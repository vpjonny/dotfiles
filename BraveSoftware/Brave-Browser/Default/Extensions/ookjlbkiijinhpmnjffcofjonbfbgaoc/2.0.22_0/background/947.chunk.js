"use strict";(self.webpackChunktemple_wallet=self.webpackChunktemple_wallet||[]).push([[947],{42947:(e,t,r)=>{var n=r(65606),l=r(96815),i=r(2543),a=r(86425),o=r(63614);function u(e){return e&&e.__esModule?e:{default:e}}var s=u(l),c=u(a),f=u(o),h=(e,t,r)=>new Promise(((n,l)=>{var i=e=>{try{o(r.next(e))}catch(e){l(e)}},a=e=>{try{o(r.throw(e))}catch(e){l(e)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,a);o((r=r.apply(e,t)).next())})),m=(n&&n.env,navigator.userAgent.includes("Macintosh")),d=e=>!!e,p=i.memoize((()=>w(window.location.hostname,"www")));function w(e,t){return e.includes(`${t}.`)?e.slice(t.length+1):e}var g="data-tw-referral",v=e=>{let t=Array.from(document.querySelectorAll("a"));if(!t.length)throw new Error("No anchors found");return t.map((t=>{if(t.hasAttribute(g))return null;let r=function(e){try{return w(new URL(e).hostname,"www")}catch(e){return null}}(t.href);if(!r||e&&!e.has(r))return null;let n=function(e){try{let t=new URL(e);return t.origin+t.pathname}catch(e){return null}}(t.href);return n?{iri:n,aElem:t,urlDomain:r}:null})).filter(d)};function y(e,t,r,n,l){var i;let{aElem:a,urlDomain:o,referralUrl:u,imageUrl:c}=e,f=a.href,h=l?function(e,t){let r=new URL(e);return r.searchParams.set("url",t),r.toString()}(l,u):u;if(a.setAttribute(g,"set"),a.onclick=e=>{e.preventDefault(),s.default.runtime.sendMessage({type:r.ReferralClick,urlDomain:o,pageDomain:p(),provider:n});let t=1===e.button||(m?e.metaKey:e.ctrlKey);window.open(h,t?"_blank":"_self")},a.oncontextmenu=()=>{a.href=h;let e=()=>{a.href=f,window.removeEventListener("focus",e)};window.addEventListener("focus",e)},!c)return;let d=p();for(let e of t){if(!1===new RegExp(e.hostRegExStr).test(d))continue;let t=e.aChildSelector?a.querySelector(e.aChildSelector):null;if(t||(t=e.aMatchSelector&&a.matches(e.aMatchSelector)?a:null),!t)continue;let r=document.createElement("img");return r.src=c,r.height=null!=(i=e.iconHeight)?i:20,r.style.display="inline-block",r.style.marginLeft="6px",r.style.verticalAlign="middle",void t.appendChild(r)}}var k=class{constructor(e,t="https://api.takeads.com"){this.publicKey=e,this.apiUrl=t,this.axios=c.default.create({baseURL:t,headers:{Authorization:`Bearer ${this.publicKey}`},adapter:"fetch"})}affiliateLinks(e,t){return h(this,null,(function*(){return(yield this.axios.put("/v1/product/monetize-api/v2/resolve",{iris:e,subId:t,withImages:!0})).data}))}},b=f.default((e=>new k(e)),{max:2});t.buildTakeadsClient=b,t.getCurrentPageDomain=p,t.processTakeAdsAnchors=function(e,t,r,n){return h(this,null,(function*(){let l=v(e);if(!l.length)return;let i=l.map((e=>e.iri)),a=yield s.default.runtime.sendMessage({type:r.FetchTakeAdsReferrals,links:i});if(a.data.length)for(let{iri:e,aElem:i,urlDomain:o}of l){let l=a.data.find((t=>t.iri===e)),u=null==l?void 0:l.trackingLink;if(!u)continue;let s=l.imageUrl;y({iri:e,aElem:i,urlDomain:o,referralUrl:u,imageUrl:s},t,r,"TakeAds",n)}}))},t.processTempleAnchors=function(e,t,r){return h(this,null,(function*(){let n=v();if(n.length)for(let{iri:l,aElem:i,urlDomain:a}of n){let n=e.find((e=>e.targetUrl===l)),o=null==n?void 0:n.referralLink;o&&y({iri:l,aElem:i,urlDomain:a,referralUrl:o,imageUrl:"https://raw.githubusercontent.com/madfish-solutions/templewallet-extension/development/public/misc/icon-128.png"},t,r,"Temple")}}))}}}]);