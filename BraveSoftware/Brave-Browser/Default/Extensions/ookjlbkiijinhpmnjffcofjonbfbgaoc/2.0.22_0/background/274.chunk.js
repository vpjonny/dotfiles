"use strict";(self.webpackChunktemple_wallet=self.webpackChunktemple_wallet||[]).push([[274],{59274:(e,t,i)=>{var r=i(65606),l=i(99589),s=i(2543),a=i(9986),n=i(96815),o=i(21396),d=i(86425);function h(e){return e&&e.__esModule?e:{default:e}}var p=h(n),c=h(d),m=Object.defineProperty,u=Object.defineProperties,g=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,f=(e,t,i)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,w=(e,t)=>{for(var i in t||(t={}))y.call(t,i)&&f(e,i,t[i]);if(v)for(var i of v(t))A.call(t,i)&&f(e,i,t[i]);return e},S=(e,t)=>u(e,g(t)),b=(e,t)=>{var i={};for(var r in e)y.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&v)for(var r of v(e))t.indexOf(r)<0&&A.call(e,r)&&(i[r]=e[r]);return i},R=(e,t,i)=>new Promise(((r,l)=>{var s=e=>{try{n(i.next(e))}catch(e){l(e)}},a=e=>{try{n(i.throw(e))}catch(e){l(e)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,a);n((i=i.apply(e,t)).next())}));r&&r.env,navigator.userAgent.includes("Macintosh");var E=(e=300)=>new Promise((t=>setTimeout(t,e))),x=class{};x.HYPELAB_PROPERTY_SLUG="",x.IS_MISES_BROWSER=!1,x.ADS_TW_WINDOW_URL="",x.TKEY_INPAGE_AD_URL="",x.SMALL_TKEY_INPAGE_AD_URL="",x.SWAP_TKEY_URL="",x.EXTERNAL_ADS_ACTIVITY_MESSAGE_TYPE="",x.getAdsStackIframeURL=()=>"",x.buildNativeAdsMeta=()=>[],x.pickNextAdMetadata=()=>{},x.bannerAdsMeta=[];var P,M="twa",C="twa-native",T="twa-hidden",N="twa-sibling-replacement",_="adRenderStart",k="resize",L="ready",O="impression",I="error",D="accelerometer; gyroscope",W="crypto",H="background",B=/[\d.]+(px)?$/,U=`[${M}]`,F=`[${M}]:not([${C}])`,$=`[${C}]`,Y=(e,t)=>{let i=parseInt(e,10);return isNaN(i)||!B.test(e)?t:i},z=(e,t,i)=>{e.style[t]=`${Math.max(Y(e.style[t],0),i)}px`},j=e=>e.reduce(((e,t)=>e+Y(t,0)),0),G=e=>!!e.closest(U),q=e=>{var t;return!(null==(t=e.previousElementSibling)||!t.getAttribute(N))},K=e=>{let t=getComputedStyle(e),{x:i,right:r,width:l,height:s}=e.getBoundingClientRect(),a={width:l,height:s},n=["width","height"];for(let l of n){let s=t[l],n=e.getAttribute(l),o=Math.max(...[s,n].map((e=>Y(null!=e?e:"",-1))));-1!==o&&(a[l]=o),"width"===l&&i<0?a.width+=i:"width"===l&&r>window.innerWidth&&(a.width=window.innerWidth-i)}return a},V=(e,t,i=document)=>e?t?[...i.querySelectorAll(e)]:[i.querySelector(e)].filter((e=>!!e)):[],X=(e,t)=>{let i=e;for(let e=0;e<t;e++){let e=i.parentElement;if(!e)return null;i=e}return i},J=e=>{let{display:t}=window.getComputedStyle(e);switch(t){case"none":return!0;case"contents":return Array.from(e.children).every((e=>J(e)));default:return!(e=>{let{x:t,y:i,width:r,height:l}=e.getBoundingClientRect();return 0!==t||0!==i||0!==r||0!==l})(e)}},Q=(e,t)=>{var i,r;return e?{width:null!=(i=document.querySelector(e.width))?i:t,height:null!=(r=document.querySelector(e.height))?r:t}:{width:t,height:t}},Z=(e,t,i,r,l)=>{var s;let a=t,{shouldUseDivWrapper:n,divWrapperStyle:o,wrapperStyle:d,elementStyle:h,adSelector:p,insertionIndex:c,insertBeforeSelector:m,insertAfterSelector:u,insertionsCount:g=1,elementsToMeasureSelectors:v,stylesOverrides:y,shouldHideOriginal:A=!1,isNative:f,urlRegexes:S,parentSelector:R,supportsTheming:E,enableForNonMises:x,fontSampleSelector:P,displayWidth:M}=a,C=b(a,["shouldUseDivWrapper","divWrapperStyle","wrapperStyle","elementStyle","adSelector","insertionIndex","insertBeforeSelector","insertAfterSelector","insertionsCount","elementsToMeasureSelectors","stylesOverrides","shouldHideOriginal","isNative","urlRegexes","parentSelector","supportsTheming","enableForNonMises","fontSampleSelector","displayWidth"]),N=C.wrapperType?d:n?o:{display:"contents"},{isMultiple:_,cssString:k,parentDepth:L}=p,O=V(f?$:F,!0,e).reduce(((e,t)=>e.some((e=>e.contains(t)))?e:[...e.filter((e=>!t.contains(e))),t]),[]),I=O.filter((e=>J(e)&&!e.hasAttribute(T))),D=g-(O.length-I.length);if(V(k,_,e).map((e=>X(e,L))).filter((e=>(e=>!!e)(e)&&!G(e))).forEach((e=>{var t;let s="none"===window.getComputedStyle(e).display;if(D<=0)(!A||!s)&&r.push({type:A?"hide-element":"remove-element",element:e});else{let r=Q(v,1===(null==(t=e.parentElement)?void 0:t.children.length)?e.parentElement:e),a=E&&P?document.querySelector(P):null,{fontSize:n,lineHeight:o}=a?window.getComputedStyle(a):{fontSize:void 0,lineHeight:void 0},d=n?Y(n,0):0,p=o?Y(o,0):0,c=w({themeColor:E?l:void 0,fontSize:d||void 0,lineHeight:p||void 0,wrapperStyle:N,elementStyle:h,stylesOverrides:y},C),m=w({type:"replace-element",element:e,adCategories:[W]},c),u={type:"hide-element",element:e},g=w({type:"simple-insert-ad",parent:e.parentElement,insertionIndex:Array.from(e.parentElement.children).indexOf(e),isSiblingReplacement:!0,adCategories:[W]},c),S=[],b=q(e);A&&b&&!s?S=[u]:A&&!b?S=[u,g]:A||(S=[m]),S.length>0&&i(r,"permanent",f,[W],...S)&&D--}})),D<=0)return;let H=-1,B=e,U={width:e,height:e},z=m||u;if(z){let t=e.querySelector(z),i=null==t?void 0:t.parentElement;t&&i&&(B=i,H=Array.from(e.children).indexOf(t)+(m?0:1),U=Q(v,t))}else{let t=null!=c?c:0;H=t<0?Math.max(e.children.length+t,0):Math.min(t,e.children.length),U=Q(v,null!=(s=e.children[H])?s:e)}if(-1!==H){let e=w({type:"simple-insert-ad",wrapperStyle:N,elementStyle:h,parent:B,insertionIndex:H,isSiblingReplacement:!1,stylesOverrides:y,adCategories:[W]},C);i(U,"permanent",f,[W],...Array(D).fill(e))}},ee=["align-items","align-self","bottom","display","flex","flex-grow","flex-shrink","float","justify-content","justify-self","left","margin","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","padding","position","right","top","vertical-align","z-index"],te=s.memoize((e=>e.reduce(((e,{dimensions:t})=>{let i=e.filter((({width:e,height:i})=>e<t.width||i<t.height));return(0===i.length||i.some((({width:e,height:i})=>e>t.width||i>t.height)))&&i.push(t),i}),[]))),ie=(e,t,i,r)=>{let{selector:{shouldUseDivWrapper:l,parentDepth:s,divWrapperStyle:a},stylesOverrides:n,shouldHideOriginal:o,isNative:d=!1}=t,h=X(e,s);if(!h||i.some((e=>e.contains(h)))||G(h)||h.querySelector(U))return;let p,c={shouldUseDivWrapper:l,wrapperStyle:a};if(l&&o){let e=h.parentElement,t="none"===window.getComputedStyle(h).display,i=w({type:"simple-insert-ad",parent:e,insertionIndex:Array.from(e.children).indexOf(h),stylesOverrides:null==n?void 0:n.map((e=>{var t=e,{parentDepth:i}=t,r=b(t,["parentDepth"]);return S(w({},r),{parentDepth:i-1})})),isSiblingReplacement:!0,adCategories:[W]},c);p=[],t||p.push({type:"hide-element",element:h}),q(h)||p.push(i)}else if(l)p=[w({type:"replace-element",element:h,stylesOverrides:null==n?void 0:n.map((e=>{var t=e,{parentDepth:i}=t,r=b(t,["parentDepth"]);return S(w({},r),{parentDepth:i-1})})),adCategories:[W]},c)];else if(o){let e={type:"simple-insert-ad",parent:h,insertionIndex:0,stylesOverrides:n,isSiblingReplacement:!0,adCategories:[W],wrapperStyle:{display:"contents"}};p=Array.from(h.children).filter((e=>"none"!==window.getComputedStyle(e).display)).map((e=>({type:"hide-element",element:e}))),h.querySelector(U)||p.push(e)}else p=[{type:"replace-all-children",parent:h,stylesOverrides:n,adCategories:[W],wrapperStyle:{display:"contents"}}];p.length>0&&r({width:h,height:h},"slot-replacement",d,[W],...p)},re=((P=re||{}).HypeLab="HypeLab",P.Temple="Temple Wallet",P.Bitmedia="Bitmedia",P),le=new Set,se=new Set,ae=e=>{let t=window.parent.location.href;p.default.runtime.sendMessage({type:x.EXTERNAL_ADS_ACTIVITY_MESSAGE_TYPE,url:t,provider:re[e]}).catch((e=>{}))},ne=e=>{let t=e.getBoundingClientRect(),i=window.visualViewport;if(!i)return!1;let r=Math.min(Math.max(0,t.x),i.width),l=Math.min(Math.max(0,t.x+t.width),i.width),s=Math.min(Math.max(0,t.y),i.height);return(l-r)*(Math.min(Math.max(0,t.y+t.height),i.height)-s)/(t.width*t.height)>=.5},oe=(e,t)=>{for(let i in t)e.style.setProperty(i,t[i])},de=e=>{let{adsMetadata:t,originalHeight:i,originalWidth:r,shouldUseBlurredBackground:l}=e,s=t[0],{dimensions:a}="number"==typeof s?x.bannerAdsMeta[s]:s;return{width:l?Math.max(r,a.width):a.width,height:l?Math.max(i,a.height):a.height}},he=(e,t,i,r,l)=>R(void 0,null,(function*(){let{elementStyle:s={},stylesOverrides:n=[],adsMetadata:o,wrapperType:d,adCategories:h,themeColor:p,fontSize:c,lineHeight:m}=e;n.sort(((e,t)=>e.parentDepth-t.parentDepth));let u,g=a.nanoid(),v=document.createElement("iframe");v.loading="lazy",v.src=x.getAdsStackIframeURL({id:g,adsMetadataIds:o,origin:window.location.href,adCategories:h,themeColor:p,fontSize:c,lineHeight:m,evmAccountAddress:x.evmAccountAddress,chainName:x.chainName}),v.id=g,v.allow=D;let y=de(e);v.style.width="tbody"===d?"100%":`${y.width}px`,v.style.height=`${y.height}px`,v.style.border="none";for(let e in s)v.style.setProperty(e,s[e]);switch(v.setAttribute(M,"true"),i.appendChild(v),e.type){case"replace-all-children":u=e.parent,e.parent.innerHTML="",e.parent.appendChild(t);break;case"replace-element":u=e.element.parentElement,e.element.replaceWith(t);break;default:let i=e.parent.children[e.insertionIndex];if(e.isSiblingReplacement){t.setAttribute(N,"true");let r=new MutationObserver((e=>{e.some((e=>Array.from(e.removedNodes).includes(i)))&&(t.remove(),r.disconnect())}));r.observe(e.parent,{childList:!0})}u=e.parent,e.parent.insertBefore(t,i)}if("tbody"!==d){let{borderLeftWidth:e,borderRightWidth:i,borderTopWidth:r,borderBottomWidth:l}=window.getComputedStyle(v),{borderLeftWidth:s,borderRightWidth:a,borderTopWidth:n,borderBottomWidth:o}=window.getComputedStyle(t),d=j([e,i,s,a]),h=j([r,l,n,o]);v.style.width=y.width-d+"px",v.style.height=y.height-h+"px"}(e=>R(void 0,null,(function*(){let t=e.id;if(le.has(t))return;le.add(t);let i=!1;return new Promise(((r,l)=>{let s,a=!1,n=o=>{var d,h;if(o.source===e.contentWindow)try{let p="string"==typeof o.data?JSON.parse(o.data):o.data;if(p.id!==t)return;let c=e.offsetWidth-e.clientWidth,m=e.offsetHeight-e.clientHeight;switch(p.type){case L:i=ne(e),s=p.adMetadata.source.providerName,r();break;case I:window.removeEventListener("message",n),e.style.display="none",l(new Error(null!=(d=p.reason)?d:"Unknown error"));break;case _:let{dimensions:t,source:o}=p.adMetadata;a=null!=(h=o.native)&&h;let{width:u,height:g}=t;u>0&&g>0&&(o.native?e.style.height=`${g}px`:(z(e,"width",u),z(e,"height",g)));break;case k:let{width:v,height:y}=p;a?e.style.height=`${y+m}px`:(z(e,"width",v+c),z(e,"height",y+m));break;case O:s&&i&&ae(s)}}catch(e){}};window.addEventListener("message",n)})).then((()=>{se.has(t)||(se.add(t),i=ne(e),new IntersectionObserver((e=>{i=e.some((e=>e.isIntersecting))}),{threshold:.5}).observe(e))})).catch((e=>{throw e})).finally((()=>{le.delete(t)}))})))(v).then(r).catch(l);let A=0;n.forEach((({parentDepth:e,style:t})=>{for(;e>A&&u;)u=u.parentElement,A++;u&&oe(u,t)}))})),pe={width:"0px",height:"0px",display:"block","overflow-x":"hidden","overflow-y":"hidden","max-block-size":"none","max-height":"none","max-inline-size":"none","max-width":"none","min-block-size":"0px","min-height":"0px","min-inline-size":"0px","min-width":"0px"},ce=e=>R(void 0,null,(function*(){let t,i,{wrapperStyle:r={},adsMetadata:l,wrapperType:s="div",colsAfter:a=0,colsBefore:n=0,colspan:o=1}=e,d=l.every((e=>"object"==typeof e));if("div"===s)t=document.createElement("div"),i=t;else{t=document.createElement("tbody");let e=document.createElement("tr");t.appendChild(e);for(let t=0;t<n;t++)e.appendChild(document.createElement("td"));let r=document.createElement("td");r.colSpan=o,e.appendChild(r),i=r;for(let t=0;t<a;t++)e.appendChild(document.createElement("td"))}t.setAttribute(M,"true"),t.setAttribute(T,"true"),d&&t.setAttribute(C,"true"),oe(t,w(w({},r),pe));let h=()=>{for(let e of i.children)i.removeChild(e)};yield he(e,t,i,(()=>{for(let e in pe)r[e]?t.style.setProperty(e,r[e]):t.style.removeProperty(e);((e,t)=>{["width","height"].forEach((i=>{var r;let l=null!=(r=e.style[i])?r:"";B.test(l)&&parseInt(l,10)<t[i]&&e.style.removeProperty(i)}))})(t,de(e)),t.removeAttribute(T)}),(e=>{h()})).catch((e=>{throw h(),e}))})),me={height:"h",slug:"p",ps:"ps",id:"id",themeColor:"tc",fontSize:"fs",lineHeight:"lh",evmAccountAddress:"ea",chainName:"cn"},ue=e=>{var t=e,{source:i,origin:r,dimensions:l}=t,s=b(t,["source","origin","dimensions"]);let{width:a,height:n}=l,{providerName:o,slug:d,native:h}=i,p=new URL(x.ADS_TW_WINDOW_URL),c=(e,t)=>{p.searchParams.set(e,String(t))};return c("ps",x.HYPELAB_PROPERTY_SLUG),c("ap",o.toLowerCase()),h?c("vh",n):c("w",a),Object.entries(w({height:n,slug:d},s)).forEach((([e,t])=>{(t||0===t)&&c(me[e],t)})),c("o",ge(r)),p.toString()},ge=e=>o.AES.encrypt(e,x.TEMPLE_PASSPHRASE).toString(),ve=class{constructor(e){this.wasReady=!1,this.rootElement=document.getElementById("root"),this.validAdsCounter=0;var t=e,{id:i,initialAdsMetadata:r,origin:l,pageHasPlacesRules:s,adCategories:a,hypelabBlacklistedCampaignsSlugs:n,evmAccountAddress:o,chainName:d}=t,h=b(t,["id","initialAdsMetadata","origin","pageHasPlacesRules","adCategories","hypelabBlacklistedCampaignsSlugs","evmAccountAddress","chainName"]);this.id=i,this.origin=l,this.pageHasPlacesRules=s,this.adCategories=a,this.hypelabBlacklistedCampaignsSlugs=n,this.adThemeParams=h,this.evmAccountAddress=o,this.chainName=d,this.adsMetadata=r.map((e=>"number"==typeof e?x.bannerAdsMeta[e]:e))}startRendering(){if(0===this.adsMetadata.length)return void this.broadcastNoMoreAds();this.currentAdMetadata=x.pickNextAdMetadata(this.adsMetadata,this.currentAdMetadata,this.validAdsCounter,this.pageHasPlacesRules,this.adCategories);let e=this.currentAdMetadata;if(!e)return void this.broadcastNoMoreAds();this.broadcastMessage({id:this.id,type:_,adMetadata:this.currentAdMetadata});let{element:t,creativeSet:i}=this.placeNewAd(e);t instanceof HTMLIFrameElement?this.listenToIframeMessages(t,e):this.handleValidAd({ad:{creative_set:i}})}listenToIframeMessages(e,t){let i=x.pickNextAdMetadata(this.adsMetadata,t,this.validAdsCounter,this.pageHasPlacesRules,this.adCategories);this.responseTimeout=setTimeout((()=>{this.handleInvalidAd()}),(i?1e4:2e4)*(x.IS_MISES_BROWSER?2:1)),this.messageListener=r=>{var l;if(r.source===e.contentWindow)try{let s="string"==typeof r.data?JSON.parse(r.data):r.data;switch(s.type){case L:if("HypeLab"===t.source.providerName&&this.hypelabBlacklistedCampaignsSlugs.includes(null==(l=s.ad)?void 0:l.campaign_slug)&&i){this.handleInvalidAd();break}this.handleValidAd(s);break;case I:this.wasReady||this.handleInvalidAd();break;case k:let{width:r,height:a}=s;r>0&&a>0&&(t.source.native?e.style.height=`${a}px`:(z(e,"width",r),z(e,"height",a)),this.broadcastMessage(S(w({},s),{id:this.id})));break;case O:this.broadcastMessage({id:this.id,type:O})}}catch(e){}},window.addEventListener("message",this.messageListener)}handleInvalidAd(){this.removeMessageListener(),this.clearResponseTimeout(),this.startRendering(),this.validAdsCounter=0}removeMessageListener(){this.messageListener&&(window.removeEventListener("message",this.messageListener),this.messageListener=void 0)}placeNewAd(e){document.body.style.backgroundColor=e.source.native?"transparent":"#F2F2F2";let t,{source:i,dimensions:r}=e;switch(i.providerName){case"Temple":t=((e,t,i=!1)=>{let r=document.createElement("div");r.style.width=`${e}px`,r.style.height=`${t}px`;let l=document.createElement("div");if(l.style.width=`${e}px`,l.style.height=`${t}px`,r.appendChild(l),i){let i=document.createElement("a");return i.href=x.SWAP_TKEY_URL,i.target="_blank",i.rel="noopener noreferrer",i.style.width=`${e}px`,i.style.height=`${t}px`,i.style.overflow="hidden",i.style.textOverflow="ellipsis",i.appendChild(document.createTextNode("TODO: Native TKEY ad")),l.appendChild(i),{element:r}}let s=document.createElement("a");s.href=x.SWAP_TKEY_URL,s.target="_blank",s.rel="noopener noreferrer",s.style.width="100%",s.style.height="100%",l.appendChild(s);let a=document.createElement("img");return a.src=e<=320?x.SMALL_TKEY_INPAGE_AD_URL:x.TKEY_INPAGE_AD_URL,a.style.width="100%",a.style.height="100%",s.appendChild(a),{element:r,creativeSet:{image:{url:a.src}}}})(r.width,r.height,i.native);break;case"HypeLab":case"Bitmedia":t=(e=>{let{source:t,id:i,dimensions:r}=e,{width:l,height:s}=r,a=document.createElement("iframe");return a.id=i,a.src=ue(e),a.style.width=t.native?"100%":`${l}px`,a.style.height=`${s}px`,a.style.border="none",a.allow=D,{element:a}})(w({id:this.id,source:i,dimensions:r,origin:this.origin,evmAccountAddress:this.evmAccountAddress,chainName:this.chainName},this.adThemeParams));break;default:throw new Error(`Unsupported ad provider: ${i.providerName}`)}let{element:l}=t,s=document.getElementById("temple-label");return this.rootElement.replaceChildren(l),i.native?s.removeAttribute("active"):s.setAttribute("active",""),t}updateBackground(e,t={}){let i=document.getElementById(H);if(e.native&&i&&this.rootElement.removeChild(i),!e.native){try{let e,{image:r,video:l}=t;if(r?(e=document.createElement("img"),e.src=r.url,e.alt=""):l&&(e=document.createElement("video"),e.src=l.url,e.autoplay=!0,e.preload="auto",e.playsInline=!0,e.muted=!0,e.loop=!0),!e&&i&&this.rootElement.removeChild(i),!e)return;e.id=H,e.style.zIndex="-1",oe(e,{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%","object-fit":"cover",filter:"blur(12px)"}),i?this.rootElement.replaceChild(e,i):this.rootElement.prepend(e)}catch(e){}document.body.style.backgroundColor="transparent"}}broadcastMessage(e){window.parent.postMessage(JSON.stringify(e),"*")}broadcastNoMoreAds(){this.broadcastMessage({id:this.id,type:I,reason:"No more ads to render"})}clearResponseTimeout(){void 0!==this.responseTimeout&&(clearTimeout(this.responseTimeout),this.responseTimeout=void 0)}handleValidAd(e){var t;let i=this.currentAdMetadata;i&&(this.wasReady||(this.wasReady=!0,this.broadcastMessage({id:this.id,type:L,adMetadata:i})),this.validAdsCounter++,this.clearResponseTimeout(),this.updateBackground(i.source,null==(t=e.ad)?void 0:t.creative_set))}},ye=(e,t,i)=>{var r;return(null!=(r=i[e])?r:[]).map((e=>{var t=e,{urlRegexes:i}=t,r=b(t,["urlRegexes"]);return S(w({},r),{urlRegexes:i.map((e=>new RegExp(e)))})})).filter((({urlRegexes:e})=>e.some(t)))},Ae=(e,t,i)=>{var r;return(null!=(r=i[e])?r:[]).map((e=>{var t=e,{urlRegexes:i}=t,r=b(t,["urlRegexes"]);return S(w({},r),{urlRegexes:i.map((e=>new RegExp(e)))})})).reduce(((e,i)=>{var r=i,{urlRegexes:l,selector:a}=r,n=b(r,["urlRegexes","selector"]);if(!l.some(t))return e;let o=a,{cssString:d}=o,h=b(o,["cssString"]),p=e.findIndex((e=>{var t=e,{selector:i}=t,r=b(t,["selector"]);let l=b(i,["cssString"]);return s.isEqual(h,l)&&s.isEqual(n,r)}));return-1===p?e.push(w({selector:a},n)):e[p].selector.cssString+=", ".concat(d),e}),[])},fe=e=>t=>{var i=t,{urlRegexes:r,elementToMeasureSelector:l,elementsToMeasureSelectors:s}=i,a=b(i,["urlRegexes","elementToMeasureSelector","elementsToMeasureSelectors"]);return S(w({},a),{urlRegexes:r.map((e=>new RegExp(e))),isNative:e,elementsToMeasureSelectors:null!=s?s:l?{width:l,height:l}:void 0})},we=(e,t,i,r={})=>{var l,s;let a=null!=(l=i[e])?l:[],n=null!=(s=r[e])?s:[];return a.map(fe(!1)).concat(n.map(fe(!0))).filter((({urlRegexes:e})=>e.some(t)))};function Se(e){let t="";return e.forEach((e=>{t+=e+", "})),t&&(t=t.slice(0,-2)),t}var be=(e,t,i,r,l,s)=>{var a;let n=(null!=(a=i[e])?a:[]).map((e=>{var t=e,{urlRegexes:i}=t,r=b(t,["urlRegexes"]);return S(w({},r),{urlRegexes:i.map((e=>new RegExp(e)))})})).filter((({urlRegexes:e})=>e.some(t))),o=new Set,d={},h=e=>{var t,i;if(o.has(e))return;let l=(null!=(t=s[e])?t:[W]).join("|");(null!=(i=r[e])?i:[]).forEach((e=>{let{selector:t,parentDepth:i}="string"==typeof e?{selector:e,parentDepth:0}:e;d[l]||(d[l]={});let r=d[l];r[i]||(r[i]=new Set),r[i].add(t)})),o.add(e)};return l.forEach(h),n.forEach((({providers:e})=>e.forEach(h))),Object.entries(d).map((([e,t])=>Object.entries(t).map((([t,i])=>({parentDepth:Number(t),selector:Se(i),categories:e.split("|")}))))).flat()},Re=e=>(...t)=>R(void 0,null,(function*(){let{data:i}=yield e(...t);return i}));t.TempleAdsApi=class{constructor(e){this.getReplaceAdPlacesRulesForAllDomains=Re((()=>this.api.get(this.getApiPath("/ad-places/replace",!1)))),this.getProvidersToReplaceAtAllSites=Re((()=>this.api.get(this.getApiPath("/providers/all-sites",!1)))),this.getProvidersCategories=Re((()=>this.api.get(this.getApiPath("/providers/categories",!1)))),this.getProvidersRulesForAllDomains=Re((()=>this.api.get(this.getApiPath("/providers/by-sites",!1)))),this.getSelectorsForAllProviders=Re((()=>this.api.get(this.getApiPath("/providers/selectors",!0)))),this.getNegativeSelectorsForAllProviders=Re((()=>this.api.get(this.getApiPath("/providers/negative-selectors",!1)))),this.getPermanentAdPlacesRulesForAllDomains=Re((()=>this.api.get(this.getApiPath("/ad-places/permanent",!1)))),this.getPermanentNativeAdPlacesRulesForAllDomains=Re((()=>this.api.get(this.getApiPath("/ad-places/permanent-native",!0)))),this.getAdsReplaceUrlsBlacklist=Re((()=>this.api.get(this.getApiPath("/replace-urls-blacklist",!1)))),this.getElementsToHideOrRemoveRules=Re((()=>this.api.get(this.getApiPath("/elements-to-hide-or-remove",!1)))),this.getBlacklistedHypelabCampaignsSlugs=Re((()=>this.api.get(this.getApiPath("/hypelab-campaigns-blacklist",!1)))),this.getAllRules=()=>R(this,null,(function*(){let[e,t,i,r,l,s,a,n,o,d,h]=yield Promise.all([this.getReplaceAdPlacesRulesForAllDomains(),this.getProvidersRulesForAllDomains(),this.getSelectorsForAllProviders(),this.getProvidersToReplaceAtAllSites(),this.getPermanentAdPlacesRulesForAllDomains(),this.getPermanentNativeAdPlacesRulesForAllDomains(),this.getAdsReplaceUrlsBlacklist(),this.getNegativeSelectorsForAllProviders(),this.getElementsToHideOrRemoveRules(),this.getProvidersCategories(),this.getBlacklistedHypelabCampaignsSlugs()]);return{adPlacesRulesForAllDomains:e,providersRulesForAllDomains:t,providersSelectors:i,providersToReplaceAtAllSites:r,permanentAdPlacesRulesForAllDomains:l,permanentNativeAdPlacesRulesForAllDomains:s,adsReplaceUrlsBlacklist:a,providersNegativeSelectors:n,elementsToHideOrRemoveRules:o,providersCategories:d,blacklistedHypelabCampaignsSlugs:h,timestamp:Date.now()}})),this.api=c.default.create({baseURL:e,adapter:"fetch"})}getApiPath(e,t){return`/ads-rules/${x.EXTENSION_VERSION}${e}${t?x.IS_MISES_BROWSER?"/mises":"/no-mises":""}`}},t.configureAds=e=>{let{hypelabPropertySlug:t,adsTwWindowUrl:i,tkeyInpageAdUrl:r,smallTkeyInpageAdUrl:l,swapTkeyUrl:s,externalAdsActivityMessageType:a,getAdsStackIframeURL:n,buildNativeAdsMeta:o,bannerAdsMeta:d,extVersion:h,templePassphrase:p,isMisesBrowser:c,pickNextAdMetadata:m,evmAccountAddress:u,chainName:g}=e;l&&(x.SMALL_TKEY_INPAGE_AD_URL=l),x.HYPELAB_PROPERTY_SLUG=t,x.ADS_TW_WINDOW_URL=i,x.TKEY_INPAGE_AD_URL=r,x.SWAP_TKEY_URL=s,x.EXTERNAL_ADS_ACTIVITY_MESSAGE_TYPE=a,x.getAdsStackIframeURL=n,x.buildNativeAdsMeta=o,x.pickNextAdMetadata=m,x.bannerAdsMeta=d,x.EXTENSION_VERSION=h,x.TEMPLE_PASSPHRASE=p,x.IS_MISES_BROWSER=c,x.evmAccountAddress=u,x.chainName=g},t.executeAdsActions=e=>Promise.allSettled(e.map((e=>R(void 0,null,(function*(){"remove-element"===e.type?e.element.remove():"hide-element"===e.type?e.element.style.setProperty("display","none","important"):yield ce(e)}))))),t.getAdsActions=e=>R(void 0,[e],(function*({providersSelectors:e,providersNegativeSelectors:t,adPlacesRules:i,permanentAdPlacesRules:r,elementsToHideOrRemoveRules:s}){let a=[],n=(e,t,i,r,...l)=>{if(l.length>0&&l.every((e=>"hide-element"===e.type||"remove-element"===e.type)))return a.push(...l),!0;let{width:s}=K(e.width),{height:n}=K(e.height),{paddingLeft:o,paddingRight:d}=window.getComputedStyle(e.width),{paddingTop:h,paddingBottom:p}=window.getComputedStyle(e.height),c=j([o,d]),m=c===s?s:s-c,u=j([h,p]),g=u===n?n:n-u,v=((e,t,i,r,l)=>{if(e<2&&t<2)return[];if(r)return x.buildNativeAdsMeta(e,t);let s="permanent"===i||"slot-replacement"===i?x.bannerAdsMeta.filter((({source:e})=>e.shouldNotUseStrictContainerLimits)):[],a=Math.max(e,...s.map((({dimensions:e})=>e.width))),n=Math.max(t,...s.map((({dimensions:e})=>e.height)));return x.bannerAdsMeta.reduce(((r,{dimensions:s,source:o},d)=>{let{shouldNotUseStrictContainerLimits:h=!1,categories:p=[W],providerName:c}=o;if(p.every((e=>!l.includes(e)))||r.some((e=>x.bannerAdsMeta[e].source.providerName===c)))return r;let{minContainerWidth:m,minContainerHeight:u,width:g,maxContainerWidth:v,maxContainerHeight:y}=s,A=!1;switch(i){case"permanent":A=h||a>=g&&(n>=u||n<2);break;case"slot-replacement":A=h||a>=m&&(n>=u||n<2);break;default:A=e>=m&&t>=u&&e<=v&&t<=y}return A&&r.push(d),r}),[])})(m,g,t,i,r);return!!v.length&&(a.push(...l.map((e=>"hide-element"===e.type||"remove-element"===e.type?e:S(w({},e),{adsMetadata:v,originalWidth:m,originalHeight:g})))),!0)},o=[],{backgroundColor:d}=window.getComputedStyle(document.body);return yield Promise.all(s.map((e=>R(void 0,null,(function*(){yield E(0),((e,t)=>{let{shouldHide:i,cssString:r,parentDepth:l,isMultiple:s}=e;V(r,s).forEach((e=>{let r=X(e,l);if(!r)return;let s=window.getComputedStyle(r);"none"!==s.display&&"hidden"!==s.visibility&&t.push({type:i?"hide-element":"remove-element",element:r})}))})(e,a)}))))),yield Promise.all(r.map((e=>R(void 0,null,(function*(){yield E(0),o=o.concat(yield((e,t,i,r)=>R(void 0,null,(function*(){let{parentSelector:s,displayWidth:a}=e,{isMultiple:n,cssString:o,parentDepth:d}=s;if(a&&!l.satisfies(l.coerce(window.innerWidth),a))return[];let h=V(o,n).map((e=>X(e,d))).filter((e=>!!e));return yield Promise.all(h.map((l=>R(void 0,null,(function*(){yield E(0),Z(l,e,t,i,r)}))))),h})))(e,n,a,d))}))))),yield Promise.all(i.map((e=>R(void 0,null,(function*(){yield E(0),yield((e,t,i)=>R(void 0,null,(function*(){let{cssString:r,isMultiple:l}=e.selector,s=V(r,l);yield Promise.all(s.map((r=>R(void 0,null,(function*(){yield E(0),ie(r,e,t,i)})))))})))(e,o,n)}))))),yield((e,t,i,r)=>R(void 0,null,(function*(){let l=te(x.bannerAdsMeta),s=e.map((({selector:e,parentDepth:t,categories:i})=>V(e,!0).reduce(((e,s)=>{var a;let n=null!=(a=X(s,t))?a:s,o=e.findIndex((({element:e})=>e.contains(n))),d=n.parentElement&&window.getComputedStyle(n.parentElement),{width:h,height:p}=K(n),c=r.some((e=>{var t;return"replace-all-children"===e.type||"simple-insert-ad"===e.type?e.parent.contains(n)||n.contains(e.parent):(null==(t=e.element.parentElement)?void 0:t.contains(n))||n.contains(e.element)})),m="none"===(null==d?void 0:d.display)||"hidden"===(null==d?void 0:d.visibility),u=o>=0&&e[o]instanceof HTMLAnchorElement,g=l.some((({width:e,height:t})=>h>=e&&p>=t));if(c||!g||m||u)return e;let v={element:n,categories:i};return o>=0?e.splice(o,1,v):e.some((({element:e})=>e.contains(n)))||e.push(v),e}),[]))).flat(),a=t.map((({selector:e,parentDepth:t})=>V(e,!0).map((e=>X(e,t))).filter((e=>!!e)))).flat();s=s.filter((({element:e})=>!a.includes(e))),yield Promise.all(s.map((e=>R(void 0,[e],(function*({element:e,categories:t}){var l,s,a,n,o,d,h,p;yield E(0);let c=e.parentElement,{width:m,height:u}=window.getComputedStyle(e),g=B.test(m)&&B.test(u)?e:null!=(s=null!=(l=null==c?void 0:c.closest("div, article, aside, footer, header"))?l:"body"===(null==c?void 0:c.tagName.toLowerCase())?void 0:c)?s:e;if(!G(e)&&!e.querySelector(U)&&!r.some((t=>"simple-insert-ad"!==t.type&&("replace-all-children"===t.type?t.parent.contains(e):t.element===e)))){let r=null!=(a=e.getAttribute("style"))?a:"",l=Object.fromEntries(r.split(";").filter(Boolean).map((e=>e.split(":").map((e=>e.trim())))));if(null!=(n=l.width)&&n.match(/^0[a-z]/)||null!=(o=l.height)&&o.match(/^0[a-z]/))return;let s=window.getComputedStyle(e),c=w(w({},Object.fromEntries(ee.map((e=>[e,s.getPropertyValue(e)])))),l);"none"===c.display&&delete c.display;let m,u={type:"hide-element",element:e},v={type:"simple-insert-ad",wrapperStyle:c,parent:null!=(d=e.parentElement)?d:document.body,insertionIndex:Array.from(null!=(p=null==(h=e.parentElement)?void 0:h.children)?p:[]).indexOf(e),isSiblingReplacement:!0,shouldUseBlurredBackground:!0,adCategories:t},y=e.closest(`[${N}] + *`);m=y&&y!==e?[{type:"remove-element",element:y.previousElementSibling},u,v]:y?"none"===window.getComputedStyle(e).display?[]:[u]:[u,v],i({width:g,height:g},"provider-replacement",!1,t,...m)}})))))})))(e,t,n,a),a})),t.renderAdsStack=e=>{try{new ve(e).startRendering()}catch(e){}},t.transformRawRules=(e,t)=>{let{adPlacesRulesForAllDomains:i,providersRulesForAllDomains:r,providersSelectors:l,providersNegativeSelectors:s={},providersToReplaceAtAllSites:a,permanentAdPlacesRulesForAllDomains:n,permanentNativeAdPlacesRulesForAllDomains:o={},adsReplaceUrlsBlacklist:d=[],elementsToHideOrRemoveRules:h={},providersCategories:p={},blacklistedHypelabCampaignsSlugs:c=[],timestamp:m}=t,u="string"==typeof e?e:e.href,{hostname:g}=new URL(u);if(d.some((e=>new RegExp(e).test(u))))return{adPlacesRules:[],permanentAdPlacesRules:[],providersSelectors:[],providersNegativeSelectors:[],elementsToHideOrRemoveRules:[],blacklistedHypelabCampaignsSlugs:c,timestamp:m};let v=u.replace(/#.*$/,""),y=e=>{let t=e.source.includes("#")?u:v;return e.test(t)};return{adPlacesRules:Ae(g,y,i),permanentAdPlacesRules:we(g,y,n,o),providersSelectors:be(g,y,r,l,a,p),providersNegativeSelectors:be(g,y,r,s,a,p),elementsToHideOrRemoveRules:ye(g,y,h),blacklistedHypelabCampaignsSlugs:c,timestamp:m}}}}]);