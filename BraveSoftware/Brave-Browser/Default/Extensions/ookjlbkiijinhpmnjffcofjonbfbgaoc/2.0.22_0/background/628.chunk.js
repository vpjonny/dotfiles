"use strict";(self.webpackChunktemple_wallet=self.webpackChunktemple_wallet||[]).push([[628],{60113:(e,t,r)=>{var n=r(48287).Buffer;t.P=function(e,t){if(0===e.length)return e;const r=n.alloc(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n%t.length];return r}},29737:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var n=r(13983),o=r(24450),i=r(48287).Buffer;function s(e){const t=i.alloc(2);return t.writeUInt16BE(e,0),t}const a={data:i.alloc(0),dataLength:0,sequence:0},c=(e,t)=>({makeBlocks(r){let n=i.concat([s(r.length),r]);const o=t-5,a=Math.ceil(n.length/o);n=i.concat([n,i.alloc(a*o-n.length+1).fill(0)]);const c=[];for(let t=0;t<a;t++){const r=i.alloc(5);r.writeUInt16BE(e,0),r.writeUInt8(5,2),r.writeUInt16BE(t,3);const s=n.slice(t*o,(t+1)*o);c.push(i.concat([r,s]))}return c},reduceResponse(t,r){let{data:n,dataLength:s,sequence:c}=t||a;if(r.readUInt16BE(0)!==e)throw new o.TransportError("Invalid channel","InvalidChannel");if(5!==r.readUInt8(2))throw new o.TransportError("Invalid tag","InvalidTag");if(r.readUInt16BE(3)!==c)throw new o.TransportError("Invalid sequence","InvalidSequence");t||(s=r.readUInt16BE(5)),c++;const u=r.slice(t?5:7);return n=i.concat([n,u]),n.length>s&&(n=n.slice(0,s)),{data:n,dataLength:s,sequence:c}},getReducedResult(e){if(e&&e.dataLength===e.data.length)return e.data}});var u=r(99589),d=r.n(u);const l={blue:{id:"blue",productName:"Ledger\xa0Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:491520,blockSize:4096,getBlockSize:e=>4096},nanoS:{id:"nanoS",productName:"Ledger\xa0Nano\xa0S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:327680,blockSize:4096,getBlockSize:e=>d().lt(d().coerce(e),"2.0.0")?4096:2048},nanoX:{id:"nanoX",productName:"Ledger\xa0Nano\xa0X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2097152,blockSize:4096,getBlockSize:e=>4096,bluetoothSpec:[{serviceUuid:"d973f2e0-b19e-11e2-9e96-0800200c9a66",notifyUuid:"d973f2e1-b19e-11e2-9e96-0800200c9a66",writeUuid:"d973f2e2-b19e-11e2-9e96-0800200c9a66"},{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572"}]}},p=Object.values(l),h=11415,f=e=>{const t=p.find((t=>t.legacyUsbProductId===e));if(t)return t;const r=e>>8;return p.find((e=>e.productIdMM===r))},g=[],m={};for(let e in l){const t=l[e],{bluetoothSpec:r}=t;if(r)for(let e=0;e<r.length;e++){const n=r[e];g.push(n.serviceUuid),m[n.serviceUuid]=m[n.serviceUuid.replace(/-/g,"")]={deviceModel:t,...n}}}var E=r(13648),v=r(48287).Buffer,y=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};const w=[{vendorId:h}],_=()=>{const{hid:e}=navigator;if(!e)throw new o.TransportError("navigator.hid is not supported","HIDNotSupported");return e};function S(){return y(this,void 0,void 0,(function*(){const e=yield _().requestDevice({filters:w});return Array.isArray(e)?e:[e]}))}function I(){return y(this,void 0,void 0,(function*(){return(yield _().getDevices()).filter((e=>e.vendorId===h))}))}class b extends n.Ay{constructor(e){super(),this.channel=Math.floor(65535*Math.random()),this.packetSize=64,this.inputs=[],this.read=()=>this.inputs.length?Promise.resolve(this.inputs.shift()):new Promise((e=>{this.inputCallback=e})),this.onInputReport=e=>{const t=v.from(e.data.buffer);this.inputCallback?(this.inputCallback(t),this.inputCallback=null):this.inputs.push(t)},this._disconnectEmitted=!1,this._emitDisconnect=e=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",e))},this.exchange=e=>y(this,void 0,void 0,(function*(){return yield this.exchangeAtomicImpl((()=>y(this,void 0,void 0,(function*(){const{channel:t,packetSize:r}=this;(0,E.Rm)("apdu","=> "+e.toString("hex"));const n=c(t,r),o=n.makeBlocks(e);for(let e=0;e<o.length;e++)yield this.device.sendReport(0,o[e]);let i,s;for(;!(i=n.getReducedResult(s));){const e=yield this.read();s=n.reduceResponse(s,e)}return(0,E.Rm)("apdu","<= "+i.toString("hex")),i})))).catch((e=>{if(e&&e.message&&e.message.includes("write"))throw this._emitDisconnect(e),new o.iX(e.message);throw e}))})),this.device=e,this.deviceModel="number"===typeof e.productId?f(e.productId):void 0,e.addEventListener("inputreport",this.onInputReport)}static request(){return y(this,void 0,void 0,(function*(){const[e]=yield S();return b.open(e)}))}static openConnected(){return y(this,void 0,void 0,(function*(){const e=yield I();return 0===e.length?null:b.open(e[0])}))}static open(e){return y(this,void 0,void 0,(function*(){yield e.open();const t=new b(e),r=n=>{e===n.device&&(_().removeEventListener("disconnect",r),t._emitDisconnect(new o.Ej))};return _().addEventListener("disconnect",r),t}))}close(){return y(this,void 0,void 0,(function*(){yield this.exchangeBusyPromise,this.device.removeEventListener("inputreport",this.onInputReport),yield this.device.close()}))}setScrambleKey(){}}b.isSupported=()=>Promise.resolve(!(!window.navigator||!window.navigator.hid)),b.list=I,b.listen=e=>{let t=!1;return function(){return y(this,void 0,void 0,(function*(){const e=yield I();return e.length>0?e[0]:(yield S())[0]}))}().then((r=>{if(r){if(!t){const t="number"===typeof r.productId?f(r.productId):void 0;e.next({type:"add",descriptor:r,deviceModel:t}),e.complete()}}else e.error(new o.kt("Access denied to use Ledger device"))}),(t=>{e.error(new o.kt(t.message))})),{unsubscribe:function(){t=!0}}};const R=b},17628:(e,t,r)=>{r.r(t),r.d(t,{TransportBridge:()=>v});var n=r(27493),o=r(13983),i=r(13648),s=r(24450),a=r(48287).Buffer;const c=e=>e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");function u(e,t,r,o){const s=function(e,t){const r=a.alloc(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n%t.length];return r}(e,r),u=a.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),d={version:"U2F_V2",keyHandle:c(s.toString("base64")),challenge:c(u.toString("base64")),appId:location.origin};return(0,i.Rm)("apdu","=> "+e.toString("hex")),(0,n.sign)(d,t/1e3).then((e=>{const{signatureData:t}=e;if("string"===typeof t){const e=a.from((r=t).replace(/-/g,"+").replace(/_/g,"/")+"==".substring(0,3*r.length%4),"base64");let n;return n=o?e.slice(5):e,(0,i.Rm)("apdu","<= "+n.toString("hex")),n}throw e;var r}))}let d=[];class l extends o.Ay{static async open(e,t=5e3){return new l}constructor(){super(),this.scrambleKey=void 0,this.unwrap=!0,d.push(this)}async exchange(e){try{return await u(e,this.exchangeTimeout,this.scrambleKey,this.unwrap)}catch(e){throw"object"===typeof e.metaData?(5===e.metaData.code&&(d.forEach((e=>e.emit("disconnect"))),d=[]),function(e,t,r){const n=new s.TransportError(t,r);return n.originalError=e,n}(e,"Failed to sign with Ledger device: U2F "+e.metaData.type,"U2F_"+e.metaData.code)):e}}setScrambleKey(e){this.scrambleKey=a.from(e,"ascii")}setUnwrap(e){this.unwrap=e}close(){return Promise.resolve()}}l.isSupported=n.isSupported,l.list=()=>(0,n.isSupported)().then((e=>e?[null]:[])),l.listen=e=>{let t=!1;return(0,n.isSupported)().then((r=>{t||(r?(e.next({type:"add",descriptor:null}),e.complete()):e.error(new s.TransportError("U2F browser support is needed for Ledger. Please use Chrome, Opera or Firefox with a U2F extension. Also make sure you're on an HTTPS connection","U2FNotSupported")))})),{unsubscribe:()=>{t=!0}}};var p=r(60113),h=r(48287).Buffer;class f extends o.Ay{constructor(...e){super(...e),this.scrambleKey=void 0}static async open(){return new f}async exchange(e){(0,i.Rm)("apdu","=> "+e.toString("hex"));const t=await((e,t,r)=>{if(!r)throw new s.TransportError("transport.setScrambleKey must be used to set a scramble key. Refer to documentation.","NoScrambleKey");if(!navigator.credentials)throw new s.TransportError("WebAuthn not supported","NotSupported");return navigator.credentials.get({publicKey:{timeout:t,challenge:new Uint8Array(32),allowCredentials:[{type:"public-key",id:new Uint8Array((0,p.P)(e,r))}]}}).then((e=>h.from(e.response.signature)))})(e,this.exchangeTimeout,this.scrambleKey);return(0,i.Rm)("apdu","<= "+t.toString("hex")),t}setScrambleKey(e){this.scrambleKey=h.from(e,"ascii")}close(){return Promise.resolve()}}f.isSupported=()=>Promise.resolve(!!navigator.credentials),f.list=()=>navigator.credentials?[null]:[],f.listen=e=>(setTimeout((()=>{if(!navigator.credentials)return e.error(new s.TransportError("WebAuthn not supported","NotSupported")),{unsubscribe:()=>{}};e.next({type:"add",descriptor:null}),e.complete()}),0),{unsubscribe:()=>{}});var g=r(29737),m=r(37287),E=r(48287).Buffer;class v{transport;async requestExchange(e){try{return await this.exchange(e.apdu,e.transportType,e.scrambleKey,e.exchangeTimeout)}catch(e){if(e&&e instanceof Error)throw new Error(e.message??"Unexpected error")}throw new Error("Unknown error")}async close(){if(null!=this.transport){try{await this.transport.close()}catch(e){}delete this.transport}}async exchange(e,t,r,n){const o=await this.getOrCreateTransport(t);n&&o.setExchangeTimeout(n),r&&o.setScrambleKey(r);return(await o.exchange(E.from(e,"hex"))).toString("hex")}async getOrCreateTransport(e){const t=this.transport;if(null==t)return await this.createTransport(e);if(e===m.Y.WEBHID&&t instanceof g.default){const e=t.device,r=e&&e.constructor.name,n=e&&e.opened;if("HIDDevice"===r&&n)return t;const o=await g.default.openConnected();o&&(this.transport=o)}return this.transport}async createTransport(e){switch(e){case m.Y.WEBHID:this.transport=await g.default.create();break;case m.Y.WEBAUTHN:this.transport=await f.create();break;default:this.transport=await l.create()}return this.transport}}},27493:(e,t,r)=>{e.exports=r(96343)},377:e=>{var t=t||{};e.exports=t,t.EXTENSION_ID="kmendfapggjehodndflmmgagdbamhnfd",t.MessageTypes={U2F_REGISTER_REQUEST:"u2f_register_request",U2F_SIGN_REQUEST:"u2f_sign_request",U2F_REGISTER_RESPONSE:"u2f_register_response",U2F_SIGN_RESPONSE:"u2f_sign_response"},t.ErrorCodes={OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5},t.Request,t.Response,t.Error,t.SignRequest,t.SignResponse,t.RegisterRequest,t.RegisterResponse,t.disconnect=function(){t.port_&&t.port_.port_&&(t.port_.port_.disconnect(),t.port_=null)},t.getMessagePort=function(e){if("undefined"!=typeof chrome&&chrome.runtime){var r={type:t.MessageTypes.U2F_SIGN_REQUEST,signRequests:[]};chrome.runtime.sendMessage(t.EXTENSION_ID,r,(function(){chrome.runtime.lastError?t.getIframePort_(e):t.getChromeRuntimePort_(e)}))}else t.getIframePort_(e)},t.getChromeRuntimePort_=function(e){var r=chrome.runtime.connect(t.EXTENSION_ID,{includeTlsChannelId:!0});setTimeout((function(){e(null,new t.WrappedChromeRuntimePort_(r))}),0)},t.WrappedChromeRuntimePort_=function(e){this.port_=e},t.WrappedChromeRuntimePort_.prototype.postMessage=function(e){this.port_.postMessage(e)},t.WrappedChromeRuntimePort_.prototype.addEventListener=function(e,t){var r=e.toLowerCase();"message"!=r&&"onmessage"!=r||this.port_.onMessage.addListener((function(e){t({data:e})}))},t.getIframePort_=function(e){var r="chrome-extension://"+t.EXTENSION_ID,n=document.createElement("iframe");n.src=r+"/u2f-comms.html",n.setAttribute("style","display:none"),document.body.appendChild(n);var o=!1,i=new MessageChannel,s=function(t){"ready"==t.data&&(i.port1.removeEventListener("message",s),o||(o=!0,e(null,i.port1)))};i.port1.addEventListener("message",s),i.port1.start(),n.addEventListener("load",(function(){n.contentWindow.postMessage("init",r,[i.port2])})),setTimeout((function(){o||(o=!0,e(new Error("IFrame extension not supported")))}),200)},t.EXTENSION_TIMEOUT_SEC=30,t.port_=null,t.waitingForPort_=[],t.reqCounter_=0,t.callbackMap_={},t.getPortSingleton_=function(e){t.port_?e(null,t.port_):(0==t.waitingForPort_.length&&t.getMessagePort((function(e,r){for(e||(t.port_=r,t.port_.addEventListener("message",t.responseHandler_));t.waitingForPort_.length;)t.waitingForPort_.shift()(e,r)})),t.waitingForPort_.push(e))},t.responseHandler_=function(e){var r=e.data,n=r.requestId;if(n&&t.callbackMap_[n]){var o=t.callbackMap_[n];delete t.callbackMap_[n],o(null,r.responseData)}},t.isSupported=function(e){t.getPortSingleton_((function(t,r){e(!t)}))},t.sign=function(e,r,n){t.getPortSingleton_((function(o,i){if(o)return r(o);var s=++t.reqCounter_;t.callbackMap_[s]=r;var a={type:t.MessageTypes.U2F_SIGN_REQUEST,signRequests:e,timeoutSeconds:"undefined"!==typeof n?n:t.EXTENSION_TIMEOUT_SEC,requestId:s};i.postMessage(a)}))},t.register=function(e,r,n,o){t.getPortSingleton_((function(i,s){if(i)return n(i);var a=++t.reqCounter_;t.callbackMap_[a]=n;var c={type:t.MessageTypes.U2F_REGISTER_REQUEST,signRequests:r,registerRequests:e,timeoutSeconds:"undefined"!==typeof o?o:t.EXTENSION_TIMEOUT_SEC,requestId:a};s.postMessage(c)}))}},96343:(e,t,r)=>{e.exports=u;var n=r(377),o="undefined"!==typeof navigator&&!!navigator.userAgent,i=o&&navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//),s=o&&navigator.userAgent.match(/Edge\/1[2345]/),a=null;function c(e){return a||(a=new e((function(e,t){function r(){e({u2f:null,native:!0})}return o?i?r():("undefined"!==typeof window.u2f&&"function"===typeof window.u2f.sign&&e({u2f:window.u2f,native:!0}),s||"http:"===location.protocol||"undefined"===typeof MessageChannel?r():void n.isSupported((function(t){t?e({u2f:n,native:!1}):r()}))):r()}))),a}function u(e){return{isSupported:p.bind(e),ensureSupport:f.bind(e),register:g.bind(e),sign:m.bind(e),ErrorCodes:u.ErrorCodes,ErrorNames:u.ErrorNames}}function d(e,t){var r=null!=t?t.errorCode:1,n=u.ErrorNames[""+r],o=new Error(e);return o.metaData={type:n,code:r},o}function l(e,t){var r={};return r.promise=new e((function(e,n){r.resolve=e,r.reject=n,t.then(e,n)})),r.promise.cancel=function(t,n){c(e).then((function(e){n&&!e.native&&e.u2f.disconnect(),r.reject(d(t,{errorCode:-1}))}))},r}function p(){return c(this).then((function(e){return!!e.u2f}))}function h(e){if(!e.u2f){if("http:"===location.protocol)throw new Error("U2F isn't supported over http, only https");throw new Error("U2F not supported")}}function f(){return c(this).then(h)}function g(e,t,r){var n=this;return Array.isArray(e)||(e=[e]),"number"===typeof t&&"undefined"===typeof r&&(r=t,t=null),t||(t=[]),l(n,c(n).then((function(o){h(o);var i=o.native,s=o.u2f;return new n((function(n,o){if(i){var a=e[0].appId;s.register(a,e,t,(function(e){e.errorCode?o(d("Registration failed",e)):(delete e.errorCode,n(e))}),r)}else s.register(e,t,(function(e,t){e?o(e):t.errorCode?o(d("Registration failed",t)):n(t)}),r)}))}))).promise}function m(e,t){var r=this;return Array.isArray(e)||(e=[e]),l(r,c(r).then((function(n){h(n);var o=n.native,i=n.u2f;return new r((function(r,n){if(o){var s=e[0].appId,a=e[0].challenge;i.sign(s,a,e,(function(e){e.errorCode?n(d("Sign failed",e)):(delete e.errorCode,r(e))}),t)}else i.sign(e,(function(e,t){e?n(e):t.errorCode?n(d("Sign failed",t)):r(t)}),t)}))}))).promise}function E(e){u[e]=function(){if(!r.g.Promise)throw new Error("The platform doesn't natively support promises");var t=[].slice.call(arguments);return u(r.g.Promise)[e].apply(null,t)}}u.ErrorCodes={CANCELLED:-1,OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5},u.ErrorNames={"-1":"CANCELLED",0:"OK",1:"OTHER_ERROR",2:"BAD_REQUEST",3:"CONFIGURATION_UNSUPPORTED",4:"DEVICE_INELIGIBLE",5:"TIMEOUT"},E("isSupported"),E("ensureSupport"),E("register"),E("sign")}}]);