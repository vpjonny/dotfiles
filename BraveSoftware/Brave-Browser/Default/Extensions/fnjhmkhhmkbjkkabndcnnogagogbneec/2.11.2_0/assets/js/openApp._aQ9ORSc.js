var g=Object.defineProperty;var f=(s,e,t)=>e in s?g(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var d=(s,e,t)=>f(s,typeof e!="symbol"?e+"":e,t);import{L as w,b as i}from"./enum.CGJbW6Yf.js";import{j as O,S as _,k as b,D as l,h as y,G as T,H as E,I as m,J as R,L as I}from"./windowUtils.Ut7JS-rc.js";class N{constructor(){d(this,"_isSidePanel",!1)}get isSidePanel(){return this._isSidePanel}set isSidePanel(e){this._isSidePanel=e}}const P=new N,u=O(b.APP_SESSION_STORE,{isOpening:!1},{storageType:_.Session}),C={...u,setIsOpening:s=>u.set(e=>({...e,isOpening:s}))},S=async(s=!0,e)=>{const t=await i.windows.getCurrent({populate:!0}),{isOpening:a}=await C.get();if(a){const p=await E();if(!(!P.isSidePanel&&p.length===0)){await i.windows.update(p[0].windowId,{focused:!0});return}}const o=t.left+t.width-375-20,n=t.top+100,r=l()?"detached_panel":"popup",c=`${m}${s?"?closeOnComplete=true":""}`;await i.windows.create({url:c,focused:!0,width:375,height:600,type:r,left:o,top:n,...e})},h=async s=>{var e,t;l()?(e=i.sidebarAction)==null||e.toggle():await((t=chrome.sidePanel)==null?void 0:t.open({tabId:s}))},M=async s=>{try{const t=(await y())[0];if(!(t!=null&&t.id)){const a=await chrome.windows.getCurrent(),o=320,n=375,r=Math.round((a.top??0)+((a.height??o)-o)/2),c=Math.round((a.left??0)+((a.width??n)-n)/2),p=`${T}?tabId=`+s;await S(!0,{width:n,height:o,top:r,left:c,url:p});return}await chrome.windows.update(t.windowId,{focused:!0})}catch(e){w.error("openRequestSidePanelPopup",e)}},L=async(s,e=!0,t)=>{try{t?h(s).catch(()=>{M(s)}):await S(e)}catch(a){w.error("openWallet",a)}},$=async(s,e=!0)=>{await L(s,e,P.isSidePanel)},x=async()=>{var e;if(await R()){const t=await I();if(!(t!=null&&t.tab))return;await h(t.tab.id)}else await((e=i.action)==null?void 0:e.openPopup())};export{C as a,P as b,$ as c,S as d,x as e,L as f,h as o};
