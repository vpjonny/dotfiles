import{j as s}from"./useTriggerLoadNext.KJIKMCqU.js";import{E as O,r as J,a as u,x as K,B as Q,a5 as X}from"./windowUtils.Ut7JS-rc.js";import{a as Z,y as $,i as tt,L as N,B as et,z as st}from"./PopupLoading.D-LitESe.js";import{e as ot,u as nt,g as rt,I as L,B as R}from"./useActiveTimeStore.C3Wei7Oz.js";import{u as at,g as it,i as ct}from"./useNftCollectionList.0TiOOKoB.js";import{N as dt}from"./Network.CvcxyDcT.js";import{r as a}from"./index.CxJLds0B.js";import{T as lt,I as l,B as z}from"./PasswordLevelLabel.rhWNhrqO.js";import"./tiny-invariant.BHpmfUqq.js";import"./enum.CGJbW6Yf.js";import"./preload-helper.2LWRYvkK.js";import"./solana.CGFphaJI.js";import"./useDebouncedEffect.CslCnlPq.js";const ut="_input_5ix62_1",ft="_footer_5ix62_5",pt="_container_5ix62_56",f={input:ut,footer:ft,container:pt},At=()=>{const e=ot(),[D,y]=a.useState(!1),p=Z(t=>t.setIsLoading),[g,b]=a.useState(O.RONIN),m=J(),F=async()=>{m(-1)},{data:o}=nt(),{refetch:j}=at((e==null?void 0:e.addresses)??[]),[i,w]=a.useState(),[h,A]=a.useState(),[T,M]=a.useState(),[x,I]=a.useState(void 0),[k,B]=a.useState(void 0),{toastSuccess:W,toastError:G}=rt(),r=$()(g),E=r==null?void 0:r.configId,{data:C,setCustomNft:P}=tt(),v=e.addresses.map(t=>{var c;return((c=C==null?void 0:C.customNftsList)==null?void 0:c[t])??[]}).flat(),n=u.manageTokens.addCustomNft;a.useEffect(()=>{var t;o!=null&&o.isSingleChain&&b(((t=o==null?void 0:o.activeChainIds)==null?void 0:t[0])??O.RONIN)},[o.activeChainIds,o==null?void 0:o.isSingleChain]);const S=t=>{G({title:"",content:t})},V=t=>{W({title:"",content:t})},_=()=>{j(),m(-1)},q=async()=>{if(e!=null&&e.baseAddress){p(!0);try{if(v==null?void 0:v.find(d=>(d==null?void 0:d.contractAddress.toLowerCase())===(i==null?void 0:i.toLowerCase())&&(d==null?void 0:d.chainConfigId)===E)){S(n.existed);return}if(!await ct({contractAddress:i,tokenId:h,chainConfig:r==null?void 0:r.chainConfig,tokenType:T,accountAddress:e==null?void 0:e.baseAddress})){S(n.notYours),p(!1);return}const Y={contractAddress:i,tokenId:h,chainConfigId:E,tokenType:T,ownerAddress:e==null?void 0:e.baseAddress};await P(e==null?void 0:e.baseAddress,Y),V(n.added),_()}catch{S(n.failed);return}finally{p(!1)}}},H=async t=>{if(t.preventDefault(),I(void 0),!X(t.target.value))w(""),I(n.invalidAddress);else{w(t.target.value);const c=await it(t.target.value,r==null?void 0:r.chainConfig);if(!c){I(n.typeNotFound);return}M(c)}},U=t=>{B(void 0),t.target.value.length>0?A(t.target.value):(A(void 0),B(n.idRequired))};return s.jsxs(N,{noBackground:!0,noFooter:!0,children:[s.jsx(N.BackableNavbar,{title:n.title,callback:_,suffixComponent:s.jsx("div",{children:s.jsx(lt.Text,{level:"2",bold:!0,intent:l.Info,onClick:()=>{j(),m(K.HOME)},children:u.manageWallet.doneBtn})})}),s.jsx(N.Content,{noPadding:!0,children:s.jsxs("div",{className:f.container,children:[s.jsx(dt,{chainId:g,callback:()=>y(!0)}),s.jsx(L,{autoFocus:!0,placeholder:"0x",label:n.contractAddress,caption:x,onChange:H,className:f.input,intent:x?l.Danger:void 0,withBackground:!0}),s.jsx(L,{placeholder:"eg: 123",type:"number",label:n.tokenId,caption:k,onChange:U,className:f.input,intent:k?l.Danger:void 0,withBackground:!0}),s.jsx(et,{children:s.jsxs("div",{className:f.footer,children:[s.jsx(z,{text:u.common.cancel,intent:l.Secondary,fullWidth:!0,onClick:F,size:R.Small}),s.jsx(z,{text:u.common.import,intent:l.Primary,disabled:!!(x||!i||!h||k),fullWidth:!0,onClick:q,size:R.Small})]})}),s.jsx(st,{currentConfigId:g,isVisible:D,requestOnClose:()=>y(!1),onSelect:t=>b(t==null?void 0:t.configId),blockchains:[Q.EVM]})]})})]})};export{At as default};
