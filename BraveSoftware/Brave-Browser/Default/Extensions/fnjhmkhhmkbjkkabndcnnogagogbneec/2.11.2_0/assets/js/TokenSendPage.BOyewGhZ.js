import{j as e}from"./useTriggerLoadNext.KJIKMCqU.js";import{g as Ze,am as qe,A as Ue,k as Ke,H as de,a4 as Xe,V as Qe,Q as we,an as Ce,O as Ye,ao as he,u as Je,e as ke,ap as es,R as ss,aq as Be,ar as as,X as ne,F as ts,L as re,B as ns}from"./PopupLoading.D-LitESe.js";import{R as w,r as g}from"./index.CxJLds0B.js";import{a as j,l as S,V as rs,B as xe,a_ as ce,b as fe,T as ge,e as je,X as cs,bB as Re,ap as ue,ag as J,af as Ee,r as Fe,x as De,f as Me,bC as X,a9 as U,aH as is,a7 as O,bD as ve,N as ls,a8 as H,bE as Te,ad as os}from"./windowUtils.Ut7JS-rc.js";import{u as W,a as ds}from"./useDebouncedValue.BgjK-DBz.js";import{c as k,i as ee,A as us,k as ms,G as ps,P as _e,I as ze,W as T,B as ye,a as Ne,b as me,C as $e,u as hs,e as xs,p as fs,q as gs}from"./useActiveTimeStore.C3Wei7Oz.js";import{T as N,I,S as se,B as ae,f as Ve,c as Le,e as js,d as _s}from"./PasswordLevelLabel.rhWNhrqO.js";import{t as ys,R as Ns,M as As}from"./RecentAddress.Dz-2Qi8G.js";import{R as Cs}from"./RecipientResolver.Du8varQg.js";import{a as vs,u as Pe}from"./useTransferAdapter.DBEESo_0.js";import{a as Ts}from"./XCircleFill.DU4rF_sO.js";import{t as Ss}from"./WalletFill.CME38IAb.js";import{t as Oe}from"./useTxStatus.C8QHcxiJ.js";import{E as bs}from"./EmptyState.B5_-rwyr.js";import{N as Is}from"./TabsActions.Gev4sY-8.js";import{a as ws}from"./useTempStore.C8dvVNTz.js";import{a as Bs}from"./Erc20SelectTokenOnRampPage.CZiohm3T.js";import{u as We}from"./useEstimateFee.mvOlF2u1.js";import{u as He}from"./useNormalizeToken.C6igk56m.js";import"./solana.CGFphaJI.js";import"./enum.CGJbW6Yf.js";import"./tiny-invariant.BHpmfUqq.js";import"./preload-helper.2LWRYvkK.js";import"./useDebouncedEffect.CslCnlPq.js";import"./SectionWallet.D4GJGuVx.js";import"./token.types.DkObBlUj.js";import"./associatedTokenAccount.Cs_dSOLN.js";import"./SummaryRow.DvX50DLf.js";import"./CustomPopover.BEpkv9NF.js";import"./ActiveNetworkDialog.BRXTzxl9.js";import"./BetaTag.D99jAmHR.js";import"./index.C702uFBM.js";import"./DotsThreeVertical.DF4zWZuW.js";import"./useSearchErc20Tokens.D0zoSI7L.js";import"./Network.CvcxyDcT.js";import"./useNormalizeToken.CRab6WQg.js";import"./useNftCollectionItems.DtJWVrNT.js";import"./useNftCollectionList.0TiOOKoB.js";const Rs=k(w.createElement(w.Fragment,null,w.createElement("path",{d:"M224 160v48a8 8 0 0 1-13.66 5.66l-16.06-16.07C174.13 214.9 151.36 224 128 224c-42.82 0-68.58-25.27-69.66-26.34a8 8 0 0 1 11.3-11.33C70 186.68 92.16 208 128 208c23.17 0 41.92-10.85 54.92-21.76l-20.58-20.58A8 8 0 0 1 168 152h48a8 8 0 0 1 8 8ZM95.39 99.06a8 8 0 0 0-1.73-8.72L73.08 69.76C86.08 58.85 104.83 48 128 48c35.95 0 58.13 21.44 58.36 21.68a8 8 0 0 0 11.3-11.34C196.58 57.27 170.82 32 128 32c-23.36 0-46.13 9.1-66.28 26.41L45.66 42.34A8 8 0 0 0 32 48v48a8 8 0 0 0 8 8h48a8 8 0 0 0 7.39-4.94Z"})),"ArrowsCounterClockwiseFillIcon"),Es=k(w.createElement(w.Fragment,null,w.createElement("path",{d:"M117.66 170.34a8 8 0 0 1 0 11.32l-32 32a8 8 0 0 1-11.32 0l-32-32a8 8 0 0 1 11.32-11.32L72 188.69V48a8 8 0 0 1 16 0v140.69l18.34-18.35a8 8 0 0 1 11.32 0Zm96-96-32-32a8 8 0 0 0-11.32 0l-32 32a8 8 0 0 0 11.32 11.32L168 67.31V208a8 8 0 0 0 16 0V67.31l18.34 18.35a8 8 0 0 0 11.32-11.32Z"})),"ArrowsDownUpIcon"),Fs=k(w.createElement(w.Fragment,null,w.createElement("path",{d:"M168 152a8 8 0 0 1-8 8H96a8 8 0 0 1 0-16h64a8 8 0 0 1 8 8Zm-8-40H96a8 8 0 0 0 0 16h64a8 8 0 0 0 0-16Zm56-64v168a16 16 0 0 1-16 16H56a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16h36.26a47.92 47.92 0 0 1 71.48 0H200a16 16 0 0 1 16 16ZM96 64h64a32 32 0 0 0-64 0Zm104-16h-26.75A47.93 47.93 0 0 1 176 64v8a8 8 0 0 1-8 8H88a8 8 0 0 1-8-8v-8a47.93 47.93 0 0 1 2.75-16H56v168h144Z"})),"ClipboardTextIcon"),Ds=k(w.createElement(w.Fragment,null,w.createElement("path",{d:"m241 69.66-19.34-19.32a8 8 0 0 0-11.32 11.32L229.66 81a8 8 0 0 1 2.34 5.63V168a8 8 0 0 1-16 0v-40a24 24 0 0 0-24-24h-16V56a24 24 0 0 0-24-24H72a24 24 0 0 0-24 24v152H32a8 8 0 0 0 0 16h160a8 8 0 0 0 0-16h-16v-88h16a8 8 0 0 1 8 8v40a24 24 0 0 0 48 0V86.63a23.85 23.85 0 0 0-7-16.97ZM144 120H80a8 8 0 0 1 0-16h64a8 8 0 0 1 0 16Z"})),"GasPumpFillIcon"),Ms="_container_1ps2m_1",Se={container:Ms},zs="_senderInfo_1oeaf_1",$s="_info_1oeaf_8",Vs="_infoRow_1oeaf_14",ie={senderInfo:zs,info:$s,infoRow:Vs},Ls=({account:s})=>{const{chainId:a}=W(),n=ee(a);return e.jsxs("div",{className:ie.senderInfo,children:[e.jsx(N.Text,{level:"3",color:"gray",children:j.transfer.from}),e.jsx(Ze,{children:e.jsx(qe,{className:ie.infoRow,title:e.jsxs("div",{className:ie.info,children:[e.jsx(us,{size:ms.M,seed:s==null?void 0:s.baseAddress}),e.jsx(Ue,{account:s,nameResolverProps:{fallbackName:s==null?void 0:s.nickname},showBalance:!1,showBlockchainAddress:n})]}),children:" "})})]})},Ps="_senderInfo_1q8gk_1",Os="_helperText_1q8gk_8",Ws="_toWrapper_1q8gk_12",Hs="_myAddresses_1q8gk_18",Gs="_triggerWrapper_1q8gk_26",Zs="_input_1q8gk_29",qs="_popoverContent_1q8gk_40",V={senderInfo:Ps,helperText:Os,toWrapper:Ws,myAddresses:Hs,triggerWrapper:Gs,input:Zs,popoverContent:qs},Us=({blockchain:s})=>{const{reset:a}=Ke(),{recipient:n,setRecipient:t,chainId:r}=W(),[i,c]=g.useState(!1),[h,u]=g.useState(!1),x=g.useRef(null),A=ps(!0),[o,d]=g.useState(n),m=ds(o,500),f=g.useRef(null),l=j.transfer;g.useEffect(()=>{x.current=null,a()},[a]),g.useEffect(()=>{m!==n&&t(m)},[m]),g.useEffect(()=>{var y,C;if(x.current&&s){const z=A.find(te=>te.id===x.current),Z=(C=(y=z==null?void 0:z.chains)==null?void 0:y[s])==null?void 0:C.address;z&&Z&&(d(Z),t(Z))}},[A==null?void 0:A.length,s,t]);const B=()=>{d("")},_=()=>{c(!1)},b=y=>{d(y.target.value)},F=async y=>{y.preventDefault();const C=await navigator.clipboard.readText();d(C),t(C),fe.sendEvent(ge.Click,je.Send,cs.PasteAddress)},L=()=>{S.isEmpty(o)&&u(!0)},$=y=>{const C=ce(y);d(C),t(C),f!=null&&f.current&&f.current.focus()},D=y=>{const C=ce(y);d(C),t(C),f!=null&&f.current&&f.current.focus()},v=(y,C)=>{const z=ce(y);d(z),t(z),_(),C?x.current=C:x.current=null,f!=null&&f.current&&f.current.focus()},R=()=>{c(!0)},M=S.isEmpty(o),P=rs(n)&&s!==xe.SOLANA,E=g.useMemo(()=>{const y=vs.getAdapter(s,r);return(y==null?void 0:y.validateRecipient(n))??!1},[s,n,r]);return e.jsxs("div",{className:V.senderInfo,children:[e.jsxs("div",{className:V.toWrapper,children:[e.jsx(N.Text,{level:"3",color:"gray",children:l.to}),e.jsxs(N.Text,{onClick:R,level:"3",intent:I.Info,className:V.myAddresses,children:[e.jsx(ys,{size:16})," ",l.myAddress]})]}),e.jsx(_e,{isOpen:h&&M,triggerElement:e.jsx(ze,{ref:f,placeholder:l.inputAddressPlaceholder,shape:se.Default,value:o,onChange:b,onFocus:L,className:V.input,suffixIcon:e.jsxs(e.Fragment,{children:[e.jsx(T,{when:!M,children:e.jsx(Ts,{role:"button",size:20,onClick:B})}),e.jsx(T,{when:M,children:e.jsx(ae,{onClick:F,text:j.common.paste,icon:Fs,intent:I.Default,size:ye.XSmall,type:"button"})})]})}),placement:"bottom-start",layerClassName:V.popover,triggerWrapperClassName:V.triggerWrapper,onOutsideClick:()=>u(!1),applyLayerMinWidth:!0,children:e.jsx("div",{className:V.popoverContent,children:e.jsx(Ns,{setReceiver:D,blockchain:s})})}),e.jsxs("div",{className:V.helperText,hidden:S.isEmpty(n),children:[e.jsx(T,{when:E,children:e.jsx(de,{intent:I.Success,children:l.validAddress})}),e.jsx(T,{when:P,children:e.jsx(Cs,{name:n,handleOnClick:$})}),e.jsx(T,{when:!E&&!P,children:e.jsx(de,{intent:I.Danger,children:l.invalidAddress})})]}),e.jsx(As,{isVisible:i,onClose:_,handleSelectAddress:v,blockchain:s})]})},Ks="_selectToken_ydubz_1",Xs={selectToken:Ks},Qs="_balanceText_cl8hf_1",Ys="_walletIcon_cl8hf_6",Js="_maxButton_cl8hf_10",le={balanceText:Qs,walletIcon:Ys,maxButton:Js},ks=({token:s,handleClickMax:a,disableMax:n})=>{const t=Re(s==null?void 0:s.balance,s==null?void 0:s.decimal,"--"),r=ue(J(s==null?void 0:s.balance,s==null?void 0:s.decimal));return e.jsxs("div",{className:le.balanceText,children:[e.jsx("div",{className:le.walletIcon,children:e.jsx(Ss,{size:16,color:"#CDD5E5BF"})}),e.jsxs(T,{when:!S.isEmpty(s==null?void 0:s.balance),children:[e.jsx(_e,{triggerElement:e.jsx(N.Text,{level:"3",children:t}),isOpen:!0,hoverToShow:!0,children:e.jsx(N.Text,{level:"3",children:r})}),e.jsx(ae,{text:j.common.max,onClick:a,variant:Ve.Plain,className:le.maxButton,size:ye.Small,disabled:n,type:"button",noPadding:!0})]}),e.jsx(T,{when:S.isEmpty(s==null?void 0:s.balance),children:e.jsx(N.Text,{level:"3",children:"--"})})]})},ea="_switchDisplayModeBtn_1aesu_1",sa="_active_1aesu_5",be={switchDisplayModeBtn:ea,active:sa};var pe=(s=>(s[s.TOKEN=0]="TOKEN",s[s.FIAT=1]="FIAT",s))(pe||{});const aa=({displayingTokenUnit:s,currencyAmount:a,numericAmount:n,setDisplayMode:t,missingInfo:r})=>{const i=Xe({value:a,showCurrencySign:!1}),c=`~ ${Ee(n)}`,h=`~ ${i}`,u=s?h:c,x=s?`~ ${ue(a)}`:`~ ${ue(n)}`;return e.jsxs(N.Text,{onClick:()=>{r||t(s?1:0)},level:"4",color:"gray",className:Le(be.switchDisplayModeBtn,!r&&be.active),children:[e.jsx(Es,{}),e.jsx(_e,{triggerElement:e.jsx(N.Text,{level:"4",color:"gray",children:u}),isOpen:!0,hoverToShow:!0,children:e.jsx(N.Text,{level:"4",color:"gray",children:x})})]})},ta="_inputClassOverride_9ig17_1",na={inputClassOverride:ta},ra=s=>isNaN(Number(s))?"":Number(s).toFixed(18),ca=s=>{const{amountToDisplay:a,displayingTokenUnit:n,handleChangeInput:t,tokenDecimals:r,className:i}=s,c=a.toString().includes("e")?ra(a):a;return e.jsx(Qe,{placeholder:"0",shape:se.Default,withBackground:!1,value:c,onChange:t,inputClassName:Le(na.inputClassOverride,i),maxDecimalLength:n?r:18})},ia="_tokenButton_uoz6v_1",la="_text_uoz6v_6",oe={tokenButton:ia,text:la},oa=({onClick:s,token:a})=>{var t;const n=(t=Ne(a==null?void 0:a.chainId))==null?void 0:t.chainConfig;return e.jsx(ae,{className:oe.tokenButton,type:"button",shape:se.Default,size:ye.Small,variant:Ve.Plain,text:e.jsxs(e.Fragment,{children:[e.jsx(T,{when:!S.isEmpty(a==null?void 0:a.symbol),children:e.jsxs("div",{className:oe.text,children:[e.jsx(we,{backAvtSrc:a==null?void 0:a.logoUrl,size:me.Size24,backAvtPlaceholder:e.jsx(Oe,{size:16}),frontAvtSrc:e.jsx($e,{chainConfig:n,size:14}),frontSquared:!0}),e.jsx(N.Text,{level:"2",bold:!0,className:oe.tokenSymbol,children:a==null?void 0:a.symbol}),e.jsx(Ce,{size:20})]})}),e.jsx(T,{when:S.isEmpty(a==null?void 0:a.symbol),children:e.jsxs(N.Text,{level:"2",children:[j.transfer.selectToken," ",e.jsx(Ce,{size:20})]})})]}),onClick:s})},da="_container_1s2fh_1",ua="_tokenList_1s2fh_11",ma="_actions_1s2fh_21",pa="_networkSelectTrigger_1s2fh_29",ha="_spinner_1s2fh_34",K={container:da,tokenList:ua,actions:ma,networkSelectTrigger:pa,spinner:ha},xa="_emptyState_t4mkw_1",fa="_tokenList_t4mkw_11",Ie={emptyState:xa,tokenList:fa},ga="_recordContainer_ygpiu_1",ja="_titleContainer_ygpiu_13",_a="_tokenName_ygpiu_18",ya="_price_ygpiu_24",q={recordContainer:ga,titleContainer:ja,tokenName:_a,price:ya},Na=({token:s,handleNext:a})=>{var i;const n=(i=Ne(s==null?void 0:s.chainId))==null?void 0:i.chainConfig,t=s==null?void 0:s.tokenLogo,r=Re(s==null?void 0:s.balance,s==null?void 0:s.decimals,"--");return e.jsxs("div",{className:q.recordContainer,role:"button",onClick:c=>{c.preventDefault(),a({...s,tokenLogo:t})},tabIndex:0,children:[e.jsx(we,{backAvtSrc:t,backAvtPlaceholder:e.jsx(Oe,{size:16}),frontAvtSrc:e.jsx($e,{chainConfig:n,size:me.Size20}),size:me.Size32,frontSquared:!0}),e.jsxs("div",{className:q.titleContainer,children:[e.jsx(N.Text,{level:"2",bold:!0,className:q.tokenName,children:s==null?void 0:s.symbol}),e.jsx(N.Text,{level:"3",intent:I.Secondary,className:q.tokenName,children:s==null?void 0:s.name})]}),e.jsx(N.Text,{level:"3",bold:!0,className:q.price,intent:I.Secondary,children:r})]})},Aa=({handleNext:s,tokenList:a,isFetching:n})=>{const t=Fe(),r=()=>{t(De.RECEIVE),fe.sendEvent(ge.Click,je.Send,Me.ClickToDeposit)},i=S.isEmpty(a);return n?e.jsx(Ye,{}):e.jsxs(w.Fragment,{children:[e.jsx("div",{className:Ie.tokenList,children:e.jsx(T,{when:!i,children:a==null?void 0:a.map(c=>e.jsx(Na,{token:c,handleNext:s},(c==null?void 0:c.contractAddress)+(c==null?void 0:c.decimals)+(c==null?void 0:c.price)+(c==null?void 0:c.chainId)))})}),e.jsx(T,{when:i,children:e.jsx(bs,{icon:"ðŸ’°",message:j.transfer.notTokenMessage,label:j.transfer.notTokenTitle,onClickButton:r,button:j.common.receive,className:Ie.emptyState})})]})},Ca=({handleRefecth:s,isFetching:a})=>a?e.jsx(es,{className:K.spinner,size:16}):e.jsx(ss,{icon:Rs,onClick:s,type:"button",size:16}),va=({handleNext:s,visible:a,onClose:n})=>{var f;const{data:t}=hs(),r=he(),[i,c]=g.useState(""),[h,u]=g.useState(null),{data:x,isFetching:A}=Je(),{reloadTokens:o}=ws(),d=t==null?void 0:t.hiddenTokensList,m=(f=x==null?void 0:x.data)==null?void 0:f.filter(l=>{var $,D,v,R,M,P;if(!S.isNil(h)&&(l==null?void 0:l.chainId)!==h)return!1;const B=i==null?void 0:i.toLowerCase(),_=(D=($=l==null?void 0:l.name)==null?void 0:$.toLowerCase())==null?void 0:D.includes(B),b=(R=(v=l==null?void 0:l.symbol)==null?void 0:v.toLowerCase())==null?void 0:R.includes(B),F=(l==null?void 0:l.balance)&&(l==null?void 0:l.balance)!=="0",L=!((P=d[r])!=null&&P.includes(`${(M=l==null?void 0:l.name)==null?void 0:M.toLowerCase()}${l==null?void 0:l.chainId}`));return(_||b)&&F&&L});return e.jsx(ke,{open:a,onClose:n,title:j.transfer.selectToken,leftHeader:e.jsx(Ca,{handleRefecth:o,isFetching:A}),push:!1,children:e.jsxs("div",{className:K.container,children:[e.jsxs("div",{className:K.actions,children:[e.jsx(ze,{placeholder:j.common.search,prefixIcon:e.jsx(Bs,{}),onChange:l=>c(l.target.value),shape:se.Default,size:js.Small}),e.jsx(Is,{selectedChainId:h,onSelectedChain:u,triggerClassName:K.networkSelectTrigger})]}),e.jsx("div",{className:K.tokenList,children:e.jsx(Aa,{handleNext:s,tokenList:m,isFetching:A})})]})})},Ta="_container_etjnn_1",Sa="_tokenRow_etjnn_11",ba="_balanceRow_etjnn_18",Ia="_numericalAmountInput_etjnn_31",wa="_displayValue_etjnn_40",Ba="_unit_etjnn_49",G={container:Ta,tokenRow:Sa,balanceRow:ba,numericalAmountInput:Ia,displayValue:wa,unit:Ba},Ra=s=>typeof s=="string"&&S.isEmpty(s)||S.isNil(s)||isNaN(Number(s))?"":Number(s),Ea=()=>{const{tokenAddress:s,chainId:a}=W(),n=ee(a),t=He(s,a,n),r=Pe(n,t==null?void 0:t.chainId),i=he(),{currentExchangeRate:c}=Be(),h=t==null?void 0:t.decimal,u=X((t==null?void 0:t.usdPrice)||"0",c),{data:x}=We({enabled:!!i&&!!t,transferType:"token"});return{calculateMaxAmount:g.useCallback(async()=>{if(S.isEmpty(t==null?void 0:t.balance)||!r||!i)return null;try{const o=await r.calculateMaxAmount({token:t,balance:t==null?void 0:t.balance,chainId:t.chainId,feeEstimate:x});if(!o)return null;const d=J(o.rawAmount,h),m=X(d||"0",u||0);return{rawAmount:o.rawAmount,numericAmount:d,currencyAmount:m,estimatedFee:o.estimatedFee,feeDetails:o.feeDetails}}catch(o){return console.error("[useCalculateMaxAmount] Error calculating max amount:",o),null}},[r,t,h,u,i,x])}},Fa=({initialNumericAmount:s,token:a,setRawAmount:n,missingInfo:t,tokenDecimals:r,feeAmount:i})=>{const{setTokenAddress:c,setChainId:h,setTokenSymbol:u,tokenAddress:x,chainId:A}=W(),{currentExchangeRate:o,currency:d}=Be(),m=he(),[f,l]=g.useState(pe.TOKEN),[B,_]=g.useState(!1),b=X((a==null?void 0:a.usdPrice)||"0",o),F=Ra(s),L=X(F,b||"0"),$=ve({tokenAddress:x,chainId:A}),[D,v]=g.useState(F),[R,M]=g.useState(L),{calculateMaxAmount:P}=Ea(),E=f===pe.TOKEN,y=E?D:R||"",C=p=>{const Q=ve({tokenAddress:p==null?void 0:p.contractAddress,chainId:p==null?void 0:p.chainId});$!==Q&&(c(p==null?void 0:p.contractAddress),h(p==null?void 0:p.chainId),u(p==null?void 0:p.symbol)),fe.sendEvent(ge.Click,je.Send,Me.SelectToken,{action_properties:{type:ls.ERC20,item:p}}),_(!1)},z=p=>{if(t)return;const Q=E?p:new is(p||"0").div(b||"1").toFixed(),Ge=E?X(p||"0",b||"0"):p;v(Q),M(Ge);const Ae=as(Q,r);if(!O(Ae)){n(void 0);return}n(Ae)},Z=async()=>{try{const p=await P();if(!p)return;n(p.rawAmount),v(p.numericAmount),M(p.currencyAmount)}catch(p){console.error("[TokenForm] Failed to calculate max amount:",p)}},te=E?d==null?void 0:d.toUpperCase():a==null?void 0:a.symbol;return E?a==null||a.symbol:d==null||d.toUpperCase(),e.jsxs("div",{className:G.container,children:[e.jsxs("div",{className:G.tokenRow,children:[e.jsx(oa,{token:a,onClick:()=>_(!0)}),e.jsx(ks,{token:a,handleClickMax:Z,disableMax:!m||U(a==null?void 0:a.address)&&!i})]}),e.jsxs("div",{className:G.balanceRow,children:[e.jsx(ca,{amountToDisplay:y,handleChangeInput:z,displayingTokenUnit:E,tokenDecimals:r,className:G.numericalAmountInput}),e.jsxs("div",{className:G.displayValue,children:[e.jsx(aa,{displayingTokenUnit:E,currencyAmount:R,numericAmount:D,setDisplayMode:l,missingInfo:t}),e.jsx(N.Text,{level:"4",color:"gray",className:G.unit,children:te})]})]}),e.jsx(va,{visible:B,onClose:()=>_(!1),handleNext:C})]})},Da=({initialNumericValue:s,normalizedToken:a,missingInfo:n,tokenDecimals:t,feeAmount:r})=>{const{tokenAddress:i,setRawAmount:c}=W();return e.jsxs("div",{className:Xs.selectToken,children:[e.jsx(N.Text,{level:"3",color:"gray",children:j.transfer.token}),e.jsx(Fa,{initialNumericAmount:s,setRawAmount:c,token:a,missingInfo:n,tokenDecimals:t,feeAmount:r},i)]})},Ma="_container_16jzj_1",za="_itemWrapper_16jzj_12",$a="_title_16jzj_20",Va="_info_16jzj_26",Y={container:Ma,itemWrapper:za,title:$a,info:Va},La=1e-9,Pa=({token:s,rawGasFee:a,isFetching:n,invalidRecipient:t})=>{var x,A,o;const r=(x=Ne(s==null?void 0:s.chainId))==null?void 0:x.chainConfig,i=(A=r==null?void 0:r.nativeToken)==null?void 0:A.symbol,c=Ee(J(a,(o=r==null?void 0:r.nativeToken)==null?void 0:o.decimals),{interpolateFractionDigits:!0,interpolateFractionDigitsBuffer:1,minimum:La,maximumFractionDigits:10}),u=!n&&!!c||t;return s?e.jsx("div",{className:Y.container,children:e.jsxs("div",{className:Y.itemWrapper,children:[e.jsxs(N.Text,{level:"3",color:"gray",className:Y.title,intent:I.Secondary,children:[e.jsx(Ds,{size:16}),j.transfer.estimateGasFee]}),e.jsx(T,{when:u,children:e.jsx(N.Text,{level:"3",className:Y.info,children:`${c||"--"} ${i}`})}),e.jsx(T,{when:!u,children:e.jsx(_s.Skeleton,{height:16,width:100,borderRadius:4})})]})}):null},Oa=({gasFee:s,token:a,nativeToken:n,fetchingGas:t})=>{const{recipient:r,rawAmount:i,chainId:c}=W(),[h,u]=g.useState(null),[x,A]=g.useState(null),o=ee(c),d=Pe(o,a==null?void 0:a.chainId),m=o===xe.SOLANA,f=new H(i),l=new H(a==null?void 0:a.balance),B=h?new H(h):null,_=j.signing.errors;if(g.useEffect(()=>{(async()=>{if(m&&d&&U(a==null?void 0:a.address))try{const v=d,R=await(v==null?void 0:v.getMinimumBalanceForRentExemption(0));u(R)}catch(v){console.error("[useValidateTransferInput] Failed to fetch min rent exemption:",v),u(null)}else u(null)})()},[m,d,a==null?void 0:a.address,a,r]),g.useEffect(()=>{(async()=>{if(m&&d&&U(a==null?void 0:a.address)){const R=await d.getTokenBalance(a,r);A(R)}})()},[m,d,a==null?void 0:a.address,a,r]),f.gt(l))return{message:_.insufficientBalance,shouldBlockNextStep:!0,intent:I.Danger};if(!(d!=null&&d.validateRecipient(r))||!O(i))return{shouldBlockNextStep:!0};if(S.isEmpty(s)&&!t)return{message:_.cannotFetchGasPrice,shouldBlockNextStep:!0,intent:I.Danger};if(!i||i=="0"||!O(i))return{message:_.invalidTokenAmount,shouldBlockNextStep:!0,intent:I.Danger};if(!O(a==null?void 0:a.balance)||!O(n==null?void 0:n.balance))return{message:_.cannotFetchBalance,shouldBlockNextStep:!0,intent:I.Danger};const b=new H(s||0),F=new H((n==null?void 0:n.balance)||0),L=f.add(b),$=F.gte(L);if(U(a==null?void 0:a.address)&&!$||F.lt(b))return{message:j.formatString(j.transfer.insufficientFunds,n==null?void 0:n.symbol).toString(),shouldBlockNextStep:!1,intent:ne.Warning};if(m&&U(a==null?void 0:a.address)&&B){if(l.lt(B.add(b)))return{message:j.formatString(_.insufficientRentExemption,Te(h,9)).toString(),shouldBlockNextStep:!1,intent:ne.Warning};if(x&&new H(x).add(f).lt(B))return{message:j.formatString(_.recipientBalanceInsufficient,Te(h,9)).toString(),shouldBlockNextStep:!1,intent:ne.Warning}}},St=()=>{var _;const{recipient:s,tokenAddress:a,chainId:n,rawAmount:t,setChainId:r}=W(),i=ee(n),c=Fe(),h=xs(),u=He(a,n,i),x=fs(),{data:A}=ts({address:(_=h==null?void 0:h.chains[i])==null?void 0:_.address,chainId:n}),{data:o,isLoading:d}=We({transferType:"token"}),m=Oa({gasFee:o==null?void 0:o.estimatedFee,fetchingGas:d,token:u,nativeToken:A}),f=!O(t)||(m==null?void 0:m.shouldBlockNextStep)||!O(o==null?void 0:o.estimatedFee),l=J(t,u==null?void 0:u.decimal),B=b=>{b.preventDefault(),c(`${De.TRANSFER_TOKEN}/${i}/${os.CONFIRM}`)};return g.useEffect(()=>{gs(xe.SOLANA,h)&&r(x)},[]),e.jsxs(re,{noBackground:!0,noFooter:!0,children:[e.jsx(re.BackableNavbar,{title:j.common.send}),e.jsx(re.Content,{noPadding:!0,children:e.jsxs("form",{autoComplete:"off",onSubmit:B,children:[e.jsxs("div",{className:Se.container,children:[e.jsx(Ls,{account:h}),e.jsx(Us,{address:s,blockchain:i}),e.jsx(Da,{initialNumericValue:l,normalizedToken:u,missingInfo:!1,tokenDecimals:u==null?void 0:u.decimal,errors:void 0,feeAmount:o==null?void 0:o.estimatedFee}),e.jsx(T,{when:!S.isEmpty(m==null?void 0:m.message),children:e.jsx(de,{intent:(m==null?void 0:m.intent)||I.Danger,className:Se.helperText,children:m==null?void 0:m.message})}),e.jsx(Pa,{rawGasFee:o==null?void 0:o.estimatedFee,token:u,invalidRecipient:!1,isFetching:d})]}),e.jsx(ns,{children:e.jsx(ae,{text:j.common.next,fullWidth:!0,type:"submit",disabled:f,intent:I.Primary})})]})})]})};export{St as default};
