import{j as r}from"./useTriggerLoadNext.KJIKMCqU.js";import{r as i}from"./index.CxJLds0B.js";import{r as M,B as C,x as _,P as B,a as b,C as N,l as O,Q as P,d as H}from"./windowUtils.Ut7JS-rc.js";import{k as U,l as D,L as p,m as V,n as W,H as $}from"./PopupLoading.D-LitESe.js";import{u as q}from"./useDebouncedValue.BgjK-DBz.js";import{T as z,F as Q}from"./TransferTitle.DcO0V0Yy.js";import{L as y}from"./enum.CGJbW6Yf.js";import{u as Y}from"./useEstimateFee.mvOlF2u1.js";import{u as G}from"./useNormalizeToken.C6igk56m.js";import{u as J}from"./useTransferAdapter.DBEESo_0.js";import{e as K,i as X,u as Z,W as aa}from"./useActiveTimeStore.C3Wei7Oz.js";import{u as sa,a as ra}from"./useTempStore.C8dvVNTz.js";import{i as ea}from"./solana.CGFphaJI.js";import{I as ta}from"./PasswordLevelLabel.rhWNhrqO.js";import"./tiny-invariant.BHpmfUqq.js";import"./preload-helper.2LWRYvkK.js";import"./useNormalizeToken.CRab6WQg.js";import"./useNftCollectionItems.DtJWVrNT.js";import"./useNftCollectionList.0TiOOKoB.js";import"./useSearchErc20Tokens.D0zoSI7L.js";import"./token.types.DkObBlUj.js";import"./associatedTokenAccount.Cs_dSOLN.js";import"./useDebouncedEffect.CslCnlPq.js";const oa="_container_1honm_1",na="_errMsg_1honm_8",I={container:oa,errMsg:na},Ea=()=>{const c=M(),l=K(),t=l==null?void 0:l.chains.solana.address,{chainId:s,recipient:e,rawAmount:m,tokenAddress:v,reset:d}=q(),w=X(s),[g,j]=i.useState(),T=J(w,s),a=G(v,s,C.SOLANA),{addCurrentReceiver:h,setActivityChainConfigId:x}=Z(),{isFetching:k}=Y(),{setPendingSignTx:u}=U(),{setActivityChanged:S}=sa(),{reloadActivity:A}=ra(),[o,R]=i.useState(),E=D({transaction:o,chainId:s,enabled:ea(o),sender:t});i.useEffect(()=>{if(!a||!t||!e)return;(async()=>{try{const f=await T.buildTransferTx({from:t,to:e,token:a,amount:m,chainId:s});R(f)}catch(f){y.error("[SOLTokenConfirmPage] Failed to build transaction:",f)}})()},[t,e,m,s,a,T]);const L=i.useCallback(async(n=!1)=>{await h(e),a!=null&&a.chainId&&await x(a==null?void 0:a.chainId),d(),n||(await u(void 0),await A(),await S(),c(`${_.HOME}${B.ACTIVITY}`))},[h,e,x,a==null?void 0:a.chainId,d,u,A,S,c]),F=async()=>{try{await u({status:"pending",payload:{txRequest:P(o),receiverAddress:e,token:a,rawAmount:m,blockchain:C.SOLANA,chainId:s}}),await H(300),await L()}catch(n){y.error("[handleConfirm] error: ",n)}};return r.jsxs(p,{noBackground:!0,noFooter:!0,children:[r.jsx(p.BackableNavbar,{title:b.signing.previewTransaction,callback:()=>{c(-1),d()}}),r.jsxs(p.Content,{className:I.container,children:[r.jsx(z,{title:b.transfer.transferTitle,logoUrl:N.RoninLogoIcon}),r.jsx(V,{chainId:s,simulateResult:E,url:"",isBlockAid:!1}),r.jsx(W,{transaction:o,chainId:s,sender:t,recipient:e,setErrorMessage:j}),r.jsx(aa,{when:!O.isEmpty(g),children:r.jsx($,{intent:ta.Danger,className:I.errMsg,children:g})}),r.jsx(Q,{isLoading:k,shouldDisableConfirm:!1,onClickConfirm:F})]})]})};export{Ea as default};
