import{j as e}from"./useTriggerLoadNext.KJIKMCqU.js";import{a as d,af as A,ag as T,z as C,l as w,a7 as y,ah as W,r as $,x as P,ad as O}from"./windowUtils.Ut7JS-rc.js";import{u as L,a as M}from"./useNormalizeToken.CRab6WQg.js";import{V as U,W as V,p as X,F as q,s as Z,q as J,D as K,X as Q,L as v,H as Y,B as k}from"./PopupLoading.D-LitESe.js";import{r as S}from"./index.CxJLds0B.js";import{T as N,I as l,S as ee,B as R,d as se}from"./PasswordLevelLabel.rhWNhrqO.js";import{B as ae,a as te,b as ne,A as re,k as ie,N as oe,e as le,i as ce}from"./useActiveTimeStore.C3Wei7Oz.js";import{t as ue}from"./Wallet.DbLc7VEl.js";import{t as de}from"./DefaultNftImg.D-qRFvZ2.js";import"./tiny-invariant.BHpmfUqq.js";import"./enum.CGJbW6Yf.js";import"./preload-helper.2LWRYvkK.js";import"./useNftCollectionItems.DtJWVrNT.js";import"./useNftCollectionList.0TiOOKoB.js";import"./useSearchErc20Tokens.D0zoSI7L.js";import"./token.types.DkObBlUj.js";import"./solana.CGFphaJI.js";import"./useDebouncedEffect.CslCnlPq.js";const me="_helperText_1oxh3_1",pe="_styledHr_1oxh3_5",F={helperText:me,styledHr:pe},xe="_container_wglth_1",he="_amountInput_wglth_19",Ne="_inputWrapperOverrride_wglth_25",fe="_suffix_wglth_29",_e="_typo_wglth_37",je="_btn_wglth_43",j={container:xe,amountInput:he,inputWrapperOverrride:Ne,suffix:fe,typo:_e,btn:je},ge=({handleChangeAmount:s,nft:i,amount:p})=>{const a=()=>{s(i==null?void 0:i.balance)};return e.jsxs("div",{className:j.container,children:[e.jsx(N.Text,{level:"3",intent:l.Secondary,children:d.transfer.amount}),e.jsx("div",{className:j.amountInput,children:e.jsx(U,{placeholder:"0",autoFocus:!0,shape:ee.Rounded,value:p,onChange:s,inputWrapperClassName:j.inputWrapperOverrride,maxDecimalLength:0,suffixIcon:e.jsxs("div",{className:j.suffix,children:[e.jsx(N.Text,{level:"2",intent:l.Secondary,className:j.typo,children:i==null?void 0:i.name}),e.jsx(R,{className:j.btn,text:d.common.max,type:"button",size:ae.XXSmall,intent:l.Secondary,onClick:a})]})})})]})},be="_container_fhpbj_1",ye="_itemWrapper_fhpbj_7",Se="_title_fhpbj_15",Be="_info_fhpbj_21",ve="_styledHr_fhpbj_30",x={container:be,itemWrapper:ye,title:Se,info:Be,styledHr:ve},Fe=({token:s,isNft:i,rawGasFee:p,isFetching:a})=>{var n,c,h;const u=(n=te(s==null?void 0:s.chainId))==null?void 0:n.chainConfig,o=(c=u==null?void 0:u.nativeToken)==null?void 0:c.symbol,f=A(T(p,(h=u==null?void 0:u.nativeToken)==null?void 0:h.decimals),{interpolateFractionDigits:!0,interpolateFractionDigitsBuffer:1}),m=i?s==null?void 0:s.balance:A(T(s==null?void 0:s.balance,s==null?void 0:s.decimal)),_=!f;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:x.container,children:[e.jsxs("div",{className:x.itemWrapper,children:[e.jsxs(N.Text,{level:"3",bold:!0,className:x.title,intent:l.Secondary,children:[i?e.jsx(V,{img:s==null?void 0:s.logoUrl,size:ne.Size20,squared:!0}):e.jsx(ue,{size:20}),d.transfer.yourBalance]}),e.jsxs(N.Text,{level:"3",bold:!0,className:x.info,children:[!i&&"≈"," ",m||"--"," ",i?s==null?void 0:s.name:s==null?void 0:s.symbol]})]}),e.jsxs("div",{className:x.itemWrapper,children:[e.jsxs(N.Text,{level:"3",bold:!0,className:x.title,intent:l.Secondary,children:[e.jsx(de,{size:20}),d.transfer.estimateNetworkFee]}),!a&&!_?e.jsxs(N.Text,{level:"3",bold:!0,className:x.info,children:["≈ ",`${f} ${o}`]}):e.jsx(se.Skeleton,{height:24,width:100,borderRadius:12})]})]}),e.jsx("div",{className:x.styledHr})]})},Ie="_tokenInfoWrapper_6z6ox_1",Ae={tokenInfoWrapper:Ie},Te=({receiver:s})=>e.jsxs("div",{className:Ae.tokenInfoWrapper,children:[e.jsx(re,{size:ie.M,seed:s}),e.jsxs("div",{className:"",children:[e.jsx(N.Text,{level:"3",intent:l.Secondary,children:d.transfer.sendTo}),e.jsx(oe,{address:s,includeWalletName:!0,suffix:`(${C(s)})`})]})]}),we=({initialRawValue:s,sender:i,receiver:p,nft:a,handleNext:u})=>{const[o,f]=S.useState(w.isEmpty(s)?"":s),[m,_]=S.useState(!1),[n,c]=S.useState(void 0),{reset:h}=X(),{errors:t}=d.signing,{data:r}=q({chainId:a==null?void 0:a.chainId,address:i}),{data:D,isFetching:B}=Z(i,p,a,"1"),E=J(a==null?void 0:a.chainId),g=K(D,E),I=w.isEmpty(o)||!y(o)||(n==null?void 0:n.shouldBlockNextStep)||!y(g),G=b=>{f(b),_(!0)},H=b=>{b.preventDefault(),!I&&(u(o),h())};return S.useEffect(()=>{if(!m&&!o)return;if(!g&&!B)return c({message:t.cannotFetchGasPrice,shouldBlockNextStep:!0,intent:l.Danger});if(!o||o==="0"||!y(o))return c({message:t.invalidTokenAmount,shouldBlockNextStep:!0,intent:l.Danger});if(!y(a==null?void 0:a.balance))return c({message:t.cannotFetchBalance,shouldBlockNextStep:!0,intent:l.Danger});if(!y(r==null?void 0:r.balance))return c({message:t.cannotFetchBalance,shouldBlockNextStep:!0,intent:l.Danger});const b=new W.BN(g||0),z=new W.BN((r==null?void 0:r.balance)||0);return Number(o)>Number(a==null?void 0:a.balance)?c({message:t.insufficientBalance,shouldBlockNextStep:!0,intent:l.Danger}):z.lt(b)?c({message:d.formatString(d.transfer.insufficientFunds,r==null?void 0:r.symbol).toString(),shouldBlockNextStep:!1,intent:Q.Warning}):c(void 0)},[B,g,m,r==null?void 0:r.balance,r==null?void 0:r.decimals,r==null?void 0:r.symbol,o,a==null?void 0:a.balance,t==null?void 0:t.cannotFetchGasPrice,t==null?void 0:t.cannotFetchBalance,t==null?void 0:t.insufficientBalance,t==null?void 0:t.invalidTokenAmount]),e.jsxs(v,{noFooter:!0,noBackground:!0,children:[e.jsx(v.BackableNavbar,{title:d.transfer.amount,noBackground:!0}),e.jsx(v.Content,{children:e.jsxs("form",{onSubmit:H,children:[e.jsx(Te,{receiver:p}),e.jsx("div",{className:F.styledHr}),e.jsx(ge,{nft:a,handleChangeAmount:G,amount:o}),e.jsx(Fe,{token:a,isNft:!0,rawGasFee:g,isFetching:B}),e.jsx("div",{className:F.styledHr}),(n==null?void 0:n.message)&&e.jsx(Y,{intent:(n==null?void 0:n.intent)||l.Danger,className:F.helperText,children:n==null?void 0:n.message}),e.jsx(k,{children:e.jsx(R,{type:"submit",text:d.common.next,fullWidth:!0,disabled:I,intent:l.Primary})})]})})]})},Je=()=>{var h;const s=$(),{chainId:i,collectionAddress:p,tokenId:a,recipient:u,setRawAmount:o,rawAmount:f}=L(),m=le(),_=ce(i),n=M({collectionAddress:p,chainId:i,tokenId:a});if(!n)return null;const c=t=>{o(t),s(`${P.TRANSFER_NFT}/${_}/${O.CONFIRM}`)};return e.jsx(we,{initialRawValue:f,receiver:u,handleNext:c,nft:n,sender:(h=m==null?void 0:m.chains[_])==null?void 0:h.address})};export{Je as default};
