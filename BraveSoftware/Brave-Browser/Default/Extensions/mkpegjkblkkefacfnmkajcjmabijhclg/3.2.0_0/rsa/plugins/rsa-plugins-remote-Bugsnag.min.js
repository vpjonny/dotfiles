import{k as e,p as r,s as t}from"./rsa-plugins-common.min.js";const n="bugsnag",a=["Bugsnag",n],o="0d96a60df267f4a13f808bbaa54e535c",s=["www.test-host.com","localhost","127.0.0.1","[::1]"],i=["userId","userTraits","groupId","groupTraits","anonymousId","config","instance","eventBuffer","traits"],l="BugsnagPlugin",u=(e,r)=>{var n;r.updateMetaData("source",{snippetVersion:globalThis.RudderSnippetVersion}),r.updateMetaData("state",null!==(n=(e=>{const r=t(e,!1,i);return null!==r?JSON.parse(r):void 0})(e))&&void 0!==n?n:{});const{errorMessage:a}=r;r.context=a,a.includes("error in script loading")&&(r.context="Script load failures"),r.severity="error"},d=(t,n)=>a=>{try{return!!(e=>{var t;const n=null===(t=e.stacktrace)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.file;if(!n||"string"!=typeof n)return!1;const a=n.includes(r),o=n.substring(n.lastIndexOf("/")+1);return a||["rsa"].some((e=>o.startsWith(e)&&o.endsWith(".js")))})(a)&&(u(t,a),!0)}catch(r){return null==n||n.error(`${l}${e}Failed to filter the error.`),!1}},c=()=>{const e=globalThis.location.hostname;return e&&s.includes(e)?"development":"production"},g=()=>globalThis[n],v=(r,t)=>{a.every((e=>!globalThis[e]))&&r.loadJSFile({url:"https://d2wy8f7a9ursnm.cloudfront.net/v6/bugsnag.min.js",id:"rs-bugsnag",callback:r=>{r||null==t||t.error(`${l}${e}Failed to load the Bugsnag SDK.`)}})},p=(e,r,t,n,a=0)=>{const s=g();if("function"==typeof s){if((e=>{var r;let t=null==e||null===(r=e._client)||void 0===r||null===(r=r._notifier)||void 0===r?void 0:r.version;var n;t||(t=null===(n=e({apiKey:o,releaseStage:"version-test",beforeSend:function(){return!1}}).notifier)||void 0===n?void 0:n.version);return t&&"6"===t.charAt(0)})(s)){const t=((e,r)=>{var t;return g()({apiKey:o,appVersion:e.context.app.value.version,metaData:{SDK:{name:"JS",installType:e.context.app.value.installType}},beforeSend:d(e,r),autoCaptureSessions:!1,collectUserIp:!1,maxEvents:100,maxBreadcrumbs:40,releaseStage:c(),user:{id:(null===(t=e.source.value)||void 0===t?void 0:t.id)||e.lifecycle.writeKey.value},logger:r,networkBreadcrumbsEnabled:!1})})(e,n);r(t)}}else a>=1e4?t(new Error(`A timeout ${1e4} ms occurred while trying to load the Bugsnag SDK.`)):globalThis.setTimeout(p,100,e,r,t,n,a+100)},f="Bugsnag",m=()=>({name:f,deps:[],initialize:e=>{e.plugins.loadedPlugins.value=[...e.plugins.loadedPlugins.value,f]},errorReportingProvider:{init:(e,r,t)=>new Promise(((n,a)=>{var s;(s=o).startsWith("{{")||s.endsWith("}}")||0===s.length?a(new Error((e=>`The Bugsnag API key (${e}) is invalid or not provided.`)(o))):(v(r,t),p(e,n,a,t))})),notify:(e,r,t,n)=>{e.notify(r)},breadcrumb:(e,r,t)=>{null==e||e.leaveBreadcrumb(r)}}});export{m as Bugsnag,m as default};
//# sourceMappingURL=rsa-plugins-remote-Bugsnag.min.js.map
