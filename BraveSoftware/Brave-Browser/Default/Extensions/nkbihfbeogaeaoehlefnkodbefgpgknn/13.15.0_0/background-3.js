LavaPack.loadBundle([[3079,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;Object.defineProperty(n,"__esModule",{value:!0}),n.DEPRECATED_NETWORKS=n.INFURA_BLOCKED_KEY=n.NetworkStatus=void 0,function(e){e.Unknown="unknown",e.Available="available",e.Degraded="degraded",e.Unavailable="unavailable",e.Blocked="blocked"}(r||(n.NetworkStatus=r={})),n.INFURA_BLOCKED_KEY="countryBlocked",n.DEPRECATED_NETWORKS=new Set(["0xe704","0x5"])}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/constants.cjs"}],[308,{"../../../../shared/constants/app":5775,"../../../../shared/constants/security-provider":5803,"../../../../shared/constants/transaction":5814,"../../../../shared/lib/snaps/snaps":5892,"../../../../shared/modules/transaction.utils":5947,"../../../../shared/modules/typed-signature":5948,"./security-alerts-api":310,"@metamask/snaps-utils":2903,"@metamask/transaction-controller":2994,"@metamask/utils":3116,lodash:4838,uuid:5734},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.generateSecurityAlertId=function(){return(0,i.v4)()},n.handlePPOMError=v,n.normalizeSignatureRequest=w,n.updateSecurityAlertResponse=async function({appStateController:e,messenger:t,method:n,securityAlertId:r,securityAlertResponse:a,signatureController:i,transactionController:s}){if(u.SIGNING_METHODS.includes(n)){const n=await async function(e,t,n){const r=e=>Object.values(e.signatureRequests).find(e=>{var n;return(null===(n=e.securityAlertResponse)||void 0===n?void 0:n.securityAlertId)===t});return new Promise(a=>{const i=r(e.state);if(i)return void a(i);const s=e=>{const t=r(e);t&&(f("Found signature request",t),n.unsubscribe("SignatureController:stateChange",s),a(t))};f("Waiting for signature request",t),n.subscribe("SignatureController:stateChange",s)})}(i,r,t);return e.addSignatureSecurityAlertResponse({...a,securityAlertId:r}),n}const o=await async function(e,t,n){const r=e=>{var n;return(null===(n=e.securityAlertResponse)||void 0===n?void 0:n.securityAlertId)===t};return new Promise(a=>{const i=e.state.transactions.find(r);if(i)return void a(i);const s=e=>{r(e)&&(f("Found transaction metadata",e),n.unsubscribe("TransactionController:unapprovedTransactionAdded",s),a(e))};f("Waiting for transaction metadata",t),n.subscribe("TransactionController:unapprovedTransactionAdded",s)})}(s,r,t);return s.updateSecurityAlertResponse(o.id,{...a,securityAlertId:r}),o},n.validateRequestWithPPOM=async function({ppomController:e,request:t,securityAlertId:n,chainId:a,updateSecurityAlertResponse:i,getSecurityAlertsConfig:o}){try{const l=function(e,t){let n=(0,s.cloneDeep)(e);n=w(n,t),n=function(e,t){if(e.method!==m.MESSAGE_TYPE.ETH_SEND_TRANSACTION)return e;if(!Array.isArray(e.params)||!e.params[0])return e;const n=e.params[0];n.gas=t.txParams.gas,n.gasPrice=t.txParams.maxFeePerGas??t.txParams.gasPrice,delete n.gasLimit,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas,delete n.type;const a=(0,r.normalizeTransactionParams)(n);return f("Normalized transaction params",a),{...e,params:[a]}}(n,t);const{delegationMock:a,id:i,jsonrpc:o,method:c,origin:l,params:u}=n;return{delegationMock:a,id:i,jsonrpc:o,method:c,origin:l,params:u}}(t,await i(t.method,n,c.LOADING_SECURITY_ALERT_RESPONSE));f("Normalized request",l);const u=(0,h.isSecurityAlertsAPIEnabled)()?await async function(e,t,n,r){try{return{...await(0,h.validateWithSecurityAlertsAPI)(t,n,r),source:c.SecurityAlertSource.API}}catch(r){return v(r,"Error validating request with security alerts API"),await b(e,n,t)}}(e,a,l,o):await b(e,l,a);await i(t.method,n,u)}catch(e){f("Error",e),await i(t.method,n,v(e,"Error validating JSON RPC using PPOM: "))}};var r=e("@metamask/transaction-controller"),a=e("@metamask/utils"),i=e("uuid"),s=e("lodash"),o=e("@metamask/snaps-utils"),c=e("../../../../shared/constants/security-provider"),l=e("../../../../shared/lib/snaps/snaps"),u=e("../../../../shared/constants/transaction"),d=e("../../../../shared/modules/typed-signature"),p=e("../../../../shared/modules/transaction.utils"),m=e("../../../../shared/constants/app"),h=e("./security-alerts-api");const f=(0,a.createProjectLogger)("ppom-util"),{sentry:g}=global,y={result_type:c.BlockaidResultType.Errored,reason:c.BlockaidReason.errored};function v(e,t,n=c.SecurityAlertSource.API){const r=function(e){if("object"==typeof e||"string"==typeof e)return e;return JSON.stringify(e)}(e),a=function(e){if(e instanceof Error)return`${e.name}: ${e.message}`;return JSON.stringify(e)}(e);return n===c.SecurityAlertSource.Local&&(null==g||g.captureException(e)),console.error(t,r),{...y,description:a,source:n}}function w(e,t){var n;if(e.method!==m.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3&&e.method!==m.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4)return e;if(!Array.isArray(e.params)||!e.params[1])return e;const r=(0,p.parseTypedDataMessage)(e.params[1]),a=(0,d.sanitizeMessageRecursively)(r.message,r.types,r.primaryType);let i=e.origin;if(t&&"decodedPermission"in t&&null!==(n=t.decodedPermission)&&void 0!==n&&n.origin){const n=(0,o.isSnapId)(e.origin),r=n&&(0,l.isSnapPreinstalled)(e.origin);n&&r&&(i=t.decodedPermission.origin)}return{...e,origin:i,params:[e.params[0],JSON.stringify({...r,message:a})]}}async function b(e,t,n){try{return{...await e.usePPOM(e=>e.validateJsonRpc(t),n),source:c.SecurityAlertSource.Local}}catch(e){return v(e,"Error validating request with PPOM controller",c.SecurityAlertSource.Local)}}}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom-util.ts"}],[3080,{"./create-network-client.cjs":3081},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createAutoManagedNetworkClient=void 0;const r=e("./create-network-client.cjs"),a="__target__",i={__UNINITIALIZED__:!0};n.createAutoManagedNetworkClient=function({networkClientId:e,networkClientConfiguration:t,getRpcServiceOptions:n,getBlockTrackerOptions:s=()=>({}),messenger:o,isRpcFailoverEnabled:c,logger:l}){let u,d=c;const p=()=>{if(u??(u=(0,r.createNetworkClient)({id:e,configuration:t,getRpcServiceOptions:n,getBlockTrackerOptions:s,messenger:o,isRpcFailoverEnabled:d,logger:l})),u===undefined)throw new Error("It looks like `createNetworkClient` didn't return anything. Perhaps it's being mocked?");return u},m=new Proxy(i,{get(e,t,n){if(t===a)return u?.provider;const{provider:r}=p();if(t in r){const e=r[t];return"function"==typeof e?function(...t){return e.apply(this===n?r:this,t)}:e}return undefined},has(e,t){if(t===a)return!0;const{provider:n}=p();return t in n}}),h=new Proxy(i,{get(e,t,n){if(t===a)return u?.blockTracker;const{blockTracker:r}=p();if(t in r){const e=r[t];return"function"==typeof e?function(...t){return e.apply(this===n?r:this,t)}:e}return undefined},has(e,t){if(t===a)return!0;const{blockTracker:n}=p();return t in n}}),f=()=>{u?.destroy()};return{configuration:t,provider:m,blockTracker:h,destroy:f,enableRpcFailover:()=>{d=!0,f(),u=undefined},disableRpcFailover:()=>{d=!1,f(),u=undefined}}}}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/create-auto-managed-network-client.cjs"}],[3081,{"./rpc-service/rpc-service-chain.cjs":3084,"./types.cjs":3086,"@metamask/controller-utils":1449,"@metamask/eth-block-tracker":1858,"@metamask/eth-json-rpc-infura":1874,"@metamask/eth-json-rpc-middleware":1885,"@metamask/eth-json-rpc-provider":1899,"@metamask/json-rpc-engine":2109,"@metamask/json-rpc-engine/v2":2119},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createNetworkClient=void 0;const r=e("@metamask/controller-utils"),a=e("@metamask/eth-block-tracker"),i=e("@metamask/eth-json-rpc-infura"),s=e("@metamask/eth-json-rpc-middleware"),o=e("@metamask/eth-json-rpc-provider"),c=e("@metamask/eth-json-rpc-provider"),l=e("@metamask/json-rpc-engine"),u=e("@metamask/json-rpc-engine/v2"),d=e("./rpc-service/rpc-service-chain.cjs"),p=e("./types.cjs");function m({network:e}){return(0,u.createScaffoldMiddleware)({eth_chainId:r.ChainId[e]})}n.createNetworkClient=function({id:e,configuration:t,getRpcServiceOptions:n,getBlockTrackerOptions:r,messenger:f,isRpcFailoverEnabled:g,logger:y}){const v=t.type===p.NetworkClientType.Infura?`https://${t.network}.infura.io/v3/${t.infuraProjectId}`:t.rpcUrl,w=function({id:e,primaryEndpointUrl:t,configuration:n,getRpcServiceOptions:r,messenger:a,isRpcFailoverEnabled:i,logger:s}){const o=i?[t,...n.failoverRpcUrls??[]]:[t],c=o.map(e=>({...r(e),endpointUrl:e,logger:s})),l=e=>"error"in e?e.error:"value"in e?e.value:undefined,u=new d.RpcServiceChain([c[0],...c.slice(1)]);return u.onBreak(t=>{const r=l(t);if(r===undefined)throw new Error("Could not make request to endpoint.");a.publish("NetworkController:rpcEndpointChainUnavailable",{chainId:n.chainId,networkClientId:e,error:r})}),u.onServiceBreak(({endpointUrl:t,primaryEndpointUrl:r,...i})=>{const s=l(i);if(s===undefined)throw new Error("Could not make request to endpoint.");a.publish("NetworkController:rpcEndpointUnavailable",{chainId:n.chainId,networkClientId:e,primaryEndpointUrl:r,endpointUrl:t,error:s})}),u.onDegraded(t=>{const r=l(t);a.publish("NetworkController:rpcEndpointChainDegraded",{chainId:n.chainId,networkClientId:e,error:r})}),u.onServiceDegraded(({endpointUrl:t,primaryEndpointUrl:r,...i})=>{const s=l(i);a.publish("NetworkController:rpcEndpointDegraded",{chainId:n.chainId,networkClientId:e,primaryEndpointUrl:r,endpointUrl:t,error:s})}),u.onAvailable(()=>{a.publish("NetworkController:rpcEndpointChainAvailable",{chainId:n.chainId,networkClientId:e})}),u.onServiceRetry(({attempt:t,endpointUrl:r,primaryEndpointUrl:i})=>{a.publish("NetworkController:rpcEndpointRetried",{chainId:n.chainId,networkClientId:e,primaryEndpointUrl:i,endpointUrl:r,attempt:t})}),u}({id:e,primaryEndpointUrl:v,configuration:t,getRpcServiceOptions:n,messenger:f,isRpcFailoverEnabled:g,logger:y});let b;b=t.type===p.NetworkClientType.Infura?(0,l.asV2Middleware)((0,i.createInfuraMiddleware)({rpcService:w,options:{source:"metamask"}})):(0,s.createFetchMiddleware)({rpcService:w});const T=(0,c.providerFromMiddlewareV2)(b),k=function({networkClientType:e,endpointUrl:t,getOptions:n,provider:r}){const i={};return new a.PollingBlockTracker({...i,...n(t),provider:r})}({networkClientType:t.type,endpointUrl:v,getOptions:r,provider:T}),_=t.type===p.NetworkClientType.Infura?function({blockTracker:e,network:t,rpcProvider:n,rpcApiMiddleware:r}){return u.JsonRpcEngineV2.create({middleware:[m({network:t}),(0,s.createBlockCacheMiddleware)({blockTracker:e}),(0,s.createInflightCacheMiddleware)(),(0,s.createBlockRefMiddleware)({blockTracker:e,provider:n}),(0,s.createRetryOnEmptyMiddleware)({blockTracker:e,provider:n}),(0,s.createBlockTrackerInspectorMiddleware)({blockTracker:e}),r]}).asMiddleware()}({blockTracker:k,network:t.network,rpcProvider:T,rpcApiMiddleware:b}):function({blockTracker:e,chainId:t,rpcApiMiddleware:n}){const r=[];return u.JsonRpcEngineV2.create({middleware:[...r,h(t),(0,s.createBlockRefRewriteMiddleware)({blockTracker:e}),(0,s.createBlockCacheMiddleware)({blockTracker:e}),(0,s.createInflightCacheMiddleware)(),(0,s.createBlockTrackerInspectorMiddleware)({blockTracker:e}),n]}).asMiddleware()}({blockTracker:k,chainId:t.chainId,rpcApiMiddleware:b});return{configuration:t,provider:new o.InternalProvider({engine:u.JsonRpcEngineV2.create({middleware:[_]})}),blockTracker:k,destroy:()=>{k.destroy()}}};const h=e=>({request:t,next:n})=>"eth_chainId"===t.method?e:n()}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/create-network-client.cjs"}],[3082,{"./NetworkController.cjs":3078,"./constants.cjs":3079,"./rpc-service/rpc-service.cjs":3085,"./types.cjs":3086},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.isConnectionError=n.NetworkClientType=n.RpcEndpointType=n.NetworkController=n.knownKeysOf=n.selectAvailableNetworkClientIds=n.getDefaultNetworkControllerState=void 0;var i=e("./NetworkController.cjs");Object.defineProperty(n,"getDefaultNetworkControllerState",{enumerable:!0,get:function(){return i.getDefaultNetworkControllerState}}),Object.defineProperty(n,"selectAvailableNetworkClientIds",{enumerable:!0,get:function(){return i.selectAvailableNetworkClientIds}}),Object.defineProperty(n,"knownKeysOf",{enumerable:!0,get:function(){return i.knownKeysOf}}),Object.defineProperty(n,"NetworkController",{enumerable:!0,get:function(){return i.NetworkController}}),Object.defineProperty(n,"RpcEndpointType",{enumerable:!0,get:function(){return i.RpcEndpointType}}),a(e("./constants.cjs"),n);var s=e("./types.cjs");Object.defineProperty(n,"NetworkClientType",{enumerable:!0,get:function(){return s.NetworkClientType}});var o=e("./rpc-service/rpc-service.cjs");Object.defineProperty(n,"isConnectionError",{enumerable:!0,get:function(){return o.isConnectionError}})}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/index.cjs"}],[3083,{"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.projectLogger=void 0;const r=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return r.createModuleLogger}}),n.projectLogger=(0,r.createProjectLogger)("network-controller")}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/logger.cjs"}],[3084,{"../logger.cjs":3083,"./rpc-service.cjs":3085,"@metamask/controller-utils":1449},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,a,i,s,o,c,l=this&&this.__classPrivateFieldSet||function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},u=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.RpcServiceChain=void 0;const d=e("@metamask/controller-utils"),p=e("./rpc-service.cjs"),m=e("../logger.cjs"),h=(0,m.createModuleLogger)(m.projectLogger,"RpcServiceChain"),f="available",g="degraded",y="unknown",v="unavailable";n.RpcServiceChain=class{constructor(e){r.set(this,void 0),a.set(this,void 0),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l(this,o,e.map(e=>new p.RpcService(e)),"f"),l(this,s,u(this,o,"f")[0],"f"),l(this,c,y,"f"),l(this,a,new d.CockatielEventEmitter,"f"),l(this,i,new d.CockatielEventEmitter,"f");for(const e of u(this,o,"f"))e.onDegraded(e=>{if(u(this,c,"f")!==g){h('Updating status to "degraded"',e),l(this,c,g,"f");const{endpointUrl:t,...n}=e;u(this,i,"f").emit(n)}});l(this,r,new d.CockatielEventEmitter,"f");for(const e of u(this,o,"f"))e.onAvailable(e=>{if(u(this,c,"f")!==f){h('Updating status to "available"',e),l(this,c,f,"f");const{endpointUrl:t,...n}=e;u(this,r,"f").emit(n)}})}onServiceRetry(e){const t=u(this,o,"f").map(t=>t.onRetry(t=>{e({...t,primaryEndpointUrl:u(this,s,"f").endpointUrl.toString()})}));return{dispose(){t.forEach(e=>e.dispose())}}}onBreak(e){return u(this,a,"f").addListener(e)}onServiceBreak(e){const t=u(this,o,"f").map(t=>t.onBreak(t=>{e({...t,primaryEndpointUrl:u(this,s,"f").endpointUrl.toString()})}));return{dispose(){t.forEach(e=>e.dispose())}}}onDegraded(e){return u(this,i,"f").addListener(e)}onServiceDegraded(e){const t=u(this,o,"f").map(t=>t.onDegraded(t=>{e({...t,primaryEndpointUrl:u(this,s,"f").endpointUrl.toString()})}));return{dispose(){t.forEach(e=>e.dispose())}}}onAvailable(e){return u(this,r,"f").addListener(e)}async request(e,t={}){let n,r;for(const[i,s]of u(this,o,"f").entries()){h(`Trying service #${i+1}...`);const p=s.getCircuitState();try{r=await s.request(e,t),h("Service successfully received request."),n=i;break}catch(e){const{lastError:t}=s,n=s.getCircuitState()===d.CircuitState.Open;if(h("Service failed! error =",e,"lastError = ",t),n){if(i<u(this,o,"f").length-1){h("This service's circuit is open. Proceeding to next service...");continue}p!==d.CircuitState.Open&&u(this,c,"f")!==v&&t!==undefined&&(h('This service\'s circuit just opened and it is the last service. Updating status to "unavailable" and triggering onBreak.'),l(this,c,v,"f"),u(this,a,"f").emit({error:t}))}throw h((n?"":"This service's circuit is closed. ")+"Re-throwing error."),e}}if(r){if(n!==undefined)for(const[e,t]of[...u(this,o,"f").entries()].slice(n+1))h(`Resetting policy for service #${e+1}.`),t.resetPolicy();return r}throw new Error("Nothing to return")}},r=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakMap,o=new WeakMap,c=new WeakMap}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/rpc-service/rpc-service-chain.cjs"}],[3085,{"../logger.cjs":3083,"@metamask/controller-utils":1449,"@metamask/rpc-errors":2600,"@metamask/utils":3116,cockatiel:4144,deepmerge:4237},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,a,i,s,o,c,l,u,d=this&&this.__classPrivateFieldSet||function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},p=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},m=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RpcService=n.isConnectionError=n.CUSTOM_RPC_ERRORS=n.CONNECTION_ERRORS=n.DEFAULT_MAX_CONSECUTIVE_FAILURES=n.DEFAULT_MAX_RETRIES=void 0;const h=e("@metamask/controller-utils"),f=e("@metamask/rpc-errors"),g=e("@metamask/utils"),y=(e("cockatiel"),m(e("deepmerge"))),v=e("../logger.cjs"),w=(0,v.createModuleLogger)(v.projectLogger,"RpcService");function b(e){if("object"!=typeof e||null===e||!("message"in e))return!1;const{message:t}=e;return"string"==typeof t&&!function(e){return e.includes("Nock:")}(t)&&n.CONNECTION_ERRORS.some(({constructorName:n,pattern:r})=>e.constructor.name===n&&r.test(t))}function T(e){return e instanceof SyntaxError||/invalid json/iu.test((0,g.getErrorMessage)(e))}n.DEFAULT_MAX_RETRIES=4,n.DEFAULT_MAX_CONSECUTIVE_FAILURES=3*(1+n.DEFAULT_MAX_RETRIES),n.CONNECTION_ERRORS=[{constructorName:"TypeError",pattern:/network error/u},{constructorName:"TypeError",pattern:/Failed to fetch/u},{constructorName:"TypeError",pattern:/NetworkError when attempting to fetch resource\./u},{constructorName:"TypeError",pattern:/The Internet connection appears to be offline\./u},{constructorName:"TypeError",pattern:/Load failed/u},{constructorName:"TypeError",pattern:/Network request failed/u},{constructorName:"FetchError",pattern:/request to (.+) failed/u},{constructorName:"TypeError",pattern:/fetch failed/u},{constructorName:"TypeError",pattern:/terminated/u}],n.CUSTOM_RPC_ERRORS={unauthorized:-32006,httpClientError:-32080},n.isConnectionError=b;n.RpcService=class{constructor(e){r.add(this),a.set(this,void 0),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0);const{btoa:t,endpointUrl:l,fetch:u,logger:m,fetchOptions:f={},policyOptions:y={}}=e;d(this,a,u,"f");const v=(w=l)instanceof URL?w:new URL(w);var w;d(this,i,p(this,r,"m",c).call(this,v,f,t),"f"),this.endpointUrl=function(e){const t=new URL(e.toString());return t.username="",t.password="",t}(v),d(this,s,m,"f"),d(this,o,(0,h.createServicePolicy)({maxRetries:n.DEFAULT_MAX_RETRIES,maxConsecutiveFailures:n.DEFAULT_MAX_CONSECUTIVE_FAILURES,...y,retryFilterPolicy:(0,h.handleWhen)(e=>b(e)||T(e)||"httpStatus"in e&&(502===e.httpStatus||503===e.httpStatus||504===e.httpStatus)||(0,g.hasProperty)(e,"code")&&("ETIMEDOUT"===e.code||"ECONNRESET"===e.code))}),"f")}resetPolicy(){p(this,o,"f").reset()}getCircuitState(){return p(this,o,"f").getCircuitState()}onRetry(e){return p(this,o,"f").onRetry(t=>{e({...t,endpointUrl:this.endpointUrl.toString()})})}onBreak(e){return p(this,o,"f").onBreak(t=>{"isolated"in t||e({...t,endpointUrl:this.endpointUrl.toString()})})}onDegraded(e){return p(this,o,"f").onDegraded(t=>{e({...t??{},endpointUrl:this.endpointUrl.toString()})})}onAvailable(e){return p(this,o,"f").onAvailable(()=>{e({endpointUrl:this.endpointUrl.toString()})})}async request(e,t={}){const n=p(this,r,"m",l).call(this,e,t);return await p(this,r,"m",u).call(this,n)}},a=new WeakMap,i=new WeakMap,s=new WeakMap,o=new WeakMap,r=new WeakSet,c=function(e,t,n){if(e.username&&e.password){const r=n(`${e.username}:${e.password}`);return(0,y.default)(t,{headers:{Authorization:`Basic ${r}`}})}return t},l=function(e,t){const n=(0,y.default)({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}},(0,y.default)(p(this,i,"f"),t)),{id:r,jsonrpc:a,method:s,params:o}=e;return{...n,body:JSON.stringify({id:r,jsonrpc:a,method:s,params:o})}},u=async function(e){let t;try{w(`[${this.endpointUrl}] Circuit state`,p(this,o,"f").getCircuitState());const n=await p(this,o,"f").execute(async n=>{if(w("REQUEST INITIATED:",this.endpointUrl.toString(),"::",e,`(attempt ${n.attempt+1})`),t=await p(this,a,"f").call(this,this.endpointUrl,e),!t.ok)throw new h.HttpError(t.status);return w("REQUEST SUCCESSFUL:",this.endpointUrl.toString(),t.status),await t.json()});return this.lastError=undefined,n}catch(e){if(w("REQUEST ERROR:",this.endpointUrl.toString(),e),this.lastError=e instanceof Error?e:new Error((0,g.getErrorMessage)(e)),e instanceof h.HttpError){const t=e.httpStatus;if(401===t)throw new f.JsonRpcError(n.CUSTOM_RPC_ERRORS.unauthorized,"Unauthorized.",{httpStatus:t});if(429===t)throw f.rpcErrors.limitExceeded({message:"Request is being rate limited.",data:{httpStatus:t}});if(t>=500||402===t||404===t)throw f.rpcErrors.resourceUnavailable({message:"RPC endpoint not found or unavailable.",data:{httpStatus:t}});throw new f.JsonRpcError(n.CUSTOM_RPC_ERRORS.httpClientError,"RPC endpoint returned HTTP client error.",{httpStatus:t})}if(T(e))throw f.rpcErrors.parse({message:"RPC endpoint did not return JSON."});if(e instanceof h.BrokenCircuitError){p(this,s,"f")?.warn(e);const t=p(this,o,"f").getRemainingCircuitOpenDuration(),n=Intl.NumberFormat(undefined,{maximumFractionDigits:2}).format((t??p(this,o,"f").circuitBreakDuration)/g.Duration.Minute);throw f.rpcErrors.resourceUnavailable({message:`RPC endpoint returned too many errors, retrying in ${n} minutes. Consider using a different RPC endpoint.`})}throw e}}}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/rpc-service/rpc-service.cjs"}],[3086,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;Object.defineProperty(n,"__esModule",{value:!0}),n.NetworkClientType=void 0,function(e){e.Custom="custom",e.Infura="infura"}(r||(n.NetworkClientType=r={}))}}},{package:"@metamask/transaction-pay-controller>@metamask/bridge-controller>@metamask/network-controller",file:"node_modules/@metamask/transaction-pay-controller/node_modules/@metamask/bridge-controller/node_modules/@metamask/network-controller/dist/types.cjs"}],[3087,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){!function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,i=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",c=1e14,l=14,u=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,m=1e9;function h(e){var t=0|e;return e>0||e===t?t:t-1}function f(e){for(var t,n,r=1,a=e.length,i=e[0]+"";r<a;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);i+=t}for(a=i.length;48===i.charCodeAt(--a););return i.slice(0,a+1||1)}function g(e,t){var n,r,a=e.c,i=t.c,s=e.s,o=t.s,c=e.e,l=t.e;if(!s||!o)return null;if(n=a&&!a[0],r=i&&!i[0],n||r)return n?r?0:-o:s;if(s!=o)return s;if(n=s<0,r=c==l,!a||!i)return r?0:!a^n?1:-1;if(!r)return c>l^n?1:-1;for(o=(c=a.length)<(l=i.length)?c:l,s=0;s<o;s++)if(a[s]!=i[s])return a[s]>i[s]^n?1:-1;return c==l?0:c>l^n?1:-1}function y(e,t,n,r){if(e<t||e>n||e!==i(e))throw Error(s+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function v(e){var t=e.c.length-1;return h(e.e/l)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function b(e,t,n){var r,a;if(t<0){for(a=n+".";++t;a+=n);e=a+e}else if(++t>(r=e.length)){for(a=n,t-=r;--t;a+=n);e+=a}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,T,k,_,E,P,S,A,C,O,M=H.prototype={constructor:H,toString:null,valueOf:null},j=new H(1),I=20,R=4,x=-7,N=21,D=-1e7,F=1e7,U=!1,B=1,G=0,$={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},L="0123456789abcdefghijklmnopqrstuvwxyz",q=!0;function H(e,t){var n,a,s,c,d,p,m,h,f=this;if(!(f instanceof H))return new H(e,t);if(null==t){if(e&&!0===e._isBigNumber)return f.s=e.s,void(!e.c||e.e>F?f.c=f.e=null:e.e<D?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice()));if((p="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,d=e;d>=10;d/=10,c++);return void(c>F?f.c=f.e=null:(f.e=c,f.c=[e]))}h=String(e)}else{if(!r.test(h=String(e)))return k(f,h,p);f.s=45==h.charCodeAt(0)?(h=h.slice(1),-1):1}(c=h.indexOf("."))>-1&&(h=h.replace(".","")),(d=h.search(/e/i))>0?(c<0&&(c=d),c+=+h.slice(d+1),h=h.substring(0,d)):c<0&&(c=h.length)}else{if(y(t,2,L.length,"Base"),10==t&&q)return K(f=new H(e),I+f.e+1,R);if(h=String(e),p="number"==typeof e){if(0*e!=0)return k(f,h,p,t);if(f.s=1/e<0?(h=h.slice(1),-1):1,H.DEBUG&&h.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else f.s=45===h.charCodeAt(0)?(h=h.slice(1),-1):1;for(n=L.slice(0,t),c=d=0,m=h.length;d<m;d++)if(n.indexOf(a=h.charAt(d))<0){if("."==a){if(d>c){c=m;continue}}else if(!s&&(h==h.toUpperCase()&&(h=h.toLowerCase())||h==h.toLowerCase()&&(h=h.toUpperCase()))){s=!0,d=-1,c=0;continue}return k(f,String(e),p,t)}p=!1,(c=(h=T(h,t,10,f.s)).indexOf("."))>-1?h=h.replace(".",""):c=h.length}for(d=0;48===h.charCodeAt(d);d++);for(m=h.length;48===h.charCodeAt(--m););if(h=h.slice(d,++m)){if(m-=d,p&&H.DEBUG&&m>15&&(e>u||e!==i(e)))throw Error(o+f.s*e);if((c=c-d-1)>F)f.c=f.e=null;else if(c<D)f.c=[f.e=0];else{if(f.e=c,f.c=[],d=(c+1)%l,c<0&&(d+=l),d<m){for(d&&f.c.push(+h.slice(0,d)),m-=l;d<m;)f.c.push(+h.slice(d,d+=l));d=l-(h=h.slice(d)).length}else d-=m;for(;d--;h+="0");f.c.push(+h)}}else f.c=[f.e=0]}function Y(e,t,n,r){var a,i,s,o,c;if(null==n?n=R:y(n,0,8),!e.c)return e.toString();if(a=e.c[0],s=e.e,null==t)c=f(e.c),c=1==r||2==r&&(s<=x||s>=N)?w(c,s):b(c,s,"0");else if(i=(e=K(new H(e),t,n)).e,o=(c=f(e.c)).length,1==r||2==r&&(t<=i||i<=x)){for(;o<t;c+="0",o++);c=w(c,i)}else if(t-=s,c=b(c,i,"0"),i+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=i-o)>0)for(i+1==o&&(c+=".");t--;c+="0");return e.s<0&&a?"-"+c:c}function W(e,t){for(var n,r,a=1,i=new H(e[0]);a<e.length;a++)(!(r=new H(e[a])).s||(n=g(i,r))===t||0===n&&i.s===t)&&(i=r);return i}function V(e,t,n){for(var r=1,a=t.length;!t[--a];t.pop());for(a=t[0];a>=10;a/=10,r++);return(n=r+n*l-1)>F?e.c=e.e=null:n<D?e.c=[e.e=0]:(e.e=n,e.c=t),e}function K(e,t,n,r){var s,o,u,p,m,h,f,g=e.c,y=d;if(g){e:{for(s=1,p=g[0];p>=10;p/=10,s++);if((o=t-s)<0)o+=l,u=t,m=g[h=0],f=i(m/y[s-u-1]%10);else if((h=a((o+1)/l))>=g.length){if(!r)break e;for(;g.length<=h;g.push(0));m=f=0,s=1,u=(o%=l)-l+1}else{for(m=p=g[h],s=1;p>=10;p/=10,s++);f=(u=(o%=l)-l+s)<0?0:i(m/y[s-u-1]%10)}if(r=r||t<0||null!=g[h+1]||(u<0?m:m%y[s-u-1]),r=n<4?(f||r)&&(0==n||n==(e.s<0?3:2)):f>5||5==f&&(4==n||r||6==n&&(o>0?u>0?m/y[s-u]:0:g[h-1])%10&1||n==(e.s<0?8:7)),t<1||!g[0])return g.length=0,r?(t-=e.e+1,g[0]=y[(l-t%l)%l],e.e=-t||0):g[0]=e.e=0,e;if(0==o?(g.length=h,p=1,h--):(g.length=h+1,p=y[l-o],g[h]=u>0?i(m/y[s-u]%y[u])*p:0),r)for(;;){if(0==h){for(o=1,u=g[0];u>=10;u/=10,o++);for(u=g[0]+=p,p=1;u>=10;u/=10,p++);o!=p&&(e.e++,g[0]==c&&(g[0]=1));break}if(g[h]+=p,g[h]!=c)break;g[h--]=0,p=1}for(o=g.length;0===g[--o];g.pop());}e.e>F?e.c=e.e=null:e.e<D&&(e.c=[e.e=0])}return e}function z(e){var t,n=e.e;return null===n?e.toString():(t=f(e.c),t=n<=x||n>=N?w(t,n):b(t,n,"0"),e.s<0?"-"+t:t)}return H.clone=e,H.ROUND_UP=0,H.ROUND_DOWN=1,H.ROUND_CEIL=2,H.ROUND_FLOOR=3,H.ROUND_HALF_UP=4,H.ROUND_HALF_DOWN=5,H.ROUND_HALF_EVEN=6,H.ROUND_HALF_CEIL=7,H.ROUND_HALF_FLOOR=8,H.EUCLID=9,H.config=H.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(s+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(y(n=e[t],0,m,t),I=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(y(n=e[t],0,8,t),R=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(y(n[0],-m,0,t),y(n[1],0,m,t),x=n[0],N=n[1]):(y(n,-m,m,t),x=-(N=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)y(n[0],-m,-1,t),y(n[1],1,m,t),D=n[0],F=n[1];else{if(y(n,-m,m,t),!n)throw Error(s+t+" cannot be zero: "+n);D=-(F=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(s+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw U=!n,Error(s+"crypto unavailable");U=n}else U=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(y(n=e[t],0,9,t),B=n),e.hasOwnProperty(t="POW_PRECISION")&&(y(n=e[t],0,m,t),G=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(s+t+" not an object: "+n);$=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(s+t+" invalid: "+n);q="0123456789"==n.slice(0,10),L=n}}return{DECIMAL_PLACES:I,ROUNDING_MODE:R,EXPONENTIAL_AT:[x,N],RANGE:[D,F],CRYPTO:U,MODULO_MODE:B,POW_PRECISION:G,FORMAT:$,ALPHABET:L}},H.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!H.DEBUG)return!0;var t,n,r=e.c,a=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===o||-1===o)&&a>=-m&&a<=m&&a===i(a)){if(0===r[0]){if(0===a&&1===r.length)return!0;break e}if((t=(a+1)%l)<1&&(t+=l),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=c||n!==i(n))break e;if(0!==n)return!0}}}else if(null===r&&null===a&&(null===o||1===o||-1===o))return!0;throw Error(s+"Invalid BigNumber: "+e)},H.maximum=H.max=function(){return W(arguments,-1)},H.minimum=H.min=function(){return W(arguments,1)},H.random=(_=9007199254740992,E=Math.random()*_&2097151?function(){return i(Math.random()*_)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,o,c,u=0,p=[],h=new H(j);if(null==e?e=I:y(e,0,m),o=a(e/l),U)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));u<o;)(c=131072*t[u]+(t[u+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[u]=n[0],t[u+1]=n[1]):(p.push(c%1e14),u+=2);u=o/2}else{if(!crypto.randomBytes)throw U=!1,Error(s+"crypto unavailable");for(t=crypto.randomBytes(o*=7);u<o;)(c=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(p.push(c%1e14),u+=7);u=o/7}if(!U)for(;u<o;)(c=E())<9e15&&(p[u++]=c%1e14);for(o=p[--u],e%=l,o&&e&&(c=d[l-e],p[u]=i(o/c)*c);0===p[u];p.pop(),u--);if(u<0)p=[r=0];else{for(r=-1;0===p[0];p.splice(0,1),r-=l);for(u=1,c=p[0];c>=10;c/=10,u++);u<l&&(r-=l-u)}return h.e=r,h.c=p,h}),H.sum=function(){for(var e=1,t=arguments,n=new H(t[0]);e<t.length;)n=n.plus(t[e++]);return n},T=function(){var e="0123456789";function t(e,t,n,r){for(var a,i,s=[0],o=0,c=e.length;o<c;){for(i=s.length;i--;s[i]*=t);for(s[0]+=r.indexOf(e.charAt(o++)),a=0;a<s.length;a++)s[a]>n-1&&(null==s[a+1]&&(s[a+1]=0),s[a+1]+=s[a]/n|0,s[a]%=n)}return s.reverse()}return function(r,a,i,s,o){var c,l,u,d,p,m,h,g,y=r.indexOf("."),v=I,w=R;for(y>=0&&(d=G,G=0,r=r.replace(".",""),m=(g=new H(a)).pow(r.length-y),G=d,g.c=t(b(f(m.c),m.e,"0"),10,i,e),g.e=g.c.length),u=d=(h=t(r,a,i,o?(c=L,e):(c=e,L))).length;0==h[--d];h.pop());if(!h[0])return c.charAt(0);if(y<0?--u:(m.c=h,m.e=u,m.s=s,h=(m=n(m,g,v,w,i)).c,p=m.r,u=m.e),y=h[l=u+v+1],d=i/2,p=p||l<0||null!=h[l+1],p=w<4?(null!=y||p)&&(0==w||w==(m.s<0?3:2)):y>d||y==d&&(4==w||p||6==w&&1&h[l-1]||w==(m.s<0?8:7)),l<1||!h[0])r=p?b(c.charAt(1),-v,c.charAt(0)):c.charAt(0);else{if(h.length=l,p)for(--i;++h[--l]>i;)h[l]=0,l||(++u,h=[1].concat(h));for(d=h.length;!h[--d];);for(y=0,r="";y<=d;r+=c.charAt(h[y++]));r=b(r,u,c.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,a,i,s,o=0,c=e.length,l=t%p,u=t/p|0;for(e=e.slice();c--;)o=((a=l*(i=e[c]%p)+(r=u*i+(s=e[c]/p|0)*l)%p*p+o)/n|0)+(r/p|0)+u*s,e[c]=a%n;return o&&(e=[o].concat(e)),e}function t(e,t,n,r){var a,i;if(n!=r)i=n>r?1:-1;else for(a=i=0;a<n;a++)if(e[a]!=t[a]){i=e[a]>t[a]?1:-1;break}return i}function n(e,t,n,r){for(var a=0;n--;)e[n]-=a,a=e[n]<t[n]?1:0,e[n]=a*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,a,s,o,u){var d,p,m,f,g,y,v,w,b,T,k,_,E,P,S,A,C,O=r.s==a.s?1:-1,M=r.c,j=a.c;if(!(M&&M[0]&&j&&j[0]))return new H(r.s&&a.s&&(M?!j||M[0]!=j[0]:j)?M&&0==M[0]||!j?0*O:O/0:NaN);for(b=(w=new H(O)).c=[],O=s+(p=r.e-a.e)+1,u||(u=c,p=h(r.e/l)-h(a.e/l),O=O/l|0),m=0;j[m]==(M[m]||0);m++);if(j[m]>(M[m]||0)&&p--,O<0)b.push(1),f=!0;else{for(P=M.length,A=j.length,m=0,O+=2,(g=i(u/(j[0]+1)))>1&&(j=e(j,g,u),M=e(M,g,u),A=j.length,P=M.length),E=A,k=(T=M.slice(0,A)).length;k<A;T[k++]=0);C=j.slice(),C=[0].concat(C),S=j[0],j[1]>=u/2&&S++;do{if(g=0,(d=t(j,T,A,k))<0){if(_=T[0],A!=k&&(_=_*u+(T[1]||0)),(g=i(_/S))>1)for(g>=u&&(g=u-1),v=(y=e(j,g,u)).length,k=T.length;1==t(y,T,v,k);)g--,n(y,A<v?C:j,v,u),v=y.length,d=1;else 0==g&&(d=g=1),v=(y=j.slice()).length;if(v<k&&(y=[0].concat(y)),n(T,y,k,u),k=T.length,-1==d)for(;t(j,T,A,k)<1;)g++,n(T,A<k?C:j,k,u),k=T.length}else 0===d&&(g++,T=[0]);b[m++]=g,T[0]?T[k++]=M[E]||0:(T=[M[E]],k=1)}while((E++<P||null!=T[0])&&O--);f=null!=T[0],b[0]||b.splice(0,1)}if(u==c){for(m=1,O=b[0];O>=10;O/=10,m++);K(w,s+(w.e=m+p*l-1)+1,o,f)}else w.e=p,w.r=+f;return w}}(),P=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,A=/^\.([^.]+)$/,C=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g,k=function(e,t,n,r){var a,i=n?t:t.replace(O,"");if(C.test(i))e.s=isNaN(i)?null:i<0?-1:1;else{if(!n&&(i=i.replace(P,function(e,t,n){return a="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=a?e:t}),r&&(a=r,i=i.replace(S,"$1").replace(A,"0.$1")),t!=i))return new H(i,a);if(H.DEBUG)throw Error(s+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},M.absoluteValue=M.abs=function(){var e=new H(this);return e.s<0&&(e.s=1),e},M.comparedTo=function(e,t){return g(this,new H(e,t))},M.decimalPlaces=M.dp=function(e,t){var n,r,a,i=this;if(null!=e)return y(e,0,m),null==t?t=R:y(t,0,8),K(new H(i),e+i.e+1,t);if(!(n=i.c))return null;if(r=((a=n.length-1)-h(this.e/l))*l,a=n[a])for(;a%10==0;a/=10,r--);return r<0&&(r=0),r},M.dividedBy=M.div=function(e,t){return n(this,new H(e,t),I,R)},M.dividedToIntegerBy=M.idiv=function(e,t){return n(this,new H(e,t),0,1)},M.exponentiatedBy=M.pow=function(e,t){var n,r,o,c,u,d,p,m,h=this;if((e=new H(e)).c&&!e.isInteger())throw Error(s+"Exponent not an integer: "+z(e));if(null!=t&&(t=new H(t)),u=e.e>14,!h.c||!h.c[0]||1==h.c[0]&&!h.e&&1==h.c.length||!e.c||!e.c[0])return m=new H(Math.pow(+z(h),u?e.s*(2-v(e)):+z(e))),t?m.mod(t):m;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new H(NaN);(r=!d&&h.isInteger()&&t.isInteger())&&(h=h.mod(t))}else{if(e.e>9&&(h.e>0||h.e<-1||(0==h.e?h.c[0]>1||u&&h.c[1]>=24e7:h.c[0]<8e13||u&&h.c[0]<=9999975e7)))return c=h.s<0&&v(e)?-0:0,h.e>-1&&(c=1/c),new H(d?1/c:c);G&&(c=a(G/l+2))}for(u?(n=new H(.5),d&&(e.s=1),p=v(e)):p=(o=Math.abs(+z(e)))%2,m=new H(j);;){if(p){if(!(m=m.times(h)).c)break;c?m.c.length>c&&(m.c.length=c):r&&(m=m.mod(t))}if(o){if(0===(o=i(o/2)))break;p=o%2}else if(K(e=e.times(n),e.e+1,1),e.e>14)p=v(e);else{if(0===(o=+z(e)))break;p=o%2}h=h.times(h),c?h.c&&h.c.length>c&&(h.c.length=c):r&&(h=h.mod(t))}return r?m:(d&&(m=j.div(m)),t?m.mod(t):c?K(m,G,R,undefined):m)},M.integerValue=function(e){var t=new H(this);return null==e?e=R:y(e,0,8),K(t,t.e+1,e)},M.isEqualTo=M.eq=function(e,t){return 0===g(this,new H(e,t))},M.isFinite=function(){return!!this.c},M.isGreaterThan=M.gt=function(e,t){return g(this,new H(e,t))>0},M.isGreaterThanOrEqualTo=M.gte=function(e,t){return 1===(t=g(this,new H(e,t)))||0===t},M.isInteger=function(){return!!this.c&&h(this.e/l)>this.c.length-2},M.isLessThan=M.lt=function(e,t){return g(this,new H(e,t))<0},M.isLessThanOrEqualTo=M.lte=function(e,t){return-1===(t=g(this,new H(e,t)))||0===t},M.isNaN=function(){return!this.s},M.isNegative=function(){return this.s<0},M.isPositive=function(){return this.s>0},M.isZero=function(){return!!this.c&&0==this.c[0]},M.minus=function(e,t){var n,r,a,i,s=this,o=s.s;if(t=(e=new H(e,t)).s,!o||!t)return new H(NaN);if(o!=t)return e.s=-t,s.plus(e);var u=s.e/l,d=e.e/l,p=s.c,m=e.c;if(!u||!d){if(!p||!m)return p?(e.s=-t,e):new H(m?s:NaN);if(!p[0]||!m[0])return m[0]?(e.s=-t,e):new H(p[0]?s:3==R?-0:0)}if(u=h(u),d=h(d),p=p.slice(),o=u-d){for((i=o<0)?(o=-o,a=p):(d=u,a=m),a.reverse(),t=o;t--;a.push(0));a.reverse()}else for(r=(i=(o=p.length)<(t=m.length))?o:t,o=t=0;t<r;t++)if(p[t]!=m[t]){i=p[t]<m[t];break}if(i&&(a=p,p=m,m=a,e.s=-e.s),(t=(r=m.length)-(n=p.length))>0)for(;t--;p[n++]=0);for(t=c-1;r>o;){if(p[--r]<m[r]){for(n=r;n&&!p[--n];p[n]=t);--p[n],p[r]+=c}p[r]-=m[r]}for(;0==p[0];p.splice(0,1),--d);return p[0]?V(e,p,d):(e.s=3==R?-1:1,e.c=[e.e=0],e)},M.modulo=M.mod=function(e,t){var r,a,i=this;return e=new H(e,t),!i.c||!e.s||e.c&&!e.c[0]?new H(NaN):!e.c||i.c&&!i.c[0]?new H(i):(9==B?(a=e.s,e.s=1,r=n(i,e,0,3),e.s=a,r.s*=a):r=n(i,e,0,B),(e=i.minus(r.times(e))).c[0]||1!=B||(e.s=i.s),e)},M.multipliedBy=M.times=function(e,t){var n,r,a,i,s,o,u,d,m,f,g,y,v,w,b,T=this,k=T.c,_=(e=new H(e,t)).c;if(!(k&&_&&k[0]&&_[0]))return!T.s||!e.s||k&&!k[0]&&!_||_&&!_[0]&&!k?e.c=e.e=e.s=null:(e.s*=T.s,k&&_?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=h(T.e/l)+h(e.e/l),e.s*=T.s,(u=k.length)<(f=_.length)&&(v=k,k=_,_=v,a=u,u=f,f=a),a=u+f,v=[];a--;v.push(0));for(w=c,b=p,a=f;--a>=0;){for(n=0,g=_[a]%b,y=_[a]/b|0,i=a+(s=u);i>a;)n=((d=g*(d=k[--s]%b)+(o=y*d+(m=k[s]/b|0)*g)%b*b+v[i]+n)/w|0)+(o/b|0)+y*m,v[i--]=d%w;v[i]=n}return n?++r:v.splice(0,1),V(e,v,r)},M.negated=function(){var e=new H(this);return e.s=-e.s||null,e},M.plus=function(e,t){var n,r=this,a=r.s;if(t=(e=new H(e,t)).s,!a||!t)return new H(NaN);if(a!=t)return e.s=-t,r.minus(e);var i=r.e/l,s=e.e/l,o=r.c,u=e.c;if(!i||!s){if(!o||!u)return new H(a/0);if(!o[0]||!u[0])return u[0]?e:new H(o[0]?r:0*a)}if(i=h(i),s=h(s),o=o.slice(),a=i-s){for(a>0?(s=i,n=u):(a=-a,n=o),n.reverse();a--;n.push(0));n.reverse()}for((a=o.length)-(t=u.length)<0&&(n=u,u=o,o=n,t=a),a=0;t;)a=(o[--t]=o[t]+u[t]+a)/c|0,o[t]=c===o[t]?0:o[t]%c;return a&&(o=[a].concat(o),++s),V(e,o,s)},M.precision=M.sd=function(e,t){var n,r,a,i=this;if(null!=e&&e!==!!e)return y(e,1,m),null==t?t=R:y(t,0,8),K(new H(i),e,t);if(!(n=i.c))return null;if(r=(a=n.length-1)*l+1,a=n[a]){for(;a%10==0;a/=10,r--);for(a=n[0];a>=10;a/=10,r++);}return e&&i.e+1>r&&(r=i.e+1),r},M.shiftedBy=function(e){return y(e,-9007199254740991,u),this.times("1e"+e)},M.squareRoot=M.sqrt=function(){var e,t,r,a,i,s=this,o=s.c,c=s.s,l=s.e,u=I+4,d=new H("0.5");if(1!==c||!o||!o[0])return new H(!c||c<0&&(!o||o[0])?NaN:o?s:1/0);if(0==(c=Math.sqrt(+z(s)))||c==1/0?(((t=f(o)).length+l)%2==0&&(t+="0"),c=Math.sqrt(+t),l=h((l+1)/2)-(l<0||l%2),r=new H(t=c==1/0?"5e"+l:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+l)):r=new H(c+""),r.c[0])for((c=(l=r.e)+u)<3&&(c=0);;)if(i=r,r=d.times(i.plus(n(s,i,u,1))),f(i.c).slice(0,c)===(t=f(r.c)).slice(0,c)){if(r.e<l&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(a||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(K(r,r.e+I+2,1),e=!r.times(r).eq(s));break}if(!a&&(K(i,i.e+I+2,0),i.times(i).eq(s))){r=i;break}u+=4,c+=4,a=1}return K(r,r.e+I+1,R,e)},M.toExponential=function(e,t){return null!=e&&(y(e,0,m),e++),Y(this,e,t,1)},M.toFixed=function(e,t){return null!=e&&(y(e,0,m),e=e+this.e+1),Y(this,e,t)},M.toFormat=function(e,t,n){var r,a=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=$;else if("object"!=typeof n)throw Error(s+"Argument not an object: "+n);if(r=a.toFixed(e,t),a.c){var i,o=r.split("."),c=+n.groupSize,l=+n.secondaryGroupSize,u=n.groupSeparator||"",d=o[0],p=o[1],m=a.s<0,h=m?d.slice(1):d,f=h.length;if(l&&(i=c,c=l,l=i,f-=i),c>0&&f>0){for(i=f%c||c,d=h.substr(0,i);i<f;i+=c)d+=u+h.substr(i,c);l>0&&(d+=u+h.slice(i)),m&&(d="-"+d)}r=p?d+(n.decimalSeparator||"")+((l=+n.fractionGroupSize)?p.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):p):d}return(n.prefix||"")+r+(n.suffix||"")},M.toFraction=function(e){var t,r,a,i,o,c,u,p,m,h,g,y,v=this,w=v.c;if(null!=e&&(!(u=new H(e)).isInteger()&&(u.c||1!==u.s)||u.lt(j)))throw Error(s+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+z(u));if(!w)return new H(v);for(t=new H(j),m=r=new H(j),a=p=new H(j),y=f(w),o=t.e=y.length-v.e-1,t.c[0]=d[(c=o%l)<0?l+c:c],e=!e||u.comparedTo(t)>0?o>0?t:m:u,c=F,F=1/0,u=new H(y),p.c[0]=0;h=n(u,t,0,1),1!=(i=r.plus(h.times(a))).comparedTo(e);)r=a,a=i,m=p.plus(h.times(i=m)),p=i,t=u.minus(h.times(i=t)),u=i;return i=n(e.minus(r),a,0,1),p=p.plus(i.times(m)),r=r.plus(i.times(a)),p.s=m.s=v.s,g=n(m,a,o*=2,R).minus(v).abs().comparedTo(n(p,r,o,R).minus(v).abs())<1?[m,a]:[p,r],F=c,g},M.toNumber=function(){return+z(this)},M.toPrecision=function(e,t){return null!=e&&y(e,1,m),Y(this,e,t,2)},M.toString=function(e){var t,n=this,r=n.s,a=n.e;return null===a?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=a<=x||a>=N?w(f(n.c),a):b(f(n.c),a,"0"):10===e&&q?t=b(f((n=K(new H(n),I+a+1,R)).c),n.e,"0"):(y(e,2,L.length,"Base"),t=T(b(f(n.c),a,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},M.valueOf=M.toJSON=function(){return z(this)},M._isBigNumber=!0,null!=t&&H.set(t),H}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define(function(){return n}):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"@metamask/transaction-pay-controller>bignumber.js",file:"node_modules/@metamask/transaction-pay-controller/node_modules/bignumber.js/bignumber.js"}],[3088,{"./constants.cjs":3089,"./helpers/Bundler.cjs":3090,"./helpers/PendingUserOperationTracker.cjs":3091,"./helpers/SnapSmartContractAccount.cjs":3092,"./logger.cjs":3094,"./types.cjs":3095,"./utils/gas-fees.cjs":3097,"./utils/gas.cjs":3098,"./utils/transaction.cjs":3099,"./utils/validation.cjs":3100,"@metamask/base-controller":1362,"@metamask/controller-utils":1449,"@metamask/eth-query":1991,"@metamask/rpc-errors":2600,"@metamask/transaction-controller":2994,"@metamask/utils":3116,events:4384,lodash:4838,uuid:5734},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,a,i,s,o,c,l,u,d,p,m,h,f,g,y,v,w,b,T,k,_,E,P,S,A=this&&this.__classPrivateFieldSet||function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},C=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},O=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.UserOperationController=void 0;const M=e("@metamask/base-controller"),j=e("@metamask/controller-utils"),I=O(e("@metamask/eth-query")),R=e("@metamask/rpc-errors"),x=e("@metamask/transaction-controller"),N=e("@metamask/utils"),D=O(e("events")),F=e("lodash"),U=e("uuid"),B=e("./constants.cjs"),G=e("./helpers/Bundler.cjs"),$=e("./helpers/PendingUserOperationTracker.cjs"),L=e("./helpers/SnapSmartContractAccount.cjs"),q=e("./logger.cjs"),H=e("./types.cjs"),Y=e("./utils/gas.cjs"),W=e("./utils/gas-fees.cjs"),V=e("./utils/transaction.cjs"),K=e("./utils/validation.cjs"),z={userOperations:{includeInStateLogs:!0,persist:!0,includeInDebugSnapshot:!1,usedInUi:!0}};class J extends M.BaseController{constructor({entrypoint:e,getGasFeeEstimates:t,messenger:n,state:o}){super({name:"UserOperationController",metadata:z,messenger:n,state:{userOperations:{},...o}}),r.add(this),a.set(this,void 0),i.set(this,void 0),s.set(this,void 0),this.hub=new D.default,A(this,a,e,"f"),A(this,i,t,"f"),A(this,s,new $.PendingUserOperationTracker({getUserOperations:()=>(0,F.cloneDeep)(Object.values(this.state.userOperations)),messenger:n}),"f"),C(this,r,"m",T).call(this)}async addUserOperation(e,t){return(0,K.validateAddUserOperationRequest)(e),(0,K.validateAddUserOperationOptions)(t),await C(this,r,"m",o).call(this,e,t)}async addUserOperationFromTransaction(e,t){(0,K.validateAddUserOperationOptions)(t);const{data:n,from:a,maxFeePerGas:i,maxPriorityFeePerGas:s,to:c,value:l}=e,u={data:""===n?undefined:n,from:a,maxFeePerGas:i,maxPriorityFeePerGas:s,to:c,value:l};return(0,K.validateAddUserOperationRequest)(u),await C(this,r,"m",o).call(this,u,{...t,transaction:e})}startPollingByNetworkClientId(e){return C(this,s,"f").startPolling({networkClientId:e})}}n.UserOperationController=J,a=new WeakMap,i=new WeakMap,s=new WeakMap,r=new WeakSet,o=async function(e,t){(0,q.projectLogger)("Adding user operation",{request:e,options:t});const{networkClientId:n,origin:a,smartContractAccount:i,swaps:s,transaction:o}=t,{chainId:d,provider:p}=await C(this,r,"m",E).call(this,n),m=await C(this,r,"m",u).call(this,d,a,o,s),h=i??new L.SnapSmartContractAccount(this.messenger),f={chainId:d,metadata:m,options:{...t,smartContractAccount:h},provider:p,request:e,transaction:o},{id:y}=m;let v=!1;const w=(async()=>{try{return await C(this,r,"m",c).call(this,f)}catch(e){if(C(this,r,"m",g).call(this,m,e),v)throw e;return undefined}})(),b=async()=>(v=!0,await w);return{id:y,hash:b,transactionHash:async()=>{await b();const{transactionHash:e}=await C(this,r,"m",l).call(this,m);return e}}},c=async function(e){const{metadata:t,options:n}=e,{requireApproval:a,smartContractAccount:i}=n;let s;try{return await C(this,r,"m",d).call(this,e),await C(this,r,"m",p).call(this,t,i),this.hub.emit("user-operation-added",t),!1!==a&&(s=await C(this,r,"m",m).call(this,e)),await C(this,r,"m",h).call(this,t,i),await C(this,r,"m",f).call(this,t),s?.success(),t.hash}catch(e){throw s?.error(e),e}},l=async function(e){const{id:t,hash:n}=e;return(0,q.projectLogger)("Waiting for confirmation",t,n),new Promise((e,n)=>{this.hub.once(`${t}:confirmed`,t=>{e(t)}),this.hub.once(`${t}:failed`,(e,t)=>{n(t)})})},u=async function(e,t,n,a){const i={actualGasCost:null,actualGasUsed:null,baseFeePerGas:null,bundlerUrl:null,chainId:e,error:null,hash:null,id:(0,U.v1)(),origin:t,status:H.UserOperationStatus.Unapproved,swapsMetadata:a?{approvalTxId:a.approvalTxId??null,destinationTokenAddress:a.destinationTokenAddress??null,destinationTokenAmount:a.destinationTokenAmount??null,destinationTokenDecimals:a.destinationTokenDecimals??null,destinationTokenSymbol:a.destinationTokenSymbol??null,estimatedBaseFee:a.estimatedBaseFee??null,sourceTokenAddress:a.sourceTokenAddress??null,sourceTokenAmount:a.sourceTokenAmount??null,sourceTokenDecimals:a.sourceTokenDecimals??null,sourceTokenSymbol:a.sourceTokenSymbol??null,swapAndSendRecipient:a.swapAndSendRecipient??null,swapMetaData:a.swapMetaData??null,swapTokenValue:a.swapTokenValue??null}:null,time:Date.now(),transactionHash:null,transactionParams:n??null,transactionType:null,userFeeLevel:null,userOperation:C(this,r,"m",y).call(this,n)};return C(this,r,"m",v).call(this,i),(0,q.projectLogger)("Added user operation",i.id),i},d=async function(e){const{chainId:t,metadata:n,options:s,provider:o,request:c,transaction:l}=e,{data:u,from:d,to:p,value:m}=c,{id:h,transactionParams:f,userOperation:g}=n,{smartContractAccount:y}=s;(0,q.projectLogger)("Preparing user operation",{id:h});const w=await C(this,r,"m",_).call(this,l,o,s);n.transactionType=w??null,(0,q.projectLogger)("Determined transaction type",w),await(0,W.updateGasFees)({getGasFeeEstimates:C(this,i,"f"),metadata:n,originalRequest:c,provider:o,transaction:f??undefined});const b=await y.prepareUserOperation({chainId:t,data:u,from:d,to:p,value:m});(0,K.validatePrepareUserOperationResponse)(b);const{bundler:T,callData:k,dummyPaymasterAndData:E,dummySignature:P,initCode:S,nonce:A,sender:O}=b;g.callData=k,g.initCode=S??B.EMPTY_BYTES,g.nonce=A,g.paymasterAndData=E??B.EMPTY_BYTES,g.sender=O,g.signature=P??B.EMPTY_BYTES,n.bundlerUrl=T,await(0,Y.updateGas)(n,b,C(this,a,"f")),C(this,r,"m",v).call(this,n)},p=async function(e,t){const{id:n,userOperation:a,chainId:i}=e;(0,q.projectLogger)("Requesting paymaster data",{id:n});const s=await t.updateUserOperation({userOperation:a,chainId:i});(0,K.validateUpdateUserOperationResponse)(s),a.paymasterAndData=s.paymasterAndData??B.EMPTY_BYTES,s.callGasLimit&&(a.callGasLimit=s.callGasLimit),s.preVerificationGas&&(a.preVerificationGas=s.preVerificationGas),s.verificationGasLimit&&(a.verificationGasLimit=s.verificationGasLimit),C(this,r,"m",v).call(this,e)},m=async function(e){(0,q.projectLogger)("Requesting approval");const{metadata:t}=e,{resultCallbacks:n,value:a}=await C(this,r,"m",k).call(this,t),i=a?.txMeta;return i&&await C(this,r,"m",P).call(this,e,i),t.status=H.UserOperationStatus.Approved,C(this,r,"m",v).call(this,t),n},h=async function(e,t){const{id:n,chainId:a,userOperation:i}=e;(0,q.projectLogger)("Signing user operation",n,i);const s=await t.signUserOperation({userOperation:i,chainId:a});(0,K.validateSignUserOperationResponse)(s);const{signature:o}=s;i.signature=o,(0,q.projectLogger)("Signed user operation",o),e.status=H.UserOperationStatus.Signed,C(this,r,"m",v).call(this,e)},f=async function(e){const{userOperation:t}=e;(0,q.projectLogger)("Submitting user operation",t);const n=new G.Bundler(e.bundlerUrl),i=await n.sendUserOperation(t,C(this,a,"f"));e.hash=i,e.status=H.UserOperationStatus.Submitted,C(this,r,"m",v).call(this,e)},g=function(e,t){const{id:n}=e,a=t;(0,q.projectLogger)("User operation failed",n,t),e.error={name:a.name,message:a.message,stack:a.stack,code:a.code,rpc:a.value},e.status=H.UserOperationStatus.Failed,C(this,r,"m",v).call(this,e),String(a.code)===String(R.errorCodes.provider.userRejectedRequest)&&C(this,r,"m",w).call(this,n)},y=function(e){return{callData:B.EMPTY_BYTES,callGasLimit:B.EMPTY_BYTES,initCode:B.EMPTY_BYTES,maxFeePerGas:e?.maxFeePerGas??B.EMPTY_BYTES,maxPriorityFeePerGas:e?.maxPriorityFeePerGas??B.EMPTY_BYTES,nonce:B.EMPTY_BYTES,paymasterAndData:B.EMPTY_BYTES,preVerificationGas:B.EMPTY_BYTES,sender:B.ADDRESS_ZERO,signature:B.EMPTY_BYTES,verificationGasLimit:B.EMPTY_BYTES}},v=function(e){const{id:t}=e;this.update(n=>{n.userOperations[t]=(0,F.cloneDeep)(e)}),C(this,r,"m",b).call(this,e)},w=function(e){this.update(t=>{delete t.userOperations[e]})},b=function(e){if(!e.transactionParams)return;const t=(0,V.getTransactionMetadata)(e);this.hub.emit("transaction-updated",t)},T=function(){C(this,s,"f").hub.on("user-operation-confirmed",e=>{(0,q.projectLogger)("In listener..."),this.hub.emit("user-operation-confirmed",e),this.hub.emit(`${e.id}:confirmed`,e)}),C(this,s,"f").hub.on("user-operation-failed",(e,t)=>{this.hub.emit("user-operation-failed",e,t),this.hub.emit(`${e.id}:failed`,e,t)}),C(this,s,"f").hub.on("user-operation-updated",e=>{C(this,r,"m",v).call(this,e)})},k=async function(e){const{id:t,origin:n}=e,r=j.ApprovalType.Transaction,a={txId:t};return await this.messenger.call("ApprovalController:addRequest",{id:t,origin:n,type:r,requestData:a,expectsResult:!0},!0)},_=async function(e,t,n){if(!e)return undefined;if(n.type)return n.type;const r=new I.default(t),a=(0,x.determineTransactionType)(e,r);return(await a).type},E=async function(e){const{provider:t,configuration:n}=this.messenger.call("NetworkController:getNetworkClientById",e),{chainId:r}=n;return{provider:t,chainId:r}},P=async function(e,t){(0,q.projectLogger)("Found updated transaction in approval",{updatedTransaction:t});const{metadata:n,request:a}=e,{userOperation:i}=n,s=i.paymasterAndData!==B.EMPTY_BYTES,o=(0,N.add0x)(t.txParams.maxFeePerGas),c=(0,N.add0x)(t.txParams.maxPriorityFeePerGas);let l=!1;const u=i.maxFeePerGas,d=i.maxPriorityFeePerGas,p=u!==o||d!==c,m=s&&o===B.VALUE_ZERO&&c===B.VALUE_ZERO;p&&!m&&((0,q.projectLogger)("Gas fees updated during approval",{previousMaxFeePerGas:u,previousMaxPriorityFeePerGas:d,updatedMaxFeePerGas:o,updatedMaxPriorityFeePerGas:c}),i.maxFeePerGas=o,i.maxPriorityFeePerGas=c,l=s);const h=a.data??B.EMPTY_BYTES,f=t.txParams.data??B.EMPTY_BYTES;h!==f&&((0,q.projectLogger)("Data updated during approval",{previousData:h,updatedData:f}),l=!0);const g=a.value??B.VALUE_ZERO,y=t.txParams.value??B.VALUE_ZERO;if(g!==y&&((0,q.projectLogger)("Value updated during approval",{previousValue:g,updatedValue:y}),l=!0),l){const t={...a,data:f,maxFeePerGas:o,maxPriorityFeePerGas:c,value:y};await C(this,r,"m",S).call(this,{...e,request:t})}},S=async function(e){(0,q.projectLogger)("Regenerating user operation as parameters were updated during approval");const{options:{smartContractAccount:t},metadata:n}=e;await C(this,r,"m",d).call(this,e),await C(this,r,"m",p).call(this,n,t),(0,q.projectLogger)("Regenerated user operation",n.userOperation)}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/UserOperationController.cjs"}],[3089,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VALUE_ZERO=n.ADDRESS_ZERO=n.EMPTY_BYTES=void 0,n.EMPTY_BYTES="0x",n.ADDRESS_ZERO="0x0000000000000000000000000000000000000000",n.VALUE_ZERO="0x0"}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/constants.cjs"}],[309,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){let r;Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.PPOM=void 0,n.initSync=function(e){if(r!==undefined)return r;const t=S();e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e));const n=new WebAssembly.Instance(e,t);return A(n,e)},n.main=function(){r.main()};const a="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&a.decode();let i=null;function s(){return null!==i&&0!==i.byteLength||(i=new Uint8Array(r.memory.buffer)),i}function o(e,t){return e>>>=0,a.decode(s().subarray(e,e+t))}const c=new Array(128).fill(undefined);c.push(undefined,null,!0,!1);let l=c.length;function u(e){l===c.length&&c.push(c.length+1);const t=l;return l=c[t],c[t]=e,t}function d(e){return c[e]}function p(e){const t=d(e);return function(e){e<132||(c[e]=l,l=e)}(e),t}let m=0;const h="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},f="function"==typeof h.encodeInto?function(e,t){return h.encodeInto(e,t)}:function(e,t){const n=h.encode(e);return t.set(n),{read:e.length,written:n.length}};function g(e,t,n){if(n===undefined){const n=h.encode(e),r=t(n.length,1)>>>0;return s().subarray(r,r+n.length).set(n),m=n.length,r}let r=e.length,a=t(r,1)>>>0;const i=s();let o=0;for(;o<r;o++){const t=e.charCodeAt(o);if(t>127)break;i[a+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),a=n(a,r,r=o+3*e.length,1)>>>0;const t=s().subarray(a+o,a+r);o+=f(e,t).written}return m=o,a}let y=null;function v(){return null!==y&&0!==y.byteLength||(y=new Int32Array(r.memory.buffer)),y}function w(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=w(e[0]));for(let r=1;r<t;r++)n+=", "+w(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}function b(e,t,n){r.wasm_bindgen__convert__closures__invoke1_mut(e,t,u(n))}function T(e,t){r._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__destroy(e,t)}let k=null;function _(e,t){const n=t(4*e.length,4)>>>0,a=(null!==k&&0!==k.byteLength||(k=new Uint32Array(r.memory.buffer)),k);for(let t=0;t<e.length;t++)a[n/4+t]=u(e[t]);return m=e.length,n}function E(e,t){try{return e.apply(this,t)}catch(e){r.__wbindgen_exn_store(u(e))}}class P{static __wrap(e){e>>>=0;const t=Object.create(P.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_ppom_free(e)}static new(e,t){const n=_(t,r.__wbindgen_malloc),a=m;return p(r.ppom_new(u(e),n,a))}validateJsonRpc(e){return p(r.ppom_validateJsonRpc(this.__wbg_ptr,u(e)))}static version(){return p(r.ppom_version())}}function S(){const e={wbg:{}};return e.wbg.__wbg_buffer_085ec1f694018c4f=function(e){return u(d(e).buffer)},e.wbg.__wbg_call_01734de55d61e11d=function(){return E(function(e,t,n){return u(d(e).call(d(t),d(n)))},arguments)},e.wbg.__wbg_call_4c92f6aec1e1d6e6=function(){return E(function(e,t,n,r){return u(d(e).call(d(t),d(n),d(r)))},arguments)},e.wbg.__wbg_from_d7c216d4616bb368=function(e){return u(Array.from(d(e)))},e.wbg.__wbg_get_44be0491f933a435=function(e,t){return u(d(e)[t>>>0])},e.wbg.__wbg_length_72e2208bbc0efc61=function(e){return d(e).length},e.wbg.__wbg_length_d813e535247d427e=function(e){return d(e).length},e.wbg.__wbg_length_fff51ee6522a1a18=function(e){return d(e).length},e.wbg.__wbg_new_43f1b47c28813cbd=function(e,t){try{var n={a:e,b:t};const a=new Promise((e,t)=>{const a=n.a;n.a=0;try{return function(e,t,n,a){r.wasm_bindgen__convert__closures__invoke2_mut(e,t,u(n),u(a))}(a,n.b,e,t)}finally{n.a=a}});return u(a)}finally{n.a=n.b=0}},e.wbg.__wbg_new_8125e318e6245eed=function(e){return u(new Uint8Array(d(e)))},e.wbg.__wbg_parse_670c19d4e984792e=function(){return E(function(e,t){return u(JSON.parse(o(e,t)))},arguments)},e.wbg.__wbg_ppom_new=function(e){return u(P.__wrap(e))},e.wbg.__wbg_resolve_53698b95aaf7fcf8=function(e){return u(Promise.resolve(d(e)))},e.wbg.__wbg_set_5cf90238115182c3=function(e,t,n){d(e).set(d(t),n>>>0)},e.wbg.__wbg_stringify_e25465938f3f611f=function(){return E(function(e){return u(JSON.stringify(d(e)))},arguments)},e.wbg.__wbg_then_b2267541e2a73865=function(e,t,n){return u(d(e).then(d(t),d(n)))},e.wbg.__wbg_then_f7e06ee3c11698eb=function(e,t){return u(d(e).then(d(t)))},e.wbg.__wbindgen_cb_drop=function(e){const t=p(e).original;if(1==t.cnt--)return t.a=0,!0;return!1},e.wbg.__wbindgen_closure_wrapper_wasm_bindgen__closure__Closure_T___wrap__breaks_if_inlined=function(e,t,n){const r=function(e,t,n,r){const a={a:e,b:t,cnt:1},i=(...e)=>{a.cnt++;const t=a.a;a.a=0;try{return r(t,a.b,...e)}finally{0===--a.cnt?n(t,a.b):a.a=t}};return i.original=a,i}(e,t,T,b);return u(r)},e.wbg.__wbindgen_debug_string=function(e,t){const n=g(w(d(t)),r.__wbindgen_malloc,r.__wbindgen_realloc),a=m;v()[e/4+1]=a,v()[e/4+0]=n},e.wbg.__wbindgen_error_new=function(e,t){return u(new Error(o(e,t)))},e.wbg.__wbindgen_is_undefined=function(e){return d(e)===undefined},e.wbg.__wbindgen_memory=function(){return u(r.memory)},e.wbg.__wbindgen_object_drop_ref=function(e){p(e)},e.wbg.__wbindgen_string_get=function(e,t){const n=d(t),a="string"==typeof n?n:undefined;var i,s=(i=a)===undefined||null===i?0:g(a,r.__wbindgen_malloc,r.__wbindgen_realloc),o=m;v()[e/4+1]=o,v()[e/4+0]=s},e.wbg.__wbindgen_string_new=function(e,t){return u(o(e,t))},e.wbg.__wbindgen_throw=function(e,t){throw new Error(o(e,t))},e}function A(e,t){return r=e.exports,C.__wbindgen_wasm_module=t,y=null,k=null,i=null,r.__wbindgen_start(),r}async function C(e){if(r!==undefined)return r;const t=S();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:a}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return A(n,a)}n.PPOM=P;n.default=C}}},{package:"$root$",file:"app/scripts/lib/ppom/ppom.js"}],[3090,{"../logger.cjs":3094},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,a,i,s=this&&this.__classPrivateFieldSet||function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.Bundler=void 0;const c=e("../logger.cjs"),l=(0,c.createModuleLogger)(c.projectLogger,"bundler");n.Bundler=class{constructor(e){r.add(this),a.set(this,void 0),s(this,a,e,"f")}async estimateUserOperationGas(e,t){l("Estimating gas",{url:o(this,a,"f"),userOperation:e,entrypoint:t});const n=await o(this,r,"m",i).call(this,"eth_estimateUserOperationGas",[e,t]);return l("Estimated gas",{response:n}),n}async getUserOperationReceipt(e){return l("Getting user operation receipt",{url:o(this,a,"f"),hash:e}),await o(this,r,"m",i).call(this,"eth_getUserOperationReceipt",[e])}async sendUserOperation(e,t){l("Sending user operation",{url:o(this,a,"f"),userOperation:e,entrypoint:t});const n=await o(this,r,"m",i).call(this,"eth_sendUserOperation",[e,t]);return l("Sent user operation",n),n}},a=new WeakMap,r=new WeakSet,i=async function(e,t){const n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:e,params:t})},r=await fetch(o(this,a,"f"),n),i=await r.json();if(i.error){const e=new Error(i.error.message||i.error);throw e.code=i.error.code,e}return i.result}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/Bundler.cjs"}],[3091,{"../logger.cjs":3094,"../types.cjs":3095,"./Bundler.cjs":3090,"@metamask/controller-utils":1449,"@metamask/eth-query":1991,"@metamask/polling-controller":3104,"@metamask/utils":3116,events:4384},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,a,i,s,o,c,l,u,d,p,m,h=this&&this.__classPrivateFieldSet||function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.PendingUserOperationTracker=void 0;const y=e("@metamask/controller-utils"),v=g(e("@metamask/eth-query")),w=e("@metamask/polling-controller"),b=e("@metamask/utils"),T=g(e("events")),k=e("../logger.cjs"),_=e("../types.cjs"),E=e("./Bundler.cjs"),P=(0,b.createModuleLogger)(k.projectLogger,"pending-user-operations");class S extends((0,w.BlockTrackerPollingControllerOnly)()){constructor({getUserOperations:e,messenger:t}){super(),r.add(this),a.set(this,void 0),i.set(this,void 0),this.hub=new T.default,h(this,a,e,"f"),h(this,i,t,"f")}async _executePoll({networkClientId:e}){try{const{blockTracker:t,configuration:n,provider:a}=this._getNetworkClientById(e);P("Polling",{blockNumber:t.getCurrentBlock(),chainId:n.chainId}),await f(this,r,"m",s).call(this,n.chainId,a)}catch(e){P("Failed to check user operations",e)}}_getNetworkClientById(e){return f(this,i,"f").call("NetworkController:getNetworkClientById",e)}}n.PendingUserOperationTracker=S,a=new WeakMap,i=new WeakMap,r=new WeakSet,s=async function(e,t){const n=f(this,r,"m",u).call(this).filter(t=>t.chainId===e);n.length?(P("Found pending user operations to check",{count:n.length,ids:n.map(e=>e.id)}),await Promise.all(n.map(e=>f(this,r,"m",o).call(this,e,t)))):P("No pending user operations to check")},o=async function(e,t){const{bundlerUrl:n,hash:a,id:i}=e;if(a&&n)try{const s=await f(this,r,"m",p).call(this,a,n),o=s?.success;if(s&&!o)return void f(this,r,"m",l).call(this,e,s);if(o)return void await f(this,r,"m",c).call(this,e,s,t);P("No receipt found for user operation",{id:i,hash:a})}catch(e){P("Failed to check user operation",i,e)}else P("Skipping user operation as missing hash or bundler",i)},c=async function(e,t,n){const{id:a}=e,{actualGasCost:i,actualGasUsed:s,receipt:{blockHash:o,transactionHash:c}}=t;P("User operation confirmed",a,c);const{baseFeePerGas:l}=await(0,y.query)(new v.default(n),"getBlockByHash",[o,!1]);e.actualGasCost=f(this,r,"m",m).call(this,i),e.actualGasUsed=f(this,r,"m",m).call(this,s),e.baseFeePerGas=l,e.status=_.UserOperationStatus.Confirmed,e.transactionHash=c,f(this,r,"m",d).call(this,e),this.hub.emit("user-operation-confirmed",e)},l=function(e,t){const{id:n}=e;P("User operation failed",n),e.status=_.UserOperationStatus.Failed,f(this,r,"m",d).call(this,e),this.hub.emit("user-operation-failed",e,new Error("User operation receipt has failed status"))},u=function(){return f(this,a,"f").call(this).filter(e=>e.status===_.UserOperationStatus.Submitted)},d=function(e){this.hub.emit("user-operation-updated",e)},p=async function(e,t){return new E.Bundler(t).getUserOperationReceipt(e)},m=function(e){return"number"==typeof e?(0,y.toHex)(e):e}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/PendingUserOperationTracker.cjs"}],[3092,{"../constants.cjs":3089,"../utils/chain-id.cjs":3096},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,a=this&&this.__classPrivateFieldSet||function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapSmartContractAccount=void 0;const s=e("../constants.cjs"),o=e("../utils/chain-id.cjs");n.SnapSmartContractAccount=class{constructor(e){r.set(this,void 0),a(this,r,e,"f")}async prepareUserOperation(e){const{chainId:t,data:n,from:a,to:c,value:l}=e,u=n??s.EMPTY_BYTES,d=c??s.ADDRESS_ZERO,p=l??s.VALUE_ZERO,m=await i(this,r,"f").call("KeyringController:prepareUserOperation",a,[{data:u,to:d,value:p}],{chainId:(0,o.toEip155ChainId)(t)}),{bundlerUrl:h,callData:f,dummyPaymasterAndData:g,dummySignature:y,gasLimits:v,initCode:w,nonce:b}=m;return{bundler:h,callData:f,dummyPaymasterAndData:g,dummySignature:y,gas:v,initCode:w,nonce:b,sender:a}}async updateUserOperation(e){const{userOperation:t,chainId:n}=e,{sender:a}=t,{paymasterAndData:c,verificationGasLimit:l,preVerificationGas:u,callGasLimit:d}=await i(this,r,"f").call("KeyringController:patchUserOperation",a,t,{chainId:(0,o.toEip155ChainId)(n)});return{paymasterAndData:c===s.EMPTY_BYTES?undefined:c,verificationGasLimit:l,preVerificationGas:u,callGasLimit:d}}async signUserOperation(e){const{userOperation:t,chainId:n}=e,{sender:a}=t;return{signature:await i(this,r,"f").call("KeyringController:signUserOperation",a,t,{chainId:(0,o.toEip155ChainId)(n)})}}},r=new WeakMap}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/SnapSmartContractAccount.cjs"}],[3093,{"./UserOperationController.cjs":3088,"./types.cjs":3095},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./UserOperationController.cjs"),n),a(e("./types.cjs"),n)}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/index.cjs"}],[3094,{"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.projectLogger=void 0;const r=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return r.createModuleLogger}}),n.projectLogger=(0,r.createProjectLogger)("user-operation-controller")}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/logger.cjs"}],[3095,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;Object.defineProperty(n,"__esModule",{value:!0}),n.UserOperationStatus=void 0,function(e){e.Unapproved="unapproved",e.Approved="approved",e.Signed="signed",e.Submitted="submitted",e.Failed="failed",e.Confirmed="confirmed"}(r||(n.UserOperationStatus=r={}))}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/types.cjs"}],[3096,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toEip155ChainId=void 0,n.toEip155ChainId=function(e){const t=Number(e);return Number.isInteger(t)?t.toString():e}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/chain-id.cjs"}],[3097,{"../constants.cjs":3089,"../logger.cjs":3094,"@metamask/controller-utils":1449,"@metamask/eth-query":1991,"@metamask/gas-fee-controller":2079,"@metamask/transaction-controller":2994,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.updateGasFees=void 0;const a=e("@metamask/controller-utils"),i=r(e("@metamask/eth-query")),s=e("@metamask/gas-fee-controller"),o=e("@metamask/transaction-controller"),c=e("@metamask/utils"),l=e("../constants.cjs"),u=e("../logger.cjs"),d=(0,u.createModuleLogger)(u.projectLogger,"gas-fees");function p(e){return(0,a.toHex)((0,a.gweiDecToWEIBN)(e))}function m(e){return!e||e===l.EMPTY_BYTES}n.updateGasFees=async function(e){const{metadata:t,originalRequest:n,transaction:r}=e,{userOperation:l}=t;let u;const h=async()=>(u||(u=await async function(e){const{getGasFeeEstimates:t,provider:n}=e;try{const{gasFeeEstimates:e,gasEstimateType:n}=await t();if(n===s.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:n}={}}=e;if(t&&n){const e={maxFeePerGas:p(n),maxPriorityFeePerGas:p(t)};return d("Using medium values from fee market estimate",e),e}}if(n===s.GAS_ESTIMATE_TYPES.LEGACY){const t=p(e.medium);return d("Using medium value from legacy estimate",t),{maxFeePerGas:t}}if(n===s.GAS_ESTIMATE_TYPES.ETH_GASPRICE){const t=p(e.gasPrice);return d("Using gasPrice from estimate",t),{maxFeePerGas:t}}}catch(e){d("Failed to get estimate",e)}const r=await(0,a.query)(new i.default(n),"gasPrice");if(!r)return{};const o=(0,c.add0x)(r.toString(16));return d("Using gasPrice from network as fallback",o),{maxFeePerGas:o}}(e)),u);l.maxFeePerGas=await async function(e,t,n){const{maxFeePerGas:r,maxPriorityFeePerGas:a}=e,{gasPrice:i}=n??{};if(!m(r))return d("Using maxFeePerGas from request",r),r;if(m(a)&&i)return d("Setting maxFeePerGas to transaction gasPrice",i),i;const{maxFeePerGas:s}=await t();if(!s)throw new Error("Failed to get gas fee estimate for maxFeePerGas");return d("Using maxFeePerGas from estimate",s),s}(n,h,r),l.maxPriorityFeePerGas=await async function(e,t,n,r){const{maxFeePerGas:a,maxPriorityFeePerGas:i}=e,{gasPrice:s}=r??{},{maxFeePerGas:o}=n;if(!m(i))return d("Using maxPriorityFeePerGas from request",i),i;if(m(a)&&s)return d("Setting maxPriorityFeePerGas to transaction gasPrice",s),s;const{maxPriorityFeePerGas:c}=await t();if(c)return d("Using maxPriorityFeePerGas from estimate",c),c;return d("Setting maxPriorityFeePerGas to maxFeePerGas",o),o}(n,h,l,r),t.userFeeLevel=function(e,t,n,r){const{origin:i}=e,{maxFeePerGas:s,maxPriorityFeePerGas:c}=t,{maxFeePerGas:l,maxPriorityFeePerGas:u}=n||{};if(m(s)&&m(c)&&r?.gasPrice)return i===a.ORIGIN_METAMASK?o.UserFeeLevel.CUSTOM:o.UserFeeLevel.DAPP_SUGGESTED;if(m(s)&&m(c)&&l&&u)return o.UserFeeLevel.MEDIUM;if(i===a.ORIGIN_METAMASK)return o.UserFeeLevel.CUSTOM;return o.UserFeeLevel.DAPP_SUGGESTED}(t,n,u,r)}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/gas-fees.cjs"}],[3098,{"../constants.cjs":3089,"../helpers/Bundler.cjs":3090,"../logger.cjs":3094,"@metamask/controller-utils":1449,"@metamask/utils":3116,"bn.js":4023},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.updateGas=void 0;const a=e("@metamask/controller-utils"),i=e("@metamask/utils"),s=r(e("bn.js")),o=e("../constants.cjs"),c=e("../helpers/Bundler.cjs"),l=e("../logger.cjs"),u=(0,l.createModuleLogger)(l.projectLogger,"gas");function d(e){const t=("string"==typeof e?(0,a.hexToBN)(e):new s.default(e)).muln(1.5);return(0,i.add0x)(t.toString(16))}n.updateGas=async function(e,t,n){const{userOperation:r}=e;if(t.gas)return r.callGasLimit=t.gas.callGasLimit,r.preVerificationGas=t.gas.preVerificationGas,r.verificationGasLimit=t.gas.verificationGasLimit,void u("Using gas values from smart contract account",{callGasLimit:r.callGasLimit,preVerificationGas:r.preVerificationGas,verificationGasLimit:r.verificationGasLimit});const a={...r,maxFeePerGas:o.VALUE_ZERO,maxPriorityFeePerGas:o.VALUE_ZERO,callGasLimit:o.VALUE_ZERO,preVerificationGas:o.VALUE_ZERO,verificationGasLimit:"0xF4240"},i=new c.Bundler(e.bundlerUrl),s=await i.estimateUserOperationGas(a,n);r.callGasLimit=d(s.callGasLimit),r.preVerificationGas=d(s.preVerificationGas),r.verificationGasLimit=d(s.verificationGasLimit??s.verificationGas),u("Using buffered gas values from bundler estimate",{callGasLimit:r.callGasLimit,preVerificationGas:r.preVerificationGas,verificationGasLimit:r.verificationGasLimit,multiplier:1.5,estimate:s})}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/gas.cjs"}],[3099,{"../constants.cjs":3089,"../types.cjs":3095,"@metamask/transaction-controller":2994,"@metamask/utils":3116,"bn.js":4023},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getTransactionMetadata=void 0;const a=e("@metamask/transaction-controller"),i=e("@metamask/utils"),s=r(e("bn.js")),o=e("../constants.cjs"),c=e("../types.cjs");n.getTransactionMetadata=function(e){const{actualGasCost:t,actualGasUsed:n,baseFeePerGas:r,chainId:l,error:u,origin:d,transactionHash:p,id:m,swapsMetadata:h,time:f,transactionParams:g,transactionType:y,userFeeLevel:v,userOperation:w}=e;if(!g)return undefined;const b=t&&n?(0,i.add0x)(new s.default((0,i.remove0x)(t),16).div(new s.default((0,i.remove0x)(n),16)).toString(16)):undefined,T=u?{name:u.name,message:u.message,stack:u.stack,code:u.code,rpc:u.rpc}:undefined,k={[c.UserOperationStatus.Unapproved]:a.TransactionStatus.unapproved,[c.UserOperationStatus.Approved]:a.TransactionStatus.approved,[c.UserOperationStatus.Signed]:a.TransactionStatus.signed,[c.UserOperationStatus.Submitted]:a.TransactionStatus.submitted,[c.UserOperationStatus.Confirmed]:a.TransactionStatus.confirmed,[c.UserOperationStatus.Failed]:a.TransactionStatus.failed}[e.status],_=function(...e){const t=new s.default(0);for(const n of e)n&&t.iadd(new s.default((0,i.remove0x)(n),16));return(0,i.add0x)(t.toString(16))}(w.preVerificationGas,w.verificationGasLimit,w.callGasLimit),E=w.paymasterAndData!==o.EMPTY_BYTES,P=E?o.VALUE_ZERO:w.maxFeePerGas,S=E?o.VALUE_ZERO:w.maxPriorityFeePerGas,A=w.nonce===o.EMPTY_BYTES?undefined:w.nonce,C={...g,from:w.sender,gas:_,nonce:A,maxFeePerGas:P,maxPriorityFeePerGas:S};delete C.gasPrice;const O={approvalTxId:h?.approvalTxId??undefined,destinationTokenAddress:h?.destinationTokenAddress??undefined,destinationTokenAmount:h?.destinationTokenAmount??undefined,destinationTokenDecimals:h?.destinationTokenDecimals??undefined,destinationTokenSymbol:h?.destinationTokenSymbol??undefined,estimatedBaseFee:h?.estimatedBaseFee??undefined,sourceTokenAddress:h?.sourceTokenAddress??undefined,sourceTokenAmount:h?.sourceTokenAmount??undefined,sourceTokenDecimals:h?.sourceTokenDecimals??undefined,sourceTokenSymbol:h?.sourceTokenSymbol??undefined,swapAndSendRecipient:h?.swapAndSendRecipient??undefined,swapMetaData:h?.swapMetaData??undefined,swapTokenValue:h?.swapTokenValue??undefined},M=E?a.UserFeeLevel.CUSTOM:v;return{baseFeePerGas:r??undefined,chainId:l,error:T,hash:p??undefined,id:m,isUserOperation:!0,networkClientId:"user-operation",origin:d,status:k,time:f,txParams:C,txReceipt:{effectiveGasPrice:b??undefined,gasUsed:n??undefined},type:y??undefined,userFeeLevel:M,...O}}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/transaction.cjs"}],[31,{"../../../shared/constants/bridge":5777,"../../../shared/constants/time":5812,"../../../shared/lib/fetch-with-cache":5870,"../../../shared/lib/trace":5897,"../lib/util":372,"@metamask/bridge-controller":1369,"@metamask/controller-utils":1449},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BridgeControllerInit=void 0;var r,a=e("@metamask/bridge-controller"),i=e("@metamask/controller-utils"),s=e("../../../shared/constants/bridge"),o=e("../../../shared/lib/trace"),c=(r=e("../../../shared/lib/fetch-with-cache"))&&r.__esModule?r:{default:r},l=e("../../../shared/constants/time"),u=e("../lib/util");n.BridgeControllerInit=({controllerMessenger:e,initMessenger:t,getController:n})=>{const r=n("TransactionController");return{persistedStateKey:null,memStateKey:null,controller:new a.BridgeController({messenger:e,clientId:a.BridgeClientId.EXTENSION,clientVersion:"13.15.0",getLayer1GasFee:(...e)=>r.getLayer1GasFee(...e),fetchFn:async(e,t)=>{const n=e.toString();if(n.includes("getTokens"))return await(0,c.default)({url:n,fetchOptions:{method:"GET",...t},cacheOptions:{cacheRefreshTime:10*l.MINUTE},functionName:"fetchBridgeTokens"});if(n.includes("spot-prices"))return await(0,c.default)({url:n,fetchOptions:{method:"GET",...t},cacheOptions:{cacheRefreshTime:30*l.SECOND},functionName:"fetchAssetExchangeRates"});if(n.includes("getQuote?"))return await(0,i.handleFetch)(e,{method:"GET",...t});const r=await fetch(e,t);if(!r.ok)throw new i.HttpError(r.status,`Fetch failed with status '${r.status}' for request ${n}`);return r},trackMetaMetricsFn:(e,n)=>{const r=(Date.now()+Math.random()).toString();t.call("MetaMetricsController:trackEvent",{category:a.UNIFIED_SWAP_BRIDGE_EVENT_CATEGORY,event:e,properties:{...n??{},environmentType:(0,u.getEnvironmentType)(),actionId:r}})},traceFn:(...e)=>(0,o.trace)(...e),config:{customBridgeApiBaseUrl:s.BRIDGE_API_BASE_URL}})}}}}},{package:"$root$",file:"app/scripts/controller-init/bridge-controller-init.ts"}],[3100,{"../constants.cjs":3089,"@metamask/superstruct":2936,"@metamask/transaction-controller":2994,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSignUserOperationResponse=n.validateUpdateUserOperationResponse=n.validatePrepareUserOperationResponse=n.validateAddUserOperationOptions=n.validateAddUserOperationRequest=void 0;const r=e("@metamask/superstruct"),a=e("@metamask/transaction-controller"),i=e("@metamask/utils"),s=e("../constants.cjs");function o(e,t,n){try{(0,r.assert)(e,t,n)}catch(e){const t=e.failures().map(e=>e.path.length?`${e.path.join(".")} - ${e.message}`:e.message).join("\n");throw new Error(`${n}\n${t}`)}}function c(){return(0,r.define)("Hexadecimal String",e=>(0,i.isStrictHexString)(e))}function l(){return(0,r.define)("Hexadecimal String or 0x",e=>(0,i.isStrictHexString)(e)||e===s.EMPTY_BYTES)}n.validateAddUserOperationRequest=function(e){const t=c(),n=l();o(e,(0,r.object)({data:(0,r.optional)(n),from:t,maxFeePerGas:(0,r.optional)(t),maxPriorityFeePerGas:(0,r.optional)(t),to:(0,r.optional)(t),value:(0,r.optional)(t)}),"Invalid request to add user operation")},n.validateAddUserOperationOptions=function(e){o(e,(0,r.object)({networkClientId:(0,r.string)(),origin:(0,r.string)(),requireApproval:(0,r.optional)((0,r.boolean)()),smartContractAccount:(0,r.optional)((0,r.object)({prepareUserOperation:(0,r.func)(),updateUserOperation:(0,r.func)(),signUserOperation:(0,r.func)()})),swaps:(0,r.optional)((0,r.object)({approvalTxId:(0,r.optional)((0,r.string)()),destinationTokenAddress:(0,r.optional)((0,r.string)()),destinationTokenDecimals:(0,r.optional)((0,r.number)()),destinationTokenSymbol:(0,r.optional)((0,r.string)()),estimatedBaseFee:(0,r.optional)((0,r.string)()),sourceTokenSymbol:(0,r.optional)((0,r.string)()),swapMetaData:(0,r.optional)((0,r.object)()),swapTokenValue:(0,r.optional)((0,r.string)()),destinationTokenAmount:(0,r.optional)((0,r.string)()),sourceTokenAddress:(0,r.optional)((0,r.string)()),sourceTokenAmount:(0,r.optional)((0,r.string)()),sourceTokenDecimals:(0,r.optional)((0,r.number)()),swapAndSendRecipient:(0,r.optional)((0,r.string)())})),type:(0,r.optional)((0,r.enums)(Object.values(a.TransactionType)))}),"Invalid options to add user operation")},n.validatePrepareUserOperationResponse=function(e){const t=c(),n=l();o(e,(0,r.refine)((0,r.object)({bundler:(0,r.string)(),callData:t,dummyPaymasterAndData:(0,r.optional)(n),dummySignature:(0,r.optional)(n),gas:(0,r.optional)((0,r.object)({callGasLimit:t,preVerificationGas:t,verificationGasLimit:t})),initCode:(0,r.optional)(n),nonce:t,sender:t}),"ValidPrepareUserOperationResponse",({gas:e,dummySignature:t})=>!!(e||t&&t!==s.EMPTY_BYTES)||"Must specify dummySignature if not specifying gas"),"Invalid response when preparing user operation")},n.validateUpdateUserOperationResponse=function(e){o(e,(0,r.optional)((0,r.object)({paymasterAndData:(0,r.optional)(l()),callGasLimit:(0,r.optional)(l()),preVerificationGas:(0,r.optional)(l()),verificationGasLimit:(0,r.optional)(l())})),"Invalid response when updating user operation")},n.validateSignUserOperationResponse=function(e){const t=c();o(e,(0,r.object)({signature:t}),"Invalid response when signing user operation")}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/validation.cjs"}],[3101,{"fast-json-stable-stringify":4398,uuid:5734},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AbstractPollingControllerBaseMixin=n.getKey=void 0;const i=a(e("fast-json-stable-stringify")),s=e("uuid");n.getKey=e=>(0,i.default)(e),n.AbstractPollingControllerBaseMixin=function(e){var t,a;return t=new WeakMap,a=new WeakMap,class extends e{constructor(){super(...arguments),t.set(this,new Map),a.set(this,new Map)}startPolling(e){const a=(0,s.v4)(),i=(0,n.getKey)(e),o=r(this,t,"f").get(i)??new Set;return o.add(a),r(this,t,"f").set(i,o),1===o.size&&this._startPolling(e),a}stopAllPolling(){r(this,t,"f").forEach((e,t)=>{e.forEach(e=>{this.stopPollingByPollingToken(e)})})}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");let n=null;for(const[a,i]of r(this,t,"f"))if(i.delete(e)){0===i.size&&(n=a);break}if(n){this._stopPollingByPollingTokenSetId(n),r(this,t,"f").delete(n);const e=r(this,a,"f").get(n);if(e){for(const t of e)t(JSON.parse(n));e.clear()}}}onPollingComplete(e,t){const i=(0,n.getKey)(e),s=r(this,a,"f").get(i)??new Set;s.add(t),r(this,a,"f").set(i,s)}}}}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/AbstractPollingController.cjs"}],[3102,{"./AbstractPollingController.cjs":3101,"@metamask/base-controller":1362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.BlockTrackerPollingController=n.BlockTrackerPollingControllerOnly=void 0;const a=e("@metamask/base-controller"),i=e("./AbstractPollingController.cjs");function s(e){var t;class n extends((0,i.AbstractPollingControllerBaseMixin)(e)){constructor(){super(...arguments),t.set(this,{})}_startPolling(e){const n=(0,i.getKey)(e);if(r(this,t,"f")[n])return;const a=this._getNetworkClientById(e.networkClientId);if(!a)throw new Error(`Unable to retrieve blockTracker for networkClientId ${e.networkClientId}`);{const i=this._executePoll.bind(this,e);a.blockTracker.addListener("latest",i),r(this,t,"f")[n]=i}}_stopPollingByPollingTokenSetId(e){const{networkClientId:n}=JSON.parse(e),a=this._getNetworkClientById(n);if(a&&r(this,t,"f")[e]){const n=r(this,t,"f")[e];n&&(a.blockTracker.removeListener("latest",n),delete r(this,t,"f")[e])}}}return t=new WeakMap,n}class o{}n.BlockTrackerPollingControllerOnly=()=>s(o);n.BlockTrackerPollingController=()=>s(a.BaseController)}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/BlockTrackerPollingController.cjs"}],[3103,{"./AbstractPollingController.cjs":3101,"@metamask/base-controller":1362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__classPrivateFieldSet||function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.StaticIntervalPollingController=n.StaticIntervalPollingControllerOnly=void 0;const i=e("@metamask/base-controller"),s=e("./AbstractPollingController.cjs");function o(e){var t,n;class i extends((0,s.AbstractPollingControllerBaseMixin)(e)){constructor(){super(...arguments),t.set(this,{}),n.set(this,1e3)}setIntervalLength(e){r(this,n,e,"f")}getIntervalLength(){return a(this,n,"f")}_startPolling(e){if(!a(this,n,"f"))throw new Error("intervalLength must be defined and greater than 0");const r=(0,s.getKey)(e),i=a(this,t,"f")[r];this._stopPollingByPollingTokenSetId(r);const o=a(this,t,"f")[r]=setTimeout(async()=>{try{await this._executePoll(e)}catch(e){console.error(e)}o===a(this,t,"f")[r]&&this._startPolling(e)},i?a(this,n,"f"):0)}_stopPollingByPollingTokenSetId(e){const n=a(this,t,"f")[e];n&&(clearTimeout(n),delete a(this,t,"f")[e])}}return t=new WeakMap,n=new WeakMap,i}class c{}n.StaticIntervalPollingControllerOnly=()=>o(c);n.StaticIntervalPollingController=()=>o(i.BaseController)}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/StaticIntervalPollingController.cjs"}],[3104,{"./BlockTrackerPollingController.cjs":3102,"./StaticIntervalPollingController.cjs":3103},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.StaticIntervalPollingController=n.StaticIntervalPollingControllerOnly=n.BlockTrackerPollingController=n.BlockTrackerPollingControllerOnly=void 0;var r=e("./BlockTrackerPollingController.cjs");Object.defineProperty(n,"BlockTrackerPollingControllerOnly",{enumerable:!0,get:function(){return r.BlockTrackerPollingControllerOnly}}),Object.defineProperty(n,"BlockTrackerPollingController",{enumerable:!0,get:function(){return r.BlockTrackerPollingController}});var a=e("./StaticIntervalPollingController.cjs");Object.defineProperty(n,"StaticIntervalPollingControllerOnly",{enumerable:!0,get:function(){return a.StaticIntervalPollingControllerOnly}}),Object.defineProperty(n,"StaticIntervalPollingController",{enumerable:!0,get:function(){return a.StaticIntervalPollingController}})}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/index.cjs"}],[311,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.qrKeyringBuilderFactory=function(e,t,n){const r=()=>new e({bridge:new t(n)});return r.type=e.type,r}}}},{package:"$root$",file:"app/scripts/lib/qr-keyring-builder-factory.ts"}],[312,{"./handlers":318,"./handlers/wallet-getPermissions":323,"./handlers/wallet-requestPermissions":324,"./handlers/wallet-revokePermissions":325,"@metamask/rpc-errors":2600,"@metamask/snaps-rpc-methods":2730,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMultichainMethodMiddleware=n.createEthAccountsMethodMiddleware=n.createEip1193MethodMiddleware=void 0,n.makeMethodMiddlewareMaker=u;var r=e("@metamask/rpc-errors"),a=e("@metamask/snaps-rpc-methods"),i=e("@metamask/utils"),s=e("./handlers"),o=e("./handlers/wallet-getPermissions"),c=e("./handlers/wallet-requestPermissions"),l=e("./handlers/wallet-revokePermissions");n.createEip1193MethodMiddleware=u([...s.handlers,...s.eip1193OnlyHandlers,o.getPermissionsHandler,c.requestPermissionsHandler,l.revokePermissionsHandler]),n.createEthAccountsMethodMiddleware=u([s.ethAccountsHandler]),n.createMultichainMethodMiddleware=u(s.handlers);function u(e){const t=e.reduce((e,t)=>{for(const n of t.methodNames)e[n]=t;return e},{}),n=new Set(e.flatMap(({hookNames:e})=>Object.getOwnPropertyNames(e)));return e=>{!function(e,t){const n=[];if(t.forEach(t=>{(0,i.hasProperty)(e,t)||n.push(t)}),n.length>0)throw new Error(`Missing expected hooks:\n\n${n.join("\n")}\n`);const r=Object.getOwnPropertyNames(e).filter(e=>!t.has(e));if(r.length>0)throw new Error(`Received unexpected hooks:\n\n${r.join("\n")}\n`)}(e,n);return async(n,i,s,o)=>{const c=t[n.method];if(c){const{implementation:t,hookNames:l}=c;try{return await t(n,i,s,o,(0,a.selectHooks)(e,l))}catch(e){return o(e instanceof Error?e:r.rpcErrors.internal({data:e}))}}return s()}}}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createMethodMiddleware.js"}],[3129,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var a=e.charAt(r),i=a.charCodeAt(0);if(255!==t[i])throw new TypeError(a+" is ambiguous");t[i]=r}var s=e.length,o=e.charAt(0),c=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var n=0;if(" "!==e[n]){for(var r=0,a=0;e[n]===o;)r++,n++;for(var i=(e.length-n)*c+1>>>0,l=new Uint8Array(i);e[n];){var u=t[e.charCodeAt(n)];if(255===u)return;for(var d=0,p=i-1;(0!==u||d<a)&&-1!==p;p--,d++)u+=s*l[p]>>>0,l[p]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");a=d,n++}if(" "!==e[n]){for(var m=i-a;m!==i&&0===l[m];)m++;for(var h=new Uint8Array(r+(i-m)),f=r;m!==i;)h[f++]=l[m++];return h}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,a=0,i=t.length;a!==i&&0===t[a];)a++,n++;for(var c=(i-a)*l+1>>>0,u=new Uint8Array(c);a!==i;){for(var d=t[a],p=0,m=c-1;(0!==d||p<r)&&-1!==m;m--,p++)d+=256*u[m]>>>0,u[m]=d%s>>>0,d=d/s>>>0;if(0!==d)throw new Error("Non-zero carry");r=p,a++}for(var h=c-r;h!==c&&0===u[h];)h++;for(var f=o.repeat(n);h<c;++h)f+=e.charAt(u[h]);return f},decodeUnsafe:u,decode:function(e){var t=u(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}}}},{package:"@ensdomains/content-hash>cids>multibase>@multiformats/base-x",file:"node_modules/@multiformats/base-x/src/index.js"}],[313,{"../../../../shared/constants/network":5795,"@metamask/rpc-errors":2600},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createUnsupportedMethodMiddleware=function(e=a.UNSUPPORTED_RPC_METHODS){return async function(t,n,a,i){return e.has(t.method)?i(r.rpcErrors.methodNotSupported()):a()}};var r=e("@metamask/rpc-errors"),a=e("../../../../shared/constants/network")}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createUnsupportedMethodMiddleware.ts"}],[314,{"../../../../../shared/constants/app":5775,"../../../../../shared/constants/network":5795,"./ethereum-chain-utils":316,"@metamask/controller-utils":1449,"@metamask/network-controller":2319,"@metamask/rpc-errors":2600,lodash:4838,"uri-js":5708},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var s=a?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(e("uri-js")),a=e("@metamask/controller-utils"),i=e("@metamask/network-controller"),s=e("@metamask/rpc-errors"),o=e("lodash"),c=e("../../../../../shared/constants/app"),l=e("../../../../../shared/constants/network"),u=e("./ethereum-chain-utils");function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}const p={methodNames:[c.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN],implementation:async function(e,t,n,c,{addNetwork:d,updateNetwork:p,getNetworkConfigurationByChainId:m,setActiveNetwork:h,requestUserApproval:f,getCurrentChainIdForDomain:g,getCaveat:y,requestPermittedChainsPermissionIncrementalForOrigin:v,rejectApprovalRequestsForOrigin:w,setTokenNetworkFilter:b,setEnabledNetworks:T,getEnabledNetworks:k}){var _,E;let P;try{P=(0,u.validateAddEthereumChainParams)(e.params[0])}catch(e){return c(e)}const{chainId:S,chainName:A,firstValidBlockExplorerUrl:C,firstValidRPCUrl:O,ticker:M}=P,{origin:j}=e,I=g(j),R=m(S);if(R&&R.chainId===S&&R.nativeCurrency!==M)return c(s.rpcErrors.invalidParams({message:`nativeCurrency.symbol does not match currency symbol for a network the user already has added with the same chainId. Received:\n${M}`}));let x=R,N=null==R?void 0:R.rpcEndpoints.findIndex(({url:e})=>r.equal(e,O)),D=C?null==R?void 0:R.blockExplorerUrls.findIndex(e=>r.equal(e,C)):undefined;const F=!R||N!==R.defaultRpcEndpointIndex||C&&D!==R.defaultBlockExplorerUrlIndex;if(F)try{if(await f({origin:j,type:a.ApprovalType.AddEthereumChain,requestData:{chainId:S,rpcPrefs:{blockExplorerUrl:C},chainName:A,rpcUrl:O,ticker:M}}),R){const e=(0,o.cloneDeep)(R);-1===N&&(e.rpcEndpoints=[...e.rpcEndpoints,{url:O,type:i.RpcEndpointType.Custom,name:A}],N=e.rpcEndpoints.length-1),C&&(-1===D&&(e.blockExplorerUrls=[...e.blockExplorerUrls,C],D=e.blockExplorerUrls.length-1),e.defaultBlockExplorerUrlIndex=D),x=await p(e.chainId,e,I===S?{replacementSelectedRpcEndpointIndex:e.defaultRpcEndpointIndex}:undefined)}else{const e=l.FEATURED_RPCS.find(e=>e.chainId===S),t=e?e.rpcEndpoints[e.defaultRpcEndpointIndex]:undefined;x=await d({blockExplorerUrls:C?[C]:[],defaultBlockExplorerUrlIndex:C?0:undefined,chainId:S,defaultRpcEndpointIndex:0,name:A,nativeCurrency:M,rpcEndpoints:[...t&&!r.equal(O,t.url)?[t]:[],{url:O,name:A,type:i.RpcEndpointType.Custom}]})}}catch(e){return c(e)}const U=null==R||null===(_=R.rpcEndpoints)||void 0===_||null===(_=_[R.defaultRpcEndpointIndex])||void 0===_?void 0:_.networkClientId,B=null===(E=x)||void 0===E||null===(E=E.rpcEndpoints)||void 0===E||null===(E=E[x.defaultRpcEndpointIndex])||void 0===E?void 0:E.networkClientId,G=U??B;return(0,u.switchChain)(t,c,S,G,{isAddFlow:!0,autoApprove:F,setActiveNetwork:h,getCaveat:y,requestPermittedChainsPermissionIncrementalForOrigin:v,rejectApprovalRequestsForOrigin:w,setTokenNetworkFilter:b,setEnabledNetworks:T,getEnabledNetworks:k})},hookNames:{addNetwork:!0,updateNetwork:!0,getNetworkConfigurationByChainId:!0,setActiveNetwork:!0,requestUserApproval:!0,getCurrentChainIdForDomain:!0,getCaveat:!0,requestPermittedChainsPermissionIncrementalForOrigin:!0,rejectApprovalRequestsForOrigin:!0,setTokenNetworkFilter:!0,setEnabledNetworks:!0,getEnabledNetworks:!0}};n.default=p}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/add-ethereum-chain.js"}],[315,{"../../../../../shared/constants/app":5775},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.ETH_ACCOUNTS],implementation:async function(e,t,n,r,{getAccounts:a}){return t.result=a(),r()},hookNames:{getAccounts:!0}};n.default=r}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/eth-accounts.ts"}],[316,{"../../../../../shared/constants/app":5775,"../../../../../shared/modules/network.utils":5926,"../../util":372,"@metamask/chain-agnostic-permission":1420,"@metamask/controller-utils":1449,"@metamask/rpc-errors":2600,"@metamask/snaps-utils":2903,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.switchChain=async function(e,t,n,a,{origin:l,isAddFlow:u,isSwitchFlow:d,autoApprove:p,setActiveNetwork:m,getCaveat:h,requestPermittedChainsPermissionIncrementalForOrigin:f,setTokenNetworkFilter:g,setEnabledNetworks:y,getEnabledNetworks:v,rejectApprovalRequestsForOrigin:w,requestUserApproval:b,hasApprovalRequestsForOrigin:T,toNetworkConfiguration:k,fromNetworkConfiguration:_}){try{const E=h({target:i.Caip25EndowmentPermissionName,caveatType:i.Caip25CaveatType});if(E){if((0,i.getPermittedEthChainIds)(E.value).includes(n))null==T||!T()||u||p||await b({origin:l,type:r.ApprovalType.SwitchEthereumChain,requestData:{toNetworkConfiguration:k,fromNetworkConfiguration:_}});else{let e;d&&(e={isSwitchEthereumChain:!0}),await f({chainId:n,autoApprove:p,metadata:e})}}else await f({chainId:n,autoApprove:p});if((0,o.isSnapId)(l)||null==w||w(),await m(a),!(0,o.isSnapId)(l))if(g(n),(0,c.isPrefixedFormattedHexString)(n)){const e=v(s.KnownCaipNamespace.Eip155);Object.keys(e).includes(n)||y(n)}else{const{namespace:e}=(0,s.parseCaipChainId)(n),t=v(e);Object.keys(t).includes(n)||y(n)}return e.result=null,t()}catch(e){return t(e)}},n.validateAddEthereumChainParams=function(e){if(!e||"object"!=typeof e)throw a.rpcErrors.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e)}`});const{chainId:t,chainName:n,blockExplorerUrls:r,nativeCurrency:i,rpcUrls:s,...o}=e,c=Object.keys(o).filter(e=>!["iconUrls"].includes(e));if(c.length>0)throw a.rpcErrors.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${c}`});const p=d(t);if(!s||!Array.isArray(s)||0===s.length)throw a.rpcErrors.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${s}`});const m=e=>{const t=(0,u.getValidUrl)(e);return null!==t&&("localhost"===t.hostname||"127.0.0.1"===t.hostname||"https:"===t.protocol)},h=s.find(e=>m(e)),f=Array.isArray(r)?r.find(e=>m(e)):null;if(!h)throw a.rpcErrors.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${s}`});if("string"!=typeof n||!n)throw a.rpcErrors.invalidParams({message:`Expected non-empty string 'chainName'. Received:\n${n}`});const g=n.length>100?n.substring(0,100):n;if(null!==i){if("object"!=typeof i||Array.isArray(i))throw a.rpcErrors.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:\n${i}`});if(18!==i.decimals)throw a.rpcErrors.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${i.decimals}`});if(!i.symbol||"string"!=typeof i.symbol)throw a.rpcErrors.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${i.symbol}`})}const y=(null==i?void 0:i.symbol)||l.UNKNOWN_TICKER_SYMBOL;if(y!==l.UNKNOWN_TICKER_SYMBOL&&("string"!=typeof y||y.length<1||y.length>6))throw a.rpcErrors.invalidParams({message:`Expected 1-6 character string 'nativeCurrency.symbol'. Received:\n${y}`});return{chainId:p,chainName:g,firstValidBlockExplorerUrl:f,firstValidRPCUrl:h,ticker:y}},n.validateChainId=d,n.validateSwitchEthereumChainParams=function(e){var t;if(null===(t=e.params)||void 0===t||!t[0]||"object"!=typeof e.params[0])throw a.rpcErrors.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`});const{chainId:n,...r}=e.params[0];if(Object.keys(r).length>0)throw a.rpcErrors.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${Object.keys(r)}`});return d(n)};var r=e("@metamask/controller-utils"),a=e("@metamask/rpc-errors"),i=e("@metamask/chain-agnostic-permission"),s=e("@metamask/utils"),o=e("@metamask/snaps-utils"),c=e("../../../../../shared/modules/network.utils"),l=e("../../../../../shared/constants/app"),u=e("../../util");function d(e){const t="string"==typeof e?e.toLowerCase():null;if(!(0,c.isPrefixedFormattedHexString)(t))throw a.rpcErrors.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${e}`});if(!(0,c.isSafeChainId)(parseInt(e,16)))throw a.rpcErrors.invalidParams({message:`Invalid chain ID "${t}": numerical value greater than max safe value. Received:\n${e}`});return t}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/ethereum-chain-utils.js"}],[317,{"../../../../../shared/constants/app":5775},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.GET_PROVIDER_STATE],implementation:async function(e,t,n,r,{getProviderState:a}){var i;const s=null===(i=e.params)||void 0===i?void 0:i.isInitializingStreamProvider;return t.result={...await a(e.origin,{isInitializingStreamProvider:s})},r()},hookNames:{getProviderState:!0}};n.default=r}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/get-provider-state.ts"}],[3173,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.openrpcDocument=void 0,n.openrpcDocument={$schema:"https://meta.json-schema.tools/",$id:"https://meta.open-rpc.org/",title:"openrpcDocument",type:"object",required:["info","methods","openrpc"],additionalProperties:!1,patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}},properties:{openrpc:{title:"openrpc",type:"string",enum:["1.3.2","1.3.1","1.3.0","1.2.6","1.2.5","1.2.4","1.2.3","1.2.2","1.2.1","1.2.0","1.1.12","1.1.11","1.1.10","1.1.9","1.1.8","1.1.7","1.1.6","1.1.5","1.1.4","1.1.3","1.1.2","1.1.1","1.1.0","1.0.0","1.0.0-rc1","1.0.0-rc0"]},info:{$ref:"#/definitions/infoObject"},externalDocs:{$ref:"#/definitions/externalDocumentationObject"},servers:{title:"servers",type:"array",additionalItems:!1,items:{$ref:"#/definitions/serverObject"}},methods:{title:"methods",type:"array",additionalItems:!1,items:{title:"methodOrReference",oneOf:[{$ref:"#/definitions/methodObject"},{$ref:"#/definitions/referenceObject"}]}},components:{title:"components",type:"object",properties:{schemas:{title:"schemaComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/JSONSchema"}}},links:{title:"linkComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/linkObject"}}},errors:{title:"errorComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/errorObject"}}},examples:{title:"exampleComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/exampleObject"}}},examplePairings:{title:"examplePairingComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/examplePairingObject"}}},contentDescriptors:{title:"contentDescriptorComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/contentDescriptorObject"}}},tags:{title:"tagComponents",type:"object",patternProperties:{"[0-z]+":{$ref:"#/definitions/tagObject"}}}}},$schema:{title:"metaSchema",description:"JSON Schema URI (used by some editors)",type:"string",default:"https://meta.open-rpc.org/"}},definitions:{specificationExtension:{title:"specificationExtension"},JSONSchema:{$ref:"https://meta.json-schema.tools"},referenceObject:{title:"referenceObject",type:"object",additionalProperties:!1,required:["$ref"],properties:{$ref:{$ref:"https://meta.json-schema.tools/#/definitions/JSONSchemaObject/properties/$ref"}}},errorObject:{title:"errorObject",type:"object",description:"Defines an application level error.",additionalProperties:!1,required:["code","message"],properties:{code:{title:"errorObjectCode",description:"A Number that indicates the error type that occurred. This MUST be an integer. The error codes from and including -32768 to -32000 are reserved for pre-defined errors. These pre-defined errors SHOULD be assumed to be returned from any JSON-RPC api.",type:"integer"},message:{title:"errorObjectMessage",description:"A String providing a short description of the error. The message SHOULD be limited to a concise single sentence.",type:"string"},data:{title:"errorObjectData",description:"A Primitive or Structured value that contains additional information about the error. This may be omitted. The value of this member is defined by the Server (e.g. detailed error information, nested errors etc.)."}}},licenseObject:{title:"licenseObject",type:"object",additionalProperties:!1,properties:{name:{title:"licenseObjectName",type:"string"},url:{title:"licenseObjectUrl",type:"string"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},contactObject:{title:"contactObject",type:"object",additionalProperties:!1,properties:{name:{title:"contactObjectName",type:"string"},email:{title:"contactObjectEmail",type:"string"},url:{title:"contactObjectUrl",type:"string"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},infoObject:{title:"infoObject",type:"object",additionalProperties:!1,required:["title","version"],properties:{title:{title:"infoObjectProperties",type:"string"},description:{title:"infoObjectDescription",type:"string"},termsOfService:{title:"infoObjectTermsOfService",type:"string",format:"uri"},version:{title:"infoObjectVersion",type:"string"},contact:{$ref:"#/definitions/contactObject"},license:{$ref:"#/definitions/licenseObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},serverObject:{title:"serverObject",type:"object",required:["url"],additionalProperties:!1,properties:{url:{title:"serverObjectUrl",type:"string",format:"uri"},name:{title:"serverObjectName",type:"string"},description:{title:"serverObjectDescription",type:"string"},summary:{title:"serverObjectSummary",type:"string"},variables:{title:"serverObjectVariables",type:"object",patternProperties:{"[0-z]+":{title:"serverObjectVariable",type:"object",required:["default"],properties:{default:{title:"serverObjectVariableDefault",type:"string"},description:{title:"serverObjectVariableDescription",type:"string"},enum:{title:"serverObjectVariableEnum",type:"array",items:{title:"serverObjectVariableEnumItem",type:"string"}}}}}}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},linkObject:{title:"linkObject",type:"object",additionalProperties:!1,properties:{name:{title:"linkObjectName",type:"string",minLength:1},summary:{title:"linkObjectSummary",type:"string"},method:{title:"linkObjectMethod",type:"string"},description:{title:"linkObjectDescription",type:"string"},params:{title:"linkObjectParams"},server:{title:"linkObjectServer",$ref:"#/definitions/serverObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},externalDocumentationObject:{title:"externalDocumentationObject",type:"object",additionalProperties:!1,description:"information about external documentation",required:["url"],properties:{description:{title:"externalDocumentationObjectDescription",type:"string"},url:{title:"externalDocumentationObjectUrl",type:"string",format:"uri"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},methodObject:{title:"methodObject",type:"object",required:["name","params"],additionalProperties:!1,properties:{name:{title:"methodObjectName",description:"The cannonical name for the method. The name MUST be unique within the methods array.",type:"string",minLength:1},description:{title:"methodObjectDescription",description:"A verbose explanation of the method behavior. GitHub Flavored Markdown syntax MAY be used for rich text representation.",type:"string"},summary:{title:"methodObjectSummary",description:"A short summary of what the method does.",type:"string"},servers:{title:"servers",type:"array",additionalItems:!1,items:{$ref:"#/definitions/serverObject"}},tags:{title:"methodObjectTags",type:"array",items:{title:"tagOrReference",oneOf:[{$ref:"#/definitions/tagObject"},{$ref:"#/definitions/referenceObject"}]}},paramStructure:{title:"methodObjectParamStructure",type:"string",description:"Format the server expects the params. Defaults to 'either'.",enum:["by-position","by-name","either"],default:"either"},params:{title:"methodObjectParams",type:"array",items:{title:"contentDescriptorOrReference",oneOf:[{$ref:"#/definitions/contentDescriptorObject"},{$ref:"#/definitions/referenceObject"}]}},result:{title:"methodObjectResult",oneOf:[{$ref:"#/definitions/contentDescriptorObject"},{$ref:"#/definitions/referenceObject"}]},errors:{title:"methodObjectErrors",description:"Defines an application level error.",type:"array",items:{title:"errorOrReference",oneOf:[{$ref:"#/definitions/errorObject"},{$ref:"#/definitions/referenceObject"}]}},links:{title:"methodObjectLinks",type:"array",items:{title:"linkOrReference",oneOf:[{$ref:"#/definitions/linkObject"},{$ref:"#/definitions/referenceObject"}]}},examples:{title:"methodObjectExamples",type:"array",items:{title:"examplePairingOrReference",oneOf:[{$ref:"#/definitions/examplePairingObject"},{$ref:"#/definitions/referenceObject"}]}},deprecated:{title:"methodObjectDeprecated",type:"boolean",default:!1},externalDocs:{$ref:"#/definitions/externalDocumentationObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},tagObject:{title:"tagObject",type:"object",additionalProperties:!1,required:["name"],properties:{name:{title:"tagObjectName",type:"string",minLength:1},description:{title:"tagObjectDescription",type:"string"},externalDocs:{$ref:"#/definitions/externalDocumentationObject"}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},exampleObject:{title:"exampleObject",type:"object",required:["name","value"],properties:{summary:{title:"exampleObjectSummary",type:"string"},value:{title:"exampleObjectValue"},description:{title:"exampleObjectDescription",type:"string"},name:{title:"exampleObjectName",type:"string",minLength:1}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}},examplePairingObject:{title:"examplePairingObject",type:"object",required:["name","params"],properties:{name:{title:"examplePairingObjectName",type:"string",minLength:1},description:{title:"examplePairingObjectDescription",type:"string"},params:{title:"examplePairingObjectParams",type:"array",items:{title:"exampleOrReference",oneOf:[{$ref:"#/definitions/exampleObject"},{$ref:"#/definitions/referenceObject"}]}},result:{title:"examplePairingObjectResult",oneOf:[{$ref:"#/definitions/exampleObject"},{$ref:"#/definitions/referenceObject"}]}}},contentDescriptorObject:{title:"contentDescriptorObject",type:"object",additionalProperties:!1,required:["name","schema"],properties:{name:{title:"contentDescriptorObjectName",type:"string",minLength:1},description:{title:"contentDescriptorObjectDescription",type:"string"},summary:{title:"contentDescriptorObjectSummary",type:"string"},schema:{$ref:"#/definitions/JSONSchema"},required:{title:"contentDescriptorObjectRequired",type:"boolean",default:!1},deprecated:{title:"contentDescriptorObjectDeprecated",type:"boolean",default:!1}},patternProperties:{"^x-":{$ref:"#/definitions/specificationExtension"}}}}},n.default=n.openrpcDocument}}},{package:"@open-rpc/meta-schema",file:"node_modules/@open-rpc/meta-schema/index.js"}],[3174,{"@json-schema-tools/dereferencer":845,"@json-schema-tools/reference-resolver":849,"fast-safe-stringify":4399},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},r.apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,o)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.OpenRPCDocumentDereferencingError=void 0;var o=s(e("@json-schema-tools/dereferencer")),c=s(e("@json-schema-tools/reference-resolver")),l=s(e("fast-safe-stringify")),u=function(e){this.name="OpenRPCDocumentDereferencingError",this.message="The json schema provided cannot be dereferenced. Received Error: \n ".concat(e)};n.OpenRPCDocumentDereferencingError=u;var d=function(e,t,n){return a(void 0,void 0,void 0,function(){var r,a;return i(this,function(i){switch(i.label){case 0:if((r=e.$ref)===undefined)return[2,e];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.resolve(r,t)];case 2:return[2,i.sent()];case 3:throw a=i.sent(),new u(["unable to eval pointer against OpenRPC Document.","error type: ".concat(a.name),"instance: ".concat(a.instance),"token: ".concat(a.token),"pointer: ".concat(r),"reference object: ".concat((0,l.default)(e))].join("\n"));case 4:return[2]}})})},p=function(e,t,n){return a(void 0,void 0,void 0,function(){var r,a,s,o,c,l;return i(this,function(i){switch(i.label){case 0:r=[],a=0,s=e,i.label=1;case 1:return a<s.length?(o=s[a],l=(c=r).push,[4,d(o,t,n)]):[3,4];case 2:l.apply(c,[i.sent()]),i.label=3;case 3:return a++,[3,1];case 4:return[2,r]}})})},m=function(e,t){return a(void 0,void 0,void 0,function(){var n,r,a;return i(this,function(i){switch(i.label){case 0:if(!0===e||!1===e)return[2,Promise.resolve(e)];t!==undefined&&(e.components={schemas:t}),n=new o.default(e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.resolve()];case 2:return!0!==(r=i.sent())&&!1!==r&&(delete r.components,delete e.components),[2,r];case 3:throw a=i.sent(),new u(["Unable to parse reference inside of JSONSchema",e.title?"Schema Title: ".concat(e.title):"","error message: ".concat(a.message),"schema in question: ".concat((0,l.default)(e))].join("\n"));case 4:return[2]}})})},h=function(e){return a(void 0,void 0,void 0,function(){var t,n,r,a,s,o,c;return i(this,function(i){switch(i.label){case 0:if(e.components===undefined)return[2,Promise.resolve(e)];if(e.components.contentDescriptors===undefined)return[2,Promise.resolve(e)];t=e.components.contentDescriptors,n=Object.keys(t),r={},e.components.schemas&&(r=e.components.schemas),a=0,s=n,i.label=1;case 1:return a<s.length?(o=s[a],c=t[o],[4,m(t[o].schema,r)]):[3,4];case 2:c.schema=i.sent(),i.label=3;case 3:return a++,[3,1];case 4:return[2,e]}})})},f=function(e,t,n){return a(void 0,void 0,void 0,function(){var r,a,s,o,c,l,u,h,f,g,y,v,w,b,T,k,_,E,P,S;return i(this,function(i){switch(i.label){case 0:return r=e,e.$ref===undefined?[3,2]:[4,d({$ref:e.$ref},t,n)];case 1:r=i.sent(),i.label=2;case 2:return r.tags===undefined?[3,4]:(a=r,[4,p(r.tags,t,n)]);case 3:a.tags=i.sent(),i.label=4;case 4:return r.errors===undefined?[3,6]:(s=r,[4,p(r.errors,t,n)]);case 5:s.errors=i.sent(),i.label=6;case 6:return r.links===undefined?[3,8]:(o=r,[4,p(r.links,t,n)]);case 7:o.links=i.sent(),i.label=8;case 8:return r.examples===undefined?[3,14]:(c=r,[4,p(r.examples,t,n)]);case 9:c.examples=i.sent(),l=0,u=r.examples,i.label=10;case 10:return l<u.length?(h=u[l],f=h,[4,p(h.params,t,n)]):[3,14];case 11:return f.params=i.sent(),h.result===undefined?[3,13]:(g=h,[4,d(h.result,t,n)]);case 12:g.result=i.sent(),i.label=13;case 13:return l++,[3,10];case 14:return y=r,[4,p(r.params,t,n)];case 15:return y.params=i.sent(),r.result===undefined?[3,17]:(v=r,[4,d(r.result,t,n)]);case 16:v.result=i.sent(),i.label=17;case 17:w={},t.components&&t.components.schemas&&(w=t.components.schemas),b=r.params,T=0,k=b,i.label=18;case 18:return T<k.length?(_=k[T],E=_,[4,m(_.schema,w)]):[3,21];case 19:E.schema=i.sent(),i.label=20;case 20:return T++,[3,18];case 21:return r.result===undefined?[3,23]:(P=r.result,S=P,[4,m(P.schema,w)]);case 22:S.schema=i.sent(),i.label=23;case 23:return[2,r]}})})};n.default=function(e,t){return void 0===t&&(t=c.default),a(this,void 0,void 0,function(){var n,s,o,c,l,u,d;return i(this,function(p){switch(p.label){case 0:return n=r({},e),[4,(g=n,a(void 0,void 0,void 0,function(){var e,t,n,r,a,s,o;return i(this,function(i){switch(i.label){case 0:if(g.components===undefined)return[2,Promise.resolve(g)];if(g.components.schemas===undefined)return[2,Promise.resolve(g)];e=g.components.schemas,t=Object.keys(e),n=0,r=t,i.label=1;case 1:return n<r.length?(a=r[n],s=e,o=a,[4,m(e[a],e)]):[3,4];case 2:s[o]=i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2,g]}})}))];case 1:return n=p.sent(),[4,h(n)];case 2:n=p.sent(),s=[],o=0,c=n.methods,p.label=3;case 3:return o<c.length?(l=c[o],d=(u=s).push,[4,f(l,n,t)]):[3,6];case 4:d.apply(u,[p.sent()]),p.label=5;case 5:return o++,[3,3];case 6:return n.methods=s,[2,n]}var g})})}}}},{package:"@open-rpc/schema-utils-js",file:"node_modules/@open-rpc/schema-utils-js/build/dereference-document.js"}],[3175,{"./dereference-document":3174,"./validate-open-rpc-document":3176,"@json-schema-tools/reference-resolver":849,"@json-schema-tools/reference-resolver/build/reference-resolver":850,"is-url":4642},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},r.apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,o)}c((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,r,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.makeCustomResolver=void 0;var u=l(e("./dereference-document")),d=s(e("./validate-open-rpc-document")),p=l(e("@json-schema-tools/reference-resolver")),m=e("is-url"),h=l(e("@json-schema-tools/reference-resolver/build/reference-resolver")),f={dereference:!0,validate:!0};n.makeCustomResolver=function(e){return new h.default(e)},n.default=function(e,t){return function(n,a){return void 0===n&&(n="./openrpc.json"),void 0===a&&(a=f),o(this,void 0,void 0,function(){var i,s,o,l;return c(this,function(c){switch(c.label){case 0:return s=r(r({},f),a),"string"==typeof n?[3,1]:(i=n,[3,6]);case 1:return function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(n)?(i=JSON.parse(n),[3,6]):[3,2];case 2:return m(n)?[4,e(n)]:[3,4];case 3:return i=c.sent(),[3,6];case 4:return[4,t(n)];case 5:i=c.sent(),c.label=6;case 6:if(s.validate&&(l=(0,d.default)(i))instanceof d.OpenRPCDocumentValidationError)throw l;return o=i,s.dereference?s.resolver===undefined?[3,8]:[4,(0,u.default)(i,s.resolver)]:[3,10];case 7:return o=c.sent(),[3,10];case 8:return[4,(0,u.default)(i,p.default)];case 9:o=c.sent(),c.label=10;case 10:if(s.validate&&(l=(0,d.default)(o))instanceof d.OpenRPCDocumentValidationError)throw l;return[2,o]}})})}}}}},{package:"@open-rpc/schema-utils-js",file:"node_modules/@open-rpc/schema-utils-js/build/parse-open-rpc-document.js"}],[3176,{"@json-schema-tools/meta-schema":846,"@open-rpc/meta-schema":3173,ajv:3818},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},r.apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.OpenRPCDocumentValidationError=void 0;var i=a(e("@open-rpc/meta-schema")),s=a(e("ajv")),o=a(e("@json-schema-tools/meta-schema")),c=function(e){this.name="OpenRPCDocumentDereferencingError",this.message=["Error validating OpenRPC Document against @open-rpc/meta-schema.","The errors found are as follows:",JSON.stringify(e,undefined,"  ")].join("\n")};n.OpenRPCDocumentValidationError=c,n.default=function(e){var t=new s.default;t.addSchema(o.default,"https://meta.json-schema.tools");var n=r({},i.default);delete n.definitions.JSONSchema.$id,delete n.definitions.JSONSchema.$schema,delete n.$schema,delete n.$id;try{t.validate(n,e)}catch(e){throw new Error(["schema-utils-js: Internal Error","-----",e,"-----","If you see this report it: https://github.com/open-rpc/schema-utils-js/issues"].join("\n"))}return!t.errors||new c(t.errors)}}}},{package:"@open-rpc/schema-utils-js",file:"node_modules/@open-rpc/schema-utils-js/build/validate-open-rpc-document.js"}],[318,{"./add-ethereum-chain":314,"./eth-accounts":315,"./get-provider-state":317,"./log-web3-shim-usage":319,"./request-accounts":320,"./send-metadata":321,"./switch-ethereum-chain":322,"./watch-asset":326},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.handlers=n.ethAccountsHandler=n.eip1193OnlyHandlers=void 0;var r=d(e("./add-ethereum-chain")),a=d(e("./eth-accounts")),i=d(e("./get-provider-state")),s=d(e("./log-web3-shim-usage")),o=d(e("./request-accounts")),c=d(e("./send-metadata")),l=d(e("./switch-ethereum-chain")),u=d(e("./watch-asset"));function d(e){return e&&e.__esModule?e:{default:e}}n.handlers=[r.default,i.default,s.default,c.default,u.default],n.eip1193OnlyHandlers=[l.default,a.default,o.default],n.ethAccountsHandler=a.default}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/index.ts"}],[319,{"../../../../../shared/constants/app":5775},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE],implementation:function(e,t,n,r,{getWeb3ShimUsageState:a,setWeb3ShimUsageRecorded:i}){const{origin:s}=e;a(s)===undefined&&i(s);return t.result=!0,r()},hookNames:{getWeb3ShimUsageState:!0,setWeb3ShimUsageRecorded:!0}};n.default=r}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/log-web3-shim-usage.ts"}],[3196,{assert:4080,buffer:4084,"component-type":4151,"join-component":4650},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("component-type"),a=e("join-component"),i=e("assert");t.exports=function(e,t){switch(o(e),t=t||e.type,i(t,"You must pass an event type."),t){case"track":return function(e){i(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),i(e.event,'You must pass an "event".')}(e);case"group":return function(e){i(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),i(e.groupId,'You must pass a "groupId".')}(e);case"identify":case"page":case"screen":return function(e){i(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".')}(e);case"alias":return function(e){i(e.userId,'You must pass a "userId".'),i(e.previousId,'You must pass a "previousId".')}(e);default:i(0,'Invalid event type: "'+t+'"')}};var s={anonymousId:["string","number"],category:"string",context:"object",event:"string",groupId:["string","number"],integrations:"object",name:"string",previousId:["string","number"],timestamp:"date",userId:["string","number"],type:"string"};function o(e){i("object"===r(e),"You must pass a message object.");var t=JSON.stringify(e);for(var o in i(n.byteLength(t,"utf8")<32768,"Your message must be < 32kb."),s){var c=e[o];if(c){var l=s[o];"array"!==r(l)&&(l=[l]);var u="object"===l[0]?"an":"a";i(l.some(function(e){return r(c)===e}),'"'+o+'" must be '+u+" "+a(l,"or")+".")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@segment/loosely-validate-event",file:"node_modules/@segment/loosely-validate-event/index.js"}],[32,{"../../../shared/constants/bridge":5777,"../../../shared/lib/trace":5897,"@metamask/bridge-status-controller":1407,"@metamask/controller-utils":1449},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BridgeStatusControllerInit=void 0;var r=e("@metamask/bridge-status-controller"),a=e("@metamask/controller-utils"),i=e("../../../shared/lib/trace"),s=e("../../../shared/constants/bridge");n.BridgeStatusControllerInit=({controllerMessenger:e,persistedState:t,getController:n})=>{const o=n("TransactionController");return{controller:new r.BridgeStatusController({messenger:e,state:t.BridgeStatusController,fetchFn:async(e,t)=>await(0,a.handleFetch)(e,{method:"GET",...t}),addTransactionFn:(...e)=>o.addTransaction(...e),addTransactionBatchFn:(...e)=>o.addTransactionBatch(...e),estimateGasFeeFn:(...e)=>o.estimateGasFee(...e),updateTransactionFn:(...e)=>o.updateTransaction(...e),config:{customBridgeApiBaseUrl:s.BRIDGE_API_BASE_URL},traceFn:(...e)=>(0,i.trace)(...e)})}}}}},{package:"$root$",file:"app/scripts/controller-init/bridge-status-controller-init.ts"}],[320,{"../../../../../shared/constants/app":5775,"../../../../../shared/constants/metametrics":5791,"../../util":372,"@metamask/rpc-errors":2600},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/rpc-errors"),a=e("../../../../../shared/constants/app"),i=e("../../../../../shared/constants/metametrics"),s=e("../../util");const o={methodNames:[a.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS],implementation:async function(e,t,n,o,{getAccounts:l,sendMetrics:u,metamaskState:d,getCaip25PermissionFromLegacyPermissionsForOrigin:p,requestPermissionsForOrigin:m}){const{origin:h}=e??{};if(c.has(h))return t.error=r.rpcErrors.resourceUnavailable(`Already processing ${a.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS}. Please wait.`),o();let f=l(h);if(f.length>0){try{c.add(h),t.result=f,o()}catch(e){o(e)}finally{c.delete(h)}return undefined}try{const e=p();await m(e)}catch(e){return o(e)}if(f=l(h),(0,s.shouldEmitDappViewedEvent)(d.metaMetricsId)){const e=!Object.keys(d.permissionHistory).includes(h);u({event:i.MetaMetricsEventName.DappViewed,category:i.MetaMetricsEventCategory.InpageProvider,referrer:{url:h},properties:{is_first_visit:e,number_of_accounts:Object.keys(d.identities).length,number_of_accounts_connected:f.length}},{excludeMetaMetricsId:!0})}return t.result=f,o()},hookNames:{getAccounts:!0,sendMetrics:!0,metamaskState:!0,getCaip25PermissionFromLegacyPermissionsForOrigin:!0,requestPermissionsForOrigin:!0}};n.default=o;const c=new Set}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/request-accounts.ts"}],[321,{"../../../../../shared/constants/app":5775,"@metamask/rpc-errors":2600,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/rpc-errors"),a=e("@metamask/utils");const i={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,n,i,{addSubjectMetadata:s,subjectType:o}){const{origin:c,params:l}=e;if(!(0,a.isObject)(l))return i(r.rpcErrors.invalidParams({data:l}));{const{icon:e=null,name:t=null,...n}=l;s({...n,iconUrl:e,name:t,subjectType:o,origin:c})}return t.result=!0,i()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};n.default=i}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/send-metadata.ts"}],[322,{"../../../../../shared/constants/app":5775,"./ethereum-chain-utils":316,"@metamask/rpc-errors":2600,"@metamask/snaps-utils":2903},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/rpc-errors"),a=e("@metamask/snaps-utils"),i=e("../../../../../shared/constants/app"),s=e("./ethereum-chain-utils");const o={methodNames:[i.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,n,o,{getNetworkConfigurationByChainId:c,setActiveNetwork:l,requestUserApproval:u,getCaveat:d,getCurrentChainIdForDomain:p,requestPermittedChainsPermissionIncrementalForOrigin:m,rejectApprovalRequestsForOrigin:h,setTokenNetworkFilter:f,setEnabledNetworks:g,getEnabledNetworks:y,hasApprovalRequestsForOrigin:v}){let w;try{w=(0,s.validateSwitchEthereumChainParams)(e)}catch(e){return o(e)}const{origin:b}=e,T=p(b);if(T===w)return t.result=null,o();const k=c(w),_=null==k?void 0:k.rpcEndpoints[k.defaultRpcEndpointIndex].networkClientId;if(!_)return o(r.providerErrors.custom({code:4902,message:`Unrecognized chain ID "${w}". Try adding the chain using ${i.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}));const E=c(T),P=c(w);return(0,s.switchChain)(t,o,w,_,{origin:b,isSwitchFlow:!0,autoApprove:(0,a.isSnapId)(b),setActiveNetwork:l,getCaveat:d,requestPermittedChainsPermissionIncrementalForOrigin:m,rejectApprovalRequestsForOrigin:h,setTokenNetworkFilter:f,setEnabledNetworks:g,getEnabledNetworks:y,requestUserApproval:u,hasApprovalRequestsForOrigin:v,toNetworkConfiguration:P,fromNetworkConfiguration:E})},hookNames:{getNetworkConfigurationByChainId:!0,setActiveNetwork:!0,requestUserApproval:!0,getCaveat:!0,getCurrentChainIdForDomain:!0,requestPermittedChainsPermissionIncrementalForOrigin:!0,rejectApprovalRequestsForOrigin:!0,setTokenNetworkFilter:!0,setEnabledNetworks:!0,getEnabledNetworks:!0,hasApprovalRequestsForOrigin:!0}};n.default=o}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/switch-ethereum-chain.js"}],[323,{"../../../../../shared/constants/permissions":5799,"../../../controllers/permissions":239,"@metamask/chain-agnostic-permission":1420,"@metamask/permission-controller":2443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPermissionsHandler=void 0;var r=e("@metamask/permission-controller"),a=e("@metamask/chain-agnostic-permission"),i=e("../../../controllers/permissions"),s=e("../../../../../shared/constants/permissions");n.getPermissionsHandler={methodNames:[r.MethodNames.GetPermissions],implementation:async function(e,t,n,r,{getPermissionsForOrigin:o,getAccounts:c}){var l;const u={...o()},d=u[a.Caip25EndowmentPermissionName],p=null==d||null===(l=d.caveats)||void 0===l||null===(l=l.find(({type:e})=>e===a.Caip25CaveatType))||void 0===l?void 0:l.value;if(delete u[a.Caip25EndowmentPermissionName],p){const e=c();e.length>0&&(u[s.RestrictedMethods.eth_accounts]={...d,parentCapability:s.RestrictedMethods.eth_accounts,caveats:[{type:s.CaveatTypes.restrictReturnedAccounts,value:e}]});const t=(0,a.getPermittedEthChainIds)(p);t.length>0&&(u[i.PermissionNames.permittedChains]={...d,parentCapability:i.PermissionNames.permittedChains,caveats:[{type:s.CaveatTypes.restrictNetworkSwitching,value:t}]})}return t.result=Object.values(u),r()},hookNames:{getPermissionsForOrigin:!0,getAccounts:!0}}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/wallet-getPermissions.ts"}],[3231,{"@metamask/eth-sig-util":1993,tslib:5689},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.transformTypedData=void 0;const r=e("tslib").__importStar(e("@metamask/eth-sig-util"));function a(e){switch(Object.prototype.toString.call(e)){case"[object Object]":{const t=Object.keys(e).map(t=>[t,a(e[t])]);return Object.fromEntries(t)}case"[object Array]":return e.map(e=>a(e));case"[object BigInt]":return e.toString();default:return e}}n.transformTypedData=(e,t)=>{if(!t)throw new Error("Trezor: Only version 4 of typed data signing is supported");const n=r.SignTypedDataVersion.V4,{types:i,primaryType:s,domain:o,message:c}=r.TypedDataUtils.sanitizeData(e),l=r.TypedDataUtils.hashStruct("EIP712Domain",a(o),i,n).toString("hex");let u=null;return"EIP712Domain"!==s&&(u=r.TypedDataUtils.hashStruct(s,a(c),i,n).toString("hex")),Object.assign({domain_separator_hash:l,message_hash:u},e)},n.default=n.transformTypedData}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-plugin-ethereum",file:"node_modules/@trezor/connect-plugin-ethereum/lib/index.js"}],[324,{"../../../../../shared/constants/permissions":5799,"../../../controllers/permissions":239,"@metamask/chain-agnostic-permission":1420,"@metamask/controller-utils":1449,"@metamask/permission-controller":2443,lodash:4838},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.requestPermissionsHandler=void 0;var r=e("lodash"),a=e("@metamask/controller-utils"),i=e("@metamask/permission-controller"),s=e("@metamask/chain-agnostic-permission"),o=e("../../../../../shared/constants/permissions"),c=e("../../../controllers/permissions");n.requestPermissionsHandler={methodNames:[i.MethodNames.RequestPermissions],implementation:async function(e,t,n,l,{getAccounts:u,requestPermissionsForOrigin:d,getCaip25PermissionFromLegacyPermissionsForOrigin:p}){const{params:m}=e;if(!Array.isArray(m)||!(0,a.isPlainObject)(m[0]))return l((0,i.invalidParams)({data:{request:e}}));let[h]=m;delete h[s.Caip25EndowmentPermissionName];const f=(0,r.pick)(h,[o.RestrictedMethods.eth_accounts,c.PermissionNames.permittedChains]);delete h[o.RestrictedMethods.eth_accounts],delete h[c.PermissionNames.permittedChains];const g=Object.keys(f).length>0;if(g){const e=p(f);h={...h,...e}}let y={};const[v]=await d(h);if(y={...v},g){var w;const e=y[s.Caip25EndowmentPermissionName];if(!e)throw new Error(`could not find ${s.Caip25EndowmentPermissionName} permission.`);const t=null===(w=e.caveats)||void 0===w||null===(w=w.find(({type:e})=>e===s.Caip25CaveatType))||void 0===w?void 0:w.value;if(!t)throw new Error(`could not find ${s.Caip25CaveatType} in granted ${s.Caip25EndowmentPermissionName} permission.`);delete y[s.Caip25EndowmentPermissionName];const n=u(origin);y[o.RestrictedMethods.eth_accounts]={...e,parentCapability:o.RestrictedMethods.eth_accounts,caveats:[{type:o.CaveatTypes.restrictReturnedAccounts,value:n}]};const r=(0,s.getPermittedEthChainIds)(t);r.length>0&&(y[c.PermissionNames.permittedChains]={...e,parentCapability:c.PermissionNames.permittedChains,caveats:[{type:o.CaveatTypes.restrictNetworkSwitching,value:r}]})}return t.result=Object.values(y).filter(e=>e!==undefined),l()},hookNames:{getAccounts:!0,requestPermissionsForOrigin:!0,getCaip25PermissionFromLegacyPermissionsForOrigin:!0}}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/wallet-requestPermissions.ts"}],[325,{"../../../../../shared/constants/permissions":5799,"../../../controllers/permissions":239,"@metamask/chain-agnostic-permission":1420,"@metamask/permission-controller":2443,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.revokePermissionsHandler=void 0;var r=e("@metamask/permission-controller"),a=e("@metamask/utils"),i=e("@metamask/chain-agnostic-permission"),s=e("../../../../../shared/constants/permissions"),o=e("../../../controllers/permissions");n.revokePermissionsHandler={methodNames:[r.MethodNames.RevokePermissions],implementation:function(e,t,n,c,{revokePermissionsForOrigin:l,rejectApprovalRequestsForOrigin:u}){const{params:d}=e,p=null==d?void 0:d[0];if(!p)return c((0,r.invalidParams)({data:{request:e}}));const m=Object.keys(p).filter(e=>e!==i.Caip25EndowmentPermissionName);if(!(0,a.isNonEmptyArray)(m))return c((0,r.invalidParams)({data:{request:e}}));const h=[s.RestrictedMethods.eth_accounts,o.PermissionNames.permittedChains],f=m.filter(e=>!h.includes(e));f.length!==m.length&&f.push(i.Caip25EndowmentPermissionName);return l(f),u(),t.result=null,c()},hookNames:{revokePermissionsForOrigin:!0,rejectApprovalRequestsForOrigin:!0,updateCaveat:!0}}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/wallet-revokePermissions.ts"}],[326,{"../../../../../shared/constants/app":5775,"@metamask/controller-utils":1449,"@metamask/rpc-errors":2600},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/rpc-errors"),a=e("@metamask/controller-utils"),i=e("../../../../../shared/constants/app");const s={methodNames:[i.MESSAGE_TYPE.WATCH_ASSET,i.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,n,i,{handleWatchAssetRequest:s}){try{const{params:{options:n,type:o},origin:c,networkClientId:l}=e,{tokenId:u}=n;return[a.ERC721,a.ERC1155].includes(o)&&u!==undefined&&"string"!=typeof u?i(r.rpcErrors.invalidParams({message:`Expected parameter 'tokenId' to be type 'string'. Received type '${typeof u}'`})):(await s({asset:n,type:o,origin:c??"",networkClientId:l??""}),t.result=!0,i())}catch(e){return i(e)}},hookNames:{handleWatchAssetRequest:!0}};n.default=s}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/watch-asset.ts"}],[327,{"./createMethodMiddleware":312,"./createUnsupportedMethodMiddleware":313},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./createMethodMiddleware");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))});var a=e("./createUnsupportedMethodMiddleware");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))})}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/index.js"}],[328,{"../../../shared/lib/snaps/snaps":5892,"@metamask/rpc-errors":2600,"@metamask/snaps-sdk":2786},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function({allowedOrigins:e,errorMessage:t="Cannot process requests at this time",state:n}){return function(s,o,c,l){if(!n.isBlocked)return c();const{origin:u}=s;if(!u)return l(new a.InternalError(`No origin specified for request with method ${s.method}`));return e.includes(u)||(0,i.isSnapPreinstalled)(u)?c():l(r.rpcErrors.resourceUnavailable(t))}};var r=e("@metamask/rpc-errors"),a=e("@metamask/snaps-sdk"),i=e("../../../shared/lib/snaps/snaps")}}},{package:"$root$",file:"app/scripts/lib/rpcBlockingMiddleware.ts"}],[329,{"./operation-safener":305,loglevel:4846,"webextension-polyfill":5763},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRequestSafeReload=function(e){const t=new i.OperationSafener({op:async t=>{try{if("data"===e.storageKind){if(!t)throw new Error("State must be provided for 'data' storageKind");await e.set(t)}else await e.persist()}catch(e){a.default.error("MetaMask - Persistence failed",e),null==o||o.captureException(e)}},wait:1e3});return{safePersist:async(...e)=>t.execute(...e),requestSafeReload:async()=>{await t.evacuate(),r.default.runtime.reload()},evacuate:()=>t.evacuate()}};var r=s(e("webextension-polyfill")),a=s(e("loglevel")),i=e("./operation-safener");function s(e){return e&&e.__esModule?e:{default:e}}const{sentry:o}=global}}},{package:"$root$",file:"app/scripts/lib/safe-reload.ts"}],[33,{"@metamask/claims-controller":1439},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ClaimsControllerInit=void 0;var r=e("@metamask/claims-controller");n.ClaimsControllerInit=e=>{const{controllerMessenger:t,persistedState:n}=e;return{controller:new r.ClaimsController({messenger:t,state:n.ClaimsController})}}}}},{package:"$root$",file:"app/scripts/controller-init/claims/claims-controller-init.ts"}],[330,{"../util":372,"@segment/loosely-validate-event":3196,buffer:4084,"is-retry-allowed":4635,lodash:4838,"remove-trailing-slash":5307,timers:4086},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t,r){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=l(e("remove-trailing-slash")),i=l(e("@segment/loosely-validate-event")),s=e("lodash"),o=l(e("is-retry-allowed")),c=e("../util");function l(e){return e&&e.__esModule?e:{default:e}}const u=()=>({});n.default=class{constructor(e,t={}){this.writeKey=e,this.host=(0,a.default)(t.host||"https://api.segment.io"),this.flushInterval=t.flushInterval||1e4,this.flushAt=t.flushAt||Math.max(t.flushAt,1)||20,this.queue=[],this.path="/v1/batch",this.maxQueueSize=460800,this.flushed=!1,this.retryCount=3,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:!0})}_validate(e,t){(0,i.default)(e,t)}_message(e,t,n){return this._validate(t,e),this.enqueue(e,t,n),this}identify(e,t){return this._message("identify",e,t)}track(e,t){return this._message("track",e,t)}page(e,t){return this._message("page",e,t)}enqueue(e,t,n=u){if(!this.enable)return void r(n);const a={...t,type:e};if(a.context={...a.context,library:{name:"analytics-node"}},a.timestamp||(a.timestamp=new Date),a.messageId||(a.messageId=(0,c.generateRandomId)()),a.anonymousId&&!(0,s.isString)(a.anonymousId)&&(a.anonymousId=JSON.stringify(a.anonymousId)),a.userId&&!(0,s.isString)(a.userId)&&(a.userId=JSON.stringify(a.userId)),this.queue.push({message:a,callback:n}),!this.flushed)return this.flushed=!0,void this.flush();const i=this.queue.length>=this.flushAt,o=this.queue.reduce((e,t)=>e+JSON.stringify(t).length,0)>=this.maxQueueSize;(i||o)&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}flush(e=u){if(!this.enable)return r(e),Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return r(e),Promise.resolve();const n=this.queue.splice(0,this.flushAt),a=n.map(e=>e.callback),i={batch:n.map(e=>e.message),timestamp:new Date,sentAt:new Date},s={Authorization:`Basic ${t.from(this.writeKey,"utf8").toString("base64")}`};return this._sendRequest(`${this.host}${this.path}`,{method:"POST",body:JSON.stringify(i),headers:s},t=>{r(()=>{a.forEach(e=>e(t,i)),e(t,i)})},0)}_retryRequest(e,t,n,r){const a=100*Math.pow(2,r);setTimeout(()=>{this._sendRequest(e,t,n,r+1)},a)}async _sendRequest(e,t,n,r){return fetch(e,t).then(async a=>{if(a.ok)n();else if(this._isErrorRetryable({response:a})&&r<=this.retryCount)this._retryRequest(e,t,n,r);else{const e=new Error(a.statusText);n(e)}}).catch(a=>{this._isErrorRetryable(a)&&r<=this.retryCount?this._retryRequest(e,t,n,r):n(a)})}_isErrorRetryable(e){return!!function(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,o.default)(e)}(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("buffer").Buffer,e("timers").setImmediate)}}},{package:"$root$",file:"app/scripts/lib/segment/analytics.js"}],[331,{"../../../../shared/constants/time":5812,"./analytics":330},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.segment=n.createSegmentMock=void 0;var r,a=e("../../../../shared/constants/time"),i=(r=e("./analytics"))&&r.__esModule?r:{default:r};const s="XdGJ17zKf3NjBPCDQ2UDjJjkx6FYBMGP",o=undefined,c=5*a.SECOND,l=(e=o)=>{const t={queue:[],flush(){t.queue.forEach(([e,t])=>{t()}),t.queue=[]},track(n,r=()=>undefined){t.queue.push([n,r]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};n.createSegmentMock=l;n.segment=s?new i.default(s,{host:null,flushAt:o,flushInterval:c}):l(o)}}},{package:"$root$",file:"app/scripts/lib/segment/index.js"}],[333,{"../../../../shared/lib/trace":5897},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addPersonalMessage=async function({signatureParams:e,signatureController:t}){return a(e,t,"newUnsignedPersonalMessage")},n.addTypedMessage=async function({signatureParams:e,signatureController:t}){return a(e,t,"newUnsignedTypedMessage")};var r=e("../../../../shared/lib/trace");async function a(e,t,n){const[a,i,s,o]=e,{id:c,method:l,params:u}=i,d={id:c,method:l,params:u,origin:s.get("origin"),networkClientId:s.get("networkClientId"),securityAlertResponse:s.get("securityAlertResponse")},p=null==c?void 0:c.toString();(0,r.endTrace)({name:r.TraceName.Middleware,id:p});const m=await t[n](a,d,o);return(0,r.endTrace)({name:r.TraceName.Signature,id:p}),m}}}},{package:"$root$",file:"app/scripts/lib/signature/util.ts"}],[334,{"../../../../shared/constants/app":5775,"../../../../shared/constants/smartTransactions":5805,"../../../../shared/modules/conversion.utils":5913,"../../../../shared/modules/selectors":5932,"../../../../shared/modules/transaction.utils":5947,"@metamask/smart-transactions-controller":2643,"@metamask/transaction-controller":2994,loglevel:4846},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSmartTransactionCommonParams=function(e,t){const n=function(e){return{metamask:e}}(e),r=(0,u.getIsSmartTransaction)(n,t),a=(0,u.getFeatureFlagsByChainId)(n,t),i=(0,u.isHardwareWallet)(n);return{isSmartTransaction:r,featureFlags:a,isHardwareWalletAccount:i}},n.submitSmartTransactionHook=n.submitBatchSmartTransactionHook=void 0;var r,a=e("@metamask/smart-transactions-controller"),i=e("@metamask/transaction-controller"),s=(r=e("loglevel"))&&r.__esModule?r:{default:r},o=e("../../../../shared/constants/app"),c=e("../../../../shared/constants/smartTransactions"),l=e("../../../../shared/modules/conversion.utils"),u=e("../../../../shared/modules/selectors"),d=e("../../../../shared/modules/transaction.utils");function p(e,t,n){m(e,t),t.set(e,n)}function m(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h(e,t){return e.get(g(e,t))}function f(e,t,n){return e.set(g(e,t),n),n}function g(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var y=new WeakMap,v=new WeakMap,w=new WeakMap,b=new WeakMap,T=new WeakMap,k=new WeakMap,_=new WeakMap,E=new WeakMap,P=new WeakMap,S=new WeakMap,A=new WeakMap,C=new WeakMap,O=new WeakMap,M=new WeakMap,j=new WeakSet;class I{constructor(e){var t;!function(e,t){m(e,t),t.add(e)}(this,j),p(this,y,void 0),p(this,v,void 0),p(this,w,void 0),p(this,b,void 0),p(this,T,void 0),p(this,k,void 0),p(this,_,void 0),p(this,E,void 0),p(this,P,void 0),p(this,S,void 0),p(this,A,void 0),p(this,C,void 0),p(this,O,void 0),p(this,M,void 0);const{transactionMeta:n,signedTransactionInHex:r,smartTransactionsController:a,transactionController:c,isSmartTransaction:l,controllerMessenger:u,featureFlags:d,transactions:g}=e;f(v,this,""),f(y,this,!1),f(S,this,n),f(A,this,r),f(E,this,a),f(P,this,c),f(_,this,l),f(b,this,u),f(T,this,d),f(k,this,n.origin!==o.ORIGIN_METAMASK),f(w,this,n.chainId),f(O,this,n.txParams),f(C,this,g);const I=null==d||null===(t=d.smartTransactions)||void 0===t?void 0:t.extensionSkipSmartTransactionStatusPage;f(M,this,!I&&Boolean(n.type!==i.TransactionType.bridge&&n.type!==i.TransactionType.shieldSubscriptionApprove||h(C,this)&&h(C,this).length>0)),s.default.info("[SmartTransaction] shouldShowStatusPage:",h(M,this))}async submit(){const e=!!h(S,this).type&&[i.TransactionType.swapAndSend,i.TransactionType.swapApproval,i.TransactionType.bridgeApproval].includes(h(S,this).type),t={transactionHash:undefined};if(!h(_,this)||e||(0,d.isLegacyTransaction)(h(S,this)))return t;let n;if(h(M,this)&&await g(j,this,N).call(this),!h(A,this)||!h(S,this).isGasFeeSponsored)try{n=await h(E,this).getFees({...h(O,this),chainId:h(w,this)},undefined,{networkClientId:h(S,this).networkClientId})}catch(e){return s.default.error("Error in smart transaction publish hook, falling back to regular transaction submission",e),g(j,this,F).call(this),t}try{var r;const e=await g(j,this,L).call(this,{getFeesResponse:n}),t=null==e?void 0:e.uuid;if(!t)throw new Error("No smart transaction UUID");await g(j,this,D).call(this,t);let a;if(a=(null===(r=h(T,this))||void 0===r||null===(r=r.smartTransactions)||void 0===r?void 0:r.extensionReturnTxHashAsap)&&null!=e&&e.txHash?e.txHash:await g(j,this,$).call(this,{uuid:t}),null===a)throw new Error("Transaction does not have a transaction hash, there was a problem");return{transactionHash:a}}catch(e){throw s.default.error("Error in smart transaction publish hook",e),g(j,this,F).call(this),e}}async submitBatch(){if(!h(_,this))throw new Error("submitBatch: Smart Transaction is required for batch submissions");h(M,this)&&await g(j,this,N).call(this);try{var e,t;const n=await g(j,this,L).call(this),r=null==n?void 0:n.uuid;if(!r)throw new Error("submitBatch: No smart transaction UUID");let a;await g(j,this,D).call(this,r),a=null!=n&&n.txHashes?{results:n.txHashes.map(e=>({transactionHash:e}))}:{results:[]};if((null===(e=h(T,this))||void 0===e||null===(e=e.smartTransactions)||void 0===e?void 0:e.extensionReturnTxHashAsapBatch)&&(null===(t=a)||void 0===t||null===(t=t.results)||void 0===t?void 0:t.length)>0)return a;if(null===await g(j,this,$).call(this,{uuid:r}))throw new Error("submitBatch: Transaction does not have a transaction hash, there was a problem");return a}catch(e){throw s.default.error("submitBatch: Error in smart transaction publish batch hook",e),g(j,this,F).call(this),e}}}async function R(e){try{await h(b,this).call("ApprovalController:endFlow",{id:e})}catch(e){}}async function x(e){try{await g(j,this,R).call(this,e),await h(b,this).call("ApprovalController:acceptRequest",e),Y._=""}catch(e){s.default.error("Error ending existing approval flow",e)}}async function N(){Y._&&await g(j,this,x).call(this,Y._);const{id:e}=await h(b,this).call("ApprovalController:startFlow");f(v,this,e),Y._=e}async function D(e){h(M,this)&&(g(j,this,U).call(this,{uuid:e}),g(j,this,G).call(this,{uuid:e}))}function F(){h(M,this)&&!h(y,this)&&(f(y,this,!0),g(j,this,R).call(this,h(v,this)),Y._===h(v,this)&&(Y._=""))}function U({uuid:e}){const t=()=>{g(j,this,F).call(this)};h(b,this).call("ApprovalController:addRequest",{id:h(v,this),origin:origin,type:o.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage,requestState:{smartTransaction:{status:a.SmartTransactionStatuses.PENDING,creationTime:Date.now(),uuid:e,chainId:h(w,this)},isDapp:h(k,this),txId:h(S,this).id}},!0).then(t,t)}async function B({smartTransaction:e}){return await h(b,this).call("ApprovalController:updateRequestState",{id:h(v,this),requestState:{smartTransaction:e,isDapp:h(k,this),txId:h(S,this).id}})}async function G({uuid:e}){h(b,this).subscribe("SmartTransactionsController:smartTransaction",async t=>{if(t.uuid===e){const{status:e}=t;if(!e||e===a.SmartTransactionStatuses.PENDING)return;h(y,this)||await g(j,this,B).call(this,{smartTransaction:t})}})}function $({uuid:e}){return new Promise(t=>{h(b,this).subscribe("SmartTransactionsController:smartTransaction",async n=>{if(n.uuid===e){const{status:e,statusMetadata:r}=n;if(!e||e===a.SmartTransactionStatuses.PENDING)return;s.default.debug("Smart Transaction: ",n),null!=r&&r.minedHash?(s.default.debug("Smart Transaction - Received tx hash: ",null==r?void 0:r.minedHash),t(r.minedHash)):t(null)}})})}async function L({getFeesResponse:e}={}){let t=[];if(h(C,this)&&Array.isArray(h(C,this))&&h(C,this).length>0)t=h(C,this).filter(e=>null==e?void 0:e.signedTx).map(e=>e.signedTx);else if(h(A,this))t=[h(A,this)];else if(e){var n;t=await g(j,this,H).call(this,(null===(n=e.tradeTxFees)||void 0===n?void 0:n.fees)??[],!1)}return await h(E,this).submitSignedTransactions({signedTransactions:t,signedCanceledTransactions:[],txParams:h(O,this),transactionMeta:h(S,this),networkClientId:h(S,this).networkClientId})}function q(e,t){if(!h(O,this))throw new Error("Transaction params are required");const n={...h(O,this),maxFeePerGas:`0x${(0,l.decimalToHex)(e.maxFeePerGas)}`,maxPriorityFeePerGas:`0x${(0,l.decimalToHex)(e.maxPriorityFeePerGas)}`,gas:t?`0x${(0,l.decimalToHex)(c.CANCEL_GAS_LIMIT_DEC)}`:h(O,this).gas};return t&&(n.to=n.from,n.data="0x"),n}async function H(e,t){if(!h(O,this)||!h(w,this))throw new Error("Transaction params and chainId are required");const n=e.map(e=>g(j,this,q).call(this,e,t)).map(e=>({...e,chainId:e.chainId||h(w,this)}));return await h(P,this).approveTransactionsWithSameNonce(n,{hasNonce:!0})}var Y={_:""};n.submitSmartTransactionHook=e=>new I(e).submit();n.submitBatchSmartTransactionHook=e=>new I(e).submitBatch()}}},{package:"$root$",file:"app/scripts/lib/smart-transaction/smart-transactions.ts"}],[335,{"./snap-keyring":338,"./utils":339},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getAccountsBySnapId",{enumerable:!0,get:function(){return a.getAccountsBySnapId}}),Object.defineProperty(n,"snapKeyringBuilder",{enumerable:!0,get:function(){return r.snapKeyringBuilder}});var r=e("./snap-keyring"),a=e("./utils")}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/index.ts"}],[336,{"@metamask/keyring-api":2193,"@metamask/permission-controller":2443},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isProtocolAllowed=u,n.keyringSnapPermissionsBuilder=function(e,t){return()=>{if("metamask"===t)return s;if(i.includes(t))return c;const n=e.getSubjectMetadata(t);return(null==n?void 0:n.subjectType)===a.SubjectType.Website&&u(t)?o:[]}};var r=e("@metamask/keyring-api"),a=e("@metamask/permission-controller");const i=["https://app.metamask.io"],s=[r.KeyringRpcMethod.ListAccounts,r.KeyringRpcMethod.GetAccount,r.KeyringRpcMethod.FilterAccountChains,r.KeyringRpcMethod.DeleteAccount,r.KeyringRpcMethod.ListRequests,r.KeyringRpcMethod.GetRequest,r.KeyringRpcMethod.SubmitRequest,r.KeyringRpcMethod.RejectRequest],o=[r.KeyringRpcMethod.ListAccounts,r.KeyringRpcMethod.GetAccount,r.KeyringRpcMethod.CreateAccount,r.KeyringRpcMethod.FilterAccountChains,r.KeyringRpcMethod.UpdateAccount,r.KeyringRpcMethod.DeleteAccount,r.KeyringRpcMethod.ExportAccount,r.KeyringRpcMethod.ListRequests,r.KeyringRpcMethod.GetRequest,r.KeyringRpcMethod.ApproveRequest,r.KeyringRpcMethod.RejectRequest],c=[r.KeyringRpcMethod.ListAccounts,r.KeyringRpcMethod.GetAccount,r.KeyringRpcMethod.GetAccountBalances,r.KeyringRpcMethod.SubmitRequest],l=["https:"];function u(e){try{const t=new URL(e);return l.includes(t.protocol)}catch(e){return!1}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/keyring-snaps-permissions.ts"}],[337,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapAndHardwareInfoForMetrics=async function(e,t,n,r){var a,i,s;if(!r)return{};const o=r.call("AccountsController:getSelectedAccount"),c=o.address;let l;var u;null!==(a=o.metadata.snap)&&void 0!==a&&a.id&&(l=r.call("SnapController:get",null===(u=o.metadata.snap)||void 0===u?void 0:u.id));let d={};const{isUnlocked:p}=r.call("KeyringController:getState");if(p){d={account_type:await e(c),device_model:await t(c)};const r=await n(c);r&&(d={...d,account_hardware_type:r})}return{...d,account_snap_type:null===(i=l)||void 0===i?void 0:i.id,account_snap_version:null===(s=l)||void 0===s?void 0:s.version}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/metrics.ts"}],[338,{"../../../../shared/constants/app":5775,"../../../../shared/constants/metametrics":5791,"../../../../shared/lib/accounts":5819,"../../../../shared/lib/accounts/snaps":5821,"../../../../shared/lib/multichain-accounts/remote-feature-flag":5880,"../../../../shared/lib/snaps/snaps":5892,"../../../../shared/lib/translate":5902,"../../../../ui/components/component-library/icon":6528,"./utils/isBlockedUrl":340,"./utils/showResult":341,"@metamask/eth-snap-keyring":2024,"@metamask/snaps-utils":2903,"webextension-polyfill":5763},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.showAccountCreationDialog=k,n.showAccountNameSuggestionDialog=_,n.snapKeyringBuilder=function(e,t){const n=()=>new a.SnapKeyring({messenger:e,callbacks:new O(e,t)});return n.state=null,n.type=a.SnapKeyring.type,n};var r,a=e("@metamask/eth-snap-keyring"),i=(r=e("webextension-polyfill"))&&r.__esModule?r:{default:r},s=e("@metamask/snaps-utils"),o=e("../../../../shared/constants/metametrics"),c=e("../../../../shared/constants/app"),l=e("../../../../shared/lib/translate"),u=e("../../../../ui/components/component-library/icon"),d=e("../../../../shared/lib/accounts"),p=e("../../../../shared/lib/snaps/snaps"),m=e("../../../../shared/lib/accounts/snaps"),h=e("../../../../shared/lib/multichain-accounts/remote-feature-flag"),f=e("./utils/isBlockedUrl"),g=e("./utils/showResult");function y(e,t,n){v(e,t),t.set(e,n)}function v(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w(e,t){return e.get(T(e,t))}function b(e,t,n){return e.set(T(e,t),n),n}function T(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}async function k(e,t){try{return Boolean(await t.call("ApprovalController:addRequest",{origin:e,type:c.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation},!0))}catch(e){throw new Error(`Error occurred while showing account creation dialog.\n${e}`)}}async function _(e,t,n){try{return await t.call("ApprovalController:addRequest",{origin:e,type:c.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showNameSnapAccount,requestData:{snapSuggestedAccountName:n}},!0)}catch(e){throw new Error(`Error occurred while showing name account dialog.\n${e}`)}}var E=new WeakMap,P=new WeakMap,S=new WeakMap,A=new WeakMap,C=new WeakSet;class O{constructor(e,{trackEvent:t,persistKeyringHelper:n,removeAccountHelper:r}){!function(e,t){v(e,t),t.add(e)}(this,C),y(this,E,void 0),y(this,P,void 0),y(this,S,void 0),y(this,A,void 0),b(E,this,e),b(P,this,t),b(S,this,n),b(A,this,r)}async addressExists(e){return(await w(E,this).call("KeyringController:getAccounts")).includes(e.toLowerCase())}async redirectUser(e,t,n){if(t.length>0||n.length>0){const r=await(0,f.isBlockedUrl)(t,async()=>await w(E,this).call("PhishingController:maybeUpdateState"),e=>w(E,this).call("PhishingController:testOrigin",e)),a=await w(E,this).call("ApprovalController:addRequest",{origin:e,requestData:{url:t,message:n,isBlockedUrl:r},type:c.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect},!0);Boolean(a)&&t.length>0?i.default.tabs.create({url:t}):console.log("User refused snap account redirection to:",t)}else console.log("Error occurred when redirecting snap account. url or message must be defined")}async saveState(){await w(S,this).call(this)}async addAccount(e,t,n,r,i="",{displayConfirmation:o,displayAccountNameSuggestion:c,setSelectedAccount:l}=(0,a.getDefaultInternalOptions)()){(0,s.assertIsValidSnapId)(t);const u=(0,p.isSnapPreinstalled)(t);let d=u&&(0,m.isMultichainWalletSnap)(t);const h=d||u&&!o,f=d||u&&!c,g=d||u&&!l,y=h&&f,{accountName:v}=await T(C,this,R).call(this,{snapId:t,skipConfirmationDialog:h,skipAccountNameSuggestionDialog:f,skipApprovalFlow:y,accountNameSuggestion:d?"":i,handleUserInput:n});T(C,this,N).call(this,{address:e,snapId:t,skipConfirmationDialog:h,skipSetSelectedAccountStep:g,skipApprovalFlow:y,accountName:v,onceSaved:r,defaultAccountNameChosen:Boolean(i)&&v===i})}async removeAccount(e,t,n){(0,s.assertIsValidSnapId)(t);const r=(0,m.getSnapName)(t,w(E,this)),{id:a}=w(E,this).call("ApprovalController:startFlow"),i="https://support.metamask.io/managing-my-wallet/accounts-and-addresses/how-to-remove-an-account-from-your-metamask-wallet/",d=e=>{w(P,this).call(this,{event:e,category:o.MetaMetricsEventCategory.Accounts,properties:{account_type:o.MetaMetricsEventAccountType.Snap,snap_id:t,snap_name:r}})};let p=!1;try{if(p=Boolean(await w(E,this).call("ApprovalController:addRequest",{origin:t,type:c.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval,requestData:{publicAddress:e}},!0)),!p)throw await n(p),new Error("User denied account removal");try{await w(A,this).call(this,e),await n(p),await w(S,this).call(this),d(o.MetaMetricsEventName.RemoveSnapAccountSuccessViewed),await(0,g.showError)(w(E,this),t,{icon:u.IconName.UserCircleRemove,title:(0,l.t)("snapAccountRemoved")},{message:(0,l.t)("snapAccountRemovedDescription"),learnMoreLink:i}),d(o.MetaMetricsEventName.RemoveSnapAccountSuccessClicked)}catch(e){const n=e.message;throw await(0,g.showError)(w(E,this),t,{icon:u.IconName.UserCircleRemove,title:(0,l.t)("snapAccountRemovalFailed")},{message:(0,l.t)("snapAccountRemovalFailedDescription",r),learnMoreLink:i,error:n}),d(o.MetaMetricsEventName.AccountRemoveFailed),new Error(`Error occurred while removing snap account: ${n}`)}}finally{p&&d(o.MetaMetricsEventName.AccountRemoved),w(E,this).call("ApprovalController:endFlow",{id:a})}}}async function M(e){const{id:t}=w(E,this).call("ApprovalController:startFlow");try{return await e(t)}finally{w(E,this).call("ApprovalController:endFlow",{id:t})}}async function j(e,t){const{success:n,name:r}=await _(e,w(E,this),t);return{success:n,accountName:r}}async function I(e){const t=await w(E,this).call("AccountsController:listMultichainAccounts");return{success:!0,accountName:(0,d.getUniqueAccountName)(t,e)}}async function R({snapId:e,skipConfirmationDialog:t,skipAccountNameSuggestionDialog:n,skipApprovalFlow:r,handleUserInput:a,accountNameSuggestion:i}){if(r){const{success:e,accountName:t}=await T(C,this,I).call(this,i);if(await a(e),!e)throw new Error("User denied account creation");return{accountName:t}}return await T(C,this,M).call(this,async r=>{{const n=t||await k(e,w(E,this));if(!n)throw await a(n),new Error("User denied account creation")}{const{success:t,accountName:r}=n?await T(C,this,I).call(this,i):await T(C,this,j).call(this,e,i);if(await a(t),!t)throw new Error("User denied account creation");return{accountName:r}}})}function x(){var e;const t=w(E,this).call("RemoteFeatureFlagController:getState"),n=null==t||null===(e=t.remoteFeatureFlags)||void 0===e?void 0:e.enableMultichainAccountsState2;return(0,h.isMultichainAccountsFeatureEnabled)(n,h.FEATURE_VERSION_2)}async function N({address:e,snapId:t,skipConfirmationDialog:n,skipSetSelectedAccountStep:r,skipApprovalFlow:a,onceSaved:i,accountName:s,defaultAccountNameChosen:c}){const d="https://support.metamask.io/managing-my-wallet/accounts-and-addresses/how-to-add-accounts-in-your-wallet/",p=(0,m.getSnapName)(t,w(E,this)),h=e=>{w(P,this).call(this,{event:e,category:o.MetaMetricsEventCategory.Accounts,properties:{account_type:o.MetaMetricsEventAccountType.Snap,snap_id:t,snap_name:p,...e===o.MetaMetricsEventName.AccountAdded&&{is_suggested_name:c}}})},f=async()=>{try{const a=await i;r||w(E,this).call("AccountsController:setSelectedAccount",a),T(C,this,x).call(this)||s&&w(E,this).call("AccountsController:setAccountName",a,s),n||(h(o.MetaMetricsEventName.AddSnapAccountSuccessViewed),await(0,g.showSuccess)(w(E,this),t,{icon:u.IconName.UserCircleAdd,title:(0,l.t)("snapAccountCreated")},{message:(0,l.t)("snapAccountCreatedDescription"),address:e,learnMoreLink:d}),h(o.MetaMetricsEventName.AddSnapAccountSuccessClicked)),h(o.MetaMetricsEventName.AccountAdded)}catch(e){const n=e.message;await(0,g.showError)(w(E,this),t,{icon:u.IconName.UserCircleAdd,title:(0,l.t)("snapAccountCreationFailed")},{message:(0,l.t)("snapAccountCreationFailedDescription",p),learnMoreLink:d,error:n}),console.error("Error occurred while creating snap account:",n)}};a?await f():await T(C,this,M).call(this,f)}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/snap-keyring.ts"}],[339,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAccountsBySnapId=void 0;n.getAccountsBySnapId=async(e,t)=>{const n=await e();return await n.getAccountsBySnapId(t)}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils.ts"}],[34,{"../../../../shared/modules/shield/config":5939,"@metamask/claims-controller":1439},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ClaimsServiceInit=void 0;var r=e("@metamask/claims-controller"),a=e("../../../../shared/modules/shield/config");n.ClaimsServiceInit=e=>{const{controllerMessenger:t}=e,{claimsEnv:n}=(0,a.loadShieldConfig)();return{controller:new r.ClaimsService({messenger:t,env:n,fetchFunction:fetch.bind(globalThis)}),memStateKey:null,persistedStateKey:null}}}}},{package:"$root$",file:"app/scripts/controller-init/claims/claims-service-init.ts"}],[340,{"../keyring-snaps-permissions":336},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isBlockedUrl=void 0;var r=e("../keyring-snaps-permissions");n.isBlockedUrl=async(e,t,n)=>{try{return!(0,r.isProtocolAllowed)(e)||(await t(),n(e).result)}catch(e){return console.error("Invalid URL passed into snap-keyring:",e),!1}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/isBlockedUrl.ts"}],[341,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.showSuccess=n.showError=void 0;const r=e=>({name:"SnapAuthorshipHeader",key:"snapHeader",properties:{snapId:e}});n.showError=(e,t,n,a)=>e.call("ApprovalController:showError",{header:[r(t)],title:n.title,icon:n.icon,error:{key:"snapAccountErrorMessage",name:"SnapAccountErrorMessage",properties:a}});n.showSuccess=(e,t,n,a)=>e.call("ApprovalController:showSuccess",{header:[r(t)],title:n.title,icon:n.icon,message:{key:"snapAccountSuccessMessage",name:"SnapAccountSuccessMessage",properties:a}})}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/showResult.ts"}],[342,{loglevel:4846},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.tryPostMessage=function(e,t,n){const r={data:{method:t,params:n}};try{return e.postMessage(r),!0}catch(e){return a.default.error("MetaMask - Failed to message to port",e,r),!1}};var r,a=(r=e("loglevel"))&&r.__esModule?r:{default:r}}}},{package:"$root$",file:"app/scripts/lib/start-up-errors/start-up-errors.ts"}],[343,{"../../../../shared/constants/start-up-errors":5807,"../../../../shared/constants/state-corruption":5808,"../start-up-errors/start-up-errors":342,"../stores/persistence-manager":349,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CorruptionHandler=void 0,n.hasVault=l;var r=e("@metamask/utils"),a=e("../../../../shared/constants/state-corruption"),i=e("../stores/persistence-manager"),s=e("../start-up-errors/start-up-errors"),o=e("../../../../shared/constants/start-up-errors");function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){if((0,r.isObject)(e)&&(0,r.hasProperty)(e,"KeyringController")){const t=e.KeyringController;if((0,r.isObject)(t)&&(0,r.hasProperty)(t,"vault"))return Boolean(t.vault)}return!1}n.CorruptionHandler=class{constructor(){c(this,"connectedPorts",new Set)}async handleStateCorruptionError({port:e,error:t,database:n,repairCallback:c}){const{connectedPorts:u}=this,d=await async function(e,t){let n=(0,r.isObject)(e)&&(0,r.hasProperty)(e,"backup")&&null!==e.backup?e.backup:null;if(!n)try{n=await t.getBackup()??null}catch{n=null}return n}(t,n),p=function(e){if((0,r.isObject)(e)&&(0,r.hasProperty)(e,"PreferencesController")){const t=e.PreferencesController;if((0,r.isObject)(t)&&(0,r.hasProperty)(t,"currentLocale")&&"string"==typeof t.currentLocale)return t.currentLocale}return null}(d),m=Boolean(l(d)),h=function(e){return e instanceof i.PersistenceError&&e.cause instanceof Error&&e.cause.message?e.cause.message:null}(t);return(0,s.tryPostMessage)(e,a.METHOD_DISPLAY_STATE_CORRUPTION_ERROR,{error:{message:t.message,name:t.name,stack:t.stack,causeMessage:h},currentLocale:p,hasBackup:m})?new Promise((t,n)=>{u.add(e),e.onDisconnect.addListener(function(){u.delete(e),t()}),e.onMessage.addListener(async function e(r){var i;if((null==r||null===(i=r.data)||void 0===i?void 0:i.method)===a.METHOD_REPAIR_DATABASE){u.forEach(t=>t.onMessage.removeListener(e));try{await async function(e){return await navigator.locks.request("repairDatabase",{ifAvailable:!0},async function(t){return null!==t&&(await e(),!0)})}(async function(){try{await c(d)}finally{u.forEach(e=>{(0,s.tryPostMessage)(e,o.RELOAD_WINDOW)})}}),t()}catch(e){n(e)}}})}):Promise.resolve()}}}}},{package:"$root$",file:"app/scripts/lib/state-corruption/state-corruption-recovery.ts"}],[344,{lodash:4838},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitizePatches=function(e){return e.filter(e=>{if(a.includes(e.path[0]))return!1;for(const t of i)if(s(e,t))return!1;return!0})},n.sanitizeUIState=function(e){const t={...e};for(const e of a)delete t[e];return function(e){const t=e.snaps;if(!t)return;e.snaps=Object.values(t).reduce((e,t)=>(e[t.id]=function(e){const t={...e};return delete t.sourceCode,delete t.auxiliaryFiles,t}(t),e),{})}(t),function(e){const t=e.srpSessionData;if(!t)return;e.srpSessionData=Object.entries(t).reduce((e,[t,n])=>{const r={...n.token};return delete r.accessToken,e[t]={...n,token:r},e},{})}(t),function(e){const t=e.nodeAuthTokens;t&&(e.nodeAuthTokens=t.map(e=>{const t={...e};return delete t.authToken,t}));const n=e.socialBackupsMetadata;n&&(e.socialBackupsMetadata=n.map(e=>{const t={...e};return delete t.hash,t}))}(t),t};var r=e("lodash");const a=["encryptionKey","encryptionSalt","vault","c2DomainBlocklistLastFetched","hotlistLastFetched","phishingLists","stalelistLastFetched","whitelist","whitelistPaths","accessToken","encryptedKeyringEncryptionKey","encryptedSeedlessEncryptionKey","metadataAccessToken","refreshToken","revokeToken","vaultEncryptionKey","vaultEncryptionSalt","snapStates","unencryptedSnapStates"],i=[["nodeAuthTokens",!0,"authToken"],["snaps",!0,"auxiliaryFiles"],["snaps",!0,"sourceCode"],["socialBackupsMetadata",!0,"hash"],["srpSessionData",!0,"token","accessToken"]];function s(e,t){for(let n=0;n<t.length;n++){const a=t[n],i=n===t.length-1,s=n===e.path.length-1;if(!(e.path[n]===a||!0===a&&e.path[n]!==undefined))return!1;if(i)return!0;if(s&&!c(e.value))return!1;if(s){const a=t.slice(n+1);return e.value=(0,r.cloneDeep)(e.value),o(e.value,a),!1}}return!1}function o(e,t,n=0){const r=t[n],a=n===t.length-1;if(a&&!0!==r&&r in e&&!Array.isArray(e))return void delete e[r];if(a)return;let i=[];!0===r?i=Object.values(e):Array.isArray(e)||(i=[e[r]]);const s=i.filter(c);for(const e of s)o(e,t,n+1)}function c(e){return"object"==typeof e&&null!==e&&e!==undefined}}}},{package:"$root$",file:"app/scripts/lib/state-utils.ts"}],[345,{"@metamask/storage-service":2926,"webextension-polyfill":5763},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BrowserStorageAdapter=void 0;var r,a=(r=e("webextension-polyfill"))&&r.__esModule?r:{default:r},i=e("@metamask/storage-service");function s(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function o(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var c=new WeakSet;function l(e,t){return`${i.STORAGE_KEY_PREFIX}${e}:${t}`}n.BrowserStorageAdapter=class{constructor(){s(this,c)}async getItem(e,t){try{const n=o(c,this,l).call(this,e,t),r=await a.default.storage.local.get(n);return n in r?{result:r[n]}:{}}catch(n){return console.error(`StorageService: Failed to get item: ${e}:${t}`,n),{error:n}}}async setItem(e,t,n){try{const r=o(c,this,l).call(this,e,t);await a.default.storage.local.set({[r]:n})}catch(n){throw console.error(`StorageService: Failed to set item: ${e}:${t}`,n),n}}async removeItem(e,t){try{const n=o(c,this,l).call(this,e,t);await a.default.storage.local.remove(n)}catch(n){throw console.error(`StorageService: Failed to remove item: ${e}:${t}`,n),n}}async getAllKeys(e){try{const t=`${i.STORAGE_KEY_PREFIX}${e}:`,n=await a.default.storage.local.get(null);return Object.keys(n).filter(e=>e.startsWith(t)).map(e=>e.slice(t.length))}catch(t){throw console.error(`StorageService: Failed to get keys for ${e}`,t),t}}async clear(e){try{const t=(await this.getAllKeys(e)).map(t=>o(c,this,l).call(this,e,t));t.length>0&&await a.default.storage.local.remove(t)}catch(t){throw console.error(`StorageService: Failed to clear namespace ${e}`,t),t}}}}}},{package:"$root$",file:"app/scripts/lib/stores/browser-storage-adapter.ts"}],[35,{"./claims-controller-init":33,"./claims-service-init":34},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"ClaimsControllerInit",{enumerable:!0,get:function(){return r.ClaimsControllerInit}}),Object.defineProperty(n,"ClaimsServiceInit",{enumerable:!0,get:function(){return a.ClaimsServiceInit}});var r=e("./claims-controller-init"),a=e("./claims-service-init")}}},{package:"$root$",file:"app/scripts/controller-init/claims/index.ts"}],[352,{"../../../../../shared/lib/delegation":5864,"../../../../../shared/lib/delegation/delegation":5861,"@metamask/transaction-controller":2994,"@metamask/utils":3116,"bignumber.js":3972},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.enforceSimulations=async function({messenger:e,transactionMeta:t,useRealSignature:n=!1}){c("Enforcing simulations",{transactionMeta:t,useRealSignature:n});const{chainId:i,simulationData:d={tokenBalanceChanges:[]},txParams:p}=t,m=p.from,h=(0,a.hexToNumber)(i),f=(0,s.getDeleGatorEnvironment)(h),g=f.DelegationManager,y=function(e,t){const n=e.call("AppStateController:getState"),r=n.enforcedSimulationsSlippage;return n.enforcedSimulationsSlippageForTransactions[t]??r}(e,t.id),v=function({accountAddress:e,environment:t,simulationData:n,slippage:a}){const i=function(e,t,n,a){const i=(0,s.createCaveatBuilder)(t),{nativeBalanceChange:o,tokenBalanceChanges:l=[]}=n;if(o){const{difference:t,isDecrease:n}=o,r=u(t,a,n);c("Caveat - Native Balance Change",{enforceDecrease:n,recipient:e,delta:BigInt(t),slippage:a,deltaWithSlippage:r}),i.addCaveat("nativeBalanceChange",n,e,r)}for(const t of l){const{difference:n,isDecrease:s,address:o,standard:l,id:d}=t,p=BigInt(n),m=u(n,a,s),h=d?BigInt(d):0n;switch(c("Caveat - Token Balance Change",{enforceDecrease:s,token:o,recipient:e,delta:p,slippage:a,deltaWithSlippage:m}),l){case r.SimulationTokenStandard.erc20:i.addCaveat("erc20BalanceChange",s,o,e,m);break;case r.SimulationTokenStandard.erc721:i.addCaveat("erc721BalanceChange",s,o,e,p);break;case r.SimulationTokenStandard.erc1155:i.addCaveat("erc1155BalanceChange",s,o,e,h,p);break;default:c("Unsupported token standard",l)}}return i.build()}(e,t,n,a);c("Caveats",i);const o=(0,s.createDelegation)({from:e,to:e,caveats:i});return o}({accountAddress:m,environment:f,simulationData:d,slippage:y});c("Delegation",v);let w=l;n&&(c("Signing delegation"),w=await e.call("DelegationController:signDelegation",{chainId:i,delegation:v}));c("Delegation signature",w);const b=function({transaction:e,delegation:t}){const n=[[t]],r=[s.SINGLE_DEFAULT_MODE],a=[[{target:e.to,callData:e.data??"0x",value:e.value?BigInt(e.value):0n}]];return(0,o.encodeRedeemDelegations)({delegations:n,modes:r,executions:a})}({transaction:p,delegation:{...v,signature:w}});return c("Data",b),{updateTransaction:e=>{e.txParams.data=b,e.txParams.to=g,e.txParams.value="0x0"}}};var r=e("@metamask/transaction-controller"),a=e("@metamask/utils"),i=e("bignumber.js"),s=e("../../../../../shared/lib/delegation"),o=e("../../../../../shared/lib/delegation/delegation");const c=(0,a.createProjectLogger)("enforced-simulations"),l="0x2261a7810ed3e9cde160895909e138e2f68adb2da86fcf98ea0840701df107721fb369ab9b52550ea98832c09f8185284aca4c94bd345e867a4f4461868dd7751b";function u(e,t,n){const r=new i.BigNumber(e),a=(100+(n?t:-t))/100;return BigInt(r.mul(a).toFixed(0))}}}},{package:"$root$",file:"app/scripts/lib/transaction/containers/enforced-simulations.ts"}],[353,{"./enforced-simulations":352,"@metamask/transaction-controller":2994,"@metamask/utils":3116,lodash:4838},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.applyTransactionContainers=c,n.applyTransactionContainersExisting=async function({containerTypes:e,transactionId:t,messenger:n,updateEditableParams:r}){const i=(await n.call("TransactionController:getState")).transactions.find(e=>e.id===t);if(!i)throw new Error(`Transaction with ID ${t} not found.`);const{updateTransaction:s}=await c({isApproved:!1,messenger:n,transactionMeta:i,types:e}),o=(0,a.cloneDeep)(i);s(o),r(t,{containerTypes:e,data:o.txParams.data,gas:o.txParams.gas,to:o.txParams.to,value:o.txParams.value})};var r=e("@metamask/transaction-controller"),a=e("lodash"),i=e("@metamask/utils"),s=e("./enforced-simulations");const o=(0,i.createProjectLogger)("transaction-containers");async function c({isApproved:e,messenger:t,transactionMeta:n,types:i}){const{txParamsOriginal:c}=n,l=(0,a.cloneDeep)(n);if(c&&(l.txParams=(0,a.cloneDeep)(c)),i.includes(r.TransactionContainerType.EnforcedSimulations)){const{updateTransaction:n}=await(0,s.enforceSimulations)({messenger:t,transactionMeta:l,useRealSignature:e});n(l)}let u;if(!e){const{gas:e}=await t.call("TransactionController:estimateGas",l.txParams,l.networkClientId,{ignoreDelegationSignatures:!0});o("Estimated gas",e),u=e}return{updateTransaction:e=>{e.containerTypes=i,e.txParams=(0,a.cloneDeep)(l.txParams),u&&(e.txParams.gas=u)}}}}}},{package:"$root$",file:"app/scripts/lib/transaction/containers/util.ts"}],[354,{"../../../../../shared/lib/four-byte":5871,"@ethersproject/abi":723,"@metamask/utils":3116,"ethereumjs-util":4342},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeTransactionDataWithFourByte=async function(e){const t=e.slice(0,10),n=await(0,s.getMethodFrom4Byte)(t);if(!n)return undefined;const i=n.split("(")[0],d=function(e){let t=e.slice(e.indexOf("(")+1,-1);const n=[];for(;t.includes("(");){const e=u(t);if(!e)break;n.push(e.value),t=`${t.slice(0,e.start)}${n.length-1}#${t.slice(e.end+1)}`}return l(t,n)}(n);o("Generated inputs",d);const p=(0,r.addHexPrefix)(e.slice(10)),m=a.Interface.getAbiCoder().decode(d,p),h=d.map((e,t)=>c(e,t,m));return{name:i,params:h}};var r=e("ethereumjs-util"),a=e("@ethersproject/abi"),i=e("@metamask/utils"),s=e("../../../../../shared/lib/four-byte");const o=(0,i.createProjectLogger)("four-byte");function c(e,t,n){var r;const a=n[t],{type:i,name:s}=e;let o=null===(r=e.components)||void 0===r?void 0:r.map((e,t)=>c(e,t,a));if(i.endsWith("[]")){const t=i.slice(0,-2);o=a.map((n,r)=>{const i=`Item ${r+1}`;return c({...e,name:i,type:t},r,a)})}return{name:s,type:i,value:a,children:o}}function l(e,t){return e.split(",").map(e=>{const n=e.split("#"),r=n.length>1?parseInt(n[0],10):undefined;return{type:r===undefined?e:`tuple${n[1]??""}`,components:r===undefined?undefined:l(t[r],t)}})}function u(e){let t=-1;for(let n=0;n<e.length;n++)if("("===e[n])t=n;else if(")"===e[n]&&-1!==t)return{start:t,end:n,value:e.slice(t+1,n)};return undefined}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/four-byte.ts"}],[355,{"ethereumjs-util":4342},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getContractProxyAddress=async function(e,t){const n=(await Promise.all(a.map(n=>t.request({method:"eth_getStorageAt",params:[e,n,"latest"]})))).find(e=>(0,r.stripHexPrefix)(e)!==i);return n&&(0,r.addHexPrefix)(n.slice(26))};var r=e("ethereumjs-util");const a=["0x7050c9e0f4ca769c69bd3a8ef740bc37934f8e2c036e5a723fd8ee048ed3f8c3","0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc"],i="0".padEnd(64,"0")}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/proxy.ts"}],[356,{"@ethersproject/abi":723,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeTransactionDataWithSourcify=async function(e,t,n){var o,c;const l=await async function(e,t){var n;const r=await async function(e,t){const n=parseInt(t,16),r=await fetch(`https://sourcify.dev/server/files/any/${n}/${e}`);if(!r.ok)throw new Error("Failed to fetch Sourcify files");return r.json()}(e,t),a=null===(n=r.files)||void 0===n?void 0:n.find(e=>e.name.includes("metadata.json"));if(!a)throw new Error("Metadata not found");return JSON.parse(a.content)}(t,n);a("Retrieved Sourcify metadata",{contractAddress:t,chainId:n,metadata:l});const{abi:u}=l.output,d=new r.Interface(u),p=e.slice(0,10);let m;try{m=d.getFunction(p)}catch(e){}if(!m)return a("Failed to find function in ABI",p,u),undefined;const{name:h,inputs:f}=m,g=s(h,f),y=null===(o=l.output.userdoc)||void 0===o?void 0:o.methods[g],v=null===(c=l.output.devdoc)||void 0===c?void 0:c.methods[g],w=(null==y?void 0:y.notice)??(null==v?void 0:v.details);a("Extracted NatSpec",{signature:g,userDoc:y,devDoc:v});const b=d.decodeFunctionData(p,e),T=f.map((e,t)=>i(e,t,b,y,v));return{name:h,description:w,params:T}};var r=e("@ethersproject/abi");const a=(0,e("@metamask/utils").createProjectLogger)("sourcify");function i(e,t,n,r,a){var s,o;const{name:c,type:l,components:u}=e,d=(null==r||null===(s=r.params)||void 0===s?void 0:s[c])??(null==a||null===(o=a.params)||void 0===o?void 0:o[c]),p=n[t];let m=null==u?void 0:u.map((e,t)=>i(e,t,p,{},{}));if(l.endsWith("[]")){const t=l.slice(0,-2);m=p.map((n,r)=>{const a=`Item ${r+1}`;return i({...e,name:a,type:t},r,p,{},{})})}return{name:c,description:d,type:l,value:p,children:m}}function s(e,t){return`${e??""}(${t.map(e=>{var t;return null!==(t=e.components)&&void 0!==t&&t.length?`${s(undefined,e.components)}${e.type.endsWith("[]")?"[]":""}`:e.type}).join(",")})`}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/sourcify.ts"}],[357,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UNISWAP_ROUTER_COMMANDS=void 0;n.UNISWAP_ROUTER_COMMANDS={0:{name:"V3_SWAP_EXACT_IN",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of input tokens for the trade",name:"amountIn"},{type:"uint256",description:"The minimum amount of output tokens the user wants",name:"amountOutMin"},{type:"bytes",description:"The UniswapV3 encoded path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},1:{name:"V3_SWAP_EXACT_OUT",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of output tokens to receive",name:"amountOut"},{type:"uint256",description:"The maximum number of input tokens that should be spent",name:"amountInMax"},{type:"bytes",description:"The UniswapV3 encoded path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},2:{name:"PERMIT2_TRANSFER_FROM",params:[{type:"address",description:"The token to fetch from Permit2",name:"token"},{type:"address",description:"The recipient of the tokens fetched",name:"recipient"},{type:"uint256",description:"The amount of token to fetch",name:"amount"}]},3:{name:"PERMIT2_PERMIT_BATCH",params:[{type:"bytes",description:"A PermitBatch struct outlining all of the Permit2 permits to execute.",name:"batch"},{type:"bytes",description:"The signature to provide to Permit2",name:"data"}]},4:{name:"SWEEP",params:[{type:"address",description:"The ERC20 token to sweep (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the sweep",name:"recipient"},{type:"uint256",description:"The minimum required tokens to receive from the sweep",name:"amountMin"}]},5:{name:"TRANSFER",params:[{type:"address",description:"The ERC20 token to transfer (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"The amount to transfer",name:"value"}]},6:{name:"PAY_PORTION",params:[{type:"address",description:"The ERC20 token to transfer (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"In basis points, the percentage of the contractâs balance to transfer",name:"bips"}]},8:{name:"V2_SWAP_EXACT_IN",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of input tokens for the trade",name:"amountIn"},{type:"uint256",description:"The minimum amount of output tokens the user wants",name:"amountOutMin"},{type:"address[]",description:"The UniswapV2 token path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},9:{name:"V2_SWAP_EXACT_OUT",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of output tokens to receive",name:"amountOut"},{type:"uint256",description:"The maximum number of input tokens that should be spent",name:"amountInMax"},{type:"address[]",description:"The UniswapV2 token path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},10:{name:"PERMIT2_PERMIT",params:[{type:"bytes",description:"A PermitSingle struct outlining the Permit2 permit to execute",name:"permitSingle"},{type:"bytes",description:"The signature to provide to Permit2",name:"signature"}]},11:{name:"WRAP_ETH",params:[{type:"address",description:"The recipient of the WETH",name:"recipient"},{type:"uint256",description:"The amount of ETH to wrap",name:"amountMin"}]},12:{name:"UNWRAP_WETH",params:[{type:"address",description:"The recipient of the ETH",name:"recipient"},{type:"uint256",description:"The minimum required ETH to receive from the unwrapping",name:"amountMin"}]},13:{name:"PERMIT2_TRANSFER_FROM_BATCH",params:[{type:"bytes",description:"An array of AllowanceTransferDetails structs that each describe a Permit2 transfer to perform",name:"batchDetails"}]},16:{name:"SEAPORT",params:[{type:"uint256",description:"The ETH value to forward to the Seaport contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Seaport contract",name:"data"}]},17:{name:"LOOKS_RARE_721",params:[{type:"uint256",description:"The ETH value to forward to the LooksRare contract",name:"value"},{type:"bytes",description:"The calldata to use to call the LooksRare contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},18:{name:"NFTX",params:[{type:"uint256",description:"The ETH value to forward to the NFTX contract",name:"value"},{type:"bytes",description:"The calldata to use to call the NFTX contract",name:"data"}]},19:{name:"CRYPTOPUNKS",params:[{type:"uint256",description:"The PunkID to purchase",name:"punkId"},{type:"address",description:"The recipient for the cryptopunk",name:"recipient"},{type:"uint256",description:"The ETH value to forward to the Cryptopunks contract",name:"value"}]},20:{name:"LOOKS_RARE_1155",params:[{type:"uint256",description:"The ETH value to forward to the LooksRare contract",name:"value"},{type:"bytes",description:"The calldata to use to call the LooksRare contract",name:"data"},{type:"address",description:"The recipient of the ERC1155",name:"recipient"},{type:"address",description:"The ERC1155 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The amount of the ERC1155 to transfer",name:"amount"}]},21:{name:"OWNER_CHECK_721",params:[{type:"address",description:"The required owner of the ERC721",name:"owner"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},22:{name:"OWNER_CHECK_1155",params:[{type:"address",description:"The required owner of the ERC1155",name:"owner"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The minimum required amount of the ERC1155",name:"minBalance"}]},23:{name:"SWEEP_ERC721",params:[{type:"address",description:"The ERC721 token address to transfer",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"The token ID to transfer",name:"id"}]},24:{name:"X2Y2_721",params:[{type:"uint256",description:"The ETH value to forward to the X2Y2 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the X2Y2 contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},25:{name:"SUDOSWAP",params:[{type:"uint256",description:"The ETH value to forward to the Sudoswap contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Sudoswap contract",name:"data"}]},26:{name:"NFT20",params:[{type:"uint256",description:"The ETH value to forward to the NFT20 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the NFT20 contract",name:"data"}]},27:{name:"X2Y2_1155",params:[{type:"uint256",description:"The ETH value to forward to the X2Y2 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the X2Y2 contract",name:"data"},{type:"address",description:"The recipient of the ERC1155",name:"recipient"},{type:"address",description:"The ERC1155 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The amount of the ERC1155 to transfer",name:"amount"}]},28:{name:"FOUNDATION",params:[{type:"uint256",description:"The ETH value to forward to the Foundation contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Foundation contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},29:{name:"SWEEP_ERC1155",params:[{type:"address",description:"The ERC1155 token address to sweep",name:"token"},{type:"address",description:"The recipient of the sweep",name:"recipient"},{type:"uint256",description:"The token ID to sweep",name:"id"},{type:"uint256",description:"The minimum required tokens to receive from the sweep",name:"amount"}]}}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/uniswap-commands.ts"}],[358,{"../../../../../shared/constants/network":5795,"../../../../../shared/modules/decoding":5916,"./uniswap-commands":357,"@ethersproject/abi":723},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UNISWAP_UNIVERSAL_ROUTER_ADDRESSES=void 0,n.decodeUniswapRouterTransactionData=function({transactionData:e,contractAddress:t,chainId:n}){const i=o[n];if(null==i||!i.map(e=>e.toLowerCase()).includes(t.toLowerCase()))return undefined;const l=new r.Interface(c);let u;try{u=l.parseTransaction({data:e})}catch(e){return undefined}const d=u.args.commands,p=u.args.inputs;return d.slice(2).match(/.{1,2}/gu).map((e,t)=>function(e,t){const n=parseInt(e,16),i=31&n,o=s.UNISWAP_ROUTER_COMMANDS[String(i)];if(!o)return undefined;const c=o.params.map(e=>e.type),l=r.Interface.getAbiCoder().decode(c,t),{name:u}=o,d=o.params.map((e,t)=>{const{name:n,type:r,description:i}=e,s=l[t];return{name:n,type:r,value:"path"===n?(0,a.decodeCommandV3Path)(s):s,description:i}});return{name:u,params:d}}(e,p[t])).filter(e=>e!==undefined)};var r=e("@ethersproject/abi"),a=e("../../../../../shared/modules/decoding"),i=e("../../../../../shared/constants/network"),s=e("./uniswap-commands");const o=n.UNISWAP_UNIVERSAL_ROUTER_ADDRESSES={[i.CHAIN_IDS.ARBITRUM]:["0x4C60051384bd2d3C01bfc845Cf5F4b44bcbE9de5","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x5E325eDA8064b456f4781070C0738d849c824258"],[i.CHAIN_IDS.AVALANCHE]:["0x82635AF6146972cD6601161c4472ffe97237D292","0x4Dae2f939ACf50408e13d58534Ff8c2776d45265"],[i.CHAIN_IDS.BASE]:["0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"],[i.CHAIN_IDS.BSC]:["0x5Dc88340E1c5c6366864Ee415d6034cadd1A9897","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x4Dae2f939ACf50408e13d58534Ff8c2776d45265"],[i.CHAIN_IDS.MAINNET]:["0xEf1c6E67703c7BD7107eed8303Fbe6EC2554BF6B","0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"],[i.CHAIN_IDS.OPTIMISM]:["0xb555edF5dcF85f42cEeF1f3630a52A108E55A654","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0xCb1355ff08Ab38bBCE60111F1bb2B784bE25D7e8"],[i.CHAIN_IDS.POLYGON]:["0x4C60051384bd2d3C01bfc845Cf5F4b44bcbE9de5","0x643770E279d5D0733F21d6DC03A8efbABf3255B4","0xec7BE89e9d109e7e3Fec59c222CF297125FEFda2"],[i.CHAIN_IDS.SEPOLIA]:["0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"]},c=[{constant:!0,inputs:[{name:"commands",type:"bytes"},{name:"inputs",type:"bytes[]"},{name:"deadline",type:"uint256"}],name:"execute",type:"function"},{constant:!0,inputs:[{name:"commands",type:"bytes"},{name:"inputs",type:"bytes[]"}],name:"execute",type:"function"}]}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/uniswap.ts"}],[3589,{"./types.js":3590},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./types.js");const a={type:"xstate.init"},i="xstate.assign";function s(e){return e===undefined?[]:[].concat(e)}function o(e,t){return"string"==typeof(e="string"==typeof e&&t&&t[e]?t[e]:e)?{type:e}:"function"==typeof e?{type:e.name,exec:e}:e}function c(e){return t=>e===t}function l(e){return"string"==typeof e?{type:e}:e}function u(e,t){return{value:e,context:t,actions:[],changed:!1,matches:c(e)}}function d(e,t,n){let r=t,a=!1;return[e.filter(e=>{if(e.type===i){a=!0;let t=Object.assign({},r);return"function"==typeof e.assignment?t=e.assignment(r,n):Object.keys(e.assignment).forEach(a=>{t[a]="function"==typeof e.assignment[a]?e.assignment[a](r,n):e.assignment[a]}),r=t,!1}return!0}),r,a]}const p=(e,t)=>e.actions.forEach(({exec:n})=>n&&n(e.context,t));Object.defineProperty(n,"InterpreterStatus",{enumerable:!0,get:function(){return r.InterpreterStatus}}),n.assign=function(e){return{type:i,assignment:e}},n.createMachine=function(e,t={}){const[n,r]=d(s(e.states[e.initial].entry).map(e=>o(e,t.actions)),e.context,a),i={config:e,_options:t,initialState:{value:e.initial,actions:n,context:r,matches:c(e.initial)},transition:(t,n)=>{const{value:r,context:a}="string"==typeof t?{value:t,context:e.context}:t,p=l(n),m=e.states[r];if(m.on){const t=s(m.on[p.type]);for(const n of t){if(n===undefined)return u(r,a);const{target:t,actions:l=[],cond:h=()=>!0}="string"==typeof n?{target:n}:n,f=t===undefined,g=null!=t?t:r,y=e.states[g];if(h(a,p)){const e=(f?s(l):[].concat(m.exit,l,y.entry).filter(e=>e)).map(e=>o(e,i._options.actions)),[n,u,h]=d(e,a,p),g=null!=t?t:r;return{value:g,context:u,actions:n,changed:t!==r||n.length>0||h,matches:c(g)}}}}return u(r,a)}};return i},n.interpret=function(e){let t=e.initialState,n=r.InterpreterStatus.NotStarted;const i=new Set,s={_machine:e,send:a=>{n===r.InterpreterStatus.Running&&(t=e.transition(t,a),p(t,l(a)),i.forEach(e=>e(t)))},subscribe:e=>(i.add(e),e(t),{unsubscribe:()=>i.delete(e)}),start:i=>{if(i){const n="object"==typeof i?i:{context:e.config.context,value:i};t={value:n.value,actions:[],context:n.context,matches:c(n.value)}}else t=e.initialState;return n=r.InterpreterStatus.Running,p(t,a),s},stop:()=>(n=r.InterpreterStatus.Stopped,i.clear(),s),get state(){return t},get status(){return n}};return s}}}},{package:"@metamask/snaps-controllers>@xstate/fsm",file:"node_modules/@xstate/fsm/lib/index.js"}],[359,{"../../../../../shared/types/transaction-decode":5951,"./four-byte":354,"./proxy":355,"./sourcify":356,"./uniswap":358,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeTransactionData=async function({transactionData:e,contractAddress:t,chainId:n,provider:r}){l("Decoding transaction data",{transactionData:e,contractAddress:t,chainId:n});const d=(0,i.decodeUniswapRouterTransactionData)({transactionData:e,contractAddress:t,chainId:n});if(d)return l("Decoded with Uniswap commands",d),{data:u(d),source:a.DecodedTransactionDataSource.Uniswap};const p=await(0,o.getContractProxyAddress)(t,r);p&&l("Retrieved proxy implementation address",p);const m=p??t,h=(0,s.decodeTransactionDataWithSourcify)(e,m,n),f=(0,c.decodeTransactionDataWithFourByte)(e),[g,y]=await Promise.allSettled([h,f]);if("fulfilled"===g.status&&g.value)return l("Decoded data with Sourcify",g.value),{data:u([g.value]),source:a.DecodedTransactionDataSource.Sourcify};if(l("Failed to decode data with Sourcify",g),"fulfilled"===y.status&&y.value)return l("Decoded data with 4Byte",y.value),{data:u([y.value]),source:a.DecodedTransactionDataSource.FourByte};return l("Failed to decode data with 4Byte",y),undefined};var r=e("@metamask/utils"),a=e("../../../../../shared/types/transaction-decode"),i=e("./uniswap"),s=e("./sourcify"),o=e("./proxy"),c=e("./four-byte");const l=(0,r.createProjectLogger)("transaction-decode");function u(e){return e.map(e=>function(e){return{...e,params:e.params.map(e=>d(e))}}(e))}function d(e){var t;return{...e,value:p(e.value),children:null===(t=e.children)||void 0===t?void 0:t.map(e=>d(e))}}function p(e){const t=e._hex;return t?BigInt(t).toString():e}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/util.ts"}],[3590,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;Object.defineProperty(n,"__esModule",{value:!0}),n.InterpreterStatus=void 0,(r=n.InterpreterStatus||(n.InterpreterStatus={}))[r.NotStarted=0]="NotStarted",r[r.Running=1]="Running",r[r.Stopped=2]="Stopped"}}},{package:"@metamask/snaps-controllers>@xstate/fsm",file:"node_modules/@xstate/fsm/lib/types.js"}],[36,{"@metamask/address-book-controller":1252},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AddressBookControllerInit=void 0;var r=e("@metamask/address-book-controller");n.AddressBookControllerInit=({controllerMessenger:e,persistedState:t})=>({controller:new r.AddressBookController({messenger:e,state:t.AddressBookController})})}}},{package:"$root$",file:"app/scripts/controller-init/confirmations/address-book-controller-init.ts"}],[360,{"@ethersproject/abi":723,"@metamask/keyring-controller":2203,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ROOT_AUTHORITY=n.PRIMARY_TYPE_DELEGATION=n.ExecutionMode=n.ANY_BENEFICIARY=void 0,n.encodeRedeemDelegations=function(e,t,n){return new i.Interface(u).encodeFunctionData("redeemDelegations",[p(e),t,(r=n,r.map(m))]);var r},n.signDelegation=async function({chainId:e,delegation:t,from:n,messenger:i}){const c={types:d,primaryType:s,domain:{chainId:String((0,r.hexToNumber)(e)),name:o,version:"1",verifyingContract:"0xdb9B1e94B5b69Df7e401DDbedE43491141047dB3"},message:{...t,chainId:(0,r.hexToNumber)(e)}};return await i.call("KeyringController:signTypedMessage",{from:n,data:c},a.SignTypedDataVersion.V4)};var r=e("@metamask/utils"),a=e("@metamask/keyring-controller"),i=e("@ethersproject/abi");n.ExecutionMode=function(e){return e.BATCH_DEFAULT_MODE="0x0100000000000000000000000000000000000000000000000000000000000000",e}({});n.ROOT_AUTHORITY="0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",n.ANY_BENEFICIARY="0x0000000000000000000000000000000000000a11";const s=n.PRIMARY_TYPE_DELEGATION="Delegation",o="DelegationManager",c=[{type:"address",name:"delegate"},{type:"address",name:"delegator"},{type:"bytes32",name:"authority"},{type:"tuple[]",name:"caveats",components:[{type:"address",name:"enforcer"},{type:"bytes",name:"terms"},{type:"bytes",name:"args"}]},{type:"uint256",name:"salt"},{type:"bytes",name:"signature"}],l=[{type:"address",name:"target"},{type:"uint256",name:"value"},{type:"bytes",name:"callData"}],u=[{type:"function",name:"redeemDelegations",inputs:[{name:"_permissionContexts",type:"bytes[]",internalType:"bytes[]"},{name:"_modes",type:"bytes32[]",internalType:"ModeCode[]"},{name:"_executionCallDatas",type:"bytes[]",internalType:"bytes[]"}],outputs:[],stateMutability:"nonpayable"}],d={EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Caveat:[{name:"enforcer",type:"address"},{name:"terms",type:"bytes"}],Delegation:[{name:"delegate",type:"address"},{name:"delegator",type:"address"},{name:"authority",type:"bytes32"},{name:"caveats",type:"Caveat[]"},{name:"salt",type:"uint256"}]};function p(e){return e.map(e=>{return t=e,i.defaultAbiCoder.encode([i.ParamType.from({components:c,name:"delegations",type:"tuple[]"})],[t]);var t})}function m(e){return i.defaultAbiCoder.encode([i.ParamType.from({components:l,name:"executions",type:"tuple[]"})],[e])}}}},{package:"$root$",file:"app/scripts/lib/transaction/delegation.ts"}],[361,{"../../../../../shared/lib/delegation":5864,"../../../../../shared/lib/delegation/caveatBuilder/exactExecutionBuilder":5855,"../../../../../shared/lib/delegation/caveatBuilder/limitedCallsBuilder":5857,"../../../../../shared/lib/delegation/caveatBuilder/specificActionERC20TransferBatchBuilder":5860,"../../../../../shared/lib/delegation/delegation":5861,"../../../../../shared/lib/eip7702-support-utils":5866,"../transaction-relay":365,"../util":366,"@ethersproject/abi":723,"@metamask/controller-utils":1449,"@metamask/metamask-eth-abis":2263,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Delegation7702PublishHook=void 0;var r=e("@ethersproject/abi"),a=e("@metamask/metamask-eth-abis"),i=e("@metamask/utils"),s=e("@metamask/controller-utils"),o=e("../../../../../shared/lib/delegation"),c=e("../../../../../shared/lib/eip7702-support-utils"),l=e("../../../../../shared/lib/delegation/caveatBuilder/exactExecutionBuilder"),u=e("../../../../../shared/lib/delegation/caveatBuilder/limitedCallsBuilder"),d=e("../../../../../shared/lib/delegation/caveatBuilder/specificActionERC20TransferBatchBuilder"),p=e("../../../../../shared/lib/delegation/delegation"),m=e("../transaction-relay"),h=e("../util");function f(e,t,n){g(e,t),t.set(e,n)}function g(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t){return e.get(w(e,t))}function v(e,t,n){return e.set(w(e,t),n),n}function w(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const b={transactionHash:undefined},T=(0,i.createProjectLogger)("delegation-7702-publish-hook");var k=new WeakMap,_=new WeakMap,E=new WeakMap,P=new WeakSet;async function S(e,t){try{return await w(P,this,A).call(this,e,t)}catch(e){throw T("Error",e),e}}async function A(e,t){const{chainId:n,gasFeeTokens:r,selectedGasFeeToken:a,txParams:i}=e,{from:s}=i,l=await y(k,this).call(this,{address:s,chainIds:[n]}),u=(0,c.findAtomicBatchSupportForChain)(l,n),{isSupported:d,delegationAddress:h,upgradeContractAddress:f}=(0,c.checkEip7702Support)(u);if(!d)return T("Skipping as EIP-7702 is not supported",{from:s,chainId:n}),b;const g=e.isGasFeeIncluded,v=Boolean(e.isGasFeeSponsored);if(!(a&&null!=r&&r.length||g||v))return T("Skipping as no selected gas fee token"),b;const _=g||v?undefined:null==r?void 0:r.find(e=>e.tokenAddress.toLowerCase()===(null==a?void 0:a.toLowerCase()));if(!_&&!g&&!v)throw new Error("Selected gas fee token not found");const E=(0,o.getDeleGatorEnvironment)(parseInt(e.chainId,16)),S=E.DelegationManager,A=!g&&!e.isGasFeeSponsored;if(A&&(!_||_===undefined))throw new Error("Gas fee token not found");const M=await w(P,this,C).call(this,E,e,_,A),j=[A?o.BATCH_DEFAULT_MODE:o.SINGLE_DEFAULT_MODE],R=w(P,this,O).call(this,e,_,A),x={chainId:n,data:(0,p.encodeRedeemDelegations)({delegations:M,modes:j,executions:R}),to:S};h||(x.authorizationList=await w(P,this,I).call(this,e,f??undefined)),T("Relay request",x);const{uuid:N}=await(0,m.submitRelayTransaction)(x),{transactionHash:D,status:F}=await(0,m.waitForRelayResult)({chainId:n,uuid:N,interval:1e3});if(F!==m.RelayStatus.Success)throw new Error(`Transaction relay error - ${F}`);return{transactionHash:D}}async function C(e,t,n,r){const a=w(P,this,M).call(this,e,t,n,r);T("Signing delegation");const i=await y(_,this).call("DelegationController:signDelegation",{chainId:t.chainId,delegation:a});T("Delegation signature",i);return[[{...a,signature:i}]]}function O(e,t,n){const{txParams:r}=e,{data:a,to:i,value:s}=r,o=w(P,this,N).call(this,a),c={target:i,value:BigInt(s??"0x0"),callData:o};if(!n)return[[c]];if(!t)throw new Error("Selected gas fee token not found");return[[c,{target:t.tokenAddress,value:BigInt("0x0"),callData:w(P,this,R).call(this,t.recipient,t.amount)}]]}function M(e,t,n,r){const a=w(P,this,j).call(this,e,t,n,r);T("Caveats",a);const i=(0,o.createDelegation)({from:t.txParams.from,to:p.ANY_BENEFICIARY,caveats:a});return T("Delegation",i),i}function j(e,t,n,r){const a=(0,o.createCaveatBuilder)(e),{txParams:i}=t,{to:s,value:c,data:p}=i,m=w(P,this,N).call(this,p);if(r&&n!==undefined){const{tokenAddress:e,recipient:t,amount:r}=n;s!==undefined&&a.addCaveat(d.specificActionERC20TransferBatch,e,t,r,s,c??"0x0",m)}else s!==undefined&&a.addCaveat(l.exactExecution,s,c??"0x0",m);return a.addCaveat(u.limitedCalls,1),a.build()}async function I(e,t){const{chainId:n,txParams:r,networkClientId:a}=e,{from:i,nonce:s}=r,o=await y(E,this).call(this,i,a),c=s??o;if(T("Including authorization as not upgraded"),!t)throw new Error("Upgrade contract address not found");const l=await y(_,this).call("KeyringController:signEip7702Authorization",{chainId:parseInt(n,16),contractAddress:t,from:i,nonce:parseInt(c,16)}),{r:u,s:d,yParity:p}=w(P,this,x).call(this,l);return T("Authorization signature",{authorizationSignature:l,r:u,s:d,yParity:p}),[{address:t,chainId:n,nonce:c,r:u,s:d,yParity:p}]}function R(e,t){return new r.Interface(a.abiERC20).encodeFunctionData("transfer",[e,t])}function x(e){const t=(0,h.stripSingleLeadingZero)(e.slice(0,66)),n=(0,h.stripSingleLeadingZero)((0,i.add0x)(e.slice(66,130))),r=parseInt(e.slice(130,132),16);return{r:t,s:n,yParity:(0,s.toHex)(r-27==0?0:1)}}function N(e){if("string"!=typeof e||0===e.length)return"0x";const t="0x"===e.slice(0,2).toLowerCase(),n=e.toLowerCase(),r=t?`0x${n.slice(2)}`:`0x${n}`,a=r.slice(2);return 0===a.length?"0x":a.length%2!=0?w(P,this,N).call(this,`0x0${a}`):r}n.Delegation7702PublishHook=class{constructor({isAtomicBatchSupported:e,messenger:t,getNextNonce:n}){var r,a;g(r=this,a=P),a.add(r),f(this,k,void 0),f(this,_,void 0),f(this,E,void 0),v(k,this,e),v(_,this,t),v(E,this,n)}getHook(){return w(P,this,S).bind(this)}}}}},{package:"$root$",file:"app/scripts/lib/transaction/hooks/delegation-7702-publish.ts"}],[362,{"../containers/util":353,"@metamask/controller-utils":1449,"@metamask/transaction-controller":2994,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.EnforceSimulationHook=void 0;e("@metamask/transaction-controller");var r=e("@metamask/utils");e("@metamask/controller-utils"),e("../containers/util");function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(e,t){return e.get(s(e,t))}function s(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const o=(0,r.createProjectLogger)("enforce-simulation-hook");var c=new WeakMap,l=new WeakSet;async function u(e,t){const{transactionMeta:n}=t,{isFinal:r}=e,{containerTypes:a,delegationAddress:s,id:l,origin:u,simulationData:d,txParamsOriginal:p}=n,m=i(c,this).call("AppStateController:getState");(null==m?void 0:m.enableEnforcedSimulationsForTransactions[l])??(null==m||m.enableEnforcedSimulations);return o("Skipping as enforced simulations are disabled"),{skipSimulation:!1}}n.EnforceSimulationHook=class{constructor({messenger:e}){var t,n;a(t=this,n=l),n.add(t),function(e,t,n){a(e,t),t.set(e,n)}(this,c,void 0),function(e,t,n){e.set(s(e,t),n)}(c,this,e)}getAfterSimulateHook(){return s(l,this,u).bind(this,{})}getBeforeSignHook(){return s(l,this,u).bind(this,{isFinal:!0})}}}}},{package:"$root$",file:"app/scripts/lib/transaction/hooks/enforce-simulation-hook.ts"}],[363,{"../../../../shared/constants/app":5775,"../../../../shared/constants/gas":5784,"../../../../shared/constants/metametrics":5791,"../../../../shared/constants/transaction":5814,"../../../../shared/lib/transactions-controller-utils":5899,"../../../../shared/lib/trust-signals":5903,"../../../../shared/modules/Numeric":5906,"../../../../shared/modules/conversion.utils":5913,"../../../../shared/modules/gas.utils":5921,"../../../../shared/modules/metametrics":5924,"../../../../shared/modules/transaction.utils":5947,"../../../../ui/helpers/utils/metrics":7120,"../snap-keyring/metrics":337,"../util":372,"@metamask/transaction-controller":2994,"@metamask/utils":3116,"bignumber.js":3972,"ethereumjs-util":4342},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.handleTransactionSubmitted=n.handleTransactionRejected=n.handleTransactionFailed=n.handleTransactionDropped=n.handleTransactionConfirmed=n.handleTransactionApproved=n.handleTransactionAdded=n.handlePostTransactionBalanceUpdate=n.createTransactionEventFragmentWithTxId=n.METRICS_STATUS_FAILED=void 0;var r=e("bignumber.js"),a=e("ethereumjs-util"),i=e("@metamask/transaction-controller"),s=e("@metamask/utils"),o=e("../../../../shared/constants/app"),c=e("../../../../shared/constants/gas"),l=e("../../../../shared/constants/metametrics"),u=e("../../../../shared/constants/transaction"),d=e("../../../../shared/lib/transactions-controller-utils"),p=e("../../../../shared/modules/conversion.utils"),m=e("../../../../shared/modules/metametrics"),h=e("../../../../shared/modules/transaction.utils"),f=e("../../../../ui/helpers/utils/metrics"),g=e("../snap-keyring/metrics"),y=e("../../../../shared/modules/gas.utils"),v=e("../../../../shared/modules/Numeric"),w=e("../util"),b=e("../../../../shared/lib/trust-signals");const T=(0,s.createProjectLogger)("transaction-metrics"),k=n.METRICS_STATUS_FAILED="failed on-chain",_=[i.TransactionType.bridge,i.TransactionType.bridgeApproval,i.TransactionType.contractInteraction,i.TransactionType.tokenMethodApprove,i.TransactionType.tokenMethodIncreaseAllowance,i.TransactionType.tokenMethodSafeTransferFrom,i.TransactionType.tokenMethodSetApprovalForAll,i.TransactionType.tokenMethodTransfer,i.TransactionType.tokenMethodTransferFrom,i.TransactionType.swap,i.TransactionType.swapAndSend,i.TransactionType.swapApproval];var E=function(e){return e.swap="mm_swap",e.bridge="mm_bridge",e}(E||{});n.handleTransactionAdded=async(e,t)=>{if(!t.transactionMeta)return;const{properties:n,sensitiveProperties:r}=await C({transactionEventPayload:t,transactionMetricsRequest:e});P({eventName:u.TransactionMetaMetricsEvent.added,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:n,sensitiveProperties:r}})};n.handleTransactionApproved=async(e,t)=>{t.transactionMeta&&await S({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionFailed=async(e,t)=>{if(!t.transactionMeta)return;const n={};t.error&&(n.error=t.error),await S({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:n,transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionConfirmed=async(e,t)=>{if(0===Object.keys(t).length)return;const n={},r={...t},{txReceipt:a}=r;n.gas_used=null==a?void 0:a.gasUsed,n.block_number=(null==a?void 0:a.blockNumber)&&(0,p.hexToDecimal)(a.blockNumber);const{submittedTime:i,blockTimestamp:s}=r;i&&(n.completion_time=function(e){return Math.round((Date.now()-e)/1e3).toString()}(i)),i&&s&&(n.completion_time_onchain=function(e,t){const n=2,r=Number((0,p.hexToDecimal)(t))-e/1e3;return(Math.round(r*10**n)/10**n).toString()}(i,s)),"0x0"===(null==a?void 0:a.status)&&(n.status=k),await S({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:n,transactionEventPayload:{actionId:r.actionId,transactionMeta:r},transactionMetricsRequest:e})};n.handleTransactionDropped=async(e,t)=>{if(!t.transactionMeta)return;await S({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:{dropped:!0},transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionRejected=async(e,t)=>{t.transactionMeta&&await S({eventName:u.TransactionMetaMetricsEvent.rejected,transactionEventPayload:t,transactionMetricsRequest:e})};n.handleTransactionSubmitted=async(e,t)=>{if(!t.transactionMeta)return;const{properties:n,sensitiveProperties:r}=await C({transactionEventPayload:t,transactionMetricsRequest:e});P({eventName:u.TransactionMetaMetricsEvent.submitted,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:n,sensitiveProperties:r}})};n.createTransactionEventFragmentWithTxId=async(e,{transactionId:t,actionId:n})=>{const r={...e.getTransaction(t),actionId:n},{properties:a,sensitiveProperties:i}=await C({transactionEventPayload:{transactionMeta:r},transactionMetricsRequest:e});P({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:{actionId:r.actionId,transactionMeta:r},transactionMetricsRequest:e,payload:{properties:a,sensitiveProperties:i}})};function P({eventName:e,transactionEventPayload:{transactionMeta:t,actionId:n},transactionMetricsRequest:r,payload:a}){if(function(e,t,n){const r=A(t,n.id);return void 0!==e(r)}(r.getEventFragmentById,e,t)&&e!==u.TransactionMetaMetricsEvent.submitted)return;const i=A(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.added:r.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.added,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:a.properties,sensitiveProperties:a.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:r.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:a.properties,sensitiveProperties:a.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.submitted:r.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.submitted,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:a.properties,sensitiveProperties:a.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.finalized:r.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:a.properties,sensitiveProperties:a.sensitiveProperties,actionId:n,uniqueIdentifier:i,persist:!0})}}async function S({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n,extraParams:r={}}){const{properties:a,sensitiveProperties:i}=await C({transactionEventPayload:t,transactionMetricsRequest:n,extraParams:r});P({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n,payload:{properties:a,sensitiveProperties:i}}),function({eventName:e,transactionEventPayload:{transactionMeta:t},transactionMetricsRequest:n,payload:r}){const a=A(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:case u.TransactionMetaMetricsEvent.finalized:n.updateEventFragment(a,{properties:r.properties,sensitiveProperties:r.sensitiveProperties})}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n,payload:{properties:a,sensitiveProperties:i}}),function({eventName:e,transactionMetricsRequest:t,transactionEventPayload:{transactionMeta:n}}){const r=A(e,n.id);switch(e){case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.finalized:t.finalizeEventFragment(r);break;case u.TransactionMetaMetricsEvent.rejected:t.finalizeEventFragment(r,{abandoned:!0})}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:n})}function A(e,t){return`transaction-${e===u.TransactionMetaMetricsEvent.finalized||e===u.TransactionMetaMetricsEvent.submitted?"submitted":"added"}-${t}`}async function C({transactionEventPayload:{transactionMeta:e},transactionMetricsRequest:t,extraParams:n={}}){var k;const{type:E,time:P,status:S,chainId:A,origin:C,txParams:{gasPrice:M,gas:j,maxFeePerGas:I,maxPriorityFeePerGas:R,estimateSuggested:x,estimateUsed:N},defaultGasEstimates:D,originalType:F,replacedById:U,customTokenAmount:B,dappProposedTokenAmount:G,currentTokenBalance:$,originalApprovalAmount:L,finalApprovalAmount:q,securityProviderResponse:H,simulationFails:Y,id:W,userFeeLevel:V}=e,K=C===o.ORIGIN_METAMASK?"user":"dapp",z="dappSuggested"===V?"dapp_proposed":V,{assetType:J,tokenStandard:X}=await(0,h.determineTransactionAssetType)(e,t.provider,t.getTokenStandardAndDetails);let Z;if(e.txParams.data){const n=await t.getMethodData(e.txParams.data);Z=null==n?void 0:n.name}const Q={};if((0,h.isEIP1559Transaction)(e)?(Q.max_fee_per_gas=I,Q.max_priority_fee_per_gas=R):(Q.gas_price=M,Q.default_estimate=l.MetaMetricsEventTransactionEstimateType.DefaultEstimate),D){var ee,te;const{estimateType:n}=D;if(n){var ne,re;Q.default_estimate=n===c.PriorityLevels.dAppSuggested?l.MetaMetricsEventTransactionEstimateType.DappProposed:n;let r=null===(ne=e.defaultGasEstimates)||void 0===ne?void 0:ne.maxFeePerGas,a=null===(re=e.defaultGasEstimates)||void 0===re?void 0:re.maxPriorityFeePerGas;if([c.GasRecommendations.low,c.GasRecommendations.medium,c.GasRecommendations.high].includes(n)){var ae,ie;const{gasFeeEstimates:e}=await t.getEIP1559GasFeeEstimates();var se,oe;if(null!=e&&null!==(ae=e[n])&&void 0!==ae&&ae.suggestedMaxFeePerGas)r=null===(se=e[n])||void 0===se?void 0:se.suggestedMaxFeePerGas,Q.default_max_fee_per_gas=r;if(null!=e&&null!==(ie=e[n])&&void 0!==ie&&ie.suggestedMaxPriorityFeePerGas)a=null===(oe=e[n])||void 0===oe?void 0:oe.suggestedMaxPriorityFeePerGas,Q.default_max_priority_fee_per_gas=a}}null!==(ee=e.defaultGasEstimates)&&void 0!==ee&&ee.gas&&(Q.default_gas=e.defaultGasEstimates.gas),null!==(te=e.defaultGasEstimates)&&void 0!==te&&te.gasPrice&&(Q.default_gas_price=e.defaultGasEstimates.gasPrice)}x&&(Q.estimate_suggested=x),N&&(Q.estimate_used=N),null!=n&&n.gas_used&&(Q.gas_used=n.gas_used);const ce=function(e){const t={};for(const n in e)(0,a.isHexString)(e[n])?t[n]=(0,p.hexWEIToDecGWEI)(e[n]):t[n]=e[n];return t}(Q);let le="0";e.txParams.maxFeePerGas&&(le="2");const ue="Approve";let de,pe,me,he,fe,ge;const{transactionType:ye,isContractInteraction:ve}=function(e,t){const n=e&&_.includes(e);if([i.TransactionType.swapAndSend,i.TransactionType.cancel,i.TransactionType.deployContract,i.TransactionType.gasPayment,i.TransactionType.batch,i.TransactionType.shieldSubscriptionApprove].includes(e))return{transactionType:e,isContractInteraction:n};if(e===i.TransactionType.retry&&t)return{transactionType:t,isContractInteraction:n};if(n){const t=O(e);return t?{transactionType:t,isContractInteraction:!0}:{transactionType:i.TransactionType.contractInteraction,isContractInteraction:!0}}return{transactionType:i.TransactionType.simpleSend,isContractInteraction:!1}}(E,F);var we,be;ve&&(pe=Z,fe=null===(we=e.txParams)||void 0===we?void 0:we.to,ge=null===(be=e.txParams)||void 0===be||null===(be=be.data)||void 0===be?void 0:be.slice(0,10),pe===ue&&X===u.TokenStandard.ERC20&&("0"===G||"0"===B?de=u.TransactionApprovalAmountType.revoke:B&&B!==G?de=u.TransactionApprovalAmountType.custom:G&&(de=u.TransactionApprovalAmountType.dappProposed),me=function(e,t,n){if(e===u.TransactionApprovalAmountType.custom&&t&&n)return`${new r.BigNumber(t,10).div(n,10).times(100).round(2)}`;return null}(de,L,q),he=function(e,t,n){if((e===u.TransactionApprovalAmountType.custom||e===u.TransactionApprovalAmountType.dappProposed)&&t&&n)return`${new r.BigNumber(t,16).div(n,10).times(100).round(2)}`;return null}(de,G,$)));const Te=t.getTransaction(U),ke={RETRY:i.TransactionType.retry,CANCEL:i.TransactionType.cancel,SAME_NONCE:"other"};let _e;null!=n&&n.dropped&&(_e=ke.SAME_NONCE,(null==Te?void 0:Te.type)===i.TransactionType.cancel?_e=ke.CANCEL:(null==Te?void 0:Te.type)===i.TransactionType.retry&&(_e=ke.RETRY));const Ee=[];1===(null==H?void 0:H.flagAsDangerous)?Ee.push(l.MetaMetricsEventUiCustomization.FlaggedAsMalicious):2===(null==H?void 0:H.flagAsDangerous)&&Ee.push(l.MetaMetricsEventUiCustomization.FlaggedAsSafetyUnknown);const Pe=(0,f.getBlockaidMetricsProps)(e);(null==Pe||null===(k=Pe.ui_customizations)||void 0===k?void 0:k.length)>0&&Ee.push(...Pe.ui_customizations),Y&&Ee.push(l.MetaMetricsEventUiCustomization.GasEstimationFailed);const Se=t.getIsConfirmationAdvancedDetailsOpen(),Ae=(0,m.getSmartTransactionMetricsProperties)(t,e),Ce=(0,f.getSwapAndSendMetricsProps)(e),Oe={hd_entropy_index:t.getHDEntropyIndex()},Me=function(e,t){const n=t.getSecurityAlertsEnabled();if(!n)return{address_alert_response:"not_applicable"};const{to:r}=e.txParams;if("string"!=typeof r)return{address_alert_response:"not_applicable"};const{chainId:a}=e,i=(0,b.mapChainIdToSupportedEVMChain)(a);if(!i)return{address_alert_response:"not_applicable"};const s=(0,b.createCacheKey)(i,r),o=t.getAddressSecurityAlertResponse(s);if(o)return{address_alert_response:o.result_type};return{address_alert_response:b.ResultType.Loading}}(e,t);let je;try{je=await t.getAccountType(t.getSelectedAddress())}catch(e){je="error",T("Error getting account type for transaction metrics:",e)}let Ie={chain_id:A,referrer:C,source:K,status:S,network:`${parseInt(A,16)}`,eip_1559_version:le,gas_edit_type:"none",gas_edit_attempted:"none",gas_estimation_failed:Boolean(Y),account_type:je,device_model:await t.getDeviceModel(t.getSelectedAddress()),asset_type:J,token_standard:X,transaction_type:ye,transaction_speed_up:E===i.TransactionType.retry,transaction_internal_id:W,gas_fee_selected:z,...Pe,ui_customizations:Ee.length>0?Ee:null,transaction_advanced_view:Se,transaction_contract_method:pe?[pe]:[],...Ae,...Ce,...Oe,...Me};const Re=await(0,g.getSnapAndHardwareInfoForMetrics)(t.getAccountType,t.getDeviceModel,t.getHardwareTypeForMetric,t.snapAndHardwareMessenger);var xe,Ne;(Object.assign(Ie,Re),pe===ue||O(E))&&(Ie={...Ie,simulation_receiving_assets_total_value:Ie.simulation_receiving_assets_total_value??(null==e||null===(xe=e.assetsFiatValues)||void 0===xe?void 0:xe.receiving),simulation_sending_assets_total_value:Ie.simulation_sending_assets_total_value??(null==e||null===(Ne=e.assetsFiatValues)||void 0===Ne?void 0:Ne.sending),transaction_approval_amount_type:de});let De={transaction_envelope_type:(0,h.isEIP1559Transaction)(e)?d.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:d.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:P,gas_limit:j,transaction_replaced:_e,transaction_contract_address:fe?[fe]:[],transaction_contract_method_4byte:ge,...n,...ce};if(pe===ue&&(De={...De,transaction_approval_amount_vs_balance_ratio:he,transaction_approval_amount_vs_proposed_ratio:me}),await async function(e,t,n,r){const a=origin&&origin!==o.ORIGIN_METAMASK,{delegationAddress:s,nestedTransactions:c,txParams:l}=e,{authorizationList:d}=l,p=Boolean(null==c?void 0:c.length),m=Boolean(null==d?void 0:d.length);a&&(n.api_method=p?o.MESSAGE_TYPE.WALLET_SEND_CALLS:o.MESSAGE_TYPE.ETH_SEND_TRANSACTION);p&&(n.batch_transaction_count=null==c?void 0:c.length,n.batch_transaction_method="eip7702",n.transaction_contract_method=await async function(e,t){const n=e.filter(e=>_.includes(e.type)&&e.data).map(e=>e.data),r=await Promise.all(n.map(e=>t(e)));return r.map(e=>null==e?void 0:e.name).filter(e=>null==e?void 0:e.length)}(c??[],t),r.transaction_contract_address=null==c?void 0:c.filter(e=>{var t;return _.includes(e.type)&&(null===(t=e.to)||void 0===t?void 0:t.length)}).map(e=>e.to));if(e.status===i.TransactionStatus.rejected){const{error:t}=e;n.eip7702_upgrade_rejection=m&&t.code===u.EIP5792ErrorCode.RejectedUpgrade}n.eip7702_upgrade_transaction=m,r.account_eip7702_upgraded=s}(e,t.getMethodData,Ie,De),function(e,t,n,r){var a;const{gasFeeTokens:i,selectedGasFeeToken:o}=e;t.gas_payment_tokens_available=null==i?void 0:i.map(e=>e.symbol),t.gas_paid_with=null==i||null===(a=i.find(e=>e.tokenAddress.toLowerCase()===(null==o?void 0:o.toLowerCase())))||void 0===a?void 0:a.symbol,(null==o?void 0:o.toLowerCase())===u.NATIVE_TOKEN_ADDRESS&&(t.gas_paid_with="pre-funded_ETH");t.gas_insufficient_native_asset=function(e,t){const{chainId:n,txParams:r}=e,{from:a,gas:i,gasPrice:o,maxFeePerGas:c,value:l}=r,u=t(a,n),d=(0,y.getMaximumGasTotalInHexWei)({gasLimit:i,gasPrice:o,maxFeePerGas:c}),m=(0,s.add0x)((0,p.addHexes)(d,l??"0x0"));return new v.Numeric(m,16).greaterThan(new v.Numeric(u,16))}(e,r)}(e,Ie,0,t.getAccountBalance),function(e,t,n){var r;const a=null===(r=n.getFeatureFlags())||void 0===r?void 0:r.extensionUxPna25,s=n.getPna25Acknowledged(),o=n.getParticipateInMetrics(),c=[i.TransactionStatus.confirmed,i.TransactionStatus.dropped,i.TransactionStatus.failed].includes(e.status);a&&s&&o&&c&&(t.transaction_hash=e.hash)}(e,Ie,t),S===i.TransactionStatus.submitted||S===i.TransactionStatus.confirmed){const n=t.getNetworkRpcUrl(e.chainId),r=(0,w.extractRpcDomain)(n);Ie.rpc_domain=r}return{properties:Ie,sensitiveProperties:De}}function O(e){return e===i.TransactionType.swap?E.swap:e===i.TransactionType.bridge?E.bridge:null}n.handlePostTransactionBalanceUpdate=async({getParticipateInMetrics:e,trackEvent:t,getHDEntropyIndex:n},{transactionMeta:a,approvalTransactionMeta:i})=>{var s;if(e()&&a.swapMetaData)if("0x0"===(null===(s=a.txReceipt)||void 0===s?void 0:s.status))t({event:l.MetaMetricsEventName.SwapFailed,category:l.MetaMetricsEventCategory.Swaps,sensitiveProperties:{...a.swapMetaData},properties:{hd_entropy_index:n()}});else{var o;const e=(0,d.getSwapsTokensReceivedFromTxMeta)(a.destinationTokenSymbol,a,a.destinationTokenAddress,a.txParams.from,a.destinationTokenDecimals,i,a.chainId),s=e?`${new r.BigNumber(e,10).div(a.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,c=null!==(o=a.txReceipt)&&void 0!==o&&o.gasUsed&&a.swapMetaData.estimated_gas?`${new r.BigNumber(a.txReceipt.gasUsed,16).div(a.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,u=function(e,t){var n,a;let i="0x0";null!=t&&t.txReceipt&&(i=(0,d.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice));const s=(0,d.calcGasTotal)(null===(n=e.txReceipt)||void 0===n?void 0:n.gasUsed,null===(a=e.txReceipt)||void 0===a?void 0:a.effectiveGasPrice),o=new r.BigNumber(s,16).plus(i,16).toString(16);return{approvalGasCostInEth:Number((0,p.hexWEIToDecETH)(i)),tradeGasCostInEth:Number((0,p.hexWEIToDecETH)(s)),tradeAndApprovalGasCostInEth:Number((0,p.hexWEIToDecETH)(o))}}(a,i);t({event:l.MetaMetricsEventName.SwapCompleted,category:l.MetaMetricsEventCategory.Swaps,sensitiveProperties:{...a.swapMetaData,token_to_amount_received:e,quote_vs_executionRatio:s,estimated_vs_used_gasRatio:c,approval_gas_cost_in_eth:u.approvalGasCostInEth,trade_gas_cost_in_eth:u.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:u.tradeAndApprovalGasCostInEth,token_to_amount:a.swapMetaData.token_to_amount.toString(10)},properties:{hd_entropy_index:n()}})}}}}},{package:"$root$",file:"app/scripts/lib/transaction/metrics.ts"}],[364,{"../../../../shared/modules/conversion.utils":5913,"../../../../shared/modules/fetch-with-timeout":5920},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.buildUrl=u,n.getSendBundleSupportedChains=async function(e){const t=await c();return e.reduce((e,n)=>{const r=(0,a.hexToDecimal)(n),i=t[r];return e[n]=(null==i?void 0:i.sendBundle)??!1,e},{})},n.getSentinelNetworkFlags=l,n.isSendBundleSupported=async function(e){const t=await l(e);if(null==t||!t.sendBundle)return!1;return!0};var r,a=e("../../../../shared/modules/conversion.utils"),i=(r=e("../../../../shared/modules/fetch-with-timeout"))&&r.__esModule?r:{default:r};const s="https://tx-sentinel-{0}.api.cx.metamask.io/",o="networks";async function c(){const e=`${u("ethereum-mainnet")}${o}`;return(await(0,i.default)()(e)).json()}async function l(e){const t=(0,a.hexToDecimal)(e);return(await c())[t]}function u(e){return s.replace("{0}",e)}}}},{package:"$root$",file:"app/scripts/lib/transaction/sentinel-api.ts"}],[365,{"../../../../shared/modules/fetch-with-timeout":5920,"../../../../shared/modules/rpc.utils":5929,"./sentinel-api":364,"@metamask/utils":3116},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RelayStatus=n.RELAY_RPC_METHOD=void 0,n.isRelaySupported=async function(e){return Boolean(await d(e))},n.submitRelayTransaction=async function(e){const{chainId:t}=e,n=await d(t);if(!n)throw new Error(`Chain not supported by transaction relay - ${t}`);c("Request",n,e);const r=await(0,i.jsonRpcRequest)(n,u,[e]);return c("Response",r),r},n.waitForRelayResult=async function(e){const{chainId:t,interval:n,uuid:r}=e,a=await d(t);if(!a)throw new Error(`Chain not supported by transaction relay - ${t}`);const i=`${a}smart-transactions/${r}`;return new Promise((e,t)=>{const r=setInterval(async()=>{try{const t=await async function(e){c("Polling request",e);const t=await(0,s.default)()(e);if(c("Polling response",t),!t.ok){const e=await t.text();throw new Error(`Failed to fetch relay transaction status: ${t.status} - ${e}`)}const n=await t.json(),r=null==n?void 0:n.transactions[0],{hash:a,status:i}=r||{};return{status:i,transactionHash:a}}(i);t.status!==l.Pending&&(clearInterval(r),e(t))}catch(e){clearInterval(r),t(e)}},n)})};var r,a=e("@metamask/utils"),i=e("../../../../shared/modules/rpc.utils"),s=(r=e("../../../../shared/modules/fetch-with-timeout"))&&r.__esModule?r:{default:r},o=e("./sentinel-api");const c=(0,a.createProjectLogger)("transaction-relay");let l=n.RelayStatus=function(e){return e.Pending="PENDING",e.Success="VALIDATED",e}({});const u=n.RELAY_RPC_METHOD="eth_sendRelayTransaction";async function d(e){const t=await(0,o.getSentinelNetworkFlags)(e);return null!=t&&t.relayTransactions?(0,o.buildUrl)(t.network):(c("Chain is not supported",e),undefined)}}}},{package:"$root$",file:"app/scripts/lib/transaction/transaction-relay.ts"}],[366,{"../../../../shared/constants/app":5775,"../../../../shared/constants/security-provider":5803,"../../../../shared/lib/trace":5897,"../../../../shared/lib/trust-signals":5903,"../../../../shared/modules/transaction.utils":5947,"../ppom/ppom-util":308,"../trust-signals/security-alerts-api":367,"@metamask/keyring-api":2193,"@metamask/transaction-controller":2994,"ethereumjs-util":4342},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addDappTransaction=async function(e){const{dappRequest:t,requestContext:n}=e,{id:r,method:a}=t,i=String(r),s=n.assertGet("origin"),o=n.get("securityAlertResponse"),l=n.get("traceContext"),u={actionId:i,requestId:String(r),method:a,origin:s,requireApproval:!0,securityAlertResponse:o};(0,c.endTrace)({name:c.TraceName.Middleware,id:i});const{waitForHash:d}=await h({...e,transactionOptions:{...u,traceContext:l}}),p=await d();return(0,c.endTrace)({name:c.TraceName.Transaction,id:i}),p},n.addTransaction=async function(e){await async function(e){const{chainId:t,ppomController:n,securityAlertsEnabled:r,transactionOptions:a,transactionParams:i,updateSecurityAlertResponse:c,internalAccounts:h,getSecurityAlertsConfig:f}=e;!function(e){const{getSecurityAlertResponse:t,addSecurityAlertResponse:n,securityAlertsEnabled:r,transactionOptions:a,transactionParams:i,chainId:s}=e,{origin:o}=a;if(o!==l.ORIGIN_METAMASK||!r)return;const{to:c}=i;if("string"!=typeof c)return;const p=(0,d.mapChainIdToSupportedEVMChain)(s);if(!p)return;const m=e=>t(e),h=(e,t)=>n(e,t);(0,u.scanAddressAndAddToCache)(c,m,h,p).catch(e=>{console.error("[scanAddressForTrustSignals] error scanning address for trust signals:",e)})}(e);const{type:g}=a,{data:v,value:w,to:b}=i,T=o.SECURITY_PROVIDER_EXCLUDED_TRANSACTION_TYPES.includes(g);if(!r||T)return;const k="0x0"===w&&m.includes(g)&&v?(0,p.getTransactionDataRecipient)(v):undefined;if(y(h,b)||y(h,k))return;try{const{from:r}=i,{actionId:l,origin:u}=a,d={method:"eth_sendTransaction",id:l??"",origin:u??"",params:[{from:r,to:b??"",value:w??"",data:v??""}],jsonrpc:"2.0"},p=(0,s.generateSecurityAlertId)();(0,s.validateRequestWithPPOM)({ppomController:n,request:d,securityAlertId:p,chainId:t,updateSecurityAlertResponse:c,getSecurityAlertsConfig:f});const m={...o.LOADING_SECURITY_ALERT_RESPONSE,securityAlertId:p};e.transactionOptions.securityAlertResponse=m}catch(e){(0,s.handlePPOMError)(e,"Error validating JSON RPC using PPOM: ")}}(e);const{transactionMeta:t,waitForHash:n}=await h(e);if(!e.waitForSubmit)return n().catch(()=>{}),t;const r=await n();return function(e,t){return t.state.transactions.find(t=>t.hash===e)}(r,e.transactionController)},n.getTransactionById=f,n.stripSingleLeadingZero=function(e){if(!e.startsWith("0x0")||e.length<=3)return e;return`0x${e.slice(3)}`};var r=e("@metamask/keyring-api"),a=e("@metamask/transaction-controller"),i=e("ethereumjs-util"),s=e("../ppom/ppom-util"),o=e("../../../../shared/constants/security-provider"),c=e("../../../../shared/lib/trace"),l=e("../../../../shared/constants/app"),u=e("../trust-signals/security-alerts-api"),d=e("../../../../shared/lib/trust-signals"),p=e("../../../../shared/modules/transaction.utils");const m=[a.TransactionType.tokenMethodTransfer,a.TransactionType.tokenMethodTransferFrom,a.TransactionType.tokenMethodSafeTransferFrom];async function h(e){const{selectedAccount:t}=e;return t.type===r.EthAccountType.Erc4337?async function(e){var t;const{networkClientId:n,transactionController:r,transactionOptions:a,transactionParams:s,userOperationController:o}=e,{maxFeePerGas:c,maxPriorityFeePerGas:l}=s,{origin:u,requireApproval:d,type:p}=a,m={...s,maxFeePerGas:(0,i.addHexPrefix)(c),maxPriorityFeePerGas:(0,i.addHexPrefix)(l)},h=null==a||null===(t=a.swaps)||void 0===t?void 0:t.meta;null!=h&&h.type&&delete h.type;const g={networkClientId:n,origin:u,requireApproval:d,swaps:h,type:p},y=await o.addUserOperationFromTransaction(m,g);o.startPollingByNetworkClientId(n);return{transactionMeta:f(y.id,r),waitForHash:y.transactionHash}}(e):async function(e){const{transactionController:t,transactionOptions:n,transactionParams:r,networkClientId:a}=e,{result:i,transactionMeta:s}=await t.addTransaction(r,{...n,networkClientId:a});return{transactionMeta:s,waitForHash:()=>i}}(e)}function f(e,t){return t.state.transactions.find(t=>t.id===e)}function g(e){return null==e?void 0:e.toLowerCase()}function y(e,t){const n=g(t);if(!n)return!1;return new Set(e.map(e=>g(e.address))).has(n)}}}},{package:"$root$",file:"app/scripts/lib/transaction/util.ts"}],[367,{"../../../../shared/constants/time":5812,"../../../../shared/lib/trust-signals":5903,"../../../../shared/modules/fetch-with-timeout":5920},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.scanAddress=l,n.scanAddressAndAddToCache=async function(e,t,n,r){const a=(0,s.createCacheKey)(r,e),i=t(a);if(i)return i;const o={result_type:s.ResultType.Loading,label:""};n(a,o);try{const t=await l(r,e);return n(a,t),t}catch(e){throw n(a,{result_type:s.ResultType.ErrorResult,label:""}),e}};var r,a=e("../../../../shared/constants/time"),i=(r=e("../../../../shared/modules/fetch-with-timeout"))&&r.__esModule?r:{default:r},s=e("../../../../shared/lib/trust-signals");const o=5*a.SECOND,c="address/evm/scan";async function l(e,t){const n="https://security-alerts.api.cx.metamask.io";const r=`${n}/${c}`,a={chain:e,address:t},s=await(0,i.default)(o)(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return await s.json()}}}},{package:"$root$",file:"app/scripts/lib/trust-signals/security-alerts-api.ts"}],[368,{"../../../../shared/constants/signatures":5804,"../../../../shared/lib/trust-signals":5903,"../../../../shared/modules/transaction.utils":5947,"../ppom/security-alerts-api":310,"../transaction/delegation":360,"./security-alerts-api":367,"./trust-signals-util":369},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createTrustSignalsMiddleware=function(e,t,n,d,p){return async(m,h,f)=>{try{if(!(0,l.isSecurityAlertsEnabledByUser)(d)||!(0,s.isSecurityAlertsAPIEnabled)())return;(0,l.isEthSendTransaction)(m)?(!function(e,t,n){if(!(0,l.hasValidTransactionParams)(e))return;const{to:a,data:i}=e.params[0],{chainId:s}=n.getNetworkConfigurationByNetworkClientId(e.networkClientId)??{};if(!s)return void console.error("ChainID not found for networkClientId");const u=(0,o.mapChainIdToSupportedEVMChain)(s);if(!u)return void console.error("Unsupported chainId:",s);if((0,c.scanAddressAndAddToCache)(a,t.getAddressSecurityAlertResponse,t.addAddressSecurityAlertResponse,u).catch(e=>{console.error("[createTrustSignalsMiddleware] error scanning address for transaction:",e)}),i&&"string"==typeof i){const e=(0,r.parseApprovalTransactionData)(i),n=null==e?void 0:e.spender;n&&(0,c.scanAddressAndAddToCache)(n,t.getAddressSecurityAlertResponse,t.addAddressSecurityAlertResponse,u).catch(e=>{console.error("[createTrustSignalsMiddleware] error scanning spender address for approval:",e)})}}(m,t,e),u(m,n)):(0,l.isEthSignTypedData)(m)?(!function(e,t,n){var s;if(!(0,l.hasValidTypedDataParams)(e))return;const u=(0,r.parseTypedDataMessage)("string"==typeof e.params[1]?e.params[1]:JSON.stringify(e.params[1])),d=null===(s=u.domain)||void 0===s?void 0:s.verifyingContract;if(!d)return;const{chainId:p}=n.getNetworkConfigurationByNetworkClientId(e.networkClientId)??{};if(!p)return void console.error("ChainID not found for networkClientId");const m=(0,o.mapChainIdToSupportedEVMChain)(p);if(!m)return void console.error("Unsupported chainId:",p);(0,c.scanAddressAndAddToCache)(d,t.getAddressSecurityAlertResponse,t.addAddressSecurityAlertResponse,m).catch(e=>{console.error("[createTrustSignalsMiddleware] error scanning address for signature:",e)});const{primaryType:h}=u;if(!h)return;if(a.PRIMARY_TYPES_PERMIT.includes(h)){var f;const e=null===(f=u.message)||void 0===f?void 0:f.spender;e&&(0,c.scanAddressAndAddToCache)(e,t.getAddressSecurityAlertResponse,t.addAddressSecurityAlertResponse,m).catch(e=>{console.error("[createTrustSignalsMiddleware] error scanning spender address for permit:",e)})}if(h===i.PRIMARY_TYPE_DELEGATION){var g;const e=null===(g=u.message)||void 0===g?void 0:g.delegate;e&&(0,c.scanAddressAndAddToCache)(e,t.getAddressSecurityAlertResponse,t.addAddressSecurityAlertResponse,m).catch(e=>{console.error("[createTrustSignalsMiddleware] error scanning delegate address for delegation:",e)})}}(m,t,e),u(m,n)):((0,l.isConnected)(m,p)||(0,l.connectScreenHasBeenPrompted)(m))&&u(m,n)}catch(e){console.error("[createTrustSignalsMiddleware] error: ",e)}finally{f()}}};var r=e("../../../../shared/modules/transaction.utils"),a=e("../../../../shared/constants/signatures"),i=e("../transaction/delegation"),s=e("../ppom/security-alerts-api"),o=e("../../../../shared/lib/trust-signals"),c=e("./security-alerts-api"),l=e("./trust-signals-util");function u(e,t){e.origin&&t.scanUrl(e.origin).catch(e=>{console.error("[createTrustSignalsMiddleware] error:",e)})}}}},{package:"$root$",file:"app/scripts/lib/trust-signals/trust-signals-middleware.ts"}],[369,{"../../../../shared/constants/app":5775,"../../../../shared/lib/trust-signals":5903,"../../../../shared/modules/selectors/networks":5934},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.connectScreenHasBeenPrompted=function(e){return e.method===a.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS||e.method===a.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS},n.getChainId=function(e){var t;const n=null===(t=(0,r.getProviderConfig)({metamask:e.state}))||void 0===t?void 0:t.chainId;if(!n)throw new Error("Chain ID not found");return(0,i.mapChainIdToSupportedEVMChain)(n)},n.hasValidTransactionParams=function(e){if(!("params"in e)||!e.params)return!1;if(!Array.isArray(e.params)||0===e.params.length)return!1;const t=e.params[0];return"object"==typeof t&&null!==t&&"to"in t},n.hasValidTypedDataParams=function(e){if(!("params"in e)||!e.params)return!1;if(!Array.isArray(e.params)||e.params.length<2)return!1;return e.params[1]!==undefined&&null!==e.params[1]},n.isConnected=function(e,t){if(!e.origin||e.method!==a.MESSAGE_TYPE.ETH_ACCOUNTS)return!1;const n=t(e.origin);return Array.isArray(n)&&n.length>0},n.isEthSendTransaction=function(e){return e.method===a.MESSAGE_TYPE.ETH_SEND_TRANSACTION},n.isEthSignTypedData=function(e){return e.method===a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA||e.method===a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V1||e.method===a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3||e.method===a.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4},n.isSecurityAlertsEnabledByUser=function(e){const{securityAlertsEnabled:t}=e.state;return t};var r=e("../../../../shared/modules/selectors/networks"),a=e("../../../../shared/constants/app"),i=e("../../../../shared/lib/trust-signals")}}},{package:"$root$",file:"app/scripts/lib/trust-signals/trust-signals-util.ts"}],[37,{"../../../../shared/constants/app":5775,"@metamask/approval-controller":1257,"@metamask/controller-utils":1449},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ApprovalControllerInit=void 0;var r=e("@metamask/approval-controller"),a=e("@metamask/controller-utils"),i=e("../../../../shared/constants/app");n.ApprovalControllerInit=({controllerMessenger:e,showUserConfirmation:t})=>({persistedStateKey:null,memStateKey:null,controller:new r.ApprovalController({messenger:e,showApprovalRequest:t,typesExcludedFromRateLimiting:[a.ApprovalType.PersonalSign,a.ApprovalType.EthSignTypedData,a.ApprovalType.Transaction,a.ApprovalType.WatchAsset,a.ApprovalType.EthGetEncryptionPublicKey,a.ApprovalType.EthDecrypt,i.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage]})})}}},{package:"$root$",file:"app/scripts/controller-init/confirmations/approval-controller-init.ts"}],[370,{loglevel:4846},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.updateRemoteFeatureFlags=async function(e){try{const t=e.remoteFeatureFlagController;await t.updateRemoteFeatureFlags()}catch(e){a.default.error("Error initializing remote feature flags:",e)}};var r,a=(r=e("loglevel"))&&r.__esModule?r:{default:r}}}},{package:"$root$",file:"app/scripts/lib/update-remote-feature-flags.ts"}],[371,{"../../../shared/modules/environment":5917,"@metamask/utils":3116,"webextension-polyfill":5763},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.useSplitStateStorage=async function(e){var t;if((0,s.getIsSettingsPageDevOptionsEnabled)()){const t=await async function(){const{splitStateMigrationEnabled:e,splitStateMigrationMaxAccounts:t,splitStateMigrationMaxNetworks:n}=await a.default.storage.local.get(["splitStateMigrationEnabled","splitStateMigrationMaxAccounts","splitStateMigrationMaxNetworks"]);return{enabled:e===undefined?null:"1"===e,maxAccounts:t===undefined?0:Number(t),maxNetworks:n===undefined?0:Number(n)}}();if(null!==t.enabled){if(!1===t.enabled)return!1;const{accountCount:n,networkCount:r}=o(e);return n<=t.maxAccounts&&r<=t.maxNetworks}}const n=e.RemoteFeatureFlagController,r=null==n||null===(t=n.remoteFeatureFlags)||void 0===t?void 0:t.platformSplitStateGradualRollout;if(!function(e){return(0,i.isObject)(e)&&(0,i.hasProperty)(e,"value")&&(0,i.isObject)(e.value)&&(0,i.hasProperty)(e.value,"enabled")&&"number"==typeof e.value.enabled&&(0,i.hasProperty)(e.value,"maxAccounts")&&"number"==typeof e.value.maxAccounts&&(0,i.hasProperty)(e.value,"maxNetworks")&&"number"==typeof e.value.maxNetworks}(r)||r.value.enabled<=0)return!1;const{accountCount:c,networkCount:l}=o(e);return c<=r.value.maxAccounts&&l<=r.value.maxNetworks};var r,a=(r=e("webextension-polyfill"))&&r.__esModule?r:{default:r},i=e("@metamask/utils"),s=e("../../../shared/modules/environment");function o(e){var t;const n=e.AccountsController,r=Object.keys((null==n||null===(t=n.internalAccounts)||void 0===t?void 0:t.accounts)??{}).length,a=e.NetworkController;return{accountCount:r,networkCount:Object.keys((null==a?void 0:a.networkConfigurationsByChainId)??{}).length}}}}},{package:"$root$",file:"app/scripts/lib/use-split-state-storage.ts"}]],[],{});