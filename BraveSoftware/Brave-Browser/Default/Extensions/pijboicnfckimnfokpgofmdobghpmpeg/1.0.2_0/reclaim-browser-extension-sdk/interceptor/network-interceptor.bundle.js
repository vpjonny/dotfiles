(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach(function(t){n(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function n(e,t,r){return(t=d(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],u=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function i(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var u=n&&n.prototype instanceof s?n:s,l=Object.create(u.prototype);return c(l,"_invoke",function(r,n,o){var a,s,u,c=0,l=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,r){return a=t,s=0,u=e,f.n=r,i}};function d(r,n){for(s=r,u=n,t=0;!p&&c&&!o&&t<l.length;t++){var o,a=l[t],d=f.p,y=a[2];r>3?(o=y===n)&&(u=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=r<2&&d<a[1])?(s=0,f.v=n,f.n=a[1]):d<y&&(o=r<3||a[0]>n||n>y)&&(a[4]=r,a[5]=n,f.n=y,s=0))}if(o||r>1)return i;throw p=!0,n}return function(o,l,y){if(c>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,y),s=l,u=y;(t=s<2?e:u)||!p;){a||(s?s<3?(s>1&&(f.n=-1),d(s,u)):f.n=u:f.v=u);try{if(c=2,a){if(s||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((t=(p=f.n<0)?u:r.call(n,f))!==i)break}catch(t){a=e,s=1,u=t}finally{c=1}}return{value:t,done:p}}}(r,o,a),!0),l}var i={};function s(){}function l(){}function p(){}t=Object.getPrototypeOf;var f=[][n]?t(t([][n]())):(c(t={},n,function(){return this}),t),d=p.prototype=s.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=p,c(d,"constructor",p),c(p,"constructor",l),l.displayName="GeneratorFunction",c(p,o,"GeneratorFunction"),c(d),c(d,o,"Generator"),c(d,n,function(){return this}),c(d,"toString",function(){return"[object Generator]"}),(u=function(){return{w:a,m:y}})()}function c(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}c=function(e,t,r,n){function a(t,r){c(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},c(e,t,r,n)}function l(e,t,r,n,o,a,i){try{var s=e[a](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function p(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){l(a,n,o,i,s,"next",e)}function s(e){l(a,n,o,i,s,"throw",e)}i(void 0)})}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}var y,h,b;y=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).error.apply(e,["❌ [Error]:"].concat(r))},h=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).info.apply(e,["ℹ️ [Info]:"].concat(r))},(b=new(function(){return t=function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.requestMiddlewares=[],this.responseMiddlewares=[],this.originalFetch=null===(t=window.fetch)||void 0===t?void 0:t.bind(window),this.originalXHR=window.XMLHttpRequest,"undefined"!=typeof window&&this.originalFetch&&this.originalXHR?(this.setupInterceptor(),h("RequestInterceptor initialized")):y("Not in a browser environment or required APIs not available")},n=[{key:"processRequestMiddlewares",value:(d=p(u().m(function e(t){var r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Promise.all(this.requestMiddlewares.map(function(e){return e(t)}));case 1:e.n=3;break;case 2:e.p=2,r=e.v,y("Error in request middleware:",r);case 3:return e.a(2)}},e,this,[[0,2]])})),function(e){return d.apply(this,arguments)})},{key:"processResponseMiddlewares",value:(l=p(u().m(function e(t,r){var n,o,i,s,c,l;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.parseResponse(t);case 1:n=e.v,o=a(this.responseMiddlewares),e.p=2,o.s();case 3:if((i=o.n()).done){e.n=8;break}return s=i.value,e.p=4,e.n=5,s(n,r);case 5:e.n=7;break;case 6:e.p=6,c=e.v,y("Error in response middleware:",c);case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,l=e.v,o.e(l);case 10:return e.p=10,o.f(),e.f(10);case 11:return e.a(2)}},e,this,[[4,6],[2,9,10,11]])})),function(e,t){return l.apply(this,arguments)})},{key:"parseResponse2",value:(c=p(u().m(function e(t){var r,n,o,a,i,s,c,l,p;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=t.headers.get("content-type")||"",null==t||null===(r=t.url)||void 0===r||!r.includes("operationName=getProfileOracle")){e.n=4;break}return a=t.clone(),i=a.headers.get("content-type")||"",console.log("contentType",i),console.log("copyresponse",a),e.p=1,e.n=2,a.json();case 2:s=e.v,console.log("responseBody",s),e.n=4;break;case 3:e.p=3,l=e.v,console.log("json read error",l);case 4:if(e.p=4,!t.bodyUsed){e.n=5;break}n="[Response body already consumed]",e.n=12;break;case 5:if(!o.includes("text/")&&!o.includes("application/json")){e.n=10;break}return e.p=6,e.n=7,t.text();case 7:n=e.v,e.n=9;break;case 8:e.p=8,e.v,n="[Invalid response format]";case 9:e.n=12;break;case 10:return e.n=11,t.text();case 11:c=e.v,n=""===c?"[Binary Data]":c;case 12:e.n=14;break;case 13:e.p=13,p=e.v,y("Error parsing response:",p),n="[Error reading response: ".concat(p.message,"]");case 14:return e.a(2,{id:t.id||null,url:t.url,status:t.status,statusText:t.statusText,headers:Object.fromEntries(t.headers.entries()),body:n,originalResponse:t,timestamp:Date.now()})}},e,null,[[6,8],[4,13],[1,3]])})),function(e){return c.apply(this,arguments)})},{key:"parseResponse",value:(s=p(u().m(function e(t){var r,n,o,a,i;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t.url||"",o=Object.fromEntries(t.headers.entries()),e.p=1,e.n=2,t.text();case 2:a=e.v,r=a,e.n=4;break;case 3:e.p=3,i=e.v,r="[Error reading response: ".concat((null==i?void 0:i.name)||i,"]");case 4:return e.a(2,{id:t.id||null,url:n,status:t.status,statusText:t.statusText,headers:o,body:r,originalResponse:t,timestamp:Date.now()})}},e,null,[[1,3]])})),function(e){return s.apply(this,arguments)})},{key:"setupInterceptor",value:function(){var t,n=this.originalFetch,a=this;window.fetch=new Proxy(n,{apply:(t=p(u().m(function e(t,n,i){var s,c,l,p,f,d,h,b,v,w,m,g,R,j,E,O;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=o(i,2),c=s[0],l=s[1],p=void 0===l?{}:l,c){e.n=1;break}return e.a(2,Reflect.apply(t,n,i));case 1:return f={url:c,options:r(r({},p),{},{method:p.method||"GET",headers:p.headers||{}})},Object.defineProperty(f,"_rc",{value:!0,enumerable:!1,configurable:!1,writable:!1}),e.p=2,e.n=3,Promise.all(a.requestMiddlewares.map(function(e){return e(f)}));case 3:e.n=5;break;case 4:e.p=4,O=e.v,y("Error in request middleware:",O);case 5:return e.n=6,Reflect.apply(t,n,[f.url,f.options]);case 6:if(d=e.v,h=d.status,b=d.statusText,v=new Headers(d.headers),d.body){e.n=7;break}return a.processResponseMiddlewares(d.clone(),f).catch(y),e.a(2,d);case 7:return w=d.body.tee(),m=o(w,2),g=m[0],R=m[1],j=new Response(g,{status:h,statusText:b,headers:v}),E=new Response(R,{status:h,statusText:b,headers:v}),a.processResponseMiddlewares(E,f).catch(y),e.a(2,j)}},e,null,[[2,4]])})),function(e,r,n){return t.apply(this,arguments)})});var i=XMLHttpRequest.prototype.open,s=XMLHttpRequest.prototype.send,c=XMLHttpRequest.prototype.setRequestHeader,l=new WeakMap;XMLHttpRequest.prototype.open=function(){Object.defineProperty(this,"_rc",{value:!0,enumerable:!1,configurable:!1,writable:!1});for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=void 0===n?"GET":n,a=t[1],s={url:void 0===a?"":a,options:{method:o,headers:{},body:null}};return l.set(this,s),i.apply(this,t)},XMLHttpRequest.prototype.setRequestHeader=function(e,t){var r=l.get(this);return r&&e&&t&&(r.options.headers[e]=t),c.apply(this,arguments)},XMLHttpRequest.prototype.send=function(t){var r=this,n=l.get(this);if(n){n.options.body=t;var o=function(){var e=p(u().m(function e(){var t;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Promise.all(a.requestMiddlewares.map(function(e){return e(n)}));case 1:e.n=3;break;case 2:e.p=2,t=e.v,y("Error in request middleware:",t);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),i=this.onreadystatechange;this.onreadystatechange=function(t){if("function"==typeof i&&i.apply(this,arguments),4===this.readyState){var r=this.status||500,o=this.statusText||"Request Failed";try{var s=new Response(function(t){if(null==t)return"";switch(e(t)){case"string":return t;case"object":if(t instanceof Blob||t instanceof ArrayBuffer)return"[Binary Data]";if(t instanceof Document)return t.documentElement.outerHTML;try{return JSON.stringify(t)}catch(e){return y("Failed to stringify object response:",e),String(t)}default:return String(t)}}(this.response),{status:r,statusText:o,headers:new Headers(Object.fromEntries((this.getAllResponseHeaders()||"").split("\r\n").filter(Boolean).map(function(e){return e.split(": ")})))});Object.defineProperty(s,"url",{value:n.url,writable:!1}),a.processResponseMiddlewares(s,n).catch(function(e){return y("Error in response middleware:",e)})}catch(e){console.log("error",e),y("Error processing XHR response:",e)}}},o().then(function(){s.call(r,n.options.body)})}else s.apply(this,arguments)},this.resetXHRInterceptor=function(){XMLHttpRequest.prototype.open=i,XMLHttpRequest.prototype.send=s,XMLHttpRequest.prototype.setRequestHeader=c}}},{key:"addRequestMiddleware",value:function(e){"function"==typeof e&&this.requestMiddlewares.push(e)}},{key:"addResponseMiddleware",value:function(e){"function"==typeof e&&this.responseMiddlewares.push(e)}}],n&&f(t.prototype,n),i&&f(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,i,s,c,l,d}())).addResponseMiddleware(function(){var t=p(u().m(function t(r,n){var o,a,i,s,c;return u().w(function(t){for(;;)switch(t.n){case 0:try{o=function(t){var r={};try{t&&(t instanceof Headers?r=Object.fromEntries(t.entries()):"object"===e(t)&&Object.keys(t).forEach(function(e){var n=t[e];"string"!=typeof n&&"number"!=typeof n||(r[e]=String(n))}))}catch(e){y("Error extracting headers:",e)}return r},a=function(t){var r=null;try{t&&("string"==typeof t?r=t:"object"===e(t)&&(r=JSON.stringify(t)))}catch(e){y("Error extracting body:",e)}return r},i=function(t){var r="";try{"string"==typeof t?r=t.startsWith("http")?t:new URL(t,window.location.origin).href:t&&"object"===e(t)&&t.url?r=t.url:t&&"object"===e(t)&&t.href?r=t.href:(r=String(t)).startsWith("http")||(r=new URL(r,window.location.origin).href)}catch(e){y("Error extracting URL:",e),r=window.location.href}return r},s=i(n.url),c={request:{url:s,method:"string"==typeof n.options.method?n.options.method:"GET",headers:o(n.options.headers),body:a(n.options.body)},response:{url:s,status:r.status,headers:o(r.headers),body:a(r.body)},timestamp:Date.now()},window.postMessage({action:"INTERCEPTED_REQUEST_AND_RESPONSE",data:c},"*")}catch(e){y("Error processing request/response:",e),window.postMessage({action:"INTERCEPTED_REQUEST_AND_RESPONSE",data:{url:window.location.href,request:{method:"GET",headers:{},body:null},response:{status:r.status||0,headers:{},body:null},timestamp:Date.now(),error:e.message}},"*")}case 1:return t.a(2)}},t)}));return function(e,r){return t.apply(this,arguments)}}()),window.reclaimInterceptor=b,h("Userscript initialized and ready - Access via window.reclaimInterceptor")})();
//# sourceMappingURL=network-interceptor.bundle.js.map