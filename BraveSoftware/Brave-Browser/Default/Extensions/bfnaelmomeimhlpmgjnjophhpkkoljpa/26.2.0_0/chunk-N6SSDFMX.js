import{Ha as Pi,I as vr,J as Ai,K as pt,Ka as Ui,L as Bi,Tb as Di,Ub as Ni,Va as Po,Z as Ti,_ as Li,ea as Oi,j as Qn,lb as Ri,o as wn,u as Lo}from"./chunk-W7IWPUIQ.js";import{$c as _r,$d as _i,Aa as So,B as mn,Ba as Ao,Ca as Bo,Da as Co,Dc as mi,E as gn,Ec as gi,Fa as Yn,Fd as bi,Gd as wi,H as dt,Ha as Io,I as Ge,Ka as xr,L as We,Ma as To,Nb as Er,Pb as yi,Yd as xi,Zd as Ei,dc as He,ee as vi,fd as he,gf as Oo,hd as Ke,qd as le,ra as Lt,sd as ae,ua as at,v as Tt,vd as oe,wa as bn,wd as me,xf as Ii,ya as _o,za as vo,ze as Ci}from"./chunk-DJGGVTSJ.js";import{F as it,d as Zl}from"./chunk-FATTDLFQ.js";import{b as tt}from"./chunk-2RWUL32J.js";import{D as wr,Ja as Ot,K as hi,Sb as Yl,U as xn,Z as Si,a as yn,j as V,s as pi,t as br,w as Eo}from"./chunk-LQZGQEJ6.js";import{a as s,d as re,e as $l,g as st,i as g,j as T,m as Buffer,n as b}from"./chunk-WKJYWAXG.js";var Mo=re((Ea,Tr)=>{g();b();(function(e,t){"use strict";typeof define=="function"&&define.amd?define(t):typeof Tr=="object"&&Tr.exports?Tr.exports=t():e.log=t()})(Ea,function(){"use strict";var e=s(function(){},"noop"),t="undefined",n=typeof self!==t&&typeof self.navigator!==t&&/Trident\/|MSIE /.test(self.navigator.userAgent),r=["trace","debug","info","warn","error"],o={},i=null;function a(h,w){var m=h[w];if(typeof m.bind=="function")return m.bind(h);try{return Function.prototype.bind.call(m,h)}catch{return function(){return Function.prototype.apply.apply(m,[h,arguments])}}}s(a,"bindMethod");function u(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}s(u,"traceForIE");function c(h){return h==="debug"&&(h="log"),typeof console===t?!1:h==="trace"&&n?u:console[h]!==void 0?a(console,h):console.log!==void 0?a(console,"log"):e}s(c,"realMethod");function l(){for(var h=this.getLevel(),w=0;w<r.length;w++){var m=r[w];this[m]=w<h?e:this.methodFactory(m,h,this.name)}if(this.log=this.debug,typeof console===t&&h<this.levels.SILENT)return"No console available for logging"}s(l,"replaceLoggingMethods");function f(h){return function(){typeof console!==t&&(l.call(this),this[h].apply(this,arguments))}}s(f,"enableLoggingWhenConsoleArrives");function p(h,w,m){return c(h)||f.apply(this,arguments)}s(p,"defaultMethodFactory");function d(h,w){var m=this,x,E,S,C="loglevel";typeof h=="string"?C+=":"+h:typeof h=="symbol"&&(C=void 0);function H(O){var R=(r[O]||"silent").toUpperCase();if(!(typeof m===t||!C)){try{m.localStorage[C]=R;return}catch{}try{m.document.cookie=encodeURIComponent(C)+"="+R+";"}catch{}}}s(H,"persistLevelIfPossible");function q(){var O;if(!(typeof m===t||!C)){try{O=m.localStorage[C]}catch{}if(typeof O===t)try{var R=m.document.cookie,D=encodeURIComponent(C),_=R.indexOf(D+"=");_!==-1&&(O=/^([^;]+)/.exec(R.slice(_+D.length+1))[1])}catch{}return m.levels[O]===void 0&&(O=void 0),O}}s(q,"getPersistedLevel");function G(){if(!(typeof m===t||!C)){try{m.localStorage.removeItem(C)}catch{}try{m.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}s(G,"clearPersistedLevel");function k(O){var R=O;if(typeof R=="string"&&m.levels[R.toUpperCase()]!==void 0&&(R=m.levels[R.toUpperCase()]),typeof R=="number"&&R>=0&&R<=m.levels.SILENT)return R;throw new TypeError("log.setLevel() called with invalid level: "+O)}s(k,"normalizeLevel"),m.name=h,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=w||p,m.getLevel=function(){return S??E??x},m.setLevel=function(O,R){return S=k(O),R!==!1&&H(S),l.call(m)},m.setDefaultLevel=function(O){E=k(O),q()||m.setLevel(O,!1)},m.resetLevel=function(){S=null,G(),l.call(m)},m.enableAll=function(O){m.setLevel(m.levels.TRACE,O)},m.disableAll=function(O){m.setLevel(m.levels.SILENT,O)},m.rebuild=function(){if(i!==m&&(x=k(i.getLevel())),l.call(m),i===m)for(var O in o)o[O].rebuild()},x=k(i?i.getLevel():"WARN");var B=q();B!=null&&(S=k(B)),l.call(m)}s(d,"Logger"),i=new d,i.getLogger=s(function(w){if(typeof w!="symbol"&&typeof w!="string"||w==="")throw new TypeError("You must supply a name when creating a logger.");var m=o[w];return m||(m=o[w]=new d(w,i.methodFactory)),m},"getLogger");var y=typeof self!==t?self.log:void 0;return i.noConflict=function(){return typeof self!==t&&self.log===i&&(self.log=y),i},i.getLoggers=s(function(){return o},"getLoggers"),i.default=i,i})});var Je=re(te=>{"use strict";g();b();Object.defineProperty(te,"__esModule",{value:!0});te.wrapCipher=te.Hash=te.nextTick=te.isLE=void 0;te.isBytes=es;te.abool=ja;te.anumber=Qo;te.abytes=ct;te.ahash=Ld;te.aexists=Od;te.aoutput=Pd;te.u8=Ud;te.u32=Rd;te.clean=Dd;te.createView=za;te.bytesToHex=Wa;te.hexToBytes=$a;te.hexToNumber=Za;te.bytesToNumberBE=Md;te.numberToBytesBE=Hd;te.utf8ToBytes=Ya;te.bytesToUtf8=qd;te.toBytes=kd;te.overlapBytes=Qa;te.complexOverlapBytes=Vd;te.concatBytes=Fd;te.checkOpts=jd;te.equalBytes=zd;te.getOutput=Wd;te.setBigUint64=Jo;te.u64Lengths=$d;te.isAligned32=Xa;te.copyBytes=Ja;function es(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}s(es,"isBytes");function ja(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}s(ja,"abool");function Qo(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}s(Qo,"anumber");function ct(e,...t){if(!es(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}s(ct,"abytes");function Ld(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Qo(e.outputLen),Qo(e.blockLen)}s(Ld,"ahash");function Od(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}s(Od,"aexists");function Pd(e,t){ct(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}s(Pd,"aoutput");function Ud(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}s(Ud,"u8");function Rd(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}s(Rd,"u32");function Dd(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}s(Dd,"clean");function za(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}s(za,"createView");te.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var Ga=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Nd=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Wa(e){if(ct(e),Ga)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=Nd[e[n]];return t}s(Wa,"bytesToHex");var Rt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Fa(e){if(e>=Rt._0&&e<=Rt._9)return e-Rt._0;if(e>=Rt.A&&e<=Rt.F)return e-(Rt.A-10);if(e>=Rt.a&&e<=Rt.f)return e-(Rt.a-10)}s(Fa,"asciiToBase16");function $a(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Ga)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,i=0;o<n;o++,i+=2){let a=Fa(e.charCodeAt(i)),u=Fa(e.charCodeAt(i+1));if(a===void 0||u===void 0){let c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[o]=a*16+u}return r}s($a,"hexToBytes");function Za(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":"0x"+e)}s(Za,"hexToNumber");function Md(e){return Za(Wa(e))}s(Md,"bytesToNumberBE");function Hd(e,t){return $a(e.toString(16).padStart(t*2,"0"))}s(Hd,"numberToBytesBE");var Kd=s(async()=>{},"nextTick");te.nextTick=Kd;function Ya(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}s(Ya,"utf8ToBytes");function qd(e){return new TextDecoder().decode(e)}s(qd,"bytesToUtf8");function kd(e){if(typeof e=="string")e=Ya(e);else if(es(e))e=Ja(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}s(kd,"toBytes");function Qa(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}s(Qa,"overlapBytes");function Vd(e,t){if(Qa(e,t)&&e.byteOffset<t.byteOffset)throw new Error("complex overlap of input and output is not supported")}s(Vd,"complexOverlapBytes");function Fd(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];ct(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let i=e[r];n.set(i,o),o+=i.length}return n}s(Fd,"concatBytes");function jd(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}s(jd,"checkOpts");function zd(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}s(zd,"equalBytes");var Xo=class{static{s(this,"Hash")}};te.Hash=Xo;var Gd=s((e,t)=>{function n(r,...o){if(ct(r),!te.isLE)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let f=o[0];if(!f)throw new Error("nonce / iv required");e.varSizeNonce?ct(f):ct(f,e.nonceLength)}let i=e.tagLength;i&&o[1]!==void 0&&ct(o[1]);let a=t(r,...o),u=s((f,p)=>{if(p!==void 0){if(f!==2)throw new Error("cipher output not supported");ct(p)}},"checkOutput"),c=!1;return{encrypt(f,p){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,ct(f),u(a.encrypt.length,p),a.encrypt(f,p)},decrypt(f,p){if(ct(f),i&&f.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return u(a.decrypt.length,p),a.decrypt(f,p)}}}return s(n,"wrappedCipher"),Object.assign(n,e),n},"wrapCipher");te.wrapCipher=Gd;function Wd(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!Xa(t))throw new Error("invalid output, must be aligned");return t}s(Wd,"getOutput");function Jo(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),i=BigInt(4294967295),a=Number(n>>o&i),u=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+l,u,r)}s(Jo,"setBigUint64");function $d(e,t,n){ja(n);let r=new Uint8Array(16),o=za(r);return Jo(o,0,BigInt(t),n),Jo(o,8,BigInt(e),n),r}s($d,"u64Lengths");function Xa(e){return e.byteOffset%4===0}s(Xa,"isAligned32");function Ja(e){return Uint8Array.from(e)}s(Ja,"copyBytes")});var Ur=re(De=>{"use strict";g();b();Object.defineProperty(De,"__esModule",{value:!0});De.AEAD_TAG_LENGTH=De.XCHACHA20_NONCE_LENGTH=De.CURVE25519_PUBLIC_KEY_SIZE=De.ETH_PUBLIC_KEY_SIZE=De.UNCOMPRESSED_PUBLIC_KEY_SIZE=De.COMPRESSED_PUBLIC_KEY_SIZE=De.SECRET_KEY_LENGTH=void 0;De.SECRET_KEY_LENGTH=32;De.COMPRESSED_PUBLIC_KEY_SIZE=33;De.UNCOMPRESSED_PUBLIC_KEY_SIZE=65;De.ETH_PUBLIC_KEY_SIZE=64;De.CURVE25519_PUBLIC_KEY_SIZE=32;De.XCHACHA20_NONCE_LENGTH=24;De.AEAD_TAG_LENGTH=16});var nr=re(we=>{"use strict";g();b();Object.defineProperty(we,"__esModule",{value:!0});we.ephemeralKeySize=we.symmetricNonceLength=we.symmetricAlgorithm=we.isHkdfKeyCompressed=we.isEphemeralKeyCompressed=we.ellipticCurve=we.ECIES_CONFIG=void 0;var Rr=Ur(),Zd=function(){function e(){this.ellipticCurve="secp256k1",this.isEphemeralKeyCompressed=!1,this.isHkdfKeyCompressed=!1,this.symmetricAlgorithm="aes-256-gcm",this.symmetricNonceLength=16}return s(e,"Config"),e}();we.ECIES_CONFIG=new Zd;var Yd=s(function(){return we.ECIES_CONFIG.ellipticCurve},"ellipticCurve");we.ellipticCurve=Yd;var Qd=s(function(){return we.ECIES_CONFIG.isEphemeralKeyCompressed},"isEphemeralKeyCompressed");we.isEphemeralKeyCompressed=Qd;var Xd=s(function(){return we.ECIES_CONFIG.isHkdfKeyCompressed},"isHkdfKeyCompressed");we.isHkdfKeyCompressed=Xd;var Jd=s(function(){return we.ECIES_CONFIG.symmetricAlgorithm},"symmetricAlgorithm");we.symmetricAlgorithm=Jd;var e0=s(function(){return we.ECIES_CONFIG.symmetricNonceLength},"symmetricNonceLength");we.symmetricNonceLength=e0;var t0=s(function(){var e={secp256k1:we.ECIES_CONFIG.isEphemeralKeyCompressed?Rr.COMPRESSED_PUBLIC_KEY_SIZE:Rr.UNCOMPRESSED_PUBLIC_KEY_SIZE,x25519:Rr.CURVE25519_PUBLIC_KEY_SIZE,ed25519:Rr.CURVE25519_PUBLIC_KEY_SIZE};if(we.ECIES_CONFIG.ellipticCurve in e)return e[we.ECIES_CONFIG.ellipticCurve];throw new Error("Not implemented")},"ephemeralKeySize");we.ephemeralKeySize=t0});var ec=re(Dr=>{"use strict";g();b();Object.defineProperty(Dr,"__esModule",{value:!0});Dr.crypto=void 0;Dr.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var rs=re(qe=>{"use strict";g();b();Object.defineProperty(qe,"__esModule",{value:!0});qe.gcm=qe.ctr=qe.cbc=qe.utils=void 0;qe.randomBytes=tc;qe.getWebcryptoSubtle=ts;qe.managedNonce=n0;var mt=ec(),In=Je();function tc(e=32){if(mt.crypto&&typeof mt.crypto.getRandomValues=="function")return mt.crypto.getRandomValues(new Uint8Array(e));if(mt.crypto&&typeof mt.crypto.randomBytes=="function")return Uint8Array.from(mt.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}s(tc,"randomBytes");function ts(){if(mt.crypto&&typeof mt.crypto.subtle=="object"&&mt.crypto.subtle!=null)return mt.crypto.subtle;throw new Error("crypto.subtle must be defined")}s(ts,"getWebcryptoSubtle");function n0(e){let{nonceLength:t}=e;return(0,In.anumber)(t),(n,...r)=>({encrypt(o,...i){let a=tc(t),u=e(n,a,...r).encrypt(o,...i),c=(0,In.concatBytes)(a,u);return u.fill(0),c},decrypt(o,...i){let a=o.subarray(0,t),u=o.subarray(t);return e(n,a,...r).decrypt(u,...i)}})}s(n0,"managedNonce");qe.utils={async encrypt(e,t,n,r){let o=ts(),i=await o.importKey("raw",e,t,!0,["encrypt"]),a=await o.encrypt(n,i,r);return new Uint8Array(a)},async decrypt(e,t,n,r){let o=ts(),i=await o.importKey("raw",e,t,!0,["decrypt"]),a=await o.decrypt(n,i,r);return new Uint8Array(a)}};var yt={CBC:"AES-CBC",CTR:"AES-CTR",GCM:"AES-GCM"};function r0(e,t,n){if(e===yt.CBC)return{name:yt.CBC,iv:t};if(e===yt.CTR)return{name:yt.CTR,counter:t,length:64};if(e===yt.GCM)return n?{name:yt.GCM,iv:t,additionalData:n}:{name:yt.GCM,iv:t};throw new Error("unknown aes block mode")}s(r0,"getCryptParams");function ns(e){return(t,n,r)=>{(0,In.abytes)(t),(0,In.abytes)(n);let o={name:e,length:t.length*8},i=r0(e,n,r),a=!1;return{encrypt(u){if((0,In.abytes)(u),a)throw new Error("Cannot encrypt() twice with same key / nonce");return a=!0,qe.utils.encrypt(t,o,i,u)},decrypt(u){return(0,In.abytes)(u),qe.utils.decrypt(t,o,i,u)}}}}s(ns,"generate");qe.cbc=ns(yt.CBC);qe.ctr=ns(yt.CTR);qe.gcm=ns(yt.GCM)});var nc=re(Nr=>{"use strict";g();b();Object.defineProperty(Nr,"__esModule",{value:!0});Nr.crypto=void 0;Nr.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var gt=re(Z=>{"use strict";g();b();Object.defineProperty(Z,"__esModule",{value:!0});Z.wrapXOFConstructorWithOpts=Z.wrapConstructorWithOpts=Z.wrapConstructor=Z.Hash=Z.nextTick=Z.swap32IfBE=Z.byteSwapIfBE=Z.swap8IfBE=Z.isLE=void 0;Z.isBytes=oc;Z.anumber=os;Z.abytes=Ln;Z.ahash=o0;Z.aexists=s0;Z.aoutput=i0;Z.u8=a0;Z.u32=c0;Z.clean=u0;Z.createView=l0;Z.rotr=f0;Z.rotl=d0;Z.byteSwap=is;Z.byteSwap32=sc;Z.bytesToHex=h0;Z.hexToBytes=y0;Z.asyncLoop=g0;Z.utf8ToBytes=as;Z.bytesToUtf8=b0;Z.toBytes=Mr;Z.kdfInputToBytes=w0;Z.concatBytes=x0;Z.checkOpts=E0;Z.createHasher=ac;Z.createOptHasher=cc;Z.createXOFer=uc;Z.randomBytes=_0;var Tn=nc();function oc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}s(oc,"isBytes");function os(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}s(os,"anumber");function Ln(e,...t){if(!oc(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}s(Ln,"abytes");function o0(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");os(e.outputLen),os(e.blockLen)}s(o0,"ahash");function s0(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}s(s0,"aexists");function i0(e,t){Ln(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}s(i0,"aoutput");function a0(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}s(a0,"u8");function c0(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}s(c0,"u32");function u0(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}s(u0,"clean");function l0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}s(l0,"createView");function f0(e,t){return e<<32-t|e>>>t}s(f0,"rotr");function d0(e,t){return e<<t|e>>>32-t>>>0}s(d0,"rotl");Z.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function is(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}s(is,"byteSwap");Z.swap8IfBE=Z.isLE?e=>e:e=>is(e);Z.byteSwapIfBE=Z.swap8IfBE;function sc(e){for(let t=0;t<e.length;t++)e[t]=is(e[t]);return e}s(sc,"byteSwap32");Z.swap32IfBE=Z.isLE?e=>e:sc;var ic=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",p0=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function h0(e){if(Ln(e),ic)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=p0[e[n]];return t}s(h0,"bytesToHex");var Dt={_0:48,_9:57,A:65,F:70,a:97,f:102};function rc(e){if(e>=Dt._0&&e<=Dt._9)return e-Dt._0;if(e>=Dt.A&&e<=Dt.F)return e-(Dt.A-10);if(e>=Dt.a&&e<=Dt.f)return e-(Dt.a-10)}s(rc,"asciiToBase16");function y0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(ic)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,i=0;o<n;o++,i+=2){let a=rc(e.charCodeAt(i)),u=rc(e.charCodeAt(i+1));if(a===void 0||u===void 0){let c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[o]=a*16+u}return r}s(y0,"hexToBytes");var m0=s(async()=>{},"nextTick");Z.nextTick=m0;async function g0(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let i=Date.now()-r;i>=0&&i<t||(await(0,Z.nextTick)(),r+=i)}}s(g0,"asyncLoop");function as(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}s(as,"utf8ToBytes");function b0(e){return new TextDecoder().decode(e)}s(b0,"bytesToUtf8");function Mr(e){return typeof e=="string"&&(e=as(e)),Ln(e),e}s(Mr,"toBytes");function w0(e){return typeof e=="string"&&(e=as(e)),Ln(e),e}s(w0,"kdfInputToBytes");function x0(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];Ln(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let i=e[r];n.set(i,o),o+=i.length}return n}s(x0,"concatBytes");function E0(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}s(E0,"checkOpts");var ss=class{static{s(this,"Hash")}};Z.Hash=ss;function ac(e){let t=s(r=>e().update(Mr(r)).digest(),"hashC"),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}s(ac,"createHasher");function cc(e){let t=s((r,o)=>e(o).update(Mr(r)).digest(),"hashC"),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}s(cc,"createOptHasher");function uc(e){let t=s((r,o)=>e(o).update(Mr(r)).digest(),"hashC"),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}s(uc,"createXOFer");Z.wrapConstructor=ac;Z.wrapConstructorWithOpts=cc;Z.wrapXOFConstructorWithOpts=uc;function _0(e=32){if(Tn.crypto&&typeof Tn.crypto.getRandomValues=="function")return Tn.crypto.getRandomValues(new Uint8Array(e));if(Tn.crypto&&typeof Tn.crypto.randomBytes=="function")return Uint8Array.from(Tn.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}s(_0,"randomBytes")});var fc=re(ke=>{"use strict";g();b();Object.defineProperty(ke,"__esModule",{value:!0});ke.SHA512_IV=ke.SHA384_IV=ke.SHA224_IV=ke.SHA256_IV=ke.HashMD=void 0;ke.setBigUint64=lc;ke.Chi=v0;ke.Maj=S0;var bt=gt();function lc(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),i=BigInt(4294967295),a=Number(n>>o&i),u=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+l,u,r)}s(lc,"setBigUint64");function v0(e,t,n){return e&t^~e&n}s(v0,"Chi");function S0(e,t,n){return e&t^e&n^t&n}s(S0,"Maj");var cs=class extends bt.Hash{static{s(this,"HashMD")}constructor(t,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=(0,bt.createView)(this.buffer)}update(t){(0,bt.aexists)(this),t=(0,bt.toBytes)(t),(0,bt.abytes)(t);let{view:n,buffer:r,blockLen:o}=this,i=t.length;for(let a=0;a<i;){let u=Math.min(o-this.pos,i-a);if(u===o){let c=(0,bt.createView)(t);for(;o<=i-a;a+=o)this.process(c,a);continue}r.set(t.subarray(a,a+u),this.pos),this.pos+=u,a+=u,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,bt.aexists)(this),(0,bt.aoutput)(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:i}=this,{pos:a}=this;n[a++]=128,(0,bt.clean)(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(r,0),a=0);for(let p=a;p<o;p++)n[p]=0;lc(r,o-8,BigInt(this.length*8),i),this.process(r,0);let u=(0,bt.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<l;p++)u.setUint32(4*p,f[p],i)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:i,destroyed:a,pos:u}=this;return t.destroyed=a,t.finished=i,t.length=o,t.pos=u,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};ke.HashMD=cs;ke.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);ke.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);ke.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);ke.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});var Uc=re(X=>{"use strict";g();b();Object.defineProperty(X,"__esModule",{value:!0});X.toBig=X.shrSL=X.shrSH=X.rotrSL=X.rotrSH=X.rotrBL=X.rotrBH=X.rotr32L=X.rotr32H=X.rotlSL=X.rotlSH=X.rotlBL=X.rotlBH=X.add5L=X.add5H=X.add4L=X.add4H=X.add3L=X.add3H=void 0;X.add=Bc;X.fromBig=ls;X.split=dc;var Hr=BigInt(2**32-1),us=BigInt(32);function ls(e,t=!1){return t?{h:Number(e&Hr),l:Number(e>>us&Hr)}:{h:Number(e>>us&Hr)|0,l:Number(e&Hr)|0}}s(ls,"fromBig");function dc(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let i=0;i<n;i++){let{h:a,l:u}=ls(e[i],t);[r[i],o[i]]=[a,u]}return[r,o]}s(dc,"split");var pc=s((e,t)=>BigInt(e>>>0)<<us|BigInt(t>>>0),"toBig");X.toBig=pc;var hc=s((e,t,n)=>e>>>n,"shrSH");X.shrSH=hc;var yc=s((e,t,n)=>e<<32-n|t>>>n,"shrSL");X.shrSL=yc;var mc=s((e,t,n)=>e>>>n|t<<32-n,"rotrSH");X.rotrSH=mc;var gc=s((e,t,n)=>e<<32-n|t>>>n,"rotrSL");X.rotrSL=gc;var bc=s((e,t,n)=>e<<64-n|t>>>n-32,"rotrBH");X.rotrBH=bc;var wc=s((e,t,n)=>e>>>n-32|t<<64-n,"rotrBL");X.rotrBL=wc;var xc=s((e,t)=>t,"rotr32H");X.rotr32H=xc;var Ec=s((e,t)=>e,"rotr32L");X.rotr32L=Ec;var _c=s((e,t,n)=>e<<n|t>>>32-n,"rotlSH");X.rotlSH=_c;var vc=s((e,t,n)=>t<<n|e>>>32-n,"rotlSL");X.rotlSL=vc;var Sc=s((e,t,n)=>t<<n-32|e>>>64-n,"rotlBH");X.rotlBH=Sc;var Ac=s((e,t,n)=>e<<n-32|t>>>64-n,"rotlBL");X.rotlBL=Ac;function Bc(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}s(Bc,"add");var Cc=s((e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),"add3L");X.add3L=Cc;var Ic=s((e,t,n,r)=>t+n+r+(e/2**32|0)|0,"add3H");X.add3H=Ic;var Tc=s((e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),"add4L");X.add4L=Tc;var Lc=s((e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,"add4H");X.add4H=Lc;var Oc=s((e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),"add5L");X.add5L=Oc;var Pc=s((e,t,n,r,o,i)=>t+n+r+o+i+(e/2**32|0)|0,"add5H");X.add5H=Pc;var A0={fromBig:ls,split:dc,toBig:pc,shrSH:hc,shrSL:yc,rotrSH:mc,rotrSL:gc,rotrBH:bc,rotrBL:wc,rotr32H:xc,rotr32L:Ec,rotlSH:_c,rotlSL:vc,rotlBH:Sc,rotlBL:Ac,add:Bc,add3L:Cc,add3H:Ic,add4L:Tc,add4H:Lc,add5H:Pc,add5L:Oc};X.default=A0});var Fr=re(ye=>{"use strict";g();b();Object.defineProperty(ye,"__esModule",{value:!0});ye.sha512_224=ye.sha512_256=ye.sha384=ye.sha512=ye.sha224=ye.sha256=ye.SHA512_256=ye.SHA512_224=ye.SHA384=ye.SHA512=ye.SHA224=ye.SHA256=void 0;var $=fc(),ne=Uc(),Be=gt(),B0=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Wt=new Uint32Array(64),rr=class extends $.HashMD{static{s(this,"SHA256")}constructor(t=32){super(64,t,8,!1),this.A=$.SHA256_IV[0]|0,this.B=$.SHA256_IV[1]|0,this.C=$.SHA256_IV[2]|0,this.D=$.SHA256_IV[3]|0,this.E=$.SHA256_IV[4]|0,this.F=$.SHA256_IV[5]|0,this.G=$.SHA256_IV[6]|0,this.H=$.SHA256_IV[7]|0}get(){let{A:t,B:n,C:r,D:o,E:i,F:a,G:u,H:c}=this;return[t,n,r,o,i,a,u,c]}set(t,n,r,o,i,a,u,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=a|0,this.G=u|0,this.H=c|0}process(t,n){for(let p=0;p<16;p++,n+=4)Wt[p]=t.getUint32(n,!1);for(let p=16;p<64;p++){let d=Wt[p-15],y=Wt[p-2],h=(0,Be.rotr)(d,7)^(0,Be.rotr)(d,18)^d>>>3,w=(0,Be.rotr)(y,17)^(0,Be.rotr)(y,19)^y>>>10;Wt[p]=w+Wt[p-7]+h+Wt[p-16]|0}let{A:r,B:o,C:i,D:a,E:u,F:c,G:l,H:f}=this;for(let p=0;p<64;p++){let d=(0,Be.rotr)(u,6)^(0,Be.rotr)(u,11)^(0,Be.rotr)(u,25),y=f+d+(0,$.Chi)(u,c,l)+B0[p]+Wt[p]|0,w=((0,Be.rotr)(r,2)^(0,Be.rotr)(r,13)^(0,Be.rotr)(r,22))+(0,$.Maj)(r,o,i)|0;f=l,l=c,c=u,u=a+y|0,a=i,i=o,o=r,r=y+w|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,a=a+this.D|0,u=u+this.E|0,c=c+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(r,o,i,a,u,c,l,f)}roundClean(){(0,Be.clean)(Wt)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,Be.clean)(this.buffer)}};ye.SHA256=rr;var Kr=class extends rr{static{s(this,"SHA224")}constructor(){super(28),this.A=$.SHA224_IV[0]|0,this.B=$.SHA224_IV[1]|0,this.C=$.SHA224_IV[2]|0,this.D=$.SHA224_IV[3]|0,this.E=$.SHA224_IV[4]|0,this.F=$.SHA224_IV[5]|0,this.G=$.SHA224_IV[6]|0,this.H=$.SHA224_IV[7]|0}};ye.SHA224=Kr;var Rc=ne.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),C0=Rc[0],I0=Rc[1],$t=new Uint32Array(80),Zt=new Uint32Array(80),tn=class extends $.HashMD{static{s(this,"SHA512")}constructor(t=64){super(128,t,16,!1),this.Ah=$.SHA512_IV[0]|0,this.Al=$.SHA512_IV[1]|0,this.Bh=$.SHA512_IV[2]|0,this.Bl=$.SHA512_IV[3]|0,this.Ch=$.SHA512_IV[4]|0,this.Cl=$.SHA512_IV[5]|0,this.Dh=$.SHA512_IV[6]|0,this.Dl=$.SHA512_IV[7]|0,this.Eh=$.SHA512_IV[8]|0,this.El=$.SHA512_IV[9]|0,this.Fh=$.SHA512_IV[10]|0,this.Fl=$.SHA512_IV[11]|0,this.Gh=$.SHA512_IV[12]|0,this.Gl=$.SHA512_IV[13]|0,this.Hh=$.SHA512_IV[14]|0,this.Hl=$.SHA512_IV[15]|0}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:i,Cl:a,Dh:u,Dl:c,Eh:l,El:f,Fh:p,Fl:d,Gh:y,Gl:h,Hh:w,Hl:m}=this;return[t,n,r,o,i,a,u,c,l,f,p,d,y,h,w,m]}set(t,n,r,o,i,a,u,c,l,f,p,d,y,h,w,m){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=i|0,this.Cl=a|0,this.Dh=u|0,this.Dl=c|0,this.Eh=l|0,this.El=f|0,this.Fh=p|0,this.Fl=d|0,this.Gh=y|0,this.Gl=h|0,this.Hh=w|0,this.Hl=m|0}process(t,n){for(let S=0;S<16;S++,n+=4)$t[S]=t.getUint32(n),Zt[S]=t.getUint32(n+=4);for(let S=16;S<80;S++){let C=$t[S-15]|0,H=Zt[S-15]|0,q=ne.rotrSH(C,H,1)^ne.rotrSH(C,H,8)^ne.shrSH(C,H,7),G=ne.rotrSL(C,H,1)^ne.rotrSL(C,H,8)^ne.shrSL(C,H,7),k=$t[S-2]|0,B=Zt[S-2]|0,O=ne.rotrSH(k,B,19)^ne.rotrBH(k,B,61)^ne.shrSH(k,B,6),R=ne.rotrSL(k,B,19)^ne.rotrBL(k,B,61)^ne.shrSL(k,B,6),D=ne.add4L(G,R,Zt[S-7],Zt[S-16]),_=ne.add4H(D,q,O,$t[S-7],$t[S-16]);$t[S]=_|0,Zt[S]=D|0}let{Ah:r,Al:o,Bh:i,Bl:a,Ch:u,Cl:c,Dh:l,Dl:f,Eh:p,El:d,Fh:y,Fl:h,Gh:w,Gl:m,Hh:x,Hl:E}=this;for(let S=0;S<80;S++){let C=ne.rotrSH(p,d,14)^ne.rotrSH(p,d,18)^ne.rotrBH(p,d,41),H=ne.rotrSL(p,d,14)^ne.rotrSL(p,d,18)^ne.rotrBL(p,d,41),q=p&y^~p&w,G=d&h^~d&m,k=ne.add5L(E,H,G,I0[S],Zt[S]),B=ne.add5H(k,x,C,q,C0[S],$t[S]),O=k|0,R=ne.rotrSH(r,o,28)^ne.rotrBH(r,o,34)^ne.rotrBH(r,o,39),D=ne.rotrSL(r,o,28)^ne.rotrBL(r,o,34)^ne.rotrBL(r,o,39),_=r&i^r&u^i&u,v=o&a^o&c^a&c;x=w|0,E=m|0,w=y|0,m=h|0,y=p|0,h=d|0,{h:p,l:d}=ne.add(l|0,f|0,B|0,O|0),l=u|0,f=c|0,u=i|0,c=a|0,i=r|0,a=o|0;let A=ne.add3L(O,D,v);r=ne.add3H(A,B,R,_),o=A|0}({h:r,l:o}=ne.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:i,l:a}=ne.add(this.Bh|0,this.Bl|0,i|0,a|0),{h:u,l:c}=ne.add(this.Ch|0,this.Cl|0,u|0,c|0),{h:l,l:f}=ne.add(this.Dh|0,this.Dl|0,l|0,f|0),{h:p,l:d}=ne.add(this.Eh|0,this.El|0,p|0,d|0),{h:y,l:h}=ne.add(this.Fh|0,this.Fl|0,y|0,h|0),{h:w,l:m}=ne.add(this.Gh|0,this.Gl|0,w|0,m|0),{h:x,l:E}=ne.add(this.Hh|0,this.Hl|0,x|0,E|0),this.set(r,o,i,a,u,c,l,f,p,d,y,h,w,m,x,E)}roundClean(){(0,Be.clean)($t,Zt)}destroy(){(0,Be.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ye.SHA512=tn;var qr=class extends tn{static{s(this,"SHA384")}constructor(){super(48),this.Ah=$.SHA384_IV[0]|0,this.Al=$.SHA384_IV[1]|0,this.Bh=$.SHA384_IV[2]|0,this.Bl=$.SHA384_IV[3]|0,this.Ch=$.SHA384_IV[4]|0,this.Cl=$.SHA384_IV[5]|0,this.Dh=$.SHA384_IV[6]|0,this.Dl=$.SHA384_IV[7]|0,this.Eh=$.SHA384_IV[8]|0,this.El=$.SHA384_IV[9]|0,this.Fh=$.SHA384_IV[10]|0,this.Fl=$.SHA384_IV[11]|0,this.Gh=$.SHA384_IV[12]|0,this.Gl=$.SHA384_IV[13]|0,this.Hh=$.SHA384_IV[14]|0,this.Hl=$.SHA384_IV[15]|0}};ye.SHA384=qr;var Ne=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),Me=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),kr=class extends tn{static{s(this,"SHA512_224")}constructor(){super(28),this.Ah=Ne[0]|0,this.Al=Ne[1]|0,this.Bh=Ne[2]|0,this.Bl=Ne[3]|0,this.Ch=Ne[4]|0,this.Cl=Ne[5]|0,this.Dh=Ne[6]|0,this.Dl=Ne[7]|0,this.Eh=Ne[8]|0,this.El=Ne[9]|0,this.Fh=Ne[10]|0,this.Fl=Ne[11]|0,this.Gh=Ne[12]|0,this.Gl=Ne[13]|0,this.Hh=Ne[14]|0,this.Hl=Ne[15]|0}};ye.SHA512_224=kr;var Vr=class extends tn{static{s(this,"SHA512_256")}constructor(){super(32),this.Ah=Me[0]|0,this.Al=Me[1]|0,this.Bh=Me[2]|0,this.Bl=Me[3]|0,this.Ch=Me[4]|0,this.Cl=Me[5]|0,this.Dh=Me[6]|0,this.Dl=Me[7]|0,this.Eh=Me[8]|0,this.El=Me[9]|0,this.Fh=Me[10]|0,this.Fl=Me[11]|0,this.Gh=Me[12]|0,this.Gl=Me[13]|0,this.Hh=Me[14]|0,this.Hl=Me[15]|0}};ye.SHA512_256=Vr;ye.sha256=(0,Be.createHasher)(()=>new rr);ye.sha224=(0,Be.createHasher)(()=>new Kr);ye.sha512=(0,Be.createHasher)(()=>new tn);ye.sha384=(0,Be.createHasher)(()=>new qr);ye.sha512_256=(0,Be.createHasher)(()=>new Vr);ye.sha512_224=(0,Be.createHasher)(()=>new kr)});var Mt=re(Y=>{"use strict";g();b();Object.defineProperty(Y,"__esModule",{value:!0});Y.notImplemented=Y.bitMask=Y.utf8ToBytes=Y.randomBytes=Y.isBytes=Y.hexToBytes=Y.concatBytes=Y.bytesToUtf8=Y.bytesToHex=Y.anumber=Y.abytes=void 0;Y.abool=T0;Y._abool2=L0;Y._abytes2=O0;Y.numberToHexUnpadded=Dc;Y.hexToNumber=ds;Y.bytesToNumberBE=P0;Y.bytesToNumberLE=U0;Y.numberToBytesBE=Nc;Y.numberToBytesLE=R0;Y.numberToVarBytesBE=D0;Y.ensureBytes=N0;Y.equalBytes=M0;Y.copyBytes=H0;Y.asciiToBytes=K0;Y.inRange=Mc;Y.aInRange=q0;Y.bitLen=k0;Y.bitGet=V0;Y.bitSet=F0;Y.createHmacDrbg=z0;Y.validateObject=W0;Y.isHash=$0;Y._validateObject=Z0;Y.memoized=Q0;var wt=gt(),Nt=gt();Object.defineProperty(Y,"abytes",{enumerable:!0,get:s(function(){return Nt.abytes},"get")});Object.defineProperty(Y,"anumber",{enumerable:!0,get:s(function(){return Nt.anumber},"get")});Object.defineProperty(Y,"bytesToHex",{enumerable:!0,get:s(function(){return Nt.bytesToHex},"get")});Object.defineProperty(Y,"bytesToUtf8",{enumerable:!0,get:s(function(){return Nt.bytesToUtf8},"get")});Object.defineProperty(Y,"concatBytes",{enumerable:!0,get:s(function(){return Nt.concatBytes},"get")});Object.defineProperty(Y,"hexToBytes",{enumerable:!0,get:s(function(){return Nt.hexToBytes},"get")});Object.defineProperty(Y,"isBytes",{enumerable:!0,get:s(function(){return Nt.isBytes},"get")});Object.defineProperty(Y,"randomBytes",{enumerable:!0,get:s(function(){return Nt.randomBytes},"get")});Object.defineProperty(Y,"utf8ToBytes",{enumerable:!0,get:s(function(){return Nt.utf8ToBytes},"get")});var jr=BigInt(0),or=BigInt(1);function T0(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}s(T0,"abool");function L0(e,t=""){if(typeof e!="boolean"){let n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}s(L0,"_abool2");function O0(e,t,n=""){let r=(0,wt.isBytes)(e),o=e?.length,i=t!==void 0;if(!r||i&&o!==t){let a=n&&`"${n}" `,u=i?` of length ${t}`:"",c=r?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+u+", got "+c)}return e}s(O0,"_abytes2");function Dc(e){let t=e.toString(16);return t.length&1?"0"+t:t}s(Dc,"numberToHexUnpadded");function ds(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?jr:BigInt("0x"+e)}s(ds,"hexToNumber");function P0(e){return ds((0,wt.bytesToHex)(e))}s(P0,"bytesToNumberBE");function U0(e){return(0,wt.abytes)(e),ds((0,wt.bytesToHex)(Uint8Array.from(e).reverse()))}s(U0,"bytesToNumberLE");function Nc(e,t){return(0,wt.hexToBytes)(e.toString(16).padStart(t*2,"0"))}s(Nc,"numberToBytesBE");function R0(e,t){return Nc(e,t).reverse()}s(R0,"numberToBytesLE");function D0(e){return(0,wt.hexToBytes)(Dc(e))}s(D0,"numberToVarBytesBE");function N0(e,t,n){let r;if(typeof t=="string")try{r=(0,wt.hexToBytes)(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if((0,wt.isBytes)(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(e+" of length "+n+" expected, got "+o);return r}s(N0,"ensureBytes");function M0(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}s(M0,"equalBytes");function H0(e){return Uint8Array.from(e)}s(H0,"copyBytes");function K0(e){return Uint8Array.from(e,(t,n)=>{let r=t.charCodeAt(0);if(t.length!==1||r>127)throw new Error(`string contains non-ASCII character "${e[n]}" with code ${r} at position ${n}`);return r})}s(K0,"asciiToBytes");var fs=s(e=>typeof e=="bigint"&&jr<=e,"isPosBig");function Mc(e,t,n){return fs(e)&&fs(t)&&fs(n)&&t<=e&&e<n}s(Mc,"inRange");function q0(e,t,n,r){if(!Mc(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}s(q0,"aInRange");function k0(e){let t;for(t=0;e>jr;e>>=or,t+=1);return t}s(k0,"bitLen");function V0(e,t){return e>>BigInt(t)&or}s(V0,"bitGet");function F0(e,t,n){return e|(n?or:jr)<<BigInt(t)}s(F0,"bitSet");var j0=s(e=>(or<<BigInt(e))-or,"bitMask");Y.bitMask=j0;function z0(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=s(y=>new Uint8Array(y),"u8n"),o=s(y=>Uint8Array.of(y),"u8of"),i=r(e),a=r(e),u=0,c=s(()=>{i.fill(1),a.fill(0),u=0},"reset"),l=s((...y)=>n(a,i,...y),"h"),f=s((y=r(0))=>{a=l(o(0),y),i=l(),y.length!==0&&(a=l(o(1),y),i=l())},"reseed"),p=s(()=>{if(u++>=1e3)throw new Error("drbg: tried 1000 values");let y=0,h=[];for(;y<t;){i=l();let w=i.slice();h.push(w),y+=i.length}return(0,wt.concatBytes)(...h)},"gen");return s((y,h)=>{c(),f(y);let w;for(;!(w=h(p()));)f();return c(),w},"genUntil")}s(z0,"createHmacDrbg");var G0={bigint:s(e=>typeof e=="bigint","bigint"),function:s(e=>typeof e=="function","function"),boolean:s(e=>typeof e=="boolean","boolean"),string:s(e=>typeof e=="string","string"),stringOrUint8Array:s(e=>typeof e=="string"||(0,wt.isBytes)(e),"stringOrUint8Array"),isSafeInteger:s(e=>Number.isSafeInteger(e),"isSafeInteger"),array:s(e=>Array.isArray(e),"array"),field:s((e,t)=>t.Fp.isValid(e),"field"),hash:s(e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen),"hash")};function W0(e,t,n={}){let r=s((o,i,a)=>{let u=G0[i];if(typeof u!="function")throw new Error("invalid validator function");let c=e[o];if(!(a&&c===void 0)&&!u(c,e))throw new Error("param "+String(o)+" is invalid. Expected "+i+", got "+c)},"checkField");for(let[o,i]of Object.entries(t))r(o,i,!1);for(let[o,i]of Object.entries(n))r(o,i,!0);return e}s(W0,"validateObject");function $0(e){return typeof e=="function"&&Number.isSafeInteger(e.outputLen)}s($0,"isHash");function Z0(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(o,i,a){let u=e[o];if(a&&u===void 0)return;let c=typeof u;if(c!==i||u===null)throw new Error(`param "${o}" is invalid: expected ${i}, got ${c}`)}s(r,"checkField"),Object.entries(t).forEach(([o,i])=>r(o,i,!1)),Object.entries(n).forEach(([o,i])=>r(o,i,!0))}s(Z0,"_validateObject");var Y0=s(()=>{throw new Error("not implemented")},"notImplemented");Y.notImplemented=Y0;function Q0(e){let t=new WeakMap;return(n,...r)=>{let o=t.get(n);if(o!==void 0)return o;let i=e(n,...r);return t.set(n,i),i}}s(Q0,"memoized")});var Yt=re(xe=>{"use strict";g();b();Object.defineProperty(xe,"__esModule",{value:!0});xe.isNegativeLE=void 0;xe.mod=Ye;xe.pow=ep;xe.pow2=tp;xe.invert=zr;xe.tonelliShanks=hs;xe.FpSqrt=jc;xe.validateField=ip;xe.FpPow=ys;xe.FpInvertBatch=zc;xe.FpDiv=ap;xe.FpLegendre=Gr;xe.FpIsSquare=cp;xe.nLength=ms;xe.Field=Wr;xe.FpSqrtOdd=up;xe.FpSqrtEven=lp;xe.hashToPrivateScalar=fp;xe.getFieldBytesLength=gs;xe.getMinHashLength=Gc;xe.mapHashToField=dp;var Qe=Mt(),Ve=BigInt(0),Ce=BigInt(1),nn=BigInt(2),Hc=BigInt(3),Kc=BigInt(4),qc=BigInt(5),X0=BigInt(7),kc=BigInt(8),J0=BigInt(9),Vc=BigInt(16);function Ye(e,t){let n=e%t;return n>=Ve?n:t+n}s(Ye,"mod");function ep(e,t,n){return ys(Wr(n),e,t)}s(ep,"pow");function tp(e,t,n){let r=e;for(;t-- >Ve;)r*=r,r%=n;return r}s(tp,"pow2");function zr(e,t){if(e===Ve)throw new Error("invert: expected non-zero number");if(t<=Ve)throw new Error("invert: expected positive modulus, got "+t);let n=Ye(e,t),r=t,o=Ve,i=Ce,a=Ce,u=Ve;for(;n!==Ve;){let l=r/n,f=r%n,p=o-a*l,d=i-u*l;r=n,n=f,o=a,i=u,a=p,u=d}if(r!==Ce)throw new Error("invert: does not exist");return Ye(o,t)}s(zr,"invert");function ps(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}s(ps,"assertIsSquare");function Fc(e,t){let n=(e.ORDER+Ce)/Kc,r=e.pow(t,n);return ps(e,r,t),r}s(Fc,"sqrt3mod4");function np(e,t){let n=(e.ORDER-qc)/kc,r=e.mul(t,nn),o=e.pow(r,n),i=e.mul(t,o),a=e.mul(e.mul(i,nn),o),u=e.mul(i,e.sub(a,e.ONE));return ps(e,u,t),u}s(np,"sqrt5mod8");function rp(e){let t=Wr(e),n=hs(e),r=n(t,t.neg(t.ONE)),o=n(t,r),i=n(t,t.neg(r)),a=(e+X0)/Vc;return(u,c)=>{let l=u.pow(c,a),f=u.mul(l,r),p=u.mul(l,o),d=u.mul(l,i),y=u.eql(u.sqr(f),c),h=u.eql(u.sqr(p),c);l=u.cmov(l,f,y),f=u.cmov(d,p,h);let w=u.eql(u.sqr(f),c),m=u.cmov(l,f,w);return ps(u,m,c),m}}s(rp,"sqrt9mod16");function hs(e){if(e<Hc)throw new Error("sqrt is not defined for small field");let t=e-Ce,n=0;for(;t%nn===Ve;)t/=nn,n++;let r=nn,o=Wr(e);for(;Gr(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return Fc;let i=o.pow(r,t),a=(t+Ce)/nn;return s(function(c,l){if(c.is0(l))return l;if(Gr(c,l)!==1)throw new Error("Cannot find square root");let f=n,p=c.mul(c.ONE,i),d=c.pow(l,t),y=c.pow(l,a);for(;!c.eql(d,c.ONE);){if(c.is0(d))return c.ZERO;let h=1,w=c.sqr(d);for(;!c.eql(w,c.ONE);)if(h++,w=c.sqr(w),h===f)throw new Error("Cannot find square root");let m=Ce<<BigInt(f-h-1),x=c.pow(p,m);f=h,p=c.sqr(x),d=c.mul(d,p),y=c.mul(y,x)}return y},"tonelliSlow")}s(hs,"tonelliShanks");function jc(e){return e%Kc===Hc?Fc:e%kc===qc?np:e%Vc===J0?rp(e):hs(e)}s(jc,"FpSqrt");var op=s((e,t)=>(Ye(e,t)&Ce)===Ce,"isNegativeLE");xe.isNegativeLE=op;var sp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ip(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=sp.reduce((r,o)=>(r[o]="function",r),t);return(0,Qe._validateObject)(e,n),e}s(ip,"validateField");function ys(e,t,n){if(n<Ve)throw new Error("invalid exponent, negatives unsupported");if(n===Ve)return e.ONE;if(n===Ce)return t;let r=e.ONE,o=t;for(;n>Ve;)n&Ce&&(r=e.mul(r,o)),o=e.sqr(o),n>>=Ce;return r}s(ys,"FpPow");function zc(e,t,n=!1){let r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((a,u,c)=>e.is0(u)?a:(r[c]=a,e.mul(a,u)),e.ONE),i=e.inv(o);return t.reduceRight((a,u,c)=>e.is0(u)?a:(r[c]=e.mul(a,r[c]),e.mul(a,u)),i),r}s(zc,"FpInvertBatch");function ap(e,t,n){return e.mul(t,typeof n=="bigint"?zr(n,e.ORDER):e.inv(n))}s(ap,"FpDiv");function Gr(e,t){let n=(e.ORDER-Ce)/nn,r=e.pow(t,n),o=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),a=e.eql(r,e.neg(e.ONE));if(!o&&!i&&!a)throw new Error("invalid Legendre symbol result");return o?1:i?0:-1}s(Gr,"FpLegendre");function cp(e,t){return Gr(e,t)===1}s(cp,"FpIsSquare");function ms(e,t){t!==void 0&&(0,Qe.anumber)(t);let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}s(ms,"nLength");function Wr(e,t,n=!1,r={}){if(e<=Ve)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,i,a=!1,u;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");let d=t;d.BITS&&(o=d.BITS),d.sqrt&&(i=d.sqrt),typeof d.isLE=="boolean"&&(n=d.isLE),typeof d.modFromBytes=="boolean"&&(a=d.modFromBytes),u=d.allowedLengths}else typeof t=="number"&&(o=t),r.sqrt&&(i=r.sqrt);let{nBitLength:c,nByteLength:l}=ms(e,o);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f,p=Object.freeze({ORDER:e,isLE:n,BITS:c,BYTES:l,MASK:(0,Qe.bitMask)(c),ZERO:Ve,ONE:Ce,allowedLengths:u,create:s(d=>Ye(d,e),"create"),isValid:s(d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return Ve<=d&&d<e},"isValid"),is0:s(d=>d===Ve,"is0"),isValidNot0:s(d=>!p.is0(d)&&p.isValid(d),"isValidNot0"),isOdd:s(d=>(d&Ce)===Ce,"isOdd"),neg:s(d=>Ye(-d,e),"neg"),eql:s((d,y)=>d===y,"eql"),sqr:s(d=>Ye(d*d,e),"sqr"),add:s((d,y)=>Ye(d+y,e),"add"),sub:s((d,y)=>Ye(d-y,e),"sub"),mul:s((d,y)=>Ye(d*y,e),"mul"),pow:s((d,y)=>ys(p,d,y),"pow"),div:s((d,y)=>Ye(d*zr(y,e),e),"div"),sqrN:s(d=>d*d,"sqrN"),addN:s((d,y)=>d+y,"addN"),subN:s((d,y)=>d-y,"subN"),mulN:s((d,y)=>d*y,"mulN"),inv:s(d=>zr(d,e),"inv"),sqrt:i||(d=>(f||(f=jc(e)),f(p,d))),toBytes:s(d=>n?(0,Qe.numberToBytesLE)(d,l):(0,Qe.numberToBytesBE)(d,l),"toBytes"),fromBytes:s((d,y=!0)=>{if(u){if(!u.includes(d.length)||d.length>l)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+d.length);let w=new Uint8Array(l);w.set(d,n?0:w.length-d.length),d=w}if(d.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+d.length);let h=n?(0,Qe.bytesToNumberLE)(d):(0,Qe.bytesToNumberBE)(d);if(a&&(h=Ye(h,e)),!y&&!p.isValid(h))throw new Error("invalid field element: outside of range 0..ORDER");return h},"fromBytes"),invertBatch:s(d=>zc(p,d),"invertBatch"),cmov:s((d,y,h)=>h?y:d,"cmov")});return Object.freeze(p)}s(Wr,"Field");function up(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?n:e.neg(n)}s(up,"FpSqrtOdd");function lp(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n}s(lp,"FpSqrtEven");function fp(e,t,n=!1){e=(0,Qe.ensureBytes)("privateHash",e);let r=e.length,o=ms(t).nByteLength+8;if(o<24||r<o||r>1024)throw new Error("hashToPrivateScalar: expected "+o+"-1024 bytes of input, got "+r);let i=n?(0,Qe.bytesToNumberLE)(e):(0,Qe.bytesToNumberBE)(e);return Ye(i,t-Ce)+Ce}s(fp,"hashToPrivateScalar");function gs(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}s(gs,"getFieldBytesLength");function Gc(e){let t=gs(e);return t+Math.ceil(t/2)}s(Gc,"getMinHashLength");function dp(e,t,n=!1){let r=e.length,o=gs(t),i=Gc(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);let a=n?(0,Qe.bytesToNumberLE)(e):(0,Qe.bytesToNumberBE)(e),u=Ye(a,t-Ce)+Ce;return n?(0,Qe.numberToBytesLE)(u,o):(0,Qe.numberToBytesBE)(u,o)}s(dp,"mapHashToField")});var $r=re(ut=>{"use strict";g();b();Object.defineProperty(ut,"__esModule",{value:!0});ut.wNAF=void 0;ut.negateCt=Es;ut.normalizeZ=pp;ut.mulEndoUnsafe=hp;ut.pippenger=yp;ut.precomputeMSMUnsafe=mp;ut.validateBasic=gp;ut._createCurveFields=bp;var sr=Mt(),ir=Yt(),On=BigInt(0),rn=BigInt(1);function Es(e,t){let n=t.negate();return e?n:t}s(Es,"negateCt");function pp(e,t){let n=(0,ir.FpInvertBatch)(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}s(pp,"normalizeZ");function vs(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}s(vs,"validateW");function bs(e,t){vs(e,t);let n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,i=(0,sr.bitMask)(e),a=BigInt(e);return{windows:n,windowSize:r,mask:i,maxNumber:o,shiftBy:a}}s(bs,"calcWOpts");function Wc(e,t,n){let{windowSize:r,mask:o,maxNumber:i,shiftBy:a}=n,u=Number(e&o),c=e>>a;u>r&&(u-=i,c+=rn);let l=t*r,f=l+Math.abs(u)-1,p=u===0,d=u<0,y=t%2!==0;return{nextN:c,offset:f,isZero:p,isNeg:d,isNegF:y,offsetF:l}}s(Wc,"calcOffsets");function Yc(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}s(Yc,"validateMSMPoints");function Qc(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}s(Qc,"validateMSMScalars");var ws=new WeakMap,Xc=new WeakMap;function xs(e){return Xc.get(e)||1}s(xs,"getW");function $c(e){if(e!==On)throw new Error("invalid wNAF")}s($c,"assert0");var _s=class{static{s(this,"wNAF")}constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>On;)n&rn&&(r=r.add(o)),o=o.double(),n>>=rn;return r}precomputeWindow(t,n){let{windows:r,windowSize:o}=bs(n,this.bits),i=[],a=t,u=a;for(let c=0;c<r;c++){u=a,i.push(u);for(let l=1;l<o;l++)u=u.add(a),i.push(u);a=u.double()}return i}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,i=this.BASE,a=bs(t,this.bits);for(let u=0;u<a.windows;u++){let{nextN:c,offset:l,isZero:f,isNeg:p,isNegF:d,offsetF:y}=Wc(r,u,a);r=c,f?i=i.add(Es(d,n[y])):o=o.add(Es(p,n[l]))}return $c(r),{p:o,f:i}}wNAFUnsafe(t,n,r,o=this.ZERO){let i=bs(t,this.bits);for(let a=0;a<i.windows&&r!==On;a++){let{nextN:u,offset:c,isZero:l,isNeg:f}=Wc(r,a,i);if(r=u,!l){let p=n[c];o=o.add(f?p.negate():p)}}return $c(r),o}getPrecomputes(t,n,r){let o=ws.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),ws.set(n,o))),o}cached(t,n,r){let o=xs(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){let i=xs(t);return i===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),n,o)}createCache(t,n){vs(n,this.bits),Xc.set(t,n),ws.delete(t)}hasCache(t){return xs(t)!==1}};ut.wNAF=_s;function hp(e,t,n,r){let o=t,i=e.ZERO,a=e.ZERO;for(;n>On||r>On;)n&rn&&(i=i.add(o)),r&rn&&(a=a.add(o)),o=o.double(),n>>=rn,r>>=rn;return{p1:i,p2:a}}s(hp,"mulEndoUnsafe");function yp(e,t,n,r){Yc(n,e),Qc(r,t);let o=n.length,i=r.length;if(o!==i)throw new Error("arrays of points and scalars must have equal length");let a=e.ZERO,u=(0,sr.bitLen)(BigInt(o)),c=1;u>12?c=u-3:u>4?c=u-2:u>0&&(c=2);let l=(0,sr.bitMask)(c),f=new Array(Number(l)+1).fill(a),p=Math.floor((t.BITS-1)/c)*c,d=a;for(let y=p;y>=0;y-=c){f.fill(a);for(let w=0;w<i;w++){let m=r[w],x=Number(m>>BigInt(y)&l);f[x]=f[x].add(n[w])}let h=a;for(let w=f.length-1,m=a;w>0;w--)m=m.add(f[w]),h=h.add(m);if(d=d.add(h),y!==0)for(let w=0;w<c;w++)d=d.double()}return d}s(yp,"pippenger");function mp(e,t,n,r){vs(r,t.BITS),Yc(n,e);let o=e.ZERO,i=2**r-1,a=Math.ceil(t.BITS/r),u=(0,sr.bitMask)(r),c=n.map(l=>{let f=[];for(let p=0,d=l;p<i;p++)f.push(d),d=d.add(l);return f});return l=>{if(Qc(l,t),l.length>n.length)throw new Error("array of scalars must be smaller than array of points");let f=o;for(let p=0;p<a;p++){if(f!==o)for(let y=0;y<r;y++)f=f.double();let d=BigInt(a*r-(p+1)*r);for(let y=0;y<l.length;y++){let h=l[y],w=Number(h>>d&u);w&&(f=f.add(c[y][w-1]))}}return f}}s(mp,"precomputeMSMUnsafe");function gp(e){return(0,ir.validateField)(e.Fp),(0,sr.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,ir.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}s(gp,"validateBasic");function Zc(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,ir.validateField)(t),t}else return(0,ir.Field)(e,{isLE:n})}s(Zc,"createField");function bp(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let c of["p","n","h"]){let l=t[c];if(!(typeof l=="bigint"&&l>On))throw new Error(`CURVE.${c} must be positive bigint`)}let o=Zc(t.p,n.Fp,r),i=Zc(t.n,n.Fn,r),u=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let c of u)if(!o.isValid(t[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:i}}s(bp,"_createCurveFields")});var tu=re(sn=>{"use strict";g();b();Object.defineProperty(sn,"__esModule",{value:!0});sn.PrimeEdwardsPoint=void 0;sn.edwards=Jc;sn.eddsa=eu;sn.twistedEdwards=Sp;var ce=Mt(),on=$r(),wp=Yt(),Qt=BigInt(0),Te=BigInt(1),Ss=BigInt(2),xp=BigInt(8);function Ep(e,t,n,r){let o=e.sqr(n),i=e.sqr(r),a=e.add(e.mul(t.a,o),i),u=e.add(e.ONE,e.mul(t.d,e.mul(o,i)));return e.eql(a,u)}s(Ep,"isEdValidXY");function Jc(e,t={}){let n=(0,on._createCurveFields)("edwards",e,t,t.FpFnLE),{Fp:r,Fn:o}=n,i=n.CURVE,{h:a}=i;(0,ce._validateObject)(t,{},{uvRatio:"function"});let u=Ss<<BigInt(o.BYTES*8)-Te,c=s(m=>r.create(m),"modP"),l=t.uvRatio||((m,x)=>{try{return{isValid:!0,value:r.sqrt(r.div(m,x))}}catch{return{isValid:!1,value:Qt}}});if(!Ep(r,i,i.Gx,i.Gy))throw new Error("bad curve params: generator point");function f(m,x,E=!1){let S=E?Te:Qt;return(0,ce.aInRange)("coordinate "+m,x,S,u),x}s(f,"acoord");function p(m){if(!(m instanceof h))throw new Error("ExtendedPoint expected")}s(p,"aextpoint");let d=(0,ce.memoized)((m,x)=>{let{X:E,Y:S,Z:C}=m,H=m.is0();x==null&&(x=H?xp:r.inv(C));let q=c(E*x),G=c(S*x),k=r.mul(C,x);if(H)return{x:Qt,y:Te};if(k!==Te)throw new Error("invZ was invalid");return{x:q,y:G}}),y=(0,ce.memoized)(m=>{let{a:x,d:E}=i;if(m.is0())throw new Error("bad point: ZERO");let{X:S,Y:C,Z:H,T:q}=m,G=c(S*S),k=c(C*C),B=c(H*H),O=c(B*B),R=c(G*x),D=c(B*c(R+k)),_=c(O+c(E*c(G*k)));if(D!==_)throw new Error("bad point: equation left != right (1)");let v=c(S*C),A=c(H*q);if(v!==A)throw new Error("bad point: equation left != right (2)");return!0});class h{static{s(this,"Point")}constructor(x,E,S,C){this.X=f("x",x),this.Y=f("y",E),this.Z=f("z",S,!0),this.T=f("t",C),Object.freeze(this)}static CURVE(){return i}static fromAffine(x){if(x instanceof h)throw new Error("extended point not allowed");let{x:E,y:S}=x||{};return f("x",E),f("y",S),new h(E,S,Te,c(E*S))}static fromBytes(x,E=!1){let S=r.BYTES,{a:C,d:H}=i;x=(0,ce.copyBytes)((0,ce._abytes2)(x,S,"point")),(0,ce._abool2)(E,"zip215");let q=(0,ce.copyBytes)(x),G=x[S-1];q[S-1]=G&-129;let k=(0,ce.bytesToNumberLE)(q),B=E?u:r.ORDER;(0,ce.aInRange)("point.y",k,Qt,B);let O=c(k*k),R=c(O-Te),D=c(H*O-C),{isValid:_,value:v}=l(R,D);if(!_)throw new Error("bad point: invalid y coordinate");let A=(v&Te)===Te,P=(G&128)!==0;if(!E&&v===Qt&&P)throw new Error("bad point: x=0 and x_0=1");return P!==A&&(v=c(-v)),h.fromAffine({x:v,y:k})}static fromHex(x,E=!1){return h.fromBytes((0,ce.ensureBytes)("point",x),E)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(x=8,E=!0){return w.createCache(this,x),E||this.multiply(Ss),this}assertValidity(){y(this)}equals(x){p(x);let{X:E,Y:S,Z:C}=this,{X:H,Y:q,Z:G}=x,k=c(E*G),B=c(H*C),O=c(S*G),R=c(q*C);return k===B&&O===R}is0(){return this.equals(h.ZERO)}negate(){return new h(c(-this.X),this.Y,this.Z,c(-this.T))}double(){let{a:x}=i,{X:E,Y:S,Z:C}=this,H=c(E*E),q=c(S*S),G=c(Ss*c(C*C)),k=c(x*H),B=E+S,O=c(c(B*B)-H-q),R=k+q,D=R-G,_=k-q,v=c(O*D),A=c(R*_),P=c(O*_),U=c(D*R);return new h(v,A,U,P)}add(x){p(x);let{a:E,d:S}=i,{X:C,Y:H,Z:q,T:G}=this,{X:k,Y:B,Z:O,T:R}=x,D=c(C*k),_=c(H*B),v=c(G*S*R),A=c(q*O),P=c((C+H)*(k+B)-D-_),U=A-v,M=A+v,L=c(_-E*D),N=c(P*U),K=c(M*L),z=c(P*L),se=c(U*M);return new h(N,K,se,z)}subtract(x){return this.add(x.negate())}multiply(x){if(!o.isValidNot0(x))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:E,f:S}=w.cached(this,x,C=>(0,on.normalizeZ)(h,C));return(0,on.normalizeZ)(h,[E,S])[0]}multiplyUnsafe(x,E=h.ZERO){if(!o.isValid(x))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return x===Qt?h.ZERO:this.is0()||x===Te?this:w.unsafe(this,x,S=>(0,on.normalizeZ)(h,S),E)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return w.unsafe(this,i.n).is0()}toAffine(x){return d(this,x)}clearCofactor(){return a===Te?this:this.multiplyUnsafe(a)}toBytes(){let{x,y:E}=this.toAffine(),S=r.toBytes(E);return S[S.length-1]|=x&Te?128:0,S}toHex(){return(0,ce.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(x){return(0,on.normalizeZ)(h,x)}static msm(x,E){return(0,on.pippenger)(h,o,x,E)}_setWindowSize(x){this.precompute(x)}toRawBytes(){return this.toBytes()}}h.BASE=new h(i.Gx,i.Gy,Te,c(i.Gx*i.Gy)),h.ZERO=new h(Qt,Te,Te,Qt),h.Fp=r,h.Fn=o;let w=new on.wNAF(h,o.BITS);return h.BASE.precompute(8),h}s(Jc,"edwards");var As=class{static{s(this,"PrimeEdwardsPoint")}constructor(t){this.ep=t}static fromBytes(t){(0,ce.notImplemented)()}static fromHex(t){(0,ce.notImplemented)()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return(0,ce.bytesToHex)(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,n){return this.init(this.ep.precompute(t,n))}toRawBytes(){return this.toBytes()}};sn.PrimeEdwardsPoint=As;function eu(e,t,n={}){if(typeof t!="function")throw new Error('"hash" function param is required');(0,ce._validateObject)(n,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:r}=n,{BASE:o,Fp:i,Fn:a}=e,u=n.randomBytes||ce.randomBytes,c=n.adjustScalarBytes||(B=>B),l=n.domain||((B,O,R)=>{if((0,ce._abool2)(R,"phflag"),O.length||R)throw new Error("Contexts/pre-hash are not supported");return B});function f(B){return a.create((0,ce.bytesToNumberLE)(B))}s(f,"modN_LE");function p(B){let O=S.secretKey;B=(0,ce.ensureBytes)("private key",B,O);let R=(0,ce.ensureBytes)("hashed private key",t(B),2*O),D=c(R.slice(0,O)),_=R.slice(O,2*O),v=f(D);return{head:D,prefix:_,scalar:v}}s(p,"getPrivateScalar");function d(B){let{head:O,prefix:R,scalar:D}=p(B),_=o.multiply(D),v=_.toBytes();return{head:O,prefix:R,scalar:D,point:_,pointBytes:v}}s(d,"getExtendedPublicKey");function y(B){return d(B).pointBytes}s(y,"getPublicKey");function h(B=Uint8Array.of(),...O){let R=(0,ce.concatBytes)(...O);return f(t(l(R,(0,ce.ensureBytes)("context",B),!!r)))}s(h,"hashDomainToScalar");function w(B,O,R={}){B=(0,ce.ensureBytes)("message",B),r&&(B=r(B));let{prefix:D,scalar:_,pointBytes:v}=d(O),A=h(R.context,D,B),P=o.multiply(A).toBytes(),U=h(R.context,P,v,B),M=a.create(A+U*_);if(!a.isValid(M))throw new Error("sign failed: invalid s");let L=(0,ce.concatBytes)(P,a.toBytes(M));return(0,ce._abytes2)(L,S.signature,"result")}s(w,"sign");let m={zip215:!0};function x(B,O,R,D=m){let{context:_,zip215:v}=D,A=S.signature;B=(0,ce.ensureBytes)("signature",B,A),O=(0,ce.ensureBytes)("message",O),R=(0,ce.ensureBytes)("publicKey",R,S.publicKey),v!==void 0&&(0,ce._abool2)(v,"zip215"),r&&(O=r(O));let P=A/2,U=B.subarray(0,P),M=(0,ce.bytesToNumberLE)(B.subarray(P,A)),L,N,K;try{L=e.fromBytes(R,v),N=e.fromBytes(U,v),K=o.multiplyUnsafe(M)}catch{return!1}if(!v&&L.isSmallOrder())return!1;let z=h(_,N.toBytes(),L.toBytes(),O);return N.add(L.multiplyUnsafe(z)).subtract(K).clearCofactor().is0()}s(x,"verify");let E=i.BYTES,S={secretKey:E,publicKey:E,signature:2*E,seed:E};function C(B=u(S.seed)){return(0,ce._abytes2)(B,S.seed,"seed")}s(C,"randomSecretKey");function H(B){let O=k.randomSecretKey(B);return{secretKey:O,publicKey:y(O)}}s(H,"keygen");function q(B){return(0,ce.isBytes)(B)&&B.length===a.BYTES}s(q,"isValidSecretKey");function G(B,O){try{return!!e.fromBytes(B,O)}catch{return!1}}s(G,"isValidPublicKey");let k={getExtendedPublicKey:d,randomSecretKey:C,isValidSecretKey:q,isValidPublicKey:G,toMontgomery(B){let{y:O}=e.fromBytes(B),R=S.publicKey,D=R===32;if(!D&&R!==57)throw new Error("only defined for 25519 and 448");let _=D?i.div(Te+O,Te-O):i.div(O-Te,O+Te);return i.toBytes(_)},toMontgomerySecret(B){let O=S.secretKey;(0,ce._abytes2)(B,O);let R=t(B.subarray(0,O));return c(R).subarray(0,O)},randomPrivateKey:C,precompute(B=8,O=e.BASE){return O.precompute(B,!1)}};return Object.freeze({keygen:H,getPublicKey:y,sign:w,verify:x,utils:k,Point:e,lengths:S})}s(eu,"eddsa");function _p(e){let t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=(0,wp.Field)(t.n,e.nBitLength,!0),o={Fp:n,Fn:r,uvRatio:e.uvRatio},i={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:o,hash:e.hash,eddsaOpts:i}}s(_p,"_eddsa_legacy_opts_to_new");function vp(e,t){let n=t.Point;return Object.assign({},t,{ExtendedPoint:n,CURVE:e,nBitLength:n.Fn.BITS,nByteLength:n.Fn.BYTES})}s(vp,"_eddsa_new_output_to_legacy");function Sp(e){let{CURVE:t,curveOpts:n,hash:r,eddsaOpts:o}=_p(e),i=Jc(t,n),a=eu(i,r,o);return vp(e,a)}s(Sp,"twistedEdwards")});var Bs=re(xt=>{"use strict";g();b();Object.defineProperty(xt,"__esModule",{value:!0});xt._DST_scalar=void 0;xt.expand_message_xmd=ou;xt.expand_message_xof=su;xt.hash_to_field=Zr;xt.isogenyMap=Cp;xt.createHasher=Ip;var Le=Mt(),nu=Yt(),Ap=Le.bytesToNumberBE;function Xt(e,t){if(ar(e),ar(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);let n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=e&255,e>>>=8;return new Uint8Array(n)}s(Xt,"i2osp");function Bp(e,t){let n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}s(Bp,"strxor");function ar(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}s(ar,"anum");function ru(e){if(!(0,Le.isBytes)(e)&&typeof e!="string")throw new Error("DST must be Uint8Array or string");return typeof e=="string"?(0,Le.utf8ToBytes)(e):e}s(ru,"normDST");function ou(e,t,n,r){(0,Le.abytes)(e),ar(n),t=ru(t),t.length>255&&(t=r((0,Le.concatBytes)((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:o,blockLen:i}=r,a=Math.ceil(n/o);if(n>65535||a>255)throw new Error("expand_message_xmd: invalid lenInBytes");let u=(0,Le.concatBytes)(t,Xt(t.length,1)),c=Xt(0,i),l=Xt(n,2),f=new Array(a),p=r((0,Le.concatBytes)(c,e,l,Xt(0,1),u));f[0]=r((0,Le.concatBytes)(p,Xt(1,1),u));for(let y=1;y<=a;y++){let h=[Bp(p,f[y-1]),Xt(y+1,1),u];f[y]=r((0,Le.concatBytes)(...h))}return(0,Le.concatBytes)(...f).slice(0,n)}s(ou,"expand_message_xmd");function su(e,t,n,r,o){if((0,Le.abytes)(e),ar(n),t=ru(t),t.length>255){let i=Math.ceil(2*r/8);t=o.create({dkLen:i}).update((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:n}).update(e).update(Xt(n,2)).update(t).update(Xt(t.length,1)).digest()}s(su,"expand_message_xof");function Zr(e,t,n){(0,Le._validateObject)(n,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:r,k:o,m:i,hash:a,expand:u,DST:c}=n;if(!(0,Le.isHash)(n.hash))throw new Error("expected valid hash");(0,Le.abytes)(e),ar(t);let l=r.toString(2).length,f=Math.ceil((l+o)/8),p=t*i*f,d;if(u==="xmd")d=ou(e,c,p,a);else if(u==="xof")d=su(e,c,p,o,a);else if(u==="_internal_pass")d=e;else throw new Error('expand must be "xmd" or "xof"');let y=new Array(t);for(let h=0;h<t;h++){let w=new Array(i);for(let m=0;m<i;m++){let x=f*(m+h*i),E=d.subarray(x,x+f);w[m]=(0,nu.mod)(Ap(E),r)}y[h]=w}return y}s(Zr,"hash_to_field");function Cp(e,t){let n=t.map(r=>Array.from(r).reverse());return(r,o)=>{let[i,a,u,c]=n.map(p=>p.reduce((d,y)=>e.add(e.mul(d,r),y))),[l,f]=(0,nu.FpInvertBatch)(e,[a,c],!0);return r=e.mul(i,l),o=e.mul(o,e.mul(u,f)),{x:r,y:o}}}s(Cp,"isogenyMap");xt._DST_scalar=(0,Le.utf8ToBytes)("HashToScalar-");function Ip(e,t,n){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function r(i){return e.fromAffine(t(i))}s(r,"map");function o(i){let a=i.clearCofactor();return a.equals(e.ZERO)?e.ZERO:(a.assertValidity(),a)}return s(o,"clear"),{defaults:n,hashToCurve(i,a){let u=Object.assign({},n,a),c=Zr(i,2,u),l=r(c[0]),f=r(c[1]);return o(l.add(f))},encodeToCurve(i,a){let u=n.encodeDST?{DST:n.encodeDST}:{},c=Object.assign({},n,u,a),l=Zr(i,1,c),f=r(l[0]);return o(f)},mapToCurve(i){if(!Array.isArray(i))throw new Error("expected array of bigints");for(let a of i)if(typeof a!="bigint")throw new Error("expected array of bigints");return o(r(i))},hashToScalar(i,a){let u=e.Fn.ORDER,c=Object.assign({},n,{p:u,m:1,DST:xt._DST_scalar},a);return Zr(i,1,c)[0][0]}}}s(Ip,"createHasher")});var iu=re(Cs=>{"use strict";g();b();Object.defineProperty(Cs,"__esModule",{value:!0});Cs.montgomery=Op;var Et=Mt(),Tp=Yt(),cr=BigInt(0),Pn=BigInt(1),Yr=BigInt(2);function Lp(e){return(0,Et._validateObject)(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}s(Lp,"validateOpts");function Op(e){let t=Lp(e),{P:n,type:r,adjustScalarBytes:o,powPminus2:i,randomBytes:a}=t,u=r==="x25519";if(!u&&r!=="x448")throw new Error("invalid type");let c=a||Et.randomBytes,l=u?255:448,f=u?32:56,p=BigInt(u?9:5),d=BigInt(u?121665:39081),y=u?Yr**BigInt(254):Yr**BigInt(447),h=u?BigInt(8)*Yr**BigInt(251)-Pn:BigInt(4)*Yr**BigInt(445)-Pn,w=y+h+Pn,m=s(_=>(0,Tp.mod)(_,n),"modP"),x=E(p);function E(_){return(0,Et.numberToBytesLE)(m(_),f)}s(E,"encodeU");function S(_){let v=(0,Et.ensureBytes)("u coordinate",_,f);return u&&(v[31]&=127),m((0,Et.bytesToNumberLE)(v))}s(S,"decodeU");function C(_){return(0,Et.bytesToNumberLE)(o((0,Et.ensureBytes)("scalar",_,f)))}s(C,"decodeScalar");function H(_,v){let A=k(S(v),C(_));if(A===cr)throw new Error("invalid private or public key received");return E(A)}s(H,"scalarMult");function q(_){return H(_,x)}s(q,"scalarMultBase");function G(_,v,A){let P=m(_*(v-A));return v=m(v-P),A=m(A+P),{x_2:v,x_3:A}}s(G,"cswap");function k(_,v){(0,Et.aInRange)("u",_,cr,n),(0,Et.aInRange)("scalar",v,y,w);let A=v,P=_,U=Pn,M=cr,L=_,N=Pn,K=cr;for(let se=BigInt(l-1);se>=cr;se--){let ie=A>>se&Pn;K^=ie,{x_2:U,x_3:L}=G(K,U,L),{x_2:M,x_3:N}=G(K,M,N),K=ie;let J=U+M,ue=m(J*J),pe=U-M,be=m(pe*pe),fe=ue-be,Ie=L+N,hn=L-N,$n=m(hn*J),Zn=m(Ie*pe),fi=$n+Zn,di=$n-Zn;L=m(fi*fi),N=m(P*m(di*di)),U=m(ue*be),M=m(fe*(ue+m(d*fe)))}({x_2:U,x_3:L}=G(K,U,L)),{x_2:M,x_3:N}=G(K,M,N);let z=i(M);return m(U*z)}s(k,"montgomeryLadder");let B={secretKey:f,publicKey:f,seed:f},O=s((_=c(f))=>((0,Et.abytes)(_,B.seed),_),"randomSecretKey");function R(_){let v=O(_);return{secretKey:v,publicKey:q(v)}}return s(R,"keygen"),{keygen:R,getSharedSecret:s((_,v)=>H(_,v),"getSharedSecret"),getPublicKey:s(_=>q(_),"getPublicKey"),scalarMult:H,scalarMultBase:q,utils:{randomSecretKey:O,randomPrivateKey:O},GuBytes:x.slice(),lengths:B}}s(Op,"montgomery")});var bu=re(Q=>{"use strict";g();b();Object.defineProperty(Q,"__esModule",{value:!0});Q.hash_to_ristretto255=Q.hashToRistretto255=Q.encodeToCurve=Q.hashToCurve=Q.RistrettoPoint=Q.edwardsToMontgomery=Q.ED25519_TORSION_SUBGROUP=Q.ristretto255_hasher=Q.ristretto255=Q.ed25519_hasher=Q.x25519=Q.ed25519ph=Q.ed25519ctx=Q.ed25519=void 0;Q.edwardsToMontgomeryPub=gu;Q.edwardsToMontgomeryPriv=zp;var ur=Fr(),Xr=gt(),Pp=$r(),eo=tu(),Qr=Bs(),de=Yt(),Up=iu(),an=Mt(),Rp=BigInt(0),_t=BigInt(1),Jr=BigInt(2),lu=BigInt(3),fu=BigInt(5),Os=BigInt(8),Ht=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),lr={p:Ht,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Os,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function du(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),i=Ht,u=e*e%i*e%i,c=(0,de.pow2)(u,Jr,i)*u%i,l=(0,de.pow2)(c,_t,i)*e%i,f=(0,de.pow2)(l,fu,i)*l%i,p=(0,de.pow2)(f,t,i)*f%i,d=(0,de.pow2)(p,n,i)*p%i,y=(0,de.pow2)(d,r,i)*d%i,h=(0,de.pow2)(y,o,i)*y%i,w=(0,de.pow2)(h,o,i)*y%i,m=(0,de.pow2)(w,t,i)*f%i;return{pow_p_5_8:(0,de.pow2)(m,Jr,i)*e%i,b2:u}}s(du,"ed25519_pow_2_252_3");function pu(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}s(pu,"adjustScalarBytes");var Is=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Ps(e,t){let n=Ht,r=(0,de.mod)(t*t*t,n),o=(0,de.mod)(r*r*t,n),i=du(e*o).pow_p_5_8,a=(0,de.mod)(e*r*i,n),u=(0,de.mod)(t*a*a,n),c=a,l=(0,de.mod)(a*Is,n),f=u===e,p=u===(0,de.mod)(-e,n),d=u===(0,de.mod)(-e*Is,n);return f&&(a=c),(p||d)&&(a=l),(0,de.isNegativeLE)(a,n)&&(a=(0,de.mod)(-a,n)),{isValid:f||p,value:a}}s(Ps,"uvRatio");var F=(0,de.Field)(lr.p,{isLE:!0}),hu=(0,de.Field)(lr.n,{isLE:!0}),Us={...lr,Fp:F,hash:ur.sha512,adjustScalarBytes:pu,uvRatio:Ps};Q.ed25519=(0,eo.twistedEdwards)(Us);function yu(e,t,n){if(t.length>255)throw new Error("Context is too big");return(0,Xr.concatBytes)((0,Xr.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}s(yu,"ed25519_domain");Q.ed25519ctx=(0,eo.twistedEdwards)({...Us,domain:yu});Q.ed25519ph=(0,eo.twistedEdwards)(Object.assign({},Us,{domain:yu,prehash:ur.sha512}));Q.x25519=(()=>{let e=F.ORDER;return(0,Up.montgomery)({P:e,type:"x25519",powPminus2:s(t=>{let{pow_p_5_8:n,b2:r}=du(t);return(0,de.mod)((0,de.pow2)(n,lu,e)*r,e)},"powPminus2"),adjustScalarBytes:pu})})();var Dp=(Ht+lu)/Os,Np=F.pow(Jr,Dp),au=F.sqrt(F.neg(F.ONE));function Mp(e){let t=(Ht-fu)/Os,n=BigInt(486662),r=F.sqr(e);r=F.mul(r,Jr);let o=F.add(r,F.ONE),i=F.neg(n),a=F.sqr(o),u=F.mul(a,o),c=F.mul(r,n);c=F.mul(c,i),c=F.add(c,a),c=F.mul(c,i);let l=F.sqr(u);a=F.sqr(l),l=F.mul(l,u),l=F.mul(l,c),a=F.mul(a,l);let f=F.pow(a,t);f=F.mul(f,l);let p=F.mul(f,au);a=F.sqr(f),a=F.mul(a,u);let d=F.eql(a,c),y=F.cmov(p,f,d),h=F.mul(i,r),w=F.mul(f,e);w=F.mul(w,Np);let m=F.mul(w,au),x=F.mul(c,r);a=F.sqr(w),a=F.mul(a,u);let E=F.eql(a,x),S=F.cmov(m,w,E);a=F.sqr(y),a=F.mul(a,u);let C=F.eql(a,c),H=F.cmov(h,i,C),q=F.cmov(S,y,C),G=F.isOdd(q);return q=F.cmov(q,F.neg(q),C!==G),{xMn:H,xMd:o,yMn:q,yMd:_t}}s(Mp,"map_to_curve_elligator2_curve25519");var Hp=(0,de.FpSqrtEven)(F,F.neg(BigInt(486664)));function Kp(e){let{xMn:t,xMd:n,yMn:r,yMd:o}=Mp(e),i=F.mul(t,o);i=F.mul(i,Hp);let a=F.mul(n,r),u=F.sub(t,n),c=F.add(t,n),l=F.mul(a,c),f=F.eql(l,F.ZERO);i=F.cmov(i,F.ZERO,f),a=F.cmov(a,F.ONE,f),u=F.cmov(u,F.ONE,f),c=F.cmov(c,F.ONE,f);let[p,d]=(0,de.FpInvertBatch)(F,[a,c],!0);return{x:F.mul(i,p),y:F.mul(u,d)}}s(Kp,"map_to_curve_elligator2_edwards25519");Q.ed25519_hasher=(0,Qr.createHasher)(Q.ed25519.Point,e=>Kp(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:Ht,m:1,k:128,expand:"xmd",hash:ur.sha512});var Ts=Is,qp=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),kp=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Vp=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Fp=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),cu=s(e=>Ps(_t,e),"invertSqrt"),jp=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Ls=s(e=>Q.ed25519.Point.Fp.create((0,an.bytesToNumberLE)(e)&jp),"bytes255ToNumberLE");function uu(e){let{d:t}=lr,n=Ht,r=s(x=>F.create(x),"mod"),o=r(Ts*e*e),i=r((o+_t)*Vp),a=BigInt(-1),u=r((a-t*o)*r(o+t)),{isValid:c,value:l}=Ps(i,u),f=r(l*e);(0,de.isNegativeLE)(f,n)||(f=r(-f)),c||(l=f),c||(a=o);let p=r(a*(o-_t)*Fp-u),d=l*l,y=r((l+l)*u),h=r(p*qp),w=r(_t-d),m=r(_t+d);return new Q.ed25519.Point(r(y*m),r(w*h),r(h*m),r(y*w))}s(uu,"calcElligatorRistrettoMap");function mu(e){(0,Xr.abytes)(e,64);let t=Ls(e.subarray(0,32)),n=uu(t),r=Ls(e.subarray(32,64)),o=uu(r);return new lt(n.add(o))}s(mu,"ristretto255_map");var lt=class e extends eo.PrimeEdwardsPoint{static{s(this,"_RistrettoPoint")}constructor(t){super(t)}static fromAffine(t){return new e(Q.ed25519.Point.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static hashToCurve(t){return mu((0,an.ensureBytes)("ristrettoHash",t,64))}static fromBytes(t){(0,Xr.abytes)(t,32);let{a:n,d:r}=lr,o=Ht,i=s(C=>F.create(C),"mod"),a=Ls(t);if(!(0,an.equalBytes)(F.toBytes(a),t)||(0,de.isNegativeLE)(a,o))throw new Error("invalid ristretto255 encoding 1");let u=i(a*a),c=i(_t+n*u),l=i(_t-n*u),f=i(c*c),p=i(l*l),d=i(n*r*f-p),{isValid:y,value:h}=cu(i(d*p)),w=i(h*l),m=i(h*w*d),x=i((a+a)*w);(0,de.isNegativeLE)(x,o)&&(x=i(-x));let E=i(c*m),S=i(x*E);if(!y||(0,de.isNegativeLE)(S,o)||E===Rp)throw new Error("invalid ristretto255 encoding 2");return new e(new Q.ed25519.Point(x,E,_t,S))}static fromHex(t){return e.fromBytes((0,an.ensureBytes)("ristrettoHex",t,32))}static msm(t,n){return(0,Pp.pippenger)(e,Q.ed25519.Point.Fn,t,n)}toBytes(){let{X:t,Y:n,Z:r,T:o}=this.ep,i=Ht,a=s(m=>F.create(m),"mod"),u=a(a(r+n)*a(r-n)),c=a(t*n),l=a(c*c),{value:f}=cu(a(u*l)),p=a(f*u),d=a(f*c),y=a(p*d*o),h;if((0,de.isNegativeLE)(o*y,i)){let m=a(n*Ts),x=a(t*Ts);t=m,n=x,h=a(p*kp)}else h=d;(0,de.isNegativeLE)(t*y,i)&&(n=a(-n));let w=a((r-n)*h);return(0,de.isNegativeLE)(w,i)&&(w=a(-w)),F.toBytes(w)}equals(t){this.assertSame(t);let{X:n,Y:r}=this.ep,{X:o,Y:i}=t.ep,a=s(l=>F.create(l),"mod"),u=a(n*i)===a(r*o),c=a(r*i)===a(n*o);return u||c}is0(){return this.equals(e.ZERO)}};lt.BASE=new lt(Q.ed25519.Point.BASE);lt.ZERO=new lt(Q.ed25519.Point.ZERO);lt.Fp=F;lt.Fn=hu;Q.ristretto255={Point:lt};Q.ristretto255_hasher={hashToCurve(e,t){let n=t?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_",r=(0,Qr.expand_message_xmd)(e,n,64,ur.sha512);return mu(r)},hashToScalar(e,t={DST:Qr._DST_scalar}){let n=(0,Qr.expand_message_xmd)(e,t.DST,64,ur.sha512);return hu.create((0,an.bytesToNumberLE)(n))}};Q.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];function gu(e){return Q.ed25519.utils.toMontgomery((0,an.ensureBytes)("pub",e))}s(gu,"edwardsToMontgomeryPub");Q.edwardsToMontgomery=gu;function zp(e){return Q.ed25519.utils.toMontgomerySecret((0,an.ensureBytes)("pub",e))}s(zp,"edwardsToMontgomeryPriv");Q.RistrettoPoint=lt;Q.hashToCurve=Q.ed25519_hasher.hashToCurve;Q.encodeToCurve=Q.ed25519_hasher.encodeToCurve;Q.hashToRistretto255=Q.ristretto255_hasher.hashToCurve;Q.hash_to_ristretto255=Q.ristretto255_hasher.hashToCurve});var Rs=re(un=>{"use strict";g();b();Object.defineProperty(un,"__esModule",{value:!0});un.hmac=un.HMAC=void 0;var cn=gt(),fr=class extends cn.Hash{static{s(this,"HMAC")}constructor(t,n){super(),this.finished=!1,this.destroyed=!1,(0,cn.ahash)(t);let r=(0,cn.toBytes)(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?t.create().update(r).digest():r);for(let a=0;a<i.length;a++)i[a]^=54;this.iHash.update(i),this.oHash=t.create();for(let a=0;a<i.length;a++)i[a]^=106;this.oHash.update(i),(0,cn.clean)(i)}update(t){return(0,cn.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,cn.aexists)(this),(0,cn.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:a,outputLen:u}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=a,t.outputLen=u,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};un.HMAC=fr;var Gp=s((e,t,n)=>new fr(e,t).update(n).digest(),"hmac");un.hmac=Gp;un.hmac.create=(e,t)=>new fr(e,t)});var Ks=re(ge=>{"use strict";g();b();Object.defineProperty(ge,"__esModule",{value:!0});ge.DER=ge.DERErr=void 0;ge._splitEndoScalar=xu;ge._normFnElement=Jt;ge.weierstrassN=Hs;ge.SWUFpSqrtRatio=_u;ge.mapToCurveSimpleSWU=Zp;ge.ecdh=Su;ge.ecdsa=Au;ge.weierstrassPoints=Yp;ge._legacyHelperEquat=Cu;ge.weierstrass=eh;var Wp=Rs(),$p=gt(),W=Mt(),Kt=$r(),Rn=Yt(),wu=s((e,t)=>(e+(e>=0?t:-t)/vt)/t,"divNearest");function xu(e,t,n){let[[r,o],[i,a]]=t,u=wu(a*e,n),c=wu(-o*e,n),l=e-u*r-c*i,f=-u*o-c*a,p=l<ft,d=f<ft;p&&(l=-l),d&&(f=-f);let y=(0,W.bitMask)(Math.ceil((0,W.bitLen)(n)/2))+Oe;if(l<ft||l>=y||f<ft||f>=y)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:p,k1:l,k2neg:d,k2:f}}s(xu,"_splitEndoScalar");function Ns(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}s(Ns,"validateSigFormat");function Ds(e,t){let n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return(0,W._abool2)(n.lowS,"lowS"),(0,W._abool2)(n.prehash,"prehash"),n.format!==void 0&&Ns(n.format),n}s(Ds,"validateSigOpts");var to=class extends Error{static{s(this,"DERErr")}constructor(t=""){super(t)}};ge.DERErr=to;ge.DER={Err:to,_tlv:{encode:s((e,t)=>{let{Err:n}=ge.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");let r=t.length/2,o=(0,W.numberToHexUnpadded)(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");let i=r>127?(0,W.numberToHexUnpadded)(o.length/2|128):"";return(0,W.numberToHexUnpadded)(e)+i+o+t},"encode"),decode(e,t){let{Err:n}=ge.DER,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");let o=t[r++],i=!!(o&128),a=0;if(!i)a=o;else{let c=o&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");let l=t.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(let f of l)a=a<<8|f;if(r+=c,a<128)throw new n("tlv.decode(long): not minimal encoding")}let u=t.subarray(r,r+a);if(u.length!==a)throw new n("tlv.decode: wrong value length");return{v:u,l:t.subarray(r+a)}}},_int:{encode(e){let{Err:t}=ge.DER;if(e<ft)throw new t("integer: negative integers are not allowed");let n=(0,W.numberToHexUnpadded)(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){let{Err:t}=ge.DER;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return(0,W.bytesToNumberBE)(e)}},toSig(e){let{Err:t,_int:n,_tlv:r}=ge.DER,o=(0,W.ensureBytes)("signature",e),{v:i,l:a}=r.decode(48,o);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:u,l:c}=r.decode(2,i),{v:l,l:f}=r.decode(2,c);if(f.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(u),s:n.decode(l)}},hexFromSig(e){let{_tlv:t,_int:n}=ge.DER,r=t.encode(2,n.encode(e.r)),o=t.encode(2,n.encode(e.s)),i=r+o;return t.encode(48,i)}};var ft=BigInt(0),Oe=BigInt(1),vt=BigInt(2),Un=BigInt(3),Ms=BigInt(4);function Jt(e,t){let{BYTES:n}=e,r;if(typeof t=="bigint")r=t;else{let o=(0,W.ensureBytes)("private key",t);try{r=e.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}s(Jt,"_normFnElement");function Hs(e,t={}){let n=(0,Kt._createCurveFields)("weierstrass",e,t),{Fp:r,Fn:o}=n,i=n.CURVE,{h:a,n:u}=i;(0,W._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:c}=t;if(c&&(!r.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let l=vu(r,o);function f(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}s(f,"assertCompressionIsSupported");function p(D,_,v){let{x:A,y:P}=_.toAffine(),U=r.toBytes(A);if((0,W._abool2)(v,"isCompressed"),v){f();let M=!r.isOdd(P);return(0,W.concatBytes)(Eu(M),U)}else return(0,W.concatBytes)(Uint8Array.of(4),U,r.toBytes(P))}s(p,"pointToBytes");function d(D){(0,W._abytes2)(D,void 0,"Point");let{publicKey:_,publicKeyUncompressed:v}=l,A=D.length,P=D[0],U=D.subarray(1);if(A===_&&(P===2||P===3)){let M=r.fromBytes(U);if(!r.isValid(M))throw new Error("bad point: is not on curve, wrong x");let L=w(M),N;try{N=r.sqrt(L)}catch(se){let ie=se instanceof Error?": "+se.message:"";throw new Error("bad point: is not on curve, sqrt error"+ie)}f();let K=r.isOdd(N);return(P&1)===1!==K&&(N=r.neg(N)),{x:M,y:N}}else if(A===v&&P===4){let M=r.BYTES,L=r.fromBytes(U.subarray(0,M)),N=r.fromBytes(U.subarray(M,M*2));if(!m(L,N))throw new Error("bad point: is not on curve");return{x:L,y:N}}else throw new Error(`bad point: got length ${A}, expected compressed=${_} or uncompressed=${v}`)}s(d,"pointFromBytes");let y=t.toBytes||p,h=t.fromBytes||d;function w(D){let _=r.sqr(D),v=r.mul(_,D);return r.add(r.add(v,r.mul(D,i.a)),i.b)}s(w,"weierstrassEquation");function m(D,_){let v=r.sqr(_),A=w(D);return r.eql(v,A)}if(s(m,"isValidXY"),!m(i.Gx,i.Gy))throw new Error("bad curve params: generator point");let x=r.mul(r.pow(i.a,Un),Ms),E=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(x,E)))throw new Error("bad curve params: a or b");function S(D,_,v=!1){if(!r.isValid(_)||v&&r.is0(_))throw new Error(`bad point coordinate ${D}`);return _}s(S,"acoord");function C(D){if(!(D instanceof B))throw new Error("ProjectivePoint expected")}s(C,"aprjpoint");function H(D){if(!c||!c.basises)throw new Error("no endo");return xu(D,c.basises,o.ORDER)}s(H,"splitEndoScalarN");let q=(0,W.memoized)((D,_)=>{let{X:v,Y:A,Z:P}=D;if(r.eql(P,r.ONE))return{x:v,y:A};let U=D.is0();_==null&&(_=U?r.ONE:r.inv(P));let M=r.mul(v,_),L=r.mul(A,_),N=r.mul(P,_);if(U)return{x:r.ZERO,y:r.ZERO};if(!r.eql(N,r.ONE))throw new Error("invZ was invalid");return{x:M,y:L}}),G=(0,W.memoized)(D=>{if(D.is0()){if(t.allowInfinityPoint&&!r.is0(D.Y))return;throw new Error("bad point: ZERO")}let{x:_,y:v}=D.toAffine();if(!r.isValid(_)||!r.isValid(v))throw new Error("bad point: x or y not field elements");if(!m(_,v))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function k(D,_,v,A,P){return v=new B(r.mul(v.X,D),v.Y,v.Z),_=(0,Kt.negateCt)(A,_),v=(0,Kt.negateCt)(P,v),_.add(v)}s(k,"finishEndo");class B{static{s(this,"Point")}constructor(_,v,A){this.X=S("x",_),this.Y=S("y",v,!0),this.Z=S("z",A),Object.freeze(this)}static CURVE(){return i}static fromAffine(_){let{x:v,y:A}=_||{};if(!_||!r.isValid(v)||!r.isValid(A))throw new Error("invalid affine point");if(_ instanceof B)throw new Error("projective point not allowed");return r.is0(v)&&r.is0(A)?B.ZERO:new B(v,A,r.ONE)}static fromBytes(_){let v=B.fromAffine(h((0,W._abytes2)(_,void 0,"point")));return v.assertValidity(),v}static fromHex(_){return B.fromBytes((0,W.ensureBytes)("pointHex",_))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(_=8,v=!0){return R.createCache(this,_),v||this.multiply(Un),this}assertValidity(){G(this)}hasEvenY(){let{y:_}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(_)}equals(_){C(_);let{X:v,Y:A,Z:P}=this,{X:U,Y:M,Z:L}=_,N=r.eql(r.mul(v,L),r.mul(U,P)),K=r.eql(r.mul(A,L),r.mul(M,P));return N&&K}negate(){return new B(this.X,r.neg(this.Y),this.Z)}double(){let{a:_,b:v}=i,A=r.mul(v,Un),{X:P,Y:U,Z:M}=this,L=r.ZERO,N=r.ZERO,K=r.ZERO,z=r.mul(P,P),se=r.mul(U,U),ie=r.mul(M,M),J=r.mul(P,U);return J=r.add(J,J),K=r.mul(P,M),K=r.add(K,K),L=r.mul(_,K),N=r.mul(A,ie),N=r.add(L,N),L=r.sub(se,N),N=r.add(se,N),N=r.mul(L,N),L=r.mul(J,L),K=r.mul(A,K),ie=r.mul(_,ie),J=r.sub(z,ie),J=r.mul(_,J),J=r.add(J,K),K=r.add(z,z),z=r.add(K,z),z=r.add(z,ie),z=r.mul(z,J),N=r.add(N,z),ie=r.mul(U,M),ie=r.add(ie,ie),z=r.mul(ie,J),L=r.sub(L,z),K=r.mul(ie,se),K=r.add(K,K),K=r.add(K,K),new B(L,N,K)}add(_){C(_);let{X:v,Y:A,Z:P}=this,{X:U,Y:M,Z:L}=_,N=r.ZERO,K=r.ZERO,z=r.ZERO,se=i.a,ie=r.mul(i.b,Un),J=r.mul(v,U),ue=r.mul(A,M),pe=r.mul(P,L),be=r.add(v,A),fe=r.add(U,M);be=r.mul(be,fe),fe=r.add(J,ue),be=r.sub(be,fe),fe=r.add(v,P);let Ie=r.add(U,L);return fe=r.mul(fe,Ie),Ie=r.add(J,pe),fe=r.sub(fe,Ie),Ie=r.add(A,P),N=r.add(M,L),Ie=r.mul(Ie,N),N=r.add(ue,pe),Ie=r.sub(Ie,N),z=r.mul(se,fe),N=r.mul(ie,pe),z=r.add(N,z),N=r.sub(ue,z),z=r.add(ue,z),K=r.mul(N,z),ue=r.add(J,J),ue=r.add(ue,J),pe=r.mul(se,pe),fe=r.mul(ie,fe),ue=r.add(ue,pe),pe=r.sub(J,pe),pe=r.mul(se,pe),fe=r.add(fe,pe),J=r.mul(ue,fe),K=r.add(K,J),J=r.mul(Ie,fe),N=r.mul(be,N),N=r.sub(N,J),J=r.mul(be,ue),z=r.mul(Ie,z),z=r.add(z,J),new B(N,K,z)}subtract(_){return this.add(_.negate())}is0(){return this.equals(B.ZERO)}multiply(_){let{endo:v}=t;if(!o.isValidNot0(_))throw new Error("invalid scalar: out of range");let A,P,U=s(M=>R.cached(this,M,L=>(0,Kt.normalizeZ)(B,L)),"mul");if(v){let{k1neg:M,k1:L,k2neg:N,k2:K}=H(_),{p:z,f:se}=U(L),{p:ie,f:J}=U(K);P=se.add(J),A=k(v.beta,z,ie,M,N)}else{let{p:M,f:L}=U(_);A=M,P=L}return(0,Kt.normalizeZ)(B,[A,P])[0]}multiplyUnsafe(_){let{endo:v}=t,A=this;if(!o.isValid(_))throw new Error("invalid scalar: out of range");if(_===ft||A.is0())return B.ZERO;if(_===Oe)return A;if(R.hasCache(this))return this.multiply(_);if(v){let{k1neg:P,k1:U,k2neg:M,k2:L}=H(_),{p1:N,p2:K}=(0,Kt.mulEndoUnsafe)(B,A,U,L);return k(v.beta,N,K,P,M)}else return R.unsafe(A,_)}multiplyAndAddUnsafe(_,v,A){let P=this.multiplyUnsafe(v).add(_.multiplyUnsafe(A));return P.is0()?void 0:P}toAffine(_){return q(this,_)}isTorsionFree(){let{isTorsionFree:_}=t;return a===Oe?!0:_?_(B,this):R.unsafe(this,u).is0()}clearCofactor(){let{clearCofactor:_}=t;return a===Oe?this:_?_(B,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(_=!0){return(0,W._abool2)(_,"isCompressed"),this.assertValidity(),y(B,this,_)}toHex(_=!0){return(0,W.bytesToHex)(this.toBytes(_))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(_=!0){return this.toBytes(_)}_setWindowSize(_){this.precompute(_)}static normalizeZ(_){return(0,Kt.normalizeZ)(B,_)}static msm(_,v){return(0,Kt.pippenger)(B,o,_,v)}static fromPrivateKey(_){return B.BASE.multiply(Jt(o,_))}}B.BASE=new B(i.Gx,i.Gy,r.ONE),B.ZERO=new B(r.ZERO,r.ONE,r.ZERO),B.Fp=r,B.Fn=o;let O=o.BITS,R=new Kt.wNAF(B,t.endo?Math.ceil(O/2):O);return B.BASE.precompute(8),B}s(Hs,"weierstrassN");function Eu(e){return Uint8Array.of(e?2:3)}s(Eu,"pprefix");function _u(e,t){let n=e.ORDER,r=ft;for(let h=n-Oe;h%vt===ft;h/=vt)r+=Oe;let o=r,i=vt<<o-Oe-Oe,a=i*vt,u=(n-Oe)/a,c=(u-Oe)/vt,l=a-Oe,f=i,p=e.pow(t,u),d=e.pow(t,(u+Oe)/vt),y=s((h,w)=>{let m=p,x=e.pow(w,l),E=e.sqr(x);E=e.mul(E,w);let S=e.mul(h,E);S=e.pow(S,c),S=e.mul(S,x),x=e.mul(S,w),E=e.mul(S,h);let C=e.mul(E,x);S=e.pow(C,f);let H=e.eql(S,e.ONE);x=e.mul(E,d),S=e.mul(C,m),E=e.cmov(x,E,H),C=e.cmov(S,C,H);for(let q=o;q>Oe;q--){let G=q-vt;G=vt<<G-Oe;let k=e.pow(C,G),B=e.eql(k,e.ONE);x=e.mul(E,m),m=e.mul(m,m),k=e.mul(C,m),E=e.cmov(x,E,B),C=e.cmov(k,C,B)}return{isValid:H,value:E}},"sqrtRatio");if(e.ORDER%Ms===Un){let h=(e.ORDER-Un)/Ms,w=e.sqrt(e.neg(t));y=s((m,x)=>{let E=e.sqr(x),S=e.mul(m,x);E=e.mul(E,S);let C=e.pow(E,h);C=e.mul(C,S);let H=e.mul(C,w),q=e.mul(e.sqr(C),x),G=e.eql(q,m),k=e.cmov(H,C,G);return{isValid:G,value:k}},"sqrtRatio")}return y}s(_u,"SWUFpSqrtRatio");function Zp(e,t){(0,Rn.validateField)(e);let{A:n,B:r,Z:o}=t;if(!e.isValid(n)||!e.isValid(r)||!e.isValid(o))throw new Error("mapToCurveSimpleSWU: invalid opts");let i=_u(e,o);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return a=>{let u,c,l,f,p,d,y,h;u=e.sqr(a),u=e.mul(u,o),c=e.sqr(u),c=e.add(c,u),l=e.add(c,e.ONE),l=e.mul(l,r),f=e.cmov(o,e.neg(c),!e.eql(c,e.ZERO)),f=e.mul(f,n),c=e.sqr(l),d=e.sqr(f),p=e.mul(d,n),c=e.add(c,p),c=e.mul(c,l),d=e.mul(d,f),p=e.mul(d,r),c=e.add(c,p),y=e.mul(u,l);let{isValid:w,value:m}=i(c,d);h=e.mul(u,a),h=e.mul(h,m),y=e.cmov(y,l,w),h=e.cmov(h,m,w);let x=e.isOdd(a)===e.isOdd(h);h=e.cmov(e.neg(h),h,x);let E=(0,Rn.FpInvertBatch)(e,[f],!0)[0];return y=e.mul(y,E),{x:y,y:h}}}s(Zp,"mapToCurveSimpleSWU");function vu(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}s(vu,"getWLengths");function Su(e,t={}){let{Fn:n}=e,r=t.randomBytes||W.randomBytes,o=Object.assign(vu(e.Fp,n),{seed:(0,Rn.getMinHashLength)(n.ORDER)});function i(y){try{return!!Jt(n,y)}catch{return!1}}s(i,"isValidSecretKey");function a(y,h){let{publicKey:w,publicKeyUncompressed:m}=o;try{let x=y.length;return h===!0&&x!==w||h===!1&&x!==m?!1:!!e.fromBytes(y)}catch{return!1}}s(a,"isValidPublicKey");function u(y=r(o.seed)){return(0,Rn.mapHashToField)((0,W._abytes2)(y,o.seed,"seed"),n.ORDER)}s(u,"randomSecretKey");function c(y,h=!0){return e.BASE.multiply(Jt(n,y)).toBytes(h)}s(c,"getPublicKey");function l(y){let h=u(y);return{secretKey:h,publicKey:c(h)}}s(l,"keygen");function f(y){if(typeof y=="bigint")return!1;if(y instanceof e)return!0;let{secretKey:h,publicKey:w,publicKeyUncompressed:m}=o;if(n.allowedLengths||h===w)return;let x=(0,W.ensureBytes)("key",y).length;return x===w||x===m}s(f,"isProbPub");function p(y,h,w=!0){if(f(y)===!0)throw new Error("first arg must be private key");if(f(h)===!1)throw new Error("second arg must be public key");let m=Jt(n,y);return e.fromHex(h).multiply(m).toBytes(w)}return s(p,"getSharedSecret"),Object.freeze({getPublicKey:c,getSharedSecret:p,keygen:l,Point:e,utils:{isValidSecretKey:i,isValidPublicKey:a,randomSecretKey:u,isValidPrivateKey:i,randomPrivateKey:u,normPrivateKeyToScalar:s(y=>Jt(n,y),"normPrivateKeyToScalar"),precompute(y=8,h=e.BASE){return h.precompute(y,!1)}},lengths:o})}s(Su,"ecdh");function Au(e,t,n={}){(0,$p.ahash)(t),(0,W._validateObject)(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let r=n.randomBytes||W.randomBytes,o=n.hmac||((v,...A)=>(0,Wp.hmac)(t,v,(0,W.concatBytes)(...A))),{Fp:i,Fn:a}=e,{ORDER:u,BITS:c}=a,{keygen:l,getPublicKey:f,getSharedSecret:p,utils:d,lengths:y}=Su(e,n),h={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},w="compact";function m(v){let A=u>>Oe;return v>A}s(m,"isBiggerThanHalfOrder");function x(v,A){if(!a.isValidNot0(A))throw new Error(`invalid signature ${v}: out of range 1..Point.Fn.ORDER`);return A}s(x,"validateRS");function E(v,A){Ns(A);let P=y.signature,U=A==="compact"?P:A==="recovered"?P+1:void 0;return(0,W._abytes2)(v,U,`${A} signature`)}s(E,"validateSigLength");class S{static{s(this,"Signature")}constructor(A,P,U){this.r=x("r",A),this.s=x("s",P),U!=null&&(this.recovery=U),Object.freeze(this)}static fromBytes(A,P=w){E(A,P);let U;if(P==="der"){let{r:K,s:z}=ge.DER.toSig((0,W._abytes2)(A));return new S(K,z)}P==="recovered"&&(U=A[0],P="compact",A=A.subarray(1));let M=a.BYTES,L=A.subarray(0,M),N=A.subarray(M,M*2);return new S(a.fromBytes(L),a.fromBytes(N),U)}static fromHex(A,P){return this.fromBytes((0,W.hexToBytes)(A),P)}addRecoveryBit(A){return new S(this.r,this.s,A)}recoverPublicKey(A){let P=i.ORDER,{r:U,s:M,recovery:L}=this;if(L==null||![0,1,2,3].includes(L))throw new Error("recovery id invalid");if(u*vt<P&&L>1)throw new Error("recovery id is ambiguous for h>1 curve");let K=L===2||L===3?U+u:U;if(!i.isValid(K))throw new Error("recovery id 2 or 3 invalid");let z=i.toBytes(K),se=e.fromBytes((0,W.concatBytes)(Eu((L&1)===0),z)),ie=a.inv(K),J=H((0,W.ensureBytes)("msgHash",A)),ue=a.create(-J*ie),pe=a.create(M*ie),be=e.BASE.multiplyUnsafe(ue).add(se.multiplyUnsafe(pe));if(be.is0())throw new Error("point at infinify");return be.assertValidity(),be}hasHighS(){return m(this.s)}toBytes(A=w){if(Ns(A),A==="der")return(0,W.hexToBytes)(ge.DER.hexFromSig(this));let P=a.toBytes(this.r),U=a.toBytes(this.s);if(A==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return(0,W.concatBytes)(Uint8Array.of(this.recovery),P,U)}return(0,W.concatBytes)(P,U)}toHex(A){return(0,W.bytesToHex)(this.toBytes(A))}assertValidity(){}static fromCompact(A){return S.fromBytes((0,W.ensureBytes)("sig",A),"compact")}static fromDER(A){return S.fromBytes((0,W.ensureBytes)("sig",A),"der")}normalizeS(){return this.hasHighS()?new S(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,W.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,W.bytesToHex)(this.toBytes("compact"))}}let C=n.bits2int||s(function(A){if(A.length>8192)throw new Error("input is too large");let P=(0,W.bytesToNumberBE)(A),U=A.length*8-c;return U>0?P>>BigInt(U):P},"bits2int_def"),H=n.bits2int_modN||s(function(A){return a.create(C(A))},"bits2int_modN_def"),q=(0,W.bitMask)(c);function G(v){return(0,W.aInRange)("num < 2^"+c,v,ft,q),a.toBytes(v)}s(G,"int2octets");function k(v,A){return(0,W._abytes2)(v,void 0,"message"),A?(0,W._abytes2)(t(v),void 0,"prehashed message"):v}s(k,"validateMsgAndHash");function B(v,A,P){if(["recovered","canonical"].some(ue=>ue in P))throw new Error("sign() legacy options not supported");let{lowS:U,prehash:M,extraEntropy:L}=Ds(P,h);v=k(v,M);let N=H(v),K=Jt(a,A),z=[G(K),G(N)];if(L!=null&&L!==!1){let ue=L===!0?r(y.secretKey):L;z.push((0,W.ensureBytes)("extraEntropy",ue))}let se=(0,W.concatBytes)(...z),ie=N;function J(ue){let pe=C(ue);if(!a.isValidNot0(pe))return;let be=a.inv(pe),fe=e.BASE.multiply(pe).toAffine(),Ie=a.create(fe.x);if(Ie===ft)return;let hn=a.create(be*a.create(ie+Ie*K));if(hn===ft)return;let $n=(fe.x===Ie?0:2)|Number(fe.y&Oe),Zn=hn;return U&&m(hn)&&(Zn=a.neg(hn),$n^=1),new S(Ie,Zn,$n)}return s(J,"k2sig"),{seed:se,k2sig:J}}s(B,"prepSig");function O(v,A,P={}){v=(0,W.ensureBytes)("message",v);let{seed:U,k2sig:M}=B(v,A,P);return(0,W.createHmacDrbg)(t.outputLen,a.BYTES,o)(U,M)}s(O,"sign");function R(v){let A,P=typeof v=="string"||(0,W.isBytes)(v),U=!P&&v!==null&&typeof v=="object"&&typeof v.r=="bigint"&&typeof v.s=="bigint";if(!P&&!U)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(U)A=new S(v.r,v.s);else if(P){try{A=S.fromBytes((0,W.ensureBytes)("sig",v),"der")}catch(M){if(!(M instanceof ge.DER.Err))throw M}if(!A)try{A=S.fromBytes((0,W.ensureBytes)("sig",v),"compact")}catch{return!1}}return A||!1}s(R,"tryParsingSig");function D(v,A,P,U={}){let{lowS:M,prehash:L,format:N}=Ds(U,h);if(P=(0,W.ensureBytes)("publicKey",P),A=k((0,W.ensureBytes)("message",A),L),"strict"in U)throw new Error("options.strict was renamed to lowS");let K=N===void 0?R(v):S.fromBytes((0,W.ensureBytes)("sig",v),N);if(K===!1)return!1;try{let z=e.fromBytes(P);if(M&&K.hasHighS())return!1;let{r:se,s:ie}=K,J=H(A),ue=a.inv(ie),pe=a.create(J*ue),be=a.create(se*ue),fe=e.BASE.multiplyUnsafe(pe).add(z.multiplyUnsafe(be));return fe.is0()?!1:a.create(fe.x)===se}catch{return!1}}s(D,"verify");function _(v,A,P={}){let{prehash:U}=Ds(P,h);return A=k(A,U),S.fromBytes(v,"recovered").recoverPublicKey(A).toBytes()}return s(_,"recoverPublicKey"),Object.freeze({keygen:l,getPublicKey:f,getSharedSecret:p,utils:d,lengths:y,Point:e,sign:O,verify:D,recoverPublicKey:_,Signature:S,hash:t})}s(Au,"ecdsa");function Yp(e){let{CURVE:t,curveOpts:n}=Bu(e),r=Hs(t,n);return Xp(e,r)}s(Yp,"weierstrassPoints");function Bu(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,o=(0,Rn.Field)(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),i={Fp:n,Fn:o,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:i}}s(Bu,"_weierstrass_legacy_opts_to_new");function Qp(e){let{CURVE:t,curveOpts:n}=Bu(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}s(Qp,"_ecdsa_legacy_opts_to_new");function Cu(e,t,n){function r(o){let i=e.sqr(o),a=e.mul(i,o);return e.add(e.add(a,e.mul(o,t)),n)}return s(r,"weierstrassEquation"),r}s(Cu,"_legacyHelperEquat");function Xp(e,t){let{Fp:n,Fn:r}=t;function o(a){return(0,W.inRange)(a,Oe,r.ORDER)}s(o,"isWithinCurveOrder");let i=Cu(n,e.a,e.b);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:s(a=>Jt(r,a),"normPrivateKeyToScalar"),weierstrassEquation:i,isWithinCurveOrder:o})}s(Xp,"_weierstrass_new_output_to_legacy");function Jp(e,t){let n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,(0,Rn.nLength)(n.Fn.ORDER,n.Fn.BITS))})}s(Jp,"_ecdsa_new_output_to_legacy");function eh(e){let{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:o}=Qp(e),i=Hs(t,n),a=Au(i,r,o);return Jp(e,a)}s(eh,"weierstrass")});var Iu=re(no=>{"use strict";g();b();Object.defineProperty(no,"__esModule",{value:!0});no.getHash=nh;no.createCurve=rh;var th=Ks();function nh(e){return{hash:e}}s(nh,"getHash");function rh(e,t){let n=s(r=>(0,th.weierstrass)({...e,hash:r}),"create");return{...n(t),create:n}}s(rh,"createCurve")});var Hu=re(Pe=>{"use strict";g();b();Object.defineProperty(Pe,"__esModule",{value:!0});Pe.encodeToCurve=Pe.hashToCurve=Pe.secp256k1_hasher=Pe.schnorr=Pe.secp256k1=void 0;var ro=Fr(),Pu=gt(),oh=Iu(),Uu=Bs(),Fe=Yt(),Ru=Ks(),et=Mt(),Dn={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},sh={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},ih=BigInt(0),Tu=BigInt(1),qs=BigInt(2);function ah(e){let t=Dn.p,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),a=BigInt(23),u=BigInt(44),c=BigInt(88),l=e*e*e%t,f=l*l*e%t,p=(0,Fe.pow2)(f,n,t)*f%t,d=(0,Fe.pow2)(p,n,t)*f%t,y=(0,Fe.pow2)(d,qs,t)*l%t,h=(0,Fe.pow2)(y,o,t)*y%t,w=(0,Fe.pow2)(h,i,t)*h%t,m=(0,Fe.pow2)(w,u,t)*w%t,x=(0,Fe.pow2)(m,c,t)*m%t,E=(0,Fe.pow2)(x,u,t)*w%t,S=(0,Fe.pow2)(E,n,t)*f%t,C=(0,Fe.pow2)(S,a,t)*h%t,H=(0,Fe.pow2)(C,r,t)*l%t,q=(0,Fe.pow2)(H,qs,t);if(!qt.eql(qt.sqr(q),e))throw new Error("Cannot find square root");return q}s(ah,"sqrtMod");var qt=(0,Fe.Field)(Dn.p,{sqrt:ah});Pe.secp256k1=(0,oh.createCurve)({...Dn,Fp:qt,lowS:!0,endo:sh},ro.sha256);var Lu={};function oo(e,...t){let n=Lu[e];if(n===void 0){let r=(0,ro.sha256)((0,et.utf8ToBytes)(e));n=(0,et.concatBytes)(r,r),Lu[e]=n}return(0,ro.sha256)((0,et.concatBytes)(n,...t))}s(oo,"taggedHash");var Vs=s(e=>e.toBytes(!0).slice(1),"pointToBytes"),Nn=Pe.secp256k1.Point,Fs=s(e=>e%qs===ih,"hasEven");function ks(e){let{Fn:t,BASE:n}=Nn,r=(0,Ru._normFnElement)(t,e),o=n.multiply(r);return{scalar:Fs(o.y)?r:t.neg(r),bytes:Vs(o)}}s(ks,"schnorrGetExtPubKey");function Du(e){let t=qt;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x \u2265 p");let n=t.create(e*e),r=t.create(n*e+BigInt(7)),o=t.sqrt(r);Fs(o)||(o=t.neg(o));let i=Nn.fromAffine({x:e,y:o});return i.assertValidity(),i}s(Du,"lift_x");var dr=et.bytesToNumberBE;function Nu(...e){return Nn.Fn.create(dr(oo("BIP0340/challenge",...e)))}s(Nu,"challenge");function Ou(e){return ks(e).bytes}s(Ou,"schnorrGetPublicKey");function ch(e,t,n=(0,Pu.randomBytes)(32)){let{Fn:r}=Nn,o=(0,et.ensureBytes)("message",e),{bytes:i,scalar:a}=ks(t),u=(0,et.ensureBytes)("auxRand",n,32),c=r.toBytes(a^dr(oo("BIP0340/aux",u))),l=oo("BIP0340/nonce",c,i,o),{bytes:f,scalar:p}=ks(l),d=Nu(f,i,o),y=new Uint8Array(64);if(y.set(f,0),y.set(r.toBytes(r.create(p+d*a)),32),!Mu(y,o,i))throw new Error("sign: Invalid signature produced");return y}s(ch,"schnorrSign");function Mu(e,t,n){let{Fn:r,BASE:o}=Nn,i=(0,et.ensureBytes)("signature",e,64),a=(0,et.ensureBytes)("message",t),u=(0,et.ensureBytes)("publicKey",n,32);try{let c=Du(dr(u)),l=dr(i.subarray(0,32));if(!(0,et.inRange)(l,Tu,Dn.p))return!1;let f=dr(i.subarray(32,64));if(!(0,et.inRange)(f,Tu,Dn.n))return!1;let p=Nu(r.toBytes(l),Vs(c),a),d=o.multiplyUnsafe(f).add(c.multiplyUnsafe(r.neg(p))),{x:y,y:h}=d.toAffine();return!(d.is0()||!Fs(h)||y!==l)}catch{return!1}}s(Mu,"schnorrVerify");Pe.schnorr=(()=>{let n=s((o=(0,Pu.randomBytes)(48))=>(0,Fe.mapHashToField)(o,Dn.n),"randomSecretKey");Pe.secp256k1.utils.randomSecretKey;function r(o){let i=n(o);return{secretKey:i,publicKey:Ou(i)}}return s(r,"keygen"),{keygen:r,getPublicKey:Ou,sign:ch,verify:Mu,Point:Nn,utils:{randomSecretKey:n,randomPrivateKey:n,taggedHash:oo,lift_x:Du,pointToBytes:Vs,numberToBytesBE:et.numberToBytesBE,bytesToNumberBE:et.bytesToNumberBE,mod:Fe.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:32*2,seed:48}}})();var uh=(0,Uu.isogenyMap)(qt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),lh=(0,Ru.mapToCurveSimpleSWU)(qt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:qt.create(BigInt("-11"))});Pe.secp256k1_hasher=(0,Uu.createHasher)(Pe.secp256k1.Point,e=>{let{x:t,y:n}=lh(qt.create(e[0]));return uh(t,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:qt.ORDER,m:1,k:128,expand:"xmd",hash:ro.sha256});Pe.hashToCurve=Pe.secp256k1_hasher.hashToCurve;Pe.encodeToCurve=Pe.secp256k1_hasher.encodeToCurve});var js=re(ln=>{"use strict";g();b();Object.defineProperty(ln,"__esModule",{value:!0});ln.decodeHex=ln.remove0x=void 0;var fh=Je(),dh=s(function(e){return e.startsWith("0x")||e.startsWith("0X")?e.slice(2):e},"remove0x");ln.remove0x=dh;var ph=s(function(e){return(0,fh.hexToBytes)((0,ln.remove0x)(e))},"decodeHex");ln.decodeHex=ph});var ku=re(je=>{"use strict";g();b();Object.defineProperty(je,"__esModule",{value:!0});je.hexToPublicKey=je.convertPublicKeyFormat=je.getSharedPoint=je.getPublicKey=je.isValidPrivateKey=je.getValidSecret=void 0;var hh=rs(),Ku=bu(),yh=Hu(),pr=nr(),qu=Ur(),mh=js(),gh=s(function(e){var t;do t=(0,hh.randomBytes)(qu.SECRET_KEY_LENGTH);while(!(0,je.isValidPrivateKey)(t,e));return t},"getValidSecret");je.getValidSecret=gh;var bh=s(function(e,t){return hr(t||(0,pr.ellipticCurve)(),function(n){return n.utils.isValidPrivateKey(e)},function(){return!0},function(){return!0})},"isValidPrivateKey");je.isValidPrivateKey=bh;var wh=s(function(e,t){return hr(t||(0,pr.ellipticCurve)(),function(n){return n.getPublicKey(e)},function(n){return n.getPublicKey(e)},function(n){return n.getPublicKey(e)})},"getPublicKey");je.getPublicKey=wh;var xh=s(function(e,t,n,r){return hr(r||(0,pr.ellipticCurve)(),function(o){return o.getSharedSecret(e,t,n)},function(o){return o.getSharedSecret(e,t)},function(o){return Sh(o,e,t)})},"getSharedPoint");je.getSharedPoint=xh;var Eh=s(function(e,t,n){return hr(n||(0,pr.ellipticCurve)(),function(r){return r.getSharedSecret(BigInt(1),e,t)},function(){return e},function(){return e})},"convertPublicKeyFormat");je.convertPublicKeyFormat=Eh;var _h=s(function(e,t){var n=(0,mh.decodeHex)(e);return hr(t||(0,pr.ellipticCurve)(),function(){return vh(n)},function(){return n},function(){return n})},"hexToPublicKey");je.hexToPublicKey=_h;function hr(e,t,n,r){if(e==="secp256k1")return t(yh.secp256k1);if(e==="x25519")return n(Ku.x25519);if(e==="ed25519")return r(Ku.ed25519);throw new Error("Not implemented")}s(hr,"_exec");var vh=s(function(e){if(e.length===qu.ETH_PUBLIC_KEY_SIZE){var t=new Uint8Array(1+e.length);return t.set([4]),t.set(e,1),t}return e},"compatEthPublicKey"),Sh=s(function(e,t,n){var r=e.utils.getExtendedPublicKey(t).scalar,o=e.ExtendedPoint.fromHex(n).multiply(r);return o.toRawBytes()},"getSharedPointOnEd25519")});var Gu=re(Hn=>{"use strict";g();b();Object.defineProperty(Hn,"__esModule",{value:!0});Hn.hkdf=void 0;Hn.extract=ju;Hn.expand=zu;var Fu=Rs(),Mn=gt();function ju(e,t,n){return(0,Mn.ahash)(e),n===void 0&&(n=new Uint8Array(e.outputLen)),(0,Fu.hmac)(e,(0,Mn.toBytes)(n),(0,Mn.toBytes)(t))}s(ju,"extract");var zs=Uint8Array.from([0]),Vu=Uint8Array.of();function zu(e,t,n,r=32){(0,Mn.ahash)(e),(0,Mn.anumber)(r);let o=e.outputLen;if(r>255*o)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(r/o);n===void 0&&(n=Vu);let a=new Uint8Array(i*o),u=Fu.hmac.create(e,t),c=u._cloneInto(),l=new Uint8Array(u.outputLen);for(let f=0;f<i;f++)zs[0]=f+1,c.update(f===0?Vu:l).update(n).update(zs).digestInto(l),a.set(l,o*f),u._cloneInto(c);return u.destroy(),c.destroy(),(0,Mn.clean)(l,zs),a.slice(0,r)}s(zu,"expand");var Ah=s((e,t,n,r,o)=>zu(e,ju(e,t,n),r,o),"hkdf");Hn.hkdf=Ah});var Wu=re(fn=>{"use strict";g();b();Object.defineProperty(fn,"__esModule",{value:!0});fn.getSharedKey=fn.deriveKey=void 0;var Bh=Je(),Ch=Gu(),Ih=Fr(),Th=s(function(e,t,n){return(0,Ch.hkdf)(Ih.sha256,e,t,n,32)},"deriveKey");fn.deriveKey=Th;var Lh=s(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,fn.deriveKey)(Bh.concatBytes.apply(void 0,e))},"getSharedKey");fn.getSharedKey=Lh});var Yu=re(dn=>{"use strict";g();b();Object.defineProperty(dn,"__esModule",{value:!0});dn.polyval=dn.ghash=void 0;dn._toGHASHKey=$u;var Ee=Je(),kt=16,Ws=new Uint8Array(16),St=(0,Ee.u32)(Ws),Oh=225,Ph=s((e,t,n,r)=>{let o=r&1;return{s3:n<<31|r>>>1,s2:t<<31|n>>>1,s1:e<<31|t>>>1,s0:e>>>1^Oh<<24&-(o&1)}},"mul2"),nt=s(e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0,"swapLE");function $u(e){e.reverse();let t=e[15]&1,n=0;for(let r=0;r<e.length;r++){let o=e[r];e[r]=o>>>1|n,n=(o&1)<<7}return e[0]^=-t&225,e}s($u,"_toGHASHKey");var Uh=s(e=>e>64*1024?8:e>1024?4:2,"estimateWindow"),so=class{static{s(this,"GHASH")}constructor(t,n){this.blockLen=kt,this.outputLen=kt,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t,16);let r=(0,Ee.createView)(t),o=r.getUint32(0,!1),i=r.getUint32(4,!1),a=r.getUint32(8,!1),u=r.getUint32(12,!1),c=[];for(let h=0;h<128;h++)c.push({s0:nt(o),s1:nt(i),s2:nt(a),s3:nt(u)}),{s0:o,s1:i,s2:a,s3:u}=Ph(o,i,a,u);let l=Uh(n||1024);if(![1,2,4,8].includes(l))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;let p=128/l,d=this.windowSize=2**l,y=[];for(let h=0;h<p;h++)for(let w=0;w<d;w++){let m=0,x=0,E=0,S=0;for(let C=0;C<l;C++){if(!(w>>>l-C-1&1))continue;let{s0:q,s1:G,s2:k,s3:B}=c[l*h+C];m^=q,x^=G,E^=k,S^=B}y.push({s0:m,s1:x,s2:E,s3:S})}this.t=y}_updateBlock(t,n,r,o){t^=this.s0,n^=this.s1,r^=this.s2,o^=this.s3;let{W:i,t:a,windowSize:u}=this,c=0,l=0,f=0,p=0,d=(1<<i)-1,y=0;for(let h of[t,n,r,o])for(let w=0;w<4;w++){let m=h>>>8*w&255;for(let x=8/i-1;x>=0;x--){let E=m>>>i*x&d,{s0:S,s1:C,s2:H,s3:q}=a[y*u+E];c^=S,l^=C,f^=H,p^=q,y+=1}}this.s0=c,this.s1=l,this.s2=f,this.s3=p}update(t){(0,Ee.aexists)(this),t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t);let n=(0,Ee.u32)(t),r=Math.floor(t.length/kt),o=t.length%kt;for(let i=0;i<r;i++)this._updateBlock(n[i*4+0],n[i*4+1],n[i*4+2],n[i*4+3]);return o&&(Ws.set(t.subarray(r*kt)),this._updateBlock(St[0],St[1],St[2],St[3]),(0,Ee.clean)(St)),this}destroy(){let{t}=this;for(let n of t)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(t){(0,Ee.aexists)(this),(0,Ee.aoutput)(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:i}=this,a=(0,Ee.u32)(t);return a[0]=n,a[1]=r,a[2]=o,a[3]=i,t}digest(){let t=new Uint8Array(kt);return this.digestInto(t),this.destroy(),t}},Gs=class extends so{static{s(this,"Polyval")}constructor(t,n){t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t);let r=$u((0,Ee.copyBytes)(t));super(r,n),(0,Ee.clean)(r)}update(t){t=(0,Ee.toBytes)(t),(0,Ee.aexists)(this);let n=(0,Ee.u32)(t),r=t.length%kt,o=Math.floor(t.length/kt);for(let i=0;i<o;i++)this._updateBlock(nt(n[i*4+3]),nt(n[i*4+2]),nt(n[i*4+1]),nt(n[i*4+0]));return r&&(Ws.set(t.subarray(o*kt)),this._updateBlock(nt(St[3]),nt(St[2]),nt(St[1]),nt(St[0])),(0,Ee.clean)(St)),this}digestInto(t){(0,Ee.aexists)(this),(0,Ee.aoutput)(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:i}=this,a=(0,Ee.u32)(t);return a[0]=n,a[1]=r,a[2]=o,a[3]=i,t.reverse()}};function Zu(e){let t=s((r,o)=>e(o,r.length).update((0,Ee.toBytes)(r)).digest(),"hashC"),n=e(new Uint8Array(16),0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=(r,o)=>e(r,o),t}s(Zu,"wrapConstructorWithKey");dn.ghash=Zu((e,t)=>new so(e,t));dn.polyval=Zu((e,t)=>new Gs(e,t))});var ll=re(_e=>{"use strict";g();b();Object.defineProperty(_e,"__esModule",{value:!0});_e.unsafe=_e.aeskwp=_e.aeskw=_e.siv=_e.gcmsiv=_e.gcm=_e.cfb=_e.cbc=_e.ecb=_e.ctr=void 0;var Zs=Yu(),I=Je(),Xe=16,Qs=4,io=new Uint8Array(Xe),Rh=283;function Xs(e){return e<<1^Rh&-(e>>7)}s(Xs,"mul2");function Kn(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(t&1),e=Xs(e);return n}s(Kn,"mul");var Ys=(()=>{let e=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=Xs(r))e[n]=r;let t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let r=e[255-n];r|=r<<8,t[e[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return(0,I.clean)(e),t})(),Dh=Ys.map((e,t)=>Ys.indexOf(t)),Nh=s(e=>e<<24|e>>>8,"rotr32_8"),$s=s(e=>e<<8|e>>>24,"rotl32_8"),co=s(e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255,"byteSwap");function Ju(e,t){if(e.length!==256)throw new Error("Wrong sbox length");let n=new Uint32Array(256).map((l,f)=>t(e[f])),r=n.map($s),o=r.map($s),i=o.map($s),a=new Uint32Array(256*256),u=new Uint32Array(256*256),c=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let f=0;f<256;f++){let p=l*256+f;a[p]=n[l]^r[f],u[p]=o[l]^i[f],c[p]=e[l]<<8|e[f]}return{sbox:e,sbox2:c,T0:n,T1:r,T2:o,T3:i,T01:a,T23:u}}s(Ju,"genTtable");var Js=Ju(Ys,e=>Kn(e,3)<<24|e<<16|e<<8|Kn(e,2)),el=Ju(Dh,e=>Kn(e,11)<<24|Kn(e,13)<<16|Kn(e,9)<<8|Kn(e,14)),Mh=(()=>{let e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=Xs(n))e[t]=n;return e})();function Bt(e){(0,I.abytes)(e);let t=e.length;if(![16,24,32].includes(t))throw new Error("aes: invalid key size, should be 16, 24 or 32, got "+t);let{sbox2:n}=Js,r=[];(0,I.isAligned32)(e)||r.push(e=(0,I.copyBytes)(e));let o=(0,I.u32)(e),i=o.length,a=s(c=>At(n,c,c,c,c),"subByte"),u=new Uint32Array(t+28);u.set(o);for(let c=i;c<u.length;c++){let l=u[c-1];c%i===0?l=a(Nh(l))^Mh[c/i-1]:i>6&&c%i===4&&(l=a(l)),u[c]=u[c-i]^l}return(0,I.clean)(...r),u}s(Bt,"expandKeyLE");function lo(e){let t=Bt(e),n=t.slice(),r=t.length,{sbox2:o}=Js,{T0:i,T1:a,T2:u,T3:c}=el;for(let l=0;l<r;l+=4)for(let f=0;f<4;f++)n[l+f]=t[r-l-4+f];(0,I.clean)(t);for(let l=4;l<r-4;l++){let f=n[l],p=At(o,f,f,f,f);n[l]=i[p&255]^a[p>>>8&255]^u[p>>>16&255]^c[p>>>24]}return n}s(lo,"expandKeyDecLE");function en(e,t,n,r,o,i){return e[n<<8&65280|r>>>8&255]^t[o>>>8&65280|i>>>24&255]}s(en,"apply0123");function At(e,t,n,r,o){return e[t&255|n&65280]|e[r>>>16&255|o>>>16&65280]<<16}s(At,"applySbox");function ze(e,t,n,r,o){let{sbox2:i,T01:a,T23:u}=Js,c=0;t^=e[c++],n^=e[c++],r^=e[c++],o^=e[c++];let l=e.length/4-2;for(let h=0;h<l;h++){let w=e[c++]^en(a,u,t,n,r,o),m=e[c++]^en(a,u,n,r,o,t),x=e[c++]^en(a,u,r,o,t,n),E=e[c++]^en(a,u,o,t,n,r);t=w,n=m,r=x,o=E}let f=e[c++]^At(i,t,n,r,o),p=e[c++]^At(i,n,r,o,t),d=e[c++]^At(i,r,o,t,n),y=e[c++]^At(i,o,t,n,r);return{s0:f,s1:p,s2:d,s3:y}}s(ze,"encrypt");function yr(e,t,n,r,o){let{sbox2:i,T01:a,T23:u}=el,c=0;t^=e[c++],n^=e[c++],r^=e[c++],o^=e[c++];let l=e.length/4-2;for(let h=0;h<l;h++){let w=e[c++]^en(a,u,t,o,r,n),m=e[c++]^en(a,u,n,t,o,r),x=e[c++]^en(a,u,r,n,t,o),E=e[c++]^en(a,u,o,r,n,t);t=w,n=m,r=x,o=E}let f=e[c++]^At(i,t,o,r,n),p=e[c++]^At(i,n,t,o,r),d=e[c++]^At(i,r,n,t,o),y=e[c++]^At(i,o,r,n,t);return{s0:f,s1:p,s2:d,s3:y}}s(yr,"decrypt");function tl(e,t,n,r){(0,I.abytes)(t,Xe),(0,I.abytes)(n);let o=n.length;r=(0,I.getOutput)(o,r),(0,I.complexOverlapBytes)(n,r);let i=t,a=(0,I.u32)(i),{s0:u,s1:c,s2:l,s3:f}=ze(e,a[0],a[1],a[2],a[3]),p=(0,I.u32)(n),d=(0,I.u32)(r);for(let h=0;h+4<=p.length;h+=4){d[h+0]=p[h+0]^u,d[h+1]=p[h+1]^c,d[h+2]=p[h+2]^l,d[h+3]=p[h+3]^f;let w=1;for(let m=i.length-1;m>=0;m--)w=w+(i[m]&255)|0,i[m]=w&255,w>>>=8;({s0:u,s1:c,s2:l,s3:f}=ze(e,a[0],a[1],a[2],a[3]))}let y=Xe*Math.floor(p.length/Qs);if(y<o){let h=new Uint32Array([u,c,l,f]),w=(0,I.u8)(h);for(let m=y,x=0;m<o;m++,x++)r[m]=n[m]^w[x];(0,I.clean)(h)}return r}s(tl,"ctrCounter");function qn(e,t,n,r,o){(0,I.abytes)(n,Xe),(0,I.abytes)(r),o=(0,I.getOutput)(r.length,o);let i=n,a=(0,I.u32)(i),u=(0,I.createView)(i),c=(0,I.u32)(r),l=(0,I.u32)(o),f=t?0:12,p=r.length,d=u.getUint32(f,t),{s0:y,s1:h,s2:w,s3:m}=ze(e,a[0],a[1],a[2],a[3]);for(let E=0;E+4<=c.length;E+=4)l[E+0]=c[E+0]^y,l[E+1]=c[E+1]^h,l[E+2]=c[E+2]^w,l[E+3]=c[E+3]^m,d=d+1>>>0,u.setUint32(f,d,t),{s0:y,s1:h,s2:w,s3:m}=ze(e,a[0],a[1],a[2],a[3]);let x=Xe*Math.floor(c.length/Qs);if(x<p){let E=new Uint32Array([y,h,w,m]),S=(0,I.u8)(E);for(let C=x,H=0;C<p;C++,H++)o[C]=r[C]^S[H];(0,I.clean)(E)}return o}s(qn,"ctr32");_e.ctr=(0,I.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,n){function r(o,i){if((0,I.abytes)(o),i!==void 0&&((0,I.abytes)(i),!(0,I.isAligned32)(i)))throw new Error("unaligned destination");let a=Bt(t),u=(0,I.copyBytes)(n),c=[a,u];(0,I.isAligned32)(o)||c.push(o=(0,I.copyBytes)(o));let l=tl(a,u,o,i);return(0,I.clean)(...c),l}return s(r,"processCtr"),{encrypt:s((o,i)=>r(o,i),"encrypt"),decrypt:s((o,i)=>r(o,i),"decrypt")}},"aesctr"));function nl(e){if((0,I.abytes)(e),e.length%Xe!==0)throw new Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size "+Xe)}s(nl,"validateBlockDecrypt");function rl(e,t,n){(0,I.abytes)(e);let r=e.length,o=r%Xe;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");(0,I.isAligned32)(e)||(e=(0,I.copyBytes)(e));let i=(0,I.u32)(e);if(t){let u=Xe-o;u||(u=Xe),r=r+u}n=(0,I.getOutput)(r,n),(0,I.complexOverlapBytes)(e,n);let a=(0,I.u32)(n);return{b:i,o:a,out:n}}s(rl,"validateBlockEncrypt");function ol(e,t){if(!t)return e;let n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");let r=e[n-1];if(r<=0||r>16)throw new Error("aes/pcks5: wrong padding");let o=e.subarray(0,-r);for(let i=0;i<r;i++)if(e[n-i-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}s(ol,"validatePCKS");function sl(e){let t=new Uint8Array(16),n=(0,I.u32)(t);t.set(e);let r=Xe-e.length;for(let o=Xe-r;o<Xe;o++)t[o]=r;return n}s(sl,"padPCKS");_e.ecb=(0,I.wrapCipher)({blockSize:16},s(function(t,n={}){let r=!n.disablePadding;return{encrypt(o,i){let{b:a,o:u,out:c}=rl(o,r,i),l=Bt(t),f=0;for(;f+4<=a.length;){let{s0:p,s1:d,s2:y,s3:h}=ze(l,a[f+0],a[f+1],a[f+2],a[f+3]);u[f++]=p,u[f++]=d,u[f++]=y,u[f++]=h}if(r){let p=sl(o.subarray(f*4)),{s0:d,s1:y,s2:h,s3:w}=ze(l,p[0],p[1],p[2],p[3]);u[f++]=d,u[f++]=y,u[f++]=h,u[f++]=w}return(0,I.clean)(l),c},decrypt(o,i){nl(o);let a=lo(t);i=(0,I.getOutput)(o.length,i);let u=[a];(0,I.isAligned32)(o)||u.push(o=(0,I.copyBytes)(o)),(0,I.complexOverlapBytes)(o,i);let c=(0,I.u32)(o),l=(0,I.u32)(i);for(let f=0;f+4<=c.length;){let{s0:p,s1:d,s2:y,s3:h}=yr(a,c[f+0],c[f+1],c[f+2],c[f+3]);l[f++]=p,l[f++]=d,l[f++]=y,l[f++]=h}return(0,I.clean)(...u),ol(i,r)}}},"aesecb"));_e.cbc=(0,I.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,n,r={}){let o=!r.disablePadding;return{encrypt(i,a){let u=Bt(t),{b:c,o:l,out:f}=rl(i,o,a),p=n,d=[u];(0,I.isAligned32)(p)||d.push(p=(0,I.copyBytes)(p));let y=(0,I.u32)(p),h=y[0],w=y[1],m=y[2],x=y[3],E=0;for(;E+4<=c.length;)h^=c[E+0],w^=c[E+1],m^=c[E+2],x^=c[E+3],{s0:h,s1:w,s2:m,s3:x}=ze(u,h,w,m,x),l[E++]=h,l[E++]=w,l[E++]=m,l[E++]=x;if(o){let S=sl(i.subarray(E*4));h^=S[0],w^=S[1],m^=S[2],x^=S[3],{s0:h,s1:w,s2:m,s3:x}=ze(u,h,w,m,x),l[E++]=h,l[E++]=w,l[E++]=m,l[E++]=x}return(0,I.clean)(...d),f},decrypt(i,a){nl(i);let u=lo(t),c=n,l=[u];(0,I.isAligned32)(c)||l.push(c=(0,I.copyBytes)(c));let f=(0,I.u32)(c);a=(0,I.getOutput)(i.length,a),(0,I.isAligned32)(i)||l.push(i=(0,I.copyBytes)(i)),(0,I.complexOverlapBytes)(i,a);let p=(0,I.u32)(i),d=(0,I.u32)(a),y=f[0],h=f[1],w=f[2],m=f[3];for(let x=0;x+4<=p.length;){let E=y,S=h,C=w,H=m;y=p[x+0],h=p[x+1],w=p[x+2],m=p[x+3];let{s0:q,s1:G,s2:k,s3:B}=yr(u,y,h,w,m);d[x++]=q^E,d[x++]=G^S,d[x++]=k^C,d[x++]=B^H}return(0,I.clean)(...l),ol(a,o)}}},"aescbc"));_e.cfb=(0,I.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,n){function r(o,i,a){(0,I.abytes)(o);let u=o.length;if(a=(0,I.getOutput)(u,a),(0,I.overlapBytes)(o,a))throw new Error("overlapping src and dst not supported.");let c=Bt(t),l=n,f=[c];(0,I.isAligned32)(l)||f.push(l=(0,I.copyBytes)(l)),(0,I.isAligned32)(o)||f.push(o=(0,I.copyBytes)(o));let p=(0,I.u32)(o),d=(0,I.u32)(a),y=i?d:p,h=(0,I.u32)(l),w=h[0],m=h[1],x=h[2],E=h[3];for(let C=0;C+4<=p.length;){let{s0:H,s1:q,s2:G,s3:k}=ze(c,w,m,x,E);d[C+0]=p[C+0]^H,d[C+1]=p[C+1]^q,d[C+2]=p[C+2]^G,d[C+3]=p[C+3]^k,w=y[C++],m=y[C++],x=y[C++],E=y[C++]}let S=Xe*Math.floor(p.length/Qs);if(S<u){({s0:w,s1:m,s2:x,s3:E}=ze(c,w,m,x,E));let C=(0,I.u8)(new Uint32Array([w,m,x,E]));for(let H=S,q=0;H<u;H++,q++)a[H]=o[H]^C[q];(0,I.clean)(C)}return(0,I.clean)(...f),a}return s(r,"processCfb"),{encrypt:s((o,i)=>r(o,!0,i),"encrypt"),decrypt:s((o,i)=>r(o,!1,i),"decrypt")}},"aescfb"));function il(e,t,n,r,o){let i=o?o.length:0,a=e.create(n,r.length+i);o&&a.update(o);let u=(0,I.u64Lengths)(8*r.length,8*i,t);a.update(r),a.update(u);let c=a.digest();return(0,I.clean)(u),c}s(il,"computeTag");_e.gcm=(0,I.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},s(function(t,n,r){if(n.length<8)throw new Error("aes/gcm: invalid nonce length");let o=16;function i(u,c,l){let f=il(Zs.ghash,!1,u,l,r);for(let p=0;p<c.length;p++)f[p]^=c[p];return f}s(i,"_computeTag");function a(){let u=Bt(t),c=io.slice(),l=io.slice();if(qn(u,!1,l,l,c),n.length===12)l.set(n);else{let p=io.slice(),d=(0,I.createView)(p);(0,I.setBigUint64)(d,8,BigInt(n.length*8),!1);let y=Zs.ghash.create(c).update(n).update(p);y.digestInto(l),y.destroy()}let f=qn(u,!1,l,io);return{xk:u,authKey:c,counter:l,tagMask:f}}return s(a,"deriveKeys"),{encrypt(u){let{xk:c,authKey:l,counter:f,tagMask:p}=a(),d=new Uint8Array(u.length+o),y=[c,l,f,p];(0,I.isAligned32)(u)||y.push(u=(0,I.copyBytes)(u)),qn(c,!1,f,u,d.subarray(0,u.length));let h=i(l,p,d.subarray(0,d.length-o));return y.push(h),d.set(h,u.length),(0,I.clean)(...y),d},decrypt(u){let{xk:c,authKey:l,counter:f,tagMask:p}=a(),d=[c,l,p,f];(0,I.isAligned32)(u)||d.push(u=(0,I.copyBytes)(u));let y=u.subarray(0,-o),h=u.subarray(-o),w=i(l,p,y);if(d.push(w),!(0,I.equalBytes)(w,h))throw new Error("aes/gcm: invalid ghash tag");let m=qn(c,!1,f,y);return(0,I.clean)(...d),m}}},"aesgcm"));var ao=s((e,t,n)=>r=>{if(!Number.isSafeInteger(r)||t>r||r>n){let o="["+t+".."+n+"]";throw new Error(""+e+": expected value in range "+o+", got "+r)}},"limit");_e.gcmsiv=(0,I.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},s(function(t,n,r){let i=ao("AAD",0,68719476736),a=ao("plaintext",0,2**36),u=ao("nonce",12,12),c=ao("ciphertext",16,2**36+16);(0,I.abytes)(t,16,24,32),u(n.length),r!==void 0&&i(r.length);function l(){let d=Bt(t),y=new Uint8Array(t.length),h=new Uint8Array(16),w=[d,y],m=n;(0,I.isAligned32)(m)||w.push(m=(0,I.copyBytes)(m));let x=(0,I.u32)(m),E=0,S=x[0],C=x[1],H=x[2],q=0;for(let k of[h,y].map(I.u32)){let B=(0,I.u32)(k);for(let O=0;O<B.length;O+=2){let{s0:R,s1:D}=ze(d,E,S,C,H);B[O+0]=R,B[O+1]=D,E=++q}}let G={authKey:h,encKey:Bt(y)};return(0,I.clean)(...w),G}s(l,"deriveKeys");function f(d,y,h){let w=il(Zs.polyval,!0,y,h,r);for(let H=0;H<12;H++)w[H]^=n[H];w[15]&=127;let m=(0,I.u32)(w),x=m[0],E=m[1],S=m[2],C=m[3];return{s0:x,s1:E,s2:S,s3:C}=ze(d,x,E,S,C),m[0]=x,m[1]=E,m[2]=S,m[3]=C,w}s(f,"_computeTag");function p(d,y,h){let w=(0,I.copyBytes)(y);w[15]|=128;let m=qn(d,!0,w,h);return(0,I.clean)(w),m}return s(p,"processSiv"),{encrypt(d){a(d.length);let{encKey:y,authKey:h}=l(),w=f(y,h,d),m=[y,h,w];(0,I.isAligned32)(d)||m.push(d=(0,I.copyBytes)(d));let x=new Uint8Array(d.length+16);return x.set(w,d.length),x.set(p(y,w,d)),(0,I.clean)(...m),x},decrypt(d){c(d.length);let y=d.subarray(-16),{encKey:h,authKey:w}=l(),m=[h,w];(0,I.isAligned32)(d)||m.push(d=(0,I.copyBytes)(d));let x=p(h,y,d.subarray(0,-16)),E=f(h,w,x);if(m.push(E),!(0,I.equalBytes)(y,E))throw(0,I.clean)(...m),new Error("invalid polyval tag");return(0,I.clean)(...m),x}}},"aessiv"));_e.siv=_e.gcmsiv;function al(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint32Array"}s(al,"isBytes32");function cl(e,t){if((0,I.abytes)(t,16),!al(e))throw new Error("_encryptBlock accepts result of expandKeyLE");let n=(0,I.u32)(t),{s0:r,s1:o,s2:i,s3:a}=ze(e,n[0],n[1],n[2],n[3]);return n[0]=r,n[1]=o,n[2]=i,n[3]=a,t}s(cl,"encryptBlock");function ul(e,t){if((0,I.abytes)(t,16),!al(e))throw new Error("_decryptBlock accepts result of expandKeyLE");let n=(0,I.u32)(t),{s0:r,s1:o,s2:i,s3:a}=yr(e,n[0],n[1],n[2],n[3]);return n[0]=r,n[1]=o,n[2]=i,n[3]=a,t}s(ul,"decryptBlock");var uo={encrypt(e,t){if(t.length>=2**32)throw new Error("plaintext should be less than 4gb");let n=Bt(e);if(t.length===16)cl(n,t);else{let r=(0,I.u32)(t),o=r[0],i=r[1];for(let a=0,u=1;a<6;a++)for(let c=2;c<r.length;c+=2,u++){let{s0:l,s1:f,s2:p,s3:d}=ze(n,o,i,r[c],r[c+1]);o=l,i=f^co(u),r[c]=p,r[c+1]=d}r[0]=o,r[1]=i}n.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");let n=lo(e),r=t.length/8-1;if(r===1)ul(n,t);else{let o=(0,I.u32)(t),i=o[0],a=o[1];for(let u=0,c=r*6;u<6;u++)for(let l=r*2;l>=1;l-=2,c--){a^=co(c);let{s0:f,s1:p,s2:d,s3:y}=yr(n,i,a,o[l],o[l+1]);i=f,a=p,o[l]=d,o[l+1]=y}o[0]=i,o[1]=a}n.fill(0)}},Qu=new Uint8Array(8).fill(166);_e.aeskw=(0,I.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!==0)throw new Error("invalid plaintext length");if(t.length===8)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");let n=(0,I.concatBytes)(Qu,t);return uo.encrypt(e,n),n},decrypt(t){if(t.length%8!==0||t.length<3*8)throw new Error("invalid ciphertext length");let n=(0,I.copyBytes)(t);if(uo.decrypt(e,n),!(0,I.equalBytes)(n.subarray(0,8),Qu))throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8)}}));var Xu=2790873510;_e.aeskwp=(0,I.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length)throw new Error("invalid plaintext length");let n=Math.ceil(t.length/8)*8,r=new Uint8Array(8+n);r.set(t,8);let o=(0,I.u32)(r);return o[0]=Xu,o[1]=co(t.length),uo.encrypt(e,r),r},decrypt(t){if(t.length<16)throw new Error("invalid ciphertext length");let n=(0,I.copyBytes)(t),r=(0,I.u32)(n);uo.decrypt(e,n);let o=co(r[1])>>>0,i=Math.ceil(o/8)*8;if(r[0]!==Xu||n.length-8!==i)throw new Error("integrity check failed");for(let a=o;a<i;a++)if(n[8+a]!==0)throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8,8+o)}}));_e.unsafe={expandKeyLE:Bt,expandKeyDecLE:lo,encrypt:ze,decrypt:yr,encryptBlock:cl,decryptBlock:ul,ctrCounter:tl,ctr32:qn}});var dl=re(kn=>{"use strict";g();b();Object.defineProperty(kn,"__esModule",{value:!0});kn.aes256cbc=kn.aes256gcm=void 0;var fl=ll(),Hh=s(function(e,t,n){return(0,fl.gcm)(e,t,n)},"aes256gcm");kn.aes256gcm=Hh;var Kh=s(function(e,t,n){return(0,fl.cbc)(e,t)},"aes256cbc");kn.aes256cbc=Kh});var ml=re(po=>{"use strict";g();b();Object.defineProperty(po,"__esModule",{value:!0});po.rotl=jh;po.createCipher=Wh;var Ae=Je(),hl=s(e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),"_utf8ToBytes"),qh=hl("expand 16-byte k"),kh=hl("expand 32-byte k"),Vh=(0,Ae.u32)(qh),Fh=(0,Ae.u32)(kh);function jh(e,t){return e<<t|e>>>32-t}s(jh,"rotl");function ei(e){return e.byteOffset%4===0}s(ei,"isAligned32");var fo=64,zh=16,yl=2**32-1,pl=new Uint32Array;function Gh(e,t,n,r,o,i,a,u){let c=o.length,l=new Uint8Array(fo),f=(0,Ae.u32)(l),p=ei(o)&&ei(i),d=p?(0,Ae.u32)(o):pl,y=p?(0,Ae.u32)(i):pl;for(let h=0;h<c;a++){if(e(t,n,r,f,a,u),a>=yl)throw new Error("arx: counter overflow");let w=Math.min(fo,c-h);if(p&&w===fo){let m=h/4;if(h%4!==0)throw new Error("arx: invalid block position");for(let x=0,E;x<zh;x++)E=m+x,y[E]=d[E]^f[x];h+=fo;continue}for(let m=0,x;m<w;m++)x=h+m,i[x]=o[x]^l[m];h+=w}}s(Gh,"runCipher");function Wh(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:a}=(0,Ae.checkOpts)({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return(0,Ae.anumber)(o),(0,Ae.anumber)(a),(0,Ae.abool)(i),(0,Ae.abool)(n),(u,c,l,f,p=0)=>{(0,Ae.abytes)(u),(0,Ae.abytes)(c),(0,Ae.abytes)(l);let d=l.length;if(f===void 0&&(f=new Uint8Array(d)),(0,Ae.abytes)(f),(0,Ae.anumber)(p),p<0||p>=yl)throw new Error("arx: counter overflow");if(f.length<d)throw new Error(`arx: output (${f.length}) is shorter than data (${d})`);let y=[],h=u.length,w,m;if(h===32)y.push(w=(0,Ae.copyBytes)(u)),m=Fh;else if(h===16&&n)w=new Uint8Array(32),w.set(u),w.set(u,16),m=Vh,y.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${h}`);ei(c)||y.push(c=(0,Ae.copyBytes)(c));let x=(0,Ae.u32)(w);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,x,(0,Ae.u32)(c.subarray(0,16)),x),c=c.subarray(16)}let E=16-o;if(E!==c.length)throw new Error(`arx: nonce must be ${E} or 16 bytes`);if(E!==12){let C=new Uint8Array(12);C.set(c,i?0:12-c.length),c=C,y.push(c)}let S=(0,Ae.u32)(c);return Gh(e,m,x,S,l,f,p,a),(0,Ae.clean)(...y),f}}s(Wh,"createCipher")});var bl=re(mr=>{"use strict";g();b();Object.defineProperty(mr,"__esModule",{value:!0});mr.poly1305=void 0;mr.wrapConstructorWithKey=gl;var Ct=Je(),Ue=s((e,t)=>e[t++]&255|(e[t++]&255)<<8,"u8to16"),ti=class{static{s(this,"Poly1305")}constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=(0,Ct.toBytes)(t),(0,Ct.abytes)(t,32);let n=Ue(t,0),r=Ue(t,2),o=Ue(t,4),i=Ue(t,6),a=Ue(t,8),u=Ue(t,10),c=Ue(t,12),l=Ue(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|i<<9)&8191,this.r[4]=(i>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|u<<2)&8191,this.r[7]=(u>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let f=0;f<8;f++)this.pad[f]=Ue(t,16+2*f)}process(t,n,r=!1){let o=r?0:2048,{h:i,r:a}=this,u=a[0],c=a[1],l=a[2],f=a[3],p=a[4],d=a[5],y=a[6],h=a[7],w=a[8],m=a[9],x=Ue(t,n+0),E=Ue(t,n+2),S=Ue(t,n+4),C=Ue(t,n+6),H=Ue(t,n+8),q=Ue(t,n+10),G=Ue(t,n+12),k=Ue(t,n+14),B=i[0]+(x&8191),O=i[1]+((x>>>13|E<<3)&8191),R=i[2]+((E>>>10|S<<6)&8191),D=i[3]+((S>>>7|C<<9)&8191),_=i[4]+((C>>>4|H<<12)&8191),v=i[5]+(H>>>1&8191),A=i[6]+((H>>>14|q<<2)&8191),P=i[7]+((q>>>11|G<<5)&8191),U=i[8]+((G>>>8|k<<8)&8191),M=i[9]+(k>>>5|o),L=0,N=L+B*u+O*(5*m)+R*(5*w)+D*(5*h)+_*(5*y);L=N>>>13,N&=8191,N+=v*(5*d)+A*(5*p)+P*(5*f)+U*(5*l)+M*(5*c),L+=N>>>13,N&=8191;let K=L+B*c+O*u+R*(5*m)+D*(5*w)+_*(5*h);L=K>>>13,K&=8191,K+=v*(5*y)+A*(5*d)+P*(5*p)+U*(5*f)+M*(5*l),L+=K>>>13,K&=8191;let z=L+B*l+O*c+R*u+D*(5*m)+_*(5*w);L=z>>>13,z&=8191,z+=v*(5*h)+A*(5*y)+P*(5*d)+U*(5*p)+M*(5*f),L+=z>>>13,z&=8191;let se=L+B*f+O*l+R*c+D*u+_*(5*m);L=se>>>13,se&=8191,se+=v*(5*w)+A*(5*h)+P*(5*y)+U*(5*d)+M*(5*p),L+=se>>>13,se&=8191;let ie=L+B*p+O*f+R*l+D*c+_*u;L=ie>>>13,ie&=8191,ie+=v*(5*m)+A*(5*w)+P*(5*h)+U*(5*y)+M*(5*d),L+=ie>>>13,ie&=8191;let J=L+B*d+O*p+R*f+D*l+_*c;L=J>>>13,J&=8191,J+=v*u+A*(5*m)+P*(5*w)+U*(5*h)+M*(5*y),L+=J>>>13,J&=8191;let ue=L+B*y+O*d+R*p+D*f+_*l;L=ue>>>13,ue&=8191,ue+=v*c+A*u+P*(5*m)+U*(5*w)+M*(5*h),L+=ue>>>13,ue&=8191;let pe=L+B*h+O*y+R*d+D*p+_*f;L=pe>>>13,pe&=8191,pe+=v*l+A*c+P*u+U*(5*m)+M*(5*w),L+=pe>>>13,pe&=8191;let be=L+B*w+O*h+R*y+D*d+_*p;L=be>>>13,be&=8191,be+=v*f+A*l+P*c+U*u+M*(5*m),L+=be>>>13,be&=8191;let fe=L+B*m+O*w+R*h+D*y+_*d;L=fe>>>13,fe&=8191,fe+=v*p+A*f+P*l+U*c+M*u,L+=fe>>>13,fe&=8191,L=(L<<2)+L|0,L=L+N|0,N=L&8191,L=L>>>13,K+=L,i[0]=N,i[1]=K,i[2]=z,i[3]=se,i[4]=ie,i[5]=J,i[6]=ue,i[7]=pe,i[8]=be,i[9]=fe}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let u=2;u<10;u++)t[u]+=o,o=t[u]>>>13,t[u]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let u=1;u<10;u++)r[u]=t[u]+o,o=r[u]>>>13,r[u]&=8191;r[9]-=8192;let i=(o^1)-1;for(let u=0;u<10;u++)r[u]&=i;i=~i;for(let u=0;u<10;u++)t[u]=t[u]&i|r[u];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let a=t[0]+n[0];t[0]=a&65535;for(let u=1;u<8;u++)a=(t[u]+n[u]|0)+(a>>>16)|0,t[u]=a&65535;(0,Ct.clean)(r)}update(t){(0,Ct.aexists)(this),t=(0,Ct.toBytes)(t),(0,Ct.abytes)(t);let{buffer:n,blockLen:r}=this,o=t.length;for(let i=0;i<o;){let a=Math.min(r-this.pos,o-i);if(a===r){for(;r<=o-i;i+=r)this.process(t,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){(0,Ct.clean)(this.h,this.r,this.buffer,this.pad)}digestInto(t){(0,Ct.aexists)(this),(0,Ct.aoutput)(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let a=0;a<8;a++)t[i++]=r[a]>>>0,t[i++]=r[a]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function gl(e){let t=s((r,o)=>e(o).update((0,Ct.toBytes)(r)).digest(),"hashC"),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}s(gl,"wrapConstructorWithKey");mr.poly1305=gl(e=>new ti(e))});var _l=re(ve=>{"use strict";g();b();Object.defineProperty(ve,"__esModule",{value:!0});ve.xchacha20poly1305=ve.chacha20poly1305=ve._poly1305_aead=ve.chacha12=ve.chacha8=ve.xchacha20=ve.chacha20=ve.chacha20orig=void 0;ve.hchacha=El;var j=ml(),$h=bl(),Vt=Je();function gr(e,t,n,r,o,i=20){let a=e[0],u=e[1],c=e[2],l=e[3],f=t[0],p=t[1],d=t[2],y=t[3],h=t[4],w=t[5],m=t[6],x=t[7],E=o,S=n[0],C=n[1],H=n[2],q=a,G=u,k=c,B=l,O=f,R=p,D=d,_=y,v=h,A=w,P=m,U=x,M=E,L=S,N=C,K=H;for(let se=0;se<i;se+=2)q=q+O|0,M=(0,j.rotl)(M^q,16),v=v+M|0,O=(0,j.rotl)(O^v,12),q=q+O|0,M=(0,j.rotl)(M^q,8),v=v+M|0,O=(0,j.rotl)(O^v,7),G=G+R|0,L=(0,j.rotl)(L^G,16),A=A+L|0,R=(0,j.rotl)(R^A,12),G=G+R|0,L=(0,j.rotl)(L^G,8),A=A+L|0,R=(0,j.rotl)(R^A,7),k=k+D|0,N=(0,j.rotl)(N^k,16),P=P+N|0,D=(0,j.rotl)(D^P,12),k=k+D|0,N=(0,j.rotl)(N^k,8),P=P+N|0,D=(0,j.rotl)(D^P,7),B=B+_|0,K=(0,j.rotl)(K^B,16),U=U+K|0,_=(0,j.rotl)(_^U,12),B=B+_|0,K=(0,j.rotl)(K^B,8),U=U+K|0,_=(0,j.rotl)(_^U,7),q=q+R|0,K=(0,j.rotl)(K^q,16),P=P+K|0,R=(0,j.rotl)(R^P,12),q=q+R|0,K=(0,j.rotl)(K^q,8),P=P+K|0,R=(0,j.rotl)(R^P,7),G=G+D|0,M=(0,j.rotl)(M^G,16),U=U+M|0,D=(0,j.rotl)(D^U,12),G=G+D|0,M=(0,j.rotl)(M^G,8),U=U+M|0,D=(0,j.rotl)(D^U,7),k=k+_|0,L=(0,j.rotl)(L^k,16),v=v+L|0,_=(0,j.rotl)(_^v,12),k=k+_|0,L=(0,j.rotl)(L^k,8),v=v+L|0,_=(0,j.rotl)(_^v,7),B=B+O|0,N=(0,j.rotl)(N^B,16),A=A+N|0,O=(0,j.rotl)(O^A,12),B=B+O|0,N=(0,j.rotl)(N^B,8),A=A+N|0,O=(0,j.rotl)(O^A,7);let z=0;r[z++]=a+q|0,r[z++]=u+G|0,r[z++]=c+k|0,r[z++]=l+B|0,r[z++]=f+O|0,r[z++]=p+R|0,r[z++]=d+D|0,r[z++]=y+_|0,r[z++]=h+v|0,r[z++]=w+A|0,r[z++]=m+P|0,r[z++]=x+U|0,r[z++]=E+M|0,r[z++]=S+L|0,r[z++]=C+N|0,r[z++]=H+K|0}s(gr,"chachaCore");function El(e,t,n,r){let o=e[0],i=e[1],a=e[2],u=e[3],c=t[0],l=t[1],f=t[2],p=t[3],d=t[4],y=t[5],h=t[6],w=t[7],m=n[0],x=n[1],E=n[2],S=n[3];for(let H=0;H<20;H+=2)o=o+c|0,m=(0,j.rotl)(m^o,16),d=d+m|0,c=(0,j.rotl)(c^d,12),o=o+c|0,m=(0,j.rotl)(m^o,8),d=d+m|0,c=(0,j.rotl)(c^d,7),i=i+l|0,x=(0,j.rotl)(x^i,16),y=y+x|0,l=(0,j.rotl)(l^y,12),i=i+l|0,x=(0,j.rotl)(x^i,8),y=y+x|0,l=(0,j.rotl)(l^y,7),a=a+f|0,E=(0,j.rotl)(E^a,16),h=h+E|0,f=(0,j.rotl)(f^h,12),a=a+f|0,E=(0,j.rotl)(E^a,8),h=h+E|0,f=(0,j.rotl)(f^h,7),u=u+p|0,S=(0,j.rotl)(S^u,16),w=w+S|0,p=(0,j.rotl)(p^w,12),u=u+p|0,S=(0,j.rotl)(S^u,8),w=w+S|0,p=(0,j.rotl)(p^w,7),o=o+l|0,S=(0,j.rotl)(S^o,16),h=h+S|0,l=(0,j.rotl)(l^h,12),o=o+l|0,S=(0,j.rotl)(S^o,8),h=h+S|0,l=(0,j.rotl)(l^h,7),i=i+f|0,m=(0,j.rotl)(m^i,16),w=w+m|0,f=(0,j.rotl)(f^w,12),i=i+f|0,m=(0,j.rotl)(m^i,8),w=w+m|0,f=(0,j.rotl)(f^w,7),a=a+p|0,x=(0,j.rotl)(x^a,16),d=d+x|0,p=(0,j.rotl)(p^d,12),a=a+p|0,x=(0,j.rotl)(x^a,8),d=d+x|0,p=(0,j.rotl)(p^d,7),u=u+c|0,E=(0,j.rotl)(E^u,16),y=y+E|0,c=(0,j.rotl)(c^y,12),u=u+c|0,E=(0,j.rotl)(E^u,8),y=y+E|0,c=(0,j.rotl)(c^y,7);let C=0;r[C++]=o,r[C++]=i,r[C++]=a,r[C++]=u,r[C++]=m,r[C++]=x,r[C++]=E,r[C++]=S}s(El,"hchacha");ve.chacha20orig=(0,j.createCipher)(gr,{counterRight:!1,counterLength:8,allowShortKeys:!0});ve.chacha20=(0,j.createCipher)(gr,{counterRight:!1,counterLength:4,allowShortKeys:!1});ve.xchacha20=(0,j.createCipher)(gr,{counterRight:!1,counterLength:8,extendNonceFn:El,allowShortKeys:!1});ve.chacha8=(0,j.createCipher)(gr,{counterRight:!1,counterLength:4,rounds:8});ve.chacha12=(0,j.createCipher)(gr,{counterRight:!1,counterLength:4,rounds:12});var Zh=new Uint8Array(16),wl=s((e,t)=>{e.update(t);let n=t.length%16;n&&e.update(Zh.subarray(n))},"updatePadded"),Yh=new Uint8Array(32);function xl(e,t,n,r,o){let i=e(t,n,Yh),a=$h.poly1305.create(i);o&&wl(a,o),wl(a,r);let u=(0,Vt.u64Lengths)(r.length,o?o.length:0,!0);a.update(u);let c=a.digest();return(0,Vt.clean)(i,u),c}s(xl,"computeTag");var Qh=s(e=>(t,n,r)=>({encrypt(i,a){let u=i.length;a=(0,Vt.getOutput)(u+16,a,!1),a.set(i);let c=a.subarray(0,-16);e(t,n,c,c,1);let l=xl(e,t,n,c,r);return a.set(l,u),(0,Vt.clean)(l),a},decrypt(i,a){a=(0,Vt.getOutput)(i.length-16,a,!1);let u=i.subarray(0,-16),c=i.subarray(-16),l=xl(e,t,n,u,r);if(!(0,Vt.equalBytes)(c,l))throw new Error("invalid tag");return a.set(i.subarray(0,-16)),e(t,n,a,a,1),(0,Vt.clean)(l),a}}),"_poly1305_aead");ve._poly1305_aead=Qh;ve.chacha20poly1305=(0,Vt.wrapCipher)({blockSize:64,nonceLength:12,tagLength:16},(0,ve._poly1305_aead)(ve.chacha20));ve.xchacha20poly1305=(0,Vt.wrapCipher)({blockSize:64,nonceLength:24,tagLength:16},(0,ve._poly1305_aead)(ve.xchacha20))});var Sl=re(Vn=>{"use strict";g();b();Object.defineProperty(Vn,"__esModule",{value:!0});Vn.chacha20=Vn.xchacha20=void 0;var vl=_l(),Xh=s(function(e,t,n){return(0,vl.xchacha20poly1305)(e,t,n)},"xchacha20");Vn.xchacha20=Xh;var Jh=s(function(e,t,n){return(0,vl.chacha20poly1305)(e,t,n)},"chacha20");Vn.chacha20=Jh});var Il=re(rt=>{"use strict";g();b();Object.defineProperty(rt,"__esModule",{value:!0});rt.aesDecrypt=rt.aesEncrypt=rt.symDecrypt=rt.symEncrypt=void 0;var ri=Je(),ey=rs(),Al=dl(),ty=Sl(),Bl=nr(),ni=Ur(),ny=s(function(e,t,n){return Cl(oy,e,t,n)},"symEncrypt");rt.symEncrypt=ny;var ry=s(function(e,t,n){return Cl(sy,e,t,n)},"symDecrypt");rt.symDecrypt=ry;rt.aesEncrypt=rt.symEncrypt;rt.aesDecrypt=rt.symDecrypt;function Cl(e,t,n,r){var o=(0,Bl.symmetricAlgorithm)();if(o==="aes-256-gcm")return e(Al.aes256gcm,t,n,(0,Bl.symmetricNonceLength)(),ni.AEAD_TAG_LENGTH,r);if(o==="xchacha20")return e(ty.xchacha20,t,n,ni.XCHACHA20_NONCE_LENGTH,ni.AEAD_TAG_LENGTH,r);if(o==="aes-256-cbc")return e(Al.aes256cbc,t,n,16,0);throw new Error("Not implemented")}s(Cl,"_exec");function oy(e,t,n,r,o,i){var a=(0,ey.randomBytes)(r),u=e(t,a,i),c=u.encrypt(n);if(o===0)return(0,ri.concatBytes)(a,c);var l=c.length-o,f=c.subarray(0,l),p=c.subarray(l);return(0,ri.concatBytes)(a,p,f)}s(oy,"_encrypt");function sy(e,t,n,r,o,i){var a=n.subarray(0,r),u=e(t,Uint8Array.from(a),i),c=n.subarray(r);if(o===0)return u.decrypt(c);var l=c.subarray(0,o),f=c.subarray(o);return u.decrypt((0,ri.concatBytes)(f,l))}s(sy,"_decrypt")});var yo=re(It=>{"use strict";g();b();var iy=It&&It.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:s(function(){return t[n]},"get")}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),ho=It&&It.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&iy(t,e,n)};Object.defineProperty(It,"__esModule",{value:!0});ho(ku(),It);ho(Wu(),It);ho(js(),It);ho(Il(),It)});var oi=re(go=>{"use strict";g();b();Object.defineProperty(go,"__esModule",{value:!0});go.PublicKey=void 0;var Tl=Je(),mo=yo(),ay=function(){function e(t,n){var r=(0,mo.convertPublicKeyFormat)(t,!0,n),o=(0,mo.convertPublicKeyFormat)(t,!1,n);this.data=r,this.dataUncompressed=r.length!==o.length?o:null}return s(e,"PublicKey"),e.fromHex=function(t,n){return new e((0,mo.hexToPublicKey)(t,n),n)},Object.defineProperty(e.prototype,"_uncompressed",{get:s(function(){return this.dataUncompressed!==null?this.dataUncompressed:this.data},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uncompressed",{get:s(function(){return Buffer.from(this._uncompressed)},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"compressed",{get:s(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toBytes=function(t){return t===void 0&&(t=!0),t?this.data:this._uncompressed},e.prototype.toHex=function(t){return t===void 0&&(t=!0),(0,Tl.bytesToHex)(this.toBytes(t))},e.prototype.decapsulate=function(t,n){n===void 0&&(n=!1);var r=this.toBytes(n),o=t.multiply(this,n);return(0,mo.getSharedKey)(r,o)},e.prototype.equals=function(t){return(0,Tl.equalBytes)(this.data,t.data)},e}();go.PublicKey=ay});var Ol=re(bo=>{"use strict";g();b();Object.defineProperty(bo,"__esModule",{value:!0});bo.PrivateKey=void 0;var Ll=Je(),Fn=yo(),cy=oi(),uy=function(){function e(t,n){if(this.curve=n,t===void 0)this.data=(0,Fn.getValidSecret)(n);else if((0,Fn.isValidPrivateKey)(t,n))this.data=t;else throw new Error("Invalid private key");this.publicKey=new cy.PublicKey((0,Fn.getPublicKey)(this.data,n),n)}return s(e,"PrivateKey"),e.fromHex=function(t,n){return new e((0,Fn.decodeHex)(t),n)},Object.defineProperty(e.prototype,"secret",{get:s(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toHex=function(){return(0,Ll.bytesToHex)(this.data)},e.prototype.encapsulate=function(t,n){n===void 0&&(n=!1);var r=this.publicKey.toBytes(n),o=this.multiply(t,n);return(0,Fn.getSharedKey)(r,o)},e.prototype.multiply=function(t,n){return n===void 0&&(n=!1),(0,Fn.getSharedPoint)(this.data,t.toBytes(!0),n,this.curve)},e.prototype.equals=function(t){return(0,Ll.equalBytes)(this.data,t.data)},e}();bo.PrivateKey=uy});var si=re(jn=>{"use strict";g();b();Object.defineProperty(jn,"__esModule",{value:!0});jn.PublicKey=jn.PrivateKey=void 0;var ly=Ol();Object.defineProperty(jn,"PrivateKey",{enumerable:!0,get:s(function(){return ly.PrivateKey},"get")});var fy=oi();Object.defineProperty(jn,"PublicKey",{enumerable:!0,get:s(function(){return fy.PublicKey},"get")})});var Ul=re(ot=>{"use strict";g();b();Object.defineProperty(ot,"__esModule",{value:!0});ot.utils=ot.PublicKey=ot.PrivateKey=ot.ECIES_CONFIG=void 0;ot.encrypt=py;ot.decrypt=yy;var dy=Je(),zn=nr(),Gn=si(),Ft=yo();function py(e,t){return Buffer.from(hy(e,t))}s(py,"encrypt");function hy(e,t){var n=(0,zn.ellipticCurve)(),r=new Gn.PrivateKey(void 0,n),o=e instanceof Uint8Array?new Gn.PublicKey(e,n):Gn.PublicKey.fromHex(e,n),i=r.encapsulate(o,(0,zn.isHkdfKeyCompressed)()),a=r.publicKey.toBytes((0,zn.isEphemeralKeyCompressed)()),u=(0,Ft.symEncrypt)(i,t);return(0,dy.concatBytes)(a,u)}s(hy,"_encrypt");function yy(e,t){return Buffer.from(my(e,t))}s(yy,"decrypt");function my(e,t){var n=(0,zn.ellipticCurve)(),r=e instanceof Uint8Array?new Gn.PrivateKey(e,n):Gn.PrivateKey.fromHex(e,n),o=(0,zn.ephemeralKeySize)(),i=new Gn.PublicKey(t.subarray(0,o),n),a=t.subarray(o),u=i.decapsulate(r,(0,zn.isHkdfKeyCompressed)());return(0,Ft.symDecrypt)(u,a)}s(my,"_decrypt");var gy=nr();Object.defineProperty(ot,"ECIES_CONFIG",{enumerable:!0,get:s(function(){return gy.ECIES_CONFIG},"get")});var Pl=si();Object.defineProperty(ot,"PrivateKey",{enumerable:!0,get:s(function(){return Pl.PrivateKey},"get")});Object.defineProperty(ot,"PublicKey",{enumerable:!0,get:s(function(){return Pl.PublicKey},"get")});ot.utils={aesEncrypt:Ft.aesEncrypt,aesDecrypt:Ft.aesDecrypt,symEncrypt:Ft.symEncrypt,symDecrypt:Ft.symDecrypt,decodeHex:Ft.decodeHex,getValidSecret:Ft.getValidSecret,remove0x:Ft.remove0x}});g();b();g();b();g();b();var $e={};var Mi={...$e,defaultExplorer:"arbiscan",getExplorerUrl:s(function(e){let t;switch(e){case Ao.Sepolia:t="sepolia.";break;case Ao.Mainnet:default:t=""}return{arbiscan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}arbiscan.io/${i}/${o}`},"arbiscan")}},"getExplorerUrl")};g();b();var Hi={...$e,defaultExplorer:"basescan",getExplorerUrl:s(function(e){let t;switch(e){case So.Sepolia:t="sepolia.";break;case So.Mainnet:default:t=""}return{basescan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}basescan.org/${i}/${o}`},"basescan")}},"getExplorerUrl")};g();b();var Ki={getExplorerUrl:s(function(){return{mempool:s((e,t)=>`https://mempool.space/${{transaction:"tx",address:"address"}[e]}/${t}`,"mempool")}},"getExplorerUrl"),defaultExplorer:"mempool"};g();b();var qi={...$e,getExplorerUrl(e){let t;switch(e){case _o.Sepolia:t="sepolia.";break;case _o.Mainnet:default:t=""}return{etherscan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}etherscan.io/${i}/${o}`},"etherscan")}},defaultExplorer:"etherscan"};g();b();var ki={...$e,defaultExplorer:"hyperliquid",getExplorerUrl:s(function(e){let t;switch(e){case Io.Testnet:t="app.hyperliquid-testnet.xyz";break;case Io.Mainnet:default:t="app.hyperliquid.xyz"}return{hyperliquid:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address"}[n];return`https://${t}/explorer/${i}/${o}`},"hyperliquid")}},"getExplorerUrl")};g();b();var Vi={...$e,defaultExplorer:"hyperevmscan",getExplorerUrl:s(function(e){return{hyperevmscan:s((t,n)=>{let r=Array.isArray(n)?n.join("/"):n;return`https://hyperevmscan.io/${{transaction:"tx",address:"address"}[t]}/${r}`},"hyperevmscan")}},"getExplorerUrl"),betaTagOverride:"Lite"};g();b();var Fi={...$e,getExplorerUrl:s(function(e){let t;switch(e){case Bo.Testnet:t="testnet.monadvision.com";break;case Bo.Mainnet:t="monadvision.com";break}return{monadexplorer:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}/${i}/${o}`},"monadexplorer")}},"getExplorerUrl"),defaultExplorer:"monadexplorer",betaTagOverride:"Beta"};g();b();var ji={...$e,getExplorerUrl:s(function(e){let t;switch(e){case vo.Amoy:t="amoy.";break;case vo.Mainnet:default:t=""}return{polygonscan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}polygonscan.com/${i}/${o}`},"polygonscan")}},"getExplorerUrl"),defaultExplorer:"polygonscan"};g();b();var zi={getExplorerUrl:s(function(e){let t;switch(e){case bn.Devnet:t="devnet";break;case bn.Testnet:t="testnet";break;case bn.Mainnet:t="mainnet-beta";break;case bn.Localnet:t="mainnet-beta";break}let n="";return["devnet","testnet"].includes(t)&&(n=`?cluster=${t}`),{"solana-beach":s((r,o)=>`https://solanabeach.io/${r}/${o}${n}`,"solana-beach"),solscan:s((r,o)=>`https://solscan.io/${{transaction:"tx",address:"account"}[r]}/${o}${n}`,"solscan"),"solana-explorer":s((r,o)=>`https://explorer.solana.com/${r}/${o}${n}`,"solana-explorer"),"solana-fm":s((r,o)=>{let i={"mainnet-beta":"mainnet-qn1",testnet:"testnet-solana",devnet:"devnet-solana",localhost:"localhost"}[t];return`https://solana.fm/${{transaction:"tx",address:"address"}[r]}/${o}?cluster=${i}`},"solana-fm"),xray:s((r,o)=>`https://xray.helius.xyz/${{transaction:"tx",address:"token"}[r]}/${o}${n}`,"xray"),orb:s((r,o)=>`https://orb.helius.dev/${{transaction:"tx",address:"address"}[r]}/${o}${n}`,"orb")}},"getExplorerUrl"),defaultExplorer:"solscan"};g();b();var Gi={getExplorerUrl:s(function(e){return{suiscan:s((t,n)=>{let r;switch(e){case Yn.Testnet:r="testnet";break;case Yn.Mainnet:r="mainnet";break}let o={transaction:"tx",address:"account",token:"coin",nft:"object"}[t];return`https://suiscan.xyz/${r}/${o}/${n}`},"suiscan"),suivision:s((t,n)=>{let r;switch(e){case Yn.Testnet:r="testnet.";break;case Yn.Mainnet:r="";break}let o={transaction:"txblock",address:"account",token:"coin",nft:"object"}[t];return`https://${r}suivision.xyz/${o}/${n}`},"suivision")}},"getExplorerUrl"),defaultExplorer:"suivision"};var Ql=new gi({[at.Solana]:zi,[at.Ethereum]:qi,[at.Polygon]:ji,[at.Monad]:Fi,[at.Base]:Hi,[at.Arbitrum]:Mi,[at.Bitcoin]:Ki,[at.Sui]:Gi,[at.Hypercore]:ki,[at.Hyperevm]:Vi}),jt=mi(Ql);g();b();g();b();g();b();g();b();var En=[{value:"en",displayValue:"English",isLocale:!1},{value:"es",displayValue:"Espa\xF1ol",isLocale:!1},{value:"de",displayValue:"Deutsch",isLocale:!1},{value:"fr",displayValue:"Fran\xE7ais",isLocale:!1},{value:"it",displayValue:"Italiano",isLocale:!1},{value:"zh-CN",displayValue:"\u4E2D\u6587(\u7B80\u4F53)",isLocale:!0},{value:"zh-TW",displayValue:"\u4E2D\u6587(\u7E41\u9AD4)",isLocale:!0},{value:"bn",displayValue:"\u09AC\u09BE\u0982\u09B2\u09BE",isLocale:!1},{value:"ja",displayValue:"\u65E5\u672C",isLocale:!1},{value:"ko",displayValue:"\uD55C\uAD6D\uC5B4",isLocale:!1},{value:"ru",displayValue:"P\u0443\u0441\u0441\u043A\u0438\u0439",isLocale:!1},{value:"hi",displayValue:"\u0939\u093F\u0902\u0926\u0940",isLocale:!1},{value:"id",displayValue:"Indonesia",isLocale:!1},{value:"ms",displayValue:"Melayu",isLocale:!1},{value:"th",displayValue:"\u0E44\u0E17\u0E22",isLocale:!1},{value:"vi",displayValue:"Ti\u1EBFng Vi\u1EC7t",isLocale:!1},{value:"pt",displayValue:"Portugu\xEAs",isLocale:!1},{value:"tr",displayValue:"T\xFCrk\xE7e",isLocale:!1},{value:"fil",displayValue:"Filipino",isLocale:!1},{value:"my",displayValue:"\u1019\u103C\u1014\u103A\u1019\u102C\u1018\u102C\u101E\u102C",isLocale:!1},{value:"am",displayValue:"\u12A0\u121B\u122D\u129B",isLocale:!1},{value:"ar",displayValue:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",isLocale:!1},{value:"gu",displayValue:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",isLocale:!1},{value:"ha",displayValue:"Hausa",isLocale:!1},{value:"ig",displayValue:"\xC1s\u1EE5\u0300s\u1EE5\u0301 \xCCgb\xF2",isLocale:!1},{value:"pa",displayValue:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40",isLocale:!1},{value:"sw",displayValue:"Kiswahili",isLocale:!1},{value:"ta",displayValue:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",isLocale:!1},{value:"te",displayValue:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",isLocale:!1},{value:"yo",displayValue:"\xC8d\xE8 Yor\xF9b\xE1",isLocale:!1}];g();b();var Wi=s(()=>{let e=[];return En.forEach(t=>{e.push(t.value),t.isLocale&&e.push(t.value.substr(0,2))}),[...new Set(e)]},"generateSupportedLanguageValues"),Sr=s((e,t)=>e.substr(0,3)==="fil"?t==="fil":e.substr(0,2)==="zh"?e==="zh-TW"?t==="zh-TW":t==="zh-CN":t===e.substr(0,2),"languageMatches"),$i=s(e=>En.find(t=>Sr(e,t.value))?.displayValue,"languageDisplayValue"),Zi=s(e=>En.find(t=>Sr(e,t.value))?.value,"getSupportedLanguageValue");var wg=15,Ar={version:1,addresses:[]},Br={version:1,addresses:[]},Yi=20,Xl=s(()=>{let e={};return He.getAllNetworkIDs().forEach(t=>{let n=jt.get(t).defaultExplorer;n&&(e[t]=n)}),e},"getDefaultExplorers"),Uo={version:1,explorers:Xl()},Qi={orb:"Orb","solana-beach":"Solana Beach",solscan:"Solscan","solana-explorer":"Solana Explorer","solana-fm":"Solana FM",xray:"XRAY",etherscan:"Etherscan",basescan:"Basescan",arbiscan:"Arbiscan",polygonscan:"Polygonscan",mempool:"Mempool",suivision:"SuiVision",suiscan:"Suiscan",monadexplorer:"Monad Explorer",hyperliquid:"Hyperliquid Explorer",hyperevmscan:"HyperEVMScan"},Xi={version:1,apps:{}};var Jl={default:"",light:"1f3fb",medium_light:"1f3fc",medium:"1f3fd",medium_dark:"1f3fe",dark:"1f3ff"},xg={"":"","1f3fb":"\u{1F3FB}","1f3fc":"\u{1F3FC}","1f3fd":"\u{1F3FD}","1f3fe":"\u{1F3FE}","1f3ff":"\u{1F3FF}"},Eg={version:1,skinTone:Jl.default},Ji=hi,ea=!0,ta=_r({minutes:15}),_n=7200;g();b();var Se;(function(e){e.ApiEnvironment="apiEnvironment",e.EmojiSkinTone="emojiSkinTone",e.IsAnalyticsOptedOut="isAnalyticsOptedOut",e.SolanaActionsEnabled="solanaActionsEnabled",e.ShowWalletShortcuts="showWalletShortcuts",e.SelectedCurrency="selectedCurrency",e.SavedAddresses="savedAddresses",e.RecentAddressesBrowser="recentAddresses",e.RecentAddressesMobile="recentAddressesV2"})(Se||(Se={}));g();b();var Cr=s(({networkID:e,endpoint:t,param:n,explorerType:r})=>{let i=jt.get(e).getExplorerUrl(e)[r??jt.get(e).defaultExplorer];return i?i(t,n):""},"generateExplorerUrl"),na=s(e=>{if(!e)return;let{explorers:t}=e,n={};return He.getAllNetworkIDs().forEach(o=>{let i=He.getNetworkName(o),a=t[o];n[i]=a}),{...e,explorers:n}},"formatExplorers");g();b();g();b();var ef=s(e=>{switch(e){case wn.PrivateKey:return xn.t("removeAccountWarningPrivateKey");case wn.Seed:return xn.t("removeAccountWarningSeed");case wn.Ledger:return xn.t("removeAccountWarningLedger");case wn.SeedVault:return xn.t("removeAccountWarningSeedVault");case wn.ReadOnly:return xn.t("removeAccountWarningReadOnly")}},"getAccountRemovalWarning");g();b();var tf=s((e,t)=>e.filter(n=>typeof n.title=="string"&&ra(t,n.title)||ra(t,n.tags?.join(" "))),"filterSearchSettings"),ra=s((e,t)=>{if(t===void 0)return!1;let n=e.toLowerCase();return t.toLowerCase().split(" ").map(r=>r.startsWith(n)||n.startsWith(r)&&t.toLowerCase().includes(n)).includes(!0)},"filterByWordPrefix");g();b();async function nf(e){for(let t of e){let n=await t.get(Ui.NetworkSetting);if(n)return n.setting}return Pi().setting}s(nf,"getNetworkSetting");g();b();g();b();g();b();var rf="currency",of="currencyExchangeRates",Ir={currencyExchangeRates:s(()=>[rf,of,wr],"currencyExchangeRates")};var sf=s(e=>e.queryKey[1]===Ir.currencyExchangeRates()[1]&&e.queryKey[2]===wr,"currencyShouldDehydrateQueryPredicate");g();b();g();b();var af="/currency_exchange/v1/rates",oa=s(async()=>{let e=await mn.api().get(`${af}?from=USD&currencies=${Object.keys(Ot).join(",")}`);if(!gn(e))throw new Error("Failed to fetch exchange rates");return await e.data},"getCurrencyExchangeRates");var cf=_r({hours:2}),g1=s(e=>oe({queryKey:Ir.currencyExchangeRates(),queryFn:oa,enabled:!!e,staleTime:cf,select(t){return e?t?.rates[e]:1}}),"useCurrencyExchangeRates");g();b();var uf=s(()=>{try{let e=vi.getMultivariateAssignment("auto-confirm-session-duration"),t=Number(e);if(!isNaN(t)&&t>0)return t}catch{}return _n},"getMaxSessionDuration");g();b();g();b();var Re="@phantom/settings",ee={appPermissions(e,...t){return[`${Re}:app-permissions`,e,...t]},emojiSkinTone(){return[`${Re}:emoji-skin-tone`]},isAnalyticsOptedOut(){return[`${Re}:is-analytics-opted-out`]},solanaActionsEnabled(){return[`${Re}:solana-actions-enabled`]},showWalletShortcuts(){return[`${Re}:show-wallet-shortcuts`]},preferredExplorers(){return[`${Re}:preferred-explorers`]},recentAddresses(){return[`${Re}:recent-addresses`]},savedAddresses(){return[`${Re}:saved-addresses`]},trustedApps(){return[`${Re}:trusted-apps`]},metaMaskOverride(){return[`${Re}:metamask-override`]},autoConfirm(e,t){return[Re,"auto-confirm",e,t]},allAutoConfirm(e){return[Re,"auto-confirm",e]},allAutoConfirmOnAllAccounts(){return[Re,"auto-confirm"]},autoConfirmLocalhost(){return[Re,"auto-confirm","auto-confirm-localhost:v1"]},webViewDebugging(){return[`${Re}:enable-webview-debugging:v1`]},selectedCurrency(){return[`${Re}:selected-currency`]}};var Ro=V.enum(["ALWAYS_ASK","USE_PHANTOM","USE_METAMASK"]),sa="metaMaskOverride";async function ia(e){let t=await e.get(sa),n=Ro.safeParse(t);return n.success?n.data:Ro.enum.ALWAYS_ASK}s(ia,"getMetaMaskOverrideSetting");function lf(){let e=he();return oe({queryKey:ee.metaMaskOverride(),refetchOnMount:"always",async queryFn(){return ia(e)}})}s(lf,"useMultiChainMetaMaskOverrideSetting");function ff(){let e=he(),t=le(),n=tt();return ae({async mutationFn(r){await aa(e,r),n.capture("metamaskOverrideSettingsChanged",{data:{setting:r}})},async onSuccess(){await t.invalidateQueries({queryKey:ee.metaMaskOverride()})}})}s(ff,"useSetMultiChainMetaMaskOverrideSetting");async function aa(e,t){await e.set(sa,t)}s(aa,"setMetaMaskOverrideSetting");g();b();var df=s(async e=>{if(!Eo)return;let t=await e.get(Se.ApiEnvironment);t&&br(t)},"loadAPIEnvironment"),pf=s(()=>{let e=he();return oe({queryKey:["settings:apiEnvironment"],queryFn:s(async()=>{let t=await e.get(Se.ApiEnvironment);return t?(br(t),t):null},"queryFn"),enabled:Eo})},"useAPIEnvironment"),hf=s(()=>{let e=he(),t=Oi(),n=le();return ae({mutationFn:s(async r=>{await e.set(Se.ApiEnvironment,r),br(r),await yf(t,n),await mf(n)},"mutationFn")})},"useSetApiEnvironment");async function yf(e,t){await e.logOut(),await Promise.all([Ti(t),Di(t)]),await Promise.all([Li(t),Ni(t)])}s(yf,"invalidateAuth");async function mf(e){await e.invalidateQueries({queryKey:["settings:apiEnvironment"]})}s(mf,"invalidateAPIEnvironment");g();b();function gf(e){return vn(t=>{let n=t.explorers[e]??jt.get(e).defaultExplorer;return Qi[n]})}s(gf,"usePreferredExplorerNameForNetworkId");function bf(e,t){return vn(n=>{let r=n.explorers[e];return Cr({networkID:e,endpoint:"address",explorerType:r,param:t})})}s(bf,"useAddressPreferredExplorerUrl");function wf(e){return vn(t=>{if(!e)return"";let n=e.networkID,r=t.explorers[n];return Cr({networkID:n,endpoint:"transaction",explorerType:r,param:e.id})})}s(wf,"useTransactionPreferredExplorerUrl");function vn(e){let t=Ke(),n=ee.preferredExplorers();return oe({queryKey:n,queryFn:s(async()=>{let o=await t.get(me.UserExplorerPreferenceV2);return o?{version:o.version,explorers:{...Uo.explorers,...o.explorers}}:Uo},"queryFn"),select:e})}s(vn,"usePreferredExplorers");function xf(){let e=Ke(),t=le();return ae({mutationFn:s(async({preferredExplorers:o})=>{await e.set(me.UserExplorerPreferenceV2,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.preferredExplorers()})},"onSuccess")})}s(xf,"useSetPreferredExplorers");g();b();var ca=s(async(e,t)=>{let n=await e.get(Se.SolanaActionsEnabled);return n===null?t??!1:n},"checkSolanaActionsEnabled");function Ef(e=!1){let t=he(),n=ee.solanaActionsEnabled();return oe({queryKey:n,queryFn:s(async()=>ca(t,e),"queryFn")})}s(Ef,"useSolanaActionsEnabled");function _f(){let e=he(),t=le();return ae({mutationFn:s(async({enabled:o})=>{await e.set(Se.SolanaActionsEnabled,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.solanaActionsEnabled()})},"onSuccess")})}s(_f,"useSetSolanaActionsEnabled");g();b();var ya=st(yn());g();b();function ua(){let{isReady:e,value:t}=Po(),n=Ke(),r=ee.recentAddresses();return oe({enabled:e,queryKey:r,queryFn:s(async()=>{let i=await n.get(me.UserRecentAddresses);if(!t)throw new Error(Lo);let a=t.enabledChainIDs;return i?fa(i,a):Ar},"queryFn")})}s(ua,"useRecentAddresses");function la(){let{isReady:e,value:t}=Po(),n=Ke(),r=ee.savedAddresses();return oe({enabled:e,queryKey:r,queryFn:s(async()=>{let i=await n.get(me.UserSavedAddresses);if(!t)throw new Error(Lo);let a=t.enabledChainIDs;return i?fa(i,a):Br},"queryFn")})}s(la,"useSavedAddresses");var fa=s((e,t)=>({...e,addresses:e.addresses.filter(n=>t.includes(He.getChainID(n.chainID)))}),"filterAddressesByChain");function qb(){return(e,t)=>{if(t==null)return e;if(e==null)return t;let n=e.addresses,r=t.addresses,o=new Map;n.forEach(a=>{o.set(a.address,a)}),r.forEach(a=>{o.set(a.address,a)});let i=Array.from(o.values());return{...e,addresses:i}}}s(qb,"syncedAddressBookResolver");g();b();function da(){let e=Ke(),t=le();return ae({mutationFn:s(async({recentAddresses:o})=>{await e.set(me.UserRecentAddresses,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.recentAddresses()})},"onSuccess")})}s(da,"useSetRecentAddresses");function pa(){let e=Ke(),t=le();return ae({mutationFn:s(async({savedAddresses:o})=>{await e.set(me.UserSavedAddresses,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.savedAddresses()})},"onSuccess")})}s(pa,"useSetSavedAddresses");var vf=s(()=>{let{data:e=[]}=Ri(),{data:t=Ar}=ua(),{data:n=Br}=la(),{mutate:r}=da(),{mutate:o}=pa();return(0,ya.useMemo)(()=>({recentAddresses:t,savedAddresses:n,addRecentAddress:s(({address:i,chainID:a,timestamp:u=Date.now()})=>Bf(e,t,n,r,{address:i,chainID:a,timestamp:u}),"addRecentAddress"),addSavedAddress:s(i=>Cf(e,t,n,r,o,i),"addSavedAddress"),editSavedAddress:s((i,a)=>If(n,o,i,a),"editSavedAddress"),getExistingAccount:s(i=>Af(e,i),"getExistingAccount"),getSavedAddressLabel:s((i,a)=>ha(n.addresses,i,a),"getSavedAddressLabel"),getKnownAddressLabel:s((i,a)=>ha([n.addresses,Sf(e)].flat(),i,a),"getKnownAddressLabel"),isExistingAccountAddress:s(i=>Do(e,i),"isExistingAccountAddress"),isRecentAddress:s((i,a)=>ma(t,i,a),"isRecentAddress"),isSavedAddress:s((i,a)=>No(n,i,a),"isSavedAddress"),removeRecentAddress:s(i=>ga(t,r,i),"removeRecentAddress"),removeSavedAddress:s(i=>Tf(n,o,i),"removeSavedAddress")}),[e,t,n,r,o])},"useAddressBook"),Sf=s(e=>{let t=[];for(let n of e)t.push(...n.addresses.map(({address:r,networkID:o})=>({address:r,chainID:o,label:n.name})));return t},"getWalletAddresses"),Af=s((e,t)=>e[wa(e,t)],"getExistingAccount"),Do=s((e,t)=>wa(e,t)>-1,"isExistingAccountAddress"),ma=s((e,t,n)=>Sn(e.addresses,{address:t,chainID:n})>-1,"isRecentAddress"),No=s((e,t,n)=>Sn(e.addresses,{address:t,chainID:n})>-1,"isSavedAddress"),Bf=s((e,t,n,r,{address:o,chainID:i,timestamp:a=Date.now()})=>{if(Do(e,o)||No(n,o,i)||ma(t,o,i))return;t.addresses.unshift({address:o,chainID:i,timestamp:a});let{addresses:u}=t;return t.addresses=u.slice(0,Yi),r({recentAddresses:t}),t},"addRecentAddress"),Cf=s((e,t,n,r,o,i)=>{let{address:a,chainID:u}=i;if(Do(e,a)||No(n,a,u))return;ga(t,r,{address:a,chainID:u,timestamp:0});let c={...n,addresses:[...n.addresses,i]};return o({savedAddresses:c}),c},"addSavedAddress"),If=s((e,t,n,r)=>{let o=Sn(e.addresses,n);if(o<0)return;let i=[...e.addresses];i[o]=r;let a={...e,addresses:i};return t({savedAddresses:a}),a},"editSavedAddress"),ga=s((e,t,n)=>{let r=Sn(e.addresses,n);if(r<0)return;let o=[...e.addresses];o.splice(r,1);let i={...e,addresses:o};return t({recentAddresses:i}),i},"removeRecentAddress"),Tf=s((e,t,n)=>{let r=Sn(e.addresses,n);if(r<0)return;let o=[...e.addresses];o.splice(r,1);let i={...e,addresses:o};return t({savedAddresses:i}),i},"removeSavedAddress"),ha=s((e,t,n)=>{let r=Sn(e,{address:t,chainID:n});if(!(r<0))return e[r].label},"getAddressLabel"),ba=s((e,t,n)=>He.isEVMNetworkID(n)?e.toLowerCase()===t.toLowerCase():e===t,"compareAddresses"),wa=s((e,t)=>e.findIndex(n=>n.addresses.find(r=>ba(r.address,t,r.networkID))),"getAccountIndex"),Sn=s((e,t)=>e.findIndex(n=>{let r=t.chainID===n.chainID,o=ba(t.address,n.address,t.chainID);return r&&o}),"getEntryIndex");g();b();g();b();var xa=Lf;function Lf(e){var t,n,r;if(e){if(Array.isArray(e)){for(t=[],n=e.length,r=0;r<n;r++){var o=e[r];o!=null&&t.push(o)}return t}if(typeof e=="object"){t={};var i=Object.keys(e);for(n=i.length,r=0;r<n;r++){var a=i[r],u=e[a];u!=null&&(t[a]=u)}return t}}}s(Lf,"flush");var Sa=st(Mo());g();b();var Of=V.object({chainType:V.union([V.literal("bip122_p2wpkh"),V.literal("bip122_p2tr")]),chainName:V.literal("bitcoin"),networkId:V.union([V.literal("128"),V.literal("239")])}),Pf=V.object({chainType:V.literal("eip155"),chainName:V.literal("ethereum"),networkId:V.union([V.literal("1"),V.literal("5"),V.literal("11155111")])}),Uf=V.object({chainType:V.literal("eip155"),chainName:V.literal("polygon"),networkId:V.union([V.literal("137"),V.literal("80002")])}),Rf=V.object({chainType:V.literal("eip155"),chainName:V.literal("base"),networkId:V.union([V.literal("8453"),V.literal("84532")])}),Df=V.object({chainType:V.literal("eip155"),chainName:V.literal("arbitrum"),networkId:V.union([V.literal("42161"),V.literal("421614")])}),Nf=V.object({chainType:V.literal("eip155"),chainName:V.literal("hyperevm"),networkId:V.union([V.literal("999"),V.literal("998")])}),Mf=V.object({chainType:V.literal("eip155"),chainName:V.literal("monad"),networkId:V.union([V.literal("143"),V.literal("10143"),V.literal("41454")])}),_a=V.object({chainType:V.literal("solana"),chainName:V.literal("solana"),networkId:V.union([V.literal("mainnet"),V.literal("testnet"),V.literal("devnet"),V.literal("localnet")])}),Hf=V.object({chainType:V.literal("sui"),chainName:V.literal("sui"),networkId:V.union([V.literal("mainnet"),V.literal("testnet")])}),va=V.union([Of,Pf,Rf,Df,Nf,Mf,Uf,_a,Hf]);var Ho=s(()=>["t","y","1","true","yes"].some(e=>T.DISABLE_ANALYTICS?.toLowerCase()===e)??!1,"isAnalyticsDisabled");function Ko(e){if(!e)return;let t=e.data??{},n=e.data?.asset??{};try{t=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(n))}catch(o){Sa.default.error("Failed to parse analytics payload",o);return}let r={...t,...e.action?{action:e.action}:{},...n&&typeof n=="object"?n:{},...e.type?{type:e.type}:{}};if("chainID"in r&&!("chainType"in r)&&!("chainName"in r)&&!("networkId"in r)){let o=xr.safeParse(r.chainID);o.success&&Object.assign(r,Aa(o.data))}return xa(r)}s(Ko,"parseAnalyticsPayload");function Aa(e){let t=He.getChainDefinition(e);return va.parse({chainType:t.addressTypes[0],chainName:t.id,networkId:t.networks[e].value.toString()})}s(Aa,"chainFromNetworkID");g();b();g();b();var qo=T.RUDDERSTACK_DATAPLANE??T.VITE_RUDDERSTACK_DATAPLANE??"https://data.phantom.app",Kf=T.RUDDERSTACK_KEY_EXT,qf=T.RUDDERSTACK_KEY_WEB,kf=T.RUDDERSTACK_KEY_PORTAL;g();b();function Xn(e,{action:t,data:n}){let r={action:t,data:n};return e.capture("actionApprovedByUser",r)}s(Xn,"actionApprovedByUser");function Jn(e,{action:t,data:n}){let r={action:t,data:{...n,chainId:n.chainId??n.networkId}};return e.capture("actionDeniedByUser",r)}s(Jn,"actionDeniedByUser");function ko(e,{action:t,data:n}){let r={type:"transaction",data:{...n,chainId:n.chainId??n.networkId},action:t};return(!r.data.ids||r.data.ids.length===0)&&We.captureError(new Error("No ids found in transactionSubmitted payload"),Ge.Provider),e.capture("transactionSubmitted",r)}s(ko,"transactionSubmitted");function Vf(e,{action:t,data:n}){let r={data:{...n,chainId:n.chainId??n.networkId},action:t};return e.capture("transactionStatus",r)}s(Vf,"transactionStatus");function Vo(e,t){let n={type:"message",data:{...t,chainId:t.chainId??t.networkId}};return e.capture("transactionSubmitted",n)}s(Vo,"messageSigned");var Pt=class{static{s(this,"SequenceAnalytics")}analytics;action;constructor(t,n){this.analytics=t,this.action=n}approved=s(t=>{Xn(this.analytics,{action:this.action,data:{...t,chainId:t.chainId??t.networkId}})},"approved");denied=s(async t=>{Jn(this.analytics,{action:this.action,data:{...t,chainId:t.chainId??t.networkId}})},"denied");submittedTransaction=s(async(t,n)=>{ko(this.analytics,{action:this.action,data:{...n,ids:n.ids??[t],chainId:n.chainId??n.networkId}})},"submittedTransaction");signedMessage=s(async t=>{Vo(this.analytics,{...t,chainId:t.chainId??t.networkId})},"signedMessage");transactionStatus=s(async(t,n)=>{n.ids||(n.ids=[t]),Vf(this.analytics,{action:this.action,data:{...n,chainId:n.chainId??n.networkId}})},"transactionStatus")};async function Ba(e,t,n){let{origin:r}=t;switch(e.method){case"eth_sendTransaction":{let[o]=e.params,i=it(o.chainId);return i?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${o.chainId}) for method "${e.method}"`}:{success:!0,data:{...i,origin:r,method:e.method,gas:o.gas,maxFeePerGas:o.maxFeePerGas,maxPriorityFeePerGas:o.maxPriorityFeePerGas,ids:n}}}case"sol_signTransaction":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signTransaction",ids:n}}}case"sol_signAndSendTransaction":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signAndSendTransaction",ids:n}}}case"sol_signAndSendAllTransactions":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signAndSendAllTransactions",ids:n}}}case"sol_signAllTransactions":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signAllTransactions",ids:n}}}}}s(Ba,"transactionSignatureEventPayloadFromRpcRequest");async function Ca(e,t){let{origin:n}=t;switch(e.method){case"eth_sign":case"personal_sign":{let r=t.chainId,o=it(r);return o?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${r}) for method "${e.method}"`}:{success:!0,data:{...o,method:e.method,origin:n}}}case"eth_signTypedData":{let[r]=e.params,o=t.chainId;for(let a of r)if(a.name==="chainId"){o=a.value;break}let i=it(o);return i?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${o}) for method "${e.method}"`}:{success:!0,data:{...i,method:e.method,origin:n}}}case"eth_signTypedData_v3":{let[r,o]=e.params,i=o.domain.chainId??t.chainId,a=it(i);return a?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${i}) for method "${e.method}"`}:{success:!0,data:{...a,method:e.method,origin:n}}}case"eth_signTypedData_v4":{let[r,o]=e.params,i=t.chainId;(typeof o.domain.chainId=="string"||typeof o.domain.chainId=="number")&&(i=o.domain.chainId);let a=it(i);return a?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${i}) for method "${e.method}"`}:{success:!0,data:{...a,method:e.method,origin:n}}}case"sol_signIn":case"sol_signMessage":{let r=t.chainId,o=it(r);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${r}) for method "${e.method}"`}:{success:!0,data:{...o,method:e.method==="sol_signIn"?"signIn":"signMessage",origin:n}}}}}s(Ca,"messageSignatureEventPayloadFromRpcRequest");g();b();g();b();var ht=st(Mo());var Ut="[Analytics Log]",Lr=class{static{s(this,"MockAnalytics")}storage;constructor(t){this.storage=t}capture(t,n){ht.default.debug(Ut,"Capture Event:",t,Ko(n))}addUserProperties(t){ht.default.debug(Ut,"User Properties:",JSON.stringify(t))}identify(t,n){ht.default.debug(Ut,"Identify, id:",t," traits:",n)}async getDeviceId(){return"mock-device-id"}setDeviceId(t){ht.default.debug(Ut,`SetDeviceId: ${t}`)}async getAnonymousId(){return"mock-anonymous-id"}async setAnalyticsOptedOut(t){ht.default.debug(Ut,`SetAnalyticsOptedOut: ${t}`)}async setDisplayLanguage(t){ht.default.debug(Ut,`SetDisplayLanguage: ${t}`)}screen(t,n){ht.default.debug(Ut,`Screen: ${t}`,n)}page(t,n,r,o){ht.default.debug(Ut,`Page: ${t}`,n,r,o)}async flushAnalytics(){ht.default.debug(Ut,"Flush Analytics")}rudderClient};var Ia=s(()=>qo,"getRudderstackDataplane"),Ff=s(({storage:e,rudderStackKey:t,createAnalytics:n})=>{if(!t)throw new Error("RUDDERSTACK_KEY_[*] env variables required.");let r=Ia();if(!r)throw new Error("[*]_RUDDERSTACK_DATAPLANE env variables required.");return Ho()?new Lr(e):n(t,r)},"initAnalytics");g();b();g();b();var jf="burn",Ta=s(e=>new Pt(e,jf),"createBurnAnalytics");g();b();var zf="send",La=s(e=>new Pt(e,zf),"createSendAnalytics");var Fo={};$l(Fo,{action:()=>Or,createDappAnalytics:()=>Gf,userApprovedAction:()=>Wf,userDeniedAction:()=>$f});g();b();var Or="dapp",Gf=s(e=>new Pt(e,Or),"createDappAnalytics");function Wf(e,t){Xn(e,{action:Or,data:{...t,chainId:t.networkId}})}s(Wf,"userApprovedAction");function $f(e,t){Jn(e,{action:Or,data:{...t,chainId:t.networkId}})}s($f,"userDeniedAction");var Zf=s(e=>({send:La(e),burn:Ta(e)}),"createSequenceAnalytics");g();b();function An(){}s(An,"noOp");async function Oa(){}s(Oa,"asyncNoOp");var Yf=s(()=>({capture:An,addUserProperties:An,identify:An,getDeviceId:s(async()=>"","getDeviceId"),setDeviceId:An,setAnalyticsOptedOut:Oa,setDisplayLanguage:Oa,screen:An,page:An,rudderClient:{}}),"createNoOpAnalytics");g();b();g();b();async function zt(e){return await e.get(zo)??Xi}s(zt,"getTrustedApps");function jo(){let e=he();return oe({queryKey:ee.trustedApps(),refetchOnMount:"always",async queryFn(){return await zt(e)}})}s(jo,"useTrustedApps");async function Gt(e,t){await e.set(zo,t)}s(Gt,"setTrustedApps");function Qf(){let e=he(),t=le();return ae({async mutationFn({trustedApps:n}){await Gt(e,n)},async onSuccess(){await t.invalidateQueries({queryKey:ee.trustedApps()})}})}s(Qf,"useSetTrustedApps");var zo=me.UserTrustedApps;g();b();function Xf(){let e=Ke(),t=ee.emojiSkinTone();return oe({queryKey:t,queryFn:s(async()=>await e.get(Se.EmojiSkinTone),"queryFn")})}s(Xf,"useEmojiSkinTone");function Jf(){let e=Ke(),t=le();return ae({mutationFn:s(async({skinTone:o})=>{await e.set(Se.EmojiSkinTone,{version:1,skinTone:o})},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.emojiSkinTone()})},"onSuccess")})}s(Jf,"useSetEmojiSkinTone");g();b();var Pa=s(async e=>await e.get(Se.IsAnalyticsOptedOut)??Ji,"checkIsAnalyticsOptedOut");function Go(){let e=Ke(),t=ee.isAnalyticsOptedOut();return oe({queryKey:t,queryFn:s(async()=>Pa(e),"queryFn")})}s(Go,"useIsAnalyticsOptedOut");function ed(){let e=Ke(),t=tt(),n=le();return ae({mutationFn:s(async({isAnalyticsOptedOut:i})=>{await e.set(Se.IsAnalyticsOptedOut,i),await t.setAnalyticsOptedOut(i)},"mutationFn"),onSuccess:s(()=>{n.invalidateQueries({queryKey:ee.isAnalyticsOptedOut()})},"onSuccess")})}s(ed,"useSetIsAnalyticsOptedOut");g();b();var td=st(yn());var nd=s(()=>{let e=he(),t=s(async()=>!!await e.get(me.BalanceHiddenStatus),"queryFn"),{data:n}=oe({queryKey:[me.BalanceHiddenStatus],queryFn:t});return n??!1},"useIsBalanceHidden"),rd=s(()=>{let e=he(),t=le(),n=s(async o=>await e.set(me.BalanceHiddenStatus,o),"mutationFn"),{mutateAsync:r}=ae({mutationFn:n,onMutate:s(async o=>{await t.cancelQueries({queryKey:[me.BalanceHiddenStatus]});let i=t.getQueryData([me.BalanceHiddenStatus]);return t.setQueryData([me.BalanceHiddenStatus],o),{previousIsBalanceHidden:i}},"onMutate"),onError:s((o,i,a)=>{t.setQueryData([me.BalanceHiddenStatus],a?.previousIsBalanceHidden)},"onError"),onSuccess:s(()=>{t.invalidateQueries({queryKey:[me.BalanceHiddenStatus]})},"onSuccess")});return r},"useSetIsBalanceHidden");g();b();var od=s(()=>{let e=he(),t=s(async()=>await e.get(me.LockTimerMs)??ta,"queryFn");return oe({queryKey:[me.LockTimerMs],queryFn:t})},"useLockTimer"),sd=s(()=>{let e=he(),t=le();return ae({mutationFn:s(async({lockTimeInMs:r})=>(We.addBreadcrumb(Ge.Account,`Lock timer updated to ${r}ms`,dt.Debug),await e.set(me.LockTimerMs,r)),"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:[me.LockTimerMs]})},"onSuccess")})},"useSetLockTimer");g();b();function id(){let e=he(),t=ee.showWalletShortcuts();return oe({queryKey:t,queryFn:s(async()=>{let r=await e.get(Se.ShowWalletShortcuts);return r!=null?r==="true":ea},"queryFn")})}s(id,"useShowWalletShortcutsSettings");function ad(){let e=he(),t=le();return ae({mutationFn:s(async({showWalletShortcuts:o})=>{await e.set(Se.ShowWalletShortcuts,o?"true":"false")},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.showWalletShortcuts()})},"onSuccess")})}s(ad,"useSetShowWalletShortcutsSettings");g();b();g();b();g();b();var Wo=s(()=>{let e=_i("auto-confirm-session-duration");return typeof e=="number"&&e>0?e:_n},"useMaxSessionDuration");var Ua=s((e=7200)=>({networks:{},maxSessionDuration:e}),"createDefaultSettings"),cd=V.object({networks:V.record(xr,V.boolean()),sessionStartTime:V.number().optional(),maxSessionDuration:V.number().positive()}),ud=V.record(V.string(),cd);function Ra(e){let{sessionStartTime:t=0,maxSessionDuration:n=_n,networks:r={}}=e??{};return Object.values(r).some(i=>i===!0)&&t>Date.now()-n*1e3}s(Ra,"isAutoConfirmSessionActive");async function ld(e,t){let r={...await zt(e)};for(let o of Object.keys(r.apps[t]))r.apps[t][o].autoConfirm&&delete r.apps[t][o].autoConfirm;await Gt(e,r)}s(ld,"endAllAutoConfirmForAccountIdentifier");async function $o(e){let n={...await zt(e)};for(let r of Object.keys(n.apps))for(let o of Object.keys(n.apps[r]))Ii(o)&&n.apps[r][o].autoConfirm&&delete n.apps[r][o].autoConfirm;await Gt(e,n)}s($o,"endAllAutoConfirmForLocalhostDomains");async function Zo(e,t,n,r=7200){let o=n.replace(/\/$/,""),i=await zt(e),a=i?.apps?.[t]?.[o]??{},u=a?.autoConfirm??Ua(r);if(a?.autoConfirm){let c=Object.values(u.networks).some(f=>f===!0);Ra(a?.autoConfirm)===!1&&c&&(u=await pd(a.autoConfirm),u=u??Ua(r))}return a.autoConfirm=u,await Gt(e,i),a.autoConfirm}s(Zo,"getAutoConfirmSettingsForDomain");async function Da(e,t,n,r,o=7200){let i=n.replace(/\/$/,"");await Zo(e,t,i,o);let a=await zt(e);a.apps[t]&&a.apps[t][i]&&(a.apps[t][i].autoConfirm=r),await Gt(e,a)}s(Da,"setAutoConfirmSettingsForDomain");function fd(e,t){let n=he(),r=le(),o=t.replace(/\/$/,""),i=Wo();return{set:ae({async mutationFn(a){await Da(n,e,o,a,i)},async onSuccess(){await r.invalidateQueries({queryKey:ee.trustedApps()}),await r.invalidateQueries({queryKey:ee.allAutoConfirm(e)})}}),remove:ae({async mutationFn(){let a=await zt(n);a.apps[e][t]?.autoConfirm&&delete a.apps[e][t].autoConfirm,await Gt(n,a)},async onSuccess(){await r.invalidateQueries({queryKey:ee.autoConfirm(e,t)})}}),get:oe({queryKey:ee.autoConfirm(e,t),refetchOnMount:"always",async queryFn(){return await Zo(n,e,t,i)}})}}s(fd,"useAutoConfirmSettings");function dd(e){let t=he(),n=le();return{removeAll:ae({async mutationFn(){return await ld(t,e)},async onSuccess(){await n.invalidateQueries({queryKey:ee.trustedApps()}),await n.resetQueries({queryKey:ee.allAutoConfirm(e)})}})}}s(dd,"useAllAutoConfirmSettings");function pd(e){if(!e?.networks)return e;for(let t of Object.keys(e?.networks))e.networks[t]=!1;return e}s(pd,"markSessionExpired");var hd=V.boolean(),Na="autoConfirmLocalhost";async function Ma(e){let t=await e.get(Na),n=hd.safeParse(t);return n.success?n.data:!1}s(Ma,"getAutoConfirmLocalhost");function yd(){let e=he();return oe({queryKey:ee.autoConfirmLocalhost(),refetchOnMount:"always",async queryFn(){return Ma(e)}})}s(yd,"useAutoConfirmLocalhost");function md(){let e=he(),t=le();return ae({async mutationFn(n){await gd(e,n),n===!1&&(await $o(e),await t.invalidateQueries({queryKey:ee.allAutoConfirmOnAllAccounts()}))},async onSuccess(){await t.invalidateQueries({queryKey:ee.autoConfirmLocalhost()}),await t.invalidateQueries({queryKey:["auto-confirm"]})}})}s(md,"useSetAutoConfirmLocalhost");async function gd(e,t){await e.set(Na,t)}s(gd,"setAutoConfirmLocalhost");g();b();var Ha=st(yn());var bd=s(()=>{let{data:e,isFetching:t}=jo(),{data:n,isFetching:r}=Go(),{data:o,isFetching:i}=vn(),a=t||r||i;return(0,Ha.useMemo)(()=>({data:{"Analytics Opt Out":n,"Preferred Explorers":na(o),"Trusted Apps":e},isFetching:a}),[n,a,o,e])},"useSettingsExport");g();b();g();b();g();b();g();b();var ka=st(Zl());g();b();var Ka=st(Yl());async function Bn({kms:e,organization:t,newPolicy:n,appId:r,analytics:o}){let i=t.users.filter(c=>c.traits?.appId===r&&(!("policy"in c)||!(0,Ka.default)(c.policy,n))),a=t.organizationId,u="usdLimit"in n?n.usdLimit?.usdCentsLimitPerDay:null;await e.batchRpcCall(i.map(c=>Ai("updateUserInOrganization",{organizationId:a,username:c.username,newPolicy:n})));for(let{username:c}of i)o?.capture("userUpdatedInOrganization",{data:{appId:r,organizationId:a,username:c,usdCentsLimitPerDay:u}})}s(Bn,"alignPolicies");g();b();g();b();var Pr=new Tt.PublicKey("L2TExMFKdjpN9kozasaurPirfHy9P8sbXoAN1qA3S95"),wd="https://node-proxy.phantom.app";async function qa(e,t="mainnet"){let n=Ed(t),r=new Tt.Connection(n,{commitment:"confirmed",confirmTransactionInitialTimeout:5e3});for(let o=0;o<=255;o++){let[i,a]=xd(e,o);try{if(await r.getAccountInfo(i))continue;return{memoryAccount:i.toBase58(),memoryId:o,memoryBump:a}}catch{return{memoryAccount:i.toBase58(),memoryId:o,memoryBump:a}}}throw new Error("All 256 memory PDAs are already initialized for this wallet")}s(qa,"findAvailableMemoryPda");function xd(e,t){if(t<0||t>255)throw new Error("memoryId must be between 0 and 255");return Tt.PublicKey.findProgramAddressSync([Buffer.from("memory"),e.toBuffer(),Buffer.from([t])],Pr)}s(xd,"findMemoryPda");function Ed(e="mainnet"){return`${wd}/v1/chain/solana/network/${e}`}s(Ed,"getPhantomSolanaRpcUrl");var _d={ethereumMessage:!0,ethereumTx:!0,ethereumTypedData:!0,rawPayload:!0,solanaTx:!0,utf8Message:!0},vd="457ad40e-ecca-4b47-a845-8e1efc6b61b3";var Sd="2b4308d3-e072-4f31-b890-4bd14ed6e546",Ad={[vd]:["HK4ai9cQNxF9Btu2aUXNiqGLKF88p3ep2cVEtYo7uK4m","5sfw7sNCmg5cm8naGX13uWD2gepKCQV1C18LWZAqCgRx","H51qLFCVJXtXHPv55W59L1ZHix9kY9eGPYGdFYCbv486","HFEvn5mqk5g138ZVWz2NU6hsFMYumAsrpqJpTvsiEyr8","ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL","TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA","11111111111111111111111111111111","ComputeBudget111111111111111111111111111111",Pr.toBase58()],[Sd]:["HK4ai9cQNxF9Btu2aUXNiqGLKF88p3ep2cVEtYo7uK4m","5sfw7sNCmg5cm8naGX13uWD2gepKCQV1C18LWZAqCgRx","H51qLFCVJXtXHPv55W59L1ZHix9kY9eGPYGdFYCbv486","HFEvn5mqk5g138ZVWz2NU6hsFMYumAsrpqJpTvsiEyr8","ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL","TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA","11111111111111111111111111111111","ComputeBudget111111111111111111111111111111",Pr.toBase58()]};async function Cn(e){let t=null;e.usdCentsLimitPerDay&&(t=await Bd({kms:e.kms,userOrganizationId:e.userOrganizationId,walletId:e.walletId,usdCentsLimitPerDay:e.usdCentsLimitPerDay,appId:e.appId}));let n=Ad[e.appId];return{type:"CEL",preset:"DAPP_CONNECTION_USER",walletId:e.walletId,usdLimit:t,allowedMethods:_d,solanaProgramAllowlist:n??null}}s(Cn,"getPolicy");async function Bd(e){try{We.addBreadcrumb(Ge.PhantomConnect,"Deriving memory account for spending limits",dt.Info,{walletId:e.walletId});let t=await Cd(e);return We.addBreadcrumb(Ge.PhantomConnect,"Derived memory account for spending limits",dt.Info,t),{usdCentsLimitPerDay:e.usdCentsLimitPerDay,memoryAccount:t.memoryAccount,memoryId:t.memoryId,memoryBump:t.memoryBump}}catch(t){let n=t instanceof Error?t.message:String(t);return We.captureError(t instanceof Error?t:new Error(n),Ge.PhantomConnect),We.addBreadcrumb(Ge.PhantomConnect,"Failed to derive memory account, continuing without spending limits",dt.Error),null}}s(Bd,"_getSpendingLimit");async function Cd(e){try{let n=(await e.kms.getOrganization({organizationId:e.userOrganizationId})).result.users.map(r=>{if(r.traits?.appId!==e.appId||!("policy"in r))return null;let o=vr.safeParse(r.policy);return o.success?o.data:null}).find(r=>r!==null);if(!n?.usdLimit)throw new Error("No existing spending limit policy found");return{memoryAccount:n.usdLimit.memoryAccount,memoryId:n.usdLimit.memoryId,memoryBump:n.usdLimit.memoryBump}}catch{let t=await Id({kms:e.kms,userOrganizationId:e.userOrganizationId,walletId:e.walletId});return await qa(t)}}s(Cd,"_getOrFindAvailableMemoryAccountPda");async function Id(e){let t=null;try{let o=(await pt()).filter(i=>i.addressFormat==="Solana");t=await e.kms.getAccounts({organizationId:e.userOrganizationId,walletId:e.walletId,accounts:o})}catch(r){let o=r instanceof Error?r.message:String(r);throw new Error(`Failed to get accounts: ${o}`)}let n=t?.result.find(r=>r.addressFormat==="Solana");if(!n)throw new Error("No Solana address found");return new Tt.PublicKey(n.address)}s(Id,"_getSolanaAccount");async function Va({kms:e,userOrganizationId:t,publicKey:n,expiresInMs:r,appId:o,walletId:i,usdCentsLimitPerDay:a}){if(!o||o==="unknown")throw new Error("App ID is required and cannot be 'unknown'");let u=n.slice(0,8),c=n.slice(-8);try{let l=await Cn({kms:e,userOrganizationId:t,appId:o,usdCentsLimitPerDay:a,walletId:i}),f="preset"in l?l.preset:"CUSTOM";We.addBreadcrumb(Ge.PhantomConnect,"Starting addUserToOrganization",dt.Info,{organizationId:t,publicKeyPreview:u,appId:o,expiresInMs:r,policyType:f,usdCentsLimitPerDay:a});let p=`user_${u}${Date.now()}${c}`,d=Er(ka.default.decode(n)),y={username:p,traits:{appId:o},authenticators:[{authenticatorKind:"keypair",publicKey:d,algorithm:"Ed25519",authenticatorName:`auth_${u}`}],expiresInMs:r,policy:l},h=await e.addUserToOrganization({organizationId:t,user:y,replaceExpirable:!0});Ei("spending_limits_cumulative")&&await Bn({kms:e,organization:h.result,newPolicy:l,appId:o}),We.addBreadcrumb(Ge.PhantomConnect,"Successfully added user to organization",dt.Info,{organizationId:t,publicKeyPreview:u,appId:o,policyType:f,usdCentsLimitPerDay:a});let m=h.getByPublicKey(n);if(!m)throw new Error("User was added to organization but could not be found in the response");return{userOrganization:h.result,user:m}}catch(l){let f=l instanceof Error?l.message:String(l);throw We.captureError(l instanceof Error?l:new Error(f),Ge.PhantomConnect),We.addBreadcrumb(Ge.PhantomConnect,"Failed to add user to organization",dt.Error,{organizationId:t,publicKeyPreview:u,appId:o,error:f}),new Error(`Failed to add user to current user's organization: ${f}`)}}s(Va,"addUserToCurrentUserOrganization");g();b();g();b();var Ze="vault",er="00000000-0000-0000-0000-000000000000",tr="00000000-0000-0000-0000-000000000001",Yo=[er,tr],Td=7*24*60*60*1e3;g();b();var Wn=st(Ul());function by(e,t){return Wn.ECIES_CONFIG.ellipticCurve="x25519",Wn.ECIES_CONFIG.symmetricAlgorithm="aes-256-gcm",Wn.ECIES_CONFIG.symmetricNonceLength=16,(0,Wn.encrypt)(e,t)}s(by,"encryptWithPublicKey");async function ii(e,t,n,r,o=Ze){try{let a=(await e.initWalletImport({organizationId:n})).result,u;if(r.length>0)u=r[0].identifier;else throw new Error("No seed available in vault for migration");let c=await t.exportEntropy(u),d=(await c.foldAsync(Bi)).mnemonic.toString().split(" ").length;if(d!==12&&d!==24)throw new Error(`Invalid mnemonic length: expected 12 or 24 words, got ${d} words`);let y=await pt();if(y.length===0)throw new Error("No valid accounts found for migration");let h=await c.foldAsync(async m=>{let x=yi(a.publicKey),E=await by(x,new Uint8Array(m));return Er(Buffer.from(E))}),w=await e.completeImportWallet({organizationId:n,importEnvelope:a,encryptedSecret:h,walletName:"Migrated Juicebox Wallet",accounts:y,mnemonicLength:d,tags:[o]});return{organizationId:n,walletId:w.result.walletId,walletName:w.result.walletName,accounts:w.result.accounts}}catch(i){throw i instanceof Error?new Error(`Failed to migrate Juicebox wallet: ${i.message}`):new Error(`Failed to migrate Juicebox wallet: ${String(i)}`)}}s(ii,"migrateJuiceboxWallet");async function ai(e,t,n,r=Ze){let o=await pt(),{result:{organizationId:i}}=await e.getOrCreatePhantomOrganization(),{result:a}=await e.getWalletWithTag({organizationId:i,tag:r,accounts:o});return a?{organizationId:i,isNewlyCreated:!1,isSeedless:!0,...a}:{...await ii(e,t,i,n,r),isNewlyCreated:!0,isSeedless:!0}}s(ai,"getOrMigrateJuiceboxWallet");g();b();async function Rl(e,t,n=Ze){let r=await pt(),i=(await t.fetchAllSeedlessMetas()).length>0,{result:{organizationId:a}}=await e.getOrCreatePhantomOrganization(),{result:u}=await e.getWalletWithTag({organizationId:a,tag:n,accounts:r});return u?{organizationId:a,needsCreation:!1,isSeedless:i,wallet:u}:{organizationId:a,needsCreation:!0,isSeedless:i,wallet:void 0}}s(Rl,"getKMSWalletStatus");g();b();g();b();async function Dl(e,t=Ze){let n=await pt(),{result:{organizationId:r}}=await e.getOrCreatePhantomOrganization(),{result:o}=await e.getWalletWithTag({organizationId:r,tag:t,accounts:n});if(o)return{organizationId:r,...o,isNewlyCreated:!1,isSeedless:!1};let{result:{walletId:i,walletName:a,accounts:u}}=await e.getOrCreateWalletWithTag({organizationId:r,walletName:"Phantom Wallet",tag:t,mnemonicLength:24,accounts:n});return{organizationId:r,walletId:i,walletName:a,accounts:u,isNewlyCreated:!0,isSeedless:!1}}s(Dl,"getOrCreateDerivedWalletFromSeedphrase");async function Nl(e,t){let n=await t.fetchAllSeedlessMetas();return n.length>0?ai(e,t,n,Ze):Dl(e,Ze)}s(Nl,"retrieveKMSWallet");g();b();function Ml(e){try{let t=new URL(e),n=t.protocol,r=t.hostname.toLowerCase(),o=t.port;return{origin:n==="https:"&&(o===""||o==="443")?`https://${r}`:n==="http:"&&(o===""||o==="80")?`http://${r}`:`${n}//${r}${o?`:${o}`:""}`,host:r,protocol:n}}catch{return{host:e.toLowerCase()}}}s(Ml,"normalizeOrigin");function Hl(e,t){let n;try{n=new URL(e)}catch{return!1}let r=Ml(e);return t.some(o=>{let i=Ml(o);return i.origin?i.origin===r.origin:i.host?i.host===n.hostname.toLowerCase():!1})}s(Hl,"isOriginWhitelisted");async function Kl(e){try{let t=await mn.api().get(`/v1/wallets/whitelist/${e}`);return gn(t)?await t.data:null}catch{return null}}s(Kl,"fetchWhitelist");async function wy(e,t){let n=await Kl(e);return n?n.status==="DISABLED"?{allowed:!1,reason:"whitelist_disabled"}:Hl(t,n.domains??[])?{allowed:!0}:{allowed:!1,reason:"origin_not_whitelisted"}:{allowed:!1,reason:"missing_or_inaccessible_whitelist"}}s(wy,"validateAppOrigin");var ci=st(yn());var kl="unknown",xy={appId:kl,title:"Unknown",imageUrl:"",origin:"",expiresAtMs:-1,createdAtMs:-1},ql={[er]:{appId:er,title:"Phantom",imageUrl:"https://dhc7eusqrdwa0.cloudfront.net/assets/phantom.png",origin:"https://phantom.app"},[tr]:{appId:tr,title:"Phantom Terminal",imageUrl:"https://dhc7eusqrdwa0.cloudfront.net/assets/phantom.png",origin:"https://trade.phantom.com"}},Vl={staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,retryOnMount:!1},Ey="@phantom/kms",_y={getPhantomOrganization:s(e=>[`${Ey}:getPhantomOrganization`,pi(),e],"getPhantomOrganization")};function wo(e){return{queryKey:_y.getPhantomOrganization(e.accountIdentifier),queryFn:s(async()=>await e.kms.getPhantomOrganization({}),"queryFn"),...Vl}}s(wo,"getPhantomOrganizationQueryOptions");function vy(e){let n=Qn().getKMSInstance(),r=wo({accountIdentifier:e,kms:n}),{data:o,error:i,isPending:a}=oe(r),u=o?.result??null,c=(0,ci.useMemo)(()=>u?By(u):[],[u]),l=ee.appPermissions(e,...c);return oe({queryKey:l,queryFn:s(async()=>{if(i)throw i;if(!u)throw new Error("Phantom organization not found");return await Sy(u,c)},"queryFn"),...Vl,enabled:!a})}s(vy,"useGetAppPermissions");async function Sy(e,t){if(t.length===0)return[];let n=t.filter(o=>o!==kl&&!Yo.includes(o)),r=[];if(n.length>0){let o=`/portal/v1/apps/metadata?ids=${n.join(",")}`,i=await mn.api().get(o);if(gn(i)&&Array.isArray(i.data))r=i.data;else if(!t.some(u=>ql[u]!==void 0))throw new Error("Failed to fetch metadata for apps")}return t.map(o=>{let i=ql[o],a=r.find(c=>c.id===o);if(i??a){let c=e.users.filter(p=>p.traits?.appId===o),l=Math.min(...c.map(p=>p.createdAtMs??0)),f=Math.max(...c.map(p=>p.expiresAtMs??0));return a?{appId:a.id,title:a.name,imageUrl:a.iconUrl??"",origin:a.url??a.name,expiresAtMs:f,createdAtMs:l}:{...i,expiresAtMs:f,createdAtMs:l}}return{...xy,appId:o}})}s(Sy,"_getAppPermissions");function Ay(e){let t=tt(),n=le(),o=Qn().getKMSInstance(),i=wo({accountIdentifier:e,kms:o}),{data:a}=oe(i);return ae({mutationFn:s(async u=>{let c=a?.result??null;if(!c)throw new Error("Phantom organization not found");let l=c.users.filter(p=>p.traits?.appId===u);if(l.length===0)return;let f=c.organizationId;for(let p of l){let d=p.username;await o.deleteUserFromOrganization({organizationId:f,username:d}),t.capture("userDeletedFromOrganization",{data:{appId:u,organizationId:f,username:d}})}},"mutationFn"),onSettled:s(()=>n.invalidateQueries({queryKey:i.queryKey}),"onSettled")})}s(Ay,"useRevokeAppPermissions");function By(e){return e.users.map(t=>t.traits?.appId).filter(t=>t!==void 0).filter((t,n,r)=>r.indexOf(t)===n).sort()}s(By,"_getUniqueAppIds");function Cy(e,t){let r=Qn().getKMSInstance(),o=wo({accountIdentifier:e,kms:r}),{data:i,...a}=oe(o);return{data:(0,ci.useMemo)(()=>{let c=i?.result?.users?.filter(l=>l.traits?.appId===t)??[];return Fl(c)},[i?.result,t]),...a}}s(Cy,"useGetSpendingLimit");function Iy(e){let t=tt(),n=le(),o=Qn().getKMSInstance(),i=wo({accountIdentifier:e,kms:o}),a=xi("spending_limits_cumulative"),{data:u}=oe({...i,enabled:a});return ae({mutationFn:s(async({appId:c,newUsdCentsLimitPerDay:l})=>{let f=u?.result??null;if(!f)throw new Error("Phantom organization not found");let p=await o.getWalletWithTag({organizationId:f.organizationId,tag:Ze});if(!p.result)throw new Error("KMS wallet not found");let d=await Cn({kms:o,userOrganizationId:f.organizationId,appId:c,usdCentsLimitPerDay:l,walletId:p.result.walletId});await Bn({kms:o,organization:f,newPolicy:d,appId:c,analytics:t})},"mutationFn"),onSettled:s(()=>n.invalidateQueries({queryKey:i.queryKey}),"onSettled")})}s(Iy,"useUpdateSpendingLimit");function Fl(e){let t=e.map(r=>"policy"in r?r.policy:void 0).filter(Boolean);if(t.length===0)return null;let n=t.map(r=>{let o=vr.safeParse(r);return o.success?o.data.usdLimit?.usdCentsLimitPerDay??null:null}).filter(r=>r!==null);return n.length===0?null:Math.min(...n)}s(Fl,"getLowestSpendingLimit");g();b();var pn=st(yn());var Ty=s(({isTestnetMode:e,enabledAddressTypes:t,enableAddressTypes:n,disableAddressTypes:r})=>{let{t:o}=Si(),i=(0,pn.useMemo)(()=>He.getAddressTypes(e?Co.Testnet:Co.Mainnet).sort(zl),[e]),a=(0,pn.useMemo)(()=>i.filter(p=>t.includes(p)).sort(zl),[i,t]),u=(0,pn.useCallback)(p=>{let d=He.getChainIDs(p);for(let y of d)if(He[y].addressTypes.filter(m=>t.includes(m)).length<=1)return!1;return!0},[t]),c=tt(),l=(0,pn.useCallback)((p,d)=>{d?u(p)&&(r({addressTypes:[p]}),c.capture("settingsPreferredBitcoinAddressToggledOffByUser",{data:{toggle:{addressType:p}}})):(n({addressTypes:[p]}),c.capture("settingsPreferredBitcoinAddressToggledOnByUser",{data:{toggle:{addressType:p}}}))},[c,u,r,n]),f=(0,pn.useMemo)(()=>({[Lt.BitcoinNativeSegwit]:{title:To.getDisplayName(Lt.BitcoinNativeSegwit),subtitle:o("settingsPreferredBitcoinAddressNativeSegwitExplainer")},[Lt.BitcoinTaproot]:{title:To.getDisplayName(Lt.BitcoinTaproot),subtitle:o("settingsPreferredBitcoinAddressTaprootExplainer")}}),[o]);return{availableBitcoinAddressTypes:i,enabledBitcoinAddressTypes:a,canDisableAddressType:u,handleAddressTypeEnablementChange:l,PREFERRED_BTC_ADDRESS_CONTENT:f}},"usePreferredAddressTypes"),jl=[Lt.BitcoinNativeSegwit,Lt.BitcoinTaproot,Lt.BitcoinNestedSegwit,Lt.BitcoinLegacy],zl=s((e,t)=>jl.indexOf(e)-jl.indexOf(t),"addressTypeSorter");g();b();var Ly=Ot.USD.value,ui=s(()=>{let{value:e}=bi(Se.SelectedCurrency);return{data:e??Ly}},"useSelectedCurrency"),li=s(()=>wi(Se.SelectedCurrency),"useSetSelectedCurrency");g();b();var xo=st(yn());var Gl=[Ot.USD,Ot.EUR],Oy=s(({beforeSelectCurrency:e=s(()=>Promise.resolve(),"beforeSelectCurrency"),goBack:t})=>{let n=tt(),{data:r}=ui(),{run:o}=li(),[i,a]=(0,xo.useState)(""),u=Ci(i,200);return{currencyRows:(0,xo.useMemo)(()=>Object.values(Ot).sort((l,f)=>{let p=Gl.indexOf(l),d=Gl.indexOf(f),y=p!==-1,h=d!==-1;if(y&&h)return p-d;if(y&&!h)return-1;if(!y&&h)return 1;let w=Oo(l.name.toLowerCase()),m=Oo(f.name.toLowerCase());return w<m?-1:w>m?1:0}).filter(l=>[l.name,l.symbol,l.abbreviation].some(p=>p.toLowerCase().includes(u.toLowerCase()))).map(l=>{let f=r===l.value,p=s(()=>{l.value!==r&&e(l).then(()=>{n.capture("settingsCurrencyUpdatedByUser",{data:{newCurrency:l.value,oldCurrency:r}}),o(l.value),t()})},"onPress");return{key:`currency-${l.value}`,topLeft:`${l.abbreviation} - ${l.name} (${l.symbol})`,type:"radio",active:f,onPress:p}}),[n,u,t,r,o,e]),searchQuery:i,setSearchQuery:a}},"useCurrencyList");g();b();var Wl="enableSolanaCopyTransaction";function Py(){let e=le(),t=he(),n=["settings","solana","enableCopyTransaction"],r=s(async()=>!!await t.get(Wl),"queryFn"),i=ae({mutationFn:s(async u=>{await t.set(Wl,u)},"mutationFn"),onSuccess:s(()=>{e.invalidateQueries({queryKey:n})},"onSuccess")}),a=oe({queryKey:n,queryFn:r});return{data:a.data,isLoading:a.isPending,mutate:i.mutate}}s(Py,"useEnableSolanaCopyTransaction");var Uy=Py;export{En as a,Wi as b,Sr as c,$i as d,Zi as e,jt as f,wg as g,Qi as h,Jl as i,xg as j,Eg as k,ea as l,ta as m,Se as n,Cr as o,ef as p,tf as q,nf as r,sf as s,g1 as t,uf as u,Wo as v,ee as w,zt as x,jo as y,Gt as z,Qf as A,zo as B,Ra as C,Zo as D,Da as E,fd as F,dd as G,qb as H,Ro as I,ia as J,lf as K,ff as L,aa as M,df as N,pf as O,hf as P,Xf as Q,Jf as R,Pa as S,Go as T,ed as U,nd as V,rd as W,od as X,sd as Y,gf as Z,bf as _,wf as $,vn as aa,xf as ba,id as ca,ad as da,ca as ea,Ef as fa,_f as ga,Ma as ha,yd as ia,md as ja,vf as ka,bd as la,Kf as ma,ko as na,Vo as oa,Pt as pa,Ba as qa,Ca as ra,Ko as sa,Aa as ta,Ff as ua,Fo as va,Zf as wa,Yf as xa,Va as ya,Td as za,Rl as Aa,Nl as Ba,wy as Ca,vy as Da,Ay as Ea,Cy as Fa,Iy as Ga,Ty as Ha,ui as Ia,Oy as Ja,Uy as Ka};
/*! Bundled license information:

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-N6SSDFMX.js.map
