import{a as C,b as d,c as z,d as G,e as H}from"./chunk-PFY5DZIQ.js";import{Aa as Q,Ba as R,Da as W,Fa as _,Ia as q,Ma as B,Sa as N,Ua as $,g as a,n as O,o as g,ra as K,ua as L,wa as F}from"./chunk-5JGASDWN.js";import{Ka as I,Oa as U,e as V}from"./chunk-W7IWPUIQ.js";import{Hc as v,vc as A}from"./chunk-4SCKDS7G.js";import{$c as h,B as x,E,H as y,I as m,L as p,Pc as j,Sc as w}from"./chunk-DJGGVTSJ.js";import{a as c,i as s,n as l}from"./chunk-WKJYWAXG.js";s();l();s();l();function ee(e,o){return d(o,e)===0?0:e/d(o,e)*100}c(ee,"calculateTotalPercentChange24h");var J=ee;s();l();s();l();async function T({walletCaip19s:e,includeFungibleCaip19s:o,excludeFungibleCaip19s:r}){let i=await x.api().timeout(h({seconds:10})).get("/portfolio/v1/fungibles/value",{params:{walletAddresses:e.join(","),...o.length>0&&{includeFungibleCaip19s:o.join(",")},...r.length>0&&{excludeFungibleCaip19s:r.join(",")}}}).then(t=>{if(E(t))return t.data;throw new Error(t.data?.message||t.data?.error||t.statusText||`Status: ${t.status}`,{cause:t.data?.code})}).catch(t=>{throw p.addBreadcrumb(m.Tokens,"getPortfolioValue",y.Error,{message:t.message,cause:t.cause,walletCaip19s:e.join(","),...o.length>0&&{includeFungibleCaip19s:o.join(",")},...r.length>0&&{excludeFungibleCaip19s:r.join(",")}}),p.captureError(t,m.Tokens),t}),n=F.parse(i);return n.errors&&n.errors.length>0&&n.errors.forEach(t=>{p.addBreadcrumb(m.Tokens,"getPortfolioValue_partialError",y.Info,{code:t.code,message:t.message,chainId:t.details.chainId,address:t.details.address})}),n}c(T,"getPortfolioValue");s();l();var te=j(function*(){return U(I.DeveloperMode)}),k=w(()=>te()),S=a(null),oe=Q((e,o)=>{let r=k.addListener(()=>{(async()=>{let i=await k.value;o(S,i??V)})()});return(async()=>{let i=await k.value;o(S,i??V)})(),()=>{r()}}),re=a(e=>(e(oe),e(S)??V)),ne=a(e=>!e(re).isDeveloperMode),P=ne;var ie=g(a(e=>{let o=e(N),i=e(B).reduce((n,t)=>{let u=v(void 0,{key:t.legacyKey??"",spamStatus:t.spamStatus??A.NotVerified}),f=v(o,{key:t.legacyKey??"",spamStatus:t.spamStatus??A.NotVerified});return u===f?n:u?{...n,exclude:[...n.exclude,t.encodedCaip19]}:{...n,include:[...n.include,t.encodedCaip19]}},{include:[],exclude:[]});return{include:i.include.sort().slice(0,50),exclude:i.exclude.sort().slice(0,50)}}),e=>e,(e,o)=>e.include.join(",")===o.include.join(",")&&e.exclude.join(",")===o.exclude.join(",")),ae=O(e=>{let o=e(_),{include:r,exclude:i}=e(ie),n=e(W),t=e(P),u=K.portfolioValue({walletCaip19s:o,include:r,exclude:i,isMainnet:t});return{enabled:o.length>0&&!n&&t,queryKey:u,refetchInterval:!1,queryFn:c(async()=>T({walletCaip19s:o,includeFungibleCaip19s:r,excludeFungibleCaip19s:i}),"queryFn")}}),M=ae;var X=a(e=>{let o=e($),r=!1,i=o.reduce((n,t)=>{let u=t.livePrice?.price??t.price?.price,f=t.livePrice?.priceChange24h??t.price?.priceChange24h;u&&(r=!0);let D=H(t,u??0),Z=G(D,f??0);return{currentValue:C(n.currentValue,D),priceDifference:C(n.priceDifference,Z)}},{currentValue:0,priceDifference:0});return r?{currentValue:i.currentValue,priceDifference:i.priceDifference,totalPercentChange24h:J(i.priceDifference,i.currentValue)}:{currentValue:void 0,priceDifference:void 0,totalPercentChange24h:void 0}}),se=R({atomToStoreOffline:M,offlineKey:a(e=>`${e(q)??""}:portfolio-value`),namespaceKey:"fungible-tokens",ttlMs:h({days:10}),initialValue:{totalValueUsdCentsCurrent:void 0,totalValueUsdStringCurrent:void 0,totalValueUsdCents24h:void 0,totalValueUsdString24h:void 0,totalPercentChange24h:void 0},schema:L}),Y=a(e=>{let o=e(se),r=o?.totalPercentChange24h,i=o?.totalValueUsdCents24h,n=o?.totalValueUsdCentsCurrent;return{currentValue:n!==void 0?n/100:void 0,priceDifference:i!==void 0&&n!==void 0?z(d(n,i),100):void 0,totalPercentChange24h:r}}),st=a(e=>{let o=e(X),r=e(Y);return{local:o,remote:r}}),le=g(M,e=>e.status),ue=a(e=>{if(!e(P))return{status:"idle",data:{currentValue:void 0,priceDifference:void 0,totalPercentChange24h:void 0}};let r=e(X),i=e(le),n=e(Y),t=typeof r.currentValue=="number"||typeof r.priceDifference=="number"||typeof r.totalPercentChange24h=="number";return{status:t?"success":i,data:t?r:n}}),lt=ue;export{P as a,M as b,st as c,lt as d};
//# sourceMappingURL=chunk-PELFKYLV.js.map
