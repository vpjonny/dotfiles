import{$ as M,I as R,M as tt,N as et,P as O,S as at,T as ot,U as nt,V as rt,ea as it,ga as st,ua as Q}from"./chunk-HLWWEHZK.js";import{N as K}from"./chunk-5JGASDWN.js";import{Rc as $,d as C,hb as E,kc as L}from"./chunk-4SCKDS7G.js";import{B as J,Be as X,E as U,I as N,L as b,dc as m,ee as Z,qd as x,ra as l,s as j,sd as v,ua as p,v as i,vd as Y,ze as G}from"./chunk-DJGGVTSJ.js";import{Z as D,a as H}from"./chunk-LQZGQEJ6.js";import{a as n,g as B,i as s,n as c}from"./chunk-WKJYWAXG.js";s();c();var q=B(H());s();c();var ct={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"info.name",weight:.5},{name:"info.keybaseUsername",weight:.3},{name:"info.website",weight:.1},{name:"voteAccountPubkey",weight:.1},{name:"identityPubkey",weight:.1}]},dt={identityPublicKey:"7GkMBmtrTZz8QbjSe1sXvAUtz7Pp42SQxfT5ymmJD4We",voteAccountPublicKey:"J2nUHEAgZFRyuJbFjdqPrAa9gyWDuc7hErtDQHPhsYRp"};s();c();var mt=n(t=>(r,a)=>{let e=t.indexOf(r.voteAccountPubkey),u=t.indexOf(a.voteAccountPubkey);return(e>-1?e:1/0)-(u>-1?u:1/0)},"recommendedValidatorSorter");s();c();s();c();var ut=new Error("Failed to fetch recommended staking validators.");async function lt(){try{let t=await J.api().get("/staking/v1/recommended");if(!U(t))throw ut;let r=t.data;return R.parse(r).validators}catch{throw ut}}n(lt,"getRecommendedValidators");var pt=n(()=>{let t=et.recommendedValidators();return Y({enabled:!0,queryKey:t,gcTime:at.Long,staleTime:ot.Never,async queryFn(){return lt()}})},"useRecommendedValidators");function ft(){let t=rt(),{results:r=[]}=t,a=pt(),{data:e=null,isFetched:u}=nt(),I=Z.isFeatureEnabled("kill-phantom-validator"),[P,o]=(0,q.useState)(""),d=G(P),h=(0,q.useMemo)(()=>{let A=r.map(V=>({...V,totalApy:V?.totalApy?tt(V.totalApy):0})),T=a.data??[];if(T.length===0)return A;let f=A.sort(mt(T));return I?f.filter(V=>V.identityPubkey!==dt.identityPublicKey):f},[r,a.data,I]),w=X(h,d||"",ct),F=(0,q.useCallback)(()=>{t.isError&&!t.isFetching&&t.refetch(),a.isError&&!a.isFetching&&a.refetch()},[a,t]),S=!t.isFetched||!u||!a.isFetched,y=t.isError||a.isError,k=t.isSuccess;return{isLoading:S,isSuccess:k,hasError:y,searchResults:w,showApy:e!==null,onRefetch:F,searchTerm:P,setSearchTerm:o}}n(ft,"useValidatorListPageProps");s();c();function W({stakePubkey:t,authorizedPubkey:r,votePubkey:a}){return i.StakeProgram.delegate({stakePubkey:t,authorizedPubkey:r,votePubkey:a})}n(W,"delegateStake");var kt=n(t=>{let{t:r}=D(),a=x(),e=O(),{mutateAsync:u}=K(t);return v({mutationFn:n(async({accountIdentifier:o,senderAddress:d,stakePubkey:h,authorizedPubkey:w,votePubkey:F})=>{if(!d)throw M;let{networkID:S,address:y}=d,k=W({stakePubkey:h,authorizedPubkey:w,votePubkey:F}),A=await E(k,{connection:t}),T={ownerAddress:y??"",networkID:S,data:{signature:""},type:C.DelegateStake,display:{summary:{topLeft:{text:r("transactionsPendingDelegatingStake")}}}};e.approved({chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),type:"delegate"});let f=await u({accountIdentifier:o,feePayer:new i.PublicKey(y),transaction:A,pendingTransactionInput:T});return e.submittedTransaction(f,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),method:"signAndSendTransaction",walletAddress:y}),{networkID:S,id:f??""}},"mutationFn"),onSuccess:n(o=>{L({connection:t,signature:o.id}).then(()=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"confirmed"}})}).catch(d=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"error"}}),b.captureError(d,N.Staking)}),Q(t,o.id,a)},"onSuccess")})},"useDelegateStake");s();c();function gt({stakePubkey:t,authorizedPubkey:r,amount:a,transaction:e=new i.Transaction}){return e.add(i.StakeProgram.withdraw({stakePubkey:t,authorizedPubkey:r,toPubkey:r,lamports:a})),e}n(gt,"withdrawStake");var ht=n(t=>{let{t:r}=D(),a=x(),e=O(),{mutateAsync:u}=K(t);return v({mutationFn:n(async({accountIdentifier:o,senderAddress:d,stakePubkey:h,authorizedPubkey:w,amount:F})=>{if(!d)throw M;let{networkID:S,address:y}=d,k=gt({stakePubkey:h,authorizedPubkey:w,amount:F}),A=await E(k,{connection:t}),T={ownerAddress:y??"",networkID:S,data:{signature:""},type:C.WithdrawStake,display:{summary:{topLeft:{text:r("transactionsPendingWithdrawingStake")}}}};e.approved({chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),type:"withdraw"});let f=await u({accountIdentifier:o,feePayer:new i.PublicKey(y),transaction:A,pendingTransactionInput:T});return e.submittedTransaction(f,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),method:"signAndSendTransaction",walletAddress:y}),{networkID:S,id:f??""}},"mutationFn"),onSuccess:n(o=>{L({connection:t,signature:o.id}).then(()=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"confirmed"}})}).catch(d=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"error"}}),b.captureError(d,N.Staking)}),Q(t,o.id,a)},"onSuccess")})},"useWithdrawStake");s();c();function wt({ownerPublicKey:t,lamports:r,transaction:a=new i.Transaction}){let e=i.Keypair.generate();return a.add(i.StakeProgram.createAccount({fromPubkey:t,stakePubkey:e.publicKey,authorized:new i.Authorized(t,t),lamports:r})),[a,e]}n(wt,"createStakeAccount");function At({lamports:t,votePubkey:r,authorizedPubkey:a}){let[e,u]=wt({ownerPublicKey:a,lamports:t});return e.add(W({stakePubkey:u.publicKey,authorizedPubkey:a,votePubkey:r})),[e,u]}n(At,"createStakeAccountAndDelegateStake");var Tt=n(t=>{let{t:r}=D(),a=x(),e=O(),{mutateAsync:u}=K(t);return v({mutationFn:n(async({accountIdentifier:o,senderAddress:d,lamports:h,votePubkey:w,authorizedPubkey:F,usdPerSol:S})=>{if(!d)throw M;let{networkID:y,address:k}=d,[A,T]=At({accountIdentifier:o,senderAddress:d,lamports:h,votePubkey:w,authorizedPubkey:F}),f=await E(A,{connection:t}),V={ownerAddress:k??"",networkID:y,data:{signature:""},type:C.CreateAccountAndDelegateStake,display:{summary:{topLeft:{text:r("transactionsPendingCreatingAndDelegatingStake")}}}};e.approved({chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(y),type:"delegate"});let z=await u({accountIdentifier:o,feePayer:new i.PublicKey(k),transaction:f,pendingTransactionInput:V,opts:{additionalSignerAccounts:[T]}});e.submittedTransaction(z,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(y),method:"signAndSendTransaction",walletAddress:k});let _=j(h),yt=S?_.times(S):void 0;return e.createStakeAccountAndDelegateStake({sol:_.toNumber(),usd:yt?.toNumber(),voteAccountPubkey:w}),{networkID:y,id:z??""}},"mutationFn"),onSuccess:n(o=>{L({connection:t,signature:o.id}).then(()=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"confirmed"}})}).catch(d=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"error"}}),b.captureError(d,N.Staking)}),Q(t,o.id,a)},"onSuccess")})},"useCreateStakeAccountAndDelegateStake");s();c();s();c();var St=B(H());function Dt({navigateToConvertStakeAccount:t}){let{t:r}=D(),{pickedLSTProvider:a}=st(m.solana.mainnetID),e=a($,!0),{hasConvertibleStakeAccounts:u}=it(e),I=r("convertToPhantomLST"),P=(0,St.useCallback)(()=>{t()},[t]);return{shouldShowLiquidStakingCTA:u,title:I,onPress:P}}n(Dt,"useFooterButton");export{ft as a,Dt as b,kt as c,ht as d,Tt as e};
//# sourceMappingURL=chunk-ZMW27YAP.js.map
