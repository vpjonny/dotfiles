import{a as _t}from"./chunk-TXNVN6J7.js";import"./chunk-RID4JEEN.js";import"./chunk-YWSY7L4P.js";import{a as Ht}from"./chunk-Z6STPKGK.js";import"./chunk-VRODSUQC.js";import"./chunk-27WMCVHA.js";import{b as Ot,d as g}from"./chunk-TRIYFLMU.js";import"./chunk-J4XA5VC7.js";import"./chunk-DQWLAPQA.js";import{o as Mt,p as Ft}from"./chunk-IUNAS73H.js";import{b as zt}from"./chunk-2LKSWQ7Y.js";import"./chunk-H4HL2VJ5.js";import"./chunk-QKX6QMZS.js";import"./chunk-5ENLJTSW.js";import"./chunk-ZMW27YAP.js";import"./chunk-QW5UCU4W.js";import"./chunk-X6Z5FRDC.js";import"./chunk-X4RRAJ67.js";import"./chunk-FFV6ZRAV.js";import"./chunk-END3S5WW.js";import"./chunk-OABENO2E.js";import{b as Et,g as W}from"./chunk-VQU4JTIB.js";import"./chunk-ZMU6KWZP.js";import"./chunk-YSZRDBUS.js";import"./chunk-UE7TCZBL.js";import"./chunk-PFY5DZIQ.js";import"./chunk-L4NFABLQ.js";import"./chunk-P3JRRYSB.js";import"./chunk-GUZFMB3D.js";import"./chunk-N3C6FBKY.js";import"./chunk-CTKHELYY.js";import"./chunk-2L6X42XL.js";import"./chunk-2P4HZW3J.js";import"./chunk-OR3XQXDJ.js";import{a as Nt}from"./chunk-HLSJ3VIL.js";import{db as i,m as s}from"./chunk-57EVB5FV.js";import"./chunk-44HH5QGP.js";import"./chunk-WVRYN4MY.js";import"./chunk-2LSP5LV2.js";import{A as $,D as bt,K as Dt,L as Pt,V as Tt,W as Rt,_ as Bt,ca as Ut,da as Wt,fa as It,na as Vt,oa as Lt,t as vt}from"./chunk-HLWWEHZK.js";import{Oa as xt,z as ht}from"./chunk-5JGASDWN.js";import"./chunk-ZDPKBPMV.js";import"./chunk-DYQ7BPYX.js";import"./chunk-NMTPXQAP.js";import"./chunk-SIWEHH3L.js";import{Z as At,_ as gt}from"./chunk-N6SSDFMX.js";import"./chunk-YJCG6GWC.js";import{A as K,vb as mt}from"./chunk-W7IWPUIQ.js";import{Fd as yt,Rc as wt,Va as Ct,Wa as ft}from"./chunk-4SCKDS7G.js";import{dc as dt,pf as Q,ua as ut,zc as kt}from"./chunk-DJGGVTSJ.js";import"./chunk-FATTDLFQ.js";import"./chunk-2RWUL32J.js";import"./chunk-RWWUDPHX.js";import{Ca as c,Na as pt,Ua as St,Z as f,a as ne,b as U,jb as d,k as lt}from"./chunk-LQZGQEJ6.js";import"./chunk-FNC6PQ53.js";import"./chunk-5QQLABHI.js";import{a as v,g as D,i as R,n as B}from"./chunk-WKJYWAXG.js";R();B();var m=D(ne(),1);R();B();var k=D(U(),1),re=s.div`
  display: grid;
  grid-template-columns: 100%;
  grid-template-rows: 47px auto;
  align-items: center;
  justify-content: flex-start;
  background: ${c.colors.legacy.elementBase};
  width: 328px;
  border-radius: 6px;
  margin-top: 24px;
`,ce=s.div`
  display: grid;
  gap: 10px;
  grid-template-columns: 33px 1fr auto;
  align-items: center;
  padding: 9px 14px;
  border-bottom: 1px solid ${c.colors.legacy.areaBase};
`,se=s(Ot)``,le=s.section`
  padding: 14px;
`,ue=s.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  height: 30px;
  align-items: center;
`,de=s(i)`
  color: ${n=>n.activationState==="active"?c.colors.legacy.spotPositive:n.activationState==="inactive"?c.colors.legacy.spotNegative:n.activationState==="activating"?c.colors.brand.yellowMoon:n.activationState==="deactivating"?c.colors.brand.yellowMoon:c.colors.legacy.textDiminished};
`,ke=s(Ht).attrs(()=>({tooltipAlignment:"bottomCenter",iconSize:12,lineHeight:17,fontWeight:400,fontSize:14,noWrap:!0}))``,q=v(n=>{let{t:e}=f(),{data:u}=Bt(n.validatorKeybaseUsername),p=n.validatorName??n.validatorKeybaseUsername??n.voteAccountPubkey??n.stakeAccountPubkey;return(0,k.jsxs)(re,{children:[(0,k.jsxs)(ce,{children:[(0,k.jsx)(se,{width:28,iconUrl:n.validatorIconUrl??u}),(0,k.jsx)(i,{textAlign:"left",weight:600,size:16,noWrap:!0,children:p}),(0,k.jsx)(de,{activationState:n.status,textAlign:"right",weight:400,size:14,noWrap:!0,textTransform:"capitalize",children:n.status??""})]}),(0,k.jsx)(le,{children:Object.entries(n.data).map(([r,a])=>(0,k.jsxs)(ue,{onClick:a.onClick,children:[(0,k.jsxs)(ke,{info:a.tooltip?(0,k.jsx)(Ft,{children:(0,k.jsx)(Mt,{children:a.tooltip})}):null,children:[r==="Stake Account"?e("stakeAccountCardStakeAccount"):"",r==="Balance"?e("stakeAccountCardBalance"):"",r==="Rent Reserve"?e("stakeAccountCardRentReserve"):"",r==="Active Stake"?e("stakeAccountCardActiveStake"):"",r==="Lockup"?e("stakeAccountCardLockup"):"",r==="Rewards"?e("stakeAccountCardRewards"):""]}),a.node]},r))})]})},"StakeAccountCard");var t=D(U(),1),I=s.div`
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow-y: scroll;
`,V=s.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  flex-grow: 1;
`,Y=s.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  color: ${c.colors.legacy.spotBase};
  text-decoration: none;
  cursor: pointer;
`,P=s.section`
  display: flex;
  gap: 15px;
`,Kt=s.section`
  display: flex;
  gap: 15px;
  margin-top: 24px;
  flex-direction: column;
`,me=s.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
`,pe=5e3,Se=v(n=>{let{t:e}=f(),{showStakeAccountDeactivateStakeStatusModal:u,showStakeAccountDelegateStakeStatusModal:p,showStakeAccountWithdrawStakeStatusModal:r,closeAllModals:a}=zt(),{data:A}=mt(),C=(0,m.useMemo)(()=>A?.addresses.find(b=>dt.isSolanaNetworkID(b.networkID)),[A]),{solanaPublicKey:T,connection:w,networkID:j}=(0,m.useMemo)(()=>{let b=C?.address??"",st=C?.networkID,ae=Ct(ft(st));return{solanaPublicKey:b,connection:ae,networkID:st}},[C]),L=It(wt),qt=kt(ut.Solana),{data:Yt}=ht({query:{data:qt}}),{data:G}=xt(),N=Yt?.usd,y=Ut(w,T),o=y.data?.find(b=>b.pubkey===n.stakeAccountPubkey),z=o?.info.meta.authorized.staker,jt=o?.lamports??0,J=parseFloat(o?.info.meta.rentExemptReserve??"0"),Gt=!!o?.inflationReward,{data:Jt=J}=yt(C),E=!!(G&&new lt(G.totalQuantityString).gt(Jt+pe)),X=Vt(),l=Wt(w,o?.pubkey).data,Xt=l?.active??0,Zt=l?.inactive??0,O=jt-J-Xt,Z=o?.info.stake?.delegation.voter,te=ve(),S=Z?te.get(Z):void 0,tt=new Date((o?.info.meta.lockup?.unixTimestamp??0)*1e3),M=Rt(o),F=Pt(l?.state)&&E,H=Dt(l?.state)&&!M&&E,h=L&&H,x=L&&F,et=L&&l?.state==="deactivating",{data:ee}=At(j),{data:ot}=gt(j,o?.pubkey??""),{pushDetailView:at}=Et(),oe=(0,m.useCallback)(()=>{at((0,t.jsx)(_t,{}))},[at]),nt=Lt(oe),it=(0,m.useCallback)(()=>{if(!o)throw new Error("Stake account not found");nt({stakeAccount:o,validatorName:S?.info?.name??"",activationState:l?.state})},[nt,o,S,l]),_=[{key:"viewOnExplorer",label:e("stakeAccountViewViewOnExplorer",{explorer:ee}),onClick:v(()=>{ot&&self.open(ot,"_blank")},"onClick")}];o&&(S&&(l?.state==="inactive"||l?.state==="deactivating")&&_.push({key:"restake",label:e("stakeAccountViewRestake"),onClick:v(()=>{p({stakeAccountPubkey:o.pubkey,voteAccountPubkey:S?.voteAccountPubkey,lamports:l.inactive,onClose:a})},"onClick")}),O>0&&O>Zt&&_.push({key:"withdrawUnstakedSOL",label:e("stakeAccountViewWithdrawUnstakedSOL"),onClick:v(()=>{r({stakeAccountPubkey:o.pubkey,amount:O,usdPerSol:N,onClose:a})},"onClick")}));let rt=(0,m.useCallback)(()=>{!o||!z||u({stakeAccountPubkey:o.pubkey,stakeAuthorityPubkey:z,onClose:a})},[o,z,u,a]),ct=(0,m.useCallback)(()=>{o&&r({stakeAccountPubkey:o.pubkey,amount:o.lamports,usdPerSol:N,onClose:a})},[o,r,N,a]);return y.isPending?(0,t.jsx)(I,{children:(0,t.jsx)(Nt,{})}):y.isError?(0,t.jsxs)(I,{children:[(0,t.jsx)(W,{children:e("stakeAccountViewPrimaryText")}),(0,t.jsx)(V,{children:(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:y.error?.message??e("stakeAccountViewError")})}),(0,t.jsx)(P,{children:(0,t.jsx)(d,{onClick:a,children:e("commandClose")})})]}):y.isSuccess&&o?(0,t.jsxs)(I,{canConvertStake:h,canConvertDelayedStake:x,children:[(0,t.jsx)(W,{items:_,children:e("stakeAccountViewPrimaryText")}),S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(V,{children:[(0,t.jsx)(Qt,{canConvertStake:h,canConvertDelayedStake:x,hasValidator:!!S,durationUntilEpochEnds:X,isDeactivating:et}),(0,t.jsx)(q,{stakeAccountPubkey:o.pubkey,voteAccountPubkey:S?.voteAccountPubkey,validatorName:S?.info?.name,validatorKeybaseUsername:S?.info?.keybaseUsername,validatorIconUrl:S?.info?.iconUrl,status:l?.state,data:{"Stake Account":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:K(o.pubkey)})},Balance:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.lamports})})},"Rent Reserve":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.info.meta.rentExemptReserve})})},"Active Stake":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:l?.active})})},Lockup:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:M?Q(tt):"\u2013"})},Rewards:Gt?{node:(0,t.jsx)(me,{children:(0,t.jsxs)(i,{color:c.colors.legacy.spotPositive,textAlign:"right",weight:500,size:14,noWrap:!0,children:["+",(0,t.jsx)(g,{children:o?.inflationReward})]})}),tooltip:e("stakeAccountCardRewardsTooltip")}:{node:(0,t.jsx)(i,{color:c.colors.legacy.textDiminished,textAlign:"right",weight:500,size:14,noWrap:!0,children:"\u2013"})}}}),E?null:(0,t.jsx)(pt,{marginY:"base",children:(0,t.jsx)(St,{color:"spotNegative",children:e("stakeAccountInsufficientFunds")})})]}),(0,t.jsx)($t,{canConvertStake:h,canUnstake:F,canWithdrawStake:H,canConvertDelayedStake:x,onClose:a,onUnstake:rt,onWithdrawStake:ct,onConvertStake:it})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(V,{children:[(0,t.jsx)(Qt,{canConvertStake:h,canConvertDelayedStake:x,hasValidator:!!S,durationUntilEpochEnds:X,isDeactivating:et}),(0,t.jsx)(q,{stakeAccountPubkey:o.pubkey,status:l?.state,data:{"Stake Account":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:K(o.pubkey)})},Balance:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.lamports})})},"Rent Reserve":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:o.info.meta.rentExemptReserve})})},"Active Stake":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(g,{children:l?.active})})},Lockup:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:M?Q(tt):"\u2013"})}}})]}),(0,t.jsx)($t,{canUnstake:F,canWithdrawStake:H,canConvertStake:h,canConvertDelayedStake:x,onClose:a,onUnstake:rt,onWithdrawStake:ct,onConvertStake:it})]})]}):(0,t.jsxs)(I,{children:[(0,t.jsx)(W,{children:e("stakeAccountViewPrimaryText")}),(0,t.jsx)(V,{children:(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:e("stakeAccountViewStakeNotFound")})}),(0,t.jsx)(P,{children:(0,t.jsx)(d,{onClick:a,children:e("commandClose")})})]})},"StakeAccountDetailPage"),oo=Se,Qt=v(({canConvertStake:n,canConvertDelayedStake:e,isDeactivating:u,hasValidator:p,durationUntilEpochEnds:r})=>{let{t:a}=f(),A=(0,m.useMemo)(()=>n?(0,t.jsxs)(t.Fragment,{children:[a("stakeAccountViewStakeInactiveToPSOL.part1")," ",(0,t.jsx)(Y,{href:bt,children:a("stakeAccountViewStakeInactiveToPSOL.part2")})]}):u?a("stakeAccountViewStakeDeactivatingToPSOL",{durationUntilEpochEnds:r}):e?a("convertToPSOLDelayDisclaimer",{durationUntilEpochEnds:r}):p?(0,t.jsxs)(vt,{i18nKey:"stakeAccountViewSOLCurrentlyStakedInterpolated",children:["Your SOL is currently staked with a validator. You'll need to unstake to ",(0,t.jsx)("br",{}),"access these funds. ",(0,t.jsx)(Y,{href:$,children:"Learn more"})]}):(0,t.jsxs)(t.Fragment,{children:[a("stakeAccountViewStakeInactive.part1")," ",(0,t.jsx)(Y,{href:$,children:a("stakeAccountViewStakeInactive.part2")})]}),[n,e,u,p,r,a]);return(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:A})},"StakeDescription"),$t=v(n=>{let{t:e}=f(),{canUnstake:u,canWithdrawStake:p,canConvertStake:r,canConvertDelayedStake:a,onClose:A,onUnstake:C,onWithdrawStake:T,onConvertStake:w}=n;return r?(0,t.jsxs)(Kt,{children:[(0,t.jsx)(d,{background:"spot",onClick:w,children:e("convertToPhantomLST")}),(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:A,children:e("commandClose")}),(0,t.jsx)(d,{onClick:T,children:e("stakeAccountViewWithdrawStake")})]})]}):a?(0,t.jsxs)(Kt,{children:[(0,t.jsx)(d,{background:"spot",onClick:w,children:e("convertToPhantomLST")}),(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:A,children:e("commandClose")}),(0,t.jsx)(d,{onClick:C,children:e("stakeAccountViewActionButtonUnstake")})]})]}):(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:A,children:e("commandClose")}),p&&(0,t.jsx)(d,{onClick:T,children:e("stakeAccountViewWithdrawStake")}),u&&(0,t.jsx)(d,{background:"spot",onClick:C,children:e("stakeAccountViewActionButtonUnstake")})]})},"StakeActions"),ve=v(()=>{let n=Tt(),e=n.results??[],u=(0,m.useRef)(e);return u.current=e,(0,m.useMemo)(()=>new Map(u.current.map(p=>[p.voteAccountPubkey,p])),[n.dataUpdatedAt])},"useValidatorsByVoteAccountPubkey");export{Se as StakeAccountDetailPage,oo as default};
//# sourceMappingURL=StakeAccountDetailPage-NADO3ESX.js.map
