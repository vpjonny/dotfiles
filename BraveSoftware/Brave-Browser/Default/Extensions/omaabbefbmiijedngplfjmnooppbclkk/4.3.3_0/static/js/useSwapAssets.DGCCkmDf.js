import{aK as o,M as _,O as E,aA as m,aB as w,d as C,Z as l,r as q,be as g,bf as R,bg as F,bh as I,bi as D,bj as K,u as U,bk as Q,bl as j,bm as v,aF as B,bn as b,bo as M,B as A,bp as J,bq as y,br as W,bs as S,ah as T,aJ as d,bt as P,bu as x,bv as z,bw as L}from"./main.D-W_HyrW.js";import{b as G}from"./useSwapMobileNotification.B1rUZ3HN.js";function N(e,s){if(e&&e===s)return!0;try{return s?(typeof e=="string"&&(e=o.Address.parse(e)),typeof s=="string"&&(s=o.Address.parse(s)),e.equals(s)):!1}catch{return!1}}var c=(e=>(e.TON="TON",e.TRON="TRON",e))(c||{});function p(e,s){return e+"__"+(typeof s=="string"?s:s.toRawString())}const H="TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t";p(c.TRON,H),c.TRON;p(c.TRON,"TRX"),c.TRON;p(c.TON,"TON"),c.TON;p(c.TON,o.Address.parse("0:b113a994b5024a16719f69139328eb759596c38a25f59028b146fecdc3621dfe")),o.Address.parse("0:b113a994b5024a16719f69139328eb759596c38a25f59028b146fecdc3621dfe"),c.TON;const O={jUSDT:o.Address.parse("EQBynBO23ywHy_CgarY9NK9FTz0yDsG82PtcbSTQgGoXwiuA"),USDe:o.Address.parse("UQAIb6KmdfdDR7CN1GBqVJuP25iCnLKCvBlJ07Evuu2dzKOa"),tsUSDe:o.Address.parse("UQDQ5UUyPHrLcQJlPAczd_fjxn8SLrlNQwolBznxCdSlfVHu")};function V(){const{swapService:e}=G(),{data:s}=Y(),a=_(E.ETHENA);return m({queryKey:[w.swapAllAssets,s,a],queryFn:async()=>{try{let n=(await e.swapAssets()).map(t=>{const i=t.address==="ton"?"TON":o.Address.parse(t.address);return{id:y(A.TON,i),symbol:t.symbol,decimals:t.decimals,name:t.name,image:J(b(i),t.image),blockchain:A.TON,noImageCorners:M(b(i)),scaledUIMultiplier:{numerator:"1",denominator:"1"},address:i}}).filter(t=>!(s||[]).some(i=>i.id===t.id)).concat(s||[]);return a||(n=n.filter(t=>!N(O.USDe,t.address)&&!N(O.tsUSDe,t.address))),n}catch(r){return console.error(r),[]}},enabled:!!s})}const Z=F("");function h(){return R(Z)}function X(){const[e]=I(),{data:s}=V(),{data:a}=D(K.TON),{fiat:r}=U();return m({queryKey:[w.swapWalletAssets,s,e,a,r],queryFn:async()=>{if(!e||!s||!a)return[];const u=s.map(n=>{if(W(n.address))return{assetAmount:new T({asset:n,weiAmount:e.ton.info.balance}),fiatAmount:S(new d(e.ton.info.balance)).multipliedBy(a.prices)};const t=e.ton.jettons.balances.find(i=>o.Address.parse(i.jetton.address).equals(n.address));return{assetAmount:new T({asset:n,weiAmount:t?.balance||0}),fiatAmount:S(new d(t?.balance||0),n.decimals).multipliedBy(new d(t?.price?.prices?.[r]||0))}});return u.sort((n,t)=>n.fiatAmount.isZero()&&t.fiatAmount.isZero()?t.assetAmount.weiAmount.comparedTo(n.assetAmount.weiAmount):t.fiatAmount.comparedTo(n.fiatAmount)),u},enabled:!!e&&!!s&&!!a})}const te=()=>{const[e]=h(),{data:s}=X();return q.useMemo(()=>{if(s)return s.filter(a=>{if(!e)return!0;if(g(e))return o.Address.parse(e).equals(a.assetAmount.asset.address);const r=e.toUpperCase();if(a.assetAmount.asset.symbol.toUpperCase().includes(r)||a.assetAmount.asset.name?.toUpperCase().includes(r))return!0})},[e,s])},ae=()=>{const[e]=h(),s=g(e),{fiat:a}=U(),r=Q(),{data:u}=j();return m({queryKey:[w.swapCustomToken,e,u,a],queryFn:async()=>{if(!s)return null;try{const n=o.Address.parse(e),t=await new P(r.tonApiV2).getJettonInfo({accountId:n.toRawString()}),i={address:n,image:t.preview,blockchain:A.TON,name:t.metadata.name,symbol:t.metadata.symbol,decimals:Number(t.metadata.decimals),id:y(A.TON,n),verification:t.verification,scaledUIMultiplier:x(t.scaledUi)},f=u?.balances.find(k=>o.Address.parse(k.jetton.address).equals(n));return{assetAmount:new T({asset:i,weiAmount:f?.balance||new d(0)}),fiatAmount:S(new d(f?.balance||0),i.decimals).multipliedBy(new d(f?.price?.prices?.[a]||0))}}catch(n){return console.error(n),null}},enabled:s&&!!u})},Y=()=>{const e=C();return m([l.SWAP_CUSTOM_ASSETS],async()=>(await e.storage.get(l.SWAP_CUSTOM_ASSETS))?.map(a=>({...a,blockchain:a.blockchain,address:L(a.address),id:y(a.blockchain,a.address),verification:z.Whitelist}))||[])},ne=()=>{const e=C(),s=v();return B(async a=>{const r=await e.storage.get(l.SWAP_CUSTOM_ASSETS)||[];await e.storage.set(l.SWAP_CUSTOM_ASSETS,[...r,{...a,address:b(a.address)}]),await s.invalidateQueries([l.SWAP_CUSTOM_ASSETS])})};export{h as a,ae as b,ne as c,te as d,V as u};
