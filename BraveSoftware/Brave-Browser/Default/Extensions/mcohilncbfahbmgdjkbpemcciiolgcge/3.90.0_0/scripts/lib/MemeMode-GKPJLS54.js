import{a as Mt,b as re,c as Lt,d as yt,e as Dt}from"./chunk-7SZ5M2YJ.js";import{a as Bt,d as wt,e as Qt}from"./chunk-E5Y77LVR.js";import{b as vt}from"./chunk-5MT5Y5AC.js";import{a as Rt,b as bt}from"./chunk-ZQKQQ4OE.js";import{a as Nt}from"./chunk-NMNQL2R3.js";import{a as xt,b as f}from"./chunk-PB55N5D7.js";import{a as At}from"./chunk-V347ZKZ3.js";import{a as Pt}from"./chunk-UR22LX4B.js";import{a as Et}from"./chunk-Q2VVUFER.js";import{b as Y}from"./chunk-6U5AQS6C.js";import{j as K}from"./chunk-QHC2DYOH.js";import{b as mt,c as lt,e as St,g as Tt,l as kt,m as Ct,n as It}from"./chunk-567ZSQZY.js";import"./chunk-R6FBHCT7.js";import"./chunk-J63JN6ZK.js";import{a as dt,b as ft,c as gt,d as Le,e as Ee}from"./chunk-MOM36K3J.js";import"./chunk-LOS6KRNX.js";import{c as pt,e as ht}from"./chunk-LOGCUUNU.js";import{d as Z,e as at}from"./chunk-QR5EI5TJ.js";import{c as Me,d as _t}from"./chunk-DLWPK36I.js";import"./chunk-5T4URYBB.js";import{d as V}from"./chunk-6KT3MJYR.js";import{a as oe}from"./chunk-LUU4SMIP.js";import{m as ee,p as te,w as ut,x as ct}from"./chunk-TQ2XASI3.js";import"./chunk-XXAIJB4T.js";import{a as $}from"./chunk-VPT3GAIN.js";import"./chunk-VJ2JNI4M.js";import{Aa as R,Ba as L,Ga as nt,Qa as it,ma as st,ra as F,xa as C,za as x}from"./chunk-22THXMTO.js";import"./chunk-HUG2KBCE.js";import{a as rt}from"./chunk-MCCEOABZ.js";import"./chunk-UJWKDH2G.js";import{A as Ce,y as Re}from"./chunk-AHLFMVMC.js";import"./chunk-KZDRRGNV.js";import"./chunk-3DAKLS7D.js";import"./chunk-JVJHSYZS.js";import{a as M,g as z,l as Ie}from"./chunk-IFGNGASP.js";import{$ as G,Fb as Ge,G as _,He as ot,K as Be,N as we,O as Ne,aa as J,ba as Qe,ca as Fe,da as Ve,ea as Oe,ec as We,fa as Ue,fc as He,gc as Ke,hc as Ye,ia as W,jc as Xe,je as $e,ld as je,m as P,n as D,ne as Je,ob as qe,oe as ze,pe as Ze,qe as et,r as be,re as tt,t as ve,zc as H}from"./chunk-NPJCEXXH.js";import"./chunk-4HHTYYQM.js";import"./chunk-PWGSI7LM.js";import"./chunk-RVS5KJOS.js";import"./chunk-5RLAMZDG.js";import"./chunk-VYWNZTTM.js";import"./chunk-K6YGPUNZ.js";import"./chunk-K6262WF4.js";import"./chunk-ZJ4FWIGG.js";import"./chunk-34KDKISZ.js";import"./chunk-AL77NTUI.js";import"./chunk-V3FLECS4.js";import"./chunk-LHUS6JBK.js";import"./chunk-R6TSAW7C.js";import"./chunk-2W2QYRRT.js";import"./chunk-Q7AZQDRY.js";import"./chunk-DSO47LPO.js";import"./chunk-QOQ6OPZO.js";import"./chunk-MGS2LE6A.js";import"./chunk-CBNY2XQM.js";import"./chunk-FRGP5XJV.js";import{a as ho}from"./chunk-Q2B4R57L.js";import{b as T}from"./chunk-PJC4UBLU.js";import"./chunk-HDMZQINQ.js";import{$ as B,c as De,j as u,o as xe,z as _e}from"./chunk-JYNY5RZ4.js";import"./chunk-F6LAWA6D.js";import"./chunk-OAMYZMR4.js";import"./chunk-I7KURANN.js";import"./chunk-BGUOO6AC.js";import"./chunk-GUM36CPA.js";import{f as g,o as n,q as i}from"./chunk-LHDKEQAM.js";n();i();var ke=g(T());n();i();var y=g(T()),lo=g($());n();i();var w=g(T());n();i();var Ae=g(T());B();var Ft=()=>{let{buyStore:s,sellStore:e}=f(),{currentBuyPreset:t,setBuyValue:o,buyValue:r}=s,{currentSellPreset:a,setSellValue:m,sellValue:c}=e,{amountList:p=[]}=t,{amountList:h=[]}=a;(0,Ae.useEffect)(()=>{_e(p)||r.type==="custom"||o({value:p[r.index]||"0",type:"select",index:r.index})},[o,p]),(0,Ae.useEffect)(()=>{if(_e(h)||c.type==="custom")return;let S=h[c.index]||"0";m({value:S,type:"select",index:c.index})},[m,h])};var go=({inputAmount:s,custom:e,defaultBuyAmountList:t,buyStore:o,setAmountUsed:r,setCustomUsed:a})=>{e==="1"?(o.setBuyValue({value:"",type:"custom",index:3}),a(!0),K("custom")):s&&(t.includes(s)?(o.setBuyValue({value:s,type:"select",index:t.findIndex(m=>m===s)}),r(!0),K("inputAmount")):o.setBuyValue({value:t[0]||"0",type:"select",index:0}))},So=({inputPercent:s,custom:e,defaultSellPercentList:t,sellStore:o,setPercentUsed:r,setCustomUsed:a})=>{e==="1"?(o.setSellValue({value:"",type:"custom",index:3}),o.setIsPercentMode(!0),a(!0),K("custom")):s&&(o.setIsPercentMode(!0),t.includes(s)?(o.setSellValue({value:s,type:"custom",index:3}),r(!0),K("inputPercent")):o.setSellValue({value:t[0]||"0",type:"select",index:0}))},Vt=()=>{let{queryParams:s}=bt(),{buyStore:e,sellStore:t,configStore:o}=f(),{currentMode:r}=o,{currentBuyPreset:a}=e,{currentSellPreset:m}=t,{amountList:c}=a,{amountList:p}=m,h=s?.get?.("inputAmount"),S=s?.get?.("inputPercent"),I=s?.get?.("custom"),[E,A]=(0,w.useState)(!1),[N,q]=(0,w.useState)(!1),[Q,ye]=(0,w.useState)(!1);(0,w.useEffect)(()=>{r==="buy"&&!E&&!Q&&go({inputAmount:h,custom:I,defaultBuyAmountList:c||[],buyStore:e,setAmountUsed:A,setCustomUsed:ye})},[h,I,r,c,E,Q]),(0,w.useEffect)(()=>{r==="sell"&&!N&&!Q&&So({inputPercent:S,custom:I,defaultSellPercentList:p||[],sellStore:t,setPercentUsed:q,setCustomUsed:ye})},[h,S,I,r,p,N,Q]),Ft()};n();i();var qt=g(T());n();i();var Ot=g(T());n();i();var se=g(T());var To=()=>{let{buyStore:s,sellStore:e,configStore:t}=f(),{currentMode:o}=t,r=(0,se.useCallback)(p=>{let h=p.coinAmountOriginalDec||p.amountNum,S={...p,amountNum:h};e.onSocketUpdateFromTokenBalance(S),s.onSocketUpdateFromTokenBalance(S)},[e,s]),a=e.fromToken?.tokenContractAddress,m=s.fromToken?.tokenContractAddress,c=(0,se.useMemo)(()=>o==="sell"?a:m,[a,m,o]);return{updateTokenBalance:r,currentTokenAddress:c}},ne=To;var ko=()=>{let{updateTokenBalance:s,currentTokenAddress:e}=ne(),t=Nt(),{chainId:o,accountId:r,userUniqueId:a,walletId:m,userWalletAddress:c,businessType:p}=t;return(0,Ot.useCallback)(async()=>{if(e&&o&&r&&a&&m&&c){let h=await wt({tokenAddress:e,chainId:o,accountId:r,userUniqueId:a,walletId:m,userWalletAddress:c,businessType:p});h&&s(h)}},[o,e,r,a,m,c,p,s])},Ut=ko;var _o=()=>{let{accountStore:s,memePositionStore:e,configStore:t,commonStore:o}=f(),{computedAccountId:r}=s,{userUniqueId:a}=o,{computedNativeTokenInfo:m}=t,{chainId:c}=m||{},{fetchPositionList:p}=e,h=Bt(p,300),{updateTokenBalance:S}=ne(),I=Ut();(0,qt.useEffect)(()=>{let E=Z({isPri:!0,needLogin:!0,subscribeParams:[{channel:ft.WALLET_ASSET}],onListenData:A=>{!A||(h({chainId:c,accountId:r,userUniqueId:a}),S(A))},onListenError:I,onListenReconnected:I});return()=>{E()}},[c,r,a,h,S,I])},Gt=_o;n();i();var Wt=g(T());function Ht(){let{accountStore:s}=f(),{computedAccountWalletAddresses:e}=s;(0,Wt.useEffect)(()=>{let t=()=>{};return e&&(t=at(e)),()=>{t?.()}},[e])}n();i();n();i();var Xt=g(T());n();i();function ie(){let{buyStore:s,sellStore:e,configStore:t}=f(),{currentMode:o}=t;return(o==="sell"?e.fromToken:s.toToken)||{}}n();i();var Kt=(s,e)=>{let t={userUniqueId:s,tokenDetailList:[{chainId:e.chainId,contractAddress:e.tokenContractAddress,tokenSymbol:e.tokenSymbol,precision:e.decimals}]};return L.post(je,t)},Yt=s=>(Array.isArray(s)?s:[s]).map(t=>({channel:dt.DEX_MARKET_TX_CHANNEL,chainId:String(t?.chainId),tokenAddress:t?.tokenContractAddress}));var Co=()=>{let s=ie(),{commonStore:e}=f();(0,Xt.useEffect)(()=>{!s.tokenContractAddress||!s.chainId||!e.userUniqueId||Kt(e.userUniqueId,s)},[e.userUniqueId,s.tokenContractAddress,s.chainId])},jt=Co;n();i();var eo=g(T());n();i();var zt=g(T());n();i();var $t=async({tokenContractAddress:s,accountId:e=void 0,chainId:t,walletAddress:o=void 0})=>{let r=performance.now(),[a,m]=await _(L.get($e,{params:{tokenContractAddress:s,accountId:e,chainId:t,walletAddress:o}})),c=performance.now()-r;return be.info(`[Market-API]: fetchLatestInfo: ${c?.toFixed?.(2)}ms`),!a&&m?m.data:{error:a}};n();i();var Jt=g(T());var Io=()=>{let{buyStore:s,sellStore:e,configStore:t}=f(),{currentMode:o}=t;return(0,Jt.useCallback)(r=>{let a={...r,chainId:Number(r.chainId)};o==="sell"?e.onSocketUpdateFromToken(a):s.onSocketUpdateToToken(a)},[o,e,s])},ae=Io;var Mo=()=>{let{accountStore:s}=f(),{computedAccountId:e,computedSignWalletAddress:t}=s,o=ae();return(0,zt.useCallback)(async r=>{let a=await $t({tokenContractAddress:r.tokenContractAddress,chainId:r.chainId,accountId:e,walletAddress:t});if(a?.error)return;let m={...r,price:a.price,marketCap:a.marketCap};o(m)},[o,e])},Zt=Mo;var Lo=()=>{let s=ie(),e=ae(),t=Zt();(0,eo.useEffect)(()=>{if(!s.tokenContractAddress||!s.chainId)return()=>{};let o=Yt(s),r=Z({subscribeParams:o,onListenData:a=>{e(a[0])},onListenError:()=>{t(s)},onListenReconnected:()=>{t(s)}});return()=>{r()}},[s.tokenContractAddress,s.chainId,e])},to=Lo;var Eo=()=>{jt(),to()},oo=Eo;n();i();var X=g(T()),ro=g($());var Ao=({currency:s,currentWallet:e,walletInfo:t,keyringIdentityTypeEnum:o,t:r,dispatch:a,onBack:m})=>{let{commonStore:c,accountStore:p,reset:h}=f();mt();let S=(0,ro.useHistory)();(0,X.useEffect)(()=>{W.setRuntimeContext({history:S,toLocale:r,dispatch:a,walletInfo:t,onBack:m})},[r,S,a,t,m]),(0,X.useEffect)(()=>{e&&p.setWalletConfig(e)},[e]),(0,X.useEffect)(()=>(c.getUserUnit(s),()=>{h()}),[]),(0,X.useEffect)(()=>{p.setKeyringIdentityTypeEnum(o)},[o])},so=Ao;n();i();var k=g(T()),U=g($());n();i();var b=g(T()),ue=g($()),ao=g(ho());n();i();var Pe=g(T());var Po=()=>Pe.default.createElement("div",{className:"mt-50"},Pe.default.createElement(Re,{pastDelay:!1,error:!0,delayTime:1e4,alt:"dexGenericError",retry:()=>{we(Be().pathname,"_self")}})),no=Po;n();i();var me=g(T());var yo=()=>{let{commonStore:s,configStore:e}=f(),{currentMode:t}=e,{fromToken:o}=Qt(),{chainId:r,isNativeToken:a,tokenContractAddress:m}=o,{visibleAddFunds:c,setAddFundsVisible:p}=s,h=rt(),S=(0,me.useMemo)(()=>h?!0:t==="sell",[h,t]);return me.default.createElement(Mt,{visible:c,params:{chainId:r,tokenContractAddress:a?"":m,receiveOnly:S},onBack:()=>{p(!1)}})},io=D(yo);var Do=[G,J],xo=({children:s,onBack:e})=>{let{commonStore:t,configStore:o,buyStore:r,sellStore:a}=f(),{showNavigator:m,title:c,closeable:p}=Lt({configStore:o,buyStore:r,sellStore:a}),h=(0,ue.useLocation)(),S=(0,ue.useHistory)(),{isTelegramMiniApp:I}=W.global,{Navigator:E}=W.components,{setAddFundsVisible:A}=t;(0,b.useEffect)(()=>{A(!1)},[]),Pt();let N=()=>{e?e(S.goBack,Do.includes(h.pathname)):S.goBack()};return b.default.createElement(lt,{fallbackComponent:no},b.default.createElement("div",{className:(0,ao.default)("universe-swap background-base-primary",re.wrapper)},m?b.default.createElement(E,{title:c,onBack:N,closeable:p}):null,b.default.createElement("div",{id:"meme-swap-container",className:I?re.memeTelegramContainer:re.extensionContainer},s)),b.default.createElement(io,null))},mo=D(xo);var uo=(0,k.lazy)(()=>import("./Buy-3JHKGQFG.js")),Ro=(0,k.lazy)(()=>import("./Sell-NM4ITVC5.js")),bo=(0,k.lazy)(()=>import("./Configure-VL2MXO5C.js")),vo=(0,k.lazy)(()=>import("./TokenList-YZHLGZ53.js")),Bo=(0,k.lazy)(()=>import("./HighRisk-3XH3MTGL.js")),wo=(0,k.lazy)(()=>import("./Presets-K3XG3UIB.js")),No=(0,k.lazy)(()=>import("./PresetEdit-U5KFE63Z.js")),Qo=({onBack:s})=>k.default.createElement(mo,{onBack:s},k.default.createElement(k.Suspense,null,k.default.createElement(U.Switch,null,[{path:G,component:uo,exact:!0},{path:J,component:Ro,exact:!0},{path:Fe,component:bo,exact:!0},{path:Qe,component:vo,exact:!0},{path:Ve,component:Bo,exact:!0},{path:Oe,component:wo,extract:!0},{path:Ue,component:No,extract:!0}].map(t=>k.default.createElement(U.Route,{key:t.path,path:t.path,component:t.component,exact:t.exact})),k.default.createElement(U.Redirect,{from:G,to:{pathname:uo,search:new Ne().getAll()},strict:!0,exact:!0})))),co=Qo;var Fo=({currency:s,currentWallet:e,keyringIdentityTypeEnum:t,walletInfo:o,onBack:r,t:a,dispatch:m})=>{so({currency:s,currentWallet:e,walletInfo:o,keyringIdentityTypeEnum:t,t:a,dispatch:m,onBack:r}),Ht(),Gt(),oo();let{accountStore:{address:c,setFromChainId:p,getAddressByChainId:h},configStore:{fetchConfig:S,computedConfig:I,setCurrentMode:E}}=f();(0,y.useEffect)(()=>{let q=h(H.SOLANA_MAINNET);At.tradePreCheck({chainId:H.SOLANA_MAINNET,userWalletAddress:q})},[]),(0,y.useEffect)(()=>{C.setTags({address:c})},[c]),(0,y.useEffect)(()=>{S()},[]);let A=(0,lo.useLocation)();(0,y.useEffect)(()=>{if(A){let{isBuyMode:q,isSellMode:Q}=Rt(A);q?E("buy"):Q&&E("sell")}},[A,E]),(0,y.useEffect)(()=>{I&&p(I?.nativeTokenInfo?.chainId)},[I]),vt(),Vt();let{initialized:N}=It();return N?y.default.createElement(co,{onBack:r}):null},fo=(0,y.memo)(D(Fo));n();i();n();i();B();var ce=class{constructor(){this.loading=!0;this.setLoading=e=>{this.loading=e};this.fromToken=null;this.setFromToken=e=>{this.fromToken=e};this.toToken=null;this.setToToken=e=>{this.toToken=e};this.onSocketUpdateToToken=e=>{V(e,this.toToken)&&this.setToToken({...this.toToken,...e})};this.onSocketUpdateFromTokenBalance=e=>{V(e,this.fromToken)&&this.setFromToken({...this.fromToken,amountNum:e.amountNum})};this.buyValue={value:"0",index:0,type:"select"};this.setBuyValue=e=>{this.buyValue=e};this.buyPresetList=[];this.setBuyPresetList=e=>{this.buyPresetList=e};this.currentBuyPresetId="";this.setCurrentBuyPresetId=e=>{this.currentBuyPresetId=e};this.updateCurrentPresetAmountList=e=>{let t=this.buyPresetList.map(o=>o.id===this.currentBuyPresetId?{...o,amountList:e}:o);this.setBuyPresetList(t)};this.buyPresetPageEditState=!1;this.setBuyPresetPageEditState=e=>{this.buyPresetPageEditState=e};this.editBuyPreset={isEdit:!0,value:{}};this.setEditBuyPreset=e=>{this.editBuyPreset=e};this.memeBtnStatus=ee;this.setMemeBtnStatus=e=>{this.memeBtnStatus=e};P(this)}get computedBuyNumber(){if(this.buyValue.type==="custom"){let e=this.buyValue.value||"0";return z(e)?"0":new M.BigNumber(e).toString(10)}return this.currentBuyPreset?.amountList?.[this.buyValue.index]}get computedBuyTokenSymbol(){return u(this,"toToken.tokenSymbol")}get computedBuyNumberIsValid(){return new M.BigNumber(this.computedBuyNumber).gt(0)}get currentBuyPreset(){return this.buyPresetList.find(e=>e.id===this.currentBuyPresetId)||{}}};n();i();var le=class{constructor(){this.initState=!1;this.setInitState=e=>{this.initState=e};this.positionList=[];this.setPositionList=e=>{this.positionList=Y.filterHiddenTokenList(e)};this.fetchPositionLoading=!0;this.setFetchPositionLoading=e=>{this.fetchPositionLoading=e};this.cancelFetchRef=null;this.fetchPositionList=async({accountId:e,userUniqueId:t,chainId:o,minAmountThreshold:r})=>{if(!e||!t||!o)return;this.cancelFetchRef&&this.cancelFetchRef.abort(),this.setFetchPositionLoading(!0),this.cancelFetchRef=x();let[a,m]=await _(L.get(Je,{params:{accountId:e,userUniqueId:t,chainId:o,minAmountThreshold:r},signal:this.cancelFetchRef?.signal}));a&&C.stuff(a),m&&m.data&&this.setPositionList(m?.data),this.setFetchPositionLoading(!1),this.setInitState(!0)};P(this)}isCancel(e){return R(e)}};n();i();B();var de=class{constructor(){this.loading=!0;this.setLoading=e=>{this.loading=e};this.fromToken=null;this.setFromToken=e=>{this.fromToken=e};this.onSocketUpdateFromToken=e=>{V(e,this.fromToken)&&this.setFromToken({...this.fromToken,...e})};this.onSocketUpdateFromTokenBalance=e=>{V(e,this.fromToken)&&this.setFromToken({...this.fromToken,amountNum:e.amountNum})};this.toToken=null;this.setToToken=e=>{this.toToken=e};this.sellValue={value:"",type:"custom",index:0};this.setSellValue=e=>{this.sellValue=e};this.isPercentMode=!0;this.setIsPercentMode=e=>{this.isPercentMode=e};this.sellPresetList=[];this.setSellPresetList=e=>{this.sellPresetList=e};this.currentSellPresetId="";this.setCurrentSellPresetId=e=>{this.currentSellPresetId=e};this.updateCurrentPresetAmountList=e=>{let t=this.sellPresetList.map(o=>o.id===this.currentSellPresetId?{...o,amountList:e}:o);this.setSellPresetList(t)};this.sellPresetPageEditState=!1;this.setSellPresetPageEditState=e=>{this.sellPresetPageEditState=e};this.editSellPreset={isEdit:!0,value:{}};this.setEditSellPreset=e=>{this.editSellPreset=e};this.memeBtnStatus=ee;this.setMemeBtnStatus=e=>{this.memeBtnStatus=e};P(this)}get computedSellNumber(){try{let e=Math.min(this.fromToken?.decimals||0,12);if(this.sellValue.type==="custom"&&!this.isPercentMode){let r=this.sellValue.value||"0";return z(r)?"0":new M.BigNumber(r).toString(10)}let t=this.fromToken?.amountNum||"0";if(this.sellValue.type==="custom"&&this.isPercentMode)return M.floorMul(M.div(this.sellValue.value||"0",100),t,e);let o=this.currentSellPreset?.amountList?.[this.sellValue.index];return M.floorMul(o,t,e)}catch(e){return C.stuff(e),"0"}}get computedSellTokenSymbol(){return u(this,"fromToken.tokenSymbol")}get computedSellTokenBalanceLessAmount(){return u(this,"fromToken.computedSellNumber")>u(this,"fromToken.amountNum")}get computedSellNumberIsValid(){return new M.BigNumber(this.computedSellNumber).gt(0)}get currentSellPreset(){return this.sellPresetList.find(e=>e.id===this.currentSellPresetId)||{}}};n();i();var fe=class{constructor(){this.searchValue="";this.setSearchValue=e=>{this.searchValue=e};this.defaultSearchLoading=!0;this.setDefaultSearchLoading=e=>{this.defaultSearchLoading=e};this.searchLoading=!1;this.setSearchLoading=e=>{this.searchLoading=e};this.commonSearchState=!1;this.setCommonSearchState=e=>{this.commonSearchState=e};this.normalTokenList=[];this.unsupportedTokenList=[];this.fetchDefaultTokenList=async({chainId:e,computedAccountId:t,userUniqueId:o})=>{this.setDefaultSearchLoading(!0),this.setCommonSearchState(!1);let r={chainId:e,accountId:t,userUniqueId:o,minAmountThreshold:Y.getMinAmountThresholdParam()},[a,m]=await _(L.get(ze,{params:r}));if(this.searchValue){this.setDefaultSearchLoading(!1);return}a&&(C.stuff(a),this.normalTokenList=[],this.unsupportedTokenList=[]),m&&m.data&&(this.normalTokenList=Y.filterHiddenTokenList(m?.data),this.unsupportedTokenList=[]),this.setDefaultSearchLoading(!1)};this.cancelSearchRef=null;this.fetchSearchTokenList=async({chainId:e,computedAccountId:t,userUniqueId:o})=>{if(!this.searchValue)return;this.cancelSearchRef&&this.cancelSearchRef.abort(),this.setSearchLoading(!0),this.setCommonSearchState(!0),this.cancelSearchRef=x();let[r,a]=await _(L.get(Ze,{params:{chainId:e,accountId:t,userUniqueId:o,inputContent:this.searchValue},signal:this.cancelSearchRef?.signal}));if(!this.searchValue){this.setSearchLoading(!1);return}r&&!this.isCancel(r)&&(C.stuff(r),this.normalTokenList=[],this.unsupportedTokenList=[]),a&&a.data&&(this.normalTokenList=a?.data?.memeList,a?.data?.memeUnsupportList?this.unsupportedTokenList=a?.data?.memeUnsupportList.map(m=>{let c=m;return c.unSupportedMeme=!0,c}):this.unsupportedTokenList=[]),this.setSearchLoading(!1)};this.highRiskToken=null;this.setHighRiskToken=e=>{this.highRiskToken=e};this.highRiskCallBack=()=>{};this.setHighRiskCallBack=e=>{this.highRiskCallBack=e};P(this)}isCancel(e){return R(e)}};n();i();B();n();i();var pe=class{constructor(){this.currentMode="buy";this.setCurrentMode=e=>{this.currentMode=e};this.presetStorageKey=te;this.currentChainID=H.SOLANA_MAINNET;this.initLoading=!0;this.setInitLoading=e=>{this.initLoading=e}}get computedIsBuy(){return this.currentMode==="buy"}get computedIsSell(){return this.currentMode==="sell"}};var he=class extends pe{constructor(){super();this.configList=[];this.setConfigList=t=>{this.configList=t};this.fetchConfig=async()=>{let[t,o]=await _(Et({sceneType:0}));if(t){C.error(F.MEME_SWAP_PRE_EXECUTE_ERR,{error:t});return}o&&o.data&&(this.setConfigList(o.data),this.setInitLoading(!1))};oe(this),this.presetStorageKey=te}get computedConfig(){return this.configList.find(t=>De(t.chainId)===this.currentChainID&&t.sceneType===0)}get computedNativeTokenInfo(){return u(this.computedConfig,"nativeTokenInfo",{})}};n();i();B();n();i();B();var ge=class{constructor(){this.QUOTE_TIMEOUT=5e3;this.quoteLoading=!1;this.quoteData=ge.INIT_QUOTE_DATA;this.resetQuote=()=>{this.cleanQuoteTimer(),this.cacheParams=null,this.setQuoteData(ge.INIT_QUOTE_DATA)};this.isAutoQuote=!1;this.cancelRef=null;this.cleanQuoteTimer=()=>{this.cancelRef&&(this.cancelRef.abort(),this.cancelRef=null),this.timerRef&&clearTimeout(this.timerRef)};this.initLoading=!0;this.timerRef=null;this.cacheParams=null;this.startingPoll=async(e,t)=>{if(this.cacheParams=e,this.timerRef&&clearTimeout(this.timerRef),!this.isQuoteImmediate(this.cacheParams||{})){this.setIsInitLoading(!1),this.resetQuote();return}await this.fetchQuoteAction(this.cacheParams,t),clearTimeout(this.timerRef),this.timerRef=setTimeout(async()=>{this.setIsAutoQuote(!0),await this.startingPoll(this.cacheParams,t)},this.QUOTE_TIMEOUT)};this.fetchQuote=xe(this.startingPoll,Ge)}setQuoteLoading(e){this.quoteLoading=e}setQuoteData(e){this.quoteData=e}setIsAutoQuote(e){this.isAutoQuote=e}setIsInitLoading(e){this.initLoading=e}quoteStart(){this.setQuoteLoading(!0),this.cleanQuoteTimer()}quoteEnd(){this.setIsInitLoading(!1),this.setQuoteLoading(!1),this.setIsAutoQuote(!1)}getQuoteUrl(){return tt}async fetchQuoteAction(e,t){this.quoteStart(),this.cancelRef=x();let[o,r]=await _(L.post(this.getQuoteUrl(),e,{signal:this.cancelRef.signal}));if(!R(o)&&o){let a=o||{};Ee.isOpen&&Ee?.close(),this.setQuoteData(a)}else this.setQuoteData(r||{}),t?.(r);this.quoteEnd()}isQuoteImmediate(e){return!!e?.chainId&&!!e?.fromTokenAddress&&!!e?.toTokenAddress&&new M.BigNumber(e?.amount).gt(0)}get computedQuoteCompleted(){return this.quoteData.error_code}get computedQuoteSuccuss(){return this.quoteData.error_code==="0"}get computedQuoteIsError(){return this.computedQuoteCompleted&&this.computedQuoteCompleted!=="0"&&this.computedQuoteCompleted!==Xe}get computedQuoteErrorMsg(){return u(this.quoteData,"error_message","")}get computedCustomQuoteLoading(){return!this.isAutoQuote&&this.quoteLoading}get computedQuoteNetworkError(){return this.quoteData.status==="ERR_NETWORK"}get computedQuoteIsBuyHoneypot(){return this.computedQuoteCompleted&&u(this.quoteData,"error_code")===Ye}get computedQuoteIsBlackAddress(){return this.computedQuoteCompleted&&u(this.quoteData,"error_code")===We}get computedQuoteIsNewAddress(){return this.computedQuoteCompleted&&u(this.quoteData,"error_code")===He}},j=ge;j.INIT_QUOTE_DATA={data:null,detailMsg:"",error_code:"",error_message:"",msg:"",status:""};var Se=class extends j{constructor(){super(),oe(this)}getQuoteUrl(){return et}async fetchQuoteAction(e,t){this.quoteStart(),this.cancelRef=x();let[o,r]=await _(ht(e,{signal:this.cancelRef.signal}));if(R(o)){this.quoteEnd();return}if(o){let a=o||{};this.setQuoteData(a)}else this.setQuoteData(r||{}),t?.(r);this.quoteEnd()}get jitoIsSuccess(){return u(this.computedCurrentDefiPlatformInfo,"isEnableMev")==="1"}get computedPriorityFeeInfo(){let e=u(this.quoteData,"data.networkFeeInfo.normal")??{},t=u(this.quoteData,"data.networkFeeInfo.mev[0]")??{},o=Le(e);return{mevPriorityFeeInfo:Le(t),nonMevPriorityFeeInfo:o}}get computedFromTokenValue(){return u(this.quoteData,"data.commonDexInfo.fromTokenValue","0")}get computedToTokenAmount(){return u(this.computedCurrentDefiPlatformInfo,"receiveAmount","0")}get computedToTokenValue(){return u(this.computedCurrentDefiPlatformInfo,"toTokenValue","0")}get computedNativeTokenPrice(){return u(this.quoteData,"data.commonDexInfo.nativeTokenPrice",0)}get quoteNetWorkFeeOfMoney(){return u(this.computedCurrentDefiPlatformInfo,"quoteNetWorkFeeOfMoney","")}get computedQuoteLiquidityError(){return this.computedQuoteCompleted&&!u(this.quoteData,"data.defiPlatformInfoList[0]")}get computedCurrentDefiPlatformInfo(){return u(this.quoteData,"data.defiPlatformInfoList[0]",{})}get computedSwapOnOtherDapp(){let e=String(u(this.quoteData,"isSupportDappTrade"))==="1";return this.computedQuoteCompleted&&e}get computedQuoteSafemoon(){if(this.computedQuoteCompleted){let e=u(this.quoteData,"data.commonDexInfo.fromToken",{}),t=u(this.quoteData,"data.commonDexInfo.toToken",{});if(Me(e))return e?.tokenSymbol;if(Me(t))return t?.tokenSymbol}return""}get computedGetRouterList(){return u(this.computedCurrentDefiPlatformInfo,"dexRouterList")}get computedGetEstimateGasFee(){return u(this.computedCurrentDefiPlatformInfo,"estimateGasFee")}get computedGetQuoteFrom(){return u(this.quoteData,"data.commonDexInfo.fromToken",{})||{}}get computedGetQuoteTo(){return u(this.quoteData,"data.commonDexInfo.toToken",{})||{}}get computedGetQuoteFromAmount(){return u(this.quoteData,"data.commonDexInfo.fromTokenAmount")}get computedGetQuoteFromPrice(){return u(this.quoteData,"data.commonDexInfo.fromTokenValue")}get computedGetQuoteToAmount(){return u(this.computedCurrentDefiPlatformInfo,"receiveAmount")}get computedGetQuoteToPrice(){return u(this.computedCurrentDefiPlatformInfo,"toTokenValue")}get computedQuoteId(){return u(this.computedCurrentDefiPlatformInfo,"quoteId","")}get computedQuoteIsInvalid(){return this.computedQuoteIsError||this.computedQuoteNetworkError||this.computedQuoteLiquidityError}get computedServiceFeeInfo(){return u(this.computedCurrentDefiPlatformInfo,"serviceFeeInfo",{})}get computedAutoSlippage(){return u(this.computedCurrentDefiPlatformInfo,"autoSlippageInfo.referenceSlippage","")||u(this.computedCurrentDefiPlatformInfo,"autoSlippageInfo.autoSlippage","")}get mevUnstableShowLevel(){return u(this.computedCurrentDefiPlatformInfo,"mevUnstableShowLevel",-1)}get solPrice(){return u(this.quoteData,"data.commonDexInfo.nativeTokenPrice",0)}get quoteDiffValThreshold(){return u(this.computedCurrentDefiPlatformInfo,"quoteDiffValThreshold")}get quoteDiffPercentThreshold(){return u(this.computedCurrentDefiPlatformInfo,"quoteDiffPercentThreshold")}get computedValueDifference(){return _t({pay:this.computedFromTokenValue,receive:this.computedToTokenValue,quoteDiffValThreshold:this.quoteDiffValThreshold,quoteDiffPercentThreshold:this.quoteDiffPercentThreshold})}get computedQuoteIsSellHoneypot(){return this.computedQuoteCompleted&&u(this.quoteData,"data.commonDexInfo.code")===Ke}get computedRate(){let e=this.computedGetQuoteFromAmount,t=this.computedGetQuoteToAmount;return e&&t?Ie(new M.BigNumber(t).div(e).toString(10),{needBillionMillionUnit:!1}):""}get computedToFromRate(){let e=this.computedGetQuoteFromAmount,t=this.computedGetQuoteToAmount;return e&&t?Ie(new M.BigNumber(e).div(t).toString(10),{needBillionMillionUnit:!1}):""}};n();i();B();var Te=class{constructor(){this.isSwapLoading=!1;this.cacheVerifyCallDataResult=null;this.setCacheVerifyCallDataResult=e=>{this.cacheVerifyCallDataResult=e};this.checkCallData=async({chainId:e,responseData:t,requestParams:o,accountId:r,signWalletAddress:a})=>{let m=await it({callData:t?.callData?.data,chainId:e,hasReferralCommission:t?.hasReferralCommission,address:a});return m.success||this.setCacheVerifyCallDataResult({...m,walletId:r,requestCommissionAddress:o?.serviceFeeInfo?.referralCommissionAddress}),m};this.logVerifyCallDataResult=({txHash:e,orderId:t})=>{this.cacheVerifyCallDataResult&&!this.cacheVerifyCallDataResult.success&&(nt({...this.cacheVerifyCallDataResult,txHash:e,orderId:t}),this.setCacheVerifyCallDataResult(null))};P(this,{},{autoBind:!0})}setIsSwapLoading(e){this.isSwapLoading=e}getSolanaUnsignedTx(e){let t=u(e,"originData.mevConfig.enableMev"),o=e?.unsignedTx||"{}";try{return t?JSON.parse(o).array:[JSON.parse(o)]}catch(r){throw new Error(r)}}getJitoTxData(e){let t=new gt,o=this.getSolanaUnsignedTx(e);return Promise.all(o.map(t.txData))}async onSolanaSwap({data:e,signedTransactions:t,txArray:o}){try{let r=await Dt({walletId:e.walletId,swapParams:e.calldataParams,signedTransactions:t,isMemeMode:!0,orderData:e?.originData});if(C.info(F.MEME_SWAP_BROADCAST_PARAMS,{data:{...e,solanaBroadcastParams:r,unsignedTxArray:o,signedTransactions:t}}),!qe()){let c=r?.dexMultiMetaSaveOrderParam?.chainId;st({chain_id:c,chain_name:ve.chainInfo?.[c]||"",tx_hash:r?.updateMultiOrderInfo?.transactionHash,trade_mode:ut.MEME,terminal:ct.WEB})}let[a,m]=await _(pt(r));if(a){this.broadcastError(a,{...e,solanaBroadcastParams:r,unsignedTxArray:o,signedTransactions:t,broadcastRes:m,tags:{userWalletAddress:e.userWalletAddress}});return}return C.info(F.MEME_SWAP_BROADCAST_SUCCESS,{data:{...e,solanaBroadcastParams:r,unsignedTxArray:o,signedTransactions:t,broadcastRes:m}}),this.logVerifyCallDataResult({txHash:m?.data?.broadcastResult?.data?.transactionHash,orderId:m?.data?.broadcastResult?.data?.orderId}),m}catch(r){throw this.broadcastError(r,{...e,unsignedTxArray:o,signedTransactions:t}),new Error(r?.error_message)}}broadcastError(e,t){Ce.error({title:e?.error_message||ot("swaptrade_home_toast_broadcast_failed"),placement:Ce.DIRECTION.top}),C.error(F.MEME_SWAP_BROADCAST_ERROR,{error:e,...t})}};var v=class{constructor(){this.reset=()=>{this.commonStore=new kt(this),this.accountStore=new Tt(this),this.sendTransactionStore=new Ct,this.configStore=new he,this.buyStore=new ce,this.sellStore=new de,this.memePositionStore=new le,this.quoteStore=new Se,this.memeTokenListStore=new fe,this.memeSwapStore=new Te};this.reset()}static getInstance(){return v.instance||(v.instance=new v),v.instance}},po=v;var Vo=({localeData:s,...e})=>(yt(),ke.default.createElement(St,{localeData:s,isDev:!0,noRemoteData:!0,customRender:t=>t},ke.default.createElement(xt.Provider,{value:po.getInstance()},ke.default.createElement(fo,{...e})))),Qa=D(Vo);export{Qa as default};
//# sourceMappingURL=MemeMode-GKPJLS54.js.map
