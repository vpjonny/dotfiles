import{A as or,B as tr,u as er}from"./chunk-OQWPK3VC.js";import{e as y}from"./chunk-GUM36CPA.js";import{c as p,f as rr,n as s,o as a,p as h,q as f}from"./chunk-LHDKEQAM.js";var E=p((yr,I)=>{a();f();var ur=Math.pow(2,30)-1;I.exports=function(r,e){if(typeof r!="number")throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if(typeof e!="number")throw new TypeError("Key length not a number");if(e<0||e>ur||e!==e)throw new TypeError("Bad key length")}});var q=p((Ar,F)=>{a();f();var _;globalThis.process&&globalThis.process.browser?_="utf-8":globalThis.process&&globalThis.process.version?(K=parseInt(s.version.split(".")[0].slice(1),10),_=K>=6?"utf-8":"binary"):_="utf-8";var K;F.exports=_});var P=p((Tr,R)=>{a();f();var A=y().Buffer;R.exports=function(r,e,t){if(A.isBuffer(r))return r;if(typeof r=="string")return A.from(r,e);if(ArrayBuffer.isView(r))return A.from(r.buffer);throw new TypeError(t+" must be a string, a Buffer, a typed array or a DataView")}});var H=p((Dr,N)=>{a();f();var ar=tr(),fr=er(),ir=or(),l=y().Buffer,sr=E(),U=q(),L=P(),cr=l.alloc(128),S={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function M(r,e,t){var n=hr(r),o=r==="sha512"||r==="sha384"?128:64;e.length>o?e=n(e):e.length<o&&(e=l.concat([e,cr],o));for(var u=l.allocUnsafe(o+S[r]),c=l.allocUnsafe(o+S[r]),i=0;i<o;i++)u[i]=e[i]^54,c[i]=e[i]^92;var m=l.allocUnsafe(o+t+4);u.copy(m,0,0,o),this.ipad1=m,this.ipad2=u,this.opad=c,this.alg=r,this.blocksize=o,this.hash=n,this.size=S[r]}M.prototype.run=function(r,e){r.copy(e,this.blocksize);var t=this.hash(e);return t.copy(this.opad,this.blocksize),this.hash(this.opad)};function hr(r){function e(n){return ir(r).update(n).digest()}function t(n){return new fr().update(n).digest()}return r==="rmd160"||r==="ripemd160"?t:r==="md5"?ar:e}function mr(r,e,t,n,o){sr(t,n),r=L(r,U,"Password"),e=L(e,U,"Salt"),o=o||"sha1";var u=new M(o,r,e.length),c=l.allocUnsafe(n),i=l.allocUnsafe(e.length+4);e.copy(i,0,0,e.length);for(var m=0,g=S[o],j=Math.ceil(n/g),B=1;B<=j;B++){i.writeUInt32BE(B,e.length);for(var C=u.run(i,u.ipad1),w=C,D=1;D<t;D++){w=u.run(w,u.ipad2);for(var b=0;b<g;b++)C[b]^=w[b]}C.copy(c,m),m+=g}return c}N.exports=mr});var Q=p((Fr,J)=>{a();f();var $=y().Buffer,lr=E(),O=q(),Z=H(),X=P(),x,v=globalThis.crypto&&globalThis.crypto.subtle,dr={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},T=[];function pr(r){if(globalThis.process&&!globalThis.process.browser||!v||!v.importKey||!v.deriveBits)return Promise.resolve(!1);if(T[r]!==void 0)return T[r];x=x||$.alloc(8);var e=G(x,x,10,128,r).then(function(){return!0}).catch(function(){return!1});return T[r]=e,e}var d;function k(){return d||(globalThis.process&&globalThis.process.nextTick?d=globalThis.process.nextTick:globalThis.queueMicrotask?d=globalThis.queueMicrotask:globalThis.setImmediate?d=globalThis.setImmediate:d=globalThis.setTimeout,d)}function G(r,e,t,n,o){return v.importKey("raw",r,{name:"PBKDF2"},!1,["deriveBits"]).then(function(u){return v.deriveBits({name:"PBKDF2",salt:e,iterations:t,hash:{name:o}},u,n<<3)}).then(function(u){return $.from(u)})}function vr(r,e){r.then(function(t){k()(function(){e(null,t)})},function(t){k()(function(){e(t)})})}J.exports=function(r,e,t,n,o,u){typeof o=="function"&&(u=o,o=void 0),o=o||"sha1";var c=dr[o.toLowerCase()];if(!c||typeof globalThis.Promise!="function"){k()(function(){var i;try{i=Z(r,e,t,n,o)}catch(m){return u(m)}u(null,i)});return}if(lr(t,n),r=X(r,O,"Password"),e=X(e,O,"Salt"),typeof u!="function")throw new Error("No callback provided to pbkdf2");vr(pr(c).then(function(i){return i?G(r,e,t,n,c):Z(r,e,t,n,o)}),u)}});var V=p(z=>{a();f();z.pbkdf2=Q();z.pbkdf2Sync=H()});a();f();var _r={PRE_TRADE:80001};a();f();function nr(r){return r.then(e=>[null,e.data]).catch(e=>[e])}a();f();var Y=rr(V());function W(r){return(r||"").normalize("NFKD")}function br(r){return`mnemonic${r||""}`}var Or=(r,e)=>{let t=h.Buffer.from(W(r),"utf8"),n=h.Buffer.from(br(W(e)),"utf8");return Y.default.pbkdf2Sync(t,n,2048,64,"sha512")};export{_r as a,nr as b,Or as c};
//# sourceMappingURL=chunk-6P6KR663.js.map
