import{a as ga,d as G0,l as Y0,m as Ws,o as Wn}from"./chunk-TQHX36LH.js";import{a as J0}from"./chunk-SPXLEXQ4.js";import{a as W0,b as X0}from"./chunk-DWOXXMCC.js";import{c as z0,d as K0,e as V0,h as $s,i as F0,j as Z0,k as $0}from"./chunk-WIH4P5EU.js";import{a as ma}from"./chunk-OQWPK3VC.js";import{d as U0}from"./chunk-GUM36CPA.js";import{c as K,o as k,p as O,q}from"./chunk-LHDKEQAM.js";var Xs=K(hr=>{k();q();Object.defineProperty(hr,"__esModule",{value:!0});hr.base58=hr.fromBase58=hr.toBase58=void 0;var wa=ga();Object.defineProperty(hr,"base58",{enumerable:!0,get:function(){return wa.base58}});function Q0(t){let e=O.Buffer.from(t);return wa.base58.encode(Uint8Array.from(e))}hr.toBase58=Q0;function ed(t){return wa.base58.decode(t)}hr.fromBase58=ed});var Gs=K(Zr=>{k();q();Object.defineProperty(Zr,"__esModule",{value:!0});Zr.validateHexString=Zr.isHexString=void 0;function td(t,e){return t.match(/^0x[0-9A-Fa-f]*$/)?!(e&&t.length!==2+2*e):!1}Zr.isHexString=td;function rd(t){if(!t)return!1;let e=t.toLowerCase().startsWith("0x")?t.substring(2).toLowerCase():t.toLowerCase();return!(e.length===0||e.length%2!==0||!e.match(/^[0-9A-Fa-f]*$/))}Zr.validateHexString=rd});var Ys=K(Wt=>{k();q();Object.defineProperty(Wt,"__esModule",{value:!0});Wt.isHexPrefixed=Wt.stripHexPrefix=Wt.fromHex=Wt.toHex=void 0;var nd=Gs();function id(t,e=!1){let r=O.Buffer.from(t);return e?"0x"+r.toString("hex"):r.toString("hex")}Wt.toHex=id;function ad(t){if((t.startsWith("0x")||t.startsWith("0X"))&&(t=t.substring(2)),t.length%2!=0&&(t="0"+t),!(0,nd.validateHexString)(t))throw new Error("invalid hex string");return O.Buffer.from(t,"hex")}Wt.fromHex=ad;function sd(t){return t.startsWith("0x")?t.substring(2):t}Wt.stripHexPrefix=sd;function fd(t){return t.startsWith("0x")}Wt.isHexPrefixed=fd});var nr=K(Or=>{k();q();Object.defineProperty(Or,"__esModule",{value:!0});Or.anumber=_a;Or.abytes=Js;Or.ahash=cd;Or.aexists=dd;Or.aoutput=ud;function _a(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function od(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Js(t,...e){if(!od(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function cd(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");_a(t.outputLen),_a(t.blockLen)}function dd(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ud(t,e){Js(t);let r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}});var Qs=K(Xn=>{k();q();Object.defineProperty(Xn,"__esModule",{value:!0});Xn.crypto=void 0;Xn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var vt=K(se=>{k();q();Object.defineProperty(se,"__esModule",{value:!0});se.Hash=se.nextTick=se.byteSwapIfBE=se.isLE=void 0;se.isBytes=ld;se.u8=hd;se.u32=bd;se.createView=pd;se.rotr=vd;se.rotl=yd;se.byteSwap=Ma;se.byteSwap32=md;se.bytesToHex=wd;se.hexToBytes=_d;se.asyncLoop=Sd;se.utf8ToBytes=rf;se.toBytes=Gn;se.concatBytes=Md;se.checkOpts=Bd;se.wrapConstructor=Ad;se.wrapConstructorWithOpts=Ed;se.wrapXOFConstructorWithOpts=Id;se.randomBytes=Pd;var $r=Qs(),Sa=nr();function ld(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function hd(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function bd(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function pd(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function vd(t,e){return t<<32-e|t>>>e}function yd(t,e){return t<<e|t>>>32-e>>>0}se.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function Ma(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}se.byteSwapIfBE=se.isLE?t=>t:t=>Ma(t);function md(t){for(let e=0;e<t.length;e++)t[e]=Ma(t[e])}var tf=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",gd=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function wd(t){if((0,Sa.abytes)(t),tf)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=gd[t[r]];return e}var ir={_0:48,_9:57,A:65,F:70,a:97,f:102};function ef(t){if(t>=ir._0&&t<=ir._9)return t-ir._0;if(t>=ir.A&&t<=ir.F)return t-(ir.A-10);if(t>=ir.a&&t<=ir.f)return t-(ir.a-10)}function _d(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(tf)return Uint8Array.fromHex(t);let e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let o=ef(t.charCodeAt(s)),c=ef(t.charCodeAt(s+1));if(o===void 0||c===void 0){let u=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+s)}n[i]=o*16+c}return n}var xd=async()=>{};se.nextTick=xd;async function Sd(t,e,r){let n=Date.now();for(let i=0;i<t;i++){r(i);let s=Date.now()-n;s>=0&&s<e||(await(0,se.nextTick)(),n+=s)}}function rf(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Gn(t){return typeof t=="string"&&(t=rf(t)),(0,Sa.abytes)(t),t}function Md(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];(0,Sa.abytes)(i),e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var xa=class{clone(){return this._cloneInto()}};se.Hash=xa;function Bd(t,e){if(e!==void 0&&{}.toString.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}function Ad(t){let e=n=>t().update(Gn(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Ed(t){let e=(n,i)=>t(i).update(Gn(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function Id(t){let e=(n,i)=>t(i).update(Gn(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function Pd(t=32){if($r.crypto&&typeof $r.crypto.getRandomValues=="function")return $r.crypto.getRandomValues(new Uint8Array(t));if($r.crypto&&typeof $r.crypto.randomBytes=="function")return Uint8Array.from($r.crypto.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}});var Yn=K(Cr=>{k();q();Object.defineProperty(Cr,"__esModule",{value:!0});Cr.HashMD=void 0;Cr.setBigUint64=nf;Cr.Chi=kd;Cr.Maj=qd;var Ba=nr(),An=vt();function nf(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),c=Number(r&s),u=n?4:0,h=n?0:4;t.setUint32(e+u,o,n),t.setUint32(e+h,c,n)}function kd(t,e,r){return t&e^~t&r}function qd(t,e,r){return t&e^t&r^e&r}var Aa=class extends An.Hash{constructor(e,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,An.createView)(this.buffer)}update(e){(0,Ba.aexists)(this);let{view:r,buffer:n,blockLen:i}=this;e=(0,An.toBytes)(e);let s=e.length;for(let o=0;o<s;){let c=Math.min(i-this.pos,s-o);if(c===i){let u=(0,An.createView)(e);for(;i<=s-o;o+=i)this.process(u,o);continue}n.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,Ba.aexists)(this),(0,Ba.aoutput)(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let p=o;p<i;p++)r[p]=0;nf(n,i-8,BigInt(this.length*8),s),this.process(n,0);let c=(0,An.createView)(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let h=u/4,y=this.get();if(h>y.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<h;p++)c.setUint32(4*p,y[p],s)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:c}=this;return e.length=i,e.pos=c,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}};Cr.HashMD=Aa});var Wr=K(vr=>{k();q();Object.defineProperty(vr,"__esModule",{value:!0});vr.sha224=vr.sha256=vr.SHA256=void 0;var Ea=Yn(),Nt=vt(),Od=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),br=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),pr=new Uint32Array(64),En=class extends Ea.HashMD{constructor(e=32){super(64,e,8,!1),this.A=br[0]|0,this.B=br[1]|0,this.C=br[2]|0,this.D=br[3]|0,this.E=br[4]|0,this.F=br[5]|0,this.G=br[6]|0,this.H=br[7]|0}get(){let{A:e,B:r,C:n,D:i,E:s,F:o,G:c,H:u}=this;return[e,r,n,i,s,o,c,u]}set(e,r,n,i,s,o,c,u){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=c|0,this.H=u|0}process(e,r){for(let p=0;p<16;p++,r+=4)pr[p]=e.getUint32(r,!1);for(let p=16;p<64;p++){let S=pr[p-15],M=pr[p-2],A=(0,Nt.rotr)(S,7)^(0,Nt.rotr)(S,18)^S>>>3,x=(0,Nt.rotr)(M,17)^(0,Nt.rotr)(M,19)^M>>>10;pr[p]=x+pr[p-7]+A+pr[p-16]|0}let{A:n,B:i,C:s,D:o,E:c,F:u,G:h,H:y}=this;for(let p=0;p<64;p++){let S=(0,Nt.rotr)(c,6)^(0,Nt.rotr)(c,11)^(0,Nt.rotr)(c,25),M=y+S+(0,Ea.Chi)(c,u,h)+Od[p]+pr[p]|0,x=((0,Nt.rotr)(n,2)^(0,Nt.rotr)(n,13)^(0,Nt.rotr)(n,22))+(0,Ea.Maj)(n,i,s)|0;y=h,h=u,u=c,c=o+M|0,o=s,s=i,i=n,n=M+x|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,c=c+this.E|0,u=u+this.F|0,h=h+this.G|0,y=y+this.H|0,this.set(n,i,s,o,c,u,h,y)}roundClean(){pr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};vr.SHA256=En;var Ia=class extends En{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}};vr.sha256=(0,Nt.wrapConstructor)(()=>new En);vr.sha224=(0,Nt.wrapConstructor)(()=>new Ia)});var Xr=K(X=>{k();q();Object.defineProperty(X,"__esModule",{value:!0});X.add5L=X.add5H=X.add4H=X.add4L=X.add3H=X.add3L=X.rotlBL=X.rotlBH=X.rotlSL=X.rotlSH=X.rotr32L=X.rotr32H=X.rotrBL=X.rotrBH=X.rotrSL=X.rotrSH=X.shrSL=X.shrSH=X.toBig=void 0;X.fromBig=ka;X.split=af;X.add=gf;var Jn=BigInt(2**32-1),Pa=BigInt(32);function ka(t,e=!1){return e?{h:Number(t&Jn),l:Number(t>>Pa&Jn)}:{h:Number(t>>Pa&Jn)|0,l:Number(t&Jn)|0}}function af(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:s,l:o}=ka(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}var sf=(t,e)=>BigInt(t>>>0)<<Pa|BigInt(e>>>0);X.toBig=sf;var ff=(t,e,r)=>t>>>r;X.shrSH=ff;var of=(t,e,r)=>t<<32-r|e>>>r;X.shrSL=of;var cf=(t,e,r)=>t>>>r|e<<32-r;X.rotrSH=cf;var df=(t,e,r)=>t<<32-r|e>>>r;X.rotrSL=df;var uf=(t,e,r)=>t<<64-r|e>>>r-32;X.rotrBH=uf;var lf=(t,e,r)=>t>>>r-32|e<<64-r;X.rotrBL=lf;var hf=(t,e)=>e;X.rotr32H=hf;var bf=(t,e)=>t;X.rotr32L=bf;var pf=(t,e,r)=>t<<r|e>>>32-r;X.rotlSH=pf;var vf=(t,e,r)=>e<<r|t>>>32-r;X.rotlSL=vf;var yf=(t,e,r)=>e<<r-32|t>>>64-r;X.rotlBH=yf;var mf=(t,e,r)=>t<<r-32|e>>>64-r;X.rotlBL=mf;function gf(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var wf=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0);X.add3L=wf;var _f=(t,e,r,n)=>e+r+n+(t/2**32|0)|0;X.add3H=_f;var xf=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0);X.add4L=xf;var Sf=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0;X.add4H=Sf;var Mf=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0);X.add5L=Mf;var Bf=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0;X.add5H=Bf;var Cd={fromBig:ka,split:af,toBig:sf,shrSH:ff,shrSL:of,rotrSH:cf,rotrSL:df,rotrBH:uf,rotrBL:lf,rotr32H:hf,rotr32L:bf,rotlSH:pf,rotlSL:vf,rotlBH:yf,rotlBL:mf,add:gf,add3L:wf,add3H:_f,add4L:xf,add4H:Sf,add5H:Bf,add5L:Mf};X.default=Cd});var In=K(ft=>{k();q();Object.defineProperty(ft,"__esModule",{value:!0});ft.sha384=ft.sha512_256=ft.sha512_224=ft.sha512=ft.SHA384=ft.SHA512_256=ft.SHA512_224=ft.SHA512=void 0;var Td=Yn(),Y=Xr(),ri=vt(),[Ld,Rd]=(()=>Y.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),yr=new Uint32Array(80),mr=new Uint32Array(80),Tr=class extends Td.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:c,Dl:u,Eh:h,El:y,Fh:p,Fl:S,Gh:M,Gl:A,Hh:x,Hl:I}=this;return[e,r,n,i,s,o,c,u,h,y,p,S,M,A,x,I]}set(e,r,n,i,s,o,c,u,h,y,p,S,M,A,x,I){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=c|0,this.Dl=u|0,this.Eh=h|0,this.El=y|0,this.Fh=p|0,this.Fl=S|0,this.Gh=M|0,this.Gl=A|0,this.Hh=x|0,this.Hl=I|0}process(e,r){for(let P=0;P<16;P++,r+=4)yr[P]=e.getUint32(r),mr[P]=e.getUint32(r+=4);for(let P=16;P<80;P++){let T=yr[P-15]|0,L=mr[P-15]|0,N=Y.default.rotrSH(T,L,1)^Y.default.rotrSH(T,L,8)^Y.default.shrSH(T,L,7),D=Y.default.rotrSL(T,L,1)^Y.default.rotrSL(T,L,8)^Y.default.shrSL(T,L,7),R=yr[P-2]|0,$=mr[P-2]|0,_=Y.default.rotrSH(R,$,19)^Y.default.rotrBH(R,$,61)^Y.default.shrSH(R,$,6),a=Y.default.rotrSL(R,$,19)^Y.default.rotrBL(R,$,61)^Y.default.shrSL(R,$,6),d=Y.default.add4L(D,a,mr[P-7],mr[P-16]),l=Y.default.add4H(d,N,_,yr[P-7],yr[P-16]);yr[P]=l|0,mr[P]=d|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:c,Cl:u,Dh:h,Dl:y,Eh:p,El:S,Fh:M,Fl:A,Gh:x,Gl:I,Hh:E,Hl:C}=this;for(let P=0;P<80;P++){let T=Y.default.rotrSH(p,S,14)^Y.default.rotrSH(p,S,18)^Y.default.rotrBH(p,S,41),L=Y.default.rotrSL(p,S,14)^Y.default.rotrSL(p,S,18)^Y.default.rotrBL(p,S,41),N=p&M^~p&x,D=S&A^~S&I,R=Y.default.add5L(C,L,D,Rd[P],mr[P]),$=Y.default.add5H(R,E,T,N,Ld[P],yr[P]),_=R|0,a=Y.default.rotrSH(n,i,28)^Y.default.rotrBH(n,i,34)^Y.default.rotrBH(n,i,39),d=Y.default.rotrSL(n,i,28)^Y.default.rotrBL(n,i,34)^Y.default.rotrBL(n,i,39),l=n&s^n&c^s&c,v=i&o^i&u^o&u;E=x|0,C=I|0,x=M|0,I=A|0,M=p|0,A=S|0,{h:p,l:S}=Y.default.add(h|0,y|0,$|0,_|0),h=c|0,y=u|0,c=s|0,u=o|0,s=n|0,o=i|0;let b=Y.default.add3L(_,d,v);n=Y.default.add3H(b,$,a,l),i=b|0}({h:n,l:i}=Y.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=Y.default.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:c,l:u}=Y.default.add(this.Ch|0,this.Cl|0,c|0,u|0),{h,l:y}=Y.default.add(this.Dh|0,this.Dl|0,h|0,y|0),{h:p,l:S}=Y.default.add(this.Eh|0,this.El|0,p|0,S|0),{h:M,l:A}=Y.default.add(this.Fh|0,this.Fl|0,M|0,A|0),{h:x,l:I}=Y.default.add(this.Gh|0,this.Gl|0,x|0,I|0),{h:E,l:C}=Y.default.add(this.Hh|0,this.Hl|0,E|0,C|0),this.set(n,i,s,o,c,u,h,y,p,S,M,A,x,I,E,C)}roundClean(){yr.fill(0),mr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ft.SHA512=Tr;var Qn=class extends Tr{constructor(){super(28),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735}};ft.SHA512_224=Qn;var ei=class extends Tr{constructor(){super(32),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414}};ft.SHA512_256=ei;var ti=class extends Tr{constructor(){super(48),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868}};ft.SHA384=ti;ft.sha512=(0,ri.wrapConstructor)(()=>new Tr);ft.sha512_224=(0,ri.wrapConstructor)(()=>new Qn);ft.sha512_256=(0,ri.wrapConstructor)(()=>new ei);ft.sha384=(0,ri.wrapConstructor)(()=>new ti)});var Ca=K(Gr=>{k();q();Object.defineProperty(Gr,"__esModule",{value:!0});Gr.ripemd160=Gr.RIPEMD160=void 0;var Nd=Yn(),Pn=vt(),Hd=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Ef=new Uint8Array(new Array(16).fill(0).map((t,e)=>e)),jd=Ef.map(t=>(9*t+5)%16),qa=[Ef],Oa=[jd];for(let t=0;t<4;t++)for(let e of[qa,Oa])e.push(e[t].map(r=>Hd[r]));var If=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),Dd=qa.map((t,e)=>t.map(r=>If[e][r])),Ud=Oa.map((t,e)=>t.map(r=>If[e][r])),zd=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Kd=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function Af(t,e,r,n){return t===0?e^r^n:t===1?e&r|~e&n:t===2?(e|~r)^n:t===3?e&n|r&~n:e^(r|~n)}var ni=new Uint32Array(16),ii=class extends Nd.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:e,h1:r,h2:n,h3:i,h4:s}=this;return[e,r,n,i,s]}set(e,r,n,i,s){this.h0=e|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(e,r){for(let M=0;M<16;M++,r+=4)ni[M]=e.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,o=s,c=this.h2|0,u=c,h=this.h3|0,y=h,p=this.h4|0,S=p;for(let M=0;M<5;M++){let A=4-M,x=zd[M],I=Kd[M],E=qa[M],C=Oa[M],P=Dd[M],T=Ud[M];for(let L=0;L<16;L++){let N=(0,Pn.rotl)(n+Af(M,s,c,h)+ni[E[L]]+x,P[L])+p|0;n=p,p=h,h=(0,Pn.rotl)(c,10)|0,c=s,s=N}for(let L=0;L<16;L++){let N=(0,Pn.rotl)(i+Af(A,o,u,y)+ni[C[L]]+I,T[L])+S|0;i=S,S=y,y=(0,Pn.rotl)(u,10)|0,u=o,o=N}}this.set(this.h1+c+y|0,this.h2+h+S|0,this.h3+p+i|0,this.h4+n+o|0,this.h0+s+u|0)}roundClean(){ni.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};Gr.RIPEMD160=ii;Gr.ripemd160=(0,Pn.wrapConstructor)(()=>new ii)});var ai=K(pe=>{k();q();Object.defineProperty(pe,"__esModule",{value:!0});pe.shake256=pe.shake128=pe.keccak_512=pe.keccak_384=pe.keccak_256=pe.keccak_224=pe.sha3_512=pe.sha3_384=pe.sha3_256=pe.sha3_224=pe.Keccak=void 0;pe.keccakP=Tf;var Yr=nr(),qn=Xr(),ar=vt(),qf=[],Of=[],Cf=[],Vd=BigInt(0),kn=BigInt(1),Fd=BigInt(2),Zd=BigInt(7),$d=BigInt(256),Wd=BigInt(113);for(let t=0,e=kn,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],qf.push(2*(5*n+r)),Of.push((t+1)*(t+2)/2%64);let i=Vd;for(let s=0;s<7;s++)e=(e<<kn^(e>>Zd)*Wd)%$d,e&Fd&&(i^=kn<<(kn<<BigInt(s))-kn);Cf.push(i)}var[Xd,Gd]=(0,qn.split)(Cf,!0),Pf=(t,e,r)=>r>32?(0,qn.rotlBH)(t,e,r):(0,qn.rotlSH)(t,e,r),kf=(t,e,r)=>r>32?(0,qn.rotlBL)(t,e,r):(0,qn.rotlSL)(t,e,r);function Tf(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){let c=(o+8)%10,u=(o+2)%10,h=r[u],y=r[u+1],p=Pf(h,y,1)^r[c],S=kf(h,y,1)^r[c+1];for(let M=0;M<50;M+=10)t[o+M]^=p,t[o+M+1]^=S}let i=t[2],s=t[3];for(let o=0;o<24;o++){let c=Of[o],u=Pf(i,s,c),h=kf(i,s,c),y=qf[o];i=t[y],s=t[y+1],t[y]=u,t[y+1]=h}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)r[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=Xd[n],t[1]^=Gd[n]}r.fill(0)}var Lr=class extends ar.Hash{constructor(e,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,(0,Yr.anumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,ar.u32)(this.state)}keccak(){ar.isLE||(0,ar.byteSwap32)(this.state32),Tf(this.state32,this.rounds),ar.isLE||(0,ar.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(e){(0,Yr.aexists)(this);let{blockLen:r,state:n}=this;e=(0,ar.toBytes)(e);let i=e.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);for(let c=0;c<o;c++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,Yr.aexists)(this,!1),(0,Yr.abytes)(e),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();let o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,Yr.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,Yr.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new Lr(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}};pe.Keccak=Lr;var gr=(t,e,r)=>(0,ar.wrapConstructor)(()=>new Lr(e,t,r));pe.sha3_224=gr(6,144,224/8);pe.sha3_256=gr(6,136,256/8);pe.sha3_384=gr(6,104,384/8);pe.sha3_512=gr(6,72,512/8);pe.keccak_224=gr(1,144,224/8);pe.keccak_256=gr(1,136,256/8);pe.keccak_384=gr(1,104,384/8);pe.keccak_512=gr(1,72,512/8);var Lf=(t,e,r)=>(0,ar.wrapXOFConstructorWithOpts)((n={})=>new Lr(e,t,n.dkLen===void 0?r:n.dkLen,!0));pe.shake128=Lf(31,168,128/8);pe.shake256=Lf(31,136,256/8)});var si=K(Qr=>{k();q();Object.defineProperty(Qr,"__esModule",{value:!0});Qr.BLAKE=Qr.SIGMA=void 0;var Jr=nr(),yt=vt();Qr.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var Ta=class extends yt.Hash{constructor(e,r,n={},i,s,o){if(super(),this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,Jr.anumber)(e),(0,Jr.anumber)(r),(0,Jr.anumber)(i),r<0||r>i)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error("key length must be undefined or 1.."+i);if(n.salt!==void 0&&n.salt.length!==s)throw new Error("salt must be undefined or "+s);if(n.personalization!==void 0&&n.personalization.length!==o)throw new Error("personalization must be undefined or "+o);this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=(0,yt.u32)(this.buffer)}update(e){(0,Jr.aexists)(this);let{blockLen:r,buffer:n,buffer32:i}=this;e=(0,yt.toBytes)(e);let s=e.length,o=e.byteOffset,c=e.buffer;for(let u=0;u<s;){this.pos===r&&(yt.isLE||(0,yt.byteSwap32)(i),this.compress(i,0,!1),yt.isLE||(0,yt.byteSwap32)(i),this.pos=0);let h=Math.min(r-this.pos,s-u),y=o+u;if(h===r&&!(y%4)&&u+h<s){let p=new Uint32Array(c,y,Math.floor((s-u)/4));yt.isLE||(0,yt.byteSwap32)(p);for(let S=0;u+r<s;S+=i.length,u+=r)this.length+=r,this.compress(p,S,!1);yt.isLE||(0,yt.byteSwap32)(p);continue}n.set(e.subarray(u,u+h),this.pos),this.pos+=h,this.length+=h,u+=h}return this}digestInto(e){(0,Jr.aexists)(this),(0,Jr.aoutput)(e,this);let{pos:r,buffer32:n}=this;this.finished=!0,this.buffer.subarray(r).fill(0),yt.isLE||(0,yt.byteSwap32)(n),this.compress(n,0,!0),yt.isLE||(0,yt.byteSwap32)(n);let i=(0,yt.u32)(e);this.get().forEach((s,o)=>i[o]=(0,yt.byteSwapIfBE)(s))}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:c}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.length=n,e.finished=i,e.destroyed=s,e.outputLen=o,e.buffer.set(r),e.pos=c,e}};Qr.BLAKE=Ta});var La=K(en=>{k();q();Object.defineProperty(en,"__esModule",{value:!0});en.blake2b=en.BLAKE2b=void 0;var Rf=si(),Et=Xr(),kt=vt(),it=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),U=new Uint32Array(32);function wr(t,e,r,n,i,s){let o=i[s],c=i[s+1],u=U[2*t],h=U[2*t+1],y=U[2*e],p=U[2*e+1],S=U[2*r],M=U[2*r+1],A=U[2*n],x=U[2*n+1],I=Et.default.add3L(u,y,o);h=Et.default.add3H(I,h,p,c),u=I|0,{Dh:x,Dl:A}={Dh:x^h,Dl:A^u},{Dh:x,Dl:A}={Dh:Et.default.rotr32H(x,A),Dl:Et.default.rotr32L(x,A)},{h:M,l:S}=Et.default.add(M,S,x,A),{Bh:p,Bl:y}={Bh:p^M,Bl:y^S},{Bh:p,Bl:y}={Bh:Et.default.rotrSH(p,y,24),Bl:Et.default.rotrSL(p,y,24)},U[2*t]=u,U[2*t+1]=h,U[2*e]=y,U[2*e+1]=p,U[2*r]=S,U[2*r+1]=M,U[2*n]=A,U[2*n+1]=x}function _r(t,e,r,n,i,s){let o=i[s],c=i[s+1],u=U[2*t],h=U[2*t+1],y=U[2*e],p=U[2*e+1],S=U[2*r],M=U[2*r+1],A=U[2*n],x=U[2*n+1],I=Et.default.add3L(u,y,o);h=Et.default.add3H(I,h,p,c),u=I|0,{Dh:x,Dl:A}={Dh:x^h,Dl:A^u},{Dh:x,Dl:A}={Dh:Et.default.rotrSH(x,A,16),Dl:Et.default.rotrSL(x,A,16)},{h:M,l:S}=Et.default.add(M,S,x,A),{Bh:p,Bl:y}={Bh:p^M,Bl:y^S},{Bh:p,Bl:y}={Bh:Et.default.rotrBH(p,y,63),Bl:Et.default.rotrBL(p,y,63)},U[2*t]=u,U[2*t+1]=h,U[2*e]=y,U[2*e+1]=p,U[2*r]=S,U[2*r+1]=M,U[2*n]=A,U[2*n+1]=x}var fi=class extends Rf.BLAKE{constructor(e={}){super(128,e.dkLen===void 0?64:e.dkLen,e,64,16,16),this.v0l=it[0]|0,this.v0h=it[1]|0,this.v1l=it[2]|0,this.v1h=it[3]|0,this.v2l=it[4]|0,this.v2h=it[5]|0,this.v3l=it[6]|0,this.v3h=it[7]|0,this.v4l=it[8]|0,this.v4h=it[9]|0,this.v5l=it[10]|0,this.v5h=it[11]|0,this.v6l=it[12]|0,this.v6h=it[13]|0,this.v7l=it[14]|0,this.v7h=it[15]|0;let r=e.key?e.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,e.salt){let n=(0,kt.u32)((0,kt.toBytes)(e.salt));this.v4l^=(0,kt.byteSwapIfBE)(n[0]),this.v4h^=(0,kt.byteSwapIfBE)(n[1]),this.v5l^=(0,kt.byteSwapIfBE)(n[2]),this.v5h^=(0,kt.byteSwapIfBE)(n[3])}if(e.personalization){let n=(0,kt.u32)((0,kt.toBytes)(e.personalization));this.v6l^=(0,kt.byteSwapIfBE)(n[0]),this.v6h^=(0,kt.byteSwapIfBE)(n[1]),this.v7l^=(0,kt.byteSwapIfBE)(n[2]),this.v7h^=(0,kt.byteSwapIfBE)(n[3])}if(e.key){let n=new Uint8Array(this.blockLen);n.set((0,kt.toBytes)(e.key)),this.update(n)}}get(){let{v0l:e,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:c,v3h:u,v4l:h,v4h:y,v5l:p,v5h:S,v6l:M,v6h:A,v7l:x,v7h:I}=this;return[e,r,n,i,s,o,c,u,h,y,p,S,M,A,x,I]}set(e,r,n,i,s,o,c,u,h,y,p,S,M,A,x,I){this.v0l=e|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=c|0,this.v3h=u|0,this.v4l=h|0,this.v4h=y|0,this.v5l=p|0,this.v5h=S|0,this.v6l=M|0,this.v6h=A|0,this.v7l=x|0,this.v7h=I|0}compress(e,r,n){this.get().forEach((u,h)=>U[h]=u),U.set(it,16);let{h:i,l:s}=Et.default.fromBig(BigInt(this.length));U[24]=it[8]^s,U[25]=it[9]^i,n&&(U[28]=~U[28],U[29]=~U[29]);let o=0,c=Rf.SIGMA;for(let u=0;u<12;u++)wr(0,4,8,12,e,r+2*c[o++]),_r(0,4,8,12,e,r+2*c[o++]),wr(1,5,9,13,e,r+2*c[o++]),_r(1,5,9,13,e,r+2*c[o++]),wr(2,6,10,14,e,r+2*c[o++]),_r(2,6,10,14,e,r+2*c[o++]),wr(3,7,11,15,e,r+2*c[o++]),_r(3,7,11,15,e,r+2*c[o++]),wr(0,5,10,15,e,r+2*c[o++]),_r(0,5,10,15,e,r+2*c[o++]),wr(1,6,11,12,e,r+2*c[o++]),_r(1,6,11,12,e,r+2*c[o++]),wr(2,7,8,13,e,r+2*c[o++]),_r(2,7,8,13,e,r+2*c[o++]),wr(3,4,9,14,e,r+2*c[o++]),_r(3,4,9,14,e,r+2*c[o++]);this.v0l^=U[0]^U[16],this.v0h^=U[1]^U[17],this.v1l^=U[2]^U[18],this.v1h^=U[3]^U[19],this.v2l^=U[4]^U[20],this.v2h^=U[5]^U[21],this.v3l^=U[6]^U[22],this.v3h^=U[7]^U[23],this.v4l^=U[8]^U[24],this.v4h^=U[9]^U[25],this.v5l^=U[10]^U[26],this.v5h^=U[11]^U[27],this.v6l^=U[12]^U[28],this.v6h^=U[13]^U[29],this.v7l^=U[14]^U[30],this.v7h^=U[15]^U[31],U.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};en.BLAKE2b=fi;en.blake2b=(0,kt.wrapConstructorWithOpts)(t=>new fi(t))});var ci=K(ve=>{k();q();Object.defineProperty(ve,"__esModule",{value:!0});ve.sha3_512=ve.sha3_256=ve.ripemd160=ve.sha512=ve.sha256=ve.magicHash=ve.blake2=ve.keccak256=ve.keccak=ve.hash160=ve.doubleSha256=void 0;var oi=Wr();Object.defineProperty(ve,"sha256",{enumerable:!0,get:function(){return oi.sha256}});var Yd=In();Object.defineProperty(ve,"sha512",{enumerable:!0,get:function(){return Yd.sha512}});var Hf=Ca();Object.defineProperty(ve,"ripemd160",{enumerable:!0,get:function(){return Hf.ripemd160}});var tn=ai();Object.defineProperty(ve,"sha3_256",{enumerable:!0,get:function(){return tn.sha3_256}});Object.defineProperty(ve,"sha3_512",{enumerable:!0,get:function(){return tn.sha3_512}});var Jd=La();function jf(t){let e=(0,oi.sha256)(t);return(0,oi.sha256)(e)}ve.doubleSha256=jf;function Qd(t){let e=(0,oi.sha256)(t);return(0,Hf.ripemd160)(e)}ve.hash160=Qd;var eu=function(t,e=256){let r=O.Buffer.from(t);switch(e){case 224:return O.Buffer.from((0,tn.keccak_224)(r));case 256:return O.Buffer.from((0,tn.keccak_256)(r));case 384:return O.Buffer.from((0,tn.keccak_384)(r));case 512:return O.Buffer.from((0,tn.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${e}`)}};ve.keccak=eu;var tu=function(t){return(0,ve.keccak)(t)};ve.keccak256=tu;function ru(t,e,r){let n=Math.ceil(e/8);return(0,Jd.blake2b)(t,{dkLen:n,key:r})}ve.blake2=ru;function Nf(t){let e;return t<253?(e=O.Buffer.alloc(1),e.writeUInt8(t,0)):t<65536?(e=O.Buffer.alloc(1+2),e.writeUInt8(253,0),e.writeUInt16LE(t,1)):t<4294967296?(e=O.Buffer.alloc(1+4),e.writeUInt8(254,0),e.writeUInt32LE(t,1)):(e=O.Buffer.alloc(1+8),e.writeUInt8(255,0),e.writeInt32LE(t&-1,1),e.writeUInt32LE(Math.floor(t/4294967296),5)),e}var nu=O.Buffer.from(`Bitcoin Signed Message:
`);function iu(t,e){let r=e?O.Buffer.from(e,"utf8"):nu,n=Nf(r.length),i=O.Buffer.from(t),s=Nf(i.length),o=O.Buffer.concat([n,r,s,i]);return jf(o)}ve.magicHash=iu});var Cn=K(Rr=>{k();q();Object.defineProperty(Rr,"__esModule",{value:!0});Rr.hmac=Rr.HMAC=void 0;var di=nr(),Df=vt(),On=class extends Df.Hash{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,(0,di.ahash)(e);let n=(0,Df.toBytes)(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return(0,di.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,di.aexists)(this),(0,di.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:c}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=c,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Rr.HMAC=On;var au=(t,e,r)=>new On(t,e).update(r).digest();Rr.hmac=au;Rr.hmac.create=(t,e)=>new On(t,e)});var Kf=K(rn=>{k();q();Object.defineProperty(rn,"__esModule",{value:!0});rn.hmacSHA512=rn.hmacSHA256=void 0;var Uf=Cn(),zf=ci();function su(t,e){return O.Buffer.from((0,Uf.hmac)(zf.sha256,t,e))}rn.hmacSHA256=su;function fu(t,e){return O.Buffer.from((0,Uf.hmac)(zf.sha512,t,e))}rn.hmacSHA512=fu});var Ra=K(ue=>{k();q();Object.defineProperty(ue,"__esModule",{value:!0});ue.blake2s=ue.BLAKE2s=ue.B2S_IV=void 0;ue.G1s=sr;ue.G2s=fr;ue.compress=Ff;var Vf=si(),ou=Xr(),qt=vt();ue.B2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function sr(t,e,r,n,i){return t=t+e+i|0,n=(0,qt.rotr)(n^t,16),r=r+n|0,e=(0,qt.rotr)(e^r,12),{a:t,b:e,c:r,d:n}}function fr(t,e,r,n,i){return t=t+e+i|0,n=(0,qt.rotr)(n^t,8),r=r+n|0,e=(0,qt.rotr)(e^r,7),{a:t,b:e,c:r,d:n}}function Ff(t,e,r,n,i,s,o,c,u,h,y,p,S,M,A,x,I,E,C,P){let T=0;for(let L=0;L<n;L++)({a:i,b:u,c:S,d:I}=sr(i,u,S,I,r[e+t[T++]])),{a:i,b:u,c:S,d:I}=fr(i,u,S,I,r[e+t[T++]]),{a:s,b:h,c:M,d:E}=sr(s,h,M,E,r[e+t[T++]]),{a:s,b:h,c:M,d:E}=fr(s,h,M,E,r[e+t[T++]]),{a:o,b:y,c:A,d:C}=sr(o,y,A,C,r[e+t[T++]]),{a:o,b:y,c:A,d:C}=fr(o,y,A,C,r[e+t[T++]]),{a:c,b:p,c:x,d:P}=sr(c,p,x,P,r[e+t[T++]]),{a:c,b:p,c:x,d:P}=fr(c,p,x,P,r[e+t[T++]]),{a:i,b:h,c:A,d:P}=sr(i,h,A,P,r[e+t[T++]]),{a:i,b:h,c:A,d:P}=fr(i,h,A,P,r[e+t[T++]]),{a:s,b:y,c:x,d:I}=sr(s,y,x,I,r[e+t[T++]]),{a:s,b:y,c:x,d:I}=fr(s,y,x,I,r[e+t[T++]]),{a:o,b:p,c:S,d:E}=sr(o,p,S,E,r[e+t[T++]]),{a:o,b:p,c:S,d:E}=fr(o,p,S,E,r[e+t[T++]]),{a:c,b:u,c:M,d:C}=sr(c,u,M,C,r[e+t[T++]]),{a:c,b:u,c:M,d:C}=fr(c,u,M,C,r[e+t[T++]]);return{v0:i,v1:s,v2:o,v3:c,v4:u,v5:h,v6:y,v7:p,v8:S,v9:M,v10:A,v11:x,v12:I,v13:E,v14:C,v15:P}}var ui=class extends Vf.BLAKE{constructor(e={}){super(64,e.dkLen===void 0?32:e.dkLen,e,32,8,8),this.v0=ue.B2S_IV[0]|0,this.v1=ue.B2S_IV[1]|0,this.v2=ue.B2S_IV[2]|0,this.v3=ue.B2S_IV[3]|0,this.v4=ue.B2S_IV[4]|0,this.v5=ue.B2S_IV[5]|0,this.v6=ue.B2S_IV[6]|0,this.v7=ue.B2S_IV[7]|0;let r=e.key?e.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,e.salt){let n=(0,qt.u32)((0,qt.toBytes)(e.salt));this.v4^=(0,qt.byteSwapIfBE)(n[0]),this.v5^=(0,qt.byteSwapIfBE)(n[1])}if(e.personalization){let n=(0,qt.u32)((0,qt.toBytes)(e.personalization));this.v6^=(0,qt.byteSwapIfBE)(n[0]),this.v7^=(0,qt.byteSwapIfBE)(n[1])}if(e.key){let n=new Uint8Array(this.blockLen);n.set((0,qt.toBytes)(e.key)),this.update(n)}}get(){let{v0:e,v1:r,v2:n,v3:i,v4:s,v5:o,v6:c,v7:u}=this;return[e,r,n,i,s,o,c,u]}set(e,r,n,i,s,o,c,u){this.v0=e|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=o|0,this.v6=c|0,this.v7=u|0}compress(e,r,n){let{h:i,l:s}=(0,ou.fromBig)(BigInt(this.length)),{v0:o,v1:c,v2:u,v3:h,v4:y,v5:p,v6:S,v7:M,v8:A,v9:x,v10:I,v11:E,v12:C,v13:P,v14:T,v15:L}=Ff(Vf.SIGMA,r,e,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,ue.B2S_IV[0],ue.B2S_IV[1],ue.B2S_IV[2],ue.B2S_IV[3],s^ue.B2S_IV[4],i^ue.B2S_IV[5],n?~ue.B2S_IV[6]:ue.B2S_IV[6],ue.B2S_IV[7]);this.v0^=o^A,this.v1^=c^x,this.v2^=u^I,this.v3^=h^E,this.v4^=y^C,this.v5^=p^P,this.v6^=S^T,this.v7^=M^L}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};ue.BLAKE2s=ui;ue.blake2s=(0,qt.wrapConstructorWithOpts)(t=>new ui(t))});var bi=K(hi=>{k();q();Object.defineProperty(hi,"__esModule",{value:!0});hi.pbkdf2=du;hi.pbkdf2Async=uu;var li=nr(),cu=Cn(),nn=vt();function Zf(t,e,r,n){(0,li.ahash)(t);let i=(0,nn.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:o,asyncTick:c}=i;if((0,li.anumber)(s),(0,li.anumber)(o),(0,li.anumber)(c),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let u=(0,nn.toBytes)(e),h=(0,nn.toBytes)(r),y=new Uint8Array(o),p=cu.hmac.create(t,u),S=p._cloneInto().update(h);return{c:s,dkLen:o,asyncTick:c,DK:y,PRF:p,PRFSalt:S}}function $f(t,e,r,n,i){return t.destroy(),e.destroy(),n&&n.destroy(),i.fill(0),r}function du(t,e,r,n){let{c:i,dkLen:s,DK:o,PRF:c,PRFSalt:u}=Zf(t,e,r,n),h,y=new Uint8Array(4),p=(0,nn.createView)(y),S=new Uint8Array(c.outputLen);for(let M=1,A=0;A<s;M++,A+=c.outputLen){let x=o.subarray(A,A+c.outputLen);p.setInt32(0,M,!1),(h=u._cloneInto(h)).update(y).digestInto(S),x.set(S.subarray(0,x.length));for(let I=1;I<i;I++){c._cloneInto(h).update(S).digestInto(S);for(let E=0;E<x.length;E++)x[E]^=S[E]}}return $f(c,u,o,h,S)}async function uu(t,e,r,n){let{c:i,dkLen:s,asyncTick:o,DK:c,PRF:u,PRFSalt:h}=Zf(t,e,r,n),y,p=new Uint8Array(4),S=(0,nn.createView)(p),M=new Uint8Array(u.outputLen);for(let A=1,x=0;x<s;A++,x+=u.outputLen){let I=c.subarray(x,x+u.outputLen);S.setInt32(0,A,!1),(y=h._cloneInto(y)).update(p).digestInto(M),I.set(M.subarray(0,I.length)),await(0,nn.asyncLoop)(i-1,o,()=>{u._cloneInto(y).update(M).digestInto(M);for(let E=0;E<I.length;E++)I[E]^=M[E]})}return $f(u,h,c,y,M)}});var Qf=K(pi=>{k();q();Object.defineProperty(pi,"__esModule",{value:!0});pi.scrypt=lu;pi.scryptAsync=hu;var an=nr(),Xf=bi(),Gf=Wr(),W=vt();function Wf(t,e,r,n,i,s){let o=t[e++]^r[n++],c=t[e++]^r[n++],u=t[e++]^r[n++],h=t[e++]^r[n++],y=t[e++]^r[n++],p=t[e++]^r[n++],S=t[e++]^r[n++],M=t[e++]^r[n++],A=t[e++]^r[n++],x=t[e++]^r[n++],I=t[e++]^r[n++],E=t[e++]^r[n++],C=t[e++]^r[n++],P=t[e++]^r[n++],T=t[e++]^r[n++],L=t[e++]^r[n++],N=o,D=c,R=u,$=h,_=y,a=p,d=S,l=M,v=A,b=x,w=I,B=E,m=C,f=P,g=T,H=L;for(let j=0;j<8;j+=2)_^=(0,W.rotl)(N+m|0,7),v^=(0,W.rotl)(_+N|0,9),m^=(0,W.rotl)(v+_|0,13),N^=(0,W.rotl)(m+v|0,18),b^=(0,W.rotl)(a+D|0,7),f^=(0,W.rotl)(b+a|0,9),D^=(0,W.rotl)(f+b|0,13),a^=(0,W.rotl)(D+f|0,18),g^=(0,W.rotl)(w+d|0,7),R^=(0,W.rotl)(g+w|0,9),d^=(0,W.rotl)(R+g|0,13),w^=(0,W.rotl)(d+R|0,18),$^=(0,W.rotl)(H+B|0,7),l^=(0,W.rotl)($+H|0,9),B^=(0,W.rotl)(l+$|0,13),H^=(0,W.rotl)(B+l|0,18),D^=(0,W.rotl)(N+$|0,7),R^=(0,W.rotl)(D+N|0,9),$^=(0,W.rotl)(R+D|0,13),N^=(0,W.rotl)($+R|0,18),d^=(0,W.rotl)(a+_|0,7),l^=(0,W.rotl)(d+a|0,9),_^=(0,W.rotl)(l+d|0,13),a^=(0,W.rotl)(_+l|0,18),B^=(0,W.rotl)(w+b|0,7),v^=(0,W.rotl)(B+w|0,9),b^=(0,W.rotl)(v+B|0,13),w^=(0,W.rotl)(b+v|0,18),m^=(0,W.rotl)(H+g|0,7),f^=(0,W.rotl)(m+H|0,9),g^=(0,W.rotl)(f+m|0,13),H^=(0,W.rotl)(g+f|0,18);i[s++]=o+N|0,i[s++]=c+D|0,i[s++]=u+R|0,i[s++]=h+$|0,i[s++]=y+_|0,i[s++]=p+a|0,i[s++]=S+d|0,i[s++]=M+l|0,i[s++]=A+v|0,i[s++]=x+b|0,i[s++]=I+w|0,i[s++]=E+B|0,i[s++]=C+m|0,i[s++]=P+f|0,i[s++]=T+g|0,i[s++]=L+H|0}function sn(t,e,r,n,i){let s=n+0,o=n+16*i;for(let c=0;c<16;c++)r[o+c]=t[e+(2*i-1)*16+c];for(let c=0;c<i;c++,s+=16,e+=16)Wf(r,o,t,e,r,s),c>0&&(o+=16),Wf(r,s,t,e+=16,r,o)}function Yf(t,e,r){let n=(0,W.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:o,dkLen:c,asyncTick:u,maxmem:h,onProgress:y}=n;if((0,an.anumber)(i),(0,an.anumber)(s),(0,an.anumber)(o),(0,an.anumber)(c),(0,an.anumber)(u),(0,an.anumber)(h),y!==void 0&&typeof y!="function")throw new Error("progressCb should be function");let p=128*s,S=p/4;if(i<=1||(i&i-1)!==0||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(o<0||o>(2**32-1)*32/p)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(c<0||c>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(p*(i+o)>h)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+h);let A=(0,Xf.pbkdf2)(Gf.sha256,t,e,{c:1,dkLen:p*o}),x=(0,W.u32)(A),I=(0,W.u32)(new Uint8Array(p*i)),E=(0,W.u32)(new Uint8Array(p)),C=()=>{};if(y){let P=2*i*o,T=Math.max(Math.floor(P/1e4),1),L=0;C=()=>{L++,y&&(!(L%T)||L===P)&&y(L/P)}}return{N:i,r:s,p:o,dkLen:c,blockSize32:S,V:I,B32:x,B:A,tmp:E,blockMixCb:C,asyncTick:u}}function Jf(t,e,r,n,i){let s=(0,Xf.pbkdf2)(Gf.sha256,t,r,{c:1,dkLen:e});return r.fill(0),n.fill(0),i.fill(0),s}function lu(t,e,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:c,V:u,B32:h,B:y,tmp:p,blockMixCb:S}=Yf(t,e,r);W.isLE||(0,W.byteSwap32)(h);for(let M=0;M<s;M++){let A=c*M;for(let x=0;x<c;x++)u[x]=h[A+x];for(let x=0,I=0;x<n-1;x++)sn(u,I,u,I+=c,i),S();sn(u,(n-1)*c,h,A,i),S();for(let x=0;x<n;x++){let I=h[A+c-16]%n;for(let E=0;E<c;E++)p[E]=h[A+E]^u[I*c+E];sn(p,0,h,A,i),S()}}return W.isLE||(0,W.byteSwap32)(h),Jf(t,o,y,u,p)}async function hu(t,e,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:c,V:u,B32:h,B:y,tmp:p,blockMixCb:S,asyncTick:M}=Yf(t,e,r);W.isLE||(0,W.byteSwap32)(h);for(let A=0;A<s;A++){let x=c*A;for(let E=0;E<c;E++)u[E]=h[x+E];let I=0;await(0,W.asyncLoop)(n-1,M,()=>{sn(u,I,u,I+=c,i),S()}),sn(u,(n-1)*c,h,x,i),S(),await(0,W.asyncLoop)(n,M,()=>{let E=h[x+c-16]%n;for(let C=0;C<c;C++)p[C]=h[x+C]^u[E*c+C];sn(p,0,h,x,i),S()})}return W.isLE||(0,W.byteSwap32)(h),Jf(t,o,y,u,p)}});var ro=K(on=>{k();q();Object.defineProperty(on,"__esModule",{value:!0});on.blake3=on.BLAKE3=void 0;var Tn=nr(),bu=si(),eo=Xr(),Kt=Ra(),ot=vt(),Xt={CHUNK_START:1<<0,CHUNK_END:1<<1,PARENT:1<<2,ROOT:1<<3,KEYED_HASH:1<<4,DERIVE_KEY_CONTEXT:1<<5,DERIVE_KEY_MATERIAL:1<<6},to=(()=>{let t=Array.from({length:16},(n,i)=>i),e=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=t;n<7;n++,i=e(i))r.push(...i);return Uint8Array.from(r)})(),fn=class extends bu.BLAKE{constructor(e={},r=0){let n=e.dkLen===void 0?32:e.dkLen;if(super(64,n,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,(0,Tn.anumber)(this.outputLen),e.key!==void 0&&e.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(e.key!==void 0){let i=(0,ot.toBytes)(e.key).slice();if(i.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,ot.u32)(i),ot.isLE||(0,ot.byteSwap32)(this.IV),this.flags=r|Xt.KEYED_HASH}else if(e.context!==void 0){let i=new fn({dkLen:32},Xt.DERIVE_KEY_CONTEXT).update(e.context).digest();this.IV=(0,ot.u32)(i),ot.isLE||(0,ot.byteSwap32)(this.IV),this.flags=r|Xt.DERIVE_KEY_MATERIAL}else this.IV=Kt.B2S_IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,ot.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(e,r,n,i=0){let{state:s,pos:o}=this,{h:c,l:u}=(0,eo.fromBig)(BigInt(e),!0),{v0:h,v1:y,v2:p,v3:S,v4:M,v5:A,v6:x,v7:I,v8:E,v9:C,v10:P,v11:T,v12:L,v13:N,v14:D,v15:R}=(0,Kt.compress)(to,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],Kt.B2S_IV[0],Kt.B2S_IV[1],Kt.B2S_IV[2],Kt.B2S_IV[3],c,u,o,r);s[0]=h^E,s[1]=y^C,s[2]=p^P,s[3]=S^T,s[4]=M^L,s[5]=A^N,s[6]=x^D,s[7]=I^R}compress(e,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=Xt.CHUNK_START),(this.chunkPos===15||n)&&(i|=Xt.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,e,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let o,c=this.chunksDone+1;(n||!(c&1))&&(o=this.stack.pop());c>>=1)this.buffer32.set(o,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|Xt.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(e){e=super._cloneInto(e);let{IV:r,flags:n,state:i,chunkPos:s,posOut:o,chunkOut:c,stack:u,chunksDone:h}=this;return e.state.set(i.slice()),e.stack=u.map(y=>Uint32Array.from(y)),e.IV.set(r),e.flags=n,e.chunkPos=s,e.chunksDone=h,e.posOut=o,e.chunkOut=c,e.enableXOF=this.enableXOF,e.bufferOut32.set(this.bufferOut32),e}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let e of this.stack)e.fill(0)}b2CompressOut(){let{state:e,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:o,l:c}=(0,eo.fromBig)(BigInt(this.chunkOut++));ot.isLE||(0,ot.byteSwap32)(i);let{v0:u,v1:h,v2:y,v3:p,v4:S,v5:M,v6:A,v7:x,v8:I,v9:E,v10:C,v11:P,v12:T,v13:L,v14:N,v15:D}=(0,Kt.compress)(to,0,i,7,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],Kt.B2S_IV[0],Kt.B2S_IV[1],Kt.B2S_IV[2],Kt.B2S_IV[3],c,o,r,n);s[0]=u^I,s[1]=h^E,s[2]=y^C,s[3]=p^P,s[4]=S^T,s[5]=M^L,s[6]=A^N,s[7]=x^D,s[8]=e[0]^I,s[9]=e[1]^E,s[10]=e[2]^C,s[11]=e[3]^P,s[12]=e[4]^T,s[13]=e[5]^L,s[14]=e[6]^N,s[15]=e[7]^D,ot.isLE||((0,ot.byteSwap32)(i),(0,ot.byteSwap32)(s)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let e=this.flags|Xt.ROOT;this.stack.length?(e|=Xt.PARENT,ot.isLE||(0,ot.byteSwap32)(this.buffer32),this.compress(this.buffer32,0,!0),ot.isLE||(0,ot.byteSwap32)(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):e|=(this.chunkPos?0:Xt.CHUNK_START)|Xt.CHUNK_END,this.flags=e,this.b2CompressOut()}writeInto(e){(0,Tn.aexists)(this,!1),(0,Tn.abytes)(e),this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.b2CompressOut();let o=Math.min(r-this.posOut,s-i);e.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(e)}xof(e){return(0,Tn.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,Tn.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};on.BLAKE3=fn;on.blake3=(0,ot.wrapXOFConstructorWithOpts)(t=>new fn(t))});var Ln=K(fe=>{k();q();var no=fe&&fe.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),pu=fe&&fe.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),It=fe&&fe.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&no(e,t,r)},vu=fe&&fe.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&no(e,t,r);return pu(e,t),e};Object.defineProperty(fe,"__esModule",{value:!0});fe.randomBytes=fe.concatBytes=fe.reverseBuffer=void 0;It(Xs(),fe);It(Ys(),fe);It(ci(),fe);It(Kf(),fe);It(ga(),fe);It(Wr(),fe);It(Cn(),fe);It(Ca(),fe);It(In(),fe);It(ai(),fe);It(La(),fe);It(Ra(),fe);It(bi(),fe);It(Qf(),fe);It(ro(),fe);var yu=vu(vt()),mu=V0();function gu(t){if(t.length<1)return t;let e=t.length-1,r=0;for(let n=0;n<t.length/2;n++)r=t[n],t[n]=t[e],t[e]=r,e--;return t}fe.reverseBuffer=gu;function wu(t,e){return yu.concatBytes(Uint8Array.from(t),Uint8Array.from(e))}fe.concatBytes=wu;function _u(t){return mu(t)}fe.randomBytes=_u});var Ot=K((io,Na)=>{k();q();(function(t,e){"use strict";function r(_,a){if(!_)throw new Error(a||"Assertion failed")}function n(_,a){_.super_=a;var d=function(){};d.prototype=a.prototype,_.prototype=new d,_.prototype.constructor=_}function i(_,a,d){if(i.isBN(_))return _;this.negative=0,this.words=null,this.length=0,this.red=null,_!==null&&((a==="le"||a==="be")&&(d=a,a=10),this._init(_||0,a||10,d||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=U0().Buffer}catch{}i.isBN=function(a){return a instanceof i?!0:a!==null&&typeof a=="object"&&a.constructor.wordSize===i.wordSize&&Array.isArray(a.words)},i.max=function(a,d){return a.cmp(d)>0?a:d},i.min=function(a,d){return a.cmp(d)<0?a:d},i.prototype._init=function(a,d,l){if(typeof a=="number")return this._initNumber(a,d,l);if(typeof a=="object")return this._initArray(a,d,l);d==="hex"&&(d=16),r(d===(d|0)&&d>=2&&d<=36),a=a.toString().replace(/\s+/g,"");var v=0;a[0]==="-"&&(v++,this.negative=1),v<a.length&&(d===16?this._parseHex(a,v,l):(this._parseBase(a,d,v),l==="le"&&this._initArray(this.toArray(),d,l)))},i.prototype._initNumber=function(a,d,l){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[a&67108863],this.length=1):a<4503599627370496?(this.words=[a&67108863,a/67108864&67108863],this.length=2):(r(a<9007199254740992),this.words=[a&67108863,a/67108864&67108863,1],this.length=3),l==="le"&&this._initArray(this.toArray(),d,l)},i.prototype._initArray=function(a,d,l){if(r(typeof a.length=="number"),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var b,w,B=0;if(l==="be")for(v=a.length-1,b=0;v>=0;v-=3)w=a[v]|a[v-1]<<8|a[v-2]<<16,this.words[b]|=w<<B&67108863,this.words[b+1]=w>>>26-B&67108863,B+=24,B>=26&&(B-=26,b++);else if(l==="le")for(v=0,b=0;v<a.length;v+=3)w=a[v]|a[v+1]<<8|a[v+2]<<16,this.words[b]|=w<<B&67108863,this.words[b+1]=w>>>26-B&67108863,B+=24,B>=26&&(B-=26,b++);return this.strip()};function o(_,a){var d=_.charCodeAt(a);return d>=65&&d<=70?d-55:d>=97&&d<=102?d-87:d-48&15}function c(_,a,d){var l=o(_,d);return d-1>=a&&(l|=o(_,d-1)<<4),l}i.prototype._parseHex=function(a,d,l){this.length=Math.ceil((a.length-d)/6),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var b=0,w=0,B;if(l==="be")for(v=a.length-1;v>=d;v-=2)B=c(a,d,v)<<b,this.words[w]|=B&67108863,b>=18?(b-=18,w+=1,this.words[w]|=B>>>26):b+=8;else{var m=a.length-d;for(v=m%2===0?d+1:d;v<a.length;v+=2)B=c(a,d,v)<<b,this.words[w]|=B&67108863,b>=18?(b-=18,w+=1,this.words[w]|=B>>>26):b+=8}this.strip()};function u(_,a,d,l){for(var v=0,b=Math.min(_.length,d),w=a;w<b;w++){var B=_.charCodeAt(w)-48;v*=l,B>=49?v+=B-49+10:B>=17?v+=B-17+10:v+=B}return v}i.prototype._parseBase=function(a,d,l){this.words=[0],this.length=1;for(var v=0,b=1;b<=67108863;b*=d)v++;v--,b=b/d|0;for(var w=a.length-l,B=w%v,m=Math.min(w,w-B)+l,f=0,g=l;g<m;g+=v)f=u(a,g,g+v,d),this.imuln(b),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(B!==0){var H=1;for(f=u(a,g,a.length,d),g=0;g<B;g++)H*=d;this.imuln(H),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},i.prototype.copy=function(a){a.words=new Array(this.length);for(var d=0;d<this.length;d++)a.words[d]=this.words[d];a.length=this.length,a.negative=this.negative,a.red=this.red},i.prototype.clone=function(){var a=new i(null);return this.copy(a),a},i.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],y=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(a,d){a=a||10,d=d|0||1;var l;if(a===16||a==="hex"){l="";for(var v=0,b=0,w=0;w<this.length;w++){var B=this.words[w],m=((B<<v|b)&16777215).toString(16);b=B>>>24-v&16777215,b!==0||w!==this.length-1?l=h[6-m.length]+m+l:l=m+l,v+=2,v>=26&&(v-=26,w--)}for(b!==0&&(l=b.toString(16)+l);l.length%d!==0;)l="0"+l;return this.negative!==0&&(l="-"+l),l}if(a===(a|0)&&a>=2&&a<=36){var f=y[a],g=p[a];l="";var H=this.clone();for(H.negative=0;!H.isZero();){var j=H.modn(g).toString(a);H=H.idivn(g),H.isZero()?l=j+l:l=h[f-j.length]+j+l}for(this.isZero()&&(l="0"+l);l.length%d!==0;)l="0"+l;return this.negative!==0&&(l="-"+l),l}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var a=this.words[0];return this.length===2?a+=this.words[1]*67108864:this.length===3&&this.words[2]===1?a+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-a:a},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(a,d){return r(typeof s<"u"),this.toArrayLike(s,a,d)},i.prototype.toArray=function(a,d){return this.toArrayLike(Array,a,d)},i.prototype.toArrayLike=function(a,d,l){var v=this.byteLength(),b=l||Math.max(1,v);r(v<=b,"byte array longer than desired length"),r(b>0,"Requested array length <= 0"),this.strip();var w=d==="le",B=new a(b),m,f,g=this.clone();if(w){for(f=0;!g.isZero();f++)m=g.andln(255),g.iushrn(8),B[f]=m;for(;f<b;f++)B[f]=0}else{for(f=0;f<b-v;f++)B[f]=0;for(f=0;!g.isZero();f++)m=g.andln(255),g.iushrn(8),B[b-f-1]=m}return B},Math.clz32?i.prototype._countBits=function(a){return 32-Math.clz32(a)}:i.prototype._countBits=function(a){var d=a,l=0;return d>=4096&&(l+=13,d>>>=13),d>=64&&(l+=7,d>>>=7),d>=8&&(l+=4,d>>>=4),d>=2&&(l+=2,d>>>=2),l+d},i.prototype._zeroBits=function(a){if(a===0)return 26;var d=a,l=0;return(d&8191)===0&&(l+=13,d>>>=13),(d&127)===0&&(l+=7,d>>>=7),(d&15)===0&&(l+=4,d>>>=4),(d&3)===0&&(l+=2,d>>>=2),(d&1)===0&&l++,l},i.prototype.bitLength=function(){var a=this.words[this.length-1],d=this._countBits(a);return(this.length-1)*26+d};function S(_){for(var a=new Array(_.bitLength()),d=0;d<a.length;d++){var l=d/26|0,v=d%26;a[d]=(_.words[l]&1<<v)>>>v}return a}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,d=0;d<this.length;d++){var l=this._zeroBits(this.words[d]);if(a+=l,l!==26)break}return a},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(a){return this.negative!==0?this.abs().inotn(a).iaddn(1):this.clone()},i.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var d=0;d<a.length;d++)this.words[d]=this.words[d]|a.words[d];return this.strip()},i.prototype.ior=function(a){return r((this.negative|a.negative)===0),this.iuor(a)},i.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},i.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},i.prototype.iuand=function(a){var d;this.length>a.length?d=a:d=this;for(var l=0;l<d.length;l++)this.words[l]=this.words[l]&a.words[l];return this.length=d.length,this.strip()},i.prototype.iand=function(a){return r((this.negative|a.negative)===0),this.iuand(a)},i.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},i.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},i.prototype.iuxor=function(a){var d,l;this.length>a.length?(d=this,l=a):(d=a,l=this);for(var v=0;v<l.length;v++)this.words[v]=d.words[v]^l.words[v];if(this!==d)for(;v<d.length;v++)this.words[v]=d.words[v];return this.length=d.length,this.strip()},i.prototype.ixor=function(a){return r((this.negative|a.negative)===0),this.iuxor(a)},i.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},i.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},i.prototype.inotn=function(a){r(typeof a=="number"&&a>=0);var d=Math.ceil(a/26)|0,l=a%26;this._expand(d),l>0&&d--;for(var v=0;v<d;v++)this.words[v]=~this.words[v]&67108863;return l>0&&(this.words[v]=~this.words[v]&67108863>>26-l),this.strip()},i.prototype.notn=function(a){return this.clone().inotn(a)},i.prototype.setn=function(a,d){r(typeof a=="number"&&a>=0);var l=a/26|0,v=a%26;return this._expand(l+1),d?this.words[l]=this.words[l]|1<<v:this.words[l]=this.words[l]&~(1<<v),this.strip()},i.prototype.iadd=function(a){var d;if(this.negative!==0&&a.negative===0)return this.negative=0,d=this.isub(a),this.negative^=1,this._normSign();if(this.negative===0&&a.negative!==0)return a.negative=0,d=this.isub(a),a.negative=1,d._normSign();var l,v;this.length>a.length?(l=this,v=a):(l=a,v=this);for(var b=0,w=0;w<v.length;w++)d=(l.words[w]|0)+(v.words[w]|0)+b,this.words[w]=d&67108863,b=d>>>26;for(;b!==0&&w<l.length;w++)d=(l.words[w]|0)+b,this.words[w]=d&67108863,b=d>>>26;if(this.length=l.length,b!==0)this.words[this.length]=b,this.length++;else if(l!==this)for(;w<l.length;w++)this.words[w]=l.words[w];return this},i.prototype.add=function(a){var d;return a.negative!==0&&this.negative===0?(a.negative=0,d=this.sub(a),a.negative^=1,d):a.negative===0&&this.negative!==0?(this.negative=0,d=a.sub(this),this.negative=1,d):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},i.prototype.isub=function(a){if(a.negative!==0){a.negative=0;var d=this.iadd(a);return a.negative=1,d._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var l=this.cmp(a);if(l===0)return this.negative=0,this.length=1,this.words[0]=0,this;var v,b;l>0?(v=this,b=a):(v=a,b=this);for(var w=0,B=0;B<b.length;B++)d=(v.words[B]|0)-(b.words[B]|0)+w,w=d>>26,this.words[B]=d&67108863;for(;w!==0&&B<v.length;B++)d=(v.words[B]|0)+w,w=d>>26,this.words[B]=d&67108863;if(w===0&&B<v.length&&v!==this)for(;B<v.length;B++)this.words[B]=v.words[B];return this.length=Math.max(this.length,B),v!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(a){return this.clone().isub(a)};function M(_,a,d){d.negative=a.negative^_.negative;var l=_.length+a.length|0;d.length=l,l=l-1|0;var v=_.words[0]|0,b=a.words[0]|0,w=v*b,B=w&67108863,m=w/67108864|0;d.words[0]=B;for(var f=1;f<l;f++){for(var g=m>>>26,H=m&67108863,j=Math.min(f,a.length-1),V=Math.max(0,f-_.length+1);V<=j;V++){var Z=f-V|0;v=_.words[Z]|0,b=a.words[V]|0,w=v*b+H,g+=w/67108864|0,H=w&67108863}d.words[f]=H|0,m=g|0}return m!==0?d.words[f]=m|0:d.length--,d.strip()}var A=function(a,d,l){var v=a.words,b=d.words,w=l.words,B=0,m,f,g,H=v[0]|0,j=H&8191,V=H>>>13,Z=v[1]|0,J=Z&8191,ne=Z>>>13,pt=v[2]|0,oe=pt&8191,ie=pt>>>13,tr=v[3]|0,ge=tr&8191,ae=tr>>>13,rr=v[4]|0,be=rr&8191,we=rr>>>13,Bn=v[5]|0,Be=Bn&8191,Ae=Bn>>>13,Cs=v[6]|0,Ee=Cs&8191,Ie=Cs>>>13,Ts=v[7]|0,Pe=Ts&8191,ke=Ts>>>13,Ls=v[8]|0,qe=Ls&8191,Oe=Ls>>>13,Rs=v[9]|0,Ce=Rs&8191,Te=Rs>>>13,Ns=b[0]|0,Le=Ns&8191,Re=Ns>>>13,Hs=b[1]|0,Ne=Hs&8191,He=Hs>>>13,js=b[2]|0,je=js&8191,De=js>>>13,Ds=b[3]|0,Ue=Ds&8191,ze=Ds>>>13,Us=b[4]|0,Ke=Us&8191,Ve=Us>>>13,zs=b[5]|0,Fe=zs&8191,Ze=zs>>>13,Ks=b[6]|0,$e=Ks&8191,We=Ks>>>13,Vs=b[7]|0,Xe=Vs&8191,Ge=Vs>>>13,Fs=b[8]|0,Ye=Fs&8191,Je=Fs>>>13,Zs=b[9]|0,Qe=Zs&8191,et=Zs>>>13;l.negative=a.negative^d.negative,l.length=19,m=Math.imul(j,Le),f=Math.imul(j,Re),f=f+Math.imul(V,Le)|0,g=Math.imul(V,Re);var Qi=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,m=Math.imul(J,Le),f=Math.imul(J,Re),f=f+Math.imul(ne,Le)|0,g=Math.imul(ne,Re),m=m+Math.imul(j,Ne)|0,f=f+Math.imul(j,He)|0,f=f+Math.imul(V,Ne)|0,g=g+Math.imul(V,He)|0;var ea=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ea>>>26)|0,ea&=67108863,m=Math.imul(oe,Le),f=Math.imul(oe,Re),f=f+Math.imul(ie,Le)|0,g=Math.imul(ie,Re),m=m+Math.imul(J,Ne)|0,f=f+Math.imul(J,He)|0,f=f+Math.imul(ne,Ne)|0,g=g+Math.imul(ne,He)|0,m=m+Math.imul(j,je)|0,f=f+Math.imul(j,De)|0,f=f+Math.imul(V,je)|0,g=g+Math.imul(V,De)|0;var ta=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ta>>>26)|0,ta&=67108863,m=Math.imul(ge,Le),f=Math.imul(ge,Re),f=f+Math.imul(ae,Le)|0,g=Math.imul(ae,Re),m=m+Math.imul(oe,Ne)|0,f=f+Math.imul(oe,He)|0,f=f+Math.imul(ie,Ne)|0,g=g+Math.imul(ie,He)|0,m=m+Math.imul(J,je)|0,f=f+Math.imul(J,De)|0,f=f+Math.imul(ne,je)|0,g=g+Math.imul(ne,De)|0,m=m+Math.imul(j,Ue)|0,f=f+Math.imul(j,ze)|0,f=f+Math.imul(V,Ue)|0,g=g+Math.imul(V,ze)|0;var ra=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ra>>>26)|0,ra&=67108863,m=Math.imul(be,Le),f=Math.imul(be,Re),f=f+Math.imul(we,Le)|0,g=Math.imul(we,Re),m=m+Math.imul(ge,Ne)|0,f=f+Math.imul(ge,He)|0,f=f+Math.imul(ae,Ne)|0,g=g+Math.imul(ae,He)|0,m=m+Math.imul(oe,je)|0,f=f+Math.imul(oe,De)|0,f=f+Math.imul(ie,je)|0,g=g+Math.imul(ie,De)|0,m=m+Math.imul(J,Ue)|0,f=f+Math.imul(J,ze)|0,f=f+Math.imul(ne,Ue)|0,g=g+Math.imul(ne,ze)|0,m=m+Math.imul(j,Ke)|0,f=f+Math.imul(j,Ve)|0,f=f+Math.imul(V,Ke)|0,g=g+Math.imul(V,Ve)|0;var na=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(na>>>26)|0,na&=67108863,m=Math.imul(Be,Le),f=Math.imul(Be,Re),f=f+Math.imul(Ae,Le)|0,g=Math.imul(Ae,Re),m=m+Math.imul(be,Ne)|0,f=f+Math.imul(be,He)|0,f=f+Math.imul(we,Ne)|0,g=g+Math.imul(we,He)|0,m=m+Math.imul(ge,je)|0,f=f+Math.imul(ge,De)|0,f=f+Math.imul(ae,je)|0,g=g+Math.imul(ae,De)|0,m=m+Math.imul(oe,Ue)|0,f=f+Math.imul(oe,ze)|0,f=f+Math.imul(ie,Ue)|0,g=g+Math.imul(ie,ze)|0,m=m+Math.imul(J,Ke)|0,f=f+Math.imul(J,Ve)|0,f=f+Math.imul(ne,Ke)|0,g=g+Math.imul(ne,Ve)|0,m=m+Math.imul(j,Fe)|0,f=f+Math.imul(j,Ze)|0,f=f+Math.imul(V,Fe)|0,g=g+Math.imul(V,Ze)|0;var ia=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ia>>>26)|0,ia&=67108863,m=Math.imul(Ee,Le),f=Math.imul(Ee,Re),f=f+Math.imul(Ie,Le)|0,g=Math.imul(Ie,Re),m=m+Math.imul(Be,Ne)|0,f=f+Math.imul(Be,He)|0,f=f+Math.imul(Ae,Ne)|0,g=g+Math.imul(Ae,He)|0,m=m+Math.imul(be,je)|0,f=f+Math.imul(be,De)|0,f=f+Math.imul(we,je)|0,g=g+Math.imul(we,De)|0,m=m+Math.imul(ge,Ue)|0,f=f+Math.imul(ge,ze)|0,f=f+Math.imul(ae,Ue)|0,g=g+Math.imul(ae,ze)|0,m=m+Math.imul(oe,Ke)|0,f=f+Math.imul(oe,Ve)|0,f=f+Math.imul(ie,Ke)|0,g=g+Math.imul(ie,Ve)|0,m=m+Math.imul(J,Fe)|0,f=f+Math.imul(J,Ze)|0,f=f+Math.imul(ne,Fe)|0,g=g+Math.imul(ne,Ze)|0,m=m+Math.imul(j,$e)|0,f=f+Math.imul(j,We)|0,f=f+Math.imul(V,$e)|0,g=g+Math.imul(V,We)|0;var aa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(aa>>>26)|0,aa&=67108863,m=Math.imul(Pe,Le),f=Math.imul(Pe,Re),f=f+Math.imul(ke,Le)|0,g=Math.imul(ke,Re),m=m+Math.imul(Ee,Ne)|0,f=f+Math.imul(Ee,He)|0,f=f+Math.imul(Ie,Ne)|0,g=g+Math.imul(Ie,He)|0,m=m+Math.imul(Be,je)|0,f=f+Math.imul(Be,De)|0,f=f+Math.imul(Ae,je)|0,g=g+Math.imul(Ae,De)|0,m=m+Math.imul(be,Ue)|0,f=f+Math.imul(be,ze)|0,f=f+Math.imul(we,Ue)|0,g=g+Math.imul(we,ze)|0,m=m+Math.imul(ge,Ke)|0,f=f+Math.imul(ge,Ve)|0,f=f+Math.imul(ae,Ke)|0,g=g+Math.imul(ae,Ve)|0,m=m+Math.imul(oe,Fe)|0,f=f+Math.imul(oe,Ze)|0,f=f+Math.imul(ie,Fe)|0,g=g+Math.imul(ie,Ze)|0,m=m+Math.imul(J,$e)|0,f=f+Math.imul(J,We)|0,f=f+Math.imul(ne,$e)|0,g=g+Math.imul(ne,We)|0,m=m+Math.imul(j,Xe)|0,f=f+Math.imul(j,Ge)|0,f=f+Math.imul(V,Xe)|0,g=g+Math.imul(V,Ge)|0;var sa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(sa>>>26)|0,sa&=67108863,m=Math.imul(qe,Le),f=Math.imul(qe,Re),f=f+Math.imul(Oe,Le)|0,g=Math.imul(Oe,Re),m=m+Math.imul(Pe,Ne)|0,f=f+Math.imul(Pe,He)|0,f=f+Math.imul(ke,Ne)|0,g=g+Math.imul(ke,He)|0,m=m+Math.imul(Ee,je)|0,f=f+Math.imul(Ee,De)|0,f=f+Math.imul(Ie,je)|0,g=g+Math.imul(Ie,De)|0,m=m+Math.imul(Be,Ue)|0,f=f+Math.imul(Be,ze)|0,f=f+Math.imul(Ae,Ue)|0,g=g+Math.imul(Ae,ze)|0,m=m+Math.imul(be,Ke)|0,f=f+Math.imul(be,Ve)|0,f=f+Math.imul(we,Ke)|0,g=g+Math.imul(we,Ve)|0,m=m+Math.imul(ge,Fe)|0,f=f+Math.imul(ge,Ze)|0,f=f+Math.imul(ae,Fe)|0,g=g+Math.imul(ae,Ze)|0,m=m+Math.imul(oe,$e)|0,f=f+Math.imul(oe,We)|0,f=f+Math.imul(ie,$e)|0,g=g+Math.imul(ie,We)|0,m=m+Math.imul(J,Xe)|0,f=f+Math.imul(J,Ge)|0,f=f+Math.imul(ne,Xe)|0,g=g+Math.imul(ne,Ge)|0,m=m+Math.imul(j,Ye)|0,f=f+Math.imul(j,Je)|0,f=f+Math.imul(V,Ye)|0,g=g+Math.imul(V,Je)|0;var fa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(fa>>>26)|0,fa&=67108863,m=Math.imul(Ce,Le),f=Math.imul(Ce,Re),f=f+Math.imul(Te,Le)|0,g=Math.imul(Te,Re),m=m+Math.imul(qe,Ne)|0,f=f+Math.imul(qe,He)|0,f=f+Math.imul(Oe,Ne)|0,g=g+Math.imul(Oe,He)|0,m=m+Math.imul(Pe,je)|0,f=f+Math.imul(Pe,De)|0,f=f+Math.imul(ke,je)|0,g=g+Math.imul(ke,De)|0,m=m+Math.imul(Ee,Ue)|0,f=f+Math.imul(Ee,ze)|0,f=f+Math.imul(Ie,Ue)|0,g=g+Math.imul(Ie,ze)|0,m=m+Math.imul(Be,Ke)|0,f=f+Math.imul(Be,Ve)|0,f=f+Math.imul(Ae,Ke)|0,g=g+Math.imul(Ae,Ve)|0,m=m+Math.imul(be,Fe)|0,f=f+Math.imul(be,Ze)|0,f=f+Math.imul(we,Fe)|0,g=g+Math.imul(we,Ze)|0,m=m+Math.imul(ge,$e)|0,f=f+Math.imul(ge,We)|0,f=f+Math.imul(ae,$e)|0,g=g+Math.imul(ae,We)|0,m=m+Math.imul(oe,Xe)|0,f=f+Math.imul(oe,Ge)|0,f=f+Math.imul(ie,Xe)|0,g=g+Math.imul(ie,Ge)|0,m=m+Math.imul(J,Ye)|0,f=f+Math.imul(J,Je)|0,f=f+Math.imul(ne,Ye)|0,g=g+Math.imul(ne,Je)|0,m=m+Math.imul(j,Qe)|0,f=f+Math.imul(j,et)|0,f=f+Math.imul(V,Qe)|0,g=g+Math.imul(V,et)|0;var oa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(oa>>>26)|0,oa&=67108863,m=Math.imul(Ce,Ne),f=Math.imul(Ce,He),f=f+Math.imul(Te,Ne)|0,g=Math.imul(Te,He),m=m+Math.imul(qe,je)|0,f=f+Math.imul(qe,De)|0,f=f+Math.imul(Oe,je)|0,g=g+Math.imul(Oe,De)|0,m=m+Math.imul(Pe,Ue)|0,f=f+Math.imul(Pe,ze)|0,f=f+Math.imul(ke,Ue)|0,g=g+Math.imul(ke,ze)|0,m=m+Math.imul(Ee,Ke)|0,f=f+Math.imul(Ee,Ve)|0,f=f+Math.imul(Ie,Ke)|0,g=g+Math.imul(Ie,Ve)|0,m=m+Math.imul(Be,Fe)|0,f=f+Math.imul(Be,Ze)|0,f=f+Math.imul(Ae,Fe)|0,g=g+Math.imul(Ae,Ze)|0,m=m+Math.imul(be,$e)|0,f=f+Math.imul(be,We)|0,f=f+Math.imul(we,$e)|0,g=g+Math.imul(we,We)|0,m=m+Math.imul(ge,Xe)|0,f=f+Math.imul(ge,Ge)|0,f=f+Math.imul(ae,Xe)|0,g=g+Math.imul(ae,Ge)|0,m=m+Math.imul(oe,Ye)|0,f=f+Math.imul(oe,Je)|0,f=f+Math.imul(ie,Ye)|0,g=g+Math.imul(ie,Je)|0,m=m+Math.imul(J,Qe)|0,f=f+Math.imul(J,et)|0,f=f+Math.imul(ne,Qe)|0,g=g+Math.imul(ne,et)|0;var ca=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ca>>>26)|0,ca&=67108863,m=Math.imul(Ce,je),f=Math.imul(Ce,De),f=f+Math.imul(Te,je)|0,g=Math.imul(Te,De),m=m+Math.imul(qe,Ue)|0,f=f+Math.imul(qe,ze)|0,f=f+Math.imul(Oe,Ue)|0,g=g+Math.imul(Oe,ze)|0,m=m+Math.imul(Pe,Ke)|0,f=f+Math.imul(Pe,Ve)|0,f=f+Math.imul(ke,Ke)|0,g=g+Math.imul(ke,Ve)|0,m=m+Math.imul(Ee,Fe)|0,f=f+Math.imul(Ee,Ze)|0,f=f+Math.imul(Ie,Fe)|0,g=g+Math.imul(Ie,Ze)|0,m=m+Math.imul(Be,$e)|0,f=f+Math.imul(Be,We)|0,f=f+Math.imul(Ae,$e)|0,g=g+Math.imul(Ae,We)|0,m=m+Math.imul(be,Xe)|0,f=f+Math.imul(be,Ge)|0,f=f+Math.imul(we,Xe)|0,g=g+Math.imul(we,Ge)|0,m=m+Math.imul(ge,Ye)|0,f=f+Math.imul(ge,Je)|0,f=f+Math.imul(ae,Ye)|0,g=g+Math.imul(ae,Je)|0,m=m+Math.imul(oe,Qe)|0,f=f+Math.imul(oe,et)|0,f=f+Math.imul(ie,Qe)|0,g=g+Math.imul(ie,et)|0;var da=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(da>>>26)|0,da&=67108863,m=Math.imul(Ce,Ue),f=Math.imul(Ce,ze),f=f+Math.imul(Te,Ue)|0,g=Math.imul(Te,ze),m=m+Math.imul(qe,Ke)|0,f=f+Math.imul(qe,Ve)|0,f=f+Math.imul(Oe,Ke)|0,g=g+Math.imul(Oe,Ve)|0,m=m+Math.imul(Pe,Fe)|0,f=f+Math.imul(Pe,Ze)|0,f=f+Math.imul(ke,Fe)|0,g=g+Math.imul(ke,Ze)|0,m=m+Math.imul(Ee,$e)|0,f=f+Math.imul(Ee,We)|0,f=f+Math.imul(Ie,$e)|0,g=g+Math.imul(Ie,We)|0,m=m+Math.imul(Be,Xe)|0,f=f+Math.imul(Be,Ge)|0,f=f+Math.imul(Ae,Xe)|0,g=g+Math.imul(Ae,Ge)|0,m=m+Math.imul(be,Ye)|0,f=f+Math.imul(be,Je)|0,f=f+Math.imul(we,Ye)|0,g=g+Math.imul(we,Je)|0,m=m+Math.imul(ge,Qe)|0,f=f+Math.imul(ge,et)|0,f=f+Math.imul(ae,Qe)|0,g=g+Math.imul(ae,et)|0;var ua=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ua>>>26)|0,ua&=67108863,m=Math.imul(Ce,Ke),f=Math.imul(Ce,Ve),f=f+Math.imul(Te,Ke)|0,g=Math.imul(Te,Ve),m=m+Math.imul(qe,Fe)|0,f=f+Math.imul(qe,Ze)|0,f=f+Math.imul(Oe,Fe)|0,g=g+Math.imul(Oe,Ze)|0,m=m+Math.imul(Pe,$e)|0,f=f+Math.imul(Pe,We)|0,f=f+Math.imul(ke,$e)|0,g=g+Math.imul(ke,We)|0,m=m+Math.imul(Ee,Xe)|0,f=f+Math.imul(Ee,Ge)|0,f=f+Math.imul(Ie,Xe)|0,g=g+Math.imul(Ie,Ge)|0,m=m+Math.imul(Be,Ye)|0,f=f+Math.imul(Be,Je)|0,f=f+Math.imul(Ae,Ye)|0,g=g+Math.imul(Ae,Je)|0,m=m+Math.imul(be,Qe)|0,f=f+Math.imul(be,et)|0,f=f+Math.imul(we,Qe)|0,g=g+Math.imul(we,et)|0;var la=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(la>>>26)|0,la&=67108863,m=Math.imul(Ce,Fe),f=Math.imul(Ce,Ze),f=f+Math.imul(Te,Fe)|0,g=Math.imul(Te,Ze),m=m+Math.imul(qe,$e)|0,f=f+Math.imul(qe,We)|0,f=f+Math.imul(Oe,$e)|0,g=g+Math.imul(Oe,We)|0,m=m+Math.imul(Pe,Xe)|0,f=f+Math.imul(Pe,Ge)|0,f=f+Math.imul(ke,Xe)|0,g=g+Math.imul(ke,Ge)|0,m=m+Math.imul(Ee,Ye)|0,f=f+Math.imul(Ee,Je)|0,f=f+Math.imul(Ie,Ye)|0,g=g+Math.imul(Ie,Je)|0,m=m+Math.imul(Be,Qe)|0,f=f+Math.imul(Be,et)|0,f=f+Math.imul(Ae,Qe)|0,g=g+Math.imul(Ae,et)|0;var ha=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ha>>>26)|0,ha&=67108863,m=Math.imul(Ce,$e),f=Math.imul(Ce,We),f=f+Math.imul(Te,$e)|0,g=Math.imul(Te,We),m=m+Math.imul(qe,Xe)|0,f=f+Math.imul(qe,Ge)|0,f=f+Math.imul(Oe,Xe)|0,g=g+Math.imul(Oe,Ge)|0,m=m+Math.imul(Pe,Ye)|0,f=f+Math.imul(Pe,Je)|0,f=f+Math.imul(ke,Ye)|0,g=g+Math.imul(ke,Je)|0,m=m+Math.imul(Ee,Qe)|0,f=f+Math.imul(Ee,et)|0,f=f+Math.imul(Ie,Qe)|0,g=g+Math.imul(Ie,et)|0;var ba=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ba>>>26)|0,ba&=67108863,m=Math.imul(Ce,Xe),f=Math.imul(Ce,Ge),f=f+Math.imul(Te,Xe)|0,g=Math.imul(Te,Ge),m=m+Math.imul(qe,Ye)|0,f=f+Math.imul(qe,Je)|0,f=f+Math.imul(Oe,Ye)|0,g=g+Math.imul(Oe,Je)|0,m=m+Math.imul(Pe,Qe)|0,f=f+Math.imul(Pe,et)|0,f=f+Math.imul(ke,Qe)|0,g=g+Math.imul(ke,et)|0;var pa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(pa>>>26)|0,pa&=67108863,m=Math.imul(Ce,Ye),f=Math.imul(Ce,Je),f=f+Math.imul(Te,Ye)|0,g=Math.imul(Te,Je),m=m+Math.imul(qe,Qe)|0,f=f+Math.imul(qe,et)|0,f=f+Math.imul(Oe,Qe)|0,g=g+Math.imul(Oe,et)|0;var va=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(va>>>26)|0,va&=67108863,m=Math.imul(Ce,Qe),f=Math.imul(Ce,et),f=f+Math.imul(Te,Qe)|0,g=Math.imul(Te,et);var ya=(B+m|0)+((f&8191)<<13)|0;return B=(g+(f>>>13)|0)+(ya>>>26)|0,ya&=67108863,w[0]=Qi,w[1]=ea,w[2]=ta,w[3]=ra,w[4]=na,w[5]=ia,w[6]=aa,w[7]=sa,w[8]=fa,w[9]=oa,w[10]=ca,w[11]=da,w[12]=ua,w[13]=la,w[14]=ha,w[15]=ba,w[16]=pa,w[17]=va,w[18]=ya,B!==0&&(w[19]=B,l.length++),l};Math.imul||(A=M);function x(_,a,d){d.negative=a.negative^_.negative,d.length=_.length+a.length;for(var l=0,v=0,b=0;b<d.length-1;b++){var w=v;v=0;for(var B=l&67108863,m=Math.min(b,a.length-1),f=Math.max(0,b-_.length+1);f<=m;f++){var g=b-f,H=_.words[g]|0,j=a.words[f]|0,V=H*j,Z=V&67108863;w=w+(V/67108864|0)|0,Z=Z+B|0,B=Z&67108863,w=w+(Z>>>26)|0,v+=w>>>26,w&=67108863}d.words[b]=B,l=w,w=v}return l!==0?d.words[b]=l:d.length--,d.strip()}function I(_,a,d){var l=new E;return l.mulp(_,a,d)}i.prototype.mulTo=function(a,d){var l,v=this.length+a.length;return this.length===10&&a.length===10?l=A(this,a,d):v<63?l=M(this,a,d):v<1024?l=x(this,a,d):l=I(this,a,d),l};function E(_,a){this.x=_,this.y=a}E.prototype.makeRBT=function(a){for(var d=new Array(a),l=i.prototype._countBits(a)-1,v=0;v<a;v++)d[v]=this.revBin(v,l,a);return d},E.prototype.revBin=function(a,d,l){if(a===0||a===l-1)return a;for(var v=0,b=0;b<d;b++)v|=(a&1)<<d-b-1,a>>=1;return v},E.prototype.permute=function(a,d,l,v,b,w){for(var B=0;B<w;B++)v[B]=d[a[B]],b[B]=l[a[B]]},E.prototype.transform=function(a,d,l,v,b,w){this.permute(w,a,d,l,v,b);for(var B=1;B<b;B<<=1)for(var m=B<<1,f=Math.cos(2*Math.PI/m),g=Math.sin(2*Math.PI/m),H=0;H<b;H+=m)for(var j=f,V=g,Z=0;Z<B;Z++){var J=l[H+Z],ne=v[H+Z],pt=l[H+Z+B],oe=v[H+Z+B],ie=j*pt-V*oe;oe=j*oe+V*pt,pt=ie,l[H+Z]=J+pt,v[H+Z]=ne+oe,l[H+Z+B]=J-pt,v[H+Z+B]=ne-oe,Z!==m&&(ie=f*j-g*V,V=f*V+g*j,j=ie)}},E.prototype.guessLen13b=function(a,d){var l=Math.max(d,a)|1,v=l&1,b=0;for(l=l/2|0;l;l=l>>>1)b++;return 1<<b+1+v},E.prototype.conjugate=function(a,d,l){if(!(l<=1))for(var v=0;v<l/2;v++){var b=a[v];a[v]=a[l-v-1],a[l-v-1]=b,b=d[v],d[v]=-d[l-v-1],d[l-v-1]=-b}},E.prototype.normalize13b=function(a,d){for(var l=0,v=0;v<d/2;v++){var b=Math.round(a[2*v+1]/d)*8192+Math.round(a[2*v]/d)+l;a[v]=b&67108863,b<67108864?l=0:l=b/67108864|0}return a},E.prototype.convert13b=function(a,d,l,v){for(var b=0,w=0;w<d;w++)b=b+(a[w]|0),l[2*w]=b&8191,b=b>>>13,l[2*w+1]=b&8191,b=b>>>13;for(w=2*d;w<v;++w)l[w]=0;r(b===0),r((b&-8192)===0)},E.prototype.stub=function(a){for(var d=new Array(a),l=0;l<a;l++)d[l]=0;return d},E.prototype.mulp=function(a,d,l){var v=2*this.guessLen13b(a.length,d.length),b=this.makeRBT(v),w=this.stub(v),B=new Array(v),m=new Array(v),f=new Array(v),g=new Array(v),H=new Array(v),j=new Array(v),V=l.words;V.length=v,this.convert13b(a.words,a.length,B,v),this.convert13b(d.words,d.length,g,v),this.transform(B,w,m,f,v,b),this.transform(g,w,H,j,v,b);for(var Z=0;Z<v;Z++){var J=m[Z]*H[Z]-f[Z]*j[Z];f[Z]=m[Z]*j[Z]+f[Z]*H[Z],m[Z]=J}return this.conjugate(m,f,v),this.transform(m,f,V,w,v,b),this.conjugate(V,w,v),this.normalize13b(V,v),l.negative=a.negative^d.negative,l.length=a.length+d.length,l.strip()},i.prototype.mul=function(a){var d=new i(null);return d.words=new Array(this.length+a.length),this.mulTo(a,d)},i.prototype.mulf=function(a){var d=new i(null);return d.words=new Array(this.length+a.length),I(this,a,d)},i.prototype.imul=function(a){return this.clone().mulTo(a,this)},i.prototype.imuln=function(a){r(typeof a=="number"),r(a<67108864);for(var d=0,l=0;l<this.length;l++){var v=(this.words[l]|0)*a,b=(v&67108863)+(d&67108863);d>>=26,d+=v/67108864|0,d+=b>>>26,this.words[l]=b&67108863}return d!==0&&(this.words[l]=d,this.length++),this},i.prototype.muln=function(a){return this.clone().imuln(a)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(a){var d=S(a);if(d.length===0)return new i(1);for(var l=this,v=0;v<d.length&&d[v]===0;v++,l=l.sqr());if(++v<d.length)for(var b=l.sqr();v<d.length;v++,b=b.sqr())d[v]!==0&&(l=l.mul(b));return l},i.prototype.iushln=function(a){r(typeof a=="number"&&a>=0);var d=a%26,l=(a-d)/26,v=67108863>>>26-d<<26-d,b;if(d!==0){var w=0;for(b=0;b<this.length;b++){var B=this.words[b]&v,m=(this.words[b]|0)-B<<d;this.words[b]=m|w,w=B>>>26-d}w&&(this.words[b]=w,this.length++)}if(l!==0){for(b=this.length-1;b>=0;b--)this.words[b+l]=this.words[b];for(b=0;b<l;b++)this.words[b]=0;this.length+=l}return this.strip()},i.prototype.ishln=function(a){return r(this.negative===0),this.iushln(a)},i.prototype.iushrn=function(a,d,l){r(typeof a=="number"&&a>=0);var v;d?v=(d-d%26)/26:v=0;var b=a%26,w=Math.min((a-b)/26,this.length),B=67108863^67108863>>>b<<b,m=l;if(v-=w,v=Math.max(0,v),m){for(var f=0;f<w;f++)m.words[f]=this.words[f];m.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var g=0;for(f=this.length-1;f>=0&&(g!==0||f>=v);f--){var H=this.words[f]|0;this.words[f]=g<<26-b|H>>>b,g=H&B}return m&&g!==0&&(m.words[m.length++]=g),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(a,d,l){return r(this.negative===0),this.iushrn(a,d,l)},i.prototype.shln=function(a){return this.clone().ishln(a)},i.prototype.ushln=function(a){return this.clone().iushln(a)},i.prototype.shrn=function(a){return this.clone().ishrn(a)},i.prototype.ushrn=function(a){return this.clone().iushrn(a)},i.prototype.testn=function(a){r(typeof a=="number"&&a>=0);var d=a%26,l=(a-d)/26,v=1<<d;if(this.length<=l)return!1;var b=this.words[l];return!!(b&v)},i.prototype.imaskn=function(a){r(typeof a=="number"&&a>=0);var d=a%26,l=(a-d)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=l)return this;if(d!==0&&l++,this.length=Math.min(l,this.length),d!==0){var v=67108863^67108863>>>d<<d;this.words[this.length-1]&=v}return this.strip()},i.prototype.maskn=function(a){return this.clone().imaskn(a)},i.prototype.iaddn=function(a){return r(typeof a=="number"),r(a<67108864),a<0?this.isubn(-a):this.negative!==0?this.length===1&&(this.words[0]|0)<a?(this.words[0]=a-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},i.prototype._iaddn=function(a){this.words[0]+=a;for(var d=0;d<this.length&&this.words[d]>=67108864;d++)this.words[d]-=67108864,d===this.length-1?this.words[d+1]=1:this.words[d+1]++;return this.length=Math.max(this.length,d+1),this},i.prototype.isubn=function(a){if(r(typeof a=="number"),r(a<67108864),a<0)return this.iaddn(-a);if(this.negative!==0)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var d=0;d<this.length&&this.words[d]<0;d++)this.words[d]+=67108864,this.words[d+1]-=1;return this.strip()},i.prototype.addn=function(a){return this.clone().iaddn(a)},i.prototype.subn=function(a){return this.clone().isubn(a)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(a,d,l){var v=a.length+l,b;this._expand(v);var w,B=0;for(b=0;b<a.length;b++){w=(this.words[b+l]|0)+B;var m=(a.words[b]|0)*d;w-=m&67108863,B=(w>>26)-(m/67108864|0),this.words[b+l]=w&67108863}for(;b<this.length-l;b++)w=(this.words[b+l]|0)+B,B=w>>26,this.words[b+l]=w&67108863;if(B===0)return this.strip();for(r(B===-1),B=0,b=0;b<this.length;b++)w=-(this.words[b]|0)+B,B=w>>26,this.words[b]=w&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(a,d){var l=this.length-a.length,v=this.clone(),b=a,w=b.words[b.length-1]|0,B=this._countBits(w);l=26-B,l!==0&&(b=b.ushln(l),v.iushln(l),w=b.words[b.length-1]|0);var m=v.length-b.length,f;if(d!=="mod"){f=new i(null),f.length=m+1,f.words=new Array(f.length);for(var g=0;g<f.length;g++)f.words[g]=0}var H=v.clone()._ishlnsubmul(b,1,m);H.negative===0&&(v=H,f&&(f.words[m]=1));for(var j=m-1;j>=0;j--){var V=(v.words[b.length+j]|0)*67108864+(v.words[b.length+j-1]|0);for(V=Math.min(V/w|0,67108863),v._ishlnsubmul(b,V,j);v.negative!==0;)V--,v.negative=0,v._ishlnsubmul(b,1,j),v.isZero()||(v.negative^=1);f&&(f.words[j]=V)}return f&&f.strip(),v.strip(),d!=="div"&&l!==0&&v.iushrn(l),{div:f||null,mod:v}},i.prototype.divmod=function(a,d,l){if(r(!a.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var v,b,w;return this.negative!==0&&a.negative===0?(w=this.neg().divmod(a,d),d!=="mod"&&(v=w.div.neg()),d!=="div"&&(b=w.mod.neg(),l&&b.negative!==0&&b.iadd(a)),{div:v,mod:b}):this.negative===0&&a.negative!==0?(w=this.divmod(a.neg(),d),d!=="mod"&&(v=w.div.neg()),{div:v,mod:w.mod}):(this.negative&a.negative)!==0?(w=this.neg().divmod(a.neg(),d),d!=="div"&&(b=w.mod.neg(),l&&b.negative!==0&&b.isub(a)),{div:w.div,mod:b}):a.length>this.length||this.cmp(a)<0?{div:new i(0),mod:this}:a.length===1?d==="div"?{div:this.divn(a.words[0]),mod:null}:d==="mod"?{div:null,mod:new i(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new i(this.modn(a.words[0]))}:this._wordDiv(a,d)},i.prototype.div=function(a){return this.divmod(a,"div",!1).div},i.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},i.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},i.prototype.divRound=function(a){var d=this.divmod(a);if(d.mod.isZero())return d.div;var l=d.div.negative!==0?d.mod.isub(a):d.mod,v=a.ushrn(1),b=a.andln(1),w=l.cmp(v);return w<0||b===1&&w===0?d.div:d.div.negative!==0?d.div.isubn(1):d.div.iaddn(1)},i.prototype.modn=function(a){r(a<=67108863);for(var d=(1<<26)%a,l=0,v=this.length-1;v>=0;v--)l=(d*l+(this.words[v]|0))%a;return l},i.prototype.idivn=function(a){r(a<=67108863);for(var d=0,l=this.length-1;l>=0;l--){var v=(this.words[l]|0)+d*67108864;this.words[l]=v/a|0,d=v%a}return this.strip()},i.prototype.divn=function(a){return this.clone().idivn(a)},i.prototype.egcd=function(a){r(a.negative===0),r(!a.isZero());var d=this,l=a.clone();d.negative!==0?d=d.umod(a):d=d.clone();for(var v=new i(1),b=new i(0),w=new i(0),B=new i(1),m=0;d.isEven()&&l.isEven();)d.iushrn(1),l.iushrn(1),++m;for(var f=l.clone(),g=d.clone();!d.isZero();){for(var H=0,j=1;(d.words[0]&j)===0&&H<26;++H,j<<=1);if(H>0)for(d.iushrn(H);H-- >0;)(v.isOdd()||b.isOdd())&&(v.iadd(f),b.isub(g)),v.iushrn(1),b.iushrn(1);for(var V=0,Z=1;(l.words[0]&Z)===0&&V<26;++V,Z<<=1);if(V>0)for(l.iushrn(V);V-- >0;)(w.isOdd()||B.isOdd())&&(w.iadd(f),B.isub(g)),w.iushrn(1),B.iushrn(1);d.cmp(l)>=0?(d.isub(l),v.isub(w),b.isub(B)):(l.isub(d),w.isub(v),B.isub(b))}return{a:w,b:B,gcd:l.iushln(m)}},i.prototype._invmp=function(a){r(a.negative===0),r(!a.isZero());var d=this,l=a.clone();d.negative!==0?d=d.umod(a):d=d.clone();for(var v=new i(1),b=new i(0),w=l.clone();d.cmpn(1)>0&&l.cmpn(1)>0;){for(var B=0,m=1;(d.words[0]&m)===0&&B<26;++B,m<<=1);if(B>0)for(d.iushrn(B);B-- >0;)v.isOdd()&&v.iadd(w),v.iushrn(1);for(var f=0,g=1;(l.words[0]&g)===0&&f<26;++f,g<<=1);if(f>0)for(l.iushrn(f);f-- >0;)b.isOdd()&&b.iadd(w),b.iushrn(1);d.cmp(l)>=0?(d.isub(l),v.isub(b)):(l.isub(d),b.isub(v))}var H;return d.cmpn(1)===0?H=v:H=b,H.cmpn(0)<0&&H.iadd(a),H},i.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var d=this.clone(),l=a.clone();d.negative=0,l.negative=0;for(var v=0;d.isEven()&&l.isEven();v++)d.iushrn(1),l.iushrn(1);do{for(;d.isEven();)d.iushrn(1);for(;l.isEven();)l.iushrn(1);var b=d.cmp(l);if(b<0){var w=d;d=l,l=w}else if(b===0||l.cmpn(1)===0)break;d.isub(l)}while(!0);return l.iushln(v)},i.prototype.invm=function(a){return this.egcd(a).a.umod(a)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(a){return this.words[0]&a},i.prototype.bincn=function(a){r(typeof a=="number");var d=a%26,l=(a-d)/26,v=1<<d;if(this.length<=l)return this._expand(l+1),this.words[l]|=v,this;for(var b=v,w=l;b!==0&&w<this.length;w++){var B=this.words[w]|0;B+=b,b=B>>>26,B&=67108863,this.words[w]=B}return b!==0&&(this.words[w]=b,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(a){var d=a<0;if(this.negative!==0&&!d)return-1;if(this.negative===0&&d)return 1;this.strip();var l;if(this.length>1)l=1;else{d&&(a=-a),r(a<=67108863,"Number is too big");var v=this.words[0]|0;l=v===a?0:v<a?-1:1}return this.negative!==0?-l|0:l},i.prototype.cmp=function(a){if(this.negative!==0&&a.negative===0)return-1;if(this.negative===0&&a.negative!==0)return 1;var d=this.ucmp(a);return this.negative!==0?-d|0:d},i.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var d=0,l=this.length-1;l>=0;l--){var v=this.words[l]|0,b=a.words[l]|0;if(v!==b){v<b?d=-1:v>b&&(d=1);break}}return d},i.prototype.gtn=function(a){return this.cmpn(a)===1},i.prototype.gt=function(a){return this.cmp(a)===1},i.prototype.gten=function(a){return this.cmpn(a)>=0},i.prototype.gte=function(a){return this.cmp(a)>=0},i.prototype.ltn=function(a){return this.cmpn(a)===-1},i.prototype.lt=function(a){return this.cmp(a)===-1},i.prototype.lten=function(a){return this.cmpn(a)<=0},i.prototype.lte=function(a){return this.cmp(a)<=0},i.prototype.eqn=function(a){return this.cmpn(a)===0},i.prototype.eq=function(a){return this.cmp(a)===0},i.red=function(a){return new R(a)},i.prototype.toRed=function(a){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),a.convertTo(this)._forceRed(a)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(a){return this.red=a,this},i.prototype.forceRed=function(a){return r(!this.red,"Already a number in reduction context"),this._forceRed(a)},i.prototype.redAdd=function(a){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},i.prototype.redIAdd=function(a){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},i.prototype.redSub=function(a){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},i.prototype.redISub=function(a){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},i.prototype.redShl=function(a){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},i.prototype.redMul=function(a){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},i.prototype.redIMul=function(a){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(a){return r(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var C={k256:null,p224:null,p192:null,p25519:null};function P(_,a){this.name=_,this.p=new i(a,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var a=new i(null);return a.words=new Array(Math.ceil(this.n/13)),a},P.prototype.ireduce=function(a){var d=a,l;do this.split(d,this.tmp),d=this.imulK(d),d=d.iadd(this.tmp),l=d.bitLength();while(l>this.n);var v=l<this.n?-1:d.ucmp(this.p);return v===0?(d.words[0]=0,d.length=1):v>0?d.isub(this.p):d.strip!==void 0?d.strip():d._strip(),d},P.prototype.split=function(a,d){a.iushrn(this.n,0,d)},P.prototype.imulK=function(a){return a.imul(this.k)};function T(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(T,P),T.prototype.split=function(a,d){for(var l=4194303,v=Math.min(a.length,9),b=0;b<v;b++)d.words[b]=a.words[b];if(d.length=v,a.length<=9){a.words[0]=0,a.length=1;return}var w=a.words[9];for(d.words[d.length++]=w&l,b=10;b<a.length;b++){var B=a.words[b]|0;a.words[b-10]=(B&l)<<4|w>>>22,w=B}w>>>=22,a.words[b-10]=w,w===0&&a.length>10?a.length-=10:a.length-=9},T.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var d=0,l=0;l<a.length;l++){var v=a.words[l]|0;d+=v*977,a.words[l]=d&67108863,d=v*64+(d/67108864|0)}return a.words[a.length-1]===0&&(a.length--,a.words[a.length-1]===0&&a.length--),a};function L(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(L,P);function N(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(N,P);function D(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(D,P),D.prototype.imulK=function(a){for(var d=0,l=0;l<a.length;l++){var v=(a.words[l]|0)*19+d,b=v&67108863;v>>>=26,a.words[l]=b,d=v}return d!==0&&(a.words[a.length++]=d),a},i._prime=function(a){if(C[a])return C[a];var d;if(a==="k256")d=new T;else if(a==="p224")d=new L;else if(a==="p192")d=new N;else if(a==="p25519")d=new D;else throw new Error("Unknown prime "+a);return C[a]=d,d};function R(_){if(typeof _=="string"){var a=i._prime(_);this.m=a.p,this.prime=a}else r(_.gtn(1),"modulus must be greater than 1"),this.m=_,this.prime=null}R.prototype._verify1=function(a){r(a.negative===0,"red works only with positives"),r(a.red,"red works only with red numbers")},R.prototype._verify2=function(a,d){r((a.negative|d.negative)===0,"red works only with positives"),r(a.red&&a.red===d.red,"red works only with red numbers")},R.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},R.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},R.prototype.add=function(a,d){this._verify2(a,d);var l=a.add(d);return l.cmp(this.m)>=0&&l.isub(this.m),l._forceRed(this)},R.prototype.iadd=function(a,d){this._verify2(a,d);var l=a.iadd(d);return l.cmp(this.m)>=0&&l.isub(this.m),l},R.prototype.sub=function(a,d){this._verify2(a,d);var l=a.sub(d);return l.cmpn(0)<0&&l.iadd(this.m),l._forceRed(this)},R.prototype.isub=function(a,d){this._verify2(a,d);var l=a.isub(d);return l.cmpn(0)<0&&l.iadd(this.m),l},R.prototype.shl=function(a,d){return this._verify1(a),this.imod(a.ushln(d))},R.prototype.imul=function(a,d){return this._verify2(a,d),this.imod(a.imul(d))},R.prototype.mul=function(a,d){return this._verify2(a,d),this.imod(a.mul(d))},R.prototype.isqr=function(a){return this.imul(a,a.clone())},R.prototype.sqr=function(a){return this.mul(a,a)},R.prototype.sqrt=function(a){if(a.isZero())return a.clone();var d=this.m.andln(3);if(r(d%2===1),d===3){var l=this.m.add(new i(1)).iushrn(2);return this.pow(a,l)}for(var v=this.m.subn(1),b=0;!v.isZero()&&v.andln(1)===0;)b++,v.iushrn(1);r(!v.isZero());var w=new i(1).toRed(this),B=w.redNeg(),m=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new i(2*f*f).toRed(this);this.pow(f,m).cmp(B)!==0;)f.redIAdd(B);for(var g=this.pow(f,v),H=this.pow(a,v.addn(1).iushrn(1)),j=this.pow(a,v),V=b;j.cmp(w)!==0;){for(var Z=j,J=0;Z.cmp(w)!==0;J++)Z=Z.redSqr();r(J<V);var ne=this.pow(g,new i(1).iushln(V-J-1));H=H.redMul(ne),g=ne.redSqr(),j=j.redMul(g),V=J}return H},R.prototype.invm=function(a){var d=a._invmp(this.m);return d.negative!==0?(d.negative=0,this.imod(d).redNeg()):this.imod(d)},R.prototype.pow=function(a,d){if(d.isZero())return new i(1).toRed(this);if(d.cmpn(1)===0)return a.clone();var l=4,v=new Array(1<<l);v[0]=new i(1).toRed(this),v[1]=a;for(var b=2;b<v.length;b++)v[b]=this.mul(v[b-1],a);var w=v[0],B=0,m=0,f=d.bitLength()%26;for(f===0&&(f=26),b=d.length-1;b>=0;b--){for(var g=d.words[b],H=f-1;H>=0;H--){var j=g>>H&1;if(w!==v[0]&&(w=this.sqr(w)),j===0&&B===0){m=0;continue}B<<=1,B|=j,m++,!(m!==l&&(b!==0||H!==0))&&(w=this.mul(w,v[B]),m=0,B=0)}f=26}return w},R.prototype.convertTo=function(a){var d=a.umod(this.m);return d===a?d.clone():d},R.prototype.convertFrom=function(a){var d=a.clone();return d.red=null,d},i.mont=function(a){return new $(a)};function $(_){R.call(this,_),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n($,R),$.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},$.prototype.convertFrom=function(a){var d=this.imod(a.mul(this.rinv));return d.red=null,d},$.prototype.imul=function(a,d){if(a.isZero()||d.isZero())return a.words[0]=0,a.length=1,a;var l=a.imul(d),v=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=l.isub(v).iushrn(this.shift),w=b;return b.cmp(this.m)>=0?w=b.isub(this.m):b.cmpn(0)<0&&(w=b.iadd(this.m)),w._forceRed(this)},$.prototype.mul=function(a,d){if(a.isZero()||d.isZero())return new i(0)._forceRed(this);var l=a.mul(d),v=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=l.isub(v).iushrn(this.shift),w=b;return b.cmp(this.m)>=0?w=b.isub(this.m):b.cmpn(0)<0&&(w=b.iadd(this.m)),w._forceRed(this)},$.prototype.invm=function(a){var d=this.imod(a._invmp(this.m).mul(this.r2));return d._forceRed(this)}})(typeof Na>"u"||Na,io)});var Lt=K(ao=>{k();q();var Vt=ao,xu=Ot(),Su=z0(),vi=K0();Vt.assert=Su;Vt.toArray=vi.toArray;Vt.zero2=vi.zero2;Vt.toHex=vi.toHex;Vt.encode=vi.encode;function Mu(t,e,r){var n=new Array(Math.max(t.bitLength(),r)+1);n.fill(0);for(var i=1<<e+1,s=t.clone(),o=0;o<n.length;o++){var c,u=s.andln(i-1);s.isOdd()?(u>(i>>1)-1?c=(i>>1)-u:c=u,s.isubn(c)):c=0,n[o]=c,s.iushrn(1)}return n}Vt.getNAF=Mu;function Bu(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var n=0,i=0,s;t.cmpn(-n)>0||e.cmpn(-i)>0;){var o=t.andln(3)+n&3,c=e.andln(3)+i&3;o===3&&(o=-1),c===3&&(c=-1);var u;(o&1)===0?u=0:(s=t.andln(7)+n&7,(s===3||s===5)&&c===2?u=-o:u=o),r[0].push(u);var h;(c&1)===0?h=0:(s=e.andln(7)+i&7,(s===3||s===5)&&o===2?h=-c:h=c),r[1].push(h),2*n===u+1&&(n=1-n),2*i===h+1&&(i=1-i),t.iushrn(1),e.iushrn(1)}return r}Vt.getJSF=Bu;function Au(t,e,r){var n="_"+e;t.prototype[e]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}Vt.cachedProperty=Au;function Eu(t){return typeof t=="string"?Vt.toArray(t,"hex"):t}Vt.parseBytes=Eu;function Iu(t){return new xu(t,"hex","le")}Vt.intFromLE=Iu});var Nn=K((F2,so)=>{k();q();var Rn=Lt(),Nr=Ot(),yi=Rn.getNAF,Pu=Rn.getJSF,mi=Rn.assert;function xr(t,e){this.type=t,this.p=new Nr(e.p,16),this.red=e.prime?Nr.red(e.prime):Nr.mont(this.p),this.zero=new Nr(0).toRed(this.red),this.one=new Nr(1).toRed(this.red),this.two=new Nr(2).toRed(this.red),this.n=e.n&&new Nr(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}so.exports=xr;xr.prototype.point=function(){throw new Error("Not implemented")};xr.prototype.validate=function(){throw new Error("Not implemented")};xr.prototype._fixedNafMul=function(e,r){mi(e.precomputed);var n=e._getDoubles(),i=yi(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],c,u;for(c=0;c<i.length;c+=n.step){u=0;for(var h=c+n.step-1;h>=c;h--)u=(u<<1)+i[h];o.push(u)}for(var y=this.jpoint(null,null,null),p=this.jpoint(null,null,null),S=s;S>0;S--){for(c=0;c<o.length;c++)u=o[c],u===S?p=p.mixedAdd(n.points[c]):u===-S&&(p=p.mixedAdd(n.points[c].neg()));y=y.add(p)}return y.toP()};xr.prototype._wnafMul=function(e,r){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=yi(r,n,this._bitLength),c=this.jpoint(null,null,null),u=o.length-1;u>=0;u--){for(var h=0;u>=0&&o[u]===0;u--)h++;if(u>=0&&h++,c=c.dblp(h),u<0)break;var y=o[u];mi(y!==0),e.type==="affine"?y>0?c=c.mixedAdd(s[y-1>>1]):c=c.mixedAdd(s[-y-1>>1].neg()):y>0?c=c.add(s[y-1>>1]):c=c.add(s[-y-1>>1].neg())}return e.type==="affine"?c.toP():c};xr.prototype._wnafMulAdd=function(e,r,n,i,s){var o=this._wnafT1,c=this._wnafT2,u=this._wnafT3,h=0,y,p,S;for(y=0;y<i;y++){S=r[y];var M=S._getNAFPoints(e);o[y]=M.wnd,c[y]=M.points}for(y=i-1;y>=1;y-=2){var A=y-1,x=y;if(o[A]!==1||o[x]!==1){u[A]=yi(n[A],o[A],this._bitLength),u[x]=yi(n[x],o[x],this._bitLength),h=Math.max(u[A].length,h),h=Math.max(u[x].length,h);continue}var I=[r[A],null,null,r[x]];r[A].y.cmp(r[x].y)===0?(I[1]=r[A].add(r[x]),I[2]=r[A].toJ().mixedAdd(r[x].neg())):r[A].y.cmp(r[x].y.redNeg())===0?(I[1]=r[A].toJ().mixedAdd(r[x]),I[2]=r[A].add(r[x].neg())):(I[1]=r[A].toJ().mixedAdd(r[x]),I[2]=r[A].toJ().mixedAdd(r[x].neg()));var E=[-3,-1,-5,-7,0,7,5,1,3],C=Pu(n[A],n[x]);for(h=Math.max(C[0].length,h),u[A]=new Array(h),u[x]=new Array(h),p=0;p<h;p++){var P=C[0][p]|0,T=C[1][p]|0;u[A][p]=E[(P+1)*3+(T+1)],u[x][p]=0,c[A]=I}}var L=this.jpoint(null,null,null),N=this._wnafT4;for(y=h;y>=0;y--){for(var D=0;y>=0;){var R=!0;for(p=0;p<i;p++)N[p]=u[p][y]|0,N[p]!==0&&(R=!1);if(!R)break;D++,y--}if(y>=0&&D++,L=L.dblp(D),y<0)break;for(p=0;p<i;p++){var $=N[p];$!==0&&($>0?S=c[p][$-1>>1]:$<0&&(S=c[p][-$-1>>1].neg()),S.type==="affine"?L=L.mixedAdd(S):L=L.add(S))}}for(y=0;y<i;y++)c[y]=null;return s?L:L.toP()};function Ht(t,e){this.curve=t,this.type=e,this.precomputed=null}xr.BasePoint=Ht;Ht.prototype.eq=function(){throw new Error("Not implemented")};Ht.prototype.validate=function(){return this.curve.validate(this)};xr.prototype.decodePoint=function(e,r){e=Rn.toArray(e,r);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?mi(e[e.length-1]%2===0):e[0]===7&&mi(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")};Ht.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Ht.prototype._encode=function(e){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};Ht.prototype.encode=function(e,r){return Rn.encode(this._encode(r),e)};Ht.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};Ht.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};Ht.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)i=i.dbl();n.push(i)}return{step:e,points:n}};Ht.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:e,points:r}};Ht.prototype._getBeta=function(){return null};Ht.prototype.dblp=function(e){for(var r=this,n=0;n<e;n++)r=r.dbl();return r}});var oo=K((W2,fo)=>{k();q();var ku=Lt(),_e=Ot(),Ha=ma(),cn=Nn(),qu=ku.assert;function jt(t){cn.call(this,"short",t),this.a=new _e(t.a,16).toRed(this.red),this.b=new _e(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Ha(jt,cn);fo.exports=jt;jt.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(e.beta)r=new _e(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(e.lambda)n=new _e(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],qu(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(c){return{a:new _e(c.a,16),b:new _e(c.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}};jt.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:_e.mont(e),n=new _e(2).toRed(r).redInvm(),i=n.redNeg(),s=new _e(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),c=i.redSub(s).fromRed();return[o,c]};jt.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),s=new _e(1),o=new _e(0),c=new _e(0),u=new _e(1),h,y,p,S,M,A,x,I=0,E,C;n.cmpn(0)!==0;){var P=i.div(n);E=i.sub(P.mul(n)),C=c.sub(P.mul(s));var T=u.sub(P.mul(o));if(!p&&E.cmp(r)<0)h=x.neg(),y=s,p=E.neg(),S=C;else if(p&&++I===2)break;x=E,i=n,n=E,c=s,s=C,u=o,o=T}M=E.neg(),A=C;var L=p.sqr().add(S.sqr()),N=M.sqr().add(A.sqr());return N.cmp(L)>=0&&(M=h,A=y),p.negative&&(p=p.neg(),S=S.neg()),M.negative&&(M=M.neg(),A=A.neg()),[{a:p,b:S},{a:M,b:A}]};jt.prototype._endoSplit=function(e){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),c=s.mul(n.a),u=o.mul(i.a),h=s.mul(n.b),y=o.mul(i.b),p=e.sub(c).sub(u),S=h.add(y).neg();return{k1:p,k2:S}};jt.prototype.pointFromX=function(e,r){e=new _e(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(e,i)};jt.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,n=e.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};jt.prototype._endoWnafMulAdd=function(e,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var c=this._endoSplit(r[o]),u=e[o],h=u._getBeta();c.k1.negative&&(c.k1.ineg(),u=u.neg(!0)),c.k2.negative&&(c.k2.ineg(),h=h.neg(!0)),i[o*2]=u,i[o*2+1]=h,s[o*2]=c.k1,s[o*2+1]=c.k2}for(var y=this._wnafMulAdd(1,i,s,o*2,n),p=0;p<o*2;p++)i[p]=null,s[p]=null;return y};function ct(t,e,r,n){cn.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new _e(e,16),this.y=new _e(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Ha(ct,cn.BasePoint);jt.prototype.point=function(e,r,n){return new ct(this,e,r,n)};jt.prototype.pointFromJSON=function(e,r){return ct.fromJSON(this,e,r)};ct.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return r}};ct.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};ct.fromJSON=function(e,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=e.point(r[0],r[1],n);if(!r[2])return i;function s(c){return e.point(c[0],c[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};ct.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};ct.prototype.isInfinity=function(){return this.inf};ct.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(e.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};ct.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),c=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,c)};ct.prototype.getX=function(){return this.x.fromRed()};ct.prototype.getY=function(){return this.y.fromRed()};ct.prototype.mul=function(e){return e=new _e(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};ct.prototype.mulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};ct.prototype.jmulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};ct.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};ct.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};ct.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function mt(t,e,r,n){cn.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new _e(0)):(this.x=new _e(e,16),this.y=new _e(r,16),this.z=new _e(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Ha(mt,cn.BasePoint);jt.prototype.jpoint=function(e,r,n){return new mt(this,e,r,n)};mt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(e);return this.curve.point(n,i)};mt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};mt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=e.x.redMul(n),o=this.y.redMul(r.redMul(e.z)),c=e.y.redMul(n.redMul(this.z)),u=i.redSub(s),h=o.redSub(c);if(u.cmpn(0)===0)return h.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var y=u.redSqr(),p=y.redMul(u),S=i.redMul(y),M=h.redSqr().redIAdd(p).redISub(S).redISub(S),A=h.redMul(S.redISub(M)).redISub(o.redMul(p)),x=this.z.redMul(e.z).redMul(u);return this.curve.jpoint(M,A,x)};mt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),c=n.redSub(i),u=s.redSub(o);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var h=c.redSqr(),y=h.redMul(c),p=n.redMul(h),S=u.redSqr().redIAdd(y).redISub(p).redISub(p),M=u.redMul(p.redISub(S)).redISub(s.redMul(y)),A=this.z.redMul(c);return this.curve.jpoint(S,M,A)};mt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<e;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,c=this.y,u=this.z,h=u.redSqr().redSqr(),y=c.redAdd(c);for(r=0;r<e;r++){var p=o.redSqr(),S=y.redSqr(),M=S.redSqr(),A=p.redAdd(p).redIAdd(p).redIAdd(i.redMul(h)),x=o.redMul(S),I=A.redSqr().redISub(x.redAdd(x)),E=x.redISub(I),C=A.redMul(E);C=C.redIAdd(C).redISub(M);var P=y.redMul(u);r+1<e&&(h=h.redMul(M)),o=I,u=P,y=C}return this.curve.jpoint(o,y.redMul(s),u)};mt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};mt.prototype._zeroDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(i).redISub(o);c=c.redIAdd(c);var u=i.redAdd(i).redIAdd(i),h=u.redSqr().redISub(c).redISub(c),y=o.redIAdd(o);y=y.redIAdd(y),y=y.redIAdd(y),e=h,r=u.redMul(c.redISub(h)).redISub(y),n=this.y.redAdd(this.y)}else{var p=this.x.redSqr(),S=this.y.redSqr(),M=S.redSqr(),A=this.x.redAdd(S).redSqr().redISub(p).redISub(M);A=A.redIAdd(A);var x=p.redAdd(p).redIAdd(p),I=x.redSqr(),E=M.redIAdd(M);E=E.redIAdd(E),E=E.redIAdd(E),e=I.redISub(A).redISub(A),r=x.redMul(A.redISub(e)).redISub(E),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,r,n)};mt.prototype._threeDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(i).redISub(o);c=c.redIAdd(c);var u=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),h=u.redSqr().redISub(c).redISub(c);e=h;var y=o.redIAdd(o);y=y.redIAdd(y),y=y.redIAdd(y),r=u.redMul(c.redISub(h)).redISub(y),n=this.y.redAdd(this.y)}else{var p=this.z.redSqr(),S=this.y.redSqr(),M=this.x.redMul(S),A=this.x.redSub(p).redMul(this.x.redAdd(p));A=A.redAdd(A).redIAdd(A);var x=M.redIAdd(M);x=x.redIAdd(x);var I=x.redAdd(x);e=A.redSqr().redISub(I),n=this.y.redAdd(this.z).redSqr().redISub(S).redISub(p);var E=S.redSqr();E=E.redIAdd(E),E=E.redIAdd(E),E=E.redIAdd(E),r=A.redMul(x.redISub(e)).redISub(E)}return this.curve.jpoint(e,r,n)};mt.prototype._dbl=function(){var e=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),c=n.redSqr(),u=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),h=r.redAdd(r);h=h.redIAdd(h);var y=h.redMul(c),p=u.redSqr().redISub(y.redAdd(y)),S=y.redISub(p),M=c.redSqr();M=M.redIAdd(M),M=M.redIAdd(M),M=M.redIAdd(M);var A=u.redMul(S).redISub(M),x=n.redAdd(n).redMul(i);return this.curve.jpoint(p,A,x)};mt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),c=this.x.redAdd(r).redSqr().redISub(e).redISub(i);c=c.redIAdd(c),c=c.redAdd(c).redIAdd(c),c=c.redISub(o);var u=c.redSqr(),h=i.redIAdd(i);h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var y=s.redIAdd(c).redSqr().redISub(o).redISub(u).redISub(h),p=r.redMul(y);p=p.redIAdd(p),p=p.redIAdd(p);var S=this.x.redMul(u).redISub(p);S=S.redIAdd(S),S=S.redIAdd(S);var M=this.y.redMul(y.redMul(h.redISub(y)).redISub(c.redMul(u)));M=M.redIAdd(M),M=M.redIAdd(M),M=M.redIAdd(M);var A=this.z.redAdd(c).redSqr().redISub(n).redISub(u);return this.curve.jpoint(S,M,A)};mt.prototype.mul=function(e,r){return e=new _e(e,r),this.curve._wnafMul(this,e)};mt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)===0};mt.prototype.eqXToP=function(e){var r=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};mt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};mt.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var lo=K((Y2,uo)=>{k();q();var dn=Ot(),co=ma(),gi=Nn(),Ou=Lt();function un(t){gi.call(this,"mont",t),this.a=new dn(t.a,16).toRed(this.red),this.b=new dn(t.b,16).toRed(this.red),this.i4=new dn(4).toRed(this.red).redInvm(),this.two=new dn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}co(un,gi);uo.exports=un;un.prototype.validate=function(e){var r=e.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function dt(t,e,r){gi.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new dn(e,16),this.z=new dn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}co(dt,gi.BasePoint);un.prototype.decodePoint=function(e,r){return this.point(Ou.toArray(e,r),1)};un.prototype.point=function(e,r){return new dt(this,e,r)};un.prototype.pointFromJSON=function(e){return dt.fromJSON(this,e)};dt.prototype.precompute=function(){};dt.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};dt.fromJSON=function(e,r){return new dt(e,r[0],r[1]||e.one)};dt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};dt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};dt.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),c=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,c)};dt.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};dt.prototype.diffAdd=function(e,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),c=o.redMul(n),u=s.redMul(i),h=r.z.redMul(c.redAdd(u).redSqr()),y=r.x.redMul(c.redISub(u).redSqr());return this.curve.point(h,y)};dt.prototype.mul=function(e){for(var r=e.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var c=o.length-1;c>=0;c--)o[c]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};dt.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};dt.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};dt.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};dt.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};dt.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var po=K((e3,bo)=>{k();q();var Cu=Lt(),or=Ot(),ho=ma(),wi=Nn(),Tu=Cu.assert;function Gt(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,wi.call(this,"edwards",t),this.a=new or(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new or(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new or(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Tu(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}ho(Gt,wi);bo.exports=Gt;Gt.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Gt.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Gt.prototype.jpoint=function(e,r,n,i){return this.point(e,r,n,i)};Gt.prototype.pointFromX=function(e,r){e=new or(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),c=o.redSqrt();if(c.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var u=c.fromRed().isOdd();return(r&&!u||!r&&u)&&(c=c.redNeg()),this.point(e,c)};Gt.prototype.pointFromY=function(e,r){e=new or(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var c=o.redSqrt();if(c.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return c.fromRed().isOdd()!==r&&(c=c.redNeg()),this.point(c,e)};Gt.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),n=e.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function le(t,e,r,n,i){wi.BasePoint.call(this,t,"projective"),e===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new or(e,16),this.y=new or(r,16),this.z=n?new or(n,16):this.curve.one,this.t=i&&new or(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}ho(le,wi.BasePoint);Gt.prototype.pointFromJSON=function(e){return le.fromJSON(this,e)};Gt.prototype.point=function(e,r,n,i){return new le(this,e,r,n,i)};le.fromJSON=function(e,r){return new le(e,r[0],r[1],r[2])};le.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};le.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};le.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=i.redAdd(r),c=o.redSub(n),u=i.redSub(r),h=s.redMul(c),y=o.redMul(u),p=s.redMul(u),S=c.redMul(o);return this.curve.point(h,y,S,p)};le.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,c,u,h;if(this.curve.twisted){c=this.curve._mulA(r);var y=c.redAdd(n);this.zOne?(i=e.redSub(r).redSub(n).redMul(y.redSub(this.curve.two)),s=y.redMul(c.redSub(n)),o=y.redSqr().redSub(y).redSub(y)):(u=this.z.redSqr(),h=y.redSub(u).redISub(u),i=e.redSub(r).redISub(n).redMul(h),s=y.redMul(c.redSub(n)),o=y.redMul(h))}else c=r.redAdd(n),u=this.curve._mulC(this.z).redSqr(),h=c.redSub(u).redSub(u),i=this.curve._mulC(e.redISub(c)).redMul(h),s=this.curve._mulC(c).redMul(r.redISub(n)),o=c.redMul(h);return this.curve.point(i,s,o)};le.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};le.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=n.redSub(r),c=s.redSub(i),u=s.redAdd(i),h=n.redAdd(r),y=o.redMul(c),p=u.redMul(h),S=o.redMul(h),M=c.redMul(u);return this.curve.point(y,p,M,S)};le.prototype._projAdd=function(e){var r=this.z.redMul(e.z),n=r.redSqr(),i=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(i).redMul(s),c=n.redSub(o),u=n.redAdd(o),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(s),y=r.redMul(c).redMul(h),p,S;return this.curve.twisted?(p=r.redMul(u).redMul(s.redSub(this.curve._mulA(i))),S=c.redMul(u)):(p=r.redMul(u).redMul(s.redSub(i)),S=this.curve._mulC(c).redMul(u)),this.curve.point(y,p,S)};le.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};le.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};le.prototype.mulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!1)};le.prototype.jmulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!0)};le.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};le.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};le.prototype.getX=function(){return this.normalize(),this.x.fromRed()};le.prototype.getY=function(){return this.normalize(),this.y.fromRed()};le.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};le.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=e.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};le.prototype.toP=le.prototype.normalize;le.prototype.mixedAdd=le.prototype.add});var ja=K(vo=>{k();q();var _i=vo;_i.base=Nn();_i.short=oo();_i.mont=lo();_i.edwards=po()});var mo=K((s3,yo)=>{k();q();yo.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var xi=K(_o=>{k();q();var Ua=_o,Sr=$s(),Da=ja(),Lu=Lt(),go=Lu.assert;function wo(t){t.type==="short"?this.curve=new Da.short(t):t.type==="edwards"?this.curve=new Da.edwards(t):this.curve=new Da.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,go(this.g.validate(),"Invalid curve"),go(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}Ua.PresetCurve=wo;function Mr(t,e){Object.defineProperty(Ua,t,{configurable:!0,enumerable:!0,get:function(){var r=new wo(e);return Object.defineProperty(Ua,t,{configurable:!0,enumerable:!0,value:r}),r}})}Mr("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Sr.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Mr("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Sr.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Mr("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Sr.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Mr("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Sr.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Mr("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Sr.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Mr("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Sr.sha256,gRed:!1,g:["9"]});Mr("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Sr.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var za;try{za=mo()}catch{za=void 0}Mr("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Sr.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",za]})});var So=K((l3,xo)=>{k();q();var Ru=Ot(),Nu=Lt(),Ka=Nu.assert;function _t(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}xo.exports=_t;_t.fromPublic=function(e,r,n){return r instanceof _t?r:new _t(e,{pub:r,pubEnc:n})};_t.fromPrivate=function(e,r,n){return r instanceof _t?r:new _t(e,{priv:r,privEnc:n})};_t.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};_t.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};_t.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};_t.prototype._importPrivate=function(e,r){this.priv=new Ru(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};_t.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?Ka(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Ka(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};_t.prototype.derive=function(e){return e.validate()||Ka(e.validate(),"public point not validated"),e.mul(this.priv).getX()};_t.prototype.sign=function(e,r,n){return this.ec.sign(e,this,r,n)};_t.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};_t.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var Ao=K((p3,Bo)=>{k();q();var Si=Ot(),Za=Lt(),Hu=Za.assert;function Hn(t,e,r){if(e instanceof Hn)return e;this._importDER(e,r)||(Hu(e.r&&e.s,"Signature without r or s"),this.r=new Si(e.r,16),this.s=new Si(e.s,16),e.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=e.recoveryParam,this.curve=t,this.byteLength=this.curve.n.byteLength())}Bo.exports=Hn;function ju(){this.place=0}function Va(t,e){var r=t[e.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,o=e.place;s<n;s++,o++)i<<=8,i|=t[o],i>>>=0;return i<=127?!1:(e.place=o,i)}function Mo(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}Hn.prototype._importDER=function(e,r){e=Za.toArray(e,r);var n=new ju;if(e[n.place++]!==48)return!1;var i=Va(e,n);if(i===!1||i+n.place!==e.length||e[n.place++]!==2)return!1;var s=Va(e,n);if(s===!1)return!1;var o=e.slice(n.place,s+n.place);if(n.place+=s,e[n.place++]!==2)return!1;var c=Va(e,n);if(c===!1||e.length!==c+n.place)return!1;var u=e.slice(n.place,c+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(u[0]===0)if(u[1]&128)u=u.slice(1);else return!1;return this.r=new Si(o),this.s=new Si(u),this.recoveryParam=null,!0};function Fa(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}Hn.prototype.toDER=function(e){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=Mo(r),n=Mo(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];Fa(i,r.length),i=i.concat(r),i.push(2),Fa(i,n.length);var s=i.concat(n),o=[48];return Fa(o,s.length),o=o.concat(s),Za.encode(o,e)};Hn.prototype.toBytes=function(){let e=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return e.concat(r)}});var Po=K((m3,Io)=>{k();q();var cr=Ot(),Eo=F0(),Du=Lt(),$a=xi(),Uu=$0(),Hr=Du.assert,Wa=So(),Mi=Ao();function Dt(t){if(!(this instanceof Dt))return new Dt(t);typeof t=="string"&&(Hr(Object.prototype.hasOwnProperty.call($a,t),"Unknown curve "+t),t=$a[t]),t instanceof $a.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}Io.exports=Dt;Dt.prototype.keyPair=function(e){return new Wa(this,e)};Dt.prototype.keyFromPrivate=function(e,r){return Wa.fromPrivate(this,e,r)};Dt.prototype.keyFromPublic=function(e,r){return Wa.fromPublic(this,e,r)};Dt.prototype.genKeyPair=function(e){e||(e={});for(var r=new Eo({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Uu(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new cr(2));;){var s=new cr(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Dt.prototype._truncateToN=function(e,r){var n=e.byteLength()*8-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};Dt.prototype.sign=function(e,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof e!="string"&&typeof e!="number"&&!cr.isBN(e)){Hr(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Hr(e.length>>>0===e.length);for(var s=0;s<e.length;s++)Hr((e[s]&255)===e[s])}r=this.keyFromPrivate(r,n),e=this._truncateToN(new cr(e,16)),Hr(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),c=r.getPrivate().toArray("be",o),u=e.toArray("be",o);Hr(new cr(u).eq(e),"Can not sign message");for(var h=new Eo({hash:this.hash,entropy:c,nonce:u,pers:i.pers,persEnc:i.persEnc||"utf8"}),y=this.n.sub(new cr(1)),p=0;;p++){var S=i.k?i.k(p):new cr(h.generate(this.n.byteLength()));if(S=this._truncateToN(S,!0),!(S.cmpn(1)<=0||S.cmp(y)>=0)){var M=this.g.mul(S);if(!M.isInfinity()){var A=M.getX(),x=A.umod(this.n);if(x.cmpn(0)!==0){var I=S.invm(this.n).mul(x.mul(r.getPrivate()).iadd(e));if(I=I.umod(this.n),I.cmpn(0)!==0){var E=(M.getY().isOdd()?1:0)|(A.cmp(x)!==0?2:0);return i.canonical&&I.cmp(this.nh)>0&&(I=this.n.sub(I),E^=1),new Mi(this.curve,{r:x,s:I,recoveryParam:E})}}}}}};Dt.prototype.verify=function(e,r,n,i){e=this._truncateToN(new cr(e,16)),n=this.keyFromPublic(n,i),r=new Mi(this.curve,r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var c=o.invm(this.n),u=c.mul(e).umod(this.n),h=c.mul(s).umod(this.n),y;return this.curve._maxwellTrick?(y=this.g.jmulAdd(u,n.getPublic(),h),y.isInfinity()?!1:y.eqXToP(s)):(y=this.g.mulAdd(u,n.getPublic(),h),y.isInfinity()?!1:y.getX().umod(this.n).cmp(s)===0)};Dt.prototype.recoverPubKey=function(t,e,r,n){Hr((3&r)===r,"The recovery param is more than two bits"),e=new Mi(this.curve,e,n);var i=this.n,s=new cr(t),o=e.r,c=e.s,u=r&1,h=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");h?o=this.curve.pointFromX(o.add(this.curve.n),u):o=this.curve.pointFromX(o,u);var y=e.r.invm(i),p=i.sub(s).mul(y).umod(i),S=c.mul(y).umod(i);return this.g.mulAdd(p,o,S)};Dt.prototype.getKeyRecoveryParam=function(t,e,r,n){if(e=new Mi(this.curve,e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(t,e,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var Co=K((_3,Oo)=>{k();q();var jn=Lt(),qo=jn.assert,ko=jn.parseBytes,ln=jn.cachedProperty;function ut(t,e){this.eddsa=t,this._secret=ko(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=ko(e.pub)}ut.fromPublic=function(e,r){return r instanceof ut?r:new ut(e,{pub:r})};ut.fromSecret=function(e,r){return r instanceof ut?r:new ut(e,{secret:r})};ut.prototype.secret=function(){return this._secret};ln(ut,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});ln(ut,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});ln(ut,"privBytes",function(){var e=this.eddsa,r=this.hash(),n=e.encodingLength-1,i=r.slice(0,e.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});ln(ut,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});ln(ut,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});ln(ut,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});ut.prototype.sign=function(e){return qo(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};ut.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};ut.prototype.getSecret=function(e){return qo(this._secret,"KeyPair is public only"),jn.encode(this.secret(),e)};ut.prototype.getPublic=function(e){return jn.encode(this.pubBytes(),e)};Oo.exports=ut});var Lo=K((M3,To)=>{k();q();var zu=Ot(),Bi=Lt(),Ku=Bi.assert,Ai=Bi.cachedProperty,Vu=Bi.parseBytes;function jr(t,e){this.eddsa=t,typeof e!="object"&&(e=Vu(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),Ku(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof zu&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}Ai(jr,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Ai(jr,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Ai(jr,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Ai(jr,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});jr.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};jr.prototype.toHex=function(){return Bi.encode(this.toBytes(),"hex").toUpperCase()};To.exports=jr});var Do=K((E3,jo)=>{k();q();var Fu=$s(),Zu=xi(),hn=Lt(),$u=hn.assert,No=hn.parseBytes,Ho=Co(),Ro=Lo();function Ct(t){if($u(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Ct))return new Ct(t);t=Zu[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=Fu.sha512}jo.exports=Ct;Ct.prototype.sign=function(e,r){e=No(e);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),e),s=this.g.mul(i),o=this.encodePoint(s),c=this.hashInt(o,n.pubBytes(),e).mul(n.priv()),u=i.add(c).umod(this.curve.n);return this.makeSignature({R:s,S:u,Rencoded:o})};Ct.prototype.verify=function(e,r,n){e=No(e),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),e),o=this.g.mul(r.S()),c=r.R().add(i.pub().mul(s));return c.eq(o)};Ct.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return hn.intFromLE(e.digest()).umod(this.curve.n)};Ct.prototype.keyFromPublic=function(e){return Ho.fromPublic(this,e)};Ct.prototype.keyFromSecret=function(e){return Ho.fromSecret(this,e)};Ct.prototype.makeSignature=function(e){return e instanceof Ro?e:new Ro(this,e)};Ct.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};Ct.prototype.decodePoint=function(e){e=hn.parseBytes(e);var r=e.length-1,n=e.slice(0,r).concat(e[r]&-129),i=(e[r]&128)!==0,s=hn.intFromLE(n);return this.curve.pointFromY(s,i)};Ct.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Ct.prototype.decodeInt=function(e){return hn.intFromLE(e)};Ct.prototype.isPoint=function(e){return e instanceof this.pointClass}});var bn=K(Ut=>{k();q();Object.defineProperty(Ut,"__esModule",{value:!0});Ut.utils=Ut.curves=Ut.curve=Ut.eddsa=Ut.ec=void 0;var Wu=ja();Ut.curve=Wu;var Xu=xi();Ut.curves=Xu;var Gu=Po();Ut.ec=Gu;var Yu=Do();Ut.eddsa=Yu;var Ju=Lt();Ut.utils=Ju});var Ko=K((Uo,zo)=>{k();q();Object.defineProperty(Uo,"__esModule",{value:!0});var Qu=bn(),Yt=new Qu.ec("secp256k1"),ee=Yt.curve,he=Ot();function el(t,e){let r=new he(e);if(r.cmp(ee.p)>=0)return null;r=r.toRed(ee.red);let n=r.redSqr().redIMul(r).redIAdd(ee.b).redSqrt();t===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(ee.b)).isZero()?Yt.keyPair({pub:{x:r,y:n}}):null}function tl(t,e,r){let n=new he(e),i=new he(r);if(n.cmp(ee.p)>=0||i.cmp(ee.p)>=0||(n=n.toRed(ee.red),i=i.toRed(ee.red),(t===6||t===7)&&i.isOdd()!==(t===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(ee.b)).isZero()?Yt.keyPair({pub:{x:n,y:i}}):null}function Br(t){let e=t[0];switch(e){case 2:case 3:return t.length!==33?null:el(e,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:tl(e,t.subarray(1,33),t.subarray(33,65));default:return null}}zo.exports={contextRandomize(){return 0},privateKeyVerify(t){let e=new he(t);return e.cmp(ee.n)<0&&!e.isZero()},privateKeyNegate(t){let e=new he(t);return O.Buffer.from(ee.n.sub(e).umod(ee.n).toArray("be",32))},privateKeyTweakAdd(t,e){let r=new he(e);return r.cmp(ee.n)>=0||(r.iadd(new he(t)),r.cmp(ee.n)>=0&&r.isub(ee.n),r.isZero())?null:O.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(t,e){let r=new he(e);return r.cmp(ee.n)>=0||r.isZero()?1:(r.imul(new he(t)),r.cmp(ee.n)>=0&&(r=r.umod(ee.n)),O.Buffer.from(r.toArray("be",32)))},publicKeyVerify(t){let e=Br(t);return e==null?null:e.validate().result},publicKeyCreate(t,e){let r=new he(t);if(r.cmp(ee.n)>=0||r.isZero())return null;let n=Yt.keyFromPrivate(t,null).getPublic();return O.Buffer.from(n.encode(null,e))},publicKeyConvert(t,e){let n=Br(t).getPublic();return O.Buffer.from(n.encode(null,e))},publicKeyNegate(t,e){let r=Br(t);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),O.Buffer.from(n.encode(null,e))},publicKeyCombine(t,e){let r=new Array(t.length);for(let i=0;i<t.length;++i)if(r[i]=Br(t[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:O.Buffer.from(n.encode(null,e))},publicKeyTweakAdd(t,e,r){let n=Br(t);if(n===null||new he(e).cmp(ee.n)>=0)return null;let s=n.getPublic().add(ee.g.mul(e));return s.isInfinity()?null:O.Buffer.from(s.encode(null,r))},publicKeyTweakMul(t,e,r){let n=Br(t);if(n===null)return null;let i=new he(e);if(i.cmp(ee.n)>=0||i.isZero())return null;let s=n.getPublic().mul(e);return O.Buffer.from(s.encode(null,r))},signatureNormalize(t){let e=new he(t.subarray(0,32)),r=new he(t.subarray(32,64));return e.cmp(ee.n)>=0||r.cmp(ee.n)>=0?null:(r.cmp(Yt.nh)===1&&t.set(ee.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){let r=e.subarray(0,32),n=e.subarray(32,64);if(new he(r).cmp(ee.n)>=0||new he(n).cmp(ee.n)>=0)return 1;let{output:i}=t,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,c=0;for(;o>1&&s[c]===0&&!(s[c+1]&128);--o,++c);if(s=s.subarray(c),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let u=i.subarray(6+33,6+33+33);u[0]=0,u.set(n,1);let h=33,y=0;for(;h>1&&u[y]===0&&!(u[y+1]&128);--h,++y);return u=u.subarray(y),u[0]&128||h>1&&u[0]===0&&!(u[1]&128)?1:(t.outputlen=6+o+h,i[0]=48,i[1]=t.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+o]=2,i[5+o]=u.length,i.set(u,6+o),0)},signatureImport(t,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let r=e[3];if(r===0||5+r>=e.length||e[4+r]!==2)return 1;let n=e[5+r];if(n===0||6+r+n!==e.length||e[4]&128||r>1&&e[4]===0&&!(e[5]&128)||e[r+6]&128||n>1&&e[r+6]===0&&!(e[r+7]&128))return 1;let i=e.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=e.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new he(i);o.cmp(ee.n)>=0&&(o=new he(0));let c=new he(e.subarray(6+r));return c.cmp(ee.n)>=0&&(c=new he(0)),t.set(o.toArrayLike(Uint8Array,"be",32),0),t.set(c.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e){let r=new he(e);return r.cmp(ee.n)>=0||r.isZero()?null:Yt.sign(t,e,{canonical:!0}).toBytes()},ecdsaVerify(t,e,r){let n={r:t.subarray(0,32),s:t.subarray(32,64)},i=new he(n.r),s=new he(n.s);if(i.cmp(ee.n)>=0||s.cmp(ee.n)>=0)return 1;if(s.cmp(Yt.nh)===1||i.isZero()||s.isZero())return 3;let o=Br(r);if(o===null)return 2;let c=o.getPublic();return Yt.verify(e,n,c)},ecdsaRecover(t,e,r,n){let i={r:t.slice(0,32),s:t.slice(32,64)},s=new he(i.r),o=new he(i.s);if(s.cmp(ee.n)>=0||o.cmp(ee.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let c;try{c=Yt.recoverPubKey(r,i,e,null)}catch{return 2}return O.Buffer.from(c.encode(null,n))},ecdh(t,e,r,n,i,s,o){let c=Br(e);if(c===null)return 1;let u=new he(r);if(u.cmp(ee.n)>=0||u.isZero())return 2;let h=c.getPublic().mul(u);if(i===void 0){let y=h.encode(null,!0),p=Yt.hash().update(y).digest();for(let S=0;S<32;++S)t[S]=p[S]}else{s||(s=new Uint8Array(32));let y=h.getX().toArray("be",32);for(let A=0;A<32;++A)s[A]=y[A];o||(o=new Uint8Array(32));let p=h.getY().toArray("be",32);for(let A=0;A<32;++A)o[A]=p[A];let S=i(s,o,n);if(!(S instanceof Uint8Array&&S.length===t.length))return 2;t.set(S)}return 0}}});var Wo=K(lt=>{k();q();var rl=lt&&lt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),nl=lt&&lt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),il=lt&&lt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&rl(e,t,r);return nl(e,t),e};Object.defineProperty(lt,"__esModule",{value:!0});lt.fromSeed=lt.fromPublicKey=lt.fromPrivateKey=lt.fromBase58=lt.tinySecp256k1Interface=void 0;var Xa=il(Ln()),al=ga(),sl=ci(),Fo=(0,al.base58check)(sl.sha256),Zo=Ko(),gt=W0(),fl=X0();function ol(t){return{isPoint:e=>t.publicKeyVerify(e),isPrivate:e=>t.privateKeyVerify(e),pointAddScalar:(e,r,n)=>t.publicKeyTweakAdd(e,r,n),pointFromScalar:(e,r)=>t.publicKeyCreate(e,r),privateAdd:(e,r)=>t.privateKeyTweakAdd(new Uint8Array(e),r),sign:(e,r)=>t.ecdsaSign(e,r),verify:(e,r,n)=>t.ecdsaVerify(n,e,r)}}function cl(t){return{isPoint:e=>t.publicKeyVerify(e),pointCompress:(e,r)=>Uint8Array.from(t.publicKeyConvert(e,r??!0)),isPrivate:e=>t.privateKeyVerify(e),pointFromScalar:(e,r)=>{let n=t.publicKeyCreate(e,r??!0);return n==null?null:Uint8Array.from(n)},sign:(e,r,n)=>Uint8Array.from(t.ecdsaSign(e,r)),verify:(e,r,n,i)=>t.ecdsaVerify(n,e,r)}}var Ar=ol(Zo);lt.tinySecp256k1Interface=cl(Zo);var Ga=gt.BufferN(32),dl=gt.compile({wif:gt.UInt8,bip32:{public:gt.UInt32,private:gt.UInt32}}),Pi={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},Vo=2147483648,ul=Math.pow(2,31)-1;function ll(t){return gt.String(t)&&t.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function hl(t){return gt.UInt32(t)&&t<=ul}var Ei=class{constructor(e,r,n,i,s=0,o=0,c=0){this.__D=e,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=o,this.__PARENT_FINGERPRINT=c,gt(dl,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=O.Buffer.from(Ar.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return O.Buffer.from(Xa.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return Ii(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let e=this.network,r=this.isNeutered()?e.bip32.public:e.bip32.private,n=O.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),Fo.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return fl.encode(this.network.wif,this.privateKey,!0)}derive(e){gt(gt.UInt32,e);let r=e>=Vo,n=O.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(e,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(e,33);let i=Xa.hmacSHA512(this.chainCode,n),s=i.slice(0,32),o=i.slice(32);if(!Ar.isPrivate(s))return this.derive(e+1);let c;if(this.isNeutered()){let u=Ar.pointAddScalar(this.publicKey,s,!0);if(u===null)return this.derive(e+1);c=Ii(u,o,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}else{let u=Ar.privateAdd(this.privateKey,s);if(u==null)return this.derive(e+1);c=Ya(u,o,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}return c}deriveHardened(e){return gt(hl,e),this.derive(e+Vo)}derivePath(e){gt(ll,e);let r=e.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(e){if(!this.privateKey)throw new Error("Missing private key");return Ar.sign(e,this.privateKey)}verify(e,r){return Ar.verify(e,this.publicKey,r)}};function bl(t,e){let r=O.Buffer.from(Fo.decode(t));if(r.length!==78)throw new TypeError("Invalid buffer length");e=e||Pi;let n=r.readUInt32BE(0);if(n!==e.bip32.private&&n!==e.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let o=r.readUInt32BE(9);if(i===0&&o!==0)throw new TypeError("Invalid index");let c=r.slice(13,45),u;if(n===e.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let h=r.slice(46,78);u=Ya(h,c,e,i,o,s)}else{let h=r.slice(45,78);u=Ii(h,c,e,i,o,s)}return u}lt.fromBase58=bl;function $o(t,e,r){return Ya(t,e,r)}lt.fromPrivateKey=$o;function Ya(t,e,r,n,i,s){if(gt({privateKey:Ga,chainCode:Ga},{privateKey:t,chainCode:e}),r=r||Pi,!Ar.isPrivate(t))throw new TypeError("Private key not in range [1, n)");return new Ei(t,void 0,e,r,n,i,s)}function pl(t,e,r){return Ii(t,e,r)}lt.fromPublicKey=pl;function Ii(t,e,r,n,i,s){if(gt({publicKey:gt.BufferN(33),chainCode:Ga},{publicKey:t,chainCode:e}),r=r||Pi,!Ar.isPoint(t))throw new TypeError("Point is not on the curve");return new Ei(void 0,t,e,r,n,i,s)}function vl(t,e){if(gt(gt.Buffer,t),t.length<16)throw new TypeError("Seed should be at least 128 bits");if(t.length>64)throw new TypeError("Seed should be at most 512 bits");e=e||Pi;let r=Xa.hmacSHA512(O.Buffer.from("Bitcoin seed","utf8"),t),n=r.slice(0,32),i=r.slice(32);return $o(n,i,e)}lt.fromSeed=vl});var Xo=K(ki=>{k();q();Object.defineProperty(ki,"__esModule",{value:!0});ki.fromSeedV2=void 0;var yl=G0();function ml(t,e){return yl.HDKey.fromMasterSeed(new Uint8Array([...t])).derive(e)}ki.fromSeedV2=ml});var Go=K(Tt=>{k();q();Object.defineProperty(Tt,"__esModule",{value:!0});Tt.fromSeedV2=Tt.fromPrivateKey=Tt.fromPublicKey=Tt.fromBase58=Tt.fromSeed=Tt.tinySecp256k1Interface=void 0;var Dn=Wo();Object.defineProperty(Tt,"tinySecp256k1Interface",{enumerable:!0,get:function(){return Dn.tinySecp256k1Interface}});Object.defineProperty(Tt,"fromSeed",{enumerable:!0,get:function(){return Dn.fromSeed}});Object.defineProperty(Tt,"fromBase58",{enumerable:!0,get:function(){return Dn.fromBase58}});Object.defineProperty(Tt,"fromPublicKey",{enumerable:!0,get:function(){return Dn.fromPublicKey}});Object.defineProperty(Tt,"fromPrivateKey",{enumerable:!0,get:function(){return Dn.fromPrivateKey}});var gl=Xo();Object.defineProperty(Tt,"fromSeedV2",{enumerable:!0,get:function(){return gl.fromSeedV2}})});var Yo=K((V3,wl)=>{wl.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var Qa=K(Dr=>{k();q();Object.defineProperty(Dr,"__esModule",{value:!0});Dr._default=Dr.wordlists=void 0;var Ja={};Dr.wordlists=Ja;var qi;Dr._default=qi;try{Dr._default=qi=Yo(),Ja.english=qi,Ja.EN=qi}catch{}});var es=K(xe=>{k();q();Object.defineProperty(xe,"__esModule",{value:!0});xe.wordlists=xe.getDefaultWordlist=xe.setDefaultWordlist=xe.validateMnemonic=xe.generateMnemonic=xe.entropyToMnemonic=xe.mnemonicToEntropy=xe.mnemonicToSeedV2=xe.mnemonicToSeed=xe.mnemonicToSeedSync=void 0;var Qo=Ln(),ec=bi(),Oi=Qa(),tc=In(),_l=Y0(),pn=Oi._default,Jo="Invalid mnemonic",Ur="Invalid entropy",xl="Invalid mnemonic checksum",rc=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function Sl(t,e,r,n,i){let s=(0,ec.pbkdf2)(tc.sha512,t,e,{c:r,dkLen:n});return Promise.resolve(O.Buffer.from(s))}function Un(t){return(t||"").normalize("NFKD")}function nc(t,e,r){for(;t.length<r;)t=e+t;return t}function ic(t){return parseInt(t,2)}function ac(t){return t.map(e=>nc(e.toString(2),"0",8)).join("")}function sc(t){let r=t.length*8/32,n=(0,Qo.sha256)(t);return ac(Array.from(n)).slice(0,r)}function fc(t){return"mnemonic"+(t||"")}function Ml(t,e){let r=O.Buffer.from(Un(t),"utf8"),n=O.Buffer.from(fc(Un(e)),"utf8"),i=(0,ec.pbkdf2)(tc.sha512,r,n,{c:2048,dkLen:64});return O.Buffer.from(i)}xe.mnemonicToSeedSync=Ml;function Bl(t,e){return Promise.resolve().then(()=>{let r=O.Buffer.from(Un(t),"utf8"),n=O.Buffer.from(fc(Un(e)),"utf8");return Sl(r,n,2048,64,"sha512")})}xe.mnemonicToSeed=Bl;async function Al(t,e){let r=t.split(" ").map(s=>pn.indexOf(s)),n=new Uint8Array(new Uint16Array(r).buffer),i=await(0,_l.mnemonicToSeed)(n,e);return O.Buffer.from(i)}xe.mnemonicToSeedV2=Al;function oc(t,e){if(e=e||pn,!e)throw new Error(rc);let r=Un(t).split(" ");if(r.length%3!==0)throw new Error(Jo);let n=r.map(y=>{let p=e.indexOf(y);if(p===-1)throw new Error(Jo);return nc(p.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),o=n.slice(i),c=s.match(/(.{1,8})/g).map(ic);if(c.length<16)throw new Error(Ur);if(c.length>32)throw new Error(Ur);if(c.length%4!==0)throw new Error(Ur);let u=O.Buffer.from(c);if(sc(u)!==o)throw new Error(xl);return u.toString("hex")}xe.mnemonicToEntropy=oc;function cc(t,e){if(O.Buffer.isBuffer(t)||(t=O.Buffer.from(t,"hex")),e=e||pn,!e)throw new Error(rc);if(t.length<16)throw new TypeError(Ur);if(t.length>32)throw new TypeError(Ur);if(t.length%4!==0)throw new TypeError(Ur);let r=ac(Array.from(t)),n=sc(t),o=(r+n).match(/(.{1,11})/g).map(c=>{let u=ic(c);return e[u]});return e[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?o.join("\u3000"):o.join(" ")}xe.entropyToMnemonic=cc;function El(t,e,r){if(t=t||128,t%32!==0)throw new TypeError(Ur);return e=e||Qo.randomBytes,cc(e(t/8),r)}xe.generateMnemonic=El;function Il(t,e){try{oc(t,e)}catch{return!1}return!0}xe.validateMnemonic=Il;function Pl(t){let e=Oi.wordlists[t];if(e)pn=e;else throw new Error('Could not find wordlist for language "'+t+'"')}xe.setDefaultWordlist=Pl;function kl(){if(!pn)throw new Error("No Default Wordlist set");return Object.keys(Oi.wordlists).filter(t=>t==="JA"||t==="EN"?!1:Oi.wordlists[t].every((e,r)=>e===pn[r]))[0]}xe.getDefaultWordlist=kl;var ql=Qa();Object.defineProperty(xe,"wordlists",{enumerable:!0,get:function(){return ql.wordlists}})});var pc=K(re=>{k();q();var Ol=re&&re.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Cl=re&&re.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Tl=re&&re.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ol(e,t,r);return Cl(e,t),e},Ll=re&&re.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(re,"__esModule",{value:!0});re.loadUncompressedPublicKey=re.loadCompressedPublicKey=re.publicKeyConvert=re.publicKeyCreate=re.publicKeyVerify=re.privateKeyVerify=re.loadPublicKey=re.recover=re.verifyWithNoRecovery=re.verify=re.getV=re.sign=void 0;var Rl=Tl(bn()),at=new Rl.ec("secp256k1"),dc=Ln(),vn=Ll(Ot());function Nl(t,e,r=!0){let n=at.sign(Array.from(t),O.Buffer.from(e),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}re.sign=Nl;function Hl(t,e,r,n,i=!0){let s=zn(n);if(s==null)throw new Error("pubkey error");let o=at.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return at.getKeyRecoveryParam(t,{r:e,s:r},o,i)}re.getV=Hl;function jl(t,e,r,n){let i=uc(e,r,t,!0);if(i==null)return!1;let s=lc(n,!0);return s==null?!1:i.equals(s)}re.verify=jl;function Dl(t,e,r){let n=zn(r);if(n==null)throw new Error("pubkey error");let i=at.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,dc.toHex)(e.slice(0,32)),s:(0,dc.toHex)(e.slice(32,64))};return i.verify(t,s)}re.verifyWithNoRecovery=Dl;function uc(t,e,r,n){let i={r:Array.from(t.slice(0,32)),s:Array.from(t.slice(32,64))},s=new vn.default(i.r),o=new vn.default(i.s);if(s.cmp(at.curve.n)>=0||o.cmp(at.curve.n)>=0||s.isZero()||o.isZero())return null;let c;try{c=at.recoverPubKey(Array.from(r),i,e,null)}catch{return null}return O.Buffer.from(c.encode(null,n))}re.recover=uc;function zn(t){let e=O.Buffer.from(t),r=e[0];switch(r){case 2:case 3:return e.length!==33?null:hc(r,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:bc(r,e.subarray(1,33),e.subarray(33,65));default:return null}}re.loadPublicKey=zn;function Ul(t){let e=new vn.default(Array.from(t));return e.cmp(at.curve.n)<0&&!e.isZero()}re.privateKeyVerify=Ul;function zl(t){return zn(t)!==null}re.publicKeyVerify=zl;function Kl(t,e){let r=at.keyFromPrivate(Array.from(t),"bytes").getPublic();return O.Buffer.from(r.encode(null,e))}re.publicKeyCreate=Kl;function lc(t,e){let r=zn(t);if(r==null)return null;let n=at.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return O.Buffer.from(n.encode(null,e))}re.publicKeyConvert=lc;function hc(t,e){let r=new vn.default(Array.from(e));if(r.cmp(at.curve.p)>=0)return null;let n=r.toRed(at.curve.red),i=n.redSqr().redIMul(n).redIAdd(at.curve.b).redSqrt();t===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(at.curve.b)).isZero()?{x:n,y:i}:null}re.loadCompressedPublicKey=hc;function bc(t,e,r){let n=new vn.default(Array.from(e)),i=new vn.default(Array.from(r));if(n.cmp(at.curve.p)>=0||i.cmp(at.curve.p)>=0)return null;let s=n.toRed(at.curve.red),o=i.toRed(at.curve.red);if((t===6||t===7)&&o.isOdd()!==(t===7))return null;let c=s.redSqr().redIMul(s);return o.redSqr().redISub(c.redIAdd(at.curve.b)).isZero()?{x:s,y:o}:null}re.loadUncompressedPublicKey=bc});var Mc=K(te=>{k();q();var Vl=te&&te.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fl=te&&te.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vc=te&&te.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vl(e,t,r);return Fl(e,t),e},Zl=te&&te.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(te,"__esModule",{value:!0});te.ed25519_getDerivedPrivateKey=te.isValidPath=te.ed25519_getRandomPrivateKey=te.ed25519SignTest=te.fromSecret=te.fromSeed=te.privateKeyVerify=te.publicKeyVerify=te.publicKeyCreate=te.verify=te.sign=te.ed25519MulBase=void 0;var yc=vc(bn()),Ft=Ln(),$l=Zl(Ot()),Wl=es(),ts=vc(Ws()),Xl=In();ts.utils.sha512Sync=(...t)=>(0,Xl.sha512)(ts.utils.concatBytes(...t));var Er=new yc.eddsa("ed25519"),mc=Er.curve;function Gl(t){let e=Er.curve.g;return Er.encodePoint(e.mul(yc.utils.intFromLE(t)))}te.ed25519MulBase=Gl;function gc(t,e){let r=e;r.length==64&&(r=r.slice(0,32));let n=ts.sync.sign(t,r);return Uint8Array.from(n)}te.sign=gc;function wc(t,e,r){return Er.keyFromPublic(Array.from(r)).verify(Array.from(t),Array.from(e))}te.verify=wc;function Ci(t){let e=t;e.length==64&&(e=e.slice(0,32));let n=Er.keyFromSecret(Array.from(e)).getPublic();if(t.length==64&&!Yl(t.slice(32,64),n))throw new Error("invalid public key");return Uint8Array.from(n)}te.publicKeyCreate=Ci;function Yl(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Jl(t){let e=Er.decodePoint(Array.from(t));return mc.validate(e)}te.publicKeyVerify=Jl;function _c(t){let e=new $l.default(Array.from(t));return e.cmp(mc.n)<0&&!e.isZero()}te.privateKeyVerify=_c;function Ql(t){let e=Er.keyFromSecret(Array.from(t)),r=Uint8Array.from(e.getPublic());return{publicKey:r,secretKey:(0,Ft.concatBytes)(t,r)}}te.fromSeed=Ql;function eh(t){let e=t.slice(0,32),r=Er.keyFromSecret(Array.from(e));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(e)}}te.fromSecret=eh;function xc(t){let e=(0,Ft.sha256)("ed25519-test"),r=Ci(t),n=gc(e,t);return wc(e,n,r)}te.ed25519SignTest=xc;function th(t,e){for(;;){let r=(0,Ft.randomBytes)(32);if(_c(r)&&xc(r)){let n=Ci(r),i=t?(0,Ft.concatBytes)(r,n):r;return e==="base58"?(0,Ft.toBase58)(i):(0,Ft.toHex)(i)}}}te.ed25519_getRandomPrivateKey=th;var rh=new RegExp("^m(\\/[0-9]+')+$"),Sc=t=>t.replace("'",""),nh=2147483648;function ih(t){let e=(0,Ft.hmacSHA512)("ed25519 seed",t),r=e.slice(0,32),n=e.slice(32);return{key:r,chainCode:n}}function ah({key:t,chainCode:e},r){let n=O.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=O.Buffer.concat([O.Buffer.alloc(1,0),t,n]),s=(0,Ft.hmacSHA512)(e,i),o=s.slice(0,32),c=s.slice(32);return{key:o,chainCode:c}}var sh=t=>rh.test(t)?!t.split("/").slice(1).map(Sc).some(isNaN):!1;te.isValidPath=sh;function fh(t,e,r=nh){if(!(0,te.isValidPath)(t))throw new Error("Invalid derivation path");let{key:n,chainCode:i}=ih(e);return t.split("/").slice(1).map(Sc).map(o=>parseInt(o,10)).reduce((o,c)=>ah(o,c+r),{key:n,chainCode:i})}async function oh(t,e,r,n){let i=await(0,Wl.mnemonicToSeedV2)(t),s=fh(e,i).key,o=Ci(s),c=r?(0,Ft.concatBytes)(s,o):s;return n==="base58"?Promise.resolve((0,Ft.toBase58)(c)):Promise.resolve((0,Ft.toHex)(c))}te.ed25519_getDerivedPrivateKey=oh});var Ic=K(ce=>{k();q();var ch=ce&&ce.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dh=ce&&ce.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),uh=ce&&ce.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ch(e,t,r);return dh(e,t),e},lh=ce&&ce.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ce,"__esModule",{value:!0});ce.loadUncompressedPublicKey=ce.loadCompressedPublicKey=ce.publicKeyConvert=ce.publicKeyCreate=ce.publicKeyVerify=ce.privateKeyVerify=ce.loadPublicKey=ce.recover=ce.verify=ce.sign=void 0;var hh=uh(bn()),Pt=new hh.ec("p256"),yn=lh(Ot());function bh(t,e,r=!0){let n=Pt.sign(Array.from(t),O.Buffer.from(e),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}ce.sign=bh;function ph(t,e,r,n){let i=Bc(e,r,t,!1);return i==null?!1:i.equals(n)}ce.verify=ph;function Bc(t,e,r,n){let i={r:Array.from(t.slice(0,32)),s:Array.from(t.slice(32,64))},s=new yn.default(i.r),o=new yn.default(i.s);if(s.cmp(Pt.curve.n)>=0||o.cmp(Pt.curve.n)>=0||s.isZero()||o.isZero())return null;let c;try{c=Pt.recoverPubKey(Array.from(r),i,e,null)}catch{return null}return O.Buffer.from(c.encode(null,n))}ce.recover=Bc;function rs(t){let e=O.Buffer.from(t),r=e[0];switch(r){case 2:case 3:return e.length!==33?null:Ac(r,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:Ec(r,e.subarray(1,33),e.subarray(33,65));default:return null}}ce.loadPublicKey=rs;function vh(t){let e=new yn.default(Array.from(t));return e.cmp(Pt.curve.n)<0&&!e.isZero()}ce.privateKeyVerify=vh;function yh(t){return rs(t)!==null}ce.publicKeyVerify=yh;function mh(t,e){let r=Pt.keyFromPrivate(Array.from(t),"bytes").getPublic();return O.Buffer.from(r.encode(null,e))}ce.publicKeyCreate=mh;function gh(t,e){let r=rs(t);if(r==null)return null;let n=Pt.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return O.Buffer.from(n.encode(null,e))}ce.publicKeyConvert=gh;function Ac(t,e){let r=new yn.default(Array.from(e));if(r.cmp(Pt.curve.p)>=0)return null;let n=r.toRed(Pt.curve.red),i=n.redSqr().redIMul(n).redIAdd(Pt.curve.b).redSqrt();return t===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}ce.loadCompressedPublicKey=Ac;function Ec(t,e,r){let n=new yn.default(Array.from(e)),i=new yn.default(Array.from(r));if(n.cmp(Pt.curve.p)>=0||i.cmp(Pt.curve.p)>=0)return null;let s=n.toRed(Pt.curve.red),o=i.toRed(Pt.curve.red);if((t===6||t===7)&&o.isOdd()!==(t===7))return null;let c=s.redSqr().redIMul(s);return o.redSqr().redISub(c.redIAdd(Pt.curve.b)).isZero()?{x:s,y:o}:null}ce.loadUncompressedPublicKey=Ec});var dr=K(G=>{k();q();Object.defineProperty(G,"__esModule",{value:!0});G.validateObject=G.createHmacDrbg=G.bitMask=G.bitSet=G.bitGet=G.bitLen=G.utf8ToBytes=G.equalBytes=G.concatBytes=G.ensureBytes=G.numberToVarBytesBE=G.numberToBytesLE=G.numberToBytesBE=G.bytesToNumberLE=G.bytesToNumberBE=G.hexToBytes=G.hexToNumber=G.numberToHexUnpadded=G.bytesToHex=void 0;var kc=BigInt(0),Ti=BigInt(1),wh=BigInt(2),Li=t=>t instanceof Uint8Array,_h=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function is(t){if(!Li(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=_h[t[r]];return e}G.bytesToHex=is;function qc(t){let e=t.toString(16);return e.length&1?`0${e}`:e}G.numberToHexUnpadded=qc;function as(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}G.hexToNumber=as;function Ri(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(t.length%2)throw new Error("hex string is invalid: unpadded "+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");e[r]=s}return e}G.hexToBytes=Ri;function xh(t){return as(is(t))}G.bytesToNumberBE=xh;function Sh(t){if(!Li(t))throw new Error("Uint8Array expected");return as(is(Uint8Array.from(t).reverse()))}G.bytesToNumberLE=Sh;var Mh=(t,e)=>Ri(t.toString(16).padStart(e*2,"0"));G.numberToBytesBE=Mh;var Bh=(t,e)=>(0,G.numberToBytesBE)(t,e).reverse();G.numberToBytesLE=Bh;var Ah=t=>Ri(qc(t));G.numberToVarBytesBE=Ah;function Eh(t,e,r){let n;if(typeof e=="string")try{n=Ri(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Li(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}G.ensureBytes=Eh;function Oc(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Li(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}G.concatBytes=Oc;function Ih(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}G.equalBytes=Ih;function Ph(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}G.utf8ToBytes=Ph;function kh(t){let e;for(e=0;t>kc;t>>=Ti,e+=1);return e}G.bitLen=kh;var qh=(t,e)=>t>>BigInt(e)&Ti;G.bitGet=qh;var Oh=(t,e,r)=>t|(r?Ti:kc)<<BigInt(e);G.bitSet=Oh;var Ch=t=>(wh<<BigInt(t-1))-Ti;G.bitMask=Ch;var ns=t=>new Uint8Array(t),Pc=t=>Uint8Array.from(t);function Th(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ns(t),i=ns(t),s=0,o=()=>{n.fill(1),i.fill(0),s=0},c=(...p)=>r(i,n,...p),u=(p=ns())=>{i=c(Pc([0]),p),n=c(),p.length!==0&&(i=c(Pc([1]),p),n=c())},h=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let p=0,S=[];for(;p<e;){n=c();let M=n.slice();S.push(M),p+=n.length}return Oc(...S)};return(p,S)=>{o(),u(p);let M;for(;!(M=S(h()));)u();return o(),M}}G.createHmacDrbg=Th;var Lh={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Rh(t,e,r={}){let n=(i,s,o)=>{let c=Lh[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);let u=t[i];if(!(o&&u===void 0)&&!c(u,t))throw new Error(`Invalid param ${String(i)}=${u} (${typeof u}), expected ${s}`)};for(let[i,s]of Object.entries(e))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return t}G.validateObject=Rh});var zr=K(Q=>{k();q();Object.defineProperty(Q,"__esModule",{value:!0});Q.hashToPrivateScalar=Q.FpSqrtEven=Q.FpSqrtOdd=Q.Field=Q.nLength=Q.FpIsSquare=Q.FpDiv=Q.FpInvertBatch=Q.FpPow=Q.validateField=Q.isNegativeLE=Q.FpSqrt=Q.tonelliShanks=Q.invert=Q.pow2=Q.pow=Q.mod=void 0;var ur=dr(),st=BigInt(0),ye=BigInt(1),Ir=BigInt(2),Nh=BigInt(3),ss=BigInt(4),Cc=BigInt(5),Tc=BigInt(8),Hh=BigInt(9),jh=BigInt(16);function zt(t,e){let r=t%e;return r>=st?r:e+r}Q.mod=zt;function Lc(t,e,r){if(r<=st||e<st)throw new Error("Expected power/modulo > 0");if(r===ye)return st;let n=ye;for(;e>st;)e&ye&&(n=n*t%r),t=t*t%r,e>>=ye;return n}Q.pow=Lc;function Dh(t,e,r){let n=t;for(;e-- >st;)n*=n,n%=r;return n}Q.pow2=Dh;function Ni(t,e){if(t===st||e<=st)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=zt(t,e),n=e,i=st,s=ye,o=ye,c=st;for(;r!==st;){let h=n/r,y=n%r,p=i-o*h,S=s-c*h;n=r,r=y,i=o,s=c,o=p,c=S}if(n!==ye)throw new Error("invert: does not exist");return zt(i,e)}Q.invert=Ni;function Rc(t){let e=(t-ye)/Ir,r,n,i;for(r=t-ye,n=0;r%Ir===st;r/=Ir,n++);for(i=Ir;i<t&&Lc(i,e,t)!==t-ye;i++);if(n===1){let o=(t+ye)/ss;return function(u,h){let y=u.pow(h,o);if(!u.eql(u.sqr(y),h))throw new Error("Cannot find square root");return y}}let s=(r+ye)/Ir;return function(c,u){if(c.pow(u,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let h=n,y=c.pow(c.mul(c.ONE,i),r),p=c.pow(u,s),S=c.pow(u,r);for(;!c.eql(S,c.ONE);){if(c.eql(S,c.ZERO))return c.ZERO;let M=1;for(let x=c.sqr(S);M<h&&!c.eql(x,c.ONE);M++)x=c.sqr(x);let A=c.pow(y,ye<<BigInt(h-M-1));y=c.sqr(A),p=c.mul(p,A),S=c.mul(S,y),h=M}return p}}Q.tonelliShanks=Rc;function Nc(t){if(t%ss===Nh){let e=(t+ye)/ss;return function(n,i){let s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%Tc===Cc){let e=(t-Cc)/Tc;return function(n,i){let s=n.mul(i,Ir),o=n.pow(s,e),c=n.mul(i,o),u=n.mul(n.mul(c,Ir),o),h=n.mul(c,n.sub(u,n.ONE));if(!n.eql(n.sqr(h),i))throw new Error("Cannot find square root");return h}}return t%jh,Rc(t)}Q.FpSqrt=Nc;var Uh=(t,e)=>(zt(t,e)&ye)===ye;Q.isNegativeLE=Uh;var zh=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Kh(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=zh.reduce((n,i)=>(n[i]="function",n),e);return(0,ur.validateObject)(t,r)}Q.validateField=Kh;function Hc(t,e,r){if(r<st)throw new Error("Expected power > 0");if(r===st)return t.ONE;if(r===ye)return e;let n=t.ONE,i=e;for(;r>st;)r&ye&&(n=t.mul(n,i)),i=t.sqr(i),r>>=ye;return n}Q.FpPow=Hc;function jc(t,e){let r=new Array(e.length),n=e.reduce((s,o,c)=>t.is0(o)?s:(r[c]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,c)=>t.is0(o)?s:(r[c]=t.mul(s,r[c]),t.mul(s,o)),i),r}Q.FpInvertBatch=jc;function Vh(t,e,r){return t.mul(e,typeof r=="bigint"?Ni(r,t.ORDER):t.inv(r))}Q.FpDiv=Vh;function Fh(t){let e=(t.ORDER-ye)/Ir;return r=>{let n=t.pow(r,e);return t.eql(n,t.ZERO)||t.eql(n,t.ONE)}}Q.FpIsSquare=Fh;function fs(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}Q.nLength=fs;function Zh(t,e,r=!1,n={}){if(t<=st)throw new Error(`Expected Fp ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:s}=fs(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Nc(t),c=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:(0,ur.bitMask)(i),ZERO:st,ONE:ye,create:u=>zt(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof u}`);return st<=u&&u<t},is0:u=>u===st,isOdd:u=>(u&ye)===ye,neg:u=>zt(-u,t),eql:(u,h)=>u===h,sqr:u=>zt(u*u,t),add:(u,h)=>zt(u+h,t),sub:(u,h)=>zt(u-h,t),mul:(u,h)=>zt(u*h,t),pow:(u,h)=>Hc(c,u,h),div:(u,h)=>zt(u*Ni(h,t),t),sqrN:u=>u*u,addN:(u,h)=>u+h,subN:(u,h)=>u-h,mulN:(u,h)=>u*h,inv:u=>Ni(u,t),sqrt:n.sqrt||(u=>o(c,u)),invertBatch:u=>jc(c,u),cmov:(u,h,y)=>y?h:u,toBytes:u=>r?(0,ur.numberToBytesLE)(u,s):(0,ur.numberToBytesBE)(u,s),fromBytes:u=>{if(u.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${u.length}`);return r?(0,ur.bytesToNumberLE)(u):(0,ur.bytesToNumberBE)(u)}});return Object.freeze(c)}Q.Field=Zh;function $h(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?r:t.neg(r)}Q.FpSqrtOdd=$h;function Wh(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}Q.FpSqrtEven=Wh;function Xh(t,e,r=!1){t=(0,ur.ensureBytes)("privateHash",t);let n=t.length,i=fs(e).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,ur.bytesToNumberLE)(t):(0,ur.bytesToNumberBE)(t);return zt(s,e-ye)+ye}Q.hashToPrivateScalar=Xh});var Uc=K(mn=>{k();q();Object.defineProperty(mn,"__esModule",{value:!0});mn.validateBasic=mn.wNAF=void 0;var Dc=zr(),Gh=dr(),Yh=BigInt(0),os=BigInt(1);function Jh(t,e){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=t.ZERO,c=i;for(;s>Yh;)s&os&&(o=o.add(c)),c=c.double(),s>>=os;return o},precomputeWindow(i,s){let{windows:o,windowSize:c}=n(s),u=[],h=i,y=h;for(let p=0;p<o;p++){y=h,u.push(y);for(let S=1;S<c;S++)y=y.add(h),u.push(y);h=y.double()}return u},wNAF(i,s,o){let{windows:c,windowSize:u}=n(i),h=t.ZERO,y=t.BASE,p=BigInt(2**i-1),S=2**i,M=BigInt(i);for(let A=0;A<c;A++){let x=A*u,I=Number(o&p);o>>=M,I>u&&(I-=S,o+=os);let E=x,C=x+Math.abs(I)-1,P=A%2!==0,T=I<0;I===0?y=y.add(r(P,s[E])):h=h.add(r(T,s[C]))}return{p:h,f:y}},wNAFCached(i,s,o,c){let u=i._WINDOW_SIZE||1,h=s.get(i);return h||(h=this.precomputeWindow(i,u),u!==1&&s.set(i,c(h))),this.wNAF(u,h,o)}}}mn.wNAF=Jh;function Qh(t){return(0,Dc.validateField)(t.Fp),(0,Gh.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Dc.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}mn.validateBasic=Qh});var ji=K(me=>{k();q();var e1=me&&me.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),t1=me&&me.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Kc=me&&me.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&e1(e,t,r);return t1(e,t),e};Object.defineProperty(me,"__esModule",{value:!0});me.mapToCurveSimpleSWU=me.SWUFpSqrtRatio=me.weierstrass=me.weierstrassPoints=me.DER=void 0;var Kn=Kc(zr()),tt=Kc(dr()),Jt=dr(),cs=Uc();function r1(t){let e=(0,cs.validateBasic)(t);tt.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:n1,hexToBytes:i1}=tt;me.DER={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=me.DER;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:n1(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=me.DER,r=typeof t=="string"?i1(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:s}=me.DER._parseInt(r.subarray(2)),{d:o,l:c}=me.DER._parseInt(s);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(t){let e=h=>Number.parseInt(h[0],16)&8?"00"+h:h,r=h=>{let y=h.toString(16);return y.length&1?`0${y}`:y},n=e(r(t.s)),i=e(r(t.r)),s=n.length/2,o=i.length/2,c=r(s),u=r(o);return`30${r(o+s+4)}02${u}${i}02${c}${n}`}};var Zt=BigInt(0),Se=BigInt(1),Pr=BigInt(2),Hi=BigInt(3),zc=BigInt(4);function Vc(t){let e=r1(t),{Fp:r}=e,n=e.toBytes||((A,x,I)=>{let E=x.toAffine();return tt.concatBytes(Uint8Array.from([4]),r.toBytes(E.x),r.toBytes(E.y))}),i=e.fromBytes||(A=>{let x=A.subarray(1),I=r.fromBytes(x.subarray(0,r.BYTES)),E=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:I,y:E}});function s(A){let{a:x,b:I}=e,E=r.sqr(A),C=r.mul(E,A);return r.add(r.add(C,r.mul(A,x)),I)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(A){return typeof A=="bigint"&&Zt<A&&A<e.n}function c(A){if(!o(A))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function u(A){let{allowedPrivateKeyLengths:x,nByteLength:I,wrapPrivateKey:E,n:C}=e;if(x&&typeof A!="bigint"){if(A instanceof Uint8Array&&(A=tt.bytesToHex(A)),typeof A!="string"||!x.includes(A.length))throw new Error("Invalid key");A=A.padStart(I*2,"0")}let P;try{P=typeof A=="bigint"?A:tt.bytesToNumberBE((0,Jt.ensureBytes)("private key",A,I))}catch{throw new Error(`private key must be ${I} bytes, hex or bigint, not ${typeof A}`)}return E&&(P=Kn.mod(P,C)),c(P),P}let h=new Map;function y(A){if(!(A instanceof p))throw new Error("ProjectivePoint expected")}class p{constructor(x,I,E){if(this.px=x,this.py=I,this.pz=E,x==null||!r.isValid(x))throw new Error("x required");if(I==null||!r.isValid(I))throw new Error("y required");if(E==null||!r.isValid(E))throw new Error("z required")}static fromAffine(x){let{x:I,y:E}=x||{};if(!x||!r.isValid(I)||!r.isValid(E))throw new Error("invalid affine point");if(x instanceof p)throw new Error("projective point not allowed");let C=P=>r.eql(P,r.ZERO);return C(I)&&C(E)?p.ZERO:new p(I,E,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(x){let I=r.invertBatch(x.map(E=>E.pz));return x.map((E,C)=>E.toAffine(I[C])).map(p.fromAffine)}static fromHex(x){let I=p.fromAffine(i((0,Jt.ensureBytes)("pointHex",x)));return I.assertValidity(),I}static fromPrivateKey(x){return p.BASE.multiply(u(x))}_setWindowSize(x){this._WINDOW_SIZE=x,h.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x,y:I}=this.toAffine();if(!r.isValid(x)||!r.isValid(I))throw new Error("bad point: x or y not FE");let E=r.sqr(I),C=s(x);if(!r.eql(E,C))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:x}=this.toAffine();if(r.isOdd)return!r.isOdd(x);throw new Error("Field doesn't support isOdd")}equals(x){y(x);let{px:I,py:E,pz:C}=this,{px:P,py:T,pz:L}=x,N=r.eql(r.mul(I,L),r.mul(P,C)),D=r.eql(r.mul(E,L),r.mul(T,C));return N&&D}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){let{a:x,b:I}=e,E=r.mul(I,Hi),{px:C,py:P,pz:T}=this,L=r.ZERO,N=r.ZERO,D=r.ZERO,R=r.mul(C,C),$=r.mul(P,P),_=r.mul(T,T),a=r.mul(C,P);return a=r.add(a,a),D=r.mul(C,T),D=r.add(D,D),L=r.mul(x,D),N=r.mul(E,_),N=r.add(L,N),L=r.sub($,N),N=r.add($,N),N=r.mul(L,N),L=r.mul(a,L),D=r.mul(E,D),_=r.mul(x,_),a=r.sub(R,_),a=r.mul(x,a),a=r.add(a,D),D=r.add(R,R),R=r.add(D,R),R=r.add(R,_),R=r.mul(R,a),N=r.add(N,R),_=r.mul(P,T),_=r.add(_,_),R=r.mul(_,a),L=r.sub(L,R),D=r.mul(_,$),D=r.add(D,D),D=r.add(D,D),new p(L,N,D)}add(x){y(x);let{px:I,py:E,pz:C}=this,{px:P,py:T,pz:L}=x,N=r.ZERO,D=r.ZERO,R=r.ZERO,$=e.a,_=r.mul(e.b,Hi),a=r.mul(I,P),d=r.mul(E,T),l=r.mul(C,L),v=r.add(I,E),b=r.add(P,T);v=r.mul(v,b),b=r.add(a,d),v=r.sub(v,b),b=r.add(I,C);let w=r.add(P,L);return b=r.mul(b,w),w=r.add(a,l),b=r.sub(b,w),w=r.add(E,C),N=r.add(T,L),w=r.mul(w,N),N=r.add(d,l),w=r.sub(w,N),R=r.mul($,b),N=r.mul(_,l),R=r.add(N,R),N=r.sub(d,R),R=r.add(d,R),D=r.mul(N,R),d=r.add(a,a),d=r.add(d,a),l=r.mul($,l),b=r.mul(_,b),d=r.add(d,l),l=r.sub(a,l),l=r.mul($,l),b=r.add(b,l),a=r.mul(d,b),D=r.add(D,a),a=r.mul(w,b),N=r.mul(v,N),N=r.sub(N,a),a=r.mul(v,d),R=r.mul(w,R),R=r.add(R,a),new p(N,D,R)}subtract(x){return this.add(x.negate())}is0(){return this.equals(p.ZERO)}wNAF(x){return M.wNAFCached(this,h,x,I=>{let E=r.invertBatch(I.map(C=>C.pz));return I.map((C,P)=>C.toAffine(E[P])).map(p.fromAffine)})}multiplyUnsafe(x){let I=p.ZERO;if(x===Zt)return I;if(c(x),x===Se)return this;let{endo:E}=e;if(!E)return M.unsafeLadder(this,x);let{k1neg:C,k1:P,k2neg:T,k2:L}=E.splitScalar(x),N=I,D=I,R=this;for(;P>Zt||L>Zt;)P&Se&&(N=N.add(R)),L&Se&&(D=D.add(R)),R=R.double(),P>>=Se,L>>=Se;return C&&(N=N.negate()),T&&(D=D.negate()),D=new p(r.mul(D.px,E.beta),D.py,D.pz),N.add(D)}multiply(x){c(x);let I=x,E,C,{endo:P}=e;if(P){let{k1neg:T,k1:L,k2neg:N,k2:D}=P.splitScalar(I),{p:R,f:$}=this.wNAF(L),{p:_,f:a}=this.wNAF(D);R=M.constTimeNegate(T,R),_=M.constTimeNegate(N,_),_=new p(r.mul(_.px,P.beta),_.py,_.pz),E=R.add(_),C=$.add(a)}else{let{p:T,f:L}=this.wNAF(I);E=T,C=L}return p.normalizeZ([E,C])[0]}multiplyAndAddUnsafe(x,I,E){let C=p.BASE,P=(L,N)=>N===Zt||N===Se||!L.equals(C)?L.multiplyUnsafe(N):L.multiply(N),T=P(this,I).add(P(x,E));return T.is0()?void 0:T}toAffine(x){let{px:I,py:E,pz:C}=this,P=this.is0();x==null&&(x=P?r.ONE:r.inv(C));let T=r.mul(I,x),L=r.mul(E,x),N=r.mul(C,x);if(P)return{x:r.ZERO,y:r.ZERO};if(!r.eql(N,r.ONE))throw new Error("invZ was invalid");return{x:T,y:L}}isTorsionFree(){let{h:x,isTorsionFree:I}=e;if(x===Se)return!0;if(I)return I(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:x,clearCofactor:I}=e;return x===Se?this:I?I(p,this):this.multiplyUnsafe(e.h)}toRawBytes(x=!0){return this.assertValidity(),n(p,this,x)}toHex(x=!0){return tt.bytesToHex(this.toRawBytes(x))}}p.BASE=new p(e.Gx,e.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);let S=e.nBitLength,M=(0,cs.wNAF)(p,e.endo?Math.ceil(S/2):S);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:u,weierstrassEquation:s,isWithinCurveOrder:o}}me.weierstrassPoints=Vc;function a1(t){let e=(0,cs.validateBasic)(t);return tt.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function s1(t){let e=a1(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function o(b){return Zt<b&&b<r.ORDER}function c(b){return Kn.mod(b,n)}function u(b){return Kn.invert(b,n)}let{ProjectivePoint:h,normPrivateKeyToScalar:y,weierstrassEquation:p,isWithinCurveOrder:S}=Vc({...e,toBytes(b,w,B){let m=w.toAffine(),f=r.toBytes(m.x),g=tt.concatBytes;return B?g(Uint8Array.from([w.hasEvenY()?2:3]),f):g(Uint8Array.from([4]),f,r.toBytes(m.y))},fromBytes(b){let w=b.length,B=b[0],m=b.subarray(1);if(w===i&&(B===2||B===3)){let f=tt.bytesToNumberBE(m);if(!o(f))throw new Error("Point is not on curve");let g=p(f),H=r.sqrt(g),j=(H&Se)===Se;return(B&1)===1!==j&&(H=r.neg(H)),{x:f,y:H}}else if(w===s&&B===4){let f=r.fromBytes(m.subarray(0,r.BYTES)),g=r.fromBytes(m.subarray(r.BYTES,2*r.BYTES));return{x:f,y:g}}else throw new Error(`Point of length ${w} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),M=b=>tt.bytesToHex(tt.numberToBytesBE(b,e.nByteLength));function A(b){let w=n>>Se;return b>w}function x(b){return A(b)?c(-b):b}let I=(b,w,B)=>tt.bytesToNumberBE(b.slice(w,B));class E{constructor(w,B,m){this.r=w,this.s=B,this.recovery=m,this.assertValidity()}static fromCompact(w){let B=e.nByteLength;return w=(0,Jt.ensureBytes)("compactSignature",w,B*2),new E(I(w,0,B),I(w,B,2*B))}static fromDER(w){let{r:B,s:m}=me.DER.toSig((0,Jt.ensureBytes)("DER",w));return new E(B,m)}assertValidity(){if(!S(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!S(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(w){return new E(this.r,this.s,w)}recoverPublicKey(w){let{r:B,s:m,recovery:f}=this,g=D((0,Jt.ensureBytes)("msgHash",w));if(f==null||![0,1,2,3].includes(f))throw new Error("recovery id invalid");let H=f===2||f===3?B+e.n:B;if(H>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let j=(f&1)===0?"02":"03",V=h.fromHex(j+M(H)),Z=u(H),J=c(-g*Z),ne=c(m*Z),pt=h.BASE.multiplyAndAddUnsafe(V,J,ne);if(!pt)throw new Error("point at infinify");return pt.assertValidity(),pt}hasHighS(){return A(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return tt.hexToBytes(this.toDERHex())}toDERHex(){return me.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return tt.hexToBytes(this.toCompactHex())}toCompactHex(){return M(this.r)+M(this.s)}}let C={isValidPrivateKey(b){try{return y(b),!0}catch{return!1}},normPrivateKeyToScalar:y,randomPrivateKey:()=>{let b=e.randomBytes(r.BYTES+8),w=Kn.hashToPrivateScalar(b,n);return tt.numberToBytesBE(w,e.nByteLength)},precompute(b=8,w=h.BASE){return w._setWindowSize(b),w.multiply(BigInt(3)),w}};function P(b,w=!0){return h.fromPrivateKey(b).toRawBytes(w)}function T(b){let w=b instanceof Uint8Array,B=typeof b=="string",m=(w||B)&&b.length;return w?m===i||m===s:B?m===2*i||m===2*s:b instanceof h}function L(b,w,B=!0){if(T(b))throw new Error("first arg must be private key");if(!T(w))throw new Error("second arg must be public key");return h.fromHex(w).multiply(y(b)).toRawBytes(B)}let N=e.bits2int||function(b){let w=tt.bytesToNumberBE(b),B=b.length*8-e.nBitLength;return B>0?w>>BigInt(B):w},D=e.bits2int_modN||function(b){return c(N(b))},R=tt.bitMask(e.nBitLength);function $(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(Zt<=b&&b<R))throw new Error(`bigint expected < 2^${e.nBitLength}`);return tt.numberToBytesBE(b,e.nByteLength)}function _(b,w,B=a){if(["recovered","canonical"].some(ie=>ie in B))throw new Error("sign() legacy options not supported");let{hash:m,randomBytes:f}=e,{lowS:g,prehash:H,extraEntropy:j}=B;g==null&&(g=!0),b=(0,Jt.ensureBytes)("msgHash",b),H&&(b=(0,Jt.ensureBytes)("prehashed msgHash",m(b)));let V=D(b),Z=y(w),J=[$(Z),$(V)];if(j!=null){let ie=j===!0?f(r.BYTES):j;J.push((0,Jt.ensureBytes)("extraEntropy",ie,r.BYTES))}let ne=tt.concatBytes(...J),pt=V;function oe(ie){let tr=N(ie);if(!S(tr))return;let ge=u(tr),ae=h.BASE.multiply(tr).toAffine(),rr=c(ae.x);if(rr===Zt)return;let be=c(ge*c(pt+rr*Z));if(be===Zt)return;let we=(ae.x===rr?0:2)|Number(ae.y&Se),Bn=be;return g&&A(be)&&(Bn=x(be),we^=1),new E(rr,Bn,we)}return{seed:ne,k2sig:oe}}let a={lowS:e.lowS,prehash:!1},d={lowS:e.lowS,prehash:!1};function l(b,w,B=a){let{seed:m,k2sig:f}=_(b,w,B),g=e;return tt.createHmacDrbg(g.hash.outputLen,g.nByteLength,g.hmac)(m,f)}h.BASE._setWindowSize(8);function v(b,w,B,m=d){let f=b;if(w=(0,Jt.ensureBytes)("msgHash",w),B=(0,Jt.ensureBytes)("publicKey",B),"strict"in m)throw new Error("options.strict was renamed to lowS");let{lowS:g,prehash:H}=m,j,V;try{if(typeof f=="string"||f instanceof Uint8Array)try{j=E.fromDER(f)}catch(ae){if(!(ae instanceof me.DER.Err))throw ae;j=E.fromCompact(f)}else if(typeof f=="object"&&typeof f.r=="bigint"&&typeof f.s=="bigint"){let{r:ae,s:rr}=f;j=new E(ae,rr)}else throw new Error("PARSE");V=h.fromHex(B)}catch(ae){if(ae.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(g&&j.hasHighS())return!1;H&&(w=e.hash(w));let{r:Z,s:J}=j,ne=D(w),pt=u(J),oe=c(ne*pt),ie=c(Z*pt),tr=h.BASE.multiplyAndAddUnsafe(V,oe,ie)?.toAffine();return tr?c(tr.x)===Z:!1}return{CURVE:e,getPublicKey:P,getSharedSecret:L,sign:l,verify:v,ProjectivePoint:h,Signature:E,utils:C}}me.weierstrass=s1;function Fc(t,e){let r=t.ORDER,n=Zt;for(let A=r-Se;A%Pr===Zt;A/=Pr)n+=Se;let i=n,s=Pr<<i-Se-Se,o=s*Pr,c=(r-Se)/o,u=(c-Se)/Pr,h=o-Se,y=s,p=t.pow(e,c),S=t.pow(e,(c+Se)/Pr),M=(A,x)=>{let I=p,E=t.pow(x,h),C=t.sqr(E);C=t.mul(C,x);let P=t.mul(A,C);P=t.pow(P,u),P=t.mul(P,E),E=t.mul(P,x),C=t.mul(P,A);let T=t.mul(C,E);P=t.pow(T,y);let L=t.eql(P,t.ONE);E=t.mul(C,S),P=t.mul(T,I),C=t.cmov(E,C,L),T=t.cmov(P,T,L);for(let N=i;N>Se;N--){let D=N-Pr;D=Pr<<D-Se;let R=t.pow(T,D),$=t.eql(R,t.ONE);E=t.mul(C,I),I=t.mul(I,I),R=t.mul(T,I),C=t.cmov(E,C,$),T=t.cmov(R,T,$)}return{isValid:L,value:C}};if(t.ORDER%zc===Hi){let A=(t.ORDER-Hi)/zc,x=t.sqrt(t.neg(e));M=(I,E)=>{let C=t.sqr(E),P=t.mul(I,E);C=t.mul(C,P);let T=t.pow(C,A);T=t.mul(T,P);let L=t.mul(T,x),N=t.mul(t.sqr(T),E),D=t.eql(N,I),R=t.cmov(L,T,D);return{isValid:D,value:R}}}return M}me.SWUFpSqrtRatio=Fc;function f1(t,e){if(Kn.validateField(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=Fc(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,c,u,h,y,p;i=t.sqr(n),i=t.mul(i,e.Z),s=t.sqr(i),s=t.add(s,i),o=t.add(s,t.ONE),o=t.mul(o,e.B),c=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),c=t.mul(c,e.A),s=t.sqr(o),h=t.sqr(c),u=t.mul(h,e.A),s=t.add(s,u),s=t.mul(s,o),h=t.mul(h,c),u=t.mul(h,e.B),s=t.add(s,u),y=t.mul(i,o);let{isValid:S,value:M}=r(s,h);p=t.mul(i,n),p=t.mul(p,M),y=t.cmov(y,o,S),p=t.cmov(p,M,S);let A=t.isOdd(n)===t.isOdd(p);return p=t.cmov(t.neg(p),p,A),y=t.div(y,c),{x:y,y:p}}}me.mapToCurveSimpleSWU=f1});var Gc=K(Me=>{k();q();Object.defineProperty(Me,"__esModule",{value:!0});Me.createHasher=Me.isogenyMap=Me.hash_to_field=Me.expand_message_xof=Me.expand_message_xmd=Me.isNum=Me.isBytes=Me.strxor=Me.i2osp=Me.validateDST=void 0;var o1=zr(),$t=dr();function Zc(t){if(t instanceof Uint8Array)return t;if(typeof t=="string")return(0,$t.utf8ToBytes)(t);throw new Error("DST must be Uint8Array or string")}Me.validateDST=Zc;var c1=$t.bytesToNumberBE;function lr(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);let r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}Me.i2osp=lr;function $c(t,e){let r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}Me.strxor=$c;function gn(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}Me.isBytes=gn;function Di(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}Me.isNum=Di;function Wc(t,e,r,n){gn(t),gn(e),Di(r),e.length>255&&(e=n((0,$t.concatBytes)((0,$t.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));let{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(o>255)throw new Error("Invalid xmd length");let c=(0,$t.concatBytes)(e,lr(e.length,1)),u=lr(0,s),h=lr(r,2),y=new Array(o),p=n((0,$t.concatBytes)(u,t,h,lr(0,1),c));y[0]=n((0,$t.concatBytes)(p,lr(1,1),c));for(let M=1;M<=o;M++){let A=[$c(p,y[M-1]),lr(M+1,1),c];y[M]=n((0,$t.concatBytes)(...A))}return(0,$t.concatBytes)(...y).slice(0,r)}Me.expand_message_xmd=Wc;function Xc(t,e,r,n,i){if(gn(t),gn(e),Di(r),e.length>255){let s=Math.ceil(2*n/8);e=i.create({dkLen:s}).update((0,$t.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(lr(r,2)).update(e).update(lr(e.length,1)).digest()}Me.expand_message_xof=Xc;function ds(t,e,r){(0,$t.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:o,expand:c,DST:u}=r;gn(t),Di(e);let h=Zc(u),y=n.toString(2).length,p=Math.ceil((y+i)/8),S=e*s*p,M;if(c==="xmd")M=Wc(t,h,S,o);else if(c==="xof")M=Xc(t,h,S,i,o);else if(c==="_internal_pass")M=t;else throw new Error('expand must be "xmd" or "xof"');let A=new Array(e);for(let x=0;x<e;x++){let I=new Array(s);for(let E=0;E<s;E++){let C=p*(E+x*s),P=M.subarray(C,C+p);I[E]=(0,o1.mod)(c1(P),n)}A[x]=I}return A}Me.hash_to_field=ds;function d1(t,e){let r=e.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,o,c,u]=r.map(h=>h.reduce((y,p)=>t.add(t.mul(y,n),p)));return n=t.div(s,o),i=t.mul(i,t.div(c,u)),{x:n,y:i}}}Me.isogenyMap=d1;function u1(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=ds(n,2,{...r,DST:r.DST,...i}),o=t.fromAffine(e(s[0])),c=t.fromAffine(e(s[1])),u=o.add(c).clearCofactor();return u.assertValidity(),u},encodeToCurve(n,i){let s=ds(n,1,{...r,DST:r.encodeDST,...i}),o=t.fromAffine(e(s[0])).clearCofactor();return o.assertValidity(),o}}}Me.createHasher=u1});var us=K(wn=>{k();q();Object.defineProperty(wn,"__esModule",{value:!0});wn.createCurve=wn.getHash=void 0;var l1=Cn(),Yc=vt(),h1=ji();function Jc(t){return{hash:t,hmac:(e,...r)=>(0,l1.hmac)(t,e,(0,Yc.concatBytes)(...r)),randomBytes:Yc.randomBytes}}wn.getHash=Jc;function b1(t,e){let r=n=>(0,h1.weierstrass)({...t,...Jc(n)});return Object.freeze({...r(e),create:r})}wn.createCurve=b1});var o0=K(rt=>{k();q();var p1=rt&&rt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),v1=rt&&rt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),y1=rt&&rt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&p1(e,t,r);return v1(e,t),e},ls;Object.defineProperty(rt,"__esModule",{value:!0});rt.encodeToCurve=rt.hashToCurve=rt.schnorr=rt.secp256k1=void 0;var Ui=Wr(),m1=vt(),ht=zr(),g1=ji(),xt=dr(),t0=y1(Gc()),w1=us(),Fi=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),zi=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),r0=BigInt(1),Ki=BigInt(2),Qc=(t,e)=>(t+e/Ki)/e;function n0(t){let e=Fi,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),c=BigInt(44),u=BigInt(88),h=t*t*t%e,y=h*h*t%e,p=(0,ht.pow2)(y,r,e)*y%e,S=(0,ht.pow2)(p,r,e)*y%e,M=(0,ht.pow2)(S,Ki,e)*h%e,A=(0,ht.pow2)(M,i,e)*M%e,x=(0,ht.pow2)(A,s,e)*A%e,I=(0,ht.pow2)(x,c,e)*x%e,E=(0,ht.pow2)(I,u,e)*I%e,C=(0,ht.pow2)(E,c,e)*x%e,P=(0,ht.pow2)(C,r,e)*y%e,T=(0,ht.pow2)(P,o,e)*A%e,L=(0,ht.pow2)(T,n,e)*h%e,N=(0,ht.pow2)(L,Ki,e);if(!kr.eql(kr.sqr(N),t))throw new Error("Cannot find square root");return N}var kr=(0,ht.Field)(Fi,void 0,void 0,{sqrt:n0});rt.secp256k1=(0,w1.createCurve)({a:BigInt(0),b:BigInt(7),Fp:kr,n:zi,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=zi,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-r0*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),c=Qc(s*t,e),u=Qc(-n*t,e),h=(0,ht.mod)(t-c*r-u*i,e),y=(0,ht.mod)(-c*n-u*s,e),p=h>o,S=y>o;if(p&&(h=e-h),S&&(y=e-y),h>o||y>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:p,k1:h,k2neg:S,k2:y}}}},Ui.sha256);var Zi=BigInt(0),i0=t=>typeof t=="bigint"&&Zi<t&&t<Fi,_1=t=>typeof t=="bigint"&&Zi<t&&t<zi,e0={};function Vi(t,...e){let r=e0[t];if(r===void 0){let n=(0,Ui.sha256)(Uint8Array.from(t,i=>i.charCodeAt(0)));r=(0,xt.concatBytes)(n,n),e0[t]=r}return(0,Ui.sha256)((0,xt.concatBytes)(r,...e))}var vs=t=>t.toRawBytes(!0).slice(1),bs=t=>(0,xt.numberToBytesBE)(t,32),hs=t=>(0,ht.mod)(t,Fi),Vn=t=>(0,ht.mod)(t,zi),ys=rt.secp256k1.ProjectivePoint,x1=(t,e,r)=>ys.BASE.multiplyAndAddUnsafe(t,e,r);function ps(t){let e=rt.secp256k1.utils.normPrivateKeyToScalar(t),r=ys.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:Vn(-e),bytes:vs(r)}}function a0(t){if(!i0(t))throw new Error("bad x: need 0 < x < p");let e=hs(t*t),r=hs(e*t+BigInt(7)),n=n0(r);n%Ki!==Zi&&(n=hs(-n));let i=new ys(t,n,r0);return i.assertValidity(),i}function s0(...t){return Vn((0,xt.bytesToNumberBE)(Vi("BIP0340/challenge",...t)))}function S1(t){return ps(t).bytes}function M1(t,e,r=(0,m1.randomBytes)(32)){let n=(0,xt.ensureBytes)("message",t),{bytes:i,scalar:s}=ps(e),o=(0,xt.ensureBytes)("auxRand",r,32),c=bs(s^(0,xt.bytesToNumberBE)(Vi("BIP0340/aux",o))),u=Vi("BIP0340/nonce",c,i,n),h=Vn((0,xt.bytesToNumberBE)(u));if(h===Zi)throw new Error("sign failed: k is zero");let{bytes:y,scalar:p}=ps(h),S=s0(y,i,n),M=new Uint8Array(64);if(M.set(y,0),M.set(bs(Vn(p+S*s)),32),!f0(M,n,i))throw new Error("sign: Invalid signature produced");return M}function f0(t,e,r){let n=(0,xt.ensureBytes)("signature",t,64),i=(0,xt.ensureBytes)("message",e),s=(0,xt.ensureBytes)("publicKey",r,32);try{let o=a0((0,xt.bytesToNumberBE)(s)),c=(0,xt.bytesToNumberBE)(n.subarray(0,32));if(!i0(c))return!1;let u=(0,xt.bytesToNumberBE)(n.subarray(32,64));if(!_1(u))return!1;let h=s0(bs(c),vs(o),i),y=x1(o,u,Vn(-h));return!(!y||!y.hasEvenY()||y.toAffine().x!==c)}catch{return!1}}rt.schnorr={getPublicKey:S1,sign:M1,verify:f0,utils:{randomPrivateKey:rt.secp256k1.utils.randomPrivateKey,lift_x:a0,pointToBytes:vs,numberToBytesBE:xt.numberToBytesBE,bytesToNumberBE:xt.bytesToNumberBE,taggedHash:Vi,mod:ht.mod}};var B1=t0.isogenyMap(kr,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),A1=(0,g1.mapToCurveSimpleSWU)(kr,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:kr.create(BigInt("-11"))});ls=t0.createHasher(rt.secp256k1.ProjectivePoint,t=>{let{x:e,y:r}=A1(kr.create(t[0]));return B1(e,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:kr.ORDER,m:1,k:128,expand:"xmd",hash:Ui.sha256}),rt.hashToCurve=ls.hashToCurve,rt.encodeToCurve=ls.encodeToCurve});var u0=K(qr=>{k();q();Object.defineProperty(qr,"__esModule",{value:!0});qr.poseidon=qr.splitConstants=qr.validateOpts=void 0;var c0=zr();function d0(t){let{Fp:e}=t;(0,c0.validateField)(e);for(let u of["t","roundsFull","roundsPartial"])if(typeof t[u]!="number"||!Number.isSafeInteger(t[u]))throw new Error(`Poseidon: invalid param ${u}=${t[u]} (${typeof t[u]})`);if(t.reversePartialPowIdx!==void 0&&typeof t.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${t.reversePartialPowIdx}`);let r=t.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=u=>(0,c0.FpPow)(e,u,n);if(r===3?i=u=>e.mul(e.sqrN(u),u):r===5&&(i=u=>e.mul(e.sqrN(e.sqrN(u)),u)),t.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${t.roundsFull}`);let s=t.roundsFull+t.roundsPartial;if(!Array.isArray(t.roundConstants)||t.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let o=t.roundConstants.map(u=>{if(!Array.isArray(u)||u.length!==t.t)throw new Error(`Poseidon wrong round constants: ${u}`);return u.map(h=>{if(typeof h!="bigint"||!e.isValid(h))throw new Error(`Poseidon wrong round constant=${h}`);return e.create(h)})});if(!Array.isArray(t.mds)||t.mds.length!==t.t)throw new Error("Poseidon: wrong MDS matrix");let c=t.mds.map(u=>{if(!Array.isArray(u)||u.length!==t.t)throw new Error(`Poseidon MDS matrix row: ${u}`);return u.map(h=>{if(typeof h!="bigint")throw new Error(`Poseidon MDS matrix value=${h}`);return e.create(h)})});return Object.freeze({...t,rounds:s,sboxFn:i,roundConstants:o,mds:c})}qr.validateOpts=d0;function E1(t,e){if(typeof e!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(t)||t.length%e)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<t.length;i++)n.push(t[i]),n.length===e&&(r.push(n),n=[]);return r}qr.splitConstants=E1;function I1(t){let{t:e,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=d0(t),o=Math.floor(t.roundsFull/2),c=s?e-1:0,u=(y,p,S)=>(y=y.map((M,A)=>r.add(M,t.roundConstants[S][A])),p?y=y.map(M=>i(M)):y[c]=i(y[c]),y=t.mds.map(M=>M.reduce((A,x,I)=>r.add(A,r.mulN(x,y[I])),r.ZERO)),y),h=function(p){if(!Array.isArray(p)||p.length!==e)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${e})`);p=p.map(M=>{if(typeof M!="bigint")throw new Error(`Poseidon: wrong value=${M} (${typeof M})`);return r.create(M)});let S=0;for(let M=0;M<o;M++)p=u(p,!0,S++);for(let M=0;M<t.roundsPartial;M++)p=u(p,!1,S++);for(let M=0;M<o;M++)p=u(p,!0,S++);if(S!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${S}, total=${n}`);return p};return h.roundConstants=t.roundConstants,h}qr.poseidon=I1});var M0=K(z=>{k();q();var P1=z&&z.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),k1=z&&z.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),q1=z&&z.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&P1(e,t,r);return k1(e,t),e};Object.defineProperty(z,"__esModule",{value:!0});z.poseidonHashMany=z.poseidonHashSingle=z.poseidonHashFunc=z.poseidonHash=z.poseidonSmall=z.poseidonCreate=z.poseidonBasic=z._poseidonMDS=z.Fp251=z.Fp253=z.keccak=z.computeHashOnElements=z.hashChain=z.pedersen=z.getAccountPath=z.ethSigToPrivate=z.getStarkKey=z.grindKey=z.utils=z.Signature=z.ProjectivePoint=z.CURVE=z.verify=z.sign=z.getSharedSecret=z.getPublicKey=z._starkCurve=void 0;var O1=ai(),ws=Wr(),C1=vt(),Vr=zr(),T1=u0(),L1=ji(),St=q1(dr()),R1=us(),Wi=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),b0=252;function l0(t){for(;t[0]===0;)t=t.subarray(1);let e=t.length*8-b0,r=St.bytesToNumberBE(t);return e>0?r>>BigInt(e):r}function p0(t){return typeof t=="string"&&(t=xs(t),t.length&1&&(t="0"+t)),St.hexToBytes(t)}var Fr=(0,L1.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,Vr.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:Wi,nBitLength:b0,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,R1.getHash)(ws.sha256),bits2int:l0,bits2int_modN:t=>{let e=St.bytesToNumberBE(t).toString(16);return e.length===63&&(t=p0(e+"0")),(0,Vr.mod)(l0(t),Wi)}});z._starkCurve=Fr;function Kr(t){return St.ensureBytes("",typeof t=="string"?p0(t):t)}function _s(t){return St.bytesToHex(Kr(t)).padStart(64,"0")}function v0(t,e=!1){return Fr.getPublicKey(_s(t),e)}z.getPublicKey=v0;function N1(t,e){return Fr.getSharedSecret(_s(t),e)}z.getSharedSecret=N1;function H1(t,e,r){return Fr.sign(Kr(t),_s(e),r)}z.sign=H1;function j1(t,e,r){let n=t instanceof y0?t:Kr(t);return Fr.verify(n,Kr(e),Kr(r))}z.verify=j1;var{CURVE:D1,ProjectivePoint:_n,Signature:y0,utils:U1}=Fr;z.CURVE=D1;z.ProjectivePoint=_n;z.Signature=y0;z.utils=U1;function m0(t){return`0x${St.bytesToHex(t.subarray(1)).replace(/^0+/gm,"")}`}function xs(t){return t.replace(/^0x/i,"")}function z1(t){return`0x${t.toString(16)}`}function g0(t){let e=Kr(t),r=2n**256n,n=r-(0,Vr.mod)(r,Wi);for(let i=0;;i++){let s=ms(St.concatBytes(e,St.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,Vr.mod)(s,Wi).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}z.grindKey=g0;function K1(t){return m0(v0(t,!0))}z.getStarkKey=K1;function V1(t){if(t=xs(t),t.length!==130)throw new Error("Wrong ethereum signature");return g0(t.substring(0,64))}z.ethSigToPrivate=V1;var F1=2n**31n-1n,$i=t=>Number(t&F1);function Z1(t,e,r,n){let i=$i(ms(t)),s=$i(ms(e)),o=St.hexToNumber(xs(r));return`m/2645'/${i}'/${s}'/${$i(o)}'/${$i(o>>31n)}'/${n}`}z.getAccountPath=Z1;var Fn=[new _n(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new _n(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new _n(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new _n(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new _n(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function w0(t,e){let r=[],n=t;for(let i=0;i<248;i++)r.push(n),n=n.double();n=e;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var $1=w0(Fn[1],Fn[2]),W1=w0(Fn[3],Fn[4]);function _0(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"){if(!Number.isSafeInteger(t))throw new Error(`Invalid pedersenArg: ${t}`);e=BigInt(t)}else e=St.bytesToNumberBE(Kr(t));if(!(0n<=e&&e<Fr.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${e}`);return e}function h0(t,e,r){let n=_0(e);for(let i=0;i<252;i++){let s=r[i];if(s.equals(t))throw new Error("Same point");(n&1n)!==0n&&(t=t.add(s)),n>>=1n}return t}function Ss(t,e){let r=Fn[0];return r=h0(r,t,$1),r=h0(r,e,W1),m0(r.toRawBytes(!0))}z.pedersen=Ss;function X1(t,e=Ss){if(!Array.isArray(t)||t.length<1)throw new Error("data should be array of at least 1 element");return t.length===1?z1(_0(t[0])):Array.from(t).reverse().reduce((r,n)=>e(n,r))}z.hashChain=X1;var G1=(t,e=Ss)=>[0,...t,t.length].reduce((r,n)=>e(r,n));z.computeHashOnElements=G1;var Y1=St.bitMask(250),J1=t=>St.bytesToNumberBE((0,O1.keccak_256)(t))&Y1;z.keccak=J1;var ms=t=>St.bytesToNumberBE((0,ws.sha256)(t));z.Fp253=(0,Vr.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));z.Fp251=(0,Vr.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function gs(t,e,r){let n=t.fromBytes((0,ws.sha256)((0,C1.utf8ToBytes)(`${e}${r}`)));return t.create(n)}function x0(t,e,r,n=0){let i=[],s=[];for(let o=0;o<r;o++)i.push(gs(t,`${e}x`,n*r+o)),s.push(gs(t,`${e}y`,n*r+o));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(o=>s.map(c=>t.inv(t.sub(o,c))))}z._poseidonMDS=x0;var Q1=[[3,1,1],[1,-1,1],[1,1,-2]].map(t=>t.map(BigInt));function Ms(t,e){if((0,Vr.validateField)(t.Fp),!Number.isSafeInteger(t.rate)||!Number.isSafeInteger(t.capacity))throw new Error(`Wrong poseidon opts: ${t}`);let r=t.rate+t.capacity,n=t.roundsFull+t.roundsPartial,i=[];for(let o=0;o<n;o++){let c=[];for(let u=0;u<r;u++)c.push(gs(t.Fp,"Hades",r*o+u));i.push(c)}let s=(0,T1.poseidon)({...t,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:e,roundConstants:i});return s.m=r,s.rate=t.rate,s.capacity=t.capacity,s}z.poseidonBasic=Ms;function eb(t,e=0){let r=t.rate+t.capacity;if(!Number.isSafeInteger(e))throw new Error(`Wrong mdsAttempt=${e}`);return Ms(t,x0(t.Fp,"HadesMDS",r,e))}z.poseidonCreate=eb;z.poseidonSmall=Ms({Fp:z.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},Q1);function S0(t,e,r=z.poseidonSmall){return r([t,e,2n])[0]}z.poseidonHash=S0;function tb(t,e,r=z.poseidonSmall){return St.numberToVarBytesBE(S0(St.bytesToNumberBE(t),St.bytesToNumberBE(e),r))}z.poseidonHashFunc=tb;function rb(t,e=z.poseidonSmall){return e([t,0n,1n])[0]}z.poseidonHashSingle=rb;function nb(t,e=z.poseidonSmall){let{m:r,rate:n}=e;if(!Array.isArray(t))throw new Error("bigint array expected in values");let i=Array.from(t);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let o=0;o<i.length;o+=n){for(let c=0;c<n;c++)s[c]+=i[o+c];s=e(s)}return s[0]}z.poseidonHashMany=nb});var E0=K(Mt=>{k();q();var ib=Mt&&Mt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ab=Mt&&Mt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),B0=Mt&&Mt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ib(e,t,r);return ab(e,t),e};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.bytesToHex=Mt.hexToBytes=Mt.stark=Mt.secp256k1=void 0;Mt.secp256k1=B0(o0());Mt.stark=B0(M0());var A0=dr();Object.defineProperty(Mt,"hexToBytes",{enumerable:!0,get:function(){return A0.hexToBytes}});Object.defineProperty(Mt,"bytesToHex",{enumerable:!0,get:function(){return A0.bytesToHex}})});var I0=K(Bt=>{k();q();var sb=Bt&&Bt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),fb=Bt&&Bt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Xi=Bt&&Bt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&sb(e,t,r);return fb(e,t),e};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.schnorr=Bt.p256=Bt.ed25519=Bt.secp256k1=void 0;Bt.secp256k1=Xi(pc());Bt.ed25519=Xi(Mc());Bt.p256=Xi(Ic());Bt.schnorr=Xi(E0())});var Zn=K(nt=>{k();q();var ob=nt&&nt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),cb=nt&&nt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),xn=nt&&nt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ob(e,t,r);return cb(e,t),e};Object.defineProperty(nt,"__esModule",{value:!0});nt.secp256k1=nt.ed25519=nt.signUtil=nt.elliptic=nt.bip39=nt.bip32=void 0;nt.bip32=xn(Go());nt.bip39=xn(es());nt.elliptic=xn(bn());nt.signUtil=xn(I0());nt.ed25519=xn(Ws());nt.secp256k1=xn(J0())});var As=K(At=>{k();q();Object.defineProperty(At,"__esModule",{value:!0});At.decrypt=At.encrypt=At.decodeBytes=At.nsecFromPrvKey=At.npubEncode=At.nsec=At.nostrHdp=void 0;var P0=Zn(),Rt=Wn();typeof crypto<"u"&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle);At.nostrHdp="npub";At.nsec="nsec";function db(t){return k0("npub",t)}At.npubEncode=db;function ub(t){return k0("nsec",t)}At.nsecFromPrvKey=ub;function k0(t,e){return Rt.base.toBech32(t,Rt.base.fromHex(e))}function Bs(t,e){try{let[r,n]=Rt.base.fromBech32(e);if(t!==r)throw new Error("invalid data");return Rt.base.toHex(n,!1)}catch(r){throw console.log(r),r}}At.decodeBytes=Bs;async function lb(t,e,r){if(crypto==null)throw new Error("crypto is null");let n=P0.secp256k1.getSharedSecret(Bs("nsec",t),"02"+Rt.base.stripHexPrefix(e)),i=q0(n),s=Uint8Array.from(Rt.base.randomBytes(16)),o=Rt.base.toUtf8(r),c=await crypto.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["encrypt"]),u=await crypto.subtle.encrypt({name:"AES-CBC",iv:s},c,o),h=Rt.base.toBase64(new Uint8Array(u)),y=Rt.base.toBase64(new Uint8Array(s.buffer));return`${h}?iv=${y}`}At.encrypt=lb;async function hb(t,e,r){let[n,i]=r.split("?iv="),s=P0.secp256k1.getSharedSecret(Bs("nsec",t),"02"+Rt.base.stripHexPrefix(e)),o=q0(s),c=await crypto.subtle.importKey("raw",o,{name:"AES-CBC"},!1,["decrypt"]),u=Rt.base.fromBase64(n),h=Rt.base.fromBase64(i),y=await crypto.subtle.decrypt({name:"AES-CBC",iv:h},c,u);return Rt.base.fromUtf8(new Uint8Array(y))}At.decrypt=hb;function q0(t){return t.slice(1,33)}});var Gi=K(Sn=>{k();q();Object.defineProperty(Sn,"__esModule",{value:!0});Sn.getPublicKey=Sn.generatePrivateKey=void 0;var O0=Zn(),Es=Wn();function bb(){return Es.base.toHex(O0.secp256k1.utils.randomPrivateKey(),!1)}Sn.generatePrivateKey=bb;function pb(t){return Es.base.toHex(O0.secp256k1.schnorr.getPublicKey(Es.base.stripHexPrefix(t)),!1)}Sn.getPublicKey=pb});var Ps=K(de=>{k();q();Object.defineProperty(de,"__esModule",{value:!0});de.getSignature=de.signEvent=de.verifySignature=de.validateEvent=de.getEventHash=de.serializeEvent=de.finishEvent=de.getBlankEvent=de.Kind=de.verifiedSymbol=void 0;var vb=Gi(),yb=Zn(),Mn=Wn(),C0=yb.signUtil.schnorr.secp256k1.schnorr;de.verifiedSymbol=Symbol("verified");var T0;(function(t){t[t.Metadata=0]="Metadata",t[t.Text=1]="Text",t[t.RecommendRelay=2]="RecommendRelay",t[t.Contacts=3]="Contacts",t[t.EncryptedDirectMessage=4]="EncryptedDirectMessage",t[t.EventDeletion=5]="EventDeletion",t[t.Repost=6]="Repost",t[t.Reaction=7]="Reaction",t[t.BadgeAward=8]="BadgeAward",t[t.ChannelCreation=40]="ChannelCreation",t[t.ChannelMetadata=41]="ChannelMetadata",t[t.ChannelMessage=42]="ChannelMessage",t[t.ChannelHideMessage=43]="ChannelHideMessage",t[t.ChannelMuteUser=44]="ChannelMuteUser",t[t.Blank=255]="Blank",t[t.Report=1984]="Report",t[t.ZapRequest=9734]="ZapRequest",t[t.Zap=9735]="Zap",t[t.RelayList=10002]="RelayList",t[t.ClientAuth=22242]="ClientAuth",t[t.NwcRequest=23194]="NwcRequest",t[t.HttpAuth=27235]="HttpAuth",t[t.ProfileBadge=30008]="ProfileBadge",t[t.BadgeDefinition=30009]="BadgeDefinition",t[t.Article=30023]="Article",t[t.FileMetadata=1063]="FileMetadata"})(T0=de.Kind||(de.Kind={}));function mb(t=T0.Blank){return{kind:t,content:"",tags:[],created_at:0}}de.getBlankEvent=mb;function gb(t,e){let r=t;return r.pubkey=(0,vb.getPublicKey)(e),r.id=Yi(r),r.sig=Is(r,e),r[de.verifiedSymbol]=!0,r}de.finishEvent=gb;function L0(t){if(!R0(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}de.serializeEvent=L0;function Yi(t){let e=Mn.base.sha256(Mn.base.toUtf8(L0(t)));return Mn.base.toHex(e,!1)}de.getEventHash=Yi;var wb=t=>t instanceof Object;function R0(t){if(!wb(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let r=t.tags[e];if(!Array.isArray(r))return!1;for(let n=0;n<r.length;n++)if(typeof r[n]=="object")return!1}return!0}de.validateEvent=R0;function _b(t){if(typeof t[de.verifiedSymbol]=="boolean")return t[de.verifiedSymbol];let e=Yi(t);if(e!==t.id)return t[de.verifiedSymbol]=!1;try{return t[de.verifiedSymbol]=C0.verify(t.sig,e,t.pubkey)}catch{return t[de.verifiedSymbol]=!1}}de.verifySignature=_b;function xb(t,e){return console.warn("nostr-tools: `signEvent` is deprecated and will be removed or changed in the future. Please use `getSignature` instead."),Is(t,Mn.base.stripHexPrefix(e))}de.signEvent=xb;function Is(t,e){return Mn.base.toHex(C0.sign(Yi(t),Mn.base.stripHexPrefix(e)),!1)}de.getSignature=Is});var D0=K(wt=>{k();q();var Sb=wt&&wt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Mb=wt&&wt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bb=wt&&wt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Sb(e,t,r);return Mb(e,t),e};Object.defineProperty(wt,"__esModule",{value:!0});wt.NostrAssetsWallet=wt.NewAddressError=wt.CryptTextParams=wt.nipOpType=void 0;var bt=Wn(),N0=Zn(),Qt=As(),$n=Bb(Z0()),H0=Ps(),j0=Gi(),ks;(function(t){t[t.NIP04_Encrypt=1]="NIP04_Encrypt",t[t.NIP04_Decrypt=2]="NIP04_Decrypt"})(ks=wt.nipOpType||(wt.nipOpType={}));var qs=class{constructor(e,r,n){this.type=e,this.pubkey=r,this.text=n}};wt.CryptTextParams=qs;typeof $n<"u"&&!$n.subtle&&$n.webcrypto&&($n.subtle=$n.webcrypto.subtle);wt.NewAddressError="generate address error";var Os=class extends bt.BaseWallet{async getDerivedPath(e){return`m/44'/1237'/${e.index}'/0/0`}getDerivedPrivateKey(e){return N0.bip39.mnemonicToSeedV2(e.mnemonic).then(r=>{let n=N0.bip32.fromSeedV2(r,e.hdPath);return n.privateKey?Promise.resolve((0,Qt.nsecFromPrvKey)(bt.base.toHex(n.privateKey,!1))):Promise.reject(bt.GenPrivateKeyError)}).catch(r=>Promise.reject(bt.GenPrivateKeyError))}getRandomPrivateKey(){try{for(;;){let e=bt.base.randomBytes(32);if((0,bt.secp256k1SignTest)(e))return Promise.resolve((0,Qt.nsecFromPrvKey)(bt.base.toHex(e,!1)))}}catch{}return Promise.reject(bt.GenPrivateKeyError)}async getNewAddress(e){try{let[r,n]=bt.base.fromBech32(e.privateKey);if(!(Qt.nsec==r))return Promise.reject("invalid privateKey");let s=(0,j0.getPublicKey)(bt.base.toHex(n,!1)),o={address:(0,Qt.npubEncode)(s),publicKey:s};return Promise.resolve(o)}catch(r){return Promise.reject(r)}}async validPrivateKey(e){let[r]=bt.base.fromBech32(e.privateKey),i={isValid:Qt.nsec==r,privateKey:e.privateKey};return Promise.resolve(i)}async validAddress(e){var r=!1;try{let[i]=bt.base.fromBech32(e.address);r=Qt.nostrHdp==i}catch(i){console.log(i)}let n={isValid:r,address:e.address};return Promise.resolve(n)}async signCommonMsg(e){let[,r]=bt.base.fromBech32(e.privateKey);return super.signCommonMsg({privateKey:e.privateKey,privateKeyHex:bt.base.toHex(r,!1),message:e.message,signType:bt.SignType.Secp256k1})}async signTransaction(e){try{if(!e.privateKey)return Promise.reject(bt.InvalidPrivateKeyError);if(Object.prototype.toString.call(e.data)==="[object Object]"&&e.data.isCryptText){let i=e.data;switch(i.type){case ks.NIP04_Decrypt:return Promise.resolve(await(0,Qt.decrypt)(e.privateKey,i.pubkey,i.text));case ks.NIP04_Encrypt:return Promise.resolve(await(0,Qt.encrypt)(e.privateKey,i.pubkey,i.text));default:return Promise.reject(bt.NotImplementedError)}}let r=(0,Qt.decodeBytes)(Qt.nsec,e.privateKey),n=e.data;return n.pubkey||(n.pubkey=(0,j0.getPublicKey)(r)),n.id||(n.id=(0,H0.getEventHash)(n)),n.sig=(0,H0.getSignature)(n,r),Promise.resolve(n)}catch{return Promise.reject(bt.SignTxError)}}};wt.NostrAssetsWallet=Os});var Eb=K(er=>{k();q();var Ab=er&&er.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ji=er&&er.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Ab(e,t,r)};Object.defineProperty(er,"__esModule",{value:!0});Ji(D0(),er);Ji(As(),er);Ji(Gi(),er);Ji(Ps(),er)});export{Eb as a};
//# sourceMappingURL=chunk-G3JCFI2N.js.map
