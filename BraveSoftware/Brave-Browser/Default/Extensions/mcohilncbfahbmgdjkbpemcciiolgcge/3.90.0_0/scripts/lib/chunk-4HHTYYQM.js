import{a as Ot,b as as,c as cs,d as us}from"./chunk-AL77NTUI.js";import{t as qi,u as cr}from"./chunk-V3FLECS4.js";import{a as Hi}from"./chunk-BGUOO6AC.js";import{a as W,c as $i,d as Vi,e as Gi}from"./chunk-GUM36CPA.js";import{c as tn,f as Ut,h as rn,o as ee,q as te}from"./chunk-LHDKEQAM.js";var fs=tn((ls,nn)=>{ee();te();(function(o,e){"use strict";function t(m,s){if(!m)throw new Error(s||"Assertion failed")}function n(m,s){m.super_=s;var u=function(){};u.prototype=s.prototype,m.prototype=new u,m.prototype.constructor=m}function r(m,s,u){if(r.isBN(m))return m;this.negative=0,this.words=null,this.length=0,this.red=null,m!==null&&((s==="le"||s==="be")&&(u=s,s=10),this._init(m||0,s||10,u||"be"))}typeof o=="object"?o.exports=r:e.BN=r,r.BN=r,r.wordSize=26;var i;try{typeof window<"u"&&typeof window.Buffer<"u"?i=window.Buffer:i=Vi().Buffer}catch{}r.isBN=function(s){return s instanceof r?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===r.wordSize&&Array.isArray(s.words)},r.max=function(s,u){return s.cmp(u)>0?s:u},r.min=function(s,u){return s.cmp(u)<0?s:u},r.prototype._init=function(s,u,l){if(typeof s=="number")return this._initNumber(s,u,l);if(typeof s=="object")return this._initArray(s,u,l);u==="hex"&&(u=16),t(u===(u|0)&&u>=2&&u<=36),s=s.toString().replace(/\s+/g,"");var h=0;s[0]==="-"&&(h++,this.negative=1),h<s.length&&(u===16?this._parseHex(s,h,l):(this._parseBase(s,u,h),l==="le"&&this._initArray(this.toArray(),u,l)))},r.prototype._initNumber=function(s,u,l){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),l==="le"&&this._initArray(this.toArray(),u,l)},r.prototype._initArray=function(s,u,l){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var h=0;h<this.length;h++)this.words[h]=0;var _,R,S=0;if(l==="be")for(h=s.length-1,_=0;h>=0;h-=3)R=s[h]|s[h-1]<<8|s[h-2]<<16,this.words[_]|=R<<S&67108863,this.words[_+1]=R>>>26-S&67108863,S+=24,S>=26&&(S-=26,_++);else if(l==="le")for(h=0,_=0;h<s.length;h+=3)R=s[h]|s[h+1]<<8|s[h+2]<<16,this.words[_]|=R<<S&67108863,this.words[_+1]=R>>>26-S&67108863,S+=24,S>=26&&(S-=26,_++);return this._strip()};function c(m,s){var u=m.charCodeAt(s);if(u>=48&&u<=57)return u-48;if(u>=65&&u<=70)return u-55;if(u>=97&&u<=102)return u-87;t(!1,"Invalid character in "+m)}function f(m,s,u){var l=c(m,u);return u-1>=s&&(l|=c(m,u-1)<<4),l}r.prototype._parseHex=function(s,u,l){this.length=Math.ceil((s.length-u)/6),this.words=new Array(this.length);for(var h=0;h<this.length;h++)this.words[h]=0;var _=0,R=0,S;if(l==="be")for(h=s.length-1;h>=u;h-=2)S=f(s,u,h)<<_,this.words[R]|=S&67108863,_>=18?(_-=18,R+=1,this.words[R]|=S>>>26):_+=8;else{var d=s.length-u;for(h=d%2===0?u+1:u;h<s.length;h+=2)S=f(s,u,h)<<_,this.words[R]|=S&67108863,_>=18?(_-=18,R+=1,this.words[R]|=S>>>26):_+=8}this._strip()};function p(m,s,u,l){for(var h=0,_=0,R=Math.min(m.length,u),S=s;S<R;S++){var d=m.charCodeAt(S)-48;h*=l,d>=49?_=d-49+10:d>=17?_=d-17+10:_=d,t(d>=0&&_<l,"Invalid character"),h+=_}return h}r.prototype._parseBase=function(s,u,l){this.words=[0],this.length=1;for(var h=0,_=1;_<=67108863;_*=u)h++;h--,_=_/u|0;for(var R=s.length-l,S=R%h,d=Math.min(R,R-S)+l,a=0,y=l;y<d;y+=h)a=p(s,y,y+h,u),this.imuln(_),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(S!==0){var P=1;for(a=p(s,y,s.length,u),y=0;y<S;y++)P*=u;this.imuln(P),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}this._strip()},r.prototype.copy=function(s){s.words=new Array(this.length);for(var u=0;u<this.length;u++)s.words[u]=this.words[u];s.length=this.length,s.negative=this.negative,s.red=this.red};function A(m,s){m.words=s.words,m.length=s.length,m.negative=s.negative,m.red=s.red}if(r.prototype._move=function(s){A(s,this)},r.prototype.clone=function(){var s=new r(null);return this.copy(s),s},r.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},r.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},r.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{r.prototype[Symbol.for("nodejs.util.inspect.custom")]=w}catch{r.prototype.inspect=w}else r.prototype.inspect=w;function w(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var I=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],M=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],E=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];r.prototype.toString=function(s,u){s=s||10,u=u|0||1;var l;if(s===16||s==="hex"){l="";for(var h=0,_=0,R=0;R<this.length;R++){var S=this.words[R],d=((S<<h|_)&16777215).toString(16);_=S>>>24-h&16777215,h+=2,h>=26&&(h-=26,R--),_!==0||R!==this.length-1?l=I[6-d.length]+d+l:l=d+l}for(_!==0&&(l=_.toString(16)+l);l.length%u!==0;)l="0"+l;return this.negative!==0&&(l="-"+l),l}if(s===(s|0)&&s>=2&&s<=36){var a=M[s],y=E[s];l="";var P=this.clone();for(P.negative=0;!P.isZero();){var z=P.modrn(y).toString(s);P=P.idivn(y),P.isZero()?l=z+l:l=I[a-z.length]+z+l}for(this.isZero()&&(l="0"+l);l.length%u!==0;)l="0"+l;return this.negative!==0&&(l="-"+l),l}t(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},r.prototype.toJSON=function(){return this.toString(16,2)},i&&(r.prototype.toBuffer=function(s,u){return this.toArrayLike(i,s,u)}),r.prototype.toArray=function(s,u){return this.toArrayLike(Array,s,u)};var k=function(s,u){return s.allocUnsafe?s.allocUnsafe(u):new s(u)};r.prototype.toArrayLike=function(s,u,l){this._strip();var h=this.byteLength(),_=l||Math.max(1,h);t(h<=_,"byte array longer than desired length"),t(_>0,"Requested array length <= 0");var R=k(s,_),S=u==="le"?"LE":"BE";return this["_toArrayLike"+S](R,h),R},r.prototype._toArrayLikeLE=function(s,u){for(var l=0,h=0,_=0,R=0;_<this.length;_++){var S=this.words[_]<<R|h;s[l++]=S&255,l<s.length&&(s[l++]=S>>8&255),l<s.length&&(s[l++]=S>>16&255),R===6?(l<s.length&&(s[l++]=S>>24&255),h=0,R=0):(h=S>>>24,R+=2)}if(l<s.length)for(s[l++]=h;l<s.length;)s[l++]=0},r.prototype._toArrayLikeBE=function(s,u){for(var l=s.length-1,h=0,_=0,R=0;_<this.length;_++){var S=this.words[_]<<R|h;s[l--]=S&255,l>=0&&(s[l--]=S>>8&255),l>=0&&(s[l--]=S>>16&255),R===6?(l>=0&&(s[l--]=S>>24&255),h=0,R=0):(h=S>>>24,R+=2)}if(l>=0)for(s[l--]=h;l>=0;)s[l--]=0},Math.clz32?r.prototype._countBits=function(s){return 32-Math.clz32(s)}:r.prototype._countBits=function(s){var u=s,l=0;return u>=4096&&(l+=13,u>>>=13),u>=64&&(l+=7,u>>>=7),u>=8&&(l+=4,u>>>=4),u>=2&&(l+=2,u>>>=2),l+u},r.prototype._zeroBits=function(s){if(s===0)return 26;var u=s,l=0;return(u&8191)===0&&(l+=13,u>>>=13),(u&127)===0&&(l+=7,u>>>=7),(u&15)===0&&(l+=4,u>>>=4),(u&3)===0&&(l+=2,u>>>=2),(u&1)===0&&l++,l},r.prototype.bitLength=function(){var s=this.words[this.length-1],u=this._countBits(s);return(this.length-1)*26+u};function v(m){for(var s=new Array(m.bitLength()),u=0;u<s.length;u++){var l=u/26|0,h=u%26;s[u]=m.words[l]>>>h&1}return s}r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,u=0;u<this.length;u++){var l=this._zeroBits(this.words[u]);if(s+=l,l!==26)break}return s},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},r.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return this.negative!==0},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var u=0;u<s.length;u++)this.words[u]=this.words[u]|s.words[u];return this._strip()},r.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},r.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},r.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},r.prototype.iuand=function(s){var u;this.length>s.length?u=s:u=this;for(var l=0;l<u.length;l++)this.words[l]=this.words[l]&s.words[l];return this.length=u.length,this._strip()},r.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},r.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},r.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},r.prototype.iuxor=function(s){var u,l;this.length>s.length?(u=this,l=s):(u=s,l=this);for(var h=0;h<l.length;h++)this.words[h]=u.words[h]^l.words[h];if(this!==u)for(;h<u.length;h++)this.words[h]=u.words[h];return this.length=u.length,this._strip()},r.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},r.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},r.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},r.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var u=Math.ceil(s/26)|0,l=s%26;this._expand(u),l>0&&u--;for(var h=0;h<u;h++)this.words[h]=~this.words[h]&67108863;return l>0&&(this.words[h]=~this.words[h]&67108863>>26-l),this._strip()},r.prototype.notn=function(s){return this.clone().inotn(s)},r.prototype.setn=function(s,u){t(typeof s=="number"&&s>=0);var l=s/26|0,h=s%26;return this._expand(l+1),u?this.words[l]=this.words[l]|1<<h:this.words[l]=this.words[l]&~(1<<h),this._strip()},r.prototype.iadd=function(s){var u;if(this.negative!==0&&s.negative===0)return this.negative=0,u=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,u=this.isub(s),s.negative=1,u._normSign();var l,h;this.length>s.length?(l=this,h=s):(l=s,h=this);for(var _=0,R=0;R<h.length;R++)u=(l.words[R]|0)+(h.words[R]|0)+_,this.words[R]=u&67108863,_=u>>>26;for(;_!==0&&R<l.length;R++)u=(l.words[R]|0)+_,this.words[R]=u&67108863,_=u>>>26;if(this.length=l.length,_!==0)this.words[this.length]=_,this.length++;else if(l!==this)for(;R<l.length;R++)this.words[R]=l.words[R];return this},r.prototype.add=function(s){var u;return s.negative!==0&&this.negative===0?(s.negative=0,u=this.sub(s),s.negative^=1,u):s.negative===0&&this.negative!==0?(this.negative=0,u=s.sub(this),this.negative=1,u):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},r.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var u=this.iadd(s);return s.negative=1,u._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var l=this.cmp(s);if(l===0)return this.negative=0,this.length=1,this.words[0]=0,this;var h,_;l>0?(h=this,_=s):(h=s,_=this);for(var R=0,S=0;S<_.length;S++)u=(h.words[S]|0)-(_.words[S]|0)+R,R=u>>26,this.words[S]=u&67108863;for(;R!==0&&S<h.length;S++)u=(h.words[S]|0)+R,R=u>>26,this.words[S]=u&67108863;if(R===0&&S<h.length&&h!==this)for(;S<h.length;S++)this.words[S]=h.words[S];return this.length=Math.max(this.length,S),h!==this&&(this.negative=1),this._strip()},r.prototype.sub=function(s){return this.clone().isub(s)};function B(m,s,u){u.negative=s.negative^m.negative;var l=m.length+s.length|0;u.length=l,l=l-1|0;var h=m.words[0]|0,_=s.words[0]|0,R=h*_,S=R&67108863,d=R/67108864|0;u.words[0]=S;for(var a=1;a<l;a++){for(var y=d>>>26,P=d&67108863,z=Math.min(a,s.length-1),K=Math.max(0,a-m.length+1);K<=z;K++){var $=a-K|0;h=m.words[$]|0,_=s.words[K]|0,R=h*_+P,y+=R/67108864|0,P=R&67108863}u.words[a]=P|0,d=y|0}return d!==0?u.words[a]=d|0:u.length--,u._strip()}var U=function(s,u,l){var h=s.words,_=u.words,R=l.words,S=0,d,a,y,P=h[0]|0,z=P&8191,K=P>>>13,$=h[1]|0,Z=$&8191,ne=$>>>13,gt=h[2]|0,se=gt&8191,ce=gt>>>13,Vn=h[3]|0,_e=Vn&8191,ge=Vn>>>13,Gn=h[4]|0,pe=Gn&8191,ye=Gn>>>13,Hn=h[5]|0,me=Hn&8191,Re=Hn>>>13,qn=h[6]|0,Se=qn&8191,be=qn>>>13,Yn=h[7]|0,Ae=Yn&8191,Ee=Yn>>>13,Xn=h[8]|0,Ie=Xn&8191,we=Xn>>>13,jn=h[9]|0,Oe=jn&8191,ve=jn>>>13,Jn=_[0]|0,ke=Jn&8191,Ne=Jn>>>13,Zn=_[1]|0,Te=Zn&8191,Le=Zn>>>13,Qn=_[2]|0,Ce=Qn&8191,xe=Qn>>>13,es=_[3]|0,Be=es&8191,Me=es>>>13,ts=_[4]|0,Pe=ts&8191,De=ts>>>13,rs=_[5]|0,Ue=rs&8191,ze=rs>>>13,ns=_[6]|0,Ke=ns&8191,Fe=ns>>>13,ss=_[7]|0,We=ss&8191,$e=ss>>>13,is=_[8]|0,Ve=is&8191,Ge=is>>>13,os=_[9]|0,He=os&8191,qe=os>>>13;l.negative=s.negative^u.negative,l.length=19,d=Math.imul(z,ke),a=Math.imul(z,Ne),a=a+Math.imul(K,ke)|0,y=Math.imul(K,Ne);var Pr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Pr>>>26)|0,Pr&=67108863,d=Math.imul(Z,ke),a=Math.imul(Z,Ne),a=a+Math.imul(ne,ke)|0,y=Math.imul(ne,Ne),d=d+Math.imul(z,Te)|0,a=a+Math.imul(z,Le)|0,a=a+Math.imul(K,Te)|0,y=y+Math.imul(K,Le)|0;var Dr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Dr>>>26)|0,Dr&=67108863,d=Math.imul(se,ke),a=Math.imul(se,Ne),a=a+Math.imul(ce,ke)|0,y=Math.imul(ce,Ne),d=d+Math.imul(Z,Te)|0,a=a+Math.imul(Z,Le)|0,a=a+Math.imul(ne,Te)|0,y=y+Math.imul(ne,Le)|0,d=d+Math.imul(z,Ce)|0,a=a+Math.imul(z,xe)|0,a=a+Math.imul(K,Ce)|0,y=y+Math.imul(K,xe)|0;var Ur=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Ur>>>26)|0,Ur&=67108863,d=Math.imul(_e,ke),a=Math.imul(_e,Ne),a=a+Math.imul(ge,ke)|0,y=Math.imul(ge,Ne),d=d+Math.imul(se,Te)|0,a=a+Math.imul(se,Le)|0,a=a+Math.imul(ce,Te)|0,y=y+Math.imul(ce,Le)|0,d=d+Math.imul(Z,Ce)|0,a=a+Math.imul(Z,xe)|0,a=a+Math.imul(ne,Ce)|0,y=y+Math.imul(ne,xe)|0,d=d+Math.imul(z,Be)|0,a=a+Math.imul(z,Me)|0,a=a+Math.imul(K,Be)|0,y=y+Math.imul(K,Me)|0;var zr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(zr>>>26)|0,zr&=67108863,d=Math.imul(pe,ke),a=Math.imul(pe,Ne),a=a+Math.imul(ye,ke)|0,y=Math.imul(ye,Ne),d=d+Math.imul(_e,Te)|0,a=a+Math.imul(_e,Le)|0,a=a+Math.imul(ge,Te)|0,y=y+Math.imul(ge,Le)|0,d=d+Math.imul(se,Ce)|0,a=a+Math.imul(se,xe)|0,a=a+Math.imul(ce,Ce)|0,y=y+Math.imul(ce,xe)|0,d=d+Math.imul(Z,Be)|0,a=a+Math.imul(Z,Me)|0,a=a+Math.imul(ne,Be)|0,y=y+Math.imul(ne,Me)|0,d=d+Math.imul(z,Pe)|0,a=a+Math.imul(z,De)|0,a=a+Math.imul(K,Pe)|0,y=y+Math.imul(K,De)|0;var Kr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Kr>>>26)|0,Kr&=67108863,d=Math.imul(me,ke),a=Math.imul(me,Ne),a=a+Math.imul(Re,ke)|0,y=Math.imul(Re,Ne),d=d+Math.imul(pe,Te)|0,a=a+Math.imul(pe,Le)|0,a=a+Math.imul(ye,Te)|0,y=y+Math.imul(ye,Le)|0,d=d+Math.imul(_e,Ce)|0,a=a+Math.imul(_e,xe)|0,a=a+Math.imul(ge,Ce)|0,y=y+Math.imul(ge,xe)|0,d=d+Math.imul(se,Be)|0,a=a+Math.imul(se,Me)|0,a=a+Math.imul(ce,Be)|0,y=y+Math.imul(ce,Me)|0,d=d+Math.imul(Z,Pe)|0,a=a+Math.imul(Z,De)|0,a=a+Math.imul(ne,Pe)|0,y=y+Math.imul(ne,De)|0,d=d+Math.imul(z,Ue)|0,a=a+Math.imul(z,ze)|0,a=a+Math.imul(K,Ue)|0,y=y+Math.imul(K,ze)|0;var Fr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Fr>>>26)|0,Fr&=67108863,d=Math.imul(Se,ke),a=Math.imul(Se,Ne),a=a+Math.imul(be,ke)|0,y=Math.imul(be,Ne),d=d+Math.imul(me,Te)|0,a=a+Math.imul(me,Le)|0,a=a+Math.imul(Re,Te)|0,y=y+Math.imul(Re,Le)|0,d=d+Math.imul(pe,Ce)|0,a=a+Math.imul(pe,xe)|0,a=a+Math.imul(ye,Ce)|0,y=y+Math.imul(ye,xe)|0,d=d+Math.imul(_e,Be)|0,a=a+Math.imul(_e,Me)|0,a=a+Math.imul(ge,Be)|0,y=y+Math.imul(ge,Me)|0,d=d+Math.imul(se,Pe)|0,a=a+Math.imul(se,De)|0,a=a+Math.imul(ce,Pe)|0,y=y+Math.imul(ce,De)|0,d=d+Math.imul(Z,Ue)|0,a=a+Math.imul(Z,ze)|0,a=a+Math.imul(ne,Ue)|0,y=y+Math.imul(ne,ze)|0,d=d+Math.imul(z,Ke)|0,a=a+Math.imul(z,Fe)|0,a=a+Math.imul(K,Ke)|0,y=y+Math.imul(K,Fe)|0;var Wr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Wr>>>26)|0,Wr&=67108863,d=Math.imul(Ae,ke),a=Math.imul(Ae,Ne),a=a+Math.imul(Ee,ke)|0,y=Math.imul(Ee,Ne),d=d+Math.imul(Se,Te)|0,a=a+Math.imul(Se,Le)|0,a=a+Math.imul(be,Te)|0,y=y+Math.imul(be,Le)|0,d=d+Math.imul(me,Ce)|0,a=a+Math.imul(me,xe)|0,a=a+Math.imul(Re,Ce)|0,y=y+Math.imul(Re,xe)|0,d=d+Math.imul(pe,Be)|0,a=a+Math.imul(pe,Me)|0,a=a+Math.imul(ye,Be)|0,y=y+Math.imul(ye,Me)|0,d=d+Math.imul(_e,Pe)|0,a=a+Math.imul(_e,De)|0,a=a+Math.imul(ge,Pe)|0,y=y+Math.imul(ge,De)|0,d=d+Math.imul(se,Ue)|0,a=a+Math.imul(se,ze)|0,a=a+Math.imul(ce,Ue)|0,y=y+Math.imul(ce,ze)|0,d=d+Math.imul(Z,Ke)|0,a=a+Math.imul(Z,Fe)|0,a=a+Math.imul(ne,Ke)|0,y=y+Math.imul(ne,Fe)|0,d=d+Math.imul(z,We)|0,a=a+Math.imul(z,$e)|0,a=a+Math.imul(K,We)|0,y=y+Math.imul(K,$e)|0;var $r=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+($r>>>26)|0,$r&=67108863,d=Math.imul(Ie,ke),a=Math.imul(Ie,Ne),a=a+Math.imul(we,ke)|0,y=Math.imul(we,Ne),d=d+Math.imul(Ae,Te)|0,a=a+Math.imul(Ae,Le)|0,a=a+Math.imul(Ee,Te)|0,y=y+Math.imul(Ee,Le)|0,d=d+Math.imul(Se,Ce)|0,a=a+Math.imul(Se,xe)|0,a=a+Math.imul(be,Ce)|0,y=y+Math.imul(be,xe)|0,d=d+Math.imul(me,Be)|0,a=a+Math.imul(me,Me)|0,a=a+Math.imul(Re,Be)|0,y=y+Math.imul(Re,Me)|0,d=d+Math.imul(pe,Pe)|0,a=a+Math.imul(pe,De)|0,a=a+Math.imul(ye,Pe)|0,y=y+Math.imul(ye,De)|0,d=d+Math.imul(_e,Ue)|0,a=a+Math.imul(_e,ze)|0,a=a+Math.imul(ge,Ue)|0,y=y+Math.imul(ge,ze)|0,d=d+Math.imul(se,Ke)|0,a=a+Math.imul(se,Fe)|0,a=a+Math.imul(ce,Ke)|0,y=y+Math.imul(ce,Fe)|0,d=d+Math.imul(Z,We)|0,a=a+Math.imul(Z,$e)|0,a=a+Math.imul(ne,We)|0,y=y+Math.imul(ne,$e)|0,d=d+Math.imul(z,Ve)|0,a=a+Math.imul(z,Ge)|0,a=a+Math.imul(K,Ve)|0,y=y+Math.imul(K,Ge)|0;var Vr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Vr>>>26)|0,Vr&=67108863,d=Math.imul(Oe,ke),a=Math.imul(Oe,Ne),a=a+Math.imul(ve,ke)|0,y=Math.imul(ve,Ne),d=d+Math.imul(Ie,Te)|0,a=a+Math.imul(Ie,Le)|0,a=a+Math.imul(we,Te)|0,y=y+Math.imul(we,Le)|0,d=d+Math.imul(Ae,Ce)|0,a=a+Math.imul(Ae,xe)|0,a=a+Math.imul(Ee,Ce)|0,y=y+Math.imul(Ee,xe)|0,d=d+Math.imul(Se,Be)|0,a=a+Math.imul(Se,Me)|0,a=a+Math.imul(be,Be)|0,y=y+Math.imul(be,Me)|0,d=d+Math.imul(me,Pe)|0,a=a+Math.imul(me,De)|0,a=a+Math.imul(Re,Pe)|0,y=y+Math.imul(Re,De)|0,d=d+Math.imul(pe,Ue)|0,a=a+Math.imul(pe,ze)|0,a=a+Math.imul(ye,Ue)|0,y=y+Math.imul(ye,ze)|0,d=d+Math.imul(_e,Ke)|0,a=a+Math.imul(_e,Fe)|0,a=a+Math.imul(ge,Ke)|0,y=y+Math.imul(ge,Fe)|0,d=d+Math.imul(se,We)|0,a=a+Math.imul(se,$e)|0,a=a+Math.imul(ce,We)|0,y=y+Math.imul(ce,$e)|0,d=d+Math.imul(Z,Ve)|0,a=a+Math.imul(Z,Ge)|0,a=a+Math.imul(ne,Ve)|0,y=y+Math.imul(ne,Ge)|0,d=d+Math.imul(z,He)|0,a=a+Math.imul(z,qe)|0,a=a+Math.imul(K,He)|0,y=y+Math.imul(K,qe)|0;var Gr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Gr>>>26)|0,Gr&=67108863,d=Math.imul(Oe,Te),a=Math.imul(Oe,Le),a=a+Math.imul(ve,Te)|0,y=Math.imul(ve,Le),d=d+Math.imul(Ie,Ce)|0,a=a+Math.imul(Ie,xe)|0,a=a+Math.imul(we,Ce)|0,y=y+Math.imul(we,xe)|0,d=d+Math.imul(Ae,Be)|0,a=a+Math.imul(Ae,Me)|0,a=a+Math.imul(Ee,Be)|0,y=y+Math.imul(Ee,Me)|0,d=d+Math.imul(Se,Pe)|0,a=a+Math.imul(Se,De)|0,a=a+Math.imul(be,Pe)|0,y=y+Math.imul(be,De)|0,d=d+Math.imul(me,Ue)|0,a=a+Math.imul(me,ze)|0,a=a+Math.imul(Re,Ue)|0,y=y+Math.imul(Re,ze)|0,d=d+Math.imul(pe,Ke)|0,a=a+Math.imul(pe,Fe)|0,a=a+Math.imul(ye,Ke)|0,y=y+Math.imul(ye,Fe)|0,d=d+Math.imul(_e,We)|0,a=a+Math.imul(_e,$e)|0,a=a+Math.imul(ge,We)|0,y=y+Math.imul(ge,$e)|0,d=d+Math.imul(se,Ve)|0,a=a+Math.imul(se,Ge)|0,a=a+Math.imul(ce,Ve)|0,y=y+Math.imul(ce,Ge)|0,d=d+Math.imul(Z,He)|0,a=a+Math.imul(Z,qe)|0,a=a+Math.imul(ne,He)|0,y=y+Math.imul(ne,qe)|0;var Hr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Hr>>>26)|0,Hr&=67108863,d=Math.imul(Oe,Ce),a=Math.imul(Oe,xe),a=a+Math.imul(ve,Ce)|0,y=Math.imul(ve,xe),d=d+Math.imul(Ie,Be)|0,a=a+Math.imul(Ie,Me)|0,a=a+Math.imul(we,Be)|0,y=y+Math.imul(we,Me)|0,d=d+Math.imul(Ae,Pe)|0,a=a+Math.imul(Ae,De)|0,a=a+Math.imul(Ee,Pe)|0,y=y+Math.imul(Ee,De)|0,d=d+Math.imul(Se,Ue)|0,a=a+Math.imul(Se,ze)|0,a=a+Math.imul(be,Ue)|0,y=y+Math.imul(be,ze)|0,d=d+Math.imul(me,Ke)|0,a=a+Math.imul(me,Fe)|0,a=a+Math.imul(Re,Ke)|0,y=y+Math.imul(Re,Fe)|0,d=d+Math.imul(pe,We)|0,a=a+Math.imul(pe,$e)|0,a=a+Math.imul(ye,We)|0,y=y+Math.imul(ye,$e)|0,d=d+Math.imul(_e,Ve)|0,a=a+Math.imul(_e,Ge)|0,a=a+Math.imul(ge,Ve)|0,y=y+Math.imul(ge,Ge)|0,d=d+Math.imul(se,He)|0,a=a+Math.imul(se,qe)|0,a=a+Math.imul(ce,He)|0,y=y+Math.imul(ce,qe)|0;var qr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(qr>>>26)|0,qr&=67108863,d=Math.imul(Oe,Be),a=Math.imul(Oe,Me),a=a+Math.imul(ve,Be)|0,y=Math.imul(ve,Me),d=d+Math.imul(Ie,Pe)|0,a=a+Math.imul(Ie,De)|0,a=a+Math.imul(we,Pe)|0,y=y+Math.imul(we,De)|0,d=d+Math.imul(Ae,Ue)|0,a=a+Math.imul(Ae,ze)|0,a=a+Math.imul(Ee,Ue)|0,y=y+Math.imul(Ee,ze)|0,d=d+Math.imul(Se,Ke)|0,a=a+Math.imul(Se,Fe)|0,a=a+Math.imul(be,Ke)|0,y=y+Math.imul(be,Fe)|0,d=d+Math.imul(me,We)|0,a=a+Math.imul(me,$e)|0,a=a+Math.imul(Re,We)|0,y=y+Math.imul(Re,$e)|0,d=d+Math.imul(pe,Ve)|0,a=a+Math.imul(pe,Ge)|0,a=a+Math.imul(ye,Ve)|0,y=y+Math.imul(ye,Ge)|0,d=d+Math.imul(_e,He)|0,a=a+Math.imul(_e,qe)|0,a=a+Math.imul(ge,He)|0,y=y+Math.imul(ge,qe)|0;var Yr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,d=Math.imul(Oe,Pe),a=Math.imul(Oe,De),a=a+Math.imul(ve,Pe)|0,y=Math.imul(ve,De),d=d+Math.imul(Ie,Ue)|0,a=a+Math.imul(Ie,ze)|0,a=a+Math.imul(we,Ue)|0,y=y+Math.imul(we,ze)|0,d=d+Math.imul(Ae,Ke)|0,a=a+Math.imul(Ae,Fe)|0,a=a+Math.imul(Ee,Ke)|0,y=y+Math.imul(Ee,Fe)|0,d=d+Math.imul(Se,We)|0,a=a+Math.imul(Se,$e)|0,a=a+Math.imul(be,We)|0,y=y+Math.imul(be,$e)|0,d=d+Math.imul(me,Ve)|0,a=a+Math.imul(me,Ge)|0,a=a+Math.imul(Re,Ve)|0,y=y+Math.imul(Re,Ge)|0,d=d+Math.imul(pe,He)|0,a=a+Math.imul(pe,qe)|0,a=a+Math.imul(ye,He)|0,y=y+Math.imul(ye,qe)|0;var Xr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Xr>>>26)|0,Xr&=67108863,d=Math.imul(Oe,Ue),a=Math.imul(Oe,ze),a=a+Math.imul(ve,Ue)|0,y=Math.imul(ve,ze),d=d+Math.imul(Ie,Ke)|0,a=a+Math.imul(Ie,Fe)|0,a=a+Math.imul(we,Ke)|0,y=y+Math.imul(we,Fe)|0,d=d+Math.imul(Ae,We)|0,a=a+Math.imul(Ae,$e)|0,a=a+Math.imul(Ee,We)|0,y=y+Math.imul(Ee,$e)|0,d=d+Math.imul(Se,Ve)|0,a=a+Math.imul(Se,Ge)|0,a=a+Math.imul(be,Ve)|0,y=y+Math.imul(be,Ge)|0,d=d+Math.imul(me,He)|0,a=a+Math.imul(me,qe)|0,a=a+Math.imul(Re,He)|0,y=y+Math.imul(Re,qe)|0;var jr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(jr>>>26)|0,jr&=67108863,d=Math.imul(Oe,Ke),a=Math.imul(Oe,Fe),a=a+Math.imul(ve,Ke)|0,y=Math.imul(ve,Fe),d=d+Math.imul(Ie,We)|0,a=a+Math.imul(Ie,$e)|0,a=a+Math.imul(we,We)|0,y=y+Math.imul(we,$e)|0,d=d+Math.imul(Ae,Ve)|0,a=a+Math.imul(Ae,Ge)|0,a=a+Math.imul(Ee,Ve)|0,y=y+Math.imul(Ee,Ge)|0,d=d+Math.imul(Se,He)|0,a=a+Math.imul(Se,qe)|0,a=a+Math.imul(be,He)|0,y=y+Math.imul(be,qe)|0;var Jr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,d=Math.imul(Oe,We),a=Math.imul(Oe,$e),a=a+Math.imul(ve,We)|0,y=Math.imul(ve,$e),d=d+Math.imul(Ie,Ve)|0,a=a+Math.imul(Ie,Ge)|0,a=a+Math.imul(we,Ve)|0,y=y+Math.imul(we,Ge)|0,d=d+Math.imul(Ae,He)|0,a=a+Math.imul(Ae,qe)|0,a=a+Math.imul(Ee,He)|0,y=y+Math.imul(Ee,qe)|0;var Zr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Zr>>>26)|0,Zr&=67108863,d=Math.imul(Oe,Ve),a=Math.imul(Oe,Ge),a=a+Math.imul(ve,Ve)|0,y=Math.imul(ve,Ge),d=d+Math.imul(Ie,He)|0,a=a+Math.imul(Ie,qe)|0,a=a+Math.imul(we,He)|0,y=y+Math.imul(we,qe)|0;var Qr=(S+d|0)+((a&8191)<<13)|0;S=(y+(a>>>13)|0)+(Qr>>>26)|0,Qr&=67108863,d=Math.imul(Oe,He),a=Math.imul(Oe,qe),a=a+Math.imul(ve,He)|0,y=Math.imul(ve,qe);var en=(S+d|0)+((a&8191)<<13)|0;return S=(y+(a>>>13)|0)+(en>>>26)|0,en&=67108863,R[0]=Pr,R[1]=Dr,R[2]=Ur,R[3]=zr,R[4]=Kr,R[5]=Fr,R[6]=Wr,R[7]=$r,R[8]=Vr,R[9]=Gr,R[10]=Hr,R[11]=qr,R[12]=Yr,R[13]=Xr,R[14]=jr,R[15]=Jr,R[16]=Zr,R[17]=Qr,R[18]=en,S!==0&&(R[19]=S,l.length++),l};Math.imul||(U=B);function Y(m,s,u){u.negative=s.negative^m.negative,u.length=m.length+s.length;for(var l=0,h=0,_=0;_<u.length-1;_++){var R=h;h=0;for(var S=l&67108863,d=Math.min(_,s.length-1),a=Math.max(0,_-m.length+1);a<=d;a++){var y=_-a,P=m.words[y]|0,z=s.words[a]|0,K=P*z,$=K&67108863;R=R+(K/67108864|0)|0,$=$+S|0,S=$&67108863,R=R+($>>>26)|0,h+=R>>>26,R&=67108863}u.words[_]=S,l=R,R=h}return l!==0?u.words[_]=l:u.length--,u._strip()}function le(m,s,u){return Y(m,s,u)}r.prototype.mulTo=function(s,u){var l,h=this.length+s.length;return this.length===10&&s.length===10?l=U(this,s,u):h<63?l=B(this,s,u):h<1024?l=Y(this,s,u):l=le(this,s,u),l};function J(m,s){this.x=m,this.y=s}J.prototype.makeRBT=function(s){for(var u=new Array(s),l=r.prototype._countBits(s)-1,h=0;h<s;h++)u[h]=this.revBin(h,l,s);return u},J.prototype.revBin=function(s,u,l){if(s===0||s===l-1)return s;for(var h=0,_=0;_<u;_++)h|=(s&1)<<u-_-1,s>>=1;return h},J.prototype.permute=function(s,u,l,h,_,R){for(var S=0;S<R;S++)h[S]=u[s[S]],_[S]=l[s[S]]},J.prototype.transform=function(s,u,l,h,_,R){this.permute(R,s,u,l,h,_);for(var S=1;S<_;S<<=1)for(var d=S<<1,a=Math.cos(2*Math.PI/d),y=Math.sin(2*Math.PI/d),P=0;P<_;P+=d)for(var z=a,K=y,$=0;$<S;$++){var Z=l[P+$],ne=h[P+$],gt=l[P+$+S],se=h[P+$+S],ce=z*gt-K*se;se=z*se+K*gt,gt=ce,l[P+$]=Z+gt,h[P+$]=ne+se,l[P+$+S]=Z-gt,h[P+$+S]=ne-se,$!==d&&(ce=a*z-y*K,K=a*K+y*z,z=ce)}},J.prototype.guessLen13b=function(s,u){var l=Math.max(u,s)|1,h=l&1,_=0;for(l=l/2|0;l;l=l>>>1)_++;return 1<<_+1+h},J.prototype.conjugate=function(s,u,l){if(!(l<=1))for(var h=0;h<l/2;h++){var _=s[h];s[h]=s[l-h-1],s[l-h-1]=_,_=u[h],u[h]=-u[l-h-1],u[l-h-1]=-_}},J.prototype.normalize13b=function(s,u){for(var l=0,h=0;h<u/2;h++){var _=Math.round(s[2*h+1]/u)*8192+Math.round(s[2*h]/u)+l;s[h]=_&67108863,_<67108864?l=0:l=_/67108864|0}return s},J.prototype.convert13b=function(s,u,l,h){for(var _=0,R=0;R<u;R++)_=_+(s[R]|0),l[2*R]=_&8191,_=_>>>13,l[2*R+1]=_&8191,_=_>>>13;for(R=2*u;R<h;++R)l[R]=0;t(_===0),t((_&-8192)===0)},J.prototype.stub=function(s){for(var u=new Array(s),l=0;l<s;l++)u[l]=0;return u},J.prototype.mulp=function(s,u,l){var h=2*this.guessLen13b(s.length,u.length),_=this.makeRBT(h),R=this.stub(h),S=new Array(h),d=new Array(h),a=new Array(h),y=new Array(h),P=new Array(h),z=new Array(h),K=l.words;K.length=h,this.convert13b(s.words,s.length,S,h),this.convert13b(u.words,u.length,y,h),this.transform(S,R,d,a,h,_),this.transform(y,R,P,z,h,_);for(var $=0;$<h;$++){var Z=d[$]*P[$]-a[$]*z[$];a[$]=d[$]*z[$]+a[$]*P[$],d[$]=Z}return this.conjugate(d,a,h),this.transform(d,a,K,R,h,_),this.conjugate(K,R,h),this.normalize13b(K,h),l.negative=s.negative^u.negative,l.length=s.length+u.length,l._strip()},r.prototype.mul=function(s){var u=new r(null);return u.words=new Array(this.length+s.length),this.mulTo(s,u)},r.prototype.mulf=function(s){var u=new r(null);return u.words=new Array(this.length+s.length),le(this,s,u)},r.prototype.imul=function(s){return this.clone().mulTo(s,this)},r.prototype.imuln=function(s){var u=s<0;u&&(s=-s),t(typeof s=="number"),t(s<67108864);for(var l=0,h=0;h<this.length;h++){var _=(this.words[h]|0)*s,R=(_&67108863)+(l&67108863);l>>=26,l+=_/67108864|0,l+=R>>>26,this.words[h]=R&67108863}return l!==0&&(this.words[h]=l,this.length++),u?this.ineg():this},r.prototype.muln=function(s){return this.clone().imuln(s)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(s){var u=v(s);if(u.length===0)return new r(1);for(var l=this,h=0;h<u.length&&u[h]===0;h++,l=l.sqr());if(++h<u.length)for(var _=l.sqr();h<u.length;h++,_=_.sqr())u[h]!==0&&(l=l.mul(_));return l},r.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var u=s%26,l=(s-u)/26,h=67108863>>>26-u<<26-u,_;if(u!==0){var R=0;for(_=0;_<this.length;_++){var S=this.words[_]&h,d=(this.words[_]|0)-S<<u;this.words[_]=d|R,R=S>>>26-u}R&&(this.words[_]=R,this.length++)}if(l!==0){for(_=this.length-1;_>=0;_--)this.words[_+l]=this.words[_];for(_=0;_<l;_++)this.words[_]=0;this.length+=l}return this._strip()},r.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},r.prototype.iushrn=function(s,u,l){t(typeof s=="number"&&s>=0);var h;u?h=(u-u%26)/26:h=0;var _=s%26,R=Math.min((s-_)/26,this.length),S=67108863^67108863>>>_<<_,d=l;if(h-=R,h=Math.max(0,h),d){for(var a=0;a<R;a++)d.words[a]=this.words[a];d.length=R}if(R!==0)if(this.length>R)for(this.length-=R,a=0;a<this.length;a++)this.words[a]=this.words[a+R];else this.words[0]=0,this.length=1;var y=0;for(a=this.length-1;a>=0&&(y!==0||a>=h);a--){var P=this.words[a]|0;this.words[a]=y<<26-_|P>>>_,y=P&S}return d&&y!==0&&(d.words[d.length++]=y),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},r.prototype.ishrn=function(s,u,l){return t(this.negative===0),this.iushrn(s,u,l)},r.prototype.shln=function(s){return this.clone().ishln(s)},r.prototype.ushln=function(s){return this.clone().iushln(s)},r.prototype.shrn=function(s){return this.clone().ishrn(s)},r.prototype.ushrn=function(s){return this.clone().iushrn(s)},r.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var u=s%26,l=(s-u)/26,h=1<<u;if(this.length<=l)return!1;var _=this.words[l];return!!(_&h)},r.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var u=s%26,l=(s-u)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=l)return this;if(u!==0&&l++,this.length=Math.min(l,this.length),u!==0){var h=67108863^67108863>>>u<<u;this.words[this.length-1]&=h}return this._strip()},r.prototype.maskn=function(s){return this.clone().imaskn(s)},r.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<=s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},r.prototype._iaddn=function(s){this.words[0]+=s;for(var u=0;u<this.length&&this.words[u]>=67108864;u++)this.words[u]-=67108864,u===this.length-1?this.words[u+1]=1:this.words[u+1]++;return this.length=Math.max(this.length,u+1),this},r.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var u=0;u<this.length&&this.words[u]<0;u++)this.words[u]+=67108864,this.words[u+1]-=1;return this._strip()},r.prototype.addn=function(s){return this.clone().iaddn(s)},r.prototype.subn=function(s){return this.clone().isubn(s)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(s,u,l){var h=s.length+l,_;this._expand(h);var R,S=0;for(_=0;_<s.length;_++){R=(this.words[_+l]|0)+S;var d=(s.words[_]|0)*u;R-=d&67108863,S=(R>>26)-(d/67108864|0),this.words[_+l]=R&67108863}for(;_<this.length-l;_++)R=(this.words[_+l]|0)+S,S=R>>26,this.words[_+l]=R&67108863;if(S===0)return this._strip();for(t(S===-1),S=0,_=0;_<this.length;_++)R=-(this.words[_]|0)+S,S=R>>26,this.words[_]=R&67108863;return this.negative=1,this._strip()},r.prototype._wordDiv=function(s,u){var l=this.length-s.length,h=this.clone(),_=s,R=_.words[_.length-1]|0,S=this._countBits(R);l=26-S,l!==0&&(_=_.ushln(l),h.iushln(l),R=_.words[_.length-1]|0);var d=h.length-_.length,a;if(u!=="mod"){a=new r(null),a.length=d+1,a.words=new Array(a.length);for(var y=0;y<a.length;y++)a.words[y]=0}var P=h.clone()._ishlnsubmul(_,1,d);P.negative===0&&(h=P,a&&(a.words[d]=1));for(var z=d-1;z>=0;z--){var K=(h.words[_.length+z]|0)*67108864+(h.words[_.length+z-1]|0);for(K=Math.min(K/R|0,67108863),h._ishlnsubmul(_,K,z);h.negative!==0;)K--,h.negative=0,h._ishlnsubmul(_,1,z),h.isZero()||(h.negative^=1);a&&(a.words[z]=K)}return a&&a._strip(),h._strip(),u!=="div"&&l!==0&&h.iushrn(l),{div:a||null,mod:h}},r.prototype.divmod=function(s,u,l){if(t(!s.isZero()),this.isZero())return{div:new r(0),mod:new r(0)};var h,_,R;return this.negative!==0&&s.negative===0?(R=this.neg().divmod(s,u),u!=="mod"&&(h=R.div.neg()),u!=="div"&&(_=R.mod.neg(),l&&_.negative!==0&&_.iadd(s)),{div:h,mod:_}):this.negative===0&&s.negative!==0?(R=this.divmod(s.neg(),u),u!=="mod"&&(h=R.div.neg()),{div:h,mod:R.mod}):(this.negative&s.negative)!==0?(R=this.neg().divmod(s.neg(),u),u!=="div"&&(_=R.mod.neg(),l&&_.negative!==0&&_.isub(s)),{div:R.div,mod:_}):s.length>this.length||this.cmp(s)<0?{div:new r(0),mod:this}:s.length===1?u==="div"?{div:this.divn(s.words[0]),mod:null}:u==="mod"?{div:null,mod:new r(this.modrn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new r(this.modrn(s.words[0]))}:this._wordDiv(s,u)},r.prototype.div=function(s){return this.divmod(s,"div",!1).div},r.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},r.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},r.prototype.divRound=function(s){var u=this.divmod(s);if(u.mod.isZero())return u.div;var l=u.div.negative!==0?u.mod.isub(s):u.mod,h=s.ushrn(1),_=s.andln(1),R=l.cmp(h);return R<0||_===1&&R===0?u.div:u.div.negative!==0?u.div.isubn(1):u.div.iaddn(1)},r.prototype.modrn=function(s){var u=s<0;u&&(s=-s),t(s<=67108863);for(var l=(1<<26)%s,h=0,_=this.length-1;_>=0;_--)h=(l*h+(this.words[_]|0))%s;return u?-h:h},r.prototype.modn=function(s){return this.modrn(s)},r.prototype.idivn=function(s){var u=s<0;u&&(s=-s),t(s<=67108863);for(var l=0,h=this.length-1;h>=0;h--){var _=(this.words[h]|0)+l*67108864;this.words[h]=_/s|0,l=_%s}return this._strip(),u?this.ineg():this},r.prototype.divn=function(s){return this.clone().idivn(s)},r.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var u=this,l=s.clone();u.negative!==0?u=u.umod(s):u=u.clone();for(var h=new r(1),_=new r(0),R=new r(0),S=new r(1),d=0;u.isEven()&&l.isEven();)u.iushrn(1),l.iushrn(1),++d;for(var a=l.clone(),y=u.clone();!u.isZero();){for(var P=0,z=1;(u.words[0]&z)===0&&P<26;++P,z<<=1);if(P>0)for(u.iushrn(P);P-- >0;)(h.isOdd()||_.isOdd())&&(h.iadd(a),_.isub(y)),h.iushrn(1),_.iushrn(1);for(var K=0,$=1;(l.words[0]&$)===0&&K<26;++K,$<<=1);if(K>0)for(l.iushrn(K);K-- >0;)(R.isOdd()||S.isOdd())&&(R.iadd(a),S.isub(y)),R.iushrn(1),S.iushrn(1);u.cmp(l)>=0?(u.isub(l),h.isub(R),_.isub(S)):(l.isub(u),R.isub(h),S.isub(_))}return{a:R,b:S,gcd:l.iushln(d)}},r.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var u=this,l=s.clone();u.negative!==0?u=u.umod(s):u=u.clone();for(var h=new r(1),_=new r(0),R=l.clone();u.cmpn(1)>0&&l.cmpn(1)>0;){for(var S=0,d=1;(u.words[0]&d)===0&&S<26;++S,d<<=1);if(S>0)for(u.iushrn(S);S-- >0;)h.isOdd()&&h.iadd(R),h.iushrn(1);for(var a=0,y=1;(l.words[0]&y)===0&&a<26;++a,y<<=1);if(a>0)for(l.iushrn(a);a-- >0;)_.isOdd()&&_.iadd(R),_.iushrn(1);u.cmp(l)>=0?(u.isub(l),h.isub(_)):(l.isub(u),_.isub(h))}var P;return u.cmpn(1)===0?P=h:P=_,P.cmpn(0)<0&&P.iadd(s),P},r.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var u=this.clone(),l=s.clone();u.negative=0,l.negative=0;for(var h=0;u.isEven()&&l.isEven();h++)u.iushrn(1),l.iushrn(1);do{for(;u.isEven();)u.iushrn(1);for(;l.isEven();)l.iushrn(1);var _=u.cmp(l);if(_<0){var R=u;u=l,l=R}else if(_===0||l.cmpn(1)===0)break;u.isub(l)}while(!0);return l.iushln(h)},r.prototype.invm=function(s){return this.egcd(s).a.umod(s)},r.prototype.isEven=function(){return(this.words[0]&1)===0},r.prototype.isOdd=function(){return(this.words[0]&1)===1},r.prototype.andln=function(s){return this.words[0]&s},r.prototype.bincn=function(s){t(typeof s=="number");var u=s%26,l=(s-u)/26,h=1<<u;if(this.length<=l)return this._expand(l+1),this.words[l]|=h,this;for(var _=h,R=l;_!==0&&R<this.length;R++){var S=this.words[R]|0;S+=_,_=S>>>26,S&=67108863,this.words[R]=S}return _!==0&&(this.words[R]=_,this.length++),this},r.prototype.isZero=function(){return this.length===1&&this.words[0]===0},r.prototype.cmpn=function(s){var u=s<0;if(this.negative!==0&&!u)return-1;if(this.negative===0&&u)return 1;this._strip();var l;if(this.length>1)l=1;else{u&&(s=-s),t(s<=67108863,"Number is too big");var h=this.words[0]|0;l=h===s?0:h<s?-1:1}return this.negative!==0?-l|0:l},r.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var u=this.ucmp(s);return this.negative!==0?-u|0:u},r.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var u=0,l=this.length-1;l>=0;l--){var h=this.words[l]|0,_=s.words[l]|0;if(h!==_){h<_?u=-1:h>_&&(u=1);break}}return u},r.prototype.gtn=function(s){return this.cmpn(s)===1},r.prototype.gt=function(s){return this.cmp(s)===1},r.prototype.gten=function(s){return this.cmpn(s)>=0},r.prototype.gte=function(s){return this.cmp(s)>=0},r.prototype.ltn=function(s){return this.cmpn(s)===-1},r.prototype.lt=function(s){return this.cmp(s)===-1},r.prototype.lten=function(s){return this.cmpn(s)<=0},r.prototype.lte=function(s){return this.cmp(s)<=0},r.prototype.eqn=function(s){return this.cmpn(s)===0},r.prototype.eq=function(s){return this.cmp(s)===0},r.red=function(s){return new he(s)},r.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},r.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(s){return this.red=s,this},r.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},r.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},r.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},r.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},r.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},r.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},r.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},r.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},r.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var nt={k256:null,p224:null,p192:null,p25519:null};function ae(m,s){this.name=m,this.p=new r(s,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}ae.prototype._tmp=function(){var s=new r(null);return s.words=new Array(Math.ceil(this.n/13)),s},ae.prototype.ireduce=function(s){var u=s,l;do this.split(u,this.tmp),u=this.imulK(u),u=u.iadd(this.tmp),l=u.bitLength();while(l>this.n);var h=l<this.n?-1:u.ucmp(this.p);return h===0?(u.words[0]=0,u.length=1):h>0?u.isub(this.p):u.strip!==void 0?u.strip():u._strip(),u},ae.prototype.split=function(s,u){s.iushrn(this.n,0,u)},ae.prototype.imulK=function(s){return s.imul(this.k)};function Ze(){ae.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(Ze,ae),Ze.prototype.split=function(s,u){for(var l=4194303,h=Math.min(s.length,9),_=0;_<h;_++)u.words[_]=s.words[_];if(u.length=h,s.length<=9){s.words[0]=0,s.length=1;return}var R=s.words[9];for(u.words[u.length++]=R&l,_=10;_<s.length;_++){var S=s.words[_]|0;s.words[_-10]=(S&l)<<4|R>>>22,R=S}R>>>=22,s.words[_-10]=R,R===0&&s.length>10?s.length-=10:s.length-=9},Ze.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var u=0,l=0;l<s.length;l++){var h=s.words[l]|0;u+=h*977,s.words[l]=u&67108863,u=h*64+(u/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function It(){ae.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(It,ae);function $n(){ae.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n($n,ae);function Mr(){ae.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(Mr,ae),Mr.prototype.imulK=function(s){for(var u=0,l=0;l<s.length;l++){var h=(s.words[l]|0)*19+u,_=h&67108863;h>>>=26,s.words[l]=_,u=h}return u!==0&&(s.words[s.length++]=u),s},r._prime=function(s){if(nt[s])return nt[s];var u;if(s==="k256")u=new Ze;else if(s==="p224")u=new It;else if(s==="p192")u=new $n;else if(s==="p25519")u=new Mr;else throw new Error("Unknown prime "+s);return nt[s]=u,u};function he(m){if(typeof m=="string"){var s=r._prime(m);this.m=s.p,this.prime=s}else t(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null}he.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},he.prototype._verify2=function(s,u){t((s.negative|u.negative)===0,"red works only with positives"),t(s.red&&s.red===u.red,"red works only with red numbers")},he.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):(A(s,s.umod(this.m)._forceRed(this)),s)},he.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},he.prototype.add=function(s,u){this._verify2(s,u);var l=s.add(u);return l.cmp(this.m)>=0&&l.isub(this.m),l._forceRed(this)},he.prototype.iadd=function(s,u){this._verify2(s,u);var l=s.iadd(u);return l.cmp(this.m)>=0&&l.isub(this.m),l},he.prototype.sub=function(s,u){this._verify2(s,u);var l=s.sub(u);return l.cmpn(0)<0&&l.iadd(this.m),l._forceRed(this)},he.prototype.isub=function(s,u){this._verify2(s,u);var l=s.isub(u);return l.cmpn(0)<0&&l.iadd(this.m),l},he.prototype.shl=function(s,u){return this._verify1(s),this.imod(s.ushln(u))},he.prototype.imul=function(s,u){return this._verify2(s,u),this.imod(s.imul(u))},he.prototype.mul=function(s,u){return this._verify2(s,u),this.imod(s.mul(u))},he.prototype.isqr=function(s){return this.imul(s,s.clone())},he.prototype.sqr=function(s){return this.mul(s,s)},he.prototype.sqrt=function(s){if(s.isZero())return s.clone();var u=this.m.andln(3);if(t(u%2===1),u===3){var l=this.m.add(new r(1)).iushrn(2);return this.pow(s,l)}for(var h=this.m.subn(1),_=0;!h.isZero()&&h.andln(1)===0;)_++,h.iushrn(1);t(!h.isZero());var R=new r(1).toRed(this),S=R.redNeg(),d=this.m.subn(1).iushrn(1),a=this.m.bitLength();for(a=new r(2*a*a).toRed(this);this.pow(a,d).cmp(S)!==0;)a.redIAdd(S);for(var y=this.pow(a,h),P=this.pow(s,h.addn(1).iushrn(1)),z=this.pow(s,h),K=_;z.cmp(R)!==0;){for(var $=z,Z=0;$.cmp(R)!==0;Z++)$=$.redSqr();t(Z<K);var ne=this.pow(y,new r(1).iushln(K-Z-1));P=P.redMul(ne),y=ne.redSqr(),z=z.redMul(y),K=Z}return P},he.prototype.invm=function(s){var u=s._invmp(this.m);return u.negative!==0?(u.negative=0,this.imod(u).redNeg()):this.imod(u)},he.prototype.pow=function(s,u){if(u.isZero())return new r(1).toRed(this);if(u.cmpn(1)===0)return s.clone();var l=4,h=new Array(1<<l);h[0]=new r(1).toRed(this),h[1]=s;for(var _=2;_<h.length;_++)h[_]=this.mul(h[_-1],s);var R=h[0],S=0,d=0,a=u.bitLength()%26;for(a===0&&(a=26),_=u.length-1;_>=0;_--){for(var y=u.words[_],P=a-1;P>=0;P--){var z=y>>P&1;if(R!==h[0]&&(R=this.sqr(R)),z===0&&S===0){d=0;continue}S<<=1,S|=z,d++,!(d!==l&&(_!==0||P!==0))&&(R=this.mul(R,h[S]),d=0,S=0)}a=26}return R},he.prototype.convertTo=function(s){var u=s.umod(this.m);return u===s?u.clone():u},he.prototype.convertFrom=function(s){var u=s.clone();return u.red=null,u},r.mont=function(s){return new wt(s)};function wt(m){he.call(this,m),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(wt,he),wt.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},wt.prototype.convertFrom=function(s){var u=this.imod(s.mul(this.rinv));return u.red=null,u},wt.prototype.imul=function(s,u){if(s.isZero()||u.isZero())return s.words[0]=0,s.length=1,s;var l=s.imul(u),h=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),_=l.isub(h).iushrn(this.shift),R=_;return _.cmp(this.m)>=0?R=_.isub(this.m):_.cmpn(0)<0&&(R=_.iadd(this.m)),R._forceRed(this)},wt.prototype.mul=function(s,u){if(s.isZero()||u.isZero())return new r(0)._forceRed(this);var l=s.mul(u),h=l.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),_=l.isub(h).iushrn(this.shift),R=_;return _.cmp(this.m)>=0?R=_.isub(this.m):_.cmpn(0)<0&&(R=_.iadd(this.m)),R._forceRed(this)},wt.prototype.invm=function(s){var u=this.imod(s._invmp(this.m).mul(this.r2));return u._forceRed(this)}})(typeof nn>"u"||nn,ls)});var ds=tn((Ah,hs)=>{ee();te();var ur=Gi().Buffer;function Yi(o){if(o.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var n=0;n<o.length;n++){var r=o.charAt(n),i=r.charCodeAt(0);if(e[i]!==255)throw new TypeError(r+" is ambiguous");e[i]=n}var c=o.length,f=o.charAt(0),p=Math.log(c)/Math.log(256),A=Math.log(256)/Math.log(c);function w(E){if((Array.isArray(E)||E instanceof Uint8Array)&&(E=ur.from(E)),!ur.isBuffer(E))throw new TypeError("Expected Buffer");if(E.length===0)return"";for(var k=0,v=0,B=0,U=E.length;B!==U&&E[B]===0;)B++,k++;for(var Y=(U-B)*A+1>>>0,le=new Uint8Array(Y);B!==U;){for(var J=E[B],nt=0,ae=Y-1;(J!==0||nt<v)&&ae!==-1;ae--,nt++)J+=256*le[ae]>>>0,le[ae]=J%c>>>0,J=J/c>>>0;if(J!==0)throw new Error("Non-zero carry");v=nt,B++}for(var Ze=Y-v;Ze!==Y&&le[Ze]===0;)Ze++;for(var It=f.repeat(k);Ze<Y;++Ze)It+=o.charAt(le[Ze]);return It}function I(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return ur.alloc(0);var k=0;if(E[k]!==" "){for(var v=0,B=0;E[k]===f;)v++,k++;for(var U=(E.length-k)*p+1>>>0,Y=new Uint8Array(U);E[k];){var le=e[E.charCodeAt(k)];if(le===255)return;for(var J=0,nt=U-1;(le!==0||J<B)&&nt!==-1;nt--,J++)le+=c*Y[nt]>>>0,Y[nt]=le%256>>>0,le=le/256>>>0;if(le!==0)throw new Error("Non-zero carry");B=J,k++}if(E[k]!==" "){for(var ae=U-B;ae!==U&&Y[ae]===0;)ae++;var Ze=ur.allocUnsafe(v+(U-ae));Ze.fill(0,0,v);for(var It=v;ae!==U;)Ze[It++]=Y[ae++];return Ze}}}function M(E){var k=I(E);if(k)return k;throw new Error("Non-base"+c+" character")}return{encode:w,decodeUnsafe:I,decode:M}}hs.exports=Yi});var gs=tn((wh,_s)=>{ee();te();var Xi=ds(),ji="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";_s.exports=Xi(ji)});ee();te();$i();var Tn=Ut(fs()),Xe=Ut(gs());ee();te();ee();te();ee();te();function sn(o){if(!Number.isSafeInteger(o)||o<0)throw new Error(`positive integer expected, not ${o}`)}function Ji(o){return o instanceof Uint8Array||o!=null&&typeof o=="object"&&o.constructor.name==="Uint8Array"}function Zt(o,...e){if(!Ji(o))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(o.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${o.length}`)}function zt(o,e=!0){if(o.destroyed)throw new Error("Hash instance has been destroyed");if(e&&o.finished)throw new Error("Hash#digest() has already been called")}function lr(o,e){Zt(o);let t=e.outputLen;if(o.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}ee();te();var ps=o=>new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)),fr=o=>new DataView(o.buffer,o.byteOffset,o.byteLength),at=(o,e)=>o<<32-e|o>>>e;var on=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,Zi=o=>o<<24&4278190080|o<<8&16711680|o>>>8&65280|o>>>24&255;function an(o){for(let e=0;e<o.length;e++)o[e]=Zi(o[e])}function Qi(o){if(typeof o!="string")throw new Error(`utf8ToBytes expected string, got ${typeof o}`);return new Uint8Array(new TextEncoder().encode(o))}function Ft(o){return typeof o=="string"&&(o=Qi(o)),Zt(o),o}var Kt=class{clone(){return this._cloneInto()}},Ch={}.toString;function hr(o){let e=n=>o().update(Ft(n)).digest(),t=o();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>o(),e}function ys(o){let e=(n,r)=>o(r).update(Ft(n)).digest(),t=o({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>o(n),e}function eo(o,e,t,n){if(typeof o.setBigUint64=="function")return o.setBigUint64(e,t,n);let r=BigInt(32),i=BigInt(4294967295),c=Number(t>>r&i),f=Number(t&i),p=n?4:0,A=n?0:4;o.setUint32(e+p,c,n),o.setUint32(e+A,f,n)}var ms=(o,e,t)=>o&e^~o&t,Rs=(o,e,t)=>o&e^o&t^e&t,dr=class extends Kt{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=fr(this.buffer)}update(e){zt(this);let{view:t,buffer:n,blockLen:r}=this;e=Ft(e);let i=e.length;for(let c=0;c<i;){let f=Math.min(r-this.pos,i-c);if(f===r){let p=fr(e);for(;r<=i-c;c+=r)this.process(p,c);continue}n.set(e.subarray(c,c+f),this.pos),this.pos+=f,c+=f,this.pos===r&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){zt(this),lr(e,this),this.finished=!0;let{buffer:t,view:n,blockLen:r,isLE:i}=this,{pos:c}=this;t[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>r-c&&(this.process(n,0),c=0);for(let I=c;I<r;I++)t[I]=0;eo(n,r-8,BigInt(this.length*8),i),this.process(n,0);let f=fr(e),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let A=p/4,w=this.get();if(A>w.length)throw new Error("_sha2: outputLen bigger than state");for(let I=0;I<A;I++)f.setUint32(4*I,w[I],i)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:n,length:r,finished:i,destroyed:c,pos:f}=this;return e.length=r,e.pos=f,e.finished=i,e.destroyed=c,r%t&&e.buffer.set(n),e}};var to=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),pt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yt=new Uint32Array(64),cn=class extends dr{constructor(){super(64,32,8,!1),this.A=pt[0]|0,this.B=pt[1]|0,this.C=pt[2]|0,this.D=pt[3]|0,this.E=pt[4]|0,this.F=pt[5]|0,this.G=pt[6]|0,this.H=pt[7]|0}get(){let{A:e,B:t,C:n,D:r,E:i,F:c,G:f,H:p}=this;return[e,t,n,r,i,c,f,p]}set(e,t,n,r,i,c,f,p){this.A=e|0,this.B=t|0,this.C=n|0,this.D=r|0,this.E=i|0,this.F=c|0,this.G=f|0,this.H=p|0}process(e,t){for(let I=0;I<16;I++,t+=4)yt[I]=e.getUint32(t,!1);for(let I=16;I<64;I++){let M=yt[I-15],E=yt[I-2],k=at(M,7)^at(M,18)^M>>>3,v=at(E,17)^at(E,19)^E>>>10;yt[I]=v+yt[I-7]+k+yt[I-16]|0}let{A:n,B:r,C:i,D:c,E:f,F:p,G:A,H:w}=this;for(let I=0;I<64;I++){let M=at(f,6)^at(f,11)^at(f,25),E=w+M+ms(f,p,A)+to[I]+yt[I]|0,v=(at(n,2)^at(n,13)^at(n,22))+Rs(n,r,i)|0;w=A,A=p,p=f,f=c+E|0,c=i,i=r,r=n,n=E+v|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,c=c+this.D|0,f=f+this.E|0,p=p+this.F|0,A=A+this.G|0,w=w+this.H|0,this.set(n,r,i,c,f,p,A,w)}roundClean(){yt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var un=hr(()=>new cn);var jt=Ut(Hi()),g=Ut(as()),Ii=Ut(as());ee();te();ee();te();var ro=1,no=2,so=3,io=4,oo=5,ao=6,co=7,uo=8,lo=9,fo=10,ho=-32700,_o=-32603,go=-32602,po=-32601,yo=-32600,mo=-32016,Ro=-32015,So=-32014,bo=-32013,Ao=-32012,Eo=-32011,Io=-32010,wo=-32009,Oo=-32008,vo=-32007,ko=-32006,No=-32005,To=-32004,Lo=-32003,Co=-32002,xo=-32001,Bo=28e5,Mo=2800001,Po=2800002,Do=2800003,Uo=2800004,zo=2800005,Ko=2800006,Fo=2800007,Wo=2800008,$o=2800009,Vo=2800010,Go=323e4,Ho=32300001,qo=3230002,Yo=3230003,Xo=3230004,jo=361e4,Jo=3610001,Zo=3610002,Qo=3610003,ea=3610004,ta=3610005,ra=3610006,na=3610007,sa=3611e3,ia=3704e3,oa=3704001,aa=3704002,ca=3704003,ua=3704004,la=4128e3,fa=4128001,ha=4128002,da=4615e3,_a=4615001,ga=4615002,pa=4615003,ya=4615004,ma=4615005,Ra=4615006,Sa=4615007,ba=4615008,Aa=4615009,Ea=4615010,Ia=4615011,wa=4615012,Oa=4615013,va=4615014,ka=4615015,Na=4615016,Ta=4615017,La=4615018,Ca=4615019,xa=4615020,Ba=4615021,Ma=4615022,Pa=4615023,Da=4615024,Ua=4615025,za=4615026,Ka=4615027,Fa=4615028,Wa=4615029,$a=4615030,Va=4615031,Ga=4615032,Ha=4615033,qa=4615034,Ya=4615035,Xa=4615036,ja=4615037,Ja=4615038,Za=4615039,Qa=4615040,ec=4615041,tc=4615042,rc=4615043,nc=4615044,sc=4615045,ic=4615046,oc=4615047,ac=4615048,cc=4615049,uc=4615050,lc=4615051,fc=4615052,hc=4615053,dc=4615054,_c=5508e3,gc=5508001,pc=5508002,yc=5508003,mc=5508004,Rc=5508005,Sc=5508006,bc=5508007,Ac=5508008,Ec=5508009,Ic=5508010,wc=5508011,Oc=5663e3,vc=5663001,kc=5663002,Nc=5663003,Tc=5663004,Lc=5663005,Cc=5663006,xc=5663007,Bc=5663008,Mc=5663009,Pc=5663010,Dc=5663011,Uc=5663012,zc=5663013,Kc=5663014,Fc=5663015,Wc=5663016,$c=5663017,Vc=5663018,Gc=5663019,Hc=705e4,qc=7050001,Yc=7050002,Xc=7050003,jc=7050004,Jc=7050005,Zc=7050006,Qc=7050007,eu=7050008,tu=7050009,ru=7050010,nu=7050011,su=7050012,iu=7050013,ou=7050014,au=7050015,cu=7050016,uu=7050017,lu=7050018,fu=7050019,hu=7050020,du=7050021,_u=7050022,gu=7050023,pu=7050024,yu=7050025,mu=7050026,Ru=7050027,Su=7050028,bu=7050029,Au=7050030,Eu=7050031,Iu=7050032,wu=7050033,Ou=7050034,vu=7050035,ku=7050036,ln=8078e3,fn=8078001,Ss=8078002,bs=8078003,hn=8078004,dn=8078005,_n=8078006,Nu=8078007,Tu=8078008,Lu=8078009,Cu=8078010,gn=8078011,xu=8078012,As=8078013,Es=8078014,Bu=8078015,Mu=8078016,Pu=8078017,Du=8078018,Uu=8078019,Is=8078020,ws=8078021,zu=8078022,Ku=81e5,Fu=8100001,Wu=8100002,$u=8100003,Vu=819e4,Gu=8190001,Hu=8190002,qu=8190003,Yu=8190004,Xu=99e5,ju=9900001,Ju=9900002,Zu=9900003,Qu=9900004;function Os(o){return Array.isArray(o)?"%5B"+o.map(Os).join("%2C%20")+"%5D":typeof o=="bigint"?`${o}n`:encodeURIComponent(String(o!=null&&Object.getPrototypeOf(o)===null?{...o}:o))}function el([o,e]){return`${o}=${Os(e)}`}function tl(o){let e=Object.entries(o).map(el).join("&");return btoa(e)}var Hh={[Go]:"Account not found at address: $address",[Xo]:"Not all accounts were decoded. Encoded accounts found at addresses: $addresses.",[Yo]:"Expected decoded account at address: $address",[qo]:"Failed to decode account data at address: $address",[Ho]:"Accounts not found at addresses: $addresses",[$o]:"Unable to find a viable program address bump seed.",[Po]:"$putativeAddress is not a base58-encoded address.",[Bo]:"Expected base58 encoded address to decode to a byte array of length 32. Actual length: $actualLength.",[Do]:"The `CryptoKey` must be an `Ed25519` public key.",[Wo]:"Invalid seeds; point must fall off the Ed25519 curve.",[Uo]:"Expected given program derived address to have the following format: [Address, ProgramDerivedAddressBump].",[Ko]:"A maximum of $maxSeeds seeds, including the bump seed, may be supplied when creating an address. Received: $actual.",[Fo]:"The seed at index $index with length $actual exceeds the maximum length of $maxSeedLength bytes.",[zo]:"Expected program derived address bump to be in the range [0, 255], got: $bump.",[Vo]:"Program address cannot end with PDA marker.",[Mo]:"Expected base58-encoded address string of length in the range [32, 44]. Actual length: $actualLength.",[io]:"Expected base58-encoded blockash string of length in the range [32, 44]. Actual length: $actualLength.",[ro]:"The network has progressed past the last block for which this transaction could have been committed.",[ln]:"Codec [$codecDescription] cannot decode empty byte arrays.",[zu]:"Enum codec cannot use lexical values [$stringValues] as discriminators. Either remove all lexical values or set `useValuesAsDiscriminators` to `false`.",[Is]:"Sentinel [$hexSentinel] must not be present in encoded bytes [$hexEncodedBytes].",[dn]:"Encoder and decoder must have the same fixed size, got [$encoderFixedSize] and [$decoderFixedSize].",[_n]:"Encoder and decoder must have the same max size, got [$encoderMaxSize] and [$decoderMaxSize].",[hn]:"Encoder and decoder must either both be fixed-size or variable-size.",[Tu]:"Enum discriminator out of range. Expected a number in [$formattedValidDiscriminators], got $discriminator.",[Ss]:"Expected a fixed-size codec, got a variable-size one.",[As]:"Codec [$codecDescription] expected a positive byte length, got $bytesLength.",[bs]:"Expected a variable-size codec, got a fixed-size one.",[Uu]:"Codec [$codecDescription] expected zero-value [$hexZeroValue] to have the same size as the provided fixed-size item [$expectedSize bytes].",[fn]:"Codec [$codecDescription] expected $expected bytes, got $bytesLength.",[Du]:"Expected byte array constant [$hexConstant] to be present in data [$hexData] at offset [$offset].",[Lu]:"Invalid discriminated union variant. Expected one of [$variants], got $value.",[Cu]:"Invalid enum variant. Expected one of [$stringValues] or a number in [$formattedNumericalValues], got $variant.",[Bu]:"Invalid literal union variant. Expected one of [$variants], got $value.",[Nu]:"Expected [$codecDescription] to have $expected items, got $actual.",[xu]:"Invalid value $value for base $base with alphabet $alphabet.",[Mu]:"Literal union discriminator out of range. Expected a number between $minRange and $maxRange, got $discriminator.",[gn]:"Codec [$codecDescription] expected number to be in the range [$min, $max], got $value.",[Es]:"Codec [$codecDescription] expected offset to be in the range [0, $bytesLength], got $offset.",[ws]:"Expected sentinel [$hexSentinel] to be present in decoded bytes [$hexDecodedBytes].",[Pu]:"Union variant out of range. Expected an index between $minRange and $maxRange, got $variant.",[sa]:"No random values implementation could be found.",[Aa]:"instruction requires an uninitialized account",[Pa]:"instruction tries to borrow reference for an account which is already borrowed",[Da]:"instruction left account with an outstanding borrowed reference",[Ba]:"program other than the account's owner changed the size of the account data",[ma]:"account data too small for instruction",[Ma]:"instruction expected an executable account",[ic]:"An account does not have enough lamports to be rent-exempt",[ac]:"Program arithmetic overflowed",[sc]:"Failed to serialize or deserialize account data: $encodedData",[dc]:"Builtin programs must consume compute units",[Ga]:"Cross-program invocation call depth too deep",[Ja]:"Computational budget exceeded",[za]:"custom program error: #$code",[Ta]:"instruction contains duplicate accounts",[Ua]:"instruction modifications of multiply-passed account differ",[$a]:"executable accounts must be rent exempt",[Fa]:"instruction changed executable accounts data",[Wa]:"instruction changed the balance of an executable account",[La]:"instruction changed executable bit of an account",[va]:"instruction modified data of an account it does not own",[Oa]:"instruction spent from the balance of an account it does not own",[_a]:"generic instruction error",[uc]:"Provided owner is not allowed",[rc]:"Account is immutable",[nc]:"Incorrect authority provided",[Sa]:"incorrect program id for instruction",[Ra]:"insufficient funds for instruction",[ya]:"invalid account data for instruction",[oc]:"Invalid account owner",[ga]:"invalid program argument",[Ka]:"program returned invalid error code",[pa]:"invalid instruction data",[ja]:"Failed to reallocate account data",[Xa]:"Provided seeds do not result in a valid address",[lc]:"Accounts data allocations exceeded the maximum allowed per transaction",[fc]:"Max accounts exceeded",[hc]:"Max instruction trace length exceeded",[Ya]:"Length of the seed is too long for address generation",[Ha]:"An account required by the instruction is missing",[ba]:"missing required signature for instruction",[wa]:"instruction illegally modified the program id of an account",[xa]:"insufficient account keys for instruction",[Za]:"Cross-program invocation with unauthorized signer or writable account",[Qa]:"Failed to create program execution environment",[tc]:"Program failed to compile",[ec]:"Program failed to complete",[Na]:"instruction modified data of a read-only account",[ka]:"instruction changed the balance of a read-only account",[qa]:"Cross-program invocation reentrancy not allowed for this instruction",[Ca]:"instruction modified rent epoch of an account",[Ia]:"sum of account balances before and after instruction do not match",[Ea]:"instruction requires an initialized account",[da]:"",[Va]:"Unsupported program id",[cc]:"Unsupported sysvar",[la]:"The instruction does not have any accounts.",[fa]:"The instruction does not have any data.",[ha]:"Expected instruction to have progress address $expectedProgramAddress, got $actualProgramAddress.",[oo]:"Expected base58 encoded blockhash to decode to a byte array of length 32. Actual length: $actualLength.",[no]:"The nonce `$expectedNonceValue` is no longer valid. It has advanced to `$actualNonceValue`",[Ju]:"Invariant violation: Found no abortable iterable cache entry for key `$cacheKey`. It should be impossible to hit this error; please file an issue at https://sola.na/web3invariant",[Qu]:"Invariant violation: This data publisher does not publish to the channel named `$channelName`. Supported channels include $supportedChannelNames.",[ju]:"Invariant violation: WebSocket message iterator state is corrupt; iterated without first resolving existing message promise. It should be impossible to hit this error; please file an issue at https://sola.na/web3invariant",[Xu]:"Invariant violation: WebSocket message iterator is missing state storage. It should be impossible to hit this error; please file an issue at https://sola.na/web3invariant",[Zu]:"Invariant violation: Switch statement non-exhaustive. Received unexpected value `$unexpectedValue`. It should be impossible to hit this error; please file an issue at https://sola.na/web3invariant",[_o]:"JSON-RPC error: Internal JSON-RPC error ($__serverMessage)",[go]:"JSON-RPC error: Invalid method parameter(s) ($__serverMessage)",[yo]:"JSON-RPC error: The JSON sent is not a valid `Request` object ($__serverMessage)",[po]:"JSON-RPC error: The method does not exist / is not available ($__serverMessage)",[ho]:"JSON-RPC error: An error occurred on the server while parsing the JSON text ($__serverMessage)",[Ao]:"$__serverMessage",[xo]:"$__serverMessage",[To]:"$__serverMessage",[So]:"$__serverMessage",[Io]:"$__serverMessage",[wo]:"$__serverMessage",[mo]:"Minimum context slot has not been reached",[No]:"Node is unhealthy; behind by $numSlotsBehind slots",[Oo]:"No snapshot",[Co]:"Transaction simulation failed",[vo]:"$__serverMessage",[Eo]:"Transaction history is not available from this node",[ko]:"$__serverMessage",[bo]:"Transaction signature length mismatch",[Lo]:"Transaction signature verification failure",[Ro]:"$__serverMessage",[ia]:"Key pair bytes must be of length 64, got $byteLength.",[oa]:"Expected private key bytes with length 32. Actual length: $actualLength.",[aa]:"Expected base58-encoded signature to decode to a byte array of length 64. Actual length: $actualLength.",[ua]:"The provided private key does not match the provided public key.",[ca]:"Expected base58-encoded signature string of length in the range [64, 88]. Actual length: $actualLength.",[ao]:"Lamports value must be in the range [0, 2e64-1]",[co]:"`$value` cannot be parsed as a `BigInt`",[fo]:"$message",[uo]:"`$value` cannot be parsed as a `Number`",[so]:"No nonce account could be found at address `$nonceAccountAddress`",[Vu]:"The notification name must end in 'Notifications' and the API must supply a subscription plan creator function for the notification '$notificationName'.",[Hu]:"WebSocket was closed before payload could be added to the send buffer",[qu]:"WebSocket connection closed",[Yu]:"WebSocket failed to connect",[Gu]:"Failed to obtain a subscription id from the server",[$u]:"Could not find an API plan for RPC method: `$method`",[Ku]:"The $argumentLabel argument to the `$methodName` RPC method$optionalPathLabel was `$value`. This number is unsafe for use with the Solana JSON-RPC because it exceeds `Number.MAX_SAFE_INTEGER`.",[Wu]:"HTTP error ($statusCode): $message",[Fu]:"HTTP header(s) forbidden: $headers. Learn more at https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name.",[_c]:"Multiple distinct signers were identified for address `$address`. Please ensure that you are using the same signer instance for each address.",[gc]:"The provided value does not implement the `KeyPairSigner` interface",[yc]:"The provided value does not implement the `MessageModifyingSigner` interface",[mc]:"The provided value does not implement the `MessagePartialSigner` interface",[pc]:"The provided value does not implement any of the `MessageSigner` interfaces",[Sc]:"The provided value does not implement the `TransactionModifyingSigner` interface",[bc]:"The provided value does not implement the `TransactionPartialSigner` interface",[Ac]:"The provided value does not implement the `TransactionSendingSigner` interface",[Rc]:"The provided value does not implement any of the `TransactionSigner` interfaces",[Ec]:"More than one `TransactionSendingSigner` was identified.",[Ic]:"No `TransactionSendingSigner` was identified. Please provide a valid `ITransactionWithSingleSendingSigner` transaction.",[wc]:"Wallet account signers do not support signing multiple messages/transactions in a single operation",[na]:"Cannot export a non-extractable key.",[Jo]:"No digest implementation could be found.",[jo]:"Cryptographic operations are only allowed in secure browser contexts. Read more here: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts.",[Zo]:`This runtime does not support the generation of Ed25519 key pairs.

Install @solana/webcrypto-ed25519-polyfill and call its \`install\` function before generating keys in environments that do not support Ed25519.

For a list of runtimes that currently support Ed25519 operations, visit https://github.com/WICG/webcrypto-secure-curves/issues/20.`,[Qo]:"No signature verification implementation could be found.",[ea]:"No key generation implementation could be found.",[ta]:"No signing implementation could be found.",[ra]:"No key export implementation could be found.",[lo]:"Timestamp value must be in the range [-(2n ** 63n), (2n ** 63n) - 1]. `$value` given",[cu]:"Transaction processing left an account with an outstanding borrowed reference",[qc]:"Account in use",[Yc]:"Account loaded twice",[Xc]:"Attempt to debit an account but found no record of a prior credit.",[gu]:"Transaction loads an address table account that doesn't exist",[Qc]:"This transaction has already been processed",[eu]:"Blockhash not found",[tu]:"Loader call chain is too deep",[au]:"Transactions are currently disabled due to cluster maintenance",[Au]:"Transaction contains a duplicate instruction ($index) that is not allowed",[Jc]:"Insufficient funds for fee",[Eu]:"Transaction results in an account ($accountIndex) with insufficient funds for rent",[Zc]:"This account may not be used to pay transaction fees",[nu]:"Transaction contains an invalid account reference",[yu]:"Transaction loads an address table account with invalid data",[mu]:"Transaction address table lookup uses an invalid index",[pu]:"Transaction loads an address table account with an invalid owner",[wu]:"LoadedAccountsDataSizeLimit set for transaction must be greater than 0.",[iu]:"This program may not be used for executing instructions",[Ru]:"Transaction leaves an account with a lower balance than rent-exempt minimum",[fu]:"Transaction loads a writable account that cannot be written",[Iu]:"Transaction exceeded max loaded accounts data size cap",[ru]:"Transaction requires a fee but has no signature present",[jc]:"Attempt to load a program that does not exist",[vu]:"Execution of the program referenced by account at index $accountIndex is temporarily restricted.",[Ou]:"ResanitizationNeeded",[ou]:"Transaction failed to sanitize accounts offsets correctly",[su]:"Transaction did not pass signature verification",[_u]:"Transaction locked too many accounts",[ku]:"Sum of account balances before and after transaction do not match",[Hc]:"The transaction failed with the error `$errorName`",[lu]:"Transaction version is unsupported",[du]:"Transaction would exceed account data limit within the block",[bu]:"Transaction would exceed total account data limit",[hu]:"Transaction would exceed max account limit within the block",[uu]:"Transaction would exceed max Block Cost Limit",[Su]:"Transaction would exceed max Vote Cost Limit",[Fc]:"Attempted to sign a transaction with an address that is not a signer for it",[Pc]:"Transaction is missing an address at index: $index.",[Wc]:"Transaction has no expected signers therefore it cannot be encoded",[kc]:"Transaction does not have a blockhash lifetime",[Nc]:"Transaction is not a durable nonce transaction",[Lc]:"Contents of these address lookup tables unknown: $lookupTableAddresses",[Cc]:"Lookup of address at index $highestRequestedIndex failed for lookup table `$lookupTableAddress`. Highest known index is $highestKnownIndex. The lookup table may have been extended since its contents were retrieved",[Bc]:"No fee payer set in CompiledTransaction",[xc]:"Could not find program address at index $index",[Vc]:"Failed to estimate the compute unit consumption for this transaction message. This is likely because simulating the transaction failed. Inspect the `cause` property of this error to learn more",[Gc]:"Transaction failed when it was simulated in order to estimate the compute unit consumption. The compute unit estimate provided is for a transaction that failed when simulated and may not be representative of the compute units this transaction would consume if successful. Inspect the `cause` property of this error to learn more",[Dc]:"Transaction is missing a fee payer.",[Uc]:"Could not determine this transaction's signature. Make sure that the transaction has been signed by its fee payer.",[Kc]:"Transaction first instruction is not advance nonce account instruction.",[zc]:"Transaction with no instructions cannot be durable nonce transaction.",[Oc]:"This transaction includes an address (`$programAddress`) which is both invoked and set as the fee payer. Program addresses may not pay fees",[vc]:"This transaction includes an address (`$programAddress`) which is both invoked and marked writable. Program addresses may not be writable",[$c]:"The transaction message expected the transaction to have $signerAddressesLength signatures, got $signaturesLength.",[Mc]:"Transaction is missing signatures for addresses: $addresses.",[Tc]:"Transaction version must be in the range [0, 127]. `$actualVersion` given"};function rl(o,e={}){{let t=`Solana error #${o}; Decode this error by running \`npx @solana/errors decode -- ${o}`;return Object.keys(e).length&&(t+=` '${tl(e)}'`),`${t}\``}}var mt=class extends Error{constructor(...[e,t]){let n,r;if(t){let{cause:c,...f}=t;c&&(r={cause:c}),Object.keys(f).length>0&&(n=f)}let i=rl(e,n);super(i,r);rn(this,"cause",this.cause);rn(this,"context");this.context={__code:e,...n},this.name="SolanaError"}};ee();te();function nl(o,e){return"fixedSize"in e?e.fixedSize:e.getSizeFromValue(o)}function vs(o){return Object.freeze({...o,encode:e=>{let t=new Uint8Array(nl(e,o));return o.write(e,t,0),t}})}function ks(o){return Object.freeze({...o,decode:(e,t=0)=>o.read(e,t)[0]})}function Wt(o){return"fixedSize"in o&&typeof o.fixedSize=="number"}function Ns(o,e){if(Wt(o)!==Wt(e))throw new mt(hn);if(Wt(o)&&Wt(e)&&o.fixedSize!==e.fixedSize)throw new mt(dn,{decoderFixedSize:e.fixedSize,encoderFixedSize:o.fixedSize});if(!Wt(o)&&!Wt(e)&&o.maxSize!==e.maxSize)throw new mt(_n,{decoderMaxSize:e.maxSize,encoderMaxSize:o.maxSize});return{...e,...o,decode:e.decode,encode:o.encode,read:e.read,write:o.write}}function Ts(o,e,t=0){if(e.length-t<=0)throw new mt(ln,{codecDescription:o})}function Ls(o,e,t,n=0){let r=t.length-n;if(r<e)throw new mt(fn,{bytesLength:r,codecDescription:o,expected:e})}function sl(o,e,t,n){if(n<e||n>t)throw new mt(gn,{codecDescription:o,max:t,min:e,value:n})}function Cs(o){return o?.endian!==1}function il(o){return vs({fixedSize:o.size,write(e,t,n){o.range&&sl(o.name,o.range[0],o.range[1],e);let r=new ArrayBuffer(o.size);return o.set(new DataView(r),e,Cs(o.config)),t.set(new Uint8Array(r),n),n+o.size}})}function ol(o){return ks({fixedSize:o.size,read(e,t=0){Ts(o.name,e,t),Ls(o.name,o.size,e,t);let n=new DataView(al(e,t,o.size));return[o.get(n,Cs(o.config)),t+o.size]}})}function al(o,e,t){let n=o.byteOffset+(e??0),r=t??o.byteLength;return o.buffer.slice(n,n+r)}var pn=(o={})=>il({config:o,name:"u64",range:[0n,BigInt("0xffffffffffffffff")],set:(e,t,n)=>e.setBigUint64(0,BigInt(t),n),size:8}),cl=(o={})=>ol({config:o,get:(e,t)=>e.getBigUint64(0,t),name:"u64",size:8}),xs=(o={})=>Ns(pn(o),cl(o));ee();te();var yn=class extends TypeError{constructor(e,t){let n,{message:r,explanation:i,...c}=e,{path:f}=e,p=f.length===0?r:`At path: ${f.join(".")} -- ${r}`;super(i??p),i!=null&&(this.cause=p),Object.assign(this,c),this.name=this.constructor.name,this.failures=()=>n??(n=[e,...t()])}};function ul(o){return Qt(o)&&typeof o[Symbol.iterator]=="function"}function Qt(o){return typeof o=="object"&&o!=null}function _r(o){return Qt(o)&&!Array.isArray(o)}function ct(o){return typeof o=="symbol"?o.toString():typeof o=="string"?JSON.stringify(o):`${o}`}function ll(o){let{done:e,value:t}=o.next();return e?void 0:t}function fl(o,e,t,n){if(o===!0)return;o===!1?o={}:typeof o=="string"&&(o={message:o});let{path:r,branch:i}=e,{type:c}=t,{refinement:f,message:p=`Expected a value of type \`${c}\`${f?` with refinement \`${f}\``:""}, but received: \`${ct(n)}\``}=o;return{value:n,type:c,refinement:f,key:r[r.length-1],path:r,branch:i,...o,message:p}}function*Bs(o,e,t,n){ul(o)||(o=[o]);for(let r of o){let i=fl(r,e,t,n);i&&(yield i)}}function*mn(o,e,t={}){let{path:n=[],branch:r=[o],coerce:i=!1,mask:c=!1}=t,f={path:n,branch:r,mask:c};i&&(o=e.coercer(o,f));let p="valid";for(let A of e.validator(o,f))A.explanation=t.message,p="not_valid",yield[A,void 0];for(let[A,w,I]of e.entries(o,f)){let M=mn(w,I,{path:A===void 0?n:[...n,A],branch:A===void 0?r:[...r,w],coerce:i,mask:c,message:t.message});for(let E of M)E[0]?(p=E[0].refinement!=null?"not_refined":"not_valid",yield[E[0],void 0]):i&&(w=E[1],A===void 0?o=w:o instanceof Map?o.set(A,w):o instanceof Set?o.add(w):Qt(o)&&(w!==void 0||A in o)&&(o[A]=w))}if(p!=="not_valid")for(let A of e.refiner(o,f))A.explanation=t.message,p="not_refined",yield[A,void 0];p==="valid"&&(yield[void 0,o])}var it=class{constructor(e){let{type:t,schema:n,validator:r,refiner:i,coercer:c=p=>p,entries:f=function*(){}}=e;this.type=t,this.schema=n,this.entries=f,this.coercer=c,r?this.validator=(p,A)=>{let w=r(p,A);return Bs(w,A,this,p)}:this.validator=()=>[],i?this.refiner=(p,A)=>{let w=i(p,A);return Bs(w,A,this,p)}:this.refiner=()=>[]}assert(e,t){return Rn(e,this,t)}create(e,t){return L(e,this,t)}is(e){return Ms(e,this)}mask(e,t){return hl(e,this,t)}validate(e,t={}){return er(e,this,t)}};function Rn(o,e,t){let n=er(o,e,{message:t});if(n[0])throw n[0]}function L(o,e,t){let n=er(o,e,{coerce:!0,message:t});if(n[0])throw n[0];return n[1]}function hl(o,e,t){let n=er(o,e,{coerce:!0,mask:!0,message:t});if(n[0])throw n[0];return n[1]}function Ms(o,e){return!er(o,e)[0]}function er(o,e,t={}){let n=mn(o,e,t),r=ll(n);return r[0]?[new yn(r[0],function*(){for(let c of n)c[0]&&(yield c[0])}),void 0]:[void 0,r[1]]}function vt(o,e){return new it({type:o,schema:null,validator:e})}function Ps(){return vt("any",()=>!0)}function C(o){return new it({type:"array",schema:o,*entries(e){if(o&&Array.isArray(e))for(let[t,n]of e.entries())yield[t,n,o]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||`Expected an array value, but received: ${ct(e)}`}})}function ut(){return vt("boolean",o=>typeof o=="boolean")}function gr(o){return vt("instance",e=>e instanceof o||`Expected a \`${o.name}\` instance, but received: ${ct(e)}`)}function ue(o){let e=ct(o),t=typeof o;return new it({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?o:null,validator(n){return n===o||`Expected the literal \`${e}\`, but received: ${ct(n)}`}})}function dl(){return vt("never",()=>!1)}function x(o){return new it({...o,validator:(e,t)=>e===null||o.validator(e,t),refiner:(e,t)=>e===null||o.refiner(e,t)})}function b(){return vt("number",o=>typeof o=="number"&&!isNaN(o)||`Expected a number, but received: ${ct(o)}`)}function F(o){return new it({...o,validator:(e,t)=>e===void 0||o.validator(e,t),refiner:(e,t)=>e===void 0||o.refiner(e,t)})}function Sn(o,e){return new it({type:"record",schema:null,*entries(t){if(Qt(t))for(let n in t){let r=t[n];yield[n,n,o],yield[n,r,e]}},validator(t){return _r(t)||`Expected an object, but received: ${ct(t)}`},coercer(t){return _r(t)?{...t}:t}})}function N(){return vt("string",o=>typeof o=="string"||`Expected a string, but received: ${ct(o)}`)}function pr(o){let e=dl();return new it({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){let n=Math.max(o.length,t.length);for(let r=0;r<n;r++)yield[r,t[r],o[r]||e]}},validator(t){return Array.isArray(t)||`Expected an array, but received: ${ct(t)}`},coercer(t){return Array.isArray(t)?t.slice():t}})}function O(o){let e=Object.keys(o);return new it({type:"type",schema:o,*entries(t){if(Qt(t))for(let n of e)yield[n,t[n],o[n]]},validator(t){return _r(t)||`Expected an object, but received: ${ct(t)}`},coercer(t){return _r(t)?{...t}:t}})}function Je(o){let e=o.map(t=>t.type).join(" | ");return new it({type:"union",schema:null,coercer(t,n){for(let r of o){let[i,c]=r.validate(t,{coerce:!0,mask:n.mask});if(!i)return c}return t},validator(t,n){let r=[];for(let i of o){let[...c]=mn(t,i,n),[f]=c;if(f[0])for(let[p]of c)p&&r.push(p);else return[]}return[`Expected the value to satisfy a union of \`${e}\`, but received: ${ct(t)}`,...r]}})}function kt(){return vt("unknown",()=>!0)}function $t(o,e,t){return new it({...o,coercer:(n,r)=>Ms(n,e)?o.coercer(t(n,r),r):o.coercer(n,r)})}var wi=Ut(qi());ee();te();ee();te();var yr=BigInt(4294967295),Ds=BigInt(32);function _l(o,e=!1){return e?{h:Number(o&yr),l:Number(o>>Ds&yr)}:{h:Number(o>>Ds&yr)|0,l:Number(o&yr)|0}}function Us(o,e=!1){let t=new Uint32Array(o.length),n=new Uint32Array(o.length);for(let r=0;r<o.length;r++){let{h:i,l:c}=_l(o[r],e);[t[r],n[r]]=[i,c]}return[t,n]}var zs=(o,e,t)=>o<<t|e>>>32-t,Ks=(o,e,t)=>e<<t|o>>>32-t,Fs=(o,e,t)=>e<<t-32|o>>>64-t,Ws=(o,e,t)=>o<<t-32|e>>>64-t;var Gs=[],Hs=[],qs=[],gl=BigInt(0),tr=BigInt(1),pl=BigInt(2),yl=BigInt(7),ml=BigInt(256),Rl=BigInt(113);for(let o=0,e=tr,t=1,n=0;o<24;o++){[t,n]=[n,(2*t+3*n)%5],Gs.push(2*(5*n+t)),Hs.push((o+1)*(o+2)/2%64);let r=gl;for(let i=0;i<7;i++)e=(e<<tr^(e>>yl)*Rl)%ml,e&pl&&(r^=tr<<(tr<<BigInt(i))-tr);qs.push(r)}var[Sl,bl]=Us(qs,!0),$s=(o,e,t)=>t>32?Fs(o,e,t):zs(o,e,t),Vs=(o,e,t)=>t>32?Ws(o,e,t):Ks(o,e,t);function Al(o,e=24){let t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let c=0;c<10;c++)t[c]=o[c]^o[c+10]^o[c+20]^o[c+30]^o[c+40];for(let c=0;c<10;c+=2){let f=(c+8)%10,p=(c+2)%10,A=t[p],w=t[p+1],I=$s(A,w,1)^t[f],M=Vs(A,w,1)^t[f+1];for(let E=0;E<50;E+=10)o[c+E]^=I,o[c+E+1]^=M}let r=o[2],i=o[3];for(let c=0;c<24;c++){let f=Hs[c],p=$s(r,i,f),A=Vs(r,i,f),w=Gs[c];r=o[w],i=o[w+1],o[w]=p,o[w+1]=A}for(let c=0;c<50;c+=10){for(let f=0;f<10;f++)t[f]=o[c+f];for(let f=0;f<10;f++)o[c+f]^=~t[(f+2)%10]&t[(f+4)%10]}o[0]^=Sl[n],o[1]^=bl[n]}t.fill(0)}var Vt=class extends Kt{constructor(e,t,n,r=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=r,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,sn(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ps(this.state)}keccak(){on||an(this.state32),Al(this.state32,this.rounds),on||an(this.state32),this.posOut=0,this.pos=0}update(e){zt(this);let{blockLen:t,state:n}=this;e=Ft(e);let r=e.length;for(let i=0;i<r;){let c=Math.min(t-this.pos,r-i);for(let f=0;f<c;f++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:n,blockLen:r}=this;e[n]^=t,(t&128)!==0&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){zt(this,!1),Zt(e),this.finish();let t=this.state,{blockLen:n}=this;for(let r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();let c=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+c),r),this.posOut+=c,r+=c}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return sn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(lr(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:n,outputLen:r,rounds:i,enableXOF:c}=this;return e||(e=new Vt(t,n,r,c,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=r,e.enableXOF=c,e.destroyed=this.destroyed,e}},Rt=(o,e,t)=>hr(()=>new Vt(e,o,t)),pd=Rt(6,144,224/8),yd=Rt(6,136,256/8),md=Rt(6,104,384/8),Rd=Rt(6,72,512/8),Sd=Rt(1,144,224/8),bn=Rt(1,136,256/8),bd=Rt(1,104,384/8),Ad=Rt(1,72,512/8),Ys=(o,e,t)=>ys((n={})=>new Vt(e,o,n.dkLen===void 0?t:n.dkLen,!0)),Ed=Ys(31,168,128/8),Id=Ys(31,136,256/8);var El=Ot.utils.randomPrivateKey,Xs=()=>{let o=Ot.utils.randomPrivateKey(),e=Sr(o),t=new Uint8Array(64);return t.set(o),t.set(e,32),{publicKey:e,secretKey:t}},Sr=Ot.getPublicKey;function js(o){try{return Ot.ExtendedPoint.fromHex(o),!0}catch{return!1}}var Un=(o,e)=>Ot.sign(o,e.slice(0,32)),Il=Ot.verify,G=o=>W.isBuffer(o)?o:o instanceof Uint8Array?W.from(o.buffer,o.byteOffset,o.byteLength):W.from(o),br=class{constructor(e){Object.assign(this,e)}encode(){return W.from((0,jt.serialize)(Rr,this))}static decode(e){return(0,jt.deserialize)(Rr,this,e)}static decodeUnchecked(e){return(0,jt.deserializeUnchecked)(Rr,this,e)}},Js=class extends br{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}},Rr=new Map,Oi,wl=32,_t=32;function Ol(o){return o._bn!==void 0}var Zs=1,T=class extends br{constructor(e){if(super({}),this._bn=void 0,Ol(e))this._bn=e._bn;else{if(typeof e=="string"){let t=Xe.default.decode(e);if(t.length!=_t)throw new Error("Invalid public key input");this._bn=new Tn.default(t)}else this._bn=new Tn.default(e);if(this._bn.byteLength()>_t)throw new Error("Invalid public key input")}}static unique(){let e=new T(Zs);return Zs+=1,new T(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return Xe.default.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){let e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){let e=this._bn.toArrayLike(W);if(e.length===_t)return e;let t=W.alloc(32);return e.copy(t,32-e.length),t}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){let r=W.concat([e.toBuffer(),W.from(t),n.toBuffer()]),i=un(r);return new T(i)}static createProgramAddressSync(e,t){let n=W.alloc(0);e.forEach(function(i){if(i.length>wl)throw new TypeError("Max seed length exceeded");n=W.concat([n,G(i)])}),n=W.concat([n,t.toBuffer(),W.from("ProgramDerivedAddress")]);let r=un(n);if(js(r))throw new Error("Invalid seeds, address must fall off the curve");return new T(r)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,r;for(;n!=0;){try{let i=e.concat(W.from([n]));r=this.createProgramAddressSync(i,t)}catch(i){if(i instanceof TypeError)throw i;n--;continue}return[r,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){let t=new T(e);return js(t.toBytes())}};Oi=T;T.default=new Oi("11111111111111111111111111111111");Rr.set(T,{kind:"struct",fields:[["_bn","u256"]]});var Qs=class{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){let t=G(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=G(El()),this._publicKey=G(Sr(this._secretKey))}get publicKey(){return new T(this._publicKey)}get secretKey(){return W.concat([this._secretKey,this._publicKey],64)}},Pd=new T("BPFLoader1111111111111111111111111111111111"),Ct=1280-40-8,zn=127,Ar=64,Er=class extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}};Object.defineProperty(Er.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});var Ir=class extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}};Object.defineProperty(Ir.prototype,"name",{value:"TransactionExpiredTimeoutError"});var Tt=class extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}};Object.defineProperty(Tt.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});var Gt=class{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){let e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(let t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");let n=new Map;this.keySegments().flat().forEach((i,c)=>{n.set(i.toBase58(),c)});let r=i=>{let c=n.get(i.toBase58());if(c===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return c};return e.map(i=>({programIdIndex:r(i.programId),accountKeyIndexes:i.keys.map(c=>r(c.pubkey)),data:i.data}))}},H=(o="publicKey")=>g.blob(32,o),vl=(o="signature")=>g.blob(64,o),Lt=(o="string")=>{let e=g.struct([g.u32("length"),g.u32("lengthPadding"),g.blob(g.offset(g.u32(),-8),"chars")],o),t=e.decode.bind(e),n=e.encode.bind(e),r=e;return r.decode=(i,c)=>t(i,c).chars.toString(),r.encode=(i,c,f)=>{let p={chars:W.from(i,"utf8")};return n(p,c,f)},r.alloc=i=>g.u32().span+g.u32().span+W.from(i,"utf8").length,r},kl=(o="authorized")=>g.struct([H("staker"),H("withdrawer")],o),Nl=(o="lockup")=>g.struct([g.ns64("unixTimestamp"),g.ns64("epoch"),H("custodian")],o),Tl=(o="voteInit")=>g.struct([H("nodePubkey"),H("authorizedVoter"),H("authorizedWithdrawer"),g.u8("commission")],o),Ll=(o="voteAuthorizeWithSeedArgs")=>g.struct([g.u32("voteAuthorizationType"),H("currentAuthorityDerivedKeyOwnerPubkey"),Lt("currentAuthorityDerivedKeySeed"),H("newAuthorized")],o);function vi(o,e){let t=r=>{if(r.span>=0)return r.span;if(typeof r.alloc=="function")return r.alloc(e[r.property]);if("count"in r&&"elementLayout"in r){let i=e[r.property];if(Array.isArray(i))return i.length*t(r.elementLayout)}else if("fields"in r)return vi({layout:r},e[r.property]);return 0},n=0;return o.layout.fields.forEach(r=>{n+=t(r)}),n}function Qe(o){let e=0,t=0;for(;;){let n=o.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function rt(o,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){o.push(n);break}else n|=128,o.push(n)}}function j(o,e){if(!o)throw new Error(e||"Assertion failed")}var Ht=class{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){let n=new Map,r=c=>{let f=c.toBase58(),p=n.get(f);return p===void 0&&(p={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(f,p)),p},i=r(t);i.isSigner=!0,i.isWritable=!0;for(let c of e){r(c.programId).isInvoked=!0;for(let f of c.keys){let p=r(f.pubkey);p.isSigner||=f.isSigner,p.isWritable||=f.isWritable}}return new Ht(t,n)}getMessageComponents(){let e=[...this.keyMetaMap.entries()];j(e.length<=256,"Max static account keys length exceeded");let t=e.filter(([,p])=>p.isSigner&&p.isWritable),n=e.filter(([,p])=>p.isSigner&&!p.isWritable),r=e.filter(([,p])=>!p.isSigner&&p.isWritable),i=e.filter(([,p])=>!p.isSigner&&!p.isWritable),c={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:i.length};{j(t.length>0,"Expected at least one writable signer key");let[p]=t[0];j(p===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}let f=[...t.map(([p])=>new T(p)),...n.map(([p])=>new T(p)),...r.map(([p])=>new T(p)),...i.map(([p])=>new T(p))];return[c,f]}extractTableLookup(e){let[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,c=>!c.isSigner&&!c.isInvoked&&c.isWritable),[r,i]=this.drainKeysFoundInLookupTable(e.state.addresses,c=>!c.isSigner&&!c.isInvoked&&!c.isWritable);if(!(t.length===0&&r.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:r},{writable:n,readonly:i}]}drainKeysFoundInLookupTable(e,t){let n=new Array,r=new Array;for(let[i,c]of this.keyMetaMap.entries())if(t(c)){let f=new T(i),p=e.findIndex(A=>A.equals(f));p>=0&&(j(p<256,"Max lookup table index exceeded"),n.push(p),r.push(f),this.keyMetaMap.delete(i))}return[n,r]}},ki="Reached end of buffer unexpectedly";function lt(o){if(o.length===0)throw new Error(ki);return o.shift()}function et(o,...e){let[t]=e;if(e.length===2?t+(e[1]??0)>o.length:t>=o.length)throw new Error(ki);return o.splice(...e)}var ot=class{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new T(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:Xe.default.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Gt(this.staticAccountKeys)}static compile(e){let t=Ht.compile(e.instructions,e.payerKey),[n,r]=t.getMessageComponents(),c=new Gt(r).compileInstructions(e.instructions).map(f=>({programIdIndex:f.programIdIndex,accounts:f.accountKeyIndexes,data:Xe.default.encode(f.data)}));return new ot({header:n,accountKeys:r,recentBlockhash:e.recentBlockhash,instructions:c})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){let t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){let n=e-t,i=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<i}else{let n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){let e=this.accountKeys.length,t=[];rt(t,e);let n=this.instructions.map(I=>{let{accounts:M,programIdIndex:E}=I,k=Array.from(Xe.default.decode(I.data)),v=[];rt(v,M.length);let B=[];return rt(B,k.length),{programIdIndex:E,keyIndicesCount:W.from(v),keyIndices:M,dataLength:W.from(B),data:k}}),r=[];rt(r,n.length);let i=W.alloc(Ct);W.from(r).copy(i);let c=r.length;n.forEach(I=>{let E=g.struct([g.u8("programIdIndex"),g.blob(I.keyIndicesCount.length,"keyIndicesCount"),g.seq(g.u8("keyIndex"),I.keyIndices.length,"keyIndices"),g.blob(I.dataLength.length,"dataLength"),g.seq(g.u8("userdatum"),I.data.length,"data")]).encode(I,i,c);c+=E}),i=i.slice(0,c);let f=g.struct([g.blob(1,"numRequiredSignatures"),g.blob(1,"numReadonlySignedAccounts"),g.blob(1,"numReadonlyUnsignedAccounts"),g.blob(t.length,"keyCount"),g.seq(H("key"),e,"keys"),H("recentBlockhash")]),p={numRequiredSignatures:W.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:W.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:W.from([this.header.numReadonlyUnsignedAccounts]),keyCount:W.from(t),keys:this.accountKeys.map(I=>G(I.toBytes())),recentBlockhash:Xe.default.decode(this.recentBlockhash)},A=W.alloc(2048),w=f.encode(p,A);return i.copy(A,w),A.slice(0,w+i.length)}static from(e){let t=[...e],n=lt(t);if(n!==(n&zn))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");let r=lt(t),i=lt(t),c=Qe(t),f=[];for(let M=0;M<c;M++){let E=et(t,0,_t);f.push(new T(W.from(E)))}let p=et(t,0,_t),A=Qe(t),w=[];for(let M=0;M<A;M++){let E=lt(t),k=Qe(t),v=et(t,0,k),B=Qe(t),U=et(t,0,B),Y=Xe.default.encode(W.from(U));w.push({programIdIndex:E,accounts:v,data:Y})}let I={header:{numRequiredSignatures:n,numReadonlySignedAccounts:r,numReadonlyUnsignedAccounts:i},recentBlockhash:Xe.default.encode(W.from(p)),accountKeys:f,instructions:w};return new ot(I)}},At=class{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(let t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Gt(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){let t=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){let r=e-n,i=this.addressTableLookups.reduce((c,f)=>c+f.writableIndexes.length,0);return r<i}else if(e>=this.header.numRequiredSignatures){let r=e-t,c=n-t-this.header.numReadonlyUnsignedAccounts;return r<c}else{let r=t-this.header.numReadonlySignedAccounts;return e<r}}resolveAddressTableLookups(e){let t={writable:[],readonly:[]};for(let n of this.addressTableLookups){let r=e.find(i=>i.key.equals(n.accountKey));if(!r)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(let i of n.writableIndexes)if(i<r.state.addresses.length)t.writable.push(r.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${n.accountKey.toBase58()}`);for(let i of n.readonlyIndexes)if(i<r.state.addresses.length)t.readonly.push(r.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${n.accountKey.toBase58()}`)}return t}static compile(e){let t=Ht.compile(e.instructions,e.payerKey),n=new Array,r={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(let w of i){let I=t.extractTableLookup(w);if(I!==void 0){let[M,{writable:E,readonly:k}]=I;n.push(M),r.writable.push(...E),r.readonly.push(...k)}}let[c,f]=t.getMessageComponents(),A=new Gt(f,r).compileInstructions(e.instructions);return new At({header:c,staticAccountKeys:f,recentBlockhash:e.recentBlockhash,compiledInstructions:A,addressTableLookups:n})}serialize(){let e=Array();rt(e,this.staticAccountKeys.length);let t=this.serializeInstructions(),n=Array();rt(n,this.compiledInstructions.length);let r=this.serializeAddressTableLookups(),i=Array();rt(i,this.addressTableLookups.length);let c=g.struct([g.u8("prefix"),g.struct([g.u8("numRequiredSignatures"),g.u8("numReadonlySignedAccounts"),g.u8("numReadonlyUnsignedAccounts")],"header"),g.blob(e.length,"staticAccountKeysLength"),g.seq(H(),this.staticAccountKeys.length,"staticAccountKeys"),H("recentBlockhash"),g.blob(n.length,"instructionsLength"),g.blob(t.length,"serializedInstructions"),g.blob(i.length,"addressTableLookupsLength"),g.blob(r.length,"serializedAddressTableLookups")]),f=new Uint8Array(Ct),p=1<<7,A=c.encode({prefix:p,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(w=>w.toBytes()),recentBlockhash:Xe.default.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:r},f);return f.slice(0,A)}serializeInstructions(){let e=0,t=new Uint8Array(Ct);for(let n of this.compiledInstructions){let r=Array();rt(r,n.accountKeyIndexes.length);let i=Array();rt(i,n.data.length);let c=g.struct([g.u8("programIdIndex"),g.blob(r.length,"encodedAccountKeyIndexesLength"),g.seq(g.u8(),n.accountKeyIndexes.length,"accountKeyIndexes"),g.blob(i.length,"encodedDataLength"),g.blob(n.data.length,"data")]);e+=c.encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(r),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:n.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0,t=new Uint8Array(Ct);for(let n of this.addressTableLookups){let r=Array();rt(r,n.writableIndexes.length);let i=Array();rt(i,n.readonlyIndexes.length);let c=g.struct([H("accountKey"),g.blob(r.length,"encodedWritableIndexesLength"),g.seq(g.u8(),n.writableIndexes.length,"writableIndexes"),g.blob(i.length,"encodedReadonlyIndexesLength"),g.seq(g.u8(),n.readonlyIndexes.length,"readonlyIndexes")]);e+=c.encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(r),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:n.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e],n=lt(t),r=n&zn;j(n!==r,"Expected versioned message but received legacy message");let i=r;j(i===0,`Expected versioned message with version 0 but found version ${i}`);let c={numRequiredSignatures:lt(t),numReadonlySignedAccounts:lt(t),numReadonlyUnsignedAccounts:lt(t)},f=[],p=Qe(t);for(let k=0;k<p;k++)f.push(new T(et(t,0,_t)));let A=Xe.default.encode(et(t,0,_t)),w=Qe(t),I=[];for(let k=0;k<w;k++){let v=lt(t),B=Qe(t),U=et(t,0,B),Y=Qe(t),le=new Uint8Array(et(t,0,Y));I.push({programIdIndex:v,accountKeyIndexes:U,data:le})}let M=Qe(t),E=[];for(let k=0;k<M;k++){let v=new T(et(t,0,_t)),B=Qe(t),U=et(t,0,B),Y=Qe(t),le=et(t,0,Y);E.push({accountKey:v,writableIndexes:U,readonlyIndexes:le})}return new At({header:c,staticAccountKeys:f,recentBlockhash:A,compiledInstructions:I,addressTableLookups:E})}},Ni={deserializeMessageVersion(o){let e=o[0],t=e&zn;return t===e?"legacy":t},deserialize:o=>{let e=Ni.deserializeMessageVersion(o);if(e==="legacy")return ot.from(o);if(e===0)return At.deserialize(o);throw new Error(`Transaction message version ${e} deserialization is not supported`)}},St=function(o){return o[o.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",o[o.PROCESSED=1]="PROCESSED",o[o.TIMED_OUT=2]="TIMED_OUT",o[o.NONCE_INVALID=3]="NONCE_INVALID",o}({}),Cl=W.alloc(Ar).fill(0),re=class{constructor(e){this.keys=void 0,this.programId=void 0,this.data=W.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}},X=class{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){let{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){let{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{let{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new re(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let v=0;v<t.length;v++)if(t[v].programId===void 0)throw new Error(`Transaction instruction index ${v} has undefined program id`);let r=[],i=[];t.forEach(v=>{v.keys.forEach(U=>{i.push({...U})});let B=v.programId.toString();r.includes(B)||r.push(B)}),r.forEach(v=>{i.push({pubkey:new T(v),isSigner:!1,isWritable:!1})});let c=[];i.forEach(v=>{let B=v.pubkey.toString(),U=c.findIndex(Y=>Y.pubkey.toString()===B);U>-1?(c[U].isWritable=c[U].isWritable||v.isWritable,c[U].isSigner=c[U].isSigner||v.isSigner):c.push(v)}),c.sort(function(v,B){if(v.isSigner!==B.isSigner)return v.isSigner?-1:1;if(v.isWritable!==B.isWritable)return v.isWritable?-1:1;let U={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return v.pubkey.toBase58().localeCompare(B.pubkey.toBase58(),"en",U)});let f=c.findIndex(v=>v.pubkey.equals(n));if(f>-1){let[v]=c.splice(f,1);v.isSigner=!0,v.isWritable=!0,c.unshift(v)}else c.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(let v of this.signatures){let B=c.findIndex(U=>U.pubkey.equals(v.publicKey));if(B>-1)c[B].isSigner||(c[B].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${v.publicKey.toString()}`)}let p=0,A=0,w=0,I=[],M=[];c.forEach(({pubkey:v,isSigner:B,isWritable:U})=>{B?(I.push(v.toString()),p+=1,U||(A+=1)):(M.push(v.toString()),U||(w+=1))});let E=I.concat(M),k=t.map(v=>{let{data:B,programId:U}=v;return{programIdIndex:E.indexOf(U.toString()),accounts:v.keys.map(Y=>E.indexOf(Y.pubkey.toString())),data:Xe.default.encode(B)}});return k.forEach(v=>{j(v.programIdIndex>=0),v.accounts.forEach(B=>j(B>=0))}),new ot({header:{numRequiredSignatures:p,numReadonlySignedAccounts:A,numReadonlyUnsignedAccounts:w},accountKeys:E,recentBlockhash:e,instructions:k})}_compile(){let e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((r,i)=>t[i].equals(r.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");let t=new Set;this.signatures=e.filter(n=>{let r=n.toString();return t.has(r)?!1:(t.add(r),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");let t=new Set,n=[];for(let i of e){let c=i.publicKey.toString();t.has(c)||(t.add(c),n.push(i))}this.signatures=n.map(i=>({signature:null,publicKey:i.publicKey}));let r=this._compile();this._partialSign(r,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");let t=new Set,n=[];for(let i of e){let c=i.publicKey.toString();t.has(c)||(t.add(c),n.push(i))}let r=this._compile();this._partialSign(r,...n)}_partialSign(e,...t){let n=e.serialize();t.forEach(r=>{let i=Un(n,r.secretKey);this._addSignature(r.publicKey,G(i))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){j(t.length===64);let n=this.signatures.findIndex(r=>e.equals(r.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=W.from(t)}verifySignatures(e=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),e)}_getMessageSignednessErrors(e,t){let n={};for(let{signature:r,publicKey:i}of this.signatures)r===null?t&&(n.missing||=[]).push(i):Il(r,e,i.toBytes())||(n.invalid||=[]).push(i);return n.invalid||n.missing?n:void 0}serialize(e){let{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),r=this.serializeMessage();if(n){let i=this._getMessageSignednessErrors(r,t);if(i){let c="Signature verification failed.";throw i.invalid&&(c+=`
Invalid signature for public key${i.invalid.length===1?"":"(s)"} [\`${i.invalid.map(f=>f.toBase58()).join("`, `")}\`].`),i.missing&&(c+=`
Missing signature for public key${i.missing.length===1?"":"(s)"} [\`${i.missing.map(f=>f.toBase58()).join("`, `")}\`].`),new Error(c)}}return this._serialize(r)}_serialize(e){let{signatures:t}=this,n=[];rt(n,t.length);let r=n.length+t.length*64+e.length,i=W.alloc(r);return j(t.length<256),W.from(n).copy(i,0),t.forEach(({signature:c},f)=>{c!==null&&(j(c.length===64,"signature has invalid length"),W.from(c).copy(i,n.length+f*64))}),e.copy(i,n.length+t.length*64),j(i.length<=Ct,`Transaction too large: ${i.length} > ${Ct}`),i}get keys(){return j(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return j(this.instructions.length===1),this.instructions[0].programId}get data(){return j(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e],n=Qe(t),r=[];for(let i=0;i<n;i++){let c=et(t,0,Ar);r.push(Xe.default.encode(W.from(c)))}return X.populate(ot.from(t),r)}static populate(e,t=[]){let n=new X;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((r,i)=>{let c={signature:r==Xe.default.encode(Cl)?null:Xe.default.decode(r),publicKey:e.accountKeys[i]};n.signatures.push(c)}),e.instructions.forEach(r=>{let i=r.accounts.map(c=>{let f=e.accountKeys[c];return{pubkey:f,isSigner:n.signatures.some(p=>p.publicKey.toString()===f.toString())||e.isAccountSigner(c),isWritable:e.isAccountWritable(c)}});n.instructions.push(new re({keys:i,programId:e.accountKeys[r.programIdIndex],data:Xe.default.decode(r.data)}))}),n._message=e,n._json=n.toJSON(),n}},wr=class{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){let{header:n,compiledInstructions:r,recentBlockhash:i}=e,{numRequiredSignatures:c,numReadonlySignedAccounts:f,numReadonlyUnsignedAccounts:p}=n,A=c-f;j(A>0,"Message header is invalid");let w=e.staticAccountKeys.length-c-p;j(w>=0,"Message header is invalid");let I=e.getAccountKeys(t),M=I.get(0);if(M===void 0)throw new Error("Failed to decompile message because no account keys were found");let E=[];for(let k of r){let v=[];for(let U of k.accountKeyIndexes){let Y=I.get(U);if(Y===void 0)throw new Error(`Failed to find key for account key index ${U}`);let le=U<c,J;le?J=U<A:U<I.staticAccountKeys.length?J=U-c<w:J=U-I.staticAccountKeys.length<I.accountKeysFromLookups.writable.length,v.push({pubkey:Y,isSigner:U<n.numRequiredSignatures,isWritable:J})}let B=I.get(k.programIdIndex);if(B===void 0)throw new Error(`Failed to find program id for program id index ${k.programIdIndex}`);E.push(new re({programId:B,data:G(k.data),keys:v}))}return new wr({payerKey:M,instructions:E,recentBlockhash:i})}compileToLegacyMessage(){return ot.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return At.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}},Or=class{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)j(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{let n=[];for(let r=0;r<e.header.numRequiredSignatures;r++)n.push(new Uint8Array(Ar));this.signatures=n}this.message=e}serialize(){let e=this.message.serialize(),t=Array();rt(t,this.signatures.length);let n=g.struct([g.blob(t.length,"encodedSignaturesLength"),g.seq(vl(),this.signatures.length,"signatures"),g.blob(e.length,"serializedMessage")]),r=new Uint8Array(2048),i=n.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},r);return r.slice(0,i)}static deserialize(e){let t=[...e],n=[],r=Qe(t);for(let c=0;c<r;c++)n.push(new Uint8Array(et(t,0,Ar)));let i=Ni.deserialize(new Uint8Array(t));return new Or(i,n)}sign(e){let t=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(let r of e){let i=n.findIndex(c=>c.equals(r.publicKey));j(i>=0,`Cannot sign with non signer key ${r.publicKey.toBase58()}`),this.signatures[i]=Un(t,r.secretKey)}}addSignature(e,t){j(t.byteLength===64,"Signature must be 64 bytes long");let r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(i=>i.equals(e));j(r>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[r]=t}},xl=160,Bl=64,Ml=xl/Bl,Ti=1e3/Ml,ht=new T("SysvarC1ock11111111111111111111111111111111"),Dd=new T("SysvarEpochSchedu1e111111111111111111111111"),Ud=new T("Sysvar1nstructions1111111111111111111111111"),An=new T("SysvarRecentB1ockHashes11111111111111111111"),nr=new T("SysvarRent111111111111111111111111111111111"),zd=new T("SysvarRewards111111111111111111111111111111"),Kd=new T("SysvarS1otHashes111111111111111111111111111"),Fd=new T("SysvarS1otHistory11111111111111111111111111"),En=new T("SysvarStakeHistory1111111111111111111111111"),qt=class extends Error{constructor({action:e,signature:t,transactionMessage:n,logs:r}){let i=r?`Logs: 
${JSON.stringify(r.slice(-10),null,2)}. `:"",c="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.",f;switch(e){case"send":f=`Transaction ${t} resulted in an error. 
${n}. `+i+c;break;case"simulate":f=`Simulation failed. 
Message: ${n}. 
`+i+c;break;default:f=`Unknown action '${(p=>p)(e)}'`}super(f),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=t,this.transactionMessage=n,this.transactionLogs=r||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){let e=this.transactionLogs;if(!(e!=null&&typeof e=="object"&&"then"in e))return e}async getLogs(e){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((t,n)=>{e.getTransaction(this.signature).then(r=>{if(r&&r.meta&&r.meta.logMessages){let i=r.meta.logMessages;this.transactionLogs=i,t(i)}else n(new Error("Log messages not found"))}).catch(n)})),await this.transactionLogs}},Wd={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016},D=class extends Error{constructor({code:e,message:t,data:n},r){super(r!=null?`${r}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}};async function ei(o,e,t,n){let r=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},i=await o.sendTransaction(e,t,r),c;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)c=(await o.confirmTransaction({abortSignal:n?.abortSignal,signature:i,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){let{nonceInstruction:f}=e.nonceInfo,p=f.keys[0].pubkey;c=(await o.confirmTransaction({abortSignal:n?.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:p,nonceValue:e.nonceInfo.nonce,signature:i},n&&n.commitment)).value}else n?.abortSignal!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),c=(await o.confirmTransaction(i,n&&n.commitment)).value;if(c.err)throw i!=null?new qt({action:"send",signature:i,transactionMessage:`Status: (${JSON.stringify(c)})`}):new Error(`Transaction ${i} failed (${JSON.stringify(c)})`);return i}function Nt(o){return new Promise(e=>setTimeout(e,o))}function q(o,e){let t=o.layout.span>=0?o.layout.span:vi(o,e),n=W.alloc(t),r=Object.assign({instruction:o.index},e);return o.layout.encode(r,n),n}function Q(o,e){let t;try{t=o.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.instruction!==o.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${o.index}`);return t}var Pl=g.nu64("lamportsPerSignature"),Li=g.struct([g.u32("version"),g.u32("state"),H("authorizedPubkey"),H("nonce"),g.struct([Pl],"feeCalculator")]),ti=Li.span,sr=class{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){let t=Li.decode(G(e),0);return new sr({authorizedPubkey:new T(t.authorizedPubkey),nonce:new T(t.nonce).toString(),feeCalculator:t.feeCalculator})}};function Yt(o){let e=(0,Ii.blob)(8,o),t=e.decode.bind(e),n=e.encode.bind(e),r=e,i=xs();return r.decode=(c,f)=>{let p=t(c,f);return i.decode(p)},r.encode=(c,f,p)=>{let A=i.encode(c);return n(A,f,p)},r}var ri=class{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);let n=g.u32("instruction").decode(e.data),r;for(let[i,c]of Object.entries(oe))if(c.index==n){r=i;break}if(!r)throw new Error("Instruction type incorrect; not a SystemInstruction");return r}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);let{lamports:t,space:n,programId:r}=Q(oe.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:n,programId:new T(r)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);let{lamports:t}=Q(oe.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);let{lamports:t,seed:n,programId:r}=Q(oe.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:n,programId:new T(r)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);let{space:t}=Q(oe.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);let{base:t,seed:n,space:r,programId:i}=Q(oe.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new T(t),seed:n,space:r,programId:new T(i)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);let{programId:t}=Q(oe.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new T(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);let{base:t,seed:n,programId:r}=Q(oe.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new T(t),seed:n,programId:new T(r)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);let{base:t,seed:n,lamports:r,space:i,programId:c}=Q(oe.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new T(t),seed:n,lamports:r,space:i,programId:new T(c)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);let{authorized:t}=Q(oe.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new T(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Q(oe.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);let{lamports:t}=Q(oe.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);let{authorized:t}=Q(oe.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new T(t)}}static checkProgramId(e){if(!e.equals(Ye.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}},oe=Object.freeze({Create:{index:0,layout:g.struct([g.u32("instruction"),g.ns64("lamports"),g.ns64("space"),H("programId")])},Assign:{index:1,layout:g.struct([g.u32("instruction"),H("programId")])},Transfer:{index:2,layout:g.struct([g.u32("instruction"),Yt("lamports")])},CreateWithSeed:{index:3,layout:g.struct([g.u32("instruction"),H("base"),Lt("seed"),g.ns64("lamports"),g.ns64("space"),H("programId")])},AdvanceNonceAccount:{index:4,layout:g.struct([g.u32("instruction")])},WithdrawNonceAccount:{index:5,layout:g.struct([g.u32("instruction"),g.ns64("lamports")])},InitializeNonceAccount:{index:6,layout:g.struct([g.u32("instruction"),H("authorized")])},AuthorizeNonceAccount:{index:7,layout:g.struct([g.u32("instruction"),H("authorized")])},Allocate:{index:8,layout:g.struct([g.u32("instruction"),g.ns64("space")])},AllocateWithSeed:{index:9,layout:g.struct([g.u32("instruction"),H("base"),Lt("seed"),g.ns64("space"),H("programId")])},AssignWithSeed:{index:10,layout:g.struct([g.u32("instruction"),H("base"),Lt("seed"),H("programId")])},TransferWithSeed:{index:11,layout:g.struct([g.u32("instruction"),Yt("lamports"),Lt("seed"),H("programId")])},UpgradeNonceAccount:{index:12,layout:g.struct([g.u32("instruction")])}}),Ye=class{constructor(){}static createAccount(e){let t=oe.Create,n=q(t,{lamports:e.lamports,space:e.space,programId:G(e.programId.toBuffer())});return new re({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){let r=oe.TransferWithSeed;t=q(r,{lamports:BigInt(e.lamports),seed:e.seed,programId:G(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{let r=oe.Transfer;t=q(r,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new re({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){let r=oe.AssignWithSeed;t=q(r,{base:G(e.basePubkey.toBuffer()),seed:e.seed,programId:G(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{let r=oe.Assign;t=q(r,{programId:G(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new re({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){let t=oe.CreateWithSeed,n=q(t,{base:G(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:G(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey.equals(e.fromPubkey)||r.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new re({keys:r,programId:this.programId,data:n})}static createNonceAccount(e){let t=new X;"basePubkey"in e&&"seed"in e?t.add(Ye.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:ti,programId:this.programId})):t.add(Ye.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:ti,programId:this.programId}));let n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){let t=oe.InitializeNonceAccount,n=q(t,{authorized:G(e.authorizedPubkey.toBuffer())}),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:An,isSigner:!1,isWritable:!1},{pubkey:nr,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new re(r)}static nonceAdvance(e){let t=oe.AdvanceNonceAccount,n=q(t),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:An,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new re(r)}static nonceWithdraw(e){let t=oe.WithdrawNonceAccount,n=q(t,{lamports:e.lamports});return new re({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:An,isSigner:!1,isWritable:!1},{pubkey:nr,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){let t=oe.AuthorizeNonceAccount,n=q(t,{authorized:G(e.newAuthorizedPubkey.toBuffer())});return new re({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){let r=oe.AllocateWithSeed;t=q(r,{base:G(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:G(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{let r=oe.Allocate;t=q(r,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new re({keys:n,programId:this.programId,data:t})}};Ye.programId=new T("11111111111111111111111111111111");var Dl=Ct-300,Et=class{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/Et.chunkSize)+1+1)}static async load(e,t,n,r,i){{let I=await e.getMinimumBalanceForRentExemption(i.length),M=await e.getAccountInfo(n.publicKey,"confirmed"),E=null;if(M!==null){if(M.executable)return console.error("Program load failed, account is already executable"),!1;M.data.length!==i.length&&(E=E||new X,E.add(Ye.allocate({accountPubkey:n.publicKey,space:i.length}))),M.owner.equals(r)||(E=E||new X,E.add(Ye.assign({accountPubkey:n.publicKey,programId:r}))),M.lamports<I&&(E=E||new X,E.add(Ye.transfer({fromPubkey:t.publicKey,toPubkey:n.publicKey,lamports:I-M.lamports})))}else E=new X().add(Ye.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:I>0?I:1,space:i.length,programId:r}));E!==null&&await ei(e,E,[t,n],{commitment:"confirmed"})}let c=g.struct([g.u32("instruction"),g.u32("offset"),g.u32("bytesLength"),g.u32("bytesLengthPadding"),g.seq(g.u8("byte"),g.offset(g.u32(),-8),"bytes")]),f=Et.chunkSize,p=0,A=i,w=[];for(;A.length>0;){let I=A.slice(0,f),M=W.alloc(f+16);c.encode({instruction:0,offset:p,bytes:I,bytesLength:0,bytesLengthPadding:0},M);let E=new X().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0}],programId:r,data:M});w.push(ei(e,E,[t,n],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await Nt(1e3/4),p+=f,A=A.slice(f)}await Promise.all(w);{let I=g.struct([g.u32("instruction")]),M=W.alloc(I.span);I.encode({instruction:1},M);let E=new X().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0},{pubkey:nr,isSigner:!1,isWritable:!1}],programId:r,data:M}),k="processed",v=await e.sendTransaction(E,[t,n],{preflightCommitment:k}),{context:B,value:U}=await e.confirmTransaction({signature:v,lastValidBlockHeight:E.lastValidBlockHeight,blockhash:E.recentBlockhash},k);if(U.err)throw new Error(`Transaction ${v} failed (${JSON.stringify(U)})`);for(;;){try{if(await e.getSlot({commitment:k})>B.slot)break}catch{}await new Promise(Y=>setTimeout(Y,Math.round(Ti/2)))}}return!0}};Et.chunkSize=Dl;var $d=new T("BPFLoader2111111111111111111111111111111111"),ni=class{static getMinNumSignatures(e){return Et.getMinNumSignatures(e)}static load(e,t,n,r,i){return Et.load(e,t,n,i,r)}};function Ul(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var In,si;function zl(){if(si)return In;si=1;var o=Object.prototype.toString,e=Object.keys||function(n){var r=[];for(var i in n)r.push(i);return r};function t(n,r){var i,c,f,p,A,w,I;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return t(n.toJSON(),r);if(I=o.call(n),I==="[object Array]"){for(f="[",c=n.length-1,i=0;i<c;i++)f+=t(n[i],!0)+",";return c>-1&&(f+=t(n[i],!0)),f+"]"}else if(I==="[object Object]"){for(p=e(n).sort(),c=p.length,f="",i=0;i<c;)A=p[i],w=t(n[A],!1),w!==void 0&&(f&&(f+=","),f+=JSON.stringify(A)+":"+w),i++;return"{"+f+"}"}else return JSON.stringify(n);case"function":case"undefined":return r?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}return In=function(n){var r=t(n,!1);if(r!==void 0)return""+r},In}var Kl=zl(),ii=Ul(Kl),rr=32;function wn(o){let e=0;for(;o>1;)o/=2,e++;return e}function Fl(o){return o===0?1:(o--,o|=o>>1,o|=o>>2,o|=o>>4,o|=o>>8,o|=o>>16,o|=o>>32,o+1)}var Ln=class{constructor(e,t,n,r,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=n,this.firstNormalEpoch=r,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){let t=wn(Fl(e+rr+1))-wn(rr)-1,n=this.getSlotsInEpoch(t),r=e-(n-rr);return[t,r]}else{let t=e-this.firstNormalSlot,n=Math.floor(t/this.slotsPerEpoch),r=this.firstNormalEpoch+n,i=t%this.slotsPerEpoch;return[r,i]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*rr:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+wn(rr)):this.slotsPerEpoch}},Wl=globalThis.fetch,Cn=class extends us{constructor(e,t,n){let r=i=>{let c=cs(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in c?this.underlyingSocket=c.socket:this.underlyingSocket=c,c};super(r,e,t,n),this.underlyingSocket=void 0}call(...e){let t=this.underlyingSocket?.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){let t=this.underlyingSocket?.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}};function $l(o,e){let t;try{t=o.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.typeIndex!==o.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${o.index}`);return t}var oi=56,vr=class{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){let e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){let t=$l(Vl,e),n=e.length-oi;j(n>=0,"lookup table is invalid"),j(n%32===0,"lookup table is invalid");let r=n/32,{addresses:i}=g.struct([g.seq(H(),r,"addresses")]).decode(e.slice(oi));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new T(t.authority[0]):void 0,addresses:i.map(c=>new T(c))}}},Vl={index:1,layout:g.struct([g.u32("typeIndex"),Yt("deactivationSlot"),g.nu64("lastExtendedSlot"),g.u8("lastExtendedStartIndex"),g.u8(),g.seq(H(),g.offset(g.u8(),-1),"authority")])},Gl=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Hl(o){let e=o.match(Gl);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${o}\``);let[t,n,r,i]=e,c=o.startsWith("https:")?"wss:":"ws:",f=r==null?null:parseInt(r.slice(1),10),p=f==null?"":`:${f+1}`;return`${c}//${n}${p}${i}`}var fe=$t(gr(T),N(),o=>new T(o)),Ci=pr([N(),ue("base64")]),Kn=$t(gr(W),Ci,o=>W.from(o[0],"base64")),ql=30*1e3;function Yl(o){if(/^https?:/.test(o)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return o}function ie(o){let e,t;if(typeof o=="string")e=o;else if(o){let{commitment:n,...r}=o;e=n,t=r}return{commitment:e,config:t}}function ai(o){return o.map(e=>"memcmp"in e?{...e,memcmp:{...e.memcmp,encoding:e.memcmp.encoding??"base58"}}:e)}function xi(o){return Je([O({jsonrpc:ue("2.0"),id:N(),result:o}),O({jsonrpc:ue("2.0"),id:N(),error:O({code:kt(),message:N(),data:F(Ps())})})])}var Xl=xi(kt());function V(o){return $t(xi(o),Xl,e=>"error"in e?e:{...e,result:L(e.result,o)})}function de(o){return V(O({context:O({slot:b()}),value:o}))}function xr(o){return O({context:O({slot:b()}),value:o})}function On(o,e){return o===0?new At({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new T(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:Xe.default.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new ot(e)}var jl=O({foundation:b(),foundationTerm:b(),initial:b(),taper:b(),terminal:b()}),Jl=V(C(x(O({epoch:b(),effectiveSlot:b(),amount:b(),postBalance:b(),commission:F(x(b()))})))),Zl=C(O({slot:b(),prioritizationFee:b()})),Ql=O({total:b(),validator:b(),foundation:b(),epoch:b()}),ef=O({epoch:b(),slotIndex:b(),slotsInEpoch:b(),absoluteSlot:b(),blockHeight:F(b()),transactionCount:F(b())}),tf=O({slotsPerEpoch:b(),leaderScheduleSlotOffset:b(),warmup:ut(),firstNormalEpoch:b(),firstNormalSlot:b()}),rf=Sn(N(),C(b())),Pt=x(Je([O({}),N()])),nf=O({err:Pt}),sf=ue("receivedSignature"),of=O({"solana-core":N(),"feature-set":F(b())}),af=O({program:N(),programId:fe,parsed:kt()}),cf=O({programId:fe,accounts:C(fe),data:N()}),ci=de(O({err:x(Je([O({}),N()])),logs:x(C(N())),accounts:F(x(C(x(O({executable:ut(),owner:N(),lamports:b(),data:C(N()),rentEpoch:F(b())}))))),unitsConsumed:F(b()),returnData:F(x(O({programId:N(),data:pr([N(),ue("base64")])}))),innerInstructions:F(x(C(O({index:b(),instructions:C(Je([af,cf]))}))))})),uf=de(O({byIdentity:Sn(N(),C(b())),range:O({firstSlot:b(),lastSlot:b()})}));function lf(o,e,t,n,r,i){let c=t||Wl,f;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let p;return n&&(p=async(w,I)=>{let M=await new Promise((E,k)=>{try{n(w,I,(v,B)=>E([v,B]))}catch(v){k(v)}});return await c(...M)}),new wi.default(async(w,I)=>{let M={method:"POST",body:w,agent:f,headers:Object.assign({"Content-Type":"application/json"},e||{},lh)};try{let E=5,k,v=500;for(;p?k=await p(o,M):k=await c(o,M),!(k.status!==429||r===!0||(E-=1,E===0));)console.error(`Server responded with ${k.status} ${k.statusText}.  Retrying after ${v}ms delay...`),await Nt(v),v*=2;let B=await k.text();k.ok?I(null,B):I(new Error(`${k.status} ${k.statusText}: ${B}`))}catch(E){E instanceof Error&&I(E)}},{})}function ff(o){return(e,t)=>new Promise((n,r)=>{o.request(e,t,(i,c)=>{if(i){r(i);return}n(c)})})}function hf(o){return e=>new Promise((t,n)=>{e.length===0&&t([]);let r=e.map(i=>o.request(i.methodName,i.args));o.request(r,(i,c)=>{if(i){n(i);return}t(c)})})}var df=V(jl),_f=V(Ql),gf=V(Zl),pf=V(ef),yf=V(tf),mf=V(rf),Rf=V(b()),Sf=de(O({total:b(),circulating:b(),nonCirculating:b(),nonCirculatingAccounts:C(fe)})),xn=O({amount:N(),uiAmount:x(b()),decimals:b(),uiAmountString:F(N())}),bf=de(C(O({address:fe,amount:N(),uiAmount:x(b()),decimals:b(),uiAmountString:F(N())}))),Af=de(C(O({pubkey:fe,account:O({executable:ut(),owner:fe,lamports:b(),data:Kn,rentEpoch:b()})}))),Bn=O({program:N(),parsed:kt(),space:b()}),Ef=de(C(O({pubkey:fe,account:O({executable:ut(),owner:fe,lamports:b(),data:Bn,rentEpoch:b()})}))),If=de(C(O({lamports:b(),address:fe}))),ir=O({executable:ut(),owner:fe,lamports:b(),data:Kn,rentEpoch:b()}),wf=O({pubkey:fe,account:ir}),Of=$t(Je([gr(W),Bn]),Je([Ci,Bn]),o=>Array.isArray(o)?L(o,Kn):o),Mn=O({executable:ut(),owner:fe,lamports:b(),data:Of,rentEpoch:b()}),vf=O({pubkey:fe,account:Mn}),kf=O({state:Je([ue("active"),ue("inactive"),ue("activating"),ue("deactivating")]),active:b(),inactive:b()}),Nf=V(C(O({signature:N(),slot:b(),err:Pt,memo:x(N()),blockTime:F(x(b()))}))),Tf=V(C(O({signature:N(),slot:b(),err:Pt,memo:x(N()),blockTime:F(x(b()))}))),Lf=O({subscription:b(),result:xr(ir)}),Cf=O({pubkey:fe,account:ir}),xf=O({subscription:b(),result:xr(Cf)}),Bf=O({parent:b(),slot:b(),root:b()}),Mf=O({subscription:b(),result:Bf}),Pf=Je([O({type:Je([ue("firstShredReceived"),ue("completed"),ue("optimisticConfirmation"),ue("root")]),slot:b(),timestamp:b()}),O({type:ue("createdBank"),parent:b(),slot:b(),timestamp:b()}),O({type:ue("frozen"),slot:b(),timestamp:b(),stats:O({numTransactionEntries:b(),numSuccessfulTransactions:b(),numFailedTransactions:b(),maxTransactionsPerEntry:b()})}),O({type:ue("dead"),slot:b(),timestamp:b(),err:N()})]),Df=O({subscription:b(),result:Pf}),Uf=O({subscription:b(),result:xr(Je([nf,sf]))}),zf=O({subscription:b(),result:b()}),Kf=O({pubkey:N(),gossip:x(N()),tpu:x(N()),rpc:x(N()),version:x(N())}),ui=O({votePubkey:N(),nodePubkey:N(),activatedStake:b(),epochVoteAccount:ut(),epochCredits:C(pr([b(),b(),b()])),commission:b(),lastVote:b(),rootSlot:x(b())}),Ff=V(O({current:C(ui),delinquent:C(ui)})),Wf=Je([ue("processed"),ue("confirmed"),ue("finalized")]),$f=O({slot:b(),confirmations:x(b()),err:Pt,confirmationStatus:F(Wf)}),Vf=de(C(x($f))),Gf=V(b()),Bi=O({accountKey:fe,writableIndexes:C(b()),readonlyIndexes:C(b())}),Fn=O({signatures:C(N()),message:O({accountKeys:C(N()),header:O({numRequiredSignatures:b(),numReadonlySignedAccounts:b(),numReadonlyUnsignedAccounts:b()}),instructions:C(O({accounts:C(b()),data:N(),programIdIndex:b()})),recentBlockhash:N(),addressTableLookups:F(C(Bi))})}),Mi=O({pubkey:fe,signer:ut(),writable:ut(),source:F(Je([ue("transaction"),ue("lookupTable")]))}),Pi=O({accountKeys:C(Mi),signatures:C(N())}),Di=O({parsed:kt(),program:N(),programId:fe}),Ui=O({accounts:C(fe),data:N(),programId:fe}),Hf=Je([Ui,Di]),qf=Je([O({parsed:kt(),program:N(),programId:N()}),O({accounts:C(N()),data:N(),programId:N()})]),zi=$t(Hf,qf,o=>"accounts"in o?L(o,Ui):L(o,Di)),Ki=O({signatures:C(N()),message:O({accountKeys:C(Mi),instructions:C(zi),recentBlockhash:N(),addressTableLookups:F(x(C(Bi)))})}),kr=O({accountIndex:b(),mint:N(),owner:F(N()),programId:F(N()),uiTokenAmount:xn}),Fi=O({writable:C(fe),readonly:C(fe)}),Br=O({err:Pt,fee:b(),innerInstructions:F(x(C(O({index:b(),instructions:C(O({accounts:C(b()),data:N(),programIdIndex:b()}))})))),preBalances:C(b()),postBalances:C(b()),logMessages:F(x(C(N()))),preTokenBalances:F(x(C(kr))),postTokenBalances:F(x(C(kr))),loadedAddresses:F(Fi),computeUnitsConsumed:F(b())}),Wn=O({err:Pt,fee:b(),innerInstructions:F(x(C(O({index:b(),instructions:C(zi)})))),preBalances:C(b()),postBalances:C(b()),logMessages:F(x(C(N()))),preTokenBalances:F(x(C(kr))),postTokenBalances:F(x(C(kr))),loadedAddresses:F(Fi),computeUnitsConsumed:F(b())}),Jt=Je([ue(0),ue("legacy")]),Dt=O({pubkey:N(),lamports:b(),postBalance:x(b()),rewardType:x(N()),commission:F(x(b()))}),Yf=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),transactions:C(O({transaction:Fn,meta:x(Br),version:F(Jt)})),rewards:F(C(Dt)),blockTime:x(b()),blockHeight:x(b())}))),Xf=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),rewards:F(C(Dt)),blockTime:x(b()),blockHeight:x(b())}))),jf=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),transactions:C(O({transaction:Pi,meta:x(Br),version:F(Jt)})),rewards:F(C(Dt)),blockTime:x(b()),blockHeight:x(b())}))),Jf=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),transactions:C(O({transaction:Ki,meta:x(Wn),version:F(Jt)})),rewards:F(C(Dt)),blockTime:x(b()),blockHeight:x(b())}))),Zf=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),transactions:C(O({transaction:Pi,meta:x(Wn),version:F(Jt)})),rewards:F(C(Dt)),blockTime:x(b()),blockHeight:x(b())}))),Qf=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),rewards:F(C(Dt)),blockTime:x(b()),blockHeight:x(b())}))),eh=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),transactions:C(O({transaction:Fn,meta:x(Br)})),rewards:F(C(Dt)),blockTime:x(b())}))),li=V(x(O({blockhash:N(),previousBlockhash:N(),parentSlot:b(),signatures:C(N()),blockTime:x(b())}))),vn=V(x(O({slot:b(),meta:x(Br),blockTime:F(x(b())),transaction:Fn,version:F(Jt)}))),mr=V(x(O({slot:b(),transaction:Ki,meta:x(Wn),blockTime:F(x(b())),version:F(Jt)}))),th=de(O({blockhash:N(),lastValidBlockHeight:b()})),rh=de(ut()),nh=O({slot:b(),numTransactions:b(),numSlots:b(),samplePeriodSecs:b()}),sh=V(C(nh)),ih=de(x(O({feeCalculator:O({lamportsPerSignature:b()})}))),oh=V(N()),ah=V(N()),ch=O({err:Pt,logs:C(N()),signature:N()}),uh=O({result:xr(ch),subscription:b()}),lh={"solana-client":"js/1.0.0-maintenance"},fi=class{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{let A={};return async w=>{let{commitment:I,config:M}=ie(w),E=this._buildArgs([],I,void 0,M),k=ii(E);return A[k]=A[k]??(async()=>{try{let v=await this._rpcRequest("getBlockHeight",E),B=L(v,V(b()));if("error"in B)throw new D(B.error,"failed to get block height information");return B.result}finally{delete A[k]}})(),await A[k]}})();let n,r,i,c,f,p;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,n=t.wsEndpoint,r=t.httpHeaders,i=t.fetch,c=t.fetchMiddleware,f=t.disableRetryOnRateLimit,p=t.httpAgent),this._rpcEndpoint=Yl(e),this._rpcWsEndpoint=n||Hl(e),this._rpcClient=lf(e,r,i,c,f,p),this._rpcRequest=ff(this._rpcClient),this._rpcBatchRequest=hf(this._rpcClient),this._rpcWebSocket=new Cn(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgs([e.toBase58()],n,void 0,r),c=await this._rpcRequest("getBalance",i),f=L(c,de(b()));if("error"in f)throw new D(f.error,`failed to get balance for ${e.toBase58()}`);return f.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){let t=await this._rpcRequest("getBlockTime",[e]),n=L(t,V(x(b())));if("error"in n)throw new D(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){let e=await this._rpcRequest("minimumLedgerSlot",[]),t=L(e,V(b()));if("error"in t)throw new D(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){let e=await this._rpcRequest("getFirstAvailableBlock",[]),t=L(e,Rf);if("error"in t)throw new D(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};let n=await this._rpcRequest("getSupply",[t]),r=L(n,Sf);if("error"in r)throw new D(r.error,"failed to get supply");return r.result}async getTokenSupply(e,t){let n=this._buildArgs([e.toBase58()],t),r=await this._rpcRequest("getTokenSupply",n),i=L(r,de(xn));if("error"in i)throw new D(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){let n=this._buildArgs([e.toBase58()],t),r=await this._rpcRequest("getTokenAccountBalance",n),i=L(r,de(xn));if("error"in i)throw new D(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,n){let{commitment:r,config:i}=ie(n),c=[e.toBase58()];"mint"in t?c.push({mint:t.mint.toBase58()}):c.push({programId:t.programId.toBase58()});let f=this._buildArgs(c,r,"base64",i),p=await this._rpcRequest("getTokenAccountsByOwner",f),A=L(p,Af);if("error"in A)throw new D(A.error,`failed to get token accounts owned by account ${e.toBase58()}`);return A.result}async getParsedTokenAccountsByOwner(e,t,n){let r=[e.toBase58()];"mint"in t?r.push({mint:t.mint.toBase58()}):r.push({programId:t.programId.toBase58()});let i=this._buildArgs(r,n,"jsonParsed"),c=await this._rpcRequest("getTokenAccountsByOwner",i),f=L(c,Ef);if("error"in f)throw new D(f.error,`failed to get token accounts owned by account ${e.toBase58()}`);return f.result}async getLargestAccounts(e){let t={...e,commitment:e&&e.commitment||this.commitment},n=t.filter||t.commitment?[t]:[],r=await this._rpcRequest("getLargestAccounts",n),i=L(r,If);if("error"in i)throw new D(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){let n=this._buildArgs([e.toBase58()],t),r=await this._rpcRequest("getTokenLargestAccounts",n),i=L(r,bf);if("error"in i)throw new D(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgs([e.toBase58()],n,"base64",r),c=await this._rpcRequest("getAccountInfo",i),f=L(c,de(x(ir)));if("error"in f)throw new D(f.error,`failed to get info about account ${e.toBase58()}`);return f.result}async getParsedAccountInfo(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgs([e.toBase58()],n,"jsonParsed",r),c=await this._rpcRequest("getAccountInfo",i),f=L(c,de(x(Mn)));if("error"in f)throw new D(f.error,`failed to get info about account ${e.toBase58()}`);return f.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,t){let{commitment:n,config:r}=ie(t),i=e.map(A=>A.toBase58()),c=this._buildArgs([i],n,"jsonParsed",r),f=await this._rpcRequest("getMultipleAccounts",c),p=L(f,de(C(x(Mn))));if("error"in p)throw new D(p.error,`failed to get info for accounts ${i}`);return p.result}async getMultipleAccountsInfoAndContext(e,t){let{commitment:n,config:r}=ie(t),i=e.map(A=>A.toBase58()),c=this._buildArgs([i],n,"base64",r),f=await this._rpcRequest("getMultipleAccounts",c),p=L(f,de(C(x(ir))));if("error"in p)throw new D(p.error,`failed to get info for accounts ${i}`);return p.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,n){let{commitment:r,config:i}=ie(t),c=this._buildArgs([e.toBase58()],r,void 0,{...i,epoch:n??i?.epoch}),f=await this._rpcRequest("getStakeActivation",c),p=L(f,V(kf));if("error"in p)throw new D(p.error,`failed to get Stake Activation ${e.toBase58()}`);return p.result}async getProgramAccounts(e,t){let{commitment:n,config:r}=ie(t),{encoding:i,...c}=r||{},f=this._buildArgs([e.toBase58()],n,i||"base64",{...c,...c.filters?{filters:ai(c.filters)}:null}),p=await this._rpcRequest("getProgramAccounts",f),A=C(wf),w=c.withContext===!0?L(p,de(A)):L(p,V(A));if("error"in w)throw new D(w.error,`failed to get accounts owned by program ${e.toBase58()}`);return w.result}async getParsedProgramAccounts(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgs([e.toBase58()],n,"jsonParsed",r),c=await this._rpcRequest("getProgramAccounts",i),f=L(c,V(C(vf)));if("error"in f)throw new D(f.error,`failed to get accounts owned by program ${e.toBase58()}`);return f.result}async confirmTransaction(e,t){let n;if(typeof e=="string")n=e;else{let i=e;if(i.abortSignal?.aborted)return Promise.reject(i.abortSignal.reason);n=i.signature}let r;try{r=Xe.default.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return j(r.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let n,r,i=!1,c=new Promise((p,A)=>{try{n=this.onSignature(t,(I,M)=>{n=void 0;let E={context:M,value:I};p({__type:St.PROCESSED,response:E})},e);let w=new Promise(I=>{n==null?I():r=this._onSubscriptionStateChange(n,M=>{M==="subscribed"&&I()})});(async()=>{if(await w,i)return;let I=await this.getSignatureStatus(t);if(i||I==null)return;let{context:M,value:E}=I;if(E!=null)if(E?.err)A(E.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(E.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(E.confirmationStatus==="processed"||E.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,p({__type:St.PROCESSED,response:{context:M,value:E}})}})()}catch(w){A(w)}});return{abortConfirmation:()=>{r&&(r(),r=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:c}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:n,signature:r}}){let i=!1,c=new Promise(I=>{let M=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let E=await M();if(!i){for(;E<=n;)if(await Nt(1e3),i||(E=await M(),i))return;I({__type:St.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:f,confirmationPromise:p}=this.getTransactionConfirmationPromise({commitment:e,signature:r}),A=this.getCancellationPromise(t),w;try{let I=await Promise.race([A,p,c]);if(I.__type===St.PROCESSED)w=I.response;else throw new Er(r)}finally{i=!0,f()}return w}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:n,nonceAccountPubkey:r,nonceValue:i,signature:c}}){let f=!1,p=new Promise(E=>{let k=i,v=null,B=async()=>{try{let{context:U,value:Y}=await this.getNonceAndContext(r,{commitment:e,minContextSlot:n});return v=U.slot,Y?.nonce}catch{return k}};(async()=>{if(k=await B(),!f)for(;;){if(i!==k){E({__type:St.NONCE_INVALID,slotInWhichNonceDidAdvance:v});return}if(await Nt(2e3),f||(k=await B(),f))return}})()}),{abortConfirmation:A,confirmationPromise:w}=this.getTransactionConfirmationPromise({commitment:e,signature:c}),I=this.getCancellationPromise(t),M;try{let E=await Promise.race([I,w,p]);if(E.__type===St.PROCESSED)M=E.response;else{let k;for(;;){let v=await this.getSignatureStatus(c);if(v==null)break;if(v.context.slot<(E.slotInWhichNonceDidAdvance??n)){await Nt(400);continue}k=v;break}if(k?.value){let v=e||"finalized",{confirmationStatus:B}=k.value;switch(v){case"processed":case"recent":if(B!=="processed"&&B!=="confirmed"&&B!=="finalized")throw new Tt(c);break;case"confirmed":case"single":case"singleGossip":if(B!=="confirmed"&&B!=="finalized")throw new Tt(c);break;case"finalized":case"max":case"root":if(B!=="finalized")throw new Tt(c);break;default:(U=>{})(v)}M={context:k.context,value:{err:k.value.err}}}else throw new Tt(c)}}finally{f=!0,A()}return M}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let n,r=new Promise(p=>{let A=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{A=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>p({__type:St.TIMED_OUT,timeoutMs:A}),A)}),{abortConfirmation:i,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:t}),f;try{let p=await Promise.race([c,r]);if(p.__type===St.PROCESSED)f=p.response;else throw new Ir(t,p.timeoutMs/1e3)}finally{clearTimeout(n),i()}return f}async getClusterNodes(){let e=await this._rpcRequest("getClusterNodes",[]),t=L(e,V(C(Kf)));if("error"in t)throw new D(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){let t=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",t),r=L(n,Ff);if("error"in r)throw new D(r.error,"failed to get vote accounts");return r.result}async getSlot(e){let{commitment:t,config:n}=ie(e),r=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getSlot",r),c=L(i,V(b()));if("error"in c)throw new D(c.error,"failed to get slot");return c.result}async getSlotLeader(e){let{commitment:t,config:n}=ie(e),r=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getSlotLeader",r),c=L(i,V(N()));if("error"in c)throw new D(c.error,"failed to get slot leader");return c.result}async getSlotLeaders(e,t){let n=[e,t],r=await this._rpcRequest("getSlotLeaders",n),i=L(r,V(C(fe)));if("error"in i)throw new D(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){let{context:n,value:r}=await this.getSignatureStatuses([e],t);j(r.length===1);let i=r[0];return{context:n,value:i}}async getSignatureStatuses(e,t){let n=[e];t&&n.push(t);let r=await this._rpcRequest("getSignatureStatuses",n),i=L(r,Vf);if("error"in i)throw new D(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){let{commitment:t,config:n}=ie(e),r=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getTransactionCount",r),c=L(i,V(b()));if("error"in c)throw new D(c.error,"failed to get transaction count");return c.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){let t=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",t),r=L(n,df);if("error"in r)throw new D(r.error,"failed to get inflation");return r.result}async getInflationReward(e,t,n){let{commitment:r,config:i}=ie(n),c=this._buildArgs([e.map(A=>A.toBase58())],r,void 0,{...i,epoch:t??i?.epoch}),f=await this._rpcRequest("getInflationReward",c),p=L(f,Jl);if("error"in p)throw new D(p.error,"failed to get inflation reward");return p.result}async getInflationRate(){let e=await this._rpcRequest("getInflationRate",[]),t=L(e,_f);if("error"in t)throw new D(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){let{commitment:t,config:n}=ie(e),r=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getEpochInfo",r),c=L(i,pf);if("error"in c)throw new D(c.error,"failed to get epoch info");return c.result}async getEpochSchedule(){let e=await this._rpcRequest("getEpochSchedule",[]),t=L(e,yf);if("error"in t)throw new D(t.error,"failed to get epoch schedule");let n=t.result;return new Ln(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){let e=await this._rpcRequest("getLeaderSchedule",[]),t=L(e,mf);if("error"in t)throw new D(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){let n=this._buildArgs([e],t),r=await this._rpcRequest("getMinimumBalanceForRentExemption",n),i=L(r,Gf);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){let{context:t,value:{blockhash:n}}=await this.getLatestBlockhashAndContext(e);return{context:t,value:{blockhash:n,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON(){return{}}}}}}async getRecentPerformanceSamples(e){let t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=L(t,sh);if("error"in n)throw new D(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,t){let n=this._buildArgs([e],t),r=await this._rpcRequest("getFeeCalculatorForBlockhash",n),i=L(r,ih);if("error"in i)throw new D(i.error,"failed to get fee calculator");let{context:c,value:f}=i.result;return{context:c,value:f!==null?f.feeCalculator:null}}async getFeeForMessage(e,t){let n=G(e.serialize()).toString("base64"),r=this._buildArgs([n],t),i=await this._rpcRequest("getFeeForMessage",r),c=L(i,de(x(b())));if("error"in c)throw new D(c.error,"failed to get fee for message");if(c.result===null)throw new Error("invalid blockhash");return c.result}async getRecentPrioritizationFees(e){let t=e?.lockedWritableAccounts?.map(c=>c.toBase58()),n=t?.length?[t]:[],r=await this._rpcRequest("getRecentPrioritizationFees",n),i=L(r,gf);if("error"in i)throw new D(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){let{commitment:t,config:n}=ie(e),r=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getLatestBlockhash",r),c=L(i,th);if("error"in c)throw new D(c.error,"failed to get latest blockhash");return c.result}async isBlockhashValid(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgs([e],n,void 0,r),c=await this._rpcRequest("isBlockhashValid",i),f=L(c,rh);if("error"in f)throw new D(f.error,"failed to determine if the blockhash `"+e+"`is valid");return f.result}async getVersion(){let e=await this._rpcRequest("getVersion",[]),t=L(e,V(of));if("error"in t)throw new D(t.error,"failed to get version");return t.result}async getGenesisHash(){let e=await this._rpcRequest("getGenesisHash",[]),t=L(e,V(N()));if("error"in t)throw new D(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgsAtLeastConfirmed([e],n,void 0,r),c=await this._rpcRequest("getBlock",i);try{switch(r?.transactionDetails){case"accounts":{let f=L(c,jf);if("error"in f)throw f.error;return f.result}case"none":{let f=L(c,Xf);if("error"in f)throw f.error;return f.result}default:{let f=L(c,Yf);if("error"in f)throw f.error;let{result:p}=f;return p?{...p,transactions:p.transactions.map(({transaction:A,meta:w,version:I})=>({meta:w,transaction:{...A,message:On(I,A.message)},version:I}))}:null}}}catch(f){throw new D(f,"failed to get confirmed block")}}async getParsedBlock(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",r),c=await this._rpcRequest("getBlock",i);try{switch(r?.transactionDetails){case"accounts":{let f=L(c,Zf);if("error"in f)throw f.error;return f.result}case"none":{let f=L(c,Qf);if("error"in f)throw f.error;return f.result}default:{let f=L(c,Jf);if("error"in f)throw f.error;return f.result}}}catch(f){throw new D(f,"failed to get block")}}async getBlockProduction(e){let t,n;if(typeof e=="string")n=e;else if(e){let{commitment:f,...p}=e;n=f,t=p}let r=this._buildArgs([],n,"base64",t),i=await this._rpcRequest("getBlockProduction",r),c=L(i,uf);if("error"in c)throw new D(c.error,"failed to get block production information");return c.result}async getTransaction(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgsAtLeastConfirmed([e],n,void 0,r),c=await this._rpcRequest("getTransaction",i),f=L(c,vn);if("error"in f)throw new D(f.error,"failed to get transaction");let p=f.result;return p&&{...p,transaction:{...p.transaction,message:On(p.version,p.transaction.message)}}}async getParsedTransaction(e,t){let{commitment:n,config:r}=ie(t),i=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",r),c=await this._rpcRequest("getTransaction",i),f=L(c,mr);if("error"in f)throw new D(f.error,"failed to get transaction");return f.result}async getParsedTransactions(e,t){let{commitment:n,config:r}=ie(t),i=e.map(p=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([p],n,"jsonParsed",r)}));return(await this._rpcBatchRequest(i)).map(p=>{let A=L(p,mr);if("error"in A)throw new D(A.error,"failed to get transactions");return A.result})}async getTransactions(e,t){let{commitment:n,config:r}=ie(t),i=e.map(p=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([p],n,void 0,r)}));return(await this._rpcBatchRequest(i)).map(p=>{let A=L(p,vn);if("error"in A)throw new D(A.error,"failed to get transactions");let w=A.result;return w&&{...w,transaction:{...w.transaction,message:On(w.version,w.transaction.message)}}})}async getConfirmedBlock(e,t){let n=this._buildArgsAtLeastConfirmed([e],t),r=await this._rpcRequest("getBlock",n),i=L(r,eh);if("error"in i)throw new D(i.error,"failed to get confirmed block");let c=i.result;if(!c)throw new Error("Confirmed block "+e+" not found");let f={...c,transactions:c.transactions.map(({transaction:p,meta:A})=>{let w=new ot(p.message);return{meta:A,transaction:{...p,message:w}}})};return{...f,transactions:f.transactions.map(({transaction:p,meta:A})=>({meta:A,transaction:X.populate(p.message,p.signatures)}))}}async getBlocks(e,t,n){let r=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],n),i=await this._rpcRequest("getBlocks",r),c=L(i,V(C(b())));if("error"in c)throw new D(c.error,"failed to get blocks");return c.result}async getBlockSignatures(e,t){let n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),r=await this._rpcRequest("getBlock",n),i=L(r,li);if("error"in i)throw new D(i.error,"failed to get block");let c=i.result;if(!c)throw new Error("Block "+e+" not found");return c}async getConfirmedBlockSignatures(e,t){let n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),r=await this._rpcRequest("getBlock",n),i=L(r,li);if("error"in i)throw new D(i.error,"failed to get confirmed block");let c=i.result;if(!c)throw new Error("Confirmed block "+e+" not found");return c}async getConfirmedTransaction(e,t){let n=this._buildArgsAtLeastConfirmed([e],t),r=await this._rpcRequest("getTransaction",n),i=L(r,vn);if("error"in i)throw new D(i.error,"failed to get transaction");let c=i.result;if(!c)return c;let f=new ot(c.transaction.message),p=c.transaction.signatures;return{...c,transaction:X.populate(f,p)}}async getParsedConfirmedTransaction(e,t){let n=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),r=await this._rpcRequest("getTransaction",n),i=L(r,mr);if("error"in i)throw new D(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){let n=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],t,"jsonParsed")}));return(await this._rpcBatchRequest(n)).map(c=>{let f=L(c,mr);if("error"in f)throw new D(f.error,"failed to get confirmed transactions");return f.result})}async getConfirmedSignaturesForAddress(e,t,n){let r={},i=await this.getFirstAvailableBlock();for(;!("until"in r)&&(t--,!(t<=0||t<i));)try{let p=await this.getConfirmedBlockSignatures(t,"finalized");p.signatures.length>0&&(r.until=p.signatures[p.signatures.length-1].toString())}catch(p){if(p instanceof Error&&p.message.includes("skipped"))continue;throw p}let c=await this.getSlot("finalized");for(;!("before"in r)&&(n++,!(n>c));)try{let p=await this.getConfirmedBlockSignatures(n);p.signatures.length>0&&(r.before=p.signatures[p.signatures.length-1].toString())}catch(p){if(p instanceof Error&&p.message.includes("skipped"))continue;throw p}return(await this.getConfirmedSignaturesForAddress2(e,r)).map(p=>p.signature)}async getConfirmedSignaturesForAddress2(e,t,n){let r=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",r),c=L(i,Nf);if("error"in c)throw new D(c.error,"failed to get confirmed signatures for address");return c.result}async getSignaturesForAddress(e,t,n){let r=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",r),c=L(i,Tf);if("error"in c)throw new D(c.error,"failed to get signatures for address");return c.result}async getAddressLookupTable(e,t){let{context:n,value:r}=await this.getAccountInfoAndContext(e,t),i=null;return r!==null&&(i=new vr({key:e,state:vr.deserialize(r.data)})),{context:n,value:i}}async getNonceAndContext(e,t){let{context:n,value:r}=await this.getAccountInfoAndContext(e,t),i=null;return r!==null&&(i=sr.fromAccountData(r.data)),{context:n,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,t){let n=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),r=L(n,oh);if("error"in r)throw new D(r.error,`airdrop to ${e.toBase58()} failed`);return r.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await Nt(100);let n=Date.now()-this._blockhashInfo.lastFetch>=ql;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{let e=Date.now(),t=this._blockhashInfo.latestBlockhash,n=t?t.blockhash:null;for(let r=0;r<50;r++){let i=await this.getLatestBlockhash("finalized");if(n!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await Nt(Ti/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){let{commitment:t,config:n}=ie(e),r=this._buildArgs([],t,"base64",n),i=await this._rpcRequest("getStakeMinimumDelegation",r),c=L(i,de(b()));if("error"in c)throw new D(c.error,"failed to get stake minimum delegation");return c.result}async simulateTransaction(e,t,n){if("message"in e){let v=e.serialize(),B=W.from(v).toString("base64");if(Array.isArray(t)||n!==void 0)throw new Error("Invalid arguments");let U=t||{};U.encoding="base64","commitment"in U||(U.commitment=this.commitment),t&&typeof t=="object"&&"innerInstructions"in t&&(U.innerInstructions=t.innerInstructions);let Y=[B,U],le=await this._rpcRequest("simulateTransaction",Y),J=L(le,ci);if("error"in J)throw new Error("failed to simulate transaction: "+J.error.message);return J.result}let r;if(e instanceof X){let k=e;r=new X,r.feePayer=k.feePayer,r.instructions=e.instructions,r.nonceInfo=k.nonceInfo,r.signatures=k.signatures}else r=X.populate(e),r._message=r._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");let i=t;if(r.nonceInfo&&i)r.sign(...i);else{let k=this._disableBlockhashCaching;for(;;){let v=await this._blockhashWithExpiryBlockHeight(k);if(r.lastValidBlockHeight=v.lastValidBlockHeight,r.recentBlockhash=v.blockhash,!i)break;if(r.sign(...i),!r.signature)throw new Error("!signature");let B=r.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(B)&&!this._blockhashInfo.transactionSignatures.includes(B)){this._blockhashInfo.simulatedSignatures.push(B);break}else k=!0}}let c=r._compile(),f=c.serialize(),A=r._serialize(f).toString("base64"),w={encoding:"base64",commitment:this.commitment};if(n){let k=(Array.isArray(n)?n:c.nonProgramIds()).map(v=>v.toBase58());w.accounts={encoding:"base64",addresses:k}}i&&(w.sigVerify=!0),t&&typeof t=="object"&&"innerInstructions"in t&&(w.innerInstructions=t.innerInstructions);let I=[A,w],M=await this._rpcRequest("simulateTransaction",I),E=L(M,ci);if("error"in E){let k;if("data"in E.error&&(k=E.error.data.logs,k&&Array.isArray(k))){let v=`
    `,B=v+k.join(v);console.error(E.error.message,B)}throw new qt({action:"simulate",signature:"",transactionMessage:E.error.message,logs:k})}return E.result}async sendTransaction(e,t,n){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");let c=e.serialize();return await this.sendRawTransaction(c,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");let r=t;if(e.nonceInfo)e.sign(...r);else{let c=this._disableBlockhashCaching;for(;;){let f=await this._blockhashWithExpiryBlockHeight(c);if(e.lastValidBlockHeight=f.lastValidBlockHeight,e.recentBlockhash=f.blockhash,e.sign(...r),!e.signature)throw new Error("!signature");let p=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(p))c=!0;else{this._blockhashInfo.transactionSignatures.push(p);break}}}let i=e.serialize();return await this.sendRawTransaction(i,n)}async sendRawTransaction(e,t){let n=G(e).toString("base64");return await this.sendEncodedTransaction(n,t)}async sendEncodedTransaction(e,t){let n={encoding:"base64"},r=t&&t.skipPreflight,i=r===!0?"processed":t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(n.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(n.minContextSlot=t.minContextSlot),r&&(n.skipPreflight=r),i&&(n.preflightCommitment=i);let c=[e,n],f=await this._rpcRequest("sendTransaction",c),p=L(f,ah);if("error"in p){let A;throw"data"in p.error&&(A=p.error.data.logs),new qt({action:r?"send":"simulate",signature:"",transactionMessage:p.error.message,logs:A})}return p.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,n])=>{this._setSubscription(t,{...n,state:"pending"})})}_setSubscription(e,t){let n=this._subscriptionsByHash[e]?.state;if(this._subscriptionsByHash[e]=t,n!==t.state){let r=this._subscriptionStateChangeCallbacksByHash[e];r&&r.forEach(i=>{try{i(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){let n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};let r=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return r.add(t),()=>{r.delete(t),r.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}let e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{let r=this._subscriptionsByHash[n];if(r!==void 0)switch(r.state){case"pending":case"unsubscribed":if(r.callbacks.size===0){delete this._subscriptionsByHash[n],r.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[r.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{let{args:i,method:c}=r;try{this._setSubscription(n,{...r,state:"subscribing"});let f=await this._rpcWebSocket.call(c,i);this._setSubscription(n,{...r,serverSubscriptionId:f,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[f]=r.callbacks,await this._updateSubscriptions()}catch(f){if(console.error(`Received ${f instanceof Error?"":"JSON-RPC "}error calling \`${c}\``,{args:i,error:f}),!t())return;this._setSubscription(n,{...r,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":r.callbacks.size===0&&await(async()=>{let{serverSubscriptionId:i,unsubscribeMethod:c}=r;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(n,{...r,state:"unsubscribing"}),this._setSubscription(n,{...r,state:"unsubscribing"});try{await this._rpcWebSocket.call(c,[i])}catch(f){if(f instanceof Error&&console.error(`${c} error:`,f.message),!t())return;this._setSubscription(n,{...r,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...r,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){let n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(r=>{try{r(...t)}catch(i){console.error(i)}})}_wsOnAccountNotification(e){let{result:t,subscription:n}=L(e,Lf);this._handleServerNotification(n,[t.value,t.context])}_makeSubscription(e,t){let n=this._nextClientSubscriptionId++,r=ii([e.method,t]),i=this._subscriptionsByHash[r];return i===void 0?this._subscriptionsByHash[r]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=r,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];let c=this._subscriptionsByHash[r];j(c!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),c.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,t,n){let{commitment:r,config:i}=ie(n),c=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64",i);return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},c)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){let{result:t,subscription:n}=L(e,xf);this._handleServerNotification(n,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,n,r){let{commitment:i,config:c}=ie(n),f=this._buildArgs([e.toBase58()],i||this._commitment||"finalized","base64",c||(r?{filters:ai(r)}:void 0));return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},f)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,n){let r=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},r)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){let{result:t,subscription:n}=L(e,uh);this._handleServerNotification(n,[t.value,t.context])}_wsOnSlotNotification(e){let{result:t,subscription:n}=L(e,Mf);this._handleServerNotification(n,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){let{result:t,subscription:n}=L(e,Df);this._handleServerNotification(n,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){let n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,n,r){let i=t||this._commitment;if(i||n||r){let c={};n&&(c.encoding=n),i&&(c.commitment=i),r&&(c=Object.assign(c,r)),e.push(c)}return e}_buildArgsAtLeastConfirmed(e,t,n,r){let i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,n,r)}_wsOnSignatureNotification(e){let{result:t,subscription:n}=L(e,Uf);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,n){let r=this._buildArgs([e],n||this._commitment||"finalized"),i=this._makeSubscription({callback:(c,f)=>{if(c.type==="status"){t(c.result,f);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},r);return i}onSignatureWithOptions(e,t,n){let{commitment:r,...i}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},c=this._buildArgs([e],r,void 0,i),f=this._makeSubscription({callback:(p,A)=>{t(p,A);try{this.removeSignatureListener(f)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},c);return f}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){let{result:t,subscription:n}=L(e,zf);this._handleServerNotification(n,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}},xt=class{constructor(e){this._keypair=void 0,this._keypair=e??Xs()}static generate(){return new xt(Xs())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");let n=e.slice(32,64);if(!t||!t.skipValidation){let r=e.slice(0,32),i=Sr(r);for(let c=0;c<32;c++)if(n[c]!==i[c])throw new Error("provided secretKey is invalid")}return new xt({publicKey:n,secretKey:e})}static fromSeed(e){let t=Sr(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new xt({publicKey:t,secretKey:n})}get publicKey(){return new T(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}},bt=Object.freeze({CreateLookupTable:{index:0,layout:g.struct([g.u32("instruction"),Yt("recentSlot"),g.u8("bumpSeed")])},FreezeLookupTable:{index:1,layout:g.struct([g.u32("instruction")])},ExtendLookupTable:{index:2,layout:g.struct([g.u32("instruction"),Yt(),g.seq(H(),g.offset(g.u32(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:g.struct([g.u32("instruction")])},CloseLookupTable:{index:4,layout:g.struct([g.u32("instruction")])}}),hi=class{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);let n=g.u32("instruction").decode(e.data),r;for(let[i,c]of Object.entries(bt))if(c.index==n){r=i;break}if(!r)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return r}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);let{recentSlot:t}=Q(bt.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);let{addresses:t}=Q(bt.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(n=>new T(n))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Nr.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}},Nr=class{constructor(){}static createLookupTable(e){let[t,n]=T.findProgramAddressSync([e.authority.toBuffer(),pn().encode(e.recentSlot)],this.programId),r=bt.CreateLookupTable,i=q(r,{recentSlot:BigInt(e.recentSlot),bumpSeed:n}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Ye.programId,isSigner:!1,isWritable:!1}];return[new re({programId:this.programId,keys:c,data:i}),t]}static freezeLookupTable(e){let t=bt.FreezeLookupTable,n=q(t),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new re({programId:this.programId,keys:r,data:n})}static extendLookupTable(e){let t=bt.ExtendLookupTable,n=q(t,{addresses:e.addresses.map(i=>i.toBytes())}),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&r.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Ye.programId,isSigner:!1,isWritable:!1}),new re({programId:this.programId,keys:r,data:n})}static deactivateLookupTable(e){let t=bt.DeactivateLookupTable,n=q(t),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new re({programId:this.programId,keys:r,data:n})}static closeLookupTable(e){let t=bt.CloseLookupTable,n=q(t),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new re({programId:this.programId,keys:r,data:n})}};Nr.programId=new T("AddressLookupTab1e1111111111111111111111111");var di=class{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);let n=g.u8("instruction").decode(e.data),r;for(let[i,c]of Object.entries(dt))if(c.index==n){r=i;break}if(!r)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return r}static decodeRequestUnits(e){this.checkProgramId(e.programId);let{units:t,additionalFee:n}=Q(dt.RequestUnits,e.data);return{units:t,additionalFee:n}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);let{bytes:t}=Q(dt.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);let{units:t}=Q(dt.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);let{microLamports:t}=Q(dt.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(Tr.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}},dt=Object.freeze({RequestUnits:{index:0,layout:g.struct([g.u8("instruction"),g.u32("units"),g.u32("additionalFee")])},RequestHeapFrame:{index:1,layout:g.struct([g.u8("instruction"),g.u32("bytes")])},SetComputeUnitLimit:{index:2,layout:g.struct([g.u8("instruction"),g.u32("units")])},SetComputeUnitPrice:{index:3,layout:g.struct([g.u8("instruction"),Yt("microLamports")])}}),Tr=class{constructor(){}static requestUnits(e){let t=dt.RequestUnits,n=q(t,e);return new re({keys:[],programId:this.programId,data:n})}static requestHeapFrame(e){let t=dt.RequestHeapFrame,n=q(t,e);return new re({keys:[],programId:this.programId,data:n})}static setComputeUnitLimit(e){let t=dt.SetComputeUnitLimit,n=q(t,e);return new re({keys:[],programId:this.programId,data:n})}static setComputeUnitPrice(e){let t=dt.SetComputeUnitPrice,n=q(t,{microLamports:BigInt(e.microLamports)});return new re({keys:[],programId:this.programId,data:n})}};Tr.programId=new T("ComputeBudget111111111111111111111111111111");var _i=64,gi=32,pi=64,yi=g.struct([g.u8("numSignatures"),g.u8("padding"),g.u16("signatureOffset"),g.u16("signatureInstructionIndex"),g.u16("publicKeyOffset"),g.u16("publicKeyInstructionIndex"),g.u16("messageDataOffset"),g.u16("messageDataSize"),g.u16("messageInstructionIndex")]),or=class{constructor(){}static createInstructionWithPublicKey(e){let{publicKey:t,message:n,signature:r,instructionIndex:i}=e;j(t.length===gi,`Public Key must be ${gi} bytes but received ${t.length} bytes`),j(r.length===pi,`Signature must be ${pi} bytes but received ${r.length} bytes`);let c=yi.span,f=c+t.length,p=f+r.length,A=1,w=W.alloc(p+n.length),I=i??65535;return yi.encode({numSignatures:A,padding:0,signatureOffset:f,signatureInstructionIndex:I,publicKeyOffset:c,publicKeyInstructionIndex:I,messageDataOffset:p,messageDataSize:n.length,messageInstructionIndex:I},w),w.fill(t,c),w.fill(r,f),w.fill(n,p),new re({keys:[],programId:or.programId,data:w})}static createInstructionWithPrivateKey(e){let{privateKey:t,message:n,instructionIndex:r}=e;j(t.length===_i,`Private key must be ${_i} bytes but received ${t.length} bytes`);try{let i=xt.fromSecretKey(t),c=i.publicKey.toBytes(),f=Un(n,i.secretKey);return this.createInstructionWithPublicKey({publicKey:c,message:n,signature:f,instructionIndex:r})}catch(i){throw new Error(`Error creating instruction; ${i}`)}}};or.programId=new T("Ed25519SigVerify111111111111111111111111111");var fh=(o,e)=>{let t=cr.sign(o,e);return[t.toCompactRawBytes(),t.recovery]};cr.utils.isValidPrivateKey;var hh=cr.getPublicKey,mi=32,kn=20,Ri=64,dh=11,Nn=g.struct([g.u8("numSignatures"),g.u16("signatureOffset"),g.u8("signatureInstructionIndex"),g.u16("ethAddressOffset"),g.u8("ethAddressInstructionIndex"),g.u16("messageDataOffset"),g.u16("messageDataSize"),g.u8("messageInstructionIndex"),g.blob(20,"ethAddress"),g.blob(64,"signature"),g.u8("recoveryId")]),Bt=class{constructor(){}static publicKeyToEthAddress(e){j(e.length===Ri,`Public key must be ${Ri} bytes but received ${e.length} bytes`);try{return W.from(bn(G(e))).slice(-kn)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){let{publicKey:t,message:n,signature:r,recoveryId:i,instructionIndex:c}=e;return Bt.createInstructionWithEthAddress({ethAddress:Bt.publicKeyToEthAddress(t),message:n,signature:r,recoveryId:i,instructionIndex:c})}static createInstructionWithEthAddress(e){let{ethAddress:t,message:n,signature:r,recoveryId:i,instructionIndex:c=0}=e,f;typeof t=="string"?t.startsWith("0x")?f=W.from(t.substr(2),"hex"):f=W.from(t,"hex"):f=t,j(f.length===kn,`Address must be ${kn} bytes but received ${f.length} bytes`);let p=1+dh,A=p,w=p+f.length,I=w+r.length+1,M=1,E=W.alloc(Nn.span+n.length);return Nn.encode({numSignatures:M,signatureOffset:w,signatureInstructionIndex:c,ethAddressOffset:A,ethAddressInstructionIndex:c,messageDataOffset:I,messageDataSize:n.length,messageInstructionIndex:c,signature:G(r),ethAddress:G(f),recoveryId:i},E),E.fill(G(n),Nn.span),new re({keys:[],programId:Bt.programId,data:E})}static createInstructionWithPrivateKey(e){let{privateKey:t,message:n,instructionIndex:r}=e;j(t.length===mi,`Private key must be ${mi} bytes but received ${t.length} bytes`);try{let i=G(t),c=hh(i,!1).slice(1),f=W.from(bn(G(n))),[p,A]=fh(f,i);return this.createInstructionWithPublicKey({publicKey:c,message:n,signature:p,recoveryId:A,instructionIndex:r})}catch(i){throw new Error(`Error creating instruction; ${i}`)}}};Bt.programId=new T("KeccakSecp256k11111111111111111111111111111");var Wi,_h=new T("StakeConfig11111111111111111111111111111111"),Pn=class{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}},Xt=class{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}};Wi=Xt;Xt.default=new Wi(0,0,T.default);var Si=class{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);let n=g.u32("instruction").decode(e.data),r;for(let[i,c]of Object.entries(je))if(c.index==n){r=i;break}if(!r)throw new Error("Instruction type incorrect; not a StakeInstruction");return r}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);let{authorized:t,lockup:n}=Q(je.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new Pn(new T(t.staker),new T(t.withdrawer)),lockup:new Xt(n.unixTimestamp,n.epoch,new T(n.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Q(je.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);let{newAuthorized:t,stakeAuthorizationType:n}=Q(je.Authorize,e.data),r={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new T(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(r.custodianPubkey=e.keys[3].pubkey),r}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);let{newAuthorized:t,stakeAuthorizationType:n,authoritySeed:r,authorityOwner:i}=Q(je.AuthorizeWithSeed,e.data),c={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:r,authorityOwner:new T(i),newAuthorizedPubkey:new T(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(c.custodianPubkey=e.keys[3].pubkey),c}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);let{lamports:t}=Q(je.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Q(je.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);let{lamports:t}=Q(je.Withdraw,e.data),n={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(n.custodianPubkey=e.keys[5].pubkey),n}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Q(je.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(ar.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}},je=Object.freeze({Initialize:{index:0,layout:g.struct([g.u32("instruction"),kl(),Nl()])},Authorize:{index:1,layout:g.struct([g.u32("instruction"),H("newAuthorized"),g.u32("stakeAuthorizationType")])},Delegate:{index:2,layout:g.struct([g.u32("instruction")])},Split:{index:3,layout:g.struct([g.u32("instruction"),g.ns64("lamports")])},Withdraw:{index:4,layout:g.struct([g.u32("instruction"),g.ns64("lamports")])},Deactivate:{index:5,layout:g.struct([g.u32("instruction")])},Merge:{index:7,layout:g.struct([g.u32("instruction")])},AuthorizeWithSeed:{index:8,layout:g.struct([g.u32("instruction"),H("newAuthorized"),g.u32("stakeAuthorizationType"),Lt("authoritySeed"),H("authorityOwner")])}}),Vd=Object.freeze({Staker:{index:0},Withdrawer:{index:1}}),ar=class{constructor(){}static initialize(e){let{stakePubkey:t,authorized:n,lockup:r}=e,i=r||Xt.default,c=je.Initialize,f=q(c,{authorized:{staker:G(n.staker.toBuffer()),withdrawer:G(n.withdrawer.toBuffer())},lockup:{unixTimestamp:i.unixTimestamp,epoch:i.epoch,custodian:G(i.custodian.toBuffer())}}),p={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:nr,isSigner:!1,isWritable:!1}],programId:this.programId,data:f};return new re(p)}static createAccountWithSeed(e){let t=new X;t.add(Ye.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));let{stakePubkey:n,authorized:r,lockup:i}=e;return t.add(this.initialize({stakePubkey:n,authorized:r,lockup:i}))}static createAccount(e){let t=new X;t.add(Ye.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));let{stakePubkey:n,authorized:r,lockup:i}=e;return t.add(this.initialize({stakePubkey:n,authorized:r,lockup:i}))}static delegate(e){let{stakePubkey:t,authorizedPubkey:n,votePubkey:r}=e,i=je.Delegate,c=q(i);return new X().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:En,isSigner:!1,isWritable:!1},{pubkey:_h,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:c})}static authorize(e){let{stakePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:r,stakeAuthorizationType:i,custodianPubkey:c}=e,f=je.Authorize,p=q(f,{newAuthorized:G(r.toBuffer()),stakeAuthorizationType:i.index}),A=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return c&&A.push({pubkey:c,isSigner:!0,isWritable:!1}),new X().add({keys:A,programId:this.programId,data:p})}static authorizeWithSeed(e){let{stakePubkey:t,authorityBase:n,authoritySeed:r,authorityOwner:i,newAuthorizedPubkey:c,stakeAuthorizationType:f,custodianPubkey:p}=e,A=je.AuthorizeWithSeed,w=q(A,{newAuthorized:G(c.toBuffer()),stakeAuthorizationType:f.index,authoritySeed:r,authorityOwner:G(i.toBuffer())}),I=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:ht,isSigner:!1,isWritable:!1}];return p&&I.push({pubkey:p,isSigner:!0,isWritable:!1}),new X().add({keys:I,programId:this.programId,data:w})}static splitInstruction(e){let{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:r,lamports:i}=e,c=je.Split,f=q(c,{lamports:i});return new re({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:f})}static split(e,t){let n=new X;return n.add(Ye.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:t,space:this.space,programId:this.programId})),n.add(this.splitInstruction(e))}static splitWithSeed(e,t){let{stakePubkey:n,authorizedPubkey:r,splitStakePubkey:i,basePubkey:c,seed:f,lamports:p}=e,A=new X;return A.add(Ye.allocate({accountPubkey:i,basePubkey:c,seed:f,space:this.space,programId:this.programId})),t&&t>0&&A.add(Ye.transfer({fromPubkey:e.authorizedPubkey,toPubkey:i,lamports:t})),A.add(this.splitInstruction({stakePubkey:n,authorizedPubkey:r,splitStakePubkey:i,lamports:p}))}static merge(e){let{stakePubkey:t,sourceStakePubKey:n,authorizedPubkey:r}=e,i=je.Merge,c=q(i);return new X().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:En,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:c})}static withdraw(e){let{stakePubkey:t,authorizedPubkey:n,toPubkey:r,lamports:i,custodianPubkey:c}=e,f=je.Withdraw,p=q(f,{lamports:i}),A=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:En,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return c&&A.push({pubkey:c,isSigner:!0,isWritable:!1}),new X().add({keys:A,programId:this.programId,data:p})}static deactivate(e){let{stakePubkey:t,authorizedPubkey:n}=e,r=je.Deactivate,i=q(r);return new X().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}};ar.programId=new T("Stake11111111111111111111111111111111111111");ar.space=200;var Dn=class{constructor(e,t,n,r){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=n,this.commission=r}},bi=class{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);let n=g.u32("instruction").decode(e.data),r;for(let[i,c]of Object.entries(ft))if(c.index==n){r=i;break}if(!r)throw new Error("Instruction type incorrect; not a VoteInstruction");return r}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);let{voteInit:t}=Q(ft.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new Dn(new T(t.nodePubkey),new T(t.authorizedVoter),new T(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);let{newAuthorized:t,voteAuthorizationType:n}=Q(ft.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new T(t),voteAuthorizationType:{index:n}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);let{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:n,newAuthorized:r,voteAuthorizationType:i}}=Q(ft.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new T(t),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new T(r),voteAuthorizationType:{index:i},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);let{lamports:t}=Q(ft.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Mt.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}},ft=Object.freeze({InitializeAccount:{index:0,layout:g.struct([g.u32("instruction"),Tl()])},Authorize:{index:1,layout:g.struct([g.u32("instruction"),H("newAuthorized"),g.u32("voteAuthorizationType")])},Withdraw:{index:3,layout:g.struct([g.u32("instruction"),g.ns64("lamports")])},UpdateValidatorIdentity:{index:4,layout:g.struct([g.u32("instruction")])},AuthorizeWithSeed:{index:10,layout:g.struct([g.u32("instruction"),Ll()])}}),Gd=Object.freeze({Voter:{index:0},Withdrawer:{index:1}}),Mt=class{constructor(){}static initializeAccount(e){let{votePubkey:t,nodePubkey:n,voteInit:r}=e,i=ft.InitializeAccount,c=q(i,{voteInit:{nodePubkey:G(r.nodePubkey.toBuffer()),authorizedVoter:G(r.authorizedVoter.toBuffer()),authorizedWithdrawer:G(r.authorizedWithdrawer.toBuffer()),commission:r.commission}}),f={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:nr,isSigner:!1,isWritable:!1},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:c};return new re(f)}static createAccount(e){let t=new X;return t.add(Ye.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){let{votePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:r,voteAuthorizationType:i}=e,c=ft.Authorize,f=q(c,{newAuthorized:G(r.toBuffer()),voteAuthorizationType:i.index}),p=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new X().add({keys:p,programId:this.programId,data:f})}static authorizeWithSeed(e){let{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:n,currentAuthorityDerivedKeySeed:r,newAuthorizedPubkey:i,voteAuthorizationType:c,votePubkey:f}=e,p=ft.AuthorizeWithSeed,A=q(p,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:G(n.toBuffer()),currentAuthorityDerivedKeySeed:r,newAuthorized:G(i.toBuffer()),voteAuthorizationType:c.index}}),w=[{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new X().add({keys:w,programId:this.programId,data:A})}static withdraw(e){let{votePubkey:t,authorizedWithdrawerPubkey:n,lamports:r,toPubkey:i}=e,c=ft.Withdraw,f=q(c,{lamports:r}),p=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return new X().add({keys:p,programId:this.programId,data:f})}static safeWithdraw(e,t,n){if(e.lamports>t-n)throw new Error("Withdraw will leave vote account with insufficient funds.");return Mt.withdraw(e)}static updateValidatorIdentity(e){let{votePubkey:t,authorizedWithdrawerPubkey:n,nodePubkey:r}=e,i=ft.UpdateValidatorIdentity,c=q(i),f=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new X().add({keys:f,programId:this.programId,data:c})}};Mt.programId=new T("Vote111111111111111111111111111111111111111");Mt.space=3762;var gh=new T("Va1idator1nfo111111111111111111111111111111"),ph=O({name:N(),website:F(N()),details:F(N()),iconUrl:F(N()),keybaseUsername:F(N())}),Lr=class{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(Qe(t)!==2)return null;let r=[];for(let i=0;i<2;i++){let c=new T(et(t,0,_t)),f=lt(t)===1;r.push({publicKey:c,isSigner:f})}if(r[0].publicKey.equals(gh)&&r[1].isSigner){let i=Lt().decode(W.from(t)),c=JSON.parse(i);return Rn(c,ph),new Lr(r[1].publicKey,c)}return null}},Hd=new T("Vote111111111111111111111111111111111111111"),yh=g.struct([H("nodePubkey"),H("authorizedWithdrawer"),g.u8("commission"),g.nu64(),g.seq(g.struct([g.nu64("slot"),g.u32("confirmationCount")]),g.offset(g.u32(),-8),"votes"),g.u8("rootSlotValid"),g.nu64("rootSlot"),g.nu64(),g.seq(g.struct([g.nu64("epoch"),H("authorizedVoter")]),g.offset(g.u32(),-8),"authorizedVoters"),g.struct([g.seq(g.struct([H("authorizedPubkey"),g.nu64("epochOfLastAuthorizedSwitch"),g.nu64("targetEpoch")]),32,"buf"),g.nu64("idx"),g.u8("isEmpty")],"priorVoters"),g.nu64(),g.seq(g.struct([g.nu64("epoch"),g.nu64("credits"),g.nu64("prevCredits")]),g.offset(g.u32(),-8),"epochCredits"),g.struct([g.nu64("slot"),g.nu64("timestamp")],"lastTimestamp")]),Cr=class{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){let n=yh.decode(G(e),4),r=n.rootSlot;return n.rootSlotValid||(r=null),new Cr({nodePubkey:new T(n.nodePubkey),authorizedWithdrawer:new T(n.authorizedWithdrawer),commission:n.commission,votes:n.votes,rootSlot:r,authorizedVoters:n.authorizedVoters.map(mh),priorVoters:Rh(n.priorVoters),epochCredits:n.epochCredits,lastTimestamp:n.lastTimestamp})}};function mh({authorizedVoter:o,epoch:e}){return{epoch:e,authorizedVoter:new T(o)}}function Ai({authorizedPubkey:o,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new T(o),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function Rh({buf:o,idx:e,isEmpty:t}){return t?[]:[...o.slice(e+1).map(Ai),...o.slice(0,e).map(Ai)]}var Ei={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function qd(o,e){let t=e===!1?"http":"https";if(!o)return Ei[t].devnet;let n=Ei[t][o];if(!n)throw new Error(`Unknown ${t} cluster: ${o}`);return n}async function Yd(o,e,t,n){let r,i;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(r=t,i=n):i=t;let c=i&&{skipPreflight:i.skipPreflight,preflightCommitment:i.preflightCommitment||i.commitment,minContextSlot:i.minContextSlot},f=await o.sendRawTransaction(e,c),p=i&&i.commitment,w=(await(r?o.confirmTransaction(r,p):o.confirmTransaction(f,p))).value;if(w.err)throw f!=null?new qt({action:c?.skipPreflight?"send":"simulate",signature:f,transactionMessage:`Status: (${JSON.stringify(w)})`}):new Error(`Raw transaction ${f} failed (${JSON.stringify(w)})`);return f}var Xd=1e9;export{br as a,Js as b,Rr as c,wl as d,_t as e,T as f,Qs as g,Pd as h,Ct as i,zn as j,Ar as k,Er as l,Ir as m,Tt as n,Gt as o,ot as p,At as q,Ni as r,St as s,re as t,X as u,wr as v,Or as w,ht as x,Dd as y,Ud as z,An as A,nr as B,zd as C,Kd as D,Fd as E,En as F,qt as G,Wd as H,D as I,ei as J,Pl as K,ti as L,sr as M,ri as N,oe as O,Ye as P,Et as Q,$d as R,ni as S,Ln as T,vr as U,ql as V,fi as W,xt as X,bt as Y,hi as Z,Nr as _,di as $,dt as aa,Tr as ba,or as ca,Bt as da,_h as ea,Pn as fa,Xt as ga,Si as ha,je as ia,Vd as ja,ar as ka,Dn as la,bi as ma,Gd as na,Mt as oa,gh as pa,Lr as qa,Hd as ra,Cr as sa,qd as ta,Yd as ua,Xd as va};
//# sourceMappingURL=chunk-4HHTYYQM.js.map
