import{a as _a}from"./chunk-ZWKYYPCG.js";import{a as ta,b as ia,c as wa}from"./chunk-YLPOVMK6.js";import{a as $r}from"./chunk-CAWXATKV.js";import{b as Yr,c as ba,d as xa,e as va,f as Ra}from"./chunk-4VAKOKZO.js";import{a as Xr}from"./chunk-XAUZ4FZE.js";import{a as Pa}from"./chunk-5JVWMQI2.js";import{d as _n,e as Ea,f as La}from"./chunk-QTPS5BDP.js";import{a as In}from"./chunk-KOQXCGQ5.js";import{a as Sn}from"./chunk-P7NYIGUS.js";import{b as sa,c as aa}from"./chunk-OWPVBYY3.js";import{A as hn,B as ya,a as ot,b as nt,c as Gt,d as Kr,e as la,f as da,g as ua,h as pa,i as ma,j as dn,k as un,l as Kt,m as pn,n as ur,o as mn,p as fn,q as ga,v as ka,w as gn,y as zr,z as Aa}from"./chunk-ZNFTIF43.js";import{a as Qr,b as vt}from"./chunk-D52EE5TC.js";import{c as Ta,k as ha}from"./chunk-FEU7MNAN.js";import{c as Js,d as ln,e as M,f as R,g as Gr,h as ca}from"./chunk-GTBNRR37.js";import{a as Sl}from"./chunk-UUOZSCBD.js";import{d as Ht,e as ea}from"./chunk-A7FGCMOW.js";import{d as et}from"./chunk-CJAFGYQK.js";import{a as kn}from"./chunk-QED56456.js";import{b as jr,c as Tn,d as Sa,e as Ia,f as Ca}from"./chunk-PYCB247J.js";import{f as ye,h as Cn,i as An}from"./chunk-2LQJ3JX6.js";import{a as pr}from"./chunk-KF7FMIRD.js";import{c as Ma}from"./chunk-SZZZVLQW.js";import{b as xt,c as tt,f as rt,t as ra,u as oa,v as na}from"./chunk-V5J3A5L5.js";import{a as qt}from"./chunk-CERSDYPT.js";import{c as fa}from"./chunk-RZETZIQO.js";import{Aa as nn,Ca as qs,Ea as qr,Fa as Gs,Ga as Ks,Ha as Qs,I as Bs,Ia as Je,Ja as sn,L as Fs,La as an,Na as zs,Sa as cn,T as Ws,U as Hr,Ya as Ys,_a as js,ab as $s,ba as Us,bb as Xs,h as Ur,jb as Zs,ma as Vs,nb as y,p as Vr,pa as xe,q as tn,ua as rn,va as J,wa as Hs,xa as dr,ya as on}from"./chunk-P5GHREX3.js";import{a as oe}from"./chunk-VL2JCPJS.js";import{l as Tt,o as Wr}from"./chunk-CTJAEFLV.js";import{a as V,g as Ls,l as Ie,o as ws,p as Ds,s as Ns,z as Os}from"./chunk-AP4E6GDF.js";import{B as wr,Bb as ys,Ce as vs,Dd as Or,De as Es,E as ks,Ee as Rs,F as Ne,Gd as Jo,Ib as ie,Id as en,Je as Ms,Ke as A,La as Zo,Le as Ke,M as Ss,Qc as Nr,S as Dr,c as L,d as ft,db as cr,e as _e,f as ir,g as hs,ha as Xo,ib as Is,ie as Br,j as $o,je as lr,k as Ge,ke as Fr,l as gt,m as D,n as _s,nb as Cs,pb as As,we as Ps,xe as bs,yc as Oe,ze as xs}from"./chunk-RPH2MNBW.js";import{a as kl}from"./chunk-DOSBJ3L3.js";import{b as Mr}from"./chunk-3O2IEAHF.js";import{A as bt,I as re,J as Ae,K as jo,R as mt,b as we,o as zo,q as Ut,s as Yo,x as Vt}from"./chunk-URGJ6D4O.js";import{a as De}from"./chunk-IQUFNLVG.js";import{C as ar,t as B,w as Qo}from"./chunk-XYWWXNVK.js";import{a as me}from"./chunk-FB3ILH2L.js";import{b as E}from"./chunk-FLSAETOH.js";import{f as Ts}from"./chunk-TR37MFB4.js";import{Aa as ce,G as Rr,M as qe,T as sr,Z as Lr,ca as fs,k as qo,l as Y,pa as Ko,ua as gs,v as Go}from"./chunk-4C5HF6J2.js";import{f as P,o as i,q as c}from"./chunk-UWURTNRY.js";i();c();var St=P(E()),Pr=P(kl());i();c();i();c();var je=P(E());i();c();i();c();i();c();var Jr={["0"]:"buy",["1"]:"sell"},Da={WIDTH:340,HEIGHT:320,BUY_HEIGHT:420,SELL_HEIGHT:530,PRESET_WIDTH:400,PRESET_HEIGHT:800,SETTING_WIDTH:340,SETTING_HEIGHT:268,FOOTER_HEIGHT:37},Na={WIDTH:342,HEIGHT:307,BUY_HEIGHT:417,SELL_HEIGHT:527,PRESET_WIDTH:400,PRESET_HEIGHT:800,FOOTER_HEIGHT:37},eo={SPACE:"Space"},mr=[{key:"Q"},{key:"W"},{key:"E"},{key:"R"},{key:"T"},{key:"Y"}],fr=[{key:"A"},{key:"S"},{key:"D"},{key:"F"},{key:"G"},{key:"H"}],to={ORDER_FROM:"INSTANT_TRADE",ORDER_SOURCE:"INSTANT_TRADE",TRADE_MODE:7,SUCCESS:"1",FAILED:"-1"},ro={SHOW_PNL:"instant_trade_showPnl"},$d=[Oe.SOLANA_MAINNET,Oe.ETHEREUM_MAINNET,Oe.BSC_MAINNET,Oe.BASE_MAINNET,Oe.ARBITRUM_MAINNET,Oe.X_LAYER_MAINNET];i();c();ce();var U=class{constructor(){this.currentWallet=null;this.getAddressByChainId=e=>y.getWalletAddressByChainId(e);this.userUniqueId=Ur.initUniqueId();this.walletSupportMev=!1;this.setWalletSupportMev=e=>{this.walletSupportMev=e};this.defaultEnabledSilentMethod=!1;this.silentEnabled=!1;this.isSaAccountNormal=!1;gt(this)}setCurrentWallet(e){this.currentWallet=y.formatCurrentWallet(e)}get computedAccountWalletAddresses(){let e=Y(this.currentWallet,"address",[]);return Array.isArray(e)?gs(e).join(","):""}get computedAccountId(){return this.currentWallet?.walletId}get isConnectedWallet(){return!!this.currentWallet?.walletId}get computedTeeStatus(){return this.currentWallet?.teeStatus||{}}get computedIsOkxWallet(){return this.currentWallet?.isOkxWallet||!1}get computedTeeInfo(){return this.currentWallet?.tee}get computedInitWalletAtExtension(){return y.isExtensionEnv?y.isExtensionEnv&&!!this.computedAccountId:!0}setDefaultEnabledSilentMethod(e){this.defaultEnabledSilentMethod=e}setSilentEnabled(e){this.silentEnabled=e}setIsSaAccountNormal(e){this.isSaAccountNormal=e}};U.storeId="currentWallet",U.storeName="CurrentWalletStore";var Oa=()=>new U;i();c();i();c();var q=class extends Gr{constructor(t,r){super(t);this.isPresetModalOpen=!1;this.isSettingModalOpen=!1;this.isEditModeActive=!1;this.isShortcutActive=!1;this.spacePressed=!1;this.tokenSelectorState=null;this.tokenSelectorHideCount=0;this.boostOnboardingShown=oe.get("boostOnboardingShown")??!1;this.isBoostInfoShown=!0;this.tempBuyModeConfigList=[];this.tempSellModeConfigList=[];this.sizeConfig=r,Ge(this,{isPresetModalOpen:L,isSettingModalOpen:L,isEditModeActive:L,isShortcutActive:L,spacePressed:L,tokenSelectorState:L,tokenSelectorHideCount:L,boostOnboardingShown:L,isBoostInfoShown:L,tempBuyModeConfigList:L,tempSellModeConfigList:L,computedDialogState:ft,computedWindowSize:ft,setPresetModalOpen:_e,setSettingModalOpen:_e,setEditModeActive:_e,setShortcutActive:_e,setSpacePressed:_e,setTokenSelectorState:_e,updateTokenSelectorHideCount:_e,setBoostOnboardingShown:_e,showBoostInfo:_e,hideBoostInfo:_e,setTempBuyModeConfigList:_e,setTempSellModeConfigList:_e})}setPresetModalOpen(t){this.isPresetModalOpen=t,this.applyWindowResize()}setSettingModalOpen(t){this.isSettingModalOpen=t,this.applyWindowResize()}get computedDialogState(){return this.isPresetModalOpen?"preset":this.isSettingModalOpen?"setting":"main"}setEditModeActive(t){this.isEditModeActive=t}setShortcutActive(t){this.isShortcutActive=t}setSpacePressed(t){this.spacePressed=t}setTokenSelectorState(t){this.tokenSelectorState=t,t!==null&&(this.isEditModeActive=!1),this.applyWindowResize(!1)}updateTokenSelectorHideCount(){this.tokenSelectorHideCount+=1}setBoostOnboardingShown(t){this.boostOnboardingShown=t,oe.set("boostOnboardingShown",t)}setBoostInfoShown(t){this.isBoostInfoShown=t,this.applyWindowResize(!1)}showBoostInfo(){this.setBoostInfoShown(!0)}hideBoostInfo(){this.setBoostInfoShown(!1)}setTempBuyModeConfigList(t){this.tempBuyModeConfigList=t}setTempSellModeConfigList(t){this.tempSellModeConfigList=t}hasTempConfigs(){return this.tempBuyModeConfigList.length>0||this.tempSellModeConfigList.length>0}get computedWindowSize(){if(this.isPresetModalOpen)return{width:this.sizeConfig.PRESET_WIDTH,height:this.sizeConfig.PRESET_HEIGHT};if(y.isExtensionEnv&&this.isSettingModalOpen)return{width:this.sizeConfig.SETTING_WIDTH,height:this.sizeConfig.SETTING_HEIGHT};if(this.tokenSelectorState!==null){let n=this.tokenSelectorState==="0";return{width:this.sizeConfig.WIDTH,height:n?this.sizeConfig.BUY_HEIGHT:this.sizeConfig.SELL_HEIGHT}}let t=this.sizeConfig.HEIGHT,r=this.isBoostInfoShown?this.sizeConfig.FOOTER_HEIGHT:0;return{width:this.sizeConfig.WIDTH,height:t+r}}applyWindowResize(t){let r=this.computedWindowSize;y.isExtensionEnv&&y.global.resize(r,t)}};q.serviceId="instantTradeDialog",q.serviceName="InstantTradeDialogService";var Fa=o=>new q(o,y.isExtensionEnv?Da:Na);i();c();var H=class{constructor(){this.ctxIsReady=!1;this.currentToken=null;this.buyWithToken=null;this.sellForToken=null;this.tokenList=[];this.buyModeConfigList=[];this.sellModeConfigList=[];this.initDataLoading=!1;this.tokenListLoading=!0;this.activeTokenSelector=null;this.activeTokenSelectorShown=!1;this.marketLatestInfo=null;this.tokenPairFeeRate={["0"]:null,["1"]:null};this.showPnl=oe.get(ro.SHOW_PNL)??!0;this.selectTradeMode="0";gt(this)}setCtxIsReady(e){this.ctxIsReady=e}setCurrentToken(e){this.currentToken=e}get computedFormattedCurrentToken(){return{...this.currentToken,tokenSymbol:this.currentToken?.tokenSymbol||Nr,formattedTokenContractAddress:qt(this.currentToken?.tokenContractAddress,6,4),formattedBalance:Ie(this.currentToken?.balance,{needPlaceholder:!0}),formattedAvailableCurrencyAmount:y.currencyConversionWithSymbol(this.currentToken?.currencyAmount,{needPlaceholder:!0})}}setBuyWithToken(e){this.buyWithToken=e}get computedFormattedBuyWithToken(){let e=this.buyWithToken;return{...e,tokenSymbol:e?.tokenSymbol||Nr,formattedTokenContractAddress:qt(e?.tokenContractAddress,6,4),formattedBalance:Ie(e?.balance,{needPlaceholder:!0})}}setSellForToken(e){this.sellForToken=e}get computedFormattedSellForToken(){let e=this.sellForToken;return{...e,tokenSymbol:e?.tokenSymbol||Nr,formattedTokenContractAddress:qt(e?.tokenContractAddress,6,4),formattedBalance:Ie(e?.balance,{needPlaceholder:!0})}}setTokenList(e){this.tokenList=e}get computedFormattedTokenList(){return this.tokenList.map(e=>({...e,label:e.tokenSymbol,value:e.tokenContractAddress,formattedBalance:Ie(e.balance,{needPlaceholder:!0}),formattedCurrencyAmount:y.currencyConversionWithSymbol(e.currencyAmount,{needPlaceholder:!0})}))}setBuyModeConfigList(e){this.buyModeConfigList=e}setSellModeConfigList(e){this.sellModeConfigList=e}setInitDataLoading(e){this.initDataLoading=e}setTokenListLoading(e){this.tokenListLoading=e}setActiveTokenSelector(e,t){this.activeTokenSelector!==e&&!t||(this.activeTokenSelector=e,this.activeTokenSelectorShown=t)}setMarketLatestInfo(e){this.marketLatestInfo=e}get computedMarketLatestInfo(){return{...this.marketLatestInfo,formattedMarketCap:y.currencyConversionWithSymbol(this.marketLatestInfo?.marketCap)}}setTokenPairFeeRate(e){this.tokenPairFeeRate=e}};H.storeId="instantTrade",H.storeName="InstantTradeStore";var Wa=()=>new H;i();c();ce();async function ve({url:o,params:e}){let t=y.getOnt(),[r,n]=await Ne(t.get(o,{params:e}));return[r,n?.data||null]}function Et(o,e){let t=o||{};return e?{...t,amountNum:e.amountNum,currencyAmount:e.currencyAmount,balance:e.amountNum}:t}function Ua(o,e){let r=o.map(({currencyTokenInfo:n,currencyDefaultBuyAmountList:s})=>({...n,currencyDefaultBuyAmountList:s,balance:n?.amountNum})).filter(n=>!et(n,e));return r.length?fs(r,n=>Number(n.currencyAmount||0),"desc"):[]}var gr=(o,e)=>Array.isArray(o)?o.map((t,r)=>e==="0"?{amount:t,buttonUniqueId:`buy_${r}`}:{percent:t,buttonUniqueId:`sell_${r}`}):[],Va=o=>{let e=Kr({token:o,storageKey:ot});return e||o?.currencyDefaultBuyAmountList||[]},Ha=o=>{let e=Va(o),t=o?.currencyDefaultBuyAmountList;return gr(e||t,"0")},qa=({token:o,config:e})=>{Gt({token:o,amountList:e,storageKey:ot,isSell:!1})},Ga=o=>{let e=Kr({token:o,storageKey:nt});return e||o?.defaultSellPercentList||[]},Ka=o=>{let e=Ga(o),t=o?.defaultSellPercentList;return gr(e||t,"1")},Qa=({token:o,config:e})=>{Gt({token:o,amountList:e,storageKey:nt,isSell:!0})},yn=(o,e)=>{if(y.isExtensionEnv)return y.global.goToSwapPage?.({fromToken:o,toToken:e});let t=sa({from:o,toToken:e}),r=aa(t);return Ss(`${ys(As)}?${r}`,"_self")};var ne=class extends Gr{constructor(){super(...arguments);this.updateCurrentTokenInfo=async t=>{let[r,n]=await ve({url:Fr,params:t});if(r||!n)return null;let s={...n.tokenInfo||{},balance:n.tokenInfo?.amountNum,defaultSellPercentList:n.defaultSellPercentList};return this.instantTradeStore.setCurrentToken(s),s};this.getTokenInfoAndBalance=async t=>{let r={chainId:t.chainId,tokenAddress:t.tokenContractAddress,userWalletAddress:this.currentWalletStore.getAddressByChainId(t.chainId),accountId:this.currentWalletStore.computedAccountId,walletId:this.currentWalletStore.computedAccountId,userUniqueId:this.currentWalletStore.userUniqueId,businessType:"1"},[n,s]=await ve({url:Or,params:r});if(n||!s)return null;let a=s;if(et(a,this.instantTradeStore.currentToken)){let l=Et(this.instantTradeStore.currentToken,a);this.instantTradeStore.setCurrentToken(l)}if(et(a,this.instantTradeStore.buyWithToken)){let l=Et(this.instantTradeStore.buyWithToken,a);this.instantTradeStore.setBuyWithToken(l)}if(et(a,this.instantTradeStore.sellForToken)){let l=Et(this.instantTradeStore.sellForToken,a);this.instantTradeStore.setSellForToken(l)}return s};this.updateTokenBalance=t=>{if(et(t,this.instantTradeStore.currentToken)){let r=Et(this.instantTradeStore.currentToken,t);this.instantTradeStore.setCurrentToken(r)}if(et(t,this.instantTradeStore.buyWithToken)){let r=Et(this.instantTradeStore.buyWithToken,t);this.instantTradeStore.setBuyWithToken(r)}if(et(t,this.instantTradeStore.sellForToken)){let r=Et(this.instantTradeStore.sellForToken,t);this.instantTradeStore.setSellForToken(r)}};this.updateTokenList=async({params:t,currentToken:r,needLoading:n})=>{n&&this.instantTradeStore.setTokenListLoading(!0);let[s,a]=await ve({url:lr,params:{...t,accountId:this.currentWalletStore.computedAccountId,userUniqueId:this.currentWalletStore.userUniqueId,tradeType:1}});if(this.instantTradeStore.setTokenListLoading(!1),s||!a||!Array.isArray(a)||!a?.length)return this.instantTradeStore.setTokenList([]),[];let l=Ua(a,r);return l.length?(this.instantTradeStore.setTokenList(l),l):(this.instantTradeStore.setTokenList([]),[])};this.storeBuyModeConfigList=t=>{let r=gr(t,"0");qa({token:this.instantTradeStore.buyWithToken,config:t}),this.instantTradeStore.setBuyModeConfigList(r)};this.updateBuyModeConfigListByToken=t=>{let r=Ha(t);this.instantTradeStore.setBuyModeConfigList(r)};this.storeSellModeConfigList=t=>{let r=gr(t,"1");Qa({token:this.instantTradeStore.currentToken,config:t}),this.instantTradeStore.setSellModeConfigList(r)};this.updateSellModeConfigListByToken=t=>{let r=Ka(t);this.instantTradeStore.setSellModeConfigList(r)};this.openPresetModal=()=>{this.instantTradeDialogService.setPresetModalOpen(!0)};this.closePresetModal=()=>{this.instantTradeDialogService.setPresetModalOpen(!1)};this.openSettingModal=()=>{this.instantTradeDialogService.setSettingModalOpen(!0)};this.closeSettingModal=()=>{this.instantTradeDialogService.setSettingModalOpen(!1)};this.activateEditMode=()=>{this.instantTradeDialogService.setEditModeActive(!0)};this.deactivateEditMode=()=>{this.instantTradeDialogService.setEditModeActive(!1)};this.activateShortcut=()=>{this.instantTradeDialogService.setShortcutActive(!0)};this.deactivateShortcut=()=>{this.instantTradeDialogService.setShortcutActive(!1)};this.setBoostOnboardingShown=t=>{this.instantTradeDialogService.setBoostOnboardingShown(t)};this.resetUIState=()=>{this.instantTradeDialogService.setPresetModalOpen(!1),this.instantTradeDialogService.setSettingModalOpen(!1),this.instantTradeDialogService.setEditModeActive(!1),this.instantTradeDialogService.setShortcutActive(!1)};this.resetStoreData=()=>{this.instantTradeStore.setBuyModeConfigList([]),this.instantTradeStore.setSellModeConfigList([]),this.instantTradeStore.setCurrentToken(null),this.instantTradeStore.setBuyWithToken(null),this.instantTradeStore.setSellForToken(null)};this.setShowPnl=t=>{this.instantTradeStore.showPnl=t,oe.set(ro.SHOW_PNL,t)};this.setSelectTradeMode=t=>{this.instantTradeStore.selectTradeMode=t}}get currentWalletStore(){let t=this.getStore(U);if(!t)throw new Error("CurrentWalletStore not found in context");return t}get instantTradeStore(){let t=this.getStore(H);if(!t)throw new Error("InstantTradeStore not found in context");return t}get instantTradeDialogService(){let t=this.getService(q);if(!t)throw new Error("InstantTradeDialogService not found in context");return t}};ne.serviceId="instantTradeAction",ne.serviceName="InstantTradeAction";var Pn=o=>new ne(o);i();c();var cs=P(E());i();c();var Z=P(E()),is=P(me());i();c();function Fe(o){let e=Ie(o.amountNum,{needPlaceholder:!0});return{...o,formattedBalance:e}}function st(o,e){return String(o.chainId)===String(e.chainId)&&o.tokenContractAddress===e.tokenContractAddress}function za(o,e,t,r){let n={...o};return t&&(st(o,t)?(t.currencyAmount!==void 0&&(n.currencyAmount=t.currencyAmount),t.amountNum!==void 0&&(n.amountNum=t.amountNum)):console.warn("Token mismatch in mergeTokenInfo:",`strategy: ${o.chainId}/${o.tokenContractAddress}`,`currency: ${t.chainId}/${t.tokenContractAddress}`)),e&&(n.defaultSellPercentList=e),r&&(n.currencyDefaultBuyAmountList=r),n}function oo(o,e){return!o||!e||e.length===0?null:e.find(t=>t.chainId===o.chainId&&t.tokenContractAddress===o.tokenContractAddress)||null}function Ya(o,e){return!o||!e||e.length===0?null:e.findIndex(r=>r.chainId===o.chainId&&r.tokenContractAddress===o.tokenContractAddress)}function bn(o,e){return o.map(t=>({...t.currencyTokenInfo,formattedBalance:Ie(t.currencyTokenInfo.amountNum,{needPlaceholder:!0}),formattedCurrencyAmount:y.currencyConversionWithSymbol(t.currencyTokenInfo.currencyAmount,{needPlaceholder:!0}),currencyDefaultBuyAmountList:t.currencyDefaultBuyAmountList,defaultSellPercentList:e}))}function ja(o,e){return{...o,marketCap:e.marketCap,formattedMarketCap:y.currencyConversionWithSymbol(e.marketCap,{needPlaceholder:!0})}}function $a(o){try{return new Ts(o),!0}catch{return!1}}i();c();i();c();var Xa=P(E());i();c();var ao=P(E());i();c();i();c();var Za=10058;i();c();var xn=P(E());ce();var Il={FAIL:"-1",NO_SELECTED:"0",WAITING_FOR_FINAL:"1",WAITING_FOR_TRANSFER:"2",TRANSFER_SUCCEED:"3"},Cl={Succeed:"1"},Al=o=>{let{dexData:e}=o||{},{status:t,receiveTokenStatus:r,transactionHash:n,orderId:s,type:a}=e||{};if(a==="approve"||a==="register")return!1;let l=r!==Il.TRANSFER_SUCCEED;if(t===Cl.Succeed&&l&&n){if(pn(n),ur(n))return!0;mn(n),dn({isSimpleToast:!0,orderId:s,speedProvider:"OKX_DEX_WS"});let d=Kt.getDuration(s),p=d?Ke("swaptrade_toast_msg_transaction_success_time",{time:xn.default.createElement(un,{duration:d})}):A("swaptrade_meme_broadcast_toast_trade_successful");return Hr({tx_status:"success",terminal:"web"}),fn({title:p,orderId:s}),!0}return!1},yl=o=>{let{dexData:e,type:t}=o||{},{status:r,transactionHash:n,orderId:s}=e||{};if(r===to.SUCCESS&&Number(t)===1&&n){if(pn(n),ur(n))return!0;mn(n),dn({isSimpleToast:!1,orderId:s,speedProvider:"OKX_DEX_WS"});let a=Kt.getDuration(s),l=a?Ke("swaptrade_toast_msg_transaction_success_time",{time:xn.default.createElement(un,{duration:a})}):A("swaptrade_orders_text_details_success");return Hr({tx_status:"success",terminal:"web"}),fn({title:l,orderId:s}),!0}return r===to.FAILED?(Hr({tx_status:"failure",terminal:"web"}),ga({title:A("swaptrade_top_text_history_failed"),orderId:s}),!0):!1},Ja=o=>{if(Y(o,"dexData.orderFrom","")!==to.ORDER_FROM)return!1;let{type:t}=o||{};return t==="5"?Al(o):yl(o)};var ei=o=>{Ja(o)},ti=o=>{if(!o.success)switch(o.status){case"invalid_amount":re.error({title:A("swaptrade_instant_toast_cannot_be_zero")});break;case"insufficient_balance":re.error({title:A("swaptrade_home_btn_insufficient_balance_of",{tokenSymbol:o.tokenSymbol||""})});break;case"preset_config_error":re.error({title:A("swaptrade_quick_buy_alert_title_unable_to_load_preset")});break;default:re.error({title:A("swaptrade_home_toast_initiation_error")});break}};var vn=(o,e)=>{switch(o.status){case"not_support_chain":{let t=zo.tip({infoType:zo.Tip.INFO_TYPE.warn,title:A("swaptrade_top_alert_switch_wallets"),children:A("swaptrade_card_alert_switch_wallet_to_match",{chainName:e||""}),confirmText:A("commonall_text_btn_ok_passive"),onConfirm:()=>{t.destroy()}});break}case"invalid_token_address":re.error({title:A("swaptrade_home_toast_initiation_error")});break;case"no_user_wallet_address":re.error({title:A("swaptrade_top_alert_switch_wallets")});break;case"prepare_order_high_risk_token":re.error({title:A("swaptrade_mid_alert_highrisk_token",{token:o.errorInfo?.tokenSymbol||""}),desc:A("swaptrade_top_text_protect_capital")});break;case"prepare_order_error":re.error({title:o.errorInfo?.errorMessage||A("swaptrade_home_toast_initiation_error")});break;case"wallet_version_error":re.error({title:"UPGRADE_WALLET"});break;default:o.success||re.error({title:A("swaptrade_home_toast_initiation_error")});break}},so=o=>{let{transactionHash:e,orderId:t}=o;switch(o.status){case"done":if(e&&ur(e))return;jo.pending({title:A(o?.titleKey||"wallet_swap_toast_swap_submitted"),placement:jo.DIRECTION.top,id:t?`notification-${t}`:void 0,lottieProps:{speed:3}});break;case"eoa_broadcast_error":Ae.error({title:o?.error||A("swaptrade_home_toast_initiation_error"),placement:Ae.DIRECTION.top});break;case"wallet_denied_eoa_sign_error":case"error":pr(o.error)?Ae.error({title:A("swaptrade_notification_notif_transaction_canceled"),placement:Ae.DIRECTION.top}):Ae.error({title:A("swaptrade_home_toast_initiation_error"),placement:Ae.DIRECTION.top});break;default:break}},ri=o=>{let{success:e,fromTokenSymbol:t,error:r}=o;e?Ae.pending({title:A("swaptrade_transfer_toast_ccy_unrevoke_submit",{ccy:ca(t)}),placement:Ae.DIRECTION.top}):pr(r)?Ae.error({title:A("swaptrade_notification_notif_transaction_canceled"),placement:Ae.DIRECTION.top}):Ae.error({title:A("swaptrade_home_toast_initiation_error"),placement:Ae.DIRECTION.top})};var oi=({chainId:o,tokenContractAddress:e,onWalletAssetAmountChange:t})=>{let r=M(H),{ctxIsReady:n}=r,s=(0,ao.useCallback)((a,l)=>{if(!!a&&(l?.channel===vt.DEX_PUSH_ENGINE&&ei(a),l.channel===vt.WALLET_ASSET)){let d=a,p=String(d.chainId)===o,f=d.tokenAddress===e;if((!p||!f)&&!d.isNativeToken)return;t(d)}},[o,e,t]);(0,ao.useEffect)(()=>{let a;return n&&(a=Ht({isPri:!0,needLogin:!0,subscribeParams:[{channel:vt.DEX_PUSH_ENGINE},{channel:vt.WALLET_ASSET}],onListenError:()=>{},onListenData:s})),()=>{a?.()}},[n,s])};i();c();var ni=P(E());var si=()=>{let o=M(U),{isConnectedWallet:e,computedAccountId:t}=o;(0,ni.useEffect)(()=>{e&&y.checkSupportMev().then(r=>{o.setWalletSupportMev(r)}).catch(()=>{})},[e,t,o])};i();c();var ze=P(E());i();c();i();c();i();c();i();c();i();c();i();c();i();c();i();c();ce();var Qt=class{constructor(e){this.fetchConfig={};this.chainId=e}getDefaultOrigin(){return typeof window<"u"?window.location.origin:""}getOriginFromReferer(e){if(!e)return this.getDefaultOrigin();try{return new URL(e).origin}catch{return e}}async broadcastToBlockRazorItem(e,t,r){let n=this.buildRequestPayload(e),s=Ur.getRandomId(16),a=r||this.getDefaultOrigin(),l=this.buildRequestHeaders(s,a),d=this.getLogPrefix(),p=m=>{let g={error:m,url:t,uuid:s,payload:n,chainId:this.chainId,tx:this.processTransactionForLogging(e)},u=this.getAdditionalLogData(e,a);return{error:m,data:{...g,...u}}},f=Rr(n)?n:JSON.stringify(n);try{let m=await fetch(t,{method:"POST",headers:l,body:f,...this.fetchConfig});if(m.ok){let u=await m.text(),T;try{T=JSON.parse(u)}catch{T=u}let k=this.parseResponse(T),S=p();if(k.success&&k.result)return J.info(`${d}_${xe.THIRD_SERVICE_BROADCAST_SUCCESS}_${s}`,{...S,data:{...S.data,[this.getTransactionFieldName()]:k.result}}),{success:!0,url:t,error:void 0};let C=k.error||"Unknown error";return J.error(`${d}_${xe.THIRD_SERVICE_BROADCAST_ERROR}_${s}`,{...p(new Error(C)),data:{...S.data,responseData:T}}),{success:!1,url:t,error:k.error}}let g=`HTTP ${m.status}: ${m.statusText}`;return J.error(`${d}_${xe.THIRD_SERVICE_BROADCAST_ERROR}_${s}`,{...p(new Error(g)),data:{...p().data,status:m.status}}),{success:!1,url:t,error:g}}catch(m){let g=m instanceof Error?m.message:String(m);return J.error(`${d}_${xe.THIRD_SERVICE_BROADCAST_ERROR}_${s}`,p(m)),{success:!1,url:t,error:`Network error: ${g}`}}}async broadcastToUrlsParallel(e,t,r){if(!t||t.length===0)return[];let n=[],s=0,a=!1;return new Promise(l=>{t.forEach((d,p)=>{this.broadcastToBlockRazorItem(e,d,r).then(f=>{n[p]=f,s++,f.success&&!a&&(a=!0,l(n.filter(Boolean))),s===t.length&&!a&&l(n)}).catch(f=>{n[p]={success:!1,url:d,error:f instanceof Error?f.message:String(f)},s++,s===t.length&&!a&&l(n)})})})}async smartBroadcast(e,t){let r=t.map(async s=>{try{let a=await this.handleProvider(e,s);if(a===null)return{providerName:s.name,results:[],successCount:0,errorCount:0,totalCount:0};let l=a.filter(d=>d.success).length;return{providerName:s.name,results:a,successCount:l,errorCount:a.filter(d=>!d.success).length,totalCount:a.length}}catch(a){return{providerName:s.name,results:s.url.map(l=>({success:!1,url:l,error:a instanceof Error?a.message:String(a)})),errorCount:s.url.length,successCount:0,totalCount:s.url.length}}});return await Promise.all(r)}};var io=class extends Qt{constructor(t="56"){super(t);this.fetchConfig={mode:"cors"}}buildRequestPayload(t){return{jsonrpc:"2.0",method:"eth_sendRawTransaction",params:t,id:1}}buildRequestHeaders(t,r){return{"Content-Type":"application/json",uuid:t}}parseResponse(t){if(typeof t=="object"&&t!==null){let r=t;if(r.error)return{success:!1,error:typeof r.error=="string"?r.error:r.error.message?.toString()||JSON.stringify(r.error)};if(r.result)return{success:!0,result:r.result}}else if(typeof t=="string")return{success:!0,result:t.trim()};return{success:!1,error:"No_transaction_hash_found_in_response"}}getLogPrefix(){return"BSC_BlockRazor"}getTransactionFieldName(){return"txHash"}processTransactionForLogging(t){return t.map(r=>r.substring(0,66)).join(",")}getAdditionalLogData(t,r){return{origin:r}}async broadcastToBlockRazor(t,r){if(t.length===0||!r.url||r.url.length===0)return[];let n=this.getOriginFromReferer(r.referer);return this.broadcastToUrlsParallel(t,r.url,n)}async handleProvider(t,r){switch(r.name){case"BLOCKRAZOR_FASTEST":case"BLOCKRAZOR":return this.broadcastToBlockRazor(t,r);default:return null}}};i();c();var co=class extends Qt{constructor(e="501"){super(e)}buildRequestPayload(e){return e[0]||""}buildRequestHeaders(e,t){let r=t;return{"Content-Type":"text/plain"}}parseResponse(e){let t=null,r=!1,n="";if(typeof e=="string")t=e.trim();else if(e&&typeof e=="object"){let s=e;s.error&&typeof s.error=="string"&&s.error.trim()?(r=!0,n=s.error):t=s.signature||s.txHash||s.hash}return!r&&t&&t.trim()?{success:!0,result:t.trim()}:{success:!1,error:r?n:"No signature found in response"}}getLogPrefix(){return"BlockRazor"}getTransactionFieldName(){return"signature"}processTransactionForLogging(e){return e[0]||""}getAdditionalLogData(){return{}}async broadcastToBlockRazor(e,t){if(!e[0]||!t.url||t.url.length===0)return[];let r=this.getOriginFromReferer(t.referer);return this.broadcastToUrlsParallel(e,t.url,r)}async handleProvider(e,t){switch(t.name){case"BLOCKRAZOR_FASTEST":case"BLOCKRAZOR":return this.broadcastToBlockRazor(e,t);default:return null}}};function ai(o){if(Tt(o))return new co(o);if(Wr(o))return new io(o);throw new Error(`Unsupported chainId: ${o}. Only Solana and BSC are supported.`)}i();c();var ii=async({signedTx:o,providers:e,chainId:t})=>{try{return!e||e.length===0?[]:!o||o.length===0?[]:await ai(t).smartBroadcast(o,e)}catch(r){let n=(o?.[0]||"").slice(0,66);return J.error(`${xe.THIRD_SERVICE_BROADCAST_ERROR}_broadcastWithRpc`,{error:r instanceof Error?r:new Error(String(r)),data:{chainId:t,providerCount:e?.length||0,providerNames:(e||[]).map(s=>s.name),txPreview:n}}),[]}};i();c();var Pl=async({quoteData:o,broadcastParams:e})=>{let{isBatchBroadcast:t,isCombineApproveAndSwap:r}=o,n=y.getOnt();if(t){let a=await n.post(Es,e);return a&&(a.clientBroadcastToastKey="swaptrade_mid_dialog_toast_success_submitted"),a}let s=await n.post(Rs,e);return s&&r&&(s.skipClientBroadcastToast=!0),s},En=Pl;function ci(o){let{chainId:e,teeSilentSignEnabled:t,broadcastProvider:r,isCancelSimulate:n,enableMev:s}=o;return n&&(Tt(e)||Wr(e))&&t&&Array.isArray(r)&&r.length>0&&!s}async function li({quoteData:o,okxBroadcastParams:e,thirdBroadcastParams:t}){let r=[],n=null,s=null,a=s,l={msg:"",error_message:"",code:0,detailMsg:"",data:{},error_code:"0",clientBroadcastToastKey:"",skipClientBroadcastToast:!1};if(t.shouldClientBroadcast)try{let d=await Promise.allSettled([ii({signedTx:t.signedTx,providers:t.providers,chainId:t.chainId}),En({quoteData:o,broadcastParams:{...e,clientBroadcast:t.providers?.map(m=>m.name).join(",")}})]);d[0].status==="fulfilled"?r=d[0].value||[]:r=[];let p=r.every(m=>m.successCount===0),f=!p;if(d[1].status==="fulfilled"?(n=d[1].value,s=null):(n=null,s=d[1].reason),p&&s)a=s,l=null;else{if(a=null,f&&s){let m=t.signedTx?.[0];l.clientBroadcastToastKey="swaptrade_order_top_toast_submit_timeout",l.data={...l.data,isThirdPartyBroadcastOnly:!0,thirdPartyTxHash:m,needTimeoutWatch:!0}}else(f&&n||p&&n)&&(l=n);J.updateTradeLogEnd({broadcastErr:a,clientBroadcastErr:p,okxBroadcastError:s})}}catch(d){J.error(xe.MULTI_BROADCAST_UNEXPECTED_ERROR,{error:d,params:e}),a=d,l=null}else{let[d,p]=await Ne(En({quoteData:o,broadcastParams:e}));l=p,a=d}return[a,l]}i();c();var bl=({shouldClientBroadcast:o,quoteData:e})=>{let t=!o&&!e?.isCombineApproveAndSwap;return Tt(e.chainId)?{simulate:t,unsignedData:{unsignedTx:e?.transactionData?.unsignedTx,hasReferralCommission:e?.transactionData?.hasReferralCommission}}:{simulate:t,calldataOut:e?.transactionData?.callData}},xl=({transactionData:o,signedResult:e})=>{let[t,r]=e.signedInfoList||[];return{simulate:!0,transactions:[{signedTx:t.signature,transactionHash:t.txHash,callDataOut:o.approveTxInfo?.unsignedTx,orderId:o.approveTxInfo?.id},{signedTx:r.signature,transactionHash:r.txHash,callDataOut:o?.callData,orderId:o?.orderId}]}},vl=()=>tn.isSaAccountNotCreate?{}:tn.isSaActive?{teeSaStatus:"1"}:{teeSaStatus:"2"},El=({shouldClientBroadcast:o,quoteData:e,transactionData:t,signAndSendTransactionParams:r,signedResult:n})=>t.approveTxInfo&&e.isBatchBroadcast?{...xl({transactionData:t,signedResult:n}),fromTokenAddress:e.fromTokenAddress,fromAmount:e.fromAmount,mevSuppliers:r?.mevSuppliers,checkBalance:!0,userWalletAddress:e.userWalletAddress,walletId:e.walletId,chainId:e.chainId}:{...bl({shouldClientBroadcast:o,quoteData:e}),solanaEncoding:e.solanaEncoding,walletId:e.walletId,userWalletAddress:e.userWalletAddress,nonce:n.nonce,signedInfoList:n.signedInfoList,mevSuppliers:r?.mevSuppliers,orderId:t.orderId,accountInfo:vl()},di=El;i();c();var Rl=({quoteAndCalldataResult:o})=>{let e=o?.commonDexInfo;if(!e)return null;let t=o?.defiPlatformInfoList?.[0];return t?{commonDexInfo:e,transactionData:t.transactionData,serviceFeeInfo:t.serviceFeeInfo}:null},Ll=({quoteAndCalldataResult:o,quoteAndCalldataParams:e})=>{let t=Rl({quoteAndCalldataResult:o});if(!t)return null;let{commonDexInfo:r,transactionData:n,serviceFeeInfo:s}=t;return{quoteData:{chainId:String(r.fromToken.chainId),userWalletAddress:e.userWalletAddress,transactionData:n,serviceFeeInfo:s,orderId:n.orderId,toTokenAddress:r.toToken.tokenContractAddress,fromTokenAddress:r.fromToken.tokenContractAddress,fromAmount:r.fromTokenAmount,accountId:e.accountInfo.accountId,solanaEncoding:e.solanaEncoding,teeSilentSignEnabled:e.accountInfo.teeSilentSignEnabled,walletId:e.accountInfo.accountId},transactionData:n}},ui=Ll;i();c();i();c();var Qe="501",Ml={ETH:"1",BSC:"56",BASE:"8453",ARB:"42161",XLAYER:"196"},pi=[Qe,...Object.values(Ml)];i();c();var Rt=class{constructor(){this.adapters=new Map}static getInstance(){return Rt.instance||(Rt.instance=new Rt),Rt.instance}static resetInstance(){Rt.instance=null}get supportedChainIds(){return _s()?[...pi]:Array.from(this.adapters.keys())}registerAdapter(e,t){this.adapters.set(e,t)}getAdapter(e){let t=this.adapters.get(e);if(!t)throw new Error(`NO_ADAPTER_FOR_CHAIN_${e}`);return t}requiresApproval(e,t,r){return this.getAdapter(e).requiresApproval(t,r)}isValidAddress(e,t){return this.getAdapter(e).isValidAddress(t)}},lo=Rt;lo.instance=null;var Tr=lo;i();c();i();c();var mi=async o=>{let{chainId:e,unsignedTx:t,hasReferralCommission:r,signWalletAddress:n}=o,s="";try{let a=JSON.parse(t);s=a.array?a.array[0].data:a.data}catch{return{success:!1,error:"FAILED_TO_PARSE_UNSIGNED_TX"}}if(!s)return{success:!1,error:"CALLDATA_IS_EMPTY"};try{let a=await $s({callData:s,chainId:Number(e),address:n,hasReferralCommission:r});return a.success?{success:!0}:{success:!1,error:"VERIFY_CALLDATA_FAILED",result:a}}catch{return{success:!1,error:"VERIFY_CALLDATA_ERROR"}}};var wl=/^[1-9A-HJ-NP-Za-km-z]{32,44}$/,Rn=class{constructor(){this.chainId=Qe;this.signingQueue=[];this.isProcessingQueue=!1}isValidAddress(e){return e?wl.test(e):!1}requiresApproval(e,t){return!1}async signTransactions(e,t){let{isSilent:r,defaultEnabledSilentMethod:n,solanaEncoding:s,logger:a,calldataParams:l}=t,d=s||"bs58",f=e.map(u=>{if(!u.unsignedTx)throw new Error("UNSIGNED_TX_NOT_PROVIDED");return u.unsignedTx}).map(u=>zr.solanaSignTransaction({unsignedTx:u,solanaEncoding:d},{isSilentSign:r,defaultEnabledSilentMethod:n,encoding:d,logger:a,...l&&{calldataParams:l}}));return(await Promise.all(f)).flatMap(u=>{let{signedInfoList:T}=u;return T.map(k=>({signature:k?.signature||"",txHash:k?.txHash||""}))})}async processNextQueueItem(){if(this.signingQueue.length===0){this.isProcessingQueue=!1;return}let e=this.signingQueue.shift();e&&await e.execute(),await this.processNextQueueItem()}startQueueProcessing(){this.isProcessingQueue||(this.isProcessingQueue=!0,this.processNextQueueItem().catch(()=>{this.isProcessingQueue=!1}))}enqueueSigningTask(e){return new Promise((t,r)=>{let n={execute:async()=>{try{let s=await e();t(s)}catch(s){r(s)}}};this.signingQueue.push(n),this.startQueueProcessing()})}async batchSignAndAssign(e,t){return this.enqueueSigningTask(async()=>{let r=e.map(s=>s.getParsedData());return{success:!0,results:{signedInfoList:await this.signTransactions(r,t)}}})}async getMevConfig(e){return e?.enableMev?{enableMev:!0,mevSuppliers:e.mevSuppliers}:{enableMev:!1}}parseTransactionData(e,t){return e.unsignedTx?{swapCalldata:{data:"",to:"",from:t,value:"0",chainId:this.chainId,unsignedTx:e.unsignedTx,orderId:e.orderId},approveCalldata:void 0,orderId:e.orderId,mevConfig:e.mevConfig,broadcastProvider:e.broadcastProvider,solanaEncoding:e.solanaEncoding}:null}getCallDataForVerification(e){return e.unsignedTx||""}async verifyCallData(e){let{swapCalldata:t,hasReferralCommission:r,signWalletAddress:n}=e,s=this.getCallDataForVerification(t);return mi({chainId:this.chainId,unsignedTx:s,hasReferralCommission:r,signWalletAddress:n})}},Ln=Rn;i();c();i();c();i();c();var at=class{constructor(){this.currentState="IDLE"}get state(){return this.currentState}get orderId(){return this.processOrderId}getParsedData(){return this.parsedData}setSignedTransaction(e){this.signedTx=e,this.currentState="SIGNED"}getResult(){return{success:this.currentState==="SIGNED",signedTx:this.signedTx,error:this.error}}getError(){return this.error}reset(){this.currentState="IDLE",this.parsedData=void 0,this.signedTx=void 0,this.error=void 0}};i();c();async function Dl(o){try{let[e,t]=await Mr.get(Jo,{params:o});return e||!t?.data?(console.error("Failed to fetch cancel approval calldata:",e),null):t.data}catch(e){return console.error("fetchCancelApprovalCalldata error:",e),null}}function Nl(o){let{cancelCalldata:e,parserParams:t}=o,{id:r,data:n,from:s,to:a,value:l,unsignedTx:d,gas:p,gasPrice:f,maxFeePerGas:m,maxPriorityFeePerGas:g,type:u,nonce:T}=e,k={data:n,from:s,to:a,value:l};return t.teeSilentSignEnabled&&(k=Ta({...k,gas:p,gasPrice:f,maxFeePerGas:m,maxPriorityFeePerGas:g,type:u,nonce:T})),{id:r,chainId:t.chainId,unsignedTx:d,...k}}var Mn=class extends at{constructor(t){super();this.type="CANCEL_APPROVAL";this.buildParams=t}setParams(t){this.buildParams=t}async build(t){if(!this.buildParams)return this.error=new Error("BUILD_PARAMS_NOT_SET"),this.currentState="ERROR",!1;let{chainId:r,userWalletAddress:n,tokenContractAddress:s}=this.buildParams;try{this.currentState="BUILDING";let a=await Dl({userWalletAddress:n,tokenContractAddress:s,chainId:r,defiPlatformId:"11",cancelApproveTag:"1",teeSilentSignEnabled:Boolean(t?.isSilentSign)});return a?(this.processOrderId=a.id,this.parsedData=Nl({cancelCalldata:a,parserParams:{chainId:r,teeSilentSignEnabled:Boolean(t?.isSilentSign)}}),this.currentState="BUILT",!0):(this.error=new Error("CANCEL_APPROVAL_CALLDATA_FETCH_FAILED"),this.currentState="ERROR",!1)}catch(a){return this.error=a,this.currentState="ERROR",!1}}};var wn=Mn;i();c();var Dn=class extends at{constructor(t){super();this.type="APPROVAL";this.calldata=t}setCalldata(t){this.calldata=t}async build(t){if(!this.calldata)return this.error=new Error("CALLDATA_NOT_SET"),this.currentState="ERROR",!1;try{if(this.currentState="BUILDING",String(t.chainId)===Qe)this.parsedData={...this.calldata};else{let{transactionPayload:r}=ha({approveTxInfo:this.calldata,params:{isOnlySign:!0,chainId:t.chainId}});this.parsedData=r}return this.currentState="BUILT",!0}catch(r){return this.error=r,this.currentState="ERROR",!1}}};var Nn=Dn;i();c();var On=class extends at{constructor(t,r){super();this.type="SWAP";this.calldata=t,r&&(this.processOrderId=r)}setCalldata(t,r){this.calldata=t,r&&(this.processOrderId=r)}async build(t){if(!this.calldata)return this.error=new Error("CALLDATA_NOT_SET"),this.currentState="ERROR",!1;try{return this.currentState="BUILDING",String(t?.quoteData?.chainId)===Qe?this.parsedData={...this.calldata}:this.parsedData=await this.formatEVMPayload(t),this.currentState="BUILT",!0}catch(r){return this.error=r,this.currentState="ERROR",!1}}async formatEVMPayload(t){let{quoteData:r,transactionData:n,enableMev:s,isSilentSign:a}=t;if(!r||!n)throw new Error("QUOTE_DATA_OR_TRANSACTION_DATA_NOT_PROVIDED");return(await ka({chainId:r.chainId},{orderData:n,extParams:{txSource:3,orderId:this.processOrderId||n.orderId,toTokenAddress:r.toTokenAddress,crossChain:0,chainId:r.chainId,tokenAddress:r.fromTokenAddress,amount:r.fromAmount,toChainId:r.chainId}},{extendEvmParams:p=>(s&&(p.extParams.isMev=!0),p)}).getSendTransactionParams({needGasPrice:!0,isSilentSign:a}))[0]}};var Bn=On;i();c();i();c();var mo=o=>{let{chainId:e,amount:t,fromToken:r,toToken:n,userWalletAddress:s,accountId:a,presetConfig:l,slippageConfig:d,networkFee:p,orderSource:f,tradeMode:m,direction:g,accountInfo:u,ext:T,liquidityConfig:k,solanaEncoding:S}=o;return{chainId:e,fromTokenAddress:r.tokenContractAddress,toTokenAddress:n.tokenContractAddress,toTokenSymbol:n.tokenSymbol,amount:t,userWalletAddress:s,accountId:a,presetConfig:l,slippageConfig:d,networkFee:p,orderSource:f,tradeMode:m,direction:g,accountInfo:u,ext:T,liquidityConfig:k,solanaEncoding:S}},fo=o=>{let e=[];return o.chainId||e.push("chainId"),o.fromTokenAddress||e.push("fromTokenAddress"),o.toTokenAddress||e.push("toTokenAddress"),o.amount||e.push("amount"),o.userWalletAddress||e.push("userWalletAddress"),e.length>0?{valid:!1,missingFields:e}:{valid:!0}},go=(o,e)=>{let t=o.commonDexInfo,r=o.defiPlatformInfoList?.[0];if(t&&r){let{transactionData:n,serviceFeeInfo:s}=r;return{chainId:String(t.fromToken.chainId),orderId:n.orderId,fromTokenAddress:t.fromToken.tokenContractAddress,toTokenAddress:t.toToken.tokenContractAddress,fromAmount:t.fromTokenAmount,swapCalldata:n.callData,approveCalldata:n.approveTxInfo||void 0,tokenApprovalInfo:r.tokenApprovedInfo,serviceFeeInfo:s,mevConfig:n.mevConfig,broadcastProvider:n.broadcastProvider,solanaEncoding:n.solanaEncoding}}return o.data||o.unsignedTx?{chainId:e.chainId,orderId:o.orderId,fromTokenAddress:e.fromTokenAddress,toTokenAddress:e.toTokenAddress,fromAmount:"",swapCalldata:{orderId:o.orderId,to:o.to,from:o.from,value:o.value,data:o.data,gas:o.gas,gasPrice:o.gasPrice,maxFeePerGas:o.maxFeePerGas,maxPriorityFeePerGas:o.maxPriorityFeePerGas,nonce:o.nonce,type:o.type,unsignedTx:o.unsignedTx},approveCalldata:o.approveData,tokenApprovalInfo:o.tokenApprovedInfo}:null},To=(o,e)=>{let t=o.commonDexInfo,r=o.defiPlatformInfoList?.[0];if(!t||!r)return null;let{transactionData:n,serviceFeeInfo:s,tokenApprovedInfo:a}=r,l={orderId:n.orderId,unsignedTx:n.unsignedTx,callData:n.callData,approveTxInfo:n.approveTxInfo,mevConfig:n.mevConfig,broadcastProvider:n.broadcastProvider,solanaEncoding:n.solanaEncoding},d=e.parseTransactionData(l);return d?{chainId:String(t.fromToken.chainId),orderId:d.orderId,fromTokenAddress:t.fromToken.tokenContractAddress,toTokenAddress:t.toToken.tokenContractAddress,fromAmount:t.fromTokenAmount,swapCalldata:d.swapCalldata,approveCalldata:d.approveCalldata,tokenApprovalInfo:a,serviceFeeInfo:s,mevConfig:n.mevConfig,broadcastProvider:n.broadcastProvider,solanaEncoding:n.solanaEncoding}:null};i();c();var Fn=async o=>{let{toTokenSymbol:e,...t}=o,[r,n]=await zr.getMarketQuoteAndCalldata({...t});if(r){let s=r,a=Number(s?.error_code)===Za,l={error_code:String(s?.error_code||""),error_message:s?.error_message||"",code:s?.code||-1},d;return a?d={...l,isHighRiskToken:!0,tokenSymbol:e||""}:d={...l},{success:!1,error:d}}return{success:!0,result:n?.data}};i();c();ce();var Wn=async()=>{let o=y.getSignWalletAddress(),e=y.getWalletAddressByChainId(Oe.ETHEREUM_MAINNET);return o||e},Un=()=>{let o=y.getSignWalletAddress(),e=y.getWalletAddressByChainId(Oe.ETHEREUM_MAINNET);return o||e||""},fi=o=>y.getWalletAddressByChainId(o)||"",hr=async(o,e)=>{let t=await js({address:o,chainId:Number(e)});return qe(t)?{referralForQuote:{},referInfo:{}}:{referralForQuote:{refCode:t.refCode,referralCommissionJsVersion:Xs},referInfo:t}};var Bl=async o=>{try{let[e]=await Mr.post(en,o);return!e}catch{return!1}},ht=class{constructor(){this.initialized=!1;this.chainManager=Tr.getInstance()}static getInstance(){return ht.instance||(ht.instance=new ht),ht.instance}static resetInstance(){ht.instance=null,Tr.resetInstance()}static isChainSupported(e){return Tr.getInstance().supportedChainIds.includes(e)}initialize(){this.initialized||(this.chainManager.registerAdapter(Qe,new Ln),this.initialized=!0)}getChainManager(){return this.chainManager}async precheckApproval(e){this.initialized||this.initialize();let{chainId:t,tokenContractAddress:r,isNativeToken:n,userWalletAddress:s,tradeAmount:a}=e;if(!this.chainManager.requiresApproval(t,r,n))return{requiresApprovalCheck:!1};try{let d=new _a,p={chainId:Number(t),tokenContractAddress:r,amount:a},m=(await d.fetchApproveAllowance(p,s,[cr]))?.[cr],g=m?.amount||"0",u=m?.needCancelApproveToken??!1;return{requiresApprovalCheck:!0,tokenApprovalInfo:{amount:g,needCancelApproveToken:u}}}catch{return{requiresApprovalCheck:!0,tokenApprovalInfo:{amount:"0",needCancelApproveToken:!1}}}}async prepareTrade(e){this.initialized||this.initialize();let{chainId:t,amount:r,fromToken:n,toToken:s,accountId:a,userWalletAddress:l}=e;try{if(!ht.isChainSupported(t))return{success:!1,status:"not_support_chain"};let d=this.chainManager.isValidAddress(t,n.tokenContractAddress),p=this.chainManager.isValidAddress(t,s.tokenContractAddress);if(!d||!p)return{success:!1,status:"invalid_token_address"};let f=await this.validateWalletAndChain(t,a,l);if(!f.success)return{success:!1,status:f.status};let m=e.precheckApprovalResult?.tokenApprovalInfo,g=this.determineStrategy(t,n.tokenContractAddress,n.isNativeToken??!1,r,n.decimals,m),u=g==="NEED_APPROVAL"||g==="NEED_CANCEL_AND_APPROVE",T=await Wn(),{referralForQuote:k}=await hr(T,t),S=mo({...e,ext:{...e.ext,...k,needApproveTxInfo:u}}),C=await this.prepareOrderForTrade(S);return C.success?C.swapCalldata?{success:!0,tradeContext:{chainId:t,chainName:e.chainName,amount:r,fromToken:n,accountId:a,userWalletAddress:l,strategy:g,swapCalldata:C.swapCalldata,approveCalldata:C.approveCalldata,orderId:C.orderId,tokenApprovedInfo:m,prepareParams:S,rawApiResponse:C.rawApiResponse}}:{success:!1,status:"prepare_order_error",error:new Error("NO_SWAP_CALLDATA")}:{success:!1,status:C.status||"prepare_order_error",error:C.error,errorInfo:C.errorInfo}}catch(d){return{success:!1,status:"error",error:d}}}async signAndBroadcastCancelApproval(e){let{chainId:t,userWalletAddress:r,fromTokenAddress:n,signOptions:s}=e;this.initialized||this.initialize();try{let a=new wn({chainId:t,userWalletAddress:r,tokenContractAddress:n});if(!await a.build({chainId:Number(t),isSilentSign:s.isSilent})||!a.getParsedData())return{success:!1,error:a.getError()||new Error("BUILD_FAILED")};let d=this.chainManager.getAdapter(t);if(!d.signAndBroadcastTransaction)return{success:!1,error:new Error("ADAPTER_SIGN_AND_BROADCAST_NOT_SUPPORTED")};let p=a.getParsedData();if(!p)return{success:!1,error:new Error("CANCEL_TX_NOT_BUILT")};let{txHash:f}=await d.signAndBroadcastTransaction({transactionPayload:p},{isSilentSign:s.isSilent});return f?(await Bl({id:a.orderId,chainId:t,userWalletAddress:r,cancelApproveTag:"1",transactionHash:f}),{success:!0,txHash:f,orderId:a.orderId}):{success:!1,error:new Error("SIGNED_TX_HASH_NOT_FOUND")}}catch(a){return{success:!1,error:a}}}async executeTrade(e){let{preparedTrade:t,silentEnabled:r,defaultEnabledSilentMethod:n,logger:s,preBroadcastCallback:a,calldataParams:l}=e;if(!t.success||!t.tradeContext)return{status:t.status||"error",success:!1,error:t.error,errorInfo:t.errorInfo};let{chainId:d,fromToken:p,accountId:f,userWalletAddress:m,strategy:g,orderId:u,swapCalldata:T,approveCalldata:k,prepareParams:S,rawApiResponse:C}=t.tradeContext,_={chainId:S.chainId,fromTokenAddress:S.fromTokenAddress,toTokenAddress:S.toTokenAddress,amount:S.amount,userWalletAddress:S.userWalletAddress,tradeMode:String(S.tradeMode),accountInfo:{accountId:S.accountInfo.accountId,teeSilentSignEnabled:S.accountInfo.teeSilentSignEnabled,accountBizLine:S.accountInfo.accountBizLine},solanaEncoding:S.solanaEncoding},I=C,x={isSilent:r,defaultEnabledSilentMethod:n,...l&&{calldataParams:l}},v=this.chainManager.getAdapter(d);try{let b=await this.executeMainTradePipeline({chainId:d,userWalletAddress:m,accountId:f,fromTokenAddress:p.tokenContractAddress,strategy:g,swapCalldata:T,approveCalldata:k,orderId:u,adapter:v,signOptions:x,quoteAndCalldataParams:_,quoteAndCalldataResult:I,logger:s,preBroadcastCallback:a});return b.success?{status:"done",success:!0,titleKey:b.titleKey,transactionHash:b.txHash,orderId:b.orderId}:{status:b.status||"error",success:!1,error:b.error}}catch(b){return{status:"error",success:!1,error:b}}}determineStrategy(e,t,r,n,s,a){if(!this.chainManager.requiresApproval(e,t,r))return"NO_APPROVAL";if(!a)return"NEED_APPROVAL";let d=Ds(a.amount,s)||"0";return V.gte(d,n)?"NO_APPROVAL":a.needCancelApproveToken&&V.gt(n,d)&&V.gt(d,"0")?"NEED_CANCEL_AND_APPROVE":"NEED_APPROVAL"}async executeMainTradePipeline(e){let{chainId:t,userWalletAddress:r,strategy:n,swapCalldata:s,approveCalldata:a,orderId:l,adapter:d,signOptions:p,quoteAndCalldataParams:f,quoteAndCalldataResult:m,logger:g,preBroadcastCallback:u}=e;if(!s)return{success:!1,error:new Error("SWAP_CALLDATA_NOT_PROVIDED")};let T=[],k,S=["NEED_APPROVAL","NEED_CANCEL_AND_APPROVE"].includes(n)&&a;S&&(k=new Nn(a),T.push(k));let C=new Bn(s,l);T.push(C);let{quoteData:_,transactionData:I}=ui({quoteAndCalldataParams:f,quoteAndCalldataResult:m}),x=await d.getMevConfig(I.mevConfig),v={chainId:Number(t),quoteData:{chainId:Number(t),toTokenAddress:_.toTokenAddress,fromTokenAddress:_.fromTokenAddress,fromAmount:_.fromAmount},transactionData:{orderId:I.orderId,...I},enableMev:x.enableMev,isSilentSign:p.isSilent||p.defaultEnabledSilentMethod};if((await Promise.all(T.map(ae=>ae.build(v)))).some(ae=>!ae))return{success:!1,error:T.find(It=>!It.getParsedData())?.getError()||new Error("BUILD_FAILED")};let z={...p,transactionData:{orderId:I.orderId,callData:I.callData,mevConfig:I.mevConfig},solanaEncoding:f?.solanaEncoding,logger:g};g&&t!==Qe&&ua(g);let N=await this.batchSignTransactionProcesses(T,d,z);if(!N.success)return{success:!1,status:N.isUserRejection?"wallet_denied_eoa_sign_error":"error",error:N.error};let O=await d.verifyCallData({swapCalldata:s,hasReferralCommission:I.hasReferralCommission,signWalletAddress:r});if(!O.success)switch(O.error){case"FAILED_TO_PARSE_UNSIGNED_TX":g?.stuff({msg:"log-verifyCallData-error-parse-tx",error:O.error,unsignedTx:s.unsignedTx});break;case"CALLDATA_IS_EMPTY":cn({success:!1,refCode:"",parsedAddress:"",localCommissionAddress:"",walletId:e.accountId,txHash:N.results.signedInfoList?.[0]?.txHash,orderId:l,callDataIsEmpty:!0,requestCommissionAddress:e.quoteAndCalldataResult?.defiPlatformInfoList?.[0]?.serviceFeeInfo?.referralCommissionAddress,module:"market-quick-buy"});break;case"VERIFY_CALLDATA_FAILED":cn({...O.result,walletId:e.accountId,txHash:N.results.signedInfoList?.[0]?.txHash,orderId:l,requestCommissionAddress:e.quoteAndCalldataResult?.defiPlatformInfoList?.[0]?.serviceFeeInfo?.referralCommissionAddress,module:"market-quick-buy"});break;default:break}let ee={..._,isBatchBroadcast:T.length>1,isCombineApproveAndSwap:T.some(ae=>ae.type==="APPROVAL")&&T.some(ae=>ae.type==="SWAP"),approveTxInfo:S?{id:k?.getParsedData()?.id,unsignedTx:k?.getParsedData()?.unsignedTx}:void 0},te=ci({chainId:_.chainId,teeSilentSignEnabled:ee.teeSilentSignEnabled,broadcastProvider:I?.broadcastProvider,isCancelSimulate:!0,enableMev:x.enableMev}),Se=di({shouldClientBroadcast:!_.teeSilentSignEnabled,quoteData:ee,transactionData:I,signAndSendTransactionParams:x,signedResult:N.results});if(u)try{let ae=N.results?.signedInfoList?.[0]?.txHash||"";await u({broadcastParams:Se,txHash:ae})}catch(ae){return{success:!1,status:"error",error:ae}}g&&(g.updateMonitorData({txHash:N.results?.signedInfoList?.[0]?.txHash||"",isSimulate:!te,isEnableMev:x?.enableMev}),pa(g)),l&&Kt.setTimestamp(l);let ue=await this.broadcastWithV6({quoteData:ee,okxBroadcastParams:Se,thirdBroadcastParams:{shouldClientBroadcast:te,providers:I?.broadcastProvider||[],signedTx:N.results.signedInfoList.map(ae=>ae.signature)}});return l&&Kt.setAfterBroadcastTimestamp(l),ue.success?(g&&ma(g),{success:!0,txHash:ue.txHash,orderId:ue.orderId||l,titleKey:ue.titleKey}):{success:!1,status:"eoa_broadcast_error",error:ue.error}}async batchSignTransactionProcesses(e,t,r){try{return await t.batchSignAndAssign(e,r)}catch(n){return{success:!1,isUserRejection:pr(n),error:n}}}async broadcastWithV6(e){let{quoteData:t,okxBroadcastParams:r,thirdBroadcastParams:n}=e,[s,a]=await li({quoteData:t,okxBroadcastParams:r,thirdBroadcastParams:n});if(s)return{success:!1,error:s?.error_message};let l=a?.data;return{success:!0,titleKey:a?.clientBroadcastToastKey,txHash:l?.transactionHash,orderId:l?.orderId||l?.swapOrderId}}async prepareOrderForTrade(e){let t=fo(e);if(!t.valid)return{success:!1,status:"prepare_order_error",error:new Error(`MISSING_REQUIRED_PARAMS:${t.missingFields?.join(",")}`),errorInfo:{errorMessage:"missingRequiredParams"}};let r=await Fn({chainId:e.chainId,fromTokenAddress:e.fromTokenAddress,toTokenAddress:e.toTokenAddress,liquidityConfig:e.liquidityConfig,amount:e.amount,userWalletAddress:e.userWalletAddress,tradeMode:e.tradeMode,preSetConfig:e.presetConfig,slippageConfig:e.slippageConfig,networkFee:e.networkFee,ext:e.ext,toTokenSymbol:e.toTokenSymbol,direction:e.direction,accountInfo:e.accountInfo,orderSource:e.orderSource,solanaEncoding:e.solanaEncoding});if(!r.success){let l=r.error;return l?.isHighRiskToken?{success:!1,status:"prepare_order_high_risk_token",error:r.error,errorInfo:{tokenSymbol:l.tokenSymbol}}:{success:!1,status:"prepare_order_error",error:r.error,errorInfo:{errorMessage:l?.error_message}}}if(!r.result)return{success:!1,status:"prepare_order_error",error:new Error("NO_RESULT_DATA"),errorInfo:{errorMessage:"noResultData"}};let n=this.chainManager.getAdapter(e.chainId),s=To(r.result,n);if(s)return{success:!0,swapCalldata:s.swapCalldata,approveCalldata:s.approveCalldata,orderId:s.orderId,tokenApprovedInfo:s.tokenApprovalInfo,rawApiResponse:r.result};let a=go(r.result,{chainId:e.chainId,fromTokenAddress:e.fromTokenAddress,toTokenAddress:e.toTokenAddress});return a?{success:!0,swapCalldata:a.swapCalldata,approveCalldata:a.approveCalldata,orderId:a.orderId,tokenApprovedInfo:a.tokenApprovalInfo,rawApiResponse:r.result}:{success:!1,status:"prepare_order_error",error:new Error("PARSE_RESPONSE_FAILED"),errorInfo:{errorMessage:"parseResponseFailed"}}}async validateWalletAndChain(e,t,r){if(!t&&!y.isExtensionEnv)return await Ys(Number(e)),{status:"wallet_not_connected",success:!1};if(y.isExtensionEnv){if(!t)return y.global.startOnboarding?.(),{status:"extension_will_onboard",success:!1};if(!r)return{status:"no_user_wallet_address",success:!1};if(!await y.global.unlockWallet?.())return{status:"extension_wallet_not_unlocked",success:!1}}return await Zs({chain:Number(e)})?{status:"done",success:!0}:{status:"switch_network_error",success:!1}}},ho=ht;ho.instance=null;var zt=ho;i();c();i();c();var Fl=3e3,gi=3e4,Ti=150,Wl=10,Ul="INSTANT_TRADE",_r=class{constructor(){this.lruCache=new Map;this.hoverCache=null;this.hoverPromise=null;this.activeButtonId=void 0;this.hoverAbortController=null;this.debounceState=null;this.traceIdMap=new Map;this.loggerMap=new Map;this.precheckCache=new Map}async fetchCalldata(e,t={}){let{isHoverRequest:r=!1,buttonId:n}=t;return r?this.handleHoverRequest(e,t,n):this.handleClickRequest(e,t,n)}async handleClickRequest(e,t,r){if((!r||!this.loggerMap.has(r))&&this.createLogger(r),r){let n=this.getCachedResult(r);if(n)return{result:n.result,timestamp:n.timestamp,params:n.params,fromCache:!0,buttonId:r}}if(this.hoverCache&&!this.isExpired(this.hoverCache))return{result:this.hoverCache.result,timestamp:this.hoverCache.timestamp,params:this.hoverCache.params,fromCache:!0,buttonId:r};if(this.debounceState&&this.debounceState.buttonId===r)return this.flushDebounce(e,t);if(this.hoverPromise&&this.activeButtonId===r)try{return await this.hoverPromise}catch{this.hoverPromise=null}return this.cancelDebounce(),this.cancelHoverRequests(),this.createRequestPromise(e,{...t,isHoverRequest:!1,buttonId:r})}handleHoverRequest(e,t,r){return this.debounceState&&this.debounceState.buttonId!==r&&this.cancelDebounce(),this.activeButtonId!==r&&this.cancelHoverRequests(),this.activeButtonId=r,r&&this.createLogger(r),new Promise((n,s)=>{if(this.debounceState&&this.debounceState.buttonId===r){clearTimeout(this.debounceState.timer),this.debounceState.callbacks.push({resolve:n,reject:s});let l=setTimeout(()=>{this.executeDebounced().catch(()=>{})},Ti);this.debounceState.timer=l;return}let a=setTimeout(()=>{this.executeDebounced().catch(()=>{})},Ti);this.debounceState={timer:a,params:e,options:t,buttonId:r,callbacks:[{resolve:n,reject:s}]}})}async executeDebounced(){if(!this.debounceState)return;let{params:e,options:t,buttonId:r,callbacks:n}=this.debounceState;this.debounceState=null,this.activeButtonId=r;try{let s=this.createRequestPromise(e,{...t,buttonId:r});this.hoverPromise=s;let a=await s;n.forEach(l=>{l.resolve(a)})}catch(s){n.forEach(a=>{a.reject(s)})}finally{this.hoverPromise=null,this.hoverAbortController=null}}async flushDebounce(e,t){if(!this.debounceState)throw new Error("No debounce to flush");let{buttonId:r,callbacks:n}=this.debounceState;clearTimeout(this.debounceState.timer),this.debounceState=null,this.activeButtonId=r;try{let s=this.createRequestPromise(e,{...t,isHoverRequest:!1,showErrorTips:!0,buttonId:r});this.hoverPromise=s;let a=await s;return n.forEach(l=>{l.resolve(a)}),a}catch(s){throw n.forEach(a=>{a.reject(s)}),s}finally{this.hoverPromise=null,this.hoverAbortController=null}}createRequestPromise(e,t){return(async()=>{let{amount:r,toToken:n,accountId:s,userWalletAddress:a,isSilent:l,chainId:d,chainName:p,fromToken:f,presetConfig:m,tradeDirection:g,teeStatus:u,solanaEncoding:T,tradeMode:k=7,orderSource:S=Ul}=e,C=new AbortController;t.isHoverRequest&&(this.hoverAbortController=C);try{let _=zt.getInstance(),I=t.precheckResult;I||(I=await _.precheckApproval({chainId:d,tokenContractAddress:f.tokenContractAddress,isNativeToken:f.isNativeToken??!1,userWalletAddress:a,tradeAmount:r}));let x=t.buttonId?this.traceIdMap.get(t.buttonId):void 0,v=await _.prepareTrade({chainId:d,chainName:p,amount:r,fromToken:f,toToken:n,accountId:s,userWalletAddress:a,presetConfig:m.preSetConfig,slippageConfig:m.slippageConfig,networkFee:m.networkFee,liquidityConfig:{defiPlatformIds:cr,excludedDexIds:""},direction:g,accountInfo:{accountId:s,teeSilentSignEnabled:l,accountBizLine:2,teeId:u?.id},tradeMode:k,orderSource:S,precheckApprovalResult:I,solanaEncoding:T,ext:{referId:x}}),b=Date.now(),Q={result:v,timestamp:b,params:e,fromCache:!1,buttonId:t.buttonId};if(t.isHoverRequest){let z={result:v,timestamp:b,params:e};t.buttonId?this.setCachedResult(t.buttonId,z):this.hoverCache=z}return Q}catch(_){return this.reset(),{result:{success:!1,status:"prepare_order_error",error:_},timestamp:Date.now(),params:e,fromCache:!1,buttonId:t.buttonId}}finally{this.hoverPromise=null,this.hoverAbortController=null}})()}getTraceIdForMonitor(e){if(!e)throw new Error("buttonId is required for getTraceIdForMonitor");return this.traceIdMap.get(e)}getLogger(e){if(!e)throw new Error("buttonId is required for getLogger");return this.loggerMap.get(e)}createLogger(e){if(!e)throw new Error("buttonId is required for createLogger");let r=this.cacheIsNotExpired(e)||this.hasPendingHoverRequest()?this.traceIdMap.get(e):void 0,n=rn(r),s=n.uid;return this.traceIdMap.set(e,s),this.loggerMap.set(e,n),n}cancelHoverRequests(){this.hoverAbortController&&(this.hoverAbortController.abort(),this.hoverAbortController=null),this.hoverPromise=null,this.cancelDebounce()}cancelDebounce(){if(this.debounceState){clearTimeout(this.debounceState.timer);let{callbacks:e}=this.debounceState;this.debounceState=null;let t=new Error("Debounce cancelled");e.forEach(r=>{r.reject(t)})}}hasPendingHoverRequest(){return this.hoverPromise!==null||this.debounceState!==null}cacheIsNotExpired(e){if(e){let t=this.lruCache.get(e);return t!==void 0&&!this.isExpired(t)}return this.hoverCache!==null&&!this.isExpired(this.hoverCache)}forceClearHoverCache(e){e?this.lruCache.delete(e):this.hoverCache=null}prepareForClick(e){if(!e)throw new Error("buttonId is required for prepareForClick");let t=this.loggerMap.get(e),r=this.traceIdMap.get(e);return(!t||!r)&&(t=rn(),r=t.uid),this.lruCache.delete(e),this.traceIdMap.delete(e),this.loggerMap.delete(e),{traceId:r,logger:t}}async fetchPrecheckApproval(e,t){let{chainId:r,fromToken:n,userWalletAddress:s,amount:a}=e,l=t,d=zt.getInstance(),p=this.precheckCache.get(l);if(p){let g=Date.now()-p.timestamp>gi,u=p.chainId===r&&p.tokenContractAddress===n.tokenContractAddress&&p.userWalletAddress===s;if(!g&&u){let T=d.determineStrategy(r,n.tokenContractAddress,n.isNativeToken??!1,a,n.decimals,p.result.tokenApprovalInfo);return{precheckApprovalResult:p.result,strategy:T}}this.precheckCache.delete(l)}let f=await d.precheckApproval({chainId:r,tokenContractAddress:n.tokenContractAddress,isNativeToken:n.isNativeToken??!1,userWalletAddress:s,tradeAmount:a});this.precheckCache.set(l,{result:f,timestamp:Date.now(),chainId:r,tokenContractAddress:n.tokenContractAddress,userWalletAddress:s});let m=d.determineStrategy(r,n.tokenContractAddress,n.isNativeToken??!1,a,n.decimals,f.tokenApprovalInfo);return{precheckApprovalResult:f,strategy:m}}getCachedPrecheckResult(e){let t=this.precheckCache.get(e);return t?Date.now()-t.timestamp>gi?(this.precheckCache.delete(e),null):t.result:null}clearPrecheckCache(e){e?this.precheckCache.delete(e):this.precheckCache.clear()}reset(){this.cancelHoverRequests(),this.lruCache.clear(),this.hoverCache=null,this.precheckCache.clear(),this.activeButtonId=void 0}getCachedResult(e){let t=this.lruCache.get(e);return t?this.isExpired(t)?(this.lruCache.delete(e),null):(this.lruCache.delete(e),this.lruCache.set(e,t),t):null}setCachedResult(e,t){if(this.lruCache.has(e)&&this.lruCache.delete(e),this.lruCache.size>=Wl){let r=this.lruCache.keys().next().value;r&&this.lruCache.delete(r)}this.lruCache.set(e,t)}isExpired(e){return Date.now()-e.timestamp>Fl}};i();c();i();c();function Vl(o){return o?Array.isArray(o)?o:[o]:[]}function hi(o){let{payload:e,transactionHash:t}=o,r=e?.dexData;return r?!r.transactionHash||r.transactionHash!==t?{matched:!1}:r.type!=="approve"?{matched:!1}:r.status===Zo.CANCEL_APPROVE_SUCCESS?{matched:!0,status:"success"}:r.status===Zo.CANCEL_APPROVE_FAILED?{matched:!0,status:"failed"}:{matched:!1}:{matched:!1}}function _i(o){let{transactionHash:e,timeoutMs:t=6e4}=o;return new Promise((r,n)=>{let s=!1,a,l,d=()=>{l&&clearTimeout(l),l=void 0,a?.(),a=void 0},p=m=>{s||(s=!0,d(),r({transactionHash:e,payload:m}))},f=m=>{s||(s=!0,d(),n(m))};l=setTimeout(()=>{let m=new Error(`WAIT_FOR_TX_CONFIRMATION_TIMEOUT: ${e} (${t}ms)`);m.name="WaitForTxConfirmationTimeoutError",f(m)},t),a=Ht({isPri:!0,needLogin:!0,subscribeParams:[{channel:vt.DEX_PUSH_ENGINE}],onListenError:m=>{f(m)},onListenData:m=>{let u=Vl(m).find(S=>hi({payload:S,transactionHash:e}).matched);if(!u)return;let T=hi({payload:u,transactionHash:e});if(!T.matched)return;if(T.status==="success"){p(u);return}let k=new Error(`WAIT_FOR_TX_CONFIRMATION_FAILED: ${e}`);k.name="WaitForTxConfirmationFailedError",k.payload=u,f(k)}})})}i();c();ce();i();c();i();c();function Vn(o){let e=o.slippageConfig.slippageRange.find(n=>n.selected),t;o.feeConfig?.feeOptions&&(t=o.feeConfig?.feeOptions.find(n=>n.selected));let r={slippageType:o.slippageConfig.slippageType};return o.routeConfig&&(r.routerModeType=o.routeConfig.routerModeType),t&&(r.feeLevel=t?.feeLevel),o.slippageConfig.slippageType===2&&(r.slippageLevel=e?.slippageLevel,r.slippageValue=e.slippageValue),o.slippageConfig.slippageType===1&&o.slippageConfig.dynamicMaxSlippageValue&&(r.dynamicMaxSlippageValue=o.slippageConfig.dynamicMaxSlippageValue),t?.feeLevel===4&&(r.feeValue=t.feeValue),r}i();c();var Hn=class extends Vr{constructor(){super();this.fetchConfigStatus=ie.DEFAULT;this.fetchSaveStatus=ie.DEFAULT;this.fetchResetStatus=ie.DEFAULT;this.loadError=!1;this.cancelFetchPresetRef=null;this.multiChainPresetsList=[];this.multiChainPresetsMap=new Map;Ge(this,{loadError:L,cancelFetchPresetRef:L,fetchConfigStatus:L,fetchSaveStatus:L,fetchResetStatus:L,multiChainPresetsList:L,multiChainPresetsMap:L})}},j=new Hn;i();c();ce();i();c();ce();function ko(o){let e=Y(o,"feeConfig",{});if(qe(e))return{};let{min:t,max:r,feeOptions:n}=e,s=n?.find(p=>p.selected===!0),a=s?.feeValue,l=ra[s?.feeLevel-1],d={[rt.MARKET]:{amount:n?.[0]?.feeValue,price:""},[rt.FAST]:{amount:n?.[1]?.feeValue,price:""},[rt.TURBO]:{amount:n?.[2]?.feeValue,price:""}};return{value:a,type:l,level:s?.feeLevel,max:r,min:t,recommendMaxValue:r,recommendMinValue:t,config:d}}i();c();ce();var _t=o=>Ns(o,{needZero:!1});function So({presetWithDirection:o,dynamicSupportMax:e}){let t=Y(o,"slippageConfig",{})??{},{slippageType:r,slippageRange:n,fixedMin:s,fixedMax:a,fixedRecommendMax:l,fixedRecommendMin:d,dynamicMin:p,dynamicMax:f,dynamicRecommendMinValue:m,dynamicRecommendMaxValue:g,dynamicMaxSlippageValue:u}=t,T=n?.find(_=>_.selected===!0),k=T?.slippageValue,S=oa[T?.slippageLevel-1],C={[tt.LOW]:n?.[0]?.slippageValue,[tt.MEDIUM]:n?.[1]?.slippageValue,[tt.HIGH]:n?.[2]?.slippageValue};return{mode:r===1?xt.DYNAMIC:xt.FIXED,supportCustomMax:e,dynamicMax:f,dynamicMin:p,recommendMax:g,recommendMin:m,customMax:u,value:k,type:S,level:T?.slippageLevel,config:C,min:s,max:a,fixedRecommendMax:l,fixedRecommendMin:d}}var Si=({level:o,value:e,min:t,max:r,recommendMin:n,recommendMax:s,auto:a,safemoon:l})=>o!=="custom"?{type:null,text:null}:e?V.lt(e,t)?{type:"error",text:A("swaptrade_settings_errortip_minimum_slippage",{cross:_t(t)})}:l&&V.lt(e,a)?{type:"warning",text:A("swaptrade_cell_alert_token_includes_tax",{token:l,num:_t(a)})}:V.lt(e,a||n)?{type:"warning",text:A("swaptrade_modal_dialog_error_low_slippage",{num1:_t(a||n),num2:_t(s)})}:V.gt(e,r)?{type:"error",text:A("swaptrade_modal_dialog_error_neg_slippage",{num1:_t(t),num2:_t(r)})}:V.gt(e,s)?{type:"warning",text:A("swaptrade_modal_dialog_error_high_slippage",{num1:_t(a||n),num2:_t(s)})}:{type:null,text:null}:{type:"error",text:A("swaptrade_preset_input_desc_you_must_enter_a"),isBlur:!0};i();c();ce();var kr=o=>{let e=Y(o,"feeOptions")||[];if(!Array.isArray(e)||qe(e))return"";let t="",r=e.find(a=>a.selected),n=r?.feeLevel,s=r?.feeValue||"";switch(n){case 1:t=A("swaptrade_modal_dialog_option_market");break;case 2:t=A("swaptrade_modal_dialog_option_fast5x");break;case 3:t=A("swaptrade_modal_dialog_option_turbo10x");break;default:t=s;break}return t},Io=o=>{let{slippageType:e,slippageRange:t}=o||{},r=t?.find(s=>s.selected);return e===1?A("swaptrade_slippage_cell_label_dynamic"):r?.slippageValue||""},Sr=o=>{let e=Y(o,"routerModeType")||{};if(e===1)return{text:A("swaptrade_trade_select_item_auto"),icon:"okx-defi-web3-shield",status:"default",tips:A("swaptrade_trade_select_item_auto")};let t={[1]:1,[3]:7,[2]:4};return na(t[e])};var Co=class{constructor(e){this.presetsList=[];this.chainId=0;this.dynamicSupportMax=!1;this.gasPriceUnitDecimal="";this.memeChainType="";this.mevPriceThreshold="";this.nativeTokenInfo={};this.nativeTokenPrice="";this.networkFeeDecimals="";this.networkFeeUnit="";this.priceImpactValue=0;this.quickBuyDefaultBuyAmount="";this.quoteIntervalMs=3e3;this.subscribeProvider=[];this.supportAutoMode=!1;this.supportCustomGasFee=!1;this.supportEip1559=!1;this.supportLimitOrder=!1;this.supportSlippage=!1;this.quickBuyAmount="";this.getSelectPreset=({presetSelectType:e})=>{let t=this.presetsList.find(r=>r.presetType===e);return t||{}};this.getSelectPresetWithTradeMode=({presetSelectType:e,selectTradeMode:t})=>t==="buy"?Y(this.getSelectPreset({presetSelectType:e}),"buyPreset",{})??{}:Y(this.getSelectPreset({presetSelectType:e}),"sellPreset",{})??{};this.getSelectRouterModeType=({presetSelectType:e,selectTradeMode:t})=>{let r=this.getSelectPresetWithTradeMode({presetSelectType:e,selectTradeMode:t});return Y(r.routeConfig,"routerModeType",1)??1};this.getSelectPriorityMode=({presetSelectType:e,selectTradeMode:t})=>this.getSelectRouterModeType({presetSelectType:e,selectTradeMode:t})===1?"auto":"manual";this.getSelectManualType=({presetSelectType:e,selectTradeMode:t})=>this.getSelectRouterModeType({presetSelectType:e,selectTradeMode:t})===3?1:0;this.getSelectSlippageState=({presetSelectType:e,selectTradeMode:t})=>{let r=this.getSelectPresetWithTradeMode({presetSelectType:e,selectTradeMode:t});return So({presetWithDirection:r,dynamicSupportMax:this.dynamicSupportMax})};this.getSelectNoQuotePriorityFeeState=({presetSelectType:e,selectTradeMode:t})=>{let r=this.getSelectPresetWithTradeMode({presetSelectType:e,selectTradeMode:t});return ko(r)};this.getQuickBuyMevStatus=({presetSelectType:e,selectTradeMode:t})=>{let r=this.getSelectPresetWithTradeMode({presetSelectType:e,selectTradeMode:t})?.routeConfig;return Sr(r)};this.getQuickBuySlippage=({presetSelectType:e,selectTradeMode:t})=>{let r=this.getSelectPresetWithTradeMode({presetSelectType:e,selectTradeMode:t})?.slippageConfig;return Io(r)};this.getQuickBuyFee=({presetSelectType:e,selectTradeMode:t})=>{let r=this.getSelectPresetWithTradeMode({presetSelectType:e,selectTradeMode:t})?.feeConfig;return kr(r)};Ge(this,{chainId:L,dynamicSupportMax:L,gasPriceUnitDecimal:L,memeChainType:L,mevPriceThreshold:L,nativeTokenInfo:L,nativeTokenPrice:L,networkFeeDecimals:L,networkFeeUnit:L,priceImpactValue:L,quickBuyDefaultBuyAmount:L,quoteIntervalMs:L,subscribeProvider:L,supportAutoMode:L,supportCustomGasFee:L,supportEip1559:L,supportLimitOrder:L,presetsList:L,supportSlippage:L,quickBuyAmount:L,computedChainName:ft,computedChainSymbol:ft,computedChainLogoUrl:ft,computedSupportPriorityFee:ft});let{chainId:t,dexPresetResultVOList:r,dynamicSupportMax:n,gasPriceUnitDecimal:s,memeChainType:a,mevPriceThreshold:l,nativeTokenInfo:d,nativeTokenPrice:p,networkFeeDecimals:f,networkFeeUnit:m,priceImpactValue:g,quickBuyDefaultBuyAmount:u,quoteIntervalMs:T,subscribeProvider:k,supportAutoMode:S,supportCustomGasFee:C,supportEip1559:_,supportLimitOrder:I,supportSlippage:x}=e;this.presetsList=r,this.chainId=t,this.dynamicSupportMax=n,this.gasPriceUnitDecimal=s,this.memeChainType=a,this.mevPriceThreshold=l,this.nativeTokenInfo=d,this.nativeTokenPrice=p,this.networkFeeDecimals=f,this.networkFeeUnit=m,this.priceImpactValue=g,this.quickBuyDefaultBuyAmount=u,this.quoteIntervalMs=T,this.subscribeProvider=k,this.supportAutoMode=S,this.supportCustomGasFee=C,this.supportEip1559=_,this.supportLimitOrder=I,this.supportSlippage=x,this.quickBuyAmount=u}get computedChainName(){return this.nativeTokenInfo?.chainName||""}get computedChainSymbol(){return this.nativeTokenInfo?.tokenSymbol||""}get computedChainLogoUrl(){return this.nativeTokenInfo?.chainLogoUrl||""}get computedSupportPriorityFee(){return this.supportEip1559||this.memeChainType==="0"}};var Gn=class{constructor(){this.getCurrentChainPresetsList=e=>j.multiChainPresetsList.find(r=>String(r.chainId)===String(e))?.dexPresetResultVOList||[];this.getCurrentChainPresetsStore=e=>j.multiChainPresetsMap.get(String(e))||{};this.updateMultiChainPresets=e=>{if(!e||!Array.isArray(e))return;let t=j.multiChainPresetsList,r=new Map(t.map(a=>[a.chainId,a]));e.forEach(a=>r.set(a.chainId,a));let n=Array.from(r.values()),s=new Map;n.forEach(a=>{s.set(String(a.chainId),new Co(a))}),j.update({multiChainPresetsList:n,multiChainPresetsMap:s,fetchConfigStatus:ie.READY})};this.fetchPreset=async({chainId:e,accountId:t,userWalletAddress:r})=>{j.cancelFetchPresetRef&&j.cancelFetchPresetRef.abort();let n=y.createAbortController();j.update({cancelFetchPresetRef:n});let s={chainId:String(e)};r&&(s.walletAddress=r);let a=y.getOnt(),[l,d]=await Ne(a.get(Ps,{params:s,signal:j.cancelFetchPresetRef?.signal,isolate:!0}));if(l)return y.isCancel(l)||(j.update({fetchConfigStatus:ie.ERROR,loadError:!0}),J.info(xe.MARKET_SWAP_FETCH_CONFIG_ERROR,{data:{params:{chainId:e,accountId:t,userWalletAddress:r},type:"fetchPreset",error:l}})),!1;let{data:p}=d;return j.update({loadError:!1}),ir(()=>{this.updateMultiChainPresets([p])}),!0};this.fetchPresets=async({chainIds:e,accountId:t})=>{j.cancelFetchPresetRef&&j.cancelFetchPresetRef.abort(),j.update({cancelFetchPresetRef:y.createAbortController()});let[r,n]=await Ne(y.getOnt().get?.(bs,{params:{chainIds:e,accountId:t},signal:j.cancelFetchPresetRef?.signal,isolate:!0}));if(r)return y.isCancel(r)||j.update({fetchConfigStatus:ie.ERROR}),!1;let{data:s}=n;return ir(()=>{this.updateMultiChainPresets(s)}),!0};this.savePreset=async({presets:e,chainId:t,userWalletAddress:r,accountId:n,presetEditType:s})=>{if(sr(t)||sr(n)||sr(r)||qe(e))return re.error({title:A("swaptrade_preset_toast_header_unable_to_save_changes")}),!1;j.update({fetchSaveStatus:ie.LOADING});let a=e.map(({id:d,name:p,presetType:f,buyPreset:m,sellPreset:g})=>({id:d,name:p,presetType:f,buyPreset:Vn(m),sellPreset:Vn(g)})),[l]=await Ne(Yr.save({chainId:t,accountId:n,userWalletAddress:r,sceneType:0,presets:a}));return l?(j.update({fetchSaveStatus:ie.ERROR}),re.error({title:A("swaptrade_preset_toast_header_unable_to_save_changes")}),!1):(J.info(xe.PRESET_EDIT_SAVE,{data:{chainId:t,accountId:n,userWalletAddress:r,presets:a,selectType:s}}),await this.fetchPreset({chainId:t,accountId:n,userWalletAddress:r}),j.update({fetchSaveStatus:ie.READY}),{success:!0,type:s,userWalletAddress:r,chainId:t})};this.resetPreset=async({presetType:e,chainId:t})=>{if(sr(e))return re.error({title:A("swaptrade_preset_toast_header_unable_to_reset_this")}),!1;j.update({fetchResetStatus:ie.LOADING});let[r,n]=await Ne(Yr.reset({chainId:t,presetType:e}));if(r)return j.update({fetchResetStatus:ie.ERROR}),re.error({title:A("swaptrade_preset_toast_header_unable_to_reset_this")}),!1;let{dexPresetResultVOList:s}=n.data,a=s?.[0];return j.update({fetchResetStatus:ie.READY}),a};this.setQuickBuyPresetGuide=e=>{oe.set(Tn,e)};this.initQuickBuyPresetGuide=()=>{let e=oe.get(Tn);this.setQuickBuyPresetGuide(e??1)}}},fe=new Gn;i();c();var Kn=class extends Vr{constructor(){super();this.presetSelectType=1;this.chainId="";Ge(this,{presetSelectType:L,chainId:L})}},We=new Kn;var Lt=(o,e)=>{let t=M(U),{defaultEnabledSilentMethod:r,silentEnabled:n}=t,s=t.computedAccountId,a=t.computedTeeInfo,{fetchConfigStatus:l}=j,{presetSelectType:d}=We,p=(0,ze.useMemo)(()=>zt.getInstance(),[]),f=(0,ze.useMemo)(()=>new _r,[]),m=(0,ze.useCallback)((C,_,I)=>!_||V.lte(_,0)?{success:!1,status:"invalid_amount",tokenSymbol:C}:V.gt(_,I)?{success:!1,status:"insufficient_balance",tokenSymbol:C}:l===ie.ERROR?{success:!1,status:"preset_config_error",tokenSymbol:C}:{success:!0,status:"done",tokenSymbol:C},[l]),g=(0,ze.useCallback)(C=>{let _=fe.getCurrentChainPresetsStore(C),I=Jr[o],x=_?.getSelectNoQuotePriorityFeeState?.({presetSelectType:d,selectTradeMode:I}),v=_?.getSelectRouterModeType?.({presetSelectType:d,selectTradeMode:I}),b=_?.getSelectSlippageState?.({presetSelectType:d,selectTradeMode:I}),{type:Q,value:z}=x||{},{mode:N,value:O,customMax:ee}=b||{},te=Ia[Q],ue=Sa[N]===1?{slippageType:1,maxSlippage:ee}:{slippageType:2,slippage:O};return{preSetConfig:{routerModeType:v},slippageConfig:ue,networkFee:{priorityFeeType:te,priorityFee:te===4?z:null}}},[d,o]),u=(0,ze.useCallback)(C=>{if((Cs()?!0:gn.supportBs64Version)&&Tt(Number(C))&&n)return"base64"},[n]),T=(0,ze.useCallback)(async C=>{let{amount:_,fromToken:I,toToken:x,buttonUniqueId:v}=C,{chainId:b,chainName:Q}=I||{},{chainId:z,chainName:N}=x||{},O=b||z,ee=Q||N,te=t.getAddressByChainId(b);if(!s||!te||l===ie.ERROR)return;let{slippageConfig:Se,networkFee:ue,preSetConfig:ae}=g(O),It={chainId:`${O}`,chainName:ee,amount:_,fromToken:{tokenSymbol:I.tokenSymbol,tokenContractAddress:I.tokenContractAddress,decimals:I.decimals,isNativeToken:I.isNativeToken},toToken:{tokenSymbol:x.tokenSymbol,tokenContractAddress:x.tokenContractAddress,decimals:x.decimals,isNativeToken:x.isNativeToken},tradeDirection:o,presetConfig:{preSetConfig:ae,slippageType:null,slippageConfig:Se,networkFee:ue},userWalletAddress:te,isSilent:n,accountId:s,referId:f.getTraceIdForMonitor(v),teeStatus:a,solanaEncoding:u(O)},rr={chainId:`${O}`,fromToken:{tokenContractAddress:I.tokenContractAddress,isNativeToken:I.isNativeToken,decimals:I.decimals},userWalletAddress:te,amount:_};f.fetchPrecheckApproval(rr,v||"default").then(or=>f.fetchCalldata(It,{isHoverRequest:!0,showErrorTips:!1,buttonId:v,precheckResult:or.precheckApprovalResult})).catch(()=>{})},[t,s,l,g,u,o,n,f,a]),k=(0,ze.useCallback)(()=>{f.cancelHoverRequests()},[f]);return{onClickTrade:(0,ze.useCallback)(async C=>{let{amount:_,fromToken:I,toToken:x,buttonUniqueId:v}=C,{chainId:b,chainName:Q,tokenSymbol:z,balance:N}=I||{},{chainId:O,chainName:ee}=x||{},te=b||O,Se=Q||ee,ue=t.getAddressByChainId(b);if(y.isExtensionEnv&&!s){y.global.startOnboarding?.();return}let ae=m(z,_,N);if(!ae.success){ti(ae);return}let{slippageConfig:It,networkFee:rr,preSetConfig:or}=g(te),Fo={chainId:`${te}`,fromToken:{tokenContractAddress:I.tokenContractAddress,isNativeToken:I.isNativeToken,decimals:I.decimals},userWalletAddress:ue,amount:_},$e=await f.fetchPrecheckApproval(Fo,v||"default"),Wo=$e.strategy,Ct={chainId:`${te}`,chainName:Se,amount:_,fromToken:{tokenSymbol:I.tokenSymbol,tokenContractAddress:I.tokenContractAddress,decimals:I.decimals,isNativeToken:I.isNativeToken},toToken:{tokenSymbol:x.tokenSymbol,tokenContractAddress:x.tokenContractAddress,decimals:x.decimals,isNativeToken:x.isNativeToken},tradeDirection:o,presetConfig:{preSetConfig:or,slippageType:null,slippageConfig:It,networkFee:rr},userWalletAddress:ue,isSilent:n,accountId:s,teeStatus:a,solanaEncoding:u(te)},{traceId:nr,logger:be}=f.prepareForClick(v),br=()=>{be.updateMonitorData({chainId:`${te}`,chainName:Se,businessType:"instant_trade",signType:Vs({computedIsLimit:!1,computedIsBuy:!0,computedValidStrategies:[]}),orderType:"swap",okxWalletVersion:gn.currentWalletVersion}),la(be)};Wo!=="NEED_CANCEL_AND_APPROVE"&&br();let Bt={...Ct,referId:nr};try{let Xe=await f.fetchCalldata(Bt,{isHoverRequest:!1,waitForPending:!0,showErrorTips:!0,buttonId:v,precheckResult:$e.precheckApprovalResult}),He=Xe.result;if(Xe.fromCache&&f.forceClearHoverCache(v),!He.success||!He.tradeContext){vn(He,Se);return}let{strategy:xr}=He.tradeContext;if(xr==="NEED_CANCEL_AND_APPROVE"){let{chainId:At,userWalletAddress:yt,accountId:vr,fromToken:Uo}=He.tradeContext,Pt=await p.signAndBroadcastCancelApproval({chainId:At,userWalletAddress:yt,accountId:vr,fromTokenAddress:Uo.tokenContractAddress,signOptions:{isSilent:n}});if(ri({success:Pt.success,fromTokenSymbol:I.tokenSymbol,error:Pt.error}),!Pt.success)return;try{if(!Pt.txHash)throw new Error("CANCEL_TX_HASH_NOT_FOUND");await _i({transactionHash:Pt.txHash,timeoutMs:6e4})}catch(Ze){so({status:"error",success:!1,error:Ze});return}f.clearPrecheckCache(v),br();let Wt=(await f.fetchCalldata(Bt,{isHoverRequest:!1,waitForPending:!1,buttonId:v})).result;if(!Wt.success||!Wt.tradeContext){vn(Wt,Se);return}He=Wt}be&&(be.updateMonitorData({orderId:He.tradeContext?.orderId}),da(be));let Ft=await p.executeTrade({preparedTrade:He,silentEnabled:n,defaultEnabledSilentMethod:r,logger:be,...e&&{calldataParams:e}});so(Ft)}catch(Xe){so({status:"error",success:!1,error:Xe})}},[o,s,a,n,r,t,p,f,e,m,g,u]),onMouseEnter:T,onMouseLeave:k}};i();c();var bi=P(E());i();c();var Kl={0:"buy_order_qty_low_click",1:"buy_order_qty_mid_click",2:"buy_order_qty_high_click",3:"buy_order_qty_full_click"},Ql={0:"sell_order_qty_low_click",1:"sell_order_qty_mid_click",2:"sell_order_qty_high_click",3:"sell_order_qty_full_click"},zl={0:"buy_order_qty_low_hotkey",1:"buy_order_qty_mid_hotkey",2:"buy_order_qty_high_hotkey",3:"buy_order_qty_full_hotkey"},Yl={0:"sell_order_qty_low_hotkey",1:"sell_order_qty_mid_hotkey",2:"sell_order_qty_high_hotkey",3:"sell_order_qty_full_hotkey"},jl={0:"low",1:"mid",2:"high",3:"full"},Pi=()=>({business_type:"instant_trade",page_name:"instant_trade",orderSource:"instant_trade",terminal:y.isExtensionEnv?"extension":"web",popup_source:y.isExtensionEnv?y.global.domainName:"market_token_details"}),Ee=o=>{Bs({...Pi(),button_name:o})},it=({btnIndex:o,isHotkey:e,isBuy:t,toTokenSymbol:r,fromTokenSymbol:n})=>{let s=t?{hotkey:zl[o],normal:Kl[o]}:{hotkey:Yl[o],normal:Ql[o]};Ee(s[e?"hotkey":"normal"]);let a=t?{buy_qty:!0}:{sell_qty:!0};Ws({...Pi(),button_name:s[e?"hotkey":"normal"],instant_order_type:e?"hotkey":"click",instant_order_qty:jl[o],from_token_symbol:n,to_token_symbol:r,...a})};i();c();var xi=P(E());i();c();var Ao=P(E());i();c();ce();var Qn=class{constructor(){this.initSwapPresetSelectType=({data:e,userWalletAddress:t,chainId:r})=>{if(!e)return;let n=oe.get(jr),s=`${r}-${t}`,{presetSelectType:a}=n?.[s]||{presetSelectType:1};!e.some(d=>d.presetType===a)&&e.length>0&&(a=e[0].presetType),this.setPresetSelectType({userWalletAddress:t,chainId:r,type:a})};this.setPresetSelectType=({userWalletAddress:e,chainId:t,type:r,needCheckChainId:n=!1})=>{!t||!r||((!n||String(We.chainId)===String(t))&&We.update({presetSelectType:r,chainId:t}),e&&this.storageSelectType({userWalletAddress:e,type:r,chainId:t}))};this.getStoreageSelectType=()=>oe.get(jr);this.storageSelectType=({userWalletAddress:e,type:t,chainId:r})=>{let n=this.getStoreageSelectType(),s=Lr({},n,{[`${r}-${e}`]:{presetSelectType:t}});this.presetSelectTypeMap=s,oe.set(jr,s)};this.presetSelectTypeMap={};this.getPresetSelectTypeByChain=(e,t)=>this.presetSelectTypeMap?.[`${e}-${t}`]?.presetSelectType||1;Ge(this,{presetSelectTypeMap:L})}},Yt=new Qn;function vi({defaultChainId:o,shouldFetch:e}={shouldFetch:!0}){let t=M(U),r=M(H),{currentToken:n}=r,s=n?.chainId||o,{computedAccountId:a}=t,l=t.getAddressByChainId(s),d=r.ctxIsReady,p=(0,Ao.useCallback)(async()=>{if(e&&s&&d&&l&&await fe.fetchPreset({chainId:s,accountId:a||"",userWalletAddress:l})){let g=fe.getCurrentChainPresetsStore(s)?.presetsList||[];Yt.initSwapPresetSelectType({data:g,userWalletAddress:l||"",chainId:s})}},[a,l,s,d,e]);(0,Ao.useEffect)(()=>{p()},[p])}i();c();var Ir=P(E());var Ei=({calldataParams:o}={})=>{let e=M(H),t=R(q),r=Lt("0",o).onClickTrade,n=Lt("1",o).onClickTrade,{currentToken:s,buyModeConfigList:a,sellModeConfigList:l,buyWithToken:d,sellForToken:p}=e,{isSettingModalOpen:f,isEditModeActive:m,isPresetModalOpen:g,isShortcutActive:u,spacePressed:T}=t,k=_=>({amount:String(a[_].amount),fromToken:d,toToken:s,buttonUniqueId:a[_].buttonUniqueId}),S=_=>{let I=l[_].percent;return{amount:V.floorMul(I,s.amountNum,s.decimals),fromToken:s,toToken:p,buttonUniqueId:l[_].buttonUniqueId}},C=(0,Ir.useMemo)(()=>s&&!(f||m||g),[s,f,m,g]);(0,Ir.useEffect)(()=>{let _=x=>{if(!!C&&x.code===eo.SPACE){if(x.repeat)return;t.setSpacePressed(!0)}},I=x=>{if(!!C){if(t.isShortcutActive&&t.spacePressed&&x.code!==eo.SPACE){let b=[...mr,...fr].find(Q=>x.code===`Key${Q.key.toUpperCase()}`);if(b){let Q=mr.findIndex(N=>N.key===b.key),z=fr.findIndex(N=>N.key===b.key);if(Q>-1){let N=k(Q);it({btnIndex:Q,toTokenSymbol:N.toToken?.tokenSymbol,fromTokenSymbol:N.fromToken?.tokenSymbol,isHotkey:!0,isBuy:!0}),r(N)}else if(z>-1){let N=S(z);it({btnIndex:z,toTokenSymbol:N.toToken?.tokenSymbol,fromTokenSymbol:N.fromToken?.tokenSymbol,isHotkey:!0,isBuy:!1}),n(N)}}}x.code===eo.SPACE&&t.setSpacePressed(!1)}};return u?(document.addEventListener("keydown",_),document.addEventListener("keyup",I)):(document.removeEventListener("keydown",_),document.removeEventListener("keyup",I)),()=>{document.removeEventListener("keydown",_),document.removeEventListener("keyup",I)}},[u,r,n,C,t,a,l,d,s,p]),(0,Ir.useEffect)(()=>{let _=()=>{T&&t.setSpacePressed(!1)},I=()=>{document.hidden&&T&&t.setSpacePressed(!1)};return window.addEventListener("blur",_),document.addEventListener("visibilitychange",I),()=>{window.removeEventListener("blur",_),document.removeEventListener("visibilitychange",I)}},[T,t])};i();c();var Pe=P(E());i();c();var Ri=async o=>await y.getOnt()?.get?.("/priapi/v1/dx/trade/multi/tokenPair/feeRate",{params:o});var $l=o=>Object.fromEntries(Object.entries(o).map(([e,t])=>[e,typeof t=="number"?parseFloat(t.toFixed(5)):t])),Li=4,Mi=o=>{let e=M(H),[t,r]=(0,Pe.useState)(null),[n,s]=(0,Pe.useState)(!1),[a,l]=(0,Pe.useState)(null),{chainId:d}=o||{},{chainId:p}=Aa(),{currentToken:f,buyWithToken:m,sellForToken:g}=e,u=d||p||"",T=Un(),k=u?fi(u):"",S=(0,Pe.useRef)({chainId:"",currentTokenAddress:"",buyWithTokenAddress:"",sellForTokenAddress:"",evmWalletAddress:"",chainWalletAddress:""}),C=(0,Pe.useRef)(!1),_=(0,Pe.useMemo)(()=>({chainId:u,currentTokenAddress:f?.tokenContractAddress||"",buyWithTokenAddress:m?.tokenContractAddress||"",sellForTokenAddress:g?.tokenContractAddress||"",evmWalletAddress:T||"",chainWalletAddress:k||""}),[u,f?.tokenContractAddress,m?.tokenContractAddress,g?.tokenContractAddress,T,k]),I=(0,Pe.useMemo)(()=>{let v=S.current;return{chainId:v.chainId!==_.chainId,currentTokenAddress:v.currentTokenAddress!==_.currentTokenAddress,buyWithTokenAddress:v.buyWithTokenAddress!==_.buyWithTokenAddress,sellForTokenAddress:v.sellForTokenAddress!==_.sellForTokenAddress,evmWalletAddress:v.evmWalletAddress!==_.evmWalletAddress,chainWalletAddress:v.chainWalletAddress!==_.chainWalletAddress}},[_]),x=(0,Pe.useMemo)(()=>Object.values(I).some(Boolean),[I]);return(0,Pe.useEffect)(()=>!_.chainId||!_.currentTokenAddress||!x||C.current?void 0:((async()=>{try{C.current=!0,s(!0),l(null),S.current={..._};let b=[],{referInfo:Q}=await hr(_.evmWalletAddress,_.chainId),z=Q?.refCode||"";if(_.buyWithTokenAddress&&(I.chainId||I.currentTokenAddress||I.buyWithTokenAddress||I.chainWalletAddress)&&b.push({mode:"0",params:{chainId:_.chainId,fromTokenAddress:_.buyWithTokenAddress,toTokenAddress:_.currentTokenAddress,tradeMode:Li,refCode:z,userWalletAddress:_.chainWalletAddress}}),_.sellForTokenAddress&&(I.chainId||I.currentTokenAddress||I.sellForTokenAddress||I.chainWalletAddress)&&b.push({mode:"1",params:{chainId:_.chainId,fromTokenAddress:_.currentTokenAddress,toTokenAddress:_.sellForTokenAddress,tradeMode:Li,refCode:z,userWalletAddress:_.chainWalletAddress}}),b.length===0)return;let N=await Promise.allSettled(b.map(ee=>Ri(ee.params))),O={};if(N.forEach((ee,te)=>{if(ee.status==="fulfilled"){let Se=b[te].mode;O[Se]=$l(ee.value.data)}}),Object.keys(O).length>0){let te={...e.tokenPairFeeRate||{},...O};e.setTokenPairFeeRate(te),r(te)}}catch(b){l(b instanceof Error?b.message:"Unknown error")}finally{s(!1),C.current=!1}})().catch(b=>{l(b instanceof Error?b.message:"Unknown error"),C.current=!1}),()=>{C.current=!1}),[_,x,I,e]),{data:t,loading:n,error:a}};i();c();var Xl=P(E());i();c();var le=P(E());var Zl=(o={})=>{let{onPaste:e,targetElement:t,enabled:r=!0}=o,[n,s]=(0,le.useState)(""),[a,l]=(0,le.useState)(!1),d=(0,le.useRef)(null),p=(0,le.useRef)({text:"",timestamp:0}),f=(0,le.useCallback)(_=>{let I=Date.now(),x=p.current;x.text===_&&I-x.timestamp<100||(p.current={text:_,timestamp:I},s(_),e?.(_))},[e]),m=(0,le.useCallback)(async()=>{try{if(!navigator.clipboard||!navigator.clipboard.readText)return"";let _=await navigator.clipboard.readText();return f(_),Us({token_contract_address:_}),_}catch{return""}},[f]),g=(0,le.useCallback)(_=>{if(!r)return;let I=_.clipboardData?.getData("text/plain")||"";f(I)},[r,f]),u=(0,le.useCallback)(_=>{if(!r)return;(navigator.platform.toUpperCase().indexOf("MAC")>=0?_.metaKey:_.ctrlKey)&&_.key==="v"&&setTimeout(()=>{m()},10)},[r,m]),T=(0,le.useCallback)(()=>{if(!r)return;let _=t||d.current||document;_.addEventListener("paste",g),_.addEventListener("keydown",u),l(!0)},[r,t,g,u]),k=(0,le.useCallback)(()=>{let _=t||d.current||document;_.removeEventListener("paste",g),_.removeEventListener("keydown",u),l(!1)},[t,g,u]),S=(0,le.useCallback)(()=>m(),[m]),C=(0,le.useCallback)(()=>{s("")},[]);return(0,le.useEffect)(()=>(r?T():k(),()=>{k()}),[r,T,k]),{pastedText:n,isListening:a,startListening:T,stopListening:k,triggerPaste:S,clearPastedText:C,elementRef:d}},wi=Zl;i();c();ce();i();c();async function zn(o){let{chainId:e,tokenContractAddress:t,accountId:r,userUniqueId:n}=o;try{let[s,a]=await Promise.all([ve({url:Fr,params:{chainId:e,tokenContractAddress:t}}),ve({url:lr,params:{chainId:e,tokenContractAddress:t,accountId:r,userUniqueId:n,tradeType:1}})]),[l,d]=s,[p,f]=a;if(l||!d)throw console.error("Failed to fetch market order placer strategy:",l),new Error("Failed to fetch market order placer strategy");if(p||!f||f.length===0)throw console.error("Failed to fetch meme currency token list:",p),new Error("Failed to fetch meme currency token list");let m=f.map(S=>S.currencyTokenInfo),g=oo(d.tokenInfo,m),u=g?f.find(S=>S.currencyTokenInfo.chainId===g.chainId&&S.currencyTokenInfo.tokenContractAddress===g.tokenContractAddress):null,T=za(d.tokenInfo,d.defaultSellPercentList,g??null,u?.currencyDefaultBuyAmountList),k=bn(f,d.defaultSellPercentList);return g||console.warn("No matching currency token found for:",`${d.tokenInfo.chainId}/${d.tokenInfo.tokenContractAddress}`,"Proceeding with strategy token info only"),u||console.warn("Failed to find currency item with buy amount list, using defaults"),{tokenInfo:T,defaultSellPercentList:d.defaultSellPercentList,currencyDefaultBuyAmountList:u?.currencyDefaultBuyAmountList??[],tokenSelectionList:k}}catch{throw new Error("Failed to fetch instant trade token data")}}var yo=async(o,e)=>{let{chainId:t,tokenContractAddress:r,accountId:n,userUniqueId:s}=e;try{let a=await ve({url:lr,params:{chainId:t,tokenContractAddress:r,accountId:n,userUniqueId:s,tradeType:1}}),[l,d]=a;if(l||!d||d.length===0)throw new Error("Failed to fetch currency token list");return bn(d,o)}catch{throw new Error("Failed to fetch currency token list")}},Di=async o=>{let{chainId:e,tokenContractAddress:t}=o;try{let r=await ve({url:Br,params:{chainId:e,tokenContractAddress:t}}),[n,s]=r;if(n||!s)throw new Error("Failed to fetch token balance");return s}catch{throw new Error("Failed to fetch token balance")}},Yn=async o=>{let{chainId:e,tokenContractAddress:t,accountId:r,userUniqueId:n,userWalletAddress:s}=o;try{let a=await ve({url:Or,params:{chainId:e,tokenAddress:t,accountId:r,walletId:r,userUniqueId:n,userWalletAddress:s,businessType:"1"}}),[l,d]=a;return l||!d?(console.error("Failed to fetch token info with balance:",l),null):d}catch(a){return console.error("fetchTokenInfoWithBalance error:",a),null}};i();c();function Ni(o,e){!o?.chainId||!o?.tokenContractAddress||Gt({token:o,amountList:e,storageKey:ot})}function Oi(o,e){!o?.chainId||!o?.tokenContractAddress||Gt({token:o,amountList:e,storageKey:nt})}var ct="501",jn="11111111111111111111111111111111",G=class{constructor(e){this.isInitialized=!1;this.defaultToken=null;this.selectedToken=null;this.buyTokenIndex=0;this.sellTokenIndex=0;this.buyConfigStorage="";this.sellConfigStorage="";this.clearData=()=>{this.defaultToken=null,this.selectedToken=null,this.buyTokenIndex=0,this.sellTokenIndex=0};this.refreshForAccountChange=async()=>{try{let e=this.currentWalletStore.computedAccountId,t=this.currentWalletStore.userUniqueId;if(!e||!t){console.error("refreshForAccountChange: Account info not available");return}if(this.defaultToken?.tokenInfo){let r=this.defaultToken.tokenInfo,n=await yo(this.defaultToken.sellPercentList,{chainId:r.chainId,tokenContractAddress:r.tokenContractAddress,accountId:e,userUniqueId:t,tradeType:1});if(n){this.defaultToken.tokenSelectionList=n;let s=oo(r,n);s?.amountNum&&(this.defaultToken.tokenInfo=Fe({...r,amountNum:s.amountNum}))}}if(this.selectedToken?.tokenInfo){let r=this.selectedToken.tokenInfo,n=this.currentWalletStore.getAddressByChainId(r.chainId),[s,a]=await Promise.all([yo(this.selectedToken.sellPercentList,{chainId:r.chainId,tokenContractAddress:r.tokenContractAddress,accountId:e,userUniqueId:t,tradeType:1}),Yn({chainId:r.chainId,tokenContractAddress:r.tokenContractAddress,accountId:e,userUniqueId:t,userWalletAddress:n})]);s&&(this.selectedToken.tokenSelectionList=s),a?.amountNum&&(this.selectedToken.tokenInfo=Fe({...r,amountNum:a.amountNum}))}}catch(e){console.error("refreshForAccountChange error:",e)}};this.initBuyAndSellIndex=({tokenList:e})=>{if(!e.length)return;let t=hn({chainId:Number(ct),storageKey:"extensionMarketBuy"}),r=e.findIndex(a=>a.tokenContractAddress===t);r!==-1&&(this.buyTokenIndex=r);let n=hn({chainId:Number(ct),storageKey:"extensionMarketSell"}),s=e.findIndex(a=>a.tokenContractAddress===n);s!==-1&&(this.sellTokenIndex=s)};this.initializeInstantTrade=async()=>{try{let e=this.currentWalletStore.computedAccountId,t=this.currentWalletStore.userUniqueId;if(console.log("initializeInstantTrade: ",e,t),!e||!t)return console.error("Account info not available from currentWalletStore"),null;let r=await zn({chainId:ct,tokenContractAddress:jn,accountId:e,userUniqueId:t});return r?(this.initBuyAndSellIndex({tokenList:r.tokenSelectionList}),this.defaultToken={tokenInfo:Fe(r.tokenInfo),buyAmountList:r.currencyDefaultBuyAmountList,sellPercentList:r.defaultSellPercentList,tokenSelectionList:r.tokenSelectionList},this.isInitialized=!0,r):null}catch(e){return console.error("initializeInstantTrade error",e),null}};this.addSelectedToken=async(e,t)=>{try{let r=this.currentWalletStore.computedAccountId,n=this.currentWalletStore.userUniqueId;if(!r||!n)return console.error("Account info not available from currentWalletStore"),null;st(this.buyWithToken,{tokenContractAddress:e,chainId:t})&&(this.buyTokenIndex=0),st(this.sellForToken,{tokenContractAddress:e,chainId:t})&&(this.sellTokenIndex=0);let s=this.currentWalletStore.getAddressByChainId(t),[a,l,d]=await Promise.all([zn({chainId:t,tokenContractAddress:e,accountId:r,userUniqueId:n}),Di({chainId:t,tokenContractAddress:e}),Yn({chainId:t,tokenContractAddress:e,accountId:r,userUniqueId:n,userWalletAddress:s})]);if(!a||!a.tokenInfo?.tokenContractAddress)return console.error("Failed to fetch token data for CA:",e),null;let p=ja(a.tokenInfo,l);return d?.amountNum&&(p={...p,amountNum:d.amountNum}),this.selectedToken={tokenInfo:Fe(p),buyAmountList:a.currencyDefaultBuyAmountList,sellPercentList:a.defaultSellPercentList,tokenSelectionList:a.tokenSelectionList},a}catch(r){return console.error("addSelectedToken error",r),null}};this.removeSelectedToken=()=>{this.selectedToken=null};this.setBuyTokenIndex=e=>{let t=this.tokenSelectionList;if(!t||t.length===0){console.warn("Cannot set buy token index: token selection list is empty");return}if(e<0||e>=t.length){console.warn(`Buy token index ${e} is out of bounds (0-${t.length-1})`);return}this.buyTokenIndex=e};this.setSellTokenIndex=e=>{let t=this.tokenSelectionList;if(!t||t.length===0){console.warn("Cannot set sell token index: token selection list is empty");return}if(e<0||e>=t.length){console.warn(`Sell token index ${e} is out of bounds (0-${t.length-1})`);return}this.sellTokenIndex=e};this.updateTokenBalance=e=>{if(!e?.chainId||!e?.tokenContractAddress)return;let t=String(e.amountNum);if(this.selectedToken?.tokenSelectionList){let r=this.selectedToken.tokenSelectionList.findIndex(n=>st(n,e));if(r!==-1){let s={...this.selectedToken.tokenSelectionList[r],amountNum:t};this.selectedToken.tokenSelectionList[r]=Fe(s)}}if(this.defaultToken?.tokenSelectionList){let r=this.defaultToken.tokenSelectionList.findIndex(n=>st(n,e));if(r!==-1){let s={...this.defaultToken.tokenSelectionList[r],amountNum:t};this.defaultToken.tokenSelectionList[r]=Fe(s)}}if(this.selectedToken?.tokenInfo&&st(this.selectedToken.tokenInfo,e)){let r={...this.selectedToken.tokenInfo,amountNum:t};this.selectedToken.tokenInfo=Fe(r)}if(this.defaultToken?.tokenInfo&&st(this.defaultToken.tokenInfo,e)){let r={...this.defaultToken.tokenInfo,amountNum:t};this.defaultToken.tokenInfo=Fe(r)}};this.updateTokenSelectionList=async()=>{let e=this.selectedToken?this.selectedToken?.tokenInfo:this.defaultToken?.tokenInfo;if(!e){console.error("Cannot update token selection list: no token data available");return}let t=await yo(e.defaultSellPercentList,{chainId:e.chainId,tokenContractAddress:e.tokenContractAddress,accountId:this.currentWalletStore.computedAccountId,userUniqueId:this.currentWalletStore.userUniqueId,tradeType:1});if(!t){console.error("Cannot update token selection list: no token selection list available");return}this.selectedToken?this.selectedToken.tokenSelectionList=t:this.defaultToken.tokenSelectionList=t};this.getTokenFromSelectionList=e=>{let t=this.tokenSelectionList;return!t||t.length===0?null:t[e]};this.storeContext=e,gt(this,{storeContext:!1,currentWalletStore:!1}),this.buyConfigStorage=oe.get(ot),this.sellConfigStorage=oe.get(nt),window.addEventListener("storage",_e(t=>{if(t.key===`ok_${Is}`){let r=JSON.parse(t.newValue);this.buyConfigStorage=Y(r,ot,""),this.sellConfigStorage=Y(r,nt,"")}})),hs(()=>({accountId:this.currentWalletStore.computedAccountId,userUniqueId:this.currentWalletStore.userUniqueId}),({accountId:t,userUniqueId:r})=>{t&&r&&(this.defaultToken||this.selectedToken)&&this.refreshForAccountChange().catch(()=>{})},{fireImmediately:!1,equals:(t,r)=>t.accountId===r.accountId&&t.userUniqueId===r.userUniqueId})}get currentWalletStore(){let e=this.storeContext.getStore(U);if(!e)throw new Error("CurrentWalletStore not found in context. Make sure LayeredStoreProvider is configured correctly.");return e}getTokenBuyConfigStorage({chainId:e,tokenContractAddress:t}){return Y(this.buyConfigStorage,`${e}.${t}`,[])}getTokenSellConfigStorage({chainId:e,tokenContractAddress:t}){return Y(this.sellConfigStorage,`${e}.${t}`,[])}reloadConfigsFromStorage(){this.buyConfigStorage=oe.get(ot),this.sellConfigStorage=oe.get(nt)}saveEditModeConfigs(e,t,r){let n=e.map(a=>String(a)),s=t.map(a=>String(a));Ni(this.buyWithToken,n),Oi(this.sellForToken,s),this.reloadConfigsFromStorage(),r&&r()}get buyWithToken(){let e=this.getTokenFromSelectionList(this.buyTokenIndex);return e?Fe(e):null}get sellForToken(){let e=this.getTokenFromSelectionList(this.sellTokenIndex);return e?Fe(e):null}get buyButtonList(){let e=this.buyWithToken||this.defaultToken?.tokenInfo,t=this.getTokenBuyConfigStorage({chainId:e?.chainId,tokenContractAddress:Ko(e?.tokenContractAddress)}),r=e?.currencyDefaultBuyAmountList,n=this.defaultToken?.buyAmountList;return Go({},t?.length>0?{list:t}:null,r?.length>0?{list:r}:null,n?.length>0?{list:n}:null,{list:[]}).list.map((a,l)=>({amount:Number(a),buttonUniqueId:`buy_${l}`}))}get sellButtonList(){let e=this.sellForToken||this.defaultToken?.tokenInfo,t=this.getTokenSellConfigStorage({chainId:e?.chainId,tokenContractAddress:Ko(e?.tokenContractAddress)}),r=this.sellForToken?.defaultSellPercentList,n=this.defaultToken?.sellPercentList;return Go({},t?.length>0?{list:t}:null,r?.length>0?{list:r}:null,n?.length>0?{list:n}:null,{list:[]}).list.map((a,l)=>({percent:Number(a),buttonUniqueId:`sell_${l}`}))}get tokenSelectionList(){let e=this.selectedToken?.tokenSelectionList||this.defaultToken?.tokenSelectionList||[];return this.selectedToken?.tokenInfo?e.filter(t=>!st(t,this.selectedToken.tokenInfo)):e}};G.serviceId="extensionInstantTrade",G.serviceName="ExtensionInstantTradeService";var Bi=o=>new G(o);i();c();var Ar=P(E()),Wi=P(me());i();c();var Po=P(E()),Fi=P(me());i();c();var Cr={content:"_content_1imqe_1","from-onboarding":"_from-onboarding_1imqe_10",fromOnboarding:"_from-onboarding_1imqe_10",link:"_link_1imqe_14","boost-text":"_boost-text_1imqe_19",boostText:"_boost-text_1imqe_19"};var ed=({fromOnboarding:o,onClick:e})=>Po.default.createElement("div",{className:(0,Fi.default)(Cr.content,{[Cr.fromOnboarding]:!!o})},Ke("swaptrade_function_emptystate_get_boost",{get:Po.default.createElement("span",{className:Cr.link,onClick:e},Ke("swaptrade_function_emptystate_text_boost_points",{boost:Po.default.createElement("span",{className:Cr.boostText},A("swaptrade_function_emptystate_text_boost"))}))})),bo=ed;i();c();var xo={"boost-info":"_boost-info_1w65k_1",boostInfo:"_boost-info_1w65k_1",close:"_close_1w65k_8"};var td=({fromOnboarding:o,onClick:e,onClose:t})=>Ar.default.createElement("div",{className:(0,Wi.default)(xo.boostInfo,{[xo.fromOnboarding]:o})},Ar.default.createElement(bo,{onClick:e}),Ar.default.createElement("div",{className:xo.close,onClick:t},Ar.default.createElement(B,{className:"okds-close",fontSize:"16px"}))),Ui=td;i();c();var Le=P(E()),$n=P(me());i();c();var Re={"boost-onboarding":"_boost-onboarding_jxvm5_1",boostOnboarding:"_boost-onboarding_jxvm5_1","top-bar":"_top-bar_jxvm5_11",topBar:"_top-bar_jxvm5_11","close-icon":"_close-icon_jxvm5_21",closeIcon:"_close-icon_jxvm5_21","drag-icon":"_drag-icon_jxvm5_31",dragIcon:"_drag-icon_jxvm5_31","extension-logo":"_extension-logo_jxvm5_42",extensionLogo:"_extension-logo_jxvm5_42","content-wrapper":"_content-wrapper_jxvm5_46",contentWrapper:"_content-wrapper_jxvm5_46",content:"_content_jxvm5_46","main-image":"_main-image_jxvm5_63",mainImage:"_main-image_jxvm5_63",button:"_button_jxvm5_67"};i();c();var ge=P(E());var rd=()=>ge.default.createElement("svg",{className:Re.mainImage,width:"96",height:"96",viewBox:"0 0 96 96",fill:"none",xmlns:"https://www.w3.org/2000/svg"},ge.default.createElement("path",{d:"M85.5544 43.3911L66.8049 43.3911",stroke:"white",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M53.751 23.559C51.2839 17.0492 45.6508 12.5 39.0964 12.5C31.3017 12.5 24.8101 18.9336 23.3965 27.4473",stroke:"#BCFF2F",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M57.2149 54.9486C59.9326 51.5011 61.5879 46.9279 61.5879 41.9101C61.5879 31.1758 54.0121 22.4719 44.6668 22.4694C44.5557 22.4694 44.4448 22.4706 44.3342 22.473L44.3342 22.4676L49.808 22.4674C59.1533 22.4699 66.7291 31.1738 66.7291 41.9082C66.7291 48.9357 63.482 55.0913 58.6171 58.5039L57.2149 54.9486Z",fill:"#BCFF2F",stroke:"#BCFF2F",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M57.1809 54.8507C59.843 51.4146 61.4612 46.8805 61.4612 41.9101C61.4612 31.1757 53.9137 22.4718 44.6034 22.4693C39.243 22.4679 33.7663 25.2924 30.6658 29.9385",stroke:"#BCFF2F",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M34.101 12.5C25.2725 12.5 18.1155 20.7536 18.1155 30.935C18.1155 31.1064 18.1175 31.2773 18.1215 31.4476C19.0922 29.433 21.0073 27.8948 23.383 27.5299C24.7387 19.1581 31.0008 12.7777 38.597 12.5088V12.5H34.101Z",fill:"#BCFF2F",stroke:"#BCFF2F",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M7.5 83.4996H84.6803",stroke:"white",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M81.5582 43.3911L77.3254 43.3911C75.9867 43.3911 74.81 44.278 74.4414 45.5649L65.5726 76.5243",stroke:"white",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M18.1155 38.4086L11.3122 38.4086C9.95087 38.4086 9.01352 39.7748 9.50342 41.0449L24.398 79.6592C25.2906 81.9735 27.5154 83.4999 29.9959 83.4999L67.8314 83.4999",stroke:"white",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M34.87 38.4086L48.7337 38.4086C49.9728 38.4086 51.0844 39.1703 51.5316 40.3259L65.3307 75.9852C66.0955 77.9616 67.9967 79.2645 70.116 79.2645C72.4196 79.2645 74.4409 77.7292 75.0589 75.5101L83.6051 44.8243C83.841 43.9771 84.6127 43.391 85.4921 43.391C87.0205 43.391 88.1424 44.8267 87.773 46.3098L80.0202 77.4334C79.1323 80.9979 75.9309 83.4997 72.2574 83.4997H68.2485",stroke:"white",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M69.1958 83.4999H67.091C64.6224 83.4999 62.4057 81.9879 61.5048 79.6895L46.5153 41.447C45.943 39.9869 47.0196 38.4086 48.5879 38.4086",stroke:"white",strokeWidth:"0.75",strokeLinecap:"round"}),ge.default.createElement("path",{d:"M23.7895 48.3735H36.9087C37.6006 48.3735 38.0834 47.6878 37.8501 47.0364L32.972 33.4132C31.6906 29.8349 28.2741 27.4473 24.4733 27.4473C19.5282 27.4473 16.1007 32.4357 17.9264 37.0315L21.9307 47.1119C22.2333 47.8735 22.9699 48.3735 23.7895 48.3735Z",stroke:"white",strokeWidth:"0.75"}),ge.default.createElement("ellipse",{cx:"25.6087",cy:"35.9174",rx:"3.49684",ry:"3.4877",stroke:"white",strokeWidth:"0.75"}),ge.default.createElement("path",{d:"M76.0631 12.5L76.063 12.6054M82.0577 18.4789L81.9365 18.479M76.0631 24.4578L76.063 24.3524M70.0685 18.4789L70.1896 18.4788M70.1896 18.4788C73.4324 18.4765 76.0607 15.8483 76.063 12.6054M70.1896 18.4788C73.4324 18.4811 76.0607 21.1095 76.063 24.3524M76.063 12.6054C76.0653 15.8483 78.6937 18.4767 81.9365 18.479M76.063 24.3524C76.0653 21.1095 78.6937 18.4813 81.9365 18.479",stroke:"white",strokeWidth:"0.75",strokeLinejoin:"round"}),ge.default.createElement("ellipse",{cx:"11.6213",cy:"75.7769",rx:"2.49775",ry:"2.49121",stroke:"white",strokeWidth:"0.75"})),Vi=rd;var od=({onClose:o})=>{let e=R(q),t=`https://${y.global?.getStaticHostname?.()}/cdn/assets/imgs/254/43DEFFE88CCA0D7C.png`;return Le.default.createElement("div",{className:Re.boostOnboarding},Le.default.createElement(B,{className:(0,$n.default)(Re.dragIcon,"okx-defi-dex-drag")}),Le.default.createElement("div",{className:Re.topBar},Le.default.createElement(De,{src:t,pictureClassName:Re.extensionLogo,width:16,height:16}),Le.default.createElement(B,{className:(0,$n.default)(Re.closeIcon,"okx-defi-collapse"),onClick:r=>{r?.detail!==0&&o&&o()},a11yText:"Close"})),Le.default.createElement("div",{className:Re.contentWrapper},Le.default.createElement("div",{className:Re.content},Le.default.createElement("div",{className:Re.image},Le.default.createElement(Vi,null)),Le.default.createElement(bo,{fromOnboarding:!0,onClick:()=>{}})),Le.default.createElement(ar,{className:Re.button,category:ar.CATEGORY.outline,type:ar.TYPE.primary,size:ar.SIZE.md,onClick:()=>{e.setBoostOnboardingShown(!0)}},A("swaptrade_function_emptystate_btn_start"))))},Hi=D(od);i();c();var jt=P(E());i();c();var Te=P(E()),Yi=P(Sl());i();c();var Ue=P(E());ce();i();c();var{DEX_MARKET_CHANNEL:nd,DEX_MARKET_TX_CHANNEL:qi}=Qr,sd=o=>o?o==="1"?qi:nd:qi,Gi=o=>Array.isArray(o)?o.map(e=>({channel:sd(e?.isTxPrice),chainId:String(e?.chainId),tokenAddress:e?.tokenContractAddress||e?.tokenAddress})):[];i();c();var lt=class{constructor(){this.marketLatestInfo=null;gt(this)}setMarketLatestInfo(e){this.marketLatestInfo=e}get computedMarketLatestInfo(){return{...this.marketLatestInfo,formattedMarketCap:y.currencyConversionWithSymbol(this.marketLatestInfo?.marketCap)}}};lt.storeId="webSocket",lt.storeName="WebSocketStore";var Ki=()=>new lt;var Xn=async({chainId:o,tokenContractAddress:e})=>{let[t,r]=await ve({url:Br,params:{chainId:o,tokenContractAddress:e}});return!t&&r?r:null},ad=({tokenContractAddress:o,chainId:e})=>Boolean(o&&Os(e)),Qi=({chainId:o,tokenContractAddress:e,onSocketError:t})=>{let r=M(H),n=M(lt),{ctxIsReady:s}=r,[a,l]=(0,Ue.useState)(null),d=(0,Ue.useRef)(t),p=(0,Ue.useRef)(n);(0,Ue.useEffect)(()=>{d.current=t,p.current=n});let f=(0,Ue.useCallback)(m=>{!m||n.setMarketLatestInfo(m)},[n]);return(0,Ue.useEffect)(()=>{let m=!0;return(async()=>{if(!ad({tokenContractAddress:e,chainId:o})||!s)return;let u=await Xn({chainId:o,tokenContractAddress:e});m&&u&&(l(u),p.current.setMarketLatestInfo(u))})(),()=>{m=!1}},[o,e,s]),(0,Ue.useEffect)(()=>{let m;if(a&&e&&s){let{isTxPrice:g}=a;m=Ht({isPri:!1,needLogin:!1,subscribeParams:Gi([{chainId:o,tokenContractAddress:e,isTxPrice:g}]),onListenData:(u,T)=>{if(T?.channel===Qr.DEX_MARKET_CHANNEL)f(u?.[0]);else{let k=u?.find?.(S=>qo(S.chainId)===qo(o)&&S.tokenContractAddress===e);k&&f(k)}},onListenError:()=>{d.current?.(),Xn({chainId:o,tokenContractAddress:e}).then(u=>{u&&p.current.setMarketLatestInfo(u)}).catch(()=>{})},onListenReconnected:()=>{d.current?.(),Xn({chainId:o,tokenContractAddress:e}).then(u=>{u&&p.current.setMarketLatestInfo(u)}).catch(()=>{})}})}return()=>{m?.()}},[o,e,s,a,f]),{latestInfo:a}};i();c();var vo=P(E());var id=()=>{let o=M(U),e=M(H),t=R(ne),{currentToken:r}=e,{userUniqueId:n,computedAccountId:s}=o,a=(0,vo.useCallback)(async()=>{if(!r)return;let d=(await t.updateTokenList({params:{chainId:r.chainId,userUniqueId:n,accountId:s,tokenContractAddress:r.tokenContractAddress},currentToken:r,needLoading:!0}))[0];d&&(e.setBuyWithToken(d),e.setSellForToken(d)),t.updateBuyModeConfigListByToken(d),t.updateSellModeConfigListByToken(r)},[s,r,n,t,e]);(0,vo.useEffect)(()=>{a()},[r?.tokenContractAddress])},zi=id;i();c();var Ve={"token-info-container":"_token-info-container_crlsd_1",tokenInfoContainer:"_token-info-container_crlsd_1","close-btn":"_close-btn_crlsd_9",closeBtn:"_close-btn_crlsd_9","token-info":"_token-info_crlsd_1",tokenInfo:"_token-info_crlsd_1",left:"_left_crlsd_27",right:"_right_crlsd_31","token-logo":"_token-logo_crlsd_35",tokenLogo:"_token-logo_crlsd_35","token-contract-address":"_token-contract-address_crlsd_39",tokenContractAddress:"_token-contract-address_crlsd_39","copy-icon":"_copy-icon_crlsd_43",copyIcon:"_copy-icon_crlsd_43","copy-group":"_copy-group_crlsd_47",copyGroup:"_copy-group_crlsd_47","top-token":"_top-token_crlsd_59",topToken:"_top-token_crlsd_59","top-right-title":"_top-right-title_crlsd_65",topRightTitle:"_top-right-title_crlsd_65","top-right-logo":"_top-right-logo_crlsd_70",topRightLogo:"_top-right-logo_crlsd_70","config-list":"_config-list_crlsd_73",configList:"_config-list_crlsd_73"};var cd=({onDiscardToken:o})=>{let e=R(G),t=M(lt),r="501",{selectedToken:n}=e,{computedMarketLatestInfo:s}=t;Qi({chainId:r,tokenContractAddress:n?.tokenInfo.tokenContractAddress,onSocketError:()=>{}}),zi();let a=(0,Te.useCallback)(l=>{let d=l.tokenAddress;l.isNativeToken&&(d=jn);let p=String(l.coinAmountOriginalDec||l.amountNum||"0");e.updateTokenBalance({chainId:l.chainId,tokenContractAddress:d,amountNum:p})},[e]);return oi({chainId:r,tokenContractAddress:n?.tokenInfo.tokenContractAddress,onWalletAssetAmountChange:a}),Mi({chainId:r,tokenContractAddress:n?.tokenInfo.tokenContractAddress}),Te.default.createElement("div",{className:Ve.tokenInfoContainer},Te.default.createElement("div",{className:Ve.tokenInfo},Te.default.createElement("div",{className:Ve.left},Te.default.createElement(De,{src:n?.tokenInfo.tokenLogoUrl,width:16,height:16,className:Ve.tokenLogo}),Te.default.createElement("span",{className:Ve.tokenSymbol},n?.tokenInfo.tokenSymbol),Te.default.createElement(bt,{title:n?.tokenInfo.tokenContractAddress,width:200},Te.default.createElement(Yi.CopyToClipboard,{text:n?.tokenInfo.tokenContractAddress,onCopy:()=>{re.success(A("swaptrade_common_address_copied_toast"))}},Te.default.createElement("span",{className:Ve.copyGroup},Te.default.createElement("span",{className:Ve.tokenContractAddress},qt(n?.tokenInfo.tokenContractAddress,6,4)),Te.default.createElement(B,{className:Ve.copyIcon,fontSize:"16px",iconName:"okx-defi-dex-copy1",a11yText:"Copy"}))))),n?.tokenInfo.marketCap&&Te.default.createElement("div",{className:Ve.right},s?.formattedMarketCap)),Te.default.createElement("div",{className:Ve.closeBtn},Te.default.createElement(B,{fontSize:"16px",iconName:"okds-clear-fill",onClick:o,a11yText:"Clear"})))},ji=D(cd);i();c();var Eo={container:"_container_3pqe1_1",input:"_input_3pqe1_4","input-inner":"_input-inner_3pqe1_4",inputInner:"_input-inner_3pqe1_4"};var ld=({validationState:o,contractAddress:e,onClearAddress:t,onFocus:r,onBlur:n})=>{let s=R(G),{selectedToken:a}=s;if(o==="valid"&&!!a)return jt.default.createElement(ji,{onDiscardToken:t});let l=o==="validating",d=o==="invalid",p=()=>l?jt.default.createElement(Qo.Circle,{size:Qo.SIZE.sm}):null,f=()=>e&&!l?jt.default.createElement(B,{fontSize:"16px",iconName:"okds-clear-fill",onClick:t,style:{cursor:"pointer"},a11yText:"Clear"}):null,m=()=>l?"":A("swaptrade_function_input_placeholder_paste_ca"),g=()=>l?"":e;return jt.default.createElement("div",{className:Eo.container},jt.default.createElement(Ut,{onFocus:r,onBlur:n,prefix:p(),value:g(),suffix:f(),size:Ut.SIZE.sm,placeholder:m(),forceError:d,className:Eo.input,innerClassName:Eo.inputInner,readOnly:!0}))},$i=D(ld);i();c();var Zn=P(E());i();c();var yr=P(E());i();c();var ut=P(E()),nc=P(me());i();c();var $t=P(E());ce();var Xi=(o,e,t)=>{let r=R(G),{buyButtonList:n,buyWithToken:s,selectedToken:a,defaultToken:l}=r,d=a?.tokenInfo||l?.tokenInfo,p=Y(s,"decimals",0),f=(0,$t.useCallback)(u=>{it({btnIndex:u.index,fromTokenSymbol:s?.tokenSymbol,toTokenSymbol:d?.tokenSymbol,isHotkey:!1,isBuy:!0}),o({amount:u.value,fromToken:s,toToken:d,buttonUniqueId:u.buttonUniqueId})},[o,s,d]),m=(0,$t.useCallback)(u=>{e({amount:u.value,fromToken:s,toToken:d,buttonUniqueId:u.buttonUniqueId})},[s,d,e]),g=(0,$t.useCallback)(u=>{t(u.buttonUniqueId)},[t]);return(0,$t.useMemo)(()=>n?.length?n.map((u,T)=>({label:Ie(u.amount,{sigFigs:p||0}),value:u.amount,precision:p,type:"select",index:T,key:`buy_select_${T+1}`,onClick:f,buttonUniqueId:u.buttonUniqueId,onMouseEnter:m,onMouseLeave:g})):null,[p,n,f])};i();c();var ke=P(E()),Ro=P(me());i();c();var dd=P(E());var Zi=()=>{let{accountStore:o,commonStore:e}=fa(),{walletSupportMev:t}=o;return{supportMev:e?.computedIsWalletEnv||t}};i();c();i();c();var dt={"keep-ltr":"_keep-ltr_1kmeq_1",keepLtr:"_keep-ltr_1kmeq_1","keep-rtl":"_keep-rtl_1kmeq_5",keepRtl:"_keep-rtl_1kmeq_5","preset-config-info-wrapper":"_preset-config-info-wrapper_1kmeq_9",presetConfigInfoWrapper:"_preset-config-info-wrapper_1kmeq_9","preset-config-info":"_preset-config-info_1kmeq_9",presetConfigInfo:"_preset-config-info_1kmeq_9","preset-icon":"_preset-icon_1kmeq_21",presetIcon:"_preset-icon_1kmeq_21",divide:"_divide_1kmeq_26","go-icon":"_go-icon_1kmeq_32",goIcon:"_go-icon_1kmeq_32"};i();c();var ec=P(E());ce();var Ji=o=>{let e=Io(o),t=V.mul(e,100);return Number.isNaN(t)?e:Dr.percent(t)},tc=({chainId:o})=>{let{presetSelectType:e}=We,t=fe.getCurrentChainPresetsStore(o),{supportAutoMode:r}=t||{},n=t?.getSelectPreset?.({presetSelectType:e});return{...(0,ec.useMemo)(()=>{let a=n?.buyPreset||{},l=n?.sellPreset||{};return{isNodata:qe(n),buySlippage:Ji(a.slippageConfig),sellSlippage:Ji(l.slippageConfig),buyFee:kr(a.feeConfig),sellFee:kr(l.feeConfig),buyMev:Sr(a.routeConfig),sellMev:Sr(l.routeConfig)}},[n]),supportAutoMode:r}};var ud=({tradeMode:o,chainId:e})=>{let t=R(ne),{isNodata:r,buySlippage:n,sellSlippage:s,buyFee:a,sellFee:l,buyMev:d,sellMev:p,supportAutoMode:f}=tc({chainId:e}),{supportMev:m}=Zi(),g=o==="0"?n:s,u=o==="0"?a:l,T=o==="0"?d:p,k=(0,ke.useMemo)(()=>{let S=Number(u);return Number.isNaN(S)?u:Ie(u,{useScientificNotation:!0})},[u]);return ke.default.createElement("div",{className:(0,Ro.default)("flex justify-start",dt.presetConfigInfoWrapper)},r?null:ke.default.createElement("div",{className:(0,Ro.default)("flex items-center",dt.presetConfigInfo),onClick:()=>{t.deactivateEditMode(),t.openPresetModal(),t.setSelectTradeMode(o),Ee("settings_enter")},role:"presentation",onKeyDown:()=>{}},ke.default.createElement(B,{className:dt.presetIcon,iconName:"okx-defi-dex-slippage"}),ke.default.createElement("span",{className:"font-12 ml-4 font-500"},g),ke.default.createElement("span",{className:dt.divide}),ke.default.createElement(B,{className:dt.presetIcon,iconName:"okx-defi-dex-fee"}),ke.default.createElement("span",{className:"font-12 ml-4 font-500"},k),f&&m&&ke.default.createElement(ke.default.Fragment,null,ke.default.createElement("span",{className:dt.divide}),ke.default.createElement(Pa,{...T,greenClassName:dt.greenLight})),ke.default.createElement(B,{className:(0,Ro.default)("okx-defi-marketplace-chevron-right",dt.goIcon)})))},Lo=D(ud);i();c();var Xt={"top-token":"_top-token_1etbn_1",topToken:"_top-token_1etbn_1","top-right-title":"_top-right-title_1etbn_7",topRightTitle:"_top-right-title_1etbn_7","top-right-logo":"_top-right-logo_1etbn_12",topRightLogo:"_top-right-logo_1etbn_12","config-list":"_config-list_1etbn_15",configList:"_config-list_1etbn_15",hight28:"_hight28_1etbn_18","btn-group":"_btn-group_1etbn_21",btnGroup:"_btn-group_1etbn_21"};i();c();var Zt=P(E()),oc=P(me());i();c();var F=P(E()),Ye=P(me());i();c();var se={"select-token":"_select-token_1otj7_1",selectToken:"_select-token_1otj7_1","select-token--disabled":"_select-token--disabled_1otj7_4",selectTokenDisabled:"_select-token--disabled_1otj7_4","display-area":"_display-area_1otj7_7",displayArea:"_display-area_1otj7_7","prefix-text":"_prefix-text_1otj7_11",prefixText:"_prefix-text_1otj7_11","token-symbol":"_token-symbol_1otj7_15",tokenSymbol:"_token-symbol_1otj7_15","suffix-icon":"_suffix-icon_1otj7_19",suffixIcon:"_suffix-icon_1otj7_19",active:"_active_1otj7_24","suffix-icon--disabled":"_suffix-icon--disabled_1otj7_27",suffixIconDisabled:"_suffix-icon--disabled_1otj7_27","value-box":"_value-box_1otj7_30",valueBox:"_value-box_1otj7_30",footer:"_footer_1otj7_34","link-to-swap":"_link-to-swap_1otj7_44",linkToSwap:"_link-to-swap_1otj7_44","option-cont":"_option-cont_1otj7_49",optionCont:"_option-cont_1otj7_49",option:"_option_1otj7_49","option-right":"_option-right_1otj7_56",optionRight:"_option-right_1otj7_56","option-title":"_option-title_1otj7_59",optionTitle:"_option-title_1otj7_59","option-sub-title":"_option-sub-title_1otj7_65",optionSubTitle:"_option-sub-title_1otj7_65","option-left-icon":"_option-left-icon_1otj7_71",optionLeftIcon:"_option-left-icon_1otj7_71"};var pd=(o,{option:e})=>F.default.createElement("div",{className:(0,Ye.default)("flex justify-between items-center",se.option)},F.default.createElement("div",{className:(0,Ye.default)("flex items-center",se.optionLeft)},F.default.createElement(De,{src:e?.tokenLogoUrl,width:28,height:28,className:se.optionLeftIcon}),F.default.createElement("div",{className:(0,Ye.default)("flex flex-col",se.optionLeftText)},F.default.createElement("span",{className:se.optionTitle},e?.tokenSymbol),F.default.createElement("span",{className:se.optionSubTitle},e?.tokenName))),o?F.default.createElement("div",{className:(0,Ye.default)("flex flex-col",se.optionRight)},F.default.createElement("span",{className:se.optionTitle},e?.formattedBalance),F.default.createElement("span",{className:se.optionSubTitle},e?.formattedCurrencyAmount)):null),md=({token:o,className:e,tradeMode:t,isDragging:r,disabled:n})=>{let s=M(U),a=R(G),l=R(q),d=(0,F.useRef)(null),{selectedToken:p,defaultToken:f,buyWithToken:m,sellForToken:g,tokenSelectionList:u}=a,T=p?.tokenInfo||f?.tokenInfo,k=(0,F.useMemo)(()=>t==="0"?A("swaptrade_instant_buy_with"):A("swaptrade_instant_sell_for"),[t]),S=l.tokenSelectorHideCount;(0,F.useEffect)(()=>{d.current?.setVisible(!1)},[t,S]);let C=(0,F.useCallback)(b=>{let Q=t==="0",z=b?t:null;ir(async()=>{l.setTokenSelectorState(z),b&&await a.updateTokenSelectionList()}),Ee(Q?"token_from":"token_to")},[t,l,a]),_=(0,F.useCallback)(b=>{let Q=t==="0";Ee("token_select"),ya({chainId:Number(b.chainId),tokenAddress:b.tokenContractAddress,storageKey:Q?"extensionMarketBuy":"extensionMarketSell"});let z=Ya(b,u);Q?a.setBuyTokenIndex(z):a.setSellTokenIndex(z)},[t,u,a]),I=(0,F.useMemo)(()=>({suffixIconComp:b})=>F.default.createElement("div",{className:(0,Ye.default)(se.displayArea,"flex items-center font-12")},F.default.createElement("span",{className:se.prefixText},k),F.default.createElement("span",{className:(0,Ye.default)("font-500",se.tokenSymbol)},o?.tokenSymbol),b),[o?.tokenSymbol,k]),x=(0,F.useCallback)(()=>{t==="0"?yn(m,T):yn(T,g)},[T,m,g,t]),v=(0,F.useCallback)(b=>pd(s.computedInitWalletAtExtension,b),[s.computedInitWalletAtExtension]);return(0,F.useEffect)(()=>{r&&d.current?.setVisible(!1)},[r]),F.default.createElement(Vt,{className:(0,Ye.default)(e,se.selectToken,`instant-trade-token-selector-${t}`,n&&se["select-token--disabled"]),popupProps:{popupStyle:{width:308},graspBaseDom:!1,alwaysUpdatePopper:!0},ref:d,options:u,displayArea:I,value:o?.tokenContractAddress,align:Vt.DIRECTION.left,scrollStyle:{maxHeight:208},valueBoxClassName:se.valueBox,optionFooter:F.default.createElement("div",{className:se.footer},F.default.createElement("span",null,Ke("swaptrade_placeorder_segmentedctl_pay_with_other_tokens",{Advanced:F.default.createElement(we,{onClick:x,className:se.linkToSwap},A("swaptrade_placeorder_segmentedctl_advanced"))}))),suffixIcon:b=>F.default.createElement(B,{iconName:"okx-defi-dex-market-sort-down",className:(0,Ye.default)(se.suffixIcon,{[se.active]:b,[se["suffix-icon--disabled"]]:n})}),optionContClassName:(0,Ye.default)(se.optionCont,`instant-trade-token-selector-option-cont-${t}`),renderOption:v,onToggleShow:C,onChange:_,disabled:n})},rc=D(md);i();c();var Mo={"top-token":"_top-token_10xx9_1",topToken:"_top-token_10xx9_1","top-right-title":"_top-right-title_10xx9_7",topRightTitle:"_top-right-title_10xx9_7","top-right-logo":"_top-right-logo_10xx9_12",topRightLogo:"_top-right-logo_10xx9_12","config-list":"_config-list_10xx9_15",configList:"_config-list_10xx9_15"};var fd=({token:o,tradeMode:e,className:t,isDragging:r})=>{let n=R(G),{buyWithToken:s,sellForToken:a}=n,l=e==="0"?s:a;return Zt.default.createElement("div",{className:(0,oc.default)("flex justify-between items-center",Mo.topToken,t)}," ",Zt.default.createElement(rc,{token:l,tradeMode:e,isDragging:r,disabled:!l})," ",!!o&&Zt.default.createElement("div",{className:"flex items-center"}," ",Zt.default.createElement("span",{className:Mo.topRightTitle}," ",o?.formattedBalance)," ",Zt.default.createElement(De,{src:o?.tokenLogoUrl,width:16,height:16,className:Mo.topRightLogo})," "))},wo=D(fd);var Td=({disabledBuyOptions:o,className:e,shortcutKeys:t,isDragging:r,calldataParams:n})=>{let s=R(q),a=R(G),{isEditModeActive:l,isShortcutActive:d,spacePressed:p}=s,{onClickTrade:f,onMouseEnter:m,onMouseLeave:g}=Lt("0",n),u=Xi(f,m,g),T=(0,ut.useCallback)(C=>{s.setTempBuyModeConfigList(C)},[s]),k=!Array.isArray(u)||u.length===0,S=a.buyWithToken;return S?ut.default.createElement("div",{className:e},ut.default.createElement(wo,{token:S,tradeMode:"0",isDragging:r}),ut.default.createElement("div",{className:(0,nc.default)("flex justify-between",Xt.hight28)},ut.default.createElement(Xr,{height:28,loading:k},ut.default.createElement($r,{disabled:o,options:u,hideEditBtn:!0,isControlledEditMode:l,shortcutKeys:t,isShortcutActive:d,spacePressed:p,className:Xt.btnGroup,instantTradeStyle:1,useFocusFirstInput:!0,customRenderError:!0,onOptionsChange:T}))),ut.default.createElement(Lo,{tradeMode:"0",chainId:S.chainId})):null},sc=D(Td);i();c();var pt=P(E()),ic=P(me());i();c();var Mt=P(E());var ac=(o,e,t)=>{let r=R(G),{sellButtonList:n,sellForToken:s,selectedToken:a}=r,l=(0,Mt.useCallback)(m=>{let g=V.div(m.value,100);return{amount:V.floorMul(g,a?.tokenInfo?.amountNum,a?.tokenInfo?.decimals)}},[a]),d=(0,Mt.useCallback)(m=>{it({btnIndex:m.index,toTokenSymbol:s?.tokenSymbol,fromTokenSymbol:a?.tokenInfo?.tokenSymbol,isHotkey:!1,isBuy:!1});let{amount:g}=l(m);o({amount:g,fromToken:a?.tokenInfo,toToken:s,buttonUniqueId:m.buttonUniqueId})},[o,a,s,l]),p=(0,Mt.useCallback)(m=>{let{amount:g}=l(m);e({amount:g,fromToken:a?.tokenInfo,toToken:s,buttonUniqueId:m.buttonUniqueId})},[a,s,e,l]),f=(0,Mt.useCallback)(m=>{t(m.buttonUniqueId)},[t]);return(0,Mt.useMemo)(()=>!Array.isArray(n)||n?.length===0?null:n.map((m,g)=>{let u=V.mul(m.percent,100);return{label:Dr.percent(u),value:u,type:"select",index:g,key:`sell_select_${g+1}`,symbol:"%",min:0,max:100,precision:0,onClick:d,buttonUniqueId:m.buttonUniqueId,onMouseEnter:p,onMouseLeave:f}}),[n,d,p,t])};var hd=({disabledSellOptions:o,className:e,shortcutKeys:t,isDragging:r,calldataParams:n})=>{let s=R(q),a=R(G),{isEditModeActive:l,isShortcutActive:d,spacePressed:p}=s,{selectedToken:f,sellForToken:m}=a,{onClickTrade:g,onMouseEnter:u,onMouseLeave:T}=Lt("1",n),k=ac(g,u,T),S=(0,pt.useCallback)(_=>{let I=_.map(x=>ws(x)?V.floorDiv(x,100,2):x);s.setTempSellModeConfigList(I)},[s]),C=!Array.isArray(k)||k.length===0;return pt.default.createElement("div",{className:e},pt.default.createElement(wo,{token:f?.tokenInfo,tradeMode:"1",isDragging:r}),pt.default.createElement("div",{className:(0,ic.default)("flex justify-between",Xt.hight28)},pt.default.createElement(Xr,{height:28,loading:C},pt.default.createElement($r,{options:k,hideEditBtn:!0,disabled:o,isControlledEditMode:l,shortcutKeys:t,isShortcutActive:d,spacePressed:p,className:Xt.btnGroup,instantTradeStyle:2,useFocusFirstInput:!1,customRenderError:!0,onOptionsChange:S}))),pt.default.createElement(Lo,{tradeMode:"1",chainId:f?.tokenInfo?.chainId||m?.chainId}))},cc=D(hd);var _d=({calldataParams:o})=>{let e=R(q),t=R(G),{isEditModeActive:r}=e,{buyWithToken:n,sellForToken:s,selectedToken:a}=t,l=!!a;return yr.default.createElement(yr.default.Fragment,null,yr.default.createElement(sc,{disabledBuyOptions:!(l&&!!n||r),shortcutKeys:mr,calldataParams:o}),yr.default.createElement(cc,{disabledSellOptions:!(l&&!!s||r),shortcutKeys:fr,calldataParams:o}))},lc=D(_d);i();c();var dc={container:"_container_14vg4_1"};var kd=({calldataParams:o})=>Zn.default.createElement("div",{className:dc.container},Zn.default.createElement(lc,{calldataParams:o})),uc=kd;i();c();var rs=P(E()),wc=P(me());i();c();var No=P(E());i();c();var $=P(E());ce();i();c();var Jn=P(E());function pc({computedQuoteSafemoon:o}){return{safeMoonToken:(0,Jn.useMemo)(()=>o,[o])}}function mc({formatPriorityFee:o,nativeTokenPrice:e,isSolana:t,networkFeeDecimals:r,estimateGasFee:n,supportCustomGasFee:s,supportEip1559:a}){return(0,Jn.useMemo)(()=>{if(t){let p=o.baseFee||0,f=o.baseFeeUsd||0,m=o.value||"0";Ls(m)&&(m="0"),m=new V.BigNumber(m).toString(10);let g=V.add(m,p),u=V.mul(e||0,g),T=V.mul(e||0,m);return{baseFeeValue:p,baseFeeUsd:f,priorityFeeForShow:m,priorityFeeUSD:T,totalFeeUSD:u}}return{totalFeeUSD:kn({formatPriorityFee:o,nativeTokenPrice:e,isSolana:t,networkFeeDecimals:r,estimateGasFee:n,supportCustomGasFee:s,supportEip1559:a})}},[o,e,t,r,n,s,a])}i();c();var Do=P(E()),es=P(me());i();c();var wt={"tab-pane":"_tab-pane_2q8hv_1",tabPane:"_tab-pane_2q8hv_1","active-pane":"_active-pane_2q8hv_1",activePane:"_active-pane_2q8hv_1","buy-pane":"_buy-pane_2q8hv_1",buyPane:"_buy-pane_2q8hv_1","sell-pane":"_sell-pane_2q8hv_5",sellPane:"_sell-pane_2q8hv_5",name:"_name_2q8hv_9","name-active":"_name-active_2q8hv_14",nameActive:"_name-active_2q8hv_14"};var Sd=({list:o,onTabChange:e,activeTabType:t,className:r,disabled:n})=>Do.default.createElement(mt.Segmented,{useReactTransition:!0,className:r,activeId:t,onChange:s=>{n||e(s)},buttonNoBorder:!0,hideContent:!0,onlyRightMore:!0,average:!0,noActiveBorder:!0,fullScreenScroll:!0,clickToView:!0,paneSpacing:8,size:mt.SIZE.sm},o.map(s=>Do.default.createElement(mt.TabPane,{style:{cursor:n&&t!==s.type?"not-allowed":"pointer"},className:(0,es.default)({[wt.activePane]:t===s.type,[wt.tabPane]:t===s.type,[wt.buyPane]:t==="buy",[wt.sellPane]:t==="sell"}),tab:Do.default.createElement("span",{className:(0,es.default)(wt.name,{[wt.nameActive]:t===s.type})},A(s.name)),key:s.type,id:s.type}))),fc=Sd;i();c();var Me=P(E());i();c();var de=P(E()),Jt=P(me());i();c();var Ce={icon:"_icon_1yr0h_1",name:"_name_1yr0h_4","edit-icon":"_edit-icon_1yr0h_8",editIcon:"_edit-icon_1yr0h_8","check-mark-disabled":"_check-mark-disabled_1yr0h_11",checkMarkDisabled:"_check-mark-disabled_1yr0h_11",input:"_input_1yr0h_14","input-box":"_input-box_1yr0h_17",inputBox:"_input-box_1yr0h_17","custom-input":"_custom-input_1yr0h_17",customInput:"_custom-input_1yr0h_17","custom-box":"_custom-box_1yr0h_17",customBox:"_custom-box_1yr0h_17"};var Id=({isActive:o,name:e,type:t,onNameChange:r,supportChangeName:n,isEdit:s,setIsEdit:a})=>{let[l,d]=(0,de.useState)(null),[p,f]=(0,de.useState)(e);(0,de.useEffect)(()=>{l&&l?.focus()},[l]);let m=g=>{let u=g.target?.value?.trim();u.length>12||f(u)};return o&&s&&n?de.default.createElement(Ut,{inputClassName:Ce.input,innerClassName:(0,Jt.default)(Ce.inputBox,Ce.customInput,Ce.customBox),size:Ut.SIZE.md,value:p,onChange:m,"aria-label":"Edit_preset_name",onBlur:g=>{let u=g.relatedTarget;u&&u.dataset.type==="suffix-button"||(p.length>0?r(p,t):f(e),a(!1))},onRef:g=>{d(g)},suffix:de.default.createElement(we,{"data-type":"suffix-button",onClick:()=>{p.length>0&&(r(p,t),a(!1))},className:p.length>0?"cursor-pointer":"cursor-not-allowed"},de.default.createElement(B,{className:(0,Jt.default)("okds-checkmark",Ce.icon,Ce.editIcon,{[Ce.checkMarkDisabled]:p.length<1})}))}):o&&n?de.default.createElement("div",{className:"flex items-center"},t===2&&de.default.createElement(B,{className:(0,Jt.default)(" okx-defi-dex-meme-mode",Ce.icon)}),de.default.createElement("span",{className:Ce.name},p),de.default.createElement(we,{onClick:()=>{a(!0)},className:Ce.editIcon},de.default.createElement(B,{className:(0,Jt.default)("okds-draw",Ce.icon)}))):de.default.createElement("div",{className:"flex items-center"},t===2&&de.default.createElement(B,{className:(0,Jt.default)(" okx-defi-dex-meme-mode",Ce.icon)}),de.default.createElement("span",{className:Ce.name},p))},gc=Id;i();c();var ts="PRESET_SELECT_GUIDE_STORAGE_KEY";var Cd=({list:o,onTabChange:e,activeTabType:t,className:r,disabled:n,onPresetListChange:s})=>{let[a,l]=(0,Me.useState)(null),[d,p]=(0,Me.useState)({}),f=(T,k)=>{p(S=>({...S,[T]:k}))},m=(T,k)=>{let S=o.map(C=>C.presetType===k?{...C,name:T}:C);s(S)},[g,u]=(0,Me.useState)(!1);return(0,Me.useEffect)(()=>{oe.get(ts)||(u(!0),oe.set(ts,"1"))},[]),Me.default.createElement("div",{className:"flex flex-col"},Me.default.createElement(Yo,{title:A("swaptrade_preset_coachmrk_title_switch_between_presets"),description:A("swaptrade_preset_coachmrk_desc_set_up_different_buy"),placement:Yo.DIRECTION.bottomLeft,show:g,closeable:!0,onClose:()=>{u(!1)},arrowAlignBoundary:()=>({left:"20px",right:"unset",top:"unset",transform:"unset"}),referenceRef:a}),Me.default.createElement(mt.Button,{useReactTransition:!0,className:r,activeId:t,onChange:T=>{n||e(T)},buttonNoBorder:!0,hideContent:!0,hideNav:Object.values(d).some(T=>T),average:!0,paneSpacing:8,size:mt.SIZE.md,getPaneListRef:T=>{l(T)}},o.map(T=>Me.default.createElement(mt.TabPane,{style:{cursor:n&&t!==T.presetType?"not-allowed":"pointer"},tab:Me.default.createElement(gc,{name:T.name,type:T.presetType,isActive:t===T.presetType,onNameChange:m,supportChangeName:T.supportChangeName,isEdit:d[T.presetType]||!1,setIsEdit:k=>{f(T.presetType,k)}}),key:T.presetType,id:T.presetType}))))},Tc=Cd;i();c();var W=P(E());ce();var hc=(o,e)=>{let t=o==="manual",r=e===0,n=e===1;return t&&r?2:t&&n?3:1},_c=(o,e,t)=>{let r=(0,W.useMemo)(()=>[o.mode,Cn(o.customMax),Cn(o.value),o.type,{low:ye(o.config.low),medium:ye(o.config.medium),high:ye(o.config.high)},ye(o.min),ye(o.max),ye(o.fixedRecommendMax),ye(o.fixedRecommendMin),ye(o.dynamicMax),ye(o.dynamicMin),ye(o.recommendMax),ye(o.recommendMin)],[o]),n=(0,W.useMemo)(()=>ye(e),[e]),[s,a,l,d,p,f,m,g,u,T,k,S,C]=r,_=(0,W.useCallback)(I=>Si({value:I,min:f,max:m,recommendMin:u,recommendMax:g,level:d,auto:n,safemoon:t}),[f,m,d,n,t,u,g]);return{slippageMode:s,customMax:a,slippage:l,slippageType:d,slippageMapUse:p,minUse:f,maxUse:m,fixedRecommendMaxUse:g,fixedRecommendMinUse:u,dynamicMaxUse:T,dynamicMinUse:k,recommendMaxUse:S,recommendMinUse:C,dynamicSlippageUse:n,validator:_}},kc=(o,e,t,r)=>{let n=(0,W.useCallback)(()=>{let l={...o?.find(p=>p.presetType===t)},d=r==="buy"?"buyPreset":"sellPreset";return{newPreset:l,direction:d}},[o,t,r]),s=(0,W.useCallback)(a=>{let l=o.map(d=>d.presetType===t?a:d);e(l)},[o,t,e]);return{getEditPresetCopy:n,updateEditPreset:s}},Sc=(o,e,t,r)=>{let n=(0,W.useCallback)(g=>{try{let{newPreset:u,direction:T}=o();u[T]={...u[T],routeConfig:{...u[T].routeConfig,routerModeType:hc(g,r)}},e(u)}catch(u){J.stuff("setPriorityMode error",u)}},[o,e,r]),s=(0,W.useCallback)(g=>{try{let{newPreset:u,direction:T}=o();u[T]={...u[T],routeConfig:{...u[T].routeConfig,routerModeType:hc(t,g)}},e(u)}catch(u){J.stuff("setManualType error",u)}},[o,e,t]),a=(0,W.useCallback)(g=>{try{let{newPreset:u,direction:T}=o();u[T].slippageConfig.slippageType=g===xt.FIXED?2:1,e(u)}catch(u){J.stuff("setSlippageMode error",u)}},[o,e]),l=(0,W.useCallback)(g=>{let{value:u,level:T}=g;if(T===tt.CUSTOM)try{let{newPreset:S,direction:C}=o();S[C].slippageConfig.slippageRange[3].slippageValue=An(u),e(S)}catch(S){J.stuff("setSlippage error",S)}},[o,e]),d=(0,W.useCallback)(g=>{try{let{newPreset:u,direction:T}=o();u[T].slippageConfig.slippageRange.forEach((k,S)=>{u[T].slippageConfig.slippageRange[S].selected=!1}),g===tt.LOW?u[T].slippageConfig.slippageRange[0].selected=!0:g===tt.MEDIUM?u[T].slippageConfig.slippageRange[1].selected=!0:g===tt.HIGH?u[T].slippageConfig.slippageRange[2].selected=!0:u[T].slippageConfig.slippageRange[3].selected=!0,e(u)}catch(u){J.stuff("setSlippageType error",u)}},[o,e]),p=(0,W.useCallback)(g=>{try{let{newPreset:u,direction:T}=o();u[T].slippageConfig.dynamicMaxSlippageValue=An(g),e(u)}catch(u){J.stuff("setCustomMax error",u)}},[o,e]),f=(0,W.useCallback)(({value:g,type:u})=>{if(u===rt.CUSTOM)try{let{newPreset:k,direction:S}=o(),C="feeOptions";k[S].feeConfig[C][3].feeValue=g,e(k)}catch(k){J.stuff("setPriorityFee error",k)}},[o,e]),m=(0,W.useCallback)(g=>{try{let{newPreset:u,direction:T}=o(),k="feeOptions";u[T].feeConfig[k].forEach((S,C)=>{u[T].feeConfig[k][C].selected=!1}),g===rt.MARKET?u[T].feeConfig[k][0].selected=!0:g===rt.FAST?u[T].feeConfig[k][1].selected=!0:g===rt.TURBO?u[T].feeConfig[k][2].selected=!0:u[T].feeConfig[k][3].selected=!0,e(u)}catch(u){J.stuff("setPriorityFeeType error",u)}},[o,e]);return{setPriorityMode:n,setManualType:s,setSlippageMode:a,setSlippage:l,setSlippageType:d,setCustomMax:p,setPriorityFee:f,setPriorityFeeType:m}},Ic=({slippage:o,slippageType:e,slippageMapUse:t,minUse:r,maxUse:n,fixedRecommendMinUse:s,fixedRecommendMaxUse:a,validator:l,dynamicSlippageUse:d,computedAutoSlippage:p,slippageState:f,customMax:m,dynamicMaxUse:g,dynamicMinUse:u,recommendMaxUse:T,recommendMinUse:k,safeMoonToken:S})=>{let C=(0,W.useMemo)(()=>({value:o,level:e,levelMap:t,min:r,max:n,recommendMin:s,recommendMax:a,validator:l,auto:d}),[o,e,t,r,n,s,a,l,d]),_=(0,W.useMemo)(()=>({showDynamicSlippage:Rr(p),dynamicSlippage:d,supportCustomMax:f.supportCustomMax,customMax:m,dynamicMax:g,dynamicMin:u,recommendMax:T,recommendMin:k,safemoon:S}),[p,d,f.supportCustomMax,m,g,u,T,k,S]);return{slippageFixedData:C,slippageDynamicData:_}},Cc=({supportAutoMode:o,isEnableMevStatus:e,mevPriorityFeeInfo:t,nonMevPriorityFeeInfo:r,supportMev:n,supportCustomGasFee:s})=>{let a=(0,W.useMemo)(()=>o&&e,[o,e]),l=(0,W.useMemo)(()=>a?t:r,[a,t,r]),d=(0,W.useMemo)(()=>o&&n,[o,n]),p=(0,W.useMemo)(()=>s,[s]);return{computedPriorityFeeInfo:l,computedShowAutoMode:d,computedShowDetailMode:p}},Ac=(o,e,t,r,n)=>({isFormDisabled:(0,W.useMemo)(()=>{let a=o==="fixed"&&e,l=o==="dynamic"&&t,d=n===6;return a||l||r||d},[o,e,t,r,n])}),yc=({presetHandlers:o,setSlippageError:e,setCustomMaxError:t,setPriorityFeeError:r,presetEditType:n,editPresetsList:s,setEditPresetsList:a,onClose:l,chainId:d,userWalletAddress:p,accountId:f,onSavePresetSuccess:m})=>{let g=(0,W.useCallback)(({mode:S,fixedData:C,dynamicData:_})=>{o.setSlippageMode(S);let I=S===xt.FIXED,x=S===xt.DYNAMIC;I&&(o.setSlippage(C),o.setSlippageType(C.level),e(C.error)),x&&(o.setCustomMax(_.customMax),t(_.error))},[o,e,t]),u=(0,W.useCallback)((S,C,_)=>{o.setPriorityFee({value:C,type:S}),o.setPriorityFeeType(S),r(_)},[o,r]),T=(0,W.useCallback)(async()=>{let S=await fe.resetPreset({presetType:n,chainId:d});if(S){e(!1),t(!1),r(!1);let C=s.map(_=>_.presetType===n?{...S,name:_.name}:_);a(C)}},[n,e,t,r,d,s,a]),k=(0,W.useCallback)(async()=>{let S=await fe.savePreset({presets:s,chainId:d,userWalletAddress:p,accountId:f,presetEditType:n});S&&S.success&&(m(S),l())},[s,d,l,p,f,n,m]);return{handleSlippageChange:g,handlePriorityFeeChange:u,handleReset:T,handleConfirm:k}},Pc=({setEditTradeMode:o,setPresetEditType:e,setEditPresetsList:t})=>{let r=(0,W.useCallback)(a=>{e(a)},[e]),n=(0,W.useCallback)(a=>{o(a)},[o]),s=(0,W.useCallback)(a=>{t(a)},[t]);return{onPresetTypeChange:r,onPresetDirectionChange:n,onPresetListChange:s}},bc=o=>{let e=(0,W.useMemo)(()=>A(o?"swaptrade_modal_dialog_title_priority":"swaptrade_swap_history_subtitle_network_fee"),[o]),t=(0,W.useMemo)(()=>A(o?"swaptrade_modal_dialog_desc_priority_meme":"swaptrade_orders_tooltips_how_paygas"),[o]);return{dialogTitle:e,dialogTooltip:t}};i();c();var vc=P(E());i();c();ce();var Ad=({priorityFee:o,fastValue:e,fastPrice:t,marketValue:r,marketPrice:n,turboValue:s,turboPrice:a})=>{let l=o?.value,d=o?.price;return o?.type==="fast"?(l=e,d=t):o?.type==="market"?(l=r,d=n):o?.type==="turbo"&&(l=s,d=a),{value:l,price:d}},xc=({priorityFee:o,priorityFeeInfo:e,supportCustomGasFee:t})=>{if(t){let{fastFee:s,fastFeeUsd:a,marketFee:l,marketFeeUsd:d,turboFee:p,turboFeeUsd:f,baseFee:m,baseFeeUsd:g}=e,u={fast:{amount:s,price:a},market:{amount:l,price:d},turbo:{amount:p,price:f}},{value:T,price:k}=Ad({priorityFee:o,fastValue:s,fastPrice:a,marketValue:l,marketPrice:d,turboValue:p,turboPrice:f});return Lr({},o,{value:T,price:k,config:u,baseFee:m,baseFeeUsd:g,gasPrice:m})}let{baseFee:r,baseFeeUsd:n}=e;return{value:r,price:n,gasPrice:r}};var Ec=({priorityFee:o,priorityFeeInfo:e,supportCustomGasFee:t})=>({formatPriorityFee:(0,vc.useMemo)(()=>xc({priorityFee:o,priorityFeeInfo:e,supportCustomGasFee:t}),[e,o,t])});i();c();var kt={root:"_root_uuhsg_1","scroll-content":"_scroll-content_uuhsg_7",scrollContent:"_scroll-content_uuhsg_7",name:"_name_uuhsg_14",priority:"_priority_uuhsg_15",mev:"_mev_uuhsg_18",slippage:"_slippage_uuhsg_19",direction:"_direction_uuhsg_23"};var yd=D(({onClose:o,computedQuoteSafemoon:e,jitoIsSuccess:t,computedAutoSlippage:r,mevUnstableShowLevel:n,getTokenAmount:s=b=>b,getUsd:a=b=>b,mevPriorityFeeInfo:l={},nonMevPriorityFeeInfo:d={},nativeTokenPrice:p,computedGetEstimateGasFee:f,renderTipsComponent:m,disableChangeTradeDirection:g,isAutoSellChecked:u,supportMev:T,chainId:k,userWalletAddress:S,accountId:C,tradeScene:_,selectTradeMode:I,presetSelectType:x,onSavePresetSuccess:v=()=>{}})=>{let{fetchSaveStatus:b,fetchResetStatus:Q}=j,z=fe.getCurrentChainPresetsStore(k),{computedChainName:N,networkFeeUnit:O,networkFeeDecimals:ee,mevPriceThreshold:te,supportAutoMode:Se,supportCustomGasFee:ue,supportEip1559:ae,memeChainType:It,computedSupportPriorityFee:rr,dynamicSupportMax:or,presetsList:Fo}=z,[$e,Wo]=(0,$.useState)(I),[Ct,nr]=(0,$.useState)($o(Fo)),[be,br]=(0,$.useState)(x),Bt=(0,$.useMemo)(()=>{let Er=Ct?.find(_l=>_l.presetType===be);return Er?$o(Er):{}},[Ct,be]),Xe=(0,$.useMemo)(()=>$e==="buy"?Y(Bt,"buyPreset",{})??{}:Y(Bt,"sellPreset",{})??{},[$e,Bt]),He=ko(Xe),xr=So({presetWithDirection:Xe,dynamicSupportMax:or}),Ft=(0,$.useMemo)(()=>Y(Xe.routeConfig,"routerModeType",1)??1,[Xe]),At=(0,$.useMemo)(()=>Ft===3?1:0,[Ft]),yt=(0,$.useMemo)(()=>Ft===1?"auto":"manual",[Ft]),vr=Sn({priorityMode:yt,manualType:At,jitoIsSuccess:t,mevUnstableShowLevel:n}),Uo=In(vr),{computedPriorityFeeInfo:Pt,computedShowAutoMode:us,computedShowDetailMode:Wt}=Cc({supportAutoMode:Se,isEnableMevStatus:Uo,mevPriorityFeeInfo:l,nonMevPriorityFeeInfo:d,supportMev:T,supportCustomGasFee:ue}),{formatPriorityFee:Ze}=Ec({priorityFee:He,priorityFeeInfo:Pt,supportCustomGasFee:ue}),{safeMoonToken:ps}=pc({computedQuoteSafemoon:e}),pe=_c(xr,r,ps),{getEditPresetCopy:Qc,updateEditPreset:zc}=kc(Ct,nr,be,$e),Vo=Sc(Qc,zc,yt,At),{slippageFixedData:Yc,slippageDynamicData:jc}=Ic({slippage:pe.slippage,slippageType:pe.slippageType,slippageMapUse:pe.slippageMapUse,minUse:pe.minUse,maxUse:pe.maxUse,fixedRecommendMinUse:pe.fixedRecommendMinUse,fixedRecommendMaxUse:pe.fixedRecommendMaxUse,validator:pe.validator,dynamicSlippageUse:pe.dynamicSlippageUse,computedAutoSlippage:r,slippageState:xr,customMax:pe.customMax,dynamicMaxUse:pe.dynamicMaxUse,dynamicMinUse:pe.dynamicMinUse,recommendMaxUse:pe.recommendMaxUse,recommendMinUse:pe.recommendMinUse,safeMoonToken:ps}),[$c,Xc]=(0,$.useState)(!1),[Zc,Jc]=(0,$.useState)(!1),[el,tl]=(0,$.useState)(!1),[ms,rl]=(0,$.useMemo)(()=>[Ze.value,Ze.type],[Ze]),ol=(0,$.useMemo)(()=>yt==="manual"&&At===1,[yt,At]),{isFormDisabled:Ho}=Ac(pe.slippageMode,Zc,$c,el,vr),{handleSlippageChange:nl,handlePriorityFeeChange:sl,handleReset:al,handleConfirm:il}=yc({presetHandlers:Vo,setSlippageError:Jc,setCustomMaxError:Xc,setPriorityFeeError:tl,presetEditType:be,editPresetsList:Ct,setEditPresetsList:nr,onClose:o,chainId:k,userWalletAddress:S,accountId:C,onSavePresetSuccess:v}),{onPresetTypeChange:cl,onPresetDirectionChange:ll,onPresetListChange:dl}=Pc({setEditTradeMode:Wo,setPresetEditType:br,setEditPresetsList:nr}),{dialogTitle:ul,dialogTooltip:pl}=bc(rr),ml=mc({formatPriorityFee:Ze,nativeTokenPrice:p,isSolana:It==="0",networkFeeDecimals:ee,estimateGasFee:f,supportCustomGasFee:ue,supportEip1559:ae}),fl=Ho||g,gl=b===ie.LOADING,Tl=Q===ie.LOADING,hl=(0,$.useMemo)(()=>u&&$e==="sell"||_===1,[u,$e,_]);return $.default.createElement("div",{className:kt.root},$.default.createElement("div",{className:kt.scrollContent},$.default.createElement(Tc,{list:Ct,activeTabType:be,onTabChange:cl,onPresetListChange:dl,className:"mt-24",disabled:Ho}),$.default.createElement(fc,{list:Ca,activeTabType:$e,onTabChange:ll,className:kt.direction,disabled:fl}),us&&$.default.createElement(La,{className:kt.mev,setMode:Vo.setPriorityMode,priorityMode:yt,setManualType:Vo.setManualType,manualType:At,mevUnstableShowLevel:n,jitoIsSuccess:t,mevPriceThreshold:te,chainName:N,showOffMevTips:ol}),$.default.createElement(Ea,{className:kt.slippage,mode:pe.slippageMode,fixedData:Yc,dynamicData:jc,showDynamicTips:hl,onChange:nl}),Wt?$.default.createElement(_n.DetailMode,{className:kt.priority,fee:ms,type:rl,feeMap:Ze.config,max:Ze.max,min:Ze.min,noRecommend:!0,currency:O,onChange:sl,getTokenAmount:s,getUsd:a,tipsComponent:m(ml),dialogTitle:ul,dialogTooltip:pl,hidePrice:!0}):$.default.createElement(_n.NoSupportCustomMode,{networkFee:ms,symbol:O,className:kt.priority})),$.default.createElement(Ra,{confirmDisabled:Ho,handleConfirm:il,handleReset:al,confirmLoading:gl,resetLoading:Tl}))}),Rc=yd;var Pd=D(({onClose:o,computedQuoteSafemoon:e,jitoIsSuccess:t,computedAutoSlippage:r,mevUnstableShowLevel:n,getTokenAmount:s,getUsd:a,mevPriorityFeeInfo:l={},nonMevPriorityFeeInfo:d={},nativeTokenPrice:p,disableChangeTradeDirection:f,computedGetEstimateGasFee:m,isAutoSellChecked:g=!1,supportMev:u=!0,chainId:T,userWalletAddress:k,accountId:S,tradeScene:C,selectTradeMode:_,presetSelectType:I,onSavePresetSuccess:x})=>No.default.createElement(Rc,{onSavePresetSuccess:x,presetSelectType:I,selectTradeMode:_,tradeScene:C,accountId:S,userWalletAddress:k,chainId:T,onClose:o,computedQuoteSafemoon:e,jitoIsSuccess:t,computedAutoSlippage:r,mevUnstableShowLevel:n,getTokenAmount:s,getUsd:a,mevPriorityFeeInfo:l,nonMevPriorityFeeInfo:d,nativeTokenPrice:p,isAutoSellChecked:g,disableChangeTradeDirection:f,computedGetEstimateGasFee:m,supportMev:u,renderTipsComponent:v=>v.totalFeeUSD?v.baseFeeValue?No.default.createElement(va,{totalFeeUSD:v.totalFeeUSD,baseFeeValue:v.baseFeeValue,baseFeeUsd:v.baseFeeUsd,priorityFeeForShow:v.priorityFeeForShow,priorityFeeUSD:v.priorityFeeUSD}):No.default.createElement(xa,{totalFeeUSD:v.totalFeeUSD}):null})),Lc=Pd;i();c();var Mc={"preset-dialog":"_preset-dialog_46n92_1",presetDialog:"_preset-dialog_46n92_1"};var bd=({chainId:o})=>{let e=M(U),t=M(H),r=R(ne),{getTokenAmount:n,getUsd:s}=ba(),{computedAccountId:a}=e,l=e.getAddressByChainId(o),d=()=>{r.closePresetModal()},{selectTradeMode:p}=t;return rs.default.createElement("div",{className:(0,wc.default)(Mc.presetDialog)},rs.default.createElement(Lc,{onClose:d,getTokenAmount:n,getUsd:s,supportMev:e.walletSupportMev,chainId:o,userWalletAddress:l,accountId:a,tradeScene:0,selectTradeMode:Jr[p],presetSelectType:We.presetSelectType,onSavePresetSuccess:Yt.setPresetSelectType}))},Dc=D(bd);i();c();var Nt=P(E()),os=P(me());i();c();var Dt={"setting-dialog":"_setting-dialog_l2ds8_1",settingDialog:"_setting-dialog_l2ds8_1","setting-item":"_setting-item_l2ds8_5",settingItem:"_setting-item_l2ds8_5",left:"_left_l2ds8_13",title:"_title_l2ds8_20",description1:"_description1_l2ds8_25","go-icon":"_go-icon_l2ds8_31",goIcon:"_go-icon_l2ds8_31"};var xd=()=>Nt.default.createElement("div",{className:(0,os.default)(Dt.settingDialog)},Nt.default.createElement(we,{className:Dt.settingItem,onClick:()=>{y.global.switchInstantTrade?.()}},Nt.default.createElement("div",{className:Dt.left},Nt.default.createElement("p",{className:Dt.title},A("swaptrade_instant_cell_tag_instant_trade_switch")),Nt.default.createElement("p",{className:Dt.description1},A("swaptrade_instant_dialog_desc_set_the_enabling_status"))),Nt.default.createElement(B,{className:(0,os.default)("okx-defi-marketplace-chevron-right",Dt.goIcon)}))),Nc=xd;i();c();var w=P(E()),Ot=P(me());i();c();var ns=P(E());var Oc=()=>{let o=R(q),e=R(G),t=R(ne),r=(0,ns.useCallback)(()=>{t.deactivateEditMode(),o.isShortcutActive?(Ee("hot_key_off"),t.deactivateShortcut()):(Ee("hot_key_on"),t.activateShortcut())},[o,t]),n=(0,ns.useCallback)(()=>{o.isEditModeActive?e.saveEditModeConfigs(o.tempBuyModeConfigList,o.tempSellModeConfigList,()=>{o.setEditModeActive(!1)}):(Ee("qty_edit"),t.activateEditMode())},[o,e,t]);return{handleShortcutToggle:r,handleEditModeToggle:n}};i();c();var X=P(E()),er=P(me());i();c();var Bc=P(E());var Fc=()=>{let o=M(U),t=M(H).ctxIsReady,r=!!o.computedAccountId;return(0,Bc.useMemo)(()=>t&&r,[t,r])};i();c();var he={"preset-selector":"_preset-selector_1rr07_1",presetSelector:"_preset-selector_1rr07_1","extension-logo":"_extension-logo_1rr07_5",extensionLogo:"_extension-logo_1rr07_5","select-preset":"_select-preset_1rr07_11",selectPreset:"_select-preset_1rr07_11","display-area":"_display-area_1rr07_14",displayArea:"_display-area_1rr07_14","display-area-label":"_display-area-label_1rr07_18",displayAreaLabel:"_display-area-label_1rr07_18","value-box":"_value-box_1rr07_27",valueBox:"_value-box_1rr07_27",footer:"_footer_1rr07_31","settings-icon":"_settings-icon_1rr07_41",settingsIcon:"_settings-icon_1rr07_41","option-cont":"_option-cont_1rr07_45",optionCont:"_option-cont_1rr07_45",option:"_option_1rr07_45","option-label":"_option-label_1rr07_55",optionLabel:"_option-label_1rr07_55","check-icon":"_check-icon_1rr07_61",checkIcon:"_check-icon_1rr07_61",active:"_active_1rr07_65"};var vd=({option:o,isActive:e})=>X.default.createElement("div",{className:(0,er.default)("flex justify-between items-center",he.option)},X.default.createElement("div",{className:he.optionLabel},o?.label),X.default.createElement(B,{className:(0,er.default)("okx-defi-dex-check",he.checkIcon,{[he.active]:e})})),Ed=({minimize:o,onMinimize:e,className:t,chainId:r,isDragging:n})=>{let s=M(U),a=R(ne),l=(0,X.useRef)(null),d=(0,X.useMemo)(()=>({popupStyle:{width:140},graspBaseDom:!1,alwaysUpdatePopper:!0}),[]),p=(0,X.useCallback)(v=>{a.deactivateEditMode(),v&&(Ee("preset_switch"),o&&e?.(!1))},[o,e,a]),f=(0,X.useCallback)(()=>{o&&e?.(!1)},[o,e]),m=r?s.getAddressByChainId(r):"",g=v=>{Yt.setPresetSelectType({userWalletAddress:m,type:v.value,chainId:r})},u=(0,X.useCallback)(()=>{l.current?.setVisible(!1),a.openPresetModal()},[a]),T=fe.getCurrentChainPresetsList(r),k=(0,X.useMemo)(()=>!Array.isArray(T)||T?.length===0?[]:T.map(v=>({label:v.name,value:v.presetType})),[T]),S=We.presetSelectType,C=Fc(),_=(0,X.useMemo)(()=>C?T?.length>0:!1,[T,C]),I=`https://${y.global?.getStaticHostname?.()}/cdn/assets/imgs/254/43DEFFE88CCA0D7C.png`;(0,X.useEffect)(()=>{n&&l.current?.setVisible(!1)},[n]);let x=({selectedOption:v,suffixIconComp:b})=>X.default.createElement("div",{className:(0,er.default)(he.displayArea)},y.isExtensionEnv&&X.default.createElement(De,{src:I,pictureClassName:he.extensionLogo,width:16,height:16,onClick:f}),X.default.createElement("div",{className:he.displayAreaLabel},v?.label),b);return X.default.createElement("div",{className:he.presetSelector},!_&&y.isExtensionEnv&&X.default.createElement(De,{src:I,pictureClassName:he.extensionLogo,width:16,height:16,onClick:f}),_&&X.default.createElement(Vt,{ref:l,className:(0,er.default)(t,he.selectPreset),popupProps:d,options:k,displayArea:x,value:S,align:Vt.DIRECTION.left,scrollStyle:{maxHeight:200},valueBoxClassName:he.valueBox,optionFooter:X.default.createElement("div",{className:he.footer},X.default.createElement(we,{onClick:u,className:he.footer},X.default.createElement(B,{className:(0,er.default)("okx-defi-dex-web3-settings",he.settingsIcon)}),X.default.createElement("span",null,A("swaptrade_preset_header_edit_presets")))),optionContClassName:he.optionCont,renderOption:vd,onChange:g,onToggleShow:p}))},Wc=D(Ed);i();c();var ss=P(E());var as=P(me());i();c();var K={"top-bar":"_top-bar_wlkc9_1",topBar:"_top-bar_wlkc9_1","top-bar--setting":"_top-bar--setting_wlkc9_14",topBarSetting:"_top-bar--setting_wlkc9_14","top-bar--preset":"_top-bar--preset_wlkc9_17",topBarPreset:"_top-bar--preset_wlkc9_17","drag-handle":"_drag-handle_wlkc9_21",dragHandle:"_drag-handle_wlkc9_21","drag-icon":"_drag-icon_wlkc9_28",dragIcon:"_drag-icon_wlkc9_28","top-bar-left":"_top-bar-left_wlkc9_35",topBarLeft:"_top-bar-left_wlkc9_35","back-icon":"_back-icon_wlkc9_35",backIcon:"_back-icon_wlkc9_35","top-bar-center":"_top-bar-center_wlkc9_41",topBarCenter:"_top-bar-center_wlkc9_41",title:"_title_wlkc9_45","title-with-logo":"_title-with-logo_wlkc9_52",titleWithLogo:"_title-with-logo_wlkc9_52","top-bar-right":"_top-bar-right_wlkc9_55",topBarRight:"_top-bar-right_wlkc9_55","icon-btn":"_icon-btn_wlkc9_60",iconBtn:"_icon-btn_wlkc9_60",active:"_active_wlkc9_80",disabled:"_disabled_wlkc9_83","active-icon":"_active-icon_wlkc9_87",activeIcon:"_active-icon_wlkc9_87",icon:"_icon_wlkc9_60","close-icon":"_close-icon_wlkc9_99",closeIcon:"_close-icon_wlkc9_99","tooltip-title-text-value":"_tooltip-title-text-value_wlkc9_109",tooltipTitleTextValue:"_tooltip-title-text-value_wlkc9_109"};var Oo=({iconName:o,isActive:e,isSelected:t,className:r,iconClassName:n,handleClick:s,minimize:a,onMinimize:l,a11yText:d,disabled:p})=>ss.default.createElement(we,{className:(0,as.default)(K.iconBtn,r,{[K.active]:e||t,[K.disabled]:p}),disabled:p,onClick:f=>{if(f?.detail!==0){if(a){l?.(!1);return}s?.()}}},ss.default.createElement(B,{className:(0,as.default)(K.icon,o,n,{[K.activeIcon]:e}),a11yText:d}));var Rd=(0,w.forwardRef)(({className:o,onClose:e,chainId:t},r)=>{let n=R(q),s=R(ne),{handleEditModeToggle:a,handleShortcutToggle:l}=Oc(),d=(0,w.useMemo)(()=>n.isShortcutActive?Ke("swaptrade_instant_to_use_hotkeys_replace",{btn:w.default.createElement("span",{className:K.tooltipTitleTextValue},A("swaptrade_instant_to_use_hotkeys_variable"))}):A("swaptrade_instant_enable_hotkeys"),[n.isShortcutActive]),p=()=>{if(n.computedDialogState==="setting")return w.default.createElement(w.default.Fragment,null,w.default.createElement("div",{className:K.topBarLeft},w.default.createElement(B,{className:(0,Ot.default)(K.backIcon,"okds-arrow-chevron-left-centered-sm"),onClick:()=>n.setSettingModalOpen(!1),fontSize:"16px",a11yText:A("swaptrade_instant_dialog_header_simple_title")})),w.default.createElement("div",{className:K.topBarCenter},w.default.createElement("span",{className:K.title},A("swaptrade_instant_dialog_header_simple_title"))),w.default.createElement("div",{className:K.topBarRight,style:{width:"24px"}}));if(n.computedDialogState==="preset"){let f=fe.getCurrentChainPresetsStore(t),{computedChainLogoUrl:m,computedChainSymbol:g}=f;return w.default.createElement(w.default.Fragment,null,w.default.createElement("div",{className:K.topBarLeft},w.default.createElement(B,{className:(0,Ot.default)(K.backIcon,"okds-arrow-chevron-left-centered-sm"),onClick:()=>{s.closePresetModal()},fontSize:"16px",a11yText:A("swaptrade_meme_header_edit_preset")})),w.default.createElement("div",{className:K.topBarCenter},w.default.createElement("div",{className:"flex justify-center align-items-center"},w.default.createElement(Ma,{src:m,alt:g,size:24}),w.default.createElement("span",{className:(0,Ot.default)(K.title,K.titleWithLogo)},A("swaptrade_meme_header_edit_preset")))),w.default.createElement("div",{className:K.topBarRight,style:{width:"24px"}}))}return w.default.createElement(w.default.Fragment,null,w.default.createElement("div",{className:K.topBarLeft},w.default.createElement(Wc,{chainId:t})),w.default.createElement("div",{className:K.topBarRight},w.default.createElement(bt,{title:A("swaptrade_multichain_tooltips_customize"),placement:bt.DIRECTION.bottomRight,disabled:n.isEditModeActive},w.default.createElement(Oo,{iconName:n.isEditModeActive?"okx-defi-dex-check":"okx-defi-marketplace-edit",isSelected:n.isEditModeActive,handleClick:a,a11yText:A("swaptrade_multichain_tooltips_customize")})),w.default.createElement(bt,{title:d,placement:bt.DIRECTION.bottom,maxWidth:100},w.default.createElement(Oo,{isActive:n.isShortcutActive,iconName:"okx-defi-dex-keyboard",handleClick:l,a11yText:n.isShortcutActive?A("swaptrade_instant_to_use_hotkeys"):A("swaptrade_instant_enable_hotkeys")})),w.default.createElement(Oo,{iconName:"okx-defi-dex-web3-settings",handleClick:()=>{s.deactivateEditMode(),s.openSettingModal(),Fs()},a11yText:"Settings"}),w.default.createElement(B,{className:(0,Ot.default)(K.closeIcon,"okx-defi-collapse"),onClick:f=>{f?.detail!==0&&e&&e()},a11yText:"Close"})))};return w.default.createElement("div",{className:(0,Ot.default)(K.topBar,o,{[K.topBarPreset]:n.computedDialogState==="preset",[K.topBarSetting]:n.computedDialogState==="setting"})},w.default.createElement("div",{className:K.dragHandle,ref:r},w.default.createElement(B,{className:(0,Ot.default)(K.dragIcon,"okx-defi-dex-drag")})),p())}),Uc=D(Rd);i();c();var Bo={mask:"_mask_m9z1s_1","dialog-window":"_dialog-window_m9z1s_10",dialogWindow:"_dialog-window_m9z1s_10","no-content-padding":"_no-content-padding_m9z1s_23",noContentPadding:"_no-content-padding_m9z1s_23","loading-overlay":"_loading-overlay_m9z1s_26",loadingOverlay:"_loading-overlay_m9z1s_26",container:"_container_m9z1s_39","pb-16":"_pb-16_m9z1s_47",pb16:"_pb-16_m9z1s_47","pt-24":"_pt-24_m9z1s_50",pt24:"_pt-24_m9z1s_50","service-fee":"_service-fee_m9z1s_53",serviceFee:"_service-fee_m9z1s_53"};var Ld=({className:o,visible:e,onClose:t,windowClass:r,id:n,isReady:s})=>{let a=R(G),l=R(q),{isInitialized:d,defaultToken:p}=a,{isBoostInfoShown:f,boostOnboardingShown:m,computedDialogState:g,computedWindowSize:u}=l,T=R(ne),[k,S]=(0,Z.useState)(""),[C,_]=(0,Z.useState)(!1),[I,x]=(0,Z.useState)("initial"),v=M(U),{computedAccountWalletAddresses:b}=v,Q=(0,Z.useMemo)(()=>({userWalletAddress:v.getAddressByChainId(ct),walletId:v.computedAccountId}),[v]),z=(0,Z.useCallback)(async O=>{x("validating"),S(O);try{if(!$a(O)){re.error({title:wr("swaptrade_function_input_toast_unsupported_network")}),x("invalid");return}let ee=await a.addSelectedToken(O,ct);!ee||!ee.tokenInfo.tokenContractAddress?(x("invalid"),re.error({title:wr("swaptrade_function_input_toast_invalid_ca")})):(x("valid"),await T.updateCurrentTokenInfo({chainId:ct,tokenContractAddress:O}))}catch(ee){console.error("validateContractAddress error:",ee),x("invalid"),re.error({title:wr("swaptrade_function_input_toast_invalid_ca")})}},[a,T]);wi({onPaste:O=>{z(O)},enabled:C&&s}),si(),Ei({calldataParams:Q}),(0,Z.useEffect)(()=>{(async()=>{if(s&&v.isConnectedWallet){let ee=await a.initializeInstantTrade();if(!m){y.global.setContentLoading?.(!1);return}y.global.setContentLoading?.(!ee)}})()},[s,v.isConnectedWallet,m]),(0,Z.useEffect)(()=>{let O;return b&&s&&(O=ea(b)),()=>{O?.()}},[b,s]);let N=(0,Z.useCallback)(()=>{let O="https://web3.okx.com/boost";y.global.goto?.(O)},[]);return!e||!s||!d||!p?null:m?Z.default.createElement(Z.default.Fragment,null,Z.default.createElement("div",{className:(0,is.default)(Bo.dialogWindow,Bo.dark,r,o),"data-testid":"okd-dialog-window",role:"dialog","aria-modal":"true",id:n,style:{width:`${u.width}px`,height:`${u.height}px`},draggable:!1},Z.default.createElement(Uc,{chainId:ct,onClose:t}),g==="setting"&&Z.default.createElement(Nc,null),g==="preset"&&Z.default.createElement(Dc,{chainId:ct}),g==="main"&&Z.default.createElement(Z.default.Fragment,null,Z.default.createElement("div",{className:(0,is.default)(Bo.container,o)},Z.default.createElement($i,{onFocus:()=>{_(!0)},onBlur:()=>{_(!1)},validationState:I,contractAddress:k,onClearAddress:()=>{a.removeSelectedToken(),S(""),x("initial")}}),Z.default.createElement(uc,{calldataParams:Q})),f&&Z.default.createElement(Ui,{onClick:N,onClose:()=>l.hideBoostInfo()})))):Z.default.createElement(Hi,{onClose:t})},Vc=D(Ld);var Md=({onClose:o,isReady:e=!1,...t})=>cs.default.createElement(ia,{fallbackComponent:()=>null},cs.default.createElement(Vc,{visible:!0,onClose:o,isReady:e,...t})),Hc=Md;i();c();var tr=P(E());var qc=({currency:o,currentWallet:e,walletInfo:t,ontCore:r,globalCtx:n,LocalStore:s,stateInfo:a,isSaAccountNormal:l})=>{let[d,p]=(0,tr.useState)(!1),f=M(U),m=M(H),g=R(q);return(0,tr.useEffect)(()=>{y.initSentry(n?.dsn,n?.config,n?.version),y.updateEnvConfig({currency:o,currentWallet:e,walletInfo:t,ontCore:r,globalCtx:n,LocalStore:s}),Xo.setOnt(r);let{getApiHostname:u}=y.global;wa(y.localStore,u?.()).then(()=>{p(!0),m.setCtxIsReady(!0),g.applyWindowResize(!1)}).catch(()=>{p(!0),m.setCtxIsReady(!0),g.applyWindowResize(!1)})},[o,e,t,r,n,s,m,g]),(0,tr.useEffect)(()=>{f.setDefaultEnabledSilentMethod(a?.defaultEnabledSilentMethod??!1),f.setSilentEnabled(a?.silentEnabled),f.setIsSaAccountNormal(l)},[a?.defaultEnabledSilentMethod,a?.silentEnabled,l,f]),(0,tr.useEffect)(()=>{y.updateEnvConfig({currentWallet:e}),f.setCurrentWallet(e)},[e,f]),{isInit:d}};var wd=({localeData:o,walletInfo:e,onBack:t,currency:r,currentWallet:n,ontCore:s,globalCtx:a,LocalStore:l,currentLocale:d,defaultChainId:p,onClose:f,chainId:m,tokenContractAddress:g,isReady:u,...T})=>{let{isInit:k}=qc({currency:r,currentWallet:n,walletInfo:e,ontCore:s,globalCtx:a,LocalStore:l,stateInfo:{defaultEnabledSilentMethod:!0,silentEnabled:!0}});return vi({defaultChainId:p,shouldFetch:!0}),ta(),je.default.createElement(ks,{fetchConfig:Ms.fetchConfig,localeData:o,isDev:!0,noRemoteData:!0,key:d},je.default.createElement(Hc,{onClose:f,isReady:k&&u,...T}))},Dd=o=>{let e=(0,je.useMemo)(()=>[Oa,Js],[]),t=(0,je.useMemo)(()=>[Wa,Ki],[]),r=(0,je.useMemo)(()=>[Bi,Fa,Pn],[]);return je.default.createElement(ln,{stores:e},je.default.createElement(ln,{stores:t,services:r},je.default.createElement(wd,{...o})))};var Nd=D(Dd);i();c();i();c();var Gc=async o=>{let{signature:e,invitationTime:t,address:r,refCode:n,signMsg:s,source:a,walletType:l,walletId:d,chainId:p,restore:f=!1,ont:m}=o,g=m||qr,u={code:n,signMsg:s,signature:e,signAddress:{[p]:r},timestamp:t,source:a,walletType:l,accountId:d,restore:f},T=new AbortController,k=await g.post(vs,u,{signal:T.signal});return{isTimeRecordError:!k||!!k?.code}};i();c();var ls=async(o,e={})=>{let{maxRetries:t=1,delay:r=0,exponentialBackoff:n=!1,onRetry:s,currentAttempt:a=0}=e;try{return await o()}catch(l){let d=a+1;if(d>t)throw l;if(s&&s(l,d),r>0){let p=n?r*2**a:r;await new Promise(f=>{setTimeout(f,p)})}return ls(o,{maxRetries:t,delay:r,exponentialBackoff:n,onRetry:s,currentAttempt:d})}};i();c();var Kc=async o=>{let e=o||qr,[t,r]=await Ne(e.get(xs));if(t)throw new Error(`Failed to get signature template: ${t.message||"Unknown error"}`);return r.data};var ds=class{constructor({ont:e,getApiHostname:t,interceptorHeaders:r,getDappStorage:n,setDappStorage:s}){this.handleRequest=async(e={})=>{let t=e;return this.interceptorHeaders&&(t=await this.interceptorHeaders(e),t.url=`https://${this.getApiHostname()}${t.url}`),y.global?.interceptorHeaders&&(t=await y.global?.interceptorHeaders(e),t.url=`https://${y.global.getApiHostname()}${t.url}`),t};this.getReferralsByAddress=async(e,t)=>this.getDappStorage({key:sn(e,t),origin:"extension"});this.ont=qs({handleRequest:this.handleRequest},e),this.getDappStorage=n,this.setDappStorage=s,this.getApiHostname=t,this.interceptorHeaders=r}async getSignSignatureMessage(){return Kc(this.ont)}async recordReferralBinding({code:e,sign:t,commissionAddress:r,discountRate:n,currentAddress:s,source:a=dr.DASHBOARD,restore:l=!1,walletId:d,chainId:p,type:f}){return ls(async()=>{let m=Date.now(),g=Hs[f]??1,u=nn(e,r),{isTimeRecordError:T}=await Gc({signMsg:u,signature:t,invitationTime:m,address:s,refCode:e,source:a,restore:l,walletType:g,walletId:d,chainId:p,ont:this.ont});return{signature:t,signTime:m,isTimeRecordError:T,referralData:{signature:t,refCode:e,discountRate:n,commissionAddress:r,invitationTime:m,isTimeRecordError:T}}},{maxRetries:1,onRetry:(m,g)=>{J.warn(`DEX_REFERRAL_TIME_RECORD_RETRY_${s}`,{error:m,code:e,attempt:g})}})}async createReferralRelationship(e,t,r,n=dr.DASHBOARD){let s=sn(e,r),a={...t,source:n,isInvalid:!1,signatureVerison:on,refId:s};return J.info(`BUSINESS_LAYER_CALLING_CREATE_${e}`,{finalData:JSON.stringify(a)}),await this.setDappStorage({key:s,value:a,origin:"extension"})}async processReferralBinding({code:e,sign:t,commissionAddress:r,discountRate:n,currentAddress:s,source:a=dr.DASHBOARD,restore:l=!1,walletId:d,chainId:p,type:f}){let m=zs(p);if(await an({address:s,chainType:m,type:f,referralInfo:{signature:t,refCode:e,commissionAddress:r,discountRate:n,signatureVerison:on}})){let{referralData:u}=await this.recordReferralBinding({code:e,sign:t,commissionAddress:r,discountRate:n,currentAddress:s,source:a,restore:l,walletId:d,chainId:p,type:f});await this.createReferralRelationship(s,u,f,a)}else throw new Error(Je.INVALID_SIGNATURE)}async verifyInvitee({code:e,currentAddress:t,allAddressMap:r,type:n}){if(!t)return{error:Je.NO_WALLET};if(!e)return{error:Je.NO_CODE};if(await this.getReferralsByAddress(t,n))return{error:Je.SWITCH_WALLET};let s=await Gs({code:e,address:t,ont:this.ont});return s?await Ks(t,s?.inviterAddresses)?{error:Je.SELF_REFERRED}:await Qs(r,this.ont)?s:{error:Je.KYS_ADDRESS}:{error:Je.REFERRAL_CODE_INVALID}}};var Od=St.default.lazy(()=>import("./Advanced-W6UNTAXW.js")),Bd=St.default.lazy(()=>import("./MemeMode-ZRYPSPKA.js")),Fd=({...o})=>St.default.createElement(Pr.Switch,null,St.default.createElement(Pr.Route,{path:"/dex-swap/meme",render:()=>St.default.createElement(Bd,{...o})}),St.default.createElement(Pr.Route,{path:"/dex-swap",render:()=>St.default.createElement(Od,{...o})}));var KM=D(Fd);export{ds as a,KM as b};
//# sourceMappingURL=chunk-MNRE2RWN.js.map
