import{a as $e,b as Re,c as et}from"./chunk-RQTEHFJ2.js";import{a as tt,d as ce}from"./chunk-X4IU7NMU.js";import{a as X}from"./chunk-GVYIP5Q5.js";import{e as Qe}from"./chunk-M43NTBTB.js";import{a as D}from"./chunk-BD5XO4WL.js";import{f as Je,o as z}from"./chunk-N6PI3XTA.js";import{a as ze,i as Y,p as le,q as We}from"./chunk-KC2XLVFC.js";import{r as Ue}from"./chunk-KGMP5AO5.js";import{d as Ze,e as de,f as me}from"./chunk-F3ILJHGP.js";import{c as u}from"./chunk-3FMJDUGT.js";import{c as Ge}from"./chunk-2O5TMJZM.js";import{K as Ke,g as Me}from"./chunk-UI4IZNSB.js";import{Pa as Ye,gb as Fe,hb as qe,ib as Xe,pb as He,wa as q,za as R}from"./chunk-EQ34WRCJ.js";import{p as o}from"./chunk-DSNMNSMD.js";import{A as je,J as te,o as ee,q as V,y as ye}from"./chunk-URGJ6D4O.js";import{a as pe}from"./chunk-IQUFNLVG.js";import{C as A,t as ue,w as Ce}from"./chunk-XYWWXNVK.js";import{a as Ne}from"./chunk-FB3ILH2L.js";import{b as O}from"./chunk-FLSAETOH.js";import{f as Ve}from"./chunk-LRIABBHT.js";import{Aa as he,g as ke,ka as De,ua as Oe}from"./chunk-4C5HF6J2.js";import{f as b,o as i,q as a}from"./chunk-UWURTNRY.js";i();a();var H=b(O());i();a();var h=b(O());he();i();a();var W={EDIT:"edit",ADD:"add"};i();a();var ot=e=>{let[t]=X({chain:e});return t?.factionType!==R&&t?.chain!==q?t?.baseChain:e},oe=()=>ze(e=>e?.factionType!==R&&e?.chain!==q?e?.baseChain:e?.chain);i();a();var F=b(O());i();a();var _e=b(O());he();var rt={[Ve.WAX]:async e=>{if(!e)return!1;let t={account:e,coinId:Ye},r;try{r=await Ke(Ge.queryAccountExist,t)}catch{ke()}return!!r?.data?.account},default:async(e,t,r)=>{let{validAddress:n}=await Me(),{isValid:s}=await n(t.valueOf(),{address:e,hrp:r});return s}};function wt(){let[e,t]=(0,_e.useState)(0),r=(0,_e.useRef)(0),n=X(),s=e>0,m=We(s,{wait:200});return{isLoading:s,isBetterLoading:m,validAddress:(d,g)=>{(async()=>{let c=++r.current,C=[];t(w=>w+1);try{await Promise.all(n.map(async({coinType:w,cosmosPrefix:k})=>{try{await(rt[w]||rt.default)(d,w,k)&&C.push(Number(w))}catch{ke()}}))}finally{c===r.current&&(t(0),g(C))}})()}}}var st=wt;var Ee={[Fe]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_evm")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_evm")}),chainKey:"wallet_extension_function_eco_evm"},[qe]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_bitcoin")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_bitcoin")}),chainKey:"wallet_extension_function_eco_bitcoin"},[Xe]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_svm")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_svm")}),chainKey:"wallet_extension_function_eco_svm"},[He]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_aptos")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_aptos")}),chainKey:"wallet_extension_function_eco_aptos"}};function kt(e,t,r,n){let s;return e?t?s=n:s=[]:s=r,s}function ht(e,t){return e.filter(({coinType:r})=>t?.includes(r))}function Nt(e){let[t,r]=tt.reduce(([n,s],m)=>{let l=s.filter(d=>d.baseChain===m);return l.length&&n.push({baseChain:m,type:"group",networks:l,groupInfo:Ee[m]}),s=s.filter(d=>d.baseChain!==m),[n,s]},[[],[...e]]);return[...t,...r]}function Ct(e,t){return!!e?.includes(t)}function yt(e){return Ze()&&e}function Et(e){let[t,r]=(0,F.useState)(null),{isLoading:n,isBetterLoading:s,validAddress:m}=st(),[l,d]=(0,F.useState)(!1),g=de(e),y=X({localType:q});(0,F.useEffect)(()=>{if(!e){r(null),d(!1);return}if(yt(g)){let k=me(e);r(null),m(k,T=>{let B=y[0]?.coinType,_=Ct(T,B);d(_)});return}m(e,k=>{r(k),d(!1)})},[e,g]);let c=X(),C=(0,F.useMemo)(()=>ht(c,t),[t]),w=(0,F.useMemo)(()=>t?Nt(C):null,[C,t]);return{isLoading:n,isBetterLoading:s,validNetworks:kt(g,l,w,y)}}var nt=Et;i();a();var it=(0,h.createContext)(null),E=()=>{let e=(0,h.useContext)(it);if(!e)throw new Error("useAddressEditContext must be used within an AddressEditProvider");return e},Tt=({type:e,data:t,onClose:r,onDelete:n,onChangeToEdit:s,children:m})=>{let l=e===W.EDIT,[d,g]=(0,h.useState)("address"),[y,c]=(0,h.useState)("address"),[C,w]=(0,h.useState)({}),[k,T]=(0,h.useState)({}),[B,_]=(0,h.useState)(""),[S,M]=(0,h.useState)(""),[K,L]=(0,h.useState)(""),[ne,we]=(0,h.useState)(""),[ie,Q]=(0,h.useState)([]),{id:ae,address:v,network:U}=t||{},$=ot(U),Ie=ce(v);Y(()=>{if(l&&Ie){let{name:ft,networks:gt}=Ie,xt=Oe([...gt,$].filter(Boolean));_(ft),L(v||""),Q(xt)}else Q($?[$]:[]),L(v||""),_("")});let{isLoading:Se,isBetterLoading:Pe,validNetworks:Le}=nt(K),_t=(0,h.useMemo)(()=>({id:ae,isEdit:l,step:d,setStep:g,prevStep:y,setPrevStep:c,dialogProps:C,setDialogProps:w,groupChain:k,setGroupChain:T,type:e,data:t,selectedNetworks:ie,setSelectedNetworks:Q,isLoading:Se,isBetterLoading:Pe,validNetworks:Le,onChangeToEdit:s,onClose:r,onDelete:n,nameInputValue:B,nameInputError:S,setNameInputValue:_,setNameInputError:M,addressInputValue:K,addressInputError:ne,setAddressInputValue:L,setAddressInputError:we}),[ne,K,t,C,k,ae,Pe,l,Se,S,B,s,r,n,ie,d,y,e,Le]);return h.default.createElement(it.Provider,{value:_t},m)},at=Tt;i();a();var I=b(O());he();i();a();var G=b(O());i();a();var ge={root:"_root_7l4sg_1",error:"_error_7l4sg_1",action:"_action_7l4sg_9"};var At=()=>{let e=E(),{data:t,isEdit:r,isLoading:n,validNetworks:s,onChangeToEdit:m,isBetterLoading:l,addressInputValue:d,addressInputError:g,setSelectedNetworks:y,setAddressInputValue:c,setAddressInputError:C}=e,{id:w,address:k}=t||{},T=ce(d),B=!!T?.id&&(!r||T?.id!==w),_=(0,G.useRef)(!1),S=g&&_.current?g:"",{run:M}=le(async()=>{let L="";d&&s&&!s.length&&(L=o("wallet_extension_addaddress_errortip_wrong_address")),B&&(L=o("wallet_extension_addaddress_errortip_address_exists")),_.current=!0,C(L)},{wait:50}),K=L=>{c(L.target.value),y([])};return(0,G.useEffect)(()=>{M()},[s]),G.default.createElement(u.Box,{className:ge.root},G.default.createElement(V.TextArea,{autoResize:!0,size:V.SIZE.xl,onChange:K,value:d,error:!n&&!!S,errorType:V.TIP_TYPE.always,disabled:!!(!r&&k),"data-testid":D.ADDRESS_BOOK.ADDRESS_INPUT,label:o("wallet_extension_addaddress_subtitle_address"),placeholder:o("wallet_extension_addaddress_input_enter_address"),suffix:l&&G.default.createElement(Ce.Circle,{size:Ce.SIZE.sm})}),!n&&!!S&&G.default.createElement("div",{className:ge.error},S,B&&G.default.createElement("span",{className:ge.action,onClick:()=>{m(T)}},o("wallet_extension_addaddress_anchor_go_to_edit"))))},lt=At;i();a();var N=b(O()),Te=b(Ne());i();a();var Z=b(O()),dt=b(Ne());i();a();var re={root:"_root_8gl1e_1",imageUrl:"_imageUrl_8gl1e_5",more:"_more_8gl1e_14"};var Bt=({networks:e,maxCount:t})=>{let{setGroupChain:r,setStep:n,step:s,setPrevStep:m}=E();return e.length<=t?null:Z.default.createElement(je,{noWrapper:!0,title:o("wallet_extension_function_bttmsheet_textbtn_show_all")},Z.default.createElement(ue,{onClick:l=>{l.stopPropagation(),m(s),r({networks:e}),n("chainList")},className:(0,dt.default)("okx-wallet-plugin-more",re.imageUrl,re.more)}))},vt=({networks:e,maxCount:t=5})=>{let r=e.slice(0,t).map(({imageUrl:n})=>n);return Z.default.createElement("div",{className:re.root},r.map(n=>Z.default.createElement("img",{alt:"",key:n,src:n,className:re.imageUrl})),Z.default.createElement(Bt,{networks:e,maxCount:t}))},xe=vt;i();a();var P={root:"_root_10afq_1",title:"_title_10afq_6",line:"_line_10afq_12",canClick:"_canClick_10afq_20",placeholder:"_placeholder_10afq_23",mainContent:"_mainContent_10afq_28",img:"_img_10afq_32",chainName:"_chainName_10afq_37",arrow:"_arrow_10afq_43",extText:"_extText_10afq_46"};var bt=({selectedNetworks:e})=>{if(e.length===1){let{imageUrl:t,chainName:r}=e[0]||{};return N.default.createElement(u.Box,{className:P.mainContent},N.default.createElement("img",{className:P.img,src:t,alt:""}),N.default.createElement(u.Box,{className:P.chainName},r))}return N.default.createElement(u.Box,{className:P.mainContent},N.default.createElement(xe,{networks:e}))},It=({selectedNetworks:e,flattenSelectedNetworks:t})=>{if(e.length===0||t.length===1)return null;let r="",n=Ee[e[0]];return e.length===1&&n?r=n.groupName:t.length===2?r=o("wallet_extension_function_title_network1_and_network2",{network1:t[0]?.chainName,network2:t[1]?.chainName}):r=o("wallet_extension_function_title_network_and_other_networks",{network:t[0]?.chainName}),N.default.createElement(z.Text,{className:P.extText},r)};function Ae(){let{validNetworks:e,selectedNetworks:t,setSelectedNetworks:r,setStep:n}=E(),s=oe(),m=(0,N.useMemo)(()=>t.reduce((d,g)=>{let y=e.filter(c=>s(c)===g).map(c=>c.type==="group"?c.networks:c).flat();return[...d,...y]},[]),[t,e,s]);(0,N.useEffect)(()=>{if(t?.length===0&&e?.length===1){let d=e[0];d.factionType===R||d.chain===q?r([d.chain]):r([d.baseChain])}},[e,r,t]);let l=e.length>1;return N.default.createElement(u.Box,{className:P.root},N.default.createElement(u.Box,{className:P.title},o("wallet_extension_addressbook_title_select_networks")),N.default.createElement(u.Box,{className:(0,Te.default)(P.line,{[P.canClick]:l}),"data-testid":D.ADDRESS_BOOK.NETWORK_INPUT,onClick:()=>{l&&n("network")}},m.length>0?N.default.createElement(bt,{selectedNetworks:m}):N.default.createElement(u.Box,{className:P.placeholder},o("commonall_title_placeholder_select_network")),l&&N.default.createElement(ue,{className:(0,Te.default)("okds-arrow-chevron-right-centered-md",P.arrow)})),N.default.createElement(It,{selectedNetworks:t,flattenSelectedNetworks:m}))}i();a();var se={root:"_root_1mc1y_1",main:"_main_1mc1y_6",footerAction:"_footerAction_1mc1y_13",deleteButton:"_deleteButton_1mc1y_18"};var St=()=>{let e=E(),{onClose:t,onDelete:r,isLoading:n,nameInputValue:s,nameInputError:m,setNameInputValue:l,setNameInputError:d,validNetworks:g,type:y,id:c,isEdit:C,selectedNetworks:w,addressInputValue:k,addressInputError:T,setDialogProps:B}=e,_=(0,I.useRef)(null),[S,M]=(0,I.useState)(!1),{run:K}=le(()=>{M(!0),De(s)>20?d(o("wallet_extension_addaddress_errortip_maximum_20")):d("")},{wait:50}),L=v=>{l(v.target.value),K()},ne=k||s||w.length,we=()=>{if(!C&&ne){let v=ee.warn({maskClassName:"edit-address-confirm-dialog",title:o("wallet_extension_addaddress_modal_cancel_adding"),alignBottom:!1,cancelText:o("wallet_extension_addaddress_btn_no"),confirmText:o("wallet_extension_addaddress_btn_yes"),onCancel:()=>{v.destroy()},onConfirm:async()=>{t()}})}else t()},ie=s===""||m!==""||k===""||T!==""||!w.length||n,Q=async v=>{v.stopPropagation();let U={address:me(k),name:s,networks:w,isXKOAddress:de(k)};if(C&&c)await Re(c,U),te.success({title:o("wallet_extension_editaddress_toast_edit_saved")}),t(U);else try{await $e(U),te.success({title:o("wallet_extension_addressbook_toast_address_added")}),t(U)}catch($){$?.message===Ue&&te.error({title:o("wallet_extension_addressbook_toast_address_limit_reached")})}},ae=()=>{let v=ee.warn({title:o("wallet_extension_editaddress_modal_detele_address"),alignBottom:!1,cancelText:o("wallet_extension_editaddress_btn_cancel"),confirmText:o("wallet_extension_editaddress_btn_detele"),onCancel:()=>{v.destroy()},onConfirm:async()=>{await et(c),te.success({title:o("wallet_extension_addressbook_toast_address_deleted")}),r&&r(),t()}})};return Y(()=>{B({title:o(C?"wallet_extension_editaddress_title_edit_address":"wallet_extension_addaddress_title_add_address"),onClose:we,showBackBtn:!1,hideCloseBtn:!1}),_.current?.focus()}),I.default.createElement(u.Box,{className:se.root},I.default.createElement(u.Box,{className:se.main},I.default.createElement(V,{"data-testid":D.ADDRESS_BOOK.NAME_INPUT,placeholder:o("wallet_extension_addaddress_input_enter_name_limit"),label:o("wallet_extension_addaddress_subtitle_name"),value:s,error:S&&m,errorType:V.TIP_TYPE.always,size:V.SIZE.xl,onChange:L,maxLength:30,onRef:v=>{_.current=v}}),I.default.createElement(lt,null),!!g?.length&&!T&&I.default.createElement(Ae,null)),I.default.createElement(u.Box,{className:se.footerAction},y===W.EDIT&&I.default.createElement(A,{className:se.deleteButton,category:A.CATEGORY.fill,type:A.TYPE.gray,size:A.SIZE.lg,onClick:ae},o("commonall_resultpage_btn_delete")),I.default.createElement(A,{"data-testid":D.ADDRESS_BOOK.ADD_BUTTON,disabled:ie,category:A.CATEGORY.fill,type:A.TYPE.highlight,size:A.SIZE.lg,onClick:Q,block:!0},o("wallet_set_password_btn_confirm"))))},mt=St;i();a();var J=b(O());i();a();var j={root:"_root_1qe4o_1",networkList:"_networkList_1qe4o_5",network:"_network_1qe4o_5",logo:"_logo_1qe4o_14",name:"_name_1qe4o_19"};var Pt=({scrollBoxHeight:e})=>{let{setDialogProps:t,setStep:r,groupChain:n,prevStep:s}=E();return Y(()=>{t({title:n?.groupInfo?.groupName||o("wallet_extension_function_bttmsheet_textbtn_show_all"),onBack(){r(s)},hideCloseBtn:!0,showBackBtn:!0})}),J.default.createElement(u.Box,{className:j.root},J.default.createElement(Qe,{virtualable:!0,height:e,className:j.networkList,dataSource:n.networks||[],renderItem:m=>J.default.createElement(u.Box,{className:j.network},J.default.createElement(pe,{src:m.imageUrl,className:j.logo}),J.default.createElement(z.Text,{className:j.name,ellipsis:{tooltip:!0}},m.chainName))}))},ut=Pt;i();a();var p=b(O());var ve=b(Ne());i();a();var f={root:"_root_cv1p1_1",main:"_main_cv1p1_6",search:"_search_cv1p1_14",networkList:"_networkList_cv1p1_21",groupNetwork:"_groupNetwork_cv1p1_28",active:"_active_cv1p1_34",groupTitle:"_groupTitle_cv1p1_37",chainsTip:"_chainsTip_cv1p1_44",matchedChainNames:"_matchedChainNames_cv1p1_50",extInfo:"_extInfo_cv1p1_53",seeAll:"_seeAll_cv1p1_57",text:"_text_cv1p1_63",icon:"_icon_cv1p1_67",singleNetwork:"_singleNetwork_cv1p1_71",logo:"_logo_cv1p1_83",name:"_name_cv1p1_88",empty:"_empty_cv1p1_95",footerAction:"_footerAction_cv1p1_98"};var Be=(e=[],t="")=>t?e.filter(({chainName:r})=>r?.toLowerCase().includes(t.toLowerCase())):e,Lt=({search:e,networks:t,tempNetworks:r,updateTempNetworks:n})=>{let{setStep:s,setGroupChain:m}=E();return t.map(l=>{let d=Be(l?.networks,e);if(!d.length)return null;let g=o("wallet_extension_function_bttmsheet_label_num_chain_networks",{num:l.networks.length,chain:o(l.groupInfo.chainKey)});if(e){let y=d.map(({chainName:c})=>c).join(o("extension_wallet_text_punctuation_mark"));g=o("wallet_extension_function_bttmsheet_label_networks_num_chain",{networks:p.default.createElement("span",{className:f.matchedChainNames},y),num:l.networks.length,chain:o(l.groupInfo.chainKey)})}return p.default.createElement(u.Box,{key:l.baseChain,"data-testid":D.ADDRESS_BOOK.NETWORK_ITEM,onClick:()=>{n(l)},className:(0,ve.default)(f.groupNetwork,{[f.active]:r.includes(l.baseChain)})},p.default.createElement(u.Box,{className:f.groupTitle},l.groupInfo.groupTitle),p.default.createElement(u.Box,{className:f.chainsTip},g),p.default.createElement(u.Box,{className:f.extInfo},p.default.createElement(u.Box,{className:f.chainLogos},p.default.createElement(xe,{maxCount:3,networks:l.networks||[]})),p.default.createElement(u.Box,{className:f.seeAll,onClick:()=>{m(l),s("chainList")}},p.default.createElement("span",{className:f.text},o("wallet_extension_function_bttmsheet_textbtn_show_all")),p.default.createElement(Je,{className:f.icon,icon:"okx-wallet-plugin-right"}))))})},Dt=({networks:e,tempNetworks:t,updateTempNetworks:r})=>{let n=oe();return e.map(s=>p.default.createElement(u.Box,{key:s.baseChain,"data-testid":D.ADDRESS_BOOK.NETWORK_ITEM,onClick:()=>{r(s)},className:(0,ve.default)(f.singleNetwork,{[f.active]:t.includes(n(s))})},p.default.createElement(pe,{src:s.imageUrl,className:f.logo}),p.default.createElement(z.Text,{className:f.name,ellipsis:{tooltip:!0}},s.chainName)))},Ot=()=>{let[e,t]=(0,p.useState)(""),{selectedNetworks:r,setStep:n,setDialogProps:s,setSelectedNetworks:m,validNetworks:l}=E(),[d,g]=(0,p.useState)(r),y=oe(),c=_=>{g(S=>{let M=y(_);return S.includes(M)?S.filter(K=>K!==M):[...S,M]})},C=(l||[]).filter(_=>_.type==="group"),w=C.filter(_=>!!Be(_.networks,e).length).length,k=Be((l||[]).filter(_=>_.type!=="group"),e),T=k.length,B=w>0||T>0;return Y(()=>{s({title:o("wallet_extension_addressbook_title_select_networks"),showBackBtn:!0,hideCloseBtn:!0,onBack(){n("address")}})}),p.default.createElement(u.Box,{className:f.root},p.default.createElement(u.Box,{className:f.main},p.default.createElement(u.Box,{className:f.search},p.default.createElement(V.Search,{value:e,onChange:_=>t(_.target.value.trim()),placeholder:o("extension_wallet_network_input_search_network")})),w>0?p.default.createElement(Lt,{search:e,networks:C,tempNetworks:d,updateTempNetworks:c}):null,T>0?p.default.createElement(Dt,{networks:k,tempNetworks:d,updateTempNetworks:c}):null,B?null:p.default.createElement(ye.State,{className:f.empty,type:ye.State.TYPE.noResult,title:o("wallet_search_text_search_no_results")})),B?p.default.createElement(u.Box,{className:f.footerAction},p.default.createElement(A,{block:!0,size:A.SIZE.lg,type:A.TYPE.highlight,category:A.CATEGORY.fill,disabled:!d.length,onClick:()=>{m(d),n("address")},"data-testid":D.ADDRESS_BOOK.NETWORK_CONFIRM},o("wallet_set_password_btn_confirm"))):null)},pt=Ot;i();a();var be={container:"_container_cya5b_1",scrollBox:"_scrollBox_cya5b_6"};var Vt={["address"]:mt,["network"]:pt,["chainList"]:ut},Gt=()=>{let e=E(),{step:t,dialogProps:r}=e,[n,s]=(0,H.useState)(null),m=n?.clientHeight,l=Vt[t];return H.default.createElement(ee.Action,{isFull:!0,visible:!0,noContentPadding:!0,scrollBoxRef:s,containerClassName:be.container,scrollBoxClassName:be.scrollBox,...r},H.default.createElement(l,{scrollBoxHeight:m}))};function ct(e){let{visible:t,...r}=e;return t?H.default.createElement(at,{...r},H.default.createElement(Gt,null)):null}ct.TYPE=W;export{ct as a};
//# sourceMappingURL=chunk-L5IAYR5L.js.map
