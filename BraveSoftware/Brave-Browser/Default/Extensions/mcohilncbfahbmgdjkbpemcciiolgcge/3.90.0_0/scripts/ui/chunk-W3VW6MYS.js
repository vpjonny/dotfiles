import{o as P}from"./chunk-NS5EW6UN.js";import{G as c}from"./chunk-3F7OC7N7.js";import{a as f,b as C,g as F,v as g}from"./chunk-EPDR6VAQ.js";import{y as _}from"./chunk-EQ34WRCJ.js";import{a as m}from"./chunk-I2AEM4CA.js";import{f as S,i as b,u as R,w as A}from"./chunk-TR37MFB4.js";import{f as I,o as s,p as T,q as i}from"./chunk-UWURTNRY.js";s();i();var M={CANCEL:"cancel",RETRY:"retry",TOKEN_METHOD_TRANSFER:"transfer",TOKEN_METHOD_TRANSFER_FROM:"transferfrom",TOKEN_METHOD_APPROVE:"approve",TOKEN_METHOD_INCREASE_ALLOWANCE:"increaseAllowance",INCOMING:"incoming",SENT_ETHER:"sentEther",CONTRACT_INTERACTION:"contractInteraction",DEPLOY_CONTRACT:"contractDeployment",SWAP:"swap",SWAP_APPROVAL:"swapApproval",SIGN:_.ETH_SIGN,SIGN_TYPED_DATA:_.ETH_SIGN_TYPED_DATA,PERSONAL_SIGN:_.PERSONAL_SIGN,ETH_DECRYPT:_.ETH_DECRYPT,ETH_GET_ENCRYPTION_PUBLIC_KEY:_.ETH_GET_ENCRYPTION_PUBLIC_KEY,EIP_5792:"eip5792"},t={UNAPPROVED:"unapproved",APPROVED:"approved",REJECTED:"rejected",SIGNED:"signed",SUBMITTED:"submitted",FAILED:"failed",DROPPED:"dropped",CONFIRMED:"confirmed",PKGING:"PKGING",CONFIRMING:"CONFIRMING",ERROR:"ERROR",SUCCESS:"SUCCESS"};var d={SEND:"send",RECEIVE:"receive",INTERACTION:"interaction",APPROVAL:"approval",SIGNATURE_REQUEST:"signature-request",SWAP:"swap"},V=[null,d.RECEIVE,d.SEND,d.INTERACTION,d.APPROVAL],B=[null,t.PKGING,t.CONFIRMING,t.ERROR,t.SUCCESS],L={[t.UNAPPROVED]:!0,[t.APPROVED]:!0,[t.SUBMITTED]:!0,[t.PKGING]:!0,[t.CONFIRMING]:!0},k={[t.FAILED]:!0,[t.DROPPED]:!0,[t.REJECTED]:!0,[t.ERROR]:!0},X={[t.SUCCESS]:!0,[t.CONFIRMED]:!0},v={...L,[t.CONFIRMED]:!0},W={[M.TOKEN_METHOD_APPROVE]:!0,[M.TOKEN_METHOD_TRANSFER]:!0,[M.TOKEN_METHOD_TRANSFER_FROM]:!0},q={CARRY_ALL_REMAINING_BALANCE:128,CARRY_ALL_REMAINING_INCOMING_VALUE:64,DESTROY_ACCOUNT_IF_ZERO:32,PAY_GAS_SEPARATELY:1,IGNORE_ERRORS:2,NONE:0},J={TON_ADDR:"ton_addr",TON_PROOF:"ton_proof"},Q={MAINNET:"-239",TESTNET:"-3"},Z={UNKNOWN_ERROR:0,BAD_REQUEST_ERROR:1,MANIFEST_NOT_FOUND_ERROR:2,MANIFEST_CONTENT_ERROR:3,UNKNOWN_APP_ERROR:100,USER_REJECTS_ERROR:300,METHOD_NOT_SUPPORTED:400},D={Transaction:"legacy",VersionedTransaction:0},j={EIP_5792:"EVM_OKX7702WALLET_EXECUTEFROMSELF"},$={TX:"tx"},ee="wallet_inner_transfer",ne="wallet_x402_transfer";s();i();var z=I(m());s();i();var x=I(m());var y=(e,n="base58")=>n==="base58"?x.default.encode(e):T.Buffer.from(e).toString("base64"),U=(e,n="base58")=>n==="base58"?x.default.decode(e):T.Buffer.from(e,"base64");var G=(e,n=c.TRANSACTION,r="base58")=>{let a=n===c.TRANSACTION?e.serialize({requireAllSignatures:!1,verifySignatures:!1}):e.serialize();return y(a,r)},_e=(e,n,r="base58")=>{let a=U(e,r);if(n)return n===c.TRANSACTION?R.from(a):A.deserialize(a);try{return R.from(a)}catch{return A.deserialize(a)}},w=e=>{switch(e?.version){case D.Transaction:case D.VersionedTransaction:return c.VERSIONED_TRANSACTION;default:return c.TRANSACTION}};var Ne=e=>e?new S(e):null,Se=(e,n)=>({publicKey:e,signature:z.default.decode(n)}),Re=(e,n="base58")=>(n==="base58"?z.default.decode(e):T.Buffer.from(e,"base64")).length>b;s();i();var E=I(m());function h(e,n){return g(C(f(n||"0",e||"0"),10**6),0)}function Pe(e,n="0",r="0"){let a=h(n,r);if(!e||F(a,e))return{priorityFee:a,priorityGasPrice:n,priorityGasLimit:r};let l=g(C(f(e,10**6),r),0);return{priorityFee:h(l,r),priorityGasPrice:l,priorityGasLimit:r}}var me=async({coinId:e,fromAddress:n,instanceType:r,serializedMessage:a,needToReplaceRecentBlockhash:l,onSign:K})=>{let N="",o,p="";if(r===c.TRANSACTION){if(o=R.from(E.default.decode(a)),l){let u=await P({coinId:e,fromAddr:n});o.recentBlockhash=u}let O=E.default.encode(o.serializeMessage());N=await K({finalizedMessage:O}),o.addSignature(new S(n),E.default.decode(N)),p=G(o,r)}else{o=A.deserialize(E.default.decode(a));let O=o.message;if(l){let H=await P({coinId:e,fromAddr:n});O.recentBlockhash=H}let u=E.default.encode(O.serialize());N=await K({finalizedMessage:u}),o.addSignature(new S(n),E.default.decode(N)),p=G(o,r)}return{signature:N,tx:o,serializedTransaction:p,type:r}};export{M as a,q as b,J as c,Q as d,Z as e,j as f,$ as g,ee as h,ne as i,G as j,_e as k,w as l,Ne as m,Se as n,Re as o,h as p,Pe as q,me as r};
//# sourceMappingURL=chunk-W3VW6MYS.js.map
