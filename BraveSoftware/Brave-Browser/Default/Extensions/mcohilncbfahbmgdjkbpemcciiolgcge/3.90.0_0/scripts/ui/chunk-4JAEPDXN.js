import{a as L}from"./chunk-YKQL2NOR.js";import{a as F}from"./chunk-7LMS53CN.js";import{b as D}from"./chunk-U44ZBWPF.js";import{a as N}from"./chunk-MEZ72IGZ.js";import{b as I,c as A}from"./chunk-NS5EW6UN.js";import{a as k}from"./chunk-XBUPORYF.js";import{Ea as C}from"./chunk-QF42JCDG.js";import{c as S}from"./chunk-EAE2NUFS.js";import{c as w,p}from"./chunk-3F7OC7N7.js";import{Qa as c,pa as f}from"./chunk-EQ34WRCJ.js";import{p as i}from"./chunk-DSNMNSMD.js";import{a as v}from"./chunk-DOSBJ3L3.js";import{I as T,o as E}from"./chunk-URGJ6D4O.js";import{b}from"./chunk-FLSAETOH.js";import{Aa as B,Q as R}from"./chunk-4C5HF6J2.js";import{f as x,o as y,q as h}from"./chunk-UWURTNRY.js";y();h();var _=x(b()),P=x(v());B();var G=({address:r,targetCoinId:a,registerPath:o})=>{let u=(0,P.useHistory)(),g=D();return async({coinId:e})=>{let{coin:t,baseCoin:n}=await g(e,!0);if(![String(e),String(n.coinId)].includes(String(a)))return!0;try{let{status:s}=await N({chainId:t.chainId,address:r});if(s===p.NOT_STARTED){let l=E.warn({title:i("wallet_dialog_modal_not_registered"),text:i("wallet_dialog_modal_register_before_using"),confirmText:i("wallet_dialog_modal_registerbtn"),cancelText:i("wallet_dialog_modal_backbtn"),alignBottom:!1,onConfirm:()=>{l.destroy(),u.push(o)},onCancel:()=>{l.destroy()}});return!1}if(s===p.PROCESSING)return T.warn({title:i("wallet_extension_transaction_notif_address_registering",{net:t.chainName})}),!1}catch(s){let l=s?.error_message||i("wallet_extension_transaction_notif_address_register_fail",{net:t.chainName});return T.error(l),!1}return!0}},$=()=>{let r=k(f);return G({address:r,targetCoinId:c,registerPath:C})},tt=r=>{let[a,o]=(0,_.useState)({isLoading:!0,isError:!1,nonce:"0",gasFee:{overallFee:"0"}}),u=async()=>(await I({coinId:c,fromAddr:r,toAddr:""}))?.info?.nonce,g=async e=>{let t={type:"deploy_account",nonce:e};return(await S().signTransaction(t,r,f))?.signature},m=async e=>{let{data:t={}}=await A({coinId:c,address:r,inputData:e});return t};return(0,_.useEffect)(()=>{(async()=>{try{let t=await u();if(R(t)){o(s=>({...s,isLoading:!1,isError:!0}));return}let n=await g(t),d=await m(n);o(s=>({...s,isLoading:!1,isError:!1,nonce:t,gasFee:{...d,resourceBounds:F(d)}}))}catch{o(n=>({...n,isLoading:!1,isError:!0}))}})()},[]),a},et=({nonce:r,gasFee:a,address:o})=>{let u=L();return async()=>{let m={type:"deploy_account",nonce:r,resourceBounds:a?.resourceBounds},e=await S().signTransaction(m,o,f),t={type:"AccountActive",serviceChargeCoinId:c,nonce:r},n={signedTx:e?.signature,fromAdr:o,serviceCharge:a?.overallFee,toAdr:o,coinAmount:"0",coinId:c,txHash:e?.txId,txType:w.REGISTRATION,extJson:JSON.stringify(t)};return await u(n)}};export{$ as a,tt as b,et as c};
//# sourceMappingURL=chunk-4JAEPDXN.js.map
