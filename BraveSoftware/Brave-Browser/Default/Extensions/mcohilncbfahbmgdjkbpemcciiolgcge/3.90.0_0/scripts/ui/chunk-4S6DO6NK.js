import{A as er,B as or,u as rr}from"./chunk-UL6IEE2K.js";import{e as w}from"./chunk-4ARIYUS3.js";import{c as d,f as j,n as process,o as a,p as c,q as f}from"./chunk-UWURTNRY.js";var y=d((wr,D)=>{a();f();var nr=Math.pow(2,30)-1;D.exports=function(r,e){if(typeof r!="number")throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if(typeof e!="number")throw new TypeError("Key length not a number");if(e<0||e>nr||e!==e)throw new TypeError("Bad key length")}});var E=d((qr,K)=>{a();f();var b;globalThis.process&&globalThis.process.browser?b="utf-8":globalThis.process&&globalThis.process.version?(I=parseInt(process.version.split(".")[0].slice(1),10),b=I>=6?"utf-8":"binary"):b="utf-8";var I;K.exports=b});var A=d((Hr,F)=>{a();f();var q=w().Buffer;F.exports=function(r,e,t){if(q.isBuffer(r))return r;if(typeof r=="string")return q.from(r,e);if(ArrayBuffer.isView(r))return q.from(r.buffer);throw new TypeError(t+" must be a string, a Buffer, a typed array or a DataView")}});var P=d((zr,M)=>{a();f();var ur=or(),ar=rr(),fr=er(),m=w().Buffer,ir=y(),R=E(),U=A(),sr=m.alloc(128),_={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function L(r,e,t){var n=cr(r),o=r==="sha512"||r==="sha384"?128:64;e.length>o?e=n(e):e.length<o&&(e=m.concat([e,sr],o));for(var u=m.allocUnsafe(o+_[r]),s=m.allocUnsafe(o+_[r]),i=0;i<o;i++)u[i]=e[i]^54,s[i]=e[i]^92;var h=m.allocUnsafe(o+t+4);u.copy(h,0,0,o),this.ipad1=h,this.ipad2=u,this.opad=s,this.alg=r,this.blocksize=o,this.hash=n,this.size=_[r]}L.prototype.run=function(r,e){r.copy(e,this.blocksize);var t=this.hash(e);return t.copy(this.opad,this.blocksize),this.hash(this.opad)};function cr(r){function e(n){return fr(r).update(n).digest()}function t(n){return new ar().update(n).digest()}return r==="rmd160"||r==="ripemd160"?t:r==="md5"?ur:e}function hr(r,e,t,n,o){ir(t,n),r=U(r,R,"Password"),e=U(e,R,"Salt"),o=o||"sha1";var u=new L(o,r,e.length),s=m.allocUnsafe(n),i=m.allocUnsafe(e.length+4);e.copy(i,0,0,e.length);for(var h=0,x=_[o],Y=Math.ceil(n/x),g=1;g<=Y;g++){i.writeUInt32BE(g,e.length);for(var B=u.run(i,u.ipad1),C=B,z=1;z<t;z++){C=u.run(C,u.ipad2);for(var v=0;v<x;v++)B[v]^=C[v]}B.copy(s,h),h+=x}return s}M.exports=hr});var J=d((Kr,G)=>{a();f();var X=w().Buffer,mr=y(),N=E(),O=P(),Z=A(),S,p=globalThis.crypto&&globalThis.crypto.subtle,lr={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},H=[];function dr(r){if(globalThis.process&&!globalThis.process.browser||!p||!p.importKey||!p.deriveBits)return Promise.resolve(!1);if(H[r]!==void 0)return H[r];S=S||X.alloc(8);var e=$(S,S,10,128,r).then(function(){return!0}).catch(function(){return!1});return H[r]=e,e}var l;function T(){return l||(globalThis.process&&globalThis.process.nextTick?l=globalThis.process.nextTick:globalThis.queueMicrotask?l=globalThis.queueMicrotask:globalThis.setImmediate?l=globalThis.setImmediate:l=globalThis.setTimeout,l)}function $(r,e,t,n,o){return p.importKey("raw",r,{name:"PBKDF2"},!1,["deriveBits"]).then(function(u){return p.deriveBits({name:"PBKDF2",salt:e,iterations:t,hash:{name:o}},u,n<<3)}).then(function(u){return X.from(u)})}function pr(r,e){r.then(function(t){T()(function(){e(null,t)})},function(t){T()(function(){e(t)})})}G.exports=function(r,e,t,n,o,u){typeof o=="function"&&(u=o,o=void 0),o=o||"sha1";var s=lr[o.toLowerCase()];if(!s||typeof globalThis.Promise!="function"){T()(function(){var i;try{i=O(r,e,t,n,o)}catch(h){return u(h)}u(null,i)});return}if(mr(t,n),r=Z(r,N,"Password"),e=Z(e,N,"Salt"),typeof u!="function")throw new Error("No callback provided to pbkdf2");pr(dr(s).then(function(i){return i?$(r,e,t,n,s):O(r,e,t,n,o)}),u)}});var Q=d(k=>{a();f();k.pbkdf2=J();k.pbkdf2Sync=P()});a();f();var br={PRE_TRADE:80001};a();f();function tr(r){return r.then(e=>[null,e.data]).catch(e=>[e])}a();f();var W=j(Q());function V(r){return(r||"").normalize("NFKD")}function vr(r){return`mnemonic${r||""}`}var Nr=(r,e)=>{let t=c.Buffer.from(V(r),"utf8"),n=c.Buffer.from(vr(V(e)),"utf8");return W.default.pbkdf2Sync(t,n,2048,64,"sha512")};export{br as a,tr as b,Nr as c};
//# sourceMappingURL=chunk-4S6DO6NK.js.map
