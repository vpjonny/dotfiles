import{Ea as b}from"./chunk-P5GHREX3.js";import{Ae as R,F as m,c as i,d as f,k as c}from"./chunk-RPH2MNBW.js";import{o as u,q as a}from"./chunk-UWURTNRY.js";u();a();var s=class{constructor(){this.unbindRefCodeList=[];this.unbindRefCodeInfoMap={};this.fetchRefInfo=async(n,o)=>{let[d,r]=await m(b.get(R,{params:{code:n,ipCheck:!0}}));if(d)return null;let{data:e}=r||{},{discountRate:t,discountRateThreshold:l,inviterAddresses:h}=e||{},C=(h||[])?.some(p=>p.address===o);return e&&t>=l&&!C?{...e,code:n}:null};this.fetchUnbindRefInfoList=async(n,o)=>{let r=(await Promise.all(n.map(async e=>this.fetchRefInfo(e.code,o)))).filter(e=>!!e);return this.unbindRefCodeInfoMap=r.reduce((e,t)=>(t&&(e[t.code]=t),e),{}),this.unbindRefCodeList=r.map(({code:e},t)=>({code:e,from:n[t].from})),{validRefInfoList:r}};this.clearRefInfo=n=>{n?(this.unbindRefCodeList=this.unbindRefCodeList.filter(o=>o.code!==n),this.unbindRefCodeInfoMap[n]=null):(this.unbindRefCodeList=[],this.unbindRefCodeInfoMap={})};c(this,{unbindRefCodeList:i,unbindRefCodeInfoMap:i,refCode:f,refInfo:f})}get refCode(){return this.unbindRefCodeList?.[0]?.code||""}get refCodeFrom(){return this.unbindRefCodeList?.[0]?.from||""}get refInfo(){return this.unbindRefCodeInfoMap?.[this.refCode]||null}},U=new s;export{U as a};
//# sourceMappingURL=chunk-PPNQSDGF.js.map
