import{a as vt}from"./chunk-4KTJXCJI.js";import{a as Ue}from"./chunk-XEYCZGG6.js";import{a as Dt}from"./chunk-2KBIS3G2.js";import{b as qt}from"./chunk-6SGNZGRT.js";import{a as Rt,b as Et}from"./chunk-AI4OWM3D.js";import{a as xe}from"./chunk-42JHCNWD.js";import{a as Le}from"./chunk-X2JMOXWP.js";import"./chunk-T2UFMQPE.js";import{a as L}from"./chunk-X7JU5VY4.js";import{a as R}from"./chunk-M2YFVDKX.js";import{a as xt,b as At}from"./chunk-EZ3BUTHE.js";import{a as It}from"./chunk-LHFDZX73.js";import{a as ae}from"./chunk-B4MQLH4C.js";import"./chunk-VWVRJUMU.js";import{a as bt}from"./chunk-ZFAUEPQW.js";import{a as Mt}from"./chunk-GMVPA3MX.js";import{b as Ie}from"./chunk-P355XBV4.js";import{a as St}from"./chunk-A7EUFORV.js";import{a as ie}from"./chunk-QEPQGEPL.js";import{l as A}from"./chunk-V7YATDMZ.js";import{e as kt}from"./chunk-YRQLRR65.js";import{a as wt}from"./chunk-E4CKCWHV.js";import"./chunk-66RCYZEO.js";import"./chunk-BIUKJDG5.js";import"./chunk-MNRE2RWN.js";import"./chunk-S63SUKPS.js";import"./chunk-QR6SNDPA.js";import"./chunk-DB7NVRTE.js";import"./chunk-EF6FTTLT.js";import"./chunk-U44ZBWPF.js";import"./chunk-UX2JFEX5.js";import{i as ht,k as Pt}from"./chunk-XHRUTTJG.js";import"./chunk-OS6U6P6N.js";import"./chunk-PLVYKYSQ.js";import"./chunk-MEZ72IGZ.js";import"./chunk-ZLTTBRML.js";import"./chunk-XUGHAFHG.js";import"./chunk-B5L26Z2J.js";import{d as Tt}from"./chunk-AVG63QW4.js";import"./chunk-YLT6ZRGE.js";import"./chunk-VSNCKUAC.js";import"./chunk-OB65JCC3.js";import"./chunk-ZWKYYPCG.js";import"./chunk-YLPOVMK6.js";import"./chunk-CAWXATKV.js";import"./chunk-GIKT3XNH.js";import"./chunk-4VAKOKZO.js";import"./chunk-F43OFDEC.js";import"./chunk-XAUZ4FZE.js";import"./chunk-5JVWMQI2.js";import"./chunk-KLS3SJXA.js";import"./chunk-5DQKP6TK.js";import"./chunk-QTPS5BDP.js";import"./chunk-KOQXCGQ5.js";import"./chunk-P7NYIGUS.js";import"./chunk-OWPVBYY3.js";import"./chunk-ZNFTIF43.js";import"./chunk-D52EE5TC.js";import"./chunk-FEU7MNAN.js";import"./chunk-CWNI35TN.js";import"./chunk-E6SXR3B6.js";import"./chunk-GTBNRR37.js";import"./chunk-UUOZSCBD.js";import"./chunk-A7FGCMOW.js";import"./chunk-V2CZ7DY4.js";import"./chunk-3PLVXUNW.js";import"./chunk-HIUQCAJS.js";import"./chunk-S6FHNOIH.js";import"./chunk-RKCZ2ONP.js";import"./chunk-RER2JAFZ.js";import"./chunk-CJAFGYQK.js";import"./chunk-QED56456.js";import"./chunk-HSSW2VTC.js";import"./chunk-PYCB247J.js";import"./chunk-2LQJ3JX6.js";import"./chunk-KF7FMIRD.js";import"./chunk-N4IYN7DD.js";import"./chunk-UY2DPNBT.js";import"./chunk-SZZZVLQW.js";import"./chunk-V5J3A5L5.js";import"./chunk-CERSDYPT.js";import"./chunk-RZETZIQO.js";import"./chunk-P5GHREX3.js";import"./chunk-HUG2KBCE.js";import"./chunk-6XMXPOUW.js";import"./chunk-3WKBEXBH.js";import"./chunk-RK4OLGCC.js";import"./chunk-NNPT43SF.js";import"./chunk-VL2JCPJS.js";import"./chunk-CTJAEFLV.js";import"./chunk-AP4E6GDF.js";import"./chunk-RPH2MNBW.js";import"./chunk-SKUQ6ZA4.js";import"./chunk-P3FTJE4X.js";import"./chunk-ACIP3YF7.js";import"./chunk-W6ZDZJCJ.js";import"./chunk-PGGBOJAH.js";import"./chunk-JDCCMYBK.js";import"./chunk-554VFFSY.js";import"./chunk-4ADHM5NM.js";import"./chunk-JBOOQ7HO.js";import"./chunk-RKPJE2LG.js";import{a as yt}from"./chunk-LIF3EEZV.js";import{e as tt}from"./chunk-GHRGCPR7.js";import{a as gt,b as Ct}from"./chunk-4NXISG4T.js";import{c as _t}from"./chunk-MLF4IONJ.js";import"./chunk-4ITEJ5A6.js";import{j as h,l as he}from"./chunk-JYCBCMDP.js";import"./chunk-CBZ2RV36.js";import"./chunk-GVYIP5Q5.js";import{_ as Qe,c as Ze}from"./chunk-VHMBEOFX.js";import"./chunk-L3AMAP6V.js";import{c as st}from"./chunk-W3VW6MYS.js";import"./chunk-GWHLETPD.js";import"./chunk-6GJ4TEPK.js";import"./chunk-BYDDPVAA.js";import"./chunk-CSTKCSUP.js";import"./chunk-M43NTBTB.js";import"./chunk-CKHT4PIF.js";import"./chunk-JMNZU6WB.js";import"./chunk-WXD7TULU.js";import"./chunk-JQHLKZPQ.js";import"./chunk-ZZBUS7GI.js";import"./chunk-PMG6IXOR.js";import"./chunk-BD5XO4WL.js";import"./chunk-7U7FORYL.js";import"./chunk-MT3ANHCR.js";import"./chunk-2IJ4E4D3.js";import"./chunk-XJ2EVWVX.js";import"./chunk-DD6IGY5O.js";import"./chunk-JMM35KIH.js";import"./chunk-5E7YC7OF.js";import"./chunk-LYGOKEAJ.js";import"./chunk-NS5EW6UN.js";import"./chunk-VUBIYSGX.js";import"./chunk-PNOOVDMP.js";import"./chunk-FHFRBSOO.js";import"./chunk-DU4RS7AX.js";import"./chunk-5C7AUJM4.js";import"./chunk-FLXVXXZH.js";import"./chunk-XBUPORYF.js";import{b as ft}from"./chunk-YVLQLIW6.js";import"./chunk-HBXZ3GPM.js";import"./chunk-6C7RJCTT.js";import{o as Me}from"./chunk-N6PI3XTA.js";import"./chunk-7DW2ZPOD.js";import"./chunk-SI5WJURV.js";import"./chunk-MT4YWUUK.js";import"./chunk-IPVHRCDK.js";import"./chunk-JW2AVC2H.js";import"./chunk-AKOAGCJX.js";import"./chunk-ARDRUD4P.js";import{e as pt,h as be,k as dt}from"./chunk-WYX7GFOD.js";import"./chunk-G6PA2JD3.js";import"./chunk-N2N44VBE.js";import"./chunk-ZDJRNLYZ.js";import"./chunk-RV5WZKGQ.js";import"./chunk-MJSLAJV6.js";import{D as nt,a as se,i as ke,x as ot}from"./chunk-KC2XLVFC.js";import{B as z,D as Ke,U as Je,qa as I,ra as g}from"./chunk-MJDO2VHF.js";import"./chunk-TFTCL6XD.js";import{h as O,m as et}from"./chunk-TBQGFYU3.js";import"./chunk-L5AZICLM.js";import"./chunk-WLEQHCLB.js";import{a as Be,b as it,i as E,jb as at,k as B}from"./chunk-QF42JCDG.js";import"./chunk-DRCTWZQB.js";import{b as ye}from"./chunk-KGMP5AO5.js";import{c as re}from"./chunk-EAE2NUFS.js";import"./chunk-OLICTWCW.js";import"./chunk-SDBZJWGW.js";import"./chunk-F3ILJHGP.js";import"./chunk-6M37VPK2.js";import"./chunk-WOJGOC63.js";import{A as Xe}from"./chunk-3F7OC7N7.js";import"./chunk-HZOYPVSA.js";import"./chunk-Z4GX4TH2.js";import{d as rt}from"./chunk-OKGWI7CU.js";import{B as Ce,j as _e}from"./chunk-EPDR6VAQ.js";import"./chunk-RFTC6RNT.js";import"./chunk-I6UBKGB5.js";import{h as lt}from"./chunk-ZIR6OOXX.js";import"./chunk-KYVX6VSI.js";import"./chunk-WN3TRBGI.js";import{c as W}from"./chunk-3FMJDUGT.js";import"./chunk-2O5TMJZM.js";import{L as Ve}from"./chunk-UI4IZNSB.js";import"./chunk-FCGPU67F.js";import"./chunk-FXRKHQFW.js";import"./chunk-YTHL7242.js";import"./chunk-XOHZCMW2.js";import{E as Te,J as $e,Lb as He,Mb as ze,Ta as we,W as Ye,Y as je,k as ge,ua as N}from"./chunk-EQ34WRCJ.js";import"./chunk-UIZGYUZK.js";import{p}from"./chunk-DSNMNSMD.js";import"./chunk-U2IAA473.js";import{a as Pe}from"./chunk-DOSBJ3L3.js";import"./chunk-DNGRHKLV.js";import"./chunk-3O2IEAHF.js";import{A as Se,I as mt,d as ct}from"./chunk-URGJ6D4O.js";import"./chunk-WC6GCIBJ.js";import"./chunk-I2AEM4CA.js";import"./chunk-JRC3ZUKA.js";import"./chunk-4U5VOZ7H.js";import{a as ut}from"./chunk-FVHZWNUE.js";import"./chunk-IQUFNLVG.js";import{w as We}from"./chunk-XYWWXNVK.js";import"./chunk-VYWNZTTM.js";import"./chunk-5CHTOVVG.js";import{a as To}from"./chunk-FB3ILH2L.js";import{b as k}from"./chunk-FLSAETOH.js";import"./chunk-TGW66MRK.js";import"./chunk-LRIABBHT.js";import"./chunk-NEASQB35.js";import"./chunk-5BYM6SMZ.js";import"./chunk-TR37MFB4.js";import"./chunk-PNECIDQW.js";import"./chunk-BVDMVGLD.js";import{Aa as fe,M as Fe,Q as de,g as pe}from"./chunk-4C5HF6J2.js";import"./chunk-4HSSECLD.js";import"./chunk-BY6XCDJZ.js";import"./chunk-U6W3TK77.js";import"./chunk-6GYKGMWB.js";import"./chunk-WJI4CIAQ.js";import"./chunk-PESQD55U.js";import"./chunk-WQGQVXPA.js";import"./chunk-GTDBOF5Q.js";import"./chunk-EI7BJC6V.js";import"./chunk-UY3WU5XU.js";import"./chunk-ALECRBLY.js";import"./chunk-B3EOGJ3Y.js";import"./chunk-YL2RBVBZ.js";import"./chunk-4HAPQ4J7.js";import"./chunk-QM6LXDU7.js";import"./chunk-WZALYVUQ.js";import"./chunk-F5YUOHHL.js";import"./chunk-26KHACOU.js";import"./chunk-VONUGAVN.js";import"./chunk-ZVKCRT3D.js";import"./chunk-MSOW5GDX.js";import"./chunk-O5NUB7LT.js";import"./chunk-QI2KSP5Y.js";import"./chunk-EL77VG5Z.js";import"./chunk-LWG66QL2.js";import"./chunk-26XSB24L.js";import"./chunk-IFKSF5TW.js";import"./chunk-PDIVTGDM.js";import"./chunk-UL6IEE2K.js";import"./chunk-4ARIYUS3.js";import{f as C,n as process,o as r,q as s}from"./chunk-UWURTNRY.js";r();s();var D=C(k());var v=C(Pe());r();s();var Nt=yt(()=>import("./Comp-XK3N3WEU.js"),"ChooseWallet");r();s();var $=C(k());r();s();var $t=C(k());fe();r();s();var x=C(k());var Wt=C(Pe());r();s();var P=C(k()),Ot=C(Pe());fe();r();s();var Ae={root:"_root_oli0p_1",multiAccount:"_multiAccount_oli0p_4",count:"_count_oli0p_9"};var wo="account-selector",ko=e=>{let t=(0,Ot.useHistory)(),{permissionsRequestId:o,request:n,dappSelectAccount:a,walletInfo:i={},connectable:c=!0,hiddenAddress:u=!1,disableSelectAccount:l=!1}=e,m=()=>{t.push({pathname:`${E}/${o}${B}`})},_=(0,P.useMemo)(()=>u?"":n?.providerType===$e?p("wallet_extension_cosmos_text_cosmos_network"):i.address??"",[u,n?.providerType,i.address]),y=n?.method===xe.walletRequestWallets&&n?.providerType===Te,f=()=>a.length<=1?y?P.default.createElement(L,{bordered:!1},P.default.createElement(Le,{onClick:l?void 0:pe,hiddenAddress:u,copyable:!1,title:p("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:p("wallet_extension_expand_all_networks")})):P.default.createElement(L,{bordered:!1},P.default.createElement(Le,{onClick:l?void 0:pe,copyable:!1,title:p("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:_,hiddenAddress:u,connectable:c})):P.default.createElement(L,{bordered:!1},P.default.createElement(St,{title:p("wallet_dapp_conncetion_requesr_subtitle_current_account")},P.default.createElement(W.Box,{className:Ae.multiAccount},P.default.createElement(W.Box,{className:Ae.count},p("wallet_extension_mid_text_accounts",{num:a.length})),P.default.createElement(Ue,{className:`${wo}__info-arrow`,side:Ue.SIDE.RIGHT}))));return P.default.createElement("div",{className:Ae.root,onClick:l?pe:m},f())},Bt=ko;function ho({targetDomainMetadata:e,permissionsRequestId:t,request:o,walletInfo:n,connectable:a,tipMessage:i,buttonGroup:c,hiddenAddress:u,disableSelectAccount:l,RequestedNetworks:m,children:_,title:y}){let f=(0,Wt.useHistory)(),T=g(h),w=pt();return x.default.createElement(W.Container,null,x.default.createElement(Tt,{backable:!1,closeable:!1,title:y??p("wallet_dapp_conncetion_maintitle_conncet_account")}),x.default.createElement(L,null,x.default.createElement(Dt,{...e})),x.default.createElement(Bt,{targetDomainMetadata:e,permissionsRequestId:t,request:o,dappSelectAccount:T,walletInfo:n,disableSelectAccount:l,hiddenAddress:u,connectable:a}),m&&x.default.createElement(m,{request:o}),_,x.default.createElement(ft,{placeholder:!0,offsetBottom:0,borderTop:!0},x.default.createElement(R,{...i}),x.default.createElement(A,{buttonGroup:c})),n?.keyringIdentityType===ze.MPC&&x.default.createElement(Rt,{keyringId:n.keyringId,customConfig:w?.length===1?{confirmText:p("wallet_extension_btn_general_gotit")}:{},actionMap:{["RECOVER"]:()=>{f.push(`${at}?action=${wt.RECOVER}&walletId=${n.walletId}`)},["SWITCH_WALLET"]:async()=>w?.length===1?(await c[0]?.onClick(),f.push(it)):f.push({pathname:`${E}/${t}${B}`})}}))}var K=ho;r();s();function Po(e,t){let o=be(),{baseChain:n,chainName:a}=vt(t),c=g(h)[0]||o,u=It({walletId:c,localType:n}),l=t?.method===xe.walletRequestWallets&&t?.providerType===Te,m=!!n&&(l||Boolean(u?.address)),_=Et(c);return{targetWalletId:c,walletInfo:u,connectable:m,chainName:a,mpcConnectable:_}}var J=Po;r();s();var Lt=C(Pe());function Ge({disabled:e,request:t,targetDomainMetadata:o,cancelPermissionsRequest:n,approvePermissionsRequest:a,connectSource:i,connectChains:c}){let u=I(),l=o?.origin,m=ae(),_=g(h),y=g(T=>Pt(T,l));return async()=>{if(e)return;m({trade:"connect_wallet",all_confirmation:"confirm"});let T={...t,permissions:{...t.permissions}};if(Object.keys(T.permissions).length>0){if(await a(T,_),_.length===1&&await u(tt(_[0],!0)),Qe({dapp_url:l}),y?.lastConnectedWalletId&&y?.providerType){let w={dappurl:l??"",connect_method:i||y.providerType,dappname:o?.name,full_url:o?.url,version:process.env.APP_VERSION};c&&(w.chain=c),Ze(w)}}else await n(T.metadata.id);await O(u)}}var So=({props:e,isMpcError:t,connectable:o,confirmBtnText:n,onConfirm:a,onCancel:i,connectSource:c,connectChains:u,disabledConfirmBtn:l=!1})=>{let m=I(),_=(0,Lt.useHistory)(),y=g(h),{permissionsRequestId:f,targetDomainMetadata:T,cancelPermissionsRequest:w,approvePermissionsRequest:S,request:U}=e,G=ae(),M=se(async()=>{G({trade:"connect_wallet",all_confirmation:"cancel"}),i?await i(f):await w(f),await O(m)}),{loading:te,onClick:oe}=ie(M),Y={actionType:A.ACTION_TYPE.CANCEL,onClick:oe,loading:te},j=Ge({request:U,targetDomainMetadata:T,approvePermissionsRequest:S,cancelPermissionsRequest:w,connectSource:c,connectChains:u}),H=se(async()=>{o?a?await a():await j():_.push({pathname:`${E}/${f}${B}`})}),{loading:ne,onClick:Oe}=ie(H),le={actionType:A.ACTION_TYPE.CONFIRM,disabled:l||o&&(y.length===0||t),btnText:o?n||p("wallet_extension_connect_btn_connect"):p("wallet_extension_connect_btn_switch_wallet"),onClick:Oe,loading:ne};return[Y,le]},X=So;r();s();var Ut=C(k());function bo(e,t){let o=I(),n=g(h),{connectable:a,mpcConnectable:i}=e;(0,Ut.useEffect)(()=>{if(!n.length&&a&&i&&t){let c=Array.isArray(t)?t:[t];o(he.setSelectAccounts(c))}},[n,a,i,t])}var Z=bo;r();s();var Gt=C(k());function Mo({isMpcError:e,connectable:t,chainName:o}){return(0,Gt.useMemo)(()=>e?{type:R.TIP_TYPE.COMMON_ERROR,message:p("extension_wallet_error_toast_not_supported")}:t?{type:R.TIP_TYPE.NORMAL,message:p("wallet_dapp_conncetion_notify_conncet_permission")}:{type:R.TIP_TYPE.COMMON_WARN,message:p("wallet_extension_connect_alert_text_doesnt_support_network",{network:o})},[e,t,o])}var Re=Mo;r();s();var Vt=C(k());r();s();var Ee=C(k());var Ft=(e,t)=>{let[o,n]=(0,Ee.useState)(!1);return(0,Ee.useEffect)(()=>{(async()=>{if(e&&t){let{data:a}=await kt({dappUrl:e});n(a.result)}})()},[e,t]),o};function Io(e){let t=g(h),o=g(Ke),n=(0,Vt.useMemo)(()=>t.some(i=>o.find(c=>c.walletId===i)?.initialType===He.MPC_KEYRING),[t,o]),a=Ft(e?.host,n);return n&&!a}var Q=Io;function xo(e){let{targetDomainMetadata:t,permissionsRequestId:o,request:n}=e,a=be(),i=J(t?.origin,n),{walletInfo:c,connectable:u,chainName:l}=i,m=Q(t),_=Re({isMpcError:m,connectable:u,chainName:l}),y=X({props:e,isMpcError:m,connectable:u});return Z(i,a),Fe(n)?null:$t.default.createElement(K,{targetDomainMetadata:t,permissionsRequestId:o,request:n,walletInfo:c,connectable:u,tipMessage:_,buttonGroup:y})}var Yt=xo;r();s();var Kt=C(k());r();s();fe();var Ao=({props:e,isMpcError:t,connectable:o,walletInfo:n={},nearAmount:a})=>{let{walletId:i,address:c}=n,u=X({props:e,isMpcError:t,connectable:o});return!de(a)&&_e(a,0)&&(u[1]={actionType:A.ACTION_TYPE.FILL_UP,coinId:we,walletId:i,address:c,receiveOnly:!0}),u},jt=Ao;r();s();var Ht=C(k());fe();function Ro({nearAmount:e,isMpcError:t,connectable:o,chainName:n}){return(0,Ht.useMemo)(()=>!de(e)&&_e(e,0)?{type:ct.TYPE.warn,message:p("wallet_extension_conncetion_alert_add_more")}:t?{type:R.TIP_TYPE.COMMON_ERROR,message:p("extension_wallet_error_toast_not_supported")}:o?{type:R.TIP_TYPE.NORMAL,message:p("wallet_extension_conncetion_alert_check_balance")}:{type:R.TIP_TYPE.COMMON_WARN,message:p("wallet_extension_connect_alert_text_doesnt_support_network",{network:n})},[e,t,o,n])}var zt=Ro;var Eo=e=>{let{targetDomainMetadata:t,permissionsRequestId:o,request:n}=e,a=g(z),i=J(t?.origin,n),{walletInfo:c,connectable:u,chainName:l,targetWalletId:m}=i,_=Q(t),y=bt(we,m)?.coinAmountInt,f=zt({targetWalletId:m,isMpcError:_,connectable:u,chainName:l,nearAmount:y}),T=jt({props:e,isMpcError:_,connectable:u,walletInfo:c,nearAmount:y});return Z(i,a),Kt.default.createElement(K,{targetDomainMetadata:t,permissionsRequestId:o,request:n,walletInfo:c,connectable:u,tipMessage:f,buttonGroup:T})},Jt=Eo;r();s();var me=C(k());r();s();var ce=C(k()),eo=C(To());r();s();var q=C(k());r();s();var qe={root:"_root_19vb2_1",name:"_name_19vb2_5",value:"_value_19vb2_11"};var Xt=({name:e,value:t})=>{let o=Mt({showDesc:!1});return q.default.createElement(W.Box,{className:qe.root},q.default.createElement(Me.Text,{ellipsis:{tooltip:!0},className:qe.name},e||p("wallet_dapp_connection_subtitle_data_label")),q.default.createElement(W.Box,{className:qe.value},q.default.createElement(Se,{noWrapper:!0,title:p("wallet_receive_btn_copy_address"),type:Se.TYPES.neutral,trigger:Se.TRIGGER_TYPES.hover},q.default.createElement(Me.Text,{size:Me.SIZE.sm,onClick:()=>{o(t)}},t))))},qo=({message:e})=>typeof e=="string"?q.default.createElement(Xt,{value:e}):q.default.createElement("div",null,e.map(({name:t,value:o})=>{let n=o;return typeof o=="boolean"&&(n=o.toString()),q.default.createElement(Xt,{key:n,name:t,value:n})})),Zt=qo;r();s();var Qt={item:"_item_11fx7_1"};function Do({className:e,message:t}){return ce.default.createElement(ce.default.Fragment,null,ce.default.createElement(L,{bordered:!1,className:(0,eo.default)(Qt.item,e)},ce.default.createElement(Zt,{message:t})))}var to=Do;r();s();var so=C(k());r();s();function vo({disabledSubmit:e,confirmBtnLoading:t,permissionsRequestId:o,cancelPermissionsRequest:n,request:a,targetDomainMetadata:i,approvePermissionsRequest:c}){let u=I(),l=ae(),m=se(async()=>{l({trade:"connect_wallet",all_confirmation:"cancel"}),await n(o),await O(u)}),{loading:_,onClick:y}=ie(m),f={loading:_,actionType:A.ACTION_TYPE.CANCEL,onClick:y},T=Ge({request:a,targetDomainMetadata:i,approvePermissionsRequest:c,cancelPermissionsRequest:n}),w={loading:t,disabled:e,actionType:A.ACTION_TYPE.CONFIRM,onClick:T};return[f,w]}var oo=vo;r();s();var De=C(k());function No(e,t){let o=(0,De.useRef)(t?.origin),a=(e?.providersExts?.[N]??e?.exts)?.message?.manifestUrl,[i,c]=(0,De.useState)(!0);return ke(()=>{(async()=>{if(a)try{let l=await Ve(a);if(l?.status===200){let m=l.data;typeof m?.url=="string"&&(o.current=m.url)}}finally{c(!1)}else c(!1)})()}),{loading:i,domain:o.current}}var no=No;r();s();var ve=C(k());function Oo(e){let t=g(z),o=g(h),n=g(c=>ht(c,e?.origin)),[a,i]=(0,ve.useState)(null);return(0,ve.useEffect)(()=>{(async()=>{t&&o.includes(t)?i(t):n&&o.includes(n)?i(n):i(o[0])})()},[t,o,n]),a}var ro=Oo;var Bo=({request:e,targetDomainMetadata:t,permissionsRequestId:o,approvePermissionsRequest:n,cancelPermissionsRequest:a,isSilentConnected:i})=>{let c=ro(t),{loading:u,domain:l}=no(e,t),m=dt(c,N),f=((e?.providersExts?.[N]??e?.exts)?.message?.items||[]).filter(({name:S})=>S===st.TON_PROOF),T=f.length===1?`${f[0].payload||""}`:f.map(({payload:S})=>({value:S}));(0,so.useEffect)(()=>{ye("Sign Ton Proof UI",{tonAddress:m})},[m]);let w=oo({disabledSubmit:u,permissionsRequestId:o,request:e,targetDomainMetadata:t,approvePermissionsRequest:async(S,U,G)=>{try{let M=Math.round(Date.now()/1e3),te=new URL(l).host,oe=await Promise.all(f.map(async({payload:Y})=>{let j;try{ye("Call Sign Ton Proof",{tonAddress:m}),j=await re().signTonProof({proof:{timestamp:M,domain:te,payload:Y}},m,c)}catch(H){throw ye("Error Sign Ton Proof",{tonAddress:m,isReject:H?.message===Xe}),H}return{payload:Y,signature:j}}));S.resultParams={domain:l,timestamp:M,signatures:oe}}catch{return mt.error({title:p("wallet_extension_ton_error_signature_support")}),null}return n(S,U,G,!i)},cancelPermissionsRequest:a});return{tonProofs:f,message:T,buttonGroup:w}},io=Bo;r();s();var ue=C(k());function Wo({targetDomainMetadata:e,dappMetadata:t,alwaysNeedProof:o}){let n=g(z),[a,i]=(0,ue.useState)(null),[c,u]=(0,ue.useState)(!0);return(0,ue.useEffect)(()=>{(async()=>{if(!o){u(!1);return}try{(await re().getPermittedWallets(e?.origin,N,!1)).length>0&&i(await re().getPermittedWallets(e?.origin,N,!0))}finally{u(!1)}})()},[o]),Z(t,c?null:a||n),{loading:c,isSilentConnected:!!a}}var ao=Wo;r();s();var co={loading:"_loading_po7pc_1"};function Lo(e){let{alwaysNeedProof:t,targetDomainMetadata:o,permissionsRequestId:n,request:a}=e,i=J(o?.origin,a),{walletInfo:c,connectable:u,chainName:l}=i,m=Q(o),_=Re({isMpcError:m,connectable:u,chainName:l}),y={props:e,isMpcError:m,connectable:u,connectSource:a?.exts?.connectSource},f=X(y),{loading:T,isSilentConnected:w}=ao({targetDomainMetadata:o,dappMetadata:i,alwaysNeedProof:t}),{tonProofs:S,message:U,buttonGroup:G}=io({...e,isSilentConnected:w}),M=S?.length>0;return T?me.default.createElement("div",{className:co.loading},me.default.createElement(We.Circle,{size:We.SIZE.lg})):me.default.createElement(K,{targetDomainMetadata:{...o,host:o.origin||o.host},permissionsRequestId:n,request:a,walletInfo:c,connectable:u,tipMessage:_,buttonGroup:M?G:f,title:M?p("wallet_extension_header_connect_sign"):void 0},me.default.createElement(to,{message:U}))}var uo=Lo;r();s();var ee=C(k());r();s();var Ne={root:"_root_h6iyb_1",animation:"_animation_h6iyb_14",text:"_text_h6iyb_17"};var Uo=({onComplete:e})=>{let[t,o]=(0,ee.useState)(!1),n=lt({dark:"/static/images/__animation__/dapp/success-dark.json",light:"/static/images/__animation__/dapp/success-light.json"});return ee.default.createElement("div",{className:Ne.root},ee.default.createElement(ut,{className:Ne.animation,path:n,loop:!1,onDataReady:()=>{o(!0)},onComplete:e}),t?ee.default.createElement("span",{className:Ne.text},p("wallet_home_foot_dapp_connceted")):null)},mo=Uo;var lo=({chooseAccountProps:e,showAni:t})=>{let o=e?.request?.exts?.alwaysNeedProof,n=e?.request?.providerType;return $.default.createElement($.default.Fragment,null,(()=>{switch(!0){case(n===Ye&&o):return $.default.createElement(Jt,{...e});case n===je:return $.default.createElement(uo,{alwaysNeedProof:o,...e});default:return $.default.createElement(Yt,{...e})}})(),t&&$.default.createElement(mo,{onComplete:()=>{e?.onComplete()}}))};r();s();r();s();function po(){let e=I();return()=>e(et())}var fo=po;r();s();var Go=({environmentType:e,history:t})=>{e!==ge&&t.push(Be)},Fo=({dispatch:e,permissionsRequest:t,showAni:o,redirect:n})=>{let a=ot(o);nt(()=>{a===void 0&&o===!1&&!t&&(e(Ie()),n())},[a,o,t])},Vo=({rejectPermissionsRequest:e,permissionsRequestId:t,optType:o})=>{let n=()=>{t&&o===gt.connect&&e(t,origin)};return{beforeUnload:n,addBeforeUnload:()=>{Ce()===ge&&window.addEventListener("beforeunload",n)},removeBeforeUnload:()=>{Ce()===ge&&window.removeEventListener("beforeunload",n)}}},$o=({rejectPermissionsRequest:e,dispatch:t,redirect:o,origin:n})=>async(i,c)=>{i&&(await e(i,n,c),await O(t),o())},Yo=({permissionsRequest:e,history:t,getCurrentWindowTab:o,getRequestAccountTabIds:n,addBeforeUnload:a,clearSelectedWallet:i})=>{ke(()=>{if(o(),n(),!e){t.push(Be);return}a(),i()})},go=e=>e||{},jo=({showConnectSuccess:e,setShowAni:t,onComplete:o})=>{e?t(!0):o()},rc=()=>{let e=I(),t=(0,v.useHistory)(),n=(0,v.useRouteMatch)().params.id,i=g(_t).find(b=>b.metadata.id===n),c=i?.providerTypes,[u,l]=(0,D.useState)(!1),m=g(Ct),_=g(Je),{metadata:y={}}=i||{},{origin:f,url:T}=y,w=null;if(f)if(_[f])w={..._[f],origin:f,url:T},w.icon??=rt;else{let b=new URL(f);w={host:b.host,name:b.hostname,origin:f,url:T}}let S=`${E}/${n}`,U=`${E}/${n}${B}`,G=async(b,F,V)=>{await e(xt(b,F,V))},M=async(b,F,V)=>{await e(At(b,F,V)),await e(Ie())},te=()=>e(qt()),oe=fo(),Y=()=>e(he.setSelectAccounts([])),{addBeforeUnload:j,removeBeforeUnload:H}=Vo({rejectPermissionsRequest:M,permissionsRequestId:n,optType:m}),ne=()=>{H();let b=Ce();return Go({environmentType:b,history:t}),null},Oe=$o({rejectPermissionsRequest:M,dispatch:e,redirect:ne,origin:f}),le=()=>{l(!1),ne(),e(Ie())};Fo({dispatch:e,permissionsRequest:i,showAni:u,redirect:ne}),Yo({permissionsRequest:i,history:t,getCurrentWindowTab:oe,getRequestAccountTabIds:te,addBeforeUnload:j,clearSelectedWallet:Y});let _o=c;return D.default.createElement("div",{className:"page-container permissions-connect"},D.default.createElement(v.Switch,null,D.default.createElement(v.Route,{path:U,exact:!0,render:()=>D.default.createElement(Nt,{request:go(i),multi:!_o})}),D.default.createElement(v.Route,{path:S,exact:!0,render:()=>{let b={request:go(i),cancelPermissionsRequest:(F,V)=>Oe(F,V),permissionsRequestId:n,targetDomainMetadata:w,onComplete:le,approvePermissionsRequest:async(F,V,Co,yo=!0)=>{await G(F,V,Co),await O(e),jo({showConnectSuccess:yo,setShowAni:l,onComplete:le})}};return D.default.createElement(lo,{chooseAccountProps:b,showAni:u})}})))};export{rc as default};
//# sourceMappingURL=PermissionsConnect-4AFIO2LS.js.map
