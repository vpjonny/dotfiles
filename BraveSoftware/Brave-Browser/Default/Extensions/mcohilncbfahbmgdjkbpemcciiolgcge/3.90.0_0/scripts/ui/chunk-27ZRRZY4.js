import{a as O}from"./chunk-RCXPUQYC.js";import{c as H}from"./chunk-Z3CN3PP7.js";import{a as I}from"./chunk-AOZHPYH5.js";import{a as M}from"./chunk-6M37VPK2.js";import{c as k}from"./chunk-EPDR6VAQ.js";import{g as N,m as F}from"./chunk-UI4IZNSB.js";import{vb as C}from"./chunk-EQ34WRCJ.js";import{p as w}from"./chunk-DSNMNSMD.js";import{I as b}from"./chunk-URGJ6D4O.js";import{b as D}from"./chunk-FLSAETOH.js";import{f as z,o as p,q as f}from"./chunk-UWURTNRY.js";p();f();var T=z(D());function B({fromAddress:t,disabled:r,localType:m,inputData:P,createInputDataFn:c,upgradeAddress:o,isUpgrade7702:g}){let s=C({localType:m}),[e,l]=(0,T.useState)(!1),[h,u]=(0,T.useState)(null),d=s?.realChainIdHex;return(0,T.useEffect)(()=>{if(r){l(!1);return}l(!0),(async()=>{try{let{getRandomPrivateKey:L,getNewAddress:a}=await N(),i=await L(s?.coinType),{address:_}=await a(s?.coinType,{privateKey:i}),E=c?await c({address:_,privateKey:i}):P,x={from:t,to:t,value:"0",data:E,authorizationList:[],stateOverrideList:[{address:t,code:g?`0xef0100${o.substring(2).toLowerCase()}`:"0x"}]},n={privateKey:i,data:{chainId:d,address:o,nonce:I(1)}},{EthWallet:y}=await F(),U=await new y().signAuthorizationListItemForRPC(n);x.authorizationList=[U],u(x),l(!1)}catch{b.error({title:w("wallet_extension_general_error_extension_code_error")})}})()},[t,r,P,c,d,o,s?.coinType,g]),{gasLimitParams:h,loading:e}}var K=B;p();f();var A=z(D());var V=t=>Number.isInteger(t);function $({unapproved:t,txParams:r,modifiedCalls:m}){let{chainId:P,extParams:{chain7702Data:{status:c,contractAddress:o,currentContractAddress:g}},walletId:s}=t,{from:e,authorizationList:l}=r||{},h=l&&l.length>0,u=O(P),[d,L]=(0,A.useState)(""),{gasLimitParams:a}=K({isUpgrade7702:!0,fromAddress:e,disabled:!r||!h,localType:u.localType,inputData:d||r?.data,upgradeAddress:o}),i=(0,A.useMemo)(()=>a?.stateOverrideList?{stateOverrideList:a.stateOverrideList}:{},[a]),_=x=>{if(!h)return x;let{nonce:n,...y}=x,G=C({localType:u.localType}),U=V(n)?Number(n):Number(M(n));return{...y,nonce:n,authorizationList:[{chainId:G?.realChainIdHex,address:o,nonce:I(U+1),fromAddress:e,walletId:s,localType:u.localType}]}};return{reserveValue:(m||[]).reduce((x,n)=>{let y=n.value?M(n.value).toString():"0";return`${k(x,y)}`},"0"),onBeforeSign:_,eip5792Params:i,gasLimitParams:a,modifiedData:d,setModifiedData:L,isAuth7702:h,contractAddress:o,from:e,status:c,currentContractAddress:g}}var nt=$;p();f();var v=z(D());p();f();function R(t){let r=t,m=r.msg||r.message||r.originalError?.message||w("wallet_extension_general_error_extension_code_error");b.error({title:m})}function W({unapproved:t,shouldUpgrade7702:r}){let{chainId:m}=t,[P,c]=(0,v.useState)(null),[o,g]=(0,v.useState)(null);return(0,v.useEffect)(()=>{g(null),c(null);let s=!1;return(async()=>{try{let{params:{from:e,calls:l},extParams:{chain7702Data:{status:h,contractAddress:u,contractData:d,currentContractAddress:L}}}=t,a={from:e,to:e,value:"0x0"},i=[...l];if(r){let _=C({chainId:m});d!=="0x"&&i.unshift({to:e,value:"0x0",data:d}),a.authorizationList=[{chainId:_.realChainIdHex,address:u}]}a.data=await H({type:1,chainIndex:m,calls:i,address:e,contractAddress:h===3?L:u}),s||(g(i),c(a))}catch(e){R(e)}})(),()=>{s=!0}},[t]),{txParams:P,modifiedCalls:o}}var _t=W;export{K as a,nt as b,_t as c};
//# sourceMappingURL=chunk-27ZRRZY4.js.map
