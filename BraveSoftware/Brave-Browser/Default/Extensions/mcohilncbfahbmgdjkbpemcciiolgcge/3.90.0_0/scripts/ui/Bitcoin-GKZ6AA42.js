import{a as In}from"./chunk-5UF3O4RA.js";import{a as Cn}from"./chunk-B5FL4ZIW.js";import{a as Tn,b as yn}from"./chunk-A7Y6FGTK.js";import"./chunk-NO3OY2S6.js";import{a as Ue}from"./chunk-H2BYDG3J.js";import{a as gn}from"./chunk-CLIHNSYH.js";import{a as xn}from"./chunk-KDZWFWCG.js";import{a as Ke}from"./chunk-PEKFKA6I.js";import"./chunk-2KBIS3G2.js";import{a as cn}from"./chunk-QPHMIRPW.js";import{j as ln,k as un,l as pn,m as dn,n as _n,o as fn}from"./chunk-UZL4Z4Q6.js";import"./chunk-6JRCGATI.js";import"./chunk-BHUBJAUL.js";import"./chunk-VFWATNQY.js";import"./chunk-JK2V6PQY.js";import{a as Me,b as De}from"./chunk-EC2OS2MX.js";import{a as vt}from"./chunk-52JFFT56.js";import"./chunk-6CJRBF2P.js";import"./chunk-3KJMTMXK.js";import"./chunk-N6NP4323.js";import{b as an}from"./chunk-T2UFMQPE.js";import{a as pt}from"./chunk-X7JU5VY4.js";import{a as Fe,b as Oe}from"./chunk-6BWJUZYL.js";import{b as qt,g as Ae,i as Qo,j as tn,k as Pe,m as Be,p as en,q as on,r as nn}from"./chunk-ITLSSVGE.js";import{a as j}from"./chunk-M2YFVDKX.js";import"./chunk-PWVBSLOL.js";import"./chunk-4YPL7LEO.js";import"./chunk-452JEOHF.js";import{a as ke}from"./chunk-3MLYZLAT.js";import"./chunk-LHFDZX73.js";import{a as mn}from"./chunk-5EFGCLI4.js";import{a as le}from"./chunk-B4MQLH4C.js";import"./chunk-VWVRJUMU.js";import{a as sn}from"./chunk-TJ3NTWVS.js";import{a as ae}from"./chunk-634WRNGH.js";import"./chunk-RN5VSY2K.js";import"./chunk-YPWPNJRG.js";import"./chunk-GMVPA3MX.js";import{b as Ct}from"./chunk-P355XBV4.js";import{d as Le}from"./chunk-C4TBDTQO.js";import{a as ce}from"./chunk-6AUQLYPZ.js";import{a as me}from"./chunk-UPIYMC4Q.js";import{c as ie,e as rn,f as Ht}from"./chunk-ZUO5BDO3.js";import"./chunk-A7EUFORV.js";import{a as K}from"./chunk-QEPQGEPL.js";import"./chunk-RZOHZNJG.js";import"./chunk-RQTEHFJ2.js";import"./chunk-75EAYNWR.js";import"./chunk-DKVOSSSH.js";import"./chunk-FWL474H4.js";import{B as Ko,a as jo,l as v,o as Jo}from"./chunk-V7YATDMZ.js";import"./chunk-YRQLRR65.js";import"./chunk-T2AAZNU7.js";import"./chunk-E4CKCWHV.js";import"./chunk-66RCYZEO.js";import"./chunk-BIUKJDG5.js";import"./chunk-MNRE2RWN.js";import{d as $o}from"./chunk-S63SUKPS.js";import"./chunk-QR6SNDPA.js";import"./chunk-DB7NVRTE.js";import"./chunk-EF6FTTLT.js";import"./chunk-U44ZBWPF.js";import"./chunk-YPTISS47.js";import{a as Zo}from"./chunk-UX2JFEX5.js";import"./chunk-XHRUTTJG.js";import"./chunk-OS6U6P6N.js";import"./chunk-PLVYKYSQ.js";import"./chunk-MEZ72IGZ.js";import"./chunk-ZLTTBRML.js";import"./chunk-XUGHAFHG.js";import"./chunk-B5L26Z2J.js";import{d as Ho}from"./chunk-AVG63QW4.js";import{d as Ut,g as Vo}from"./chunk-YLT6ZRGE.js";import"./chunk-VSNCKUAC.js";import"./chunk-OB65JCC3.js";import"./chunk-ZWKYYPCG.js";import"./chunk-YLPOVMK6.js";import"./chunk-CAWXATKV.js";import"./chunk-GIKT3XNH.js";import"./chunk-4VAKOKZO.js";import"./chunk-F43OFDEC.js";import"./chunk-XAUZ4FZE.js";import"./chunk-5JVWMQI2.js";import"./chunk-KLS3SJXA.js";import"./chunk-5DQKP6TK.js";import"./chunk-QTPS5BDP.js";import"./chunk-KOQXCGQ5.js";import"./chunk-P7NYIGUS.js";import"./chunk-OWPVBYY3.js";import"./chunk-ZNFTIF43.js";import"./chunk-D52EE5TC.js";import"./chunk-FEU7MNAN.js";import"./chunk-CWNI35TN.js";import"./chunk-E6SXR3B6.js";import"./chunk-GTBNRR37.js";import"./chunk-UUOZSCBD.js";import"./chunk-A7FGCMOW.js";import"./chunk-V2CZ7DY4.js";import"./chunk-3PLVXUNW.js";import"./chunk-HIUQCAJS.js";import"./chunk-S6FHNOIH.js";import"./chunk-RKCZ2ONP.js";import"./chunk-RER2JAFZ.js";import"./chunk-CJAFGYQK.js";import"./chunk-QED56456.js";import"./chunk-HSSW2VTC.js";import"./chunk-PYCB247J.js";import"./chunk-2LQJ3JX6.js";import"./chunk-KF7FMIRD.js";import"./chunk-N4IYN7DD.js";import"./chunk-UY2DPNBT.js";import"./chunk-SZZZVLQW.js";import"./chunk-V5J3A5L5.js";import"./chunk-CERSDYPT.js";import"./chunk-RZETZIQO.js";import"./chunk-P5GHREX3.js";import"./chunk-HUG2KBCE.js";import"./chunk-6XMXPOUW.js";import"./chunk-3WKBEXBH.js";import"./chunk-RK4OLGCC.js";import"./chunk-NNPT43SF.js";import"./chunk-VL2JCPJS.js";import"./chunk-CTJAEFLV.js";import"./chunk-AP4E6GDF.js";import"./chunk-RPH2MNBW.js";import"./chunk-SKUQ6ZA4.js";import"./chunk-P3FTJE4X.js";import"./chunk-ACIP3YF7.js";import"./chunk-W6ZDZJCJ.js";import"./chunk-PGGBOJAH.js";import"./chunk-JDCCMYBK.js";import"./chunk-554VFFSY.js";import"./chunk-4ADHM5NM.js";import"./chunk-JBOOQ7HO.js";import"./chunk-RKPJE2LG.js";import"./chunk-PIORNFOX.js";import{b as Go}from"./chunk-LZL7SWT5.js";import"./chunk-HZ3JMDUS.js";import"./chunk-TXIKSV43.js";import"./chunk-NQGIYDUG.js";import{W as qo}from"./chunk-QTCVWDVR.js";import"./chunk-4NXISG4T.js";import"./chunk-MLF4IONJ.js";import"./chunk-4ITEJ5A6.js";import{m as ct,n as nt}from"./chunk-JYCBCMDP.js";import"./chunk-CBZ2RV36.js";import{c as ut}from"./chunk-GVYIP5Q5.js";import"./chunk-VHMBEOFX.js";import"./chunk-L3AMAP6V.js";import"./chunk-W3VW6MYS.js";import"./chunk-GWHLETPD.js";import"./chunk-6GJ4TEPK.js";import"./chunk-BYDDPVAA.js";import"./chunk-CSTKCSUP.js";import{e as zo}from"./chunk-M43NTBTB.js";import"./chunk-CKHT4PIF.js";import"./chunk-JMNZU6WB.js";import"./chunk-WXD7TULU.js";import"./chunk-JQHLKZPQ.js";import"./chunk-ZZBUS7GI.js";import{c as lt}from"./chunk-PMG6IXOR.js";import"./chunk-BD5XO4WL.js";import"./chunk-7U7FORYL.js";import{j as Ve,k as be,m as ko}from"./chunk-MT3ANHCR.js";import"./chunk-2IJ4E4D3.js";import"./chunk-XJ2EVWVX.js";import"./chunk-DD6IGY5O.js";import"./chunk-JMM35KIH.js";import"./chunk-5E7YC7OF.js";import"./chunk-LYGOKEAJ.js";import{i as Io}from"./chunk-NS5EW6UN.js";import"./chunk-VUBIYSGX.js";import"./chunk-PNOOVDMP.js";import"./chunk-FHFRBSOO.js";import"./chunk-DU4RS7AX.js";import"./chunk-5C7AUJM4.js";import"./chunk-FLXVXXZH.js";import"./chunk-XBUPORYF.js";import{b as se}from"./chunk-YVLQLIW6.js";import"./chunk-HBXZ3GPM.js";import"./chunk-6C7RJCTT.js";import{a as ir,b as Yo,h as Dt,o as I}from"./chunk-N6PI3XTA.js";import"./chunk-7DW2ZPOD.js";import"./chunk-SI5WJURV.js";import"./chunk-MT4YWUUK.js";import"./chunk-IPVHRCDK.js";import"./chunk-JW2AVC2H.js";import"./chunk-AKOAGCJX.js";import"./chunk-ARDRUD4P.js";import{n as ne,o as re}from"./chunk-WYX7GFOD.js";import"./chunk-G6PA2JD3.js";import"./chunk-N2N44VBE.js";import"./chunk-ZDJRNLYZ.js";import"./chunk-RV5WZKGQ.js";import{g as Ro}from"./chunk-MJSLAJV6.js";import{A as So,a as ee,c as Ee,k as wo,n as Mt}from"./chunk-KC2XLVFC.js";import{P as Co,qa as mt,ra as bo}from"./chunk-MJDO2VHF.js";import{a as Xo}from"./chunk-TFTCL6XD.js";import{h as tt}from"./chunk-TBQGFYU3.js";import"./chunk-L5AZICLM.js";import"./chunk-WLEQHCLB.js";import{a as Ao}from"./chunk-QF42JCDG.js";import"./chunk-DRCTWZQB.js";import"./chunk-KGMP5AO5.js";import{c as ho}from"./chunk-EAE2NUFS.js";import"./chunk-OLICTWCW.js";import"./chunk-SDBZJWGW.js";import"./chunk-F3ILJHGP.js";import"./chunk-6M37VPK2.js";import"./chunk-WOJGOC63.js";import{H as J,V as yo,Z as Ot,c as U,d as To,ia as Et}from"./chunk-3F7OC7N7.js";import"./chunk-HZOYPVSA.js";import"./chunk-Z4GX4TH2.js";import{c as No,e as Eo}from"./chunk-OKGWI7CU.js";import{a as Ze}from"./chunk-EPDR6VAQ.js";import"./chunk-RFTC6RNT.js";import"./chunk-I6UBKGB5.js";import{h as Je}from"./chunk-ZIR6OOXX.js";import"./chunk-KYVX6VSI.js";import"./chunk-WN3TRBGI.js";import{c as u}from"./chunk-3FMJDUGT.js";import{c as mo}from"./chunk-2O5TMJZM.js";import{K as lo,e as co}from"./chunk-UI4IZNSB.js";import"./chunk-FCGPU67F.js";import"./chunk-FXRKHQFW.js";import"./chunk-YTHL7242.js";import"./chunk-XOHZCMW2.js";import{Nb as zt,Tb as _o,Vb as fo,Wb as xo,Xb as go,Ya as Ne,ab as Ft,bb as wt,eb as uo,hb as po}from"./chunk-EQ34WRCJ.js";import"./chunk-UIZGYUZK.js";import{k as B,p as m}from"./chunk-DSNMNSMD.js";import"./chunk-U2IAA473.js";import{a as Po}from"./chunk-DOSBJ3L3.js";import"./chunk-DNGRHKLV.js";import"./chunk-3O2IEAHF.js";import{$ as vo,I as Do,J as Uo,_ as $e,d as Ce,fa as Wo,o as oe,p as je,y as Mo}from"./chunk-URGJ6D4O.js";import"./chunk-WC6GCIBJ.js";import"./chunk-I2AEM4CA.js";import"./chunk-JRC3ZUKA.js";import"./chunk-4U5VOZ7H.js";import"./chunk-FVHZWNUE.js";import{a as Fo}from"./chunk-IQUFNLVG.js";import{C as rt,t as Lo,w as Oo}from"./chunk-XYWWXNVK.js";import"./chunk-VYWNZTTM.js";import"./chunk-5CHTOVVG.js";import{a as Bo}from"./chunk-FB3ILH2L.js";import{b as D}from"./chunk-FLSAETOH.js";import"./chunk-TGW66MRK.js";import"./chunk-LRIABBHT.js";import"./chunk-NEASQB35.js";import"./chunk-5BYM6SMZ.js";import"./chunk-TR37MFB4.js";import"./chunk-PNECIDQW.js";import"./chunk-BVDMVGLD.js";import"./chunk-4C5HF6J2.js";import"./chunk-4HSSECLD.js";import"./chunk-BY6XCDJZ.js";import"./chunk-U6W3TK77.js";import"./chunk-6GYKGMWB.js";import"./chunk-WJI4CIAQ.js";import"./chunk-PESQD55U.js";import"./chunk-WQGQVXPA.js";import"./chunk-GTDBOF5Q.js";import"./chunk-EI7BJC6V.js";import"./chunk-UY3WU5XU.js";import"./chunk-ALECRBLY.js";import"./chunk-B3EOGJ3Y.js";import"./chunk-YL2RBVBZ.js";import"./chunk-4HAPQ4J7.js";import"./chunk-QM6LXDU7.js";import"./chunk-WZALYVUQ.js";import"./chunk-F5YUOHHL.js";import"./chunk-26KHACOU.js";import"./chunk-VONUGAVN.js";import"./chunk-ZVKCRT3D.js";import"./chunk-MSOW5GDX.js";import"./chunk-O5NUB7LT.js";import"./chunk-QI2KSP5Y.js";import"./chunk-EL77VG5Z.js";import"./chunk-LWG66QL2.js";import"./chunk-26XSB24L.js";import"./chunk-IFKSF5TW.js";import"./chunk-PDIVTGDM.js";import"./chunk-UL6IEE2K.js";import"./chunk-4ARIYUS3.js";import{f as A,o as i,p as C,q as a}from"./chunk-UWURTNRY.js";i();a();var At=A(D());i();a();var ve=A(D());i();a();var hn=({unapproved:t})=>ve.default.createElement(u.Container,null,ve.default.createElement(pt,{bordered:!1,verticalPadding:!1},ve.default.createElement(cn,{unapproved:t})));i();a();var y=A(D());var ar=({unapproved:t})=>{let e=t?.localType,o=t?.method,r=ut({localType:e})?.coinId;r===void 0&&(r=wt(e));let s=Ut(r),c=mt(),_=t.walletId,d=t.params.transaction.from,O=re(_),x=t.params.transaction.amount||2,[,w]=ke({coinId:r,address:d,chainId:s?.chainId}),S=w?.transferReminder,l=w?.dummyOutput,[f,M]=(0,y.useState)({level:Ot.STANDARD,satBytes:w?.normal}),N=f?.satBytes;(0,y.useEffect)(()=>{if(!N&&w?.normal&&M({level:Ot.STANDARD,satBytes:w?.normal}),N&&f?.level!==Ot.CUSTOM){let H=w[Fe[f?.level]?.satBytes];M({...f,satBytes:H})}},[w]);let[E,{toggle:W}]=Mt(!1),[b,{set:T}]=Mt(!1),[P,{set:X}]=Mt(!1),[G,st]=(0,y.useState)(),[z,h]=Pe({coinId:r,walletId:_,address:d,batchDummyNum:x,utxoType:qt.SPLIT_UTXO}),[q,R,St]=tn({coinId:r,walletId:_,address:d,networkFee:G,utxoType:qt.SPLIT_UTXO,batchDummyNum:x,coinAmount:B.mul(l,x)},{ready:!!l}),ft=(0,y.useMemo)(()=>R.findIndex(({dummy:H})=>H!==!0),[R]),yt=(0,y.useMemo)(()=>ft===-1?[]:R.slice(ft),[ft,R]),xt=(0,y.useMemo)(()=>ft===-1?0:Math.max(x-ft,0),[x,ft]),Yt=B.gt(xt,0),Vt=B.mul(l,xt),$=en({coinId:r,fromAddr:d,satBytes:N}),ot=(0,y.useCallback)(async()=>{try{if(!N)return;T(!0);let H=await $({inputs:yt,outputs:Array.from({length:xt}).map(()=>({address:d,amount:l}))});X(!1),st(H)}catch{X(!0)}finally{T(!1)}},[l,$,d,yt,xt,N,X,T]);(0,y.useEffect)(()=>{ot()},[ot]);let Nt=(0,y.useMemo)(()=>h===void 0||!G?!0:B.gt(h,G),[h,G]),jt=ne(_),[It,ht]=(0,y.useState)(!1),Pt=(0,y.useCallback)(async()=>{await c(ct(t.id)),await c(Ct()),await tt(c),ht(!1)},[c,t.id]),{addressCheckError:Q,addressCheckLoading:Bt}=vt({chainIndex:s?.chainId||Ne,method:o,from:d,handleCancel:Pt}),$t=(0,y.useMemo)(()=>O?{type:j.TIP_TYPE.COMMON_ERROR,message:m("wallet_extension_top_toast_dapp_comingsoon")}:P?{type:j.TIP_TYPE.FEE_ERROR}:Nt?Q?{type:j.TIP_TYPE.COMMON_ERROR,message:Q}:{type:Ce.TYPE.warn,message:S}:{coinId:r,type:j.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[r,P,O,Nt,S,Q]),Jt=Ko({coinId:r,walletId:_,coinAmount:"0",fromAddr:d,toAddr:d,localType:s?.localType,networkFee:G,extJson:JSON.stringify({}),txSource:zt.DAPP,txType:U.BTC_SPLIT_UTXO}),Z=Be({coinId:r,txType:U.BTC_SPLIT_UTXO,address:d}),Xt=(0,y.useCallback)(async()=>{if(Yt)try{await Z(yt),ht(!0);let{signed:H,utxos:Gt}=await ho().splitUtxo({splitAmount:xt,inputs:Ae(yt),amount:l,feePerB:f.satBytes},d,_),fe=await jo(s?.localType,H);await Jt(H,{txHash:fe});let qe=R.filter(xe=>xe.dummy),He=[...Ae(qe),...Gt.map(xe=>({...xe,rawTransaction:H}))];await c(nt(t.id,{utxos:He,txHash:fe}))}catch{}finally{ht(!1)}else{let H=R.slice(0,x);await c(nt(t.id,{utxos:Ae(H)}))}},[x,c,l,R,d,Yt,yt,Jt,xt,f.satBytes,t.id,Z,_]),{loading:Kt,onClick:_e}=K(Pt),{loading:Ie,onClick:he}=K(Xt),we=(0,y.useMemo)(()=>{let H={loading:Kt,actionType:v.ACTION_TYPE.CANCEL,btnText:m("wallet_dapp_connection_btn_reject"),onClick:_e},Gt={actionType:v.ACTION_TYPE.CONFIRM,disabled:z||b||q||P||St||!Number(G)||O||Q,onClick:he,loading:Ie||Bt};return Nt||(Gt={coinId:r,walletId:_,address:d,actionType:v.ACTION_TYPE.FILL_UP}),[H,Gt]},[r,G,P,b,d,O,Nt,z,_e,he,St,q,_,Kt,Ie]);return y.default.createElement(u.Container,null,y.default.createElement(Le,{coinId:r,...$t}),y.default.createElement(ie,{injectInfo:{title:m("wallet_extension_send_colored_send"),identify:!0}}),y.default.createElement(pt,null,y.default.createElement(Dt.Thin,{compact:!0}),y.default.createElement(ae,{coinId:r,assetChange:Vt,hideSign:!0})),y.default.createElement(pt,{bordered:!1},y.default.createElement(ce,{coinId:r}),y.default.createElement(me,{coinId:r,loading:b,feeError:P,networkFee:G,onClick:W}),y.default.createElement(Ht,{walletId:_,address:d,title:m("wallet_extension_network_address_title_walletused")}),!!h&&y.default.createElement(Me,{coinBalance:h,tooltip:m("extension_defi_bot_popuptext_avail_amount"),coinId:r})),y.default.createElement(se,{placeholder:!0,offsetBottom:0,borderTop:!0},y.default.createElement(v,{buttonGroup:we})),y.default.createElement(Oe,{coinId:r,visible:E,signInfo:w,value:f,estimatedFee:G,onChange:M,onToggleVisible:W}),y.default.createElement(De,{visible:jt&&It}))},wn=ar;i();a();var Sn=A(D());var Nn=({unapproved:t})=>{let e=t.params?.message,o=In({unapproved:t});return Sn.default.createElement(Cn,{message:e,unapproved:t,tipMessage:o})};i();a();var Tt=A(D());var En=A(Po());i();a();var Zt={AMOUNT:1,CONFIRM:2};var Qe=Zt.AMOUNT;function mr({unapproved:t}){let{from:e,type:o=U.BRC20_INSCRIBE,tick:n="",tid:r,amount:s,txSource:c=zt.DAPP}=t?.params?.transaction||{},_=t?.localType||po,[d,O]=(0,Tt.useState)(Qe),x=mt(),w=(0,En.useHistory)(),l=ut({localType:_})?.netWorkId;l===void 0?l=Ft(_):l=+l;let f=Ee(()=>o===U.BRC20_INSCRIBE?{chainId:l,coinType:be(l),symbol:n}:null,[o,r,n,l]),N=Ut(void 0,{},f)?.coinId,E=(0,Tt.useCallback)(async()=>{await x(ct(t.id)),await x(Ct()),await tt(x)},[x,t.id]),W=vt({from:e,chainIndex:Ft(_),handleCancel:E,method:t?.method}),b=(0,Tt.useCallback)(()=>{O(Zt.CONFIRM),Qe=Zt.CONFIRM},[]),T=(0,Tt.useCallback)(async({txIds:X,commitTx:G,revealTxs:st})=>{await x(nt(t.id,{txIds:X,commitTx:G,revealTxs:st})),await x(Ct()),w.push(Ao)},[x,w,t.id]),P=(0,Tt.useCallback)(()=>{O(Zt.AMOUNT),Qe=Zt.AMOUNT},[]);return Tt.default.createElement(fn,{fromAddress:e,coinId:N},d===Zt.AMOUNT?Tt.default.createElement(dn,{amount:s,walletId:t.walletId,onCancel:E,onConfirm:b,headerProps:{closeable:!1,backable:!1}}):Tt.default.createElement(_n,{addressCheckRet:W,txSource:c,onCancel:E,onConfirm:T,walletId:t.walletId,headerProps:{onBack:P,closeable:!1,backable:!0}}))}var bn=mr;i();a();var p=A(D());var Zn=A(Po());i();a();var to=A(D());i();a();function kn(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(e=>{let{direction:o,amount:n,usdAmount:r,symbol:s,logo:c}=e;return{operator:o===1?"+":"-",usdValue:r,rawValue:n,asset:{assetType:Jo.NATIVE,amount:n,symbol:s,imageUrl:c}}})}var cr=({address:t,hexStringList:e=[],chainIndex:o=0},n={})=>{let r=e?.toString(),s={ready:o!==void 0&&!!e?.length,refreshDeps:[t,r,o],...n},{loading:c,data:_,error:d}=wo(async()=>(await Io({address:t,hexStringList:e,chainIndex:o})).data,s);return{loading:c,data:_,error:d}},lr=t=>(0,to.useMemo)(()=>!t||!t.length?[]:t.map(e=>{let{assetChange:o=[],assetInversion:n}=e;return{status:e.analysisStatus,gasFee:e?.gasFee||0,isShowFee:e?.isShowFee,exploreUrl:e?.exploreUrl,inputInfo:e?.inputInfo||[],outputInfo:e?.outputInfo||[],assetChange:kn(o),assetInversion:n||!1}}),[t]),ur=(t=[])=>(0,to.useMemo)(()=>!t||!t.length?null:t.some(o=>o.status>0)?Et.EXECUTE_ERROR:null,[t]);function An(t={},e={}){let{loading:o,data:n,error:r}=cr(t,e),{utxoAllInfos:s}=n||{},c=lr(s),_=ur(c);return{loading:o,error:r||_,data:c}}i();a();var g=A(D());var pe=A(Bo());i();a();function eo(t){return t===_o.XRC_NFT}i();a();var ue=A(D());var Bn=A(ir());i();a();var Pn={address:"_address_11ipy_1"};function oo({children:t,addresses:e=[],exploreUrl:o=""}){let n=e[0],r=ee(()=>{(0,Bn.default)(n),Uo.success({title:m("wallet_receive_toast_address_copied"),desc:""})},[n]),s=ee(()=>{o&&globalThis.platform.openTab({url:`${o}${n}`})},[n,o]);return e.length>1?t:ue.default.createElement(je.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:ue.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"center"},ue.default.createElement(I.Text,{forceWrap:!0,size:I.SIZE.sm,className:Pn.address},n),ue.default.createElement(lt,{size:lt.SIZE.xs,icon:"okx-wallet-plugin-copy",onClick:r,style:{marginLeft:8}}),ue.default.createElement(lt,{size:lt.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:s,style:{marginLeft:8}})),trigger:je.TRIGGER.hover},t)}i();a();var L={content:"_content_c8f5u_1",none:"_none_c8f5u_4",title:"_title_c8f5u_7",input:"_input_c8f5u_12",utxoContainer:"_utxoContainer_c8f5u_12",isCurrentAddr:"_isCurrentAddr_c8f5u_12",signTag:"_signTag_c8f5u_12",output:"_output_c8f5u_15",addrContainer:"_addrContainer_c8f5u_21",address:"_address_c8f5u_26",amount:"_amount_c8f5u_35",xrcAssetsContainer:"_xrcAssetsContainer_c8f5u_47",xrcAssetsTitle:"_xrcAssetsTitle_c8f5u_53",xrcAssetContainer:"_xrcAssetContainer_c8f5u_59",logo:"_logo_c8f5u_62",isNFT:"_isNFT_c8f5u_69",isNft:"_isNFT_c8f5u_69",amountText:"_amountText_c8f5u_72",protocol:"_protocol_c8f5u_75",moreXRCContainer:"_moreXRCContainer_c8f5u_82",moreXrcContainer:"_moreXRCContainer_c8f5u_82",showMoreTitle:"_showMoreTitle_c8f5u_86",moreAssetsLogos:"_moreAssetsLogos_c8f5u_92",moreAssetsLogo:"_moreAssetsLogo_c8f5u_92",expandContainer:"_expandContainer_c8f5u_103",expandContainer_title:"_expandContainer_title_c8f5u_107",expandContainerTitle:"_expandContainer_title_c8f5u_107",expandContainer_leftTotal:"_expandContainer_leftTotal_c8f5u_113",expandContainerLeftTotal:"_expandContainer_leftTotal_c8f5u_113",expandContainer_icon:"_expandContainer_icon_c8f5u_120",expandContainerIcon:"_expandContainer_icon_c8f5u_120"};var no="inputInfo",Ln="outputInfo",We={xrcAsset:10,utxo:50},pr=({coinId:t,data:e={},currentAddr:o})=>{let[n,r]=(0,g.useState)({}),[,s]=Vo(t,{withPrice:!0}),c=bo(Co),_=(0,g.useMemo)(()=>[no,Ln].map(f=>{let M=e[f]||[],N=n[f]||!1;return M.map((E,W)=>{let b=n[`${f}-${W}`]||!1,T=E.xrcAssets||[];return E.xrcToShow=b?T:T.slice(0,We.xrcAsset),E.moreXRC=T.slice(We.xrcAsset),E}),{key:f,exploreUrl:e.exploreUrl,allData:M,dataToShow:N?M:M.slice(0,We.utxo),moreData:M.slice(We.utxo)}}),[e,n]),d=(0,g.useCallback)((l=[])=>l.reduce((f,{amount:M})=>B.add(f,M),0),[]),O=(0,g.useCallback)(l=>{switch(l){case no:return m("wallet_extension_asset_input_inputs_num",{amount:_[0].allData.length});case Ln:return m("wallet_extension_asset_outputs",{amount:_[1].allData.length});default:return""}},[_]),x=(0,g.useCallback)(l=>{r(f=>({...f,[l]:!0}))},[]),w=l=>{let{protocolType:f}=l||{};return eo(f)?l.logo||Eo:l.logo||No},S=g.default.memo(({xrcAssets:l=[]})=>g.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:L.moreAssetsLogos},l.slice(0,3).map(f=>g.default.createElement("img",{className:L.moreAssetsLogo,src:f.logo||"",alt:f.symbol}))));return g.default.createElement(Ue,{copyable:!1,title:m("wallet_extension_asset_btn_transaction_details")},_.map((l,f)=>{let M=f;return g.default.createElement("div",{key:M,className:(0,pe.default)(L.content,l.key===no?L.input:L.output,l.dataToShow.length===0?L.none:"")},g.default.createElement("div",{className:(0,pe.default)(L.title)},O(l.key)),l.dataToShow.map((N,E)=>{let W=`${M}-${E}`;return g.default.createElement(g.default.Fragment,null,g.default.createElement(u.FlexBox,{key:W,align:u.ALIGN.center,justify:"space-between",className:(0,pe.default)(L.utxoContainer,o===N.address[0]?L.isCurrentAddr:"")},g.default.createElement("div",{className:(0,pe.default)(L.addrContainer)},g.default.createElement(oo,{addresses:N.address,exploreUrl:l.exploreUrl},g.default.createElement("div",{className:L.address},N.address.length>1?m("wallet_extension_asset_title_multisig"):Ro(N.address[0]))),g.default.createElement(Wo,{className:L.signTag,size:$e.SIZE.sm},m("wallet_extension_asset_tag_sign"))),g.default.createElement("div",{className:L.amount},g.default.createElement(I.DisplayAmount,{noStyle:!0,amount:N.amount,mode:I.CRYPTO,symbol:s?.symbol,decimals:s?.decimals,precision:s?.decimals,isStableCoin:s?.stableCoin,currencySign:c}))),N.xrcToShow.length>0&&g.default.createElement("div",{className:L.xrcAssetsContainer},g.default.createElement(I.Text,{size:I.SIZE.xs,className:L.xrcAssetsTitle},m("wallet_extension_asset_include_asset")),N.xrcToShow.map(b=>g.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:L.xrcAssetContainer},g.default.createElement("img",{className:(0,pe.default)(L.logo,eo(b.protocolType)?L.isNFT:""),src:w(b),alt:b.symbol}),g.default.createElement(I.Text,{nowrap:!0,size:I.SIZE.xs,ellipsis:{tooltip:!0},className:L.amountText},`${b.amount} ${b.symbol}`),g.default.createElement(vo,{className:L.protocol,size:$e.SIZE.sm},b.protocolName))),N.moreXRC.length>0&&!n[`${l.key}-${E}`]?g.default.createElement(u.FlexBox,{align:u.ALIGN.center,onClick:()=>{x(`${l.key}-${E}`)},className:L.moreXRCContainer},g.default.createElement(S,{xrcAssets:N.moreXRC}),g.default.createElement("div",{className:L.showMoreTitle},m("wallet_extension_asset_btn_show_num_asset",{amount:B.thousandFormat(N.moreXRC.length)})),g.default.createElement(lt,{icon:"okx-wallet-plugin-arrow-small-down",size:lt.SIZE.xs})):null))}),l.moreData.length>0&&!n[l.key]?g.default.createElement("div",{className:L.expandContainer,onClick:()=>{x(l.key)}},g.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between"},g.default.createElement("div",{className:L.expandContainer_title},m("wallet_extension_asset_more_amount_inputs",{amount:B.thousandFormat(l.moreData.length)})),g.default.createElement(u.FlexBox,null,g.default.createElement("div",{className:L.expandContainer_leftTotal},g.default.createElement(I.DisplayAmount,{noStyle:!0,amount:d(l.moreData),mode:I.CRYPTO,symbol:s?.symbol,decimals:s?.decimals,precision:s?.displayPrecision,isStableCoin:s?.stableCoin,currencySign:c})),g.default.createElement(lt,{icon:"okx-wallet-plugin-arrow-small-down",size:Yo.xs,className:L.expandContainer_icon})))):null)}))},Fn=pr;i();a();var et=A(D());i();a();var Te={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function dr({psbts:t=[],loading:e,onClick:o}){let n=(0,et.useCallback)(s=>{o(s)},[o]);return et.default.createElement(et.default.Fragment,null,(()=>e?et.default.createElement("div",{className:Te.scrollArea},et.default.createElement("div",{className:Te.loading},et.default.createElement(Oo.Circle,null))):t.length===0?et.default.createElement(Mo.State,{className:Te.empty}):et.default.createElement("div",{className:Te.scrollArea},et.default.createElement(pt,{bordered:!1},(t||[]).map((s,c)=>et.default.createElement(rn,{key:s,onClick:()=>{n(c)},label:m("wallet_extension_asset_transaction_confirmation",{amount:qo(c+1)}),value:ko(s)})))))())}var On=(0,et.memo)(dr);i();a();var ro=A(D());var _r=t=>{let{loading:e,analyzeRet:o,noFold:n=!1}=t,{assetChange:r=[]}=o;return e?ro.default.createElement(yn,null):ro.default.createElement(Tn,{assetChange:r,noFold:n,showDappInfo:!1})},Re=_r;i();a();var dt=A(D());i();a();var Wt={main:"_main_1h9ym_1",box:"_box_1h9ym_6",tipImg:"_tipImg_1h9ym_12",tipImgIcon:"_tipImgIcon_1h9ym_21",tipImgPic:"_tipImgPic_1h9ym_25",title:"_title_1h9ym_29",decs:"_decs_1h9ym_37",w100:"_w100_1h9ym_43",footerWrap:"_footerWrap_1h9ym_46"};var fr=({visible:t,onCancel:e,onConfirm:o,headerProps:n,psbtHasMultiXRCAsset:r,paymentUseXRCAsset:s,assetInversion:c})=>{let _=(0,dt.useMemo)(()=>r?m("wallet_extension_tip_multiple_inscription_use"):s?m("wallet_extension_desc_inscription_asset"):c?m("wallet_extension_bot_desc_nft_high_pay"):"",[c,s,r]),d=Je({light:"/cdn/assets/imgs/254/1A753CC7A4597254.png",dark:"/cdn/assets/imgs/254/5A6525A2E28CDA88.png"}),O=Je({light:"/cdn/assets/imgs/2411/435A510ADAEB8439.png",dark:"/cdn/assets/imgs/2411/FF2841348F871214.png"});return dt.default.createElement(oe,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:rt.SIZE.lg},cancelBtnProps:{size:rt.SIZE.lg},cancelText:m("wallet_extension_function_btn_continue_transaction"),confirmText:m("wallet_extension_mid_dialog_btn_cancel"),onCancel:e,onConfirm:o,onClose:e},dt.default.createElement(u.FlexBox,{className:Wt.main,direction:u.DIRECTION.vertical},dt.default.createElement(u.Box,{className:Wt.box},dt.default.createElement(u.Box,{className:Wt.tipImg},dt.default.createElement(Fo,{src:c?d:O,className:Wt.tipImgPic})),dt.default.createElement(I.Text,{className:Wt.title,align:I.ALIGN.center},c?m("wallet_extension_bot_title_high_valuediff"):m("wallet_extension_title_transaction_risk")),dt.default.createElement(I.Text,{className:Wt.decs,size:I.SIZE.sm,align:I.ALIGN.center},_)),dt.default.createElement(u.Box,{className:Wt.w100},dt.default.createElement(Re,{...n,showDappInfo:!1,loading:!1,noFold:!0}))))},Mn=fr;i();a();var Ye=A(D());var xr=()=>{let[t,e]=(0,Ye.useState)(""),o=async()=>{let{data:n}=await lo(mo.getSignPrompt);n.assetReminder?e(n.assetReminder):e(null)};return(0,Ye.useEffect)(()=>{o()},[]),{assetReminder:t}},Dn=xr;i();a();var Un=A(D());var gr=({onConfirm:t})=>(0,Un.useCallback)(()=>{oe.warn({title:m("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:m("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:rt.TYPE.outline,size:rt.SIZE.lg},cancelBtnProps:{type:rt.TYPE.highlight,size:rt.SIZE.lg},onConfirm(e){e.destroy(),t()},async onCancel(e){e.destroy()},cancelText:m("commonall_text_btn_cancel"),confirmText:m("wallet_extension_asset_btn_continue")})},[t]),vn=gr;i();a();var de=A(D());i();a();var Y=A(D()),so=A(Bo());i();a();var _t={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var Wn=t=>{let{children:e,desc:o,title:n,isPureScreen:r}=t;return Y.default.createElement(u.FlexBox,{className:_t.main,direction:u.DIRECTION.vertical},Y.default.createElement(u.Box,{className:(0,so.default)(_t.box,{[_t.isPureScreen]:r})},Y.default.createElement(u.Box,{className:_t.tipImg},Y.default.createElement(Lo,{className:(0,so.default)("okx-wallet-plugin-risk-trading",_t.tipImgIcon)})),Y.default.createElement(I.Text,{className:_t.title,align:I.ALIGN.center},n),Y.default.createElement(I.Text,{className:_t.decs,size:I.SIZE.sm,align:I.ALIGN.center},o)),Y.default.createElement(u.Box,{className:_t.footerWrap},e))},Cr=({modalParams:t,handleCancel:e,handleNext:o})=>{let{screenOne:n,screenTwo:r}=t,[s,c]=(0,Y.useState)(!1),_=async()=>{c(!0),await e(),c(!1)};return Y.default.createElement(Wn,{desc:n.desc,title:n.title},Y.default.createElement(u.Box,{className:_t.screenOneButtons},Y.default.createElement(rt,{block:!0,loading:s,size:rt.SIZE.lg,onClick:_,type:rt.TYPE.highlight,category:rt.CATEGORY.fill},n.mainBtnText),r?Y.default.createElement(u.Box,{className:_t.extButton,onClick:o},n.subBtnText):null))},Tr=({handleCancel:t,handleNext:e,modalParams:o})=>{let{screenTwo:n={}}=o,{loading:r,onClick:s}=K(e),{loading:c,onClick:_}=K(t),d=[{loading:r,actionType:v.ACTION_TYPE.CANCEL,btnText:n.subBtnText,onClick:s},{loading:c,actionType:v.ACTION_TYPE.CONFIRM,btnText:n.mainBtnText,onClick:_}];return Y.default.createElement(Wn,{isPureScreen:!0,desc:n.desc,title:n.title},Y.default.createElement(u.Box,{className:_t.screenTwoButtons},Y.default.createElement(v,{buttonGroup:d})))},yr=({handleCancel:t,closeModal:e,modalParams:o})=>{let[n,r]=(0,Y.useState)(1);return n===2?Y.default.createElement(Tr,{modalParams:o,handleCancel:t,handleNext:e}):Y.default.createElement(Cr,{modalParams:o,handleCancel:t,handleNext:()=>{r(2)}})},Rn=yr;i();a();var Xn=A(D());i();a();var Yn={extLink:"_extLink_1eb1z_1"};var Ir=()=>{let t=Zo(),e=r=>({title:m("wallet_extension_fractal_title_transaction_risky"),desc:m(r,{case:Xn.default.createElement(Xo,{className:Yn.extLink,href:t?.scamsUrl},m("wallet_extension_function_link_case"))}),mainBtnText:m("wallet_extension_function_btn_cancel"),subBtnText:m("wallet_extension_function_btn_advanced")}),o={title:m("wallet_extension_fractal_title_transaction_risky"),desc:m("wallet_extension_function_desc_developer_continue"),mainBtnText:m("wallet_extension_mid_dialog_btn_cancel"),subBtnText:m("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:e("wallet_extension_fractal_desc_transaction_risky"),screenTwo:o})}},Gn=Ir;var hr=({psbtsInfoErr:t,handleCancel:e})=>{let{getUTXONotFoundModalParams:o}=Gn(),n=(0,de.useRef)(),r=s=>{n.current||(n.current=oe.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:de.default.createElement(Rn,{modalParams:s,handleCancel:async()=>{await e(),n.current.destroy(),n.current=null},closeModal:()=>{n.current.destroy(),n.current=null}})}))};(0,de.useEffect)(()=>{t?.code==Et.UTXO_NOT_FOUND&&r(o())},[t])},zn=hr;i();a();i();a();var io=A(co());var qn=t=>{try{return io.Psbt.fromHex(t).toBase64()}catch{return io.Psbt.fromBase64(t),t}};var Xe=A(co());var bt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},Hn=t=>{try{let e=Xe.Psbt.fromBase64(qn(t)),o=e?.data?.inputs||[],n=e?.data?.globalMap?.unsignedTx?.tx?.outs||[],r=[];return o.forEach((s,c)=>{if(s.witnessUtxo)r.push({...s,value:s.witnessUtxo.value});else if(s.nonWitnessUtxo){let _=Xe.Transaction.fromBuffer(s.nonWitnessUtxo),d=e?.data?.globalMap?.unsignedTx?.tx?.ins||[],x=_.outs[d[c]?.index]?.value;r.push({...s,value:x})}}),{inputs:r,outputs:n}}catch{return{inputs:[],outputs:[]}}},Rt=(t,e=0,o)=>!Array.isArray(t)||o===0?0:t.slice(e,o?e+o:void 0).reduce((n,{value:r})=>B.add(n,r),0);var Vn=({unapproved:t})=>{let{psbt:e,psbts:o,type:n,from:r,amount:s=1,psbtOpts:c,broadcast:_=!1}=t.params.transaction,{origin:d,method:O}=t,x=t.method===J.SIGNPSBTS,w=t?.walletId,S=t?.localType,f=ut({localType:S})?.coinId;f===void 0&&(f=wt(S));let M=ne(w),N=re(w),E=le(w),{loading:W,data:b,error:T}=An({address:r,hexStringList:x?o:[e],chainIndex:Ft(S)}),[P,X]=(0,p.useState)(!1),[G,st]=(0,p.useState)(0),z=(0,p.useMemo)(()=>x&&!P,[x,P]),h=(0,p.useMemo)(()=>b[G]||{},[b,G]),{assetReminder:q}=Dn(),R=mt(),St=(0,Zn.useHistory)(),ft=mn(t),{name:yt,icon:xt,host:Yt}=ft,{inputs:Vt,outputs:$}=Hn(x?o[G]:e),ot=(0,p.useMemo)(()=>B.sub(Rt(Vt),Rt($)),[Vt,$]),Nt=xn(),jt=(0,p.useMemo)(()=>{if(n!==bt.TRADE&&n!==bt.RUNES)return null;let V=Number(s);if(n===bt.RUNES){let Qt=Rt($,1,V),te=B.add(Rt($,0,1),Rt($,$.length-V+1,V-1));return`${B.sub(te,B.add(Qt,ot))}`}let gt=Rt($,V+1,V),Lt=Rt($,1,V);return`${B.sub(Lt,B.add(gt,ot))}`},[s,ot,$,n]),It=(0,p.useCallback)(async()=>{await R(ct(t.id)),await tt(R)},[R,t.id]),{addressCheckError:ht,addressCheckLoading:Pt}=vt({handleCancel:It,from:r,method:O,chainIndex:Ft(S)}),Q=(0,p.useMemo)(()=>M&&x?{type:j.TIP_TYPE.COMMON_ERROR,message:m("extension_wallet_contractual_interaction_wallet_unavailable")}:N?{type:j.TIP_TYPE.COMMON_ERROR,message:m("wallet_extension_top_toast_dapp_comingsoon")}:ht?{type:j.TIP_TYPE.COMMON_ERROR,message:ht}:T?{type:Ce.TYPE.warn,message:m("wallet_extension_asset_alert_trust_network")}:q&&!d?.includes("okx.com")?{type:Ce.TYPE.warn,message:q}:{},[M,x,N,T,q,d,ht]),Bt=(0,p.useCallback)(async()=>{let V=uo(S);try{let gt=await $o(x?o:e,r,w,{localType:V,isPsbts:x},c);await R(nt(t.id,{signedTx:gt,broadcast:_}))}catch(gt){await Nt({id:t.id,error:gt?.message||"Error"})}await tt(R)},[St,r,Nt,R,x,S,e,c,o,t.id,w]);zn({psbtsInfoErr:T,handleCancel:It});let $t=vn({onConfirm:Bt}),[Jt,Z]=(0,p.useState)(!1),Xt=(0,p.useMemo)(()=>{let V=h?.inputInfo||[],gt=h?.outputInfo||[],Lt=V.filter(it=>it.address?.includes(r)),Qt=gt.filter(it=>it.address?.includes(r)),te=[],Se=[];return Lt.forEach(it=>{it.xrcAssets&&it.xrcAssets.forEach(at=>{te.some(ge=>ge.symbol===at.symbol&&ge.protocolId===at.protocolId)||te.push({symbol:at.symbol,protocolId:at.protocolId})})}),Qt.forEach(it=>{it.xrcAssets&&it.xrcAssets.forEach(at=>{Se.some(ge=>ge.symbol===at.symbol&&ge.protocolId===at.protocolId)||Se.push({symbol:at.symbol,protocolId:at.protocolId})})}),te.length>0&&Se.length>0?!te.every(it=>Se.some(at=>it.symbol===at.symbol&&it.protocolId===at.protocolId)):!1},[h,r]),Kt=(0,p.useMemo)(()=>{let V=h.inputInfo||[],gt=h.outputInfo||[];return[...V,...gt].some(Lt=>!!(Lt.xrcAssets&&Lt.xrcAssets.length>1))},[h]),_e=(0,p.useMemo)(()=>b.some(V=>{let gt=V.inputInfo||[],Lt=V.outputInfo||[];return[...gt,...Lt].some(Qt=>!!(Qt.xrcAssets&&Qt.xrcAssets.length>1))}),[b]);(0,p.useEffect)(()=>{z||(Kt||Xt||h.assetInversion)&&Z(!0)},[b,z,Kt,Xt,h.assetInversion]);let Ie=(0,p.useCallback)(()=>{if(!_e||!z){Bt();return}$t()},[_e,Bt,$t,z]),he=(0,p.useCallback)(V=>{X(!0),st(V)},[X]),{loading:we,onClick:H}=K(It),{loading:Gt,onClick:fe}=K(Ie),qe=(0,p.useMemo)(()=>[{loading:we,actionType:v.ACTION_TYPE.CANCEL,btnText:z?m("wallet_extension_asset_btn_cancel_all"):m("wallet_dapp_connection_btn_reject"),onClick:H},{disabled:N||W||Q.type===j.TIP_TYPE.COMMON_ERROR,actionType:v.ACTION_TYPE.CONFIRM,btnText:z?m("wallet_extension_asset_btn_confirm_all"):m("extension_transactions_btn_confirm"),onClick:fe,loading:Gt||Pt}],[N,we,Gt,H,Q,fe,z,W,Pt]),He=(0,p.useMemo)(()=>{switch(n){case bt.LIST:return m("extension_wallet_transfer_maintitle_list");case bt.UNLIST:return m("extension_wallet_transfer_maintitle_cancel_listing");case bt.TRADE:return m("extension_wallet_transfer_maintitle_transaction");default:return m("extension_wallet_transfer_maintitle_transaction")}},[n]),xe=(0,p.useMemo)(()=>n==="list"||h&&!h.isShowFee?!1:B.gt(h.gasFee,0)||B.gt(ot,0),[ot,h,n]),rr=(0,p.useMemo)(()=>!T||T===Et.EXECUTE_ERROR&&h.status!==Et.PSBT_ANALYSIS_FAILED,[T,h]),sr=(0,p.useMemo)(()=>T&&T!==Et.EXECUTE_ERROR||h?.status===Et.PSBT_ANALYSIS_FAILED,[T,h]);return p.default.createElement(u.Container,null,x&&P&&p.default.createElement(Ho,{backable:!0,closeable:!1,onBack:()=>{X(!1)}}),p.default.createElement(ie,{injectInfo:{title:He,subTitle:z?"":Yt,identify:!0}}),p.default.createElement(pt,{bordered:!1},p.default.createElement(Dt.Thin,{compact:!0}),z?p.default.createElement(an,{summaryList:[{title:yt,desc:Yt,icon:{src:xt}}]}):null),z?p.default.createElement(On,{psbts:o,loading:W,onClick:he}):null,z?null:p.default.createElement(p.default.Fragment,null,rr&&p.default.createElement(Re,{coinId:f,loading:W,analyzeRet:h}),p.default.createElement(pt,{bordered:!1},p.default.createElement(Dt.Thin,{compact:!0}),sr&&(n===bt.TRADE||n===bt.RUNES)&&p.default.createElement(ae,{coinId:f,assetChange:jt,hideSign:!0}),p.default.createElement(ce,{coinId:f}),xe&&p.default.createElement(me,{coinId:f,networkFee:h.gasFee||ot}),p.default.createElement(Ht,{title:m("wallet_extension_network_address_title_walletused"),address:r,walletId:w,onCopyCallback:()=>{E({trade:"approve",all_confirmation:"wallet_used_address"})}}),p.default.createElement(sn,null,p.default.createElement(u.Space,{direction:u.DIRECTION.vertical,space:24},p.default.createElement("div",null),p.default.createElement(Fn,{coinId:f,data:h,currentAddr:r}),p.default.createElement(Ue,{data:x?o[G]:e,copyable:{hideDesc:!0}}))))),P?null:p.default.createElement(se,{placeholder:!0,offsetBottom:0,borderTop:!0},p.default.createElement(j,{coinId:f,...Q}),p.default.createElement(v,{buttonGroup:qe})),p.default.createElement(Mn,{visible:Jt,onCancel:()=>{Z(!1)},onConfirm:()=>{Z(!1),It()},headerProps:{coinId:f,txType:U.TRANS_OUT,analyzeRet:h},psbtHasMultiXRCAsset:Kt,paymentUseXRCAsset:Xt,assetInversion:h.assetInversion}))};i();a();var k=A(D());i();a();var jn={"retina-border-basic":"_retina-border-basic_9c07r_1",retinaBorderBasic:"_retina-border-basic_9c07r_1",container:"_container_9c07r_29",nav:"_nav_9c07r_33",main:"_main_9c07r_36",center:"_center_9c07r_42",group:"_group_9c07r_47",mt20:"_mt20_9c07r_56",mt12:"_mt12_9c07r_59",line:"_line_9c07r_62",address:"_address_9c07r_67",mt8:"_mt8_9c07r_72",utxosBlock:"_utxosBlock_9c07r_75",utxoBorder:"_utxoBorder_9c07r_80",data:"_data_9c07r_113"};var $n=({unapproved:t})=>{let e=t.walletId,{localType:o,method:n}=t,r=ut({localType:o}),s=r?.coinId;s===void 0&&(s=wt(o));let c=re(e),{memo:_,value:d,memoPos:O,to:x,satBytes:w,from:S,extraParams:l}=t.params.transaction,f=Ut(s),[M,{toggle:N}]=Mt(!1),[E,W]=(0,k.useState)(w?{level:Ot.CUSTOM,satBytes:w}:{}),b=E?.satBytes,T=mt(),[,P]=ke({coinId:s,address:S,chainId:f?.chainId}),X=P?.transferReminder;(0,k.useEffect)(()=>{if(!b&&P?.normal&&W({level:Ot.STANDARD,satBytes:P?.normal}),b&&E?.level!==Ot.CUSTOM){let Z=P[Fe[E?.level]?.satBytes];W({...E,satBytes:Z})}},[P]);let[G,st]=Pe({coinId:s,walletId:e,address:S,satBytes:b},{}),z=le(e),[h,q,R]=on({coinId:s,toAddr:x,walletId:e,fromAddr:S,satBytes:b,coinAmount:d,canTransferAmount:st},{}),St=(0,k.useMemo)(()=>!st||!q?!1:B.gte(st,B.add(q,d)),[st,d,q]),ft=Be({coinId:s,txType:U.TRANS_OUT,address:S}),yt=nn({memo:_,memoPos:O,coinId:s,toAddr:x,walletId:e,coinAmount:d,fromAddr:S,localType:f?.localType,dustSize:P?.minOutput,networkFee:q,satBytes:E.satBytes}),xt=Qo({coinId:s,walletId:e,satBytes:b,address:S,utxoType:qt.TRANSFER}),Yt=ne(e),[Vt,$]=(0,k.useState)(!1),ot=(0,k.useCallback)(async()=>{await T(ct(t.id)),await T(Ct()),await tt(T),$(!1)},[T,t.id]),Nt=(0,k.useCallback)(async()=>{let Z=await xt(d,q);await ft(Z,()=>{ot()}),$(!0);let Xt=await yt({utxoList:Z});t.id&&(await T(nt(t.id,{signedTx:Xt,coinAmount:d,serviceCharge:q,satPerByte:b,coinId:s,...l})),await T(Ct())),$(!1)},[ft,d,T,q,l,xt,ot,b,yt,t.id]),{loading:jt,onClick:It}=K(ot),{loading:ht,onClick:Pt}=K(Nt),{addressCheckError:Q,addressCheckLoading:Bt}=vt({method:n,from:S,handleCancel:It,chainIndex:r?.chainId||Ne}),$t=(0,k.useMemo)(()=>c?{type:j.TIP_TYPE.COMMON_ERROR,message:m("wallet_extension_top_toast_dapp_comingsoon")}:St?R?{type:j.TIP_TYPE.FEE_ERROR}:Q?{type:j.TIP_TYPE.COMMON_ERROR,message:Q}:{type:j.TIP_TYPE.COMMON_TIP,message:X}:{type:j.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[R,c,St,X,Q]),Jt=(0,k.useMemo)(()=>{let Z=[{actionType:v.ACTION_TYPE.CANCEL,btnText:m("wallet_dapp_connection_btn_reject"),onClick:It,loading:jt}];return St?Z=[...Z,{disabled:G||h||R||c||!Number(q)||!!Q,actionType:v.ACTION_TYPE.CONFIRM,onClick:Pt,loading:ht||Bt}]:Z=[...Z,{coinId:s,address:S,walletId:e,actionType:v.ACTION_TYPE.FILL_UP}],Z},[jt,s,ht,q,R,h,S,c,St,G,It,Pt,e,Bt,Q]);return k.default.createElement("div",{className:jn.container},k.default.createElement(Le,{coinId:s,...$t}),k.default.createElement(u.Container,null,k.default.createElement(ie,{injectInfo:{title:m("wallet_extension_send_colored_send"),identify:!0}}),k.default.createElement(pt,{bordered:!1},k.default.createElement(Dt.Thin,{compact:!0}),k.default.createElement(ae,{coinId:s,assetChange:d,hideSign:!0}),k.default.createElement(Dt.Thin,{compact:!0}),k.default.createElement(ce,{coinId:s}),k.default.createElement(me,{coinId:s,loading:h,estimateFailed:R,networkFee:q,level:E?.level,onClick:()=>{N(),z({trade:"send",all_confirmation:"network_fee"})}}),k.default.createElement(Ht,{walletId:e,address:S,title:m("extension_send_mid_text_from"),onCopyCallback:()=>{z({trade:"send",all_confirmation:"wallet_used_address"})}}),k.default.createElement(Ht,{address:x,title:m("extension_send_mid_text_to"),onCopyCallback:()=>{z({trade:"send",all_confirmation:"to_address"})}}),!!st&&k.default.createElement(Me,{coinBalance:st,coinId:s})),k.default.createElement(se,{placeholder:!0,offsetBottom:0,borderTop:!0},k.default.createElement(v,{buttonGroup:Jt})),k.default.createElement(Oe,{coinId:s,visible:M,signInfo:P,value:E,estimatedFee:q,onChange:W,onToggleVisible:N}),k.default.createElement(De,{visible:Yt&&Vt})))};i();a();var ye=A(D());i();a();function Jn(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}i();a();var ze=A(D());i();a();var F=A(D());i();a();var kt={"inscription-preview":"_inscription-preview_p4oy9_1",inscriptionPreview:"_inscription-preview_p4oy9_1","inscription-preview__inner":"_inscription-preview__inner_p4oy9_13",inscriptionPreviewInner:"_inscription-preview__inner_p4oy9_13","inscription-preview-text":"_inscription-preview-text_p4oy9_21",inscriptionPreviewText:"_inscription-preview-text_p4oy9_21","inscription-preview-image":"_inscription-preview-image_p4oy9_26",inscriptionPreviewImage:"_inscription-preview-image_p4oy9_26","inscription-item__container":"_inscription-item__container_p4oy9_30",inscriptionItemContainer:"_inscription-item__container_p4oy9_30","inscription-exceedTip":"_inscription-exceedTip_p4oy9_33",inscriptionExceedTip:"_inscription-exceedTip_p4oy9_33","inscription-extend":"_inscription-extend_p4oy9_38",inscriptionExtend:"_inscription-extend_p4oy9_38","inscription-extend__icon":"_inscription-extend__icon_p4oy9_42",inscriptionExtendIcon:"_inscription-extend__icon_p4oy9_42"};var ao=24,Ge={TEXT:"text",IMAGE:"image"},wr=F.default.memo(({type:t,contentType:e,body:o})=>{let[{inscriptionType:n,inscriptionContent:r},s]=So({inscriptionType:Ge.TEXT,inscriptionContent:o});return(0,F.useEffect)(()=>{if(t===U.ORDINAL_NFT||e?.startsWith("image/"))try{let c=URL.createObjectURL(new Blob([o]));s({inscriptionType:Ge.IMAGE,inscriptionContent:c})}catch{s({inscriptionType:Ge.TEXT,inscriptionContent:o})}finally{s({initing:!1})}},[o,e,s,t]),F.default.createElement(u.Box,{className:kt["inscription-preview"]},n===Ge.IMAGE?F.default.createElement("img",{alt:"",src:r,className:kt["inscription-preview-image"]}):F.default.createElement(u.Box,{className:kt["inscription-preview__inner"]},F.default.createElement(I.Text,{forceWrap:!0,className:kt["inscription-preview-text"]},r)))}),Sr=({type:t,contentType:e,body:o,rawBody:n})=>{let r=(0,F.useMemo)(()=>{let d=o?.length;return B.lt(d,1024)?`${d} B`:`${B.floorTruncate(B.div(d,1024),3)} KB`},[o?.length]),s=t===U.ORDINAL_NFT||e?.startsWith("image/"),c=s?n?.slice(0,200):n,_=(0,F.useMemo)(()=>Ke(c)>28?28:Ke(c),[c]);return F.default.createElement(u.FlexBox,{align:u.ALIGN.center},F.default.createElement(wr,{type:t,body:o,contentType:e}),F.default.createElement(u.FlexBox,{direction:u.DIRECTION.vertical,className:kt["inscription-item__content"]},F.default.createElement(I.AdaptiveText,{strong:!0,ellipsis:{tooltip:!s},text:c,autoSize:()=>_},c),F.default.createElement(I.Text,{size:I.SIZE.md,type:I.TYPE.secondary},r)))},Nr=({type:t,dataSource:e=[]})=>{let o=e?.length||0,[n,{toggle:r}]=Mt(!1),s=(0,F.useMemo)(()=>n?e?.slice(0,ao):e?.slice(0,3),[e,n]);return F.default.createElement(F.default.Fragment,null,F.default.createElement(zo,{space:24,renderEmpty:!1,dataSource:s,renderItem:c=>F.default.createElement(Sr,{...c,type:t})}),n&&o>ao&&F.default.createElement(I.Text,{size:I.SIZE.xs,type:I.TYPE.secondary,className:kt["inscription-exceedTip"]},m("wallet_info_dialog_desc_replicate_hide",{num:B.sub(o,ao)})),o>3&&F.default.createElement(u.FlexBox,{justify:"center",className:kt["inscription-extend"],onClick:r},F.default.createElement(lt,{size:lt.SIZE.xs,className:kt["inscription-extend__icon"],icon:n?"okx-wallet-plugin-arrow-small-up":"okx-wallet-plugin-add-arrow-chevrons"})))},Kn=Nr;i();a();var Qn={top:"_top_w7xvl_1"};function Er({unapproved:t}){let e=mt(),{id:o}=t,{type:n}=t.params?.transaction||{},r=To[n],{localType:s}=t,_=ut({localType:s})?.coinId;_===void 0&&(_=wt(s));let d=async()=>{await e(Ct()),await e(ct(t.id)),await tt(e)},O=async S=>{await e(nt(t.id,S)),await e(Ct())},{inscriptions:x}=ln(),w=r?m(r):null;return ze.default.createElement(un,{txId:o,headerProps:{title:w},confirmButtonProps:{onCancel:d,onConfirm:O},slot:{top:ze.default.createElement(u.Space,{direction:u.DIRECTION.vertical,space:24,className:Qn.top},ze.default.createElement(Kn,{type:n,dataSource:x,title:w}))},netWorkCoinId:_})}var tr=Er;var br=[U.BRC20_MINT,U.BRC20_INSCRIBE,U.BRC20_DEPLOY],kr=[U.RUNES_ETCH];function Ar(t,e){let o=xo(e);return br.includes(t)?o=fo(e):kr.includes(t)&&(o=go(e)),o}function Pr(t,e){return e.map(({contentType:o,body:n})=>{let r=n;try{(t===U.ORDINAL_NFT||typeof t!="number"&&o?.startsWith("image/"))&&(r=C.Buffer.from(n,"hex"))}catch{}return{contentType:o,body:r,rawBody:n}})}function Br({unapproved:t}){let{tick:e,type:o,from:n,to:r,txSource:s,inscriptions:c=[],amount:_,mintType:d=yo.parallel,noBroadCast:O=!1}=t.params?.transaction||{},{localType:x}=t,w=(0,ye.useMemo)(()=>Pr(o,c),[o,c]),S=ut({localType:x}),l=S?.netWorkId;l===void 0?l=Ft(x):l=+l;let f=S?.coinId;f===void 0&&(f=wt(x));let M=Ee(()=>{if(o===U.RUNES_ETCH){let[T,P]=Jn(c[0]?.body);if(P)return{chainId:l,coinType:Ve(l),symbol:e,address:"btc-runesMain-invalid-inscriptions"};let X=T?.id||"";return{chainId:l,coinType:Ve(l),symbol:e,address:`btc-runesMain-${X}`}}return e?{chainId:l,coinType:be(l),symbol:e}:null},[e,o,l]),N=Ar(o,l),E=Ut(void 0,{},M),W=(T,P)=>{if(o===U.RUNES_ETCH)return{...T,coinAmount:Ze(_,10**E?.decimals),coinId:E?.coinId||f,txSource:s||zt.DAPP};let X=0;return _&&E?.decimals&&(X=Ze(_,10**E?.decimals)),{...T,coinAmount:X,coinId:P?f:E?.coinId||f,txSource:s||zt.DAPP}},b=(T,P)=>({noBroadCast:O,commitParams:T?W(T,!0):null,revealParams:Array.isArray(P)?P.map(X=>W(X,!1)):P});return ye.default.createElement(pn,{params:{walletId:t.walletId,utxoType:qt.INSCRIPTION_USE_NFT_UTXO,from:n,to:r,inscriptions:w,txType:o,protocolId:N,mintType:d,netWorkCoinId:f},lifecycle:{beforePostTx:b}},ye.default.createElement(tr,{unapproved:t}))}var er=Br;i();a();var or=A(D());var Lr=({unapproved:t})=>{let e=mt(),{targetCoin:o}=t.params||{},n={image:o.logo,decimals:o.decimals,name:o.name,address:o.contractAddress,symbol:o.symbol},r=le(),s=ee(async()=>{r({all_confirmation:"cancel",trade:"add_token"}),await e(ct(t.id)),await tt(e)}),{loading:c,onClick:_}=K(s),d={actionType:v.ACTION_TYPE.CANCEL,btnText:m("wallet_dapp_connection_btn_reject"),onClick:_,loading:c},O=ee(async()=>{try{r({all_confirmation:"confirm",trade:"add_token"}),await Go(o),await e(nt(t.id)),await tt(e)}catch(f){Do.error(f?.data?.originalError?.msg||m("wallet_extenshion_toast_add_failed"))}}),{loading:x,onClick:w}=K(O),S={actionType:v.ACTION_TYPE.CONFIRM,onClick:w,loading:x},l=[d,S];return or.default.createElement(gn,{token:n,networkName:o.blockChain||o.localType,buttonGroup:l})},nr=Lr;var Gu=({unapproved:t})=>{switch(t.method){case J.TRANSFER_NFT:case J.SEND_INSCRIPTION:return At.default.createElement(hn,{unapproved:t});case J.SPLITUTXO:return At.default.createElement(wn,{unapproved:t});case J.INSCRIBE:case J.INSCRIBE_TRANSFER:return At.default.createElement(bn,{unapproved:t});case J.SIGNPSBT:case J.SIGNPSBTS:return At.default.createElement(Vn,{unapproved:t});case J.SIGN_MESSAGE:return At.default.createElement(Nn,{unapproved:t});case J.MINT:return At.default.createElement(er,{unapproved:t});case J.WATCHASSET:return At.default.createElement(nr,{unapproved:t});case J.SEND:case J.SEND_BTC:return At.default.createElement($n,{unapproved:t});default:return""}};export{Gu as default};
//# sourceMappingURL=Bitcoin-GKZ6AA42.js.map
