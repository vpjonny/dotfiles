import{a as M}from"./chunk-7LMS53CN.js";import{b as v}from"./chunk-GMVPA3MX.js";import{p as D}from"./chunk-BIUKJDG5.js";import{a as G}from"./chunk-MEZ72IGZ.js";import{d as N}from"./chunk-YLT6ZRGE.js";import{b as P}from"./chunk-NQGIYDUG.js";import{m as h}from"./chunk-CKHT4PIF.js";import{b as w,c as C}from"./chunk-NS5EW6UN.js";import{x as k}from"./chunk-KC2XLVFC.js";import{c as L}from"./chunk-EAE2NUFS.js";import{p as u}from"./chunk-3F7OC7N7.js";import{Qa as c,pa as g}from"./chunk-EQ34WRCJ.js";import{p as l}from"./chunk-DSNMNSMD.js";import{b}from"./chunk-FLSAETOH.js";import{f as X,o as R,q as y}from"./chunk-UWURTNRY.js";R();y();var t=X(b());var K="0";function it(f){let r=N(c)||{},s=h(g,f),[S,o]=(0,t.useState)(!0),[_,a]=(0,t.useState)(""),[p,E]=(0,t.useState)(""),d=async()=>{try{let{status:i}=await G({chainId:r?.chainId,coinId:c,address:s});E(i),i===u.NOT_STARTED?a(l("wallet_dialog_modal_not_registered")):i===u.PROCESSING?a(l("wallet_extension_transaction_notif_address_registering",{net:r?.chainName})):a("")}catch{a(l("wallet_extension_transaction_notif_address_register_fail",{net:r?.chainName}))}finally{o(!1)}},m=P("wallet-tx-status-toast",{onError:d,pollingInterval:10*1e3});return(0,t.useEffect)(()=>{d()},[m]),{loading:S,registerError:_,registerStatus:p}}function ct(f,r){let{transactions:s}=f?.params||{},S=k(r),o=h(g,f?.walletId),[_,a]=(0,t.useState)({overallFee:"0"}),{preExecuteRet:p,updateAndExecute:E}=v({coinId:c}),[d,m]=(0,t.useState)(!1),[i,I]=(0,t.useState)(!1),[U,B]=(0,t.useState)(null),O=async()=>{let e=await w({coinId:c,fromAddr:o,toAddr:""});return B(e),e},A=async e=>{let n={type:"multi_contract_call",nonce:e?.info?.nonce,chainId:D.StarknetChainId.SN_MAIN,multiContractCallData:{from:o,calls:s}};return(await L().signTransaction(n,o,g))?.signature},q=async e=>{let{data:n}=await C({coinId:c,address:o,inputData:e});return m(n?.queryGasLimitErrorUseDefault),n?.queryGasLimitErrorUseDefault?{overallFee:K}:n},T=async()=>{try{let e=await O(),n=await A(e),x=await q(n),W=await A(e),F=s?.[0]?.contractAddress||s?.[0]?.contract_address;E({value:0,from:o,to:F,txType:3,tokenAddress:F,data:W}),a({...x,resourceBounds:M(x)})}catch{m(!0)}finally{I(!1)}};return(0,t.useEffect)(()=>{s&&(I(!0),T())},[s]),(0,t.useEffect)(()=>{S===u.PROCESSING&&r===u.COMPLETED&&(I(!0),T())},[r]),{gasFee:_,feeLoading:i,feeError:d,signInfo:U,preExecuteRet:p?.[0]}}export{it as a,ct as b};
//# sourceMappingURL=chunk-4XE5R6CP.js.map
