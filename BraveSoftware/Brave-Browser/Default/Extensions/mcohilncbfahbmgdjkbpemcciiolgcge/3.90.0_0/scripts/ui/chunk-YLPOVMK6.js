import{c as we}from"./chunk-5DQKP6TK.js";import{a as f,f as Ne}from"./chunk-A7FGCMOW.js";import{a as ke}from"./chunk-RER2JAFZ.js";import{b as Oe,c as We,d as Me}from"./chunk-CJAFGYQK.js";import{Ea as R,Va as G,Wa as Re,h as Ae,nb as ye,o as Le,pa as T,s as be,va as I}from"./chunk-P5GHREX3.js";import{a as V,j as _e,z as b}from"./chunk-AP4E6GDF.js";import{E as te,F as k,Ia as re,Je as Ee,Ld as he,Mc as B,Md as pe,Nd as fe,Oc as oe,Od as H,Pd as Ce,Qd as ge,Rd as Te,Sa as U,Sd as Ie,Tc as l,Wc as ie,Wd as Se,Xa as A,_c as ne,c as E,cd as ae,d as Z,fd as le,ha as u,id as P,jd as de,k as M,lb as se,mb as m,n as ee,vd as ce,xd as F,yc as L,yd as ue,zd as me}from"./chunk-RPH2MNBW.js";import{a as Ve}from"./chunk-UIZGYUZK.js";import{b as _}from"./chunk-FLSAETOH.js";import{Aa as Q,l as g,ua as v}from"./chunk-4C5HF6J2.js";import{f as S,h as r,o,q as i}from"./chunk-UWURTNRY.js";o();i();o();i();o();i();o();i();var De=S(_());function Ge({children:a,...e}){return De.default.createElement(te,{fetchConfig:Ee.fetchConfig,...e},a)}o();i();o();i();Q();o();i();var w=[L.BTC_MAINNET,L.TON_MAINNET];o();i();var xe=(a,e)=>{let t=a.split(".").map(Number),s=e.split(".").map(Number),n=Math.max(t.length,s.length);for(let d=0;d<n;d++){let C=t[d]||0,p=s[d]||0;if(C>p)return 1;if(C<p)return-1}return 0};var y=class{constructor(){r(this,"commonStore",null);r(this,"userForbiddenWithBridge",U);r(this,"setUserForbiddenBridge",e=>{this.userForbiddenWithBridge=e});r(this,"defaultWalletConfig",oe);r(this,"walletConfig",this.defaultWalletConfig);r(this,"hasInitWalletInfo",!1);r(this,"setHasInitWalletInfo",e=>{this.hasInitWalletInfo=e});r(this,"referralInfo",{refCode:"",referralCommissionAddress:""});r(this,"setReferralInfo",e=>{this.referralInfo={refCode:e?.refCode||"",referralCommissionAddress:e?.referralCommissionAddress||""}});r(this,"chainId",f);r(this,"setChainId",e=>{this.chainId=e});r(this,"fromChainId",f);r(this,"setFromChainId",e=>{this.fromChainId=e});r(this,"addressType","");r(this,"setAddressType",e=>{this.addressType=e});r(this,"walletSupportMev",!1);r(this,"setWalletSupportMev",e=>{this.walletSupportMev=e});r(this,"checkOkxVersion",async()=>{let e="2.82.31",t=this.walletConfig.isOkxWallet;if(this.isConnectedWallet&&t&&window?.okxwallet?.getVersion){let s=await window.okxwallet.getVersion(),d=xe(s,e)>=0;this.setWalletSupportMev(d)}else this.setWalletSupportMev(!1)});r(this,"signWalletChainId",L.ETHEREUM_MAINNET)}getDeviceId(){}getChainId(){}get scanAppType(){throw new Error("scanAppType is not defined")}get walletType(){throw new Error("walletType is not defined")}get address(){return f}get computedForbiddenBridge(){let{computedIsCrossChain:e}=g(this.rootStore,"fromToStore",{});return e?this.userForbiddenWithBridge:U}get computedAccountId(){let{walletConfig:e}=this;return e.walletId}setWalletConfig(e={}){e.walletId!==this.walletConfig.walletId&&(this.referralInfo={refCode:"",referralCommissionAddress:""}),this.walletConfig=e}getAddressByChainId(){}get isConnectedWallet(){return!!this.walletConfig.walletId}get computedNonsupportChain(){return!this.isConnectedWallet||!b(this.fromChainId)?!1:!this.address}get computedAccountWalletAddresses(){return v(g(this,"walletConfig.address",[])).join(",")||this.address}get computedAccountWalletAddressesArray(){return v(g(this,"walletConfig.address",[]))||[this.address]}get computedMultiAddresses(){let e=[],t=[];return w.forEach(s=>{let n=this.getAddressByChainId(s);n&&(e.push(s),t.push(n))}),{targetChainId:e.join(),targetWalletAddress:t.join()}}setSignWalletChainId(e){this.signWalletChainId=e}get computedSignWalletAddress(){let e=this.computedAccountWalletAddressesArray;return e?.length===1?e[0]:this.getAddressByChainId(this.signWalletChainId)}cleanWalletConfig(){this.walletConfig=this.defaultWalletConfig,this.hasInitWalletInfo=!1}};o();i();o();i();function N(a=[],e=[]){let t={};a.forEach(n=>{t[n]=E});let s={};return e.forEach(n=>{s[n]=Z}),{...t,...s}}var ve=N(["walletConfig","chainId","hasInitWalletInfo","fromChainId","addressType","referralInfo"],["computedAccountId","isConnectedWallet","computedNonsupportChain","computedAccountWalletAddresses","computedAccountWalletAddressesArray","address","computedMultiAddresses"]);var K=class extends y{constructor(t){super();r(this,"formatWalletType",()=>{let{walletInfo:t}=u,{isHARDWARE:s,isMNEMONIC:n,isMPC:d,isPRIVATE:C}=t?.walletType||{};return s?A.HARDWARE:n?A.MNEMONIC:d?A.MPC:C?A.PRIVATE_KEY:null});r(this,"formatWalletAccount",t=>{let s=Object.values(t.account);return{...t,OKXWalletType:this.formatWalletType(),address:s}});r(this,"keyringIdentityTypeEnum",{});r(this,"walletList",[]);r(this,"addressBookList",[]);r(this,"hasInitWalletInfo",!1);r(this,"getAddressByChainId",t=>{if(!b(t))return f;let s=this.getWalletChainName(t);return this.walletConfig.account?.[s]||f});this.rootStore=t,this.commonStore=t.commonStore,M(this,ve)}async getDeviceId(){let{devid:t}=await u.localStore.get("devid");return t}getCurrentChainAddress(t){let s=this.rootStore?.fromToStore.from.chainId;if(!b(s))return f;let n=this.getWalletChainName(s);return t.account[n]}getWalletChainName(t){return u.getNetWorkName(t)}replaceAddressByType(t){if(this.addressType){let s={};return w.forEach(n=>{let d=this.getWalletChainName(n);if(t.account?.[d]){let p=t.accountsMap?.[d]?.[this.addressType]?.address;p&&(s[d]=p)}}),{...t,account:{...t.account,...s}}}return t}setWalletConfig(t){this.walletConfig=this.formatWalletAccount(this.replaceAddressByType(t)),this.hasInitWalletInfo=!0}webSwapHistoryDetailViewMore(){}setAddressBookList(t){this.addressBookList=t}setWalletList(t){this.walletList=t.map(s=>s.walletId===this.computedAccountId?this.replaceAddressByType(s):s)}setKeyringIdentityTypeEnum(t){this.keyringIdentityTypeEnum=t}get address(){return this.getAddressByChainId(this.fromChainId)}},Xt=K;o();i();o();i();var X=S(_());Q();o();i();var Qt={FROM:"FROM",TO:"TO"},Zt={COMMON:"COMMON",COLLECTION:"COLLECTION"},h={COLLECT_LIST:"COLLECT_LIST",ALL_NETWORK:"ALL_NETWORK",CHAIN_LIST:"CHAIN_LIST",SEARCH:"SEARCH",ALL_TOKENS:"ALL_TOKENS",HISTORY_LIST:"HISTORY_LIST"},Ke={[h.COLLECT_LIST]:{[l.SWAP]:H,[l.LIMIT_ORDER]:H,[l.BRIDGE]:Ce},[h.ALL_NETWORK]:{[l.SWAP]:pe,[l.LIMIT_ORDER]:he,[l.BRIDGE]:fe},[h.SEARCH]:{[l.SWAP]:Te,[l.LIMIT_ORDER]:ge,[l.BRIDGE]:Ie},[h.CHAIN_LIST]:{[l.ORDERS]:F,[l.SWAP]:F,[l.LIMIT_ORDER]:me,[l.BRIDGE]:ue},[h.ALL_TOKENS]:{[l.SWAP]:P,[l.LIMIT_ORDER]:P,[l.BRIDGE]:de},[h.HISTORY_LIST]:{[l.SWAP]:ne,[l.LIMIT_ORDER]:ae,[l.BRIDGE]:le}},Y=(a,e)=>Ke[a]?.[e]??"";var O=class{constructor(e){r(this,"watchTopDomRef",(0,X.createRef)());r(this,"watchBottomDomRef",(0,X.createRef)());r(this,"rootStore",null);r(this,"userUniqueId",Ae.initUniqueId());r(this,"chainListFreshCount",0);r(this,"chainList",[]);r(this,"setChainList",e=>{this.chainList=e,this.chainListFreshCount+=1});r(this,"transactionLoading",!1);r(this,"setTransactionLoading",e=>{this.transactionLoading=e});r(this,"nowCurrencyUnit",{});r(this,"tokenModalVisible",!1);r(this,"safemoonSlippage",0);r(this,"getChainListUrl",({isHistory:e,currentTab:t})=>{let s=Y(h.CHAIN_LIST,this.currentTab||t);return e&&(s=Y(h.CHAIN_LIST,t||this.currentTab)),s});r(this,"fetchChainList",async({businessLine:e=1,isLimit:t=!1,isHistory:s=!1,currentTab:n,chainIdConfig:d={}})=>{if(ee())return[];let C=this.getChainListUrl({isHistory:s,isLimit:t,currentTab:n}),[p,He]=await k(R.get(C,{params:{businessLine:t?ie.LIMIT_ORDER:e,...d}}));if(p)return I.error(T.CHAIN_LIST_LOAD_ERROR,{error:p}),[];let W=He?.data||[];return W.length||I.info(T.TOKEN_LIST_FETCH_RESULT_EMPTY,{data:{isLimit:t,isHistory:s,currentTab:n}}),!s&&this.setChainList(W),this.setCurrentTabChainList({[n||this.currentTab]:W}),W});r(this,"currentTabChainList",{});r(this,"setCurrentTabChainList",e=>{this.currentTabChainList={...this.currentTabChainList,...e}});r(this,"getTradeType",()=>this.rootStore?.fromToStore?.computedIsCrossChain?B.MULTI:B.SINGLE);r(this,"globalMessages",null);r(this,"setGlobalMessage",e=>{this.globalMessages=e});r(this,"cleanGlobalMessage",()=>{this.globalMessages=null});r(this,"socketStatus",!1);r(this,"balancePushSocketStatus",!1);r(this,"resetFromToByTabChange",!1);r(this,"setResetFromToByTabChange",e=>{this.resetFromToByTabChange=e});r(this,"portal",m.DEX);r(this,"setPortal",e=>{this.portal=e});r(this,"currencyConversion",e=>{let{usdToThisRate:t}=this.nowCurrencyUnit,s=V.BigNumber(e);return!t||s.isNaN()?"":s.multipliedBy(t)});r(this,"currencyReConversion",e=>{let{usdToThisRate:t}=this.nowCurrencyUnit,s=V.BigNumber(e);return!t||s.isNaN()?"":s.dividedBy(t).toString()});r(this,"isSensitiveChain",e=>this.computedSensitiveChainIds.some(t=>String(t)===String(e)));r(this,"getTokenAddress",e=>Oe(e,this.isSensitiveChain(e?.chainId)));r(this,"equalsChainId",(e,t)=>We(e,t));r(this,"equalsToken",(e,t)=>{let s=this.isSensitiveChain(e?.chainId);return Me(e,t,s)});r(this,"fromFillToken",!1);r(this,"currentTab","");r(this,"setCurrentTab",(e,t)=>{this.currentTab!==e&&(this.setResetFromToByTabChange(!0),this.rootStore?.fromToStore?.clearFromTo()),this.currentTab=e,this.fromFillToken=!!t});r(this,"forceUpdateFromToByHash",0);r(this,"forceUpdateFromTo",()=>{this.forceUpdateFromToByHash+=1});r(this,"isFirstInit",!0);r(this,"visibleAddFunds",!1);r(this,"setAddFundsVisible",e=>{this.visibleAddFunds=e});r(this,"currencyConversionWithSymbol",(e,t={})=>{let s=this.currencyConversion(e).toString(),n=this.computedNowCurrencySymbol;return _e(s,n,t)});r(this,"disclaimerVisible",we());r(this,"setDisclaimerVisible",e=>{this.disclaimerVisible=e});r(this,"buySellAmountChangedCount",0);r(this,"triggerBuySellAmountChanged",()=>{this.buySellAmountChangedCount+=1});r(this,"tradeTokenChangeMsg",{fromModule:"",tradeDirection:"",token:{},msgId:""});r(this,"sendTradeTokenChangeMsg",({fromModule:e,tradeDirection:t,token:s})=>{this.tradeTokenChangeMsg={fromModule:e,tradeDirection:t,token:s,msgId:`${e}-${t}-${new Date().getTime()}`}});this.rootStore=e,ke&&this.setPortal(m.LEDGER)}setChainType(){}get computedReserveGas(){let{chainList:e}=this,t=g(this.rootStore,"fromToStore.from.chainId");return e.find(n=>Number(n.chainId)===Number(t))?.reserveGas||""}getChainByID(e){return this.chainList.find(t=>(this.computedCurrentTabIsLimit||t.chainUsed)&&t.chainId===Number(e))}getUserUnit(){}get computedRealSlippageValue(){return g(this,"rootStore.slippageStore",{}).computedRealSlippageValue||0}setSocketStatus(e){this.socketStatus=e}setBalanceSocketStatus(e){this.balancePushSocketStatus=e}get computedIsWalletEnv(){return this.portal===m.OKX_WALLET_EXTENSION}get computedIsWalletDashBoard(){return this.portal===m.WALLET_DASHBOARD}get computedIsMarket(){return this.portal===m.MARKET}get computedNotThirdBiz(){return this.portal===m.OKX_WALLET_EXTENSION||this.portal===m.DEX||this.portal===m.MARKET}get computedNowCurrencySymbol(){return this.nowCurrencyUnit.symbol||""}get computedSensitiveChainIds(){return this.chainList.map(e=>Number(e.isSensitive)===re.YES?e.chainId:null).filter(Boolean)}get computedCurrentTabIsLimit(){return this.currentTab===l.LIMIT_ORDER}get computedIsUrlFillSwap(){return this.computedIsWalletDashBoard||this.computedIsWalletEnv}setIsFirstInit(e){this.isFirstInit=e}get computedTradeTokenChangeMsgId(){return this.tradeTokenChangeMsg.msgId}};o();i();var Ue=N(["userUniqueId","chainList","transactionLoading","nowCurrencyUnit","tokenModalVisible","safemoonSlippage","globalMessages","socketStatus","balancePushSocketStatus","portal","currentTab","currentTabChainList","forceUpdateFromToByHash","isFirstInit","visibleAddFunds","disclaimerVisible","buySellAmountChangedCount","tradeTokenChangeMsg"],["computedReserveGas","computedNowCurrencySymbol","computedSensitiveChainIds","computedIsWalletEnv","computedCurrentTabIsLimit","computedTradeTokenChangeMsgId"]);var q=class extends O{constructor(t){super(t);r(this,"swapCollapse",!1);r(this,"setSwapCollapse",t=>{this.swapCollapse=t});r(this,"chainListLoadError",!1);r(this,"setChainListLoadError",t=>{this.chainListLoadError=t});M(this,{...Ue,swapCollapse:E,chainListLoadError:E}),this.setPortal(se)}getUserUnit(t){this.nowCurrencyUnit=t}};o();i();o();i();var j=class{constructor(e){r(this,"updateTxHash",e=>(I.info(T.UPDATE_HASH,{...e,tags:{orderId:e.orderId,status:e?.status||1}}),R.post(ce,e).catch(t=>{I.info(T.UPDATE_HASH_ERROR,{...e,error:t,tags:{orderId:e.orderId}})})));r(this,"cancelOrder",e=>(I.info(T.CANCEL_ORDER,{tags:{orderId:e}}),R.get(Se,{params:{id:e}})));r(this,"cancelLimitOrder",()=>{});this.rootStore=e}},Be=j;var $=class extends Be{constructor(){super(...arguments);r(this,"sendTransaction",async(...t)=>G(...t));r(this,"sendTransactionEnhance",async(...t)=>G(...t));r(this,"signTransaction",async(t,s)=>{let[n,d]=await k(Re({message:t,chainId:s}));return[n,d]})}},Vr=$;o();i();var x=S(_());o();i();var D=S(Ve());async function Ye(a,e){let{devid:t}=await a.get("devid");return(s,n)=>{D.setDeviceId(t);let d=D.newInstance({site:"okex",product:s});return d.setApiEndpoint(`${e}/amplitude`),d.setCommonParams(Le()),n(d),d}}async function z(a,e){(await Ye(a,e))("web3_trade",be)}var Xe=()=>{let[a,e]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{let{getApiHostname:t}=u.global;z(u.localStore,t()).then(()=>e(!0)).catch(()=>{})},[]),{initialized:a}},es=Xe;o();i();var Pe=S(_());var as=()=>{(0,Pe.useEffect)(()=>{let a=u.global?.getWssHostname?.(),e=ye.global?.getWssHostname?.();Ne({baseUrl:`wss://${a||e}`})},[])};o();i();var Fe=S(_());var J=class extends Fe.PureComponent{constructor(e){super(e),this.state={hasError:!1,error:void 0,errorInfo:{}}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),(async()=>{try{let{logger:s,LOGGER_EVENT_MAP:n}=await import("./logger-IQORZWHN.js");this.props.isMainEntry?s.error("fatal rendering error",{error:e,errorInfo:t,level:"fatal"}):s.error(n.ERROR_BOUNDARY,{error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}catch{}})()}onRetry(){this.setState({hasError:!1})}render(){let{error:e,errorInfo:t,hasError:s}=this.state;return s?this.props.fallbackComponent({error:e,errorInfo:t,onRetry:()=>this.onRetry()}):this.props.children}};export{as as a,J as b,z as c,Ge as d,N as e,Xt as f,Qt as g,Zt as h,h as i,Y as j,q as k,Vr as l,es as m};
//# sourceMappingURL=chunk-YLPOVMK6.js.map
