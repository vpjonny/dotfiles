import{a as st,b as pt}from"./chunk-DZPLORMY.js";import{c as mt,k as ct}from"./chunk-EUAAIPZO.js";import{a as it}from"./chunk-ZFAUEPQW.js";import{a as Y}from"./chunk-QEPQGEPL.js";import{A as at,a as nt,l as H}from"./chunk-V7YATDMZ.js";import{d as rt}from"./chunk-YLT6ZRGE.js";import{a as X}from"./chunk-JYCBCMDP.js";import{a as ot,c as et}from"./chunk-GVYIP5Q5.js";import{n as tt}from"./chunk-CKHT4PIF.js";import{a as Q}from"./chunk-KC2XLVFC.js";import{b as J}from"./chunk-KGMP5AO5.js";import{c as V,h as q}from"./chunk-F3ILJHGP.js";import{c as B,m as G}from"./chunk-3F7OC7N7.js";import{a as v,c as R,k as z}from"./chunk-EPDR6VAQ.js";import{Z as F}from"./chunk-EQ34WRCJ.js";import{p as j}from"./chunk-DSNMNSMD.js";import{I as $}from"./chunk-URGJ6D4O.js";import{b as O}from"./chunk-FLSAETOH.js";import{Aa as Ct,Q as Z}from"./chunk-4C5HF6J2.js";import{a as Pt}from"./chunk-PESQD55U.js";import{f as k,o as T,q as I}from"./chunk-UWURTNRY.js";T();I();var c=k(O());var ut=k(Pt());T();I();var K=k(O());Ct();var St=n=>n.reduce((m,e)=>{let{gasLimit:a,gasPrice:o,maxFeePerGas:l,type:s}=e;return s===G.FEE_MARKET?R(m,v(a,l),{returnString:!0}):R(m,v(a,o,{returnString:!0}),{returnString:!0})},"0"),Et=({coinId:n,walletId:m,params:e})=>{let a=it(n,m),{coinAmountInt:o}=a,l=e[e.length-1],{gasLimit:s,gasPrice:d,maxFeePerGas:f,type:t}=l,u=(0,K.useMemo)(()=>t===G.FEE_MARKET?v(s,f):v(s,d),[s,d,f,t]),A=St(e),x=(0,K.useMemo)(()=>Z(o)||z.gte(o,A),[o,A]),p=et({coinId:n});return{networkFeeProps:{coinId:n,loading:!1,estimateFailed:!1,networkFee:u,network:p},isSufficientGas:x,coinWithBalance:a}},dt=Et;T();I();var M=k(O());var ht=({onCancel:n,onConfirm:m,params:e,from:a,walletAccount:o,baseCoin:l,preExecInfo:s,coinWithBalance:d,isSufficientGas:f})=>{let{loading:t,onClick:u}=Y(n),A=(0,M.useMemo)(()=>({loading:t,onClick:u,actionType:H.ACTION_TYPE.CANCEL}),[t,u]),{walletId:x}=o,{localType:p}=l||{},C=at({fromAddr:V(a,p),walletId:x,localType:q(p)}),L=async()=>{try{let E=await Promise.all(e.map(async b=>{let _=await C({params:b}),D=await nt(F,_);return{signedTx:_,txHash:D}}));await m({signedTxs:E})}catch(E){J("dex-2in1-tx-failed",{message:E?.message,from:e?.[0]?.from}),$.error(j("extension_wallet_error_toast_signature_failed"))}},{loading:W,onClick:P}=Y(L),{canConfirm:i}=s,{isBalanceLoadError:y}=d,S=(0,M.useMemo)(()=>y||i===!1||!f,[i,y,f]),N=(0,M.useMemo)(()=>({loading:W,onClick:P,disabled:S,actionType:H.ACTION_TYPE.CONFIRM}),[W,P,S]);return[A,N]},ft=ht;var wt=n=>{let{txId:m,params:e,onConfirm:a,onCancel:o,dappInfo:l,method:s,walletId:d,slot:f}=n,[t,u]=(0,c.useState)(e),[A,x]=(0,c.useState)({}),p=tt(F,d,""),{from:C,chainId:L}=t[0],[W={}]=ot({appBaseChain:"ethereum",realChainIdHex:L})||[],P=W?.coinId,i=rt(P),{networkFeeProps:y,isSufficientGas:S,coinWithBalance:N}=dt({coinId:P,walletId:d,params:t}),E=t.some(r=>!!r?.extParams?.isMev),b=(0,c.useMemo)(()=>({dappData:JSON.stringify(t),from:C,dappInfo:l||{},chainIndex:i?.chainId,method:s}),[i?.chainId]),_={txId:m,baseCoin:i,isSufficientGas:S,coinWithBalance:N},D=ft({onCancel:o,onConfirm:a,from:C,walletAccount:p,params:t,baseCoin:i,preExecInfo:A,coinWithBalance:N,isSufficientGas:S}),At=Q((r,h,g)=>{let w=X(h,Number(r)===B.INCREASE_ALLOWANCE?st:[]);return w?mt(t[0].data,{approveAmount:g},w):null});return c.default.createElement(ct,{slot:f,handleCancel:o,preExecParams:b,walletAccount:p,buttonGroup:D,onUpdatePreExecInfo:x,txState:_,localType:i?.localType,mevProps:{isMev:E,needMev:!0,onMevChange:ut.noop},networkFeeProps:y,onDataChange:r=>{let h=(r?.moduleList||[]).filter(g=>g?.moduleName==="approveInfo"||g?.data?.moduleType==="tx");u([{...t[0],data:h[0]?.data?.modifiedData},t[1]])},renderEditApproveAmount:(r,h)=>{let g=r?.authQuantity?.canEdit,w=r?.spender?.approvalType,gt=r?.txTitle?.data;return[B.INCREASE_ALLOWANCE,B.AUTHORIZATION].includes(w)&&g?c.default.createElement(pt,{txTypeInfo:{baseInfo:gt},onReject:o,walletAccount:p,approve:r,baseCoin:i,updateApproveInfo:(Tt,U)=>{let It=t[0].data,xt=At(w,It,U.amount);h(Tt,U,xt)}}):null}})},so=wt;export{so as a};
//# sourceMappingURL=chunk-STNL5AMR.js.map
