import{a as ze,b as We}from"./chunk-RDR2UL3Q.js";import"./chunk-OSD5TZNZ.js";import{a as He}from"./chunk-W25M53MS.js";import{a as je}from"./chunk-UX2JFEX5.js";import{a as te}from"./chunk-B5L26Z2J.js";import{d as Ue}from"./chunk-AVG63QW4.js";import{a as Fe,b as Be}from"./chunk-LZL7SWT5.js";import{E as Ne}from"./chunk-VHMBEOFX.js";import"./chunk-BYDDPVAA.js";import"./chunk-CKHT4PIF.js";import"./chunk-JMNZU6WB.js";import"./chunk-WXD7TULU.js";import"./chunk-JQHLKZPQ.js";import"./chunk-ZZBUS7GI.js";import"./chunk-PMG6IXOR.js";import{a as U}from"./chunk-BD5XO4WL.js";import"./chunk-7U7FORYL.js";import"./chunk-XJ2EVWVX.js";import"./chunk-DD6IGY5O.js";import"./chunk-5E7YC7OF.js";import"./chunk-LYGOKEAJ.js";import"./chunk-FLXVXXZH.js";import"./chunk-XBUPORYF.js";import{b as Me}from"./chunk-YVLQLIW6.js";import"./chunk-HBXZ3GPM.js";import"./chunk-6C7RJCTT.js";import{o as Y}from"./chunk-N6PI3XTA.js";import"./chunk-7DW2ZPOD.js";import"./chunk-JW2AVC2H.js";import"./chunk-AKOAGCJX.js";import"./chunk-ARDRUD4P.js";import"./chunk-WYX7GFOD.js";import{a as w}from"./chunk-G6PA2JD3.js";import"./chunk-N2N44VBE.js";import"./chunk-ZDJRNLYZ.js";import"./chunk-RV5WZKGQ.js";import"./chunk-MJSLAJV6.js";import{n as Ee,p as ee}from"./chunk-KC2XLVFC.js";import"./chunk-MJDO2VHF.js";import"./chunk-TFTCL6XD.js";import"./chunk-TBQGFYU3.js";import"./chunk-L5AZICLM.js";import"./chunk-WLEQHCLB.js";import{I as Oe,a as Se,l as ve,m as Ae}from"./chunk-QF42JCDG.js";import"./chunk-DRCTWZQB.js";import"./chunk-KGMP5AO5.js";import"./chunk-EAE2NUFS.js";import"./chunk-OLICTWCW.js";import"./chunk-6M37VPK2.js";import"./chunk-WOJGOC63.js";import{k as Pe}from"./chunk-OKGWI7CU.js";import"./chunk-EPDR6VAQ.js";import"./chunk-RFTC6RNT.js";import"./chunk-I6UBKGB5.js";import"./chunk-ZIR6OOXX.js";import"./chunk-KYVX6VSI.js";import"./chunk-WN3TRBGI.js";import{c as N}from"./chunk-3FMJDUGT.js";import"./chunk-2O5TMJZM.js";import"./chunk-UI4IZNSB.js";import"./chunk-FCGPU67F.js";import"./chunk-FXRKHQFW.js";import"./chunk-YTHL7242.js";import"./chunk-XOHZCMW2.js";import{$ as Q,Fa as be,Pa as D,Ra as xe,Ua as Te,Va as X,zb as we}from"./chunk-EQ34WRCJ.js";import"./chunk-UIZGYUZK.js";import{p as i,s as M}from"./chunk-DSNMNSMD.js";import"./chunk-U2IAA473.js";import{a as ae}from"./chunk-DOSBJ3L3.js";import"./chunk-DNGRHKLV.js";import"./chunk-3O2IEAHF.js";import{I as oe,g as W,o as Re,q as _}from"./chunk-URGJ6D4O.js";import"./chunk-WC6GCIBJ.js";import"./chunk-JRC3ZUKA.js";import"./chunk-4U5VOZ7H.js";import"./chunk-FVHZWNUE.js";import{a as le}from"./chunk-IQUFNLVG.js";import{C as b,t as De,w as Le}from"./chunk-XYWWXNVK.js";import"./chunk-VYWNZTTM.js";import"./chunk-5CHTOVVG.js";import{a as ko}from"./chunk-FB3ILH2L.js";import{b as E}from"./chunk-FLSAETOH.js";import"./chunk-TGW66MRK.js";import"./chunk-LRIABBHT.js";import"./chunk-NEASQB35.js";import{Aa as yo,M as Ie}from"./chunk-4C5HF6J2.js";import"./chunk-U6W3TK77.js";import"./chunk-WJI4CIAQ.js";import"./chunk-GTDBOF5Q.js";import"./chunk-EI7BJC6V.js";import"./chunk-B3EOGJ3Y.js";import"./chunk-YL2RBVBZ.js";import"./chunk-4HAPQ4J7.js";import"./chunk-F5YUOHHL.js";import"./chunk-LWG66QL2.js";import"./chunk-26XSB24L.js";import"./chunk-IFKSF5TW.js";import"./chunk-PDIVTGDM.js";import"./chunk-UL6IEE2K.js";import"./chunk-4ARIYUS3.js";import{f as C,o as t,q as r}from"./chunk-UWURTNRY.js";t();r();var s=C(E()),to=C(ae());t();r();var L=C(E()),re=C(ae()),Ye=C(ko());var ho=(e,o)=>{let n=e==="protocol"?Ae:ve;if(o){let a=new URLSearchParams(o).toString();return`${n}?${a}`}return n},Io=({selectedInfo:e,category:o})=>{let n=(0,re.useHistory)(),a=(0,re.useLocation)(),c=new URLSearchParams(a.search);return L.default.createElement("div",{"data-testid":U.CUSTOM_COIN_PAGE.NETWORK_SELECTOR,className:"chain-select",onClick:()=>{let d={...Object.fromEntries(c.entries()),pageType:"customCrypto"};n.push(ho(o,d))}},L.default.createElement("div",{className:"chain-select-title"},o==="protocol"?i("extension_defi_info_title_protocol"):i("wallet_custom_crypto_subtitle_select_network")),L.default.createElement("div",{className:"chain-select-box","aria-label":o==="protocol"?"protocol-select-box":"chain-select-box",role:"button"},o==="protocol"?null:L.default.createElement("img",{className:"chain-select-icon",src:e?.imageUrl||e?.logo,alt:""}),L.default.createElement("div",{className:"chain-select-name"},e?.name),L.default.createElement(De,{className:(0,Ye.default)("okx-wallet-plugin-right","chain-select-arrow")})))},ne=Io;t();r();var ce=C(E());var bo=({currentAddress:e,addressInputTitle:o,errorText:n,placeHolderText:a,addressIsInvalid:c,updateCustomCoin:d})=>ce.default.createElement("div",{className:"contract-address-box"},ce.default.createElement(_.TextArea,{"data-testid":U.CUSTOM_COIN_PAGE.CONTRACT_ADDRESS_INPUT,autoResize:!0,value:e,title:o,size:_.SIZE.xl,error:c&&n,errorType:_.TIP_TYPE.always,placeholder:a,onChange:f=>{d(f.target.value)}})),Ge=bo;t();r();var qe=C(E());t();r();var Ze={root:"_root_11n0d_1"};var xo=({customCoin:e}={})=>e?.decimals===void 0||e?.localType===Q?null:qe.default.createElement(_,{className:Ze.root,label:i("wallet_manage_crypto_custom_coin_subtitle_decimals"),disabled:!0,value:e.decimals,size:_.SIZE.xl}),Ve=xo;t();r();var y=C(E());t();r();var R={"risk-dialog-footer":"_risk-dialog-footer_1jyn7_1",riskDialogFooter:"_risk-dialog-footer_1jyn7_1","risk-dialog-content":"_risk-dialog-content_1jyn7_4",riskDialogContent:"_risk-dialog-content_1jyn7_4","risk-dialog-confirm-btn":"_risk-dialog-confirm-btn_1jyn7_7",riskDialogConfirmBtn:"_risk-dialog-confirm-btn_1jyn7_7","risk-dialog-title":"_risk-dialog-title_1jyn7_16",riskDialogTitle:"_risk-dialog-title_1jyn7_16","risk-dialog-desc":"_risk-dialog-desc_1jyn7_22",riskDialogDesc:"_risk-dialog-desc_1jyn7_22","risk-dialog-jump-link":"_risk-dialog-jump-link_1jyn7_25",riskDialogJumpLink:"_risk-dialog-jump-link_1jyn7_25"};var To=({onCloseDialog:e,onNext:o,riskJumpUrl:n})=>{let a=je(),c=(0,y.useCallback)(()=>{n&&setTimeout(()=>{globalThis.platform.openTab({url:`${a.origin}${n}`})},100)},[n]);return y.default.createElement(Re,{visible:!0,title:!1,footer:y.default.createElement(N.FlexBox,{className:R.riskDialogFooter,direction:N.DIRECTION.vertical,align:N.ALIGN.center},y.default.createElement(b,{category:b.CATEGORY.outline,type:b.TYPE.primary,size:b.SIZE.lg,block:!0,onClick:e},M("commonall_text_btn_cancel")),y.default.createElement("span",{className:R.riskDialogConfirmBtn,onClick:o},M("wallet_extension_risk_alert_btn_continue_add"))),noMargin:!0,isFull:!0,hideCloseBtn:!0},y.default.createElement(N.FlexBox,{direction:N.DIRECTION.vertical,align:N.ALIGN.center,justify:"center",className:R.riskDialogContent},y.default.createElement(le,{width:100,height:100,src:"/static/images/risk-warning.png",layout:le.LAYOUT.contain}),y.default.createElement(Y.Text,{strong:500,className:R.riskDialogTitle},M("wallet_extension_risk_alert_title_approve_eoa")),y.default.createElement(Y.Text,{size:Y.SIZE.sm,type:Y.TYPE.secondary,strong:400,className:R.riskDialogDesc},M("wallet_extension_risk_alert_desc_approve_eoa",{detail:""})),n&&y.default.createElement(W,{type:W.TYPE.primary,underline:!0,weight:W.WEIGHT.muted,size:W.SIZE.md,onClick:c,className:R.riskDialogJumpLink},M("wallet_extension_risk_alert_icu_approve_eoa"))))},$e=To;t();r();var Je=C(E());t();r();function G(e){return e===X}t();r();var Ke={root:"_root_11n0d_1"};var wo=(e,o,n)=>G(o.coinId)?{show:!0,value:n,disabled:!1}:e?.localType===Q?{show:!1,value:e?.symbol,disabled:!0}:{show:e?.symbol!==void 0,value:e?.symbol,disabled:!0},No=({customCoin:e={},selectedNetwork:o,onChange:n,value:a,title:c,placeholder:d})=>{let f=I=>{n?.(I.target.value)},{show:k,value:h,disabled:p}=wo(e,o,a);return k&&Je.default.createElement(_,{className:Ke.root,label:c||i("wallet_manage_crypto_subtitle_custom_crpto_symbol"),placeholder:d,disabled:p,value:h,size:_.SIZE.xl,onChange:f})},Qe=No;t();r();var me={[D]:{title:"wallet_extension_create_input_title_contract_token_symbol",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"},[we]:{title:"extension_wallet_customcoin_text_currency_symbol",error:"extension_wallet_customcoin_errortip_crypto_notfound",placeholderName:"extension_defi_placeholder_enter_token_name",placeholderId:"extension_defi_placeholder_enter_token_id",placeholder:"extension_defi_placeholder_enter_token_id_name"},[be]:{title:"extension_wallet_customcoin_text_currency_symbol",titleId:"wallet_extension_cat_desc_token_id",error:"extension_wallet_customcoin_errortip_crypto_notfound",placeholderName:"extension_defi_placeholder_enter_token_name",placeholderId:"extension_defi_placeholder_enter_token_id",placeholder:"extension_defi_placeholder_enter_token_id_name"},[xe]:{title:"extension_wallet_cardano_text_fingerprint",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"},[Te]:{title:"wallet_extension_import_title_jetton_master",error:"developer_mode_manage_errortip_request_failed",placeholder:"wallet_extension_import_input_jetton_master"},[X]:{title:"wallet_extension_selecttoken_input_label_asset_issuer",placeholder:"wallet_extension_selecttoken_input_placeholder_issuer_name",symbolTitle:"wallet_extension_selecttoken_input_label_asset_code",symbolPlaceholder:"wallet_extension_selecttoken_input_placeholder_asset_code",error:"developer_mode_manage_errortip_request_failed"},default:{title:"wallet_transaction_history_subtitle_contract_address",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"}};t();r();var j=C(E());var Eo=({selectedNetwork:e,account:o,accountIsInvalid:n,accountErrorMessage:a,setAccount:c,updateCustomCoin:d,accountRef:f,setProtocol:k,protocol:h,protocolList:p=[]})=>{let I=te(),m=Number(I.get("protocolId"));return(0,j.useEffect)(()=>{let l=null;if(!w(e)){k("");return}if(m&&p?.length&&(l=p.find(g=>g.protocolId===m)),!l&&p.length>0&&(l=p[0]),l){let g={...l,name:l.protocolName};k(g)}},[p,e]),{renderCustomForm:()=>e?.coinId===D?j.default.createElement("div",{className:"contract-address-box"},j.default.createElement(_.TextArea,{autoResize:!0,value:o,title:i("wallet_extension_create_input_title_contract_account_name"),size:_.SIZE.xl,error:n&&a,errorType:_.TIP_TYPE.always,placeholder:i("wallet_extension_create_input_title_contract_token_symbol"),onChange:l=>{c(l.target.value),f.current=l.target.value,d()}})):w(e)&&h?j.default.createElement(ne,{selectedInfo:h,category:"protocol"}):null}},Xe=Eo;t();r();var P=C(E());yo();var Po=e=>e?.data?.originalError?.data?.code==="ERR_NETWORK",So=(e,o)=>w(e)?{protocolId:o}:{},vo=(e,o)=>e?{symbol:o}:{},Ao=e=>`facet_${e}`,Oo=(e,o)=>e?Ao(o):o,Do=(e,o)=>e&&Ie(o),Lo=(e,o)=>e.coinId===D&&!o?.accountValid,Ro=({selectedNetwork:e,currentAddress:o,isFacet:n,currentAddressRef:a,currentSymbolRef:c,accountRef:d,protocol:f})=>{let[k,h]=(0,P.useState)({}),[p,I]=(0,P.useState)(!1),[m,H]=(0,P.useState)(""),[l,g]=(0,P.useState)(!0),[Z,z]=(0,P.useState)(""),[x,S]=(0,P.useState)(!1),[se,F]=(0,P.useState)(!1),{run:q}=ee(async({addr:v,accountName:V,protocolId:$,symbol:K})=>{if(F(!1),!v)return;let B=G(e.coinId);if(Do(B,K))return;let T;try{T=await Fe({contractAddress:Oo(n,v),chainInfo:e,account:V,isFacet:n,...So(e,$),...vo(B,K)})}catch(J){T={},Po(J)&&F(!0)}if(v===o){if(h(T),Lo(e,T)){I(!0),H(T?.msg||""),g(!0);return}else if(!Z&&e?.coinId===D){S(!1),g(!0);return}I(!1),H(""),v&&T?.symbol?(S(!1),g(!1)):v?(S(!0),g(!0)):(S(!1),g(!0))}},{wait:500});return{customCoin:k,accountIsInvalid:p,accountErrorMessage:m,stateOnLock:l,account:Z,addressIsInvalid:x,setAccount:z,updateCustomCoin:()=>{h({}),g(!0),q({addr:a.current,accountName:d.current,protocolId:f?.protocolId,symbol:c.current})},networkError:se}},eo=Ro;t();r();var oo=C(ae());t();r();function Fo(e,o){if(e.key&&o.key)return e.key===o.key;if(e.coinId&&o.coinId)return e.coinId===o.coinId;let n=e.address||e.contractAddress,a=o.address||o.contractAddress;return n&&a?n.toLowerCase()===a.toLowerCase()&&e.localType===o.localType:!1}function ue(e,o){for(let n=0;n<o.length;n++){let a=o[n];if(Fo(a,e)||a.childrenCoin&&ue(e,a.childrenCoin))return!0}return!1}function de(e,o,n=!1){let a=(0,oo.useHistory)(),[c,{setTrue:d,setFalse:f}]=Ee(),k=He(),{run:h}=ee(async()=>{if(d(),ue(e,k)){oe.error(i("wallet_manage_crypto_errortip_crypto_added")),f();return}try{await Be({...e,protocolId:o}),oe.success(i("wallet_manage_crypto_toast_custom_crypto_success")),n?globalThis.platform.closeCurrentWindow():a.push(Se)}catch(I){let m=I?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed");oe.error(m)}finally{f()}},{wait:100});return{isSubmitting:c,submitAction:h}}t();r();var Bo="Ethereum",Mo=()=>{let e=(0,to.useHistory)(),o=s.default.useRef(""),n=s.default.useRef(""),a=s.default.useRef(""),c=s.default.useRef(""),[d,f]=(0,s.useState)(!1),[k,h]=(0,s.useState)(""),[p,I]=(0,s.useState)(""),[m,H]=(0,s.useState)(""),[l,g]=(0,s.useState)({imageUrl:"",name:"",coinId:-1}),[Z,z]=(0,s.useState)(!1),{supportNetworkList:x,run:S,loading:se}=We({cachePriority:!0}),{protocolList:F,run:q,loading:_e}=ze(l.coinId),v=se||_e,V=te(),$=V.get("network"),K=V.get("close"),{title:B,titleId:T,error:J,placeholder:pe,placeholderName:fe,placeholderId:ge,symbolTitle:ro,symbolPlaceholder:no}=me[l?.coinId]||me.default,so=(0,s.useMemo)(()=>w(l)&&m?.searchType?m.searchType===1?i(B):i(T):i(B),[m.searchType,l,B,T]),io=(0,s.useMemo)(()=>w(l)&&m?.searchType?m.searchType===1?i(fe):i(ge):i(pe),[pe,ge,fe,m.searchType,l]),{customCoin:A,accountIsInvalid:Ce,accountErrorMessage:ao,stateOnLock:lo,account:co,addressIsInvalid:ye,setAccount:mo,updateCustomCoin:ie,networkError:ke}=eo({selectedNetwork:l,currentAddress:k,currentSymbol:p,isFacet:d,currentAddressRef:a,currentSymbolRef:c,accountRef:o,protocol:m}),uo=(0,s.useMemo)(()=>ke?i("developer_mode_manage_errortip_network_error"):i(J),[J,ke]),{renderCustomForm:_o}=Xe({selectedNetwork:l,account:co,accountIsInvalid:Ce,accountErrorMessage:ao,setAccount:mo,updateCustomCoin:ie,accountRef:o,protocolRef:n,setProtocol:H,protocol:m,protocolList:F,isFacet:d,setIsFacet:f}),{isSubmitting:po,submitAction:he}=de(A,m.protocolId,K);(0,s.useEffect)(()=>{(!x||x.length===0)&&S()},[S,x]),(0,s.useEffect)(()=>{w(l)&&(!F||F?.length===0)&&q()},[l,q]),(0,s.useEffect)(()=>{async function O(){if(x.length>0){let go=$||Bo;g(x.filter(Co=>Co.name===go)[0]||x[0])}}O()},[x,$]);let fo=()=>{Ne({token_symbol:A.symbol,chain_symbol:l.name,token_contract_address:A.contractAddress,source_page:"custom_crypto"}),A.riskType===Pe.NORMAL?he():z(!0)};return s.default.createElement("div",{className:"custom-crypto-page main-container"},s.default.createElement(Ue,{title:i("wallet_manage_crypto_maintitle_custom_crypto"),onBack:()=>{e.push(Oe)}}),s.default.createElement(N.Spin,{loading:v,size:Le.SIZE.lg},s.default.createElement("div",{className:"custom-crypto--body"},s.default.createElement(ne,{selectedInfo:l}),_o(),s.default.createElement(Ge,{updateCustomCoin:O=>{a.current=O,h(O),ie()},currentAddress:k,addressInputTitle:so,errorText:uo,placeHolderText:io,addressIsInvalid:ye}),s.default.createElement(Qe,{title:i(ro),placeholder:i(no),customCoin:A,value:p,selectedNetwork:l,onChange:O=>{c.current=O,I(O),ie()}}),s.default.createElement(Ve,{customCoin:A})),s.default.createElement(Me.FooterActions,{usePortal:!0},s.default.createElement(b,{"data-testid":U.CUSTOM_COIN_PAGE.ADD_COIN_CONFIRM_BUTTON,onClick:fo,size:b.SIZE.lg,type:b.TYPE.highlight,category:b.CATEGORY.fill,loading:po,disabled:ye||lo||Ce},i("wallet_set_password_btn_confirm")))),Z&&s.default.createElement($e,{onCloseDialog:()=>{z(!1)},onNext:()=>{z(!1),he()},riskJumpUrl:A.riskJumpUrl}))},Xr=Mo;export{Xr as default};
//# sourceMappingURL=CustomCrypto-K2K6BBKH.js.map
