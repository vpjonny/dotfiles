import{a as zr,f as xi,g as Ei,i as Bi}from"./chunk-ZVKCRT3D.js";import{c as G,o as v,q as A}from"./chunk-UWURTNRY.js";var qn=G(Ze=>{v();A();Object.defineProperty(Ze,"__esModule",{value:!0});Ze.equal=Ze.concat=Ze.HEX_REGEX=void 0;var vi=zr();Ze.HEX_REGEX=/^[A-F0-9]*$/iu;function Ai(e){return(0,vi.concatBytes)(...e)}Ze.concat=Ai;function Si(e,t){if(e.byteLength!==t.byteLength)return!1;let n=new Int8Array(e),r=new Int8Array(t);for(let s=0;s!==e.byteLength;s++)if(n[s]!==r[s])return!1;return!0}Ze.equal=Si});var vt=G(de=>{v();A();var Ti=de&&de.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Ci=de&&de.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Ti(t,e,n)};Object.defineProperty(de,"__esModule",{value:!0});de.randomBytes=de.stringToHex=de.hexToString=de.hexToBytes=de.bytesToHex=void 0;var Gr=zr(),Ii=qn(),Li=e=>(0,Gr.bytesToHex)(e instanceof Uint8Array?e:Uint8Array.from(e)).toUpperCase();de.bytesToHex=Li;var Oi=e=>{let t=e.length,n=new Uint8Array(t/2);if(!Ii.HEX_REGEX.test(e))throw new Error("Invalid hex string");for(let r=0;r<n.length;r++){let s=r*2,o=e.slice(s,s+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n};de.hexToBytes=Oi;var qi=(e,t="utf8")=>new TextDecoder(t).decode((0,de.hexToBytes)(e));de.hexToString=qi;var Ri=e=>(0,de.bytesToHex)(new TextEncoder().encode(e));de.stringToHex=Ri;de.randomBytes=Gr.randomBytes;Ci(qn(),de)});var so=G(L=>{v();A();Object.defineProperty(L,"__esModule",{value:!0});L.bytes=L.stringToBytes=L.str=L.bytesToString=L.hex=L.utf8=L.bech32m=L.bech32=L.base58check=L.createBase58check=L.base58xmr=L.base58xrp=L.base58flickr=L.base58=L.base64urlnopad=L.base64url=L.base64nopad=L.base64=L.base32crockford=L.base32hexnopad=L.base32hex=L.base32nopad=L.base32=L.base16=L.utils=L.assertNumber=void 0;function ht(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Qr(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Hn(e){if(typeof e!="function")throw new Error("function expected");return!0}function bt(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function ct(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}L.assertNumber=ct;function Gt(e){if(!Array.isArray(e))throw new Error("array expected")}function Xt(e,t){if(!Qr(!0,t))throw new Error(`${e}: array of strings expected`)}function Nn(e,t){if(!Qr(!1,t))throw new Error(`${e}: array of numbers expected`)}function xe(...e){let t=o=>o,n=(o,i)=>c=>o(i(c)),r=e.map(o=>o.encode).reduceRight(n,t),s=e.map(o=>o.decode).reduce(n,t);return{encode:r,decode:s}}function Be(e){let t=typeof e=="string"?e.split(""):e,n=t.length;Xt("alphabet",t);let r=new Map(t.map((s,o)=>[s,o]));return{encode:s=>(Gt(s),s.map(o=>{if(!Number.isSafeInteger(o)||o<0||o>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${o}". Allowed: ${e}`);return t[o]})),decode:s=>(Gt(s),s.map(o=>{bt("alphabet.decode",o);let i=r.get(o);if(i===void 0)throw new Error(`Unknown letter: "${o}". Allowed: ${e}`);return i}))}}function ve(e=""){return bt("join",e),{encode:t=>(Xt("join.decode",t),t.join(e)),decode:t=>(bt("join.decode",t),t.split(e))}}function St(e,t="="){return ct(e),bt("padding",t),{encode(n){for(Xt("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){Xt("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function Jr(e){return Hn(e),{encode:t=>t,decode:t=>e(t)}}function Rn(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(Gt(e),!e.length)return[];let r=0,s=[],o=Array.from(e,c=>{if(ct(c),c<0||c>=t)throw new Error(`invalid integer: ${c}`);return c}),i=o.length;for(;;){let c=0,a=!0;for(let u=r;u<i;u++){let d=o[u],f=t*c,l=f+d;if(!Number.isSafeInteger(l)||f/t!==c||l-d!==f)throw new Error("convertRadix: carry overflow");let p=l/n;c=l%n;let B=Math.floor(p);if(o[u]=B,!Number.isSafeInteger(B)||B*n+c!==l)throw new Error("convertRadix: carry overflow");if(a)B?a=!1:r=u;else continue}if(s.push(c),a)break}for(let c=0;c<e.length-1&&e[c]===0;c++)s.push(0);return s.reverse()}var eo=(e,t)=>t===0?e:eo(t,e%t),Yt=(e,t)=>e+(t-eo(e,t)),zt=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function Wt(e,t,n,r){if(Gt(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Yt(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Yt(t,n)}`);let s=0,o=0,i=zt[t],c=zt[n]-1,a=[];for(let u of e){if(ct(u),u>=i)throw new Error(`convertRadix2: invalid data word=${u} from=${t}`);if(s=s<<t|u,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)a.push((s>>o-n&c)>>>0);let d=zt[o];if(d===void 0)throw new Error("invalid carry");s&=d-1}if(s=s<<n-o&c,!r&&o>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&o>0&&a.push(s>>>0),a}function to(e){ct(e);let t=2**8;return{encode:n=>{if(!ht(n))throw new Error("radix.encode input should be Uint8Array");return Rn(Array.from(n),t,e)},decode:n=>(Nn("radix.decode",n),Uint8Array.from(Rn(n,e,t)))}}function Le(e,t=!1){if(ct(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Yt(8,e)>32||Yt(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!ht(n))throw new Error("radix2.encode input should be Uint8Array");return Wt(Array.from(n),8,e,!t)},decode:n=>(Nn("radix2.decode",n),Uint8Array.from(Wt(n,e,8,t)))}}function Xr(e){return Hn(e),function(...t){try{return e.apply(null,t)}catch{}}}function no(e,t){return ct(e),Hn(t),{encode(n){if(!ht(n))throw new Error("checksum.encode: input should be Uint8Array");let r=t(n).slice(0,e),s=new Uint8Array(n.length+e);return s.set(n),s.set(r,n.length),s},decode(n){if(!ht(n))throw new Error("checksum.decode: input should be Uint8Array");let r=n.slice(0,-e),s=n.slice(-e),o=t(r).slice(0,e);for(let i=0;i<e;i++)if(o[i]!==s[i])throw new Error("Invalid checksum");return r}}}L.utils={alphabet:Be,chain:xe,checksum:no,convertRadix:Rn,convertRadix2:Wt,radix:to,radix2:Le,join:ve,padding:St};L.base16=xe(Le(4),Be("0123456789ABCDEF"),ve(""));L.base32=xe(Le(5),Be("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),St(5),ve(""));L.base32nopad=xe(Le(5),Be("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),ve(""));L.base32hex=xe(Le(5),Be("0123456789ABCDEFGHIJKLMNOPQRSTUV"),St(5),ve(""));L.base32hexnopad=xe(Le(5),Be("0123456789ABCDEFGHIJKLMNOPQRSTUV"),ve(""));L.base32crockford=xe(Le(5),Be("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),ve(""),Jr(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));L.base64=xe(Le(6),Be("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),St(6),ve(""));L.base64nopad=xe(Le(6),Be("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ve(""));L.base64url=xe(Le(6),Be("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),St(6),ve(""));L.base64urlnopad=xe(Le(6),Be("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),ve(""));var kn=e=>xe(to(58),Be(e),ve(""));L.base58=kn("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");L.base58flickr=kn("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");L.base58xrp=kn("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");var Yr=[0,2,3,5,6,7,9,10,11];L.base58xmr={encode(e){let t="";for(let n=0;n<e.length;n+=8){let r=e.subarray(n,n+8);t+=L.base58.encode(r).padStart(Yr[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){let r=e.slice(n,n+11),s=Yr.indexOf(r.length),o=L.base58.decode(r);for(let i=0;i<o.length-s;i++)if(o[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(o.slice(o.length-s)))}return Uint8Array.from(t)}};var Pi=e=>xe(no(4,t=>e(e(t))),L.base58);L.createBase58check=Pi;L.base58check=L.createBase58check;var Pn=xe(Be("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),ve("")),Wr=[996825010,642813549,513874426,1027748829,705979059];function At(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<Wr.length;r++)(t>>r&1)===1&&(n^=Wr[r]);return n}function Fr(e,t,n=1){let r=e.length,s=1;for(let o=0;o<r;o++){let i=e.charCodeAt(o);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);s=At(s)^i>>5}s=At(s);for(let o=0;o<r;o++)s=At(s)^e.charCodeAt(o)&31;for(let o of t)s=At(s)^o;for(let o=0;o<6;o++)s=At(s);return s^=n,Pn.encode(Wt([s%zt[30]],30,5,!1))}function ro(e){let t=e==="bech32"?1:734539939,n=Le(5),r=n.decode,s=n.encode,o=Xr(r);function i(f,l,p=90){bt("bech32.encode prefix",f),ht(l)&&(l=Array.from(l)),Nn("bech32.encode",l);let B=f.length;if(B===0)throw new TypeError(`Invalid prefix length ${B}`);let m=B+7+l.length;if(p!==!1&&m>p)throw new TypeError(`Length ${m} exceeds limit ${p}`);let h=f.toLowerCase(),w=Fr(h,l,t);return`${h}1${Pn.encode(l)}${w}`}function c(f,l=90){bt("bech32.decode input",f);let p=f.length;if(p<8||l!==!1&&p>l)throw new TypeError(`invalid string length: ${p} (${f}). Expected (8..${l})`);let B=f.toLowerCase();if(f!==B&&f!==f.toUpperCase())throw new Error("String must be lowercase or uppercase");let m=B.lastIndexOf("1");if(m===0||m===-1)throw new Error('Letter "1" must be present between prefix and data only');let h=B.slice(0,m),w=B.slice(m+1);if(w.length<6)throw new Error("Data must be at least 6 characters long");let g=Pn.decode(w).slice(0,-6),b=Fr(h,g,t);if(!w.endsWith(b))throw new Error(`Invalid checksum in ${f}: expected "${b}"`);return{prefix:h,words:g}}let a=Xr(c);function u(f){let{prefix:l,words:p}=c(f,!1);return{prefix:l,words:p,bytes:r(p)}}function d(f,l){return i(f,s(l))}return{encode:i,decode:c,encodeFromBytes:d,decodeToBytes:u,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:o,toWords:s}}L.bech32=ro("bech32");L.bech32m=ro("bech32m");L.utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)};L.hex=xe(Le(4),Be("0123456789abcdef"),ve(""),Jr(e=>{if(typeof e!="string"||e.length%2!==0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));var Ft={utf8:L.utf8,hex:L.hex,base16:L.base16,base32:L.base32,base64:L.base64,base64url:L.base64url,base58:L.base58,base58xmr:L.base58xmr},oo="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",Hi=(e,t)=>{if(typeof e!="string"||!Ft.hasOwnProperty(e))throw new TypeError(oo);if(!ht(t))throw new TypeError("bytesToString() expects Uint8Array");return Ft[e].encode(t)};L.bytesToString=Hi;L.str=L.bytesToString;var Ni=(e,t)=>{if(!Ft.hasOwnProperty(e))throw new TypeError(oo);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return Ft[e].decode(t)};L.stringToBytes=Ni;L.bytes=L.stringToBytes});var io=G(Un=>{v();A();Object.defineProperty(Un,"__esModule",{value:!0});function ki(e){return Array.isArray(e)?new Uint8Array(e):e}Un.default=ki});var Qt=G(Tt=>{v();A();var Ui=Tt&&Tt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tt,"__esModule",{value:!0});var co=Ui(io());function Di(e){function t(n){return e((0,co.default)(n))}return t.create=()=>{let n=e.create();return{update(r){return n.update((0,co.default)(r)),this},digest(){return n.digest()}}},t}Tt.default=Di});var Dn=G(yt=>{v();A();var ji=yt&&yt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yt,"__esModule",{value:!0});yt.sha256=void 0;var Mi=Ei(),$i=ji(Qt());yt.sha256=(0,$i.default)(Mi.sha256)});var ao=G(gt=>{v();A();Object.defineProperty(gt,"__esModule",{value:!0});gt.concatArgs=gt.arrayEqual=void 0;function Vi(e,t){return e.length!==t.length?!1:e.every((n,r)=>n===t[r])}gt.arrayEqual=Vi;function Ki(e){return typeof e=="number"}function Zi(...e){return e.flatMap(t=>Ki(t)?[t]:Array.from(t))}gt.concatArgs=Zi});var mo=G(oe=>{v();A();Object.defineProperty(oe,"__esModule",{value:!0});oe.isValidClassicAddress=oe.decodeAccountPublic=oe.encodeAccountPublic=oe.encodeNodePublic=oe.decodeNodePublic=oe.decodeAddress=oe.decodeAccountID=oe.encodeAddress=oe.encodeAccountID=oe.decodeSeed=oe.encodeSeed=oe.codec=void 0;var zi=so(),Gi=Dn(),Jt=ao(),jn=class{constructor(t){this._sha256=t.sha256,this._codec=zi.base58xrp}encode(t,n){let r=n.versions;return this._encodeVersioned(t,r,n.expectedLength)}decode(t,n){var r;let s=n.versions,o=n.versionTypes,i=this.decodeChecked(t);if(s.length>1&&!n.expectedLength)throw new Error("expectedLength is required because there are >= 2 possible versions");let c=typeof s[0]=="number"?1:s[0].length,a=(r=n.expectedLength)!==null&&r!==void 0?r:i.length-c,u=i.slice(0,-a),d=i.slice(-a);for(let f=0;f<s.length;f++){let l=Array.isArray(s[f])?s[f]:[s[f]];if((0,Jt.arrayEqual)(u,l))return{version:l,bytes:d,type:o?o[f]:null}}throw new Error("version_invalid: version bytes do not match any of the provided version(s)")}encodeChecked(t){let n=this._sha256(this._sha256(t)).slice(0,4);return this._encodeRaw(Uint8Array.from((0,Jt.concatArgs)(t,n)))}decodeChecked(t){let n=this._decodeRaw(t);if(n.byteLength<5)throw new Error("invalid_input_size: decoded data must have length >= 5");if(!this._verifyCheckSum(n))throw new Error("checksum_invalid");return n.slice(0,-4)}_encodeVersioned(t,n,r){if(!go(t,r))throw new Error("unexpected_payload_length: bytes.length does not match expectedLength. Ensure that the bytes are a Uint8Array.");return this.encodeChecked((0,Jt.concatArgs)(n,t))}_encodeRaw(t){return this._codec.encode(Uint8Array.from(t))}_decodeRaw(t){return this._codec.decode(t)}_verifyCheckSum(t){let n=this._sha256(this._sha256(t.slice(0,-4))).slice(0,4),r=t.slice(-4);return(0,Jt.arrayEqual)(n,r)}},uo=0,fo=35,lo=33,ho=28,bo=[1,225,75],Xi={sha256:Gi.sha256},$e=new jn(Xi);oe.codec=$e;function Yi(e,t){if(!go(e,16))throw new Error("entropy must have length 16");let n={expectedLength:16,versions:t==="ed25519"?bo:[lo]};return $e.encode(e,n)}oe.encodeSeed=Yi;function Wi(e,t={versionTypes:["ed25519","secp256k1"],versions:[bo,lo],expectedLength:16}){return $e.decode(e,t)}oe.decodeSeed=Wi;function yo(e){let t={versions:[uo],expectedLength:20};return $e.encode(e,t)}oe.encodeAccountID=yo;oe.encodeAddress=yo;function Mn(e){let t={versions:[uo],expectedLength:20};return $e.decode(e,t).bytes}oe.decodeAccountID=Mn;oe.decodeAddress=Mn;function Fi(e){let t={versions:[ho],expectedLength:33};return $e.decode(e,t).bytes}oe.decodeNodePublic=Fi;function Qi(e){let t={versions:[ho],expectedLength:33};return $e.encode(e,t)}oe.encodeNodePublic=Qi;function Ji(e){let t={versions:[fo],expectedLength:33};return $e.encode(e,t)}oe.encodeAccountPublic=Ji;function ec(e){let t={versions:[fo],expectedLength:33};return $e.decode(e,t).bytes}oe.decodeAccountPublic=ec;function tc(e){try{Mn(e)}catch{return!1}return!0}oe.isValidClassicAddress=tc;function go(e,t){return"byteLength"in e?e.byteLength===t:e.length===t}});var po=G(W=>{v();A();Object.defineProperty(W,"__esModule",{value:!0});W.isValidXAddress=W.decodeXAddress=W.xAddressToClassicAddress=W.encodeXAddress=W.classicAddressToXAddress=W.isValidClassicAddress=W.decodeAccountPublic=W.encodeAccountPublic=W.decodeNodePublic=W.encodeNodePublic=W.decodeAccountID=W.encodeAccountID=W.decodeSeed=W.encodeSeed=W.codec=void 0;var Ct=vt(),Ae=mo();Object.defineProperty(W,"codec",{enumerable:!0,get:function(){return Ae.codec}});Object.defineProperty(W,"encodeSeed",{enumerable:!0,get:function(){return Ae.encodeSeed}});Object.defineProperty(W,"decodeSeed",{enumerable:!0,get:function(){return Ae.decodeSeed}});Object.defineProperty(W,"encodeAccountID",{enumerable:!0,get:function(){return Ae.encodeAccountID}});Object.defineProperty(W,"decodeAccountID",{enumerable:!0,get:function(){return Ae.decodeAccountID}});Object.defineProperty(W,"encodeNodePublic",{enumerable:!0,get:function(){return Ae.encodeNodePublic}});Object.defineProperty(W,"decodeNodePublic",{enumerable:!0,get:function(){return Ae.decodeNodePublic}});Object.defineProperty(W,"encodeAccountPublic",{enumerable:!0,get:function(){return Ae.encodeAccountPublic}});Object.defineProperty(W,"decodeAccountPublic",{enumerable:!0,get:function(){return Ae.decodeAccountPublic}});Object.defineProperty(W,"isValidClassicAddress",{enumerable:!0,get:function(){return Ae.isValidClassicAddress}});var en={main:Uint8Array.from([5,68]),test:Uint8Array.from([4,147])},nc=4294967295;function rc(e,t,n){let r=(0,Ae.decodeAccountID)(e);return wo(r,t,n)}W.classicAddressToXAddress=rc;function wo(e,t,n){if(e.length!==20)throw new Error("Account ID must be 20 bytes");if(t!==!1&&t>nc)throw new Error("Invalid tag");let r=t||0,s=t===!1||t==null?0:1,o=(0,Ct.concat)([n?en.test:en.main,e,Uint8Array.from([s,r&255,r>>8&255,r>>16&255,r>>24&255,0,0,0,0])]);return Ae.codec.encodeChecked(o)}W.encodeXAddress=wo;function oc(e){let{accountId:t,tag:n,test:r}=$n(e);return{classicAddress:(0,Ae.encodeAccountID)(t),tag:n,test:r}}W.xAddressToClassicAddress=oc;function $n(e){let t=Ae.codec.decodeChecked(e),n=sc(t),r=t.slice(2,22),s=ic(t);return{accountId:r,tag:s,test:n}}W.decodeXAddress=$n;function sc(e){let t=e.slice(0,2);if((0,Ct.equal)(en.main,t))return!1;if((0,Ct.equal)(en.test,t))return!0;throw new Error("Invalid X-address: bad prefix")}function ic(e){let t=e[22];if(t>=2)throw new Error("Unsupported X-address");if(t===1)return e[23]+e[24]*256+e[25]*65536+e[26]*16777216;if(t!==0)throw new Error("flag must be zero to indicate no tag");if(!(0,Ct.equal)((0,Ct.hexToBytes)("0000000000000000"),e.slice(23,23+8)))throw new Error("remaining bytes must be zero");return!1}function cc(e){try{$n(e)}catch{return!1}return!0}W.isValidXAddress=cc});var _o=G(mt=>{v();A();var ac=mt&&mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mt,"__esModule",{value:!0});mt.ripemd160=void 0;var dc=xi(),uc=ac(Qt());mt.ripemd160=(0,uc.default)(dc.ripemd160)});var nn=G(De=>{v();A();Object.defineProperty(De,"__esModule",{value:!0});De.isBytes=Eo;De.number=tn;De.bool=xo;De.bytes=Vn;De.hash=Bo;De.exists=vo;De.output=Ao;function tn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function xo(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Eo(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function Vn(e,...t){if(!Eo(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Bo(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");tn(e.outputLen),tn(e.blockLen)}function vo(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ao(e,t){Vn(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var fc={number:tn,bool:xo,bytes:Vn,hash:Bo,exists:vo,output:Ao};De.default=fc});var So=G(rn=>{v();A();Object.defineProperty(rn,"__esModule",{value:!0});rn.crypto=void 0;rn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var ze=G($=>{v();A();Object.defineProperty($,"__esModule",{value:!0});$.Hash=$.nextTick=$.byteSwapIfBE=$.byteSwap=$.isLE=$.rotl=$.rotr=$.createView=$.u32=$.u8=void 0;$.isBytes=lc;$.byteSwap32=pc;$.bytesToHex=xc;$.hexToBytes=Ec;$.asyncLoop=vc;$.utf8ToBytes=Co;$.toBytes=on;$.concatBytes=Ac;$.checkOpts=Tc;$.wrapConstructor=Cc;$.wrapConstructorWithOpts=Ic;$.wrapXOFConstructorWithOpts=Lc;$.randomBytes=Oc;var wt=So(),Zn=nn();function lc(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var hc=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);$.u8=hc;var bc=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));$.u32=bc;var yc=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);$.createView=yc;var gc=(e,t)=>e<<32-t|e>>>t;$.rotr=gc;var mc=(e,t)=>e<<t|e>>>32-t>>>0;$.rotl=mc;$.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var wc=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;$.byteSwap=wc;$.byteSwapIfBE=$.isLE?e=>e:e=>(0,$.byteSwap)(e);function pc(e){for(let t=0;t<e.length;t++)e[t]=(0,$.byteSwap)(e[t])}var _c=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function xc(e){(0,Zn.bytes)(e);let t="";for(let n=0;n<e.length;n++)t+=_c[e[n]];return t}var Ve={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function To(e){if(e>=Ve._0&&e<=Ve._9)return e-Ve._0;if(e>=Ve._A&&e<=Ve._F)return e-(Ve._A-10);if(e>=Ve._a&&e<=Ve._f)return e-(Ve._a-10)}function Ec(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=To(e.charCodeAt(o)),c=To(e.charCodeAt(o+1));if(i===void 0||c===void 0){let a=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+o)}r[s]=i*16+c}return r}var Bc=async()=>{};$.nextTick=Bc;async function vc(e,t,n){let r=Date.now();for(let s=0;s<e;s++){n(s);let o=Date.now()-r;o>=0&&o<t||(await(0,$.nextTick)(),r+=o)}}function Co(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function on(e){return typeof e=="string"&&(e=Co(e)),(0,Zn.bytes)(e),e}function Ac(...e){let t=0;for(let r=0;r<e.length;r++){let s=e[r];(0,Zn.bytes)(s),t+=s.length}let n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){let o=e[r];n.set(o,s),s+=o.length}return n}var Kn=class{clone(){return this._cloneInto()}};$.Hash=Kn;var Sc={}.toString;function Tc(e,t){if(t!==void 0&&Sc.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function Cc(e){let t=r=>e().update(on(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Ic(e){let t=(r,s)=>e(s).update(on(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Lc(e){let t=(r,s)=>e(s).update(on(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Oc(e=32){if(wt.crypto&&typeof wt.crypto.getRandomValues=="function")return wt.crypto.getRandomValues(new Uint8Array(e));if(wt.crypto&&typeof wt.crypto.randomBytes=="function")return wt.crypto.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}});var Xn=G(Ge=>{v();A();Object.defineProperty(Ge,"__esModule",{value:!0});Ge.HashMD=Ge.Maj=Ge.Chi=void 0;var zn=nn(),It=ze();function qc(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),a=r?4:0,u=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+u,c,r)}var Rc=(e,t,n)=>e&t^~e&n;Ge.Chi=Rc;var Pc=(e,t,n)=>e&t^e&n^t&n;Ge.Maj=Pc;var Gn=class extends It.Hash{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,It.createView)(this.buffer)}update(t){(0,zn.exists)(this);let{view:n,buffer:r,blockLen:s}=this;t=(0,It.toBytes)(t);let o=t.length;for(let i=0;i<o;){let c=Math.min(s-this.pos,o-i);if(c===s){let a=(0,It.createView)(t);for(;s<=o-i;i+=s)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,zn.exists)(this),(0,zn.output)(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:s,isLE:o}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let f=i;f<s;f++)n[f]=0;qc(r,s-8,BigInt(this.length*8),o),this.process(r,0);let c=(0,It.createView)(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)c.setUint32(4*f,d[f],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:c}=this;return t.length=s,t.pos=c,t.finished=o,t.destroyed=i,s%n&&t.buffer.set(r),t}};Ge.HashMD=Gn});var Io=G(We=>{v();A();Object.defineProperty(We,"__esModule",{value:!0});We.sha224=We.sha256=We.SHA256=void 0;var Yn=Xn(),He=ze(),Hc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ye=new Uint32Array(64),Lt=class extends Yn.HashMD{constructor(){super(64,32,8,!1),this.A=Xe[0]|0,this.B=Xe[1]|0,this.C=Xe[2]|0,this.D=Xe[3]|0,this.E=Xe[4]|0,this.F=Xe[5]|0,this.G=Xe[6]|0,this.H=Xe[7]|0}get(){let{A:t,B:n,C:r,D:s,E:o,F:i,G:c,H:a}=this;return[t,n,r,s,o,i,c,a]}set(t,n,r,s,o,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let f=0;f<16;f++,n+=4)Ye[f]=t.getUint32(n,!1);for(let f=16;f<64;f++){let l=Ye[f-15],p=Ye[f-2],B=(0,He.rotr)(l,7)^(0,He.rotr)(l,18)^l>>>3,m=(0,He.rotr)(p,17)^(0,He.rotr)(p,19)^p>>>10;Ye[f]=m+Ye[f-7]+B+Ye[f-16]|0}let{A:r,B:s,C:o,D:i,E:c,F:a,G:u,H:d}=this;for(let f=0;f<64;f++){let l=(0,He.rotr)(c,6)^(0,He.rotr)(c,11)^(0,He.rotr)(c,25),p=d+l+(0,Yn.Chi)(c,a,u)+Hc[f]+Ye[f]|0,m=((0,He.rotr)(r,2)^(0,He.rotr)(r,13)^(0,He.rotr)(r,22))+(0,Yn.Maj)(r,s,o)|0;d=u,u=a,a=c,c=i+p|0,i=o,o=s,s=r,r=p+m|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(r,s,o,i,c,a,u,d)}roundClean(){Ye.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};We.SHA256=Lt;var Wn=class extends Lt{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};We.sha256=(0,He.wrapConstructor)(()=>new Lt);We.sha224=(0,He.wrapConstructor)(()=>new Wn)});var Oo=G(at=>{v();A();Object.defineProperty(at,"__esModule",{value:!0});at.hmac=at.HMAC=void 0;var sn=nn(),Lo=ze(),Ot=class extends Lo.Hash{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,(0,sn.hash)(t);let r=(0,Lo.toBytes)(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?t.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(t){return(0,sn.exists)(this),this.iHash.update(t),this}digestInto(t){(0,sn.exists)(this),(0,sn.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:s,destroyed:o,blockLen:i,outputLen:c}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};at.HMAC=Ot;var Nc=(e,t,n)=>new Ot(e,t).update(n).digest();at.hmac=Nc;at.hmac.create=(e,t)=>new Ot(e,t)});var Oe=G(Q=>{v();A();Object.defineProperty(Q,"__esModule",{value:!0});Q.notImplemented=Q.bitMask=void 0;Q.isBytes=an;Q.abytes=dn;Q.abool=Uc;Q.bytesToHex=er;Q.numberToHexUnpadded=Po;Q.hexToNumber=tr;Q.hexToBytes=un;Q.bytesToNumberBE=jc;Q.bytesToNumberLE=Mc;Q.numberToBytesBE=Ho;Q.numberToBytesLE=$c;Q.numberToVarBytesBE=Vc;Q.ensureBytes=Kc;Q.concatBytes=No;Q.equalBytes=Zc;Q.utf8ToBytes=zc;Q.inRange=ko;Q.aInRange=Gc;Q.bitLen=Xc;Q.bitGet=Yc;Q.bitSet=Wc;Q.createHmacDrbg=Qc;Q.validateObject=ea;Q.memoized=na;var Jn=BigInt(0),cn=BigInt(1),kc=BigInt(2);function an(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function dn(e){if(!an(e))throw new Error("Uint8Array expected")}function Uc(e,t){if(typeof t!="boolean")throw new Error(`${e} must be valid boolean, got "${t}".`)}var Dc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function er(e){dn(e);let t="";for(let n=0;n<e.length;n++)t+=Dc[e[n]];return t}function Po(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function tr(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}var Ke={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function qo(e){if(e>=Ke._0&&e<=Ke._9)return e-Ke._0;if(e>=Ke._A&&e<=Ke._F)return e-(Ke._A-10);if(e>=Ke._a&&e<=Ke._f)return e-(Ke._a-10)}function un(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=qo(e.charCodeAt(o)),c=qo(e.charCodeAt(o+1));if(i===void 0||c===void 0){let a=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+o)}r[s]=i*16+c}return r}function jc(e){return tr(er(e))}function Mc(e){return dn(e),tr(er(Uint8Array.from(e).reverse()))}function Ho(e,t){return un(e.toString(16).padStart(t*2,"0"))}function $c(e,t){return Ho(e,t).reverse()}function Vc(e){return un(Po(e))}function Kc(e,t,n){let r;if(typeof t=="string")try{r=un(t)}catch(o){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${o}`)}else if(an(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${e} expected ${n} bytes, got ${s}`);return r}function No(...e){let t=0;for(let r=0;r<e.length;r++){let s=e[r];dn(s),t+=s.length}let n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){let o=e[r];n.set(o,s),s+=o.length}return n}function Zc(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function zc(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}var Fn=e=>typeof e=="bigint"&&Jn<=e;function ko(e,t,n){return Fn(e)&&Fn(t)&&Fn(n)&&t<=e&&e<n}function Gc(e,t,n,r){if(!ko(t,n,r))throw new Error(`expected valid ${e}: ${n} <= n < ${r}, got ${typeof t} ${t}`)}function Xc(e){let t;for(t=0;e>Jn;e>>=cn,t+=1);return t}function Yc(e,t){return e>>BigInt(t)&cn}function Wc(e,t,n){return e|(n?cn:Jn)<<BigInt(t)}var Fc=e=>(kc<<BigInt(e-1))-cn;Q.bitMask=Fc;var Qn=e=>new Uint8Array(e),Ro=e=>Uint8Array.from(e);function Qc(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Qn(e),s=Qn(e),o=0,i=()=>{r.fill(1),s.fill(0),o=0},c=(...f)=>n(s,r,...f),a=(f=Qn())=>{s=c(Ro([0]),f),r=c(),f.length!==0&&(s=c(Ro([1]),f),r=c())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,l=[];for(;f<t;){r=c();let p=r.slice();l.push(p),f+=r.length}return No(...l)};return(f,l)=>{i(),a(f);let p;for(;!(p=l(u()));)a();return i(),p}}var Jc={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||an(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function ea(e,t,n={}){let r=(s,o,i)=>{let c=Jc[o];if(typeof c!="function")throw new Error(`Invalid validator "${o}", expected function`);let a=e[s];if(!(i&&a===void 0)&&!c(a,e))throw new Error(`Invalid param ${String(s)}=${a} (${typeof a}), expected ${o}`)};for(let[s,o]of Object.entries(t))r(s,o,!1);for(let[s,o]of Object.entries(n))r(s,o,!0);return e}var ta=()=>{throw new Error("not implemented")};Q.notImplemented=ta;function na(e){let t=new WeakMap;return(n,...r)=>{let s=t.get(n);if(s!==void 0)return s;let o=e(n,...r);return t.set(n,o),o}}});var Qe=G(se=>{v();A();Object.defineProperty(se,"__esModule",{value:!0});se.isNegativeLE=void 0;se.mod=qe;se.pow=jo;se.pow2=ia;se.invert=fn;se.tonelliShanks=Mo;se.FpSqrt=$o;se.validateField=da;se.FpPow=Vo;se.FpInvertBatch=Ko;se.FpDiv=ua;se.FpLegendre=Zo;se.FpIsSquare=fa;se.nLength=rr;se.Field=la;se.FpSqrtOdd=ha;se.FpSqrtEven=ba;se.hashToPrivateScalar=ya;se.getFieldBytesLength=or;se.getMinHashLength=zo;se.mapHashToField=ga;var Re=Oe(),ue=BigInt(0),te=BigInt(1),Fe=BigInt(2),ra=BigInt(3),nr=BigInt(4),Uo=BigInt(5),Do=BigInt(8),oa=BigInt(9),sa=BigInt(16);function qe(e,t){let n=e%t;return n>=ue?n:t+n}function jo(e,t,n){if(n<=ue||t<ue)throw new Error("Expected power/modulo > 0");if(n===te)return ue;let r=te;for(;t>ue;)t&te&&(r=r*e%n),e=e*e%n,t>>=te;return r}function ia(e,t,n){let r=e;for(;t-- >ue;)r*=r,r%=n;return r}function fn(e,t){if(e===ue||t<=ue)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=qe(e,t),r=t,s=ue,o=te,i=te,c=ue;for(;n!==ue;){let u=r/n,d=r%n,f=s-i*u,l=o-c*u;r=n,n=d,s=i,o=c,i=f,c=l}if(r!==te)throw new Error("invert: does not exist");return qe(s,t)}function Mo(e){let t=(e-te)/Fe,n,r,s;for(n=e-te,r=0;n%Fe===ue;n/=Fe,r++);for(s=Fe;s<e&&jo(s,t,e)!==e-te;s++);if(r===1){let i=(e+te)/nr;return function(a,u){let d=a.pow(u,i);if(!a.eql(a.sqr(d),u))throw new Error("Cannot find square root");return d}}let o=(n+te)/Fe;return function(c,a){if(c.pow(a,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let u=r,d=c.pow(c.mul(c.ONE,s),n),f=c.pow(a,o),l=c.pow(a,n);for(;!c.eql(l,c.ONE);){if(c.eql(l,c.ZERO))return c.ZERO;let p=1;for(let m=c.sqr(l);p<u&&!c.eql(m,c.ONE);p++)m=c.sqr(m);let B=c.pow(d,te<<BigInt(u-p-1));d=c.sqr(B),f=c.mul(f,B),l=c.mul(l,d),u=p}return f}}function $o(e){if(e%nr===ra){let t=(e+te)/nr;return function(r,s){let o=r.pow(s,t);if(!r.eql(r.sqr(o),s))throw new Error("Cannot find square root");return o}}if(e%Do===Uo){let t=(e-Uo)/Do;return function(r,s){let o=r.mul(s,Fe),i=r.pow(o,t),c=r.mul(s,i),a=r.mul(r.mul(c,Fe),i),u=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(u),s))throw new Error("Cannot find square root");return u}}return e%sa,Mo(e)}var ca=(e,t)=>(qe(e,t)&te)===te;se.isNegativeLE=ca;var aa=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function da(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=aa.reduce((r,s)=>(r[s]="function",r),t);return(0,Re.validateObject)(e,n)}function Vo(e,t,n){if(n<ue)throw new Error("Expected power > 0");if(n===ue)return e.ONE;if(n===te)return t;let r=e.ONE,s=t;for(;n>ue;)n&te&&(r=e.mul(r,s)),s=e.sqr(s),n>>=te;return r}function Ko(e,t){let n=new Array(t.length),r=t.reduce((o,i,c)=>e.is0(i)?o:(n[c]=o,e.mul(o,i)),e.ONE),s=e.inv(r);return t.reduceRight((o,i,c)=>e.is0(i)?o:(n[c]=e.mul(o,n[c]),e.mul(o,i)),s),n}function ua(e,t,n){return e.mul(t,typeof n=="bigint"?fn(n,e.ORDER):e.inv(n))}function Zo(e){let t=(e-te)/Fe;return(n,r)=>n.pow(r,t)}function fa(e){let t=Zo(e.ORDER);return n=>{let r=t(e,n);return e.eql(r,e.ZERO)||e.eql(r,e.ONE)}}function rr(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function la(e,t,n=!1,r={}){if(e<=ue)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:s,nByteLength:o}=rr(e,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=$o(e),c=Object.freeze({ORDER:e,BITS:s,BYTES:o,MASK:(0,Re.bitMask)(s),ZERO:ue,ONE:te,create:a=>qe(a,e),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return ue<=a&&a<e},is0:a=>a===ue,isOdd:a=>(a&te)===te,neg:a=>qe(-a,e),eql:(a,u)=>a===u,sqr:a=>qe(a*a,e),add:(a,u)=>qe(a+u,e),sub:(a,u)=>qe(a-u,e),mul:(a,u)=>qe(a*u,e),pow:(a,u)=>Vo(c,a,u),div:(a,u)=>qe(a*fn(u,e),e),sqrN:a=>a*a,addN:(a,u)=>a+u,subN:(a,u)=>a-u,mulN:(a,u)=>a*u,inv:a=>fn(a,e),sqrt:r.sqrt||(a=>i(c,a)),invertBatch:a=>Ko(c,a),cmov:(a,u,d)=>d?u:a,toBytes:a=>n?(0,Re.numberToBytesLE)(a,o):(0,Re.numberToBytesBE)(a,o),fromBytes:a=>{if(a.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${a.length}`);return n?(0,Re.bytesToNumberLE)(a):(0,Re.bytesToNumberBE)(a)}});return Object.freeze(c)}function ha(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?n:e.neg(n)}function ba(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n}function ya(e,t,n=!1){e=(0,Re.ensureBytes)("privateHash",e);let r=e.length,s=rr(t).nByteLength+8;if(s<24||r<s||r>1024)throw new Error(`hashToPrivateScalar: expected ${s}-1024 bytes of input, got ${r}`);let o=n?(0,Re.bytesToNumberLE)(e):(0,Re.bytesToNumberBE)(e);return qe(o,t-te)+te}function or(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function zo(e){let t=or(e);return t+Math.ceil(t/2)}function ga(e,t,n=!1){let r=e.length,s=or(t),o=zo(t);if(r<16||r<o||r>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${r}`);let i=n?(0,Re.bytesToNumberBE)(e):(0,Re.bytesToNumberLE)(e),c=qe(i,t-te)+te;return n?(0,Re.numberToBytesLE)(c,s):(0,Re.numberToBytesBE)(c,s)}});var cr=G(qt=>{v();A();Object.defineProperty(qt,"__esModule",{value:!0});qt.wNAF=wa;qt.pippenger=pa;qt.validateBasic=_a;var Go=Qe(),Yo=Oe(),ma=BigInt(0),sr=BigInt(1),ir=new WeakMap,Xo=new WeakMap;function wa(e,t){let n=(o,i)=>{let c=i.negate();return o?c:i},r=o=>{if(!Number.isSafeInteger(o)||o<=0||o>t)throw new Error(`Wrong window size=${o}, should be [1..${t}]`)},s=o=>{r(o);let i=Math.ceil(t/o)+1,c=2**(o-1);return{windows:i,windowSize:c}};return{constTimeNegate:n,unsafeLadder(o,i){let c=e.ZERO,a=o;for(;i>ma;)i&sr&&(c=c.add(a)),a=a.double(),i>>=sr;return c},precomputeWindow(o,i){let{windows:c,windowSize:a}=s(i),u=[],d=o,f=d;for(let l=0;l<c;l++){f=d,u.push(f);for(let p=1;p<a;p++)f=f.add(d),u.push(f);d=f.double()}return u},wNAF(o,i,c){let{windows:a,windowSize:u}=s(o),d=e.ZERO,f=e.BASE,l=BigInt(2**o-1),p=2**o,B=BigInt(o);for(let m=0;m<a;m++){let h=m*u,w=Number(c&l);c>>=B,w>u&&(w-=p,c+=sr);let g=h,b=h+Math.abs(w)-1,x=m%2!==0,H=w<0;w===0?f=f.add(n(x,i[g])):d=d.add(n(H,i[b]))}return{p:d,f}},wNAFCached(o,i,c){let a=Xo.get(o)||1,u=ir.get(o);return u||(u=this.precomputeWindow(o,a),a!==1&&ir.set(o,c(u))),this.wNAF(a,u,i)},setWindowSize(o,i){r(i),Xo.set(o,i),ir.delete(o)}}}function pa(e,t,n,r){if(!Array.isArray(n)||!Array.isArray(r)||r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");r.forEach((d,f)=>{if(!t.isValid(d))throw new Error(`wrong scalar at index ${f}`)}),n.forEach((d,f)=>{if(!(d instanceof e))throw new Error(`wrong point at index ${f}`)});let s=(0,Yo.bitLen)(BigInt(n.length)),o=s>12?s-3:s>4?s-2:s?2:1,i=(1<<o)-1,c=new Array(i+1).fill(e.ZERO),a=Math.floor((t.BITS-1)/o)*o,u=e.ZERO;for(let d=a;d>=0;d-=o){c.fill(e.ZERO);for(let l=0;l<r.length;l++){let p=r[l],B=Number(p>>BigInt(d)&BigInt(i));c[B]=c[B].add(n[l])}let f=e.ZERO;for(let l=c.length-1,p=e.ZERO;l>0;l--)p=p.add(c[l]),f=f.add(p);if(u=u.add(f),d!==0)for(let l=0;l<o;l++)u=u.double()}return u}function _a(e){return(0,Go.validateField)(e.Fp),(0,Yo.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Go.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}});var ar=G(we=>{v();A();Object.defineProperty(we,"__esModule",{value:!0});we.DER=void 0;we.weierstrassPoints=Qo;we.weierstrass=Aa;we.SWUFpSqrtRatio=Jo;we.mapToCurveSimpleSWU=Sa;var ln=cr(),dt=Qe(),Y=Oe(),me=Oe();function Wo(e){e.lowS!==void 0&&(0,me.abool)("lowS",e.lowS),e.prehash!==void 0&&(0,me.abool)("prehash",e.prehash)}function xa(e){let t=(0,ln.validateBasic)(e);Y.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:n,Fp:r,a:s}=t;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Ea,hexToBytes:Ba}=Y;we.DER={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(e,t)=>{let{Err:n}=we.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");let r=t.length/2,s=Y.numberToHexUnpadded(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");let o=r>127?Y.numberToHexUnpadded(s.length/2|128):"";return`${Y.numberToHexUnpadded(e)}${o}${s}${t}`},decode(e,t){let{Err:n}=we.DER,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");let s=t[r++],o=!!(s&128),i=0;if(!o)i=s;else{let a=s&127;if(!a)throw new n("tlv.decode(long): indefinite length not supported");if(a>4)throw new n("tlv.decode(long): byte length is too big");let u=t.subarray(r,r+a);if(u.length!==a)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(let d of u)i=i<<8|d;if(r+=a,i<128)throw new n("tlv.decode(long): not minimal encoding")}let c=t.subarray(r,r+i);if(c.length!==i)throw new n("tlv.decode: wrong value length");return{v:c,l:t.subarray(r+i)}}},_int:{encode(e){let{Err:t}=we.DER;if(e<ke)throw new t("integer: negative integers are not allowed");let n=Y.numberToHexUnpadded(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected assertion");return n},decode(e){let{Err:t}=we.DER;if(e[0]&128)throw new t("Invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return Ea(e)}},toSig(e){let{Err:t,_int:n,_tlv:r}=we.DER,s=typeof e=="string"?Ba(e):e;Y.abytes(s);let{v:o,l:i}=r.decode(48,s);if(i.length)throw new t("Invalid signature: left bytes after parsing");let{v:c,l:a}=r.decode(2,o),{v:u,l:d}=r.decode(2,a);if(d.length)throw new t("Invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(u)}},hexFromSig(e){let{_tlv:t,_int:n}=we.DER,r=`${t.encode(2,n.encode(e.r))}${t.encode(2,n.encode(e.s))}`;return t.encode(48,r)}};var ke=BigInt(0),ee=BigInt(1),Je=BigInt(2),hn=BigInt(3),Fo=BigInt(4);function Qo(e){let t=xa(e),{Fp:n}=t,r=dt.Field(t.n,t.nBitLength),s=t.toBytes||((m,h,w)=>{let g=h.toAffine();return Y.concatBytes(Uint8Array.from([4]),n.toBytes(g.x),n.toBytes(g.y))}),o=t.fromBytes||(m=>{let h=m.subarray(1),w=n.fromBytes(h.subarray(0,n.BYTES)),g=n.fromBytes(h.subarray(n.BYTES,2*n.BYTES));return{x:w,y:g}});function i(m){let{a:h,b:w}=t,g=n.sqr(m),b=n.mul(g,m);return n.add(n.add(b,n.mul(m,h)),w)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function c(m){return Y.inRange(m,ee,t.n)}function a(m){let{allowedPrivateKeyLengths:h,nByteLength:w,wrapPrivateKey:g,n:b}=t;if(h&&typeof m!="bigint"){if(Y.isBytes(m)&&(m=Y.bytesToHex(m)),typeof m!="string"||!h.includes(m.length))throw new Error("Invalid key");m=m.padStart(w*2,"0")}let x;try{x=typeof m=="bigint"?m:Y.bytesToNumberBE((0,me.ensureBytes)("private key",m,w))}catch{throw new Error(`private key must be ${w} bytes, hex or bigint, not ${typeof m}`)}return g&&(x=dt.mod(x,b)),Y.aInRange("private key",x,ee,b),x}function u(m){if(!(m instanceof l))throw new Error("ProjectivePoint expected")}let d=(0,me.memoized)((m,h)=>{let{px:w,py:g,pz:b}=m;if(n.eql(b,n.ONE))return{x:w,y:g};let x=m.is0();h==null&&(h=x?n.ONE:n.inv(b));let H=n.mul(w,h),C=n.mul(g,h),I=n.mul(b,h);if(x)return{x:n.ZERO,y:n.ZERO};if(!n.eql(I,n.ONE))throw new Error("invZ was invalid");return{x:H,y:C}}),f=(0,me.memoized)(m=>{if(m.is0()){if(t.allowInfinityPoint&&!n.is0(m.py))return;throw new Error("bad point: ZERO")}let{x:h,y:w}=m.toAffine();if(!n.isValid(h)||!n.isValid(w))throw new Error("bad point: x or y not FE");let g=n.sqr(w),b=i(h);if(!n.eql(g,b))throw new Error("bad point: equation left != right");if(!m.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class l{constructor(h,w,g){if(this.px=h,this.py=w,this.pz=g,h==null||!n.isValid(h))throw new Error("x required");if(w==null||!n.isValid(w))throw new Error("y required");if(g==null||!n.isValid(g))throw new Error("z required");Object.freeze(this)}static fromAffine(h){let{x:w,y:g}=h||{};if(!h||!n.isValid(w)||!n.isValid(g))throw new Error("invalid affine point");if(h instanceof l)throw new Error("projective point not allowed");let b=x=>n.eql(x,n.ZERO);return b(w)&&b(g)?l.ZERO:new l(w,g,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){let w=n.invertBatch(h.map(g=>g.pz));return h.map((g,b)=>g.toAffine(w[b])).map(l.fromAffine)}static fromHex(h){let w=l.fromAffine(o((0,me.ensureBytes)("pointHex",h)));return w.assertValidity(),w}static fromPrivateKey(h){return l.BASE.multiply(a(h))}static msm(h,w){return(0,ln.pippenger)(l,r,h,w)}_setWindowSize(h){B.setWindowSize(this,h)}assertValidity(){f(this)}hasEvenY(){let{y:h}=this.toAffine();if(n.isOdd)return!n.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){u(h);let{px:w,py:g,pz:b}=this,{px:x,py:H,pz:C}=h,I=n.eql(n.mul(w,C),n.mul(x,b)),O=n.eql(n.mul(g,C),n.mul(H,b));return I&&O}negate(){return new l(this.px,n.neg(this.py),this.pz)}double(){let{a:h,b:w}=t,g=n.mul(w,hn),{px:b,py:x,pz:H}=this,C=n.ZERO,I=n.ZERO,O=n.ZERO,R=n.mul(b,b),ne=n.mul(x,x),U=n.mul(H,H),Z=n.mul(b,x);return Z=n.add(Z,Z),O=n.mul(b,H),O=n.add(O,O),C=n.mul(h,O),I=n.mul(g,U),I=n.add(C,I),C=n.sub(ne,I),I=n.add(ne,I),I=n.mul(C,I),C=n.mul(Z,C),O=n.mul(g,O),U=n.mul(h,U),Z=n.sub(R,U),Z=n.mul(h,Z),Z=n.add(Z,O),O=n.add(R,R),R=n.add(O,R),R=n.add(R,U),R=n.mul(R,Z),I=n.add(I,R),U=n.mul(x,H),U=n.add(U,U),R=n.mul(U,Z),C=n.sub(C,R),O=n.mul(U,ne),O=n.add(O,O),O=n.add(O,O),new l(C,I,O)}add(h){u(h);let{px:w,py:g,pz:b}=this,{px:x,py:H,pz:C}=h,I=n.ZERO,O=n.ZERO,R=n.ZERO,ne=t.a,U=n.mul(t.b,hn),Z=n.mul(w,x),ie=n.mul(g,H),T=n.mul(b,C),q=n.add(w,g),_=n.add(x,H);q=n.mul(q,_),_=n.add(Z,ie),q=n.sub(q,_),_=n.add(w,b);let y=n.add(x,C);return _=n.mul(_,y),y=n.add(Z,T),_=n.sub(_,y),y=n.add(g,b),I=n.add(H,C),y=n.mul(y,I),I=n.add(ie,T),y=n.sub(y,I),R=n.mul(ne,_),I=n.mul(U,T),R=n.add(I,R),I=n.sub(ie,R),R=n.add(ie,R),O=n.mul(I,R),ie=n.add(Z,Z),ie=n.add(ie,Z),T=n.mul(ne,T),_=n.mul(U,_),ie=n.add(ie,T),T=n.sub(Z,T),T=n.mul(ne,T),_=n.add(_,T),Z=n.mul(ie,_),O=n.add(O,Z),Z=n.mul(y,_),I=n.mul(q,I),I=n.sub(I,Z),Z=n.mul(q,ie),R=n.mul(y,R),R=n.add(R,Z),new l(I,O,R)}subtract(h){return this.add(h.negate())}is0(){return this.equals(l.ZERO)}wNAF(h){return B.wNAFCached(this,h,l.normalizeZ)}multiplyUnsafe(h){Y.aInRange("scalar",h,ke,t.n);let w=l.ZERO;if(h===ke)return w;if(h===ee)return this;let{endo:g}=t;if(!g)return B.unsafeLadder(this,h);let{k1neg:b,k1:x,k2neg:H,k2:C}=g.splitScalar(h),I=w,O=w,R=this;for(;x>ke||C>ke;)x&ee&&(I=I.add(R)),C&ee&&(O=O.add(R)),R=R.double(),x>>=ee,C>>=ee;return b&&(I=I.negate()),H&&(O=O.negate()),O=new l(n.mul(O.px,g.beta),O.py,O.pz),I.add(O)}multiply(h){let{endo:w,n:g}=t;Y.aInRange("scalar",h,ee,g);let b,x;if(w){let{k1neg:H,k1:C,k2neg:I,k2:O}=w.splitScalar(h),{p:R,f:ne}=this.wNAF(C),{p:U,f:Z}=this.wNAF(O);R=B.constTimeNegate(H,R),U=B.constTimeNegate(I,U),U=new l(n.mul(U.px,w.beta),U.py,U.pz),b=R.add(U),x=ne.add(Z)}else{let{p:H,f:C}=this.wNAF(h);b=H,x=C}return l.normalizeZ([b,x])[0]}multiplyAndAddUnsafe(h,w,g){let b=l.BASE,x=(C,I)=>I===ke||I===ee||!C.equals(b)?C.multiplyUnsafe(I):C.multiply(I),H=x(this,w).add(x(h,g));return H.is0()?void 0:H}toAffine(h){return d(this,h)}isTorsionFree(){let{h,isTorsionFree:w}=t;if(h===ee)return!0;if(w)return w(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h,clearCofactor:w}=t;return h===ee?this:w?w(l,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return(0,me.abool)("isCompressed",h),this.assertValidity(),s(l,this,h)}toHex(h=!0){return(0,me.abool)("isCompressed",h),Y.bytesToHex(this.toRawBytes(h))}}l.BASE=new l(t.Gx,t.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);let p=t.nBitLength,B=(0,ln.wNAF)(l,t.endo?Math.ceil(p/2):p);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:a,weierstrassEquation:i,isWithinCurveOrder:c}}function va(e){let t=(0,ln.validateBasic)(e);return Y.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Aa(e){let t=va(e),{Fp:n,n:r}=t,s=n.BYTES+1,o=2*n.BYTES+1;function i(T){return dt.mod(T,r)}function c(T){return dt.invert(T,r)}let{ProjectivePoint:a,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:f}=Qo({...t,toBytes(T,q,_){let y=q.toAffine(),E=n.toBytes(y.x),P=Y.concatBytes;return(0,me.abool)("isCompressed",_),_?P(Uint8Array.from([q.hasEvenY()?2:3]),E):P(Uint8Array.from([4]),E,n.toBytes(y.y))},fromBytes(T){let q=T.length,_=T[0],y=T.subarray(1);if(q===s&&(_===2||_===3)){let E=Y.bytesToNumberBE(y);if(!Y.inRange(E,ee,n.ORDER))throw new Error("Point is not on curve");let P=d(E),N;try{N=n.sqrt(P)}catch(z){let K=z instanceof Error?": "+z.message:"";throw new Error("Point is not on curve"+K)}let k=(N&ee)===ee;return(_&1)===1!==k&&(N=n.neg(N)),{x:E,y:N}}else if(q===o&&_===4){let E=n.fromBytes(y.subarray(0,n.BYTES)),P=n.fromBytes(y.subarray(n.BYTES,2*n.BYTES));return{x:E,y:P}}else throw new Error(`Point of length ${q} was invalid. Expected ${s} compressed bytes or ${o} uncompressed bytes`)}}),l=T=>Y.bytesToHex(Y.numberToBytesBE(T,t.nByteLength));function p(T){let q=r>>ee;return T>q}function B(T){return p(T)?i(-T):T}let m=(T,q,_)=>Y.bytesToNumberBE(T.slice(q,_));class h{constructor(q,_,y){this.r=q,this.s=_,this.recovery=y,this.assertValidity()}static fromCompact(q){let _=t.nByteLength;return q=(0,me.ensureBytes)("compactSignature",q,_*2),new h(m(q,0,_),m(q,_,2*_))}static fromDER(q){let{r:_,s:y}=we.DER.toSig((0,me.ensureBytes)("DER",q));return new h(_,y)}assertValidity(){Y.aInRange("r",this.r,ee,r),Y.aInRange("s",this.s,ee,r)}addRecoveryBit(q){return new h(this.r,this.s,q)}recoverPublicKey(q){let{r:_,s:y,recovery:E}=this,P=C((0,me.ensureBytes)("msgHash",q));if(E==null||![0,1,2,3].includes(E))throw new Error("recovery id invalid");let N=E===2||E===3?_+t.n:_;if(N>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");let k=(E&1)===0?"02":"03",V=a.fromHex(k+l(N)),z=c(N),K=i(-P*z),F=i(y*z),re=a.BASE.multiplyAndAddUnsafe(V,K,F);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return Y.hexToBytes(this.toDERHex())}toDERHex(){return we.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Y.hexToBytes(this.toCompactHex())}toCompactHex(){return l(this.r)+l(this.s)}}let w={isValidPrivateKey(T){try{return u(T),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let T=dt.getMinHashLength(t.n);return dt.mapHashToField(t.randomBytes(T),t.n)},precompute(T=8,q=a.BASE){return q._setWindowSize(T),q.multiply(BigInt(3)),q}};function g(T,q=!0){return a.fromPrivateKey(T).toRawBytes(q)}function b(T){let q=Y.isBytes(T),_=typeof T=="string",y=(q||_)&&T.length;return q?y===s||y===o:_?y===2*s||y===2*o:T instanceof a}function x(T,q,_=!0){if(b(T))throw new Error("first arg must be private key");if(!b(q))throw new Error("second arg must be public key");return a.fromHex(q).multiply(u(T)).toRawBytes(_)}let H=t.bits2int||function(T){let q=Y.bytesToNumberBE(T),_=T.length*8-t.nBitLength;return _>0?q>>BigInt(_):q},C=t.bits2int_modN||function(T){return i(H(T))},I=Y.bitMask(t.nBitLength);function O(T){return Y.aInRange(`num < 2^${t.nBitLength}`,T,ke,I),Y.numberToBytesBE(T,t.nByteLength)}function R(T,q,_=ne){if(["recovered","canonical"].some(le=>le in _))throw new Error("sign() legacy options not supported");let{hash:y,randomBytes:E}=t,{lowS:P,prehash:N,extraEntropy:k}=_;P==null&&(P=!0),T=(0,me.ensureBytes)("msgHash",T),Wo(_),N&&(T=(0,me.ensureBytes)("prehashed msgHash",y(T)));let V=C(T),z=u(q),K=[O(z),O(V)];if(k!=null&&k!==!1){let le=k===!0?E(n.BYTES):k;K.push((0,me.ensureBytes)("extraEntropy",le))}let F=Y.concatBytes(...K),re=V;function fe(le){let ge=H(le);if(!f(ge))return;let _e=c(ge),ae=a.BASE.multiply(ge).toAffine(),Ee=i(ae.x);if(Ee===ke)return;let Me=i(_e*i(re+Ee*z));if(Me===ke)return;let Et=(ae.x===Ee?0:2)|Number(ae.y&ee),Bt=Me;return P&&p(Me)&&(Bt=B(Me),Et^=1),new h(Ee,Bt,Et)}return{seed:F,k2sig:fe}}let ne={lowS:t.lowS,prehash:!1},U={lowS:t.lowS,prehash:!1};function Z(T,q,_=ne){let{seed:y,k2sig:E}=R(T,q,_),P=t;return Y.createHmacDrbg(P.hash.outputLen,P.nByteLength,P.hmac)(y,E)}a.BASE._setWindowSize(8);function ie(T,q,_,y=U){let E=T;if(q=(0,me.ensureBytes)("msgHash",q),_=(0,me.ensureBytes)("publicKey",_),"strict"in y)throw new Error("options.strict was renamed to lowS");Wo(y);let{lowS:P,prehash:N}=y,k,V;try{if(typeof E=="string"||Y.isBytes(E))try{k=h.fromDER(E)}catch(ae){if(!(ae instanceof we.DER.Err))throw ae;k=h.fromCompact(E)}else if(typeof E=="object"&&typeof E.r=="bigint"&&typeof E.s=="bigint"){let{r:ae,s:Ee}=E;k=new h(ae,Ee)}else throw new Error("PARSE");V=a.fromHex(_)}catch(ae){if(ae.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(P&&k.hasHighS())return!1;N&&(q=t.hash(q));let{r:z,s:K}=k,F=C(q),re=c(K),fe=i(F*re),le=i(z*re),ge=a.BASE.multiplyAndAddUnsafe(V,fe,le)?.toAffine();return ge?i(ge.x)===z:!1}return{CURVE:t,getPublicKey:g,getSharedSecret:x,sign:Z,verify:ie,ProjectivePoint:a,Signature:h,utils:w}}function Jo(e,t){let n=e.ORDER,r=ke;for(let B=n-ee;B%Je===ke;B/=Je)r+=ee;let s=r,o=Je<<s-ee-ee,i=o*Je,c=(n-ee)/i,a=(c-ee)/Je,u=i-ee,d=o,f=e.pow(t,c),l=e.pow(t,(c+ee)/Je),p=(B,m)=>{let h=f,w=e.pow(m,u),g=e.sqr(w);g=e.mul(g,m);let b=e.mul(B,g);b=e.pow(b,a),b=e.mul(b,w),w=e.mul(b,m),g=e.mul(b,B);let x=e.mul(g,w);b=e.pow(x,d);let H=e.eql(b,e.ONE);w=e.mul(g,l),b=e.mul(x,h),g=e.cmov(w,g,H),x=e.cmov(b,x,H);for(let C=s;C>ee;C--){let I=C-Je;I=Je<<I-ee;let O=e.pow(x,I),R=e.eql(O,e.ONE);w=e.mul(g,h),h=e.mul(h,h),O=e.mul(x,h),g=e.cmov(w,g,R),x=e.cmov(O,x,R)}return{isValid:H,value:g}};if(e.ORDER%Fo===hn){let B=(e.ORDER-hn)/Fo,m=e.sqrt(e.neg(t));p=(h,w)=>{let g=e.sqr(w),b=e.mul(h,w);g=e.mul(g,b);let x=e.pow(g,B);x=e.mul(x,b);let H=e.mul(x,m),C=e.mul(e.sqr(x),w),I=e.eql(C,h),O=e.cmov(H,x,I);return{isValid:I,value:O}}}return p}function Sa(e,t){if(dt.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let n=Jo(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let s,o,i,c,a,u,d,f;s=e.sqr(r),s=e.mul(s,t.Z),o=e.sqr(s),o=e.add(o,s),i=e.add(o,e.ONE),i=e.mul(i,t.B),c=e.cmov(t.Z,e.neg(o),!e.eql(o,e.ZERO)),c=e.mul(c,t.A),o=e.sqr(i),u=e.sqr(c),a=e.mul(u,t.A),o=e.add(o,a),o=e.mul(o,i),u=e.mul(u,c),a=e.mul(u,t.B),o=e.add(o,a),d=e.mul(s,i);let{isValid:l,value:p}=n(o,u);f=e.mul(s,r),f=e.mul(f,p),d=e.cmov(d,i,l),f=e.cmov(f,p,l);let B=e.isOdd(r)===e.isOdd(f);return f=e.cmov(e.neg(f),f,B),d=e.div(d,c),{x:d,y:f}}}});var ns=G(bn=>{v();A();Object.defineProperty(bn,"__esModule",{value:!0});bn.getHash=ts;bn.createCurve=Ia;var Ta=Oo(),es=ze(),Ca=ar();function ts(e){return{hash:e,hmac:(t,...n)=>(0,Ta.hmac)(e,t,(0,es.concatBytes)(...n)),randomBytes:es.randomBytes}}function Ia(e,t){let n=r=>(0,Ca.weierstrass)({...e,...ts(r)});return Object.freeze({...n(t),create:n})}});var ur=G(ut=>{v();A();Object.defineProperty(ut,"__esModule",{value:!0});ut.expand_message_xmd=rs;ut.expand_message_xof=os;ut.hash_to_field=dr;ut.isogenyMap=Ra;ut.createHasher=Pa;var La=Qe(),pe=Oe(),Oa=pe.bytesToNumberBE;function et(e,t){if(Rt(e),Rt(t),e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=e&255,e>>>=8;return new Uint8Array(n)}function qa(e,t){let n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function Rt(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function rs(e,t,n,r){(0,pe.abytes)(e),(0,pe.abytes)(t),Rt(n),t.length>255&&(t=r((0,pe.concatBytes)((0,pe.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:s,blockLen:o}=r,i=Math.ceil(n/s);if(n>65535||i>255)throw new Error("expand_message_xmd: invalid lenInBytes");let c=(0,pe.concatBytes)(t,et(t.length,1)),a=et(0,o),u=et(n,2),d=new Array(i),f=r((0,pe.concatBytes)(a,e,u,et(0,1),c));d[0]=r((0,pe.concatBytes)(f,et(1,1),c));for(let p=1;p<=i;p++){let B=[qa(f,d[p-1]),et(p+1,1),c];d[p]=r((0,pe.concatBytes)(...B))}return(0,pe.concatBytes)(...d).slice(0,n)}function os(e,t,n,r,s){if((0,pe.abytes)(e),(0,pe.abytes)(t),Rt(n),t.length>255){let o=Math.ceil(2*r/8);t=s.create({dkLen:o}).update((0,pe.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:n}).update(e).update(et(n,2)).update(t).update(et(t.length,1)).digest()}function dr(e,t,n){(0,pe.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:r,k:s,m:o,hash:i,expand:c,DST:a}=n;(0,pe.abytes)(e),Rt(t);let u=typeof a=="string"?(0,pe.utf8ToBytes)(a):a,d=r.toString(2).length,f=Math.ceil((d+s)/8),l=t*o*f,p;if(c==="xmd")p=rs(e,u,l,i);else if(c==="xof")p=os(e,u,l,s,i);else if(c==="_internal_pass")p=e;else throw new Error('expand must be "xmd" or "xof"');let B=new Array(t);for(let m=0;m<t;m++){let h=new Array(o);for(let w=0;w<o;w++){let g=f*(w+m*o),b=p.subarray(g,g+f);h[w]=(0,La.mod)(Oa(b),r)}B[m]=h}return B}function Ra(e,t){let n=t.map(r=>Array.from(r).reverse());return(r,s)=>{let[o,i,c,a]=n.map(u=>u.reduce((d,f)=>e.add(e.mul(d,r),f)));return r=e.div(o,i),s=e.mul(s,e.div(c,a)),{x:r,y:s}}}function Pa(e,t,n){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,s){let o=dr(r,2,{...n,DST:n.DST,...s}),i=e.fromAffine(t(o[0])),c=e.fromAffine(t(o[1])),a=i.add(c).clearCofactor();return a.assertValidity(),a},encodeToCurve(r,s){let o=dr(r,1,{...n,DST:n.encodeDST,...s}),i=e.fromAffine(t(o[0])).clearCofactor();return i.assertValidity(),i},mapToCurve(r){if(!Array.isArray(r))throw new Error("mapToCurve: expected array of bigints");for(let o of r)if(typeof o!="bigint")throw new Error(`mapToCurve: expected array of bigints, got ${o} in array`);let s=e.fromAffine(t(r)).clearCofactor();return s.assertValidity(),s}}}});var gr=G(Te=>{v();A();Object.defineProperty(Te,"__esModule",{value:!0});Te.encodeToCurve=Te.hashToCurve=Te.schnorr=Te.secp256k1=void 0;var yn=Io(),Ha=ze(),Na=ns(),cs=ur(),he=Qe(),Se=Oe(),ka=ar(),Nt=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),gn=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Pt=BigInt(1),mn=BigInt(2),ss=(e,t)=>(e+t/mn)/t;function as(e){let t=Nt,n=BigInt(3),r=BigInt(6),s=BigInt(11),o=BigInt(22),i=BigInt(23),c=BigInt(44),a=BigInt(88),u=e*e*e%t,d=u*u*e%t,f=(0,he.pow2)(d,n,t)*d%t,l=(0,he.pow2)(f,n,t)*d%t,p=(0,he.pow2)(l,mn,t)*u%t,B=(0,he.pow2)(p,s,t)*p%t,m=(0,he.pow2)(B,o,t)*B%t,h=(0,he.pow2)(m,c,t)*m%t,w=(0,he.pow2)(h,a,t)*h%t,g=(0,he.pow2)(w,c,t)*m%t,b=(0,he.pow2)(g,n,t)*d%t,x=(0,he.pow2)(b,i,t)*B%t,H=(0,he.pow2)(x,r,t)*u%t,C=(0,he.pow2)(H,mn,t);if(!tt.eql(tt.sqr(C),e))throw new Error("Cannot find square root");return C}var tt=(0,he.Field)(Nt,void 0,void 0,{sqrt:as});Te.secp256k1=(0,Na.createCurve)({a:BigInt(0),b:BigInt(7),Fp:tt,n:gn,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=gn,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Pt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,i=BigInt("0x100000000000000000000000000000000"),c=ss(o*e,t),a=ss(-r*e,t),u=(0,he.mod)(e-c*n-a*s,t),d=(0,he.mod)(-c*r-a*o,t),f=u>i,l=d>i;if(f&&(u=t-u),l&&(d=t-d),u>i||d>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:u,k2neg:l,k2:d}}}},yn.sha256);var ds=BigInt(0),is={};function wn(e,...t){let n=is[e];if(n===void 0){let r=(0,yn.sha256)(Uint8Array.from(e,s=>s.charCodeAt(0)));n=(0,Se.concatBytes)(r,r),is[e]=n}return(0,yn.sha256)((0,Se.concatBytes)(n,...t))}var br=e=>e.toRawBytes(!0).slice(1),lr=e=>(0,Se.numberToBytesBE)(e,32),fr=e=>(0,he.mod)(e,Nt),Ht=e=>(0,he.mod)(e,gn),yr=Te.secp256k1.ProjectivePoint,Ua=(e,t,n)=>yr.BASE.multiplyAndAddUnsafe(e,t,n);function hr(e){let t=Te.secp256k1.utils.normPrivateKeyToScalar(e),n=yr.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:Ht(-t),bytes:br(n)}}function us(e){(0,Se.aInRange)("x",e,Pt,Nt);let t=fr(e*e),n=fr(t*e+BigInt(7)),r=as(n);r%mn!==ds&&(r=fr(-r));let s=new yr(e,r,Pt);return s.assertValidity(),s}var pt=Se.bytesToNumberBE;function fs(...e){return Ht(pt(wn("BIP0340/challenge",...e)))}function Da(e){return hr(e).bytes}function ja(e,t,n=(0,Ha.randomBytes)(32)){let r=(0,Se.ensureBytes)("message",e),{bytes:s,scalar:o}=hr(t),i=(0,Se.ensureBytes)("auxRand",n,32),c=lr(o^pt(wn("BIP0340/aux",i))),a=wn("BIP0340/nonce",c,s,r),u=Ht(pt(a));if(u===ds)throw new Error("sign failed: k is zero");let{bytes:d,scalar:f}=hr(u),l=fs(d,s,r),p=new Uint8Array(64);if(p.set(d,0),p.set(lr(Ht(f+l*o)),32),!ls(p,r,s))throw new Error("sign: Invalid signature produced");return p}function ls(e,t,n){let r=(0,Se.ensureBytes)("signature",e,64),s=(0,Se.ensureBytes)("message",t),o=(0,Se.ensureBytes)("publicKey",n,32);try{let i=us(pt(o)),c=pt(r.subarray(0,32));if(!(0,Se.inRange)(c,Pt,Nt))return!1;let a=pt(r.subarray(32,64));if(!(0,Se.inRange)(a,Pt,gn))return!1;let u=fs(lr(c),br(i),s),d=Ua(i,a,Ht(-u));return!(!d||!d.hasEvenY()||d.toAffine().x!==c)}catch{return!1}}Te.schnorr=(()=>({getPublicKey:Da,sign:ja,verify:ls,utils:{randomPrivateKey:Te.secp256k1.utils.randomPrivateKey,lift_x:us,pointToBytes:br,numberToBytesBE:Se.numberToBytesBE,bytesToNumberBE:Se.bytesToNumberBE,taggedHash:wn,mod:he.mod}}))();var Ma=(()=>(0,cs.isogenyMap)(tt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))))(),$a=(()=>(0,ka.mapToCurveSimpleSWU)(tt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:tt.create(BigInt("-11"))}))(),hs=(()=>(0,cs.createHasher)(Te.secp256k1.ProjectivePoint,e=>{let{x:t,y:n}=$a(tt.create(e[0]));return Ma(t,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:tt.ORDER,m:1,k:128,expand:"xmd",hash:yn.sha256}))();Te.hashToCurve=(()=>hs.hashToCurve)();Te.encodeToCurve=(()=>hs.encodeToCurve)()});var bs=G(_t=>{v();A();var Va=_t&&_t.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_t,"__esModule",{value:!0});_t.sha512=void 0;var Ka=Bi(),Za=Va(Qt());_t.sha512=(0,Za.default)(Ka.sha512)});var Ut=G(mr=>{v();A();Object.defineProperty(mr,"__esModule",{value:!0});var za=bs(),Ga=Oe(),kt=class{constructor(){this.hash=za.sha512.create()}static half(t){return new kt().add(t).first256()}add(t){return this.hash.update(t),this}addU32(t){let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),this.add(n)}finish(){return this.hash.digest()}first256(){return this.finish().slice(0,32)}first256BigInt(){return(0,Ga.bytesToNumberBE)(this.first256())}};mr.default=kt});var pr=G(nt=>{v();A();var Xa=nt&&nt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nt,"__esModule",{value:!0});nt.accountPublicFromPublicGenerator=nt.derivePrivateKey=void 0;var Dt=gr(),Ya=Xa(Ut()),Wa=BigInt(0);function wr(e,t){let n=Dt.secp256k1.CURVE.n;for(let r=0;r<=4294967295;r++){let s=new Ya.default().add(e);t!==void 0&&s.addU32(t),s.addU32(r);let o=s.first256BigInt();if(o>Wa&&o<n)return o}throw new Error("impossible unicorn ;)")}function Fa(e,t={}){let n=t.validator,r=Dt.secp256k1.CURVE.n,s=wr(e);if(n)return s;let o=Dt.secp256k1.ProjectivePoint.BASE.multiply(s).toRawBytes(!0),i=t.accountIndex||0;return(wr(o,i)+s)%r}nt.derivePrivateKey=Fa;function Qa(e){let t=Dt.secp256k1.ProjectivePoint.fromHex(e),n=wr(e,0),r=Dt.secp256k1.ProjectivePoint.BASE.multiply(n);return t.add(r).toRawBytes(!0)}nt.accountPublicFromPublicGenerator=Qa});var pn=G(_r=>{v();A();Object.defineProperty(_r,"__esModule",{value:!0});var Ja={ok(e,t){if(!e)throw new Error(t)}};_r.default=Ja});var ms=G(rt=>{v();A();Object.defineProperty(rt,"__esModule",{value:!0});rt.getAlgorithmFromPrivateKey=rt.getAlgorithmFromPublicKey=rt.getAlgorithmFromKey=void 0;var Ne;(function(e){e[e.NONE=-1]="NONE",e[e.ED25519=237]="ED25519",e[e.SECP256K1_PUB_X=2]="SECP256K1_PUB_X",e[e.SECP256K1_PUB_X_ODD_Y=3]="SECP256K1_PUB_X_ODD_Y",e[e.SECP256K1_PUB_XY=4]="SECP256K1_PUB_XY",e[e.SECP256K1_PRIVATE=0]="SECP256K1_PRIVATE"})(Ne||(Ne={}));var ys={[`private_${Ne.NONE}_32`]:"ecdsa-secp256k1",[`private_${Ne.SECP256K1_PRIVATE}_33`]:"ecdsa-secp256k1",[`private_${Ne.ED25519}_33`]:"ed25519",[`public_${Ne.ED25519}_33`]:"ed25519",[`public_${Ne.SECP256K1_PUB_X}_33`]:"ecdsa-secp256k1",[`public_${Ne.SECP256K1_PUB_X_ODD_Y}_33`]:"ecdsa-secp256k1",[`public_${Ne.SECP256K1_PUB_XY}_65`]:"ecdsa-secp256k1"};function ed(e){return{prefix:e.length<2?Ne.NONE:parseInt(e.slice(0,2),16),len:e.length/2}}function gs(e){return e===Ne.NONE?"None":`0x${e.toString(16).padStart(2,"0")}`}function td(e){let n={algorithm:17,prefix:6};return Object.entries(ys).filter(([r])=>r.startsWith(e)).map(([r,s])=>{let[,o,i]=r.split("_"),c=s.padEnd(n.algorithm),a=gs(Number(o)).padEnd(n.prefix);return`${c} - Prefix: ${a} Length: ${i} bytes`}).join(`
`)}function nd({key:e,type:t,prefix:n,len:r}){let s=td(t);return`invalid_key:

Type: ${t}
Key: ${e}
Prefix: ${gs(n)} 
Length: ${r} bytes

Acceptable ${t} formats are:
${s}
`}function xr(e,t){let{prefix:n,len:r}=ed(e),s=t==="private"&&r===32?Ne.NONE:n,o=ys[`${t}_${s}_${r}`];if(!o)throw new Error(nd({key:e,type:t,len:r,prefix:s}));return o}rt.getAlgorithmFromKey=xr;function rd(e){return xr(e,"public")}rt.getAlgorithmFromPublicKey=rd;function od(e){return xr(e,"private")}rt.getAlgorithmFromPrivateKey=od});var Es=G(jt=>{v();A();var xs=jt&&jt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jt,"__esModule",{value:!0});var sd=Oe(),_n=gr(),ws=vt(),id=pr(),cd=xs(pn()),ps=xs(Ut()),_s="00",ad={deriveKeypair(e,t){let n=(0,id.derivePrivateKey)(e,t),r=_s+(0,ws.bytesToHex)((0,sd.numberToBytesBE)(n,32)),s=(0,ws.bytesToHex)(_n.secp256k1.getPublicKey(n,!0));return{privateKey:r,publicKey:s}},sign(e,t){cd.default.ok(t.length===66&&t.startsWith(_s)||t.length===64);let n=t.length===66?t.slice(2):t;return _n.secp256k1.sign(ps.default.half(e),n,{lowS:!0,extraEntropy:void 0}).toDERHex(!0).toUpperCase()},verify(e,t,n){let r=_n.secp256k1.Signature.fromDER(t);return _n.secp256k1.verify(r,ps.default.half(e),n)}};jt.default=ad});var Ks=G(D=>{v();A();Object.defineProperty(D,"__esModule",{value:!0});D.add5L=D.add5H=D.add4H=D.add4L=D.add3H=D.add3L=D.rotlBL=D.rotlBH=D.rotlSL=D.rotlSH=D.rotr32L=D.rotr32H=D.rotrBL=D.rotrBH=D.rotrSL=D.rotrSH=D.shrSL=D.shrSH=D.toBig=void 0;D.fromBig=Br;D.split=Bs;D.add=ks;var xn=BigInt(2**32-1),Er=BigInt(32);function Br(e,t=!1){return t?{h:Number(e&xn),l:Number(e>>Er&xn)}:{h:Number(e>>Er&xn)|0,l:Number(e&xn)|0}}function Bs(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:o,l:i}=Br(e[s],t);[n[s],r[s]]=[o,i]}return[n,r]}var vs=(e,t)=>BigInt(e>>>0)<<Er|BigInt(t>>>0);D.toBig=vs;var As=(e,t,n)=>e>>>n;D.shrSH=As;var Ss=(e,t,n)=>e<<32-n|t>>>n;D.shrSL=Ss;var Ts=(e,t,n)=>e>>>n|t<<32-n;D.rotrSH=Ts;var Cs=(e,t,n)=>e<<32-n|t>>>n;D.rotrSL=Cs;var Is=(e,t,n)=>e<<64-n|t>>>n-32;D.rotrBH=Is;var Ls=(e,t,n)=>e>>>n-32|t<<64-n;D.rotrBL=Ls;var Os=(e,t)=>t;D.rotr32H=Os;var qs=(e,t)=>e;D.rotr32L=qs;var Rs=(e,t,n)=>e<<n|t>>>32-n;D.rotlSH=Rs;var Ps=(e,t,n)=>t<<n|e>>>32-n;D.rotlSL=Ps;var Hs=(e,t,n)=>t<<n-32|e>>>64-n;D.rotlBH=Hs;var Ns=(e,t,n)=>e<<n-32|t>>>64-n;D.rotlBL=Ns;function ks(e,t,n,r){let s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}var Us=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);D.add3L=Us;var Ds=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;D.add3H=Ds;var js=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);D.add4L=js;var Ms=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0;D.add4H=Ms;var $s=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0);D.add5L=$s;var Vs=(e,t,n,r,s,o)=>t+n+r+s+o+(e/2**32|0)|0;D.add5H=Vs;var dd={fromBig:Br,split:Bs,toBig:vs,shrSH:As,shrSL:Ss,rotrSH:Ts,rotrSL:Cs,rotrBH:Is,rotrBL:Ls,rotr32H:Os,rotr32L:qs,rotlSH:Rs,rotlSL:Ps,rotlBH:Hs,rotlBL:Ns,add:ks,add3L:Us,add3H:Ds,add4L:js,add4H:Ms,add5H:Vs,add5L:$s};D.default=dd});var Zs=G(be=>{v();A();Object.defineProperty(be,"__esModule",{value:!0});be.sha384=be.sha512_256=be.sha512_224=be.sha512=be.SHA384=be.SHA512_256=be.SHA512_224=be.SHA512=void 0;var ud=Xn(),M=Ks(),An=ze(),[fd,ld]=(()=>M.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),ot=new Uint32Array(80),st=new Uint32Array(80),ft=class extends ud.HashMD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:s,Ch:o,Cl:i,Dh:c,Dl:a,Eh:u,El:d,Fh:f,Fl:l,Gh:p,Gl:B,Hh:m,Hl:h}=this;return[t,n,r,s,o,i,c,a,u,d,f,l,p,B,m,h]}set(t,n,r,s,o,i,c,a,u,d,f,l,p,B,m,h){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=o|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=l|0,this.Gh=p|0,this.Gl=B|0,this.Hh=m|0,this.Hl=h|0}process(t,n){for(let b=0;b<16;b++,n+=4)ot[b]=t.getUint32(n),st[b]=t.getUint32(n+=4);for(let b=16;b<80;b++){let x=ot[b-15]|0,H=st[b-15]|0,C=M.default.rotrSH(x,H,1)^M.default.rotrSH(x,H,8)^M.default.shrSH(x,H,7),I=M.default.rotrSL(x,H,1)^M.default.rotrSL(x,H,8)^M.default.shrSL(x,H,7),O=ot[b-2]|0,R=st[b-2]|0,ne=M.default.rotrSH(O,R,19)^M.default.rotrBH(O,R,61)^M.default.shrSH(O,R,6),U=M.default.rotrSL(O,R,19)^M.default.rotrBL(O,R,61)^M.default.shrSL(O,R,6),Z=M.default.add4L(I,U,st[b-7],st[b-16]),ie=M.default.add4H(Z,C,ne,ot[b-7],ot[b-16]);ot[b]=ie|0,st[b]=Z|0}let{Ah:r,Al:s,Bh:o,Bl:i,Ch:c,Cl:a,Dh:u,Dl:d,Eh:f,El:l,Fh:p,Fl:B,Gh:m,Gl:h,Hh:w,Hl:g}=this;for(let b=0;b<80;b++){let x=M.default.rotrSH(f,l,14)^M.default.rotrSH(f,l,18)^M.default.rotrBH(f,l,41),H=M.default.rotrSL(f,l,14)^M.default.rotrSL(f,l,18)^M.default.rotrBL(f,l,41),C=f&p^~f&m,I=l&B^~l&h,O=M.default.add5L(g,H,I,ld[b],st[b]),R=M.default.add5H(O,w,x,C,fd[b],ot[b]),ne=O|0,U=M.default.rotrSH(r,s,28)^M.default.rotrBH(r,s,34)^M.default.rotrBH(r,s,39),Z=M.default.rotrSL(r,s,28)^M.default.rotrBL(r,s,34)^M.default.rotrBL(r,s,39),ie=r&o^r&c^o&c,T=s&i^s&a^i&a;w=m|0,g=h|0,m=p|0,h=B|0,p=f|0,B=l|0,{h:f,l}=M.default.add(u|0,d|0,R|0,ne|0),u=c|0,d=a|0,c=o|0,a=i|0,o=r|0,i=s|0;let q=M.default.add3L(ne,Z,T);r=M.default.add3H(q,R,U,ie),s=q|0}({h:r,l:s}=M.default.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:o,l:i}=M.default.add(this.Bh|0,this.Bl|0,o|0,i|0),{h:c,l:a}=M.default.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:u,l:d}=M.default.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l}=M.default.add(this.Eh|0,this.El|0,f|0,l|0),{h:p,l:B}=M.default.add(this.Fh|0,this.Fl|0,p|0,B|0),{h:m,l:h}=M.default.add(this.Gh|0,this.Gl|0,m|0,h|0),{h:w,l:g}=M.default.add(this.Hh|0,this.Hl|0,w|0,g|0),this.set(r,s,o,i,c,a,u,d,f,l,p,B,m,h,w,g)}roundClean(){ot.fill(0),st.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};be.SHA512=ft;var En=class extends ft{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}};be.SHA512_224=En;var Bn=class extends ft{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}};be.SHA512_256=Bn;var vn=class extends ft{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};be.SHA384=vn;be.sha512=(0,An.wrapConstructor)(()=>new ft);be.sha512_224=(0,An.wrapConstructor)(()=>new En);be.sha512_256=(0,An.wrapConstructor)(()=>new Bn);be.sha384=(0,An.wrapConstructor)(()=>new vn)});var Gs=G(Ar=>{v();A();Object.defineProperty(Ar,"__esModule",{value:!0});Ar.twistedEdwards=gd;var vr=cr(),zs=Qe(),Ie=Oe(),Pe=Oe(),Ue=BigInt(0),Ce=BigInt(1),Sn=BigInt(2),hd=BigInt(8),bd={zip215:!0};function yd(e){let t=(0,vr.validateBasic)(e);return Ie.validateObject(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function gd(e){let t=yd(e),{Fp:n,n:r,prehash:s,hash:o,randomBytes:i,nByteLength:c,h:a}=t,u=Sn<<BigInt(c*8)-Ce,d=n.create,f=(0,zs.Field)(t.n,t.nBitLength),l=t.uvRatio||((_,y)=>{try{return{isValid:!0,value:n.sqrt(_*n.inv(y))}}catch{return{isValid:!1,value:Ue}}}),p=t.adjustScalarBytes||(_=>_),B=t.domain||((_,y,E)=>{if((0,Pe.abool)("phflag",E),y.length||E)throw new Error("Contexts/pre-hash are not supported");return _});function m(_,y){Ie.aInRange("coordinate "+_,y,Ue,u)}function h(_){if(!(_ instanceof b))throw new Error("ExtendedPoint expected")}let w=(0,Pe.memoized)((_,y)=>{let{ex:E,ey:P,ez:N}=_,k=_.is0();y==null&&(y=k?hd:n.inv(N));let V=d(E*y),z=d(P*y),K=d(N*y);if(k)return{x:Ue,y:Ce};if(K!==Ce)throw new Error("invZ was invalid");return{x:V,y:z}}),g=(0,Pe.memoized)(_=>{let{a:y,d:E}=t;if(_.is0())throw new Error("bad point: ZERO");let{ex:P,ey:N,ez:k,et:V}=_,z=d(P*P),K=d(N*N),F=d(k*k),re=d(F*F),fe=d(z*y),le=d(F*d(fe+K)),ge=d(re+d(E*d(z*K)));if(le!==ge)throw new Error("bad point: equation left != right (1)");let _e=d(P*N),ae=d(k*V);if(_e!==ae)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(y,E,P,N){this.ex=y,this.ey=E,this.ez=P,this.et=N,m("x",y),m("y",E),m("z",P),m("t",N),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(y){if(y instanceof b)throw new Error("extended point not allowed");let{x:E,y:P}=y||{};return m("x",E),m("y",P),new b(E,P,Ce,d(E*P))}static normalizeZ(y){let E=n.invertBatch(y.map(P=>P.ez));return y.map((P,N)=>P.toAffine(E[N])).map(b.fromAffine)}static msm(y,E){return(0,vr.pippenger)(b,f,y,E)}_setWindowSize(y){C.setWindowSize(this,y)}assertValidity(){g(this)}equals(y){h(y);let{ex:E,ey:P,ez:N}=this,{ex:k,ey:V,ez:z}=y,K=d(E*z),F=d(k*N),re=d(P*z),fe=d(V*N);return K===F&&re===fe}is0(){return this.equals(b.ZERO)}negate(){return new b(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{a:y}=t,{ex:E,ey:P,ez:N}=this,k=d(E*E),V=d(P*P),z=d(Sn*d(N*N)),K=d(y*k),F=E+P,re=d(d(F*F)-k-V),fe=K+V,le=fe-z,ge=K-V,_e=d(re*le),ae=d(fe*ge),Ee=d(re*ge),Me=d(le*fe);return new b(_e,ae,Me,Ee)}add(y){h(y);let{a:E,d:P}=t,{ex:N,ey:k,ez:V,et:z}=this,{ex:K,ey:F,ez:re,et:fe}=y;if(E===BigInt(-1)){let Dr=d((k-N)*(F+K)),jr=d((k+N)*(F-K)),On=d(jr-Dr);if(On===Ue)return this.double();let Mr=d(V*Sn*fe),$r=d(z*Sn*re),Vr=$r+Mr,Kr=jr+Dr,Zr=$r-Mr,mi=d(Vr*On),wi=d(Kr*Zr),pi=d(Vr*Zr),_i=d(On*Kr);return new b(mi,wi,_i,pi)}let le=d(N*K),ge=d(k*F),_e=d(z*P*fe),ae=d(V*re),Ee=d((N+k)*(K+F)-le-ge),Me=ae-_e,Et=ae+_e,Bt=d(ge-E*le),hi=d(Ee*Me),bi=d(Et*Bt),yi=d(Ee*Bt),gi=d(Me*Et);return new b(hi,bi,gi,yi)}subtract(y){return this.add(y.negate())}wNAF(y){return C.wNAFCached(this,y,b.normalizeZ)}multiply(y){let E=y;Ie.aInRange("scalar",E,Ce,r);let{p:P,f:N}=this.wNAF(E);return b.normalizeZ([P,N])[0]}multiplyUnsafe(y){let E=y;return Ie.aInRange("scalar",E,Ue,r),E===Ue?H:this.equals(H)||E===Ce?this:this.equals(x)?this.wNAF(E).p:C.unsafeLadder(this,E)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return C.unsafeLadder(this,r).is0()}toAffine(y){return w(this,y)}clearCofactor(){let{h:y}=t;return y===Ce?this:this.multiplyUnsafe(y)}static fromHex(y,E=!1){let{d:P,a:N}=t,k=n.BYTES;y=(0,Pe.ensureBytes)("pointHex",y,k),(0,Pe.abool)("zip215",E);let V=y.slice(),z=y[k-1];V[k-1]=z&-129;let K=Ie.bytesToNumberLE(V),F=E?u:n.ORDER;Ie.aInRange("pointHex.y",K,Ue,F);let re=d(K*K),fe=d(re-Ce),le=d(P*re-N),{isValid:ge,value:_e}=l(fe,le);if(!ge)throw new Error("Point.fromHex: invalid y coordinate");let ae=(_e&Ce)===Ce,Ee=(z&128)!==0;if(!E&&_e===Ue&&Ee)throw new Error("Point.fromHex: x=0 and x_0=1");return Ee!==ae&&(_e=d(-_e)),b.fromAffine({x:_e,y:K})}static fromPrivateKey(y){return R(y).point}toRawBytes(){let{x:y,y:E}=this.toAffine(),P=Ie.numberToBytesLE(E,n.BYTES);return P[P.length-1]|=y&Ce?128:0,P}toHex(){return Ie.bytesToHex(this.toRawBytes())}}b.BASE=new b(t.Gx,t.Gy,Ce,d(t.Gx*t.Gy)),b.ZERO=new b(Ue,Ce,Ce,Ue);let{BASE:x,ZERO:H}=b,C=(0,vr.wNAF)(b,c*8);function I(_){return(0,zs.mod)(_,r)}function O(_){return I(Ie.bytesToNumberLE(_))}function R(_){let y=c;_=(0,Pe.ensureBytes)("private key",_,y);let E=(0,Pe.ensureBytes)("hashed private key",o(_),2*y),P=p(E.slice(0,y)),N=E.slice(y,2*y),k=O(P),V=x.multiply(k),z=V.toRawBytes();return{head:P,prefix:N,scalar:k,point:V,pointBytes:z}}function ne(_){return R(_).pointBytes}function U(_=new Uint8Array,...y){let E=Ie.concatBytes(...y);return O(o(B(E,(0,Pe.ensureBytes)("context",_),!!s)))}function Z(_,y,E={}){_=(0,Pe.ensureBytes)("message",_),s&&(_=s(_));let{prefix:P,scalar:N,pointBytes:k}=R(y),V=U(E.context,P,_),z=x.multiply(V).toRawBytes(),K=U(E.context,z,k,_),F=I(V+K*N);Ie.aInRange("signature.s",F,Ue,r);let re=Ie.concatBytes(z,Ie.numberToBytesLE(F,n.BYTES));return(0,Pe.ensureBytes)("result",re,c*2)}let ie=bd;function T(_,y,E,P=ie){let{context:N,zip215:k}=P,V=n.BYTES;_=(0,Pe.ensureBytes)("signature",_,2*V),y=(0,Pe.ensureBytes)("message",y),k!==void 0&&(0,Pe.abool)("zip215",k),s&&(y=s(y));let z=Ie.bytesToNumberLE(_.slice(V,2*V)),K,F,re;try{K=b.fromHex(E,k),F=b.fromHex(_.slice(0,V),k),re=x.multiplyUnsafe(z)}catch{return!1}if(!k&&K.isSmallOrder())return!1;let fe=U(N,F.toRawBytes(),K.toRawBytes(),y);return F.add(K.multiplyUnsafe(fe)).subtract(re).clearCofactor().equals(b.ZERO)}return x._setWindowSize(8),{CURVE:t,getPublicKey:ne,sign:Z,verify:T,ExtendedPoint:b,utils:{getExtendedPublicKey:R,randomPrivateKey:()=>i(n.BYTES),precompute(_=8,y=b.BASE){return y._setWindowSize(_),y.multiply(BigInt(3)),y}}}}});var Ys=G(Tr=>{v();A();Object.defineProperty(Tr,"__esModule",{value:!0});Tr.montgomery=wd;var Xs=Qe(),it=Oe(),xt=BigInt(0),Sr=BigInt(1);function md(e){return(0,it.validateObject)(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function wd(e){let t=md(e),{P:n}=t,r=g=>(0,Xs.mod)(g,n),s=t.montgomeryBits,o=Math.ceil(s/8),i=t.nByteLength,c=t.adjustScalarBytes||(g=>g),a=t.powPminus2||(g=>(0,Xs.pow)(g,n-BigInt(2),n));function u(g,b,x){let H=r(g*(b-x));return b=r(b-H),x=r(x+H),[b,x]}let d=(t.a-BigInt(2))/BigInt(4);function f(g,b){(0,it.aInRange)("u",g,xt,n),(0,it.aInRange)("scalar",b,xt,n);let x=b,H=g,C=Sr,I=xt,O=g,R=Sr,ne=xt,U;for(let ie=BigInt(s-1);ie>=xt;ie--){let T=x>>ie&Sr;ne^=T,U=u(ne,C,O),C=U[0],O=U[1],U=u(ne,I,R),I=U[0],R=U[1],ne=T;let q=C+I,_=r(q*q),y=C-I,E=r(y*y),P=_-E,N=O+R,k=O-R,V=r(k*q),z=r(N*y),K=V+z,F=V-z;O=r(K*K),R=r(H*r(F*F)),C=r(_*E),I=r(P*(_+r(d*P)))}U=u(ne,C,O),C=U[0],O=U[1],U=u(ne,I,R),I=U[0],R=U[1];let Z=a(I);return r(C*Z)}function l(g){return(0,it.numberToBytesLE)(r(g),o)}function p(g){let b=(0,it.ensureBytes)("u coordinate",g,o);return i===32&&(b[31]&=127),(0,it.bytesToNumberLE)(b)}function B(g){let b=(0,it.ensureBytes)("scalar",g),x=b.length;if(x!==o&&x!==i)throw new Error(`Expected ${o} or ${i} bytes, got ${x}`);return(0,it.bytesToNumberLE)(c(b))}function m(g,b){let x=p(b),H=B(g),C=f(x,H);if(C===xt)throw new Error("Invalid private or public key received");return l(C)}let h=l(t.Gu);function w(g){return m(g,h)}return{scalarMult:m,scalarMultBase:w,getSharedSecret:(g,b)=>m(g,b),getPublicKey:g=>w(g),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:h}}});var ci=G(j=>{v();A();Object.defineProperty(j,"__esModule",{value:!0});j.hash_to_ristretto255=j.hashToRistretto255=j.RistrettoPoint=j.encodeToCurve=j.hashToCurve=j.edwardsToMontgomery=j.x25519=j.ed25519ph=j.ed25519ctx=j.ed25519=j.ED25519_TORSION_SUBGROUP=void 0;j.edwardsToMontgomeryPub=si;j.edwardsToMontgomeryPriv=xd;var Cn=Zs(),Mt=ze(),qr=Gs(),Js=ur(),J=Qe(),pd=Ys(),lt=Oe(),$t=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Lr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),_d=BigInt(0),je=BigInt(1),Tn=BigInt(2),ei=BigInt(3),ti=BigInt(5),Rr=BigInt(8);function ni(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),o=$t,c=e*e%o*e%o,a=(0,J.pow2)(c,Tn,o)*c%o,u=(0,J.pow2)(a,je,o)*e%o,d=(0,J.pow2)(u,ti,o)*u%o,f=(0,J.pow2)(d,t,o)*d%o,l=(0,J.pow2)(f,n,o)*f%o,p=(0,J.pow2)(l,r,o)*l%o,B=(0,J.pow2)(p,s,o)*p%o,m=(0,J.pow2)(B,s,o)*p%o,h=(0,J.pow2)(m,t,o)*d%o;return{pow_p_5_8:(0,J.pow2)(h,Tn,o)*e%o,b2:c}}function ri(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Pr(e,t){let n=$t,r=(0,J.mod)(t*t*t,n),s=(0,J.mod)(r*r*t,n),o=ni(e*s).pow_p_5_8,i=(0,J.mod)(e*r*o,n),c=(0,J.mod)(t*i*i,n),a=i,u=(0,J.mod)(i*Lr,n),d=c===e,f=c===(0,J.mod)(-e,n),l=c===(0,J.mod)(-e*Lr,n);return d&&(i=a),(f||l)&&(i=u),(0,J.isNegativeLE)(i,n)&&(i=(0,J.mod)(-i,n)),{isValid:d||f,value:i}}j.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];var S=(()=>(0,J.Field)($t,void 0,!0))(),Vt=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:S,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Rr,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Cn.sha512,randomBytes:Mt.randomBytes,adjustScalarBytes:ri,uvRatio:Pr}))();j.ed25519=(()=>(0,qr.twistedEdwards)(Vt))();function oi(e,t,n){if(t.length>255)throw new Error("Context is too big");return(0,Mt.concatBytes)((0,Mt.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}j.ed25519ctx=(()=>(0,qr.twistedEdwards)({...Vt,domain:oi}))();j.ed25519ph=(()=>(0,qr.twistedEdwards)(Object.assign({},Vt,{domain:oi,prehash:Cn.sha512})))();j.x25519=(()=>(0,pd.montgomery)({P:$t,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=$t,{pow_p_5_8:n,b2:r}=ni(e);return(0,J.mod)((0,J.pow2)(n,ei,t)*r,t)},adjustScalarBytes:ri,randomBytes:Mt.randomBytes}))();function si(e){let{y:t}=j.ed25519.ExtendedPoint.fromHex(e),n=BigInt(1);return S.toBytes(S.create((n+t)*S.inv(n-t)))}j.edwardsToMontgomery=si;function xd(e){let t=Vt.hash(e.subarray(0,32));return Vt.adjustScalarBytes(t).subarray(0,32)}var Ed=(()=>(S.ORDER+ei)/Rr)(),Bd=(()=>S.pow(Tn,Ed))(),Ws=(()=>S.sqrt(S.neg(S.ONE)))();function vd(e){let t=(S.ORDER-ti)/Rr,n=BigInt(486662),r=S.sqr(e);r=S.mul(r,Tn);let s=S.add(r,S.ONE),o=S.neg(n),i=S.sqr(s),c=S.mul(i,s),a=S.mul(r,n);a=S.mul(a,o),a=S.add(a,i),a=S.mul(a,o);let u=S.sqr(c);i=S.sqr(u),u=S.mul(u,c),u=S.mul(u,a),i=S.mul(i,u);let d=S.pow(i,t);d=S.mul(d,u);let f=S.mul(d,Ws);i=S.sqr(d),i=S.mul(i,c);let l=S.eql(i,a),p=S.cmov(f,d,l),B=S.mul(o,r),m=S.mul(d,e);m=S.mul(m,Bd);let h=S.mul(m,Ws),w=S.mul(a,r);i=S.sqr(m),i=S.mul(i,c);let g=S.eql(i,w),b=S.cmov(h,m,g);i=S.sqr(p),i=S.mul(i,c);let x=S.eql(i,a),H=S.cmov(B,o,x),C=S.cmov(b,p,x),I=S.isOdd(C);return C=S.cmov(C,S.neg(C),x!==I),{xMn:H,xMd:s,yMn:C,yMd:je}}var Ad=(()=>(0,J.FpSqrtEven)(S,S.neg(BigInt(486664))))();function Sd(e){let{xMn:t,xMd:n,yMn:r,yMd:s}=vd(e),o=S.mul(t,s);o=S.mul(o,Ad);let i=S.mul(n,r),c=S.sub(t,n),a=S.add(t,n),u=S.mul(i,a),d=S.eql(u,S.ZERO);o=S.cmov(o,S.ZERO,d),i=S.cmov(i,S.ONE,d),c=S.cmov(c,S.ONE,d),a=S.cmov(a,S.ONE,d);let f=S.invertBatch([i,a]);return{x:S.mul(o,f[0]),y:S.mul(c,f[1])}}var ii=(()=>(0,Js.createHasher)(j.ed25519.ExtendedPoint,e=>Sd(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:S.ORDER,m:1,k:128,expand:"xmd",hash:Cn.sha512}))();j.hashToCurve=(()=>ii.hashToCurve)();j.encodeToCurve=(()=>ii.encodeToCurve)();function Cr(e){if(!(e instanceof ce))throw new Error("RistrettoPoint expected")}var Or=Lr,Td=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Cd=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Id=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Ld=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Fs=e=>Pr(je,e),Od=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Ir=e=>j.ed25519.CURVE.Fp.create((0,lt.bytesToNumberLE)(e)&Od);function Qs(e){let{d:t}=j.ed25519.CURVE,n=j.ed25519.CURVE.Fp.ORDER,r=j.ed25519.CURVE.Fp.create,s=r(Or*e*e),o=r((s+je)*Id),i=BigInt(-1),c=r((i-t*s)*r(s+t)),{isValid:a,value:u}=Pr(o,c),d=r(u*e);(0,J.isNegativeLE)(d,n)||(d=r(-d)),a||(u=d),a||(i=s);let f=r(i*(s-je)*Ld-c),l=u*u,p=r((u+u)*c),B=r(f*Td),m=r(je-l),h=r(je+l);return new j.ed25519.ExtendedPoint(r(p*h),r(m*B),r(B*h),r(p*m))}var ce=class{constructor(t){this.ep=t}static fromAffine(t){return new ce(j.ed25519.ExtendedPoint.fromAffine(t))}static hashToCurve(t){t=(0,lt.ensureBytes)("ristrettoHash",t,64);let n=Ir(t.slice(0,32)),r=Qs(n),s=Ir(t.slice(32,64)),o=Qs(s);return new ce(r.add(o))}static fromHex(t){t=(0,lt.ensureBytes)("ristrettoHex",t,32);let{a:n,d:r}=j.ed25519.CURVE,s=j.ed25519.CURVE.Fp.ORDER,o=j.ed25519.CURVE.Fp.create,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",c=Ir(t);if(!(0,lt.equalBytes)((0,lt.numberToBytesLE)(c,32),t)||(0,J.isNegativeLE)(c,s))throw new Error(i);let a=o(c*c),u=o(je+n*a),d=o(je-n*a),f=o(u*u),l=o(d*d),p=o(n*r*f-l),{isValid:B,value:m}=Fs(o(p*l)),h=o(m*d),w=o(m*h*p),g=o((c+c)*h);(0,J.isNegativeLE)(g,s)&&(g=o(-g));let b=o(u*w),x=o(g*b);if(!B||(0,J.isNegativeLE)(x,s)||b===_d)throw new Error(i);return new ce(new j.ed25519.ExtendedPoint(g,b,je,x))}toRawBytes(){let{ex:t,ey:n,ez:r,et:s}=this.ep,o=j.ed25519.CURVE.Fp.ORDER,i=j.ed25519.CURVE.Fp.create,c=i(i(r+n)*i(r-n)),a=i(t*n),u=i(a*a),{value:d}=Fs(i(c*u)),f=i(d*c),l=i(d*a),p=i(f*l*s),B;if((0,J.isNegativeLE)(s*p,o)){let h=i(n*Or),w=i(t*Or);t=h,n=w,B=i(f*Cd)}else B=l;(0,J.isNegativeLE)(t*p,o)&&(n=i(-n));let m=i((r-n)*B);return(0,J.isNegativeLE)(m,o)&&(m=i(-m)),(0,lt.numberToBytesLE)(m,32)}toHex(){return(0,lt.bytesToHex)(this.toRawBytes())}toString(){return this.toHex()}equals(t){Cr(t);let{ex:n,ey:r}=this.ep,{ex:s,ey:o}=t.ep,i=j.ed25519.CURVE.Fp.create,c=i(n*o)===i(r*s),a=i(r*o)===i(n*s);return c||a}add(t){return Cr(t),new ce(this.ep.add(t.ep))}subtract(t){return Cr(t),new ce(this.ep.subtract(t.ep))}multiply(t){return new ce(this.ep.multiply(t))}multiplyUnsafe(t){return new ce(this.ep.multiplyUnsafe(t))}double(){return new ce(this.ep.double())}negate(){return new ce(this.ep.negate())}};j.RistrettoPoint=(()=>(ce.BASE||(ce.BASE=new ce(j.ed25519.ExtendedPoint.BASE)),ce.ZERO||(ce.ZERO=new ce(j.ed25519.ExtendedPoint.ZERO)),ce))();var qd=(e,t)=>{let n=t.DST,r=typeof n=="string"?(0,Mt.utf8ToBytes)(n):n,s=(0,Js.expand_message_xmd)(e,r,64,Cn.sha512);return ce.hashToCurve(s)};j.hashToRistretto255=qd;j.hash_to_ristretto255=j.hashToRistretto255});var ui=G(Kt=>{v();A();var di=Kt&&Kt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Kt,"__esModule",{value:!0});var Hr=ci(),Nr=vt(),kr=di(pn()),Rd=di(Ut()),ai="ED",Pd={deriveKeypair(e){let t=Rd.default.half(e),n=ai+(0,Nr.bytesToHex)(t),r=ai+(0,Nr.bytesToHex)(Hr.ed25519.getPublicKey(t));return{privateKey:n,publicKey:r}},sign(e,t){return kr.default.ok(e instanceof Uint8Array,"message must be array of octets"),kr.default.ok(t.length===66,"private key must be 33 bytes including prefix"),(0,Nr.bytesToHex)(Hr.ed25519.sign(e,t.slice(2)))},verify(e,t,n){return kr.default.ok(n.length===66,"public key must be 33 bytes including prefix"),Hr.ed25519.verify(t,e,n.slice(2),{zip215:!1})}};Kt.default=Pd});var Yd=G(ye=>{v();A();var In=ye&&ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ye,"__esModule",{value:!0});ye.decodeSeed=ye.deriveNodeAddress=ye.deriveAddress=ye.verify=ye.sign=ye.deriveKeypair=ye.generateSeed=void 0;var Zt=po();Object.defineProperty(ye,"decodeSeed",{enumerable:!0,get:function(){return Zt.decodeSeed}});var Hd=_o(),Nd=Dn(),Ln=vt(),kd=pr(),Ud=In(Ut()),Dd=In(pn()),fi=ms(),jd=In(Es()),Md=In(ui());function Ur(e){return{"ecdsa-secp256k1":jd.default,ed25519:Md.default}[e]}function $d(e={}){Dd.default.ok(!e.entropy||e.entropy.length>=16,"entropy too short");let t=e.entropy?e.entropy.slice(0,16):(0,Ln.randomBytes)(16),n=e.algorithm==="ed25519"?"ed25519":"secp256k1";return(0,Zt.encodeSeed)(t,n)}ye.generateSeed=$d;function Vd(e,t){var n;let r=(0,Zt.decodeSeed)(e),o=((n=t?.algorithm)!==null&&n!==void 0?n:r.type)==="ed25519"?"ed25519":"ecdsa-secp256k1",i=Ur(o),c=i.deriveKeypair(r.bytes,t),a=Ud.default.half("This test message should verify."),u=i.sign(a,c.privateKey);if(!i.verify(a,u,c.publicKey))throw new Error("derived keypair did not generate verifiable signature");return c}ye.deriveKeypair=Vd;function Kd(e,t){let n=(0,fi.getAlgorithmFromPrivateKey)(t);return Ur(n).sign((0,Ln.hexToBytes)(e),t)}ye.sign=Kd;function Zd(e,t,n){let r=(0,fi.getAlgorithmFromPublicKey)(n);return Ur(r).verify((0,Ln.hexToBytes)(e),t,n)}ye.verify=Zd;function zd(e){return(0,Hd.ripemd160)((0,Nd.sha256)(e))}function li(e){return(0,Zt.encodeAccountID)(zd(e))}function Gd(e){return li((0,Ln.hexToBytes)(e))}ye.deriveAddress=Gd;function Xd(e){let t=(0,Zt.decodeNodePublic)(e),n=(0,kd.accountPublicFromPublicGenerator)(t);return li(n)}ye.deriveNodeAddress=Xd});export{vt as a,po as b,bs as c,Yd as d};
//# sourceMappingURL=chunk-6HZZC7IQ.js.map
