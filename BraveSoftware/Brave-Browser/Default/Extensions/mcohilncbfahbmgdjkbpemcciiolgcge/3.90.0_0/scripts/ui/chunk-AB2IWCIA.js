import{l as ao}from"./chunk-RS5XCICJ.js";import{a as R}from"./chunk-MNWYUYGW.js";import{a as X}from"./chunk-KDZWFWCG.js";import{a as so}from"./chunk-PEKFKA6I.js";import{a as V}from"./chunk-2KBIS3G2.js";import{a as D}from"./chunk-RCXPUQYC.js";import{a as ft}from"./chunk-XI5NMQGM.js";import{a as ut}from"./chunk-X2JMOXWP.js";import{a as N}from"./chunk-X7JU5VY4.js";import{a as ot}from"./chunk-M2YFVDKX.js";import{f as dt,g as ro,h as no,i as io}from"./chunk-AOZHPYH5.js";import{a as M}from"./chunk-5EFGCLI4.js";import{a as S}from"./chunk-B4MQLH4C.js";import{j as pt,k as lt}from"./chunk-EUAAIPZO.js";import{a as $t}from"./chunk-ZFAUEPQW.js";import{a as eo}from"./chunk-GMVPA3MX.js";import{a as to,d as oo}from"./chunk-C4TBDTQO.js";import{c as Qt,e as tt}from"./chunk-ZUO5BDO3.js";import{a as L}from"./chunk-A7EUFORV.js";import{a as T}from"./chunk-QEPQGEPL.js";import{l as f}from"./chunk-V7YATDMZ.js";import{d as jt,i as Kt}from"./chunk-XHRUTTJG.js";import{d as Q}from"./chunk-AVG63QW4.js";import{d as Zt}from"./chunk-YLT6ZRGE.js";import{c as Lt}from"./chunk-OBLKTTHP.js";import{b as Vt}from"./chunk-QMHGGMPE.js";import{a as mt}from"./chunk-GVYIP5Q5.js";import{q as Jt}from"./chunk-CKHT4PIF.js";import{a as zt}from"./chunk-WXD7TULU.js";import{c as $}from"./chunk-PMG6IXOR.js";import{d as ct}from"./chunk-7U7FORYL.js";import{b as H}from"./chunk-YVLQLIW6.js";import{h as Ht,j as Xt,n as Rt,o as v}from"./chunk-N6PI3XTA.js";import{a as J,i as Bt,n as Wt}from"./chunk-KC2XLVFC.js";import{B as Nt,F as Mt,qa as Gt,r as st,ra as Y}from"./chunk-MJDO2VHF.js";import{c as Dt}from"./chunk-EAE2NUFS.js";import{a as Ft}from"./chunk-6M37VPK2.js";import{c as vt}from"./chunk-OKGWI7CU.js";import{c as y}from"./chunk-3FMJDUGT.js";import{E as At,Z as it,gb as at,y as G}from"./chunk-EQ34WRCJ.js";import{p as s}from"./chunk-DSNMNSMD.js";import{J as ht,d as Yt}from"./chunk-URGJ6D4O.js";import{a as qt}from"./chunk-IQUFNLVG.js";import{C as W,t as Ot}from"./chunk-XYWWXNVK.js";import{a as Ut}from"./chunk-FB3ILH2L.js";import{b as P}from"./chunk-FLSAETOH.js";import{Aa as bo,f as bt}from"./chunk-4C5HF6J2.js";import{f as k,o as i,q as a}from"./chunk-UWURTNRY.js";i();a();var g=k(P());var Ao=({unapproved:t})=>{let[o,{cancel:e,approve:n}]=ao(t),r=M(o),{rpcNetworks:c}=ct(),m=(0,g.useRef)([]);(0,g.useEffect)(()=>{c?.length&&!m.current?.length&&(m.current=c)},[c?.length]);let p=m.current.find(_=>_.rpcUrl===o.rpcUrl),{loading:l,onClick:u}=T(e),h=(0,g.useMemo)(()=>({actionType:f.ACTION_TYPE.CANCEL,onClick:u,loading:l}),[l,u]),w=J(async()=>{await n(),ht.success({duration:1.5,title:s("developer_mode_home_toast_added"),placement:ht.DIRECTION.top})}),{loading:E,onClick:I}=T(w),b=(0,g.useMemo)(()=>({loading:E,disabled:!!p,actionType:f.ACTION_TYPE.CONFIRM,btnText:s("developer_mode_add_network_btn_approve"),onClick:I}),[p,E,I]),A=[h,b];return g.default.createElement(y.Container,null,g.default.createElement(oo,{type:p?Yt.TYPE.error:to.COMMON_TIP,message:p?s("developer_mode_infor_errortip_used_network",{network:p.name}):s("developer_mode_add_network_errortip_risk_aware")}),g.default.createElement(Qt,{injectInfo:{title:s("developer_mode_add_network_maintitle_add_network"),identify:!0}}),g.default.createElement(Ht.Thin,{compact:!0}),g.default.createElement(N,null,g.default.createElement(V,{...r})),g.default.createElement(N,{bordered:!1},g.default.createElement(tt,{label:s("developer_mode_add_network_title_network_name"),tip:s("wallet_dapp_conncetion_add_network_subtitle_network_name_tips"),value:o.type||o.chainName}),o.switchType===G.ADD_ETHEREUM_CHAIN&&[g.default.createElement(tt,{key:"rpcUrl",label:s("developer_mode_add_network_title_networkurl"),tip:s("wallet_dapp_conncetion_add_network_subtitle_network_url_tips"),value:o.rpcUrl}),g.default.createElement(tt,{key:"chainId",label:s("developer_mode_add_network_title_chainid"),tip:s("wallet_dapp_conncetion_add_network_subtitle_chain_id_tips"),value:o.chainIdToDisplay}),g.default.createElement(tt,{key:"ticker",label:s("developer_mode_add_network_title_currency_symbol"),tip:s("wallet_dapp_conncetion_add_network_subtitle_currency_symbol_tips"),value:o.ticker}),g.default.createElement(tt,{key:"explorers",label:s("developer_mode_add_network_title_block_explorerurl"),tip:s("wallet_dapp_conncetion_add_network_subtitle_explorer_url_tips"),value:o.explorers||o.blockExplorerUrl})]),g.default.createElement(H,{placeholder:!0,offsetBottom:0,borderTop:!0},g.default.createElement(f,{buttonGroup:A})))},ke=Ao;i();a();var Pt=k(P());i();a();var F=k(P());i();a();var B=(t,o)=>{let e=Y(Mt),n=Y(jt),r=Y(Nt),c=Y(l=>Kt(l,t)),m=l=>({...l,address:o});if(n[t]?.includes(r)&&e[r]?.account[at]===o)return m(e[r]||{});if(n[t]?.includes(c)&&e[c]?.account[at]===o)return m(e[c]);let p=n[t]?.find(l=>e[l]?.account[at]===o);return p?m(e[p]):{}};i();a();var Z=k(P());var No=({walletAccount:t,children:o,chainId:e})=>{let[n]=zt(),{walletAsset:r}=Jt(t.walletId),c=S(t.walletId),m=D(e);return $t(m?.coinId,t.walletId),Z.default.createElement(Z.default.Fragment,null,Z.default.createElement(N,null,Z.default.createElement(ut,{title:s("wallet_extension_network_address_title_walletused"),address:t.address,walletId:t.walletId,onCopyCallback:()=>{c({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),Z.default.createElement(N,{bordered:!1},Z.default.createElement(L,{title:s("wallet_dapp_connection_subtitle_balance")},Z.default.createElement(v.DisplayAmount,{ellipsis:!0,size:v.SIZE.sm,mode:v.LEGAL,useApproximate:!1,hidden:n?"***":!1},r)),o))},gt=No;i();a();var x=k(P()),co=k(Ut());i();a();var et={root:"_root_1xv1e_1",msgWrap:"_msgWrap_1xv1e_12",decrypted:"_decrypted_1xv1e_20",copyMsg:"_copyMsg_1xv1e_23",decryptMsg:"_decryptMsg_1xv1e_28"};var Mo=({rawData:t})=>{let o=eo({showDesc:!1});return x.default.createElement(W,{rect:!0,size:W.SIZE.xxs,type:W.TYPE.primary,category:W.CATEGORY.outline,className:et.copyMsg,onClick:()=>{o(t)}},x.default.createElement(Ot,{className:"okx-wallet-plugin-copy"}),x.default.createElement(y.Box,null,s("wallet_extension_encrypted_text_copy")))},Do=({unapproved:t,decryptCb:o,walletAccount:e})=>{let n=no(),r=(0,x.useCallback)(async()=>{let{msgParams:c}=t,m=await n(e?.walletId,c);o(m)},[o,n,t,e?.walletId]);return x.default.createElement(W,{className:et.decryptMsg,size:W.SIZE.sm,type:W.TYPE.primary,category:W.CATEGORY.outline,icon:"okx-wallet-plugin-lock-1",iconType:W.ICON_POSITION.leading,onClick:r},s("wallet_dapp_conncetion_subtitle_decrypt_metamask_information"))},Bo=({unapproved:t={},walletAccount:o})=>{let[e,n]=(0,x.useState)(!1),[r,c]=(0,x.useState)(t.msgParams?.data),[m,p]=(0,x.useState)(!1),l=u=>{u.error?(p(!0),c(s("wallet_dapp_conncetion_errortip_decrypt_error",{errorMessage:u.error}))):c(u.rawData),n(!0)};return x.default.createElement(L,{title:s("wallet_extension_encrypted_text_encrypted_message")},x.default.createElement(y.Box,{className:et.root},x.default.createElement(y.Box,{className:(0,co.default)(et.msgWrap,{[et.decrypted]:e})},r),e?!m&&x.default.createElement(Mo,{rawData:r}):x.default.createElement(Do,{unapproved:t,decryptCb:l,walletAccount:o})))},mo=Bo;i();a();var Wo=(t,o)=>{let{id:e}=t,n=S(o?.walletId),r=D(),c=R(),m=J(async()=>{n({all_confirmation:"cancel",trade:"decrypt_message",dapp_url:t.origin,network:r?.chainName}),await c({id:e})}),{loading:p,onClick:l}=T(m),u={loading:p,actionType:f.ACTION_TYPE.CANCEL,btnText:s("wallet_dapp_connection_btn_reject"),onClick:l},h=io(),w=X(),E=J(async()=>{try{n({all_confirmation:"confirm",trade:"decrypt_message",dapp_url:t.origin,network:r?.chainName});let{msgParams:_}=t,O=await h(o?.walletId,_);await w({id:e,result:O})}catch(_){console.log(_),w({id:e,error:"Failed"})}}),{loading:I,onClick:b}=T(E),A={loading:I,actionType:f.ACTION_TYPE.CONFIRM,onClick:b};return[u,A]},po=Wo;var vo=({unapproved:t})=>{let o=M(t),e=B(t.origin,t.msgParams?.from),n=M(t),r=po(t,e),c=(0,F.useMemo)(()=>({type:ot.TIP_TYPE.NORMAL,message:s("wallet_dapp_conncetion_notify_decrypt_message",{siteName:n.name||n.host})}),[n]);return F.default.createElement(y.Container,null,F.default.createElement(Q,{title:s("wallet_dapp_conncetion_subtitle_decrypt_request"),closeable:!1,backable:!1}),F.default.createElement(N,null,F.default.createElement(V,{...o})),F.default.createElement(gt,{walletAccount:e,chainId:t.chainId},F.default.createElement(mo,{unapproved:t,walletAccount:e})),F.default.createElement(H,{placeholder:!0,offsetBottom:0,borderTop:!0},F.default.createElement(ot,{...c}),F.default.createElement(f,{buttonGroup:r})))},lo=vo;i();a();var U=k(P());i();a();var Fo=(t,o)=>{let{id:e}=t,n=S(o?.walletId),r=D(),c=R(),m=J(async()=>{n({all_confirmation:"cancel",trade:"get_public_key",dapp_url:t?.origin,network:r?.chainName}),await c({id:e})}),{loading:p,onClick:l}=T(m),u={actionType:f.ACTION_TYPE.CANCEL,btnText:s("wallet_dapp_connection_btn_reject"),onClick:l,loading:p},h=ro(),w=X(),E=J(async()=>{try{n({all_confirmation:"confirm",trade:"get_public_key",dapp_url:t?.origin,network:r?.chainName});let _=await h(o?.walletId,t.msgParams);w({id:e,result:_})}catch(_){console.log(_),w({id:e,error:"Failed"})}}),{loading:I,onClick:b}=T(E),A={actionType:f.ACTION_TYPE.CONFIRM,btnText:s("wallet_dapp_conncetion_btn_provide"),onClick:b,loading:I};return[u,A]},uo=Fo;var Go=({unapproved:t})=>{let o=B(t.origin,t.msgParams),e=uo(t,o),n=M(t),r=M(t),c=S(o?.walletId);Bt(()=>{c({all_confirmation:"confirm",trade:"get_public_key",dapp_url:t?.origin})});let m=(0,U.useMemo)(()=>({type:ot.TIP_TYPE.NORMAL,message:s("wallet_dapp_conncetion_notify_public_key_notice",{siteName:r.name||r.host})}),[r]);return U.default.createElement(y.Container,null,U.default.createElement(Q,{title:s("wallet_dapp_conncetion_notify_public_key_request"),closeable:!1,backable:!1}),U.default.createElement(N,null,U.default.createElement(V,{...n})),U.default.createElement(gt,{walletAccount:o,chainId:t.chainId}),U.default.createElement(H,{placeholder:!0,offsetBottom:0,borderTop:!0},U.default.createElement(ot,{...m}),U.default.createElement(f,{buttonGroup:e})))},fo=Go;i();a();var j=k(P());bo();i();a();i();a();var rt=k(P());var Lo=t=>{let[o,e]=(0,rt.useState)(null),[n,r]=(0,rt.useState)(!1),c=mt();return(0,rt.useEffect)(()=>{if(c?.length){let m=c.find(p=>p.realChainIdHex===t);m?(e(m?.chainId),r(!1)):(e(+Ft(t)),r(!0))}},[c,t]),{chainIndex:o,isRpcChain:n}},go=Lo;i();a();var _o=k(P());var Uo=()=>{let t=Vt(At),o=ct();return(0,_o.useMemo)(()=>t?.uniqueId?o.rpcNetworks.find(r=>r.uniqueId===t?.uniqueId)??{}:{},[t,o])},yo=Uo;var Oo=t=>{let o=go(t),{isRpcChain:e}=o,n=yo(),[r={}]=mt({chainId:o?.chainIndex})||[];return{network:e?{chainName:n?.name,imageUrl:n?.icon,...n}:r,chainIndexParams:o,isRpcChain:e}},_t=Oo;i();a();var Yo=t=>{let o=R(),{walletId:e}=B(t.origin,t.msgParams?.from),n=S(e),r=D(t?.chainId);return async()=>{n({all_confirmation:"cancel",trade:"sign",dapp_url:t.origin,network:r?.chainName});let{id:c}=t;await o({id:c})}},qo=t=>{let o=X(),{walletId:e}=B(t.origin,t.msgParams?.from),n=dt({walletId:e}),r=S(e),c=D(t?.chainId);return async()=>{let{id:m,msgParams:p,type:l}=t;try{r({all_confirmation:"confirm",trade:"sign",dapp_url:t.origin,network:c?.chainName});let u=await n({msgParams:p,baseChain:t.localType,type:l});await o({id:m,result:u})}catch(u){o({id:m,error:u?.message||"Failed"})}}},zo=({unapproved:t,preExecInfo:o={}})=>{let e=Yo(t),{loading:n,onClick:r}=T(e),c={actionType:f.ACTION_TYPE.CANCEL,onClick:r,loading:n},m=qo(t),{loading:p,onClick:l}=T(m),u={actionType:f.ACTION_TYPE.CONFIRM,disabled:o?.canConfirm===!1,onClick:l,loading:p};return{buttonGroup:[c,u],handleCancel:e}},Co=zo;var Jo=({unapproved:t={}})=>{let[o,e]=(0,j.useState)({}),n=M(t),{buttonGroup:r,handleCancel:c}=Co({unapproved:t,preExecInfo:o}),{type:m,msgParams:p,chainId:l}=t,{chainId:u}=Y(st),h=l||u,{from:w,isSilentSign:E}=p,I=(0,j.useMemo)(()=>{let q=t.msgParams?.data,z={[G.ETH_SIGN](){return[{value:q}]},[G.PERSONAL_SIGN](){return[{value:Lt(q)}]},[G.ETH_SIGN_TYPED_DATA](){return q}};return bt(z[m])?z[m]():[]},[m,t.msgParams?.data]),b=B(t.origin,w)||{},{network:A,chainIndexParams:_}=_t(h),O=(0,j.useMemo)(()=>({method:m,dappData:JSON.stringify(p),dappInfo:n,from:w,message:I,..._}),[_?.chainIndex]);return j.default.createElement(lt,{needPreExecFn:()=>m!==G.PERSONAL_SIGN,txType:pt.signMessage,handleCancel:c,preExecParams:O,walletAccount:b,buttonGroup:r,localType:it,onUpdatePreExecInfo:e,networkFeeProps:{network:A},slot:{bottom:!!E&&j.default.createElement(ft,{walletAccount:b})}})},ko=Jo;i();a();var K=k(P());i();a();var C=k(P());i();a();var nt=k(P());var Ho=({coinId:t})=>{let o=Zt(t);return nt.default.createElement(L,{title:s("wallet_dapp_conncetion_subtitle_network")},nt.default.createElement(y.Space,{align:y.ALIGN.center,space:4},nt.default.createElement($,{src:o?.image,size:$.SIZE.xs,defaultIcon:vt}),nt.default.createElement(v.Text,{size:v.SIZE.sm},o?.chainName)))},wo=Ho;i();a();var Tt=k(P());var Xo=({unapproved:t,walletAccount:o,preExecInfo:e={}})=>{let n=Gt(),{walletId:r}=o,c=S(r),m=D(t.chainId),p=X(),l=R(),u=dt({walletId:r}),h=(0,Tt.useCallback)(async()=>{let{id:z}=t;c({trade:"sign",all_confirmation:"cancel",network:m?.chainName,dapp_url:t?.origin}),await l({id:z})},[m?.chainName,l,c,n,t]),w=(0,Tt.useCallback)(async()=>{let{msgParams:z,id:Et,localType:So,type:Eo}=t;try{c({trade:"sign",all_confirmation:"confirm",network:m?.chainName,dapp_url:t?.origin});let xt=await u({msgParams:z,baseChain:So,type:Eo});await p({id:Et,result:xt})}catch(xt){p({id:Et,error:xt?.message||"Failed"})}},[t,c,r,n,h,m?.chainName,u,p]),{loading:E,onClick:I}=T(h),b={actionType:f.ACTION_TYPE.CANCEL,onClick:I,loading:E},{loading:A,onClick:_}=T(w),O={actionType:f.ACTION_TYPE.CONFIRM,type:W.TYPE.highlight,disabled:e?.canConfirm===!1,onClick:_,loading:A};return{buttonGroup:[b,O],handleCancel:h}},yt=Xo;i();a();var kt=k(P());i();a();var Ct={root:"_root_szca8_1",icon:"_icon_szca8_5",showValue:"_showValue_szca8_11"};var Ro=({icon:t,amount:o,symbol:e})=>kt.default.createElement(y.Box,{className:Ct.root},kt.default.createElement(qt,{src:t,className:Ct.icon}),kt.default.createElement(v.AdaptiveText,{autoSize:so,ellipsis:{tooltip:!0},className:Ct.showValue},"- ",o," ",e)),Io=Ro;i();a();var It=k(P());var Po=k(Ut());i();a();var wt={root:"_root_1wji9_1",price:"_price_1wji9_4",switchIcon:"_switchIcon_1wji9_11"};var Vo=({fromSymbol:t,toSymbol:o,price:e,reversePrice:n})=>{let[r,{toggle:c}]=Wt(!1),m=r?o:t,p=r?t:o,l=r?n:e;return It.default.createElement(y.FlexBox,{className:wt.root},It.default.createElement(v.Text,{size:v.SIZE.sm,ellipsis:{tooltip:!0},className:wt.price},"1 ",m," = ",l," ",p),It.default.createElement($,{size:$.SIZE.xs,className:(0,Po.default)("okx-wallet-plugin-switch",wt.switchIcon),onClick:c}))},St=Vo;var Zo={CREATE:"10",REVOCATION:"20"},jo=({unapproved:t={}})=>{let o=D(t.chainId),{dexExtraData:e}=JSON.parse(t.msgParams.data),n=M(t),r=B(t.origin,t.msgParams?.from),{buttonGroup:c}=yt({unapproved:t,walletAccount:r}),{expiration:m,order:p,predictPriceFormat:l,reversePredictPrice:u,sellTokenAmountFormat:h,sellTokenImage:w,sellTokenSymbol:E,type:I}=e,b={icon:w,symbol:E,amount:h},{fromSymbol:A,toSymbol:_,priceFormat:O,reversePrice:q}=p,z=S(r.walletId);return C.default.createElement(y.Container,null,C.default.createElement(Q,{title:I===Zo.CREATE?s("swaptrade_limit_title_place_limit_order"):s("swaptrade_limit_title_cancel_limit_order"),closeable:!1,backable:!1}),C.default.createElement(N,null,C.default.createElement(L,{title:s("extension_contract_interaction_maintitle_asset_changes"),tooltip:s("extension_infor_tooltip_asset_changestips")},C.default.createElement(Io,{...b})),C.default.createElement(V,{...n})),C.default.createElement(N,null,C.default.createElement(ut,{title:s("wallet_extension_network_address_title_walletused"),address:r.address,walletId:r.walletId,onCopyCallback:()=>{z({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),C.default.createElement(N,{bordered:!1},C.default.createElement(L,{title:s("swaptrade_limit_text_limit_price")},C.default.createElement(St,{toSymbol:_,price:O,fromSymbol:A,reversePrice:q})),C.default.createElement(L,{title:s("swaptrade_limit_text_est_execution_price"),tooltip:s("swaptrade_limit_tooltip_estimated_price")},C.default.createElement(St,{toSymbol:_,fromSymbol:A,price:l,reversePrice:u})),C.default.createElement(L,{title:s("swaptrade_limit_text_expiry_time")},C.default.createElement(Rt,{size:Xt.sm,dateTime:m,format:"yyyyMMddHHmm"})),C.default.createElement(wo,{coinId:o?.coinId})),C.default.createElement(H,{placeholder:!0,offsetBottom:0,borderTop:!0},C.default.createElement(f,{buttonGroup:c})))},xo=jo;var Ko=({unapproved:t={}})=>{let[o,e]=(0,K.useState)({}),{chainId:n,msgParams:{version:r,data:c,from:m,isSilentSign:p}}=t,{chainId:l}=Y(st),u=n||l,{network:h,chainIndexParams:w}=_t(u),E=M(t),I=B(t.origin,m)||{},{buttonGroup:b,handleCancel:A}=yt({unapproved:t,preExecInfo:o,walletAccount:I}),_=(0,K.useMemo)(()=>({dappInfo:E,dappData:JSON.stringify(t?.msgParams),from:m,method:`eth_signTypedData_${r.toLowerCase()}`,...w}),[w?.chainIndex]);if(r==="V4"){let O={};try{O=JSON.parse(c)}catch(q){console.log(q)}if(O.dexExtraData)return K.default.createElement(xo,{unapproved:t})}return K.default.createElement(lt,{txType:pt.signTypedData,handleCancel:A,preExecParams:_,walletAccount:I,buttonGroup:b,localType:it,onUpdatePreExecInfo:e,networkFeeProps:{network:h},slot:{bottom:!!p&&K.default.createElement(ft,{walletAccount:I})}})},ho=Ko;var $o=t=>{let{msgParams:{version:o},type:e}=t;return e===G.ETH_GET_ENCRYPTION_PUBLIC_KEY?fo:e===G.ETH_DECRYPT?lo:e===G.ETH_SIGN_TYPED_DATA&&["V3","V4"].includes(o)?ho:ko},Qo=(0,Pt.memo)(t=>{let{unapproved:o={}}=t,e=$o(o);return Pt.default.createElement(e,{unapproved:o})}),Wa=Qo;i();a();var To=k(P());var te=()=>(0,To.useCallback)(async(t,o)=>{await Dt().handleErc20Token(t,o)},[]),Ua=te;export{ke as a,Ua as b,yo as c,B as d,Wa as e};
//# sourceMappingURL=chunk-AB2IWCIA.js.map
