import{a as rt}from"./chunk-IUVKL7ZK.js";import{b as _t}from"./chunk-HUZIRVCJ.js";import{a as nt}from"./chunk-O652XWZZ.js";import{a as st}from"./chunk-C7QS3I2S.js";import{a as lt}from"./chunk-UX2JFEX5.js";import{a as at}from"./chunk-JHL2WJA4.js";import{Qa as X}from"./chunk-VHMBEOFX.js";import{c as it}from"./chunk-PMG6IXOR.js";import{a as M}from"./chunk-BD5XO4WL.js";import{g as J}from"./chunk-7DW2ZPOD.js";import{d as et,r as ot}from"./chunk-WYX7GFOD.js";import{ra as Z}from"./chunk-MJDO2VHF.js";import{yb as q}from"./chunk-QF42JCDG.js";import{p,s as m}from"./chunk-DSNMNSMD.js";import{a as yt}from"./chunk-DOSBJ3L3.js";import{A as B,I as G,J as tt,o as Q,p as Y,s as R}from"./chunk-URGJ6D4O.js";import{t as v,w as P}from"./chunk-XYWWXNVK.js";import{a as kt}from"./chunk-FB3ILH2L.js";import{b as O}from"./chunk-FLSAETOH.js";import{l as F,m as St}from"./chunk-4C5HF6J2.js";import{f as y,o as i,q as a}from"./chunk-UWURTNRY.js";i();a();var t=y(O()),k=y(kt());i();a();var _=y(O());var ct=y(yt());St();i();a();var mt=(n,f,d=2)=>{let r=(0,ct.useHistory)(),c=ot(),C=Z(J),[b,E]=(0,_.useState)(!1),[T,I]=(0,_.useState)(""),{saFeatureEnabled:W}=rt(),h=(0,_.useMemo)(()=>{if(!W)return!1;let o=F(n,"walletIdentities.0");return nt(o)},[n,W]);(0,_.useEffect)(()=>{if(!T)return;let o=n.walletIdentities.find(u=>u.walletId===T);if(!o)return;!(o.teeStatus?.isCreated??!1)||!h?G.success({title:p("wallet_extension_account_notification_title_account_added",{account:o.walletName})}):G.success({title:p("wallet_extension_account_notification_title_account_added",{account:o.walletName}),desc:o?.teeStatus?.isActive?p("wallet_extension_account_notification_subtitle_already_sa"):p("wallet_extension_account_notification_subtitle_enable_again"),duration:at}),I("")},[T,n,h]);let x=(0,_.useCallback)(o=>{I(o),f&&f(o)},[f]),A=(0,_.useCallback)(async o=>{E(!0);try{let w=await c(n?.keyringId,{hideToast:!0});return E(!1),o&&o(w),w&&x(w),w}catch(w){let u=w;throw u.message===et&&tt.error({title:p("wallet_extension_error_reminder_system_busy")}),E(!1),u}},[n,c,x]),g=(0,_.useCallback)(async()=>{r.push(`${q}?from=${d}&keyringId=${n?.keyringId}`)},[r,n,d]),S=(0,_.useCallback)(async o=>{o==="normal_account"?await A():o==="smart_account"&&await g()},[A,g,h]),D=(0,_.useMemo)(()=>C||b,[C,b]),j=(0,_.useMemo)(()=>{if(C)return p("wallet_extension_addaccount_text_feature_unavailable")},[C]);return{loading:b,isDisabled:D,tooltipTitle:j,canAddSmartAccount:h,createNormalAccount:A,createSmartAccount:g,handleCreateAccount:S,handleAccountCreationSuccess:x}};i();a();var e=y(O());i();a();var l={list:"_list_1oudy_1",list__item:"_list__item_1oudy_7",listItem:"_list__item_1oudy_7",list__item__content:"_list__item__content_1oudy_17",listItemContent:"_list__item__content_1oudy_17",list__item__icon:"_list__item__icon_1oudy_23",listItemIcon:"_list__item__icon_1oudy_23",list__item__textWrapper:"_list__item__textWrapper_1oudy_31",listItemTextWrapper:"_list__item__textWrapper_1oudy_31",list__item__title:"_list__item__title_1oudy_36",listItemTitle:"_list__item__title_1oudy_36",list__item__desc:"_list__item__desc_1oudy_42",listItemDesc:"_list__item__desc_1oudy_42",list__item__arrow:"_list__item__arrow_1oudy_48",listItemArrow:"_list__item__arrow_1oudy_48"};var dt=({visible:n,onBack:f,onAddAccount:d})=>e.default.createElement(Q.Action,{visible:n,onClose:f,title:m("wallet_manage_wallet_btn_add_acoount"),maskClosable:!0,windowStyle:{overflow:"hidden"},zIndex:1e3,alignBottom:!0,noContentPadding:!0},e.default.createElement("div",{className:l.list},e.default.createElement("div",{className:l.list__item,onClick:()=>d("normal_account"),"data-testid":M.WALLET_MANAGEMENT_PAGE.ADD_ACCOUNT_INNER_BUTTON},e.default.createElement("div",{className:l.list__item__content},e.default.createElement("div",{className:l.list__item__icon},e.default.createElement(v,{className:"okx-wallet-plugin-seed-phrase",fontSize:"32px"})),e.default.createElement("div",{className:l.list__item__textWrapper},e.default.createElement("span",{className:l.list__item__title},m("wallet_extension_account_bttmsheet_title_add_account")),e.default.createElement("span",{className:l.list__item__desc},m("wallet_extension_account_bttmsheet_subtitle_add_account")))),e.default.createElement("div",{className:l.list__item__arrow},e.default.createElement(v,{className:"okx-wallet-plugin-chevron-right",fontSize:"20px"}))),e.default.createElement("div",{className:l.list__item,onClick:()=>(X(),d("smart_account")),"data-testid":M.WALLET_MANAGEMENT_PAGE.ADD_ACCOUNT_AND_ENABLE_SA_BUTTON},e.default.createElement("div",{className:l.list__item__content},e.default.createElement("div",{className:l.list__item__icon},e.default.createElement(v,{className:"okx-wallet-plugin-trading-bot",fontSize:"32px"})),e.default.createElement("div",{className:l.list__item__textWrapper},e.default.createElement("span",{className:l.list__item__title},m("wallet_extension_account_bttmsheet_title_smart_account")),e.default.createElement("span",{className:l.list__item__desc},m("wallet_extension_account_bttmsheet_subtitle_smart_account")))),e.default.createElement("div",{className:l.list__item__arrow},e.default.createElement(v,{className:"okx-wallet-plugin-chevron-right",fontSize:"20px"})))));i();a();var pt=y(O());i();a();var ut={coachmark:"_coachmark_1m4o3_1"};var ft=({actionRef:n,isShow:f,hideCancel:d,onConfirm:r,onCancel:c})=>{if(!n?.current)return null;let C=d?{}:{cancelText:m("wallet_extension_home_link_learn_more"),onCancel:c};return pt.default.createElement(R,{mask:!0,className:ut.coachmark,referenceRef:n.current,placement:Y.DIRECTION.bottomLeft,offset:[12,0],arrowPointAtCenter:!1,arrowAlignBoundary:()=>({transform:"translateX(12px)"}),highlightedPadding:0,title:m("wallet_extension_account_coachmark_title_smart_account"),description:m("wallet_extension_account_coachmark_desc_smart_account"),show:f,onConfirm:r,confirmText:m("wallet_extension_btn_general_gotit"),...C})};i();a();var s={container:"_container_e2uje_1","container--disabled":"_container--disabled_e2uje_10",containerDisabled:"_container--disabled_e2uje_10","container--detail-list":"_container--detail-list_e2uje_15",containerDetailList:"_container--detail-list_e2uje_15","container--wallet-list":"_container--wallet-list_e2uje_26",containerWalletList:"_container--wallet-list_e2uje_26","icon-wrapper":"_icon-wrapper_e2uje_41",iconWrapper:"_icon-wrapper_e2uje_41","icon-wrapper--wallet-list":"_icon-wrapper--wallet-list_e2uje_48",iconWrapperWalletList:"_icon-wrapper--wallet-list_e2uje_48","icon-wrapper--detail-list":"_icon-wrapper--detail-list_e2uje_53",iconWrapperDetailList:"_icon-wrapper--detail-list_e2uje_53",icon:"_icon_e2uje_41","icon--wallet-list":"_icon--wallet-list_e2uje_61",iconWalletList:"_icon--wallet-list_e2uje_61","icon--detail-list":"_icon--detail-list_e2uje_64",iconDetailList:"_icon--detail-list_e2uje_64",text:"_text_e2uje_67","text--wallet-list":"_text--wallet-list_e2uje_74",textWalletList:"_text--wallet-list_e2uje_74","text--detail-list":"_text--detail-list_e2uje_78",textDetailList:"_text--detail-list_e2uje_78","loader--wallet-list":"_loader--wallet-list_e2uje_82",loaderWalletList:"_loader--wallet-list_e2uje_82","loader--detail-list":"_loader--detail-list_e2uje_86",loaderDetailList:"_loader--detail-list_e2uje_86"};var It=t.default.forwardRef(({keyringIdentity:n,onAccountCreated:f,onAddAccountClick:d,canAddSmartAccount:r=!1,variant:c="wallet-list",tooltip:C,className:b,children:E,SACoachMarkFeatureEnable:T=!1},I)=>{let[W,h]=(0,t.useState)(!1),[x,A]=(0,t.useState)(!1),[g,S]=(0,t.useState)(!1),D=lt(),{loading:j,isDisabled:o,tooltipTitle:w,canAddSmartAccount:u,createNormalAccount:$,handleCreateAccount:z}=mt(n,f,2),At=x||j,U=x||o,{isShowSACoachMarkOnce:K,markShown:wt}=_t();(0,t.useEffect)(()=>{T&&r&&u&&(K||setTimeout(()=>{S(!0),wt()}))},[T,r,u,K]);let Ct=(0,t.useCallback)(async()=>{if(!U){A(!0);try{r&&u?h(!0):(await $(),A(!1))}catch(L){throw A(!1),L}}},[U,r,u,$]),ht=(0,t.useCallback)(async L=>{try{h(!1),await z(L)}finally{A(!1)}},[z]),Nt=(0,t.useCallback)(()=>{h(!1),A(!1)},[]),Tt=(0,t.useCallback)(()=>{S(!1)},[r,u]),xt=(0,t.useCallback)(()=>{S(!1),globalThis.platform.openTab({url:D.smartAccountWhatIsSmartAccount})},[]),gt=()=>{S(!1),d&&d(),st({confirmText:p("wallet_extension_onboard_checkbox_i_understand"),callback:Ct})};return t.default.createElement(t.default.Fragment,null,(()=>{let L=E||t.default.createElement(t.default.Fragment,null,t.default.createElement("div",{className:(0,k.default)(s["icon-wrapper"],s[`icon-wrapper--${c}`])},At?t.default.createElement(P.Circle,{className:(0,k.default)(s.loader,s[`loader--${c}`]),size:P.SIZE.md}):t.default.createElement(it,{icon:"okx-wallet-plugin-plus",className:(0,k.default)(s.icon,s[`icon--${c}`])})),t.default.createElement("div",{className:(0,k.default)(s.text,s[`text--${c}`])},p("wallet_manage_wallet_btn_add_acoount"))),H=t.default.createElement("div",{ref:I,className:(0,k.default)(b,s.container,{[s["container--disabled"]]:U,[s["container--detail-list"]]:c==="detail-list",[s["container--wallet-list"]]:c==="wallet-list"}),"data-testid":M.WALLET_MANAGEMENT_PAGE.ADD_ACCOUNT_BUTTON,onClick:gt},L),V=C||w;return V?t.default.createElement(B,{title:V,placement:B.DIRECTION.top,maxWidth:328},H):H})(),g&&t.default.createElement(ft,{isShow:g,actionRef:I,onConfirm:Tt,onCancel:xt,hideCancel:!D.smartAccountWhatIsSmartAccount}),r&&t.default.createElement(dt,{visible:W,onBack:Nt,onAddAccount:ht}))}),Ge=t.default.memo(It);export{Ge as a};
//# sourceMappingURL=chunk-5FXPBT57.js.map
