import{b as od,g as cd,h as Ys,j as Zn}from"./chunk-VONUGAVN.js";import{a as dd}from"./chunk-QI2KSP5Y.js";import{a as xa}from"./chunk-EL77VG5Z.js";import{a as sd,b as fd}from"./chunk-26XSB24L.js";import{c as td,d as rd,e as nd,i as Xs,j as id,l as ad}from"./chunk-PDIVTGDM.js";import{c as _a}from"./chunk-UL6IEE2K.js";import{d as ed}from"./chunk-4ARIYUS3.js";import{c as D,o as k,p as P,q}from"./chunk-UWURTNRY.js";var Js=D(lr=>{k();q();Object.defineProperty(lr,"__esModule",{value:!0});lr.base58=lr.fromBase58=lr.toBase58=void 0;var Sa=xa();Object.defineProperty(lr,"base58",{enumerable:!0,get:function(){return Sa.base58}});function ud(t){let e=P.Buffer.from(t);return Sa.base58.encode(Uint8Array.from(e))}lr.toBase58=ud;function ld(t){return Sa.base58.decode(t)}lr.fromBase58=ld});var Qs=D(Fr=>{k();q();Object.defineProperty(Fr,"__esModule",{value:!0});Fr.validateHexString=Fr.isHexString=void 0;function hd(t,e){return t.match(/^0x[0-9A-Fa-f]*$/)?!(e&&t.length!==2+2*e):!1}Fr.isHexString=hd;function bd(t){if(!t)return!1;let e=t.toLowerCase().startsWith("0x")?t.substring(2).toLowerCase():t.toLowerCase();return!(e.length===0||e.length%2!==0||!e.match(/^[0-9A-Fa-f]*$/))}Fr.validateHexString=bd});var ef=D(Ft=>{k();q();Object.defineProperty(Ft,"__esModule",{value:!0});Ft.isHexPrefixed=Ft.stripHexPrefix=Ft.fromHex=Ft.toHex=void 0;var pd=Qs();function vd(t,e=!1){let r=P.Buffer.from(t);return e?"0x"+r.toString("hex"):r.toString("hex")}Ft.toHex=vd;function yd(t){if((t.startsWith("0x")||t.startsWith("0X"))&&(t=t.substring(2)),t.length%2!=0&&(t="0"+t),!(0,pd.validateHexString)(t))throw new Error("invalid hex string");return P.Buffer.from(t,"hex")}Ft.fromHex=yd;function md(t){return t.startsWith("0x")?t.substring(2):t}Ft.stripHexPrefix=md;function gd(t){return t.startsWith("0x")}Ft.isHexPrefixed=gd});var Qt=D(qr=>{k();q();Object.defineProperty(qr,"__esModule",{value:!0});qr.anumber=Ma;qr.abytes=tf;qr.ahash=_d;qr.aexists=xd;qr.aoutput=Sd;function Ma(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function wd(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function tf(t,...e){if(!wd(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function _d(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ma(t.outputLen),Ma(t.blockLen)}function xd(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Sd(t,e){tf(t);let r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}});var rf=D(Wn=>{k();q();Object.defineProperty(Wn,"__esModule",{value:!0});Wn.crypto=void 0;Wn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var ht=D(ae=>{k();q();Object.defineProperty(ae,"__esModule",{value:!0});ae.Hash=ae.nextTick=ae.byteSwapIfBE=ae.isLE=void 0;ae.isBytes=Md;ae.u8=Bd;ae.u32=Ad;ae.createView=Id;ae.rotr=Ed;ae.rotl=Pd;ae.byteSwap=Ia;ae.byteSwap32=kd;ae.bytesToHex=Od;ae.hexToBytes=Cd;ae.asyncLoop=Td;ae.utf8ToBytes=sf;ae.toBytes=$n;ae.concatBytes=Hd;ae.checkOpts=Nd;ae.wrapConstructor=Rd;ae.wrapConstructorWithOpts=Kd;ae.wrapXOFConstructorWithOpts=Ud;ae.randomBytes=jd;var Zr=rf(),Aa=Qt();function Md(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Bd(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function Ad(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Id(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ed(t,e){return t<<32-e|t>>>e}function Pd(t,e){return t<<e|t>>>32-e>>>0}ae.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function Ia(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}ae.byteSwapIfBE=ae.isLE?t=>t:t=>Ia(t);function kd(t){for(let e=0;e<t.length;e++)t[e]=Ia(t[e])}var af=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",qd=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Od(t){if((0,Aa.abytes)(t),af)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=qd[t[r]];return e}var er={_0:48,_9:57,A:65,F:70,a:97,f:102};function nf(t){if(t>=er._0&&t<=er._9)return t-er._0;if(t>=er.A&&t<=er.F)return t-(er.A-10);if(t>=er.a&&t<=er.f)return t-(er.a-10)}function Cd(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(af)return Uint8Array.fromHex(t);let e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let o=nf(t.charCodeAt(s)),c=nf(t.charCodeAt(s+1));if(o===void 0||c===void 0){let u=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+s)}n[i]=o*16+c}return n}var Ld=async()=>{};ae.nextTick=Ld;async function Td(t,e,r){let n=Date.now();for(let i=0;i<t;i++){r(i);let s=Date.now()-n;s>=0&&s<e||(await(0,ae.nextTick)(),n+=s)}}function sf(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function $n(t){return typeof t=="string"&&(t=sf(t)),(0,Aa.abytes)(t),t}function Hd(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];(0,Aa.abytes)(i),e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var Ba=class{clone(){return this._cloneInto()}};ae.Hash=Ba;function Nd(t,e){if(e!==void 0&&{}.toString.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}function Rd(t){let e=n=>t().update($n(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Kd(t){let e=(n,i)=>t(i).update($n(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function Ud(t){let e=(n,i)=>t(i).update($n(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function jd(t=32){if(Zr.crypto&&typeof Zr.crypto.getRandomValues=="function")return Zr.crypto.getRandomValues(new Uint8Array(t));if(Zr.crypto&&typeof Zr.crypto.randomBytes=="function")return Uint8Array.from(Zr.crypto.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}});var Gn=D(Or=>{k();q();Object.defineProperty(Or,"__esModule",{value:!0});Or.HashMD=void 0;Or.setBigUint64=ff;Or.Chi=Dd;Or.Maj=zd;var Ea=Qt(),An=ht();function ff(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),c=Number(r&s),u=n?4:0,l=n?0:4;t.setUint32(e+u,o,n),t.setUint32(e+l,c,n)}function Dd(t,e,r){return t&e^~t&r}function zd(t,e,r){return t&e^t&r^e&r}var Pa=class extends An.Hash{constructor(e,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,An.createView)(this.buffer)}update(e){(0,Ea.aexists)(this);let{view:r,buffer:n,blockLen:i}=this;e=(0,An.toBytes)(e);let s=e.length;for(let o=0;o<s;){let c=Math.min(i-this.pos,s-o);if(c===i){let u=(0,An.createView)(e);for(;i<=s-o;o+=i)this.process(u,o);continue}n.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,Ea.aexists)(this),(0,Ea.aoutput)(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let p=o;p<i;p++)r[p]=0;ff(n,i-8,BigInt(this.length*8),s),this.process(n,0);let c=(0,An.createView)(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=u/4,y=this.get();if(l>y.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<l;p++)c.setUint32(4*p,y[p],s)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:c}=this;return e.length=i,e.pos=c,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}};Or.HashMD=Pa});var Wr=D(pr=>{k();q();Object.defineProperty(pr,"__esModule",{value:!0});pr.sha224=pr.sha256=pr.SHA256=void 0;var ka=Gn(),Ot=ht(),Vd=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),hr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),br=new Uint32Array(64),In=class extends ka.HashMD{constructor(e=32){super(64,e,8,!1),this.A=hr[0]|0,this.B=hr[1]|0,this.C=hr[2]|0,this.D=hr[3]|0,this.E=hr[4]|0,this.F=hr[5]|0,this.G=hr[6]|0,this.H=hr[7]|0}get(){let{A:e,B:r,C:n,D:i,E:s,F:o,G:c,H:u}=this;return[e,r,n,i,s,o,c,u]}set(e,r,n,i,s,o,c,u){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=c|0,this.H=u|0}process(e,r){for(let p=0;p<16;p++,r+=4)br[p]=e.getUint32(r,!1);for(let p=16;p<64;p++){let S=br[p-15],M=br[p-2],A=(0,Ot.rotr)(S,7)^(0,Ot.rotr)(S,18)^S>>>3,x=(0,Ot.rotr)(M,17)^(0,Ot.rotr)(M,19)^M>>>10;br[p]=x+br[p-7]+A+br[p-16]|0}let{A:n,B:i,C:s,D:o,E:c,F:u,G:l,H:y}=this;for(let p=0;p<64;p++){let S=(0,Ot.rotr)(c,6)^(0,Ot.rotr)(c,11)^(0,Ot.rotr)(c,25),M=y+S+(0,ka.Chi)(c,u,l)+Vd[p]+br[p]|0,x=((0,Ot.rotr)(n,2)^(0,Ot.rotr)(n,13)^(0,Ot.rotr)(n,22))+(0,ka.Maj)(n,i,s)|0;y=l,l=u,u=c,c=o+M|0,o=s,s=i,i=n,n=M+x|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,c=c+this.E|0,u=u+this.F|0,l=l+this.G|0,y=y+this.H|0,this.set(n,i,s,o,c,u,l,y)}roundClean(){br.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};pr.SHA256=In;var qa=class extends In{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}};pr.sha256=(0,Ot.wrapConstructor)(()=>new In);pr.sha224=(0,Ot.wrapConstructor)(()=>new qa)});var $r=D($=>{k();q();Object.defineProperty($,"__esModule",{value:!0});$.add5L=$.add5H=$.add4H=$.add4L=$.add3H=$.add3L=$.rotlBL=$.rotlBH=$.rotlSL=$.rotlSH=$.rotr32L=$.rotr32H=$.rotrBL=$.rotrBH=$.rotrSL=$.rotrSH=$.shrSL=$.shrSH=$.toBig=void 0;$.fromBig=Ca;$.split=of;$.add=xf;var Xn=BigInt(2**32-1),Oa=BigInt(32);function Ca(t,e=!1){return e?{h:Number(t&Xn),l:Number(t>>Oa&Xn)}:{h:Number(t>>Oa&Xn)|0,l:Number(t&Xn)|0}}function of(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:s,l:o}=Ca(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}var cf=(t,e)=>BigInt(t>>>0)<<Oa|BigInt(e>>>0);$.toBig=cf;var df=(t,e,r)=>t>>>r;$.shrSH=df;var uf=(t,e,r)=>t<<32-r|e>>>r;$.shrSL=uf;var lf=(t,e,r)=>t>>>r|e<<32-r;$.rotrSH=lf;var hf=(t,e,r)=>t<<32-r|e>>>r;$.rotrSL=hf;var bf=(t,e,r)=>t<<64-r|e>>>r-32;$.rotrBH=bf;var pf=(t,e,r)=>t>>>r-32|e<<64-r;$.rotrBL=pf;var vf=(t,e)=>e;$.rotr32H=vf;var yf=(t,e)=>t;$.rotr32L=yf;var mf=(t,e,r)=>t<<r|e>>>32-r;$.rotlSH=mf;var gf=(t,e,r)=>e<<r|t>>>32-r;$.rotlSL=gf;var wf=(t,e,r)=>e<<r-32|t>>>64-r;$.rotlBH=wf;var _f=(t,e,r)=>t<<r-32|e>>>64-r;$.rotlBL=_f;function xf(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var Sf=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0);$.add3L=Sf;var Mf=(t,e,r,n)=>e+r+n+(t/2**32|0)|0;$.add3H=Mf;var Bf=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0);$.add4L=Bf;var Af=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0;$.add4H=Af;var If=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0);$.add5L=If;var Ef=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0;$.add5H=Ef;var Fd={fromBig:Ca,split:of,toBig:cf,shrSH:df,shrSL:uf,rotrSH:lf,rotrSL:hf,rotrBH:bf,rotrBL:pf,rotr32H:vf,rotr32L:yf,rotlSH:mf,rotlSL:gf,rotlBH:wf,rotlBL:_f,add:xf,add3L:Sf,add3H:Mf,add4L:Bf,add4H:Af,add5H:Ef,add5L:If};$.default=Fd});var En=D(at=>{k();q();Object.defineProperty(at,"__esModule",{value:!0});at.sha384=at.sha512_256=at.sha512_224=at.sha512=at.SHA384=at.SHA512_256=at.SHA512_224=at.SHA512=void 0;var Zd=Gn(),X=$r(),ei=ht(),[Wd,$d]=(()=>X.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),vr=new Uint32Array(80),yr=new Uint32Array(80),Cr=class extends Zd.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:c,Dl:u,Eh:l,El:y,Fh:p,Fl:S,Gh:M,Gl:A,Hh:x,Hl:E}=this;return[e,r,n,i,s,o,c,u,l,y,p,S,M,A,x,E]}set(e,r,n,i,s,o,c,u,l,y,p,S,M,A,x,E){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=c|0,this.Dl=u|0,this.Eh=l|0,this.El=y|0,this.Fh=p|0,this.Fl=S|0,this.Gh=M|0,this.Gl=A|0,this.Hh=x|0,this.Hl=E|0}process(e,r){for(let O=0;O<16;O++,r+=4)vr[O]=e.getUint32(r),yr[O]=e.getUint32(r+=4);for(let O=16;O<80;O++){let L=vr[O-15]|0,T=yr[O-15]|0,N=X.default.rotrSH(L,T,1)^X.default.rotrSH(L,T,8)^X.default.shrSH(L,T,7),U=X.default.rotrSL(L,T,1)^X.default.rotrSL(L,T,8)^X.default.shrSL(L,T,7),H=vr[O-2]|0,Z=yr[O-2]|0,_=X.default.rotrSH(H,Z,19)^X.default.rotrBH(H,Z,61)^X.default.shrSH(H,Z,6),a=X.default.rotrSL(H,Z,19)^X.default.rotrBL(H,Z,61)^X.default.shrSL(H,Z,6),d=X.default.add4L(U,a,yr[O-7],yr[O-16]),h=X.default.add4H(d,N,_,vr[O-7],vr[O-16]);vr[O]=h|0,yr[O]=d|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:c,Cl:u,Dh:l,Dl:y,Eh:p,El:S,Fh:M,Fl:A,Gh:x,Gl:E,Hh:I,Hl:C}=this;for(let O=0;O<80;O++){let L=X.default.rotrSH(p,S,14)^X.default.rotrSH(p,S,18)^X.default.rotrBH(p,S,41),T=X.default.rotrSL(p,S,14)^X.default.rotrSL(p,S,18)^X.default.rotrBL(p,S,41),N=p&M^~p&x,U=S&A^~S&E,H=X.default.add5L(C,T,U,$d[O],yr[O]),Z=X.default.add5H(H,I,L,N,Wd[O],vr[O]),_=H|0,a=X.default.rotrSH(n,i,28)^X.default.rotrBH(n,i,34)^X.default.rotrBH(n,i,39),d=X.default.rotrSL(n,i,28)^X.default.rotrBL(n,i,34)^X.default.rotrBL(n,i,39),h=n&s^n&c^s&c,v=i&o^i&u^o&u;I=x|0,C=E|0,x=M|0,E=A|0,M=p|0,A=S|0,{h:p,l:S}=X.default.add(l|0,y|0,Z|0,_|0),l=c|0,y=u|0,c=s|0,u=o|0,s=n|0,o=i|0;let b=X.default.add3L(_,d,v);n=X.default.add3H(b,Z,a,h),i=b|0}({h:n,l:i}=X.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=X.default.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:c,l:u}=X.default.add(this.Ch|0,this.Cl|0,c|0,u|0),{h:l,l:y}=X.default.add(this.Dh|0,this.Dl|0,l|0,y|0),{h:p,l:S}=X.default.add(this.Eh|0,this.El|0,p|0,S|0),{h:M,l:A}=X.default.add(this.Fh|0,this.Fl|0,M|0,A|0),{h:x,l:E}=X.default.add(this.Gh|0,this.Gl|0,x|0,E|0),{h:I,l:C}=X.default.add(this.Hh|0,this.Hl|0,I|0,C|0),this.set(n,i,s,o,c,u,l,y,p,S,M,A,x,E,I,C)}roundClean(){vr.fill(0),yr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};at.SHA512=Cr;var Yn=class extends Cr{constructor(){super(28),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735}};at.SHA512_224=Yn;var Jn=class extends Cr{constructor(){super(32),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414}};at.SHA512_256=Jn;var Qn=class extends Cr{constructor(){super(48),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868}};at.SHA384=Qn;at.sha512=(0,ei.wrapConstructor)(()=>new Cr);at.sha512_224=(0,ei.wrapConstructor)(()=>new Yn);at.sha512_256=(0,ei.wrapConstructor)(()=>new Jn);at.sha384=(0,ei.wrapConstructor)(()=>new Qn)});var Ha=D(Gr=>{k();q();Object.defineProperty(Gr,"__esModule",{value:!0});Gr.ripemd160=Gr.RIPEMD160=void 0;var Gd=Gn(),Pn=ht(),Xd=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),kf=new Uint8Array(new Array(16).fill(0).map((t,e)=>e)),Yd=kf.map(t=>(9*t+5)%16),La=[kf],Ta=[Yd];for(let t=0;t<4;t++)for(let e of[La,Ta])e.push(e[t].map(r=>Xd[r]));var qf=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),Jd=La.map((t,e)=>t.map(r=>qf[e][r])),Qd=Ta.map((t,e)=>t.map(r=>qf[e][r])),eu=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),tu=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function Pf(t,e,r,n){return t===0?e^r^n:t===1?e&r|~e&n:t===2?(e|~r)^n:t===3?e&n|r&~n:e^(r|~n)}var ti=new Uint32Array(16),ri=class extends Gd.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:e,h1:r,h2:n,h3:i,h4:s}=this;return[e,r,n,i,s]}set(e,r,n,i,s){this.h0=e|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(e,r){for(let M=0;M<16;M++,r+=4)ti[M]=e.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,o=s,c=this.h2|0,u=c,l=this.h3|0,y=l,p=this.h4|0,S=p;for(let M=0;M<5;M++){let A=4-M,x=eu[M],E=tu[M],I=La[M],C=Ta[M],O=Jd[M],L=Qd[M];for(let T=0;T<16;T++){let N=(0,Pn.rotl)(n+Pf(M,s,c,l)+ti[I[T]]+x,O[T])+p|0;n=p,p=l,l=(0,Pn.rotl)(c,10)|0,c=s,s=N}for(let T=0;T<16;T++){let N=(0,Pn.rotl)(i+Pf(A,o,u,y)+ti[C[T]]+E,L[T])+S|0;i=S,S=y,y=(0,Pn.rotl)(u,10)|0,u=o,o=N}}this.set(this.h1+c+y|0,this.h2+l+S|0,this.h3+p+i|0,this.h4+n+o|0,this.h0+s+u|0)}roundClean(){ti.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};Gr.RIPEMD160=ri;Gr.ripemd160=(0,Pn.wrapConstructor)(()=>new ri)});var ni=D(he=>{k();q();Object.defineProperty(he,"__esModule",{value:!0});he.shake256=he.shake128=he.keccak_512=he.keccak_384=he.keccak_256=he.keccak_224=he.sha3_512=he.sha3_384=he.sha3_256=he.sha3_224=he.Keccak=void 0;he.keccakP=Nf;var Xr=Qt(),qn=$r(),tr=ht(),Lf=[],Tf=[],Hf=[],ru=BigInt(0),kn=BigInt(1),nu=BigInt(2),iu=BigInt(7),au=BigInt(256),su=BigInt(113);for(let t=0,e=kn,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],Lf.push(2*(5*n+r)),Tf.push((t+1)*(t+2)/2%64);let i=ru;for(let s=0;s<7;s++)e=(e<<kn^(e>>iu)*su)%au,e&nu&&(i^=kn<<(kn<<BigInt(s))-kn);Hf.push(i)}var[fu,ou]=(0,qn.split)(Hf,!0),Of=(t,e,r)=>r>32?(0,qn.rotlBH)(t,e,r):(0,qn.rotlSH)(t,e,r),Cf=(t,e,r)=>r>32?(0,qn.rotlBL)(t,e,r):(0,qn.rotlSL)(t,e,r);function Nf(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){let c=(o+8)%10,u=(o+2)%10,l=r[u],y=r[u+1],p=Of(l,y,1)^r[c],S=Cf(l,y,1)^r[c+1];for(let M=0;M<50;M+=10)t[o+M]^=p,t[o+M+1]^=S}let i=t[2],s=t[3];for(let o=0;o<24;o++){let c=Tf[o],u=Of(i,s,c),l=Cf(i,s,c),y=Lf[o];i=t[y],s=t[y+1],t[y]=u,t[y+1]=l}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)r[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=fu[n],t[1]^=ou[n]}r.fill(0)}var Lr=class extends tr.Hash{constructor(e,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,(0,Xr.anumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,tr.u32)(this.state)}keccak(){tr.isLE||(0,tr.byteSwap32)(this.state32),Nf(this.state32,this.rounds),tr.isLE||(0,tr.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(e){(0,Xr.aexists)(this);let{blockLen:r,state:n}=this;e=(0,tr.toBytes)(e);let i=e.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);for(let c=0;c<o;c++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,Xr.aexists)(this,!1),(0,Xr.abytes)(e),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();let o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,Xr.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,Xr.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new Lr(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}};he.Keccak=Lr;var mr=(t,e,r)=>(0,tr.wrapConstructor)(()=>new Lr(e,t,r));he.sha3_224=mr(6,144,224/8);he.sha3_256=mr(6,136,256/8);he.sha3_384=mr(6,104,384/8);he.sha3_512=mr(6,72,512/8);he.keccak_224=mr(1,144,224/8);he.keccak_256=mr(1,136,256/8);he.keccak_384=mr(1,104,384/8);he.keccak_512=mr(1,72,512/8);var Rf=(t,e,r)=>(0,tr.wrapXOFConstructorWithOpts)((n={})=>new Lr(e,t,n.dkLen===void 0?r:n.dkLen,!0));he.shake128=Rf(31,168,128/8);he.shake256=Rf(31,136,256/8)});var ii=D(Jr=>{k();q();Object.defineProperty(Jr,"__esModule",{value:!0});Jr.BLAKE=Jr.SIGMA=void 0;var Yr=Qt(),bt=ht();Jr.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var Na=class extends bt.Hash{constructor(e,r,n={},i,s,o){if(super(),this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,Yr.anumber)(e),(0,Yr.anumber)(r),(0,Yr.anumber)(i),r<0||r>i)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error("key length must be undefined or 1.."+i);if(n.salt!==void 0&&n.salt.length!==s)throw new Error("salt must be undefined or "+s);if(n.personalization!==void 0&&n.personalization.length!==o)throw new Error("personalization must be undefined or "+o);this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=(0,bt.u32)(this.buffer)}update(e){(0,Yr.aexists)(this);let{blockLen:r,buffer:n,buffer32:i}=this;e=(0,bt.toBytes)(e);let s=e.length,o=e.byteOffset,c=e.buffer;for(let u=0;u<s;){this.pos===r&&(bt.isLE||(0,bt.byteSwap32)(i),this.compress(i,0,!1),bt.isLE||(0,bt.byteSwap32)(i),this.pos=0);let l=Math.min(r-this.pos,s-u),y=o+u;if(l===r&&!(y%4)&&u+l<s){let p=new Uint32Array(c,y,Math.floor((s-u)/4));bt.isLE||(0,bt.byteSwap32)(p);for(let S=0;u+r<s;S+=i.length,u+=r)this.length+=r,this.compress(p,S,!1);bt.isLE||(0,bt.byteSwap32)(p);continue}n.set(e.subarray(u,u+l),this.pos),this.pos+=l,this.length+=l,u+=l}return this}digestInto(e){(0,Yr.aexists)(this),(0,Yr.aoutput)(e,this);let{pos:r,buffer32:n}=this;this.finished=!0,this.buffer.subarray(r).fill(0),bt.isLE||(0,bt.byteSwap32)(n),this.compress(n,0,!0),bt.isLE||(0,bt.byteSwap32)(n);let i=(0,bt.u32)(e);this.get().forEach((s,o)=>i[o]=(0,bt.byteSwapIfBE)(s))}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:c}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.length=n,e.finished=i,e.destroyed=s,e.outputLen=o,e.buffer.set(r),e.pos=c,e}};Jr.BLAKE=Na});var Ra=D(Qr=>{k();q();Object.defineProperty(Qr,"__esModule",{value:!0});Qr.blake2b=Qr.BLAKE2b=void 0;var Kf=ii(),St=$r(),At=ht(),rt=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),j=new Uint32Array(32);function gr(t,e,r,n,i,s){let o=i[s],c=i[s+1],u=j[2*t],l=j[2*t+1],y=j[2*e],p=j[2*e+1],S=j[2*r],M=j[2*r+1],A=j[2*n],x=j[2*n+1],E=St.default.add3L(u,y,o);l=St.default.add3H(E,l,p,c),u=E|0,{Dh:x,Dl:A}={Dh:x^l,Dl:A^u},{Dh:x,Dl:A}={Dh:St.default.rotr32H(x,A),Dl:St.default.rotr32L(x,A)},{h:M,l:S}=St.default.add(M,S,x,A),{Bh:p,Bl:y}={Bh:p^M,Bl:y^S},{Bh:p,Bl:y}={Bh:St.default.rotrSH(p,y,24),Bl:St.default.rotrSL(p,y,24)},j[2*t]=u,j[2*t+1]=l,j[2*e]=y,j[2*e+1]=p,j[2*r]=S,j[2*r+1]=M,j[2*n]=A,j[2*n+1]=x}function wr(t,e,r,n,i,s){let o=i[s],c=i[s+1],u=j[2*t],l=j[2*t+1],y=j[2*e],p=j[2*e+1],S=j[2*r],M=j[2*r+1],A=j[2*n],x=j[2*n+1],E=St.default.add3L(u,y,o);l=St.default.add3H(E,l,p,c),u=E|0,{Dh:x,Dl:A}={Dh:x^l,Dl:A^u},{Dh:x,Dl:A}={Dh:St.default.rotrSH(x,A,16),Dl:St.default.rotrSL(x,A,16)},{h:M,l:S}=St.default.add(M,S,x,A),{Bh:p,Bl:y}={Bh:p^M,Bl:y^S},{Bh:p,Bl:y}={Bh:St.default.rotrBH(p,y,63),Bl:St.default.rotrBL(p,y,63)},j[2*t]=u,j[2*t+1]=l,j[2*e]=y,j[2*e+1]=p,j[2*r]=S,j[2*r+1]=M,j[2*n]=A,j[2*n+1]=x}var ai=class extends Kf.BLAKE{constructor(e={}){super(128,e.dkLen===void 0?64:e.dkLen,e,64,16,16),this.v0l=rt[0]|0,this.v0h=rt[1]|0,this.v1l=rt[2]|0,this.v1h=rt[3]|0,this.v2l=rt[4]|0,this.v2h=rt[5]|0,this.v3l=rt[6]|0,this.v3h=rt[7]|0,this.v4l=rt[8]|0,this.v4h=rt[9]|0,this.v5l=rt[10]|0,this.v5h=rt[11]|0,this.v6l=rt[12]|0,this.v6h=rt[13]|0,this.v7l=rt[14]|0,this.v7h=rt[15]|0;let r=e.key?e.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,e.salt){let n=(0,At.u32)((0,At.toBytes)(e.salt));this.v4l^=(0,At.byteSwapIfBE)(n[0]),this.v4h^=(0,At.byteSwapIfBE)(n[1]),this.v5l^=(0,At.byteSwapIfBE)(n[2]),this.v5h^=(0,At.byteSwapIfBE)(n[3])}if(e.personalization){let n=(0,At.u32)((0,At.toBytes)(e.personalization));this.v6l^=(0,At.byteSwapIfBE)(n[0]),this.v6h^=(0,At.byteSwapIfBE)(n[1]),this.v7l^=(0,At.byteSwapIfBE)(n[2]),this.v7h^=(0,At.byteSwapIfBE)(n[3])}if(e.key){let n=new Uint8Array(this.blockLen);n.set((0,At.toBytes)(e.key)),this.update(n)}}get(){let{v0l:e,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:c,v3h:u,v4l:l,v4h:y,v5l:p,v5h:S,v6l:M,v6h:A,v7l:x,v7h:E}=this;return[e,r,n,i,s,o,c,u,l,y,p,S,M,A,x,E]}set(e,r,n,i,s,o,c,u,l,y,p,S,M,A,x,E){this.v0l=e|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=c|0,this.v3h=u|0,this.v4l=l|0,this.v4h=y|0,this.v5l=p|0,this.v5h=S|0,this.v6l=M|0,this.v6h=A|0,this.v7l=x|0,this.v7h=E|0}compress(e,r,n){this.get().forEach((u,l)=>j[l]=u),j.set(rt,16);let{h:i,l:s}=St.default.fromBig(BigInt(this.length));j[24]=rt[8]^s,j[25]=rt[9]^i,n&&(j[28]=~j[28],j[29]=~j[29]);let o=0,c=Kf.SIGMA;for(let u=0;u<12;u++)gr(0,4,8,12,e,r+2*c[o++]),wr(0,4,8,12,e,r+2*c[o++]),gr(1,5,9,13,e,r+2*c[o++]),wr(1,5,9,13,e,r+2*c[o++]),gr(2,6,10,14,e,r+2*c[o++]),wr(2,6,10,14,e,r+2*c[o++]),gr(3,7,11,15,e,r+2*c[o++]),wr(3,7,11,15,e,r+2*c[o++]),gr(0,5,10,15,e,r+2*c[o++]),wr(0,5,10,15,e,r+2*c[o++]),gr(1,6,11,12,e,r+2*c[o++]),wr(1,6,11,12,e,r+2*c[o++]),gr(2,7,8,13,e,r+2*c[o++]),wr(2,7,8,13,e,r+2*c[o++]),gr(3,4,9,14,e,r+2*c[o++]),wr(3,4,9,14,e,r+2*c[o++]);this.v0l^=j[0]^j[16],this.v0h^=j[1]^j[17],this.v1l^=j[2]^j[18],this.v1h^=j[3]^j[19],this.v2l^=j[4]^j[20],this.v2h^=j[5]^j[21],this.v3l^=j[6]^j[22],this.v3h^=j[7]^j[23],this.v4l^=j[8]^j[24],this.v4h^=j[9]^j[25],this.v5l^=j[10]^j[26],this.v5h^=j[11]^j[27],this.v6l^=j[12]^j[28],this.v6h^=j[13]^j[29],this.v7l^=j[14]^j[30],this.v7h^=j[15]^j[31],j.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Qr.BLAKE2b=ai;Qr.blake2b=(0,At.wrapConstructorWithOpts)(t=>new ai(t))});var fi=D(be=>{k();q();Object.defineProperty(be,"__esModule",{value:!0});be.sha3_512=be.sha3_256=be.ripemd160=be.sha512=be.sha256=be.magicHash=be.blake2=be.keccak256=be.keccak=be.hash160=be.doubleSha256=void 0;var si=Wr();Object.defineProperty(be,"sha256",{enumerable:!0,get:function(){return si.sha256}});var cu=En();Object.defineProperty(be,"sha512",{enumerable:!0,get:function(){return cu.sha512}});var jf=Ha();Object.defineProperty(be,"ripemd160",{enumerable:!0,get:function(){return jf.ripemd160}});var en=ni();Object.defineProperty(be,"sha3_256",{enumerable:!0,get:function(){return en.sha3_256}});Object.defineProperty(be,"sha3_512",{enumerable:!0,get:function(){return en.sha3_512}});var du=Ra();function Df(t){let e=(0,si.sha256)(t);return(0,si.sha256)(e)}be.doubleSha256=Df;function uu(t){let e=(0,si.sha256)(t);return(0,jf.ripemd160)(e)}be.hash160=uu;var lu=function(t,e=256){let r=P.Buffer.from(t);switch(e){case 224:return P.Buffer.from((0,en.keccak_224)(r));case 256:return P.Buffer.from((0,en.keccak_256)(r));case 384:return P.Buffer.from((0,en.keccak_384)(r));case 512:return P.Buffer.from((0,en.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${e}`)}};be.keccak=lu;var hu=function(t){return(0,be.keccak)(t)};be.keccak256=hu;function bu(t,e,r){let n=Math.ceil(e/8);return(0,du.blake2b)(t,{dkLen:n,key:r})}be.blake2=bu;function Uf(t){let e;return t<253?(e=P.Buffer.alloc(1),e.writeUInt8(t,0)):t<65536?(e=P.Buffer.alloc(1+2),e.writeUInt8(253,0),e.writeUInt16LE(t,1)):t<4294967296?(e=P.Buffer.alloc(1+4),e.writeUInt8(254,0),e.writeUInt32LE(t,1)):(e=P.Buffer.alloc(1+8),e.writeUInt8(255,0),e.writeInt32LE(t&-1,1),e.writeUInt32LE(Math.floor(t/4294967296),5)),e}var pu=P.Buffer.from(`Bitcoin Signed Message:
`);function vu(t,e){let r=e?P.Buffer.from(e,"utf8"):pu,n=Uf(r.length),i=P.Buffer.from(t),s=Uf(i.length),o=P.Buffer.concat([n,r,s,i]);return Df(o)}be.magicHash=vu});var Cn=D(Tr=>{k();q();Object.defineProperty(Tr,"__esModule",{value:!0});Tr.hmac=Tr.HMAC=void 0;var oi=Qt(),zf=ht(),On=class extends zf.Hash{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,(0,oi.ahash)(e);let n=(0,zf.toBytes)(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return(0,oi.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,oi.aexists)(this),(0,oi.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:c}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=c,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Tr.HMAC=On;var yu=(t,e,r)=>new On(t,e).update(r).digest();Tr.hmac=yu;Tr.hmac.create=(t,e)=>new On(t,e)});var Zf=D(tn=>{k();q();Object.defineProperty(tn,"__esModule",{value:!0});tn.hmacSHA512=tn.hmacSHA256=void 0;var Vf=Cn(),Ff=fi();function mu(t,e){return P.Buffer.from((0,Vf.hmac)(Ff.sha256,t,e))}tn.hmacSHA256=mu;function gu(t,e){return P.Buffer.from((0,Vf.hmac)(Ff.sha512,t,e))}tn.hmacSHA512=gu});var Ka=D(ce=>{k();q();Object.defineProperty(ce,"__esModule",{value:!0});ce.blake2s=ce.BLAKE2s=ce.B2S_IV=void 0;ce.G1s=rr;ce.G2s=nr;ce.compress=$f;var Wf=ii(),wu=$r(),It=ht();ce.B2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function rr(t,e,r,n,i){return t=t+e+i|0,n=(0,It.rotr)(n^t,16),r=r+n|0,e=(0,It.rotr)(e^r,12),{a:t,b:e,c:r,d:n}}function nr(t,e,r,n,i){return t=t+e+i|0,n=(0,It.rotr)(n^t,8),r=r+n|0,e=(0,It.rotr)(e^r,7),{a:t,b:e,c:r,d:n}}function $f(t,e,r,n,i,s,o,c,u,l,y,p,S,M,A,x,E,I,C,O){let L=0;for(let T=0;T<n;T++)({a:i,b:u,c:S,d:E}=rr(i,u,S,E,r[e+t[L++]])),{a:i,b:u,c:S,d:E}=nr(i,u,S,E,r[e+t[L++]]),{a:s,b:l,c:M,d:I}=rr(s,l,M,I,r[e+t[L++]]),{a:s,b:l,c:M,d:I}=nr(s,l,M,I,r[e+t[L++]]),{a:o,b:y,c:A,d:C}=rr(o,y,A,C,r[e+t[L++]]),{a:o,b:y,c:A,d:C}=nr(o,y,A,C,r[e+t[L++]]),{a:c,b:p,c:x,d:O}=rr(c,p,x,O,r[e+t[L++]]),{a:c,b:p,c:x,d:O}=nr(c,p,x,O,r[e+t[L++]]),{a:i,b:l,c:A,d:O}=rr(i,l,A,O,r[e+t[L++]]),{a:i,b:l,c:A,d:O}=nr(i,l,A,O,r[e+t[L++]]),{a:s,b:y,c:x,d:E}=rr(s,y,x,E,r[e+t[L++]]),{a:s,b:y,c:x,d:E}=nr(s,y,x,E,r[e+t[L++]]),{a:o,b:p,c:S,d:I}=rr(o,p,S,I,r[e+t[L++]]),{a:o,b:p,c:S,d:I}=nr(o,p,S,I,r[e+t[L++]]),{a:c,b:u,c:M,d:C}=rr(c,u,M,C,r[e+t[L++]]),{a:c,b:u,c:M,d:C}=nr(c,u,M,C,r[e+t[L++]]);return{v0:i,v1:s,v2:o,v3:c,v4:u,v5:l,v6:y,v7:p,v8:S,v9:M,v10:A,v11:x,v12:E,v13:I,v14:C,v15:O}}var ci=class extends Wf.BLAKE{constructor(e={}){super(64,e.dkLen===void 0?32:e.dkLen,e,32,8,8),this.v0=ce.B2S_IV[0]|0,this.v1=ce.B2S_IV[1]|0,this.v2=ce.B2S_IV[2]|0,this.v3=ce.B2S_IV[3]|0,this.v4=ce.B2S_IV[4]|0,this.v5=ce.B2S_IV[5]|0,this.v6=ce.B2S_IV[6]|0,this.v7=ce.B2S_IV[7]|0;let r=e.key?e.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,e.salt){let n=(0,It.u32)((0,It.toBytes)(e.salt));this.v4^=(0,It.byteSwapIfBE)(n[0]),this.v5^=(0,It.byteSwapIfBE)(n[1])}if(e.personalization){let n=(0,It.u32)((0,It.toBytes)(e.personalization));this.v6^=(0,It.byteSwapIfBE)(n[0]),this.v7^=(0,It.byteSwapIfBE)(n[1])}if(e.key){let n=new Uint8Array(this.blockLen);n.set((0,It.toBytes)(e.key)),this.update(n)}}get(){let{v0:e,v1:r,v2:n,v3:i,v4:s,v5:o,v6:c,v7:u}=this;return[e,r,n,i,s,o,c,u]}set(e,r,n,i,s,o,c,u){this.v0=e|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=o|0,this.v6=c|0,this.v7=u|0}compress(e,r,n){let{h:i,l:s}=(0,wu.fromBig)(BigInt(this.length)),{v0:o,v1:c,v2:u,v3:l,v4:y,v5:p,v6:S,v7:M,v8:A,v9:x,v10:E,v11:I,v12:C,v13:O,v14:L,v15:T}=$f(Wf.SIGMA,r,e,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,ce.B2S_IV[0],ce.B2S_IV[1],ce.B2S_IV[2],ce.B2S_IV[3],s^ce.B2S_IV[4],i^ce.B2S_IV[5],n?~ce.B2S_IV[6]:ce.B2S_IV[6],ce.B2S_IV[7]);this.v0^=o^A,this.v1^=c^x,this.v2^=u^E,this.v3^=l^I,this.v4^=y^C,this.v5^=p^O,this.v6^=S^L,this.v7^=M^T}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};ce.BLAKE2s=ci;ce.blake2s=(0,It.wrapConstructorWithOpts)(t=>new ci(t))});var li=D(ui=>{k();q();Object.defineProperty(ui,"__esModule",{value:!0});ui.pbkdf2=xu;ui.pbkdf2Async=Su;var di=Qt(),_u=Cn(),rn=ht();function Gf(t,e,r,n){(0,di.ahash)(t);let i=(0,rn.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:o,asyncTick:c}=i;if((0,di.anumber)(s),(0,di.anumber)(o),(0,di.anumber)(c),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let u=(0,rn.toBytes)(e),l=(0,rn.toBytes)(r),y=new Uint8Array(o),p=_u.hmac.create(t,u),S=p._cloneInto().update(l);return{c:s,dkLen:o,asyncTick:c,DK:y,PRF:p,PRFSalt:S}}function Xf(t,e,r,n,i){return t.destroy(),e.destroy(),n&&n.destroy(),i.fill(0),r}function xu(t,e,r,n){let{c:i,dkLen:s,DK:o,PRF:c,PRFSalt:u}=Gf(t,e,r,n),l,y=new Uint8Array(4),p=(0,rn.createView)(y),S=new Uint8Array(c.outputLen);for(let M=1,A=0;A<s;M++,A+=c.outputLen){let x=o.subarray(A,A+c.outputLen);p.setInt32(0,M,!1),(l=u._cloneInto(l)).update(y).digestInto(S),x.set(S.subarray(0,x.length));for(let E=1;E<i;E++){c._cloneInto(l).update(S).digestInto(S);for(let I=0;I<x.length;I++)x[I]^=S[I]}}return Xf(c,u,o,l,S)}async function Su(t,e,r,n){let{c:i,dkLen:s,asyncTick:o,DK:c,PRF:u,PRFSalt:l}=Gf(t,e,r,n),y,p=new Uint8Array(4),S=(0,rn.createView)(p),M=new Uint8Array(u.outputLen);for(let A=1,x=0;x<s;A++,x+=u.outputLen){let E=c.subarray(x,x+u.outputLen);S.setInt32(0,A,!1),(y=l._cloneInto(y)).update(p).digestInto(M),E.set(M.subarray(0,E.length)),await(0,rn.asyncLoop)(i-1,o,()=>{u._cloneInto(y).update(M).digestInto(M);for(let I=0;I<E.length;I++)E[I]^=M[I]})}return Xf(u,l,c,y,M)}});var ro=D(hi=>{k();q();Object.defineProperty(hi,"__esModule",{value:!0});hi.scrypt=Mu;hi.scryptAsync=Bu;var nn=Qt(),Jf=li(),Qf=Wr(),W=ht();function Yf(t,e,r,n,i,s){let o=t[e++]^r[n++],c=t[e++]^r[n++],u=t[e++]^r[n++],l=t[e++]^r[n++],y=t[e++]^r[n++],p=t[e++]^r[n++],S=t[e++]^r[n++],M=t[e++]^r[n++],A=t[e++]^r[n++],x=t[e++]^r[n++],E=t[e++]^r[n++],I=t[e++]^r[n++],C=t[e++]^r[n++],O=t[e++]^r[n++],L=t[e++]^r[n++],T=t[e++]^r[n++],N=o,U=c,H=u,Z=l,_=y,a=p,d=S,h=M,v=A,b=x,w=E,B=I,m=C,f=O,g=L,R=T;for(let K=0;K<8;K+=2)_^=(0,W.rotl)(N+m|0,7),v^=(0,W.rotl)(_+N|0,9),m^=(0,W.rotl)(v+_|0,13),N^=(0,W.rotl)(m+v|0,18),b^=(0,W.rotl)(a+U|0,7),f^=(0,W.rotl)(b+a|0,9),U^=(0,W.rotl)(f+b|0,13),a^=(0,W.rotl)(U+f|0,18),g^=(0,W.rotl)(w+d|0,7),H^=(0,W.rotl)(g+w|0,9),d^=(0,W.rotl)(H+g|0,13),w^=(0,W.rotl)(d+H|0,18),Z^=(0,W.rotl)(R+B|0,7),h^=(0,W.rotl)(Z+R|0,9),B^=(0,W.rotl)(h+Z|0,13),R^=(0,W.rotl)(B+h|0,18),U^=(0,W.rotl)(N+Z|0,7),H^=(0,W.rotl)(U+N|0,9),Z^=(0,W.rotl)(H+U|0,13),N^=(0,W.rotl)(Z+H|0,18),d^=(0,W.rotl)(a+_|0,7),h^=(0,W.rotl)(d+a|0,9),_^=(0,W.rotl)(h+d|0,13),a^=(0,W.rotl)(_+h|0,18),B^=(0,W.rotl)(w+b|0,7),v^=(0,W.rotl)(B+w|0,9),b^=(0,W.rotl)(v+B|0,13),w^=(0,W.rotl)(b+v|0,18),m^=(0,W.rotl)(R+g|0,7),f^=(0,W.rotl)(m+R|0,9),g^=(0,W.rotl)(f+m|0,13),R^=(0,W.rotl)(g+f|0,18);i[s++]=o+N|0,i[s++]=c+U|0,i[s++]=u+H|0,i[s++]=l+Z|0,i[s++]=y+_|0,i[s++]=p+a|0,i[s++]=S+d|0,i[s++]=M+h|0,i[s++]=A+v|0,i[s++]=x+b|0,i[s++]=E+w|0,i[s++]=I+B|0,i[s++]=C+m|0,i[s++]=O+f|0,i[s++]=L+g|0,i[s++]=T+R|0}function an(t,e,r,n,i){let s=n+0,o=n+16*i;for(let c=0;c<16;c++)r[o+c]=t[e+(2*i-1)*16+c];for(let c=0;c<i;c++,s+=16,e+=16)Yf(r,o,t,e,r,s),c>0&&(o+=16),Yf(r,s,t,e+=16,r,o)}function eo(t,e,r){let n=(0,W.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:o,dkLen:c,asyncTick:u,maxmem:l,onProgress:y}=n;if((0,nn.anumber)(i),(0,nn.anumber)(s),(0,nn.anumber)(o),(0,nn.anumber)(c),(0,nn.anumber)(u),(0,nn.anumber)(l),y!==void 0&&typeof y!="function")throw new Error("progressCb should be function");let p=128*s,S=p/4;if(i<=1||(i&i-1)!==0||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(o<0||o>(2**32-1)*32/p)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(c<0||c>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(p*(i+o)>l)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+l);let A=(0,Jf.pbkdf2)(Qf.sha256,t,e,{c:1,dkLen:p*o}),x=(0,W.u32)(A),E=(0,W.u32)(new Uint8Array(p*i)),I=(0,W.u32)(new Uint8Array(p)),C=()=>{};if(y){let O=2*i*o,L=Math.max(Math.floor(O/1e4),1),T=0;C=()=>{T++,y&&(!(T%L)||T===O)&&y(T/O)}}return{N:i,r:s,p:o,dkLen:c,blockSize32:S,V:E,B32:x,B:A,tmp:I,blockMixCb:C,asyncTick:u}}function to(t,e,r,n,i){let s=(0,Jf.pbkdf2)(Qf.sha256,t,r,{c:1,dkLen:e});return r.fill(0),n.fill(0),i.fill(0),s}function Mu(t,e,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:c,V:u,B32:l,B:y,tmp:p,blockMixCb:S}=eo(t,e,r);W.isLE||(0,W.byteSwap32)(l);for(let M=0;M<s;M++){let A=c*M;for(let x=0;x<c;x++)u[x]=l[A+x];for(let x=0,E=0;x<n-1;x++)an(u,E,u,E+=c,i),S();an(u,(n-1)*c,l,A,i),S();for(let x=0;x<n;x++){let E=l[A+c-16]%n;for(let I=0;I<c;I++)p[I]=l[A+I]^u[E*c+I];an(p,0,l,A,i),S()}}return W.isLE||(0,W.byteSwap32)(l),to(t,o,y,u,p)}async function Bu(t,e,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:c,V:u,B32:l,B:y,tmp:p,blockMixCb:S,asyncTick:M}=eo(t,e,r);W.isLE||(0,W.byteSwap32)(l);for(let A=0;A<s;A++){let x=c*A;for(let I=0;I<c;I++)u[I]=l[x+I];let E=0;await(0,W.asyncLoop)(n-1,M,()=>{an(u,E,u,E+=c,i),S()}),an(u,(n-1)*c,l,x,i),S(),await(0,W.asyncLoop)(n,M,()=>{let I=l[x+c-16]%n;for(let C=0;C<c;C++)p[C]=l[x+C]^u[I*c+C];an(p,0,l,x,i),S()})}return W.isLE||(0,W.byteSwap32)(l),to(t,o,y,u,p)}});var ao=D(fn=>{k();q();Object.defineProperty(fn,"__esModule",{value:!0});fn.blake3=fn.BLAKE3=void 0;var Ln=Qt(),Au=ii(),no=$r(),Ut=Ka(),st=ht(),Zt={CHUNK_START:1<<0,CHUNK_END:1<<1,PARENT:1<<2,ROOT:1<<3,KEYED_HASH:1<<4,DERIVE_KEY_CONTEXT:1<<5,DERIVE_KEY_MATERIAL:1<<6},io=(()=>{let t=Array.from({length:16},(n,i)=>i),e=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=t;n<7;n++,i=e(i))r.push(...i);return Uint8Array.from(r)})(),sn=class extends Au.BLAKE{constructor(e={},r=0){let n=e.dkLen===void 0?32:e.dkLen;if(super(64,n,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,(0,Ln.anumber)(this.outputLen),e.key!==void 0&&e.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(e.key!==void 0){let i=(0,st.toBytes)(e.key).slice();if(i.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,st.u32)(i),st.isLE||(0,st.byteSwap32)(this.IV),this.flags=r|Zt.KEYED_HASH}else if(e.context!==void 0){let i=new sn({dkLen:32},Zt.DERIVE_KEY_CONTEXT).update(e.context).digest();this.IV=(0,st.u32)(i),st.isLE||(0,st.byteSwap32)(this.IV),this.flags=r|Zt.DERIVE_KEY_MATERIAL}else this.IV=Ut.B2S_IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,st.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(e,r,n,i=0){let{state:s,pos:o}=this,{h:c,l:u}=(0,no.fromBig)(BigInt(e),!0),{v0:l,v1:y,v2:p,v3:S,v4:M,v5:A,v6:x,v7:E,v8:I,v9:C,v10:O,v11:L,v12:T,v13:N,v14:U,v15:H}=(0,Ut.compress)(io,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],Ut.B2S_IV[0],Ut.B2S_IV[1],Ut.B2S_IV[2],Ut.B2S_IV[3],c,u,o,r);s[0]=l^I,s[1]=y^C,s[2]=p^O,s[3]=S^L,s[4]=M^T,s[5]=A^N,s[6]=x^U,s[7]=E^H}compress(e,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=Zt.CHUNK_START),(this.chunkPos===15||n)&&(i|=Zt.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,e,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let o,c=this.chunksDone+1;(n||!(c&1))&&(o=this.stack.pop());c>>=1)this.buffer32.set(o,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|Zt.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(e){e=super._cloneInto(e);let{IV:r,flags:n,state:i,chunkPos:s,posOut:o,chunkOut:c,stack:u,chunksDone:l}=this;return e.state.set(i.slice()),e.stack=u.map(y=>Uint32Array.from(y)),e.IV.set(r),e.flags=n,e.chunkPos=s,e.chunksDone=l,e.posOut=o,e.chunkOut=c,e.enableXOF=this.enableXOF,e.bufferOut32.set(this.bufferOut32),e}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let e of this.stack)e.fill(0)}b2CompressOut(){let{state:e,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:o,l:c}=(0,no.fromBig)(BigInt(this.chunkOut++));st.isLE||(0,st.byteSwap32)(i);let{v0:u,v1:l,v2:y,v3:p,v4:S,v5:M,v6:A,v7:x,v8:E,v9:I,v10:C,v11:O,v12:L,v13:T,v14:N,v15:U}=(0,Ut.compress)(io,0,i,7,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],Ut.B2S_IV[0],Ut.B2S_IV[1],Ut.B2S_IV[2],Ut.B2S_IV[3],c,o,r,n);s[0]=u^E,s[1]=l^I,s[2]=y^C,s[3]=p^O,s[4]=S^L,s[5]=M^T,s[6]=A^N,s[7]=x^U,s[8]=e[0]^E,s[9]=e[1]^I,s[10]=e[2]^C,s[11]=e[3]^O,s[12]=e[4]^L,s[13]=e[5]^T,s[14]=e[6]^N,s[15]=e[7]^U,st.isLE||((0,st.byteSwap32)(i),(0,st.byteSwap32)(s)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let e=this.flags|Zt.ROOT;this.stack.length?(e|=Zt.PARENT,st.isLE||(0,st.byteSwap32)(this.buffer32),this.compress(this.buffer32,0,!0),st.isLE||(0,st.byteSwap32)(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):e|=(this.chunkPos?0:Zt.CHUNK_START)|Zt.CHUNK_END,this.flags=e,this.b2CompressOut()}writeInto(e){(0,Ln.aexists)(this,!1),(0,Ln.abytes)(e),this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.b2CompressOut();let o=Math.min(r-this.posOut,s-i);e.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(e)}xof(e){return(0,Ln.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,Ln.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};fn.BLAKE3=sn;fn.blake3=(0,st.wrapXOFConstructorWithOpts)(t=>new sn(t))});var Tn=D(se=>{k();q();var so=se&&se.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Iu=se&&se.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Mt=se&&se.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&so(e,t,r)},Eu=se&&se.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&so(e,t,r);return Iu(e,t),e};Object.defineProperty(se,"__esModule",{value:!0});se.randomBytes=se.concatBytes=se.reverseBuffer=void 0;Mt(Js(),se);Mt(ef(),se);Mt(fi(),se);Mt(Zf(),se);Mt(xa(),se);Mt(Wr(),se);Mt(Cn(),se);Mt(Ha(),se);Mt(En(),se);Mt(ni(),se);Mt(Ra(),se);Mt(Ka(),se);Mt(li(),se);Mt(ro(),se);Mt(ao(),se);var Pu=Eu(ht()),ku=nd();function qu(t){if(t.length<1)return t;let e=t.length-1,r=0;for(let n=0;n<t.length/2;n++)r=t[n],t[n]=t[e],t[e]=r,e--;return t}se.reverseBuffer=qu;function Ou(t,e){return Pu.concatBytes(Uint8Array.from(t),Uint8Array.from(e))}se.concatBytes=Ou;function Cu(t){return ku(t)}se.randomBytes=Cu});var Et=D((fo,Ua)=>{k();q();(function(t,e){"use strict";function r(_,a){if(!_)throw new Error(a||"Assertion failed")}function n(_,a){_.super_=a;var d=function(){};d.prototype=a.prototype,_.prototype=new d,_.prototype.constructor=_}function i(_,a,d){if(i.isBN(_))return _;this.negative=0,this.words=null,this.length=0,this.red=null,_!==null&&((a==="le"||a==="be")&&(d=a,a=10),this._init(_||0,a||10,d||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=ed().Buffer}catch{}i.isBN=function(a){return a instanceof i?!0:a!==null&&typeof a=="object"&&a.constructor.wordSize===i.wordSize&&Array.isArray(a.words)},i.max=function(a,d){return a.cmp(d)>0?a:d},i.min=function(a,d){return a.cmp(d)<0?a:d},i.prototype._init=function(a,d,h){if(typeof a=="number")return this._initNumber(a,d,h);if(typeof a=="object")return this._initArray(a,d,h);d==="hex"&&(d=16),r(d===(d|0)&&d>=2&&d<=36),a=a.toString().replace(/\s+/g,"");var v=0;a[0]==="-"&&(v++,this.negative=1),v<a.length&&(d===16?this._parseHex(a,v,h):(this._parseBase(a,d,v),h==="le"&&this._initArray(this.toArray(),d,h)))},i.prototype._initNumber=function(a,d,h){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[a&67108863],this.length=1):a<4503599627370496?(this.words=[a&67108863,a/67108864&67108863],this.length=2):(r(a<9007199254740992),this.words=[a&67108863,a/67108864&67108863,1],this.length=3),h==="le"&&this._initArray(this.toArray(),d,h)},i.prototype._initArray=function(a,d,h){if(r(typeof a.length=="number"),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var b,w,B=0;if(h==="be")for(v=a.length-1,b=0;v>=0;v-=3)w=a[v]|a[v-1]<<8|a[v-2]<<16,this.words[b]|=w<<B&67108863,this.words[b+1]=w>>>26-B&67108863,B+=24,B>=26&&(B-=26,b++);else if(h==="le")for(v=0,b=0;v<a.length;v+=3)w=a[v]|a[v+1]<<8|a[v+2]<<16,this.words[b]|=w<<B&67108863,this.words[b+1]=w>>>26-B&67108863,B+=24,B>=26&&(B-=26,b++);return this.strip()};function o(_,a){var d=_.charCodeAt(a);return d>=65&&d<=70?d-55:d>=97&&d<=102?d-87:d-48&15}function c(_,a,d){var h=o(_,d);return d-1>=a&&(h|=o(_,d-1)<<4),h}i.prototype._parseHex=function(a,d,h){this.length=Math.ceil((a.length-d)/6),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var b=0,w=0,B;if(h==="be")for(v=a.length-1;v>=d;v-=2)B=c(a,d,v)<<b,this.words[w]|=B&67108863,b>=18?(b-=18,w+=1,this.words[w]|=B>>>26):b+=8;else{var m=a.length-d;for(v=m%2===0?d+1:d;v<a.length;v+=2)B=c(a,d,v)<<b,this.words[w]|=B&67108863,b>=18?(b-=18,w+=1,this.words[w]|=B>>>26):b+=8}this.strip()};function u(_,a,d,h){for(var v=0,b=Math.min(_.length,d),w=a;w<b;w++){var B=_.charCodeAt(w)-48;v*=h,B>=49?v+=B-49+10:B>=17?v+=B-17+10:v+=B}return v}i.prototype._parseBase=function(a,d,h){this.words=[0],this.length=1;for(var v=0,b=1;b<=67108863;b*=d)v++;v--,b=b/d|0;for(var w=a.length-h,B=w%v,m=Math.min(w,w-B)+h,f=0,g=h;g<m;g+=v)f=u(a,g,g+v,d),this.imuln(b),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(B!==0){var R=1;for(f=u(a,g,a.length,d),g=0;g<B;g++)R*=d;this.imuln(R),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},i.prototype.copy=function(a){a.words=new Array(this.length);for(var d=0;d<this.length;d++)a.words[d]=this.words[d];a.length=this.length,a.negative=this.negative,a.red=this.red},i.prototype.clone=function(){var a=new i(null);return this.copy(a),a},i.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],y=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(a,d){a=a||10,d=d|0||1;var h;if(a===16||a==="hex"){h="";for(var v=0,b=0,w=0;w<this.length;w++){var B=this.words[w],m=((B<<v|b)&16777215).toString(16);b=B>>>24-v&16777215,b!==0||w!==this.length-1?h=l[6-m.length]+m+h:h=m+h,v+=2,v>=26&&(v-=26,w--)}for(b!==0&&(h=b.toString(16)+h);h.length%d!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}if(a===(a|0)&&a>=2&&a<=36){var f=y[a],g=p[a];h="";var R=this.clone();for(R.negative=0;!R.isZero();){var K=R.modn(g).toString(a);R=R.idivn(g),R.isZero()?h=K+h:h=l[f-K.length]+K+h}for(this.isZero()&&(h="0"+h);h.length%d!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var a=this.words[0];return this.length===2?a+=this.words[1]*67108864:this.length===3&&this.words[2]===1?a+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-a:a},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(a,d){return r(typeof s<"u"),this.toArrayLike(s,a,d)},i.prototype.toArray=function(a,d){return this.toArrayLike(Array,a,d)},i.prototype.toArrayLike=function(a,d,h){var v=this.byteLength(),b=h||Math.max(1,v);r(v<=b,"byte array longer than desired length"),r(b>0,"Requested array length <= 0"),this.strip();var w=d==="le",B=new a(b),m,f,g=this.clone();if(w){for(f=0;!g.isZero();f++)m=g.andln(255),g.iushrn(8),B[f]=m;for(;f<b;f++)B[f]=0}else{for(f=0;f<b-v;f++)B[f]=0;for(f=0;!g.isZero();f++)m=g.andln(255),g.iushrn(8),B[b-f-1]=m}return B},Math.clz32?i.prototype._countBits=function(a){return 32-Math.clz32(a)}:i.prototype._countBits=function(a){var d=a,h=0;return d>=4096&&(h+=13,d>>>=13),d>=64&&(h+=7,d>>>=7),d>=8&&(h+=4,d>>>=4),d>=2&&(h+=2,d>>>=2),h+d},i.prototype._zeroBits=function(a){if(a===0)return 26;var d=a,h=0;return(d&8191)===0&&(h+=13,d>>>=13),(d&127)===0&&(h+=7,d>>>=7),(d&15)===0&&(h+=4,d>>>=4),(d&3)===0&&(h+=2,d>>>=2),(d&1)===0&&h++,h},i.prototype.bitLength=function(){var a=this.words[this.length-1],d=this._countBits(a);return(this.length-1)*26+d};function S(_){for(var a=new Array(_.bitLength()),d=0;d<a.length;d++){var h=d/26|0,v=d%26;a[d]=(_.words[h]&1<<v)>>>v}return a}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,d=0;d<this.length;d++){var h=this._zeroBits(this.words[d]);if(a+=h,h!==26)break}return a},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(a){return this.negative!==0?this.abs().inotn(a).iaddn(1):this.clone()},i.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var d=0;d<a.length;d++)this.words[d]=this.words[d]|a.words[d];return this.strip()},i.prototype.ior=function(a){return r((this.negative|a.negative)===0),this.iuor(a)},i.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},i.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},i.prototype.iuand=function(a){var d;this.length>a.length?d=a:d=this;for(var h=0;h<d.length;h++)this.words[h]=this.words[h]&a.words[h];return this.length=d.length,this.strip()},i.prototype.iand=function(a){return r((this.negative|a.negative)===0),this.iuand(a)},i.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},i.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},i.prototype.iuxor=function(a){var d,h;this.length>a.length?(d=this,h=a):(d=a,h=this);for(var v=0;v<h.length;v++)this.words[v]=d.words[v]^h.words[v];if(this!==d)for(;v<d.length;v++)this.words[v]=d.words[v];return this.length=d.length,this.strip()},i.prototype.ixor=function(a){return r((this.negative|a.negative)===0),this.iuxor(a)},i.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},i.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},i.prototype.inotn=function(a){r(typeof a=="number"&&a>=0);var d=Math.ceil(a/26)|0,h=a%26;this._expand(d),h>0&&d--;for(var v=0;v<d;v++)this.words[v]=~this.words[v]&67108863;return h>0&&(this.words[v]=~this.words[v]&67108863>>26-h),this.strip()},i.prototype.notn=function(a){return this.clone().inotn(a)},i.prototype.setn=function(a,d){r(typeof a=="number"&&a>=0);var h=a/26|0,v=a%26;return this._expand(h+1),d?this.words[h]=this.words[h]|1<<v:this.words[h]=this.words[h]&~(1<<v),this.strip()},i.prototype.iadd=function(a){var d;if(this.negative!==0&&a.negative===0)return this.negative=0,d=this.isub(a),this.negative^=1,this._normSign();if(this.negative===0&&a.negative!==0)return a.negative=0,d=this.isub(a),a.negative=1,d._normSign();var h,v;this.length>a.length?(h=this,v=a):(h=a,v=this);for(var b=0,w=0;w<v.length;w++)d=(h.words[w]|0)+(v.words[w]|0)+b,this.words[w]=d&67108863,b=d>>>26;for(;b!==0&&w<h.length;w++)d=(h.words[w]|0)+b,this.words[w]=d&67108863,b=d>>>26;if(this.length=h.length,b!==0)this.words[this.length]=b,this.length++;else if(h!==this)for(;w<h.length;w++)this.words[w]=h.words[w];return this},i.prototype.add=function(a){var d;return a.negative!==0&&this.negative===0?(a.negative=0,d=this.sub(a),a.negative^=1,d):a.negative===0&&this.negative!==0?(this.negative=0,d=a.sub(this),this.negative=1,d):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},i.prototype.isub=function(a){if(a.negative!==0){a.negative=0;var d=this.iadd(a);return a.negative=1,d._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var h=this.cmp(a);if(h===0)return this.negative=0,this.length=1,this.words[0]=0,this;var v,b;h>0?(v=this,b=a):(v=a,b=this);for(var w=0,B=0;B<b.length;B++)d=(v.words[B]|0)-(b.words[B]|0)+w,w=d>>26,this.words[B]=d&67108863;for(;w!==0&&B<v.length;B++)d=(v.words[B]|0)+w,w=d>>26,this.words[B]=d&67108863;if(w===0&&B<v.length&&v!==this)for(;B<v.length;B++)this.words[B]=v.words[B];return this.length=Math.max(this.length,B),v!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(a){return this.clone().isub(a)};function M(_,a,d){d.negative=a.negative^_.negative;var h=_.length+a.length|0;d.length=h,h=h-1|0;var v=_.words[0]|0,b=a.words[0]|0,w=v*b,B=w&67108863,m=w/67108864|0;d.words[0]=B;for(var f=1;f<h;f++){for(var g=m>>>26,R=m&67108863,K=Math.min(f,a.length-1),V=Math.max(0,f-_.length+1);V<=K;V++){var F=f-V|0;v=_.words[F]|0,b=a.words[V]|0,w=v*b+R,g+=w/67108864|0,R=w&67108863}d.words[f]=R|0,m=g|0}return m!==0?d.words[f]=m|0:d.length--,d.strip()}var A=function(a,d,h){var v=a.words,b=d.words,w=h.words,B=0,m,f,g,R=v[0]|0,K=R&8191,V=R>>>13,F=v[1]|0,Y=F&8191,re=F>>>13,lt=v[2]|0,fe=lt&8191,ne=lt>>>13,Yt=v[3]|0,ye=Yt&8191,ie=Yt>>>13,Jt=v[4]|0,le=Jt&8191,me=Jt>>>13,Bn=v[5]|0,Se=Bn&8191,Me=Bn>>>13,Hs=v[6]|0,Be=Hs&8191,Ae=Hs>>>13,Ns=v[7]|0,Ie=Ns&8191,Ee=Ns>>>13,Rs=v[8]|0,Pe=Rs&8191,ke=Rs>>>13,Ks=v[9]|0,qe=Ks&8191,Oe=Ks>>>13,Us=b[0]|0,Ce=Us&8191,Le=Us>>>13,js=b[1]|0,Te=js&8191,He=js>>>13,Ds=b[2]|0,Ne=Ds&8191,Re=Ds>>>13,zs=b[3]|0,Ke=zs&8191,Ue=zs>>>13,Vs=b[4]|0,je=Vs&8191,De=Vs>>>13,Fs=b[5]|0,ze=Fs&8191,Ve=Fs>>>13,Zs=b[6]|0,Fe=Zs&8191,Ze=Zs>>>13,Ws=b[7]|0,We=Ws&8191,$e=Ws>>>13,$s=b[8]|0,Ge=$s&8191,Xe=$s>>>13,Gs=b[9]|0,Ye=Gs&8191,Je=Gs>>>13;h.negative=a.negative^d.negative,h.length=19,m=Math.imul(K,Ce),f=Math.imul(K,Le),f=f+Math.imul(V,Ce)|0,g=Math.imul(V,Le);var ra=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ra>>>26)|0,ra&=67108863,m=Math.imul(Y,Ce),f=Math.imul(Y,Le),f=f+Math.imul(re,Ce)|0,g=Math.imul(re,Le),m=m+Math.imul(K,Te)|0,f=f+Math.imul(K,He)|0,f=f+Math.imul(V,Te)|0,g=g+Math.imul(V,He)|0;var na=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(na>>>26)|0,na&=67108863,m=Math.imul(fe,Ce),f=Math.imul(fe,Le),f=f+Math.imul(ne,Ce)|0,g=Math.imul(ne,Le),m=m+Math.imul(Y,Te)|0,f=f+Math.imul(Y,He)|0,f=f+Math.imul(re,Te)|0,g=g+Math.imul(re,He)|0,m=m+Math.imul(K,Ne)|0,f=f+Math.imul(K,Re)|0,f=f+Math.imul(V,Ne)|0,g=g+Math.imul(V,Re)|0;var ia=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ia>>>26)|0,ia&=67108863,m=Math.imul(ye,Ce),f=Math.imul(ye,Le),f=f+Math.imul(ie,Ce)|0,g=Math.imul(ie,Le),m=m+Math.imul(fe,Te)|0,f=f+Math.imul(fe,He)|0,f=f+Math.imul(ne,Te)|0,g=g+Math.imul(ne,He)|0,m=m+Math.imul(Y,Ne)|0,f=f+Math.imul(Y,Re)|0,f=f+Math.imul(re,Ne)|0,g=g+Math.imul(re,Re)|0,m=m+Math.imul(K,Ke)|0,f=f+Math.imul(K,Ue)|0,f=f+Math.imul(V,Ke)|0,g=g+Math.imul(V,Ue)|0;var aa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(aa>>>26)|0,aa&=67108863,m=Math.imul(le,Ce),f=Math.imul(le,Le),f=f+Math.imul(me,Ce)|0,g=Math.imul(me,Le),m=m+Math.imul(ye,Te)|0,f=f+Math.imul(ye,He)|0,f=f+Math.imul(ie,Te)|0,g=g+Math.imul(ie,He)|0,m=m+Math.imul(fe,Ne)|0,f=f+Math.imul(fe,Re)|0,f=f+Math.imul(ne,Ne)|0,g=g+Math.imul(ne,Re)|0,m=m+Math.imul(Y,Ke)|0,f=f+Math.imul(Y,Ue)|0,f=f+Math.imul(re,Ke)|0,g=g+Math.imul(re,Ue)|0,m=m+Math.imul(K,je)|0,f=f+Math.imul(K,De)|0,f=f+Math.imul(V,je)|0,g=g+Math.imul(V,De)|0;var sa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(sa>>>26)|0,sa&=67108863,m=Math.imul(Se,Ce),f=Math.imul(Se,Le),f=f+Math.imul(Me,Ce)|0,g=Math.imul(Me,Le),m=m+Math.imul(le,Te)|0,f=f+Math.imul(le,He)|0,f=f+Math.imul(me,Te)|0,g=g+Math.imul(me,He)|0,m=m+Math.imul(ye,Ne)|0,f=f+Math.imul(ye,Re)|0,f=f+Math.imul(ie,Ne)|0,g=g+Math.imul(ie,Re)|0,m=m+Math.imul(fe,Ke)|0,f=f+Math.imul(fe,Ue)|0,f=f+Math.imul(ne,Ke)|0,g=g+Math.imul(ne,Ue)|0,m=m+Math.imul(Y,je)|0,f=f+Math.imul(Y,De)|0,f=f+Math.imul(re,je)|0,g=g+Math.imul(re,De)|0,m=m+Math.imul(K,ze)|0,f=f+Math.imul(K,Ve)|0,f=f+Math.imul(V,ze)|0,g=g+Math.imul(V,Ve)|0;var fa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(fa>>>26)|0,fa&=67108863,m=Math.imul(Be,Ce),f=Math.imul(Be,Le),f=f+Math.imul(Ae,Ce)|0,g=Math.imul(Ae,Le),m=m+Math.imul(Se,Te)|0,f=f+Math.imul(Se,He)|0,f=f+Math.imul(Me,Te)|0,g=g+Math.imul(Me,He)|0,m=m+Math.imul(le,Ne)|0,f=f+Math.imul(le,Re)|0,f=f+Math.imul(me,Ne)|0,g=g+Math.imul(me,Re)|0,m=m+Math.imul(ye,Ke)|0,f=f+Math.imul(ye,Ue)|0,f=f+Math.imul(ie,Ke)|0,g=g+Math.imul(ie,Ue)|0,m=m+Math.imul(fe,je)|0,f=f+Math.imul(fe,De)|0,f=f+Math.imul(ne,je)|0,g=g+Math.imul(ne,De)|0,m=m+Math.imul(Y,ze)|0,f=f+Math.imul(Y,Ve)|0,f=f+Math.imul(re,ze)|0,g=g+Math.imul(re,Ve)|0,m=m+Math.imul(K,Fe)|0,f=f+Math.imul(K,Ze)|0,f=f+Math.imul(V,Fe)|0,g=g+Math.imul(V,Ze)|0;var oa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(oa>>>26)|0,oa&=67108863,m=Math.imul(Ie,Ce),f=Math.imul(Ie,Le),f=f+Math.imul(Ee,Ce)|0,g=Math.imul(Ee,Le),m=m+Math.imul(Be,Te)|0,f=f+Math.imul(Be,He)|0,f=f+Math.imul(Ae,Te)|0,g=g+Math.imul(Ae,He)|0,m=m+Math.imul(Se,Ne)|0,f=f+Math.imul(Se,Re)|0,f=f+Math.imul(Me,Ne)|0,g=g+Math.imul(Me,Re)|0,m=m+Math.imul(le,Ke)|0,f=f+Math.imul(le,Ue)|0,f=f+Math.imul(me,Ke)|0,g=g+Math.imul(me,Ue)|0,m=m+Math.imul(ye,je)|0,f=f+Math.imul(ye,De)|0,f=f+Math.imul(ie,je)|0,g=g+Math.imul(ie,De)|0,m=m+Math.imul(fe,ze)|0,f=f+Math.imul(fe,Ve)|0,f=f+Math.imul(ne,ze)|0,g=g+Math.imul(ne,Ve)|0,m=m+Math.imul(Y,Fe)|0,f=f+Math.imul(Y,Ze)|0,f=f+Math.imul(re,Fe)|0,g=g+Math.imul(re,Ze)|0,m=m+Math.imul(K,We)|0,f=f+Math.imul(K,$e)|0,f=f+Math.imul(V,We)|0,g=g+Math.imul(V,$e)|0;var ca=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ca>>>26)|0,ca&=67108863,m=Math.imul(Pe,Ce),f=Math.imul(Pe,Le),f=f+Math.imul(ke,Ce)|0,g=Math.imul(ke,Le),m=m+Math.imul(Ie,Te)|0,f=f+Math.imul(Ie,He)|0,f=f+Math.imul(Ee,Te)|0,g=g+Math.imul(Ee,He)|0,m=m+Math.imul(Be,Ne)|0,f=f+Math.imul(Be,Re)|0,f=f+Math.imul(Ae,Ne)|0,g=g+Math.imul(Ae,Re)|0,m=m+Math.imul(Se,Ke)|0,f=f+Math.imul(Se,Ue)|0,f=f+Math.imul(Me,Ke)|0,g=g+Math.imul(Me,Ue)|0,m=m+Math.imul(le,je)|0,f=f+Math.imul(le,De)|0,f=f+Math.imul(me,je)|0,g=g+Math.imul(me,De)|0,m=m+Math.imul(ye,ze)|0,f=f+Math.imul(ye,Ve)|0,f=f+Math.imul(ie,ze)|0,g=g+Math.imul(ie,Ve)|0,m=m+Math.imul(fe,Fe)|0,f=f+Math.imul(fe,Ze)|0,f=f+Math.imul(ne,Fe)|0,g=g+Math.imul(ne,Ze)|0,m=m+Math.imul(Y,We)|0,f=f+Math.imul(Y,$e)|0,f=f+Math.imul(re,We)|0,g=g+Math.imul(re,$e)|0,m=m+Math.imul(K,Ge)|0,f=f+Math.imul(K,Xe)|0,f=f+Math.imul(V,Ge)|0,g=g+Math.imul(V,Xe)|0;var da=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(da>>>26)|0,da&=67108863,m=Math.imul(qe,Ce),f=Math.imul(qe,Le),f=f+Math.imul(Oe,Ce)|0,g=Math.imul(Oe,Le),m=m+Math.imul(Pe,Te)|0,f=f+Math.imul(Pe,He)|0,f=f+Math.imul(ke,Te)|0,g=g+Math.imul(ke,He)|0,m=m+Math.imul(Ie,Ne)|0,f=f+Math.imul(Ie,Re)|0,f=f+Math.imul(Ee,Ne)|0,g=g+Math.imul(Ee,Re)|0,m=m+Math.imul(Be,Ke)|0,f=f+Math.imul(Be,Ue)|0,f=f+Math.imul(Ae,Ke)|0,g=g+Math.imul(Ae,Ue)|0,m=m+Math.imul(Se,je)|0,f=f+Math.imul(Se,De)|0,f=f+Math.imul(Me,je)|0,g=g+Math.imul(Me,De)|0,m=m+Math.imul(le,ze)|0,f=f+Math.imul(le,Ve)|0,f=f+Math.imul(me,ze)|0,g=g+Math.imul(me,Ve)|0,m=m+Math.imul(ye,Fe)|0,f=f+Math.imul(ye,Ze)|0,f=f+Math.imul(ie,Fe)|0,g=g+Math.imul(ie,Ze)|0,m=m+Math.imul(fe,We)|0,f=f+Math.imul(fe,$e)|0,f=f+Math.imul(ne,We)|0,g=g+Math.imul(ne,$e)|0,m=m+Math.imul(Y,Ge)|0,f=f+Math.imul(Y,Xe)|0,f=f+Math.imul(re,Ge)|0,g=g+Math.imul(re,Xe)|0,m=m+Math.imul(K,Ye)|0,f=f+Math.imul(K,Je)|0,f=f+Math.imul(V,Ye)|0,g=g+Math.imul(V,Je)|0;var ua=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ua>>>26)|0,ua&=67108863,m=Math.imul(qe,Te),f=Math.imul(qe,He),f=f+Math.imul(Oe,Te)|0,g=Math.imul(Oe,He),m=m+Math.imul(Pe,Ne)|0,f=f+Math.imul(Pe,Re)|0,f=f+Math.imul(ke,Ne)|0,g=g+Math.imul(ke,Re)|0,m=m+Math.imul(Ie,Ke)|0,f=f+Math.imul(Ie,Ue)|0,f=f+Math.imul(Ee,Ke)|0,g=g+Math.imul(Ee,Ue)|0,m=m+Math.imul(Be,je)|0,f=f+Math.imul(Be,De)|0,f=f+Math.imul(Ae,je)|0,g=g+Math.imul(Ae,De)|0,m=m+Math.imul(Se,ze)|0,f=f+Math.imul(Se,Ve)|0,f=f+Math.imul(Me,ze)|0,g=g+Math.imul(Me,Ve)|0,m=m+Math.imul(le,Fe)|0,f=f+Math.imul(le,Ze)|0,f=f+Math.imul(me,Fe)|0,g=g+Math.imul(me,Ze)|0,m=m+Math.imul(ye,We)|0,f=f+Math.imul(ye,$e)|0,f=f+Math.imul(ie,We)|0,g=g+Math.imul(ie,$e)|0,m=m+Math.imul(fe,Ge)|0,f=f+Math.imul(fe,Xe)|0,f=f+Math.imul(ne,Ge)|0,g=g+Math.imul(ne,Xe)|0,m=m+Math.imul(Y,Ye)|0,f=f+Math.imul(Y,Je)|0,f=f+Math.imul(re,Ye)|0,g=g+Math.imul(re,Je)|0;var la=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(la>>>26)|0,la&=67108863,m=Math.imul(qe,Ne),f=Math.imul(qe,Re),f=f+Math.imul(Oe,Ne)|0,g=Math.imul(Oe,Re),m=m+Math.imul(Pe,Ke)|0,f=f+Math.imul(Pe,Ue)|0,f=f+Math.imul(ke,Ke)|0,g=g+Math.imul(ke,Ue)|0,m=m+Math.imul(Ie,je)|0,f=f+Math.imul(Ie,De)|0,f=f+Math.imul(Ee,je)|0,g=g+Math.imul(Ee,De)|0,m=m+Math.imul(Be,ze)|0,f=f+Math.imul(Be,Ve)|0,f=f+Math.imul(Ae,ze)|0,g=g+Math.imul(Ae,Ve)|0,m=m+Math.imul(Se,Fe)|0,f=f+Math.imul(Se,Ze)|0,f=f+Math.imul(Me,Fe)|0,g=g+Math.imul(Me,Ze)|0,m=m+Math.imul(le,We)|0,f=f+Math.imul(le,$e)|0,f=f+Math.imul(me,We)|0,g=g+Math.imul(me,$e)|0,m=m+Math.imul(ye,Ge)|0,f=f+Math.imul(ye,Xe)|0,f=f+Math.imul(ie,Ge)|0,g=g+Math.imul(ie,Xe)|0,m=m+Math.imul(fe,Ye)|0,f=f+Math.imul(fe,Je)|0,f=f+Math.imul(ne,Ye)|0,g=g+Math.imul(ne,Je)|0;var ha=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ha>>>26)|0,ha&=67108863,m=Math.imul(qe,Ke),f=Math.imul(qe,Ue),f=f+Math.imul(Oe,Ke)|0,g=Math.imul(Oe,Ue),m=m+Math.imul(Pe,je)|0,f=f+Math.imul(Pe,De)|0,f=f+Math.imul(ke,je)|0,g=g+Math.imul(ke,De)|0,m=m+Math.imul(Ie,ze)|0,f=f+Math.imul(Ie,Ve)|0,f=f+Math.imul(Ee,ze)|0,g=g+Math.imul(Ee,Ve)|0,m=m+Math.imul(Be,Fe)|0,f=f+Math.imul(Be,Ze)|0,f=f+Math.imul(Ae,Fe)|0,g=g+Math.imul(Ae,Ze)|0,m=m+Math.imul(Se,We)|0,f=f+Math.imul(Se,$e)|0,f=f+Math.imul(Me,We)|0,g=g+Math.imul(Me,$e)|0,m=m+Math.imul(le,Ge)|0,f=f+Math.imul(le,Xe)|0,f=f+Math.imul(me,Ge)|0,g=g+Math.imul(me,Xe)|0,m=m+Math.imul(ye,Ye)|0,f=f+Math.imul(ye,Je)|0,f=f+Math.imul(ie,Ye)|0,g=g+Math.imul(ie,Je)|0;var ba=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ba>>>26)|0,ba&=67108863,m=Math.imul(qe,je),f=Math.imul(qe,De),f=f+Math.imul(Oe,je)|0,g=Math.imul(Oe,De),m=m+Math.imul(Pe,ze)|0,f=f+Math.imul(Pe,Ve)|0,f=f+Math.imul(ke,ze)|0,g=g+Math.imul(ke,Ve)|0,m=m+Math.imul(Ie,Fe)|0,f=f+Math.imul(Ie,Ze)|0,f=f+Math.imul(Ee,Fe)|0,g=g+Math.imul(Ee,Ze)|0,m=m+Math.imul(Be,We)|0,f=f+Math.imul(Be,$e)|0,f=f+Math.imul(Ae,We)|0,g=g+Math.imul(Ae,$e)|0,m=m+Math.imul(Se,Ge)|0,f=f+Math.imul(Se,Xe)|0,f=f+Math.imul(Me,Ge)|0,g=g+Math.imul(Me,Xe)|0,m=m+Math.imul(le,Ye)|0,f=f+Math.imul(le,Je)|0,f=f+Math.imul(me,Ye)|0,g=g+Math.imul(me,Je)|0;var pa=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(pa>>>26)|0,pa&=67108863,m=Math.imul(qe,ze),f=Math.imul(qe,Ve),f=f+Math.imul(Oe,ze)|0,g=Math.imul(Oe,Ve),m=m+Math.imul(Pe,Fe)|0,f=f+Math.imul(Pe,Ze)|0,f=f+Math.imul(ke,Fe)|0,g=g+Math.imul(ke,Ze)|0,m=m+Math.imul(Ie,We)|0,f=f+Math.imul(Ie,$e)|0,f=f+Math.imul(Ee,We)|0,g=g+Math.imul(Ee,$e)|0,m=m+Math.imul(Be,Ge)|0,f=f+Math.imul(Be,Xe)|0,f=f+Math.imul(Ae,Ge)|0,g=g+Math.imul(Ae,Xe)|0,m=m+Math.imul(Se,Ye)|0,f=f+Math.imul(Se,Je)|0,f=f+Math.imul(Me,Ye)|0,g=g+Math.imul(Me,Je)|0;var va=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(va>>>26)|0,va&=67108863,m=Math.imul(qe,Fe),f=Math.imul(qe,Ze),f=f+Math.imul(Oe,Fe)|0,g=Math.imul(Oe,Ze),m=m+Math.imul(Pe,We)|0,f=f+Math.imul(Pe,$e)|0,f=f+Math.imul(ke,We)|0,g=g+Math.imul(ke,$e)|0,m=m+Math.imul(Ie,Ge)|0,f=f+Math.imul(Ie,Xe)|0,f=f+Math.imul(Ee,Ge)|0,g=g+Math.imul(Ee,Xe)|0,m=m+Math.imul(Be,Ye)|0,f=f+Math.imul(Be,Je)|0,f=f+Math.imul(Ae,Ye)|0,g=g+Math.imul(Ae,Je)|0;var ya=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ya>>>26)|0,ya&=67108863,m=Math.imul(qe,We),f=Math.imul(qe,$e),f=f+Math.imul(Oe,We)|0,g=Math.imul(Oe,$e),m=m+Math.imul(Pe,Ge)|0,f=f+Math.imul(Pe,Xe)|0,f=f+Math.imul(ke,Ge)|0,g=g+Math.imul(ke,Xe)|0,m=m+Math.imul(Ie,Ye)|0,f=f+Math.imul(Ie,Je)|0,f=f+Math.imul(Ee,Ye)|0,g=g+Math.imul(Ee,Je)|0;var ma=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ma>>>26)|0,ma&=67108863,m=Math.imul(qe,Ge),f=Math.imul(qe,Xe),f=f+Math.imul(Oe,Ge)|0,g=Math.imul(Oe,Xe),m=m+Math.imul(Pe,Ye)|0,f=f+Math.imul(Pe,Je)|0,f=f+Math.imul(ke,Ye)|0,g=g+Math.imul(ke,Je)|0;var ga=(B+m|0)+((f&8191)<<13)|0;B=(g+(f>>>13)|0)+(ga>>>26)|0,ga&=67108863,m=Math.imul(qe,Ye),f=Math.imul(qe,Je),f=f+Math.imul(Oe,Ye)|0,g=Math.imul(Oe,Je);var wa=(B+m|0)+((f&8191)<<13)|0;return B=(g+(f>>>13)|0)+(wa>>>26)|0,wa&=67108863,w[0]=ra,w[1]=na,w[2]=ia,w[3]=aa,w[4]=sa,w[5]=fa,w[6]=oa,w[7]=ca,w[8]=da,w[9]=ua,w[10]=la,w[11]=ha,w[12]=ba,w[13]=pa,w[14]=va,w[15]=ya,w[16]=ma,w[17]=ga,w[18]=wa,B!==0&&(w[19]=B,h.length++),h};Math.imul||(A=M);function x(_,a,d){d.negative=a.negative^_.negative,d.length=_.length+a.length;for(var h=0,v=0,b=0;b<d.length-1;b++){var w=v;v=0;for(var B=h&67108863,m=Math.min(b,a.length-1),f=Math.max(0,b-_.length+1);f<=m;f++){var g=b-f,R=_.words[g]|0,K=a.words[f]|0,V=R*K,F=V&67108863;w=w+(V/67108864|0)|0,F=F+B|0,B=F&67108863,w=w+(F>>>26)|0,v+=w>>>26,w&=67108863}d.words[b]=B,h=w,w=v}return h!==0?d.words[b]=h:d.length--,d.strip()}function E(_,a,d){var h=new I;return h.mulp(_,a,d)}i.prototype.mulTo=function(a,d){var h,v=this.length+a.length;return this.length===10&&a.length===10?h=A(this,a,d):v<63?h=M(this,a,d):v<1024?h=x(this,a,d):h=E(this,a,d),h};function I(_,a){this.x=_,this.y=a}I.prototype.makeRBT=function(a){for(var d=new Array(a),h=i.prototype._countBits(a)-1,v=0;v<a;v++)d[v]=this.revBin(v,h,a);return d},I.prototype.revBin=function(a,d,h){if(a===0||a===h-1)return a;for(var v=0,b=0;b<d;b++)v|=(a&1)<<d-b-1,a>>=1;return v},I.prototype.permute=function(a,d,h,v,b,w){for(var B=0;B<w;B++)v[B]=d[a[B]],b[B]=h[a[B]]},I.prototype.transform=function(a,d,h,v,b,w){this.permute(w,a,d,h,v,b);for(var B=1;B<b;B<<=1)for(var m=B<<1,f=Math.cos(2*Math.PI/m),g=Math.sin(2*Math.PI/m),R=0;R<b;R+=m)for(var K=f,V=g,F=0;F<B;F++){var Y=h[R+F],re=v[R+F],lt=h[R+F+B],fe=v[R+F+B],ne=K*lt-V*fe;fe=K*fe+V*lt,lt=ne,h[R+F]=Y+lt,v[R+F]=re+fe,h[R+F+B]=Y-lt,v[R+F+B]=re-fe,F!==m&&(ne=f*K-g*V,V=f*V+g*K,K=ne)}},I.prototype.guessLen13b=function(a,d){var h=Math.max(d,a)|1,v=h&1,b=0;for(h=h/2|0;h;h=h>>>1)b++;return 1<<b+1+v},I.prototype.conjugate=function(a,d,h){if(!(h<=1))for(var v=0;v<h/2;v++){var b=a[v];a[v]=a[h-v-1],a[h-v-1]=b,b=d[v],d[v]=-d[h-v-1],d[h-v-1]=-b}},I.prototype.normalize13b=function(a,d){for(var h=0,v=0;v<d/2;v++){var b=Math.round(a[2*v+1]/d)*8192+Math.round(a[2*v]/d)+h;a[v]=b&67108863,b<67108864?h=0:h=b/67108864|0}return a},I.prototype.convert13b=function(a,d,h,v){for(var b=0,w=0;w<d;w++)b=b+(a[w]|0),h[2*w]=b&8191,b=b>>>13,h[2*w+1]=b&8191,b=b>>>13;for(w=2*d;w<v;++w)h[w]=0;r(b===0),r((b&-8192)===0)},I.prototype.stub=function(a){for(var d=new Array(a),h=0;h<a;h++)d[h]=0;return d},I.prototype.mulp=function(a,d,h){var v=2*this.guessLen13b(a.length,d.length),b=this.makeRBT(v),w=this.stub(v),B=new Array(v),m=new Array(v),f=new Array(v),g=new Array(v),R=new Array(v),K=new Array(v),V=h.words;V.length=v,this.convert13b(a.words,a.length,B,v),this.convert13b(d.words,d.length,g,v),this.transform(B,w,m,f,v,b),this.transform(g,w,R,K,v,b);for(var F=0;F<v;F++){var Y=m[F]*R[F]-f[F]*K[F];f[F]=m[F]*K[F]+f[F]*R[F],m[F]=Y}return this.conjugate(m,f,v),this.transform(m,f,V,w,v,b),this.conjugate(V,w,v),this.normalize13b(V,v),h.negative=a.negative^d.negative,h.length=a.length+d.length,h.strip()},i.prototype.mul=function(a){var d=new i(null);return d.words=new Array(this.length+a.length),this.mulTo(a,d)},i.prototype.mulf=function(a){var d=new i(null);return d.words=new Array(this.length+a.length),E(this,a,d)},i.prototype.imul=function(a){return this.clone().mulTo(a,this)},i.prototype.imuln=function(a){r(typeof a=="number"),r(a<67108864);for(var d=0,h=0;h<this.length;h++){var v=(this.words[h]|0)*a,b=(v&67108863)+(d&67108863);d>>=26,d+=v/67108864|0,d+=b>>>26,this.words[h]=b&67108863}return d!==0&&(this.words[h]=d,this.length++),this},i.prototype.muln=function(a){return this.clone().imuln(a)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(a){var d=S(a);if(d.length===0)return new i(1);for(var h=this,v=0;v<d.length&&d[v]===0;v++,h=h.sqr());if(++v<d.length)for(var b=h.sqr();v<d.length;v++,b=b.sqr())d[v]!==0&&(h=h.mul(b));return h},i.prototype.iushln=function(a){r(typeof a=="number"&&a>=0);var d=a%26,h=(a-d)/26,v=67108863>>>26-d<<26-d,b;if(d!==0){var w=0;for(b=0;b<this.length;b++){var B=this.words[b]&v,m=(this.words[b]|0)-B<<d;this.words[b]=m|w,w=B>>>26-d}w&&(this.words[b]=w,this.length++)}if(h!==0){for(b=this.length-1;b>=0;b--)this.words[b+h]=this.words[b];for(b=0;b<h;b++)this.words[b]=0;this.length+=h}return this.strip()},i.prototype.ishln=function(a){return r(this.negative===0),this.iushln(a)},i.prototype.iushrn=function(a,d,h){r(typeof a=="number"&&a>=0);var v;d?v=(d-d%26)/26:v=0;var b=a%26,w=Math.min((a-b)/26,this.length),B=67108863^67108863>>>b<<b,m=h;if(v-=w,v=Math.max(0,v),m){for(var f=0;f<w;f++)m.words[f]=this.words[f];m.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var g=0;for(f=this.length-1;f>=0&&(g!==0||f>=v);f--){var R=this.words[f]|0;this.words[f]=g<<26-b|R>>>b,g=R&B}return m&&g!==0&&(m.words[m.length++]=g),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(a,d,h){return r(this.negative===0),this.iushrn(a,d,h)},i.prototype.shln=function(a){return this.clone().ishln(a)},i.prototype.ushln=function(a){return this.clone().iushln(a)},i.prototype.shrn=function(a){return this.clone().ishrn(a)},i.prototype.ushrn=function(a){return this.clone().iushrn(a)},i.prototype.testn=function(a){r(typeof a=="number"&&a>=0);var d=a%26,h=(a-d)/26,v=1<<d;if(this.length<=h)return!1;var b=this.words[h];return!!(b&v)},i.prototype.imaskn=function(a){r(typeof a=="number"&&a>=0);var d=a%26,h=(a-d)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=h)return this;if(d!==0&&h++,this.length=Math.min(h,this.length),d!==0){var v=67108863^67108863>>>d<<d;this.words[this.length-1]&=v}return this.strip()},i.prototype.maskn=function(a){return this.clone().imaskn(a)},i.prototype.iaddn=function(a){return r(typeof a=="number"),r(a<67108864),a<0?this.isubn(-a):this.negative!==0?this.length===1&&(this.words[0]|0)<a?(this.words[0]=a-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},i.prototype._iaddn=function(a){this.words[0]+=a;for(var d=0;d<this.length&&this.words[d]>=67108864;d++)this.words[d]-=67108864,d===this.length-1?this.words[d+1]=1:this.words[d+1]++;return this.length=Math.max(this.length,d+1),this},i.prototype.isubn=function(a){if(r(typeof a=="number"),r(a<67108864),a<0)return this.iaddn(-a);if(this.negative!==0)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var d=0;d<this.length&&this.words[d]<0;d++)this.words[d]+=67108864,this.words[d+1]-=1;return this.strip()},i.prototype.addn=function(a){return this.clone().iaddn(a)},i.prototype.subn=function(a){return this.clone().isubn(a)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(a,d,h){var v=a.length+h,b;this._expand(v);var w,B=0;for(b=0;b<a.length;b++){w=(this.words[b+h]|0)+B;var m=(a.words[b]|0)*d;w-=m&67108863,B=(w>>26)-(m/67108864|0),this.words[b+h]=w&67108863}for(;b<this.length-h;b++)w=(this.words[b+h]|0)+B,B=w>>26,this.words[b+h]=w&67108863;if(B===0)return this.strip();for(r(B===-1),B=0,b=0;b<this.length;b++)w=-(this.words[b]|0)+B,B=w>>26,this.words[b]=w&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(a,d){var h=this.length-a.length,v=this.clone(),b=a,w=b.words[b.length-1]|0,B=this._countBits(w);h=26-B,h!==0&&(b=b.ushln(h),v.iushln(h),w=b.words[b.length-1]|0);var m=v.length-b.length,f;if(d!=="mod"){f=new i(null),f.length=m+1,f.words=new Array(f.length);for(var g=0;g<f.length;g++)f.words[g]=0}var R=v.clone()._ishlnsubmul(b,1,m);R.negative===0&&(v=R,f&&(f.words[m]=1));for(var K=m-1;K>=0;K--){var V=(v.words[b.length+K]|0)*67108864+(v.words[b.length+K-1]|0);for(V=Math.min(V/w|0,67108863),v._ishlnsubmul(b,V,K);v.negative!==0;)V--,v.negative=0,v._ishlnsubmul(b,1,K),v.isZero()||(v.negative^=1);f&&(f.words[K]=V)}return f&&f.strip(),v.strip(),d!=="div"&&h!==0&&v.iushrn(h),{div:f||null,mod:v}},i.prototype.divmod=function(a,d,h){if(r(!a.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var v,b,w;return this.negative!==0&&a.negative===0?(w=this.neg().divmod(a,d),d!=="mod"&&(v=w.div.neg()),d!=="div"&&(b=w.mod.neg(),h&&b.negative!==0&&b.iadd(a)),{div:v,mod:b}):this.negative===0&&a.negative!==0?(w=this.divmod(a.neg(),d),d!=="mod"&&(v=w.div.neg()),{div:v,mod:w.mod}):(this.negative&a.negative)!==0?(w=this.neg().divmod(a.neg(),d),d!=="div"&&(b=w.mod.neg(),h&&b.negative!==0&&b.isub(a)),{div:w.div,mod:b}):a.length>this.length||this.cmp(a)<0?{div:new i(0),mod:this}:a.length===1?d==="div"?{div:this.divn(a.words[0]),mod:null}:d==="mod"?{div:null,mod:new i(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new i(this.modn(a.words[0]))}:this._wordDiv(a,d)},i.prototype.div=function(a){return this.divmod(a,"div",!1).div},i.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},i.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},i.prototype.divRound=function(a){var d=this.divmod(a);if(d.mod.isZero())return d.div;var h=d.div.negative!==0?d.mod.isub(a):d.mod,v=a.ushrn(1),b=a.andln(1),w=h.cmp(v);return w<0||b===1&&w===0?d.div:d.div.negative!==0?d.div.isubn(1):d.div.iaddn(1)},i.prototype.modn=function(a){r(a<=67108863);for(var d=(1<<26)%a,h=0,v=this.length-1;v>=0;v--)h=(d*h+(this.words[v]|0))%a;return h},i.prototype.idivn=function(a){r(a<=67108863);for(var d=0,h=this.length-1;h>=0;h--){var v=(this.words[h]|0)+d*67108864;this.words[h]=v/a|0,d=v%a}return this.strip()},i.prototype.divn=function(a){return this.clone().idivn(a)},i.prototype.egcd=function(a){r(a.negative===0),r(!a.isZero());var d=this,h=a.clone();d.negative!==0?d=d.umod(a):d=d.clone();for(var v=new i(1),b=new i(0),w=new i(0),B=new i(1),m=0;d.isEven()&&h.isEven();)d.iushrn(1),h.iushrn(1),++m;for(var f=h.clone(),g=d.clone();!d.isZero();){for(var R=0,K=1;(d.words[0]&K)===0&&R<26;++R,K<<=1);if(R>0)for(d.iushrn(R);R-- >0;)(v.isOdd()||b.isOdd())&&(v.iadd(f),b.isub(g)),v.iushrn(1),b.iushrn(1);for(var V=0,F=1;(h.words[0]&F)===0&&V<26;++V,F<<=1);if(V>0)for(h.iushrn(V);V-- >0;)(w.isOdd()||B.isOdd())&&(w.iadd(f),B.isub(g)),w.iushrn(1),B.iushrn(1);d.cmp(h)>=0?(d.isub(h),v.isub(w),b.isub(B)):(h.isub(d),w.isub(v),B.isub(b))}return{a:w,b:B,gcd:h.iushln(m)}},i.prototype._invmp=function(a){r(a.negative===0),r(!a.isZero());var d=this,h=a.clone();d.negative!==0?d=d.umod(a):d=d.clone();for(var v=new i(1),b=new i(0),w=h.clone();d.cmpn(1)>0&&h.cmpn(1)>0;){for(var B=0,m=1;(d.words[0]&m)===0&&B<26;++B,m<<=1);if(B>0)for(d.iushrn(B);B-- >0;)v.isOdd()&&v.iadd(w),v.iushrn(1);for(var f=0,g=1;(h.words[0]&g)===0&&f<26;++f,g<<=1);if(f>0)for(h.iushrn(f);f-- >0;)b.isOdd()&&b.iadd(w),b.iushrn(1);d.cmp(h)>=0?(d.isub(h),v.isub(b)):(h.isub(d),b.isub(v))}var R;return d.cmpn(1)===0?R=v:R=b,R.cmpn(0)<0&&R.iadd(a),R},i.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var d=this.clone(),h=a.clone();d.negative=0,h.negative=0;for(var v=0;d.isEven()&&h.isEven();v++)d.iushrn(1),h.iushrn(1);do{for(;d.isEven();)d.iushrn(1);for(;h.isEven();)h.iushrn(1);var b=d.cmp(h);if(b<0){var w=d;d=h,h=w}else if(b===0||h.cmpn(1)===0)break;d.isub(h)}while(!0);return h.iushln(v)},i.prototype.invm=function(a){return this.egcd(a).a.umod(a)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(a){return this.words[0]&a},i.prototype.bincn=function(a){r(typeof a=="number");var d=a%26,h=(a-d)/26,v=1<<d;if(this.length<=h)return this._expand(h+1),this.words[h]|=v,this;for(var b=v,w=h;b!==0&&w<this.length;w++){var B=this.words[w]|0;B+=b,b=B>>>26,B&=67108863,this.words[w]=B}return b!==0&&(this.words[w]=b,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(a){var d=a<0;if(this.negative!==0&&!d)return-1;if(this.negative===0&&d)return 1;this.strip();var h;if(this.length>1)h=1;else{d&&(a=-a),r(a<=67108863,"Number is too big");var v=this.words[0]|0;h=v===a?0:v<a?-1:1}return this.negative!==0?-h|0:h},i.prototype.cmp=function(a){if(this.negative!==0&&a.negative===0)return-1;if(this.negative===0&&a.negative!==0)return 1;var d=this.ucmp(a);return this.negative!==0?-d|0:d},i.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var d=0,h=this.length-1;h>=0;h--){var v=this.words[h]|0,b=a.words[h]|0;if(v!==b){v<b?d=-1:v>b&&(d=1);break}}return d},i.prototype.gtn=function(a){return this.cmpn(a)===1},i.prototype.gt=function(a){return this.cmp(a)===1},i.prototype.gten=function(a){return this.cmpn(a)>=0},i.prototype.gte=function(a){return this.cmp(a)>=0},i.prototype.ltn=function(a){return this.cmpn(a)===-1},i.prototype.lt=function(a){return this.cmp(a)===-1},i.prototype.lten=function(a){return this.cmpn(a)<=0},i.prototype.lte=function(a){return this.cmp(a)<=0},i.prototype.eqn=function(a){return this.cmpn(a)===0},i.prototype.eq=function(a){return this.cmp(a)===0},i.red=function(a){return new H(a)},i.prototype.toRed=function(a){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),a.convertTo(this)._forceRed(a)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(a){return this.red=a,this},i.prototype.forceRed=function(a){return r(!this.red,"Already a number in reduction context"),this._forceRed(a)},i.prototype.redAdd=function(a){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},i.prototype.redIAdd=function(a){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},i.prototype.redSub=function(a){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},i.prototype.redISub=function(a){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},i.prototype.redShl=function(a){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},i.prototype.redMul=function(a){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},i.prototype.redIMul=function(a){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(a){return r(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var C={k256:null,p224:null,p192:null,p25519:null};function O(_,a){this.name=_,this.p=new i(a,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}O.prototype._tmp=function(){var a=new i(null);return a.words=new Array(Math.ceil(this.n/13)),a},O.prototype.ireduce=function(a){var d=a,h;do this.split(d,this.tmp),d=this.imulK(d),d=d.iadd(this.tmp),h=d.bitLength();while(h>this.n);var v=h<this.n?-1:d.ucmp(this.p);return v===0?(d.words[0]=0,d.length=1):v>0?d.isub(this.p):d.strip!==void 0?d.strip():d._strip(),d},O.prototype.split=function(a,d){a.iushrn(this.n,0,d)},O.prototype.imulK=function(a){return a.imul(this.k)};function L(){O.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(L,O),L.prototype.split=function(a,d){for(var h=4194303,v=Math.min(a.length,9),b=0;b<v;b++)d.words[b]=a.words[b];if(d.length=v,a.length<=9){a.words[0]=0,a.length=1;return}var w=a.words[9];for(d.words[d.length++]=w&h,b=10;b<a.length;b++){var B=a.words[b]|0;a.words[b-10]=(B&h)<<4|w>>>22,w=B}w>>>=22,a.words[b-10]=w,w===0&&a.length>10?a.length-=10:a.length-=9},L.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var d=0,h=0;h<a.length;h++){var v=a.words[h]|0;d+=v*977,a.words[h]=d&67108863,d=v*64+(d/67108864|0)}return a.words[a.length-1]===0&&(a.length--,a.words[a.length-1]===0&&a.length--),a};function T(){O.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(T,O);function N(){O.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(N,O);function U(){O.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(U,O),U.prototype.imulK=function(a){for(var d=0,h=0;h<a.length;h++){var v=(a.words[h]|0)*19+d,b=v&67108863;v>>>=26,a.words[h]=b,d=v}return d!==0&&(a.words[a.length++]=d),a},i._prime=function(a){if(C[a])return C[a];var d;if(a==="k256")d=new L;else if(a==="p224")d=new T;else if(a==="p192")d=new N;else if(a==="p25519")d=new U;else throw new Error("Unknown prime "+a);return C[a]=d,d};function H(_){if(typeof _=="string"){var a=i._prime(_);this.m=a.p,this.prime=a}else r(_.gtn(1),"modulus must be greater than 1"),this.m=_,this.prime=null}H.prototype._verify1=function(a){r(a.negative===0,"red works only with positives"),r(a.red,"red works only with red numbers")},H.prototype._verify2=function(a,d){r((a.negative|d.negative)===0,"red works only with positives"),r(a.red&&a.red===d.red,"red works only with red numbers")},H.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},H.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},H.prototype.add=function(a,d){this._verify2(a,d);var h=a.add(d);return h.cmp(this.m)>=0&&h.isub(this.m),h._forceRed(this)},H.prototype.iadd=function(a,d){this._verify2(a,d);var h=a.iadd(d);return h.cmp(this.m)>=0&&h.isub(this.m),h},H.prototype.sub=function(a,d){this._verify2(a,d);var h=a.sub(d);return h.cmpn(0)<0&&h.iadd(this.m),h._forceRed(this)},H.prototype.isub=function(a,d){this._verify2(a,d);var h=a.isub(d);return h.cmpn(0)<0&&h.iadd(this.m),h},H.prototype.shl=function(a,d){return this._verify1(a),this.imod(a.ushln(d))},H.prototype.imul=function(a,d){return this._verify2(a,d),this.imod(a.imul(d))},H.prototype.mul=function(a,d){return this._verify2(a,d),this.imod(a.mul(d))},H.prototype.isqr=function(a){return this.imul(a,a.clone())},H.prototype.sqr=function(a){return this.mul(a,a)},H.prototype.sqrt=function(a){if(a.isZero())return a.clone();var d=this.m.andln(3);if(r(d%2===1),d===3){var h=this.m.add(new i(1)).iushrn(2);return this.pow(a,h)}for(var v=this.m.subn(1),b=0;!v.isZero()&&v.andln(1)===0;)b++,v.iushrn(1);r(!v.isZero());var w=new i(1).toRed(this),B=w.redNeg(),m=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new i(2*f*f).toRed(this);this.pow(f,m).cmp(B)!==0;)f.redIAdd(B);for(var g=this.pow(f,v),R=this.pow(a,v.addn(1).iushrn(1)),K=this.pow(a,v),V=b;K.cmp(w)!==0;){for(var F=K,Y=0;F.cmp(w)!==0;Y++)F=F.redSqr();r(Y<V);var re=this.pow(g,new i(1).iushln(V-Y-1));R=R.redMul(re),g=re.redSqr(),K=K.redMul(g),V=Y}return R},H.prototype.invm=function(a){var d=a._invmp(this.m);return d.negative!==0?(d.negative=0,this.imod(d).redNeg()):this.imod(d)},H.prototype.pow=function(a,d){if(d.isZero())return new i(1).toRed(this);if(d.cmpn(1)===0)return a.clone();var h=4,v=new Array(1<<h);v[0]=new i(1).toRed(this),v[1]=a;for(var b=2;b<v.length;b++)v[b]=this.mul(v[b-1],a);var w=v[0],B=0,m=0,f=d.bitLength()%26;for(f===0&&(f=26),b=d.length-1;b>=0;b--){for(var g=d.words[b],R=f-1;R>=0;R--){var K=g>>R&1;if(w!==v[0]&&(w=this.sqr(w)),K===0&&B===0){m=0;continue}B<<=1,B|=K,m++,!(m!==h&&(b!==0||R!==0))&&(w=this.mul(w,v[B]),m=0,B=0)}f=26}return w},H.prototype.convertTo=function(a){var d=a.umod(this.m);return d===a?d.clone():d},H.prototype.convertFrom=function(a){var d=a.clone();return d.red=null,d},i.mont=function(a){return new Z(a)};function Z(_){H.call(this,_),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(Z,H),Z.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},Z.prototype.convertFrom=function(a){var d=this.imod(a.mul(this.rinv));return d.red=null,d},Z.prototype.imul=function(a,d){if(a.isZero()||d.isZero())return a.words[0]=0,a.length=1,a;var h=a.imul(d),v=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=h.isub(v).iushrn(this.shift),w=b;return b.cmp(this.m)>=0?w=b.isub(this.m):b.cmpn(0)<0&&(w=b.iadd(this.m)),w._forceRed(this)},Z.prototype.mul=function(a,d){if(a.isZero()||d.isZero())return new i(0)._forceRed(this);var h=a.mul(d),v=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=h.isub(v).iushrn(this.shift),w=b;return b.cmp(this.m)>=0?w=b.isub(this.m):b.cmpn(0)<0&&(w=b.iadd(this.m)),w._forceRed(this)},Z.prototype.invm=function(a){var d=this.imod(a._invmp(this.m).mul(this.r2));return d._forceRed(this)}})(typeof Ua>"u"||Ua,fo)});var qt=D(oo=>{k();q();var jt=oo,Lu=Et(),Tu=td(),bi=rd();jt.assert=Tu;jt.toArray=bi.toArray;jt.zero2=bi.zero2;jt.toHex=bi.toHex;jt.encode=bi.encode;function Hu(t,e,r){var n=new Array(Math.max(t.bitLength(),r)+1);n.fill(0);for(var i=1<<e+1,s=t.clone(),o=0;o<n.length;o++){var c,u=s.andln(i-1);s.isOdd()?(u>(i>>1)-1?c=(i>>1)-u:c=u,s.isubn(c)):c=0,n[o]=c,s.iushrn(1)}return n}jt.getNAF=Hu;function Nu(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var n=0,i=0,s;t.cmpn(-n)>0||e.cmpn(-i)>0;){var o=t.andln(3)+n&3,c=e.andln(3)+i&3;o===3&&(o=-1),c===3&&(c=-1);var u;(o&1)===0?u=0:(s=t.andln(7)+n&7,(s===3||s===5)&&c===2?u=-o:u=o),r[0].push(u);var l;(c&1)===0?l=0:(s=e.andln(7)+i&7,(s===3||s===5)&&o===2?l=-c:l=c),r[1].push(l),2*n===u+1&&(n=1-n),2*i===l+1&&(i=1-i),t.iushrn(1),e.iushrn(1)}return r}jt.getJSF=Nu;function Ru(t,e,r){var n="_"+e;t.prototype[e]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}jt.cachedProperty=Ru;function Ku(t){return typeof t=="string"?jt.toArray(t,"hex"):t}jt.parseBytes=Ku;function Uu(t){return new Lu(t,"hex","le")}jt.intFromLE=Uu});var Nn=D((w3,co)=>{k();q();var Hn=qt(),Hr=Et(),pi=Hn.getNAF,ju=Hn.getJSF,vi=Hn.assert;function _r(t,e){this.type=t,this.p=new Hr(e.p,16),this.red=e.prime?Hr.red(e.prime):Hr.mont(this.p),this.zero=new Hr(0).toRed(this.red),this.one=new Hr(1).toRed(this.red),this.two=new Hr(2).toRed(this.red),this.n=e.n&&new Hr(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}co.exports=_r;_r.prototype.point=function(){throw new Error("Not implemented")};_r.prototype.validate=function(){throw new Error("Not implemented")};_r.prototype._fixedNafMul=function(e,r){vi(e.precomputed);var n=e._getDoubles(),i=pi(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],c,u;for(c=0;c<i.length;c+=n.step){u=0;for(var l=c+n.step-1;l>=c;l--)u=(u<<1)+i[l];o.push(u)}for(var y=this.jpoint(null,null,null),p=this.jpoint(null,null,null),S=s;S>0;S--){for(c=0;c<o.length;c++)u=o[c],u===S?p=p.mixedAdd(n.points[c]):u===-S&&(p=p.mixedAdd(n.points[c].neg()));y=y.add(p)}return y.toP()};_r.prototype._wnafMul=function(e,r){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=pi(r,n,this._bitLength),c=this.jpoint(null,null,null),u=o.length-1;u>=0;u--){for(var l=0;u>=0&&o[u]===0;u--)l++;if(u>=0&&l++,c=c.dblp(l),u<0)break;var y=o[u];vi(y!==0),e.type==="affine"?y>0?c=c.mixedAdd(s[y-1>>1]):c=c.mixedAdd(s[-y-1>>1].neg()):y>0?c=c.add(s[y-1>>1]):c=c.add(s[-y-1>>1].neg())}return e.type==="affine"?c.toP():c};_r.prototype._wnafMulAdd=function(e,r,n,i,s){var o=this._wnafT1,c=this._wnafT2,u=this._wnafT3,l=0,y,p,S;for(y=0;y<i;y++){S=r[y];var M=S._getNAFPoints(e);o[y]=M.wnd,c[y]=M.points}for(y=i-1;y>=1;y-=2){var A=y-1,x=y;if(o[A]!==1||o[x]!==1){u[A]=pi(n[A],o[A],this._bitLength),u[x]=pi(n[x],o[x],this._bitLength),l=Math.max(u[A].length,l),l=Math.max(u[x].length,l);continue}var E=[r[A],null,null,r[x]];r[A].y.cmp(r[x].y)===0?(E[1]=r[A].add(r[x]),E[2]=r[A].toJ().mixedAdd(r[x].neg())):r[A].y.cmp(r[x].y.redNeg())===0?(E[1]=r[A].toJ().mixedAdd(r[x]),E[2]=r[A].add(r[x].neg())):(E[1]=r[A].toJ().mixedAdd(r[x]),E[2]=r[A].toJ().mixedAdd(r[x].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],C=ju(n[A],n[x]);for(l=Math.max(C[0].length,l),u[A]=new Array(l),u[x]=new Array(l),p=0;p<l;p++){var O=C[0][p]|0,L=C[1][p]|0;u[A][p]=I[(O+1)*3+(L+1)],u[x][p]=0,c[A]=E}}var T=this.jpoint(null,null,null),N=this._wnafT4;for(y=l;y>=0;y--){for(var U=0;y>=0;){var H=!0;for(p=0;p<i;p++)N[p]=u[p][y]|0,N[p]!==0&&(H=!1);if(!H)break;U++,y--}if(y>=0&&U++,T=T.dblp(U),y<0)break;for(p=0;p<i;p++){var Z=N[p];Z!==0&&(Z>0?S=c[p][Z-1>>1]:Z<0&&(S=c[p][-Z-1>>1].neg()),S.type==="affine"?T=T.mixedAdd(S):T=T.add(S))}}for(y=0;y<i;y++)c[y]=null;return s?T:T.toP()};function Ct(t,e){this.curve=t,this.type=e,this.precomputed=null}_r.BasePoint=Ct;Ct.prototype.eq=function(){throw new Error("Not implemented")};Ct.prototype.validate=function(){return this.curve.validate(this)};_r.prototype.decodePoint=function(e,r){e=Hn.toArray(e,r);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?vi(e[e.length-1]%2===0):e[0]===7&&vi(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")};Ct.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Ct.prototype._encode=function(e){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};Ct.prototype.encode=function(e,r){return Hn.encode(this._encode(r),e)};Ct.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};Ct.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};Ct.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)i=i.dbl();n.push(i)}return{step:e,points:n}};Ct.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:e,points:r}};Ct.prototype._getBeta=function(){return null};Ct.prototype.dblp=function(e){for(var r=this,n=0;n<e;n++)r=r.dbl();return r}});var lo=D((S3,uo)=>{k();q();var Du=qt(),ge=Et(),ja=_a(),on=Nn(),zu=Du.assert;function Lt(t){on.call(this,"short",t),this.a=new ge(t.a,16).toRed(this.red),this.b=new ge(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}ja(Lt,on);uo.exports=Lt;Lt.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(e.beta)r=new ge(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(e.lambda)n=new ge(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],zu(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(c){return{a:new ge(c.a,16),b:new ge(c.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}};Lt.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:ge.mont(e),n=new ge(2).toRed(r).redInvm(),i=n.redNeg(),s=new ge(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),c=i.redSub(s).fromRed();return[o,c]};Lt.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),s=new ge(1),o=new ge(0),c=new ge(0),u=new ge(1),l,y,p,S,M,A,x,E=0,I,C;n.cmpn(0)!==0;){var O=i.div(n);I=i.sub(O.mul(n)),C=c.sub(O.mul(s));var L=u.sub(O.mul(o));if(!p&&I.cmp(r)<0)l=x.neg(),y=s,p=I.neg(),S=C;else if(p&&++E===2)break;x=I,i=n,n=I,c=s,s=C,u=o,o=L}M=I.neg(),A=C;var T=p.sqr().add(S.sqr()),N=M.sqr().add(A.sqr());return N.cmp(T)>=0&&(M=l,A=y),p.negative&&(p=p.neg(),S=S.neg()),M.negative&&(M=M.neg(),A=A.neg()),[{a:p,b:S},{a:M,b:A}]};Lt.prototype._endoSplit=function(e){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),c=s.mul(n.a),u=o.mul(i.a),l=s.mul(n.b),y=o.mul(i.b),p=e.sub(c).sub(u),S=l.add(y).neg();return{k1:p,k2:S}};Lt.prototype.pointFromX=function(e,r){e=new ge(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(e,i)};Lt.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,n=e.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};Lt.prototype._endoWnafMulAdd=function(e,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var c=this._endoSplit(r[o]),u=e[o],l=u._getBeta();c.k1.negative&&(c.k1.ineg(),u=u.neg(!0)),c.k2.negative&&(c.k2.ineg(),l=l.neg(!0)),i[o*2]=u,i[o*2+1]=l,s[o*2]=c.k1,s[o*2+1]=c.k2}for(var y=this._wnafMulAdd(1,i,s,o*2,n),p=0;p<o*2;p++)i[p]=null,s[p]=null;return y};function ft(t,e,r,n){on.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new ge(e,16),this.y=new ge(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}ja(ft,on.BasePoint);Lt.prototype.point=function(e,r,n){return new ft(this,e,r,n)};Lt.prototype.pointFromJSON=function(e,r){return ft.fromJSON(this,e,r)};ft.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return r}};ft.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};ft.fromJSON=function(e,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=e.point(r[0],r[1],n);if(!r[2])return i;function s(c){return e.point(c[0],c[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};ft.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};ft.prototype.isInfinity=function(){return this.inf};ft.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(e.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};ft.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),c=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,c)};ft.prototype.getX=function(){return this.x.fromRed()};ft.prototype.getY=function(){return this.y.fromRed()};ft.prototype.mul=function(e){return e=new ge(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};ft.prototype.mulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};ft.prototype.jmulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};ft.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};ft.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};ft.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function pt(t,e,r,n){on.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ge(0)):(this.x=new ge(e,16),this.y=new ge(r,16),this.z=new ge(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}ja(pt,on.BasePoint);Lt.prototype.jpoint=function(e,r,n){return new pt(this,e,r,n)};pt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(e);return this.curve.point(n,i)};pt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};pt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=e.x.redMul(n),o=this.y.redMul(r.redMul(e.z)),c=e.y.redMul(n.redMul(this.z)),u=i.redSub(s),l=o.redSub(c);if(u.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var y=u.redSqr(),p=y.redMul(u),S=i.redMul(y),M=l.redSqr().redIAdd(p).redISub(S).redISub(S),A=l.redMul(S.redISub(M)).redISub(o.redMul(p)),x=this.z.redMul(e.z).redMul(u);return this.curve.jpoint(M,A,x)};pt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),c=n.redSub(i),u=s.redSub(o);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=c.redSqr(),y=l.redMul(c),p=n.redMul(l),S=u.redSqr().redIAdd(y).redISub(p).redISub(p),M=u.redMul(p.redISub(S)).redISub(s.redMul(y)),A=this.z.redMul(c);return this.curve.jpoint(S,M,A)};pt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<e;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,c=this.y,u=this.z,l=u.redSqr().redSqr(),y=c.redAdd(c);for(r=0;r<e;r++){var p=o.redSqr(),S=y.redSqr(),M=S.redSqr(),A=p.redAdd(p).redIAdd(p).redIAdd(i.redMul(l)),x=o.redMul(S),E=A.redSqr().redISub(x.redAdd(x)),I=x.redISub(E),C=A.redMul(I);C=C.redIAdd(C).redISub(M);var O=y.redMul(u);r+1<e&&(l=l.redMul(M)),o=E,u=O,y=C}return this.curve.jpoint(o,y.redMul(s),u)};pt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};pt.prototype._zeroDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(i).redISub(o);c=c.redIAdd(c);var u=i.redAdd(i).redIAdd(i),l=u.redSqr().redISub(c).redISub(c),y=o.redIAdd(o);y=y.redIAdd(y),y=y.redIAdd(y),e=l,r=u.redMul(c.redISub(l)).redISub(y),n=this.y.redAdd(this.y)}else{var p=this.x.redSqr(),S=this.y.redSqr(),M=S.redSqr(),A=this.x.redAdd(S).redSqr().redISub(p).redISub(M);A=A.redIAdd(A);var x=p.redAdd(p).redIAdd(p),E=x.redSqr(),I=M.redIAdd(M);I=I.redIAdd(I),I=I.redIAdd(I),e=E.redISub(A).redISub(A),r=x.redMul(A.redISub(e)).redISub(I),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,r,n)};pt.prototype._threeDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(i).redISub(o);c=c.redIAdd(c);var u=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),l=u.redSqr().redISub(c).redISub(c);e=l;var y=o.redIAdd(o);y=y.redIAdd(y),y=y.redIAdd(y),r=u.redMul(c.redISub(l)).redISub(y),n=this.y.redAdd(this.y)}else{var p=this.z.redSqr(),S=this.y.redSqr(),M=this.x.redMul(S),A=this.x.redSub(p).redMul(this.x.redAdd(p));A=A.redAdd(A).redIAdd(A);var x=M.redIAdd(M);x=x.redIAdd(x);var E=x.redAdd(x);e=A.redSqr().redISub(E),n=this.y.redAdd(this.z).redSqr().redISub(S).redISub(p);var I=S.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I),r=A.redMul(x.redISub(e)).redISub(I)}return this.curve.jpoint(e,r,n)};pt.prototype._dbl=function(){var e=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),c=n.redSqr(),u=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),l=r.redAdd(r);l=l.redIAdd(l);var y=l.redMul(c),p=u.redSqr().redISub(y.redAdd(y)),S=y.redISub(p),M=c.redSqr();M=M.redIAdd(M),M=M.redIAdd(M),M=M.redIAdd(M);var A=u.redMul(S).redISub(M),x=n.redAdd(n).redMul(i);return this.curve.jpoint(p,A,x)};pt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),c=this.x.redAdd(r).redSqr().redISub(e).redISub(i);c=c.redIAdd(c),c=c.redAdd(c).redIAdd(c),c=c.redISub(o);var u=c.redSqr(),l=i.redIAdd(i);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var y=s.redIAdd(c).redSqr().redISub(o).redISub(u).redISub(l),p=r.redMul(y);p=p.redIAdd(p),p=p.redIAdd(p);var S=this.x.redMul(u).redISub(p);S=S.redIAdd(S),S=S.redIAdd(S);var M=this.y.redMul(y.redMul(l.redISub(y)).redISub(c.redMul(u)));M=M.redIAdd(M),M=M.redIAdd(M),M=M.redIAdd(M);var A=this.z.redAdd(c).redSqr().redISub(n).redISub(u);return this.curve.jpoint(S,M,A)};pt.prototype.mul=function(e,r){return e=new ge(e,r),this.curve._wnafMul(this,e)};pt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)===0};pt.prototype.eqXToP=function(e){var r=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};pt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};pt.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var po=D((A3,bo)=>{k();q();var cn=Et(),ho=_a(),yi=Nn(),Vu=qt();function dn(t){yi.call(this,"mont",t),this.a=new cn(t.a,16).toRed(this.red),this.b=new cn(t.b,16).toRed(this.red),this.i4=new cn(4).toRed(this.red).redInvm(),this.two=new cn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}ho(dn,yi);bo.exports=dn;dn.prototype.validate=function(e){var r=e.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function ot(t,e,r){yi.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new cn(e,16),this.z=new cn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}ho(ot,yi.BasePoint);dn.prototype.decodePoint=function(e,r){return this.point(Vu.toArray(e,r),1)};dn.prototype.point=function(e,r){return new ot(this,e,r)};dn.prototype.pointFromJSON=function(e){return ot.fromJSON(this,e)};ot.prototype.precompute=function(){};ot.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};ot.fromJSON=function(e,r){return new ot(e,r[0],r[1]||e.one)};ot.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ot.prototype.isInfinity=function(){return this.z.cmpn(0)===0};ot.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),c=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,c)};ot.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};ot.prototype.diffAdd=function(e,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),c=o.redMul(n),u=s.redMul(i),l=r.z.redMul(c.redAdd(u).redSqr()),y=r.x.redMul(c.redISub(u).redSqr());return this.curve.point(l,y)};ot.prototype.mul=function(e){for(var r=e.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var c=o.length-1;c>=0;c--)o[c]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};ot.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};ot.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};ot.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};ot.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};ot.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var mo=D((P3,yo)=>{k();q();var Fu=qt(),ir=Et(),vo=_a(),mi=Nn(),Zu=Fu.assert;function Wt(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,mi.call(this,"edwards",t),this.a=new ir(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new ir(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new ir(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Zu(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}vo(Wt,mi);yo.exports=Wt;Wt.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Wt.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Wt.prototype.jpoint=function(e,r,n,i){return this.point(e,r,n,i)};Wt.prototype.pointFromX=function(e,r){e=new ir(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),c=o.redSqrt();if(c.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var u=c.fromRed().isOdd();return(r&&!u||!r&&u)&&(c=c.redNeg()),this.point(e,c)};Wt.prototype.pointFromY=function(e,r){e=new ir(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var c=o.redSqrt();if(c.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return c.fromRed().isOdd()!==r&&(c=c.redNeg()),this.point(c,e)};Wt.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),n=e.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function de(t,e,r,n,i){mi.BasePoint.call(this,t,"projective"),e===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new ir(e,16),this.y=new ir(r,16),this.z=n?new ir(n,16):this.curve.one,this.t=i&&new ir(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}vo(de,mi.BasePoint);Wt.prototype.pointFromJSON=function(e){return de.fromJSON(this,e)};Wt.prototype.point=function(e,r,n,i){return new de(this,e,r,n,i)};de.fromJSON=function(e,r){return new de(e,r[0],r[1],r[2])};de.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};de.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};de.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=i.redAdd(r),c=o.redSub(n),u=i.redSub(r),l=s.redMul(c),y=o.redMul(u),p=s.redMul(u),S=c.redMul(o);return this.curve.point(l,y,S,p)};de.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,c,u,l;if(this.curve.twisted){c=this.curve._mulA(r);var y=c.redAdd(n);this.zOne?(i=e.redSub(r).redSub(n).redMul(y.redSub(this.curve.two)),s=y.redMul(c.redSub(n)),o=y.redSqr().redSub(y).redSub(y)):(u=this.z.redSqr(),l=y.redSub(u).redISub(u),i=e.redSub(r).redISub(n).redMul(l),s=y.redMul(c.redSub(n)),o=y.redMul(l))}else c=r.redAdd(n),u=this.curve._mulC(this.z).redSqr(),l=c.redSub(u).redSub(u),i=this.curve._mulC(e.redISub(c)).redMul(l),s=this.curve._mulC(c).redMul(r.redISub(n)),o=c.redMul(l);return this.curve.point(i,s,o)};de.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};de.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=n.redSub(r),c=s.redSub(i),u=s.redAdd(i),l=n.redAdd(r),y=o.redMul(c),p=u.redMul(l),S=o.redMul(l),M=c.redMul(u);return this.curve.point(y,p,M,S)};de.prototype._projAdd=function(e){var r=this.z.redMul(e.z),n=r.redSqr(),i=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(i).redMul(s),c=n.redSub(o),u=n.redAdd(o),l=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(s),y=r.redMul(c).redMul(l),p,S;return this.curve.twisted?(p=r.redMul(u).redMul(s.redSub(this.curve._mulA(i))),S=c.redMul(u)):(p=r.redMul(u).redMul(s.redSub(i)),S=this.curve._mulC(c).redMul(u)),this.curve.point(y,p,S)};de.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};de.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};de.prototype.mulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!1)};de.prototype.jmulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!0)};de.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};de.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};de.prototype.getX=function(){return this.normalize(),this.x.fromRed()};de.prototype.getY=function(){return this.normalize(),this.y.fromRed()};de.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};de.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=e.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};de.prototype.toP=de.prototype.normalize;de.prototype.mixedAdd=de.prototype.add});var Da=D(go=>{k();q();var gi=go;gi.base=Nn();gi.short=lo();gi.mont=po();gi.edwards=mo()});var _o=D((T3,wo)=>{k();q();wo.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var wi=D(Mo=>{k();q();var Va=Mo,xr=Xs(),za=Da(),Wu=qt(),xo=Wu.assert;function So(t){t.type==="short"?this.curve=new za.short(t):t.type==="edwards"?this.curve=new za.edwards(t):this.curve=new za.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,xo(this.g.validate(),"Invalid curve"),xo(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}Va.PresetCurve=So;function Sr(t,e){Object.defineProperty(Va,t,{configurable:!0,enumerable:!0,get:function(){var r=new So(e);return Object.defineProperty(Va,t,{configurable:!0,enumerable:!0,value:r}),r}})}Sr("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:xr.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Sr("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:xr.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Sr("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:xr.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Sr("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:xr.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Sr("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:xr.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Sr("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:xr.sha256,gRed:!1,g:["9"]});Sr("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:xr.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var Fa;try{Fa=_o()}catch{Fa=void 0}Sr("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:xr.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",Fa]})});var Ao=D((j3,Bo)=>{k();q();var $u=Et(),Gu=qt(),Za=Gu.assert;function mt(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}Bo.exports=mt;mt.fromPublic=function(e,r,n){return r instanceof mt?r:new mt(e,{pub:r,pubEnc:n})};mt.fromPrivate=function(e,r,n){return r instanceof mt?r:new mt(e,{priv:r,privEnc:n})};mt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};mt.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};mt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};mt.prototype._importPrivate=function(e,r){this.priv=new $u(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};mt.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?Za(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Za(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};mt.prototype.derive=function(e){return e.validate()||Za(e.validate(),"public point not validated"),e.mul(this.priv).getX()};mt.prototype.sign=function(e,r,n){return this.ec.sign(e,this,r,n)};mt.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};mt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var Po=D((V3,Eo)=>{k();q();var _i=Et(),Ga=qt(),Xu=Ga.assert;function Rn(t,e,r){if(e instanceof Rn)return e;this._importDER(e,r)||(Xu(e.r&&e.s,"Signature without r or s"),this.r=new _i(e.r,16),this.s=new _i(e.s,16),e.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=e.recoveryParam,this.curve=t,this.byteLength=this.curve.n.byteLength())}Eo.exports=Rn;function Yu(){this.place=0}function Wa(t,e){var r=t[e.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,o=e.place;s<n;s++,o++)i<<=8,i|=t[o],i>>>=0;return i<=127?!1:(e.place=o,i)}function Io(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}Rn.prototype._importDER=function(e,r){e=Ga.toArray(e,r);var n=new Yu;if(e[n.place++]!==48)return!1;var i=Wa(e,n);if(i===!1||i+n.place!==e.length||e[n.place++]!==2)return!1;var s=Wa(e,n);if(s===!1)return!1;var o=e.slice(n.place,s+n.place);if(n.place+=s,e[n.place++]!==2)return!1;var c=Wa(e,n);if(c===!1||e.length!==c+n.place)return!1;var u=e.slice(n.place,c+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(u[0]===0)if(u[1]&128)u=u.slice(1);else return!1;return this.r=new _i(o),this.s=new _i(u),this.recoveryParam=null,!0};function $a(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}Rn.prototype.toDER=function(e){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=Io(r),n=Io(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];$a(i,r.length),i=i.concat(r),i.push(2),$a(i,n.length);var s=i.concat(n),o=[48];return $a(o,s.length),o=o.concat(s),Ga.encode(o,e)};Rn.prototype.toBytes=function(){let e=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return e.concat(r)}});var Oo=D((W3,qo)=>{k();q();var ar=Et(),ko=id(),Ju=qt(),Xa=wi(),Qu=ad(),Nr=Ju.assert,Ya=Ao(),xi=Po();function Tt(t){if(!(this instanceof Tt))return new Tt(t);typeof t=="string"&&(Nr(Object.prototype.hasOwnProperty.call(Xa,t),"Unknown curve "+t),t=Xa[t]),t instanceof Xa.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}qo.exports=Tt;Tt.prototype.keyPair=function(e){return new Ya(this,e)};Tt.prototype.keyFromPrivate=function(e,r){return Ya.fromPrivate(this,e,r)};Tt.prototype.keyFromPublic=function(e,r){return Ya.fromPublic(this,e,r)};Tt.prototype.genKeyPair=function(e){e||(e={});for(var r=new ko({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Qu(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new ar(2));;){var s=new ar(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Tt.prototype._truncateToN=function(e,r){var n=e.byteLength()*8-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};Tt.prototype.sign=function(e,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof e!="string"&&typeof e!="number"&&!ar.isBN(e)){Nr(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Nr(e.length>>>0===e.length);for(var s=0;s<e.length;s++)Nr((e[s]&255)===e[s])}r=this.keyFromPrivate(r,n),e=this._truncateToN(new ar(e,16)),Nr(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),c=r.getPrivate().toArray("be",o),u=e.toArray("be",o);Nr(new ar(u).eq(e),"Can not sign message");for(var l=new ko({hash:this.hash,entropy:c,nonce:u,pers:i.pers,persEnc:i.persEnc||"utf8"}),y=this.n.sub(new ar(1)),p=0;;p++){var S=i.k?i.k(p):new ar(l.generate(this.n.byteLength()));if(S=this._truncateToN(S,!0),!(S.cmpn(1)<=0||S.cmp(y)>=0)){var M=this.g.mul(S);if(!M.isInfinity()){var A=M.getX(),x=A.umod(this.n);if(x.cmpn(0)!==0){var E=S.invm(this.n).mul(x.mul(r.getPrivate()).iadd(e));if(E=E.umod(this.n),E.cmpn(0)!==0){var I=(M.getY().isOdd()?1:0)|(A.cmp(x)!==0?2:0);return i.canonical&&E.cmp(this.nh)>0&&(E=this.n.sub(E),I^=1),new xi(this.curve,{r:x,s:E,recoveryParam:I})}}}}}};Tt.prototype.verify=function(e,r,n,i){e=this._truncateToN(new ar(e,16)),n=this.keyFromPublic(n,i),r=new xi(this.curve,r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var c=o.invm(this.n),u=c.mul(e).umod(this.n),l=c.mul(s).umod(this.n),y;return this.curve._maxwellTrick?(y=this.g.jmulAdd(u,n.getPublic(),l),y.isInfinity()?!1:y.eqXToP(s)):(y=this.g.mulAdd(u,n.getPublic(),l),y.isInfinity()?!1:y.getX().umod(this.n).cmp(s)===0)};Tt.prototype.recoverPubKey=function(t,e,r,n){Nr((3&r)===r,"The recovery param is more than two bits"),e=new xi(this.curve,e,n);var i=this.n,s=new ar(t),o=e.r,c=e.s,u=r&1,l=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?o=this.curve.pointFromX(o.add(this.curve.n),u):o=this.curve.pointFromX(o,u);var y=e.r.invm(i),p=i.sub(s).mul(y).umod(i),S=c.mul(y).umod(i);return this.g.mulAdd(p,o,S)};Tt.prototype.getKeyRecoveryParam=function(t,e,r,n){if(e=new xi(this.curve,e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(t,e,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var Ho=D((X3,To)=>{k();q();var Kn=qt(),Lo=Kn.assert,Co=Kn.parseBytes,un=Kn.cachedProperty;function ct(t,e){this.eddsa=t,this._secret=Co(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=Co(e.pub)}ct.fromPublic=function(e,r){return r instanceof ct?r:new ct(e,{pub:r})};ct.fromSecret=function(e,r){return r instanceof ct?r:new ct(e,{secret:r})};ct.prototype.secret=function(){return this._secret};un(ct,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});un(ct,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});un(ct,"privBytes",function(){var e=this.eddsa,r=this.hash(),n=e.encodingLength-1,i=r.slice(0,e.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});un(ct,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});un(ct,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});un(ct,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});ct.prototype.sign=function(e){return Lo(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};ct.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};ct.prototype.getSecret=function(e){return Lo(this._secret,"KeyPair is public only"),Kn.encode(this.secret(),e)};ct.prototype.getPublic=function(e){return Kn.encode(this.pubBytes(),e)};To.exports=ct});var Ro=D((Q3,No)=>{k();q();var el=Et(),Si=qt(),tl=Si.assert,Mi=Si.cachedProperty,rl=Si.parseBytes;function Rr(t,e){this.eddsa=t,typeof e!="object"&&(e=rl(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),tl(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof el&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}Mi(Rr,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Mi(Rr,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Mi(Rr,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Mi(Rr,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Rr.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Rr.prototype.toHex=function(){return Si.encode(this.toBytes(),"hex").toUpperCase()};No.exports=Rr});var zo=D((r6,Do)=>{k();q();var nl=Xs(),il=wi(),ln=qt(),al=ln.assert,Uo=ln.parseBytes,jo=Ho(),Ko=Ro();function Pt(t){if(al(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Pt))return new Pt(t);t=il[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=nl.sha512}Do.exports=Pt;Pt.prototype.sign=function(e,r){e=Uo(e);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),e),s=this.g.mul(i),o=this.encodePoint(s),c=this.hashInt(o,n.pubBytes(),e).mul(n.priv()),u=i.add(c).umod(this.curve.n);return this.makeSignature({R:s,S:u,Rencoded:o})};Pt.prototype.verify=function(e,r,n){e=Uo(e),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),e),o=this.g.mul(r.S()),c=r.R().add(i.pub().mul(s));return c.eq(o)};Pt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return ln.intFromLE(e.digest()).umod(this.curve.n)};Pt.prototype.keyFromPublic=function(e){return jo.fromPublic(this,e)};Pt.prototype.keyFromSecret=function(e){return jo.fromSecret(this,e)};Pt.prototype.makeSignature=function(e){return e instanceof Ko?e:new Ko(this,e)};Pt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};Pt.prototype.decodePoint=function(e){e=ln.parseBytes(e);var r=e.length-1,n=e.slice(0,r).concat(e[r]&-129),i=(e[r]&128)!==0,s=ln.intFromLE(n);return this.curve.pointFromY(s,i)};Pt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Pt.prototype.decodeInt=function(e){return ln.intFromLE(e)};Pt.prototype.isPoint=function(e){return e instanceof this.pointClass}});var hn=D(Ht=>{k();q();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.utils=Ht.curves=Ht.curve=Ht.eddsa=Ht.ec=void 0;var sl=Da();Ht.curve=sl;var fl=wi();Ht.curves=fl;var ol=Oo();Ht.ec=ol;var cl=zo();Ht.eddsa=cl;var dl=qt();Ht.utils=dl});var Zo=D((Vo,Fo)=>{k();q();Object.defineProperty(Vo,"__esModule",{value:!0});var ul=hn(),$t=new ul.ec("secp256k1"),Q=$t.curve,ue=Et();function ll(t,e){let r=new ue(e);if(r.cmp(Q.p)>=0)return null;r=r.toRed(Q.red);let n=r.redSqr().redIMul(r).redIAdd(Q.b).redSqrt();t===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(Q.b)).isZero()?$t.keyPair({pub:{x:r,y:n}}):null}function hl(t,e,r){let n=new ue(e),i=new ue(r);if(n.cmp(Q.p)>=0||i.cmp(Q.p)>=0||(n=n.toRed(Q.red),i=i.toRed(Q.red),(t===6||t===7)&&i.isOdd()!==(t===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(Q.b)).isZero()?$t.keyPair({pub:{x:n,y:i}}):null}function Mr(t){let e=t[0];switch(e){case 2:case 3:return t.length!==33?null:ll(e,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:hl(e,t.subarray(1,33),t.subarray(33,65));default:return null}}Fo.exports={contextRandomize(){return 0},privateKeyVerify(t){let e=new ue(t);return e.cmp(Q.n)<0&&!e.isZero()},privateKeyNegate(t){let e=new ue(t);return P.Buffer.from(Q.n.sub(e).umod(Q.n).toArray("be",32))},privateKeyTweakAdd(t,e){let r=new ue(e);return r.cmp(Q.n)>=0||(r.iadd(new ue(t)),r.cmp(Q.n)>=0&&r.isub(Q.n),r.isZero())?null:P.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(t,e){let r=new ue(e);return r.cmp(Q.n)>=0||r.isZero()?1:(r.imul(new ue(t)),r.cmp(Q.n)>=0&&(r=r.umod(Q.n)),P.Buffer.from(r.toArray("be",32)))},publicKeyVerify(t){let e=Mr(t);return e==null?null:e.validate().result},publicKeyCreate(t,e){let r=new ue(t);if(r.cmp(Q.n)>=0||r.isZero())return null;let n=$t.keyFromPrivate(t,null).getPublic();return P.Buffer.from(n.encode(null,e))},publicKeyConvert(t,e){let n=Mr(t).getPublic();return P.Buffer.from(n.encode(null,e))},publicKeyNegate(t,e){let r=Mr(t);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),P.Buffer.from(n.encode(null,e))},publicKeyCombine(t,e){let r=new Array(t.length);for(let i=0;i<t.length;++i)if(r[i]=Mr(t[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:P.Buffer.from(n.encode(null,e))},publicKeyTweakAdd(t,e,r){let n=Mr(t);if(n===null||new ue(e).cmp(Q.n)>=0)return null;let s=n.getPublic().add(Q.g.mul(e));return s.isInfinity()?null:P.Buffer.from(s.encode(null,r))},publicKeyTweakMul(t,e,r){let n=Mr(t);if(n===null)return null;let i=new ue(e);if(i.cmp(Q.n)>=0||i.isZero())return null;let s=n.getPublic().mul(e);return P.Buffer.from(s.encode(null,r))},signatureNormalize(t){let e=new ue(t.subarray(0,32)),r=new ue(t.subarray(32,64));return e.cmp(Q.n)>=0||r.cmp(Q.n)>=0?null:(r.cmp($t.nh)===1&&t.set(Q.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){let r=e.subarray(0,32),n=e.subarray(32,64);if(new ue(r).cmp(Q.n)>=0||new ue(n).cmp(Q.n)>=0)return 1;let{output:i}=t,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,c=0;for(;o>1&&s[c]===0&&!(s[c+1]&128);--o,++c);if(s=s.subarray(c),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let u=i.subarray(6+33,6+33+33);u[0]=0,u.set(n,1);let l=33,y=0;for(;l>1&&u[y]===0&&!(u[y+1]&128);--l,++y);return u=u.subarray(y),u[0]&128||l>1&&u[0]===0&&!(u[1]&128)?1:(t.outputlen=6+o+l,i[0]=48,i[1]=t.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+o]=2,i[5+o]=u.length,i.set(u,6+o),0)},signatureImport(t,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let r=e[3];if(r===0||5+r>=e.length||e[4+r]!==2)return 1;let n=e[5+r];if(n===0||6+r+n!==e.length||e[4]&128||r>1&&e[4]===0&&!(e[5]&128)||e[r+6]&128||n>1&&e[r+6]===0&&!(e[r+7]&128))return 1;let i=e.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=e.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new ue(i);o.cmp(Q.n)>=0&&(o=new ue(0));let c=new ue(e.subarray(6+r));return c.cmp(Q.n)>=0&&(c=new ue(0)),t.set(o.toArrayLike(Uint8Array,"be",32),0),t.set(c.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e){let r=new ue(e);return r.cmp(Q.n)>=0||r.isZero()?null:$t.sign(t,e,{canonical:!0}).toBytes()},ecdsaVerify(t,e,r){let n={r:t.subarray(0,32),s:t.subarray(32,64)},i=new ue(n.r),s=new ue(n.s);if(i.cmp(Q.n)>=0||s.cmp(Q.n)>=0)return 1;if(s.cmp($t.nh)===1||i.isZero()||s.isZero())return 3;let o=Mr(r);if(o===null)return 2;let c=o.getPublic();return $t.verify(e,n,c)},ecdsaRecover(t,e,r,n){let i={r:t.slice(0,32),s:t.slice(32,64)},s=new ue(i.r),o=new ue(i.s);if(s.cmp(Q.n)>=0||o.cmp(Q.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let c;try{c=$t.recoverPubKey(r,i,e,null)}catch{return 2}return P.Buffer.from(c.encode(null,n))},ecdh(t,e,r,n,i,s,o){let c=Mr(e);if(c===null)return 1;let u=new ue(r);if(u.cmp(Q.n)>=0||u.isZero())return 2;let l=c.getPublic().mul(u);if(i===void 0){let y=l.encode(null,!0),p=$t.hash().update(y).digest();for(let S=0;S<32;++S)t[S]=p[S]}else{s||(s=new Uint8Array(32));let y=l.getX().toArray("be",32);for(let A=0;A<32;++A)s[A]=y[A];o||(o=new Uint8Array(32));let p=l.getY().toArray("be",32);for(let A=0;A<32;++A)o[A]=p[A];let S=i(s,o,n);if(!(S instanceof Uint8Array&&S.length===t.length))return 2;t.set(S)}return 0}}});var Yo=D(dt=>{k();q();var bl=dt&&dt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),pl=dt&&dt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vl=dt&&dt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bl(e,t,r);return pl(e,t),e};Object.defineProperty(dt,"__esModule",{value:!0});dt.fromSeed=dt.fromPublicKey=dt.fromPrivateKey=dt.fromBase58=dt.tinySecp256k1Interface=void 0;var Ja=vl(Tn()),yl=xa(),ml=fi(),$o=(0,yl.base58check)(ml.sha256),Go=Zo(),vt=sd(),gl=fd();function wl(t){return{isPoint:e=>t.publicKeyVerify(e),isPrivate:e=>t.privateKeyVerify(e),pointAddScalar:(e,r,n)=>t.publicKeyTweakAdd(e,r,n),pointFromScalar:(e,r)=>t.publicKeyCreate(e,r),privateAdd:(e,r)=>t.privateKeyTweakAdd(new Uint8Array(e),r),sign:(e,r)=>t.ecdsaSign(e,r),verify:(e,r,n)=>t.ecdsaVerify(n,e,r)}}function _l(t){return{isPoint:e=>t.publicKeyVerify(e),pointCompress:(e,r)=>Uint8Array.from(t.publicKeyConvert(e,r??!0)),isPrivate:e=>t.privateKeyVerify(e),pointFromScalar:(e,r)=>{let n=t.publicKeyCreate(e,r??!0);return n==null?null:Uint8Array.from(n)},sign:(e,r,n)=>Uint8Array.from(t.ecdsaSign(e,r)),verify:(e,r,n,i)=>t.ecdsaVerify(n,e,r)}}var Br=wl(Go);dt.tinySecp256k1Interface=_l(Go);var Qa=vt.BufferN(32),xl=vt.compile({wif:vt.UInt8,bip32:{public:vt.UInt32,private:vt.UInt32}}),Ii={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},Wo=2147483648,Sl=Math.pow(2,31)-1;function Ml(t){return vt.String(t)&&t.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function Bl(t){return vt.UInt32(t)&&t<=Sl}var Bi=class{constructor(e,r,n,i,s=0,o=0,c=0){this.__D=e,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=o,this.__PARENT_FINGERPRINT=c,vt(xl,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=P.Buffer.from(Br.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return P.Buffer.from(Ja.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return Ai(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let e=this.network,r=this.isNeutered()?e.bip32.public:e.bip32.private,n=P.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),$o.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return gl.encode(this.network.wif,this.privateKey,!0)}derive(e){vt(vt.UInt32,e);let r=e>=Wo,n=P.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(e,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(e,33);let i=Ja.hmacSHA512(this.chainCode,n),s=i.slice(0,32),o=i.slice(32);if(!Br.isPrivate(s))return this.derive(e+1);let c;if(this.isNeutered()){let u=Br.pointAddScalar(this.publicKey,s,!0);if(u===null)return this.derive(e+1);c=Ai(u,o,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}else{let u=Br.privateAdd(this.privateKey,s);if(u==null)return this.derive(e+1);c=es(u,o,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}return c}deriveHardened(e){return vt(Bl,e),this.derive(e+Wo)}derivePath(e){vt(Ml,e);let r=e.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(e){if(!this.privateKey)throw new Error("Missing private key");return Br.sign(e,this.privateKey)}verify(e,r){return Br.verify(e,this.publicKey,r)}};function Al(t,e){let r=P.Buffer.from($o.decode(t));if(r.length!==78)throw new TypeError("Invalid buffer length");e=e||Ii;let n=r.readUInt32BE(0);if(n!==e.bip32.private&&n!==e.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let o=r.readUInt32BE(9);if(i===0&&o!==0)throw new TypeError("Invalid index");let c=r.slice(13,45),u;if(n===e.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let l=r.slice(46,78);u=es(l,c,e,i,o,s)}else{let l=r.slice(45,78);u=Ai(l,c,e,i,o,s)}return u}dt.fromBase58=Al;function Xo(t,e,r){return es(t,e,r)}dt.fromPrivateKey=Xo;function es(t,e,r,n,i,s){if(vt({privateKey:Qa,chainCode:Qa},{privateKey:t,chainCode:e}),r=r||Ii,!Br.isPrivate(t))throw new TypeError("Private key not in range [1, n)");return new Bi(t,void 0,e,r,n,i,s)}function Il(t,e,r){return Ai(t,e,r)}dt.fromPublicKey=Il;function Ai(t,e,r,n,i,s){if(vt({publicKey:vt.BufferN(33),chainCode:Qa},{publicKey:t,chainCode:e}),r=r||Ii,!Br.isPoint(t))throw new TypeError("Point is not on the curve");return new Bi(void 0,t,e,r,n,i,s)}function El(t,e){if(vt(vt.Buffer,t),t.length<16)throw new TypeError("Seed should be at least 128 bits");if(t.length>64)throw new TypeError("Seed should be at most 512 bits");e=e||Ii;let r=Ja.hmacSHA512(P.Buffer.from("Bitcoin seed","utf8"),t),n=r.slice(0,32),i=r.slice(32);return Xo(n,i,e)}dt.fromSeed=El});var Jo=D(Ei=>{k();q();Object.defineProperty(Ei,"__esModule",{value:!0});Ei.fromSeedV2=void 0;var Pl=od();function kl(t,e){return Pl.HDKey.fromMasterSeed(new Uint8Array([...t])).derive(e)}Ei.fromSeedV2=kl});var Qo=D(kt=>{k();q();Object.defineProperty(kt,"__esModule",{value:!0});kt.fromSeedV2=kt.fromPrivateKey=kt.fromPublicKey=kt.fromBase58=kt.fromSeed=kt.tinySecp256k1Interface=void 0;var Un=Yo();Object.defineProperty(kt,"tinySecp256k1Interface",{enumerable:!0,get:function(){return Un.tinySecp256k1Interface}});Object.defineProperty(kt,"fromSeed",{enumerable:!0,get:function(){return Un.fromSeed}});Object.defineProperty(kt,"fromBase58",{enumerable:!0,get:function(){return Un.fromBase58}});Object.defineProperty(kt,"fromPublicKey",{enumerable:!0,get:function(){return Un.fromPublicKey}});Object.defineProperty(kt,"fromPrivateKey",{enumerable:!0,get:function(){return Un.fromPrivateKey}});var ql=Jo();Object.defineProperty(kt,"fromSeedV2",{enumerable:!0,get:function(){return ql.fromSeedV2}})});var ec=D((g6,Ol)=>{Ol.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var rs=D(Kr=>{k();q();Object.defineProperty(Kr,"__esModule",{value:!0});Kr._default=Kr.wordlists=void 0;var ts={};Kr.wordlists=ts;var Pi;Kr._default=Pi;try{Kr._default=Pi=ec(),ts.english=Pi,ts.EN=Pi}catch{}});var ns=D(we=>{k();q();Object.defineProperty(we,"__esModule",{value:!0});we.wordlists=we.getDefaultWordlist=we.setDefaultWordlist=we.validateMnemonic=we.generateMnemonic=we.entropyToMnemonic=we.mnemonicToEntropy=we.mnemonicToSeedV2=we.mnemonicToSeed=we.mnemonicToSeedSync=void 0;var rc=Tn(),nc=li(),ki=rs(),ic=En(),Cl=cd(),bn=ki._default,tc="Invalid mnemonic",Ur="Invalid entropy",Ll="Invalid mnemonic checksum",ac=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function Tl(t,e,r,n,i){let s=(0,nc.pbkdf2)(ic.sha512,t,e,{c:r,dkLen:n});return Promise.resolve(P.Buffer.from(s))}function jn(t){return(t||"").normalize("NFKD")}function sc(t,e,r){for(;t.length<r;)t=e+t;return t}function fc(t){return parseInt(t,2)}function oc(t){return t.map(e=>sc(e.toString(2),"0",8)).join("")}function cc(t){let r=t.length*8/32,n=(0,rc.sha256)(t);return oc(Array.from(n)).slice(0,r)}function dc(t){return"mnemonic"+(t||"")}function Hl(t,e){let r=P.Buffer.from(jn(t),"utf8"),n=P.Buffer.from(dc(jn(e)),"utf8"),i=(0,nc.pbkdf2)(ic.sha512,r,n,{c:2048,dkLen:64});return P.Buffer.from(i)}we.mnemonicToSeedSync=Hl;function Nl(t,e){return Promise.resolve().then(()=>{let r=P.Buffer.from(jn(t),"utf8"),n=P.Buffer.from(dc(jn(e)),"utf8");return Tl(r,n,2048,64,"sha512")})}we.mnemonicToSeed=Nl;async function Rl(t,e){let r=t.split(" ").map(s=>bn.indexOf(s)),n=new Uint8Array(new Uint16Array(r).buffer),i=await(0,Cl.mnemonicToSeed)(n,e);return P.Buffer.from(i)}we.mnemonicToSeedV2=Rl;function uc(t,e){if(e=e||bn,!e)throw new Error(ac);let r=jn(t).split(" ");if(r.length%3!==0)throw new Error(tc);let n=r.map(y=>{let p=e.indexOf(y);if(p===-1)throw new Error(tc);return sc(p.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),o=n.slice(i),c=s.match(/(.{1,8})/g).map(fc);if(c.length<16)throw new Error(Ur);if(c.length>32)throw new Error(Ur);if(c.length%4!==0)throw new Error(Ur);let u=P.Buffer.from(c);if(cc(u)!==o)throw new Error(Ll);return u.toString("hex")}we.mnemonicToEntropy=uc;function lc(t,e){if(P.Buffer.isBuffer(t)||(t=P.Buffer.from(t,"hex")),e=e||bn,!e)throw new Error(ac);if(t.length<16)throw new TypeError(Ur);if(t.length>32)throw new TypeError(Ur);if(t.length%4!==0)throw new TypeError(Ur);let r=oc(Array.from(t)),n=cc(t),o=(r+n).match(/(.{1,11})/g).map(c=>{let u=fc(c);return e[u]});return e[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?o.join("\u3000"):o.join(" ")}we.entropyToMnemonic=lc;function Kl(t,e,r){if(t=t||128,t%32!==0)throw new TypeError(Ur);return e=e||rc.randomBytes,lc(e(t/8),r)}we.generateMnemonic=Kl;function Ul(t,e){try{uc(t,e)}catch{return!1}return!0}we.validateMnemonic=Ul;function jl(t){let e=ki.wordlists[t];if(e)bn=e;else throw new Error('Could not find wordlist for language "'+t+'"')}we.setDefaultWordlist=jl;function Dl(){if(!bn)throw new Error("No Default Wordlist set");return Object.keys(ki.wordlists).filter(t=>t==="JA"||t==="EN"?!1:ki.wordlists[t].every((e,r)=>e===bn[r]))[0]}we.getDefaultWordlist=Dl;var zl=rs();Object.defineProperty(we,"wordlists",{enumerable:!0,get:function(){return zl.wordlists}})});var mc=D(te=>{k();q();var Vl=te&&te.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Fl=te&&te.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Zl=te&&te.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Vl(e,t,r);return Fl(e,t),e},Wl=te&&te.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(te,"__esModule",{value:!0});te.loadUncompressedPublicKey=te.loadCompressedPublicKey=te.publicKeyConvert=te.publicKeyCreate=te.publicKeyVerify=te.privateKeyVerify=te.loadPublicKey=te.recover=te.verifyWithNoRecovery=te.verify=te.getV=te.sign=void 0;var $l=Zl(hn()),nt=new $l.ec("secp256k1"),hc=Tn(),pn=Wl(Et());function Gl(t,e,r=!0){let n=nt.sign(Array.from(t),P.Buffer.from(e),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}te.sign=Gl;function Xl(t,e,r,n,i=!0){let s=Dn(n);if(s==null)throw new Error("pubkey error");let o=nt.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return nt.getKeyRecoveryParam(t,{r:e,s:r},o,i)}te.getV=Xl;function Yl(t,e,r,n){let i=bc(e,r,t,!0);if(i==null)return!1;let s=pc(n,!0);return s==null?!1:i.equals(s)}te.verify=Yl;function Jl(t,e,r){let n=Dn(r);if(n==null)throw new Error("pubkey error");let i=nt.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,hc.toHex)(e.slice(0,32)),s:(0,hc.toHex)(e.slice(32,64))};return i.verify(t,s)}te.verifyWithNoRecovery=Jl;function bc(t,e,r,n){let i={r:Array.from(t.slice(0,32)),s:Array.from(t.slice(32,64))},s=new pn.default(i.r),o=new pn.default(i.s);if(s.cmp(nt.curve.n)>=0||o.cmp(nt.curve.n)>=0||s.isZero()||o.isZero())return null;let c;try{c=nt.recoverPubKey(Array.from(r),i,e,null)}catch{return null}return P.Buffer.from(c.encode(null,n))}te.recover=bc;function Dn(t){let e=P.Buffer.from(t),r=e[0];switch(r){case 2:case 3:return e.length!==33?null:vc(r,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:yc(r,e.subarray(1,33),e.subarray(33,65));default:return null}}te.loadPublicKey=Dn;function Ql(t){let e=new pn.default(Array.from(t));return e.cmp(nt.curve.n)<0&&!e.isZero()}te.privateKeyVerify=Ql;function eh(t){return Dn(t)!==null}te.publicKeyVerify=eh;function th(t,e){let r=nt.keyFromPrivate(Array.from(t),"bytes").getPublic();return P.Buffer.from(r.encode(null,e))}te.publicKeyCreate=th;function pc(t,e){let r=Dn(t);if(r==null)return null;let n=nt.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return P.Buffer.from(n.encode(null,e))}te.publicKeyConvert=pc;function vc(t,e){let r=new pn.default(Array.from(e));if(r.cmp(nt.curve.p)>=0)return null;let n=r.toRed(nt.curve.red),i=n.redSqr().redIMul(n).redIAdd(nt.curve.b).redSqrt();t===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(nt.curve.b)).isZero()?{x:n,y:i}:null}te.loadCompressedPublicKey=vc;function yc(t,e,r){let n=new pn.default(Array.from(e)),i=new pn.default(Array.from(r));if(n.cmp(nt.curve.p)>=0||i.cmp(nt.curve.p)>=0)return null;let s=n.toRed(nt.curve.red),o=i.toRed(nt.curve.red);if((t===6||t===7)&&o.isOdd()!==(t===7))return null;let c=s.redSqr().redIMul(s);return o.redSqr().redISub(c.redIAdd(nt.curve.b)).isZero()?{x:s,y:o}:null}te.loadUncompressedPublicKey=yc});var Ic=D(ee=>{k();q();var rh=ee&&ee.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),nh=ee&&ee.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),gc=ee&&ee.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&rh(e,t,r);return nh(e,t),e},ih=ee&&ee.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ee,"__esModule",{value:!0});ee.ed25519_getDerivedPrivateKey=ee.isValidPath=ee.ed25519_getRandomPrivateKey=ee.ed25519SignTest=ee.fromSecret=ee.fromSeed=ee.privateKeyVerify=ee.publicKeyVerify=ee.publicKeyCreate=ee.verify=ee.sign=ee.ed25519MulBase=void 0;var wc=gc(hn()),Dt=Tn(),ah=ih(Et()),sh=ns(),is=gc(Ys()),fh=En();is.utils.sha512Sync=(...t)=>(0,fh.sha512)(is.utils.concatBytes(...t));var Ar=new wc.eddsa("ed25519"),_c=Ar.curve;function oh(t){let e=Ar.curve.g;return Ar.encodePoint(e.mul(wc.utils.intFromLE(t)))}ee.ed25519MulBase=oh;function xc(t,e){let r=e;r.length==64&&(r=r.slice(0,32));let n=is.sync.sign(t,r);return Uint8Array.from(n)}ee.sign=xc;function Sc(t,e,r){return Ar.keyFromPublic(Array.from(r)).verify(Array.from(t),Array.from(e))}ee.verify=Sc;function qi(t){let e=t;e.length==64&&(e=e.slice(0,32));let n=Ar.keyFromSecret(Array.from(e)).getPublic();if(t.length==64&&!ch(t.slice(32,64),n))throw new Error("invalid public key");return Uint8Array.from(n)}ee.publicKeyCreate=qi;function ch(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function dh(t){let e=Ar.decodePoint(Array.from(t));return _c.validate(e)}ee.publicKeyVerify=dh;function Mc(t){let e=new ah.default(Array.from(t));return e.cmp(_c.n)<0&&!e.isZero()}ee.privateKeyVerify=Mc;function uh(t){let e=Ar.keyFromSecret(Array.from(t)),r=Uint8Array.from(e.getPublic());return{publicKey:r,secretKey:(0,Dt.concatBytes)(t,r)}}ee.fromSeed=uh;function lh(t){let e=t.slice(0,32),r=Ar.keyFromSecret(Array.from(e));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(e)}}ee.fromSecret=lh;function Bc(t){let e=(0,Dt.sha256)("ed25519-test"),r=qi(t),n=xc(e,t);return Sc(e,n,r)}ee.ed25519SignTest=Bc;function hh(t,e){for(;;){let r=(0,Dt.randomBytes)(32);if(Mc(r)&&Bc(r)){let n=qi(r),i=t?(0,Dt.concatBytes)(r,n):r;return e==="base58"?(0,Dt.toBase58)(i):(0,Dt.toHex)(i)}}}ee.ed25519_getRandomPrivateKey=hh;var bh=new RegExp("^m(\\/[0-9]+')+$"),Ac=t=>t.replace("'",""),ph=2147483648;function vh(t){let e=(0,Dt.hmacSHA512)("ed25519 seed",t),r=e.slice(0,32),n=e.slice(32);return{key:r,chainCode:n}}function yh({key:t,chainCode:e},r){let n=P.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=P.Buffer.concat([P.Buffer.alloc(1,0),t,n]),s=(0,Dt.hmacSHA512)(e,i),o=s.slice(0,32),c=s.slice(32);return{key:o,chainCode:c}}var mh=t=>bh.test(t)?!t.split("/").slice(1).map(Ac).some(isNaN):!1;ee.isValidPath=mh;function gh(t,e,r=ph){if(!(0,ee.isValidPath)(t))throw new Error("Invalid derivation path");let{key:n,chainCode:i}=vh(e);return t.split("/").slice(1).map(Ac).map(o=>parseInt(o,10)).reduce((o,c)=>yh(o,c+r),{key:n,chainCode:i})}async function wh(t,e,r,n){let i=await(0,sh.mnemonicToSeedV2)(t),s=gh(e,i).key,o=qi(s),c=r?(0,Dt.concatBytes)(s,o):s;return n==="base58"?Promise.resolve((0,Dt.toBase58)(c)):Promise.resolve((0,Dt.toHex)(c))}ee.ed25519_getDerivedPrivateKey=wh});var qc=D(oe=>{k();q();var _h=oe&&oe.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),xh=oe&&oe.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sh=oe&&oe.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_h(e,t,r);return xh(e,t),e},Mh=oe&&oe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(oe,"__esModule",{value:!0});oe.loadUncompressedPublicKey=oe.loadCompressedPublicKey=oe.publicKeyConvert=oe.publicKeyCreate=oe.publicKeyVerify=oe.privateKeyVerify=oe.loadPublicKey=oe.recover=oe.verify=oe.sign=void 0;var Bh=Sh(hn()),Bt=new Bh.ec("p256"),vn=Mh(Et());function Ah(t,e,r=!0){let n=Bt.sign(Array.from(t),P.Buffer.from(e),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}oe.sign=Ah;function Ih(t,e,r,n){let i=Ec(e,r,t,!1);return i==null?!1:i.equals(n)}oe.verify=Ih;function Ec(t,e,r,n){let i={r:Array.from(t.slice(0,32)),s:Array.from(t.slice(32,64))},s=new vn.default(i.r),o=new vn.default(i.s);if(s.cmp(Bt.curve.n)>=0||o.cmp(Bt.curve.n)>=0||s.isZero()||o.isZero())return null;let c;try{c=Bt.recoverPubKey(Array.from(r),i,e,null)}catch{return null}return P.Buffer.from(c.encode(null,n))}oe.recover=Ec;function as(t){let e=P.Buffer.from(t),r=e[0];switch(r){case 2:case 3:return e.length!==33?null:Pc(r,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:kc(r,e.subarray(1,33),e.subarray(33,65));default:return null}}oe.loadPublicKey=as;function Eh(t){let e=new vn.default(Array.from(t));return e.cmp(Bt.curve.n)<0&&!e.isZero()}oe.privateKeyVerify=Eh;function Ph(t){return as(t)!==null}oe.publicKeyVerify=Ph;function kh(t,e){let r=Bt.keyFromPrivate(Array.from(t),"bytes").getPublic();return P.Buffer.from(r.encode(null,e))}oe.publicKeyCreate=kh;function qh(t,e){let r=as(t);if(r==null)return null;let n=Bt.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return P.Buffer.from(n.encode(null,e))}oe.publicKeyConvert=qh;function Pc(t,e){let r=new vn.default(Array.from(e));if(r.cmp(Bt.curve.p)>=0)return null;let n=r.toRed(Bt.curve.red),i=n.redSqr().redIMul(n).redIAdd(Bt.curve.b).redSqrt();return t===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}oe.loadCompressedPublicKey=Pc;function kc(t,e,r){let n=new vn.default(Array.from(e)),i=new vn.default(Array.from(r));if(n.cmp(Bt.curve.p)>=0||i.cmp(Bt.curve.p)>=0)return null;let s=n.toRed(Bt.curve.red),o=i.toRed(Bt.curve.red);if((t===6||t===7)&&o.isOdd()!==(t===7))return null;let c=s.redSqr().redIMul(s);return o.redSqr().redISub(c.redIAdd(Bt.curve.b)).isZero()?{x:s,y:o}:null}oe.loadUncompressedPublicKey=kc});var sr=D(G=>{k();q();Object.defineProperty(G,"__esModule",{value:!0});G.validateObject=G.createHmacDrbg=G.bitMask=G.bitSet=G.bitGet=G.bitLen=G.utf8ToBytes=G.equalBytes=G.concatBytes=G.ensureBytes=G.numberToVarBytesBE=G.numberToBytesLE=G.numberToBytesBE=G.bytesToNumberLE=G.bytesToNumberBE=G.hexToBytes=G.hexToNumber=G.numberToHexUnpadded=G.bytesToHex=void 0;var Cc=BigInt(0),Oi=BigInt(1),Oh=BigInt(2),Ci=t=>t instanceof Uint8Array,Ch=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function fs(t){if(!Ci(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Ch[t[r]];return e}G.bytesToHex=fs;function Lc(t){let e=t.toString(16);return e.length&1?`0${e}`:e}G.numberToHexUnpadded=Lc;function os(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}G.hexToNumber=os;function Li(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(t.length%2)throw new Error("hex string is invalid: unpadded "+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");e[r]=s}return e}G.hexToBytes=Li;function Lh(t){return os(fs(t))}G.bytesToNumberBE=Lh;function Th(t){if(!Ci(t))throw new Error("Uint8Array expected");return os(fs(Uint8Array.from(t).reverse()))}G.bytesToNumberLE=Th;var Hh=(t,e)=>Li(t.toString(16).padStart(e*2,"0"));G.numberToBytesBE=Hh;var Nh=(t,e)=>(0,G.numberToBytesBE)(t,e).reverse();G.numberToBytesLE=Nh;var Rh=t=>Li(Lc(t));G.numberToVarBytesBE=Rh;function Kh(t,e,r){let n;if(typeof e=="string")try{n=Li(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Ci(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}G.ensureBytes=Kh;function Tc(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Ci(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}G.concatBytes=Tc;function Uh(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}G.equalBytes=Uh;function jh(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}G.utf8ToBytes=jh;function Dh(t){let e;for(e=0;t>Cc;t>>=Oi,e+=1);return e}G.bitLen=Dh;var zh=(t,e)=>t>>BigInt(e)&Oi;G.bitGet=zh;var Vh=(t,e,r)=>t|(r?Oi:Cc)<<BigInt(e);G.bitSet=Vh;var Fh=t=>(Oh<<BigInt(t-1))-Oi;G.bitMask=Fh;var ss=t=>new Uint8Array(t),Oc=t=>Uint8Array.from(t);function Zh(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ss(t),i=ss(t),s=0,o=()=>{n.fill(1),i.fill(0),s=0},c=(...p)=>r(i,n,...p),u=(p=ss())=>{i=c(Oc([0]),p),n=c(),p.length!==0&&(i=c(Oc([1]),p),n=c())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let p=0,S=[];for(;p<e;){n=c();let M=n.slice();S.push(M),p+=n.length}return Tc(...S)};return(p,S)=>{o(),u(p);let M;for(;!(M=S(l()));)u();return o(),M}}G.createHmacDrbg=Zh;var Wh={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function $h(t,e,r={}){let n=(i,s,o)=>{let c=Wh[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);let u=t[i];if(!(o&&u===void 0)&&!c(u,t))throw new Error(`Invalid param ${String(i)}=${u} (${typeof u}), expected ${s}`)};for(let[i,s]of Object.entries(e))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return t}G.validateObject=$h});var jr=D(J=>{k();q();Object.defineProperty(J,"__esModule",{value:!0});J.hashToPrivateScalar=J.FpSqrtEven=J.FpSqrtOdd=J.Field=J.nLength=J.FpIsSquare=J.FpDiv=J.FpInvertBatch=J.FpPow=J.validateField=J.isNegativeLE=J.FpSqrt=J.tonelliShanks=J.invert=J.pow2=J.pow=J.mod=void 0;var fr=sr(),it=BigInt(0),pe=BigInt(1),Ir=BigInt(2),Gh=BigInt(3),cs=BigInt(4),Hc=BigInt(5),Nc=BigInt(8),Xh=BigInt(9),Yh=BigInt(16);function Nt(t,e){let r=t%e;return r>=it?r:e+r}J.mod=Nt;function Rc(t,e,r){if(r<=it||e<it)throw new Error("Expected power/modulo > 0");if(r===pe)return it;let n=pe;for(;e>it;)e&pe&&(n=n*t%r),t=t*t%r,e>>=pe;return n}J.pow=Rc;function Jh(t,e,r){let n=t;for(;e-- >it;)n*=n,n%=r;return n}J.pow2=Jh;function Ti(t,e){if(t===it||e<=it)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Nt(t,e),n=e,i=it,s=pe,o=pe,c=it;for(;r!==it;){let l=n/r,y=n%r,p=i-o*l,S=s-c*l;n=r,r=y,i=o,s=c,o=p,c=S}if(n!==pe)throw new Error("invert: does not exist");return Nt(i,e)}J.invert=Ti;function Kc(t){let e=(t-pe)/Ir,r,n,i;for(r=t-pe,n=0;r%Ir===it;r/=Ir,n++);for(i=Ir;i<t&&Rc(i,e,t)!==t-pe;i++);if(n===1){let o=(t+pe)/cs;return function(u,l){let y=u.pow(l,o);if(!u.eql(u.sqr(y),l))throw new Error("Cannot find square root");return y}}let s=(r+pe)/Ir;return function(c,u){if(c.pow(u,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let l=n,y=c.pow(c.mul(c.ONE,i),r),p=c.pow(u,s),S=c.pow(u,r);for(;!c.eql(S,c.ONE);){if(c.eql(S,c.ZERO))return c.ZERO;let M=1;for(let x=c.sqr(S);M<l&&!c.eql(x,c.ONE);M++)x=c.sqr(x);let A=c.pow(y,pe<<BigInt(l-M-1));y=c.sqr(A),p=c.mul(p,A),S=c.mul(S,y),l=M}return p}}J.tonelliShanks=Kc;function Uc(t){if(t%cs===Gh){let e=(t+pe)/cs;return function(n,i){let s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%Nc===Hc){let e=(t-Hc)/Nc;return function(n,i){let s=n.mul(i,Ir),o=n.pow(s,e),c=n.mul(i,o),u=n.mul(n.mul(c,Ir),o),l=n.mul(c,n.sub(u,n.ONE));if(!n.eql(n.sqr(l),i))throw new Error("Cannot find square root");return l}}return t%Yh,Kc(t)}J.FpSqrt=Uc;var Qh=(t,e)=>(Nt(t,e)&pe)===pe;J.isNegativeLE=Qh;var e1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function t1(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=e1.reduce((n,i)=>(n[i]="function",n),e);return(0,fr.validateObject)(t,r)}J.validateField=t1;function jc(t,e,r){if(r<it)throw new Error("Expected power > 0");if(r===it)return t.ONE;if(r===pe)return e;let n=t.ONE,i=e;for(;r>it;)r&pe&&(n=t.mul(n,i)),i=t.sqr(i),r>>=pe;return n}J.FpPow=jc;function Dc(t,e){let r=new Array(e.length),n=e.reduce((s,o,c)=>t.is0(o)?s:(r[c]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,c)=>t.is0(o)?s:(r[c]=t.mul(s,r[c]),t.mul(s,o)),i),r}J.FpInvertBatch=Dc;function r1(t,e,r){return t.mul(e,typeof r=="bigint"?Ti(r,t.ORDER):t.inv(r))}J.FpDiv=r1;function n1(t){let e=(t.ORDER-pe)/Ir;return r=>{let n=t.pow(r,e);return t.eql(n,t.ZERO)||t.eql(n,t.ONE)}}J.FpIsSquare=n1;function ds(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}J.nLength=ds;function i1(t,e,r=!1,n={}){if(t<=it)throw new Error(`Expected Fp ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:s}=ds(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Uc(t),c=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:(0,fr.bitMask)(i),ZERO:it,ONE:pe,create:u=>Nt(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof u}`);return it<=u&&u<t},is0:u=>u===it,isOdd:u=>(u&pe)===pe,neg:u=>Nt(-u,t),eql:(u,l)=>u===l,sqr:u=>Nt(u*u,t),add:(u,l)=>Nt(u+l,t),sub:(u,l)=>Nt(u-l,t),mul:(u,l)=>Nt(u*l,t),pow:(u,l)=>jc(c,u,l),div:(u,l)=>Nt(u*Ti(l,t),t),sqrN:u=>u*u,addN:(u,l)=>u+l,subN:(u,l)=>u-l,mulN:(u,l)=>u*l,inv:u=>Ti(u,t),sqrt:n.sqrt||(u=>o(c,u)),invertBatch:u=>Dc(c,u),cmov:(u,l,y)=>y?l:u,toBytes:u=>r?(0,fr.numberToBytesLE)(u,s):(0,fr.numberToBytesBE)(u,s),fromBytes:u=>{if(u.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${u.length}`);return r?(0,fr.bytesToNumberLE)(u):(0,fr.bytesToNumberBE)(u)}});return Object.freeze(c)}J.Field=i1;function a1(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?r:t.neg(r)}J.FpSqrtOdd=a1;function s1(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}J.FpSqrtEven=s1;function f1(t,e,r=!1){t=(0,fr.ensureBytes)("privateHash",t);let n=t.length,i=ds(e).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,fr.bytesToNumberLE)(t):(0,fr.bytesToNumberBE)(t);return Nt(s,e-pe)+pe}J.hashToPrivateScalar=f1});var Vc=D(yn=>{k();q();Object.defineProperty(yn,"__esModule",{value:!0});yn.validateBasic=yn.wNAF=void 0;var zc=jr(),o1=sr(),c1=BigInt(0),us=BigInt(1);function d1(t,e){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=t.ZERO,c=i;for(;s>c1;)s&us&&(o=o.add(c)),c=c.double(),s>>=us;return o},precomputeWindow(i,s){let{windows:o,windowSize:c}=n(s),u=[],l=i,y=l;for(let p=0;p<o;p++){y=l,u.push(y);for(let S=1;S<c;S++)y=y.add(l),u.push(y);l=y.double()}return u},wNAF(i,s,o){let{windows:c,windowSize:u}=n(i),l=t.ZERO,y=t.BASE,p=BigInt(2**i-1),S=2**i,M=BigInt(i);for(let A=0;A<c;A++){let x=A*u,E=Number(o&p);o>>=M,E>u&&(E-=S,o+=us);let I=x,C=x+Math.abs(E)-1,O=A%2!==0,L=E<0;E===0?y=y.add(r(O,s[I])):l=l.add(r(L,s[C]))}return{p:l,f:y}},wNAFCached(i,s,o,c){let u=i._WINDOW_SIZE||1,l=s.get(i);return l||(l=this.precomputeWindow(i,u),u!==1&&s.set(i,c(l))),this.wNAF(u,l,o)}}}yn.wNAF=d1;function u1(t){return(0,zc.validateField)(t.Fp),(0,o1.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,zc.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}yn.validateBasic=u1});var Ni=D(ve=>{k();q();var l1=ve&&ve.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),h1=ve&&ve.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Zc=ve&&ve.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&l1(e,t,r);return h1(e,t),e};Object.defineProperty(ve,"__esModule",{value:!0});ve.mapToCurveSimpleSWU=ve.SWUFpSqrtRatio=ve.weierstrass=ve.weierstrassPoints=ve.DER=void 0;var zn=Zc(jr()),Qe=Zc(sr()),Gt=sr(),ls=Vc();function b1(t){let e=(0,ls.validateBasic)(t);Qe.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:p1,hexToBytes:v1}=Qe;ve.DER={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=ve.DER;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:p1(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=ve.DER,r=typeof t=="string"?v1(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:s}=ve.DER._parseInt(r.subarray(2)),{d:o,l:c}=ve.DER._parseInt(s);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(t){let e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,r=l=>{let y=l.toString(16);return y.length&1?`0${y}`:y},n=e(r(t.s)),i=e(r(t.r)),s=n.length/2,o=i.length/2,c=r(s),u=r(o);return`30${r(o+s+4)}02${u}${i}02${c}${n}`}};var zt=BigInt(0),_e=BigInt(1),Er=BigInt(2),Hi=BigInt(3),Fc=BigInt(4);function Wc(t){let e=b1(t),{Fp:r}=e,n=e.toBytes||((A,x,E)=>{let I=x.toAffine();return Qe.concatBytes(Uint8Array.from([4]),r.toBytes(I.x),r.toBytes(I.y))}),i=e.fromBytes||(A=>{let x=A.subarray(1),E=r.fromBytes(x.subarray(0,r.BYTES)),I=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:E,y:I}});function s(A){let{a:x,b:E}=e,I=r.sqr(A),C=r.mul(I,A);return r.add(r.add(C,r.mul(A,x)),E)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(A){return typeof A=="bigint"&&zt<A&&A<e.n}function c(A){if(!o(A))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function u(A){let{allowedPrivateKeyLengths:x,nByteLength:E,wrapPrivateKey:I,n:C}=e;if(x&&typeof A!="bigint"){if(A instanceof Uint8Array&&(A=Qe.bytesToHex(A)),typeof A!="string"||!x.includes(A.length))throw new Error("Invalid key");A=A.padStart(E*2,"0")}let O;try{O=typeof A=="bigint"?A:Qe.bytesToNumberBE((0,Gt.ensureBytes)("private key",A,E))}catch{throw new Error(`private key must be ${E} bytes, hex or bigint, not ${typeof A}`)}return I&&(O=zn.mod(O,C)),c(O),O}let l=new Map;function y(A){if(!(A instanceof p))throw new Error("ProjectivePoint expected")}class p{constructor(x,E,I){if(this.px=x,this.py=E,this.pz=I,x==null||!r.isValid(x))throw new Error("x required");if(E==null||!r.isValid(E))throw new Error("y required");if(I==null||!r.isValid(I))throw new Error("z required")}static fromAffine(x){let{x:E,y:I}=x||{};if(!x||!r.isValid(E)||!r.isValid(I))throw new Error("invalid affine point");if(x instanceof p)throw new Error("projective point not allowed");let C=O=>r.eql(O,r.ZERO);return C(E)&&C(I)?p.ZERO:new p(E,I,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(x){let E=r.invertBatch(x.map(I=>I.pz));return x.map((I,C)=>I.toAffine(E[C])).map(p.fromAffine)}static fromHex(x){let E=p.fromAffine(i((0,Gt.ensureBytes)("pointHex",x)));return E.assertValidity(),E}static fromPrivateKey(x){return p.BASE.multiply(u(x))}_setWindowSize(x){this._WINDOW_SIZE=x,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x,y:E}=this.toAffine();if(!r.isValid(x)||!r.isValid(E))throw new Error("bad point: x or y not FE");let I=r.sqr(E),C=s(x);if(!r.eql(I,C))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:x}=this.toAffine();if(r.isOdd)return!r.isOdd(x);throw new Error("Field doesn't support isOdd")}equals(x){y(x);let{px:E,py:I,pz:C}=this,{px:O,py:L,pz:T}=x,N=r.eql(r.mul(E,T),r.mul(O,C)),U=r.eql(r.mul(I,T),r.mul(L,C));return N&&U}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){let{a:x,b:E}=e,I=r.mul(E,Hi),{px:C,py:O,pz:L}=this,T=r.ZERO,N=r.ZERO,U=r.ZERO,H=r.mul(C,C),Z=r.mul(O,O),_=r.mul(L,L),a=r.mul(C,O);return a=r.add(a,a),U=r.mul(C,L),U=r.add(U,U),T=r.mul(x,U),N=r.mul(I,_),N=r.add(T,N),T=r.sub(Z,N),N=r.add(Z,N),N=r.mul(T,N),T=r.mul(a,T),U=r.mul(I,U),_=r.mul(x,_),a=r.sub(H,_),a=r.mul(x,a),a=r.add(a,U),U=r.add(H,H),H=r.add(U,H),H=r.add(H,_),H=r.mul(H,a),N=r.add(N,H),_=r.mul(O,L),_=r.add(_,_),H=r.mul(_,a),T=r.sub(T,H),U=r.mul(_,Z),U=r.add(U,U),U=r.add(U,U),new p(T,N,U)}add(x){y(x);let{px:E,py:I,pz:C}=this,{px:O,py:L,pz:T}=x,N=r.ZERO,U=r.ZERO,H=r.ZERO,Z=e.a,_=r.mul(e.b,Hi),a=r.mul(E,O),d=r.mul(I,L),h=r.mul(C,T),v=r.add(E,I),b=r.add(O,L);v=r.mul(v,b),b=r.add(a,d),v=r.sub(v,b),b=r.add(E,C);let w=r.add(O,T);return b=r.mul(b,w),w=r.add(a,h),b=r.sub(b,w),w=r.add(I,C),N=r.add(L,T),w=r.mul(w,N),N=r.add(d,h),w=r.sub(w,N),H=r.mul(Z,b),N=r.mul(_,h),H=r.add(N,H),N=r.sub(d,H),H=r.add(d,H),U=r.mul(N,H),d=r.add(a,a),d=r.add(d,a),h=r.mul(Z,h),b=r.mul(_,b),d=r.add(d,h),h=r.sub(a,h),h=r.mul(Z,h),b=r.add(b,h),a=r.mul(d,b),U=r.add(U,a),a=r.mul(w,b),N=r.mul(v,N),N=r.sub(N,a),a=r.mul(v,d),H=r.mul(w,H),H=r.add(H,a),new p(N,U,H)}subtract(x){return this.add(x.negate())}is0(){return this.equals(p.ZERO)}wNAF(x){return M.wNAFCached(this,l,x,E=>{let I=r.invertBatch(E.map(C=>C.pz));return E.map((C,O)=>C.toAffine(I[O])).map(p.fromAffine)})}multiplyUnsafe(x){let E=p.ZERO;if(x===zt)return E;if(c(x),x===_e)return this;let{endo:I}=e;if(!I)return M.unsafeLadder(this,x);let{k1neg:C,k1:O,k2neg:L,k2:T}=I.splitScalar(x),N=E,U=E,H=this;for(;O>zt||T>zt;)O&_e&&(N=N.add(H)),T&_e&&(U=U.add(H)),H=H.double(),O>>=_e,T>>=_e;return C&&(N=N.negate()),L&&(U=U.negate()),U=new p(r.mul(U.px,I.beta),U.py,U.pz),N.add(U)}multiply(x){c(x);let E=x,I,C,{endo:O}=e;if(O){let{k1neg:L,k1:T,k2neg:N,k2:U}=O.splitScalar(E),{p:H,f:Z}=this.wNAF(T),{p:_,f:a}=this.wNAF(U);H=M.constTimeNegate(L,H),_=M.constTimeNegate(N,_),_=new p(r.mul(_.px,O.beta),_.py,_.pz),I=H.add(_),C=Z.add(a)}else{let{p:L,f:T}=this.wNAF(E);I=L,C=T}return p.normalizeZ([I,C])[0]}multiplyAndAddUnsafe(x,E,I){let C=p.BASE,O=(T,N)=>N===zt||N===_e||!T.equals(C)?T.multiplyUnsafe(N):T.multiply(N),L=O(this,E).add(O(x,I));return L.is0()?void 0:L}toAffine(x){let{px:E,py:I,pz:C}=this,O=this.is0();x==null&&(x=O?r.ONE:r.inv(C));let L=r.mul(E,x),T=r.mul(I,x),N=r.mul(C,x);if(O)return{x:r.ZERO,y:r.ZERO};if(!r.eql(N,r.ONE))throw new Error("invZ was invalid");return{x:L,y:T}}isTorsionFree(){let{h:x,isTorsionFree:E}=e;if(x===_e)return!0;if(E)return E(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:x,clearCofactor:E}=e;return x===_e?this:E?E(p,this):this.multiplyUnsafe(e.h)}toRawBytes(x=!0){return this.assertValidity(),n(p,this,x)}toHex(x=!0){return Qe.bytesToHex(this.toRawBytes(x))}}p.BASE=new p(e.Gx,e.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);let S=e.nBitLength,M=(0,ls.wNAF)(p,e.endo?Math.ceil(S/2):S);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:u,weierstrassEquation:s,isWithinCurveOrder:o}}ve.weierstrassPoints=Wc;function y1(t){let e=(0,ls.validateBasic)(t);return Qe.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function m1(t){let e=y1(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function o(b){return zt<b&&b<r.ORDER}function c(b){return zn.mod(b,n)}function u(b){return zn.invert(b,n)}let{ProjectivePoint:l,normPrivateKeyToScalar:y,weierstrassEquation:p,isWithinCurveOrder:S}=Wc({...e,toBytes(b,w,B){let m=w.toAffine(),f=r.toBytes(m.x),g=Qe.concatBytes;return B?g(Uint8Array.from([w.hasEvenY()?2:3]),f):g(Uint8Array.from([4]),f,r.toBytes(m.y))},fromBytes(b){let w=b.length,B=b[0],m=b.subarray(1);if(w===i&&(B===2||B===3)){let f=Qe.bytesToNumberBE(m);if(!o(f))throw new Error("Point is not on curve");let g=p(f),R=r.sqrt(g),K=(R&_e)===_e;return(B&1)===1!==K&&(R=r.neg(R)),{x:f,y:R}}else if(w===s&&B===4){let f=r.fromBytes(m.subarray(0,r.BYTES)),g=r.fromBytes(m.subarray(r.BYTES,2*r.BYTES));return{x:f,y:g}}else throw new Error(`Point of length ${w} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),M=b=>Qe.bytesToHex(Qe.numberToBytesBE(b,e.nByteLength));function A(b){let w=n>>_e;return b>w}function x(b){return A(b)?c(-b):b}let E=(b,w,B)=>Qe.bytesToNumberBE(b.slice(w,B));class I{constructor(w,B,m){this.r=w,this.s=B,this.recovery=m,this.assertValidity()}static fromCompact(w){let B=e.nByteLength;return w=(0,Gt.ensureBytes)("compactSignature",w,B*2),new I(E(w,0,B),E(w,B,2*B))}static fromDER(w){let{r:B,s:m}=ve.DER.toSig((0,Gt.ensureBytes)("DER",w));return new I(B,m)}assertValidity(){if(!S(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!S(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(w){return new I(this.r,this.s,w)}recoverPublicKey(w){let{r:B,s:m,recovery:f}=this,g=U((0,Gt.ensureBytes)("msgHash",w));if(f==null||![0,1,2,3].includes(f))throw new Error("recovery id invalid");let R=f===2||f===3?B+e.n:B;if(R>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let K=(f&1)===0?"02":"03",V=l.fromHex(K+M(R)),F=u(R),Y=c(-g*F),re=c(m*F),lt=l.BASE.multiplyAndAddUnsafe(V,Y,re);if(!lt)throw new Error("point at infinify");return lt.assertValidity(),lt}hasHighS(){return A(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Qe.hexToBytes(this.toDERHex())}toDERHex(){return ve.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Qe.hexToBytes(this.toCompactHex())}toCompactHex(){return M(this.r)+M(this.s)}}let C={isValidPrivateKey(b){try{return y(b),!0}catch{return!1}},normPrivateKeyToScalar:y,randomPrivateKey:()=>{let b=e.randomBytes(r.BYTES+8),w=zn.hashToPrivateScalar(b,n);return Qe.numberToBytesBE(w,e.nByteLength)},precompute(b=8,w=l.BASE){return w._setWindowSize(b),w.multiply(BigInt(3)),w}};function O(b,w=!0){return l.fromPrivateKey(b).toRawBytes(w)}function L(b){let w=b instanceof Uint8Array,B=typeof b=="string",m=(w||B)&&b.length;return w?m===i||m===s:B?m===2*i||m===2*s:b instanceof l}function T(b,w,B=!0){if(L(b))throw new Error("first arg must be private key");if(!L(w))throw new Error("second arg must be public key");return l.fromHex(w).multiply(y(b)).toRawBytes(B)}let N=e.bits2int||function(b){let w=Qe.bytesToNumberBE(b),B=b.length*8-e.nBitLength;return B>0?w>>BigInt(B):w},U=e.bits2int_modN||function(b){return c(N(b))},H=Qe.bitMask(e.nBitLength);function Z(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(zt<=b&&b<H))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Qe.numberToBytesBE(b,e.nByteLength)}function _(b,w,B=a){if(["recovered","canonical"].some(ne=>ne in B))throw new Error("sign() legacy options not supported");let{hash:m,randomBytes:f}=e,{lowS:g,prehash:R,extraEntropy:K}=B;g==null&&(g=!0),b=(0,Gt.ensureBytes)("msgHash",b),R&&(b=(0,Gt.ensureBytes)("prehashed msgHash",m(b)));let V=U(b),F=y(w),Y=[Z(F),Z(V)];if(K!=null){let ne=K===!0?f(r.BYTES):K;Y.push((0,Gt.ensureBytes)("extraEntropy",ne,r.BYTES))}let re=Qe.concatBytes(...Y),lt=V;function fe(ne){let Yt=N(ne);if(!S(Yt))return;let ye=u(Yt),ie=l.BASE.multiply(Yt).toAffine(),Jt=c(ie.x);if(Jt===zt)return;let le=c(ye*c(lt+Jt*F));if(le===zt)return;let me=(ie.x===Jt?0:2)|Number(ie.y&_e),Bn=le;return g&&A(le)&&(Bn=x(le),me^=1),new I(Jt,Bn,me)}return{seed:re,k2sig:fe}}let a={lowS:e.lowS,prehash:!1},d={lowS:e.lowS,prehash:!1};function h(b,w,B=a){let{seed:m,k2sig:f}=_(b,w,B),g=e;return Qe.createHmacDrbg(g.hash.outputLen,g.nByteLength,g.hmac)(m,f)}l.BASE._setWindowSize(8);function v(b,w,B,m=d){let f=b;if(w=(0,Gt.ensureBytes)("msgHash",w),B=(0,Gt.ensureBytes)("publicKey",B),"strict"in m)throw new Error("options.strict was renamed to lowS");let{lowS:g,prehash:R}=m,K,V;try{if(typeof f=="string"||f instanceof Uint8Array)try{K=I.fromDER(f)}catch(ie){if(!(ie instanceof ve.DER.Err))throw ie;K=I.fromCompact(f)}else if(typeof f=="object"&&typeof f.r=="bigint"&&typeof f.s=="bigint"){let{r:ie,s:Jt}=f;K=new I(ie,Jt)}else throw new Error("PARSE");V=l.fromHex(B)}catch(ie){if(ie.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(g&&K.hasHighS())return!1;R&&(w=e.hash(w));let{r:F,s:Y}=K,re=U(w),lt=u(Y),fe=c(re*lt),ne=c(F*lt),Yt=l.BASE.multiplyAndAddUnsafe(V,fe,ne)?.toAffine();return Yt?c(Yt.x)===F:!1}return{CURVE:e,getPublicKey:O,getSharedSecret:T,sign:h,verify:v,ProjectivePoint:l,Signature:I,utils:C}}ve.weierstrass=m1;function $c(t,e){let r=t.ORDER,n=zt;for(let A=r-_e;A%Er===zt;A/=Er)n+=_e;let i=n,s=Er<<i-_e-_e,o=s*Er,c=(r-_e)/o,u=(c-_e)/Er,l=o-_e,y=s,p=t.pow(e,c),S=t.pow(e,(c+_e)/Er),M=(A,x)=>{let E=p,I=t.pow(x,l),C=t.sqr(I);C=t.mul(C,x);let O=t.mul(A,C);O=t.pow(O,u),O=t.mul(O,I),I=t.mul(O,x),C=t.mul(O,A);let L=t.mul(C,I);O=t.pow(L,y);let T=t.eql(O,t.ONE);I=t.mul(C,S),O=t.mul(L,E),C=t.cmov(I,C,T),L=t.cmov(O,L,T);for(let N=i;N>_e;N--){let U=N-Er;U=Er<<U-_e;let H=t.pow(L,U),Z=t.eql(H,t.ONE);I=t.mul(C,E),E=t.mul(E,E),H=t.mul(L,E),C=t.cmov(I,C,Z),L=t.cmov(H,L,Z)}return{isValid:T,value:C}};if(t.ORDER%Fc===Hi){let A=(t.ORDER-Hi)/Fc,x=t.sqrt(t.neg(e));M=(E,I)=>{let C=t.sqr(I),O=t.mul(E,I);C=t.mul(C,O);let L=t.pow(C,A);L=t.mul(L,O);let T=t.mul(L,x),N=t.mul(t.sqr(L),I),U=t.eql(N,E),H=t.cmov(T,L,U);return{isValid:U,value:H}}}return M}ve.SWUFpSqrtRatio=$c;function g1(t,e){if(zn.validateField(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=$c(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,c,u,l,y,p;i=t.sqr(n),i=t.mul(i,e.Z),s=t.sqr(i),s=t.add(s,i),o=t.add(s,t.ONE),o=t.mul(o,e.B),c=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),c=t.mul(c,e.A),s=t.sqr(o),l=t.sqr(c),u=t.mul(l,e.A),s=t.add(s,u),s=t.mul(s,o),l=t.mul(l,c),u=t.mul(l,e.B),s=t.add(s,u),y=t.mul(i,o);let{isValid:S,value:M}=r(s,l);p=t.mul(i,n),p=t.mul(p,M),y=t.cmov(y,o,S),p=t.cmov(p,M,S);let A=t.isOdd(n)===t.isOdd(p);return p=t.cmov(t.neg(p),p,A),y=t.div(y,c),{x:y,y:p}}}ve.mapToCurveSimpleSWU=g1});var Qc=D(xe=>{k();q();Object.defineProperty(xe,"__esModule",{value:!0});xe.createHasher=xe.isogenyMap=xe.hash_to_field=xe.expand_message_xof=xe.expand_message_xmd=xe.isNum=xe.isBytes=xe.strxor=xe.i2osp=xe.validateDST=void 0;var w1=jr(),Vt=sr();function Gc(t){if(t instanceof Uint8Array)return t;if(typeof t=="string")return(0,Vt.utf8ToBytes)(t);throw new Error("DST must be Uint8Array or string")}xe.validateDST=Gc;var _1=Vt.bytesToNumberBE;function or(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);let r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}xe.i2osp=or;function Xc(t,e){let r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}xe.strxor=Xc;function mn(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}xe.isBytes=mn;function Ri(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}xe.isNum=Ri;function Yc(t,e,r,n){mn(t),mn(e),Ri(r),e.length>255&&(e=n((0,Vt.concatBytes)((0,Vt.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));let{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(o>255)throw new Error("Invalid xmd length");let c=(0,Vt.concatBytes)(e,or(e.length,1)),u=or(0,s),l=or(r,2),y=new Array(o),p=n((0,Vt.concatBytes)(u,t,l,or(0,1),c));y[0]=n((0,Vt.concatBytes)(p,or(1,1),c));for(let M=1;M<=o;M++){let A=[Xc(p,y[M-1]),or(M+1,1),c];y[M]=n((0,Vt.concatBytes)(...A))}return(0,Vt.concatBytes)(...y).slice(0,r)}xe.expand_message_xmd=Yc;function Jc(t,e,r,n,i){if(mn(t),mn(e),Ri(r),e.length>255){let s=Math.ceil(2*n/8);e=i.create({dkLen:s}).update((0,Vt.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(or(r,2)).update(e).update(or(e.length,1)).digest()}xe.expand_message_xof=Jc;function hs(t,e,r){(0,Vt.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:o,expand:c,DST:u}=r;mn(t),Ri(e);let l=Gc(u),y=n.toString(2).length,p=Math.ceil((y+i)/8),S=e*s*p,M;if(c==="xmd")M=Yc(t,l,S,o);else if(c==="xof")M=Jc(t,l,S,i,o);else if(c==="_internal_pass")M=t;else throw new Error('expand must be "xmd" or "xof"');let A=new Array(e);for(let x=0;x<e;x++){let E=new Array(s);for(let I=0;I<s;I++){let C=p*(I+x*s),O=M.subarray(C,C+p);E[I]=(0,w1.mod)(_1(O),n)}A[x]=E}return A}xe.hash_to_field=hs;function x1(t,e){let r=e.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,o,c,u]=r.map(l=>l.reduce((y,p)=>t.add(t.mul(y,n),p)));return n=t.div(s,o),i=t.mul(i,t.div(c,u)),{x:n,y:i}}}xe.isogenyMap=x1;function S1(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=hs(n,2,{...r,DST:r.DST,...i}),o=t.fromAffine(e(s[0])),c=t.fromAffine(e(s[1])),u=o.add(c).clearCofactor();return u.assertValidity(),u},encodeToCurve(n,i){let s=hs(n,1,{...r,DST:r.encodeDST,...i}),o=t.fromAffine(e(s[0])).clearCofactor();return o.assertValidity(),o}}}xe.createHasher=S1});var bs=D(gn=>{k();q();Object.defineProperty(gn,"__esModule",{value:!0});gn.createCurve=gn.getHash=void 0;var M1=Cn(),e0=ht(),B1=Ni();function t0(t){return{hash:t,hmac:(e,...r)=>(0,M1.hmac)(t,e,(0,e0.concatBytes)(...r)),randomBytes:e0.randomBytes}}gn.getHash=t0;function A1(t,e){let r=n=>(0,B1.weierstrass)({...t,...t0(n)});return Object.freeze({...r(e),create:r})}gn.createCurve=A1});var u0=D(et=>{k();q();var I1=et&&et.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),E1=et&&et.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),P1=et&&et.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&I1(e,t,r);return E1(e,t),e},ps;Object.defineProperty(et,"__esModule",{value:!0});et.encodeToCurve=et.hashToCurve=et.schnorr=et.secp256k1=void 0;var Ki=Wr(),k1=ht(),ut=jr(),q1=Ni(),gt=sr(),i0=P1(Qc()),O1=bs(),zi=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ui=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),a0=BigInt(1),ji=BigInt(2),r0=(t,e)=>(t+e/ji)/e;function s0(t){let e=zi,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),c=BigInt(44),u=BigInt(88),l=t*t*t%e,y=l*l*t%e,p=(0,ut.pow2)(y,r,e)*y%e,S=(0,ut.pow2)(p,r,e)*y%e,M=(0,ut.pow2)(S,ji,e)*l%e,A=(0,ut.pow2)(M,i,e)*M%e,x=(0,ut.pow2)(A,s,e)*A%e,E=(0,ut.pow2)(x,c,e)*x%e,I=(0,ut.pow2)(E,u,e)*E%e,C=(0,ut.pow2)(I,c,e)*x%e,O=(0,ut.pow2)(C,r,e)*y%e,L=(0,ut.pow2)(O,o,e)*A%e,T=(0,ut.pow2)(L,n,e)*l%e,N=(0,ut.pow2)(T,ji,e);if(!Pr.eql(Pr.sqr(N),t))throw new Error("Cannot find square root");return N}var Pr=(0,ut.Field)(zi,void 0,void 0,{sqrt:s0});et.secp256k1=(0,O1.createCurve)({a:BigInt(0),b:BigInt(7),Fp:Pr,n:Ui,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=Ui,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-a0*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),c=r0(s*t,e),u=r0(-n*t,e),l=(0,ut.mod)(t-c*r-u*i,e),y=(0,ut.mod)(-c*n-u*s,e),p=l>o,S=y>o;if(p&&(l=e-l),S&&(y=e-y),l>o||y>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:p,k1:l,k2neg:S,k2:y}}}},Ki.sha256);var Vi=BigInt(0),f0=t=>typeof t=="bigint"&&Vi<t&&t<zi,C1=t=>typeof t=="bigint"&&Vi<t&&t<Ui,n0={};function Di(t,...e){let r=n0[t];if(r===void 0){let n=(0,Ki.sha256)(Uint8Array.from(t,i=>i.charCodeAt(0)));r=(0,gt.concatBytes)(n,n),n0[t]=r}return(0,Ki.sha256)((0,gt.concatBytes)(r,...e))}var gs=t=>t.toRawBytes(!0).slice(1),ys=t=>(0,gt.numberToBytesBE)(t,32),vs=t=>(0,ut.mod)(t,zi),Vn=t=>(0,ut.mod)(t,Ui),ws=et.secp256k1.ProjectivePoint,L1=(t,e,r)=>ws.BASE.multiplyAndAddUnsafe(t,e,r);function ms(t){let e=et.secp256k1.utils.normPrivateKeyToScalar(t),r=ws.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:Vn(-e),bytes:gs(r)}}function o0(t){if(!f0(t))throw new Error("bad x: need 0 < x < p");let e=vs(t*t),r=vs(e*t+BigInt(7)),n=s0(r);n%ji!==Vi&&(n=vs(-n));let i=new ws(t,n,a0);return i.assertValidity(),i}function c0(...t){return Vn((0,gt.bytesToNumberBE)(Di("BIP0340/challenge",...t)))}function T1(t){return ms(t).bytes}function H1(t,e,r=(0,k1.randomBytes)(32)){let n=(0,gt.ensureBytes)("message",t),{bytes:i,scalar:s}=ms(e),o=(0,gt.ensureBytes)("auxRand",r,32),c=ys(s^(0,gt.bytesToNumberBE)(Di("BIP0340/aux",o))),u=Di("BIP0340/nonce",c,i,n),l=Vn((0,gt.bytesToNumberBE)(u));if(l===Vi)throw new Error("sign failed: k is zero");let{bytes:y,scalar:p}=ms(l),S=c0(y,i,n),M=new Uint8Array(64);if(M.set(y,0),M.set(ys(Vn(p+S*s)),32),!d0(M,n,i))throw new Error("sign: Invalid signature produced");return M}function d0(t,e,r){let n=(0,gt.ensureBytes)("signature",t,64),i=(0,gt.ensureBytes)("message",e),s=(0,gt.ensureBytes)("publicKey",r,32);try{let o=o0((0,gt.bytesToNumberBE)(s)),c=(0,gt.bytesToNumberBE)(n.subarray(0,32));if(!f0(c))return!1;let u=(0,gt.bytesToNumberBE)(n.subarray(32,64));if(!C1(u))return!1;let l=c0(ys(c),gs(o),i),y=L1(o,u,Vn(-l));return!(!y||!y.hasEvenY()||y.toAffine().x!==c)}catch{return!1}}et.schnorr={getPublicKey:T1,sign:H1,verify:d0,utils:{randomPrivateKey:et.secp256k1.utils.randomPrivateKey,lift_x:o0,pointToBytes:gs,numberToBytesBE:gt.numberToBytesBE,bytesToNumberBE:gt.bytesToNumberBE,taggedHash:Di,mod:ut.mod}};var N1=i0.isogenyMap(Pr,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),R1=(0,q1.mapToCurveSimpleSWU)(Pr,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Pr.create(BigInt("-11"))});ps=i0.createHasher(et.secp256k1.ProjectivePoint,t=>{let{x:e,y:r}=R1(Pr.create(t[0]));return N1(e,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Pr.ORDER,m:1,k:128,expand:"xmd",hash:Ki.sha256}),et.hashToCurve=ps.hashToCurve,et.encodeToCurve=ps.encodeToCurve});var b0=D(kr=>{k();q();Object.defineProperty(kr,"__esModule",{value:!0});kr.poseidon=kr.splitConstants=kr.validateOpts=void 0;var l0=jr();function h0(t){let{Fp:e}=t;(0,l0.validateField)(e);for(let u of["t","roundsFull","roundsPartial"])if(typeof t[u]!="number"||!Number.isSafeInteger(t[u]))throw new Error(`Poseidon: invalid param ${u}=${t[u]} (${typeof t[u]})`);if(t.reversePartialPowIdx!==void 0&&typeof t.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${t.reversePartialPowIdx}`);let r=t.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=u=>(0,l0.FpPow)(e,u,n);if(r===3?i=u=>e.mul(e.sqrN(u),u):r===5&&(i=u=>e.mul(e.sqrN(e.sqrN(u)),u)),t.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${t.roundsFull}`);let s=t.roundsFull+t.roundsPartial;if(!Array.isArray(t.roundConstants)||t.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let o=t.roundConstants.map(u=>{if(!Array.isArray(u)||u.length!==t.t)throw new Error(`Poseidon wrong round constants: ${u}`);return u.map(l=>{if(typeof l!="bigint"||!e.isValid(l))throw new Error(`Poseidon wrong round constant=${l}`);return e.create(l)})});if(!Array.isArray(t.mds)||t.mds.length!==t.t)throw new Error("Poseidon: wrong MDS matrix");let c=t.mds.map(u=>{if(!Array.isArray(u)||u.length!==t.t)throw new Error(`Poseidon MDS matrix row: ${u}`);return u.map(l=>{if(typeof l!="bigint")throw new Error(`Poseidon MDS matrix value=${l}`);return e.create(l)})});return Object.freeze({...t,rounds:s,sboxFn:i,roundConstants:o,mds:c})}kr.validateOpts=h0;function K1(t,e){if(typeof e!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(t)||t.length%e)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<t.length;i++)n.push(t[i]),n.length===e&&(r.push(n),n=[]);return r}kr.splitConstants=K1;function U1(t){let{t:e,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=h0(t),o=Math.floor(t.roundsFull/2),c=s?e-1:0,u=(y,p,S)=>(y=y.map((M,A)=>r.add(M,t.roundConstants[S][A])),p?y=y.map(M=>i(M)):y[c]=i(y[c]),y=t.mds.map(M=>M.reduce((A,x,E)=>r.add(A,r.mulN(x,y[E])),r.ZERO)),y),l=function(p){if(!Array.isArray(p)||p.length!==e)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${e})`);p=p.map(M=>{if(typeof M!="bigint")throw new Error(`Poseidon: wrong value=${M} (${typeof M})`);return r.create(M)});let S=0;for(let M=0;M<o;M++)p=u(p,!0,S++);for(let M=0;M<t.roundsPartial;M++)p=u(p,!1,S++);for(let M=0;M<o;M++)p=u(p,!0,S++);if(S!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${S}, total=${n}`);return p};return l.roundConstants=t.roundConstants,l}kr.poseidon=U1});var I0=D(z=>{k();q();var j1=z&&z.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),D1=z&&z.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),z1=z&&z.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&j1(e,t,r);return D1(e,t),e};Object.defineProperty(z,"__esModule",{value:!0});z.poseidonHashMany=z.poseidonHashSingle=z.poseidonHashFunc=z.poseidonHash=z.poseidonSmall=z.poseidonCreate=z.poseidonBasic=z._poseidonMDS=z.Fp251=z.Fp253=z.keccak=z.computeHashOnElements=z.hashChain=z.pedersen=z.getAccountPath=z.ethSigToPrivate=z.getStarkKey=z.grindKey=z.utils=z.Signature=z.ProjectivePoint=z.CURVE=z.verify=z.sign=z.getSharedSecret=z.getPublicKey=z._starkCurve=void 0;var V1=ni(),Ss=Wr(),F1=ht(),zr=jr(),Z1=b0(),W1=Ni(),wt=z1(sr()),$1=bs(),Zi=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),y0=252;function p0(t){for(;t[0]===0;)t=t.subarray(1);let e=t.length*8-y0,r=wt.bytesToNumberBE(t);return e>0?r>>BigInt(e):r}function m0(t){return typeof t=="string"&&(t=Bs(t),t.length&1&&(t="0"+t)),wt.hexToBytes(t)}var Vr=(0,W1.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,zr.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:Zi,nBitLength:y0,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,$1.getHash)(Ss.sha256),bits2int:p0,bits2int_modN:t=>{let e=wt.bytesToNumberBE(t).toString(16);return e.length===63&&(t=m0(e+"0")),(0,zr.mod)(p0(t),Zi)}});z._starkCurve=Vr;function Dr(t){return wt.ensureBytes("",typeof t=="string"?m0(t):t)}function Ms(t){return wt.bytesToHex(Dr(t)).padStart(64,"0")}function g0(t,e=!1){return Vr.getPublicKey(Ms(t),e)}z.getPublicKey=g0;function G1(t,e){return Vr.getSharedSecret(Ms(t),e)}z.getSharedSecret=G1;function X1(t,e,r){return Vr.sign(Dr(t),Ms(e),r)}z.sign=X1;function Y1(t,e,r){let n=t instanceof w0?t:Dr(t);return Vr.verify(n,Dr(e),Dr(r))}z.verify=Y1;var{CURVE:J1,ProjectivePoint:wn,Signature:w0,utils:Q1}=Vr;z.CURVE=J1;z.ProjectivePoint=wn;z.Signature=w0;z.utils=Q1;function _0(t){return`0x${wt.bytesToHex(t.subarray(1)).replace(/^0+/gm,"")}`}function Bs(t){return t.replace(/^0x/i,"")}function eb(t){return`0x${t.toString(16)}`}function x0(t){let e=Dr(t),r=2n**256n,n=r-(0,zr.mod)(r,Zi);for(let i=0;;i++){let s=_s(wt.concatBytes(e,wt.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,zr.mod)(s,Zi).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}z.grindKey=x0;function tb(t){return _0(g0(t,!0))}z.getStarkKey=tb;function rb(t){if(t=Bs(t),t.length!==130)throw new Error("Wrong ethereum signature");return x0(t.substring(0,64))}z.ethSigToPrivate=rb;var nb=2n**31n-1n,Fi=t=>Number(t&nb);function ib(t,e,r,n){let i=Fi(_s(t)),s=Fi(_s(e)),o=wt.hexToNumber(Bs(r));return`m/2645'/${i}'/${s}'/${Fi(o)}'/${Fi(o>>31n)}'/${n}`}z.getAccountPath=ib;var Fn=[new wn(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new wn(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new wn(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new wn(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new wn(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function S0(t,e){let r=[],n=t;for(let i=0;i<248;i++)r.push(n),n=n.double();n=e;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var ab=S0(Fn[1],Fn[2]),sb=S0(Fn[3],Fn[4]);function M0(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"){if(!Number.isSafeInteger(t))throw new Error(`Invalid pedersenArg: ${t}`);e=BigInt(t)}else e=wt.bytesToNumberBE(Dr(t));if(!(0n<=e&&e<Vr.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${e}`);return e}function v0(t,e,r){let n=M0(e);for(let i=0;i<252;i++){let s=r[i];if(s.equals(t))throw new Error("Same point");(n&1n)!==0n&&(t=t.add(s)),n>>=1n}return t}function As(t,e){let r=Fn[0];return r=v0(r,t,ab),r=v0(r,e,sb),_0(r.toRawBytes(!0))}z.pedersen=As;function fb(t,e=As){if(!Array.isArray(t)||t.length<1)throw new Error("data should be array of at least 1 element");return t.length===1?eb(M0(t[0])):Array.from(t).reverse().reduce((r,n)=>e(n,r))}z.hashChain=fb;var ob=(t,e=As)=>[0,...t,t.length].reduce((r,n)=>e(r,n));z.computeHashOnElements=ob;var cb=wt.bitMask(250),db=t=>wt.bytesToNumberBE((0,V1.keccak_256)(t))&cb;z.keccak=db;var _s=t=>wt.bytesToNumberBE((0,Ss.sha256)(t));z.Fp253=(0,zr.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));z.Fp251=(0,zr.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function xs(t,e,r){let n=t.fromBytes((0,Ss.sha256)((0,F1.utf8ToBytes)(`${e}${r}`)));return t.create(n)}function B0(t,e,r,n=0){let i=[],s=[];for(let o=0;o<r;o++)i.push(xs(t,`${e}x`,n*r+o)),s.push(xs(t,`${e}y`,n*r+o));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(o=>s.map(c=>t.inv(t.sub(o,c))))}z._poseidonMDS=B0;var ub=[[3,1,1],[1,-1,1],[1,1,-2]].map(t=>t.map(BigInt));function Is(t,e){if((0,zr.validateField)(t.Fp),!Number.isSafeInteger(t.rate)||!Number.isSafeInteger(t.capacity))throw new Error(`Wrong poseidon opts: ${t}`);let r=t.rate+t.capacity,n=t.roundsFull+t.roundsPartial,i=[];for(let o=0;o<n;o++){let c=[];for(let u=0;u<r;u++)c.push(xs(t.Fp,"Hades",r*o+u));i.push(c)}let s=(0,Z1.poseidon)({...t,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:e,roundConstants:i});return s.m=r,s.rate=t.rate,s.capacity=t.capacity,s}z.poseidonBasic=Is;function lb(t,e=0){let r=t.rate+t.capacity;if(!Number.isSafeInteger(e))throw new Error(`Wrong mdsAttempt=${e}`);return Is(t,B0(t.Fp,"HadesMDS",r,e))}z.poseidonCreate=lb;z.poseidonSmall=Is({Fp:z.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},ub);function A0(t,e,r=z.poseidonSmall){return r([t,e,2n])[0]}z.poseidonHash=A0;function hb(t,e,r=z.poseidonSmall){return wt.numberToVarBytesBE(A0(wt.bytesToNumberBE(t),wt.bytesToNumberBE(e),r))}z.poseidonHashFunc=hb;function bb(t,e=z.poseidonSmall){return e([t,0n,1n])[0]}z.poseidonHashSingle=bb;function pb(t,e=z.poseidonSmall){let{m:r,rate:n}=e;if(!Array.isArray(t))throw new Error("bigint array expected in values");let i=Array.from(t);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let o=0;o<i.length;o+=n){for(let c=0;c<n;c++)s[c]+=i[o+c];s=e(s)}return s[0]}z.poseidonHashMany=pb});var k0=D(_t=>{k();q();var vb=_t&&_t.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),yb=_t&&_t.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),E0=_t&&_t.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&vb(e,t,r);return yb(e,t),e};Object.defineProperty(_t,"__esModule",{value:!0});_t.bytesToHex=_t.hexToBytes=_t.stark=_t.secp256k1=void 0;_t.secp256k1=E0(u0());_t.stark=E0(I0());var P0=sr();Object.defineProperty(_t,"hexToBytes",{enumerable:!0,get:function(){return P0.hexToBytes}});Object.defineProperty(_t,"bytesToHex",{enumerable:!0,get:function(){return P0.bytesToHex}})});var q0=D(xt=>{k();q();var mb=xt&&xt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),gb=xt&&xt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Wi=xt&&xt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&mb(e,t,r);return gb(e,t),e};Object.defineProperty(xt,"__esModule",{value:!0});xt.schnorr=xt.p256=xt.ed25519=xt.secp256k1=void 0;xt.secp256k1=Wi(mc());xt.ed25519=Wi(Ic());xt.p256=Wi(qc());xt.schnorr=Wi(k0())});var Es=D(tt=>{k();q();var wb=tt&&tt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_b=tt&&tt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_n=tt&&tt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wb(e,t,r);return _b(e,t),e};Object.defineProperty(tt,"__esModule",{value:!0});tt.secp256k1=tt.ed25519=tt.signUtil=tt.elliptic=tt.bip39=tt.bip32=void 0;tt.bip32=_n(Qo());tt.bip39=_n(ns());tt.elliptic=_n(hn());tt.signUtil=_n(q0());tt.ed25519=_n(Ys());tt.secp256k1=_n(dd())});var Gi=D($i=>{k();q();Object.defineProperty($i,"__esModule",{value:!0});$i.validate=void 0;function xb(t,e){if(!t)throw new Error(e)}$i.validate=xb});var C0=D(Xi=>{k();q();Object.defineProperty(Xi,"__esModule",{value:!0});Xi.convert=void 0;var O0=Gi();function Sb(t,e,r,n){for(var i=n?Math.floor(t.length*e/r):Math.ceil(t.length*e/r),s=(1<<r)-1,o=new Uint8Array(i),c=0,u=0,l=0,y=0;y<t.length;++y){var p=t[y];for((0,O0.validate)(0<=p&&p>>e===0,"Invalid value: "+p+"."),u=u<<e|p,l+=e;l>=r;)l-=r,o[c]=u>>l&s,++c}return n?(0,O0.validate)(l<e&&(u<<r-l&s)===0,"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):l>0&&(o[c]=u<<r-l&s,++c),o}Xi.convert=Sb});var H0=D(xn=>{k();q();Object.defineProperty(xn,"__esModule",{value:!0});xn.decode=xn.encode=void 0;var T0=Gi(),Mb="qpzry9x8gf2tvdw0s3jn54khce6mua7l",L0={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};function Bb(t){for(var e="",r=0;r<t.length;++r){var n=t[r];(0,T0.validate)(0<=n&&n<32,"Invalid value: "+n+"."),e+=Mb[n]}return e}xn.encode=Bb;function Ab(t){for(var e=new Uint8Array(t.length),r=0;r<t.length;++r){var n=t[r];(0,T0.validate)(n in L0,"Invalid value: "+n+"."),e[r]=L0[n]}return e}xn.decode=Ab});var Ps=D(Rt=>{k();q();var Ib=Rt&&Rt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Eb=Rt&&Rt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pb=Rt&&Rt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Ib(e,t,r);return Eb(e,t),e};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.payToAddrScript=Rt.encodePubKeyAddress=void 0;var Yi=Gi(),R0=C0(),K0=Pb(H0()),kb=Zn();function qb(t,e){let r=[0,0,0,0,0,0,0,0],n=U0(e).concat([0]),i=0,s=Array.prototype.slice.call(kb.base.fromHex(t),0),o=(0,R0.convert)(new Uint8Array([i].concat(s)),8,5,!1),c=new Uint8Array(n.length+o.length+r.length);c.set(n),c.set(o,n.length),c.set(r,n.length+o.length);let u=Lb(j0(c)),l=new Uint8Array(o.length+u.length);return l.set(o),l.set(u,o.length),"kaspa:"+K0.encode(l)}Rt.encodePubKeyAddress=qb;function Ob(t){(0,Yi.validate)(Cb(t),"Mixed case"),t=t.toLowerCase();let e=t.split(":");(0,Yi.validate)(e.length===2,"Invalid format: "+t);let r=e[0];(0,Yi.validate)(r==="kaspa","Invalid prefix: "+t);let n=e[1],i=K0.decode(n);(0,Yi.validate)(Tb(r,i),"Invalid checksum: "+t);let s=(0,R0.convert)(i.slice(0,-8),5,8,!0),o=s[0],c=s.slice(1);switch(o){case 0:if(c.length!==32)throw new Error("Invalid Schnorr public key length");return P.Buffer.concat([P.Buffer.from([32]),c,P.Buffer.from([172])]);case 1:if(c.length!==33)throw new Error("Invalid ECDSA public key length");return P.Buffer.concat([P.Buffer.from([33]),c,P.Buffer.from([171])]);case 8:if(c.length!==32)throw new Error("Invalid script hash length");return P.Buffer.concat([P.Buffer.from([170]),P.Buffer.from([32]),c,P.Buffer.from([135])]);default:throw new Error(`Unsupported address version: ${o}`)}}Rt.payToAddrScript=Ob;function Cb(t){return t===t.toLowerCase()||t===t.toUpperCase()}function U0(t){let e=[];for(let r=0;r<t.length;r++)e.push(t.charCodeAt(r)&31);return e}function Lb(t){let e=[];for(let r=0;r<8;++r)e.push(t&31),t/=32;return e.reverse()}function Tb(t,e){let r=U0(t),n=new Uint8Array(t.length+1+e.length);return n.set(r),n.set([0],r.length),n.set(e,r.length+1),j0(n)===0}var N0=[152,121,243,174,30],Hb=[4072443489,3077413346,1046459332,783016616,1329849456];function j0(t){for(var e=0,r=1,n=0,i=0;i<t.length;i++){n=e>>>3,e&=7,e<<=5,e|=r>>>27,r&=134217727,r<<=5,r^=t[i];for(var s=0;s<N0.length;++s)n&1<<s&&(e^=N0[s],r^=Hb[s])}return r^=1,r<0&&(r^=1<<31,r+=(1<<30)*2),e*(1<<30)*4+r}});var ks=D(Kt=>{k();q();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.validateAddress=Kt.addressFromPrvKey=Kt.addressFromPubKey=Kt.checkPrvKey=Kt.pubKeyFromPrvKey=void 0;var Ji=Zn(),Nb=Es(),D0=Ps();function z0(t){if(!V0(t))throw new Error("invalid key");return Ji.base.toHex(Nb.signUtil.secp256k1.publicKeyCreate(Ji.base.fromHex(t.toLowerCase()),!0).slice(1))}Kt.pubKeyFromPrvKey=z0;function V0(t){if(!Ji.base.validateHexString(t))return!1;let e=Ji.base.fromHex(t.toLowerCase());return e.length==32&&!e.every(r=>r===0)}Kt.checkPrvKey=V0;function F0(t){return(0,D0.encodePubKeyAddress)(t,"kaspa")}Kt.addressFromPubKey=F0;function Rb(t){return F0(z0(t))}Kt.addressFromPrvKey=Rb;function Kb(t){try{(0,D0.payToAddrScript)(t)}catch{return!1}return!0}Kt.validateAddress=Kb});var Cs=D(Xt=>{k();q();Object.defineProperty(Xt,"__esModule",{value:!0});Xt.Transaction=Xt.signMessage=Xt.calcTxHash=Xt.transfer=void 0;var yt=Zn(),$0=Es(),qs=Ps(),Ub=P.Buffer.from("TransactionSigningHash"),jb=P.Buffer.from("TransactionID"),Db=P.Buffer.from("PersonalMessageSigningHash");function zb(t,e){return Sn.fromTxData(t).sign(e).getMessage()}Xt.transfer=zb;function Vb(t){let e=new cr;return e.writeUInt16LE(t.version),e.writeUInt64LE(BigInt(t.inputs.length)),t.inputs.forEach(r=>{e.writeHash(yt.base.fromHex(r.previousOutpoint.transactionId)),e.writeUInt32LE(r.previousOutpoint.index),e.writeVarBytes(P.Buffer.alloc(0)),e.writeUInt64LE(BigInt(r.sequence))}),e.writeUInt64LE(BigInt(t.outputs.length)),t.outputs.forEach(r=>{e.writeUInt64LE(BigInt(r.amount)),e.writeUInt16LE(r.scriptPublicKey.version),e.writeVarBytes(yt.base.fromHex(r.scriptPublicKey.scriptPublicKey))}),e.writeUInt64LE(BigInt(t.lockTime)),e.writeHash(yt.base.fromHex(t.subnetworkId)),e.writeUInt64LE(0n),e.writeVarBytes(P.Buffer.alloc(0)),yt.base.toHex(yt.base.blake2(e.toBuffer(),256,jb))}Xt.calcTxHash=Vb;function Fb(t,e){let r=yt.base.blake2(P.Buffer.from(t),256,Db),n=$0.signUtil.schnorr.secp256k1.schnorr.sign(r,yt.base.toHex(yt.base.fromHex(e)));return yt.base.toHex(n)}Xt.signMessage=Fb;var Sn=class{static fromTxData(e){return new Sn(e)}constructor(e){this.version=0,this.inputs=[],this.outputs=[],this.lockTime="0",this.subnetworkId="0000000000000000000000000000000000000000",this.utxos=[];let r=0n;e.inputs.forEach(s=>{this.inputs.push({previousOutpoint:{transactionId:s.txId,index:s.vOut},signatureScript:"",sequence:"0",sigOpCount:1}),this.utxos.push({pkScript:(0,qs.payToAddrScript)(s.address),amount:s.amount}),r+=BigInt(s.amount)});let n=0n;e.outputs.forEach(s=>{this.outputs.push({scriptPublicKey:{version:0,scriptPublicKey:yt.base.toHex((0,qs.payToAddrScript)(s.address))},amount:s.amount}),n+=BigInt(s.amount)});let i=r-n-BigInt(e.fee);i>=BigInt(e.dustSize||546)&&this.outputs.push({scriptPublicKey:{version:0,scriptPublicKey:yt.base.toHex((0,qs.payToAddrScript)(e.address))},amount:i.toString()})}sign(e){return this.inputs.forEach((r,n)=>{let i=$b(this,Z0,n,{}),s=$0.signUtil.schnorr.secp256k1.schnorr.sign(i,yt.base.toHex(yt.base.fromHex(e)));r.signatureScript=yt.base.toHex(P.Buffer.concat([P.Buffer.from([65]),s,P.Buffer.from([Z0])]))}),this}getMessage(){return JSON.stringify({transaction:{version:this.version,inputs:this.inputs,outputs:this.outputs,lockTime:this.lockTime,subnetworkId:this.subnetworkId},allowOrphan:!1})}};Xt.Transaction=Sn;var Z0=1,Zb=2,Wb=4,W0=128,G0=7;function X0(t){return(t&G0)===Zb}function Y0(t){return(t&G0)===Wb}function Os(t){return(t&W0)===W0}function $b(t,e,r,n={}){let i=new cr;i.writeUInt16LE(t.version),i.writeHash(Xb(t,e,n)),i.writeHash(Yb(t,e,n)),i.writeHash(Jb(t,e,n));let s=t.inputs[r],o=t.utxos[r];return J0(i,s),i.writeUInt16LE(0),i.writeVarBytes(o.pkScript),i.writeUInt64LE(BigInt(o.amount)),i.writeUInt64LE(BigInt(s.sequence)),i.writeUInt8(1),i.writeHash(Qb(t,r,e,n)),i.writeUInt64LE(BigInt(t.lockTime)),i.writeHash(Gb()),i.writeUInt64LE(0n),i.writeHash(Mn()),i.writeUInt8(e),i.finalize()}function Mn(){return P.Buffer.alloc(32)}function Gb(){return P.Buffer.alloc(20)}function Xb(t,e,r){if(Os(e))return Mn();if(!r.previousOutputsHash){let n=new cr;t.inputs.forEach(i=>J0(n,i)),r.previousOutputsHash=n.finalize()}return r.previousOutputsHash}function Yb(t,e,r){if(Y0(e)||Os(e)||X0(e))return Mn();if(!r.sequencesHash){let n=new cr;t.inputs.forEach(i=>n.writeUInt64LE(BigInt(i.sequence))),r.sequencesHash=n.finalize()}return r.sequencesHash}function Jb(t,e,r){if(Os(e))return Mn();if(!r.sigOpCountsHash){let n=new cr;t.inputs.forEach(i=>n.writeUInt8(1)),r.sigOpCountsHash=n.finalize()}return r.sigOpCountsHash}function Qb(t,e,r,n){if(X0(r))return Mn();if(Y0(r))return e>=t.outputs.length?Mn():new cr().finalize();if(!n.outputsHash){let i=new cr;t.outputs.forEach(s=>e2(i,s)),n.outputsHash=i.finalize()}return n.outputsHash}function J0(t,e){t.writeHash(yt.base.fromHex(e.previousOutpoint.transactionId)),t.writeUInt32LE(e.previousOutpoint.index)}function e2(t,e){t.writeUInt64LE(BigInt(e.amount)),t.writeUInt16LE(0),t.writeVarBytes(yt.base.fromHex(e.scriptPublicKey.scriptPublicKey))}var cr=class{constructor(){this.bufLen=0,this.bufs=[]}toBuffer(){return this.concat()}concat(){return P.Buffer.concat(this.bufs,this.bufLen)}write(e){return this.bufs.push(e),this.bufLen+=e.length,this}writeReverse(e){return this.bufs.push(e.reverse()),this.bufLen+=e.length,this}writeHash(e){return this.write(e),this}writeVarBytes(e){return this.writeUInt64LE(BigInt(e.length)),this.write(e),this}writeUInt8(e){let r=P.Buffer.alloc(1);return r.writeUInt8(e),this.write(r),this}writeUInt16LE(e){let r=P.Buffer.alloc(2);return r.writeUInt16LE(e),this.write(r),this}writeUInt32LE(e){let r=P.Buffer.alloc(4);return r.writeUInt32LE(e,0),this.write(r),this}writeUInt64LE(e){let r=P.Buffer.alloc(8);return r.writeBigUInt64LE(e),this.write(r),this}finalize(){return yt.base.blake2(this.toBuffer(),256,Ub)}}});var Q0=D(ta=>{k();q();Object.defineProperty(ta,"__esModule",{value:!0});ta.KaspaWallet=void 0;var dr=Zn(),Qi=ks(),ea=Cs(),Ls=class extends dr.BaseWallet{async getDerivedPath(e){return`m/44'/111111'/0'/0/${e.index}`}async getNewAddress(e){return Promise.resolve({address:(0,Qi.addressFromPrvKey)(e.privateKey),publicKey:(0,Qi.pubKeyFromPrvKey)(e.privateKey)})}async validPrivateKey(e){let n={isValid:(0,Qi.checkPrvKey)(e.privateKey),privateKey:e.privateKey};return Promise.resolve(n)}async validAddress(e){return Promise.resolve({isValid:(0,Qi.validateAddress)(e.address),address:e.address})}async signTransaction(e){try{if(!e.privateKey)return Promise.reject(dr.InvalidPrivateKeyError);let r=e.data;for(let i of r.outputs)if(!(await this.validAddress({address:i.address})).isValid)return Promise.reject(dr.ValidAddressError);return(await this.validAddress({address:r.address})).isValid?Promise.resolve((0,ea.transfer)(e.data,e.privateKey)):Promise.reject(dr.ValidAddressError)}catch{return Promise.reject(dr.SignTxError)}}async calcTxHash(e){try{return typeof e.data=="string"?Promise.resolve((0,ea.calcTxHash)(JSON.parse(e.data).transaction)):Promise.resolve((0,ea.calcTxHash)(e.data.transaction))}catch{return Promise.reject(dr.CalcTxHashError)}}async signMessage(e){if(!e.privateKey)return Promise.reject(`${dr.InvalidPrivateKeyError}: cannot be empty`);let{isValid:r}=await this.validPrivateKey({privateKey:e.privateKey});if(!r)return Promise.reject(`${dr.InvalidPrivateKeyError}: not valid private key`);try{return Promise.resolve((0,ea.signMessage)(e.data.message,e.privateKey))}catch{return Promise.reject(dr.SignTxError)}}};ta.KaspaWallet=Ls});var r2=D(ur=>{k();q();var t2=ur&&ur.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ts=ur&&ur.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&t2(e,t,r)};Object.defineProperty(ur,"__esModule",{value:!0});Ts(Q0(),ur);Ts(ks(),ur);Ts(Cs(),ur)});export{r2 as a};
//# sourceMappingURL=chunk-GNYTNXQK.js.map
