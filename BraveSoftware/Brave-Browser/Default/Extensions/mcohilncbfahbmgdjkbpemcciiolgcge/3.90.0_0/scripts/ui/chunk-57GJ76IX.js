import{a as uw,b as Kc,c as Ka,d as fw}from"./chunk-CHEPP27E.js";import{b as ow,g as aw,h as z0,j as le}from"./chunk-VONUGAVN.js";import{a as cw}from"./chunk-QI2KSP5Y.js";import{a as Od}from"./chunk-EL77VG5Z.js";import{a as iw,b as sw}from"./chunk-26XSB24L.js";import{c as Qv,d as ew,e as tw,i as V0,j as rw,k as W0,l as nw}from"./chunk-PDIVTGDM.js";import{c as Id}from"./chunk-UL6IEE2K.js";import{d as La}from"./chunk-4ARIYUS3.js";import{c as H,o as w,p,q as S}from"./chunk-UWURTNRY.js";var pn=H(is=>{w();S();Object.defineProperty(is,"__esModule",{value:!0});is.testnet=is.regtest=is.bitcoin=void 0;is.bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};is.regtest={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};is.testnet={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}});var Bd=H(ss=>{w();S();Object.defineProperty(ss,"__esModule",{value:!0});ss.encode=ss.decode=ss.check=void 0;function dw(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;let t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;let r=e[5+t];return!(r===0||6+t+r!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||r>1&&e[t+6]===0&&!(e[t+7]&128))}ss.check=dw;function lw(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");let t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");let r=e[5+t];if(r===0)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(r>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}ss.decode=lw;function hw(e,t){let r=e.length,n=t.length;if(r===0)throw new Error("R length is zero");if(n===0)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(n>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(n>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");let i=p.Buffer.allocUnsafe(6+r+n);return i[0]=48,i[1]=i.length-2,i[2]=2,i[3]=e.length,e.copy(i,4),i[4+r]=2,i[5+r]=t.length,t.copy(i,6+r),i}ss.encode=hw});var $s=H(Oo=>{w();S();Object.defineProperty(Oo,"__esModule",{value:!0});Oo.REVERSE_OPS=Oo.OPS=void 0;var Md={OP_FALSE:0,OP_0:0,OP_DATA_1:1,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};Oo.OPS=Md;var X0={};Oo.REVERSE_OPS=X0;for(let e of Object.keys(Md)){let t=Md[e];X0[t]=e}});var $0=H(as=>{w();S();Object.defineProperty(as,"__esModule",{value:!0});as.decode=as.encode=as.encodingLength=void 0;var os=$s();function Y0(e){return e<os.OPS.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}as.encodingLength=Y0;function pw(e,t,r){let n=Y0(t);return n===1?e.writeUInt8(t,r):n===2?(e.writeUInt8(os.OPS.OP_PUSHDATA1,r),e.writeUInt8(t,r+1)):n===3?(e.writeUInt8(os.OPS.OP_PUSHDATA2,r),e.writeUInt16LE(t,r+1)):(e.writeUInt8(os.OPS.OP_PUSHDATA4,r),e.writeUInt32LE(t,r+1)),n}as.encode=pw;function bw(e,t){let r=e.readUInt8(t),n,i;if(r<os.OPS.OP_PUSHDATA1)n=r,i=1;else if(r===os.OPS.OP_PUSHDATA1){if(t+2>e.length)return null;n=e.readUInt8(t+1),i=2}else if(r===os.OPS.OP_PUSHDATA2){if(t+3>e.length)return null;n=e.readUInt16LE(t+1),i=3}else{if(t+5>e.length)return null;if(r!==os.OPS.OP_PUSHDATA4)throw new Error("Unexpected opcode");n=e.readUInt32LE(t+1),i=5}return{opcode:r,number:n,size:i}}as.decode=bw});var Z0=H(Bo=>{w();S();Object.defineProperty(Bo,"__esModule",{value:!0});Bo.encode=Bo.decode=void 0;function gw(e,t,r){t=t||4,r=r===void 0?!0:r;let n=e.length;if(n===0)return 0;if(n>t)throw new TypeError("Script number overflow");if(r&&(e[n-1]&127)===0&&(n<=1||(e[n-2]&128)===0))throw new Error("Non-minimally encoded script number");if(n===5){let s=e.readUInt32LE(0),o=e.readUInt8(4);return o&128?-((o&-129)*4294967296+s):o*4294967296+s}let i=0;for(let s=0;s<n;++s)i|=e[s]<<8*s;return e[n-1]&128?-(i&~(128<<8*(n-1))):i}Bo.decode=gw;function yw(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function mw(e){let t=Math.abs(e),r=yw(t),n=p.Buffer.allocUnsafe(r),i=e<0;for(let s=0;s<r;++s)n.writeUInt8(t&255,s),t>>=8;return n[r-1]&128?n.writeUInt8(i?128:0,r-1):i&&(n[r-1]|=128),n}Bo.encode=mw});var Or=H($=>{w();S();Object.defineProperty($,"__esModule",{value:!0});$.oneOf=$.Null=$.BufferN=$.Function=$.UInt32=$.UInt8=$.tuple=$.maybe=$.Hex=$.Buffer=$.String=$.Boolean=$.Array=$.Number=$.Hash256bit=$.Hash160bit=$.Buffer256bit=$.isTaptree=$.isTapleaf=$.TAPLEAF_VERSION_MASK=$.Satoshi=$.Signer=$.BIP32Path=$.UInt31=$.isPoint=$.typeforce=void 0;var Dc=La(),nt=le();Object.defineProperty($,"typeforce",{enumerable:!0,get:function(){return nt.typeforce}});var J0=Dc.Buffer.alloc(32,0),Q0=Dc.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");function _w(e){if(!Dc.Buffer.isBuffer(e)||e.length<33)return!1;let t=e[0],r=e.slice(1,33);if(r.compare(J0)===0||r.compare(Q0)>=0)return!1;if((t===2||t===3)&&e.length===33)return!0;let n=e.slice(33);return n.compare(J0)===0||n.compare(Q0)>=0?!1:t===4&&e.length===65}$.isPoint=_w;var vw=Math.pow(2,31)-1;function ww(e){return nt.typeforce.UInt32(e)&&e<=vw}$.UInt31=ww;function ep(e){return nt.typeforce.String(e)&&!!e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}$.BIP32Path=ep;ep.toJSON=()=>"BIP32 derivation path";function Sw(e){return(nt.typeforce.Buffer(e.publicKey)||typeof e.getPublicKey=="function")&&typeof e.sign=="function"}$.Signer=Sw;var xw=21*1e14;function Pw(e){return nt.typeforce.UInt53(e)&&e<=xw}$.Satoshi=Pw;$.TAPLEAF_VERSION_MASK=254;function tp(e){return!e||!("output"in e)||!Dc.Buffer.isBuffer(e.output)?!1:e.version!==void 0?(e.version&$.TAPLEAF_VERSION_MASK)===e.version:!0}$.isTapleaf=tp;function rp(e){return(0,$.Array)(e)?e.length!==2?!1:e.every(t=>rp(t)):tp(e)}$.isTaptree=rp;$.Buffer256bit=nt.typeforce.BufferN(32);$.Hash160bit=nt.typeforce.BufferN(20);$.Hash256bit=nt.typeforce.BufferN(32);$.Number=nt.typeforce.Number;$.Array=nt.typeforce.Array;$.Boolean=nt.typeforce.Boolean;$.String=nt.typeforce.String;$.Buffer=nt.typeforce.Buffer;$.Hex=nt.typeforce.Hex;$.maybe=nt.typeforce.maybe;$.tuple=nt.typeforce.tuple;$.UInt8=nt.typeforce.UInt8;$.UInt32=nt.typeforce.UInt32;$.Function=nt.typeforce.Function;$.BufferN=nt.typeforce.BufferN;$.Null=nt.typeforce.Null;$.oneOf=nt.typeforce.oneOf});var cp=H(mn=>{w();S();var Tw=mn&&mn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ew=mn&&mn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),op=mn&&mn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Tw(t,e,r);return Ew(t,e),t};Object.defineProperty(mn,"__esModule",{value:!0});mn.encode=mn.decode=void 0;var ap=op(Bd()),Cd=op(Or()),{typeforce:Aw}=Cd,np=p.Buffer.alloc(1,0);function ip(e){let t=0;for(;e[t]===0;)++t;return t===e.length?np:(e=e.slice(t),e[0]&128?p.Buffer.concat([np,e],1+e.length):e)}function sp(e){e[0]===0&&(e=e.slice(1));let t=p.Buffer.alloc(32,0),r=Math.max(0,32-e.length);return e.copy(t,r),t}function Iw(e){let t=e.readUInt8(e.length-1),r=t&-193;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);let n=ap.decode(e.slice(0,-1)),i=sp(n.r),s=sp(n.s);return{signature:p.Buffer.concat([i,s],64),hashType:t}}mn.decode=Iw;function Ow(e,t){Aw({signature:Cd.BufferN(64),hashType:Cd.UInt8},{signature:e,hashType:t});let r=t&-193;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);let n=p.Buffer.allocUnsafe(1);n.writeUInt8(t,0);let i=ip(e.slice(0,32)),s=ip(e.slice(32,64));return p.Buffer.concat([ap.encode(i,s),n])}mn.encode=Ow});var Ft=H(xe=>{w();S();var Bw=xe&&xe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Mw=xe&&xe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ja=xe&&xe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Bw(t,e,r);return Mw(t,e),t};Object.defineProperty(xe,"__esModule",{value:!0});xe.signature=xe.number=xe.isCanonicalScriptSignature=xe.isDefinedHashType=xe.isCanonicalPubKey=xe.toStack=xe.fromASM=xe.toASM=xe.decompile=xe.compile=xe.isPushOnly=xe.OPS=void 0;var Cw=ja(Bd()),Xr=$s();Object.defineProperty(xe,"OPS",{enumerable:!0,get:function(){return Xr.OPS}});var kd=ja($0()),up=ja(Z0()),kw=ja(cp()),oi=ja(Or()),{typeforce:Da}=oi,fp=Xr.OPS.OP_RESERVED;function Hw(e){return oi.Number(e)&&(e===Xr.OPS.OP_0||e>=Xr.OPS.OP_1&&e<=Xr.OPS.OP_16||e===Xr.OPS.OP_1NEGATE)}function Nw(e){return oi.Buffer(e)||Hw(e)}function dp(e){return oi.Array(e)&&e.every(Nw)}xe.isPushOnly=dp;function jc(e){if(e.length===0)return Xr.OPS.OP_0;if(e.length===1){if(e[0]>=1&&e[0]<=16)return fp+e[0];if(e[0]===129)return Xr.OPS.OP_1NEGATE}}function lp(e){return p.Buffer.isBuffer(e)}function Rw(e){return oi.Array(e)}function Fc(e){return p.Buffer.isBuffer(e)}function hp(e){if(lp(e))return e;Da(oi.Array,e);let t=e.reduce((i,s)=>Fc(s)?s.length===1&&jc(s)!==void 0?i+1:i+kd.encodingLength(s.length)+s.length:i+1,0),r=p.Buffer.allocUnsafe(t),n=0;if(e.forEach(i=>{if(Fc(i)){let s=jc(i);if(s!==void 0){r.writeUInt8(s,n),n+=1;return}n+=kd.encode(r,i.length,n),i.copy(r,n),n+=i.length}else r.writeUInt8(i,n),n+=1}),n!==r.length)throw new Error("Could not decode chunks");return r}xe.compile=hp;function Hd(e){if(Rw(e))return e;Da(oi.Buffer,e);let t=[],r=0;for(;r<e.length;){let n=e[r];if(n>Xr.OPS.OP_0&&n<=Xr.OPS.OP_PUSHDATA4){let i=kd.decode(e,r);if(i===null||(r+=i.size,r+i.number>e.length))return null;let s=e.slice(r,r+i.number);r+=i.number;let o=jc(s);o!==void 0?t.push(o):t.push(s)}else t.push(n),r+=1}return t}xe.decompile=Hd;function Uw(e){return lp(e)&&(e=Hd(e)),e.map(t=>{if(Fc(t)){let r=jc(t);if(r===void 0)return t.toString("hex");t=r}return Xr.REVERSE_OPS[t]}).join(" ")}xe.toASM=Uw;function qw(e){return Da(oi.String,e),hp(e.split(" ").map(t=>Xr.OPS[t]!==void 0?Xr.OPS[t]:(Da(oi.Hex,t),p.Buffer.from(t,"hex"))))}xe.fromASM=qw;function Lw(e){return e=Hd(e),Da(dp,e),e.map(t=>Fc(t)?t:t===Xr.OPS.OP_0?p.Buffer.allocUnsafe(0):up.encode(t-fp))}xe.toStack=Lw;function Kw(e){return oi.isPoint(e)}xe.isCanonicalPubKey=Kw;function pp(e){let t=e;return t&128&&(t=t&-129),t&64&&(t=t&-65),t>0&&t<4}xe.isDefinedHashType=pp;function Dw(e){return!p.Buffer.isBuffer(e)||!pp(e[e.length-1])?!1:Cw.check(e.slice(0,-1))}xe.isCanonicalScriptSignature=Dw;xe.number=up;xe.signature=kw});var Ui=H(Mo=>{w();S();Object.defineProperty(Mo,"__esModule",{value:!0});Mo.value=Mo.prop=void 0;function jw(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){let n=r.call(this);return this[t]=n,n},set(n){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:n,writable:!0})}})}Mo.prop=jw;function Fw(e){let t;return()=>(t!==void 0||(t=e()),t)}Mo.value=Fw});var mp=H(ai=>{w();S();var Gw=ai&&ai.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Vw=ai&&ai.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),yp=ai&&ai.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Gw(t,e,r);return Vw(t,e),t};Object.defineProperty(ai,"__esModule",{value:!0});ai.p2data=void 0;var Ww=pn(),Gc=yp(Ft()),qi=Or(),bp=yp(Ui()),gp=Gc.OPS;function zw(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Xw(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,qi.typeforce)({network:qi.typeforce.maybe(qi.typeforce.Object),output:qi.typeforce.maybe(qi.typeforce.Buffer),data:qi.typeforce.maybe(qi.typeforce.arrayOf(qi.typeforce.Buffer))},e);let n={name:"embed",network:e.network||Ww.bitcoin};if(bp.prop(n,"output",()=>{if(!!e.data)return Gc.compile([gp.OP_RETURN].concat(e.data))}),bp.prop(n,"data",()=>{if(!!e.output)return Gc.decompile(e.output).slice(1)}),t.validate&&e.output){let i=Gc.decompile(e.output);if(i[0]!==gp.OP_RETURN)throw new TypeError("Output is invalid");if(!i.slice(1).every(qi.typeforce.Buffer))throw new TypeError("Output is invalid");if(e.data&&!zw(e.data,n.data))throw new TypeError("Data mismatch")}return Object.assign(n,e)}ai.p2data=Xw});var wp=H(ci=>{w();S();var Yw=ci&&ci.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),$w=ci&&ci.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),vp=ci&&ci.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Yw(t,e,r);return $w(t,e),t};Object.defineProperty(ci,"__esModule",{value:!0});ci.p2ms=void 0;var Zw=pn(),Co=vp(Ft()),Jt=Or(),cs=vp(Ui()),ko=Co.OPS,Vc=ko.OP_RESERVED;function _p(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Jw(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==void 0)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{});function r(c){return Co.isCanonicalScriptSignature(c)||(t.allowIncomplete&&c===ko.OP_0)!==void 0}(0,Jt.typeforce)({network:Jt.typeforce.maybe(Jt.typeforce.Object),m:Jt.typeforce.maybe(Jt.typeforce.Number),n:Jt.typeforce.maybe(Jt.typeforce.Number),output:Jt.typeforce.maybe(Jt.typeforce.Buffer),pubkeys:Jt.typeforce.maybe(Jt.typeforce.arrayOf(Jt.isPoint)),signatures:Jt.typeforce.maybe(Jt.typeforce.arrayOf(r)),input:Jt.typeforce.maybe(Jt.typeforce.Buffer)},e);let i={network:e.network||Zw.bitcoin},s=[],o=!1;function a(c){o||(o=!0,s=Co.decompile(c),i.m=s[0]-Vc,i.n=s[s.length-2]-Vc,i.pubkeys=s.slice(1,-2))}if(cs.prop(i,"output",()=>{if(!!e.m&&!!i.n&&!!e.pubkeys)return Co.compile([].concat(Vc+e.m,e.pubkeys,Vc+i.n,ko.OP_CHECKMULTISIG))}),cs.prop(i,"m",()=>{if(!!i.output)return a(i.output),i.m}),cs.prop(i,"n",()=>{if(!!i.pubkeys)return i.pubkeys.length}),cs.prop(i,"pubkeys",()=>{if(!!e.output)return a(e.output),i.pubkeys}),cs.prop(i,"signatures",()=>{if(!!e.input)return Co.decompile(e.input).slice(1)}),cs.prop(i,"input",()=>{if(!!e.signatures)return Co.compile([ko.OP_0].concat(e.signatures))}),cs.prop(i,"witness",()=>{if(!!i.input)return[]}),cs.prop(i,"name",()=>{if(!(!i.m||!i.n))return`p2ms(${i.m} of ${i.n})`}),t.validate){if(e.output){if(a(e.output),!Jt.typeforce.Number(s[0]))throw new TypeError("Output is invalid");if(!Jt.typeforce.Number(s[s.length-2]))throw new TypeError("Output is invalid");if(s[s.length-1]!==ko.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(i.m<=0||i.n>16||i.m>i.n||i.n!==s.length-3)throw new TypeError("Output is invalid");if(!i.pubkeys.every(c=>(0,Jt.isPoint)(c)))throw new TypeError("Output is invalid");if(e.m!==void 0&&e.m!==i.m)throw new TypeError("m mismatch");if(e.n!==void 0&&e.n!==i.n)throw new TypeError("n mismatch");if(e.pubkeys&&!_p(e.pubkeys,i.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==void 0&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(i.n=e.pubkeys.length,i.n<i.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<i.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>i.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==ko.OP_0)throw new TypeError("Input is invalid");if(i.signatures.length===0||!i.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!_p(e.signatures,i.signatures))throw new TypeError("Signature mismatch");if(e.m!==void 0&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(i,e)}ci.p2ms=Jw});var Pp=H(ui=>{w();S();var Qw=ui&&ui.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),e3=ui&&ui.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),xp=ui&&ui.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Qw(t,e,r);return e3(t,e),t};Object.defineProperty(ui,"__esModule",{value:!0});ui.p2pk=void 0;var t3=pn(),No=xp(Ft()),Yn=Or(),Ho=xp(Ui()),Sp=No.OPS;function r3(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Yn.typeforce)({network:Yn.typeforce.maybe(Yn.typeforce.Object),output:Yn.typeforce.maybe(Yn.typeforce.Buffer),pubkey:Yn.typeforce.maybe(Yn.isPoint),signature:Yn.typeforce.maybe(No.isCanonicalScriptSignature),input:Yn.typeforce.maybe(Yn.typeforce.Buffer)},e);let r=Ho.value(()=>No.decompile(e.input)),i={name:"p2pk",network:e.network||t3.bitcoin};if(Ho.prop(i,"output",()=>{if(!!e.pubkey)return No.compile([e.pubkey,Sp.OP_CHECKSIG])}),Ho.prop(i,"pubkey",()=>{if(!!e.output)return e.output.slice(1,-1)}),Ho.prop(i,"signature",()=>{if(!!e.input)return r()[0]}),Ho.prop(i,"input",()=>{if(!!e.signature)return No.compile([e.signature])}),Ho.prop(i,"witness",()=>{if(!!i.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==Sp.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!(0,Yn.isPoint)(i.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(i.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(i.input))throw new TypeError("Signature mismatch");if(e.input){if(r().length!==1)throw new TypeError("Input is invalid");if(!No.isCanonicalScriptSignature(i.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(i,e)}ui.p2pk=r3});var vr=H(_n=>{w();S();Object.defineProperty(_n,"__esModule",{value:!0});_n.taggedHash=_n.hash256=_n.hash160=_n.sha256=_n.ripemd160=void 0;var Tp=le();function Ep(e){return p.Buffer.from(Tp.base.ripemd160(e))}_n.ripemd160=Ep;function Ro(e){return p.Buffer.from(Tp.base.sha256(e))}_n.sha256=Ro;function n3(e){return Ep(Ro(e))}_n.hash160=n3;function i3(e){return Ro(Ro(e))}_n.hash256=i3;var s3=["BIP0340/challenge","BIP0340/aux","BIP0340/nonce","TapLeaf","TapBranch","TapSighash","TapTweak","KeyAgg list","KeyAgg coefficient"],o3=Object.fromEntries(s3.map(e=>{let t=Ro(p.Buffer.from(e));return[e,p.Buffer.concat([t,t])]}));function a3(e,t){return Ro(p.Buffer.concat([o3[e],t]))}_n.taggedHash=a3});var Ip=H(fi=>{w();S();var c3=fi&&fi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),u3=fi&&fi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Rd=fi&&fi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&c3(t,e,r);return u3(t,e),t};Object.defineProperty(fi,"__esModule",{value:!0});fi.p2pkh=void 0;var Nd=Rd(vr()),f3=pn(),Uo=Rd(Ft()),Kr=Or(),Li=Rd(Ui()),us=Uo.OPS,Ap=le();function d3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Kr.typeforce)({network:Kr.typeforce.maybe(Kr.typeforce.Object),address:Kr.typeforce.maybe(Kr.typeforce.String),hash:Kr.typeforce.maybe(Kr.typeforce.BufferN(20)),output:Kr.typeforce.maybe(Kr.typeforce.BufferN(25)),pubkey:Kr.typeforce.maybe(Kr.isPoint),signature:Kr.typeforce.maybe(Uo.isCanonicalScriptSignature),input:Kr.typeforce.maybe(Kr.typeforce.Buffer)},e);let r=Li.value(()=>{let o=Ap.base.fromBase58Check(e.address),a=o.readUInt8(0),c=o.slice(1);return{version:a,hash:c}}),n=Li.value(()=>Uo.decompile(e.input)),i=e.network||f3.bitcoin,s={name:"p2pkh",network:i};if(Li.prop(s,"address",()=>{if(!s.hash)return;let o=p.Buffer.allocUnsafe(21);return o.writeUInt8(i.pubKeyHash,0),s.hash.copy(o,1),Ap.base.toBase58Check(o)}),Li.prop(s,"hash",()=>{if(e.output)return e.output.slice(3,23);if(e.address)return r().hash;if(e.pubkey||s.pubkey)return Nd.hash160(e.pubkey||s.pubkey)}),Li.prop(s,"output",()=>{if(!!s.hash)return Uo.compile([us.OP_DUP,us.OP_HASH160,s.hash,us.OP_EQUALVERIFY,us.OP_CHECKSIG])}),Li.prop(s,"pubkey",()=>{if(!!e.input)return n()[1]}),Li.prop(s,"signature",()=>{if(!!e.input)return n()[0]}),Li.prop(s,"input",()=>{if(!!e.pubkey&&!!e.signature)return Uo.compile([e.signature,e.pubkey])}),Li.prop(s,"witness",()=>{if(!!s.input)return[]}),t.validate){let o=p.Buffer.from([]);if(e.address){if(r().version!==i.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(r().hash.length!==20)throw new TypeError("Invalid address");o=r().hash}if(e.hash){if(o.length>0&&!o.equals(e.hash))throw new TypeError("Hash mismatch");o=e.hash}if(e.output){if(e.output.length!==25||e.output[0]!==us.OP_DUP||e.output[1]!==us.OP_HASH160||e.output[2]!==20||e.output[23]!==us.OP_EQUALVERIFY||e.output[24]!==us.OP_CHECKSIG)throw new TypeError("Output is invalid");let a=e.output.slice(3,23);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.pubkey){let a=Nd.hash160(e.pubkey);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.input){let a=n();if(a.length!==2)throw new TypeError("Input is invalid");if(!Uo.isCanonicalScriptSignature(a[0]))throw new TypeError("Input has invalid signature");if(!(0,Kr.isPoint)(a[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(a[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(a[1]))throw new TypeError("Pubkey mismatch");let c=Nd.hash160(a[1]);if(o.length>0&&!o.equals(c))throw new TypeError("Hash mismatch")}}return Object.assign(s,e)}fi.p2pkh=d3});var Mp=H(li=>{w();S();var l3=li&&li.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),h3=li&&li.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ud=li&&li.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&l3(t,e,r);return h3(t,e),t};Object.defineProperty(li,"__esModule",{value:!0});li.p2sh=void 0;var Op=Ud(vr()),p3=pn(),Ki=Ud(Ft()),Ye=Or(),di=Ud(Ui()),Bp=le(),Wc=Ki.OPS;function b3(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function g3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Ye.typeforce)({network:Ye.typeforce.maybe(Ye.typeforce.Object),address:Ye.typeforce.maybe(Ye.typeforce.String),hash:Ye.typeforce.maybe(Ye.typeforce.BufferN(20)),output:Ye.typeforce.maybe(Ye.typeforce.BufferN(23)),redeem:Ye.typeforce.maybe({network:Ye.typeforce.maybe(Ye.typeforce.Object),output:Ye.typeforce.maybe(Ye.typeforce.Buffer),input:Ye.typeforce.maybe(Ye.typeforce.Buffer),witness:Ye.typeforce.maybe(Ye.typeforce.arrayOf(Ye.typeforce.Buffer))}),input:Ye.typeforce.maybe(Ye.typeforce.Buffer),witness:Ye.typeforce.maybe(Ye.typeforce.arrayOf(Ye.typeforce.Buffer))},e);let r=e.network;r||(r=e.redeem&&e.redeem.network||p3.bitcoin);let n={network:r},i=di.value(()=>{let a=Bp.base.fromBase58Check(e.address),c=a.readUInt8(0),u=a.slice(1);return{version:c,hash:u}}),s=di.value(()=>Ki.decompile(e.input)),o=di.value(()=>{let a=s();return{network:r,output:a[a.length-1],input:Ki.compile(a.slice(0,-1)),witness:e.witness||[]}});if(di.prop(n,"address",()=>{if(!n.hash)return;let a=p.Buffer.allocUnsafe(21);return a.writeUInt8(n.network.scriptHash,0),n.hash.copy(a,1),Bp.base.toBase58Check(a)}),di.prop(n,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return i().hash;if(n.redeem&&n.redeem.output)return Op.hash160(n.redeem.output)}),di.prop(n,"output",()=>{if(!!n.hash)return Ki.compile([Wc.OP_HASH160,n.hash,Wc.OP_EQUAL])}),di.prop(n,"redeem",()=>{if(!!e.input)return o()}),di.prop(n,"input",()=>{if(!(!e.redeem||!e.redeem.input||!e.redeem.output))return Ki.compile([].concat(Ki.decompile(e.redeem.input),e.redeem.output))}),di.prop(n,"witness",()=>{if(n.redeem&&n.redeem.witness)return n.redeem.witness;if(n.input)return[]}),di.prop(n,"name",()=>{let a=["p2sh"];return n.redeem!==void 0&&n.redeem.name!==void 0&&a.push(n.redeem.name),a.join("-")}),t.validate){let a=p.Buffer.from([]);if(e.address){if(i().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(i().hash.length!==20)throw new TypeError("Invalid address");a=i().hash}if(e.hash){if(a.length>0&&!a.equals(e.hash))throw new TypeError("Hash mismatch");a=e.hash}if(e.output){if(e.output.length!==23||e.output[0]!==Wc.OP_HASH160||e.output[1]!==20||e.output[22]!==Wc.OP_EQUAL)throw new TypeError("Output is invalid");let u=e.output.slice(2,22);if(a.length>0&&!a.equals(u))throw new TypeError("Hash mismatch");a=u}let c=u=>{if(u.output){let d=Ki.decompile(u.output);if(!d||d.length<1)throw new TypeError("Redeem.output too short");let f=Op.hash160(u.output);if(a.length>0&&!a.equals(f))throw new TypeError("Hash mismatch");a=f}if(u.input){let d=u.input.length>0,f=u.witness&&u.witness.length>0;if(!d&&!f)throw new TypeError("Empty input");if(d&&f)throw new TypeError("Input and witness provided");if(d){let b=Ki.decompile(u.input);if(!Ki.isPushOnly(b))throw new TypeError("Non push-only scriptSig")}}};if(e.input){let u=s();if(!u||u.length<1)throw new TypeError("Input too short");if(!p.Buffer.isBuffer(o().output))throw new TypeError("Input is invalid");c(o())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw new TypeError("Network mismatch");if(e.input){let u=o();if(e.redeem.output&&!e.redeem.output.equals(u.output))throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(u.input))throw new TypeError("Redeem.input mismatch")}c(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!b3(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(n,e)}li.p2sh=g3});var kp=H(hi=>{w();S();var y3=hi&&hi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),m3=hi&&hi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ld=hi&&hi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&y3(t,e,r);return m3(t,e),t};Object.defineProperty(hi,"__esModule",{value:!0});hi.p2wpkh=void 0;var qd=Ld(vr()),_3=pn(),Xc=Ld(Ft()),Qt=Or(),fs=Ld(Ui()),zc=le(),Cp=Xc.OPS,v3=p.Buffer.alloc(0);function w3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Qt.typeforce)({address:Qt.typeforce.maybe(Qt.typeforce.String),hash:Qt.typeforce.maybe(Qt.typeforce.BufferN(20)),input:Qt.typeforce.maybe(Qt.typeforce.BufferN(0)),network:Qt.typeforce.maybe(Qt.typeforce.Object),output:Qt.typeforce.maybe(Qt.typeforce.BufferN(22)),pubkey:Qt.typeforce.maybe(Qt.isPoint),signature:Qt.typeforce.maybe(Xc.isCanonicalScriptSignature),witness:Qt.typeforce.maybe(Qt.typeforce.arrayOf(Qt.typeforce.Buffer))},e);let r=fs.value(()=>{let s=zc.base.bech32.decode(e.address),o=s.words.shift(),a=zc.base.bech32.fromWords(s.words);return{version:o,prefix:s.prefix,data:p.Buffer.from(a)}}),n=e.network||_3.bitcoin,i={name:"p2wpkh",network:n};if(fs.prop(i,"address",()=>{if(!i.hash)return;let s=zc.base.bech32.toWords(i.hash);return s.unshift(0),zc.base.bech32.encode(n.bech32,s)}),fs.prop(i,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return r().data;if(e.pubkey||i.pubkey)return qd.hash160(e.pubkey||i.pubkey)}),fs.prop(i,"output",()=>{if(!!i.hash)return Xc.compile([Cp.OP_0,i.hash])}),fs.prop(i,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(!!e.witness)return e.witness[1]}),fs.prop(i,"signature",()=>{if(!!e.witness)return e.witness[0]}),fs.prop(i,"input",()=>{if(!!i.witness)return v3}),fs.prop(i,"witness",()=>{if(!!e.pubkey&&!!e.signature)return[e.signature,e.pubkey]}),t.validate){let s=p.Buffer.from([]);if(e.address){if(n&&n.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==20)throw new TypeError("Invalid address data");s=r().data}if(e.hash){if(s.length>0&&!s.equals(e.hash))throw new TypeError("Hash mismatch");s=e.hash}if(e.output){if(e.output.length!==22||e.output[0]!==Cp.OP_0||e.output[1]!==20)throw new TypeError("Output is invalid");if(s.length>0&&!s.equals(e.output.slice(2)))throw new TypeError("Hash mismatch");s=e.output.slice(2)}if(e.pubkey){let o=qd.hash160(e.pubkey);if(s.length>0&&!s.equals(o))throw new TypeError("Hash mismatch");if(s=o,!(0,Qt.isPoint)(e.pubkey)||e.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(e.witness.length!==2)throw new TypeError("Witness is invalid");if(!Xc.isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!(0,Qt.isPoint)(e.witness[1])||e.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw new TypeError("Pubkey mismatch");let o=qd.hash160(e.witness[1]);if(s.length>0&&!s.equals(o))throw new TypeError("Hash mismatch")}}return Object.assign(i,e)}hi.p2wpkh=w3});var Rp=H(pi=>{w();S();var S3=pi&&pi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),x3=pi&&pi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Dd=pi&&pi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&S3(t,e,r);return x3(t,e),t};Object.defineProperty(pi,"__esModule",{value:!0});pi.p2wsh=void 0;var Hp=Dd(vr()),P3=pn(),ds=Dd(Ft()),De=Or(),Di=Dd(Ui()),Yc=le(),Np=ds.OPS,Kd=p.Buffer.alloc(0);function T3(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function $c(e){return!!(p.Buffer.isBuffer(e)&&e.length===65&&e[0]===4&&(0,De.isPoint)(e))}function E3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,De.typeforce)({network:De.typeforce.maybe(De.typeforce.Object),address:De.typeforce.maybe(De.typeforce.String),hash:De.typeforce.maybe(De.typeforce.BufferN(32)),output:De.typeforce.maybe(De.typeforce.BufferN(34)),redeem:De.typeforce.maybe({input:De.typeforce.maybe(De.typeforce.Buffer),network:De.typeforce.maybe(De.typeforce.Object),output:De.typeforce.maybe(De.typeforce.Buffer),witness:De.typeforce.maybe(De.typeforce.arrayOf(De.typeforce.Buffer))}),input:De.typeforce.maybe(De.typeforce.BufferN(0)),witness:De.typeforce.maybe(De.typeforce.arrayOf(De.typeforce.Buffer))},e);let r=Di.value(()=>{let o=Yc.base.bech32.decode(e.address),a=o.words.shift(),c=Yc.base.bech32.fromWords(o.words);return{version:a,prefix:o.prefix,data:p.Buffer.from(c)}}),n=Di.value(()=>ds.decompile(e.redeem.input)),i=e.network;i||(i=e.redeem&&e.redeem.network||P3.bitcoin);let s={network:i};if(Di.prop(s,"address",()=>{if(!s.hash)return;let o=Yc.base.bech32.toWords(s.hash);return o.unshift(0),Yc.base.bech32.encode(i.bech32,o)}),Di.prop(s,"hash",()=>{if(e.output)return e.output.slice(2);if(e.address)return r().data;if(s.redeem&&s.redeem.output)return Hp.sha256(s.redeem.output)}),Di.prop(s,"output",()=>{if(!!s.hash)return ds.compile([Np.OP_0,s.hash])}),Di.prop(s,"redeem",()=>{if(!!e.witness)return{output:e.witness[e.witness.length-1],input:Kd,witness:e.witness.slice(0,-1)}}),Di.prop(s,"input",()=>{if(!!s.witness)return Kd}),Di.prop(s,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){let o=ds.toStack(n());return s.redeem=Object.assign({witness:o},e.redeem),s.redeem.input=Kd,[].concat(o,e.redeem.output)}if(!!e.redeem&&!!e.redeem.output&&!!e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),Di.prop(s,"name",()=>{let o=["p2wsh"];return s.redeem!==void 0&&s.redeem.name!==void 0&&o.push(s.redeem.name),o.join("-")}),t.validate){let o=p.Buffer.from([]);if(e.address){if(r().prefix!==i.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");o=r().data}if(e.hash){if(o.length>0&&!o.equals(e.hash))throw new TypeError("Hash mismatch");o=e.hash}if(e.output){if(e.output.length!==34||e.output[0]!==Np.OP_0||e.output[1]!==32)throw new TypeError("Output is invalid");let a=e.output.slice(2);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.redeem){if(e.redeem.network&&e.redeem.network!==i)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){if(ds.decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");let a=Hp.sha256(e.redeem.output);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.redeem.input&&!ds.isPushOnly(n()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!T3(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&n().some($c)||e.redeem.output&&(ds.decompile(e.redeem.output)||[]).some($c))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){let a=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(a))throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some($c)||(ds.decompile(a)||[]).some($c))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(s,e)}pi.p2wsh=E3});var Lp=H((jd,qp)=>{w();S();var Zc=La(),bi=Zc.Buffer;function Up(e,t){for(var r in e)t[r]=e[r]}bi.from&&bi.alloc&&bi.allocUnsafe&&bi.allocUnsafeSlow?qp.exports=Zc:(Up(Zc,jd),jd.Buffer=Zs);function Zs(e,t,r){return bi(e,t,r)}Zs.prototype=Object.create(bi.prototype);Up(bi,Zs);Zs.from=function(e,t,r){if(typeof e=="number")throw new TypeError("Argument must not be a number");return bi(e,t,r)};Zs.alloc=function(e,t,r){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=bi(e);return t!==void 0?typeof r=="string"?n.fill(t,r):n.fill(t):n.fill(0),n};Zs.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return bi(e)};Zs.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Zc.SlowBuffer(e)}});var Vd=H((LB,Dp)=>{w();S();var Fd=Lp().Buffer,A3=9007199254740991;function Gd(e){if(e<0||e>A3||e%1!==0)throw new RangeError("value out of range")}function Fa(e,t,r){if(Gd(e),t||(t=Fd.allocUnsafe(Kp(e))),!Fd.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),Fa.bytes=1):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),Fa.bytes=3):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),Fa.bytes=5):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),Fa.bytes=9),t}function Ga(e,t){if(!Fd.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);var r=e.readUInt8(t);if(r<253)return Ga.bytes=1,r;if(r===253)return Ga.bytes=3,e.readUInt16LE(t+1);if(r===254)return Ga.bytes=5,e.readUInt32LE(t+1);Ga.bytes=9;var n=e.readUInt32LE(t+1),i=e.readUInt32LE(t+5),s=i*4294967296+n;return Gd(s),s}function Kp(e){return Gd(e),e<253?1:e<=65535?3:e<=4294967295?5:9}Dp.exports={encode:Fa,decode:Ga,encodingLength:Kp}});var ls=H(it=>{w();S();var I3=it&&it.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),O3=it&&it.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jp=it&&it.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&I3(t,e,r);return O3(t,e),t};Object.defineProperty(it,"__esModule",{value:!0});it.BufferReader=it.BufferWriter=it.cloneBuffer=it.reverseBuffer=it.writeUInt64LE=it.readUInt64LE=it.varuint=void 0;var Js=jp(Or()),{typeforce:Fp}=Js,Va=jp(Vd());it.varuint=Va;function Gp(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function Vp(e,t){let r=e.readUInt32LE(t),n=e.readUInt32LE(t+4);return n*=4294967296,Gp(n+r,9007199254740991),n+r}it.readUInt64LE=Vp;function Wp(e,t,r){return Gp(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}it.writeUInt64LE=Wp;function B3(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}it.reverseBuffer=B3;function M3(e){let t=p.Buffer.allocUnsafe(e.length);return e.copy(t),t}it.cloneBuffer=M3;var Wa=class{static withCapacity(t){return new Wa(p.Buffer.alloc(t))}constructor(t,r=0){this.buffer=t,this.offset=r,Fp(Js.tuple(Js.Buffer,Js.UInt32),[t,r])}writeUInt8(t){this.offset=this.buffer.writeUInt8(t,this.offset)}writeInt32(t){this.offset=this.buffer.writeInt32LE(t,this.offset)}writeUInt32(t){this.offset=this.buffer.writeUInt32LE(t,this.offset)}writeUInt64(t){this.offset=Wp(this.buffer,t,this.offset)}writeVarInt(t){Va.encode(t,this.buffer,this.offset),this.offset+=Va.encode.bytes}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.offset+=t.copy(this.buffer,this.offset)}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(r=>this.writeVarSlice(r))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}};it.BufferWriter=Wa;var Wd=class{constructor(t,r=0){this.buffer=t,this.offset=r,Fp(Js.tuple(Js.Buffer,Js.UInt32),[t,r])}readUInt8(){let t=this.buffer.readUInt8(this.offset);return this.offset++,t}readInt32(){let t=this.buffer.readInt32LE(this.offset);return this.offset+=4,t}readUInt32(){let t=this.buffer.readUInt32LE(this.offset);return this.offset+=4,t}readUInt64(){let t=Vp(this.buffer,this.offset);return this.offset+=8,t}readVarInt(){let t=Va.decode(this.buffer,this.offset);return this.offset+=Va.decode.bytes,t}readSlice(t){if(this.buffer.length<this.offset+t)throw new Error("Cannot read slice out of bounds");let r=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,r}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){let t=this.readVarInt(),r=[];for(let n=0;n<t;n++)r.push(this.readVarSlice());return r}};it.BufferReader=Wd});var zp=H(hs=>{w();S();Object.defineProperty(hs,"__esModule",{value:!0});hs.base58=hs.fromBase58=hs.toBase58=void 0;var zd=Od();Object.defineProperty(hs,"base58",{enumerable:!0,get:function(){return zd.base58}});function C3(e){let t=p.Buffer.from(e);return zd.base58.encode(Uint8Array.from(t))}hs.toBase58=C3;function k3(e){return zd.base58.decode(e)}hs.fromBase58=k3});var Xp=H(qo=>{w();S();Object.defineProperty(qo,"__esModule",{value:!0});qo.validateHexString=qo.isHexString=void 0;function H3(e,t){return e.match(/^0x[0-9A-Fa-f]*$/)?!(t&&e.length!==2+2*t):!1}qo.isHexString=H3;function N3(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||t.length%2!==0||!t.match(/^[0-9A-Fa-f]*$/))}qo.validateHexString=N3});var Yp=H(gi=>{w();S();Object.defineProperty(gi,"__esModule",{value:!0});gi.isHexPrefixed=gi.stripHexPrefix=gi.fromHex=gi.toHex=void 0;var R3=Xp();function U3(e,t=!1){let r=p.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}gi.toHex=U3;function q3(e){if((e.startsWith("0x")||e.startsWith("0X"))&&(e=e.substring(2)),e.length%2!=0&&(e="0"+e),!(0,R3.validateHexString)(e))throw new Error("invalid hex string");return p.Buffer.from(e,"hex")}gi.fromHex=q3;function L3(e){return e.startsWith("0x")?e.substring(2):e}gi.stripHexPrefix=L3;function K3(e){return e.startsWith("0x")}gi.isHexPrefixed=K3});var ji=H(Qs=>{w();S();Object.defineProperty(Qs,"__esModule",{value:!0});Qs.anumber=Xd;Qs.abytes=$p;Qs.ahash=j3;Qs.aexists=F3;Qs.aoutput=G3;function Xd(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function D3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function $p(e,...t){if(!D3(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function j3(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Xd(e.outputLen),Xd(e.blockLen)}function F3(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function G3(e,t){$p(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}});var Zp=H(Jc=>{w();S();Object.defineProperty(Jc,"__esModule",{value:!0});Jc.crypto=void 0;Jc.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var wr=H(Ee=>{w();S();Object.defineProperty(Ee,"__esModule",{value:!0});Ee.Hash=Ee.nextTick=Ee.byteSwapIfBE=Ee.isLE=void 0;Ee.isBytes=V3;Ee.u8=W3;Ee.u32=z3;Ee.createView=X3;Ee.rotr=Y3;Ee.rotl=$3;Ee.byteSwap=Zd;Ee.byteSwap32=Z3;Ee.bytesToHex=Q3;Ee.hexToBytes=eS;Ee.asyncLoop=rS;Ee.utf8ToBytes=eb;Ee.toBytes=Qc;Ee.concatBytes=nS;Ee.checkOpts=iS;Ee.wrapConstructor=sS;Ee.wrapConstructorWithOpts=oS;Ee.wrapXOFConstructorWithOpts=aS;Ee.randomBytes=cS;var Lo=Zp(),$d=ji();function V3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function W3(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function z3(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function X3(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Y3(e,t){return e<<32-t|e>>>t}function $3(e,t){return e<<t|e>>>32-t>>>0}Ee.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function Zd(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}Ee.byteSwapIfBE=Ee.isLE?e=>e:e=>Zd(e);function Z3(e){for(let t=0;t<e.length;t++)e[t]=Zd(e[t])}var Qp=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",J3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Q3(e){if((0,$d.abytes)(e),Qp)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=J3[e[r]];return t}var Fi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Jp(e){if(e>=Fi._0&&e<=Fi._9)return e-Fi._0;if(e>=Fi.A&&e<=Fi.F)return e-(Fi.A-10);if(e>=Fi.a&&e<=Fi.f)return e-(Fi.a-10)}function eS(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Qp)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let o=Jp(e.charCodeAt(s)),a=Jp(e.charCodeAt(s+1));if(o===void 0||a===void 0){let c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}var tS=async()=>{};Ee.nextTick=tS;async function rS(e,t,r){let n=Date.now();for(let i=0;i<e;i++){r(i);let s=Date.now()-n;s>=0&&s<t||(await(0,Ee.nextTick)(),n+=s)}}function eb(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Qc(e){return typeof e=="string"&&(e=eb(e)),(0,$d.abytes)(e),e}function nS(...e){let t=0;for(let n=0;n<e.length;n++){let i=e[n];(0,$d.abytes)(i),t+=i.length}let r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var Yd=class{clone(){return this._cloneInto()}};Ee.Hash=Yd;function iS(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function sS(e){let t=n=>e().update(Qc(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function oS(e){let t=(n,i)=>e(i).update(Qc(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function aS(e){let t=(n,i)=>e(i).update(Qc(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function cS(e=32){if(Lo.crypto&&typeof Lo.crypto.getRandomValues=="function")return Lo.crypto.getRandomValues(new Uint8Array(e));if(Lo.crypto&&typeof Lo.crypto.randomBytes=="function")return Uint8Array.from(Lo.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var eu=H(eo=>{w();S();Object.defineProperty(eo,"__esModule",{value:!0});eo.HashMD=void 0;eo.setBigUint64=tb;eo.Chi=uS;eo.Maj=fS;var Jd=ji(),za=wr();function tb(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+u,a,n)}function uS(e,t,r){return e&t^~e&r}function fS(e,t,r){return e&t^e&r^t&r}var Qd=class extends za.Hash{constructor(t,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(t),this.view=(0,za.createView)(this.buffer)}update(t){(0,Jd.aexists)(this);let{view:r,buffer:n,blockLen:i}=this;t=(0,za.toBytes)(t);let s=t.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=(0,za.createView)(t);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,Jd.aexists)(this),(0,Jd.aoutput)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;tb(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=(0,za.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)a.setUint32(4*f,d[f],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};eo.HashMD=Qd});var Ko=H(gs=>{w();S();Object.defineProperty(gs,"__esModule",{value:!0});gs.sha224=gs.sha256=gs.SHA256=void 0;var el=eu(),vn=wr(),dS=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ps=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bs=new Uint32Array(64),Xa=class extends el.HashMD{constructor(t=32){super(64,t,8,!1),this.A=ps[0]|0,this.B=ps[1]|0,this.C=ps[2]|0,this.D=ps[3]|0,this.E=ps[4]|0,this.F=ps[5]|0,this.G=ps[6]|0,this.H=ps[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,r){for(let f=0;f<16;f++,r+=4)bs[f]=t.getUint32(r,!1);for(let f=16;f<64;f++){let b=bs[f-15],m=bs[f-2],y=(0,vn.rotr)(b,7)^(0,vn.rotr)(b,18)^b>>>3,_=(0,vn.rotr)(m,17)^(0,vn.rotr)(m,19)^m>>>10;bs[f]=_+bs[f-7]+y+bs[f-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:d}=this;for(let f=0;f<64;f++){let b=(0,vn.rotr)(a,6)^(0,vn.rotr)(a,11)^(0,vn.rotr)(a,25),m=d+b+(0,el.Chi)(a,c,u)+dS[f]+bs[f]|0,_=((0,vn.rotr)(n,2)^(0,vn.rotr)(n,13)^(0,vn.rotr)(n,22))+(0,el.Maj)(n,i,s)|0;d=u,u=c,c=a,a=o+m|0,o=s,s=i,i=n,n=m+_|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(n,i,s,o,a,c,u,d)}roundClean(){bs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};gs.SHA256=Xa;var tl=class extends Xa{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}};gs.sha256=(0,vn.wrapConstructor)(()=>new Xa);gs.sha224=(0,vn.wrapConstructor)(()=>new tl)});var Do=H(te=>{w();S();Object.defineProperty(te,"__esModule",{value:!0});te.add5L=te.add5H=te.add4H=te.add4L=te.add3H=te.add3L=te.rotlBL=te.rotlBH=te.rotlSL=te.rotlSH=te.rotr32L=te.rotr32H=te.rotrBL=te.rotrBH=te.rotrSL=te.rotrSH=te.shrSL=te.shrSH=te.toBig=void 0;te.fromBig=nl;te.split=rb;te.add=gb;var tu=BigInt(2**32-1),rl=BigInt(32);function nl(e,t=!1){return t?{h:Number(e&tu),l:Number(e>>rl&tu)}:{h:Number(e>>rl&tu)|0,l:Number(e&tu)|0}}function rb(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:o}=nl(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]}var nb=(e,t)=>BigInt(e>>>0)<<rl|BigInt(t>>>0);te.toBig=nb;var ib=(e,t,r)=>e>>>r;te.shrSH=ib;var sb=(e,t,r)=>e<<32-r|t>>>r;te.shrSL=sb;var ob=(e,t,r)=>e>>>r|t<<32-r;te.rotrSH=ob;var ab=(e,t,r)=>e<<32-r|t>>>r;te.rotrSL=ab;var cb=(e,t,r)=>e<<64-r|t>>>r-32;te.rotrBH=cb;var ub=(e,t,r)=>e>>>r-32|t<<64-r;te.rotrBL=ub;var fb=(e,t)=>t;te.rotr32H=fb;var db=(e,t)=>e;te.rotr32L=db;var lb=(e,t,r)=>e<<r|t>>>32-r;te.rotlSH=lb;var hb=(e,t,r)=>t<<r|e>>>32-r;te.rotlSL=hb;var pb=(e,t,r)=>t<<r-32|e>>>64-r;te.rotlBH=pb;var bb=(e,t,r)=>e<<r-32|t>>>64-r;te.rotlBL=bb;function gb(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var yb=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);te.add3L=yb;var mb=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;te.add3H=mb;var _b=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);te.add4L=_b;var vb=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;te.add4H=vb;var wb=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);te.add5L=wb;var Sb=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;te.add5H=Sb;var lS={fromBig:nl,split:rb,toBig:nb,shrSH:ib,shrSL:sb,rotrSH:ob,rotrSL:ab,rotrBH:cb,rotrBL:ub,rotr32H:fb,rotr32L:db,rotlSH:lb,rotlSL:hb,rotlBH:pb,rotlBL:bb,add:gb,add3L:yb,add3H:mb,add4L:_b,add4H:vb,add5H:Sb,add5L:wb};te.default=lS});var Ya=H(sr=>{w();S();Object.defineProperty(sr,"__esModule",{value:!0});sr.sha384=sr.sha512_256=sr.sha512_224=sr.sha512=sr.SHA384=sr.SHA512_256=sr.SHA512_224=sr.SHA512=void 0;var hS=eu(),ue=Do(),su=wr(),[pS,bS]=(()=>ue.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),ys=new Uint32Array(80),ms=new Uint32Array(80),to=class extends hS.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:d,Fh:f,Fl:b,Gh:m,Gl:y,Hh:_,Hl:E}=this;return[t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E]}set(t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=b|0,this.Gh=m|0,this.Gl=y|0,this.Hh=_|0,this.Hl=E|0}process(t,r){for(let C=0;C<16;C++,r+=4)ys[C]=t.getUint32(r),ms[C]=t.getUint32(r+=4);for(let C=16;C<80;C++){let R=ys[C-15]|0,N=ms[C-15]|0,U=ue.default.rotrSH(R,N,1)^ue.default.rotrSH(R,N,8)^ue.default.shrSH(R,N,7),q=ue.default.rotrSL(R,N,1)^ue.default.rotrSL(R,N,8)^ue.default.shrSL(R,N,7),L=ys[C-2]|0,V=ms[C-2]|0,O=ue.default.rotrSH(L,V,19)^ue.default.rotrBH(L,V,61)^ue.default.shrSH(L,V,6),l=ue.default.rotrSL(L,V,19)^ue.default.rotrBL(L,V,61)^ue.default.shrSL(L,V,6),g=ue.default.add4L(q,l,ms[C-7],ms[C-16]),v=ue.default.add4H(g,U,O,ys[C-7],ys[C-16]);ys[C]=v|0,ms[C]=g|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:d,Eh:f,El:b,Fh:m,Fl:y,Gh:_,Gl:E,Hh:I,Hl:k}=this;for(let C=0;C<80;C++){let R=ue.default.rotrSH(f,b,14)^ue.default.rotrSH(f,b,18)^ue.default.rotrBH(f,b,41),N=ue.default.rotrSL(f,b,14)^ue.default.rotrSL(f,b,18)^ue.default.rotrBL(f,b,41),U=f&m^~f&_,q=b&y^~b&E,L=ue.default.add5L(k,N,q,bS[C],ms[C]),V=ue.default.add5H(L,I,R,U,pS[C],ys[C]),O=L|0,l=ue.default.rotrSH(n,i,28)^ue.default.rotrBH(n,i,34)^ue.default.rotrBH(n,i,39),g=ue.default.rotrSL(n,i,28)^ue.default.rotrBL(n,i,34)^ue.default.rotrBL(n,i,39),v=n&s^n&a^s&a,P=i&o^i&c^o&c;I=_|0,k=E|0,_=m|0,E=y|0,m=f|0,y=b|0,{h:f,l:b}=ue.default.add(u|0,d|0,V|0,O|0),u=a|0,d=c|0,a=s|0,c=o|0,s=n|0,o=i|0;let x=ue.default.add3L(O,g,P);n=ue.default.add3H(x,V,l,v),i=x|0}({h:n,l:i}=ue.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=ue.default.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=ue.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:d}=ue.default.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l:b}=ue.default.add(this.Eh|0,this.El|0,f|0,b|0),{h:m,l:y}=ue.default.add(this.Fh|0,this.Fl|0,m|0,y|0),{h:_,l:E}=ue.default.add(this.Gh|0,this.Gl|0,_|0,E|0),{h:I,l:k}=ue.default.add(this.Hh|0,this.Hl|0,I|0,k|0),this.set(n,i,s,o,a,c,u,d,f,b,m,y,_,E,I,k)}roundClean(){ys.fill(0),ms.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};sr.SHA512=to;var ru=class extends to{constructor(){super(28),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735}};sr.SHA512_224=ru;var nu=class extends to{constructor(){super(32),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414}};sr.SHA512_256=nu;var iu=class extends to{constructor(){super(48),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868}};sr.SHA384=iu;sr.sha512=(0,su.wrapConstructor)(()=>new to);sr.sha512_224=(0,su.wrapConstructor)(()=>new ru);sr.sha512_256=(0,su.wrapConstructor)(()=>new nu);sr.sha384=(0,su.wrapConstructor)(()=>new iu)});var ol=H(jo=>{w();S();Object.defineProperty(jo,"__esModule",{value:!0});jo.ripemd160=jo.RIPEMD160=void 0;var gS=eu(),$a=wr(),yS=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Pb=new Uint8Array(new Array(16).fill(0).map((e,t)=>t)),mS=Pb.map(e=>(9*e+5)%16),il=[Pb],sl=[mS];for(let e=0;e<4;e++)for(let t of[il,sl])t.push(t[e].map(r=>yS[r]));var Tb=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),_S=il.map((e,t)=>e.map(r=>Tb[t][r])),vS=sl.map((e,t)=>e.map(r=>Tb[t][r])),wS=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),SS=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function xb(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}var ou=new Uint32Array(16),au=class extends gS.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:r,h2:n,h3:i,h4:s}=this;return[t,r,n,i,s]}set(t,r,n,i,s){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(t,r){for(let m=0;m<16;m++,r+=4)ou[m]=t.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,o=s,a=this.h2|0,c=a,u=this.h3|0,d=u,f=this.h4|0,b=f;for(let m=0;m<5;m++){let y=4-m,_=wS[m],E=SS[m],I=il[m],k=sl[m],C=_S[m],R=vS[m];for(let N=0;N<16;N++){let U=(0,$a.rotl)(n+xb(m,s,a,u)+ou[I[N]]+_,C[N])+f|0;n=f,f=u,u=(0,$a.rotl)(a,10)|0,a=s,s=U}for(let N=0;N<16;N++){let U=(0,$a.rotl)(i+xb(y,o,c,d)+ou[k[N]]+E,R[N])+b|0;i=b,b=d,d=(0,$a.rotl)(c,10)|0,c=o,o=U}}this.set(this.h1+a+d|0,this.h2+u+b|0,this.h3+f+i|0,this.h4+n+o|0,this.h0+s+c|0)}roundClean(){ou.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};jo.RIPEMD160=au;jo.ripemd160=(0,$a.wrapConstructor)(()=>new au)});var cu=H(je=>{w();S();Object.defineProperty(je,"__esModule",{value:!0});je.shake256=je.shake128=je.keccak_512=je.keccak_384=je.keccak_256=je.keccak_224=je.sha3_512=je.sha3_384=je.sha3_256=je.sha3_224=je.Keccak=void 0;je.keccakP=Mb;var Fo=ji(),Ja=Do(),Gi=wr(),Ib=[],Ob=[],Bb=[],xS=BigInt(0),Za=BigInt(1),PS=BigInt(2),TS=BigInt(7),ES=BigInt(256),AS=BigInt(113);for(let e=0,t=Za,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Ib.push(2*(5*n+r)),Ob.push((e+1)*(e+2)/2%64);let i=xS;for(let s=0;s<7;s++)t=(t<<Za^(t>>TS)*AS)%ES,t&PS&&(i^=Za<<(Za<<BigInt(s))-Za);Bb.push(i)}var[IS,OS]=(0,Ja.split)(Bb,!0),Eb=(e,t,r)=>r>32?(0,Ja.rotlBH)(e,t,r):(0,Ja.rotlSH)(e,t,r),Ab=(e,t,r)=>r>32?(0,Ja.rotlBL)(e,t,r):(0,Ja.rotlSL)(e,t,r);function Mb(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let o=0;o<10;o++)r[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,c=(o+2)%10,u=r[c],d=r[c+1],f=Eb(u,d,1)^r[a],b=Ab(u,d,1)^r[a+1];for(let m=0;m<50;m+=10)e[o+m]^=f,e[o+m+1]^=b}let i=e[2],s=e[3];for(let o=0;o<24;o++){let a=Ob[o],c=Eb(i,s,a),u=Ab(i,s,a),d=Ib[o];i=e[d],s=e[d+1],e[d]=c,e[d+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=IS[n],e[1]^=OS[n]}r.fill(0)}var ro=class extends Gi.Hash{constructor(t,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,(0,Fo.anumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,Gi.u32)(this.state)}keccak(){Gi.isLE||(0,Gi.byteSwap32)(this.state32),Mb(this.state32,this.rounds),Gi.isLE||(0,Gi.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,Fo.aexists)(this);let{blockLen:r,state:n}=this;t=(0,Gi.toBytes)(t);let i=t.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){(0,Fo.aexists)(this,!1),(0,Fo.abytes)(t),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=n&&this.keccak();let o=Math.min(n-this.posOut,s-i);t.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,Fo.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,Fo.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new ro(r,n,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=n,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}};je.Keccak=ro;var _s=(e,t,r)=>(0,Gi.wrapConstructor)(()=>new ro(t,e,r));je.sha3_224=_s(6,144,224/8);je.sha3_256=_s(6,136,256/8);je.sha3_384=_s(6,104,384/8);je.sha3_512=_s(6,72,512/8);je.keccak_224=_s(1,144,224/8);je.keccak_256=_s(1,136,256/8);je.keccak_384=_s(1,104,384/8);je.keccak_512=_s(1,72,512/8);var Cb=(e,t,r)=>(0,Gi.wrapXOFConstructorWithOpts)((n={})=>new ro(t,e,n.dkLen===void 0?r:n.dkLen,!0));je.shake128=Cb(31,168,128/8);je.shake256=Cb(31,136,256/8)});var uu=H(Vo=>{w();S();Object.defineProperty(Vo,"__esModule",{value:!0});Vo.BLAKE=Vo.SIGMA=void 0;var Go=ji(),Sr=wr();Vo.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var al=class extends Sr.Hash{constructor(t,r,n={},i,s,o){if(super(),this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,Go.anumber)(t),(0,Go.anumber)(r),(0,Go.anumber)(i),r<0||r>i)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error("key length must be undefined or 1.."+i);if(n.salt!==void 0&&n.salt.length!==s)throw new Error("salt must be undefined or "+s);if(n.personalization!==void 0&&n.personalization.length!==o)throw new Error("personalization must be undefined or "+o);this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=(0,Sr.u32)(this.buffer)}update(t){(0,Go.aexists)(this);let{blockLen:r,buffer:n,buffer32:i}=this;t=(0,Sr.toBytes)(t);let s=t.length,o=t.byteOffset,a=t.buffer;for(let c=0;c<s;){this.pos===r&&(Sr.isLE||(0,Sr.byteSwap32)(i),this.compress(i,0,!1),Sr.isLE||(0,Sr.byteSwap32)(i),this.pos=0);let u=Math.min(r-this.pos,s-c),d=o+c;if(u===r&&!(d%4)&&c+u<s){let f=new Uint32Array(a,d,Math.floor((s-c)/4));Sr.isLE||(0,Sr.byteSwap32)(f);for(let b=0;c+r<s;b+=i.length,c+=r)this.length+=r,this.compress(f,b,!1);Sr.isLE||(0,Sr.byteSwap32)(f);continue}n.set(t.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(t){(0,Go.aexists)(this),(0,Go.aoutput)(t,this);let{pos:r,buffer32:n}=this;this.finished=!0,this.buffer.subarray(r).fill(0),Sr.isLE||(0,Sr.byteSwap32)(n),this.compress(n,0,!0),Sr.isLE||(0,Sr.byteSwap32)(n);let i=(0,Sr.u32)(t);this.get().forEach((s,o)=>i[o]=(0,Sr.byteSwapIfBE)(s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=n,t.finished=i,t.destroyed=s,t.outputLen=o,t.buffer.set(r),t.pos=a,t}};Vo.BLAKE=al});var cl=H(Wo=>{w();S();Object.defineProperty(Wo,"__esModule",{value:!0});Wo.blake2b=Wo.BLAKE2b=void 0;var kb=uu(),Dr=Do(),Yr=wr(),er=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),G=new Uint32Array(32);function vs(e,t,r,n,i,s){let o=i[s],a=i[s+1],c=G[2*e],u=G[2*e+1],d=G[2*t],f=G[2*t+1],b=G[2*r],m=G[2*r+1],y=G[2*n],_=G[2*n+1],E=Dr.default.add3L(c,d,o);u=Dr.default.add3H(E,u,f,a),c=E|0,{Dh:_,Dl:y}={Dh:_^u,Dl:y^c},{Dh:_,Dl:y}={Dh:Dr.default.rotr32H(_,y),Dl:Dr.default.rotr32L(_,y)},{h:m,l:b}=Dr.default.add(m,b,_,y),{Bh:f,Bl:d}={Bh:f^m,Bl:d^b},{Bh:f,Bl:d}={Bh:Dr.default.rotrSH(f,d,24),Bl:Dr.default.rotrSL(f,d,24)},G[2*e]=c,G[2*e+1]=u,G[2*t]=d,G[2*t+1]=f,G[2*r]=b,G[2*r+1]=m,G[2*n]=y,G[2*n+1]=_}function ws(e,t,r,n,i,s){let o=i[s],a=i[s+1],c=G[2*e],u=G[2*e+1],d=G[2*t],f=G[2*t+1],b=G[2*r],m=G[2*r+1],y=G[2*n],_=G[2*n+1],E=Dr.default.add3L(c,d,o);u=Dr.default.add3H(E,u,f,a),c=E|0,{Dh:_,Dl:y}={Dh:_^u,Dl:y^c},{Dh:_,Dl:y}={Dh:Dr.default.rotrSH(_,y,16),Dl:Dr.default.rotrSL(_,y,16)},{h:m,l:b}=Dr.default.add(m,b,_,y),{Bh:f,Bl:d}={Bh:f^m,Bl:d^b},{Bh:f,Bl:d}={Bh:Dr.default.rotrBH(f,d,63),Bl:Dr.default.rotrBL(f,d,63)},G[2*e]=c,G[2*e+1]=u,G[2*t]=d,G[2*t+1]=f,G[2*r]=b,G[2*r+1]=m,G[2*n]=y,G[2*n+1]=_}var fu=class extends kb.BLAKE{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=er[0]|0,this.v0h=er[1]|0,this.v1l=er[2]|0,this.v1h=er[3]|0,this.v2l=er[4]|0,this.v2h=er[5]|0,this.v3l=er[6]|0,this.v3h=er[7]|0,this.v4l=er[8]|0,this.v4h=er[9]|0,this.v5l=er[10]|0,this.v5h=er[11]|0,this.v6l=er[12]|0,this.v6h=er[13]|0,this.v7l=er[14]|0,this.v7h=er[15]|0;let r=t.key?t.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,Yr.u32)((0,Yr.toBytes)(t.salt));this.v4l^=(0,Yr.byteSwapIfBE)(n[0]),this.v4h^=(0,Yr.byteSwapIfBE)(n[1]),this.v5l^=(0,Yr.byteSwapIfBE)(n[2]),this.v5h^=(0,Yr.byteSwapIfBE)(n[3])}if(t.personalization){let n=(0,Yr.u32)((0,Yr.toBytes)(t.personalization));this.v6l^=(0,Yr.byteSwapIfBE)(n[0]),this.v6h^=(0,Yr.byteSwapIfBE)(n[1]),this.v7l^=(0,Yr.byteSwapIfBE)(n[2]),this.v7h^=(0,Yr.byteSwapIfBE)(n[3])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,Yr.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:u,v4h:d,v5l:f,v5h:b,v6l:m,v6h:y,v7l:_,v7h:E}=this;return[t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E]}set(t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=u|0,this.v4h=d|0,this.v5l=f|0,this.v5h=b|0,this.v6l=m|0,this.v6h=y|0,this.v7l=_|0,this.v7h=E|0}compress(t,r,n){this.get().forEach((c,u)=>G[u]=c),G.set(er,16);let{h:i,l:s}=Dr.default.fromBig(BigInt(this.length));G[24]=er[8]^s,G[25]=er[9]^i,n&&(G[28]=~G[28],G[29]=~G[29]);let o=0,a=kb.SIGMA;for(let c=0;c<12;c++)vs(0,4,8,12,t,r+2*a[o++]),ws(0,4,8,12,t,r+2*a[o++]),vs(1,5,9,13,t,r+2*a[o++]),ws(1,5,9,13,t,r+2*a[o++]),vs(2,6,10,14,t,r+2*a[o++]),ws(2,6,10,14,t,r+2*a[o++]),vs(3,7,11,15,t,r+2*a[o++]),ws(3,7,11,15,t,r+2*a[o++]),vs(0,5,10,15,t,r+2*a[o++]),ws(0,5,10,15,t,r+2*a[o++]),vs(1,6,11,12,t,r+2*a[o++]),ws(1,6,11,12,t,r+2*a[o++]),vs(2,7,8,13,t,r+2*a[o++]),ws(2,7,8,13,t,r+2*a[o++]),vs(3,4,9,14,t,r+2*a[o++]),ws(3,4,9,14,t,r+2*a[o++]);this.v0l^=G[0]^G[16],this.v0h^=G[1]^G[17],this.v1l^=G[2]^G[18],this.v1h^=G[3]^G[19],this.v2l^=G[4]^G[20],this.v2h^=G[5]^G[21],this.v3l^=G[6]^G[22],this.v3h^=G[7]^G[23],this.v4l^=G[8]^G[24],this.v4h^=G[9]^G[25],this.v5l^=G[10]^G[26],this.v5h^=G[11]^G[27],this.v6l^=G[12]^G[28],this.v6h^=G[13]^G[29],this.v7l^=G[14]^G[30],this.v7h^=G[15]^G[31],G.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Wo.BLAKE2b=fu;Wo.blake2b=(0,Yr.wrapConstructorWithOpts)(e=>new fu(e))});var lu=H(Fe=>{w();S();Object.defineProperty(Fe,"__esModule",{value:!0});Fe.sha3_512=Fe.sha3_256=Fe.ripemd160=Fe.sha512=Fe.sha256=Fe.magicHash=Fe.blake2=Fe.keccak256=Fe.keccak=Fe.hash160=Fe.doubleSha256=void 0;var du=Ko();Object.defineProperty(Fe,"sha256",{enumerable:!0,get:function(){return du.sha256}});var BS=Ya();Object.defineProperty(Fe,"sha512",{enumerable:!0,get:function(){return BS.sha512}});var Nb=ol();Object.defineProperty(Fe,"ripemd160",{enumerable:!0,get:function(){return Nb.ripemd160}});var zo=cu();Object.defineProperty(Fe,"sha3_256",{enumerable:!0,get:function(){return zo.sha3_256}});Object.defineProperty(Fe,"sha3_512",{enumerable:!0,get:function(){return zo.sha3_512}});var MS=cl();function Rb(e){let t=(0,du.sha256)(e);return(0,du.sha256)(t)}Fe.doubleSha256=Rb;function CS(e){let t=(0,du.sha256)(e);return(0,Nb.ripemd160)(t)}Fe.hash160=CS;var kS=function(e,t=256){let r=p.Buffer.from(e);switch(t){case 224:return p.Buffer.from((0,zo.keccak_224)(r));case 256:return p.Buffer.from((0,zo.keccak_256)(r));case 384:return p.Buffer.from((0,zo.keccak_384)(r));case 512:return p.Buffer.from((0,zo.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${t}`)}};Fe.keccak=kS;var HS=function(e){return(0,Fe.keccak)(e)};Fe.keccak256=HS;function NS(e,t,r){let n=Math.ceil(t/8);return(0,MS.blake2b)(e,{dkLen:n,key:r})}Fe.blake2=NS;function Hb(e){let t;return e<253?(t=p.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=p.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=p.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=p.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}var RS=p.Buffer.from(`Bitcoin Signed Message:
`);function US(e,t){let r=t?p.Buffer.from(t,"utf8"):RS,n=Hb(r.length),i=p.Buffer.from(e),s=Hb(i.length),o=p.Buffer.concat([n,r,s,i]);return Rb(o)}Fe.magicHash=US});var ec=H(no=>{w();S();Object.defineProperty(no,"__esModule",{value:!0});no.hmac=no.HMAC=void 0;var hu=ji(),Ub=wr(),Qa=class extends Ub.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,hu.ahash)(t);let n=(0,Ub.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,hu.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,hu.aexists)(this),(0,hu.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};no.HMAC=Qa;var qS=(e,t,r)=>new Qa(e,t).update(r).digest();no.hmac=qS;no.hmac.create=(e,t)=>new Qa(e,t)});var Kb=H(Xo=>{w();S();Object.defineProperty(Xo,"__esModule",{value:!0});Xo.hmacSHA512=Xo.hmacSHA256=void 0;var qb=ec(),Lb=lu();function LS(e,t){return p.Buffer.from((0,qb.hmac)(Lb.sha256,e,t))}Xo.hmacSHA256=LS;function KS(e,t){return p.Buffer.from((0,qb.hmac)(Lb.sha512,e,t))}Xo.hmacSHA512=KS});var ul=H(Be=>{w();S();Object.defineProperty(Be,"__esModule",{value:!0});Be.blake2s=Be.BLAKE2s=Be.B2S_IV=void 0;Be.G1s=Vi;Be.G2s=Wi;Be.compress=jb;var Db=uu(),DS=Do(),$r=wr();Be.B2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function Vi(e,t,r,n,i){return e=e+t+i|0,n=(0,$r.rotr)(n^e,16),r=r+n|0,t=(0,$r.rotr)(t^r,12),{a:e,b:t,c:r,d:n}}function Wi(e,t,r,n,i){return e=e+t+i|0,n=(0,$r.rotr)(n^e,8),r=r+n|0,t=(0,$r.rotr)(t^r,7),{a:e,b:t,c:r,d:n}}function jb(e,t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E,I,k,C){let R=0;for(let N=0;N<n;N++)({a:i,b:c,c:b,d:E}=Vi(i,c,b,E,r[t+e[R++]])),{a:i,b:c,c:b,d:E}=Wi(i,c,b,E,r[t+e[R++]]),{a:s,b:u,c:m,d:I}=Vi(s,u,m,I,r[t+e[R++]]),{a:s,b:u,c:m,d:I}=Wi(s,u,m,I,r[t+e[R++]]),{a:o,b:d,c:y,d:k}=Vi(o,d,y,k,r[t+e[R++]]),{a:o,b:d,c:y,d:k}=Wi(o,d,y,k,r[t+e[R++]]),{a,b:f,c:_,d:C}=Vi(a,f,_,C,r[t+e[R++]]),{a,b:f,c:_,d:C}=Wi(a,f,_,C,r[t+e[R++]]),{a:i,b:u,c:y,d:C}=Vi(i,u,y,C,r[t+e[R++]]),{a:i,b:u,c:y,d:C}=Wi(i,u,y,C,r[t+e[R++]]),{a:s,b:d,c:_,d:E}=Vi(s,d,_,E,r[t+e[R++]]),{a:s,b:d,c:_,d:E}=Wi(s,d,_,E,r[t+e[R++]]),{a:o,b:f,c:b,d:I}=Vi(o,f,b,I,r[t+e[R++]]),{a:o,b:f,c:b,d:I}=Wi(o,f,b,I,r[t+e[R++]]),{a,b:c,c:m,d:k}=Vi(a,c,m,k,r[t+e[R++]]),{a,b:c,c:m,d:k}=Wi(a,c,m,k,r[t+e[R++]]);return{v0:i,v1:s,v2:o,v3:a,v4:c,v5:u,v6:d,v7:f,v8:b,v9:m,v10:y,v11:_,v12:E,v13:I,v14:k,v15:C}}var pu=class extends Db.BLAKE{constructor(t={}){super(64,t.dkLen===void 0?32:t.dkLen,t,32,8,8),this.v0=Be.B2S_IV[0]|0,this.v1=Be.B2S_IV[1]|0,this.v2=Be.B2S_IV[2]|0,this.v3=Be.B2S_IV[3]|0,this.v4=Be.B2S_IV[4]|0,this.v5=Be.B2S_IV[5]|0,this.v6=Be.B2S_IV[6]|0,this.v7=Be.B2S_IV[7]|0;let r=t.key?t.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,$r.u32)((0,$r.toBytes)(t.salt));this.v4^=(0,$r.byteSwapIfBE)(n[0]),this.v5^=(0,$r.byteSwapIfBE)(n[1])}if(t.personalization){let n=(0,$r.u32)((0,$r.toBytes)(t.personalization));this.v6^=(0,$r.byteSwapIfBE)(n[0]),this.v7^=(0,$r.byteSwapIfBE)(n[1])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,$r.toBytes)(t.key)),this.update(n)}}get(){let{v0:t,v1:r,v2:n,v3:i,v4:s,v5:o,v6:a,v7:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=o|0,this.v6=a|0,this.v7=c|0}compress(t,r,n){let{h:i,l:s}=(0,DS.fromBig)(BigInt(this.length)),{v0:o,v1:a,v2:c,v3:u,v4:d,v5:f,v6:b,v7:m,v8:y,v9:_,v10:E,v11:I,v12:k,v13:C,v14:R,v15:N}=jb(Db.SIGMA,r,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,Be.B2S_IV[0],Be.B2S_IV[1],Be.B2S_IV[2],Be.B2S_IV[3],s^Be.B2S_IV[4],i^Be.B2S_IV[5],n?~Be.B2S_IV[6]:Be.B2S_IV[6],Be.B2S_IV[7]);this.v0^=o^y,this.v1^=a^_,this.v2^=c^E,this.v3^=u^I,this.v4^=d^k,this.v5^=f^C,this.v6^=b^R,this.v7^=m^N}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};Be.BLAKE2s=pu;Be.blake2s=(0,$r.wrapConstructorWithOpts)(e=>new pu(e))});var yu=H(gu=>{w();S();Object.defineProperty(gu,"__esModule",{value:!0});gu.pbkdf2=FS;gu.pbkdf2Async=GS;var bu=ji(),jS=ec(),Yo=wr();function Fb(e,t,r,n){(0,bu.ahash)(e);let i=(0,Yo.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:o,asyncTick:a}=i;if((0,bu.anumber)(s),(0,bu.anumber)(o),(0,bu.anumber)(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let c=(0,Yo.toBytes)(t),u=(0,Yo.toBytes)(r),d=new Uint8Array(o),f=jS.hmac.create(e,c),b=f._cloneInto().update(u);return{c:s,dkLen:o,asyncTick:a,DK:d,PRF:f,PRFSalt:b}}function Gb(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}function FS(e,t,r,n){let{c:i,dkLen:s,DK:o,PRF:a,PRFSalt:c}=Fb(e,t,r,n),u,d=new Uint8Array(4),f=(0,Yo.createView)(d),b=new Uint8Array(a.outputLen);for(let m=1,y=0;y<s;m++,y+=a.outputLen){let _=o.subarray(y,y+a.outputLen);f.setInt32(0,m,!1),(u=c._cloneInto(u)).update(d).digestInto(b),_.set(b.subarray(0,_.length));for(let E=1;E<i;E++){a._cloneInto(u).update(b).digestInto(b);for(let I=0;I<_.length;I++)_[I]^=b[I]}}return Gb(a,c,o,u,b)}async function GS(e,t,r,n){let{c:i,dkLen:s,asyncTick:o,DK:a,PRF:c,PRFSalt:u}=Fb(e,t,r,n),d,f=new Uint8Array(4),b=(0,Yo.createView)(f),m=new Uint8Array(c.outputLen);for(let y=1,_=0;_<s;y++,_+=c.outputLen){let E=a.subarray(_,_+c.outputLen);b.setInt32(0,y,!1),(d=u._cloneInto(d)).update(f).digestInto(m),E.set(m.subarray(0,E.length)),await(0,Yo.asyncLoop)(i-1,o,()=>{c._cloneInto(d).update(m).digestInto(m);for(let I=0;I<E.length;I++)E[I]^=m[I]})}return Gb(c,u,a,d,m)}});var $b=H(mu=>{w();S();Object.defineProperty(mu,"__esModule",{value:!0});mu.scrypt=VS;mu.scryptAsync=WS;var $o=ji(),Wb=yu(),zb=Ko(),ee=wr();function Vb(e,t,r,n,i,s){let o=e[t++]^r[n++],a=e[t++]^r[n++],c=e[t++]^r[n++],u=e[t++]^r[n++],d=e[t++]^r[n++],f=e[t++]^r[n++],b=e[t++]^r[n++],m=e[t++]^r[n++],y=e[t++]^r[n++],_=e[t++]^r[n++],E=e[t++]^r[n++],I=e[t++]^r[n++],k=e[t++]^r[n++],C=e[t++]^r[n++],R=e[t++]^r[n++],N=e[t++]^r[n++],U=o,q=a,L=c,V=u,O=d,l=f,g=b,v=m,P=y,x=_,B=E,M=I,T=k,h=C,A=R,D=N;for(let K=0;K<8;K+=2)O^=(0,ee.rotl)(U+T|0,7),P^=(0,ee.rotl)(O+U|0,9),T^=(0,ee.rotl)(P+O|0,13),U^=(0,ee.rotl)(T+P|0,18),x^=(0,ee.rotl)(l+q|0,7),h^=(0,ee.rotl)(x+l|0,9),q^=(0,ee.rotl)(h+x|0,13),l^=(0,ee.rotl)(q+h|0,18),A^=(0,ee.rotl)(B+g|0,7),L^=(0,ee.rotl)(A+B|0,9),g^=(0,ee.rotl)(L+A|0,13),B^=(0,ee.rotl)(g+L|0,18),V^=(0,ee.rotl)(D+M|0,7),v^=(0,ee.rotl)(V+D|0,9),M^=(0,ee.rotl)(v+V|0,13),D^=(0,ee.rotl)(M+v|0,18),q^=(0,ee.rotl)(U+V|0,7),L^=(0,ee.rotl)(q+U|0,9),V^=(0,ee.rotl)(L+q|0,13),U^=(0,ee.rotl)(V+L|0,18),g^=(0,ee.rotl)(l+O|0,7),v^=(0,ee.rotl)(g+l|0,9),O^=(0,ee.rotl)(v+g|0,13),l^=(0,ee.rotl)(O+v|0,18),M^=(0,ee.rotl)(B+x|0,7),P^=(0,ee.rotl)(M+B|0,9),x^=(0,ee.rotl)(P+M|0,13),B^=(0,ee.rotl)(x+P|0,18),T^=(0,ee.rotl)(D+A|0,7),h^=(0,ee.rotl)(T+D|0,9),A^=(0,ee.rotl)(h+T|0,13),D^=(0,ee.rotl)(A+h|0,18);i[s++]=o+U|0,i[s++]=a+q|0,i[s++]=c+L|0,i[s++]=u+V|0,i[s++]=d+O|0,i[s++]=f+l|0,i[s++]=b+g|0,i[s++]=m+v|0,i[s++]=y+P|0,i[s++]=_+x|0,i[s++]=E+B|0,i[s++]=I+M|0,i[s++]=k+T|0,i[s++]=C+h|0,i[s++]=R+A|0,i[s++]=N+D|0}function Zo(e,t,r,n,i){let s=n+0,o=n+16*i;for(let a=0;a<16;a++)r[o+a]=e[t+(2*i-1)*16+a];for(let a=0;a<i;a++,s+=16,t+=16)Vb(r,o,e,t,r,s),a>0&&(o+=16),Vb(r,s,e,t+=16,r,o)}function Xb(e,t,r){let n=(0,ee.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:o,dkLen:a,asyncTick:c,maxmem:u,onProgress:d}=n;if((0,$o.anumber)(i),(0,$o.anumber)(s),(0,$o.anumber)(o),(0,$o.anumber)(a),(0,$o.anumber)(c),(0,$o.anumber)(u),d!==void 0&&typeof d!="function")throw new Error("progressCb should be function");let f=128*s,b=f/4;if(i<=1||(i&i-1)!==0||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(o<0||o>(2**32-1)*32/f)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(f*(i+o)>u)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+u);let y=(0,Wb.pbkdf2)(zb.sha256,e,t,{c:1,dkLen:f*o}),_=(0,ee.u32)(y),E=(0,ee.u32)(new Uint8Array(f*i)),I=(0,ee.u32)(new Uint8Array(f)),k=()=>{};if(d){let C=2*i*o,R=Math.max(Math.floor(C/1e4),1),N=0;k=()=>{N++,d&&(!(N%R)||N===C)&&d(N/C)}}return{N:i,r:s,p:o,dkLen:a,blockSize32:b,V:E,B32:_,B:y,tmp:I,blockMixCb:k,asyncTick:c}}function Yb(e,t,r,n,i){let s=(0,Wb.pbkdf2)(zb.sha256,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),i.fill(0),s}function VS(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:u,B:d,tmp:f,blockMixCb:b}=Xb(e,t,r);ee.isLE||(0,ee.byteSwap32)(u);for(let m=0;m<s;m++){let y=a*m;for(let _=0;_<a;_++)c[_]=u[y+_];for(let _=0,E=0;_<n-1;_++)Zo(c,E,c,E+=a,i),b();Zo(c,(n-1)*a,u,y,i),b();for(let _=0;_<n;_++){let E=u[y+a-16]%n;for(let I=0;I<a;I++)f[I]=u[y+I]^c[E*a+I];Zo(f,0,u,y,i),b()}}return ee.isLE||(0,ee.byteSwap32)(u),Yb(e,o,d,c,f)}async function WS(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:u,B:d,tmp:f,blockMixCb:b,asyncTick:m}=Xb(e,t,r);ee.isLE||(0,ee.byteSwap32)(u);for(let y=0;y<s;y++){let _=a*y;for(let I=0;I<a;I++)c[I]=u[_+I];let E=0;await(0,ee.asyncLoop)(n-1,m,()=>{Zo(c,E,c,E+=a,i),b()}),Zo(c,(n-1)*a,u,_,i),b(),await(0,ee.asyncLoop)(n,m,()=>{let I=u[_+a-16]%n;for(let k=0;k<a;k++)f[k]=u[_+k]^c[I*a+k];Zo(f,0,u,_,i),b()})}return ee.isLE||(0,ee.byteSwap32)(u),Yb(e,o,d,c,f)}});var Qb=H(Qo=>{w();S();Object.defineProperty(Qo,"__esModule",{value:!0});Qo.blake3=Qo.BLAKE3=void 0;var tc=ji(),zS=uu(),Zb=Do(),$n=ul(),or=wr(),yi={CHUNK_START:1<<0,CHUNK_END:1<<1,PARENT:1<<2,ROOT:1<<3,KEYED_HASH:1<<4,DERIVE_KEY_CONTEXT:1<<5,DERIVE_KEY_MATERIAL:1<<6},Jb=(()=>{let e=Array.from({length:16},(n,i)=>i),t=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=e;n<7;n++,i=t(i))r.push(...i);return Uint8Array.from(r)})(),Jo=class extends zS.BLAKE{constructor(t={},r=0){let n=t.dkLen===void 0?32:t.dkLen;if(super(64,n,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,(0,tc.anumber)(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){let i=(0,or.toBytes)(t.key).slice();if(i.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,or.u32)(i),or.isLE||(0,or.byteSwap32)(this.IV),this.flags=r|yi.KEYED_HASH}else if(t.context!==void 0){let i=new Jo({dkLen:32},yi.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=(0,or.u32)(i),or.isLE||(0,or.byteSwap32)(this.IV),this.flags=r|yi.DERIVE_KEY_MATERIAL}else this.IV=$n.B2S_IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,or.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,r,n,i=0){let{state:s,pos:o}=this,{h:a,l:c}=(0,Zb.fromBig)(BigInt(t),!0),{v0:u,v1:d,v2:f,v3:b,v4:m,v5:y,v6:_,v7:E,v8:I,v9:k,v10:C,v11:R,v12:N,v13:U,v14:q,v15:L}=(0,$n.compress)(Jb,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],$n.B2S_IV[0],$n.B2S_IV[1],$n.B2S_IV[2],$n.B2S_IV[3],a,c,o,r);s[0]=u^I,s[1]=d^k,s[2]=f^C,s[3]=b^R,s[4]=m^N,s[5]=y^U,s[6]=_^q,s[7]=E^L}compress(t,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=yi.CHUNK_START),(this.chunkPos===15||n)&&(i|=yi.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,t,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let o,a=this.chunksDone+1;(n||!(a&1))&&(o=this.stack.pop());a>>=1)this.buffer32.set(o,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|yi.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:r,flags:n,state:i,chunkPos:s,posOut:o,chunkOut:a,stack:c,chunksDone:u}=this;return t.state.set(i.slice()),t.stack=c.map(d=>Uint32Array.from(d)),t.IV.set(r),t.flags=n,t.chunkPos=s,t.chunksDone=u,t.posOut=o,t.chunkOut=a,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){let{state:t,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:o,l:a}=(0,Zb.fromBig)(BigInt(this.chunkOut++));or.isLE||(0,or.byteSwap32)(i);let{v0:c,v1:u,v2:d,v3:f,v4:b,v5:m,v6:y,v7:_,v8:E,v9:I,v10:k,v11:C,v12:R,v13:N,v14:U,v15:q}=(0,$n.compress)(Jb,0,i,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],$n.B2S_IV[0],$n.B2S_IV[1],$n.B2S_IV[2],$n.B2S_IV[3],a,o,r,n);s[0]=c^E,s[1]=u^I,s[2]=d^k,s[3]=f^C,s[4]=b^R,s[5]=m^N,s[6]=y^U,s[7]=_^q,s[8]=t[0]^E,s[9]=t[1]^I,s[10]=t[2]^k,s[11]=t[3]^C,s[12]=t[4]^R,s[13]=t[5]^N,s[14]=t[6]^U,s[15]=t[7]^q,or.isLE||((0,or.byteSwap32)(i),(0,or.byteSwap32)(s)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|yi.ROOT;this.stack.length?(t|=yi.PARENT,or.isLE||(0,or.byteSwap32)(this.buffer32),this.compress(this.buffer32,0,!0),or.isLE||(0,or.byteSwap32)(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:yi.CHUNK_START)|yi.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){(0,tc.aexists)(this,!1),(0,tc.abytes)(t),this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.b2CompressOut();let o=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return(0,tc.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,tc.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};Qo.BLAKE3=Jo;Qo.blake3=(0,or.wrapXOFConstructorWithOpts)(e=>new Jo(e))});var rc=H(Ae=>{w();S();var eg=Ae&&Ae.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),XS=Ae&&Ae.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jr=Ae&&Ae.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&eg(t,e,r)},YS=Ae&&Ae.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&eg(t,e,r);return XS(t,e),t};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.randomBytes=Ae.concatBytes=Ae.reverseBuffer=void 0;jr(zp(),Ae);jr(Yp(),Ae);jr(lu(),Ae);jr(Kb(),Ae);jr(Od(),Ae);jr(Ko(),Ae);jr(ec(),Ae);jr(ol(),Ae);jr(Ya(),Ae);jr(cu(),Ae);jr(cl(),Ae);jr(ul(),Ae);jr(yu(),Ae);jr($b(),Ae);jr(Qb(),Ae);var $S=YS(wr()),ZS=tw();function JS(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Ae.reverseBuffer=JS;function QS(e,t){return $S.concatBytes(Uint8Array.from(e),Uint8Array.from(t))}Ae.concatBytes=QS;function e6(e){return ZS(e)}Ae.randomBytes=e6});var Zr=H((tg,fl)=>{w();S();(function(e,t){"use strict";function r(O,l){if(!O)throw new Error(l||"Assertion failed")}function n(O,l){O.super_=l;var g=function(){};g.prototype=l.prototype,O.prototype=new g,O.prototype.constructor=O}function i(O,l,g){if(i.isBN(O))return O;this.negative=0,this.words=null,this.length=0,this.red=null,O!==null&&((l==="le"||l==="be")&&(g=l,l=10),this._init(O||0,l||10,g||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=La().Buffer}catch{}i.isBN=function(l){return l instanceof i?!0:l!==null&&typeof l=="object"&&l.constructor.wordSize===i.wordSize&&Array.isArray(l.words)},i.max=function(l,g){return l.cmp(g)>0?l:g},i.min=function(l,g){return l.cmp(g)<0?l:g},i.prototype._init=function(l,g,v){if(typeof l=="number")return this._initNumber(l,g,v);if(typeof l=="object")return this._initArray(l,g,v);g==="hex"&&(g=16),r(g===(g|0)&&g>=2&&g<=36),l=l.toString().replace(/\s+/g,"");var P=0;l[0]==="-"&&(P++,this.negative=1),P<l.length&&(g===16?this._parseHex(l,P,v):(this._parseBase(l,g,P),v==="le"&&this._initArray(this.toArray(),g,v)))},i.prototype._initNumber=function(l,g,v){l<0&&(this.negative=1,l=-l),l<67108864?(this.words=[l&67108863],this.length=1):l<4503599627370496?(this.words=[l&67108863,l/67108864&67108863],this.length=2):(r(l<9007199254740992),this.words=[l&67108863,l/67108864&67108863,1],this.length=3),v==="le"&&this._initArray(this.toArray(),g,v)},i.prototype._initArray=function(l,g,v){if(r(typeof l.length=="number"),l.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(l.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var x,B,M=0;if(v==="be")for(P=l.length-1,x=0;P>=0;P-=3)B=l[P]|l[P-1]<<8|l[P-2]<<16,this.words[x]|=B<<M&67108863,this.words[x+1]=B>>>26-M&67108863,M+=24,M>=26&&(M-=26,x++);else if(v==="le")for(P=0,x=0;P<l.length;P+=3)B=l[P]|l[P+1]<<8|l[P+2]<<16,this.words[x]|=B<<M&67108863,this.words[x+1]=B>>>26-M&67108863,M+=24,M>=26&&(M-=26,x++);return this.strip()};function o(O,l){var g=O.charCodeAt(l);return g>=65&&g<=70?g-55:g>=97&&g<=102?g-87:g-48&15}function a(O,l,g){var v=o(O,g);return g-1>=l&&(v|=o(O,g-1)<<4),v}i.prototype._parseHex=function(l,g,v){this.length=Math.ceil((l.length-g)/6),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var x=0,B=0,M;if(v==="be")for(P=l.length-1;P>=g;P-=2)M=a(l,g,P)<<x,this.words[B]|=M&67108863,x>=18?(x-=18,B+=1,this.words[B]|=M>>>26):x+=8;else{var T=l.length-g;for(P=T%2===0?g+1:g;P<l.length;P+=2)M=a(l,g,P)<<x,this.words[B]|=M&67108863,x>=18?(x-=18,B+=1,this.words[B]|=M>>>26):x+=8}this.strip()};function c(O,l,g,v){for(var P=0,x=Math.min(O.length,g),B=l;B<x;B++){var M=O.charCodeAt(B)-48;P*=v,M>=49?P+=M-49+10:M>=17?P+=M-17+10:P+=M}return P}i.prototype._parseBase=function(l,g,v){this.words=[0],this.length=1;for(var P=0,x=1;x<=67108863;x*=g)P++;P--,x=x/g|0;for(var B=l.length-v,M=B%P,T=Math.min(B,B-M)+v,h=0,A=v;A<T;A+=P)h=c(l,A,A+P,g),this.imuln(x),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(M!==0){var D=1;for(h=c(l,A,l.length,g),A=0;A<M;A++)D*=g;this.imuln(D),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this.strip()},i.prototype.copy=function(l){l.words=new Array(this.length);for(var g=0;g<this.length;g++)l.words[g]=this.words[g];l.length=this.length,l.negative=this.negative,l.red=this.red},i.prototype.clone=function(){var l=new i(null);return this.copy(l),l},i.prototype._expand=function(l){for(;this.length<l;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(l,g){l=l||10,g=g|0||1;var v;if(l===16||l==="hex"){v="";for(var P=0,x=0,B=0;B<this.length;B++){var M=this.words[B],T=((M<<P|x)&16777215).toString(16);x=M>>>24-P&16777215,x!==0||B!==this.length-1?v=u[6-T.length]+T+v:v=T+v,P+=2,P>=26&&(P-=26,B--)}for(x!==0&&(v=x.toString(16)+v);v.length%g!==0;)v="0"+v;return this.negative!==0&&(v="-"+v),v}if(l===(l|0)&&l>=2&&l<=36){var h=d[l],A=f[l];v="";var D=this.clone();for(D.negative=0;!D.isZero();){var K=D.modn(A).toString(l);D=D.idivn(A),D.isZero()?v=K+v:v=u[h-K.length]+K+v}for(this.isZero()&&(v="0"+v);v.length%g!==0;)v="0"+v;return this.negative!==0&&(v="-"+v),v}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var l=this.words[0];return this.length===2?l+=this.words[1]*67108864:this.length===3&&this.words[2]===1?l+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-l:l},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(l,g){return r(typeof s<"u"),this.toArrayLike(s,l,g)},i.prototype.toArray=function(l,g){return this.toArrayLike(Array,l,g)},i.prototype.toArrayLike=function(l,g,v){var P=this.byteLength(),x=v||Math.max(1,P);r(P<=x,"byte array longer than desired length"),r(x>0,"Requested array length <= 0"),this.strip();var B=g==="le",M=new l(x),T,h,A=this.clone();if(B){for(h=0;!A.isZero();h++)T=A.andln(255),A.iushrn(8),M[h]=T;for(;h<x;h++)M[h]=0}else{for(h=0;h<x-P;h++)M[h]=0;for(h=0;!A.isZero();h++)T=A.andln(255),A.iushrn(8),M[x-h-1]=T}return M},Math.clz32?i.prototype._countBits=function(l){return 32-Math.clz32(l)}:i.prototype._countBits=function(l){var g=l,v=0;return g>=4096&&(v+=13,g>>>=13),g>=64&&(v+=7,g>>>=7),g>=8&&(v+=4,g>>>=4),g>=2&&(v+=2,g>>>=2),v+g},i.prototype._zeroBits=function(l){if(l===0)return 26;var g=l,v=0;return(g&8191)===0&&(v+=13,g>>>=13),(g&127)===0&&(v+=7,g>>>=7),(g&15)===0&&(v+=4,g>>>=4),(g&3)===0&&(v+=2,g>>>=2),(g&1)===0&&v++,v},i.prototype.bitLength=function(){var l=this.words[this.length-1],g=this._countBits(l);return(this.length-1)*26+g};function b(O){for(var l=new Array(O.bitLength()),g=0;g<l.length;g++){var v=g/26|0,P=g%26;l[g]=(O.words[v]&1<<P)>>>P}return l}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var l=0,g=0;g<this.length;g++){var v=this._zeroBits(this.words[g]);if(l+=v,v!==26)break}return l},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(l){return this.negative!==0?this.abs().inotn(l).iaddn(1):this.clone()},i.prototype.fromTwos=function(l){return this.testn(l-1)?this.notn(l).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(l){for(;this.length<l.length;)this.words[this.length++]=0;for(var g=0;g<l.length;g++)this.words[g]=this.words[g]|l.words[g];return this.strip()},i.prototype.ior=function(l){return r((this.negative|l.negative)===0),this.iuor(l)},i.prototype.or=function(l){return this.length>l.length?this.clone().ior(l):l.clone().ior(this)},i.prototype.uor=function(l){return this.length>l.length?this.clone().iuor(l):l.clone().iuor(this)},i.prototype.iuand=function(l){var g;this.length>l.length?g=l:g=this;for(var v=0;v<g.length;v++)this.words[v]=this.words[v]&l.words[v];return this.length=g.length,this.strip()},i.prototype.iand=function(l){return r((this.negative|l.negative)===0),this.iuand(l)},i.prototype.and=function(l){return this.length>l.length?this.clone().iand(l):l.clone().iand(this)},i.prototype.uand=function(l){return this.length>l.length?this.clone().iuand(l):l.clone().iuand(this)},i.prototype.iuxor=function(l){var g,v;this.length>l.length?(g=this,v=l):(g=l,v=this);for(var P=0;P<v.length;P++)this.words[P]=g.words[P]^v.words[P];if(this!==g)for(;P<g.length;P++)this.words[P]=g.words[P];return this.length=g.length,this.strip()},i.prototype.ixor=function(l){return r((this.negative|l.negative)===0),this.iuxor(l)},i.prototype.xor=function(l){return this.length>l.length?this.clone().ixor(l):l.clone().ixor(this)},i.prototype.uxor=function(l){return this.length>l.length?this.clone().iuxor(l):l.clone().iuxor(this)},i.prototype.inotn=function(l){r(typeof l=="number"&&l>=0);var g=Math.ceil(l/26)|0,v=l%26;this._expand(g),v>0&&g--;for(var P=0;P<g;P++)this.words[P]=~this.words[P]&67108863;return v>0&&(this.words[P]=~this.words[P]&67108863>>26-v),this.strip()},i.prototype.notn=function(l){return this.clone().inotn(l)},i.prototype.setn=function(l,g){r(typeof l=="number"&&l>=0);var v=l/26|0,P=l%26;return this._expand(v+1),g?this.words[v]=this.words[v]|1<<P:this.words[v]=this.words[v]&~(1<<P),this.strip()},i.prototype.iadd=function(l){var g;if(this.negative!==0&&l.negative===0)return this.negative=0,g=this.isub(l),this.negative^=1,this._normSign();if(this.negative===0&&l.negative!==0)return l.negative=0,g=this.isub(l),l.negative=1,g._normSign();var v,P;this.length>l.length?(v=this,P=l):(v=l,P=this);for(var x=0,B=0;B<P.length;B++)g=(v.words[B]|0)+(P.words[B]|0)+x,this.words[B]=g&67108863,x=g>>>26;for(;x!==0&&B<v.length;B++)g=(v.words[B]|0)+x,this.words[B]=g&67108863,x=g>>>26;if(this.length=v.length,x!==0)this.words[this.length]=x,this.length++;else if(v!==this)for(;B<v.length;B++)this.words[B]=v.words[B];return this},i.prototype.add=function(l){var g;return l.negative!==0&&this.negative===0?(l.negative=0,g=this.sub(l),l.negative^=1,g):l.negative===0&&this.negative!==0?(this.negative=0,g=l.sub(this),this.negative=1,g):this.length>l.length?this.clone().iadd(l):l.clone().iadd(this)},i.prototype.isub=function(l){if(l.negative!==0){l.negative=0;var g=this.iadd(l);return l.negative=1,g._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(l),this.negative=1,this._normSign();var v=this.cmp(l);if(v===0)return this.negative=0,this.length=1,this.words[0]=0,this;var P,x;v>0?(P=this,x=l):(P=l,x=this);for(var B=0,M=0;M<x.length;M++)g=(P.words[M]|0)-(x.words[M]|0)+B,B=g>>26,this.words[M]=g&67108863;for(;B!==0&&M<P.length;M++)g=(P.words[M]|0)+B,B=g>>26,this.words[M]=g&67108863;if(B===0&&M<P.length&&P!==this)for(;M<P.length;M++)this.words[M]=P.words[M];return this.length=Math.max(this.length,M),P!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(l){return this.clone().isub(l)};function m(O,l,g){g.negative=l.negative^O.negative;var v=O.length+l.length|0;g.length=v,v=v-1|0;var P=O.words[0]|0,x=l.words[0]|0,B=P*x,M=B&67108863,T=B/67108864|0;g.words[0]=M;for(var h=1;h<v;h++){for(var A=T>>>26,D=T&67108863,K=Math.min(h,l.length-1),F=Math.max(0,h-O.length+1);F<=K;F++){var Z=h-F|0;P=O.words[Z]|0,x=l.words[F]|0,B=P*x+D,A+=B/67108864|0,D=B&67108863}g.words[h]=D|0,T=A|0}return T!==0?g.words[h]=T|0:g.length--,g.strip()}var y=function(l,g,v){var P=l.words,x=g.words,B=v.words,M=0,T,h,A,D=P[0]|0,K=D&8191,F=D>>>13,Z=P[1]|0,ce=Z&8191,we=Z>>>13,_r=P[2]|0,Ie=_r&8191,Se=_r>>>13,Ni=P[3]|0,et=Ni&8191,Te=Ni>>>13,Ri=P[4]|0,Ke=Ri&8191,tt=Ri>>>13,qa=P[5]|0,ht=qa&8191,pt=qa>>>13,M0=P[6]|0,bt=M0&8191,gt=M0>>>13,C0=P[7]|0,yt=C0&8191,mt=C0>>>13,k0=P[8]|0,_t=k0&8191,vt=k0>>>13,H0=P[9]|0,wt=H0&8191,St=H0>>>13,N0=x[0]|0,xt=N0&8191,Pt=N0>>>13,R0=x[1]|0,Tt=R0&8191,Et=R0>>>13,U0=x[2]|0,At=U0&8191,It=U0>>>13,q0=x[3]|0,Ot=q0&8191,Bt=q0>>>13,L0=x[4]|0,Mt=L0&8191,Ct=L0>>>13,K0=x[5]|0,kt=K0&8191,Ht=K0>>>13,D0=x[6]|0,Nt=D0&8191,Rt=D0>>>13,j0=x[7]|0,Ut=j0&8191,qt=j0>>>13,F0=x[8]|0,Lt=F0&8191,Kt=F0>>>13,G0=x[9]|0,Dt=G0&8191,jt=G0>>>13;v.negative=l.negative^g.negative,v.length=19,T=Math.imul(K,xt),h=Math.imul(K,Pt),h=h+Math.imul(F,xt)|0,A=Math.imul(F,Pt);var ud=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(ud>>>26)|0,ud&=67108863,T=Math.imul(ce,xt),h=Math.imul(ce,Pt),h=h+Math.imul(we,xt)|0,A=Math.imul(we,Pt),T=T+Math.imul(K,Tt)|0,h=h+Math.imul(K,Et)|0,h=h+Math.imul(F,Tt)|0,A=A+Math.imul(F,Et)|0;var fd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(fd>>>26)|0,fd&=67108863,T=Math.imul(Ie,xt),h=Math.imul(Ie,Pt),h=h+Math.imul(Se,xt)|0,A=Math.imul(Se,Pt),T=T+Math.imul(ce,Tt)|0,h=h+Math.imul(ce,Et)|0,h=h+Math.imul(we,Tt)|0,A=A+Math.imul(we,Et)|0,T=T+Math.imul(K,At)|0,h=h+Math.imul(K,It)|0,h=h+Math.imul(F,At)|0,A=A+Math.imul(F,It)|0;var dd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(dd>>>26)|0,dd&=67108863,T=Math.imul(et,xt),h=Math.imul(et,Pt),h=h+Math.imul(Te,xt)|0,A=Math.imul(Te,Pt),T=T+Math.imul(Ie,Tt)|0,h=h+Math.imul(Ie,Et)|0,h=h+Math.imul(Se,Tt)|0,A=A+Math.imul(Se,Et)|0,T=T+Math.imul(ce,At)|0,h=h+Math.imul(ce,It)|0,h=h+Math.imul(we,At)|0,A=A+Math.imul(we,It)|0,T=T+Math.imul(K,Ot)|0,h=h+Math.imul(K,Bt)|0,h=h+Math.imul(F,Ot)|0,A=A+Math.imul(F,Bt)|0;var ld=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(ld>>>26)|0,ld&=67108863,T=Math.imul(Ke,xt),h=Math.imul(Ke,Pt),h=h+Math.imul(tt,xt)|0,A=Math.imul(tt,Pt),T=T+Math.imul(et,Tt)|0,h=h+Math.imul(et,Et)|0,h=h+Math.imul(Te,Tt)|0,A=A+Math.imul(Te,Et)|0,T=T+Math.imul(Ie,At)|0,h=h+Math.imul(Ie,It)|0,h=h+Math.imul(Se,At)|0,A=A+Math.imul(Se,It)|0,T=T+Math.imul(ce,Ot)|0,h=h+Math.imul(ce,Bt)|0,h=h+Math.imul(we,Ot)|0,A=A+Math.imul(we,Bt)|0,T=T+Math.imul(K,Mt)|0,h=h+Math.imul(K,Ct)|0,h=h+Math.imul(F,Mt)|0,A=A+Math.imul(F,Ct)|0;var hd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(hd>>>26)|0,hd&=67108863,T=Math.imul(ht,xt),h=Math.imul(ht,Pt),h=h+Math.imul(pt,xt)|0,A=Math.imul(pt,Pt),T=T+Math.imul(Ke,Tt)|0,h=h+Math.imul(Ke,Et)|0,h=h+Math.imul(tt,Tt)|0,A=A+Math.imul(tt,Et)|0,T=T+Math.imul(et,At)|0,h=h+Math.imul(et,It)|0,h=h+Math.imul(Te,At)|0,A=A+Math.imul(Te,It)|0,T=T+Math.imul(Ie,Ot)|0,h=h+Math.imul(Ie,Bt)|0,h=h+Math.imul(Se,Ot)|0,A=A+Math.imul(Se,Bt)|0,T=T+Math.imul(ce,Mt)|0,h=h+Math.imul(ce,Ct)|0,h=h+Math.imul(we,Mt)|0,A=A+Math.imul(we,Ct)|0,T=T+Math.imul(K,kt)|0,h=h+Math.imul(K,Ht)|0,h=h+Math.imul(F,kt)|0,A=A+Math.imul(F,Ht)|0;var pd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(pd>>>26)|0,pd&=67108863,T=Math.imul(bt,xt),h=Math.imul(bt,Pt),h=h+Math.imul(gt,xt)|0,A=Math.imul(gt,Pt),T=T+Math.imul(ht,Tt)|0,h=h+Math.imul(ht,Et)|0,h=h+Math.imul(pt,Tt)|0,A=A+Math.imul(pt,Et)|0,T=T+Math.imul(Ke,At)|0,h=h+Math.imul(Ke,It)|0,h=h+Math.imul(tt,At)|0,A=A+Math.imul(tt,It)|0,T=T+Math.imul(et,Ot)|0,h=h+Math.imul(et,Bt)|0,h=h+Math.imul(Te,Ot)|0,A=A+Math.imul(Te,Bt)|0,T=T+Math.imul(Ie,Mt)|0,h=h+Math.imul(Ie,Ct)|0,h=h+Math.imul(Se,Mt)|0,A=A+Math.imul(Se,Ct)|0,T=T+Math.imul(ce,kt)|0,h=h+Math.imul(ce,Ht)|0,h=h+Math.imul(we,kt)|0,A=A+Math.imul(we,Ht)|0,T=T+Math.imul(K,Nt)|0,h=h+Math.imul(K,Rt)|0,h=h+Math.imul(F,Nt)|0,A=A+Math.imul(F,Rt)|0;var bd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(bd>>>26)|0,bd&=67108863,T=Math.imul(yt,xt),h=Math.imul(yt,Pt),h=h+Math.imul(mt,xt)|0,A=Math.imul(mt,Pt),T=T+Math.imul(bt,Tt)|0,h=h+Math.imul(bt,Et)|0,h=h+Math.imul(gt,Tt)|0,A=A+Math.imul(gt,Et)|0,T=T+Math.imul(ht,At)|0,h=h+Math.imul(ht,It)|0,h=h+Math.imul(pt,At)|0,A=A+Math.imul(pt,It)|0,T=T+Math.imul(Ke,Ot)|0,h=h+Math.imul(Ke,Bt)|0,h=h+Math.imul(tt,Ot)|0,A=A+Math.imul(tt,Bt)|0,T=T+Math.imul(et,Mt)|0,h=h+Math.imul(et,Ct)|0,h=h+Math.imul(Te,Mt)|0,A=A+Math.imul(Te,Ct)|0,T=T+Math.imul(Ie,kt)|0,h=h+Math.imul(Ie,Ht)|0,h=h+Math.imul(Se,kt)|0,A=A+Math.imul(Se,Ht)|0,T=T+Math.imul(ce,Nt)|0,h=h+Math.imul(ce,Rt)|0,h=h+Math.imul(we,Nt)|0,A=A+Math.imul(we,Rt)|0,T=T+Math.imul(K,Ut)|0,h=h+Math.imul(K,qt)|0,h=h+Math.imul(F,Ut)|0,A=A+Math.imul(F,qt)|0;var gd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(gd>>>26)|0,gd&=67108863,T=Math.imul(_t,xt),h=Math.imul(_t,Pt),h=h+Math.imul(vt,xt)|0,A=Math.imul(vt,Pt),T=T+Math.imul(yt,Tt)|0,h=h+Math.imul(yt,Et)|0,h=h+Math.imul(mt,Tt)|0,A=A+Math.imul(mt,Et)|0,T=T+Math.imul(bt,At)|0,h=h+Math.imul(bt,It)|0,h=h+Math.imul(gt,At)|0,A=A+Math.imul(gt,It)|0,T=T+Math.imul(ht,Ot)|0,h=h+Math.imul(ht,Bt)|0,h=h+Math.imul(pt,Ot)|0,A=A+Math.imul(pt,Bt)|0,T=T+Math.imul(Ke,Mt)|0,h=h+Math.imul(Ke,Ct)|0,h=h+Math.imul(tt,Mt)|0,A=A+Math.imul(tt,Ct)|0,T=T+Math.imul(et,kt)|0,h=h+Math.imul(et,Ht)|0,h=h+Math.imul(Te,kt)|0,A=A+Math.imul(Te,Ht)|0,T=T+Math.imul(Ie,Nt)|0,h=h+Math.imul(Ie,Rt)|0,h=h+Math.imul(Se,Nt)|0,A=A+Math.imul(Se,Rt)|0,T=T+Math.imul(ce,Ut)|0,h=h+Math.imul(ce,qt)|0,h=h+Math.imul(we,Ut)|0,A=A+Math.imul(we,qt)|0,T=T+Math.imul(K,Lt)|0,h=h+Math.imul(K,Kt)|0,h=h+Math.imul(F,Lt)|0,A=A+Math.imul(F,Kt)|0;var yd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(yd>>>26)|0,yd&=67108863,T=Math.imul(wt,xt),h=Math.imul(wt,Pt),h=h+Math.imul(St,xt)|0,A=Math.imul(St,Pt),T=T+Math.imul(_t,Tt)|0,h=h+Math.imul(_t,Et)|0,h=h+Math.imul(vt,Tt)|0,A=A+Math.imul(vt,Et)|0,T=T+Math.imul(yt,At)|0,h=h+Math.imul(yt,It)|0,h=h+Math.imul(mt,At)|0,A=A+Math.imul(mt,It)|0,T=T+Math.imul(bt,Ot)|0,h=h+Math.imul(bt,Bt)|0,h=h+Math.imul(gt,Ot)|0,A=A+Math.imul(gt,Bt)|0,T=T+Math.imul(ht,Mt)|0,h=h+Math.imul(ht,Ct)|0,h=h+Math.imul(pt,Mt)|0,A=A+Math.imul(pt,Ct)|0,T=T+Math.imul(Ke,kt)|0,h=h+Math.imul(Ke,Ht)|0,h=h+Math.imul(tt,kt)|0,A=A+Math.imul(tt,Ht)|0,T=T+Math.imul(et,Nt)|0,h=h+Math.imul(et,Rt)|0,h=h+Math.imul(Te,Nt)|0,A=A+Math.imul(Te,Rt)|0,T=T+Math.imul(Ie,Ut)|0,h=h+Math.imul(Ie,qt)|0,h=h+Math.imul(Se,Ut)|0,A=A+Math.imul(Se,qt)|0,T=T+Math.imul(ce,Lt)|0,h=h+Math.imul(ce,Kt)|0,h=h+Math.imul(we,Lt)|0,A=A+Math.imul(we,Kt)|0,T=T+Math.imul(K,Dt)|0,h=h+Math.imul(K,jt)|0,h=h+Math.imul(F,Dt)|0,A=A+Math.imul(F,jt)|0;var md=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(md>>>26)|0,md&=67108863,T=Math.imul(wt,Tt),h=Math.imul(wt,Et),h=h+Math.imul(St,Tt)|0,A=Math.imul(St,Et),T=T+Math.imul(_t,At)|0,h=h+Math.imul(_t,It)|0,h=h+Math.imul(vt,At)|0,A=A+Math.imul(vt,It)|0,T=T+Math.imul(yt,Ot)|0,h=h+Math.imul(yt,Bt)|0,h=h+Math.imul(mt,Ot)|0,A=A+Math.imul(mt,Bt)|0,T=T+Math.imul(bt,Mt)|0,h=h+Math.imul(bt,Ct)|0,h=h+Math.imul(gt,Mt)|0,A=A+Math.imul(gt,Ct)|0,T=T+Math.imul(ht,kt)|0,h=h+Math.imul(ht,Ht)|0,h=h+Math.imul(pt,kt)|0,A=A+Math.imul(pt,Ht)|0,T=T+Math.imul(Ke,Nt)|0,h=h+Math.imul(Ke,Rt)|0,h=h+Math.imul(tt,Nt)|0,A=A+Math.imul(tt,Rt)|0,T=T+Math.imul(et,Ut)|0,h=h+Math.imul(et,qt)|0,h=h+Math.imul(Te,Ut)|0,A=A+Math.imul(Te,qt)|0,T=T+Math.imul(Ie,Lt)|0,h=h+Math.imul(Ie,Kt)|0,h=h+Math.imul(Se,Lt)|0,A=A+Math.imul(Se,Kt)|0,T=T+Math.imul(ce,Dt)|0,h=h+Math.imul(ce,jt)|0,h=h+Math.imul(we,Dt)|0,A=A+Math.imul(we,jt)|0;var _d=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(_d>>>26)|0,_d&=67108863,T=Math.imul(wt,At),h=Math.imul(wt,It),h=h+Math.imul(St,At)|0,A=Math.imul(St,It),T=T+Math.imul(_t,Ot)|0,h=h+Math.imul(_t,Bt)|0,h=h+Math.imul(vt,Ot)|0,A=A+Math.imul(vt,Bt)|0,T=T+Math.imul(yt,Mt)|0,h=h+Math.imul(yt,Ct)|0,h=h+Math.imul(mt,Mt)|0,A=A+Math.imul(mt,Ct)|0,T=T+Math.imul(bt,kt)|0,h=h+Math.imul(bt,Ht)|0,h=h+Math.imul(gt,kt)|0,A=A+Math.imul(gt,Ht)|0,T=T+Math.imul(ht,Nt)|0,h=h+Math.imul(ht,Rt)|0,h=h+Math.imul(pt,Nt)|0,A=A+Math.imul(pt,Rt)|0,T=T+Math.imul(Ke,Ut)|0,h=h+Math.imul(Ke,qt)|0,h=h+Math.imul(tt,Ut)|0,A=A+Math.imul(tt,qt)|0,T=T+Math.imul(et,Lt)|0,h=h+Math.imul(et,Kt)|0,h=h+Math.imul(Te,Lt)|0,A=A+Math.imul(Te,Kt)|0,T=T+Math.imul(Ie,Dt)|0,h=h+Math.imul(Ie,jt)|0,h=h+Math.imul(Se,Dt)|0,A=A+Math.imul(Se,jt)|0;var vd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(vd>>>26)|0,vd&=67108863,T=Math.imul(wt,Ot),h=Math.imul(wt,Bt),h=h+Math.imul(St,Ot)|0,A=Math.imul(St,Bt),T=T+Math.imul(_t,Mt)|0,h=h+Math.imul(_t,Ct)|0,h=h+Math.imul(vt,Mt)|0,A=A+Math.imul(vt,Ct)|0,T=T+Math.imul(yt,kt)|0,h=h+Math.imul(yt,Ht)|0,h=h+Math.imul(mt,kt)|0,A=A+Math.imul(mt,Ht)|0,T=T+Math.imul(bt,Nt)|0,h=h+Math.imul(bt,Rt)|0,h=h+Math.imul(gt,Nt)|0,A=A+Math.imul(gt,Rt)|0,T=T+Math.imul(ht,Ut)|0,h=h+Math.imul(ht,qt)|0,h=h+Math.imul(pt,Ut)|0,A=A+Math.imul(pt,qt)|0,T=T+Math.imul(Ke,Lt)|0,h=h+Math.imul(Ke,Kt)|0,h=h+Math.imul(tt,Lt)|0,A=A+Math.imul(tt,Kt)|0,T=T+Math.imul(et,Dt)|0,h=h+Math.imul(et,jt)|0,h=h+Math.imul(Te,Dt)|0,A=A+Math.imul(Te,jt)|0;var wd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(wd>>>26)|0,wd&=67108863,T=Math.imul(wt,Mt),h=Math.imul(wt,Ct),h=h+Math.imul(St,Mt)|0,A=Math.imul(St,Ct),T=T+Math.imul(_t,kt)|0,h=h+Math.imul(_t,Ht)|0,h=h+Math.imul(vt,kt)|0,A=A+Math.imul(vt,Ht)|0,T=T+Math.imul(yt,Nt)|0,h=h+Math.imul(yt,Rt)|0,h=h+Math.imul(mt,Nt)|0,A=A+Math.imul(mt,Rt)|0,T=T+Math.imul(bt,Ut)|0,h=h+Math.imul(bt,qt)|0,h=h+Math.imul(gt,Ut)|0,A=A+Math.imul(gt,qt)|0,T=T+Math.imul(ht,Lt)|0,h=h+Math.imul(ht,Kt)|0,h=h+Math.imul(pt,Lt)|0,A=A+Math.imul(pt,Kt)|0,T=T+Math.imul(Ke,Dt)|0,h=h+Math.imul(Ke,jt)|0,h=h+Math.imul(tt,Dt)|0,A=A+Math.imul(tt,jt)|0;var Sd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Sd>>>26)|0,Sd&=67108863,T=Math.imul(wt,kt),h=Math.imul(wt,Ht),h=h+Math.imul(St,kt)|0,A=Math.imul(St,Ht),T=T+Math.imul(_t,Nt)|0,h=h+Math.imul(_t,Rt)|0,h=h+Math.imul(vt,Nt)|0,A=A+Math.imul(vt,Rt)|0,T=T+Math.imul(yt,Ut)|0,h=h+Math.imul(yt,qt)|0,h=h+Math.imul(mt,Ut)|0,A=A+Math.imul(mt,qt)|0,T=T+Math.imul(bt,Lt)|0,h=h+Math.imul(bt,Kt)|0,h=h+Math.imul(gt,Lt)|0,A=A+Math.imul(gt,Kt)|0,T=T+Math.imul(ht,Dt)|0,h=h+Math.imul(ht,jt)|0,h=h+Math.imul(pt,Dt)|0,A=A+Math.imul(pt,jt)|0;var xd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(xd>>>26)|0,xd&=67108863,T=Math.imul(wt,Nt),h=Math.imul(wt,Rt),h=h+Math.imul(St,Nt)|0,A=Math.imul(St,Rt),T=T+Math.imul(_t,Ut)|0,h=h+Math.imul(_t,qt)|0,h=h+Math.imul(vt,Ut)|0,A=A+Math.imul(vt,qt)|0,T=T+Math.imul(yt,Lt)|0,h=h+Math.imul(yt,Kt)|0,h=h+Math.imul(mt,Lt)|0,A=A+Math.imul(mt,Kt)|0,T=T+Math.imul(bt,Dt)|0,h=h+Math.imul(bt,jt)|0,h=h+Math.imul(gt,Dt)|0,A=A+Math.imul(gt,jt)|0;var Pd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Pd>>>26)|0,Pd&=67108863,T=Math.imul(wt,Ut),h=Math.imul(wt,qt),h=h+Math.imul(St,Ut)|0,A=Math.imul(St,qt),T=T+Math.imul(_t,Lt)|0,h=h+Math.imul(_t,Kt)|0,h=h+Math.imul(vt,Lt)|0,A=A+Math.imul(vt,Kt)|0,T=T+Math.imul(yt,Dt)|0,h=h+Math.imul(yt,jt)|0,h=h+Math.imul(mt,Dt)|0,A=A+Math.imul(mt,jt)|0;var Td=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Td>>>26)|0,Td&=67108863,T=Math.imul(wt,Lt),h=Math.imul(wt,Kt),h=h+Math.imul(St,Lt)|0,A=Math.imul(St,Kt),T=T+Math.imul(_t,Dt)|0,h=h+Math.imul(_t,jt)|0,h=h+Math.imul(vt,Dt)|0,A=A+Math.imul(vt,jt)|0;var Ed=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Ed>>>26)|0,Ed&=67108863,T=Math.imul(wt,Dt),h=Math.imul(wt,jt),h=h+Math.imul(St,Dt)|0,A=Math.imul(St,jt);var Ad=(M+T|0)+((h&8191)<<13)|0;return M=(A+(h>>>13)|0)+(Ad>>>26)|0,Ad&=67108863,B[0]=ud,B[1]=fd,B[2]=dd,B[3]=ld,B[4]=hd,B[5]=pd,B[6]=bd,B[7]=gd,B[8]=yd,B[9]=md,B[10]=_d,B[11]=vd,B[12]=wd,B[13]=Sd,B[14]=xd,B[15]=Pd,B[16]=Td,B[17]=Ed,B[18]=Ad,M!==0&&(B[19]=M,v.length++),v};Math.imul||(y=m);function _(O,l,g){g.negative=l.negative^O.negative,g.length=O.length+l.length;for(var v=0,P=0,x=0;x<g.length-1;x++){var B=P;P=0;for(var M=v&67108863,T=Math.min(x,l.length-1),h=Math.max(0,x-O.length+1);h<=T;h++){var A=x-h,D=O.words[A]|0,K=l.words[h]|0,F=D*K,Z=F&67108863;B=B+(F/67108864|0)|0,Z=Z+M|0,M=Z&67108863,B=B+(Z>>>26)|0,P+=B>>>26,B&=67108863}g.words[x]=M,v=B,B=P}return v!==0?g.words[x]=v:g.length--,g.strip()}function E(O,l,g){var v=new I;return v.mulp(O,l,g)}i.prototype.mulTo=function(l,g){var v,P=this.length+l.length;return this.length===10&&l.length===10?v=y(this,l,g):P<63?v=m(this,l,g):P<1024?v=_(this,l,g):v=E(this,l,g),v};function I(O,l){this.x=O,this.y=l}I.prototype.makeRBT=function(l){for(var g=new Array(l),v=i.prototype._countBits(l)-1,P=0;P<l;P++)g[P]=this.revBin(P,v,l);return g},I.prototype.revBin=function(l,g,v){if(l===0||l===v-1)return l;for(var P=0,x=0;x<g;x++)P|=(l&1)<<g-x-1,l>>=1;return P},I.prototype.permute=function(l,g,v,P,x,B){for(var M=0;M<B;M++)P[M]=g[l[M]],x[M]=v[l[M]]},I.prototype.transform=function(l,g,v,P,x,B){this.permute(B,l,g,v,P,x);for(var M=1;M<x;M<<=1)for(var T=M<<1,h=Math.cos(2*Math.PI/T),A=Math.sin(2*Math.PI/T),D=0;D<x;D+=T)for(var K=h,F=A,Z=0;Z<M;Z++){var ce=v[D+Z],we=P[D+Z],_r=v[D+Z+M],Ie=P[D+Z+M],Se=K*_r-F*Ie;Ie=K*Ie+F*_r,_r=Se,v[D+Z]=ce+_r,P[D+Z]=we+Ie,v[D+Z+M]=ce-_r,P[D+Z+M]=we-Ie,Z!==T&&(Se=h*K-A*F,F=h*F+A*K,K=Se)}},I.prototype.guessLen13b=function(l,g){var v=Math.max(g,l)|1,P=v&1,x=0;for(v=v/2|0;v;v=v>>>1)x++;return 1<<x+1+P},I.prototype.conjugate=function(l,g,v){if(!(v<=1))for(var P=0;P<v/2;P++){var x=l[P];l[P]=l[v-P-1],l[v-P-1]=x,x=g[P],g[P]=-g[v-P-1],g[v-P-1]=-x}},I.prototype.normalize13b=function(l,g){for(var v=0,P=0;P<g/2;P++){var x=Math.round(l[2*P+1]/g)*8192+Math.round(l[2*P]/g)+v;l[P]=x&67108863,x<67108864?v=0:v=x/67108864|0}return l},I.prototype.convert13b=function(l,g,v,P){for(var x=0,B=0;B<g;B++)x=x+(l[B]|0),v[2*B]=x&8191,x=x>>>13,v[2*B+1]=x&8191,x=x>>>13;for(B=2*g;B<P;++B)v[B]=0;r(x===0),r((x&-8192)===0)},I.prototype.stub=function(l){for(var g=new Array(l),v=0;v<l;v++)g[v]=0;return g},I.prototype.mulp=function(l,g,v){var P=2*this.guessLen13b(l.length,g.length),x=this.makeRBT(P),B=this.stub(P),M=new Array(P),T=new Array(P),h=new Array(P),A=new Array(P),D=new Array(P),K=new Array(P),F=v.words;F.length=P,this.convert13b(l.words,l.length,M,P),this.convert13b(g.words,g.length,A,P),this.transform(M,B,T,h,P,x),this.transform(A,B,D,K,P,x);for(var Z=0;Z<P;Z++){var ce=T[Z]*D[Z]-h[Z]*K[Z];h[Z]=T[Z]*K[Z]+h[Z]*D[Z],T[Z]=ce}return this.conjugate(T,h,P),this.transform(T,h,F,B,P,x),this.conjugate(F,B,P),this.normalize13b(F,P),v.negative=l.negative^g.negative,v.length=l.length+g.length,v.strip()},i.prototype.mul=function(l){var g=new i(null);return g.words=new Array(this.length+l.length),this.mulTo(l,g)},i.prototype.mulf=function(l){var g=new i(null);return g.words=new Array(this.length+l.length),E(this,l,g)},i.prototype.imul=function(l){return this.clone().mulTo(l,this)},i.prototype.imuln=function(l){r(typeof l=="number"),r(l<67108864);for(var g=0,v=0;v<this.length;v++){var P=(this.words[v]|0)*l,x=(P&67108863)+(g&67108863);g>>=26,g+=P/67108864|0,g+=x>>>26,this.words[v]=x&67108863}return g!==0&&(this.words[v]=g,this.length++),this},i.prototype.muln=function(l){return this.clone().imuln(l)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(l){var g=b(l);if(g.length===0)return new i(1);for(var v=this,P=0;P<g.length&&g[P]===0;P++,v=v.sqr());if(++P<g.length)for(var x=v.sqr();P<g.length;P++,x=x.sqr())g[P]!==0&&(v=v.mul(x));return v},i.prototype.iushln=function(l){r(typeof l=="number"&&l>=0);var g=l%26,v=(l-g)/26,P=67108863>>>26-g<<26-g,x;if(g!==0){var B=0;for(x=0;x<this.length;x++){var M=this.words[x]&P,T=(this.words[x]|0)-M<<g;this.words[x]=T|B,B=M>>>26-g}B&&(this.words[x]=B,this.length++)}if(v!==0){for(x=this.length-1;x>=0;x--)this.words[x+v]=this.words[x];for(x=0;x<v;x++)this.words[x]=0;this.length+=v}return this.strip()},i.prototype.ishln=function(l){return r(this.negative===0),this.iushln(l)},i.prototype.iushrn=function(l,g,v){r(typeof l=="number"&&l>=0);var P;g?P=(g-g%26)/26:P=0;var x=l%26,B=Math.min((l-x)/26,this.length),M=67108863^67108863>>>x<<x,T=v;if(P-=B,P=Math.max(0,P),T){for(var h=0;h<B;h++)T.words[h]=this.words[h];T.length=B}if(B!==0)if(this.length>B)for(this.length-=B,h=0;h<this.length;h++)this.words[h]=this.words[h+B];else this.words[0]=0,this.length=1;var A=0;for(h=this.length-1;h>=0&&(A!==0||h>=P);h--){var D=this.words[h]|0;this.words[h]=A<<26-x|D>>>x,A=D&M}return T&&A!==0&&(T.words[T.length++]=A),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(l,g,v){return r(this.negative===0),this.iushrn(l,g,v)},i.prototype.shln=function(l){return this.clone().ishln(l)},i.prototype.ushln=function(l){return this.clone().iushln(l)},i.prototype.shrn=function(l){return this.clone().ishrn(l)},i.prototype.ushrn=function(l){return this.clone().iushrn(l)},i.prototype.testn=function(l){r(typeof l=="number"&&l>=0);var g=l%26,v=(l-g)/26,P=1<<g;if(this.length<=v)return!1;var x=this.words[v];return!!(x&P)},i.prototype.imaskn=function(l){r(typeof l=="number"&&l>=0);var g=l%26,v=(l-g)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=v)return this;if(g!==0&&v++,this.length=Math.min(v,this.length),g!==0){var P=67108863^67108863>>>g<<g;this.words[this.length-1]&=P}return this.strip()},i.prototype.maskn=function(l){return this.clone().imaskn(l)},i.prototype.iaddn=function(l){return r(typeof l=="number"),r(l<67108864),l<0?this.isubn(-l):this.negative!==0?this.length===1&&(this.words[0]|0)<l?(this.words[0]=l-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(l),this.negative=1,this):this._iaddn(l)},i.prototype._iaddn=function(l){this.words[0]+=l;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},i.prototype.isubn=function(l){if(r(typeof l=="number"),r(l<67108864),l<0)return this.iaddn(-l);if(this.negative!==0)return this.negative=0,this.iaddn(l),this.negative=1,this;if(this.words[0]-=l,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this.strip()},i.prototype.addn=function(l){return this.clone().iaddn(l)},i.prototype.subn=function(l){return this.clone().isubn(l)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(l,g,v){var P=l.length+v,x;this._expand(P);var B,M=0;for(x=0;x<l.length;x++){B=(this.words[x+v]|0)+M;var T=(l.words[x]|0)*g;B-=T&67108863,M=(B>>26)-(T/67108864|0),this.words[x+v]=B&67108863}for(;x<this.length-v;x++)B=(this.words[x+v]|0)+M,M=B>>26,this.words[x+v]=B&67108863;if(M===0)return this.strip();for(r(M===-1),M=0,x=0;x<this.length;x++)B=-(this.words[x]|0)+M,M=B>>26,this.words[x]=B&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(l,g){var v=this.length-l.length,P=this.clone(),x=l,B=x.words[x.length-1]|0,M=this._countBits(B);v=26-M,v!==0&&(x=x.ushln(v),P.iushln(v),B=x.words[x.length-1]|0);var T=P.length-x.length,h;if(g!=="mod"){h=new i(null),h.length=T+1,h.words=new Array(h.length);for(var A=0;A<h.length;A++)h.words[A]=0}var D=P.clone()._ishlnsubmul(x,1,T);D.negative===0&&(P=D,h&&(h.words[T]=1));for(var K=T-1;K>=0;K--){var F=(P.words[x.length+K]|0)*67108864+(P.words[x.length+K-1]|0);for(F=Math.min(F/B|0,67108863),P._ishlnsubmul(x,F,K);P.negative!==0;)F--,P.negative=0,P._ishlnsubmul(x,1,K),P.isZero()||(P.negative^=1);h&&(h.words[K]=F)}return h&&h.strip(),P.strip(),g!=="div"&&v!==0&&P.iushrn(v),{div:h||null,mod:P}},i.prototype.divmod=function(l,g,v){if(r(!l.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var P,x,B;return this.negative!==0&&l.negative===0?(B=this.neg().divmod(l,g),g!=="mod"&&(P=B.div.neg()),g!=="div"&&(x=B.mod.neg(),v&&x.negative!==0&&x.iadd(l)),{div:P,mod:x}):this.negative===0&&l.negative!==0?(B=this.divmod(l.neg(),g),g!=="mod"&&(P=B.div.neg()),{div:P,mod:B.mod}):(this.negative&l.negative)!==0?(B=this.neg().divmod(l.neg(),g),g!=="div"&&(x=B.mod.neg(),v&&x.negative!==0&&x.isub(l)),{div:B.div,mod:x}):l.length>this.length||this.cmp(l)<0?{div:new i(0),mod:this}:l.length===1?g==="div"?{div:this.divn(l.words[0]),mod:null}:g==="mod"?{div:null,mod:new i(this.modn(l.words[0]))}:{div:this.divn(l.words[0]),mod:new i(this.modn(l.words[0]))}:this._wordDiv(l,g)},i.prototype.div=function(l){return this.divmod(l,"div",!1).div},i.prototype.mod=function(l){return this.divmod(l,"mod",!1).mod},i.prototype.umod=function(l){return this.divmod(l,"mod",!0).mod},i.prototype.divRound=function(l){var g=this.divmod(l);if(g.mod.isZero())return g.div;var v=g.div.negative!==0?g.mod.isub(l):g.mod,P=l.ushrn(1),x=l.andln(1),B=v.cmp(P);return B<0||x===1&&B===0?g.div:g.div.negative!==0?g.div.isubn(1):g.div.iaddn(1)},i.prototype.modn=function(l){r(l<=67108863);for(var g=(1<<26)%l,v=0,P=this.length-1;P>=0;P--)v=(g*v+(this.words[P]|0))%l;return v},i.prototype.idivn=function(l){r(l<=67108863);for(var g=0,v=this.length-1;v>=0;v--){var P=(this.words[v]|0)+g*67108864;this.words[v]=P/l|0,g=P%l}return this.strip()},i.prototype.divn=function(l){return this.clone().idivn(l)},i.prototype.egcd=function(l){r(l.negative===0),r(!l.isZero());var g=this,v=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var P=new i(1),x=new i(0),B=new i(0),M=new i(1),T=0;g.isEven()&&v.isEven();)g.iushrn(1),v.iushrn(1),++T;for(var h=v.clone(),A=g.clone();!g.isZero();){for(var D=0,K=1;(g.words[0]&K)===0&&D<26;++D,K<<=1);if(D>0)for(g.iushrn(D);D-- >0;)(P.isOdd()||x.isOdd())&&(P.iadd(h),x.isub(A)),P.iushrn(1),x.iushrn(1);for(var F=0,Z=1;(v.words[0]&Z)===0&&F<26;++F,Z<<=1);if(F>0)for(v.iushrn(F);F-- >0;)(B.isOdd()||M.isOdd())&&(B.iadd(h),M.isub(A)),B.iushrn(1),M.iushrn(1);g.cmp(v)>=0?(g.isub(v),P.isub(B),x.isub(M)):(v.isub(g),B.isub(P),M.isub(x))}return{a:B,b:M,gcd:v.iushln(T)}},i.prototype._invmp=function(l){r(l.negative===0),r(!l.isZero());var g=this,v=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var P=new i(1),x=new i(0),B=v.clone();g.cmpn(1)>0&&v.cmpn(1)>0;){for(var M=0,T=1;(g.words[0]&T)===0&&M<26;++M,T<<=1);if(M>0)for(g.iushrn(M);M-- >0;)P.isOdd()&&P.iadd(B),P.iushrn(1);for(var h=0,A=1;(v.words[0]&A)===0&&h<26;++h,A<<=1);if(h>0)for(v.iushrn(h);h-- >0;)x.isOdd()&&x.iadd(B),x.iushrn(1);g.cmp(v)>=0?(g.isub(v),P.isub(x)):(v.isub(g),x.isub(P))}var D;return g.cmpn(1)===0?D=P:D=x,D.cmpn(0)<0&&D.iadd(l),D},i.prototype.gcd=function(l){if(this.isZero())return l.abs();if(l.isZero())return this.abs();var g=this.clone(),v=l.clone();g.negative=0,v.negative=0;for(var P=0;g.isEven()&&v.isEven();P++)g.iushrn(1),v.iushrn(1);do{for(;g.isEven();)g.iushrn(1);for(;v.isEven();)v.iushrn(1);var x=g.cmp(v);if(x<0){var B=g;g=v,v=B}else if(x===0||v.cmpn(1)===0)break;g.isub(v)}while(!0);return v.iushln(P)},i.prototype.invm=function(l){return this.egcd(l).a.umod(l)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(l){return this.words[0]&l},i.prototype.bincn=function(l){r(typeof l=="number");var g=l%26,v=(l-g)/26,P=1<<g;if(this.length<=v)return this._expand(v+1),this.words[v]|=P,this;for(var x=P,B=v;x!==0&&B<this.length;B++){var M=this.words[B]|0;M+=x,x=M>>>26,M&=67108863,this.words[B]=M}return x!==0&&(this.words[B]=x,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(l){var g=l<0;if(this.negative!==0&&!g)return-1;if(this.negative===0&&g)return 1;this.strip();var v;if(this.length>1)v=1;else{g&&(l=-l),r(l<=67108863,"Number is too big");var P=this.words[0]|0;v=P===l?0:P<l?-1:1}return this.negative!==0?-v|0:v},i.prototype.cmp=function(l){if(this.negative!==0&&l.negative===0)return-1;if(this.negative===0&&l.negative!==0)return 1;var g=this.ucmp(l);return this.negative!==0?-g|0:g},i.prototype.ucmp=function(l){if(this.length>l.length)return 1;if(this.length<l.length)return-1;for(var g=0,v=this.length-1;v>=0;v--){var P=this.words[v]|0,x=l.words[v]|0;if(P!==x){P<x?g=-1:P>x&&(g=1);break}}return g},i.prototype.gtn=function(l){return this.cmpn(l)===1},i.prototype.gt=function(l){return this.cmp(l)===1},i.prototype.gten=function(l){return this.cmpn(l)>=0},i.prototype.gte=function(l){return this.cmp(l)>=0},i.prototype.ltn=function(l){return this.cmpn(l)===-1},i.prototype.lt=function(l){return this.cmp(l)===-1},i.prototype.lten=function(l){return this.cmpn(l)<=0},i.prototype.lte=function(l){return this.cmp(l)<=0},i.prototype.eqn=function(l){return this.cmpn(l)===0},i.prototype.eq=function(l){return this.cmp(l)===0},i.red=function(l){return new L(l)},i.prototype.toRed=function(l){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),l.convertTo(this)._forceRed(l)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(l){return this.red=l,this},i.prototype.forceRed=function(l){return r(!this.red,"Already a number in reduction context"),this._forceRed(l)},i.prototype.redAdd=function(l){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,l)},i.prototype.redIAdd=function(l){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,l)},i.prototype.redSub=function(l){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,l)},i.prototype.redISub=function(l){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,l)},i.prototype.redShl=function(l){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,l)},i.prototype.redMul=function(l){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.mul(this,l)},i.prototype.redIMul=function(l){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.imul(this,l)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(l){return r(this.red&&!l.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,l)};var k={k256:null,p224:null,p192:null,p25519:null};function C(O,l){this.name=O,this.p=new i(l,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}C.prototype._tmp=function(){var l=new i(null);return l.words=new Array(Math.ceil(this.n/13)),l},C.prototype.ireduce=function(l){var g=l,v;do this.split(g,this.tmp),g=this.imulK(g),g=g.iadd(this.tmp),v=g.bitLength();while(v>this.n);var P=v<this.n?-1:g.ucmp(this.p);return P===0?(g.words[0]=0,g.length=1):P>0?g.isub(this.p):g.strip!==void 0?g.strip():g._strip(),g},C.prototype.split=function(l,g){l.iushrn(this.n,0,g)},C.prototype.imulK=function(l){return l.imul(this.k)};function R(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(R,C),R.prototype.split=function(l,g){for(var v=4194303,P=Math.min(l.length,9),x=0;x<P;x++)g.words[x]=l.words[x];if(g.length=P,l.length<=9){l.words[0]=0,l.length=1;return}var B=l.words[9];for(g.words[g.length++]=B&v,x=10;x<l.length;x++){var M=l.words[x]|0;l.words[x-10]=(M&v)<<4|B>>>22,B=M}B>>>=22,l.words[x-10]=B,B===0&&l.length>10?l.length-=10:l.length-=9},R.prototype.imulK=function(l){l.words[l.length]=0,l.words[l.length+1]=0,l.length+=2;for(var g=0,v=0;v<l.length;v++){var P=l.words[v]|0;g+=P*977,l.words[v]=g&67108863,g=P*64+(g/67108864|0)}return l.words[l.length-1]===0&&(l.length--,l.words[l.length-1]===0&&l.length--),l};function N(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(N,C);function U(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(U,C);function q(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(q,C),q.prototype.imulK=function(l){for(var g=0,v=0;v<l.length;v++){var P=(l.words[v]|0)*19+g,x=P&67108863;P>>>=26,l.words[v]=x,g=P}return g!==0&&(l.words[l.length++]=g),l},i._prime=function(l){if(k[l])return k[l];var g;if(l==="k256")g=new R;else if(l==="p224")g=new N;else if(l==="p192")g=new U;else if(l==="p25519")g=new q;else throw new Error("Unknown prime "+l);return k[l]=g,g};function L(O){if(typeof O=="string"){var l=i._prime(O);this.m=l.p,this.prime=l}else r(O.gtn(1),"modulus must be greater than 1"),this.m=O,this.prime=null}L.prototype._verify1=function(l){r(l.negative===0,"red works only with positives"),r(l.red,"red works only with red numbers")},L.prototype._verify2=function(l,g){r((l.negative|g.negative)===0,"red works only with positives"),r(l.red&&l.red===g.red,"red works only with red numbers")},L.prototype.imod=function(l){return this.prime?this.prime.ireduce(l)._forceRed(this):l.umod(this.m)._forceRed(this)},L.prototype.neg=function(l){return l.isZero()?l.clone():this.m.sub(l)._forceRed(this)},L.prototype.add=function(l,g){this._verify2(l,g);var v=l.add(g);return v.cmp(this.m)>=0&&v.isub(this.m),v._forceRed(this)},L.prototype.iadd=function(l,g){this._verify2(l,g);var v=l.iadd(g);return v.cmp(this.m)>=0&&v.isub(this.m),v},L.prototype.sub=function(l,g){this._verify2(l,g);var v=l.sub(g);return v.cmpn(0)<0&&v.iadd(this.m),v._forceRed(this)},L.prototype.isub=function(l,g){this._verify2(l,g);var v=l.isub(g);return v.cmpn(0)<0&&v.iadd(this.m),v},L.prototype.shl=function(l,g){return this._verify1(l),this.imod(l.ushln(g))},L.prototype.imul=function(l,g){return this._verify2(l,g),this.imod(l.imul(g))},L.prototype.mul=function(l,g){return this._verify2(l,g),this.imod(l.mul(g))},L.prototype.isqr=function(l){return this.imul(l,l.clone())},L.prototype.sqr=function(l){return this.mul(l,l)},L.prototype.sqrt=function(l){if(l.isZero())return l.clone();var g=this.m.andln(3);if(r(g%2===1),g===3){var v=this.m.add(new i(1)).iushrn(2);return this.pow(l,v)}for(var P=this.m.subn(1),x=0;!P.isZero()&&P.andln(1)===0;)x++,P.iushrn(1);r(!P.isZero());var B=new i(1).toRed(this),M=B.redNeg(),T=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new i(2*h*h).toRed(this);this.pow(h,T).cmp(M)!==0;)h.redIAdd(M);for(var A=this.pow(h,P),D=this.pow(l,P.addn(1).iushrn(1)),K=this.pow(l,P),F=x;K.cmp(B)!==0;){for(var Z=K,ce=0;Z.cmp(B)!==0;ce++)Z=Z.redSqr();r(ce<F);var we=this.pow(A,new i(1).iushln(F-ce-1));D=D.redMul(we),A=we.redSqr(),K=K.redMul(A),F=ce}return D},L.prototype.invm=function(l){var g=l._invmp(this.m);return g.negative!==0?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},L.prototype.pow=function(l,g){if(g.isZero())return new i(1).toRed(this);if(g.cmpn(1)===0)return l.clone();var v=4,P=new Array(1<<v);P[0]=new i(1).toRed(this),P[1]=l;for(var x=2;x<P.length;x++)P[x]=this.mul(P[x-1],l);var B=P[0],M=0,T=0,h=g.bitLength()%26;for(h===0&&(h=26),x=g.length-1;x>=0;x--){for(var A=g.words[x],D=h-1;D>=0;D--){var K=A>>D&1;if(B!==P[0]&&(B=this.sqr(B)),K===0&&M===0){T=0;continue}M<<=1,M|=K,T++,!(T!==v&&(x!==0||D!==0))&&(B=this.mul(B,P[M]),T=0,M=0)}h=26}return B},L.prototype.convertTo=function(l){var g=l.umod(this.m);return g===l?g.clone():g},L.prototype.convertFrom=function(l){var g=l.clone();return g.red=null,g},i.mont=function(l){return new V(l)};function V(O){L.call(this,O),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(V,L),V.prototype.convertTo=function(l){return this.imod(l.ushln(this.shift))},V.prototype.convertFrom=function(l){var g=this.imod(l.mul(this.rinv));return g.red=null,g},V.prototype.imul=function(l,g){if(l.isZero()||g.isZero())return l.words[0]=0,l.length=1,l;var v=l.imul(g),P=v.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=v.isub(P).iushrn(this.shift),B=x;return x.cmp(this.m)>=0?B=x.isub(this.m):x.cmpn(0)<0&&(B=x.iadd(this.m)),B._forceRed(this)},V.prototype.mul=function(l,g){if(l.isZero()||g.isZero())return new i(0)._forceRed(this);var v=l.mul(g),P=v.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=v.isub(P).iushrn(this.shift),B=x;return x.cmp(this.m)>=0?B=x.isub(this.m):x.cmpn(0)<0&&(B=x.iadd(this.m)),B._forceRed(this)},V.prototype.invm=function(l){var g=this.imod(l._invmp(this.m).mul(this.r2));return g._forceRed(this)}})(typeof fl>"u"||fl,tg)});var bn=H(rg=>{w();S();var Zn=rg,t6=Zr(),r6=Qv(),_u=ew();Zn.assert=r6;Zn.toArray=_u.toArray;Zn.zero2=_u.zero2;Zn.toHex=_u.toHex;Zn.encode=_u.encode;function n6(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),o=0;o<n.length;o++){var a,c=s.andln(i-1);s.isOdd()?(c>(i>>1)-1?a=(i>>1)-c:a=c,s.isubn(a)):a=0,n[o]=a,s.iushrn(1)}return n}Zn.getNAF=n6;function i6(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n=0,i=0,s;e.cmpn(-n)>0||t.cmpn(-i)>0;){var o=e.andln(3)+n&3,a=t.andln(3)+i&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)===0?c=0:(s=e.andln(7)+n&7,(s===3||s===5)&&a===2?c=-o:c=o),r[0].push(c);var u;(a&1)===0?u=0:(s=t.andln(7)+i&7,(s===3||s===5)&&o===2?u=-a:u=a),r[1].push(u),2*n===c+1&&(n=1-n),2*i===u+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return r}Zn.getJSF=i6;function s6(e,t,r){var n="_"+t;e.prototype[t]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}Zn.cachedProperty=s6;function o6(e){return typeof e=="string"?Zn.toArray(e,"hex"):e}Zn.parseBytes=o6;function a6(e){return new t6(e,"hex","le")}Zn.intFromLE=a6});var ic=H((cC,ng)=>{w();S();var nc=bn(),io=Zr(),vu=nc.getNAF,c6=nc.getJSF,wu=nc.assert;function Ss(e,t){this.type=e,this.p=new io(t.p,16),this.red=t.prime?io.red(t.prime):io.mont(this.p),this.zero=new io(0).toRed(this.red),this.one=new io(1).toRed(this.red),this.two=new io(2).toRed(this.red),this.n=t.n&&new io(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}ng.exports=Ss;Ss.prototype.point=function(){throw new Error("Not implemented")};Ss.prototype.validate=function(){throw new Error("Not implemented")};Ss.prototype._fixedNafMul=function(t,r){wu(t.precomputed);var n=t._getDoubles(),i=vu(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<i.length;a+=n.step){c=0;for(var u=a+n.step-1;u>=a;u--)c=(c<<1)+i[u];o.push(c)}for(var d=this.jpoint(null,null,null),f=this.jpoint(null,null,null),b=s;b>0;b--){for(a=0;a<o.length;a++)c=o[a],c===b?f=f.mixedAdd(n.points[a]):c===-b&&(f=f.mixedAdd(n.points[a].neg()));d=d.add(f)}return d.toP()};Ss.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=vu(r,n,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var d=o[c];wu(d!==0),t.type==="affine"?d>0?a=a.mixedAdd(s[d-1>>1]):a=a.mixedAdd(s[-d-1>>1].neg()):d>0?a=a.add(s[d-1>>1]):a=a.add(s[-d-1>>1].neg())}return t.type==="affine"?a.toP():a};Ss.prototype._wnafMulAdd=function(t,r,n,i,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,d,f,b;for(d=0;d<i;d++){b=r[d];var m=b._getNAFPoints(t);o[d]=m.wnd,a[d]=m.points}for(d=i-1;d>=1;d-=2){var y=d-1,_=d;if(o[y]!==1||o[_]!==1){c[y]=vu(n[y],o[y],this._bitLength),c[_]=vu(n[_],o[_],this._bitLength),u=Math.max(c[y].length,u),u=Math.max(c[_].length,u);continue}var E=[r[y],null,null,r[_]];r[y].y.cmp(r[_].y)===0?(E[1]=r[y].add(r[_]),E[2]=r[y].toJ().mixedAdd(r[_].neg())):r[y].y.cmp(r[_].y.redNeg())===0?(E[1]=r[y].toJ().mixedAdd(r[_]),E[2]=r[y].add(r[_].neg())):(E[1]=r[y].toJ().mixedAdd(r[_]),E[2]=r[y].toJ().mixedAdd(r[_].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],k=c6(n[y],n[_]);for(u=Math.max(k[0].length,u),c[y]=new Array(u),c[_]=new Array(u),f=0;f<u;f++){var C=k[0][f]|0,R=k[1][f]|0;c[y][f]=I[(C+1)*3+(R+1)],c[_][f]=0,a[y]=E}}var N=this.jpoint(null,null,null),U=this._wnafT4;for(d=u;d>=0;d--){for(var q=0;d>=0;){var L=!0;for(f=0;f<i;f++)U[f]=c[f][d]|0,U[f]!==0&&(L=!1);if(!L)break;q++,d--}if(d>=0&&q++,N=N.dblp(q),d<0)break;for(f=0;f<i;f++){var V=U[f];V!==0&&(V>0?b=a[f][V-1>>1]:V<0&&(b=a[f][-V-1>>1].neg()),b.type==="affine"?N=N.mixedAdd(b):N=N.add(b))}}for(d=0;d<i;d++)a[d]=null;return s?N:N.toP()};function wn(e,t){this.curve=e,this.type=t,this.precomputed=null}Ss.BasePoint=wn;wn.prototype.eq=function(){throw new Error("Not implemented")};wn.prototype.validate=function(){return this.curve.validate(this)};Ss.prototype.decodePoint=function(t,r){t=nc.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*n){t[0]===6?wu(t[t.length-1]%2===0):t[0]===7&&wu(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};wn.prototype.encodeCompressed=function(t){return this.encode(t,!0)};wn.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};wn.prototype.encode=function(t,r){return nc.encode(this._encode(r),t)};wn.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};wn.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};wn.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=t){for(var o=0;o<t;o++)i=i.dbl();n.push(i)}return{step:t,points:n}};wn.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:t,points:r}};wn.prototype._getBeta=function(){return null};wn.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r}});var sg=H((dC,ig)=>{w();S();var u6=bn(),st=Zr(),dl=Id(),ea=ic(),f6=u6.assert;function Sn(e){ea.call(this,"short",e),this.a=new st(e.a,16).toRed(this.red),this.b=new st(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}dl(Sn,ea);ig.exports=Sn;Sn.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new st(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new st(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],f6(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return t.basis?o=t.basis.map(function(a){return{a:new st(a.a,16),b:new st(a.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}};Sn.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:st.mont(t),n=new st(2).toRed(r).redInvm(),i=n.redNeg(),s=new st(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]};Sn.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),s=new st(1),o=new st(0),a=new st(0),c=new st(1),u,d,f,b,m,y,_,E=0,I,k;n.cmpn(0)!==0;){var C=i.div(n);I=i.sub(C.mul(n)),k=a.sub(C.mul(s));var R=c.sub(C.mul(o));if(!f&&I.cmp(r)<0)u=_.neg(),d=s,f=I.neg(),b=k;else if(f&&++E===2)break;_=I,i=n,n=I,a=s,s=k,c=o,o=R}m=I.neg(),y=k;var N=f.sqr().add(b.sqr()),U=m.sqr().add(y.sqr());return U.cmp(N)>=0&&(m=u,y=d),f.negative&&(f=f.neg(),b=b.neg()),m.negative&&(m=m.neg(),y=y.neg()),[{a:f,b},{a:m,b:y}]};Sn.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(t).divRound(this.n),o=n.b.neg().mul(t).divRound(this.n),a=s.mul(n.a),c=o.mul(i.a),u=s.mul(n.b),d=o.mul(i.b),f=t.sub(a).sub(c),b=u.add(d).neg();return{k1:f,k2:b}};Sn.prototype.pointFromX=function(t,r){t=new st(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(t,i)};Sn.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};Sn.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<t.length;o++){var a=this._endoSplit(r[o]),c=t[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),i[o*2]=c,i[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var d=this._wnafMulAdd(1,i,s,o*2,n),f=0;f<o*2;f++)i[f]=null,s[f]=null;return d};function ar(e,t,r,n){ea.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new st(t,16),this.y=new st(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}dl(ar,ea.BasePoint);Sn.prototype.point=function(t,r,n){return new ar(this,t,r,n)};Sn.prototype.pointFromJSON=function(t,r){return ar.fromJSON(this,t,r)};ar.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};ar.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};ar.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function s(a){return t.point(a[0],a[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};ar.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};ar.prototype.isInfinity=function(){return this.inf};ar.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};ar.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};ar.prototype.getX=function(){return this.x.fromRed()};ar.prototype.getY=function(){return this.y.fromRed()};ar.prototype.mul=function(t){return t=new st(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};ar.prototype.mulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};ar.prototype.jmulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};ar.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};ar.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};ar.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function xr(e,t,r,n){ea.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new st(0)):(this.x=new st(t,16),this.y=new st(r,16),this.z=new st(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}dl(xr,ea.BasePoint);Sn.prototype.jpoint=function(t,r,n){return new xr(this,t,r,n)};xr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};xr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};xr.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(n),o=this.y.redMul(r.redMul(t.z)),a=t.y.redMul(n.redMul(this.z)),c=i.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var d=c.redSqr(),f=d.redMul(c),b=i.redMul(d),m=u.redSqr().redIAdd(f).redISub(b).redISub(b),y=u.redMul(b.redISub(m)).redISub(o.redMul(f)),_=this.z.redMul(t.z).redMul(c);return this.curve.jpoint(m,y,_)};xr.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),s=this.y,o=t.y.redMul(r).redMul(this.z),a=n.redSub(i),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),d=u.redMul(a),f=n.redMul(u),b=c.redSqr().redIAdd(d).redISub(f).redISub(f),m=c.redMul(f.redISub(b)).redISub(s.redMul(d)),y=this.z.redMul(a);return this.curve.jpoint(b,m,y)};xr.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),d=a.redAdd(a);for(r=0;r<t;r++){var f=o.redSqr(),b=d.redSqr(),m=b.redSqr(),y=f.redAdd(f).redIAdd(f).redIAdd(i.redMul(u)),_=o.redMul(b),E=y.redSqr().redISub(_.redAdd(_)),I=_.redISub(E),k=y.redMul(I);k=k.redIAdd(k).redISub(m);var C=d.redMul(c);r+1<t&&(u=u.redMul(m)),o=E,c=C,d=k}return this.curve.jpoint(o,d.redMul(s),c)};xr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};xr.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i),u=c.redSqr().redISub(a).redISub(a),d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),t=u,r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var f=this.x.redSqr(),b=this.y.redSqr(),m=b.redSqr(),y=this.x.redAdd(b).redSqr().redISub(f).redISub(m);y=y.redIAdd(y);var _=f.redAdd(f).redIAdd(f),E=_.redSqr(),I=m.redIAdd(m);I=I.redIAdd(I),I=I.redIAdd(I),t=E.redISub(y).redISub(y),r=_.redMul(y.redISub(t)).redISub(I),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};xr.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);t=u;var d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var f=this.z.redSqr(),b=this.y.redSqr(),m=this.x.redMul(b),y=this.x.redSub(f).redMul(this.x.redAdd(f));y=y.redAdd(y).redIAdd(y);var _=m.redIAdd(m);_=_.redIAdd(_);var E=_.redAdd(_);t=y.redSqr().redISub(E),n=this.y.redAdd(this.z).redSqr().redISub(b).redISub(f);var I=b.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I),r=y.redMul(_.redISub(t)).redISub(I)}return this.curve.jpoint(t,r,n)};xr.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),a=n.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(t.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var d=u.redMul(a),f=c.redSqr().redISub(d.redAdd(d)),b=d.redISub(f),m=a.redSqr();m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var y=c.redMul(b).redISub(m),_=n.redAdd(n).redMul(i);return this.curve.jpoint(f,y,_)};xr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=t.redAdd(t).redIAdd(t),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(t).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var d=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),f=r.redMul(d);f=f.redIAdd(f),f=f.redIAdd(f);var b=this.x.redMul(c).redISub(f);b=b.redIAdd(b),b=b.redIAdd(b);var m=this.y.redMul(d.redMul(u.redISub(d)).redISub(a.redMul(c)));m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var y=this.z.redAdd(a).redSqr().redISub(n).redISub(c);return this.curve.jpoint(b,m,y)};xr.prototype.mul=function(t,r){return t=new st(t,r),this.curve._wnafMul(this,t)};xr.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(i)).cmpn(0)===0};xr.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};xr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};xr.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var cg=H((pC,ag)=>{w();S();var ta=Zr(),og=Id(),Su=ic(),d6=bn();function ra(e){Su.call(this,"mont",e),this.a=new ta(e.a,16).toRed(this.red),this.b=new ta(e.b,16).toRed(this.red),this.i4=new ta(4).toRed(this.red).redInvm(),this.two=new ta(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}og(ra,Su);ag.exports=ra;ra.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function cr(e,t,r){Su.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new ta(t,16),this.z=new ta(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}og(cr,Su.BasePoint);ra.prototype.decodePoint=function(t,r){return this.point(d6.toArray(t,r),1)};ra.prototype.point=function(t,r){return new cr(this,t,r)};ra.prototype.pointFromJSON=function(t){return cr.fromJSON(this,t)};cr.prototype.precompute=function(){};cr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};cr.fromJSON=function(t,r){return new cr(t,r[0],r[1]||t.one)};cr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};cr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};cr.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),a=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};cr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};cr.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=t.x.redAdd(t.z),o=t.x.redSub(t.z),a=o.redMul(n),c=s.redMul(i),u=r.z.redMul(a.redAdd(c).redSqr()),d=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,d)};cr.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};cr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};cr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};cr.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};cr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};cr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var dg=H((yC,fg)=>{w();S();var l6=bn(),zi=Zr(),ug=Id(),xu=ic(),h6=l6.assert;function mi(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,xu.call(this,"edwards",e),this.a=new zi(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new zi(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new zi(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),h6(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}ug(mi,xu);fg.exports=mi;mi.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};mi.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};mi.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};mi.prototype.pointFromX=function(t,r){t=new zi(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(t,a)};mi.prototype.pointFromY=function(t,r){t=new zi(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,t)};mi.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function ke(e,t,r,n,i){xu.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new zi(t,16),this.y=new zi(r,16),this.z=n?new zi(n,16):this.curve.one,this.t=i&&new zi(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}ug(ke,xu.BasePoint);mi.prototype.pointFromJSON=function(t){return ke.fromJSON(this,t)};mi.prototype.point=function(t,r,n,i){return new ke(this,t,r,n,i)};ke.fromJSON=function(t,r){return new ke(t,r[0],r[1],r[2])};ke.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ke.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};ke.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),o=i.redAdd(r),a=o.redSub(n),c=i.redSub(r),u=s.redMul(a),d=o.redMul(c),f=s.redMul(c),b=a.redMul(o);return this.curve.point(u,d,b,f)};ke.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(r);var d=a.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(d.redSub(this.curve.two)),s=d.redMul(a.redSub(n)),o=d.redSqr().redSub(d).redSub(d)):(c=this.z.redSqr(),u=d.redSub(c).redISub(c),i=t.redSub(r).redISub(n).redMul(u),s=d.redMul(a.redSub(n)),o=d.redMul(u))}else a=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),i=this.curve._mulC(t.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(n)),o=a.redMul(u);return this.curve.point(i,s,o)};ke.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};ke.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),o=n.redSub(r),a=s.redSub(i),c=s.redAdd(i),u=n.redAdd(r),d=o.redMul(a),f=c.redMul(u),b=o.redMul(u),m=a.redMul(c);return this.curve.point(d,f,m,b)};ke.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),s=this.y.redMul(t.y),o=this.curve.d.redMul(i).redMul(s),a=n.redSub(o),c=n.redAdd(o),u=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),d=r.redMul(a).redMul(u),f,b;return this.curve.twisted?(f=r.redMul(c).redMul(s.redSub(this.curve._mulA(i))),b=a.redMul(c)):(f=r.redMul(c).redMul(s.redSub(i)),b=this.curve._mulC(a).redMul(c)),this.curve.point(d,f,b)};ke.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};ke.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};ke.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};ke.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};ke.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};ke.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};ke.prototype.getX=function(){return this.normalize(),this.x.fromRed()};ke.prototype.getY=function(){return this.normalize(),this.y.fromRed()};ke.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};ke.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};ke.prototype.toP=ke.prototype.normalize;ke.prototype.mixedAdd=ke.prototype.add});var ll=H(lg=>{w();S();var Pu=lg;Pu.base=ic();Pu.short=sg();Pu.mont=cg();Pu.edwards=dg()});var pg=H((xC,hg)=>{w();S();hg.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Tu=H(yg=>{w();S();var pl=yg,xs=V0(),hl=ll(),p6=bn(),bg=p6.assert;function gg(e){e.type==="short"?this.curve=new hl.short(e):e.type==="edwards"?this.curve=new hl.edwards(e):this.curve=new hl.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,bg(this.g.validate(),"Invalid curve"),bg(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}pl.PresetCurve=gg;function Ps(e,t){Object.defineProperty(pl,e,{configurable:!0,enumerable:!0,get:function(){var r=new gg(t);return Object.defineProperty(pl,e,{configurable:!0,enumerable:!0,value:r}),r}})}Ps("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:xs.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Ps("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:xs.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Ps("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:xs.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Ps("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:xs.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Ps("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:xs.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Ps("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:xs.sha256,gRed:!1,g:["9"]});Ps("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:xs.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var bl;try{bl=pg()}catch{bl=void 0}Ps("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:xs.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",bl]})});var _g=H((OC,mg)=>{w();S();var b6=Zr(),g6=bn(),gl=g6.assert;function Br(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}mg.exports=Br;Br.fromPublic=function(t,r,n){return r instanceof Br?r:new Br(t,{pub:r,pubEnc:n})};Br.fromPrivate=function(t,r,n){return r instanceof Br?r:new Br(t,{priv:r,privEnc:n})};Br.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Br.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};Br.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};Br.prototype._importPrivate=function(t,r){this.priv=new b6(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};Br.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?gl(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&gl(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};Br.prototype.derive=function(t){return t.validate()||gl(t.validate(),"public point not validated"),t.mul(this.priv).getX()};Br.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};Br.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};Br.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var Sg=H((CC,wg)=>{w();S();var Eu=Zr(),_l=bn(),y6=_l.assert;function sc(e,t,r){if(t instanceof sc)return t;this._importDER(t,r)||(y6(t.r&&t.s,"Signature without r or s"),this.r=new Eu(t.r,16),this.s=new Eu(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam,this.curve=e,this.byteLength=this.curve.n.byteLength())}wg.exports=sc;function m6(){this.place=0}function yl(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,o=t.place;s<n;s++,o++)i<<=8,i|=e[o],i>>>=0;return i<=127?!1:(t.place=o,i)}function vg(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}sc.prototype._importDER=function(t,r){t=_l.toArray(t,r);var n=new m6;if(t[n.place++]!==48)return!1;var i=yl(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var s=yl(t,n);if(s===!1)return!1;var o=t.slice(n.place,s+n.place);if(n.place+=s,t[n.place++]!==2)return!1;var a=yl(t,n);if(a===!1||t.length!==a+n.place)return!1;var c=t.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Eu(o),this.s=new Eu(c),this.recoveryParam=null,!0};function ml(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}sc.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=vg(r),n=vg(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];ml(i,r.length),i=i.concat(r),i.push(2),ml(i,n.length);var s=i.concat(n),o=[48];return ml(o,s.length),o=o.concat(s),_l.encode(o,t)};sc.prototype.toBytes=function(){let t=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return t.concat(r)}});var Tg=H((NC,Pg)=>{w();S();var Xi=Zr(),xg=rw(),_6=bn(),vl=Tu(),v6=nw(),so=_6.assert,wl=_g(),Au=Sg();function xn(e){if(!(this instanceof xn))return new xn(e);typeof e=="string"&&(so(Object.prototype.hasOwnProperty.call(vl,e),"Unknown curve "+e),e=vl[e]),e instanceof vl.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}Pg.exports=xn;xn.prototype.keyPair=function(t){return new wl(this,t)};xn.prototype.keyFromPrivate=function(t,r){return wl.fromPrivate(this,t,r)};xn.prototype.keyFromPublic=function(t,r){return wl.fromPublic(this,t,r)};xn.prototype.genKeyPair=function(t){t||(t={});for(var r=new xg({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||v6(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Xi(2));;){var s=new Xi(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};xn.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};xn.prototype.sign=function(t,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof t!="string"&&typeof t!="number"&&!Xi.isBN(t)){so(typeof t=="object"&&t&&typeof t.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),so(t.length>>>0===t.length);for(var s=0;s<t.length;s++)so((t[s]&255)===t[s])}r=this.keyFromPrivate(r,n),t=this._truncateToN(new Xi(t,16)),so(!t.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=r.getPrivate().toArray("be",o),c=t.toArray("be",o);so(new Xi(c).eq(t),"Can not sign message");for(var u=new xg({hash:this.hash,entropy:a,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),d=this.n.sub(new Xi(1)),f=0;;f++){var b=i.k?i.k(f):new Xi(u.generate(this.n.byteLength()));if(b=this._truncateToN(b,!0),!(b.cmpn(1)<=0||b.cmp(d)>=0)){var m=this.g.mul(b);if(!m.isInfinity()){var y=m.getX(),_=y.umod(this.n);if(_.cmpn(0)!==0){var E=b.invm(this.n).mul(_.mul(r.getPrivate()).iadd(t));if(E=E.umod(this.n),E.cmpn(0)!==0){var I=(m.getY().isOdd()?1:0)|(y.cmp(_)!==0?2:0);return i.canonical&&E.cmp(this.nh)>0&&(E=this.n.sub(E),I^=1),new Au(this.curve,{r:_,s:E,recoveryParam:I})}}}}}};xn.prototype.verify=function(t,r,n,i){t=this._truncateToN(new Xi(t,16)),n=this.keyFromPublic(n,i),r=new Au(this.curve,r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(t).umod(this.n),u=a.mul(s).umod(this.n),d;return this.curve._maxwellTrick?(d=this.g.jmulAdd(c,n.getPublic(),u),d.isInfinity()?!1:d.eqXToP(s)):(d=this.g.mulAdd(c,n.getPublic(),u),d.isInfinity()?!1:d.getX().umod(this.n).cmp(s)===0)};xn.prototype.recoverPubKey=function(e,t,r,n){so((3&r)===r,"The recovery param is more than two bits"),t=new Au(this.curve,t,n);var i=this.n,s=new Xi(e),o=t.r,a=t.s,c=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var d=t.r.invm(i),f=i.sub(s).mul(d).umod(i),b=a.mul(d).umod(i);return this.g.mulAdd(f,o,b)};xn.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new Au(this.curve,t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var Og=H((qC,Ig)=>{w();S();var oc=bn(),Ag=oc.assert,Eg=oc.parseBytes,na=oc.cachedProperty;function ur(e,t){this.eddsa=e,this._secret=Eg(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=Eg(t.pub)}ur.fromPublic=function(t,r){return r instanceof ur?r:new ur(t,{pub:r})};ur.fromSecret=function(t,r){return r instanceof ur?r:new ur(t,{secret:r})};ur.prototype.secret=function(){return this._secret};na(ur,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});na(ur,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});na(ur,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});na(ur,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});na(ur,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});na(ur,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});ur.prototype.sign=function(t){return Ag(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};ur.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};ur.prototype.getSecret=function(t){return Ag(this._secret,"KeyPair is public only"),oc.encode(this.secret(),t)};ur.prototype.getPublic=function(t){return oc.encode(this.pubBytes(),t)};Ig.exports=ur});var Mg=H((DC,Bg)=>{w();S();var w6=Zr(),Iu=bn(),S6=Iu.assert,Ou=Iu.cachedProperty,x6=Iu.parseBytes;function oo(e,t){this.eddsa=e,typeof t!="object"&&(t=x6(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),S6(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof w6&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Ou(oo,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Ou(oo,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Ou(oo,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Ou(oo,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});oo.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};oo.prototype.toHex=function(){return Iu.encode(this.toBytes(),"hex").toUpperCase()};Bg.exports=oo});var Rg=H((GC,Ng)=>{w();S();var P6=V0(),T6=Tu(),ia=bn(),E6=ia.assert,kg=ia.parseBytes,Hg=Og(),Cg=Mg();function Jr(e){if(E6(e==="ed25519","only tested with ed25519 so far"),!(this instanceof Jr))return new Jr(e);e=T6[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=P6.sha512}Ng.exports=Jr;Jr.prototype.sign=function(t,r){t=kg(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),s=this.g.mul(i),o=this.encodePoint(s),a=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),c=i.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Jr.prototype.verify=function(t,r,n){t=kg(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),t),o=this.g.mul(r.S()),a=r.R().add(i.pub().mul(s));return a.eq(o)};Jr.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return ia.intFromLE(t.digest()).umod(this.curve.n)};Jr.prototype.keyFromPublic=function(t){return Hg.fromPublic(this,t)};Jr.prototype.keyFromSecret=function(t){return Hg.fromSecret(this,t)};Jr.prototype.makeSignature=function(t){return t instanceof Cg?t:new Cg(this,t)};Jr.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};Jr.prototype.decodePoint=function(t){t=ia.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&-129),i=(t[r]&128)!==0,s=ia.intFromLE(n);return this.curve.pointFromY(s,i)};Jr.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};Jr.prototype.decodeInt=function(t){return ia.intFromLE(t)};Jr.prototype.isPoint=function(t){return t instanceof this.pointClass}});var sa=H(Pn=>{w();S();Object.defineProperty(Pn,"__esModule",{value:!0});Pn.utils=Pn.curves=Pn.curve=Pn.eddsa=Pn.ec=void 0;var A6=ll();Pn.curve=A6;var I6=Tu();Pn.curves=I6;var O6=Tg();Pn.ec=O6;var B6=Rg();Pn.eddsa=B6;var M6=bn();Pn.utils=M6});var Lg=H((Ug,qg)=>{w();S();Object.defineProperty(Ug,"__esModule",{value:!0});var C6=sa(),_i=new C6.ec("secp256k1"),be=_i.curve,He=Zr();function k6(e,t){let r=new He(t);if(r.cmp(be.p)>=0)return null;r=r.toRed(be.red);let n=r.redSqr().redIMul(r).redIAdd(be.b).redSqrt();e===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(be.b)).isZero()?_i.keyPair({pub:{x:r,y:n}}):null}function H6(e,t,r){let n=new He(t),i=new He(r);if(n.cmp(be.p)>=0||i.cmp(be.p)>=0||(n=n.toRed(be.red),i=i.toRed(be.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(be.b)).isZero()?_i.keyPair({pub:{x:n,y:i}}):null}function Ts(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:k6(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:H6(t,e.subarray(1,33),e.subarray(33,65));default:return null}}qg.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new He(e);return t.cmp(be.n)<0&&!t.isZero()},privateKeyNegate(e){let t=new He(e);return p.Buffer.from(be.n.sub(t).umod(be.n).toArray("be",32))},privateKeyTweakAdd(e,t){let r=new He(t);return r.cmp(be.n)>=0||(r.iadd(new He(e)),r.cmp(be.n)>=0&&r.isub(be.n),r.isZero())?null:p.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(e,t){let r=new He(t);return r.cmp(be.n)>=0||r.isZero()?1:(r.imul(new He(e)),r.cmp(be.n)>=0&&(r=r.umod(be.n)),p.Buffer.from(r.toArray("be",32)))},publicKeyVerify(e){let t=Ts(e);return t==null?null:t.validate().result},publicKeyCreate(e,t){let r=new He(e);if(r.cmp(be.n)>=0||r.isZero())return null;let n=_i.keyFromPrivate(e,null).getPublic();return p.Buffer.from(n.encode(null,t))},publicKeyConvert(e,t){let n=Ts(e).getPublic();return p.Buffer.from(n.encode(null,t))},publicKeyNegate(e,t){let r=Ts(e);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),p.Buffer.from(n.encode(null,t))},publicKeyCombine(e,t){let r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=Ts(e[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:p.Buffer.from(n.encode(null,t))},publicKeyTweakAdd(e,t,r){let n=Ts(e);if(n===null||new He(t).cmp(be.n)>=0)return null;let s=n.getPublic().add(be.g.mul(t));return s.isInfinity()?null:p.Buffer.from(s.encode(null,r))},publicKeyTweakMul(e,t,r){let n=Ts(e);if(n===null)return null;let i=new He(t);if(i.cmp(be.n)>=0||i.isZero())return null;let s=n.getPublic().mul(t);return p.Buffer.from(s.encode(null,r))},signatureNormalize(e){let t=new He(e.subarray(0,32)),r=new He(e.subarray(32,64));return t.cmp(be.n)>=0||r.cmp(be.n)>=0?null:(r.cmp(_i.nh)===1&&e.set(be.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new He(r).cmp(be.n)>=0||new He(n).cmp(be.n)>=0)return 1;let{output:i}=e,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=i.subarray(6+33,6+33+33);c[0]=0,c.set(n,1);let u=33,d=0;for(;u>1&&c[d]===0&&!(c[d+1]&128);--u,++d);return c=c.subarray(d),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(e.outputlen=6+o+u,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+o]=2,i[5+o]=c.length,i.set(c,6+o),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let i=t.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new He(i);o.cmp(be.n)>=0&&(o=new He(0));let a=new He(t.subarray(6+r));return a.cmp(be.n)>=0&&(a=new He(0)),e.set(o.toArrayLike(Uint8Array,"be",32),0),e.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t){let r=new He(t);return r.cmp(be.n)>=0||r.isZero()?null:_i.sign(e,t,{canonical:!0}).toBytes()},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},i=new He(n.r),s=new He(n.s);if(i.cmp(be.n)>=0||s.cmp(be.n)>=0)return 1;if(s.cmp(_i.nh)===1||i.isZero()||s.isZero())return 3;let o=Ts(r);if(o===null)return 2;let a=o.getPublic();return _i.verify(t,n,a)},ecdsaRecover(e,t,r,n){let i={r:e.slice(0,32),s:e.slice(32,64)},s=new He(i.r),o=new He(i.s);if(s.cmp(be.n)>=0||o.cmp(be.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=_i.recoverPubKey(r,i,t,null)}catch{return 2}return p.Buffer.from(a.encode(null,n))},ecdh(e,t,r,n,i,s,o){let a=Ts(t);if(a===null)return 1;let c=new He(r);if(c.cmp(be.n)>=0||c.isZero())return 2;let u=a.getPublic().mul(c);if(i===void 0){let d=u.encode(null,!0),f=_i.hash().update(d).digest();for(let b=0;b<32;++b)e[b]=f[b]}else{s||(s=new Uint8Array(32));let d=u.getX().toArray("be",32);for(let y=0;y<32;++y)s[y]=d[y];o||(o=new Uint8Array(32));let f=u.getY().toArray("be",32);for(let y=0;y<32;++y)o[y]=f[y];let b=i(s,o,n);if(!(b instanceof Uint8Array&&b.length===e.length))return 2;e.set(b)}return 0}}});var Gg=H(fr=>{w();S();var N6=fr&&fr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),R6=fr&&fr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),U6=fr&&fr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&N6(t,e,r);return R6(t,e),t};Object.defineProperty(fr,"__esModule",{value:!0});fr.fromSeed=fr.fromPublicKey=fr.fromPrivateKey=fr.fromBase58=fr.tinySecp256k1Interface=void 0;var Sl=U6(rc()),q6=Od(),L6=lu(),Dg=(0,q6.base58check)(L6.sha256),jg=Lg(),Pr=iw(),K6=sw();function D6(e){return{isPoint:t=>e.publicKeyVerify(t),isPrivate:t=>e.privateKeyVerify(t),pointAddScalar:(t,r,n)=>e.publicKeyTweakAdd(t,r,n),pointFromScalar:(t,r)=>e.publicKeyCreate(t,r),privateAdd:(t,r)=>e.privateKeyTweakAdd(new Uint8Array(t),r),sign:(t,r)=>e.ecdsaSign(t,r),verify:(t,r,n)=>e.ecdsaVerify(n,t,r)}}function j6(e){return{isPoint:t=>e.publicKeyVerify(t),pointCompress:(t,r)=>Uint8Array.from(e.publicKeyConvert(t,r??!0)),isPrivate:t=>e.privateKeyVerify(t),pointFromScalar:(t,r)=>{let n=e.publicKeyCreate(t,r??!0);return n==null?null:Uint8Array.from(n)},sign:(t,r,n)=>Uint8Array.from(e.ecdsaSign(t,r)),verify:(t,r,n,i)=>e.ecdsaVerify(n,t,r)}}var Es=D6(jg);fr.tinySecp256k1Interface=j6(jg);var xl=Pr.BufferN(32),F6=Pr.compile({wif:Pr.UInt8,bip32:{public:Pr.UInt32,private:Pr.UInt32}}),Cu={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},Kg=2147483648,G6=Math.pow(2,31)-1;function V6(e){return Pr.String(e)&&e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function W6(e){return Pr.UInt32(e)&&e<=G6}var Bu=class{constructor(t,r,n,i,s=0,o=0,a=0){this.__D=t,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=o,this.__PARENT_FINGERPRINT=a,Pr(F6,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=p.Buffer.from(Es.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return p.Buffer.from(Sl.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return Mu(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=p.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),Dg.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return K6.encode(this.network.wif,this.privateKey,!0)}derive(t){Pr(Pr.UInt32,t);let r=t>=Kg,n=p.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(t,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(t,33);let i=Sl.hmacSHA512(this.chainCode,n),s=i.slice(0,32),o=i.slice(32);if(!Es.isPrivate(s))return this.derive(t+1);let a;if(this.isNeutered()){let c=Es.pointAddScalar(this.publicKey,s,!0);if(c===null)return this.derive(t+1);a=Mu(c,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{let c=Es.privateAdd(this.privateKey,s);if(c==null)return this.derive(t+1);a=Pl(c,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return a}deriveHardened(t){return Pr(W6,t),this.derive(t+Kg)}derivePath(t){Pr(V6,t);let r=t.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(t){if(!this.privateKey)throw new Error("Missing private key");return Es.sign(t,this.privateKey)}verify(t,r){return Es.verify(t,this.publicKey,r)}};function z6(e,t){let r=p.Buffer.from(Dg.decode(e));if(r.length!==78)throw new TypeError("Invalid buffer length");t=t||Cu;let n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let o=r.readUInt32BE(9);if(i===0&&o!==0)throw new TypeError("Invalid index");let a=r.slice(13,45),c;if(n===t.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let u=r.slice(46,78);c=Pl(u,a,t,i,o,s)}else{let u=r.slice(45,78);c=Mu(u,a,t,i,o,s)}return c}fr.fromBase58=z6;function Fg(e,t,r){return Pl(e,t,r)}fr.fromPrivateKey=Fg;function Pl(e,t,r,n,i,s){if(Pr({privateKey:xl,chainCode:xl},{privateKey:e,chainCode:t}),r=r||Cu,!Es.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new Bu(e,void 0,t,r,n,i,s)}function X6(e,t,r){return Mu(e,t,r)}fr.fromPublicKey=X6;function Mu(e,t,r,n,i,s){if(Pr({publicKey:Pr.BufferN(33),chainCode:xl},{publicKey:e,chainCode:t}),r=r||Cu,!Es.isPoint(e))throw new TypeError("Point is not on the curve");return new Bu(void 0,e,t,r,n,i,s)}function Y6(e,t){if(Pr(Pr.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||Cu;let r=Sl.hmacSHA512(p.Buffer.from("Bitcoin seed","utf8"),e),n=r.slice(0,32),i=r.slice(32);return Fg(n,i,t)}fr.fromSeed=Y6});var Vg=H(ku=>{w();S();Object.defineProperty(ku,"__esModule",{value:!0});ku.fromSeedV2=void 0;var $6=ow();function Z6(e,t){return $6.HDKey.fromMasterSeed(new Uint8Array([...e])).derive(t)}ku.fromSeedV2=Z6});var Wg=H(Qr=>{w();S();Object.defineProperty(Qr,"__esModule",{value:!0});Qr.fromSeedV2=Qr.fromPrivateKey=Qr.fromPublicKey=Qr.fromBase58=Qr.fromSeed=Qr.tinySecp256k1Interface=void 0;var ac=Gg();Object.defineProperty(Qr,"tinySecp256k1Interface",{enumerable:!0,get:function(){return ac.tinySecp256k1Interface}});Object.defineProperty(Qr,"fromSeed",{enumerable:!0,get:function(){return ac.fromSeed}});Object.defineProperty(Qr,"fromBase58",{enumerable:!0,get:function(){return ac.fromBase58}});Object.defineProperty(Qr,"fromPublicKey",{enumerable:!0,get:function(){return ac.fromPublicKey}});Object.defineProperty(Qr,"fromPrivateKey",{enumerable:!0,get:function(){return ac.fromPrivateKey}});var J6=Vg();Object.defineProperty(Qr,"fromSeedV2",{enumerable:!0,get:function(){return J6.fromSeedV2}})});var zg=H((ak,Q6)=>{Q6.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var El=H(ao=>{w();S();Object.defineProperty(ao,"__esModule",{value:!0});ao._default=ao.wordlists=void 0;var Tl={};ao.wordlists=Tl;var Hu;ao._default=Hu;try{ao._default=Hu=zg(),Tl.english=Hu,Tl.EN=Hu}catch{}});var Al=H(ot=>{w();S();Object.defineProperty(ot,"__esModule",{value:!0});ot.wordlists=ot.getDefaultWordlist=ot.setDefaultWordlist=ot.validateMnemonic=ot.generateMnemonic=ot.entropyToMnemonic=ot.mnemonicToEntropy=ot.mnemonicToSeedV2=ot.mnemonicToSeed=ot.mnemonicToSeedSync=void 0;var Yg=rc(),$g=yu(),Nu=El(),Zg=Ya(),e4=aw(),oa=Nu._default,Xg="Invalid mnemonic",co="Invalid entropy",t4="Invalid mnemonic checksum",Jg=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function r4(e,t,r,n,i){let s=(0,$g.pbkdf2)(Zg.sha512,e,t,{c:r,dkLen:n});return Promise.resolve(p.Buffer.from(s))}function cc(e){return(e||"").normalize("NFKD")}function Qg(e,t,r){for(;e.length<r;)e=t+e;return e}function ey(e){return parseInt(e,2)}function ty(e){return e.map(t=>Qg(t.toString(2),"0",8)).join("")}function ry(e){let r=e.length*8/32,n=(0,Yg.sha256)(e);return ty(Array.from(n)).slice(0,r)}function ny(e){return"mnemonic"+(e||"")}function n4(e,t){let r=p.Buffer.from(cc(e),"utf8"),n=p.Buffer.from(ny(cc(t)),"utf8"),i=(0,$g.pbkdf2)(Zg.sha512,r,n,{c:2048,dkLen:64});return p.Buffer.from(i)}ot.mnemonicToSeedSync=n4;function i4(e,t){return Promise.resolve().then(()=>{let r=p.Buffer.from(cc(e),"utf8"),n=p.Buffer.from(ny(cc(t)),"utf8");return r4(r,n,2048,64,"sha512")})}ot.mnemonicToSeed=i4;async function s4(e,t){let r=e.split(" ").map(s=>oa.indexOf(s)),n=new Uint8Array(new Uint16Array(r).buffer),i=await(0,e4.mnemonicToSeed)(n,t);return p.Buffer.from(i)}ot.mnemonicToSeedV2=s4;function iy(e,t){if(t=t||oa,!t)throw new Error(Jg);let r=cc(e).split(" ");if(r.length%3!==0)throw new Error(Xg);let n=r.map(d=>{let f=t.indexOf(d);if(f===-1)throw new Error(Xg);return Qg(f.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),o=n.slice(i),a=s.match(/(.{1,8})/g).map(ey);if(a.length<16)throw new Error(co);if(a.length>32)throw new Error(co);if(a.length%4!==0)throw new Error(co);let c=p.Buffer.from(a);if(ry(c)!==o)throw new Error(t4);return c.toString("hex")}ot.mnemonicToEntropy=iy;function sy(e,t){if(p.Buffer.isBuffer(e)||(e=p.Buffer.from(e,"hex")),t=t||oa,!t)throw new Error(Jg);if(e.length<16)throw new TypeError(co);if(e.length>32)throw new TypeError(co);if(e.length%4!==0)throw new TypeError(co);let r=ty(Array.from(e)),n=ry(e),o=(r+n).match(/(.{1,11})/g).map(a=>{let c=ey(a);return t[c]});return t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?o.join("\u3000"):o.join(" ")}ot.entropyToMnemonic=sy;function o4(e,t,r){if(e=e||128,e%32!==0)throw new TypeError(co);return t=t||Yg.randomBytes,sy(t(e/8),r)}ot.generateMnemonic=o4;function a4(e,t){try{iy(e,t)}catch{return!1}return!0}ot.validateMnemonic=a4;function c4(e){let t=Nu.wordlists[e];if(t)oa=t;else throw new Error('Could not find wordlist for language "'+e+'"')}ot.setDefaultWordlist=c4;function u4(){if(!oa)throw new Error("No Default Wordlist set");return Object.keys(Nu.wordlists).filter(e=>e==="JA"||e==="EN"?!1:Nu.wordlists[e].every((t,r)=>t===oa[r]))[0]}ot.getDefaultWordlist=u4;var f4=El();Object.defineProperty(ot,"wordlists",{enumerable:!0,get:function(){return f4.wordlists}})});var dy=H(ye=>{w();S();var d4=ye&&ye.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),l4=ye&&ye.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),h4=ye&&ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&d4(t,e,r);return l4(t,e),t},p4=ye&&ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ye,"__esModule",{value:!0});ye.loadUncompressedPublicKey=ye.loadCompressedPublicKey=ye.publicKeyConvert=ye.publicKeyCreate=ye.publicKeyVerify=ye.privateKeyVerify=ye.loadPublicKey=ye.recover=ye.verifyWithNoRecovery=ye.verify=ye.getV=ye.sign=void 0;var b4=h4(sa()),tr=new b4.ec("secp256k1"),oy=rc(),aa=p4(Zr());function g4(e,t,r=!0){let n=tr.sign(Array.from(e),p.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}ye.sign=g4;function y4(e,t,r,n,i=!0){let s=uc(n);if(s==null)throw new Error("pubkey error");let o=tr.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return tr.getKeyRecoveryParam(e,{r:t,s:r},o,i)}ye.getV=y4;function m4(e,t,r,n){let i=ay(t,r,e,!0);if(i==null)return!1;let s=cy(n,!0);return s==null?!1:i.equals(s)}ye.verify=m4;function _4(e,t,r){let n=uc(r);if(n==null)throw new Error("pubkey error");let i=tr.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,oy.toHex)(t.slice(0,32)),s:(0,oy.toHex)(t.slice(32,64))};return i.verify(e,s)}ye.verifyWithNoRecovery=_4;function ay(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new aa.default(i.r),o=new aa.default(i.s);if(s.cmp(tr.curve.n)>=0||o.cmp(tr.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=tr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return p.Buffer.from(a.encode(null,n))}ye.recover=ay;function uc(e){let t=p.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:uy(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:fy(r,t.subarray(1,33),t.subarray(33,65));default:return null}}ye.loadPublicKey=uc;function v4(e){let t=new aa.default(Array.from(e));return t.cmp(tr.curve.n)<0&&!t.isZero()}ye.privateKeyVerify=v4;function w4(e){return uc(e)!==null}ye.publicKeyVerify=w4;function S4(e,t){let r=tr.keyFromPrivate(Array.from(e),"bytes").getPublic();return p.Buffer.from(r.encode(null,t))}ye.publicKeyCreate=S4;function cy(e,t){let r=uc(e);if(r==null)return null;let n=tr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return p.Buffer.from(n.encode(null,t))}ye.publicKeyConvert=cy;function uy(e,t){let r=new aa.default(Array.from(t));if(r.cmp(tr.curve.p)>=0)return null;let n=r.toRed(tr.curve.red),i=n.redSqr().redIMul(n).redIAdd(tr.curve.b).redSqrt();e===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(tr.curve.b)).isZero()?{x:n,y:i}:null}ye.loadCompressedPublicKey=uy;function fy(e,t,r){let n=new aa.default(Array.from(t)),i=new aa.default(Array.from(r));if(n.cmp(tr.curve.p)>=0||i.cmp(tr.curve.p)>=0)return null;let s=n.toRed(tr.curve.red),o=i.toRed(tr.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(tr.curve.b)).isZero()?{x:s,y:o}:null}ye.loadUncompressedPublicKey=fy});var vy=H(ge=>{w();S();var x4=ge&&ge.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),P4=ge&&ge.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ly=ge&&ge.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&x4(t,e,r);return P4(t,e),t},T4=ge&&ge.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ge,"__esModule",{value:!0});ge.ed25519_getDerivedPrivateKey=ge.isValidPath=ge.ed25519_getRandomPrivateKey=ge.ed25519SignTest=ge.fromSecret=ge.fromSeed=ge.privateKeyVerify=ge.publicKeyVerify=ge.publicKeyCreate=ge.verify=ge.sign=ge.ed25519MulBase=void 0;var hy=ly(sa()),Jn=rc(),E4=T4(Zr()),A4=Al(),Il=ly(z0()),I4=Ya();Il.utils.sha512Sync=(...e)=>(0,I4.sha512)(Il.utils.concatBytes(...e));var As=new hy.eddsa("ed25519"),py=As.curve;function O4(e){let t=As.curve.g;return As.encodePoint(t.mul(hy.utils.intFromLE(e)))}ge.ed25519MulBase=O4;function by(e,t){let r=t;r.length==64&&(r=r.slice(0,32));let n=Il.sync.sign(e,r);return Uint8Array.from(n)}ge.sign=by;function gy(e,t,r){return As.keyFromPublic(Array.from(r)).verify(Array.from(e),Array.from(t))}ge.verify=gy;function Ru(e){let t=e;t.length==64&&(t=t.slice(0,32));let n=As.keyFromSecret(Array.from(t)).getPublic();if(e.length==64&&!B4(e.slice(32,64),n))throw new Error("invalid public key");return Uint8Array.from(n)}ge.publicKeyCreate=Ru;function B4(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function M4(e){let t=As.decodePoint(Array.from(e));return py.validate(t)}ge.publicKeyVerify=M4;function yy(e){let t=new E4.default(Array.from(e));return t.cmp(py.n)<0&&!t.isZero()}ge.privateKeyVerify=yy;function C4(e){let t=As.keyFromSecret(Array.from(e)),r=Uint8Array.from(t.getPublic());return{publicKey:r,secretKey:(0,Jn.concatBytes)(e,r)}}ge.fromSeed=C4;function k4(e){let t=e.slice(0,32),r=As.keyFromSecret(Array.from(t));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(t)}}ge.fromSecret=k4;function my(e){let t=(0,Jn.sha256)("ed25519-test"),r=Ru(e),n=by(t,e);return gy(t,n,r)}ge.ed25519SignTest=my;function H4(e,t){for(;;){let r=(0,Jn.randomBytes)(32);if(yy(r)&&my(r)){let n=Ru(r),i=e?(0,Jn.concatBytes)(r,n):r;return t==="base58"?(0,Jn.toBase58)(i):(0,Jn.toHex)(i)}}}ge.ed25519_getRandomPrivateKey=H4;var N4=new RegExp("^m(\\/[0-9]+')+$"),_y=e=>e.replace("'",""),R4=2147483648;function U4(e){let t=(0,Jn.hmacSHA512)("ed25519 seed",e),r=t.slice(0,32),n=t.slice(32);return{key:r,chainCode:n}}function q4({key:e,chainCode:t},r){let n=p.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=p.Buffer.concat([p.Buffer.alloc(1,0),e,n]),s=(0,Jn.hmacSHA512)(t,i),o=s.slice(0,32),a=s.slice(32);return{key:o,chainCode:a}}var L4=e=>N4.test(e)?!e.split("/").slice(1).map(_y).some(isNaN):!1;ge.isValidPath=L4;function K4(e,t,r=R4){if(!(0,ge.isValidPath)(e))throw new Error("Invalid derivation path");let{key:n,chainCode:i}=U4(t);return e.split("/").slice(1).map(_y).map(o=>parseInt(o,10)).reduce((o,a)=>q4(o,a+r),{key:n,chainCode:i})}async function D4(e,t,r,n){let i=await(0,A4.mnemonicToSeedV2)(e),s=K4(t,i).key,o=Ru(s),a=r?(0,Jn.concatBytes)(s,o):s;return n==="base58"?Promise.resolve((0,Jn.toBase58)(a)):Promise.resolve((0,Jn.toHex)(a))}ge.ed25519_getDerivedPrivateKey=D4});var Py=H(Oe=>{w();S();var j4=Oe&&Oe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),F4=Oe&&Oe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),G4=Oe&&Oe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&j4(t,e,r);return F4(t,e),t},V4=Oe&&Oe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.loadUncompressedPublicKey=Oe.loadCompressedPublicKey=Oe.publicKeyConvert=Oe.publicKeyCreate=Oe.publicKeyVerify=Oe.privateKeyVerify=Oe.loadPublicKey=Oe.recover=Oe.verify=Oe.sign=void 0;var W4=G4(sa()),Fr=new W4.ec("p256"),ca=V4(Zr());function z4(e,t,r=!0){let n=Fr.sign(Array.from(e),p.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}Oe.sign=z4;function X4(e,t,r,n){let i=wy(t,r,e,!1);return i==null?!1:i.equals(n)}Oe.verify=X4;function wy(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new ca.default(i.r),o=new ca.default(i.s);if(s.cmp(Fr.curve.n)>=0||o.cmp(Fr.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=Fr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return p.Buffer.from(a.encode(null,n))}Oe.recover=wy;function Ol(e){let t=p.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:Sy(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:xy(r,t.subarray(1,33),t.subarray(33,65));default:return null}}Oe.loadPublicKey=Ol;function Y4(e){let t=new ca.default(Array.from(e));return t.cmp(Fr.curve.n)<0&&!t.isZero()}Oe.privateKeyVerify=Y4;function $4(e){return Ol(e)!==null}Oe.publicKeyVerify=$4;function Z4(e,t){let r=Fr.keyFromPrivate(Array.from(e),"bytes").getPublic();return p.Buffer.from(r.encode(null,t))}Oe.publicKeyCreate=Z4;function J4(e,t){let r=Ol(e);if(r==null)return null;let n=Fr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return p.Buffer.from(n.encode(null,t))}Oe.publicKeyConvert=J4;function Sy(e,t){let r=new ca.default(Array.from(t));if(r.cmp(Fr.curve.p)>=0)return null;let n=r.toRed(Fr.curve.red),i=n.redSqr().redIMul(n).redIAdd(Fr.curve.b).redSqrt();return e===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}Oe.loadCompressedPublicKey=Sy;function xy(e,t,r){let n=new ca.default(Array.from(t)),i=new ca.default(Array.from(r));if(n.cmp(Fr.curve.p)>=0||i.cmp(Fr.curve.p)>=0)return null;let s=n.toRed(Fr.curve.red),o=i.toRed(Fr.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(Fr.curve.b)).isZero()?{x:s,y:o}:null}Oe.loadUncompressedPublicKey=xy});var Yi=H(oe=>{w();S();Object.defineProperty(oe,"__esModule",{value:!0});oe.validateObject=oe.createHmacDrbg=oe.bitMask=oe.bitSet=oe.bitGet=oe.bitLen=oe.utf8ToBytes=oe.equalBytes=oe.concatBytes=oe.ensureBytes=oe.numberToVarBytesBE=oe.numberToBytesLE=oe.numberToBytesBE=oe.bytesToNumberLE=oe.bytesToNumberBE=oe.hexToBytes=oe.hexToNumber=oe.numberToHexUnpadded=oe.bytesToHex=void 0;var Ey=BigInt(0),Uu=BigInt(1),Q4=BigInt(2),qu=e=>e instanceof Uint8Array,e8=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ml(e){if(!qu(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=e8[e[r]];return t}oe.bytesToHex=Ml;function Ay(e){let t=e.toString(16);return t.length&1?`0${t}`:t}oe.numberToHexUnpadded=Ay;function Cl(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}oe.hexToNumber=Cl;function Lu(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");t[r]=s}return t}oe.hexToBytes=Lu;function t8(e){return Cl(Ml(e))}oe.bytesToNumberBE=t8;function r8(e){if(!qu(e))throw new Error("Uint8Array expected");return Cl(Ml(Uint8Array.from(e).reverse()))}oe.bytesToNumberLE=r8;var n8=(e,t)=>Lu(e.toString(16).padStart(t*2,"0"));oe.numberToBytesBE=n8;var i8=(e,t)=>(0,oe.numberToBytesBE)(e,t).reverse();oe.numberToBytesLE=i8;var s8=e=>Lu(Ay(e));oe.numberToVarBytesBE=s8;function o8(e,t,r){let n;if(typeof t=="string")try{n=Lu(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(qu(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}oe.ensureBytes=o8;function Iy(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!qu(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}oe.concatBytes=Iy;function a8(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}oe.equalBytes=a8;function c8(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}oe.utf8ToBytes=c8;function u8(e){let t;for(t=0;e>Ey;e>>=Uu,t+=1);return t}oe.bitLen=u8;var f8=(e,t)=>e>>BigInt(t)&Uu;oe.bitGet=f8;var d8=(e,t,r)=>e|(r?Uu:Ey)<<BigInt(t);oe.bitSet=d8;var l8=e=>(Q4<<BigInt(e-1))-Uu;oe.bitMask=l8;var Bl=e=>new Uint8Array(e),Ty=e=>Uint8Array.from(e);function h8(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Bl(e),i=Bl(e),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...f)=>r(i,n,...f),c=(f=Bl())=>{i=a(Ty([0]),f),n=a(),f.length!==0&&(i=a(Ty([1]),f),n=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,b=[];for(;f<t;){n=a();let m=n.slice();b.push(m),f+=n.length}return Iy(...b)};return(f,b)=>{o(),c(f);let m;for(;!(m=b(u()));)c();return o(),m}}oe.createHmacDrbg=h8;var p8={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function b8(e,t,r={}){let n=(i,s,o)=>{let a=p8[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=e[i];if(!(o&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}oe.validateObject=b8});var uo=H(pe=>{w();S();Object.defineProperty(pe,"__esModule",{value:!0});pe.hashToPrivateScalar=pe.FpSqrtEven=pe.FpSqrtOdd=pe.Field=pe.nLength=pe.FpIsSquare=pe.FpDiv=pe.FpInvertBatch=pe.FpPow=pe.validateField=pe.isNegativeLE=pe.FpSqrt=pe.tonelliShanks=pe.invert=pe.pow2=pe.pow=pe.mod=void 0;var $i=Yi(),rr=BigInt(0),Ge=BigInt(1),Is=BigInt(2),g8=BigInt(3),kl=BigInt(4),Oy=BigInt(5),By=BigInt(8),y8=BigInt(9),m8=BigInt(16);function Tn(e,t){let r=e%t;return r>=rr?r:t+r}pe.mod=Tn;function My(e,t,r){if(r<=rr||t<rr)throw new Error("Expected power/modulo > 0");if(r===Ge)return rr;let n=Ge;for(;t>rr;)t&Ge&&(n=n*e%r),e=e*e%r,t>>=Ge;return n}pe.pow=My;function _8(e,t,r){let n=e;for(;t-- >rr;)n*=n,n%=r;return n}pe.pow2=_8;function Ku(e,t){if(e===rr||t<=rr)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=Tn(e,t),n=t,i=rr,s=Ge,o=Ge,a=rr;for(;r!==rr;){let u=n/r,d=n%r,f=i-o*u,b=s-a*u;n=r,r=d,i=o,s=a,o=f,a=b}if(n!==Ge)throw new Error("invert: does not exist");return Tn(i,t)}pe.invert=Ku;function Cy(e){let t=(e-Ge)/Is,r,n,i;for(r=e-Ge,n=0;r%Is===rr;r/=Is,n++);for(i=Is;i<e&&My(i,t,e)!==e-Ge;i++);if(n===1){let o=(e+Ge)/kl;return function(c,u){let d=c.pow(u,o);if(!c.eql(c.sqr(d),u))throw new Error("Cannot find square root");return d}}let s=(r+Ge)/Is;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,d=a.pow(a.mul(a.ONE,i),r),f=a.pow(c,s),b=a.pow(c,r);for(;!a.eql(b,a.ONE);){if(a.eql(b,a.ZERO))return a.ZERO;let m=1;for(let _=a.sqr(b);m<u&&!a.eql(_,a.ONE);m++)_=a.sqr(_);let y=a.pow(d,Ge<<BigInt(u-m-1));d=a.sqr(y),f=a.mul(f,y),b=a.mul(b,d),u=m}return f}}pe.tonelliShanks=Cy;function ky(e){if(e%kl===g8){let t=(e+Ge)/kl;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%By===Oy){let t=(e-Oy)/By;return function(n,i){let s=n.mul(i,Is),o=n.pow(s,t),a=n.mul(i,o),c=n.mul(n.mul(a,Is),o),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%m8,Cy(e)}pe.FpSqrt=ky;var v8=(e,t)=>(Tn(e,t)&Ge)===Ge;pe.isNegativeLE=v8;var w8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function S8(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=w8.reduce((n,i)=>(n[i]="function",n),t);return(0,$i.validateObject)(e,r)}pe.validateField=S8;function Hy(e,t,r){if(r<rr)throw new Error("Expected power > 0");if(r===rr)return e.ONE;if(r===Ge)return t;let n=e.ONE,i=t;for(;r>rr;)r&Ge&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Ge;return n}pe.FpPow=Hy;function Ny(e,t){let r=new Array(t.length),n=t.reduce((s,o,a)=>e.is0(o)?s:(r[a]=s,e.mul(s,o)),e.ONE),i=e.inv(n);return t.reduceRight((s,o,a)=>e.is0(o)?s:(r[a]=e.mul(s,r[a]),e.mul(s,o)),i),r}pe.FpInvertBatch=Ny;function x8(e,t,r){return e.mul(t,typeof r=="bigint"?Ku(r,e.ORDER):e.inv(r))}pe.FpDiv=x8;function P8(e){let t=(e.ORDER-Ge)/Is;return r=>{let n=e.pow(r,t);return e.eql(n,e.ZERO)||e.eql(n,e.ONE)}}pe.FpIsSquare=P8;function Hl(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}pe.nLength=Hl;function T8(e,t,r=!1,n={}){if(e<=rr)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=Hl(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=ky(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:(0,$i.bitMask)(i),ZERO:rr,ONE:Ge,create:c=>Tn(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return rr<=c&&c<e},is0:c=>c===rr,isOdd:c=>(c&Ge)===Ge,neg:c=>Tn(-c,e),eql:(c,u)=>c===u,sqr:c=>Tn(c*c,e),add:(c,u)=>Tn(c+u,e),sub:(c,u)=>Tn(c-u,e),mul:(c,u)=>Tn(c*u,e),pow:(c,u)=>Hy(a,c,u),div:(c,u)=>Tn(c*Ku(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Ku(c,e),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>Ny(a,c),cmov:(c,u,d)=>d?u:c,toBytes:c=>r?(0,$i.numberToBytesLE)(c,s):(0,$i.numberToBytesBE)(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?(0,$i.bytesToNumberLE)(c):(0,$i.bytesToNumberBE)(c)}});return Object.freeze(a)}pe.Field=T8;function E8(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}pe.FpSqrtOdd=E8;function A8(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}pe.FpSqrtEven=A8;function I8(e,t,r=!1){e=(0,$i.ensureBytes)("privateHash",e);let n=e.length,i=Hl(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,$i.bytesToNumberLE)(e):(0,$i.bytesToNumberBE)(e);return Tn(s,t-Ge)+Ge}pe.hashToPrivateScalar=I8});var Uy=H(ua=>{w();S();Object.defineProperty(ua,"__esModule",{value:!0});ua.validateBasic=ua.wNAF=void 0;var Ry=uo(),O8=Yi(),B8=BigInt(0),Nl=BigInt(1);function M8(e,t){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(t/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=e.ZERO,a=i;for(;s>B8;)s&Nl&&(o=o.add(a)),a=a.double(),s>>=Nl;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),c=[],u=i,d=u;for(let f=0;f<o;f++){d=u,c.push(d);for(let b=1;b<a;b++)d=d.add(u),c.push(d);u=d.double()}return c},wNAF(i,s,o){let{windows:a,windowSize:c}=n(i),u=e.ZERO,d=e.BASE,f=BigInt(2**i-1),b=2**i,m=BigInt(i);for(let y=0;y<a;y++){let _=y*c,E=Number(o&f);o>>=m,E>c&&(E-=b,o+=Nl);let I=_,k=_+Math.abs(E)-1,C=y%2!==0,R=E<0;E===0?d=d.add(r(C,s[I])):u=u.add(r(R,s[k]))}return{p:u,f:d}},wNAFCached(i,s,o,a){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,a(u))),this.wNAF(c,u,o)}}}ua.wNAF=M8;function C8(e){return(0,Ry.validateField)(e.Fp),(0,O8.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Ry.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}ua.validateBasic=C8});var ju=H(Ve=>{w();S();var k8=Ve&&Ve.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),H8=Ve&&Ve.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ly=Ve&&Ve.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&k8(t,e,r);return H8(t,e),t};Object.defineProperty(Ve,"__esModule",{value:!0});Ve.mapToCurveSimpleSWU=Ve.SWUFpSqrtRatio=Ve.weierstrass=Ve.weierstrassPoints=Ve.DER=void 0;var fc=Ly(uo()),Gt=Ly(Yi()),vi=Yi(),Rl=Uy();function N8(e){let t=(0,Rl.validateBasic)(e);Gt.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:R8,hexToBytes:U8}=Gt;Ve.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=Ve.DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:R8(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=Ve.DER,r=typeof e=="string"?U8(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=Ve.DER._parseInt(r.subarray(2)),{d:o,l:a}=Ve.DER._parseInt(s);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let d=u.toString(16);return d.length&1?`0${d}`:d},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,o=i.length/2,a=r(s),c=r(o);return`30${r(o+s+4)}02${c}${i}02${a}${n}`}};var Qn=BigInt(0),at=BigInt(1),Os=BigInt(2),Du=BigInt(3),qy=BigInt(4);function Ky(e){let t=N8(e),{Fp:r}=t,n=t.toBytes||((y,_,E)=>{let I=_.toAffine();return Gt.concatBytes(Uint8Array.from([4]),r.toBytes(I.x),r.toBytes(I.y))}),i=t.fromBytes||(y=>{let _=y.subarray(1),E=r.fromBytes(_.subarray(0,r.BYTES)),I=r.fromBytes(_.subarray(r.BYTES,2*r.BYTES));return{x:E,y:I}});function s(y){let{a:_,b:E}=t,I=r.sqr(y),k=r.mul(I,y);return r.add(r.add(k,r.mul(y,_)),E)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(y){return typeof y=="bigint"&&Qn<y&&y<t.n}function a(y){if(!o(y))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(y){let{allowedPrivateKeyLengths:_,nByteLength:E,wrapPrivateKey:I,n:k}=t;if(_&&typeof y!="bigint"){if(y instanceof Uint8Array&&(y=Gt.bytesToHex(y)),typeof y!="string"||!_.includes(y.length))throw new Error("Invalid key");y=y.padStart(E*2,"0")}let C;try{C=typeof y=="bigint"?y:Gt.bytesToNumberBE((0,vi.ensureBytes)("private key",y,E))}catch{throw new Error(`private key must be ${E} bytes, hex or bigint, not ${typeof y}`)}return I&&(C=fc.mod(C,k)),a(C),C}let u=new Map;function d(y){if(!(y instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(_,E,I){if(this.px=_,this.py=E,this.pz=I,_==null||!r.isValid(_))throw new Error("x required");if(E==null||!r.isValid(E))throw new Error("y required");if(I==null||!r.isValid(I))throw new Error("z required")}static fromAffine(_){let{x:E,y:I}=_||{};if(!_||!r.isValid(E)||!r.isValid(I))throw new Error("invalid affine point");if(_ instanceof f)throw new Error("projective point not allowed");let k=C=>r.eql(C,r.ZERO);return k(E)&&k(I)?f.ZERO:new f(E,I,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){let E=r.invertBatch(_.map(I=>I.pz));return _.map((I,k)=>I.toAffine(E[k])).map(f.fromAffine)}static fromHex(_){let E=f.fromAffine(i((0,vi.ensureBytes)("pointHex",_)));return E.assertValidity(),E}static fromPrivateKey(_){return f.BASE.multiply(c(_))}_setWindowSize(_){this._WINDOW_SIZE=_,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:_,y:E}=this.toAffine();if(!r.isValid(_)||!r.isValid(E))throw new Error("bad point: x or y not FE");let I=r.sqr(E),k=s(_);if(!r.eql(I,k))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:_}=this.toAffine();if(r.isOdd)return!r.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){d(_);let{px:E,py:I,pz:k}=this,{px:C,py:R,pz:N}=_,U=r.eql(r.mul(E,N),r.mul(C,k)),q=r.eql(r.mul(I,N),r.mul(R,k));return U&&q}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){let{a:_,b:E}=t,I=r.mul(E,Du),{px:k,py:C,pz:R}=this,N=r.ZERO,U=r.ZERO,q=r.ZERO,L=r.mul(k,k),V=r.mul(C,C),O=r.mul(R,R),l=r.mul(k,C);return l=r.add(l,l),q=r.mul(k,R),q=r.add(q,q),N=r.mul(_,q),U=r.mul(I,O),U=r.add(N,U),N=r.sub(V,U),U=r.add(V,U),U=r.mul(N,U),N=r.mul(l,N),q=r.mul(I,q),O=r.mul(_,O),l=r.sub(L,O),l=r.mul(_,l),l=r.add(l,q),q=r.add(L,L),L=r.add(q,L),L=r.add(L,O),L=r.mul(L,l),U=r.add(U,L),O=r.mul(C,R),O=r.add(O,O),L=r.mul(O,l),N=r.sub(N,L),q=r.mul(O,V),q=r.add(q,q),q=r.add(q,q),new f(N,U,q)}add(_){d(_);let{px:E,py:I,pz:k}=this,{px:C,py:R,pz:N}=_,U=r.ZERO,q=r.ZERO,L=r.ZERO,V=t.a,O=r.mul(t.b,Du),l=r.mul(E,C),g=r.mul(I,R),v=r.mul(k,N),P=r.add(E,I),x=r.add(C,R);P=r.mul(P,x),x=r.add(l,g),P=r.sub(P,x),x=r.add(E,k);let B=r.add(C,N);return x=r.mul(x,B),B=r.add(l,v),x=r.sub(x,B),B=r.add(I,k),U=r.add(R,N),B=r.mul(B,U),U=r.add(g,v),B=r.sub(B,U),L=r.mul(V,x),U=r.mul(O,v),L=r.add(U,L),U=r.sub(g,L),L=r.add(g,L),q=r.mul(U,L),g=r.add(l,l),g=r.add(g,l),v=r.mul(V,v),x=r.mul(O,x),g=r.add(g,v),v=r.sub(l,v),v=r.mul(V,v),x=r.add(x,v),l=r.mul(g,x),q=r.add(q,l),l=r.mul(B,x),U=r.mul(P,U),U=r.sub(U,l),l=r.mul(P,g),L=r.mul(B,L),L=r.add(L,l),new f(U,q,L)}subtract(_){return this.add(_.negate())}is0(){return this.equals(f.ZERO)}wNAF(_){return m.wNAFCached(this,u,_,E=>{let I=r.invertBatch(E.map(k=>k.pz));return E.map((k,C)=>k.toAffine(I[C])).map(f.fromAffine)})}multiplyUnsafe(_){let E=f.ZERO;if(_===Qn)return E;if(a(_),_===at)return this;let{endo:I}=t;if(!I)return m.unsafeLadder(this,_);let{k1neg:k,k1:C,k2neg:R,k2:N}=I.splitScalar(_),U=E,q=E,L=this;for(;C>Qn||N>Qn;)C&at&&(U=U.add(L)),N&at&&(q=q.add(L)),L=L.double(),C>>=at,N>>=at;return k&&(U=U.negate()),R&&(q=q.negate()),q=new f(r.mul(q.px,I.beta),q.py,q.pz),U.add(q)}multiply(_){a(_);let E=_,I,k,{endo:C}=t;if(C){let{k1neg:R,k1:N,k2neg:U,k2:q}=C.splitScalar(E),{p:L,f:V}=this.wNAF(N),{p:O,f:l}=this.wNAF(q);L=m.constTimeNegate(R,L),O=m.constTimeNegate(U,O),O=new f(r.mul(O.px,C.beta),O.py,O.pz),I=L.add(O),k=V.add(l)}else{let{p:R,f:N}=this.wNAF(E);I=R,k=N}return f.normalizeZ([I,k])[0]}multiplyAndAddUnsafe(_,E,I){let k=f.BASE,C=(N,U)=>U===Qn||U===at||!N.equals(k)?N.multiplyUnsafe(U):N.multiply(U),R=C(this,E).add(C(_,I));return R.is0()?void 0:R}toAffine(_){let{px:E,py:I,pz:k}=this,C=this.is0();_==null&&(_=C?r.ONE:r.inv(k));let R=r.mul(E,_),N=r.mul(I,_),U=r.mul(k,_);if(C)return{x:r.ZERO,y:r.ZERO};if(!r.eql(U,r.ONE))throw new Error("invZ was invalid");return{x:R,y:N}}isTorsionFree(){let{h:_,isTorsionFree:E}=t;if(_===at)return!0;if(E)return E(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:_,clearCofactor:E}=t;return _===at?this:E?E(f,this):this.multiplyUnsafe(t.h)}toRawBytes(_=!0){return this.assertValidity(),n(f,this,_)}toHex(_=!0){return Gt.bytesToHex(this.toRawBytes(_))}}f.BASE=new f(t.Gx,t.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);let b=t.nBitLength,m=(0,Rl.wNAF)(f,t.endo?Math.ceil(b/2):b);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}Ve.weierstrassPoints=Ky;function q8(e){let t=(0,Rl.validateBasic)(e);return Gt.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function L8(e){let t=q8(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function o(x){return Qn<x&&x<r.ORDER}function a(x){return fc.mod(x,n)}function c(x){return fc.invert(x,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:b}=Ky({...t,toBytes(x,B,M){let T=B.toAffine(),h=r.toBytes(T.x),A=Gt.concatBytes;return M?A(Uint8Array.from([B.hasEvenY()?2:3]),h):A(Uint8Array.from([4]),h,r.toBytes(T.y))},fromBytes(x){let B=x.length,M=x[0],T=x.subarray(1);if(B===i&&(M===2||M===3)){let h=Gt.bytesToNumberBE(T);if(!o(h))throw new Error("Point is not on curve");let A=f(h),D=r.sqrt(A),K=(D&at)===at;return(M&1)===1!==K&&(D=r.neg(D)),{x:h,y:D}}else if(B===s&&M===4){let h=r.fromBytes(T.subarray(0,r.BYTES)),A=r.fromBytes(T.subarray(r.BYTES,2*r.BYTES));return{x:h,y:A}}else throw new Error(`Point of length ${B} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),m=x=>Gt.bytesToHex(Gt.numberToBytesBE(x,t.nByteLength));function y(x){let B=n>>at;return x>B}function _(x){return y(x)?a(-x):x}let E=(x,B,M)=>Gt.bytesToNumberBE(x.slice(B,M));class I{constructor(B,M,T){this.r=B,this.s=M,this.recovery=T,this.assertValidity()}static fromCompact(B){let M=t.nByteLength;return B=(0,vi.ensureBytes)("compactSignature",B,M*2),new I(E(B,0,M),E(B,M,2*M))}static fromDER(B){let{r:M,s:T}=Ve.DER.toSig((0,vi.ensureBytes)("DER",B));return new I(M,T)}assertValidity(){if(!b(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!b(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(B){return new I(this.r,this.s,B)}recoverPublicKey(B){let{r:M,s:T,recovery:h}=this,A=q((0,vi.ensureBytes)("msgHash",B));if(h==null||![0,1,2,3].includes(h))throw new Error("recovery id invalid");let D=h===2||h===3?M+t.n:M;if(D>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let K=(h&1)===0?"02":"03",F=u.fromHex(K+m(D)),Z=c(D),ce=a(-A*Z),we=a(T*Z),_r=u.BASE.multiplyAndAddUnsafe(F,ce,we);if(!_r)throw new Error("point at infinify");return _r.assertValidity(),_r}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Gt.hexToBytes(this.toDERHex())}toDERHex(){return Ve.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Gt.hexToBytes(this.toCompactHex())}toCompactHex(){return m(this.r)+m(this.s)}}let k={isValidPrivateKey(x){try{return d(x),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{let x=t.randomBytes(r.BYTES+8),B=fc.hashToPrivateScalar(x,n);return Gt.numberToBytesBE(B,t.nByteLength)},precompute(x=8,B=u.BASE){return B._setWindowSize(x),B.multiply(BigInt(3)),B}};function C(x,B=!0){return u.fromPrivateKey(x).toRawBytes(B)}function R(x){let B=x instanceof Uint8Array,M=typeof x=="string",T=(B||M)&&x.length;return B?T===i||T===s:M?T===2*i||T===2*s:x instanceof u}function N(x,B,M=!0){if(R(x))throw new Error("first arg must be private key");if(!R(B))throw new Error("second arg must be public key");return u.fromHex(B).multiply(d(x)).toRawBytes(M)}let U=t.bits2int||function(x){let B=Gt.bytesToNumberBE(x),M=x.length*8-t.nBitLength;return M>0?B>>BigInt(M):B},q=t.bits2int_modN||function(x){return a(U(x))},L=Gt.bitMask(t.nBitLength);function V(x){if(typeof x!="bigint")throw new Error("bigint expected");if(!(Qn<=x&&x<L))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Gt.numberToBytesBE(x,t.nByteLength)}function O(x,B,M=l){if(["recovered","canonical"].some(Se=>Se in M))throw new Error("sign() legacy options not supported");let{hash:T,randomBytes:h}=t,{lowS:A,prehash:D,extraEntropy:K}=M;A==null&&(A=!0),x=(0,vi.ensureBytes)("msgHash",x),D&&(x=(0,vi.ensureBytes)("prehashed msgHash",T(x)));let F=q(x),Z=d(B),ce=[V(Z),V(F)];if(K!=null){let Se=K===!0?h(r.BYTES):K;ce.push((0,vi.ensureBytes)("extraEntropy",Se,r.BYTES))}let we=Gt.concatBytes(...ce),_r=F;function Ie(Se){let Ni=U(Se);if(!b(Ni))return;let et=c(Ni),Te=u.BASE.multiply(Ni).toAffine(),Ri=a(Te.x);if(Ri===Qn)return;let Ke=a(et*a(_r+Ri*Z));if(Ke===Qn)return;let tt=(Te.x===Ri?0:2)|Number(Te.y&at),qa=Ke;return A&&y(Ke)&&(qa=_(Ke),tt^=1),new I(Ri,qa,tt)}return{seed:we,k2sig:Ie}}let l={lowS:t.lowS,prehash:!1},g={lowS:t.lowS,prehash:!1};function v(x,B,M=l){let{seed:T,k2sig:h}=O(x,B,M),A=t;return Gt.createHmacDrbg(A.hash.outputLen,A.nByteLength,A.hmac)(T,h)}u.BASE._setWindowSize(8);function P(x,B,M,T=g){let h=x;if(B=(0,vi.ensureBytes)("msgHash",B),M=(0,vi.ensureBytes)("publicKey",M),"strict"in T)throw new Error("options.strict was renamed to lowS");let{lowS:A,prehash:D}=T,K,F;try{if(typeof h=="string"||h instanceof Uint8Array)try{K=I.fromDER(h)}catch(Te){if(!(Te instanceof Ve.DER.Err))throw Te;K=I.fromCompact(h)}else if(typeof h=="object"&&typeof h.r=="bigint"&&typeof h.s=="bigint"){let{r:Te,s:Ri}=h;K=new I(Te,Ri)}else throw new Error("PARSE");F=u.fromHex(M)}catch(Te){if(Te.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(A&&K.hasHighS())return!1;D&&(B=t.hash(B));let{r:Z,s:ce}=K,we=q(B),_r=c(ce),Ie=a(we*_r),Se=a(Z*_r),Ni=u.BASE.multiplyAndAddUnsafe(F,Ie,Se)?.toAffine();return Ni?a(Ni.x)===Z:!1}return{CURVE:t,getPublicKey:C,getSharedSecret:N,sign:v,verify:P,ProjectivePoint:u,Signature:I,utils:k}}Ve.weierstrass=L8;function Dy(e,t){let r=e.ORDER,n=Qn;for(let y=r-at;y%Os===Qn;y/=Os)n+=at;let i=n,s=Os<<i-at-at,o=s*Os,a=(r-at)/o,c=(a-at)/Os,u=o-at,d=s,f=e.pow(t,a),b=e.pow(t,(a+at)/Os),m=(y,_)=>{let E=f,I=e.pow(_,u),k=e.sqr(I);k=e.mul(k,_);let C=e.mul(y,k);C=e.pow(C,c),C=e.mul(C,I),I=e.mul(C,_),k=e.mul(C,y);let R=e.mul(k,I);C=e.pow(R,d);let N=e.eql(C,e.ONE);I=e.mul(k,b),C=e.mul(R,E),k=e.cmov(I,k,N),R=e.cmov(C,R,N);for(let U=i;U>at;U--){let q=U-Os;q=Os<<q-at;let L=e.pow(R,q),V=e.eql(L,e.ONE);I=e.mul(k,E),E=e.mul(E,E),L=e.mul(R,E),k=e.cmov(I,k,V),R=e.cmov(L,R,V)}return{isValid:N,value:k}};if(e.ORDER%qy===Du){let y=(e.ORDER-Du)/qy,_=e.sqrt(e.neg(t));m=(E,I)=>{let k=e.sqr(I),C=e.mul(E,I);k=e.mul(k,C);let R=e.pow(k,y);R=e.mul(R,C);let N=e.mul(R,_),U=e.mul(e.sqr(R),I),q=e.eql(U,E),L=e.cmov(N,R,q);return{isValid:q,value:L}}}return m}Ve.SWUFpSqrtRatio=Dy;function K8(e,t){if(fc.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=Dy(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,a,c,u,d,f;i=e.sqr(n),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),u=e.sqr(a),c=e.mul(u,t.A),s=e.add(s,c),s=e.mul(s,o),u=e.mul(u,a),c=e.mul(u,t.B),s=e.add(s,c),d=e.mul(i,o);let{isValid:b,value:m}=r(s,u);f=e.mul(i,n),f=e.mul(f,m),d=e.cmov(d,o,b),f=e.cmov(f,m,b);let y=e.isOdd(n)===e.isOdd(f);return f=e.cmov(e.neg(f),f,y),d=e.div(d,a),{x:d,y:f}}}Ve.mapToCurveSimpleSWU=K8});var Wy=H(ct=>{w();S();Object.defineProperty(ct,"__esModule",{value:!0});ct.createHasher=ct.isogenyMap=ct.hash_to_field=ct.expand_message_xof=ct.expand_message_xmd=ct.isNum=ct.isBytes=ct.strxor=ct.i2osp=ct.validateDST=void 0;var D8=uo(),ei=Yi();function jy(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,ei.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}ct.validateDST=jy;var j8=ei.bytesToNumberBE;function Zi(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}ct.i2osp=Zi;function Fy(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}ct.strxor=Fy;function fa(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected")}ct.isBytes=fa;function Fu(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}ct.isNum=Fu;function Gy(e,t,r,n){fa(e),fa(t),Fu(r),t.length>255&&(t=n((0,ei.concatBytes)((0,ei.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(o>255)throw new Error("Invalid xmd length");let a=(0,ei.concatBytes)(t,Zi(t.length,1)),c=Zi(0,s),u=Zi(r,2),d=new Array(o),f=n((0,ei.concatBytes)(c,e,u,Zi(0,1),a));d[0]=n((0,ei.concatBytes)(f,Zi(1,1),a));for(let m=1;m<=o;m++){let y=[Fy(f,d[m-1]),Zi(m+1,1),a];d[m]=n((0,ei.concatBytes)(...y))}return(0,ei.concatBytes)(...d).slice(0,r)}ct.expand_message_xmd=Gy;function Vy(e,t,r,n,i){if(fa(e),fa(t),Fu(r),t.length>255){let s=Math.ceil(2*n/8);t=i.create({dkLen:s}).update((0,ei.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(Zi(r,2)).update(t).update(Zi(t.length,1)).digest()}ct.expand_message_xof=Vy;function Ul(e,t,r){(0,ei.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:o,expand:a,DST:c}=r;fa(e),Fu(t);let u=jy(c),d=n.toString(2).length,f=Math.ceil((d+i)/8),b=t*s*f,m;if(a==="xmd")m=Gy(e,u,b,o);else if(a==="xof")m=Vy(e,u,b,i,o);else if(a==="_internal_pass")m=e;else throw new Error('expand must be "xmd" or "xof"');let y=new Array(t);for(let _=0;_<t;_++){let E=new Array(s);for(let I=0;I<s;I++){let k=f*(I+_*s),C=m.subarray(k,k+f);E[I]=(0,D8.mod)(j8(C),n)}y[_]=E}return y}ct.hash_to_field=Ul;function F8(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,o,a,c]=r.map(u=>u.reduce((d,f)=>e.add(e.mul(d,n),f)));return n=e.div(s,o),i=e.mul(i,e.div(a,c)),{x:n,y:i}}}ct.isogenyMap=F8;function G8(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=Ul(n,2,{...r,DST:r.DST,...i}),o=e.fromAffine(t(s[0])),a=e.fromAffine(t(s[1])),c=o.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,i){let s=Ul(n,1,{...r,DST:r.encodeDST,...i}),o=e.fromAffine(t(s[0])).clearCofactor();return o.assertValidity(),o}}}ct.createHasher=G8});var ql=H(da=>{w();S();Object.defineProperty(da,"__esModule",{value:!0});da.createCurve=da.getHash=void 0;var V8=ec(),zy=wr(),W8=ju();function Xy(e){return{hash:e,hmac:(t,...r)=>(0,V8.hmac)(e,t,(0,zy.concatBytes)(...r)),randomBytes:zy.randomBytes}}da.getHash=Xy;function z8(e,t){let r=n=>(0,W8.weierstrass)({...e,...Xy(n)});return Object.freeze({...r(t),create:r})}da.createCurve=z8});var i1=H(Vt=>{w();S();var X8=Vt&&Vt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Y8=Vt&&Vt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$8=Vt&&Vt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&X8(t,e,r);return Y8(t,e),t},Ll;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.encodeToCurve=Vt.hashToCurve=Vt.schnorr=Vt.secp256k1=void 0;var Gu=Ko(),Z8=wr(),dr=uo(),J8=ju(),Mr=Yi(),Zy=$8(Wy()),Q8=ql(),Xu=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Vu=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Jy=BigInt(1),Wu=BigInt(2),Yy=(e,t)=>(e+t/Wu)/t;function Qy(e){let t=Xu,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,d=u*u*e%t,f=(0,dr.pow2)(d,r,t)*d%t,b=(0,dr.pow2)(f,r,t)*d%t,m=(0,dr.pow2)(b,Wu,t)*u%t,y=(0,dr.pow2)(m,i,t)*m%t,_=(0,dr.pow2)(y,s,t)*y%t,E=(0,dr.pow2)(_,a,t)*_%t,I=(0,dr.pow2)(E,c,t)*E%t,k=(0,dr.pow2)(I,a,t)*_%t,C=(0,dr.pow2)(k,r,t)*d%t,R=(0,dr.pow2)(C,o,t)*y%t,N=(0,dr.pow2)(R,n,t)*u%t,U=(0,dr.pow2)(N,Wu,t);if(!Bs.eql(Bs.sqr(U),e))throw new Error("Cannot find square root");return U}var Bs=(0,dr.Field)(Xu,void 0,void 0,{sqrt:Qy});Vt.secp256k1=(0,Q8.createCurve)({a:BigInt(0),b:BigInt(7),Fp:Bs,n:Vu,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=Vu,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Jy*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=Yy(s*e,t),c=Yy(-n*e,t),u=(0,dr.mod)(e-a*r-c*i,t),d=(0,dr.mod)(-a*n-c*s,t),f=u>o,b=d>o;if(f&&(u=t-u),b&&(d=t-d),u>o||d>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:u,k2neg:b,k2:d}}}},Gu.sha256);var Yu=BigInt(0),e1=e=>typeof e=="bigint"&&Yu<e&&e<Xu,e5=e=>typeof e=="bigint"&&Yu<e&&e<Vu,$y={};function zu(e,...t){let r=$y[e];if(r===void 0){let n=(0,Gu.sha256)(Uint8Array.from(e,i=>i.charCodeAt(0)));r=(0,Mr.concatBytes)(n,n),$y[e]=r}return(0,Gu.sha256)((0,Mr.concatBytes)(r,...t))}var Fl=e=>e.toRawBytes(!0).slice(1),Dl=e=>(0,Mr.numberToBytesBE)(e,32),Kl=e=>(0,dr.mod)(e,Xu),dc=e=>(0,dr.mod)(e,Vu),Gl=Vt.secp256k1.ProjectivePoint,t5=(e,t,r)=>Gl.BASE.multiplyAndAddUnsafe(e,t,r);function jl(e){let t=Vt.secp256k1.utils.normPrivateKeyToScalar(e),r=Gl.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:dc(-t),bytes:Fl(r)}}function t1(e){if(!e1(e))throw new Error("bad x: need 0 < x < p");let t=Kl(e*e),r=Kl(t*e+BigInt(7)),n=Qy(r);n%Wu!==Yu&&(n=Kl(-n));let i=new Gl(e,n,Jy);return i.assertValidity(),i}function r1(...e){return dc((0,Mr.bytesToNumberBE)(zu("BIP0340/challenge",...e)))}function r5(e){return jl(e).bytes}function n5(e,t,r=(0,Z8.randomBytes)(32)){let n=(0,Mr.ensureBytes)("message",e),{bytes:i,scalar:s}=jl(t),o=(0,Mr.ensureBytes)("auxRand",r,32),a=Dl(s^(0,Mr.bytesToNumberBE)(zu("BIP0340/aux",o))),c=zu("BIP0340/nonce",a,i,n),u=dc((0,Mr.bytesToNumberBE)(c));if(u===Yu)throw new Error("sign failed: k is zero");let{bytes:d,scalar:f}=jl(u),b=r1(d,i,n),m=new Uint8Array(64);if(m.set(d,0),m.set(Dl(dc(f+b*s)),32),!n1(m,n,i))throw new Error("sign: Invalid signature produced");return m}function n1(e,t,r){let n=(0,Mr.ensureBytes)("signature",e,64),i=(0,Mr.ensureBytes)("message",t),s=(0,Mr.ensureBytes)("publicKey",r,32);try{let o=t1((0,Mr.bytesToNumberBE)(s)),a=(0,Mr.bytesToNumberBE)(n.subarray(0,32));if(!e1(a))return!1;let c=(0,Mr.bytesToNumberBE)(n.subarray(32,64));if(!e5(c))return!1;let u=r1(Dl(a),Fl(o),i),d=t5(o,c,dc(-u));return!(!d||!d.hasEvenY()||d.toAffine().x!==a)}catch{return!1}}Vt.schnorr={getPublicKey:r5,sign:n5,verify:n1,utils:{randomPrivateKey:Vt.secp256k1.utils.randomPrivateKey,lift_x:t1,pointToBytes:Fl,numberToBytesBE:Mr.numberToBytesBE,bytesToNumberBE:Mr.bytesToNumberBE,taggedHash:zu,mod:dr.mod}};var i5=Zy.isogenyMap(Bs,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),s5=(0,J8.mapToCurveSimpleSWU)(Bs,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Bs.create(BigInt("-11"))});Ll=Zy.createHasher(Vt.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=s5(Bs.create(e[0]));return i5(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Bs.ORDER,m:1,k:128,expand:"xmd",hash:Gu.sha256}),Vt.hashToCurve=Ll.hashToCurve,Vt.encodeToCurve=Ll.encodeToCurve});var a1=H(Ms=>{w();S();Object.defineProperty(Ms,"__esModule",{value:!0});Ms.poseidon=Ms.splitConstants=Ms.validateOpts=void 0;var s1=uo();function o1(e){let{Fp:t}=e;(0,s1.validateField)(t);for(let c of["t","roundsFull","roundsPartial"])if(typeof e[c]!="number"||!Number.isSafeInteger(e[c]))throw new Error(`Poseidon: invalid param ${c}=${e[c]} (${typeof e[c]})`);if(e.reversePartialPowIdx!==void 0&&typeof e.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${e.reversePartialPowIdx}`);let r=e.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=c=>(0,s1.FpPow)(t,c,n);if(r===3?i=c=>t.mul(t.sqrN(c),c):r===5&&(i=c=>t.mul(t.sqrN(t.sqrN(c)),c)),e.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${e.roundsFull}`);let s=e.roundsFull+e.roundsPartial;if(!Array.isArray(e.roundConstants)||e.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let o=e.roundConstants.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon wrong round constants: ${c}`);return c.map(u=>{if(typeof u!="bigint"||!t.isValid(u))throw new Error(`Poseidon wrong round constant=${u}`);return t.create(u)})});if(!Array.isArray(e.mds)||e.mds.length!==e.t)throw new Error("Poseidon: wrong MDS matrix");let a=e.mds.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon MDS matrix row: ${c}`);return c.map(u=>{if(typeof u!="bigint")throw new Error(`Poseidon MDS matrix value=${u}`);return t.create(u)})});return Object.freeze({...e,rounds:s,sboxFn:i,roundConstants:o,mds:a})}Ms.validateOpts=o1;function o5(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<e.length;i++)n.push(e[i]),n.length===t&&(r.push(n),n=[]);return r}Ms.splitConstants=o5;function a5(e){let{t,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=o1(e),o=Math.floor(e.roundsFull/2),a=s?t-1:0,c=(d,f,b)=>(d=d.map((m,y)=>r.add(m,e.roundConstants[b][y])),f?d=d.map(m=>i(m)):d[a]=i(d[a]),d=e.mds.map(m=>m.reduce((y,_,E)=>r.add(y,r.mulN(_,d[E])),r.ZERO)),d),u=function(f){if(!Array.isArray(f)||f.length!==t)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${t})`);f=f.map(m=>{if(typeof m!="bigint")throw new Error(`Poseidon: wrong value=${m} (${typeof m})`);return r.create(m)});let b=0;for(let m=0;m<o;m++)f=c(f,!0,b++);for(let m=0;m<e.roundsPartial;m++)f=c(f,!1,b++);for(let m=0;m<o;m++)f=c(f,!0,b++);if(b!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${b}, total=${n}`);return f};return u.roundConstants=e.roundConstants,u}Ms.poseidon=a5});var v1=H(W=>{w();S();var c5=W&&W.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),u5=W&&W.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f5=W&&W.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&c5(t,e,r);return u5(t,e),t};Object.defineProperty(W,"__esModule",{value:!0});W.poseidonHashMany=W.poseidonHashSingle=W.poseidonHashFunc=W.poseidonHash=W.poseidonSmall=W.poseidonCreate=W.poseidonBasic=W._poseidonMDS=W.Fp251=W.Fp253=W.keccak=W.computeHashOnElements=W.hashChain=W.pedersen=W.getAccountPath=W.ethSigToPrivate=W.getStarkKey=W.grindKey=W.utils=W.Signature=W.ProjectivePoint=W.CURVE=W.verify=W.sign=W.getSharedSecret=W.getPublicKey=W._starkCurve=void 0;var d5=cu(),zl=Ko(),l5=wr(),lo=uo(),h5=a1(),p5=ju(),Cr=f5(Yi()),b5=ql(),Zu=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),f1=252;function c1(e){for(;e[0]===0;)e=e.subarray(1);let t=e.length*8-f1,r=Cr.bytesToNumberBE(e);return t>0?r>>BigInt(t):r}function d1(e){return typeof e=="string"&&(e=Yl(e),e.length&1&&(e="0"+e)),Cr.hexToBytes(e)}var ho=(0,p5.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,lo.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:Zu,nBitLength:f1,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,b5.getHash)(zl.sha256),bits2int:c1,bits2int_modN:e=>{let t=Cr.bytesToNumberBE(e).toString(16);return t.length===63&&(e=d1(t+"0")),(0,lo.mod)(c1(e),Zu)}});W._starkCurve=ho;function fo(e){return Cr.ensureBytes("",typeof e=="string"?d1(e):e)}function Xl(e){return Cr.bytesToHex(fo(e)).padStart(64,"0")}function l1(e,t=!1){return ho.getPublicKey(Xl(e),t)}W.getPublicKey=l1;function g5(e,t){return ho.getSharedSecret(Xl(e),t)}W.getSharedSecret=g5;function y5(e,t,r){return ho.sign(fo(e),Xl(t),r)}W.sign=y5;function m5(e,t,r){let n=e instanceof h1?e:fo(e);return ho.verify(n,fo(t),fo(r))}W.verify=m5;var{CURVE:_5,ProjectivePoint:la,Signature:h1,utils:v5}=ho;W.CURVE=_5;W.ProjectivePoint=la;W.Signature=h1;W.utils=v5;function p1(e){return`0x${Cr.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function Yl(e){return e.replace(/^0x/i,"")}function w5(e){return`0x${e.toString(16)}`}function b1(e){let t=fo(e),r=2n**256n,n=r-(0,lo.mod)(r,Zu);for(let i=0;;i++){let s=Vl(Cr.concatBytes(t,Cr.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,lo.mod)(s,Zu).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}W.grindKey=b1;function S5(e){return p1(l1(e,!0))}W.getStarkKey=S5;function x5(e){if(e=Yl(e),e.length!==130)throw new Error("Wrong ethereum signature");return b1(e.substring(0,64))}W.ethSigToPrivate=x5;var P5=2n**31n-1n,$u=e=>Number(e&P5);function T5(e,t,r,n){let i=$u(Vl(e)),s=$u(Vl(t)),o=Cr.hexToNumber(Yl(r));return`m/2645'/${i}'/${s}'/${$u(o)}'/${$u(o>>31n)}'/${n}`}W.getAccountPath=T5;var lc=[new la(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new la(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new la(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new la(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new la(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function g1(e,t){let r=[],n=e;for(let i=0;i<248;i++)r.push(n),n=n.double();n=t;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var E5=g1(lc[1],lc[2]),A5=g1(lc[3],lc[4]);function y1(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=Cr.bytesToNumberBE(fo(e));if(!(0n<=t&&t<ho.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function u1(e,t,r){let n=y1(t);for(let i=0;i<252;i++){let s=r[i];if(s.equals(e))throw new Error("Same point");(n&1n)!==0n&&(e=e.add(s)),n>>=1n}return e}function $l(e,t){let r=lc[0];return r=u1(r,e,E5),r=u1(r,t,A5),p1(r.toRawBytes(!0))}W.pedersen=$l;function I5(e,t=$l){if(!Array.isArray(e)||e.length<1)throw new Error("data should be array of at least 1 element");return e.length===1?w5(y1(e[0])):Array.from(e).reverse().reduce((r,n)=>t(n,r))}W.hashChain=I5;var O5=(e,t=$l)=>[0,...e,e.length].reduce((r,n)=>t(r,n));W.computeHashOnElements=O5;var B5=Cr.bitMask(250),M5=e=>Cr.bytesToNumberBE((0,d5.keccak_256)(e))&B5;W.keccak=M5;var Vl=e=>Cr.bytesToNumberBE((0,zl.sha256)(e));W.Fp253=(0,lo.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));W.Fp251=(0,lo.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function Wl(e,t,r){let n=e.fromBytes((0,zl.sha256)((0,l5.utf8ToBytes)(`${t}${r}`)));return e.create(n)}function m1(e,t,r,n=0){let i=[],s=[];for(let o=0;o<r;o++)i.push(Wl(e,`${t}x`,n*r+o)),s.push(Wl(e,`${t}y`,n*r+o));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(o=>s.map(a=>e.inv(e.sub(o,a))))}W._poseidonMDS=m1;var C5=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function Zl(e,t){if((0,lo.validateField)(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);let r=e.rate+e.capacity,n=e.roundsFull+e.roundsPartial,i=[];for(let o=0;o<n;o++){let a=[];for(let c=0;c<r;c++)a.push(Wl(e.Fp,"Hades",r*o+c));i.push(a)}let s=(0,h5.poseidon)({...e,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:i});return s.m=r,s.rate=e.rate,s.capacity=e.capacity,s}W.poseidonBasic=Zl;function k5(e,t=0){let r=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return Zl(e,m1(e.Fp,"HadesMDS",r,t))}W.poseidonCreate=k5;W.poseidonSmall=Zl({Fp:W.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},C5);function _1(e,t,r=W.poseidonSmall){return r([e,t,2n])[0]}W.poseidonHash=_1;function H5(e,t,r=W.poseidonSmall){return Cr.numberToVarBytesBE(_1(Cr.bytesToNumberBE(e),Cr.bytesToNumberBE(t),r))}W.poseidonHashFunc=H5;function N5(e,t=W.poseidonSmall){return t([e,0n,1n])[0]}W.poseidonHashSingle=N5;function R5(e,t=W.poseidonSmall){let{m:r,rate:n}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");let i=Array.from(e);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let o=0;o<i.length;o+=n){for(let a=0;a<n;a++)s[a]+=i[o+a];s=t(s)}return s[0]}W.poseidonHashMany=R5});var x1=H(kr=>{w();S();var U5=kr&&kr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),q5=kr&&kr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),w1=kr&&kr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&U5(t,e,r);return q5(t,e),t};Object.defineProperty(kr,"__esModule",{value:!0});kr.bytesToHex=kr.hexToBytes=kr.stark=kr.secp256k1=void 0;kr.secp256k1=w1(i1());kr.stark=w1(v1());var S1=Yi();Object.defineProperty(kr,"hexToBytes",{enumerable:!0,get:function(){return S1.hexToBytes}});Object.defineProperty(kr,"bytesToHex",{enumerable:!0,get:function(){return S1.bytesToHex}})});var P1=H(Hr=>{w();S();var L5=Hr&&Hr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),K5=Hr&&Hr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ju=Hr&&Hr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&L5(t,e,r);return K5(t,e),t};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.schnorr=Hr.p256=Hr.ed25519=Hr.secp256k1=void 0;Hr.secp256k1=Ju(dy());Hr.ed25519=Ju(vy());Hr.p256=Ju(Py());Hr.schnorr=Ju(x1())});var ti=H(Wt=>{w();S();var D5=Wt&&Wt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),j5=Wt&&Wt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ha=Wt&&Wt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&D5(t,e,r);return j5(t,e),t};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.secp256k1=Wt.ed25519=Wt.signUtil=Wt.elliptic=Wt.bip39=Wt.bip32=void 0;Wt.bip32=ha(Wg());Wt.bip39=ha(Al());Wt.elliptic=ha(sa());Wt.signUtil=ha(P1());Wt.ed25519=ha(z0());Wt.secp256k1=ha(cw())});var eh=H(wi=>{w();S();Object.defineProperty(wi,"__esModule",{value:!0});wi.encode=wi.decode=wi.encodeRaw=wi.decodeRaw=void 0;var Jl=le();function T1(e,t){if(t!==void 0&&e[0]!==t)throw new Error("Invalid network version");if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}wi.decodeRaw=T1;function Ql(e,t,r){let n=p.Buffer.alloc(r?34:33);return n.writeUInt8(e,0),t.copy(n,1),r&&(n[33]=1),n}wi.encodeRaw=Ql;function F5(e,t){return T1(Jl.base.fromBase58Check(e),t)}wi.decode=F5;function G5(e,t,r){return typeof e=="number"?Jl.base.toBase58Check(Ql(e,t,r)):Jl.base.toBase58Check(Ql(e.version,e.privateKey,e.compressed))}wi.encode=G5});var pa=H(en=>{w();S();var V5=en&&en.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),W5=en&&en.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),z5=en&&en.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&V5(t,e,r);return W5(t,e),t};Object.defineProperty(en,"__esModule",{value:!0});en.countAdjustedVsize=en.convertScriptSigAsm=en.countScriptSigops=void 0;var X5=$s(),Y5=tn(),E1=le(),$5=z5(rn());function hc(e,t=!1,r=!1){if(!e?.length)return 0;let n=0;if(n+=e.match(/OP_CHECKSIG/g)?.length||0,t)n+=20*(e.match(/OP_CHECKMULTISIG/g)?.length||0);else{let i=e.matchAll(/(?:OP_(?:PUSHNUM_)?(\d+))? OP_CHECKMULTISIG/g);for(let s of i){let o=parseInt(s[1]);Number.isInteger(o)?n+=o:n+=20}}return r?n:n*4}en.countScriptSigops=hc;function pc(e){if(e?.length==0)return"";let t=[],r=0;for(;r<e.length;){let n=e[r];if(n>=1&&n<=78){r++;let i;n===76?(i=e.readUInt8(r),t.push("OP_PUSHDATA1"),r+=1):n===77?(i=e.readUInt16LE(r),t.push("OP_PUSHDATA2"),r+=2):n===78?(i=e.readUInt32LE(r),t.push("OP_PUSHDATA4"),r+=4):(i=n,t.push("OP_PUSHBYTES_"+i));let s=e.slice(r,r+i);if(s.length!==i)break;t.push(s.toString("hex")),r+=s.length}else{if(n===0)t.push("OP_0");else if(n===79)t.push("OP_PUSHNUM_NEG1");else if(n===177)t.push("OP_CLTV");else if(n===178)t.push("OP_CSV");else if(n===186)t.push("OP_CHECKSIGADD");else{let i=X5.REVERSE_OPS[n];i&&n<253?/^OP_(\d+)$/.test(i)?t.push(i.replace(/^OP_(\d+)$/,"OP_PUSHNUM_$1")):t.push(i):t.push("OP_RETURN_"+n)}r+=1}}return t.join(" ")}en.convertScriptSigAsm=pc;function Z5(e,t,r){if(e==null)return 0;r==null&&(r=$5.networks.bitcoin);let n=0;(t!=null||null)&&t.length==e.ins.length&&e.ins.forEach((s,o)=>{if(s.script!=null&&(n+=hc(pc(s.script),!0)),t.length<=o||t[o]==null||null||t[o]=="")return;let a=(0,Y5.getAddressType)(t[o],r);switch(!0){case(a==="segwit_nested"&&s.witness?.length===2&&s.script&&E1.base.toHex(s.script).startsWith("160014")):case a==="segwit_native":n+=1;break;case(a==="segwit_nested"&&s.witness?.length&&s.script&&E1.base.toHex(s.script).startsWith("220020")):case a==="segwit_native":s.witness?.length&&(n+=hc(pc(s.witness[s.witness.length-1]),!1,!0));break;case a==="segwit_nested":s.script&&(n+=hc(pc(s.script)));break}});for(let s of e.outs)s&&(n+=hc(pc(s.script),!0));let i=e.virtualSize();return i>n*5?i:n*5}en.countAdjustedVsize=Z5});var tn=H(re=>{w();S();var J5=re&&re.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Q5=re&&re.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),gc=re&&re.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&J5(t,e,r);return Q5(t,e),t};Object.defineProperty(re,"__esModule",{value:!0});re.fakeSign=re.estimateBchFee=re.estimateBtcFee=re.ValidSignedTransaction=re.getMPCTransaction=re.calculateBchTxSize=re.calculateTxSize=re.signBch=re.getAddressType=re.signBtc=re.TxBuild=re.private2Wif=re.wif2Public=re.sign=re.private2public=re.privateKeyFromWIF=re.Array=void 0;var he=gc(rn()),I1=rn(),bc=ti(),z=le(),O1=gc(eh()),A1=ba(),B1=gc(vr()),M1=gc(Si()),Ji=gc(Ft()),Cs=$s(),ex=pa(),C1=bc.signUtil.schnorr.secp256k1.schnorr;re.Array=z.typeforce.Array;function th(e,t){let r=O1.decode(e),n=r.version;if((0,re.Array)(t)){if(t=t.filter(i=>n===i.wif).pop(),!t)throw new Error("Unknown network version")}else if(t=t||he.networks.bitcoin,n!==t.wif)throw new Error("Invalid network version");return z.base.toHex(r.privateKey)}re.privateKeyFromWIF=th;function rh(e){return bc.signUtil.secp256k1.publicKeyCreate(z.base.fromHex(e),!0)}re.private2public=rh;function Qu(e,t){let{signature:r}=bc.signUtil.secp256k1.sign(e,z.base.fromHex(t));return p.Buffer.from(r)}re.sign=Qu;function tx(e,t){let r=th(e,t);return rh(r)}re.wif2Public=tx;function yc(e,t){return t=t||he.networks.bitcoin,O1.encode(t.wif,e,!0)}re.private2Wif=yc;var po=class{constructor(t,r,n,i,s){this.tx=new he.Transaction,this.network=he.networks.bitcoin,t?this.tx.version=t:this.tx.version=2,r&&(this.network=r),this.inputs=[],this.outputs=[],this.bitcoinCash=n||!1,this.hardware=i||!1,this.fakeKey=s||!1}addInput(t,r,n,i,s,o,a,c){this.inputs.push({txId:t,index:r,privateKey:n,address:i,script:s,value:o,publicKey:a,sequence:c})}addOutput(t,r,n){this.outputs.push({address:t,value:r,omniScript:n})}build(t){let r=[];for(let n of this.inputs){let i=z.base.reverseBuffer(p.Buffer.from(n.txId,"hex"));this.tx.addInput(i,n.index,n.sequence),n.privateKey?r.push(th(n.privateKey,this.network)):r.push("")}for(let n of this.outputs)if(n.omniScript)this.tx.addOutput(z.base.fromHex(n.omniScript),0);else{let i=he.address.toOutputScript(n.address,this.network);this.tx.addOutput(i,n.value)}if(this.hardware)return this.tx.toHex();for(let n=0;n<r.length;n++){let i=r[n],s;i?s=rh(i):this.hardware||(s=z.base.fromHex(this.inputs[n].publicKey));let o,a=he.Transaction.SIGHASH_ALL;if(this.bitcoinCash){let c=he.payments.p2pkh({pubkey:s}).output;a=he.Transaction.SIGHASH_ALL|he.Transaction.SIGHASH_BITCOINCASHBIP143;let u=this.inputs[n].value||0;o=this.tx.hashForCashSignature(n,c,u,a);let d;t?(t.push(z.base.toHex(o)),d=p.Buffer.alloc(64,0)):d=Qu(o,i);let f=he.payments.p2pkh({output:c,pubkey:s,signature:he.script.signature.encode(d,a)});f.input&&(this.tx.ins[n].script=f.input)}else{let c=k1(this.inputs[n].address,this.network);if(this.fakeKey){let{witness:u,script:d}=H1(c);u!==void 0&&(this.tx.ins[n].witness=u),d!==void 0&&(this.tx.ins[n].script=d);continue}if(c==="legacy"){let u=he.payments.p2pkh({pubkey:s}).output;o=this.tx.hashForSignature(n,u,a);let d;t?(t.push(z.base.toHex(o)),d=p.Buffer.alloc(64,0)):d=Qu(o,i);let f=he.payments.p2pkh({output:u,pubkey:s,signature:he.script.signature.encode(d,a)});f.input&&(this.tx.ins[n].script=f.input)}else if(c==="segwit_taproot"){let u=this.inputs.map(b=>he.address.toOutputScript(b.address,this.network)),d=this.inputs.map(b=>b.value);o=this.tx.hashForWitnessV1(n,u,d,he.Transaction.SIGHASH_DEFAULT);let f;if(t)t.push(z.base.toHex(o)),f=p.Buffer.alloc(64,0);else{let b=M1.taprootTweakPrivKey(z.base.fromHex(i));f=p.Buffer.from(C1.sign(o,b,z.base.randomBytes(32)))}this.tx.ins[n].witness=[p.Buffer.from(f)]}else{let u=B1.hash160(s),d=p.Buffer.of(25,118,169,20,...u,136,172),f=this.inputs[n].value||0;o=this.tx.hashForWitness(n,d,f,a);let b;t?(t.push(z.base.toHex(o)),b=p.Buffer.alloc(64,0)):b=Qu(o,i),this.tx.ins[n].witness=[],this.tx.ins[n].witness.push(he.script.signature.encode(b,a)),this.tx.ins[n].witness.push(s);let m=p.Buffer.of(22,0,20,...u);c!=="segwit_native"&&(this.tx.ins[n].script=m)}}}return this.tx.toHex()}virtualSize(){return(0,ex.countAdjustedVsize)(this.tx,this.inputs.map(t=>t.address),this.network||he.networks.bitcoin)}};re.TxBuild=po;function rx(e,t,r,n,i,s){let o=e.inputs,a=e.outputs,c=e.address,u=e.feePerB||10,d=e.dustSize||546;if(r=r||he.networks.bitcoin,e.memo&&(z.base.isHexString(e.memo)?z.base.fromHex(e.memo):p.Buffer.from(z.base.toUtf8(e.memo))).length>80)throw new Error("data after op_return is  too long");let f=t;if(f||(f=yc(z.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),r)),s){let{inputAmount:I,outputAmount:k,virtualSize:C}=ef(o,a,c,f,r,d,!1,e.memo,e.memoPos);return(I-k-Math.ceil(C*u)).toString()}let{inputAmount:b,outputAmount:m,virtualSize:y}=ef(o,a,c,f,r,d,!1,e.memo,e.memoPos),_=b-m-Math.ceil(y*u),E=new po(2,r,!1,i);for(let I=0;I<o.length;I++){let k=o[I],C=k.privateKey||t,R=k.address||c;E.addInput(k.txId,k.vOut,C,R,k.reedScript,k.amount,k.publicKey,k.sequence)}e.memo&&e.memoPos==0&&E.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(e.memo)?z.base.fromHex(e.memo):p.Buffer.from(z.base.toUtf8(e.memo))))));for(let I=0;I<a.length;I++){let k=a[I];E.addOutput(k.address,k.amount,k.omniScript),e.memo&&e.memoPos&&E.outputs.length==e.memoPos&&E.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(e.memo)?z.base.fromHex(e.memo):p.Buffer.from(z.base.toUtf8(e.memo))))))}return _>d&&(E.addOutput(c,_),e.memo&&e.memoPos&&E.outputs.length==e.memoPos&&E.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(e.memo)?z.base.fromHex(e.memo):p.Buffer.from(z.base.toUtf8(e.memo))))))),e.memo&&(e.memoPos==null||e.memoPos<0||e.memoPos>E.outputs.length)&&E.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(e.memo)?z.base.fromHex(e.memo):p.Buffer.from(z.base.toUtf8(e.memo)))))),E.build(n)}re.signBtc=rx;function k1(e,t){let r,n;try{r=(0,A1.fromBase58Check)(e)}catch{}if(r){if(r.version===t.pubKeyHash)return"legacy";if(r.version===t.scriptHash)return"segwit_nested"}else{try{n=(0,A1.fromBech32)(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0)return"segwit_native";if(n.version===1)return"segwit_taproot"}}return"legacy"}re.getAddressType=k1;function nx(e,t,r,n,i){let s=e.inputs,o=e.outputs,a=e.address,c=e.feePerB||10,u=e.dustSize||546;r=r||he.networks.bitcoin;let d=t;d||(d=yc(z.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),r));let{inputAmount:f,outputAmount:b,virtualSize:m}=nh(s,o,a,d,r,u),y=f-b-m*c,_=new po(2,r,!0,i);for(let E=0;E<s.length;E++){let I=s[E];_.addInput(I.txId,I.vOut,t,a,void 0,I.amount,I.publicKey,I.sequence)}for(let E=0;E<o.length;E++){let I=o[E];_.addOutput(I.address,I.amount)}return y>u&&_.addOutput(a,y),_.build(n)}re.signBch=nx;function ef(e,t,r,n,i,s,o,a,c){let u=new po(2,i,!1,o,!0),d=0;for(let y=0;y<e.length;y++){let _=e[y],E=_.privateKey||n,I=_.address||r;u.addInput(_.txId,_.vOut,E,I,_.reedScript,_.amount,_.publicKey,_.sequence),d=d+(_.amount||0)}a&&c==0&&u.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(a)?z.base.fromHex(a):p.Buffer.from(z.base.toUtf8(a))))));let f=0;for(let y=0;y<t.length;y++){let _=t[y];u.addOutput(_.address,_.amount,_.omniScript),f=f+_.amount,a&&c&&u.outputs.length==c&&u.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(a)?z.base.fromHex(a):p.Buffer.from(z.base.toUtf8(a))))))}d-f>s&&(u.addOutput(r,d-f),a&&c&&u.outputs.length==c&&u.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(a)?z.base.fromHex(a):p.Buffer.from(z.base.toUtf8(a))))))),a&&(c==null||c<0||c>u.outputs.length)&&u.addOutput("",0,z.base.toHex(Ji.compile([Cs.OPS.OP_RETURN].concat(z.base.isHexString(a)?z.base.fromHex(a):p.Buffer.from(z.base.toUtf8(a))))));let b=u.build(),m=u.virtualSize();return{inputAmount:d,outputAmount:f,virtualSize:m,txHex:b}}re.calculateTxSize=ef;function nh(e,t,r,n,i,s,o){let a=new po(2,i,!0,o),c=0;for(let b=0;b<e.length;b++){let m=e[b];a.addInput(m.txId,m.vOut,n,r,void 0,m.amount,m.publicKey,m.sequence),c=c+(m.amount||0)}let u=0;for(let b=0;b<t.length;b++){let m=t[b];a.addOutput(m.address,m.amount),u=u+m.amount}c-u>s&&a.addOutput(r,c-u);let d=a.build(),f=a.tx.virtualSize();return{inputAmount:c,outputAmount:u,virtualSize:f,txHex:d}}re.calculateBchTxSize=nh;function ix(e,t,r){let n=I1.Transaction.fromBuffer(z.base.fromHex(e),!1);for(let i=0;i<n.ins.length;i++){let s=n.ins[i],o=z.base.fromHex(t[i]),a=he.Transaction.SIGHASH_ALL;if(r){a=he.Transaction.SIGHASH_ALL|he.Transaction.SIGHASH_BITCOINCASHBIP143;let c=he.payments.p2pkh({input:s.script}),u=he.payments.p2pkh({pubkey:c.pubkey,signature:he.script.signature.encode(o,a)});u.input&&(s.script=u.input)}else{let c;if(s.witness.length===2)c="segwit_native";else if(s.witness.length===1)c="segwit_taproot";else if(s.witness.length===0)c="legacy";else throw Error("unknown witness length");if(c==="legacy"){let u=he.payments.p2pkh({input:s.script}),d=he.payments.p2pkh({pubkey:u.pubkey,signature:he.script.signature.encode(o,a)});d.input&&(s.script=d.input)}else c==="segwit_taproot"?s.witness=[o]:s.witness[0]=he.script.signature.encode(o,a)}}return n.toHex()}re.getMPCTransaction=ix;function sx(e,t,r){let n=I1.Transaction.fromBuffer(z.base.fromHex(e),!1);if(!t)return n;for(let i=0;i<n.ins.length;i++){let s=n.ins[i],o=t[i],a;if(s.witness.length===2)a="segwit_native";else if(s.witness.length===1)a="segwit_taproot";else if(s.witness.length===0)a="legacy";else throw Error("unknown witness length");if(a==="legacy"){let c=Ji.decompile(s.script),u=c[0],d=c[1],f=he.script.signature.decode(u),b=he.address.toOutputScript(o.address,r),m=n.hashForSignature(i,b,f.hashType);if(!bc.signUtil.secp256k1.verifyWithNoRecovery(m,f.signature,d))throw Error("signature error")}else if(a==="segwit_native"){let c=s.witness[0],u=s.witness[1],d=he.script.signature.decode(c),f=p.Buffer.of(25,118,169,20,...B1.hash160(u),136,172),b=n.hashForWitness(i,f,o.value,d.hashType);if(!bc.signUtil.secp256k1.verifyWithNoRecovery(b,d.signature,u))throw Error("signature error")}else{let c=s.witness[0],u=t.map(m=>he.address.toOutputScript(m.address,r)),d=t.map(m=>m.value),f=n.hashForWitnessV1(i,u,d,he.Transaction.SIGHASH_DEFAULT),b=M1.taprootTweakPubkey(z.base.fromHex(o.publicKey).slice(1))[0];if(!C1.verify(z.base.toHex(c),z.base.toHex(f),z.base.toHex(b)))throw Error("signature error")}}for(let i of n.ins)i.hash=z.base.reverseBuffer(i.hash);return n}re.ValidSignedTransaction=sx;function ox(e,t){let r=e.inputs,n=e.outputs,i=e.feePerB||10,s=e.dustSize||546;t=t||he.networks.bitcoin;let o=yc(z.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),t),{virtualSize:a}=ef(r,n,e.address,o,t,s,!1,e.memo);return Math.ceil(a*i)}re.estimateBtcFee=ox;function ax(e,t){let r=e.inputs,n=e.outputs,i=e.feePerB||10,s=e.dustSize||546;t=t||he.networks.bitcoin;let o=yc(z.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),t),{virtualSize:a}=nh(r,n,e.address,o,t,s);return a*i}re.estimateBchFee=ax;function H1(e){let t,r;return e==="segwit_taproot"?t=[p.Buffer.alloc(64)]:e==="legacy"?r=p.Buffer.alloc(107):(t=[p.Buffer.alloc(72),p.Buffer.alloc(33)],e==="segwit_nested"&&(r=p.Buffer.alloc(23))),{witness:t,script:r}}re.fakeSign=H1});var Si=H(ks=>{w();S();Object.defineProperty(ks,"__esModule",{value:!0});ks.taprootSignSighash=ks.taprootTweakPubkey=ks.taprootTweakPrivKey=void 0;var cx=ti(),N1=le(),ux=tn(),sh=cx.signUtil.schnorr.secp256k1,tf=sh.schnorr,R1=sh.secp256k1.ProjectivePoint,ih=sh.secp256k1.CURVE.n;function U1(e,t){let r=tf.utils,n=r.taggedHash("TapTweak",e,t),i=r.bytesToNumberBE(n);if(i>=ih)throw new Error("tweak higher than curve order");return i}function q1(e,t=new Uint8Array){let r=tf.utils,n=r.bytesToNumberBE(e),i=R1.fromPrivateKey(n),s=i.hasEvenY()?n:r.mod(-n,ih),o=r.pointToBytes(i),a=U1(o,t);return r.numberToBytesBE(r.mod(s+a,ih),32)}ks.taprootTweakPrivKey=q1;function fx(e,t){t||(t=new Uint8Array);let r=tf.utils,n=U1(e,t),s=r.lift_x(r.bytesToNumberBE(e)).add(R1.fromPrivateKey(n)),o=s.hasEvenY()?0:1;return[r.pointToBytes(s),o]}ks.taprootTweakPubkey=fx;function dx(e,t,r){let n=q1(N1.base.fromHex((0,ux.privateKeyFromWIF)(e)));return t.map(s=>{let o=p.Buffer.from(tf.sign(s,n,r));return N1.base.toHex(o)})}ks.taprootSignSighash=dx});var rf=H(We=>{w();S();var lx=We&&We.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),hx=We&&We.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),px=We&&We.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&lx(t,e,r);return hx(t,e),t};Object.defineProperty(We,"__esModule",{value:!0});We.tweakKey=We.tapTweakHash=We.tapleafHash=We.findScriptPath=We.toHashTree=We.rootHashFromPath=We.MAX_TAPTREE_DEPTH=We.LEAF_VERSION_TAPSCRIPT=void 0;var Hs=La(),uh=px(vr()),L1=ls(),bx=Or(),gx=Si();We.LEAF_VERSION_TAPSCRIPT=192;We.MAX_TAPTREE_DEPTH=128;var yx=e=>"left"in e&&"right"in e;function mx(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);let r=(e.length-33)/32,n=t;for(let i=0;i<r;i++){let s=e.slice(33+32*i,65+32*i);n.compare(s)<0?n=ch(n,s):n=ch(s,n)}return n}We.rootHashFromPath=mx;function oh(e){if((0,bx.isTapleaf)(e))return{hash:K1(e)};let t=[oh(e[0]),oh(e[1])];t.sort((i,s)=>i.hash.compare(s.hash));let[r,n]=t;return{hash:ch(r.hash,n.hash),left:r,right:n}}We.toHashTree=oh;function ah(e,t){if(yx(e)){let r=ah(e.left,t);if(r!==void 0)return[...r,e.right.hash];let n=ah(e.right,t);if(n!==void 0)return[...n,e.left.hash]}else if(e.hash.equals(t))return[]}We.findScriptPath=ah;function K1(e){let t=e.version||We.LEAF_VERSION_TAPSCRIPT;return uh.taggedHash("TapLeaf",Hs.Buffer.concat([Hs.Buffer.from([t]),wx(e.output)]))}We.tapleafHash=K1;function _x(e,t){return uh.taggedHash("TapTweak",Hs.Buffer.concat(t?[e,t]:[e]))}We.tapTweakHash=_x;function vx(e,t){if(!Hs.Buffer.isBuffer(e)||e.length!==32||t&&t.length!==32)return null;let r=(0,gx.taprootTweakPubkey)(e,t);return{parity:r[1],x:Hs.Buffer.from(r[0])}}We.tweakKey=vx;function ch(e,t){return uh.taggedHash("TapBranch",Hs.Buffer.concat([e,t]))}function wx(e){let t=L1.varuint.encodingLength(e.length),r=Hs.Buffer.allocUnsafe(t);return L1.varuint.encode(e.length,r),Hs.Buffer.concat([r,e])}});var G1=H(xi=>{w();S();var Sx=xi&&xi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),xx=xi&&xi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),F1=xi&&xi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Sx(t,e,r);return xx(t,e),t};Object.defineProperty(xi,"__esModule",{value:!0});xi.p2tr=void 0;var nf=La(),Px=pn(),fh=F1(Ft()),_e=Or(),nn=rf(),En=F1(Ui()),sf=le(),D1=fh.OPS,j1=1,Tx=80;function Ex(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,_e.typeforce)({address:_e.typeforce.maybe(_e.typeforce.String),input:_e.typeforce.maybe(_e.typeforce.BufferN(0)),network:_e.typeforce.maybe(_e.typeforce.Object),output:_e.typeforce.maybe(_e.typeforce.BufferN(34)),internalPubkey:_e.typeforce.maybe(_e.typeforce.BufferN(32)),hash:_e.typeforce.maybe(_e.typeforce.BufferN(32)),pubkey:_e.typeforce.maybe(_e.typeforce.BufferN(32)),witness:_e.typeforce.maybe(_e.typeforce.arrayOf(_e.typeforce.Buffer)),scriptTree:_e.typeforce.maybe(_e.isTaptree),redeem:_e.typeforce.maybe({output:_e.typeforce.maybe(_e.typeforce.Buffer),redeemVersion:_e.typeforce.maybe(_e.typeforce.Number),witness:_e.typeforce.maybe(_e.typeforce.arrayOf(_e.typeforce.Buffer))}),redeemVersion:_e.typeforce.maybe(_e.typeforce.Number)},e);let r=En.value(()=>{let a=sf.base.bech32m.decode(e.address),c=a.words.shift(),u=sf.base.bech32m.fromWords(a.words);return{version:c,prefix:a.prefix,data:nf.Buffer.from(u)}}),n=En.value(()=>{if(!(!e.witness||!e.witness.length))return e.witness.length>=2&&e.witness[e.witness.length-1][0]===Tx?e.witness.slice(0,-1):e.witness.slice()}),i=En.value(()=>{if(e.scriptTree)return(0,nn.toHashTree)(e.scriptTree);if(e.hash)return{hash:e.hash}}),s=e.network||Px.bitcoin,o={name:"p2tr",network:s};if(En.prop(o,"address",()=>{if(!o.pubkey)return;let a=sf.base.bech32m.toWords(o.pubkey);return a.unshift(j1),sf.base.bech32m.encode(s.bech32,a)}),En.prop(o,"hash",()=>{let a=i();if(a)return a.hash;let c=n();if(c&&c.length>1){let u=c[c.length-1],d=u[0]&_e.TAPLEAF_VERSION_MASK,f=c[c.length-2],b=(0,nn.tapleafHash)({output:f,version:d});return(0,nn.rootHashFromPath)(u,b)}return null}),En.prop(o,"output",()=>{if(!!o.pubkey)return fh.compile([D1.OP_1,o.pubkey])}),En.prop(o,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&e.redeem.redeemVersion!==void 0&&e.redeem.redeemVersion!==null?e.redeem.redeemVersion:nn.LEAF_VERSION_TAPSCRIPT),En.prop(o,"redeem",()=>{let a=n();if(!(!a||a.length<2))return{output:a[a.length-2],witness:a.slice(0,-2),redeemVersion:a[a.length-1][0]&_e.TAPLEAF_VERSION_MASK}}),En.prop(o,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return r().data;if(o.internalPubkey){let a=(0,nn.tweakKey)(o.internalPubkey,o.hash);if(a)return a.x}}),En.prop(o,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;let a=n();if(a&&a.length>1)return a[a.length-1].slice(1,33)}),En.prop(o,"signature",()=>{if(e.signature)return e.signature;let a=n();if(!(!a||a.length!==1))return a[0]}),En.prop(o,"witness",()=>{if(e.witness)return e.witness;let a=i();if(a&&e.redeem&&e.redeem.output&&e.internalPubkey){let c=(0,nn.tapleafHash)({output:e.redeem.output,version:o.redeemVersion}),u=(0,nn.findScriptPath)(a,c);if(!u)return;let d=(0,nn.tweakKey)(e.internalPubkey,a.hash);if(!d)return;let f=nf.Buffer.concat([nf.Buffer.from([o.redeemVersion|d.parity]),e.internalPubkey].concat(u));return[e.redeem.output,f]}if(e.signature)return[e.signature]}),t.validate){let a=nf.Buffer.from([]);if(e.address){if(s&&s.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==j1)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");a=r().data}if(e.pubkey){if(a.length>0&&!a.equals(e.pubkey))throw new TypeError("Pubkey mismatch");a=e.pubkey}if(e.output){if(e.output.length!==34||e.output[0]!==D1.OP_1||e.output[1]!==32)throw new TypeError("Output is invalid");if(a.length>0&&!a.equals(e.output.slice(2)))throw new TypeError("Pubkey mismatch");a=e.output.slice(2)}if(e.internalPubkey){let d=(0,nn.tweakKey)(e.internalPubkey,o.hash);if(a.length>0&&!a.equals(d.x))throw new TypeError("Pubkey mismatch");a=d.x}if(a&&a.length&&a.length!==32)throw new TypeError("Invalid pubkey for p2tr");let c=i();if(e.hash&&c&&!e.hash.equals(c.hash))throw new TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&c){let d=(0,nn.tapleafHash)({output:e.redeem.output,version:o.redeemVersion});if(!(0,nn.findScriptPath)(c,d))throw new TypeError("Redeem script not in tree")}let u=n();if(e.redeem&&o.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==o.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(fh.decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(o.redeem.output&&!e.redeem.output.equals(o.redeem.output))throw new TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&o.redeem.witness&&!Ax(e.redeem.witness,o.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(u&&u.length)if(u.length===1){if(e.signature&&!e.signature.equals(u[0]))throw new TypeError("Signature mismatch")}else{let d=u[u.length-1];if(d.length<33)throw new TypeError(`The control-block length is too small. Got ${d.length}, expected min 33.`);if((d.length-33)%32!==0)throw new TypeError(`The control-block length of ${d.length} is incorrect!`);let f=(d.length-33)/32;if(f>128)throw new TypeError(`The script path is too long. Got ${f}, expected max 128.`);let b=d.slice(1,33);if(e.internalPubkey&&!e.internalPubkey.equals(b))throw new TypeError("Internal pubkey mismatch");if(b.length!==32)throw new TypeError("Invalid internalPubkey for p2tr witness");let m=d[0]&_e.TAPLEAF_VERSION_MASK,y=u[u.length-2],_=(0,nn.tapleafHash)({output:y,version:m}),E=(0,nn.rootHashFromPath)(d,_),I=(0,nn.tweakKey)(b,E);if(!I)throw new TypeError("Invalid outputKey for p2tr witness");if(a.length&&!a.equals(I.x))throw new TypeError("Pubkey mismatch for p2tr witness");if(I.parity!==(d[0]&1))throw new Error("Incorrect parity")}}return Object.assign(o,e)}xi.p2tr=Ex;function Ax(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}});var Ns=H(lr=>{w();S();Object.defineProperty(lr,"__esModule",{value:!0});lr.p2tr=lr.p2wsh=lr.p2wpkh=lr.p2sh=lr.p2pkh=lr.p2pk=lr.p2ms=lr.embed=void 0;var Ix=mp();Object.defineProperty(lr,"embed",{enumerable:!0,get:function(){return Ix.p2data}});var Ox=wp();Object.defineProperty(lr,"p2ms",{enumerable:!0,get:function(){return Ox.p2ms}});var Bx=Pp();Object.defineProperty(lr,"p2pk",{enumerable:!0,get:function(){return Bx.p2pk}});var Mx=Ip();Object.defineProperty(lr,"p2pkh",{enumerable:!0,get:function(){return Mx.p2pkh}});var Cx=Mp();Object.defineProperty(lr,"p2sh",{enumerable:!0,get:function(){return Cx.p2sh}});var kx=kp();Object.defineProperty(lr,"p2wpkh",{enumerable:!0,get:function(){return kx.p2wpkh}});var Hx=Rp();Object.defineProperty(lr,"p2wsh",{enumerable:!0,get:function(){return Hx.p2wsh}});var Nx=G1();Object.defineProperty(lr,"p2tr",{enumerable:!0,get:function(){return Nx.p2tr}})});var ba=H(zt=>{w();S();var Rx=zt&&zt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ux=zt&&zt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),af=zt&&zt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Rx(t,e,r);return Ux(t,e),t};Object.defineProperty(zt,"__esModule",{value:!0});zt.toOutputScript=zt.fromOutputScript=zt.toBech32=zt.toBase58Check=zt.fromBech32=zt.fromBase58Check=void 0;var V1=af(pn()),Pi=af(Ns()),W1=af(Ft()),of=af(Or()),Rs=le(),{typeforce:qx}=of,z1=40,X1=2,Y1=16,$1=2,Z1=80,J1="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.";function Lx(e,t){let r=e.slice(2);if(r.length<X1||r.length>z1)throw new TypeError("Invalid program length for segwit address");let n=e[0]-Z1;if(n<$1||n>Y1)throw new TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw new TypeError("Invalid script for segwit address");return console.warn(J1),tm(r,n,t.bech32)}function Q1(e){let t=Rs.base.fromBase58Check(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");let r=t.readUInt8(0),n=t.slice(1);return{version:r,hash:n}}zt.fromBase58Check=Q1;function em(e){let t,r;try{t=Rs.base.bech32.decode(e)}catch{}if(t){if(r=t.words[0],r!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=Rs.base.bech32m.decode(e),r=t.words[0],r===0)throw new TypeError(e+" uses wrong encoding");let n=Rs.base.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:p.Buffer.from(n)}}zt.fromBech32=em;function Kx(e,t){qx(of.tuple(of.Hash160bit,of.UInt8),arguments);let r=p.Buffer.allocUnsafe(21);return r.writeUInt8(t,0),e.copy(r,1),Rs.base.toBase58Check(r)}zt.toBase58Check=Kx;function tm(e,t,r){let n=Rs.base.bech32.toWords(e);return n.unshift(t),t===0?Rs.base.bech32.encode(r,n):Rs.base.bech32m.encode(r,n)}zt.toBech32=tm;function Dx(e,t){t=t||V1.bitcoin;try{return Pi.p2pkh({output:e,network:t}).address}catch{}try{return Pi.p2sh({output:e,network:t}).address}catch{}try{return Pi.p2wpkh({output:e,network:t}).address}catch{}try{return Pi.p2wsh({output:e,network:t}).address}catch{}try{return Pi.p2tr({output:e,network:t}).address}catch{}try{return Lx(e,t)}catch{}throw new Error(W1.toASM(e)+" has no matching Address")}zt.fromOutputScript=Dx;function jx(e,t){t=t||V1.bitcoin;let r,n;try{r=Q1(e)}catch{}if(r){if(r.version===t.pubKeyHash)return Pi.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return Pi.p2sh({hash:r.hash}).output}else{try{n=em(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0){if(n.data.length===20)return Pi.p2wpkh({hash:n.data}).output;if(n.data.length===32)return Pi.p2wsh({hash:n.data}).output}else if(n.version===1){if(n.data.length===32)return Pi.p2tr({pubkey:n.data}).output}else if(n.version>=$1&&n.version<=Y1&&n.data.length>=X1&&n.data.length<=z1)return console.warn(J1),W1.compile([n.version+Z1,n.data])}}throw new Error(e+" has no matching Script")}zt.toOutputScript=jx});var qs=H(on=>{w();S();var Fx=on&&on.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Gx=on&&on.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),dh=on&&on.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Fx(t,e,r);return Gx(t,e),t};Object.defineProperty(on,"__esModule",{value:!0});on.Transaction=on.vectorSize=on.varSliceSize=void 0;var ze=ls(),Xt=dh(vr()),rm=dh(Ft()),Vx=Ft(),fe=dh(Or()),{typeforce:ri}=fe;function sn(e){let t=e.length;return ze.varuint.encodingLength(t)+t}on.varSliceSize=sn;function sm(e){let t=e.length;return ze.varuint.encodingLength(t)+e.reduce((r,n)=>r+sn(n),0)}on.vectorSize=sm;var Us=p.Buffer.allocUnsafe(0),nm=[],ga=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),im=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),Wx=p.Buffer.from("ffffffffffffffff","hex"),zx={script:Us,valueBuffer:Wx};function Xx(e){return e.value!==void 0}var J=class{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(t,r){let n=new ze.BufferReader(t),i=new J;i.version=n.readInt32();let s=n.readUInt8(),o=n.readUInt8(),a=!1;s===J.ADVANCED_TRANSACTION_MARKER&&o===J.ADVANCED_TRANSACTION_FLAG?a=!0:n.offset-=2;let c=n.readVarInt();for(let d=0;d<c;++d)i.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:nm});let u=n.readVarInt();for(let d=0;d<u;++d)i.outs.push({value:n.readUInt64(),script:n.readVarSlice()});if(a){for(let d=0;d<c;++d)i.ins[d].witness=n.readVector();if(!i.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(i.locktime=n.readUInt32(),r)return i;if(n.offset!==t.length)throw new Error("Transaction has unexpected data");return i}static fromHex(t){return J.fromBuffer(p.Buffer.from(t,"hex"),!1)}static isCoinbaseHash(t){ri(fe.Hash256bit,t);for(let r=0;r<32;++r)if(t[r]!==0)return!1;return!0}isCoinbase(){return this.ins.length===1&&J.isCoinbaseHash(this.ins[0].hash)}addInput(t,r,n,i){return ri(fe.tuple(fe.Hash256bit,fe.UInt32,fe.maybe(fe.UInt32),fe.maybe(fe.Buffer)),arguments),fe.Null(n)&&(n=J.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:r,script:i||Us,sequence:n,witness:nm})-1}addOutput(t,r){return ri(fe.tuple(fe.Buffer,fe.Satoshi),arguments),this.outs.push({script:t,value:r})-1}hasWitnesses(){return this.ins.some(t=>t.witness.length!==0)}weight(){let t=this.byteLength(!1),r=this.byteLength(!0);return t*3+r}virtualSize(){return Math.ceil(this.weight()/4)}dogeByteLength(){let t=26+this.ins.reduce((r,n)=>{let i=40+sn(n.script);return r+32+4+i},0)+this.outs.reduce((r,n)=>r+9+n.script.length,0);return Math.ceil(t)}byteLength(t=!0){let r=t&&this.hasWitnesses();return(r?10:8)+ze.varuint.encodingLength(this.ins.length)+ze.varuint.encodingLength(this.outs.length)+this.ins.reduce((n,i)=>n+40+sn(i.script),0)+this.outs.reduce((n,i)=>n+8+sn(i.script),0)+(r?this.ins.reduce((n,i)=>n+sm(i.witness),0):0)}clone(){let t=new J;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(r=>({hash:r.hash,index:r.index,script:r.script,sequence:r.sequence,witness:r.witness})),t.outs=this.outs.map(r=>({script:r.script,value:r.value})),t}hashForSignature(t,r,n){if(ri(fe.tuple(fe.UInt32,fe.Buffer,fe.Number),arguments),t>=this.ins.length)return im;let i=rm.compile(rm.decompile(r).filter(a=>a!==Vx.OPS.OP_CODESEPARATOR)),s=this.clone();if((n&31)===J.SIGHASH_NONE)s.outs=[],s.ins.forEach((a,c)=>{c!==t&&(a.sequence=0)});else if((n&31)===J.SIGHASH_SINGLE){if(t>=this.outs.length)return im;s.outs.length=t+1;for(let a=0;a<t;a++)s.outs[a]=zx;s.ins.forEach((a,c)=>{c!==t&&(a.sequence=0)})}n&J.SIGHASH_ANYONECANPAY?(s.ins=[s.ins[t]],s.ins[0].script=i):(s.ins.forEach(a=>{a.script=Us}),s.ins[t].script=i);let o=p.Buffer.allocUnsafe(s.byteLength(!1)+4);return o.writeInt32LE(n,o.length-4),s.__toBuffer(o,0,!1),Xt.hash256(o)}hashForCashSignature(t,r,n,i){if(i&J.SIGHASH_BITCOINCASHBIP143){if(fe.Null(n))throw new Error("Bitcoin Cash sighash requires value of input to be signed.");return this.hashForWitnessV0(t,r,n,i)}else return this.hashForSignature(t,r,i)}hashForWitnessV1(t,r,n,i,s,o){if(ri(fe.tuple(fe.UInt32,ri.arrayOf(fe.Buffer),ri.arrayOf(fe.Satoshi),fe.UInt32),arguments),n.length!==this.ins.length||r.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");let a=i===J.SIGHASH_DEFAULT?J.SIGHASH_ALL:i&J.SIGHASH_OUTPUT_MASK,u=(i&J.SIGHASH_INPUT_MASK)===J.SIGHASH_ANYONECANPAY,d=a===J.SIGHASH_NONE,f=a===J.SIGHASH_SINGLE,b=Us,m=Us,y=Us,_=Us,E=Us;if(!u){let R=ze.BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(N=>{R.writeSlice(N.hash),R.writeUInt32(N.index)}),b=Xt.sha256(R.end()),R=ze.BufferWriter.withCapacity(8*this.ins.length),n.forEach(N=>R.writeUInt64(N)),m=Xt.sha256(R.end()),R=ze.BufferWriter.withCapacity(r.map(sn).reduce((N,U)=>N+U)),r.forEach(N=>R.writeVarSlice(N)),y=Xt.sha256(R.end()),R=ze.BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(N=>R.writeUInt32(N.sequence)),_=Xt.sha256(R.end())}if(d||f){if(f&&t<this.outs.length){let R=this.outs[t],N=ze.BufferWriter.withCapacity(8+sn(R.script));N.writeUInt64(R.value),N.writeVarSlice(R.script),E=Xt.sha256(N.end())}}else{let R=this.outs.map(U=>8+sn(U.script)).reduce((U,q)=>U+q),N=ze.BufferWriter.withCapacity(R);this.outs.forEach(U=>{N.writeUInt64(U.value),N.writeVarSlice(U.script)}),E=Xt.sha256(N.end())}let I=(s?2:0)+(o?1:0),k=174-(u?49:0)-(d?32:0)+(o?32:0)+(s?37:0),C=ze.BufferWriter.withCapacity(k);if(C.writeUInt8(i),C.writeInt32(this.version),C.writeUInt32(this.locktime),C.writeSlice(b),C.writeSlice(m),C.writeSlice(y),C.writeSlice(_),d||f||C.writeSlice(E),C.writeUInt8(I),u){let R=this.ins[t];C.writeSlice(R.hash),C.writeUInt32(R.index),C.writeUInt64(n[t]),C.writeVarSlice(r[t]),C.writeUInt32(R.sequence)}else C.writeUInt32(t);if(o){let R=ze.BufferWriter.withCapacity(sn(o));R.writeVarSlice(o),C.writeSlice(Xt.sha256(R.end()))}return f&&C.writeSlice(E),s&&(C.writeSlice(s),C.writeUInt8(0),C.writeUInt32(4294967295)),Xt.taggedHash("TapSighash",p.Buffer.concat([p.Buffer.of(0),C.end()]))}hashForWitnessV0(t,r,n,i){ri(fe.tuple(fe.UInt32,fe.Buffer,fe.Satoshi,fe.UInt32),arguments);let s=p.Buffer.from([]),o,a=ga,c=ga,u=ga;if(i&J.SIGHASH_ANYONECANPAY||(s=p.Buffer.allocUnsafe(36*this.ins.length),o=new ze.BufferWriter(s,0),this.ins.forEach(f=>{o.writeSlice(f.hash),o.writeUInt32(f.index)}),c=Xt.hash256(s)),!(i&J.SIGHASH_ANYONECANPAY)&&(i&31)!==J.SIGHASH_SINGLE&&(i&31)!==J.SIGHASH_NONE&&(s=p.Buffer.allocUnsafe(4*this.ins.length),o=new ze.BufferWriter(s,0),this.ins.forEach(f=>{o.writeUInt32(f.sequence)}),u=Xt.hash256(s)),(i&31)!==J.SIGHASH_SINGLE&&(i&31)!==J.SIGHASH_NONE){let f=this.outs.reduce((b,m)=>b+8+sn(m.script),0);s=p.Buffer.allocUnsafe(f),o=new ze.BufferWriter(s,0),this.outs.forEach(b=>{o.writeUInt64(b.value),o.writeVarSlice(b.script)}),a=Xt.hash256(s)}else if((i&31)===J.SIGHASH_SINGLE&&t<this.outs.length){let f=this.outs[t];s=p.Buffer.allocUnsafe(8+sn(f.script)),o=new ze.BufferWriter(s,0),o.writeUInt64(f.value),o.writeVarSlice(f.script),a=Xt.hash256(s)}s=p.Buffer.allocUnsafe(156+sn(r)),o=new ze.BufferWriter(s,0);let d=this.ins[t];return o.writeInt32(this.version),o.writeSlice(c),o.writeSlice(u),o.writeSlice(d.hash),o.writeUInt32(d.index),o.writeVarSlice(r),o.writeUInt64(n),o.writeUInt32(d.sequence),o.writeSlice(a),o.writeUInt32(this.locktime),o.writeUInt32(i),Xt.hash256(s)}getHash(t){return t&&this.isCoinbase()?p.Buffer.alloc(32,0):Xt.hash256(this.__toBuffer(void 0,void 0,t))}getId(){return(0,ze.reverseBuffer)(this.getHash(!1)).toString("hex")}toBuffer(t,r){return this.__toBuffer(t,r,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(t,r){ri(fe.tuple(fe.Number,fe.Buffer),arguments),this.ins[t].script=r}setWitness(t,r){ri(fe.tuple(fe.Number,[fe.Buffer]),arguments),this.ins[t].witness=r}__toBuffer(t,r,n=!1){t||(t=p.Buffer.allocUnsafe(this.byteLength(n)));let i=new ze.BufferWriter(t,r||0);i.writeInt32(this.version);let s=n&&this.hasWitnesses();return s&&(i.writeUInt8(J.ADVANCED_TRANSACTION_MARKER),i.writeUInt8(J.ADVANCED_TRANSACTION_FLAG)),i.writeVarInt(this.ins.length),this.ins.forEach(o=>{i.writeSlice(o.hash),i.writeUInt32(o.index),i.writeVarSlice(o.script),i.writeUInt32(o.sequence)}),i.writeVarInt(this.outs.length),this.outs.forEach(o=>{Xx(o)?i.writeUInt64(o.value):i.writeSlice(o.valueBuffer),i.writeVarSlice(o.script)}),s&&this.ins.forEach(o=>{i.writeVector(o.witness)}),i.writeUInt32(this.locktime),r!==void 0?t.slice(r,i.offset):t}hashForWitness(t,r,n,i){ri(fe.tuple(fe.UInt32,fe.Buffer,fe.Satoshi,fe.UInt32),arguments);let s=p.Buffer.from([]),o,a=ga,c=ga,u=ga;if(i&J.SIGHASH_ANYONECANPAY||(s=p.Buffer.allocUnsafe(36*this.ins.length),o=new ze.BufferWriter(s,0),this.ins.forEach(f=>{o.writeSlice(f.hash),o.writeUInt32(f.index)}),c=Xt.hash256(s)),!(i&J.SIGHASH_ANYONECANPAY)&&(i&31)!==J.SIGHASH_SINGLE&&(i&31)!==J.SIGHASH_NONE&&(s=p.Buffer.allocUnsafe(4*this.ins.length),o=new ze.BufferWriter(s,0),this.ins.forEach(f=>{o.writeUInt32(f.sequence)}),u=Xt.hash256(s)),(i&31)!==J.SIGHASH_SINGLE&&(i&31)!==J.SIGHASH_NONE){let f=this.outs.reduce((b,m)=>b+8+sn(m.script),0);s=p.Buffer.allocUnsafe(f),o=new ze.BufferWriter(s,0),this.outs.forEach(b=>{o.writeUInt64(b.value),o.writeVarSlice(b.script)}),a=Xt.hash256(s)}else if((i&31)===J.SIGHASH_SINGLE&&t<this.outs.length){let f=this.outs[t];s=p.Buffer.allocUnsafe(8+sn(f.script)),o=new ze.BufferWriter(s,0),o.writeUInt64(f.value),o.writeVarSlice(f.script),a=Xt.hash256(s)}s=p.Buffer.allocUnsafe(156+r.length),o=new ze.BufferWriter(s,0);let d=this.ins[t];return o.writeInt32(this.version),o.writeSlice(c),o.writeSlice(u),o.writeSlice(d.hash),o.writeUInt32(d.index),o.writeSlice(r),o.writeUInt64(n),o.writeUInt32(d.sequence),o.writeSlice(a),o.writeUInt32(this.locktime),o.writeUInt32(i),Xt.hash256(s)}};on.Transaction=J;J.DEFAULT_SEQUENCE=4294967295;J.SIGHASH_DEFAULT=0;J.SIGHASH_ALL=1;J.SIGHASH_NONE=2;J.SIGHASH_SINGLE=3;J.SIGHASH_ANYONECANPAY=128;J.SIGHASH_OUTPUT_MASK=3;J.SIGHASH_INPUT_MASK=128;J.SIGHASH_BITCOINCASHBIP143=64;J.ADVANCED_TRANSACTION_MARKER=0;J.ADVANCED_TRANSACTION_FLAG=1});var hr=H(Tr=>{w();S();Object.defineProperty(Tr,"__esModule",{value:!0});Tr.OUTPUT_TYPE_NAMES=Tr.OutputTypes=Tr.INPUT_TYPE_NAMES=Tr.InputTypes=Tr.GLOBAL_TYPE_NAMES=Tr.GlobalTypes=void 0;var Yx;(function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"})(Yx=Tr.GlobalTypes||(Tr.GlobalTypes={}));Tr.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"];var $x;(function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"})($x=Tr.InputTypes||(Tr.InputTypes={}));Tr.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"];var Zx;(function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"})(Zx=Tr.OutputTypes||(Tr.OutputTypes={}));Tr.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"]});var am=H(An=>{w();S();Object.defineProperty(An,"__esModule",{value:!0});An.canAddToArray=An.check=An.expected=An.encode=An.decode=void 0;var om=hr(),Jx=e=>[...Array(e).keys()];function Qx(e){if(e.key[0]!==om.GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"));if(e.key.length!==79||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");let t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(let n of Jx(e.value.length/4-1)){let i=e.value.readUInt32LE(n*4+4),s=!!(i&2147483648),o=i&2147483647;r.path+="/"+o.toString(10)+(s?"'":"")}return r}An.decode=Qx;function eP(e){let t=p.Buffer.from([om.GlobalTypes.GLOBAL_XPUB]),r=p.Buffer.concat([t,e.extendedPubkey]),n=e.path.split("/"),i=p.Buffer.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let s=4;return n.slice(1).forEach(o=>{let a=o.slice(-1)==="'",c=2147483647&parseInt(a?o.slice(0,-1):o,10);a&&(c+=2147483648),i.writeUInt32LE(c,s),s+=4}),{key:r,value:i}}An.encode=eP;An.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }";function tP(e){let t=e.extendedPubkey,r=e.masterFingerprint,n=e.path;return p.Buffer.isBuffer(t)&&t.length===78&&[2,3].indexOf(t[45])>-1&&p.Buffer.isBuffer(r)&&r.length===4&&typeof n=="string"&&!!n.match(/^m(\/\d+'?)*$/)}An.check=tP;function rP(e,t,r){let n=t.extendedPubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.extendedPubkey.equals(t.extendedPubkey)).length===0)}An.canAddToArray=rP});var cm=H(cf=>{w();S();Object.defineProperty(cf,"__esModule",{value:!0});cf.encode=void 0;var nP=hr();function iP(e){return{key:p.Buffer.from([nP.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}cf.encode=iP});var fm=H(In=>{w();S();Object.defineProperty(In,"__esModule",{value:!0});In.canAdd=In.check=In.expected=In.encode=In.decode=void 0;var um=hr();function sP(e){if(e.key[0]!==um.InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"));return e.value}In.decode=sP;function oP(e){return{key:p.Buffer.from([um.InputTypes.FINAL_SCRIPTSIG]),value:e}}In.encode=oP;In.expected="Buffer";function aP(e){return p.Buffer.isBuffer(e)}In.check=aP;function cP(e,t){return!!e&&!!t&&e.finalScriptSig===void 0}In.canAdd=cP});var lm=H(On=>{w();S();Object.defineProperty(On,"__esModule",{value:!0});On.canAdd=On.check=On.expected=On.encode=On.decode=void 0;var dm=hr();function uP(e){if(e.key[0]!==dm.InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"));return e.value}On.decode=uP;function fP(e){return{key:p.Buffer.from([dm.InputTypes.FINAL_SCRIPTWITNESS]),value:e}}On.encode=fP;On.expected="Buffer";function dP(e){return p.Buffer.isBuffer(e)}On.check=dP;function lP(e,t){return!!e&&!!t&&e.finalScriptWitness===void 0}On.canAdd=lP});var pm=H(Bn=>{w();S();Object.defineProperty(Bn,"__esModule",{value:!0});Bn.canAdd=Bn.check=Bn.expected=Bn.encode=Bn.decode=void 0;var hm=hr();function hP(e){if(e.key[0]!==hm.InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"));return e.value}Bn.decode=hP;function pP(e){return{key:p.Buffer.from([hm.InputTypes.NON_WITNESS_UTXO]),value:e}}Bn.encode=pP;Bn.expected="Buffer";function bP(e){return p.Buffer.isBuffer(e)}Bn.check=bP;function gP(e,t){return!!e&&!!t&&e.nonWitnessUtxo===void 0}Bn.canAdd=gP});var gm=H(Mn=>{w();S();Object.defineProperty(Mn,"__esModule",{value:!0});Mn.canAddToArray=Mn.check=Mn.expected=Mn.encode=Mn.decode=void 0;var bm=hr();function yP(e){if(e.key[0]!==bm.InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"));if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"));return{pubkey:e.key.slice(1),signature:e.value}}Mn.decode=yP;function mP(e){let t=p.Buffer.from([bm.InputTypes.PARTIAL_SIG]);return{key:p.Buffer.concat([t,e.pubkey]),value:e.signature}}Mn.encode=mP;Mn.expected="{ pubkey: Buffer; signature: Buffer; }";function _P(e){return p.Buffer.isBuffer(e.pubkey)&&p.Buffer.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&vP(e.signature)}Mn.check=_P;function vP(e){if(!p.Buffer.isBuffer(e)||e.length<9||e[0]!==48||e.length!==e[1]+3||e[2]!==2)return!1;let t=e[3];if(t>33||t<1||e[3+t+1]!==2)return!1;let r=e[3+t+2];return!(r>33||r<1||e.length!==3+t+2+r+2)}function wP(e,t,r){let n=t.pubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)).length===0)}Mn.canAddToArray=wP});var mm=H(Cn=>{w();S();Object.defineProperty(Cn,"__esModule",{value:!0});Cn.canAdd=Cn.check=Cn.expected=Cn.encode=Cn.decode=void 0;var ym=hr();function SP(e){if(e.key[0]!==ym.InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"));return e.value.toString("utf8")}Cn.decode=SP;function xP(e){return{key:p.Buffer.from([ym.InputTypes.POR_COMMITMENT]),value:p.Buffer.from(e,"utf8")}}Cn.encode=xP;Cn.expected="string";function PP(e){return typeof e=="string"}Cn.check=PP;function TP(e,t){return!!e&&!!t&&e.porCommitment===void 0}Cn.canAdd=TP});var vm=H(kn=>{w();S();Object.defineProperty(kn,"__esModule",{value:!0});kn.canAdd=kn.check=kn.expected=kn.encode=kn.decode=void 0;var _m=hr();function EP(e){if(e.key[0]!==_m.InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"));return e.value.readUInt32LE(0)}kn.decode=EP;function AP(e){let t=p.Buffer.from([_m.InputTypes.SIGHASH_TYPE]),r=p.Buffer.allocUnsafe(4);return r.writeUInt32LE(e,0),{key:t,value:r}}kn.encode=AP;kn.expected="number";function IP(e){return typeof e=="number"}kn.check=IP;function OP(e,t){return!!e&&!!t&&e.sighashType===void 0}kn.canAdd=OP});var xm=H(Hn=>{w();S();Object.defineProperty(Hn,"__esModule",{value:!0});Hn.canAdd=Hn.check=Hn.expected=Hn.encode=Hn.decode=void 0;var wm=hr();function BP(e){if(e.key[0]!==wm.InputTypes.TAP_KEY_SIG||e.key.length!==1)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+e.key.toString("hex"));if(!Sm(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}Hn.decode=BP;function MP(e){return{key:p.Buffer.from([wm.InputTypes.TAP_KEY_SIG]),value:e}}Hn.encode=MP;Hn.expected="Buffer";function Sm(e){return p.Buffer.isBuffer(e)&&(e.length===64||e.length===65)}Hn.check=Sm;function CP(e,t){return!!e&&!!t&&e.tapKeySig===void 0}Hn.canAdd=CP});var Tm=H(Nn=>{w();S();Object.defineProperty(Nn,"__esModule",{value:!0});Nn.canAddToArray=Nn.check=Nn.expected=Nn.encode=Nn.decode=void 0;var Pm=hr();function kP(e){if(e.key[0]!==Pm.InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+e.key.toString("hex"));if((e.key.length-2)%32!==0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+e.key.toString("hex"));let t=e.value[e.value.length-1];if((e.key[1]&254)!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+e.key.toString("hex"));let r=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:r,leafVersion:t}}Nn.decode=kP;function HP(e){let t=p.Buffer.from([Pm.InputTypes.TAP_LEAF_SCRIPT]),r=p.Buffer.from([e.leafVersion]);return{key:p.Buffer.concat([t,e.controlBlock]),value:p.Buffer.concat([e.script,r])}}Nn.encode=HP;Nn.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }";function NP(e){return p.Buffer.isBuffer(e.controlBlock)&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&p.Buffer.isBuffer(e.script)}Nn.check=NP;function RP(e,t,r){let n=t.controlBlock.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.controlBlock.equals(t.controlBlock)).length===0)}Nn.canAddToArray=RP});var Im=H(Rn=>{w();S();Object.defineProperty(Rn,"__esModule",{value:!0});Rn.canAdd=Rn.check=Rn.expected=Rn.encode=Rn.decode=void 0;var Em=hr();function UP(e){if(e.key[0]!==Em.InputTypes.TAP_MERKLE_ROOT||e.key.length!==1)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+e.key.toString("hex"));if(!Am(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}Rn.decode=UP;function qP(e){return{key:p.Buffer.from([Em.InputTypes.TAP_MERKLE_ROOT]),value:e}}Rn.encode=qP;Rn.expected="Buffer";function Am(e){return p.Buffer.isBuffer(e)&&e.length===32}Rn.check=Am;function LP(e,t){return!!e&&!!t&&e.tapMerkleRoot===void 0}Rn.canAdd=LP});var Bm=H(Un=>{w();S();Object.defineProperty(Un,"__esModule",{value:!0});Un.canAddToArray=Un.check=Un.expected=Un.encode=Un.decode=void 0;var Om=hr();function KP(e){if(e.key[0]!==Om.InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+e.key.toString("hex"));if(e.key.length!==65)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+e.key.toString("hex"));if(e.value.length!==64&&e.value.length!==65)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+e.key.toString("hex"));let t=e.key.slice(1,33),r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}Un.decode=KP;function DP(e){let t=p.Buffer.from([Om.InputTypes.TAP_SCRIPT_SIG]);return{key:p.Buffer.concat([t,e.pubkey,e.leafHash]),value:e.signature}}Un.encode=DP;Un.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }";function jP(e){return p.Buffer.isBuffer(e.pubkey)&&p.Buffer.isBuffer(e.leafHash)&&p.Buffer.isBuffer(e.signature)&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}Un.check=jP;function FP(e,t,r){let n=t.pubkey.toString("hex")+t.leafHash.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)&&i.leafHash.equals(t.leafHash)).length===0)}Un.canAddToArray=FP});var Ks=H(Ls=>{w();S();Object.defineProperty(Ls,"__esModule",{value:!0});Ls.encodingLength=Ls.decode=Ls.encode=void 0;var GP=9007199254740991;function lh(e){if(e<0||e>GP||e%1!==0)throw new RangeError("value out of range")}function mc(e,t,r){if(lh(e),t||(t=p.Buffer.allocUnsafe(Mm(e))),!p.Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),Object.assign(mc,{bytes:1})):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),Object.assign(mc,{bytes:3})):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),Object.assign(mc,{bytes:5})):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),Object.assign(mc,{bytes:9})),t}Ls.encode=mc;function _c(e,t){if(!p.Buffer.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);let r=e.readUInt8(t);if(r<253)return Object.assign(_c,{bytes:1}),r;if(r===253)return Object.assign(_c,{bytes:3}),e.readUInt16LE(t+1);if(r===254)return Object.assign(_c,{bytes:5}),e.readUInt32LE(t+1);{Object.assign(_c,{bytes:9});let n=e.readUInt32LE(t+1),s=e.readUInt32LE(t+5)*4294967296+n;return lh(s),s}}Ls.decode=_c;function Mm(e){return lh(e),e<253?1:e<=65535?3:e<=4294967295?5:9}Ls.encodingLength=Mm});var ff=H(Yt=>{w();S();var VP=Yt&&Yt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),WP=Yt&&Yt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),zP=Yt&&Yt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&VP(t,e,r);return WP(t,e),t};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.writeUInt64LE=Yt.readUInt64LE=Yt.keyValToBuffer=Yt.keyValsToBuffer=Yt.reverseBuffer=Yt.range=void 0;var uf=zP(Ks()),XP=e=>[...Array(e).keys()];Yt.range=XP;function YP(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Yt.reverseBuffer=YP;function $P(e){let t=e.map(Cm);return t.push(p.Buffer.from([0])),p.Buffer.concat(t)}Yt.keyValsToBuffer=$P;function Cm(e){let t=e.key.length,r=e.value.length,n=uf.encodingLength(t),i=uf.encodingLength(r),s=p.Buffer.allocUnsafe(n+t+i+r);return uf.encode(t,s,0),e.key.copy(s,n),uf.encode(r,s,n+t),e.value.copy(s,n+t+i),s}Yt.keyValToBuffer=Cm;function km(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function ZP(e,t){let r=e.readUInt32LE(t),n=e.readUInt32LE(t+4);return n*=4294967296,km(n+r,9007199254740991),n+r}Yt.readUInt64LE=ZP;function JP(e,t,r){return km(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}Yt.writeUInt64LE=JP});var Rm=H(pr=>{w();S();var QP=pr&&pr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),eT=pr&&pr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),tT=pr&&pr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&QP(t,e,r);return eT(t,e),t};Object.defineProperty(pr,"__esModule",{value:!0});pr.canAdd=pr.check=pr.expected=pr.encode=pr.decode=void 0;var Hm=hr(),Nm=ff(),df=tT(Ks());function rT(e){if(e.key[0]!==Hm.InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"));let t=(0,Nm.readUInt64LE)(e.value,0),r=8,n=df.decode(e.value,r);r+=df.encodingLength(n);let i=e.value.slice(r);if(i.length!==n)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:i,value:t}}pr.decode=rT;function nT(e){let{script:t,value:r}=e,n=df.encodingLength(t.length),i=p.Buffer.allocUnsafe(8+n+t.length);return(0,Nm.writeUInt64LE)(i,r,0),df.encode(t.length,i,8),t.copy(i,8+n),{key:p.Buffer.from([Hm.InputTypes.WITNESS_UTXO]),value:i}}pr.encode=nT;pr.expected="{ script: Buffer; value: number; }";function iT(e){return p.Buffer.isBuffer(e.script)&&typeof e.value=="number"}pr.check=iT;function sT(e,t){return!!e&&!!t&&e.witnessUtxo===void 0}pr.canAdd=sT});var qm=H(br=>{w();S();var oT=br&&br.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),aT=br&&br.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cT=br&&br.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&oT(t,e,r);return aT(t,e),t};Object.defineProperty(br,"__esModule",{value:!0});br.canAdd=br.check=br.expected=br.encode=br.decode=void 0;var Um=hr(),hh=cT(Ks());function uT(e){if(e.key[0]!==Um.OutputTypes.TAP_TREE||e.key.length!==1)throw new Error("Decode Error: could not decode tapTree with key 0x"+e.key.toString("hex"));let t=0,r=[];for(;t<e.value.length;){let n=e.value[t++],i=e.value[t++],s=hh.decode(e.value,t);t+=hh.encodingLength(s),r.push({depth:n,leafVersion:i,script:e.value.slice(t,t+s)}),t+=s}return{leaves:r}}br.decode=uT;function fT(e){let t=p.Buffer.from([Um.OutputTypes.TAP_TREE]),r=[].concat(...e.leaves.map(n=>[p.Buffer.of(n.depth,n.leafVersion),hh.encode(n.script.length),n.script]));return{key:t,value:p.Buffer.concat(r)}}br.encode=fT;br.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }";function dT(e){return Array.isArray(e.leaves)&&e.leaves.every(t=>t.depth>=0&&t.depth<=128&&(t.leafVersion&254)===t.leafVersion&&p.Buffer.isBuffer(t.script))}br.check=dT;function lT(e,t){return!!e&&!!t&&e.tapTree===void 0}br.canAdd=lT});var ph=H(lf=>{w();S();Object.defineProperty(lf,"__esModule",{value:!0});lf.makeConverter=void 0;var hT=e=>[...Array(e).keys()],pT=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function bT(e,t=pT){function r(a){if(a.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+a.key.toString("hex"));let c=a.key.slice(1);if(!t(c))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+a.key.toString("hex"));if(a.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");let u={masterFingerprint:a.value.slice(0,4),pubkey:c,path:"m"};for(let d of hT(a.value.length/4-1)){let f=a.value.readUInt32LE(d*4+4),b=!!(f&2147483648),m=f&2147483647;u.path+="/"+m.toString(10)+(b?"'":"")}return u}function n(a){let c=p.Buffer.from([e]),u=p.Buffer.concat([c,a.pubkey]),d=a.path.split("/"),f=p.Buffer.allocUnsafe(d.length*4);a.masterFingerprint.copy(f,0);let b=4;return d.slice(1).forEach(m=>{let y=m.slice(-1)==="'",_=2147483647&parseInt(y?m.slice(0,-1):m,10);y&&(_+=2147483648),f.writeUInt32LE(_,b),b+=4}),{key:u,value:f}}let i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }";function s(a){return p.Buffer.isBuffer(a.pubkey)&&p.Buffer.isBuffer(a.masterFingerprint)&&typeof a.path=="string"&&t(a.pubkey)&&a.masterFingerprint.length===4}function o(a,c,u){let d=c.pubkey.toString("hex");return u.has(d)?!1:(u.add(d),a.filter(f=>f.pubkey.equals(c.pubkey)).length===0)}return{decode:r,encode:n,check:s,expected:i,canAddToArray:o}}lf.makeConverter=bT});var Lm=H(hf=>{w();S();Object.defineProperty(hf,"__esModule",{value:!0});hf.makeChecker=void 0;function gT(e){return t;function t(r){let n;if(e.includes(r.key[0])&&(n=r.key.slice(1),!(n.length===33||n.length===65)||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+r.key.toString("hex"));return n}}hf.makeChecker=gT});var Km=H(pf=>{w();S();Object.defineProperty(pf,"__esModule",{value:!0});pf.makeConverter=void 0;function yT(e){function t(o){if(o.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+o.key.toString("hex"));return o.value}function r(o){return{key:p.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return p.Buffer.isBuffer(o)}function s(o,a){return!!o&&!!a&&o.redeemScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}pf.makeConverter=yT});var jm=H(Ti=>{w();S();var mT=Ti&&Ti.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),_T=Ti&&Ti.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Dm=Ti&&Ti.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&mT(t,e,r);return _T(t,e),t};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.makeConverter=void 0;var bf=Dm(Ks()),vT=Dm(ph()),wT=e=>e.length===32;function ST(e){let t=vT.makeConverter(e,wT);function r(o){let a=bf.decode(o.value),c=bf.encodingLength(a),u=t.decode({key:o.key,value:o.value.slice(c+a*32)}),d=new Array(a);for(let f=0,b=c;f<a;f++,b+=32)d[f]=o.value.slice(b,b+32);return{...u,leafHashes:d}}function n(o){let a=t.encode(o),c=bf.encodingLength(o.leafHashes.length),u=p.Buffer.allocUnsafe(c);bf.encode(o.leafHashes.length,u);let d=p.Buffer.concat([u,...o.leafHashes,a.value]);return{...a,value:d}}let i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; leafHashes: Buffer[]; }";function s(o){return Array.isArray(o.leafHashes)&&o.leafHashes.every(a=>p.Buffer.isBuffer(a)&&a.length===32)&&t.check(o)}return{decode:r,encode:n,check:s,expected:i,canAddToArray:t.canAddToArray}}Ti.makeConverter=ST});var Fm=H(gf=>{w();S();Object.defineProperty(gf,"__esModule",{value:!0});gf.makeConverter=void 0;function xT(e){function t(o){if(o.key[0]!==e||o.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+o.key.toString("hex"));if(o.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return o.value}function r(o){return{key:p.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return p.Buffer.isBuffer(o)&&o.length===32}function s(o,a){return!!o&&!!a&&o.tapInternalKey===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}gf.makeConverter=xT});var Gm=H(yf=>{w();S();Object.defineProperty(yf,"__esModule",{value:!0});yf.makeConverter=void 0;function PT(e){function t(o){if(o.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+o.key.toString("hex"));return o.value}function r(o){return{key:p.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return p.Buffer.isBuffer(o)}function s(o,a){return!!o&&!!a&&o.witnessScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}yf.makeConverter=PT});var mf=H(an=>{w();S();var TT=an&&an.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ET=an&&an.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$t=an&&an.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&TT(t,e,r);return ET(t,e),t};Object.defineProperty(an,"__esModule",{value:!0});an.outputs=an.inputs=an.globals=void 0;var gn=hr(),AT=$t(am()),IT=$t(cm()),OT=$t(fm()),BT=$t(lm()),MT=$t(pm()),CT=$t(gm()),kT=$t(mm()),HT=$t(vm()),NT=$t(xm()),RT=$t(Tm()),UT=$t(Im()),qT=$t(Bm()),LT=$t(Rm()),KT=$t(qm()),Vm=$t(ph()),bh=$t(Lm()),Wm=$t(Km()),zm=$t(jm()),Xm=$t(Fm()),Ym=$t(Gm()),DT={unsignedTx:IT,globalXpub:AT,checkPubkey:bh.makeChecker([])};an.globals=DT;var jT={nonWitnessUtxo:MT,partialSig:CT,sighashType:HT,finalScriptSig:OT,finalScriptWitness:BT,porCommitment:kT,witnessUtxo:LT,bip32Derivation:Vm.makeConverter(gn.InputTypes.BIP32_DERIVATION),redeemScript:Wm.makeConverter(gn.InputTypes.REDEEM_SCRIPT),witnessScript:Ym.makeConverter(gn.InputTypes.WITNESS_SCRIPT),checkPubkey:bh.makeChecker([gn.InputTypes.PARTIAL_SIG,gn.InputTypes.BIP32_DERIVATION]),tapKeySig:NT,tapScriptSig:qT,tapLeafScript:RT,tapBip32Derivation:zm.makeConverter(gn.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:Xm.makeConverter(gn.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:UT};an.inputs=jT;var FT={bip32Derivation:Vm.makeConverter(gn.OutputTypes.BIP32_DERIVATION),redeemScript:Wm.makeConverter(gn.OutputTypes.REDEEM_SCRIPT),witnessScript:Ym.makeConverter(gn.OutputTypes.WITNESS_SCRIPT),checkPubkey:bh.makeChecker([gn.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:zm.makeConverter(gn.OutputTypes.TAP_BIP32_DERIVATION),tapTree:KT,tapInternalKey:Xm.makeConverter(gn.OutputTypes.TAP_INTERNAL_KEY)};an.outputs=FT});var Qm=H(cn=>{w();S();var GT=cn&&cn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),VT=cn&&cn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Zm=cn&&cn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&GT(t,e,r);return VT(t,e),t};Object.defineProperty(cn,"__esModule",{value:!0});cn.psbtFromKeyVals=cn.checkKeyBuffer=cn.psbtFromBuffer=void 0;var Xe=Zm(mf()),_f=ff(),$m=Zm(Ks()),ae=hr();function WT(e,t){let r=0;function n(){let E=$m.decode(e,r);r+=$m.encodingLength(E);let I=e.slice(r,r+E);return r+=E,I}function i(){let E=e.readUInt32BE(r);return r+=4,E}function s(){let E=e.readUInt8(r);return r+=1,E}function o(){let E=n(),I=n();return{key:E,value:I}}function a(){if(r>=e.length)throw new Error("Format Error: Unexpected End of PSBT");let E=e.readUInt8(r)===0;return E&&r++,E}if(i()!==1886610036)throw new Error("Format Error: Invalid Magic Number");if(s()!==255)throw new Error("Format Error: Magic Number must be followed by 0xff separator");let c=[],u={};for(;!a();){let E=o(),I=E.key.toString("hex");if(u[I])throw new Error("Format Error: Keys must be unique for global keymap: key "+I);u[I]=1,c.push(E)}let d=c.filter(E=>E.key[0]===ae.GlobalTypes.UNSIGNED_TX);if(d.length!==1)throw new Error("Format Error: Only one UNSIGNED_TX allowed");let f=t(d[0].value),{inputCount:b,outputCount:m}=f.getInputOutputCounts(),y=[],_=[];for(let E of(0,_f.range)(b)){let I={},k=[];for(;!a();){let C=o(),R=C.key.toString("hex");if(I[R])throw new Error("Format Error: Keys must be unique for each input: input index "+E+" key "+R);I[R]=1,k.push(C)}y.push(k)}for(let E of(0,_f.range)(m)){let I={},k=[];for(;!a();){let C=o(),R=C.key.toString("hex");if(I[R])throw new Error("Format Error: Keys must be unique for each output: output index "+E+" key "+R);I[R]=1,k.push(C)}_.push(k)}return Jm(f,{globalMapKeyVals:c,inputKeyVals:y,outputKeyVals:_})}cn.psbtFromBuffer=WT;function Er(e,t,r){if(!t.equals(p.Buffer.from([r])))throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}cn.checkKeyBuffer=Er;function Jm(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){let i={unsignedTx:e},s=0;for(let d of t)switch(d.key[0]){case ae.GlobalTypes.UNSIGNED_TX:if(Er("global",d.key,ae.GlobalTypes.UNSIGNED_TX),s>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");s++;break;case ae.GlobalTypes.GLOBAL_XPUB:i.globalXpub===void 0&&(i.globalXpub=[]),i.globalXpub.push(Xe.globals.globalXpub.decode(d));break;default:i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(d)}let o=r.length,a=n.length,c=[],u=[];for(let d of(0,_f.range)(o)){let f={};for(let b of r[d])switch(Xe.inputs.checkPubkey(b),b.key[0]){case ae.InputTypes.NON_WITNESS_UTXO:if(Er("input",b.key,ae.InputTypes.NON_WITNESS_UTXO),f.nonWitnessUtxo!==void 0)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");f.nonWitnessUtxo=Xe.inputs.nonWitnessUtxo.decode(b);break;case ae.InputTypes.WITNESS_UTXO:if(Er("input",b.key,ae.InputTypes.WITNESS_UTXO),f.witnessUtxo!==void 0)throw new Error("Format Error: Input has multiple WITNESS_UTXO");f.witnessUtxo=Xe.inputs.witnessUtxo.decode(b);break;case ae.InputTypes.PARTIAL_SIG:f.partialSig===void 0&&(f.partialSig=[]),f.partialSig.push(Xe.inputs.partialSig.decode(b));break;case ae.InputTypes.SIGHASH_TYPE:if(Er("input",b.key,ae.InputTypes.SIGHASH_TYPE),f.sighashType!==void 0)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");f.sighashType=Xe.inputs.sighashType.decode(b);break;case ae.InputTypes.REDEEM_SCRIPT:if(Er("input",b.key,ae.InputTypes.REDEEM_SCRIPT),f.redeemScript!==void 0)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");f.redeemScript=Xe.inputs.redeemScript.decode(b);break;case ae.InputTypes.WITNESS_SCRIPT:if(Er("input",b.key,ae.InputTypes.WITNESS_SCRIPT),f.witnessScript!==void 0)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");f.witnessScript=Xe.inputs.witnessScript.decode(b);break;case ae.InputTypes.BIP32_DERIVATION:f.bip32Derivation===void 0&&(f.bip32Derivation=[]),f.bip32Derivation.push(Xe.inputs.bip32Derivation.decode(b));break;case ae.InputTypes.FINAL_SCRIPTSIG:Er("input",b.key,ae.InputTypes.FINAL_SCRIPTSIG),f.finalScriptSig=Xe.inputs.finalScriptSig.decode(b);break;case ae.InputTypes.FINAL_SCRIPTWITNESS:Er("input",b.key,ae.InputTypes.FINAL_SCRIPTWITNESS),f.finalScriptWitness=Xe.inputs.finalScriptWitness.decode(b);break;case ae.InputTypes.POR_COMMITMENT:Er("input",b.key,ae.InputTypes.POR_COMMITMENT),f.porCommitment=Xe.inputs.porCommitment.decode(b);break;case ae.InputTypes.TAP_KEY_SIG:Er("input",b.key,ae.InputTypes.TAP_KEY_SIG),f.tapKeySig=Xe.inputs.tapKeySig.decode(b);break;case ae.InputTypes.TAP_SCRIPT_SIG:f.tapScriptSig===void 0&&(f.tapScriptSig=[]),f.tapScriptSig.push(Xe.inputs.tapScriptSig.decode(b));break;case ae.InputTypes.TAP_LEAF_SCRIPT:f.tapLeafScript===void 0&&(f.tapLeafScript=[]),f.tapLeafScript.push(Xe.inputs.tapLeafScript.decode(b));break;case ae.InputTypes.TAP_BIP32_DERIVATION:f.tapBip32Derivation===void 0&&(f.tapBip32Derivation=[]),f.tapBip32Derivation.push(Xe.inputs.tapBip32Derivation.decode(b));break;case ae.InputTypes.TAP_INTERNAL_KEY:Er("input",b.key,ae.InputTypes.TAP_INTERNAL_KEY),f.tapInternalKey=Xe.inputs.tapInternalKey.decode(b);break;case ae.InputTypes.TAP_MERKLE_ROOT:Er("input",b.key,ae.InputTypes.TAP_MERKLE_ROOT),f.tapMerkleRoot=Xe.inputs.tapMerkleRoot.decode(b);break;default:f.unknownKeyVals||(f.unknownKeyVals=[]),f.unknownKeyVals.push(b)}c.push(f)}for(let d of(0,_f.range)(a)){let f={};for(let b of n[d])switch(Xe.outputs.checkPubkey(b),b.key[0]){case ae.OutputTypes.REDEEM_SCRIPT:if(Er("output",b.key,ae.OutputTypes.REDEEM_SCRIPT),f.redeemScript!==void 0)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");f.redeemScript=Xe.outputs.redeemScript.decode(b);break;case ae.OutputTypes.WITNESS_SCRIPT:if(Er("output",b.key,ae.OutputTypes.WITNESS_SCRIPT),f.witnessScript!==void 0)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");f.witnessScript=Xe.outputs.witnessScript.decode(b);break;case ae.OutputTypes.BIP32_DERIVATION:f.bip32Derivation===void 0&&(f.bip32Derivation=[]),f.bip32Derivation.push(Xe.outputs.bip32Derivation.decode(b));break;case ae.OutputTypes.TAP_INTERNAL_KEY:Er("output",b.key,ae.OutputTypes.TAP_INTERNAL_KEY),f.tapInternalKey=Xe.outputs.tapInternalKey.decode(b);break;case ae.OutputTypes.TAP_TREE:Er("output",b.key,ae.OutputTypes.TAP_TREE),f.tapTree=Xe.outputs.tapTree.decode(b);break;case ae.OutputTypes.TAP_BIP32_DERIVATION:f.tapBip32Derivation===void 0&&(f.tapBip32Derivation=[]),f.tapBip32Derivation.push(Xe.outputs.tapBip32Derivation.decode(b));break;default:f.unknownKeyVals||(f.unknownKeyVals=[]),f.unknownKeyVals.push(b)}u.push(f)}return{globalMap:i,inputs:c,outputs:u}}cn.psbtFromKeyVals=Jm});var r2=H(qn=>{w();S();var zT=qn&&qn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),XT=qn&&qn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),YT=qn&&qn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&zT(t,e,r);return XT(t,e),t};Object.defineProperty(qn,"__esModule",{value:!0});qn.psbtToKeyVals=qn.psbtToBuffer=void 0;var gh=YT(mf()),e2=ff();function $T({globalMap:e,inputs:t,outputs:r}){let{globalKeyVals:n,inputKeyVals:i,outputKeyVals:s}=t2({globalMap:e,inputs:t,outputs:r}),o=(0,e2.keyValsToBuffer)(n),a=f=>f.length===0?[p.Buffer.from([0])]:f.map(e2.keyValsToBuffer),c=a(i),u=a(s),d=p.Buffer.allocUnsafe(5);return d.writeUIntBE(482972169471,0,5),p.Buffer.concat([d,o].concat(c,u))}qn.psbtToBuffer=$T;var ZT=(e,t)=>e.key.compare(t.key);function yh(e,t){let r=new Set,n=Object.entries(e).reduce((s,[o,a])=>{if(o==="unknownKeyVals")return s;let c=t[o];if(c===void 0)return s;let u=(Array.isArray(a)?a:[a]).map(c.encode);return u.map(f=>f.key.toString("hex")).forEach(f=>{if(r.has(f))throw new Error("Serialize Error: Duplicate key: "+f);r.add(f)}),s.concat(u)},[]),i=e.unknownKeyVals?e.unknownKeyVals.filter(s=>!r.has(s.key.toString("hex"))):[];return n.concat(i).sort(ZT)}function t2({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:yh(e,gh.globals),inputKeyVals:t.map(n=>yh(n,gh.inputs)),outputKeyVals:r.map(n=>yh(n,gh.outputs))}}qn.psbtToKeyVals=t2});var mh=H(Ds=>{w();S();var JT=Ds&&Ds.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),n2=Ds&&Ds.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&JT(t,e,r)};Object.defineProperty(Ds,"__esModule",{value:!0});n2(Qm(),Ds);n2(r2(),Ds)});var s2=H(vf=>{w();S();Object.defineProperty(vf,"__esModule",{value:!0});vf.combine=void 0;var _h=mh();function QT(e){let t=e[0],r=(0,_h.psbtToKeyVals)(t),n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");let i=i2(t);if(i===void 0)throw new Error("Combine: Self missing transaction");let s=ya(r.globalKeyVals),o=r.inputKeyVals.map(ya),a=r.outputKeyVals.map(ya);for(let c of n){let u=i2(c);if(u===void 0||!u.toBuffer().equals(i.toBuffer()))throw new Error("Combine: One of the Psbts does not have the same transaction.");let d=(0,_h.psbtToKeyVals)(c);ya(d.globalKeyVals).forEach(vh(s,r.globalKeyVals,d.globalKeyVals)),d.inputKeyVals.map(ya).forEach((y,_)=>y.forEach(vh(o[_],r.inputKeyVals[_],d.inputKeyVals[_]))),d.outputKeyVals.map(ya).forEach((y,_)=>y.forEach(vh(a[_],r.outputKeyVals[_],d.outputKeyVals[_])))}return(0,_h.psbtFromKeyVals)(i,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}vf.combine=QT;function vh(e,t,r){return n=>{if(e.has(n))return;let i=r.filter(s=>s.key.toString("hex")===n)[0];t.push(i),e.add(n)}}function i2(e){return e.globalMap.unsignedTx}function ya(e){let t=new Set;return e.forEach(r=>{let n=r.key.toString("hex");if(t.has(n))throw new Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}});var Sh=H(me=>{w();S();var e7=me&&me.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),t7=me&&me.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r7=me&&me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&e7(t,e,r);return t7(t,e),t};Object.defineProperty(me,"__esModule",{value:!0});me.defaultLocktimeSetter=me.defaultVersionSetter=me.addOutputAttributes=me.addInputAttributes=me.updateOutput=me.updateInput=me.updateGlobal=me.inputCheckUncleanFinalized=me.getEnumLength=me.checkHasKey=me.checkForOutput=me.checkForInput=void 0;var n7=r7(mf());function a2(e,t){let r=e[t];if(r===void 0)throw new Error(`No input #${t}`);return r}me.checkForInput=a2;function c2(e,t){let r=e[t];if(r===void 0)throw new Error(`No output #${t}`);return r}me.checkForOutput=c2;function i7(e,t,r){if(e.key[0]<r)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&t.filter(n=>n.key.equals(e.key)).length!==0)throw new Error(`Duplicate Key: ${e.key.toString("hex")}`)}me.checkHasKey=i7;function s7(e){let t=0;return Object.keys(e).forEach(r=>{Number(isNaN(Number(r)))&&t++}),t}me.getEnumLength=s7;function o7(e,t){let r=!1;if(t.nonWitnessUtxo||t.witnessUtxo){let n=!!t.redeemScript,i=!!t.witnessScript,s=!n||!!t.finalScriptSig,o=!i||!!t.finalScriptWitness,a=!!t.finalScriptSig||!!t.finalScriptWitness;r=s&&o&&a}if(r===!1)throw new Error(`Input #${e} has too much or too little data to clean`)}me.inputCheckUncleanFinalized=o7;function o2(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${r} and got ${JSON.stringify(n)}`)}function wh(e){return(t,r)=>{for(let n of Object.keys(t)){let i=t[n],{canAdd:s,canAddToArray:o,check:a,expected:c}=n7[e+"s"][n]||{},u=!!o;if(a)if(u){if(!Array.isArray(i)||r[n]&&!Array.isArray(r[n]))throw new Error(`Key type ${n} must be an array`);i.every(a)||o2(e,n,c,i);let d=r[n]||[],f=new Set;if(!i.every(b=>o(d,b,f)))throw new Error("Can not add duplicate data to array");r[n]=d.concat(i)}else{if(a(i)||o2(e,n,c,i),!s(r,i))throw new Error(`Can not add duplicate data to ${e}`);r[n]=i}}}}me.updateGlobal=wh("global");me.updateInput=wh("input");me.updateOutput=wh("output");function a7(e,t){let r=e.length-1,n=a2(e,r);(0,me.updateInput)(t,n)}me.addInputAttributes=a7;function c7(e,t){let r=e.length-1,n=c2(e,r);(0,me.updateOutput)(t,n)}me.addOutputAttributes=c7;function u7(e,t){if(!p.Buffer.isBuffer(t)||t.length<4)throw new Error("Set Version: Invalid Transaction");return t.writeUInt32LE(e,0),t}me.defaultVersionSetter=u7;function f7(e,t){if(!p.Buffer.isBuffer(t)||t.length<4)throw new Error("Set Locktime: Invalid Transaction");return t.writeUInt32LE(e,t.length-4),t}me.defaultLocktimeSetter=f7});var f2=H(wf=>{w();S();Object.defineProperty(wf,"__esModule",{value:!0});wf.Psbt=void 0;var d7=s2(),u2=mh(),xh=hr(),Ar=Sh(),Ph=class{static fromBase64(t,r){let n=p.Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r){let n=p.Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r){let n=(0,u2.psbtFromBuffer)(t,r),i=new this(n.globalMap.unsignedTx);return Object.assign(i,n),i}constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}toBase64(){return this.toBuffer().toString("base64")}toHex(){return this.toBuffer().toString("hex")}toBuffer(){return(0,u2.psbtToBuffer)(this)}updateGlobal(t){return(0,Ar.updateGlobal)(t,this.globalMap),this}updateInput(t,r){let n=(0,Ar.checkForInput)(this.inputs,t);return(0,Ar.updateInput)(r,n),this}updateOutput(t,r){let n=(0,Ar.checkForOutput)(this.outputs,t);return(0,Ar.updateOutput)(r,n),this}addUnknownKeyValToGlobal(t){return(0,Ar.checkHasKey)(t,this.globalMap.unknownKeyVals,(0,Ar.getEnumLength)(xh.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,r){let n=(0,Ar.checkForInput)(this.inputs,t);return(0,Ar.checkHasKey)(r,n.unknownKeyVals,(0,Ar.getEnumLength)(xh.InputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addUnknownKeyValToOutput(t,r){let n=(0,Ar.checkForOutput)(this.outputs,t);return(0,Ar.checkHasKey)(r,n.unknownKeyVals,(0,Ar.getEnumLength)(xh.OutputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});let r=t.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),(0,Ar.addInputAttributes)(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});let r=t.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),(0,Ar.addOutputAttributes)(this.outputs,t),this}clearFinalizedInput(t){let r=(0,Ar.checkForInput)(this.inputs,t);(0,Ar.inputCheckUncleanFinalized)(t,r);for(let n of Object.keys(r))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete r[n];return this}combine(...t){let r=(0,d7.combine)([this].concat(t));return Object.assign(this,r),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};wf.Psbt=Ph});var yo=H(Pe=>{w();S();var l7=Pe&&Pe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),h7=Pe&&Pe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Th=Pe&&Pe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&l7(t,e,r);return h7(t,e),t};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.signatureBlocksAction=Pe.checkInputForSig=Pe.pubkeyInScript=Pe.pubkeyPositionInScript=Pe.witnessStackToScriptWitness=Pe.isP2TR=Pe.isP2SHScript=Pe.isP2WSHScript=Pe.isP2WPKH=Pe.isP2PKH=Pe.isP2PK=Pe.isP2MS=void 0;var d2=Th(Ks()),vc=Th(Ft()),Sf=qs(),p7=vr(),bo=Th(Ns());function go(e){return t=>{try{return e({output:t}),!0}catch{return!1}}}Pe.isP2MS=go(bo.p2ms);Pe.isP2PK=go(bo.p2pk);Pe.isP2PKH=go(bo.p2pkh);Pe.isP2WPKH=go(bo.p2wpkh);Pe.isP2WSHScript=go(bo.p2wsh);Pe.isP2SHScript=go(bo.p2sh);Pe.isP2TR=go(bo.p2tr);function b7(e){let t=p.Buffer.allocUnsafe(0);function r(o){t=p.Buffer.concat([t,p.Buffer.from(o)])}function n(o){let a=t.length,c=d2.encodingLength(o);t=p.Buffer.concat([t,p.Buffer.allocUnsafe(c)]),d2.encode(o,t,a)}function i(o){n(o.length),r(o)}function s(o){n(o.length),o.forEach(i)}return s(e),t}Pe.witnessStackToScriptWitness=b7;function l2(e,t){let r=(0,p7.hash160)(e),n=e.slice(1,33),i=vc.decompile(t);if(i===null)throw new Error("Unknown script error");return i.findIndex(s=>typeof s=="number"?!1:s.equals(e)||s.equals(r)||s.equals(n))}Pe.pubkeyPositionInScript=l2;function g7(e,t){return l2(e,t)!==-1}Pe.pubkeyInScript=g7;function y7(e,t){return m7(e).some(n=>h2(n,vc.signature.decode,t))}Pe.checkInputForSig=y7;function h2(e,t,r){let{hashType:n}=t(e),i=[];switch(n&Sf.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput"),n&31){case Sf.Transaction.SIGHASH_ALL:break;case Sf.Transaction.SIGHASH_SINGLE:case Sf.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence");break}return i.indexOf(r)===-1}Pe.signatureBlocksAction=h2;function m7(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=_7(e)}else t=e.partialSig;return t.map(r=>r.signature)}function _7(e){let t=e.finalScriptSig?vc.decompile(e.finalScriptSig)||[]:[],r=e.finalScriptWitness?vc.decompile(e.finalScriptWitness)||[]:[];return t.concat(r).filter(n=>p.Buffer.isBuffer(n)&&vc.isCanonicalScriptSignature(n)).map(n=>({signature:n}))}});var Bh=H($e=>{w();S();Object.defineProperty($e,"__esModule",{value:!0});$e.checkTaprootInputForSigs=$e.tapTreeFromList=$e.tapTreeToList=$e.tweakInternalPubKey=$e.checkTaprootOutputFields=$e.checkTaprootInputFields=$e.isTaprootOutput=$e.isTaprootInput=$e.serializeTaprootSignature=$e.tapScriptFinalizer=$e.toXOnly=void 0;var Oh=Or(),v7=qs(),Tf=yo(),js=rf(),w7=Ns(),S7=yo(),x7=e=>e.length===32?e:e.slice(1,33);$e.toXOnly=x7;function P7(e,t,r){let n=j7(t,e,r);try{let s=K7(t,n).concat(n.script).concat(n.controlBlock);return{finalScriptWitness:(0,Tf.witnessStackToScriptWitness)(s)}}catch(i){throw new Error(`Can not finalize taproot input #${e}: ${i}`)}}$e.tapScriptFinalizer=P7;function T7(e,t){let r=t?p.Buffer.from([t]):p.Buffer.from([]);return p.Buffer.concat([e,r])}$e.serializeTaprootSignature=T7;function xf(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&(0,Tf.isP2TR)(e.witnessUtxo.script))}$e.isTaprootInput=xf;function Pf(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t&&(0,Tf.isP2TR)(t))}$e.isTaprootOutput=Pf;function E7(e,t,r){U7(e,t,r),L7(e,t,r)}$e.checkTaprootInputFields=E7;function A7(e,t,r){q7(e,t,r),I7(e,t)}$e.checkTaprootOutputFields=A7;function I7(e,t){if(!t.tapTree&&!t.tapInternalKey)return;let r=t.tapInternalKey||e.tapInternalKey,n=t.tapTree||e.tapTree;if(r){let{script:i}=e,s=O7(r,n);if(i&&!i.equals(s))throw new Error("Error adding output. Script or address missmatch.")}}function O7(e,t){let r=t&&p2(t.leaves),{output:n}=(0,w7.p2tr)({internalPubkey:e,scriptTree:r});return n}function B7(e,t){let r=t.tapInternalKey,n=r&&(0,js.tweakKey)(r,t.tapMerkleRoot);if(!n)throw new Error(`Cannot tweak tap internal key for input #${e}. Public key: ${r&&r.toString("hex")}`);return n.x}$e.tweakInternalPubKey=B7;function M7(e){if(!(0,Oh.isTaptree)(e))throw new Error("Cannot convert taptree to tapleaf list. Expecting a tapree structure.");return Ah(e)}$e.tapTreeToList=M7;function p2(e=[]){return e.length===1&&e[0].depth===0?{output:e[0].script,version:e[0].leafVersion}:R7(e)}$e.tapTreeFromList=p2;function C7(e,t){return H7(e).some(n=>(0,S7.signatureBlocksAction)(n,k7,t))}$e.checkTaprootInputForSigs=C7;function k7(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||v7.Transaction.SIGHASH_DEFAULT}}function H7(e){let t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(r=>r.signature)),!t.length){let r=N7(e.finalScriptWitness);r&&t.push(r)}return t}function N7(e){if(!e)return;let t=e.slice(2);if(t.length===64||t.length===65)return t}function Ah(e,t=[],r=0){if(r>js.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");return e?(0,Oh.isTapleaf)(e)?(t.push({depth:r,leafVersion:e.version||js.LEAF_VERSION_TAPSCRIPT,script:e.output}),t):(e[0]&&Ah(e[0],t,r+1),e[1]&&Ah(e[1],t,r+1),t):[]}function R7(e){let t;for(let r of e)if(t=Ih(r,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}function Ih(e,t,r=0){if(r>js.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===r)return t?void 0:{output:e.script,version:e.leafVersion};if((0,Oh.isTapleaf)(t))return;let n=Ih(e,t&&t[0],r+1);if(n)return[n,t&&t[1]];let i=Ih(e,t&&t[1],r+1);if(i)return[t&&t[0],i]}function U7(e,t,r){let n=xf(e)&&ma(t),i=ma(e)&&xf(t),s=e===t&&xf(t)&&ma(t);if(n||i||s)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function q7(e,t,r){let n=Pf(e)&&ma(t),i=ma(e)&&Pf(t),s=e===t&&Pf(t)&&ma(t);if(n||i||s)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function L7(e,t,r){if(t.tapMerkleRoot){let n=(t.tapLeafScript||[]).every(s=>Eh(s,t.tapMerkleRoot)),i=(e.tapLeafScript||[]).every(s=>Eh(s,t.tapMerkleRoot));if(!n||!i)throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(i=>Eh(i,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}function Eh(e,t){if(!t)return!0;let r=(0,js.tapleafHash)({output:e.script,version:e.leafVersion});return(0,js.rootHashFromPath)(e.controlBlock,r).equals(t)}function K7(e,t){let r=(0,js.tapleafHash)({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(n=>n.leafHash.equals(r)).map(n=>D7(t.script,n)).sort((n,i)=>i.positionInScript-n.positionInScript).map(n=>n.signature)}function D7(e,t){return Object.assign({positionInScript:(0,Tf.pubkeyPositionInScript)(t.pubkey,e)},t)}function j7(e,t,r){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);let n=(e.tapLeafScript||[]).sort((i,s)=>i.controlBlock.length-s.controlBlock.length).find(i=>F7(i,e.tapScriptSig,r));if(!n)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return n}function F7(e,t,r){let n=(0,js.tapleafHash)({output:e.script,version:e.leafVersion});return(!r||r.equals(n))&&t.find(s=>s.leafHash.equals(n))!==void 0}function ma(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}});var Mf=H(Kn=>{w();S();var G7=Kn&&Kn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),V7=Kn&&Kn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Nh=Kn&&Kn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&G7(t,e,r);return V7(t,e),t};Object.defineProperty(Kn,"__esModule",{value:!0});Kn.getHashAndSighashType=Kn.Psbt=void 0;var b2=f2(),g2=Nh(Ks()),Gr=Sh(),y2=ba(),_a=ls(),W7=pn(),Ln=Nh(Ns()),z7=rf(),Qi=Nh(Ft()),ut=qs(),Ne=Bh(),gr=yo(),P2=ti(),Mh=le(),X7=Ft(),Y7=Si(),$7=P2.signUtil.schnorr.secp256k1.schnorr,Z7={network:W7.bitcoin,maximumFeeRate:5e3},va=class{static fromBase64(t,r={}){let n=p.Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r={}){let n=p.Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r={}){let n=b2.Psbt.fromBuffer(t,J7),i=new va(r,n);return n9(i.__CACHE.__TX,i.__CACHE),i}constructor(t={},r=new b2.Psbt(new Af)){this.data=r,this.opts=Object.assign({},Z7,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},this.data.inputs.length===0&&this.setVersion(2);let n=(i,s,o,a)=>Object.defineProperty(i,s,{enumerable:o,writable:a});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:(0,_a.cloneBuffer)(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let r;try{r=(0,y2.fromOutputScript)(t.script,this.opts.network)}catch{}return{script:(0,_a.cloneBuffer)(t.script),value:t.value,address:r}})}combine(...t){return this.data.combine(...t.map(r=>r.data)),this}clone(){let t=va.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){Ef(t),this.opts.maximumFeeRate=t}setVersion(t){Ef(t),wc(this.data.inputs,"setVersion");let r=this.__CACHE;return r.__TX.version=t,r.__EXTRACTED_TX=void 0,this}setLocktime(t){Ef(t),wc(this.data.inputs,"setLocktime");let r=this.__CACHE;return r.__TX.locktime=t,r.__EXTRACTED_TX=void 0,this}setInputSequence(t,r){Ef(r),wc(this.data.inputs,"setInputSequence");let n=this.__CACHE;if(n.__TX.ins.length<=t)throw new Error("Input index too high");return n.__TX.ins[t].sequence=r,n.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(r=>this.addInput(r)),this}addInput(t){if(arguments.length>1||!t||t.hash===void 0||t.index===void 0)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");(0,Ne.checkTaprootInputFields)(t,t,"addInput"),wc(this.data.inputs,"addInput"),t.witnessScript&&If(t.witnessScript);let r=this.__CACHE;this.data.addInput(t);let n=r.__TX.ins[r.__TX.ins.length-1];A2(r,n);let i=this.data.inputs.length-1,s=this.data.inputs[i];return s.nonWitnessUtxo&&Hh(this.__CACHE,s,i),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(r=>this.addOutput(r)),this}addOutput(t){if(arguments.length>1||!t||t.value===void 0||t.address===void 0&&t.script===void 0)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");wc(this.data.inputs,"addOutput");let{address:r}=t;if(typeof r=="string"){let{network:i}=this.opts,s=(0,y2.toOutputScript)(r,i);t=Object.assign(t,{script:s})}(0,Ne.checkTaprootOutputFields)(t,t,"addOutput");let n=this.__CACHE;return this.data.addOutput(t),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(T2))throw new Error("Not finalized");let r=this.__CACHE;if(t||e9(this,r,this.opts),r.__EXTRACTED_TX)return r.__EXTRACTED_TX;let n=r.__TX.clone();return C2(this.data.inputs,n,r,!0),n}getFeeRate(){return S2("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return S2("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return(0,Gr.checkForInput)(this.data.inputs,0),Sc(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,r){let n=(0,Gr.checkForInput)(this.data.inputs,t);return(0,Ne.isTaprootInput)(n)?this._finalizeTaprootInput(t,n,void 0,r):this._finalizeInput(t,n,r)}finalizeTaprootInput(t,r,n=Ne.tapScriptFinalizer){let i=(0,Gr.checkForInput)(this.data.inputs,t);if((0,Ne.isTaprootInput)(i))return this._finalizeTaprootInput(t,i,r,n);throw new Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,r,n=i9){let{script:i,isP2SH:s,isP2WSH:o,isSegwit:a}=c9(t,r,this.__CACHE);if(!i)throw new Error(`No script found for input #${t}`);t9(r);let{finalScriptSig:c,finalScriptWitness:u}=n(t,r,i,a,s,o);if(c&&this.data.updateInput(t,{finalScriptSig:c}),u&&this.data.updateInput(t,{finalScriptWitness:u}),!c&&!u)throw new Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,r,n,i=Ne.tapScriptFinalizer){if(!r.witnessUtxo)throw new Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(r.tapKeySig){let s=Ln.p2tr({output:r.witnessUtxo.script,signature:r.tapKeySig}),o=(0,gr.witnessStackToScriptWitness)(s.witness);this.data.updateInput(t,{finalScriptWitness:o})}else{let{finalScriptWitness:s}=i(t,r,n);this.data.updateInput(t,{finalScriptWitness:s})}return this.data.clearFinalizedInput(t),this}getInputType(t){let r=(0,Gr.checkForInput)(this.data.inputs,t),n=k2(t,r,this.__CACHE),i=Bf(n,t,"input",r.redeemScript||h9(r.finalScriptSig),r.witnessScript||p9(r.finalScriptWitness)),s=i.type==="raw"?"":i.type+"-",o=R2(i.meaningfulScript);return s+o}inputHasPubkey(t,r){let n=(0,Gr.checkForInput)(this.data.inputs,t);return d9(r,n,t,this.__CACHE)}inputHasHDKey(t,r){let n=(0,Gr.checkForInput)(this.data.inputs,t),i=_2(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}outputHasPubkey(t,r){let n=(0,Gr.checkForOutput)(this.data.outputs,t);return l9(r,n,t,this.__CACHE)}outputHasHDKey(t,r){let n=(0,Gr.checkForOutput)(this.data.outputs,t),i=_2(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}validateSignaturesOfAllInputs(t){return(0,Gr.checkForInput)(this.data.inputs,0),Sc(this.data.inputs.length).map(n=>this.validateSignaturesOfInput(n,t)).reduce((n,i)=>i===!0&&n,!0)}validateSignaturesOfInput(t,r,n){let i=this.data.inputs[t];return(0,Ne.isTaprootInput)(i)?this.validateSignaturesOfTaprootInput(t,r,n):this._validateSignaturesOfInput(t,r,n)}_validateSignaturesOfInput(t,r,n){let i=this.data.inputs[t],s=(i||{}).partialSig;if(!i||!s||s.length<1)throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");let o=n?s.filter(f=>f.pubkey.equals(n)):s;if(o.length<1)throw new Error("No signatures for this pubkey");let a=[],c,u,d;for(let f of o){let b=Qi.signature.decode(f.signature),{hash:m,script:y}=d!==b.hashType?O2(t,Object.assign({},i,{sighashType:b.hashType}),this.__CACHE,!0):{hash:c,script:u};d=b.hashType,c=m,u=y,E2(f.pubkey,y,"verify"),a.push(r(f.pubkey,m,b.signature))}return a.every(f=>f===!0)}validateSignaturesOfTaprootInput(t,r,n){let i=this.data.inputs[t],s=(i||{}).tapKeySig,o=(i||{}).tapScriptSig;if(!i&&!s&&!(o&&!o.length))throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");n=n&&(0,Ne.toXOnly)(n);let a=n?kh(t,i,this.data.inputs,n,this.__CACHE):o9(t,i,this.data.inputs,this.__CACHE);if(!a.length)throw new Error("No signatures for this pubkey");let c=a.find(u=>!!u.leafHash);if(s&&c&&!r(c.pubkey,c.hash,s))return!1;if(o)for(let u of o){let d=a.find(f=>u.pubkey.equals(f.pubkey));if(d&&!r(u.pubkey,d.hash,u.signature))return!1}return!0}signAllInputsHD(t,r=[ut.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");let n=[];for(let i of Sc(this.data.inputs.length))try{this.signInputHD(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,r=[ut.Transaction.SIGHASH_ALL]){return new Promise((n,i)=>{if(!t||!t.publicKey||!t.fingerprint)return i(new Error("Need HDSigner to sign input"));let s=[],o=[];for(let a of Sc(this.data.inputs.length))o.push(this.signInputHDAsync(a,t,r).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(a=>a===!1))return i(new Error("No inputs were signed"));n()})})}signInputHD(t,r,n=[ut.Transaction.SIGHASH_ALL]){if(!r||!r.publicKey||!r.fingerprint)throw new Error("Need HDSigner to sign input");return x2(t,this.data.inputs,r).forEach(s=>this.signInput(t,s,n)),this}signInputHDAsync(t,r,n=[ut.Transaction.SIGHASH_ALL]){return new Promise((i,s)=>{if(!r||!r.publicKey||!r.fingerprint)return s(new Error("Need HDSigner to sign input"));let a=x2(t,this.data.inputs,r).map(c=>this.signInputAsync(t,c,n));return Promise.all(a).then(()=>{i()}).catch(s)})}signAllInputs(t,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");let n=[];for(let i of Sc(this.data.inputs.length))try{this.signInput(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,r){return new Promise((n,i)=>{if(!t||!t.publicKey)return i(new Error("Need Signer to sign input"));let s=[],o=[];for(let[a]of this.data.inputs.entries())o.push(this.signInputAsync(a,t,r).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(a=>a===!1))return i(new Error("No inputs were signed"));n()})})}signInput(t,r,n,i){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Gr.checkForInput)(this.data.inputs,t);return(0,Ne.isTaprootInput)(s)?this._signTaprootInput(t,s,r,i,n):this._signInput(t,r,n)}signTaprootInput(t,r,n,i){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Gr.checkForInput)(this.data.inputs,t);if((0,Ne.isTaprootInput)(s))return this._signTaprootInput(t,s,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)}getHashAndSighashType(t,r,n=[ut.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=xc(this.data.inputs,t,r,this.__CACHE,n);return{hash:i,sighashType:s}}_signInput(t,r,n=[ut.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=xc(this.data.inputs,t,r.publicKey,this.__CACHE,n),o=[{pubkey:r.publicKey,signature:Qi.signature.encode(r.sign(i),s)}];return this.data.updateInput(t,{partialSig:o}),this}_signTaprootInput(t,r,n,i,s=[ut.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,r,n,i,s),a=o.filter(u=>!u.leafHash).map(u=>(0,Ne.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType))[0],c=o.filter(u=>!!u.leafHash).map(u=>({pubkey:(0,Ne.toXOnly)(n.publicKey),signature:(0,Ne.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType),leafHash:u.leafHash}));return a&&this.data.updateInput(t,{tapKeySig:a}),c.length&&this.data.updateInput(t,{tapScriptSig:c}),this}signInputAsync(t,r,n){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let i=(0,Gr.checkForInput)(this.data.inputs,t);return(0,Ne.isTaprootInput)(i)?this._signTaprootInputAsync(t,i,r,void 0,n):this._signInputAsync(t,r,n)})}signTaprootInputAsync(t,r,n,i){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Gr.checkForInput)(this.data.inputs,t);if((0,Ne.isTaprootInput)(s))return this._signTaprootInputAsync(t,s,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,r,n=[ut.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=xc(this.data.inputs,t,r.publicKey,this.__CACHE,n);return Promise.resolve(r.sign(i)).then(o=>{let a=[{pubkey:r.publicKey,signature:Qi.signature.encode(o,s)}];this.data.updateInput(t,{partialSig:a})})}async _signTaprootInputAsync(t,r,n,i,s=[ut.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,r,n,i,s),a=[],c=o.filter(d=>!d.leafHash)[0];if(c){let d=Promise.resolve(n.signSchnorr(c.hash)).then(f=>({tapKeySig:(0,Ne.serializeTaprootSignature)(f,r.sighashType)}));a.push(d)}let u=o.filter(d=>!!d.leafHash);if(u.length){let d=u.map(f=>Promise.resolve(n.signSchnorr(f.hash)).then(b=>({tapScriptSig:[{pubkey:(0,Ne.toXOnly)(n.publicKey),signature:(0,Ne.serializeTaprootSignature)(b,r.sighashType),leafHash:f.leafHash}]})));a.push(...d)}return Promise.all(a).then(d=>{d.forEach(f=>this.data.updateInput(t,f))})}checkTaprootHashesForSig(t,r,n,i,s){if(typeof n.signSchnorr!="function")throw new Error(`Need Schnorr Signer to sign taproot input #${t}.`);let o=kh(t,r,this.data.inputs,n.publicKey,this.__CACHE,i,s);if(!o||!o.length)throw new Error(`Can not sign for input #${t} with the key ${n.publicKey.toString("hex")}`);return o}toBuffer(){return Ch(this.__CACHE),this.data.toBuffer()}toHex(){return Ch(this.__CACHE),this.data.toHex()}toBase64(){return Ch(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,r){return r.witnessScript&&If(r.witnessScript),(0,Ne.checkTaprootInputFields)(this.data.inputs[t],r,"updateInput"),this.data.updateInput(t,r),r.nonWitnessUtxo&&Hh(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,r){let n=this.data.outputs[t];return(0,Ne.checkTaprootOutputFields)(n,r,"updateOutput"),this.data.updateOutput(t,r),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,r){return this.data.addUnknownKeyValToInput(t,r),this}addUnknownKeyValToOutput(t,r){return this.data.addUnknownKeyValToOutput(t,r),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}verify(t,r){let n=[ut.Transaction.SIGHASH_SINGLE|ut.Transaction.SIGHASH_ANYONECANPAY,ut.Transaction.SIGHASH_ALL,ut.Transaction.SIGHASH_DEFAULT];for(let i=0;i<this.inputCount;i++)if((0,Ne.isTaprootInput)(this.data.inputs[i])){let s=p.Buffer.from((0,Y7.taprootTweakPubkey)(t.slice(1))[0]),a=new _a.BufferReader(r).readVector(),c={publicKey:s,sign(f){return p.Buffer.alloc(64)},signSchnorr(f){return p.Buffer.alloc(64)}},d=this.checkTaprootHashesForSig(i,this.data.inputs[i],c,void 0,n).filter(f=>!f.leafHash)[0].hash;if(!$7.verify(Mh.base.toHex(a[0]),Mh.base.toHex(d),Mh.base.toHex(s)))return!1}else{let{hash:s}=xc(this.data.inputs,i,t,this.__CACHE,n),a=new _a.BufferReader(r).readVector(),c=X7.signature.decode(a[0]).signature,u=a[1];if(!t.equals(u))throw Error("pubKey error");if(!P2.signUtil.secp256k1.verifyWithNoRecovery(s,c,t))return!1}return!0}};Kn.Psbt=va;var J7=e=>new Af(e),Af=class{constructor(t=p.Buffer.from([2,0,0,0,0,0,0,0,0,0])){this.tx=ut.Transaction.fromBuffer(t),r9(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(t.hash===void 0||t.index===void 0||!p.Buffer.isBuffer(t.hash)&&typeof t.hash!="string"||typeof t.index!="number")throw new Error("Error adding input.");let r=typeof t.hash=="string"?(0,_a.reverseBuffer)(p.Buffer.from(t.hash,"hex")):t.hash;this.tx.addInput(r,t.index,t.sequence)}addOutput(t){if(t.script===void 0||t.value===void 0||!p.Buffer.isBuffer(t.script)||typeof t.value!="number")throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}};function Q7(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return m2(1,e.partialSig);case"multisig":let n=Ln.p2ms({output:t});return m2(n.m,e.partialSig,n.pubkeys);default:return!1}}function Ch(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==!1)throw new Error("Not BIP174 compliant, can not export")}function m2(e,t,r){if(!t)return!1;let n;if(r?n=r.map(i=>{let s=b9(i);return t.find(o=>o.pubkey.equals(s))}).filter(i=>!!i):n=t,n.length>e)throw new Error("Too many signatures");return n.length===e}function T2(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function _2(e){return t=>!(!t.masterFingerprint.equals(e.fingerprint)||!e.derivePath(t.path).publicKey.equals(t.pubkey))}function Ef(e){if(typeof e!="number"||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function e9(e,t,r){let n=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize(),s=n*i;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(s/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}function wc(e,t){e.forEach(r=>{if((0,Ne.isTaprootInput)(r)?(0,Ne.checkTaprootInputForSigs)(r,t):(0,gr.checkInputForSig)(r,t))throw new Error("Can not modify transaction, signatures exist.")})}function t9(e){if(!e.sighashType||!e.partialSig)return;let{partialSig:t,sighashType:r}=e;t.forEach(n=>{let{hashType:i}=Qi.signature.decode(n.signature);if(r!==i)throw new Error("Signature sighash does not match input sighash type")})}function E2(e,t,r){if(!(0,gr.pubkeyInScript)(e,t))throw new Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}function r9(e){if(!e.ins.every(r=>r.script&&r.script.length===0&&r.witness&&r.witness.length===0))throw new Error("Format Error: Transaction ScriptSigs are not empty")}function n9(e,t){e.ins.forEach(r=>{A2(t,r)})}function A2(e,t){let r=(0,_a.reverseBuffer)(p.Buffer.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function I2(e,t){return(r,n,i,s)=>{let o=e({redeem:{output:i}}).output;if(!n.equals(o))throw new Error(`${t} for ${s} #${r} doesn't match the scriptPubKey in the prevout`)}}var v2=I2(Ln.p2sh,"Redeem script"),w2=I2(Ln.p2wsh,"Witness script");function S2(e,t,r,n){if(!r.every(T2))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&n.__FEE_RATE)return n.__FEE_RATE;if(e==="__FEE"&&n.__FEE)return n.__FEE;let i,s=!0;if(n.__EXTRACTED_TX?(i=n.__EXTRACTED_TX,s=!1):i=n.__TX.clone(),C2(r,i,n,s),e==="__FEE_RATE")return n.__FEE_RATE;if(e==="__FEE")return n.__FEE}function i9(e,t,r,n,i,s){let o=R2(r);if(!Q7(t,r,o))throw new Error(`Can not finalize input #${e}`);return s9(r,o,t.partialSig,n,i,s)}function s9(e,t,r,n,i,s){let o,a,c=a9(e,t,r),u=s?Ln.p2wsh({redeem:c}):null,d=i?Ln.p2sh({redeem:u||c}):null;return n?(u?a=(0,gr.witnessStackToScriptWitness)(u.witness):a=(0,gr.witnessStackToScriptWitness)(c.witness),d&&(o=d.input)):d?o=d.input:o=c.input,{finalScriptSig:o,finalScriptWitness:a}}function xc(e,t,r,n,i){let s=(0,Gr.checkForInput)(e,t),{hash:o,sighashType:a,script:c}=O2(t,s,n,!1,i);return E2(r,c,"sign"),{hash:o,sighashType:a}}Kn.getHashAndSighashType=xc;function O2(e,t,r,n,i){let s=r.__TX,o=t.sighashType||ut.Transaction.SIGHASH_ALL;B2(o,i);let a,c;if(t.nonWitnessUtxo){let f=Of(r,t,e),b=s.ins[e].hash,m=f.getHash();if(!b.equals(m))throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);let y=s.ins[e].index;c=f.outs[y]}else if(t.witnessUtxo)c=t.witnessUtxo;else throw new Error("Need a Utxo input item for signing");let{meaningfulScript:u,type:d}=Bf(c.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(d)>=0)a=s.hashForWitnessV0(e,u,c.value,o);else if((0,gr.isP2WPKH)(u)){let f=Ln.p2pkh({hash:u.slice(2)}).output;a=s.hashForWitnessV0(e,f,c.value,o)}else{if(t.nonWitnessUtxo===void 0&&r.__UNSAFE_SIGN_NONSEGWIT===!1)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${u.toString("hex")}`);!n&&r.__UNSAFE_SIGN_NONSEGWIT!==!1&&console.warn(`Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecesor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.
*********************
PROCEED WITH CAUTION!
*********************`),a=s.hashForSignature(e,u,o)}return{script:u,sighashType:o,hash:a}}function o9(e,t,r,n){let i=[];if(t.tapInternalKey){let o=(0,Ne.tweakInternalPubKey)(e,t);i.push(o)}if(t.tapScriptSig){let o=t.tapScriptSig.map(a=>a.pubkey);i.push(...o)}return i.map(o=>kh(e,t,r,o,n)).flat()}function kh(e,t,r,n,i,s,o){let a=i.__TX,c=t.sighashType||ut.Transaction.SIGHASH_DEFAULT;B2(c,o);let u=r.map((y,_)=>H2(_,y,i)),d=u.map(y=>y.script),f=u.map(y=>y.value),b=[];if(t.tapInternalKey&&!s){let y=(0,Ne.tweakInternalPubKey)(e,t);if((0,Ne.toXOnly)(n).equals(y)){let _=a.hashForWitnessV1(e,d,f,c);b.push({pubkey:n,hash:_})}}let m=(t.tapLeafScript||[]).map(y=>{let _=(0,z7.tapleafHash)({output:y.script,version:y.leafVersion});return Object.assign({hash:_},y)}).filter(y=>!s||s.equals(y.hash)).map(y=>{let _=a.hashForWitnessV1(e,d,f,ut.Transaction.SIGHASH_DEFAULT,y.hash);return{pubkey:n,hash:_,leafHash:y.hash}});return b.concat(m)}function B2(e,t){if(t&&t.indexOf(e)<0){let r=f9(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${r}`)}}function a9(e,t,r){let n;switch(t){case"multisig":let i=u9(e,r);n=Ln.p2ms({output:e,signatures:i});break;case"pubkey":n=Ln.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=Ln.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=Ln.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break}return n}function c9(e,t,r){let n=r.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){let s=Of(r,t,e),o=n.ins[e].index;i.script=s.outs[o].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);return(t.witnessScript||(0,gr.isP2WPKH)(i.script))&&(i.isSegwit=!0),i}function x2(e,t,r){let n=(0,Gr.checkForInput)(t,e);if(!n.bip32Derivation||n.bip32Derivation.length===0)throw new Error("Need bip32Derivation to sign with HD");let i=n.bip32Derivation.map(o=>{if(o.masterFingerprint.equals(r.fingerprint))return o}).filter(o=>!!o);if(i.length===0)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(o=>{let a=r.derivePath(o.path);if(!o.pubkey.equals(a.publicKey))throw new Error("pubkey did not match bip32Derivation");return a})}function u9(e,t){return Ln.p2ms({output:e}).pubkeys.map(n=>(t.filter(i=>i.pubkey.equals(n))[0]||{}).signature).filter(n=>!!n)}function M2(e){let t=0;function r(o){return t+=o,e.slice(t-o,t)}function n(){let o=g2.decode(e,t);return t+=g2.decode.bytes,o}function i(){return r(n())}function s(){let o=n(),a=[];for(let c=0;c<o;c++)a.push(i());return a}return s()}function f9(e){let t=e&ut.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(e&31){case ut.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case ut.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case ut.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function Hh(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;let n=ut.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;let i=e,s=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){let o=i.__NON_WITNESS_UTXO_BUF_CACHE[s],a=i.__NON_WITNESS_UTXO_TX_CACHE[s];if(o!==void 0)return o;{let c=a.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[s]=c,c}},set(o){i.__NON_WITNESS_UTXO_BUF_CACHE[s]=o}})}function C2(e,t,r,n){let i=0;e.forEach((c,u)=>{if(n&&c.finalScriptSig&&(t.ins[u].script=c.finalScriptSig),n&&c.finalScriptWitness&&(t.ins[u].witness=M2(c.finalScriptWitness)),c.witnessUtxo)i+=c.witnessUtxo.value;else if(c.nonWitnessUtxo){let d=Of(r,c,u),f=t.ins[u].index,b=d.outs[f];i+=b.value}});let s=t.outs.reduce((c,u)=>c+u.value,0),o=i-s;if(o<0)throw new Error("Outputs are spending more than Inputs");let a=t.virtualSize();r.__FEE=o,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(o/a)}function Of(e,t,r){let n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||Hh(e,t,r),n[r]}function k2(e,t,r){let{script:n}=H2(e,t,r);return n}function H2(e,t,r){if(t.witnessUtxo!==void 0)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(t.nonWitnessUtxo!==void 0){let i=Of(r,t,e).outs[r.__TX.ins[e].index];return{script:i.script,value:i.value}}else throw new Error("Can't find pubkey in input without Utxo data")}function d9(e,t,r,n){let i=k2(r,t,n),{meaningfulScript:s}=Bf(i,r,"input",t.redeemScript,t.witnessScript);return(0,gr.pubkeyInScript)(e,s)}function l9(e,t,r,n){let i=n.__TX.outs[r].script,{meaningfulScript:s}=Bf(i,r,"output",t.redeemScript,t.witnessScript);return(0,gr.pubkeyInScript)(e,s)}function h9(e){if(!e)return;let t=Qi.decompile(e);if(!t)return;let r=t[t.length-1];if(!(!p.Buffer.isBuffer(r)||N2(r)||g9(r)||!Qi.decompile(r)))return r}function p9(e){if(!e)return;let t=M2(e),r=t[t.length-1];if(!(N2(r)||!Qi.decompile(r)))return r}function b9(e){if(e.length===65){let t=e[64]&1,r=e.slice(0,33);return r[0]=2|t,r}return e.slice()}function N2(e){return e.length===33&&Qi.isCanonicalPubKey(e)}function g9(e){return Qi.isCanonicalScriptSignature(e)}function Bf(e,t,r,n,i){let s=(0,gr.isP2SHScript)(e),o=s&&n&&(0,gr.isP2WSHScript)(n),a=(0,gr.isP2WSHScript)(e);if(s&&n===void 0)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((a||o)&&i===void 0)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let c;return o?(c=i,v2(t,e,n,r),w2(t,n,i,r),If(c)):a?(c=i,w2(t,e,i,r),If(c)):s?(c=n,v2(t,e,n,r)):c=e,{meaningfulScript:c,type:o?"p2sh-p2wsh":s?"p2sh":a?"p2wsh":"raw"}}function If(e){if((0,gr.isP2WPKH)(e)||(0,gr.isP2SHScript)(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function R2(e){return(0,gr.isP2WPKH)(e)?"witnesspubkeyhash":(0,gr.isP2PKH)(e)?"pubkeyhash":(0,gr.isP2MS)(e)?"multisig":(0,gr.isP2PK)(e)?"pubkey":"nonstandard"}function Sc(e){return[...Array(e).keys()]}});var Dh=H(Q=>{w();S();var y9=Q&&Q.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),m9=Q&&Q.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),L2=Q&&Q.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&y9(t,e,r);return m9(t,e),t};Object.defineProperty(Q,"__esModule",{value:!0});Q.generateMPCSignedPSBT=Q.generateMPCUnsignedPSBT=Q.generateMPCSignedBuyingTx=Q.generateMPCUnsignedBuyingPSBT=Q.generateMPCSignedListingPSBT=Q.generateMPCUnsignedListingPSBT=Q.generateSignedBuyingTx=Q.mergeSignedBuyingPsbt=Q.generateUnsignedBuyingPsbt=Q.generateSignedListingPsbt=Q.generateUnsignedListingPsbt=Q.extractPsbtTransaction=Q.psbtSignImpl=Q.signPsbtWithKeyPathAndScriptPathImpl=Q.signPsbtWithKeyPathAndScriptPath=Q.signPsbtWithKeyPathAndScriptPathBatch=Q.psbtDecode=Q.psbtSign=Q.classicToPsbt=Q.buildPsbt=void 0;var un=Mf(),_9=ti(),ne=le(),lt=tn(),se=rn(),Fs=L2(Si()),ni=Bh(),v9=ba(),w9=ls(),U2=yo(),Rh=L2(Ft()),S9=vr(),x9=W0(),Pc=_9.signUtil.schnorr.secp256k1.schnorr,Tc=5e3;function Uh(e,t,r){return K2(e,t,r).toHex()}Q.buildPsbt=Uh;function K2(e,t,r){let n=new un.Psbt({network:t,maximumFeeRate:r||Tc});return e.inputs.forEach(i=>{let s=(0,v9.toOutputScript)(i.address,t),o={hash:i.txId,index:i.vOut,witnessUtxo:{script:s,value:i.amount}},a=(0,lt.getAddressType)(i.address,t||se.networks.bitcoin);i.bip32Derivation&&(a==="segwit_taproot"?o.tapBip32Derivation=i.bip32Derivation.map(c=>{let u=ne.base.fromHex(c.pubkey);return u.length!=32&&(u=u.slice(1)),{masterFingerprint:ne.base.fromHex(c.masterFingerprint),pubkey:u,path:c.path,leafHashes:c.leafHashes.map(d=>p.Buffer.from(d,"hex"))}}):o.bip32Derivation=i.bip32Derivation.map(c=>({masterFingerprint:ne.base.fromHex(c.masterFingerprint),pubkey:ne.base.fromHex(c.pubkey),path:c.path}))),a==="legacy"?o.nonWitnessUtxo=ne.base.fromHex(i.nonWitnessUtxo):a==="segwit_taproot"?i.publicKey&&(o.tapInternalKey=(0,ni.toXOnly)(ne.base.fromHex(i.publicKey))):a==="segwit_nested"&&(o.redeemScript=se.payments.p2wpkh({pubkey:p.Buffer.from(i.publicKey,"hex"),network:t}).output),i.sighashType&&(o.sighashType=i.sighashType),n.addInput(o)}),e.outputs.forEach(i=>{if(i.omniScript)n.addOutput({script:ne.base.fromHex(i.omniScript),value:0});else{let s={address:i.address,value:i.amount};i.bip32Derivation&&(s.bip32Derivation=i.bip32Derivation.map(o=>({masterFingerprint:ne.base.fromHex(o.masterFingerprint),pubkey:ne.base.fromHex(o.pubkey),path:o.path}))),n.addOutput(s)}}),n}Q.classicToPsbt=K2;function qh(e,t,r,n){let i=un.Psbt.fromBase64(e,{network:r,maximumFeeRate:n||Tc});return F2(i,t,r),i.toBase64()}Q.psbtSign=qh;function P9(e,t,r){try{let n=un.Psbt.fromHex(e,{network:t,maximumFeeRate:r||Tc});return n.txInputs?n.txInputs.filter(i=>!i.hash.equals(p.Buffer.alloc(32))).map(i=>({txId:ne.base.toHex(ne.base.reverseBuffer(i.hash)),vOut:i.index})):[]}catch{let i=un.Psbt.fromBase64(e,{network:t,maximumFeeRate:r||Tc});return i.txInputs?i.txInputs.filter(s=>!s.hash.equals(p.Buffer.alloc(32))).map(s=>({txId:ne.base.toHex(ne.base.reverseBuffer(s.hash)),vOut:s.index})):[]}}Q.psbtDecode=P9;function T9(e,t,r,n){if(e==null||e.length==0)return[];let i=[],s=n==null?0:n.length,o=0;for(o=0;o<e.length;o++){let a={};o<s&&n&&(a=n[o]);let c=D2(e[o],t,r,{autoFinalized:a.autoFinalized,toSignInputs:a.toSignInputs});i.push(c)}return i}Q.signPsbtWithKeyPathAndScriptPathBatch=T9;function D2(e,t,r,n={}){let i=Kh(e,r);return j2(i,t,r,n.autoFinalized,n.toSignInputs),i.toHex()}Q.signPsbtWithKeyPathAndScriptPath=D2;function j2(e,t,r,n,i){r=r||se.networks.bitcoin;let s=(0,lt.privateKeyFromWIF)(t,r),o=new Map;i?.forEach(f=>{o.set(f.index,f)});let a={psbtIndex:0,needTweak:!0,tweakHash:p.Buffer.alloc(0),toSignInputsMap:o,publicKey:p.Buffer.alloc(0),sign(f){return(0,lt.sign)(f,s)},signSchnorr(f){let b=Fs.taprootTweakPrivKey(ne.base.fromHex(s));return this.toSignInputsMap?.has(this.psbtIndex)&&this.toSignInputsMap.get(this.psbtIndex)?.disableTweakSigner?p.Buffer.from(Pc.sign(f,s,ne.base.randomBytes(32))):this.needTweak?(this.needTweak&&this.tweakHash.length>0&&(b=Fs.taprootTweakPrivKey(ne.base.fromHex(s),this.tweakHash)),p.Buffer.from(Pc.sign(f,b,ne.base.randomBytes(32)))):p.Buffer.from(Pc.sign(f,s,ne.base.randomBytes(32)))}},c=[se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY,se.Transaction.SIGHASH_ALL,se.Transaction.SIGHASH_DEFAULT],u=()=>({psbtIndex:0,needTweak:!0,tweakHash:p.Buffer.alloc(0),toSignInputsMap:o,publicKey:p.Buffer.alloc(0),getPrivateKey(){let f=ne.base.fromHex(s);return this.needTweak&&(f=p.Buffer.from(Fs.taprootTweakPrivKey(f,this.tweakHash))),f},sign(f){return(0,lt.sign)(f,this.getPrivateKey().toString("hex"))},signSchnorr(f){return p.Buffer.from(Pc.sign(f,this.getPrivateKey(),ne.base.randomBytes(32)))}}),d=()=>[se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY,se.Transaction.SIGHASH_ALL,se.Transaction.SIGHASH_DEFAULT];for(let f=0;f<e.inputCount;f++)if(!(o?.size>0&&!o?.has(f)))if(o?.get(f)?.useTweakSigner!==void 0){let b=e.data.inputs[f],m,y=u(),_=d();y.psbtIndex=f,y.publicKey=(0,lt.wif2Public)(t,r);let E=o.get(f);E.sighashTypes!==void 0&&(_=E.sighashTypes),y.needTweak=E.useTweakSigner,y.needTweak&&(y.publicKey=p.Buffer.from(Fs.taprootTweakPubkey((0,ni.toXOnly)((0,lt.wif2Public)(t,r)),y.tweakHash)[0])),(0,ni.isTaprootInput)(b)&&(!b.tapInternalKey&&!b.tapLeafScript&&(b.tapInternalKey=(0,ni.toXOnly)((0,lt.wif2Public)(t,r))),E.tapLeafHashToSign!==void 0&&(m=p.Buffer.from(E.tapLeafHashToSign,"hex")));try{if(e.signInput(f,y,_,m),n!=null&&!n)continue;e.finalizeInput(f)}catch(I){throw I}}else{a.psbtIndex=f;let b=e.data.inputs[f];(0,ni.isTaprootInput)(b)?(b.tapInternalKey||(b.tapInternalKey=(0,ni.toXOnly)((0,lt.wif2Public)(t,r))),a.needTweak=!0,a.publicKey=p.Buffer.from(Fs.taprootTweakPubkey((0,ni.toXOnly)((0,lt.wif2Public)(t,r)))[0]),o?.has(f)&&o?.get(f)?.disableTweakSigner&&(a.publicKey=(0,lt.wif2Public)(t,r),a.needTweak=!1),b.tapLeafScript&&b.tapLeafScript?.length>0&&!b.tapMerkleRoot?b.tapLeafScript.forEach(m=>{m.controlBlock&&m.script&&(a.publicKey=(0,lt.wif2Public)(t,r),a.needTweak=!1)}):b.tapMerkleRoot&&(a.needTweak=!0,a.tweakHash=b.tapMerkleRoot,a.publicKey=p.Buffer.from(Fs.taprootTweakPubkey((0,ni.toXOnly)((0,lt.wif2Public)(t,r)),b.tapMerkleRoot)[0]))):(a.needTweak=!1,a.tweakHash=p.Buffer.alloc(0),a.publicKey=(0,lt.wif2Public)(t,r));try{if(o?.has(f)){let m=o?.get(f)?.sighashTypes;m!=null&&(c=m)}if(e.signInput(f,a,c),n!=null&&!n)continue;e.finalizeInput(f)}catch(m){if(o?.size>0&&o?.has(f))throw m}}}Q.signPsbtWithKeyPathAndScriptPathImpl=j2;function F2(e,t,r){r=r||se.networks.bitcoin;let n=(0,lt.privateKeyFromWIF)(t,r),i={publicKey:p.Buffer.alloc(0),sign(o){return(0,lt.sign)(o,n)},signSchnorr(o){let a=Fs.taprootTweakPrivKey(ne.base.fromHex(n));return p.Buffer.from(Pc.sign(o,a,ne.base.randomBytes(32)))}},s=[se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY,se.Transaction.SIGHASH_ALL|se.Transaction.SIGHASH_ANYONECANPAY,se.Transaction.SIGHASH_ALL,se.Transaction.SIGHASH_DEFAULT];for(let o=0;o<e.inputCount;o++){if((0,ni.isTaprootInput)(e.data.inputs[o])){let a=e.data.inputs[o];a.tapInternalKey||(a.tapInternalKey=(0,ni.toXOnly)((0,lt.wif2Public)(t,r))),i.publicKey=p.Buffer.from(Fs.taprootTweakPubkey((0,ni.toXOnly)((0,lt.wif2Public)(t,r)))[0])}else i.publicKey=(0,lt.wif2Public)(t,r);try{e.signInput(o,i,s)}catch{}}}Q.psbtSignImpl=F2;function Lh(e,t,r){let n=un.Psbt.fromHex(e,{network:t,maximumFeeRate:r||Tc}),i;try{i=n.finalizeAllInputs().extractTransaction()}catch(s){i=n.extractTransaction(),console.log(s)}return i.toHex()}Q.extractPsbtTransaction=Lh;function G2(e,t,r){let n=se.address.toOutputScript(e.nftAddress,t);if(((0,U2.isP2SHScript)(n)||(0,U2.isP2TR)(n))&&!r)throw new Error("Missing publicKey");let i={inputs:[],outputs:[]},s="bc1pcyj5mt2q4t4py8jnur8vpxvxxchke4pzy7tdr9yvj3u3kdfgrj6sw3rzmr";t===se.networks.testnet&&(s="tb1pcyj5mt2q4t4py8jnur8vpxvxxchke4pzy7tdr9yvj3u3kdfgrj6see4dpv"),i.inputs.push({txId:"0".repeat(64),vOut:0,amount:0,address:s},{txId:"0".repeat(64),vOut:1,amount:0,address:s}),i.outputs.push({address:s,amount:0},{address:s,amount:0}),i.inputs.push({txId:e.nftUtxo.txHash,vOut:e.nftUtxo.vout,address:e.nftAddress,amount:e.nftUtxo.coinAmount,publicKey:r,nonWitnessUtxo:e.nftUtxo.rawTransation,sighashType:se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY}),i.outputs.push({address:e.receiveBtcAddress,amount:e.price});let o=Uh(i,t);return ne.base.toBase64(ne.base.fromHex(o))}Q.generateUnsignedListingPsbt=G2;function E9(e,t,r){let n=ne.base.toHex((0,lt.wif2Public)(t,r));return qh(G2(e,r,n),t,r)}Q.generateSignedListingPsbt=E9;var Gs=2,A9=600,I9=546;function V2(e,t,r){let n={inputs:[],outputs:[],address:e.paymentAndChangeAddress,feePerB:e.feeRate};e.dummyUtxos.forEach(o=>{n.inputs.push({txId:o.txHash,vOut:o.vout,address:e.paymentAndChangeAddress,amount:o.coinAmount,publicKey:r,nonWitnessUtxo:o.rawTransation})}),n.outputs.push({address:e.paymentAndChangeAddress,amount:e.dummyUtxos.reduce((o,a)=>o+a.coinAmount,0)});let i=[];e.sellerPsbts.forEach(o=>{let a=un.Psbt.fromBase64(o,{network:t}),c=a.data.globalMap.unsignedTx.tx.ins[Gs];i.push(a.data.globalMap.unsignedTx.tx.outs[Gs]);let u=a.data.inputs[Gs].witnessUtxo;u||(u=se.Transaction.fromBuffer(a.data.inputs[Gs].nonWitnessUtxo).outs[c.index]),n.inputs.push({txId:ne.base.toHex((0,w9.reverseBuffer)(c.hash)),vOut:c.index,address:se.address.fromOutputScript(u.script,t),amount:u.value,sighashType:se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY}),n.outputs.push({address:e.receiveNftAddress,amount:u.value})}),i.forEach(o=>{n.outputs.push({address:se.address.fromOutputScript(o.script,t),amount:o.value})}),e.paymentUtxos.forEach(o=>{n.inputs.push({txId:o.txHash,vOut:o.vout,address:e.paymentAndChangeAddress,amount:o.coinAmount,publicKey:r,nonWitnessUtxo:o.rawTransation})}),e.dummyUtxos.forEach(()=>{n.outputs.push({address:e.paymentAndChangeAddress,amount:A9})});let s=parseInt((0,lt.signBtc)(n,"",t,void 0,!1,!0));return s>=I9&&n.outputs.push({address:e.paymentAndChangeAddress,amount:s}),ne.base.toBase64(ne.base.fromHex(Uh(n,t)))}Q.generateUnsignedBuyingPsbt=V2;function W2(e,t){let r=un.Psbt.fromBase64(e),n=t.length+1;return t.forEach((i,s)=>{let o=un.Psbt.fromBase64(i);r.data.globalMap.unsignedTx.tx.ins[n+s]=o.data.globalMap.unsignedTx.tx.ins[Gs],r.data.inputs[n+s]=o.data.inputs[Gs]}),r}Q.mergeSignedBuyingPsbt=W2;function O9(e,t,r){let n=ne.base.toHex((0,lt.wif2Public)(t,r)),i=qh(V2(e,r,n),t,r);return Lh(W2(i,e.sellerPsbts).toHex(),r)}Q.generateSignedBuyingTx=O9;function B9(e,t,r){let n=un.Psbt.fromBase64(e,{network:r}),i=ne.base.fromHex(t),s=[se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY],o=[];for(let a=0;a<n.inputCount;a++){if(a!=Gs)continue;let{hash:c}=n.getHashAndSighashType(a,i,s);o.push(ne.base.toHex(c))}return{psbtBase64:e,signHashList:o}}Q.generateMPCUnsignedListingPSBT=B9;function M9(e,t,r,n){let i=un.Psbt.fromBase64(e,{network:n}),o=[{pubkey:ne.base.fromHex(t),signature:Rh.signature.encode(ne.base.fromHex(r),se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY)}];return i.data.updateInput(Gs,{partialSig:o}),i.toBase64()}Q.generateMPCSignedListingPSBT=M9;function C9(e,t,r,n=1){let i=un.Psbt.fromBase64(e,{network:r}),s=ne.base.fromHex(t),o=[se.Transaction.SIGHASH_ALL],a=[],c=n+1;for(let u=0;u<i.inputCount;u++){if(u>=c&&u<c+n)continue;let{hash:d}=i.getHashAndSighashType(u,s,o);a.push(ne.base.toHex(d))}return{psbtBase64:e,signHashList:a}}Q.generateMPCUnsignedBuyingPSBT=C9;function k9(e,t,r,n,i=1){let s=un.Psbt.fromBase64(e,{network:n}),o=ne.base.fromHex(t),a=i+1;for(let c=0;c<s.inputCount;c++){if(c>=a&&c<a+i)continue;let u=[{pubkey:o,signature:Rh.signature.encode(ne.base.fromHex(r[c]),se.Transaction.SIGHASH_ALL)}];s.data.updateInput(c,{partialSig:u})}return Lh(s.toHex(),n)}Q.generateMPCSignedBuyingTx=k9;function z2(e,t,r){let n=Kh(e,r),i=ne.base.fromHex(t),s=[se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY,se.Transaction.SIGHASH_SINGLE|se.Transaction.SIGHASH_ANYONECANPAY,se.Transaction.SIGHASH_ALL|se.Transaction.SIGHASH_ANYONECANPAY,se.Transaction.SIGHASH_ALL,se.Transaction.SIGHASH_DEFAULT],o=[];for(let c=0;c<n.inputCount;c++)try{let{hash:u}=n.getHashAndSighashType(c,i,s);o.push(ne.base.toHex(u))}catch{let d=q2();o.push(d)}let a=new Map;return o.forEach((c,u)=>{let d=a.get(c);d=d??0,d!=null&&d>=1&&(o[u]=q2()),a.set(c,d+1)}),{psbtStr:e,signHashList:o}}Q.generateMPCUnsignedPSBT=z2;function q2(){let e=(0,S9.sha256)((0,x9.randomBytes)(32));return"ffffffff"+ne.base.toHex(e.slice(0,28))}function H9(e,t,r,n){let i=Kh(e,n),s=ne.base.fromHex(t),o=se.Transaction.SIGHASH_ALL,c=z2(e,t,n).signHashList;for(let u=0;u<i.inputCount;u++){if(c[u].slice(0,8)=="ffffffff")continue;i.data.inputs[u].sighashType!=null&&(o=i.data.inputs[u].sighashType);let d=[{pubkey:s,signature:Rh.signature.encode(ne.base.fromHex(r[u]),o)}];try{i.data.updateInput(u,{partialSig:d})}catch{}}return i.toHex()}Q.generateMPCSignedPSBT=H9;function Kh(e,t){let r;return ne.base.isHexString("0x"+e)?r=un.Psbt.fromHex(e,{network:t}):r=un.Psbt.fromBase64(e,{network:t}),r}});var e_=H(Sa=>{w();S();Object.defineProperty(Sa,"__esModule",{value:!0});Sa.verifySimple=Sa.signSimple=void 0;var wa=le(),Y2=ba(),$2=qs(),Z2=Mf(),X2=Vd(),N9=Dh(),R9=tn(),J2=yo();function Q2(e){let t="BIP0322-signed-message",r=wa.base.sha256(p.Buffer.from(t)),n=wa.base.sha256(p.Buffer.concat([r,r,p.Buffer.from(e)]));return wa.base.toHex(n)}async function U9(e,t,r,n){let i=(0,Y2.toOutputScript)(t,n),s=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),o=4294967295,a=0,c=p.Buffer.concat([p.Buffer.from("0020","hex"),p.Buffer.from(Q2(e),"hex")]),u=new $2.Transaction;u.version=0,u.addInput(s,o,a,c),u.addOutput(i,0);let d=new Z2.Psbt({network:n});d.setVersion(0),d.addInput({hash:u.getHash(),index:0,sequence:0,witnessUtxo:{script:i,value:0}}),(0,J2.isP2TR)(i)&&d.updateInput(0,{tapInternalKey:(0,R9.wif2Public)(r,n).slice(1)}),d.addOutput({script:p.Buffer.from("6a","hex"),value:0}),(0,N9.psbtSignImpl)(d,r,n),d.finalizeAllInputs();let f=d.extractTransaction();function b(_){return p.Buffer.concat([(0,X2.encode)(_.byteLength),_])}let m=(0,X2.encode)(f.ins[0].witness.length),y=p.Buffer.concat([m,...f.ins[0].witness.map(_=>b(_))]);return wa.base.toBase64(y)}Sa.signSimple=U9;function q9(e,t,r,n,i){let s=(0,Y2.toOutputScript)(t,i),o=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),a=4294967295,c=0,u=p.Buffer.concat([p.Buffer.from("0020","hex"),p.Buffer.from(Q2(e),"hex")]),d=new $2.Transaction;d.version=0,d.addInput(o,a,c,u),d.addOutput(s,0);let f=new Z2.Psbt;f.setVersion(0),f.addInput({hash:d.getHash(),index:0,sequence:0,witnessUtxo:{script:s,value:0}});let b=wa.base.fromHex(n);return(0,J2.isP2TR)(s)&&f.updateInput(0,{tapInternalKey:b.slice(1)}),f.addOutput({script:p.Buffer.from("6a","hex"),value:0}),f.verify(b,p.Buffer.from(wa.base.fromBase64(r)))}Sa.verifySimple=q9});var rn=H(Re=>{w();S();var L9=Re&&Re.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),K9=Re&&Re.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),mo=Re&&Re.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&L9(t,e,r);return K9(t,e),t};Object.defineProperty(Re,"__esModule",{value:!0});Re.BufferWriter=Re.Transaction=Re.psbt=Re.bip0322=Re.script=Re.payments=Re.networks=Re.crypto=Re.address=void 0;var D9=mo(ba());Re.address=D9;var j9=mo(vr());Re.crypto=j9;var F9=mo(pn());Re.networks=F9;var G9=mo(Ns());Re.payments=G9;var V9=mo(Ft());Re.script=V9;var W9=mo(e_());Re.bip0322=W9;var z9=mo(Mf());Re.psbt=z9;var X9=qs();Object.defineProperty(Re,"Transaction",{enumerable:!0,get:function(){return X9.Transaction}});var Y9=ls();Object.defineProperty(Re,"BufferWriter",{enumerable:!0,get:function(){return Y9.BufferWriter}})});var kf=H(Cf=>{w();S();Object.defineProperty(Cf,"__esModule",{value:!0});Cf.validate=void 0;function $9(e,t){if(!e)throw new Error(t)}Cf.validate=$9});var n_=H(xa=>{w();S();Object.defineProperty(xa,"__esModule",{value:!0});xa.decode=xa.encode=void 0;var r_=kf(),Z9="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t_={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};function J9(e){for(var t="",r=0;r<e.length;++r){var n=e[r];(0,r_.validate)(0<=n&&n<32,"Invalid value: "+n+"."),t+=Z9[n]}return t}xa.encode=J9;function Q9(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r){var n=e[r];(0,r_.validate)(n in t_,"Invalid value: "+n+"."),t[r]=t_[n]}return t}xa.decode=Q9});var s_=H(Hf=>{w();S();Object.defineProperty(Hf,"__esModule",{value:!0});Hf.convert=void 0;var i_=kf();function eE(e,t,r,n){for(var i=n?Math.floor(e.length*t/r):Math.ceil(e.length*t/r),s=(1<<r)-1,o=new Uint8Array(i),a=0,c=0,u=0,d=0;d<e.length;++d){var f=e[d];for((0,i_.validate)(0<=f&&f>>t===0,"Invalid value: "+f+"."),c=c<<t|f,u+=t;u>=r;)u-=r,o[a]=c>>u&s,++a}return n?(0,i_.validate)(u<t&&(c<<r-u&s)===0,"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):u>0&&(o[a]=c<<r-u&s,++a),o}Hf.convert=eE});var d_=H(Dn=>{w();S();var tE=Dn&&Dn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),rE=Dn&&Dn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o_=Dn&&Dn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&tE(t,e,r);return rE(t,e),t};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.decode=Dn.encode=void 0;var a_=o_(n_()),nE=uw(),c_=o_(s_()),jh=kf();function iE(e,t,r){let n=_o(u_(e),new Uint8Array(1)),i=aE(t)+uE(r),s=dE(_o(new Uint8Array([i]),r)),o=_o(_o(n,s),new Uint8Array(8)),a=_o(s,oE(f_(o)));return e+":"+a_.encode(a)}Dn.encode=iE;function sE(e){let t=e.toLowerCase().split(":");(0,jh.validate)(t.length===2,"Missing prefix: "+e+".");let r=t[0],n=a_.decode(t[1]);(0,jh.validate)(hE(r,n),"Invalid checksum: "+e+".");let i=lE(n.subarray(0,-8)),s=i[0],o=i.subarray(1);(0,jh.validate)(fE(s)===o.length*8,"Invalid hash size: "+e+".");let a=cE(s);return{prefix:r,type:a,hash:o}}Dn.decode=sE;function u_(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0)&31;return t}function oE(e){for(var t=new Uint8Array(8),r=0;r<8;++r)t[7-r]=e.and(31).toJSNumber(),e=e.shiftRight(5);return t}function aE(e){switch(e){case"P2PKH":return 0;case"P2SH":return 8;default:throw new Error("Invalid type: "+e+".")}}function cE(e){switch(e&120){case 0:return"P2PKH";case 8:return"P2SH";default:throw new Error("Invalid address type in version byte: "+e+".")}}function uE(e){switch(e.length*8){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new Error("Invalid hash size: "+e.length+".")}}function fE(e){switch(e&7){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512}}function dE(e){return c_.convert(e,8,5,!1)}function lE(e){return c_.convert(e,5,8,!0)}function _o(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function f_(e){for(var t=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336],r=nE(1),n=0;n<e.length;++n){var i=e[n],s=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(i);for(var o=0;o<t.length;++o)s.shiftRight(o).and(1).equals(1)&&(r=r.xor(t[o]))}return r.xor(1)}function hE(e,t){var r=_o(u_(e),new Uint8Array(1)),n=_o(r,t);return f_(n).equals(0)}});var b_=H(Zt=>{w();S();var pE=Zt&&Zt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),bE=Zt&&Zt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),h_=Zt&&Zt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&pE(t,e,r);return bE(t,e),t};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.convert2LegacyAddress=Zt.isCashAddress=Zt.ValidateBitcashP2PkHAddress=Zt.GetBitcashP2PkHAddressByPublicKey=Zt.GetBitcashAddressByPublicKey=Zt.GetBitcashAddressByHash=void 0;var p_=vr(),Nf=h_(d_()),l_=h_(Ns());function Fh(e,t,r){return Nf.encode(e,t,r)}Zt.GetBitcashAddressByHash=Fh;function gE(e,t,r){let n=(0,p_.hash160)(p.Buffer.from(r));return Fh(e,t,n)}Zt.GetBitcashAddressByPublicKey=gE;function yE(e){let t=(0,p_.hash160)(p.Buffer.from(e));return Fh("bitcoincash","P2PKH",t)}Zt.GetBitcashP2PkHAddressByPublicKey=yE;function mE(e){try{e.indexOf(":")===-1&&(e="bitcoincash:"+e);let{prefix:t,type:r,hash:n}=Nf.decode(e);return r==="P2PKH"&&n.length===20}catch{return!1}}Zt.ValidateBitcashP2PkHAddress=mE;function _E(e){try{return e.startsWith("bitcoincash:")||(e="bitcoincash:"+e,Nf.decode(e)),!0}catch{return!1}}Zt.isCashAddress=_E;function vE(e,t){e.indexOf(":")===-1&&(e="bitcoincash:"+e);let{type:r,hash:n}=Nf.decode(e);if(r=="P2PKH")return l_.p2pkh({hash:p.Buffer.from(n),network:t}).address;if(r=="P2SH")return l_.p2sh({hash:p.Buffer.from(n),network:t}).address;throw new Error("convert2LegacyAddress error")}Zt.convert2LegacyAddress=vE});var y_=H(g_=>{w();S();Object.defineProperty(g_,"__esModule",{value:!0})});var S_=H(jn=>{w();S();var wE=jn&&jn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),SE=jn&&jn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Gh=jn&&jn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&wE(t,e,r);return SE(t,e),t};Object.defineProperty(jn,"__esModule",{value:!0});jn.srcInscribe=jn.SrcInscriptionTool=void 0;var Nr=Gh(rn()),xE=ti(),Pa=le(),PE=Gh(Si()),TE=Gh(vr()),Ec=tn(),EE=rn(),m_=pa(),AE=xE.signUtil.schnorr.secp256k1.schnorr,IE=2,__=31,OE=4294967293,BE=7800,ME=7800,ZR=4e6/10,Ta=class{constructor(){this.network=Nr.networks.bitcoin,this.revealTxs=[],this.commitTx=new Nr.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newSrcInscriptionTool(t,r){let n=new Ta;n.network=t;let i=r.revealOutValue||BE,s=r.minChangeValue||ME;return n.buildCommitTx(t,r.inscriptionData,i,r.commitTxPrevOutputList,r.changeAddress,r.commitFeeRate,s)||n.signCommitTx(r.commitTxPrevOutputList),n}buildCommitTx(t,r,n,i,s,o,a){let c=p.Buffer.from(r.contentType),u=p.Buffer.from(r.body);for(;u[u.length-1]==0;)u=u.slice(0,u.length-1);let d=2+c.length+u.length,f=d%62==0?d:d+62-d%62,b=EE.BufferWriter.withCapacity(f);b.writeSlice(p.Buffer.from([(c.length+u.length)/256,(c.length+u.length)%256])),b.writeSlice(c),b.writeSlice(u),f>d&&b.writeSlice(p.Buffer.alloc(f-d));let m=b.end(),y=Pa.base.fromHex(NE(i[0].txId,m.toString("hex"))),_=0,E=0,I=new Nr.Transaction;for(I.version=IE,E+=n,I.addOutput(Nr.address.toOutputScript(r.revealAddr,t),n);y.length;){let q=y.slice(0,Math.min(__,y.length)),L=q.toString("hex");L.length<62&&(L=L+"0".repeat(62-L.length)),y=y.slice(q.length);let O=y.slice(0,Math.min(__,y.length)).toString("hex");O.length<62&&(O=O+"0".repeat(62-O.length)),y=y.slice(q.length);let l=["03"+L+"00","02"+O+"00","020202020202020202020202020202020202020202020202020202020202020202"].map(v=>p.Buffer.from(v,"hex")),g=Nr.payments.p2ms({m:1,pubkeys:l});I.addOutput(g.output,n),E+=n}i.forEach(q=>{let L=Pa.base.reverseBuffer(Pa.base.fromHex(q.txId));I.addInput(L,q.vOut,OE),this.commitTxPrevOutputFetcher.push(q.amount),_+=q.amount});let k=Nr.address.toOutputScript(s,t);I.addOutput(k,0);let C=I.clone();v_(C,i,this.network);let R=(0,m_.countAdjustedVsize)(C,i.map(q=>q.address),t),N=Math.floor(R*o),U=_-E-N;if(U>=a)I.outs[I.outs.length-1].value=U;else{I.outs=I.outs.slice(0,I.outs.length-1),C.outs=C.outs.slice(0,C.outs.length-1);let q=(0,m_.countAdjustedVsize)(C,i.map(V=>V.address),t),L=Math.floor(q*o);if(_-E-L<0)return this.mustCommitTxFee=N,this.mustRevealTxFees.push(E),!0}return this.commitTx=I,!1}signCommitTx(t){v_(this.commitTx,t,this.network)}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};jn.SrcInscriptionTool=Ta;function v_(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Ec.getAddressType)(t[i].address,r),o=Pa.base.fromHex((0,Ec.privateKeyFromWIF)(t[i].privateKey,r)),a=Pa.base.toHex(o),c=(0,Ec.private2public)(a);if(s==="segwit_taproot"){let u=t.map(y=>Nr.address.toOutputScript(y.address,r)),d=t.map(y=>y.amount),f=e.hashForWitnessV1(i,u,d,Nr.Transaction.SIGHASH_DEFAULT),b=PE.taprootTweakPrivKey(o),m=p.Buffer.from(AE.sign(f,b,Pa.base.randomBytes(32)));n.witness=[p.Buffer.from(m)]}else if(s==="legacy"){let u=Nr.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,Nr.Transaction.SIGHASH_ALL),f=(0,Ec.sign)(d,a),b=Nr.payments.p2pkh({signature:Nr.script.signature.encode(f,Nr.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=TE.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,Nr.Transaction.SIGHASH_ALL),m=(0,Ec.sign)(b,a);n.witness=[Nr.script.signature.encode(m,Nr.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function CE(e,t){let r=Ta.newSrcInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}jn.srcInscribe=CE;function kE(e,t){for(var r=[],n=0,i,s="",o=0;o<256;o++)r[o]=o;for(o=0;o<256;o++)n=(n+r[o]+e.charCodeAt(o%e.length))%256,i=r[o],r[o]=r[n],r[n]=i;o=0,n=0;for(var a=0;a<t.length;a++)o=(o+1)%256,n=(n+r[o])%256,i=r[o],r[o]=r[n],r[n]=i,s+=String.fromCharCode(t.charCodeAt(a)^r[(r[o]+r[n])%256]);return s}function w_(e){for(var t=[],r,n=0;n<e.length-1;n+=2){var i=parseInt(e.substr(n,2),16);t.push(i)}return r=String.fromCharCode.apply(String,t),r}function HE(e){var t,r,n="",i;for(e+="",t=0,r=e.length;t<r;t++)i=e.charCodeAt(t).toString(16),n+=i.length<2?"0"+i:i;return n}function NE(e,t){return HE(kE(w_(e),w_(t)))}});var B_=H(Rr=>{w();S();var RE=Rr&&Rr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),UE=Rr&&Rr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),zh=Rr&&Rr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&RE(t,e,r);return UE(t,e),t};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.inscribeForMPCSigned=Rr.inscribeForMPCUnsigned=Rr.inscribe=Rr.InscriptionTool=void 0;var ie=zh(rn()),qE=ti(),yn=le(),LE=zh(Si()),P_=zh(vr()),T_=qs(),Vs=tn(),Vh=yo(),Rf=pa(),Xh=qE.signUtil.schnorr.secp256k1.schnorr,Uf=2,qf=4294967293,E_=546,A_=546,x_=4e6/10,Ea=class{constructor(){this.network=ie.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new ie.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newInscriptionTool(t,r){let n=new Ea;n.network=t;let i=r.revealOutValue||E_,s=r.minChangeValue||A_,o=r.commitTxPrevOutputList[0].privateKey;r.inscriptionDataList.forEach(u=>{n.inscriptionTxCtxDataList.push(I_(t,u,o))});let a=n.buildEmptyRevealTx(t,i,r.revealFeeRate);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,a,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTx(t,r,n){let i=0,s=[],o=[],a=[];return this.inscriptionTxCtxDataList.forEach((c,u)=>{let d=new ie.Transaction;d.version=Uf,d.addInput(p.Buffer.alloc(32),u,qf),d.addOutput(c.revealPkScript,r);let f=p.Buffer.alloc(64),b=p.Buffer.alloc(33),m=[];m.push(f),m.push(c.inscriptionScript),m.push(b);let y=Math.floor((d.byteLength()+Math.floor(((0,T_.vectorSize)(m)+2+3)/4))*n),_=r+y;c.revealTxPrevOutput={pkScript:c.commitTxAddressPkScript,value:_},i+=_,s.push(d),o.push(y),a.push(c.commitTxAddress)}),this.revealTxs=s,this.mustRevealTxFees=o,this.commitAddrs=a,i}buildCommitTx(t,r,n,i,s,o){let a=0,c=new ie.Transaction;c.version=Uf,r.forEach(y=>{let _=yn.base.reverseBuffer(yn.base.fromHex(y.txId));c.addInput(_,y.vOut,qf),this.commitTxPrevOutputFetcher.push(y.amount),a+=y.amount}),this.inscriptionTxCtxDataList.forEach(y=>{c.addOutput(y.revealTxPrevOutput.pkScript,y.revealTxPrevOutput.value)});let u=ie.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();Wh(d,r.map(y=>({...y,privateKey:""})),this.network);let f=(0,Rf.countAdjustedVsize)(d,r.map(y=>y.address),t),b=Math.floor(f*s),m=a-i-b;if(m>=o)c.outs[c.outs.length-1].value=m;else{c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let y=(0,Rf.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(y*s);if(a-i-_<0)return this.mustCommitTxFee=b,!0}return this.commitTx=c,!1}signCommitTx(t){Wh(this.commitTx,t,this.network)}completeRevealTx(){this.revealTxs.forEach((t,r)=>{t.ins[0].hash=this.commitTx.getHash();let n=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.pkScript],i=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value];this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value);let s=t.hashForWitnessV1(0,n,i,ie.Transaction.SIGHASH_DEFAULT,this.inscriptionTxCtxDataList[r].hash),o=p.Buffer.from(Xh.sign(s,this.inscriptionTxCtxDataList[r].privateKey,yn.base.randomBytes(32)));t.ins[0].witness=[p.Buffer.from(o),...this.inscriptionTxCtxDataList[r].witness];let a=t.weight();if(a>x_)throw new Error(`reveal(index ${r}) transaction weight greater than ${x_} (MAX_STANDARD_TX_WEIGHT): ${a}`)})}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};Rr.InscriptionTool=Ea;function Wh(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Vs.getAddressType)(t[i].address,r);if(t[i].privateKey==""){let{witness:u,script:d}=(0,Vs.fakeSign)(s);u!==void 0&&(n.witness=u),d!==void 0&&(n.script=d);return}let o=yn.base.fromHex((0,Vs.privateKeyFromWIF)(t[i].privateKey,r)),a=yn.base.toHex(o),c=(0,Vs.private2public)(a);if(s==="segwit_taproot"){let u=t.map(y=>ie.address.toOutputScript(y.address,r)),d=t.map(y=>y.amount),f=e.hashForWitnessV1(i,u,d,ie.Transaction.SIGHASH_DEFAULT),b=LE.taprootTweakPrivKey(o),m=p.Buffer.from(Xh.sign(f,b,yn.base.randomBytes(32)));n.witness=[p.Buffer.from(m)]}else if(s==="legacy"){let u=ie.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,ie.Transaction.SIGHASH_ALL),f=(0,Vs.sign)(d,a),b=ie.payments.p2pkh({signature:ie.script.signature.encode(f,ie.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=P_.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,ie.Transaction.SIGHASH_ALL),m=(0,Vs.sign)(b,a);n.witness=[ie.script.signature.encode(m,ie.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function I_(e,t,r){let n=yn.base.fromHex((0,Vs.privateKeyFromWIF)(r,e)),i=(0,Vs.wif2Public)(r,e).slice(1),s=ie.script.OPS,o=[];o.push(i),o.push(s.OP_CHECKSIG),o.push(s.OP_FALSE),o.push(s.OP_IF),o.push(p.Buffer.from("ord")),o.push(s.OP_DATA_1),o.push(s.OP_DATA_1),o.push(p.Buffer.from(t.contentType)),o.push(s.OP_0);let a=520,c=p.Buffer.from(t.body),u=c.length;for(let I=0;I<u;I+=a){let k=I+a;k>u&&(k=u),o.push(c.slice(I,k))}o.push(s.OP_ENDIF);let d=ie.script.compile(o),f={output:d},b={output:d,redeemVersion:192},{output:m,witness:y,hash:_,address:E}=ie.payments.p2tr({internalPubkey:i,scriptTree:f,redeem:b,network:e});return{privateKey:n,inscriptionScript:d,commitTxAddress:E,commitTxAddressPkScript:m,witness:y,hash:_,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:ie.address.toOutputScript(t.revealAddr,e)}}function KE(e,t){let r=Ea.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}Rr.inscribe=KE;function O_(e,t,r,n){let i=e.commitTxPrevOutputList[0].privateKey,s=[];e.inscriptionDataList.forEach(N=>{s.push(I_(t,N,i))});let o=0,a=e.revealOutValue||E_,c=[];s.forEach((N,U)=>{let q=new ie.Transaction;q.version=Uf,q.addInput(p.Buffer.alloc(32),U,qf),q.addOutput(N.revealPkScript,a),c.push(q);let L=p.Buffer.alloc(64),V=p.Buffer.alloc(33),O=[];O.push(L),O.push(N.inscriptionScript),O.push(V);let l=Math.floor((q.byteLength()+Math.floor(((0,T_.vectorSize)(O)+2+3)/4))*e.revealFeeRate),g=a+l;N.revealTxPrevOutput={pkScript:N.commitTxAddressPkScript,value:g},o+=g});let u=0,d=new ie.Transaction;d.version=Uf,e.commitTxPrevOutputList.forEach(N=>{d.addInput(yn.base.reverseBuffer(yn.base.fromHex(N.txId)),N.vOut,qf),u+=N.amount});let f=[];s.forEach(N=>{d.addOutput(N.revealTxPrevOutput.pkScript,N.revealTxPrevOutput.value),f.push(N.commitTxAddress)});let b=ie.address.toOutputScript(e.changeAddress,t);d.addOutput(b,0);let m=d.clone();Wh(m,e.commitTxPrevOutputList,t);let y=(0,Rf.countAdjustedVsize)(m,e.commitTxPrevOutputList.map(N=>N.address),t),_=Math.floor(y*e.commitFeeRate),E=u-o-_;if(E>=(e.minChangeValue||A_))d.outs[d.outs.length-1].value=E;else{d.outs=d.outs.slice(0,d.outs.length-1),m.outs=m.outs.slice(0,m.outs.length-1);let N=(0,Rf.countAdjustedVsize)(m,e.commitTxPrevOutputList.map(q=>q.address),t),U=Math.floor(N*e.commitFeeRate);if(u-o-U<0)throw new Error("insufficient balance")}let I=jE(d,e.commitTxPrevOutputList,t),k=d.getHash();n&&(k=n),c.forEach((N,U)=>{N.ins[0].hash=k;let q=[s[U].revealTxPrevOutput.pkScript],L=[s[U].revealTxPrevOutput.value],V=N.hashForWitnessV1(0,q,L,ie.Transaction.SIGHASH_DEFAULT,s[U].hash),O=p.Buffer.from(Xh.sign(V,s[U].privateKey,yn.base.randomBytes(32)));N.ins[0].witness=[O,...s[U].witness]});let C=0;d.ins.forEach((N,U)=>{C+=e.commitTxPrevOutputList[U].amount}),d.outs.forEach(N=>{C-=N.value});let R=[];return c.forEach((N,U)=>{let q=0;q+=s[U].revealTxPrevOutput.value,q-=N.outs[0].value,R.push(q)}),{signHashList:I,commitTx:d.toHex(),revealTxs:c.map(N=>N.toHex()),commitTxFee:C,revealTxFees:R,commitAddrs:f}}Rr.inscribeForMPCUnsigned=O_;function DE(e,t){let r=e.commitTx,n=e.signatureList,i=ie.Transaction.fromHex(r),s=i.getHash();i.ins.forEach((c,u)=>{let d=yn.base.fromHex(n[u]);!c.witness||c.witness.length==0?c.script=ie.payments.p2pkh({pubkey:ie.payments.p2pkh({input:c.script}).pubkey,signature:ie.script.signature.encode(d,ie.Transaction.SIGHASH_ALL)}).input:c.witness[0]=ie.script.signature.encode(d,ie.Transaction.SIGHASH_ALL)});let o=i.getHash(),a=O_(e,t,s,o);return{signHashList:null,commitTx:i.toHex(),revealTxs:a.revealTxs,commitTxFee:a.commitTxFee,revealTxFees:a.revealTxFees,commitAddrs:a.commitAddrs}}Rr.inscribeForMPCSigned=DE;function jE(e,t,r){let n=[];return e.ins.forEach((i,s)=>{let o=yn.base.fromHex(t[s].publicKey),a=ie.address.toOutputScript(t[s].address,r),c=p.Buffer.alloc(64,0),u;if((0,Vh.isP2TR)(a)){let d=t.map(b=>ie.address.toOutputScript(b.address,r)),f=t.map(b=>b.amount);u=e.hashForWitnessV1(s,d,f,ie.Transaction.SIGHASH_DEFAULT),i.witness=[c]}else if((0,Vh.isP2PKH)(a)){let d=ie.address.toOutputScript(t[s].address,r);u=e.hashForSignature(s,d,ie.Transaction.SIGHASH_ALL),i.script=ie.payments.p2pkh({pubkey:o,signature:ie.script.signature.encode(c,ie.Transaction.SIGHASH_ALL)}).input}else{let d=P_.hash160(o),f=p.Buffer.of(25,118,169,20,...d,136,172);u=e.hashForWitness(s,f,t[s].amount,ie.Transaction.SIGHASH_ALL),i.witness=ie.payments.p2wpkh({pubkey:o,signature:ie.script.signature.encode(c,ie.Transaction.SIGHASH_ALL)}).witness;let b=p.Buffer.of(22,0,20,...d);(0,Vh.isP2SHScript)(a)&&(i.script=b)}n.push(yn.base.toHex(u))}),n}});var H_=H(fn=>{w();S();var FE=fn&&fn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),GE=fn&&fn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Yh=fn&&fn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&FE(t,e,r);return GE(t,e),t};Object.defineProperty(fn,"__esModule",{value:!0});fn.inscribeRefundFee=fn.createInscriptionTxCtxData=fn.InscriptionRefundFeeTool=void 0;var yr=Yh(rn()),VE=ti(),Aa=le(),WE=Yh(Si()),zE=Yh(vr()),vo=tn(),M_=pa(),XE=VE.signUtil.schnorr.secp256k1.schnorr,YE=2,$E=4294967293,ZE=546,iU=4e6/10,Ia=class{constructor(){this.network=yr.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.refundFeeTx=new yr.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustTxFee=0,this.dustChange=0,this.commitAddrs=[],this.merkleRoot=new Uint8Array}static newInscriptionRefundFeeTool(t,r){let n=new Ia;n.network=t;let i=r.minChangeValue||ZE;if(r.inputs&&r.inputs.length>600)throw new Error("invalid amount of inputs");let s=100;r.maxAmountOfInput&&(s=r.maxAmountOfInput),s>r.inputs.length&&(s=r.inputs.length);let o=r.inputs[0].privateKey;if(r.inscriptionRefundFeeDataList.forEach(c=>{n.inscriptionTxCtxDataList.push(k_(t,c,o))}),r.middleAddress&&r.middleAddress!=n.inscriptionTxCtxDataList[0].commitTxAddress)throw new Error("invalid middle address");return n.commitAddrs=[n.inscriptionTxCtxDataList[0].commitTxAddress],n.merkleRoot=n.inscriptionTxCtxDataList[0].hash,n.buildrRefundFeeTx(t,r.inputs.slice(0,s),r.changeAddress,0,r.feeRate,i)||n.signRefundFeeTx(r.inputs.slice(0,s)),n}buildrRefundFeeTx(t,r,n,i,s,o){let a=0,c=new yr.Transaction;c.version=YE,r.forEach(y=>{let _=Aa.base.reverseBuffer(Aa.base.fromHex(y.txId));c.addInput(_,y.vOut,$E),this.commitTxPrevOutputFetcher.push(y.amount),a+=y.amount});let u=yr.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();C_(d,r,this.network);let f=(0,M_.countAdjustedVsize)(d,r.map(y=>y.address),t),b=Math.floor(f*s),m=a-i-b;if(m>=o)c.outs[c.outs.length-1].value=m;else{if(c.outs.length<=1)return this.dustChange=m,!0;c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let y=(0,M_.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(y*s);if(a-i-_<0)return this.mustTxFee=b,!0}return this.refundFeeTx=c,!1}signRefundFeeTx(t){C_(this.refundFeeTx,t,this.network,this.merkleRoot)}calculateFee(){let t=0;return this.refundFeeTx.ins.forEach((r,n)=>{t+=this.commitTxPrevOutputFetcher[n]}),this.refundFeeTx.outs.forEach(r=>{t-=r.value}),{refundFeeTxFee:t}}};fn.InscriptionRefundFeeTool=Ia;function C_(e,t,r,n=new Uint8Array){e.ins.forEach((i,s)=>{let o=(0,vo.getAddressType)(t[s].address,r),a=Aa.base.fromHex((0,vo.privateKeyFromWIF)(t[s].privateKey,r)),c=Aa.base.toHex(a),u=(0,vo.private2public)(c);if(o==="segwit_taproot"){let d=t.map(_=>yr.address.toOutputScript(_.address,r)),f=t.map(_=>_.amount),b=e.hashForWitnessV1(s,d,f,yr.Transaction.SIGHASH_DEFAULT),m=WE.taprootTweakPrivKey(a,n),y=p.Buffer.from(XE.sign(b,m,Aa.base.randomBytes(32)));i.witness=[p.Buffer.from(y)]}else if(o==="legacy"){let d=yr.address.toOutputScript(t[s].address,r),f=e.hashForSignature(s,d,yr.Transaction.SIGHASH_ALL),b=(0,vo.sign)(f,c),m=yr.payments.p2pkh({signature:yr.script.signature.encode(b,yr.Transaction.SIGHASH_ALL),pubkey:u});i.script=m.input}else{let d=zE.hash160(u),f=p.Buffer.of(25,118,169,20,...d,136,172),b=t[s].amount,m=e.hashForWitness(s,f,b,yr.Transaction.SIGHASH_ALL),y=(0,vo.sign)(m,c);i.witness=[yr.script.signature.encode(y,yr.Transaction.SIGHASH_ALL),u];let _=p.Buffer.of(22,0,20,...d);o==="segwit_nested"&&(i.script=_)}})}function k_(e,t,r){let n=Aa.base.fromHex((0,vo.privateKeyFromWIF)(r,e)),i=(0,vo.wif2Public)(r,e).slice(1),s=yr.script.OPS,o=[];o.push(i),o.push(s.OP_CHECKSIG),o.push(s.OP_FALSE),o.push(s.OP_IF),o.push(p.Buffer.from("ord")),o.push(s.OP_DATA_1),o.push(s.OP_DATA_1),o.push(p.Buffer.from(t.contentType)),o.push(s.OP_0);let a=520,c=p.Buffer.from(t.body),u=c.length;for(let I=0;I<u;I+=a){let k=I+a;k>u&&(k=u),o.push(c.slice(I,k))}o.push(s.OP_ENDIF);let d=yr.script.compile(o),f={output:d},b={output:d,redeemVersion:192},{output:m,witness:y,hash:_,address:E}=yr.payments.p2tr({internalPubkey:i,scriptTree:f,redeem:b,network:e});return{privateKey:n,inscriptionScript:d,commitTxAddress:E,commitTxAddressPkScript:m,witness:y,hash:_,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:yr.address.toOutputScript(t.revealAddr,e)}}fn.createInscriptionTxCtxData=k_;function JE(e,t){let r=Ia.newInscriptionRefundFeeTool(e,t);return r.mustTxFee>0||r.dustChange!=0?{refundFeeTx:"",mustTxFee:r.mustTxFee,dustChange:r.dustChange}:{refundFeeTx:r.refundFeeTx.toHex(),...r.calculateFee(),middleAddresses:r.commitAddrs}}fn.inscribeRefundFee=JE});var K_=H(ft=>{w();S();var QE=ft&&ft.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),eA=ft&&ft.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Jh=ft&&ft.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&QE(t,e,r);return eA(t,e),t};Object.defineProperty(ft,"__esModule",{value:!0});ft.dogInscribe=ft.DogInscriptionTool=ft.DogScript=ft.bufferToChunk=ft.bufferToBuffer=ft.CHANGE_OUTPUT_MAX_SIZE=void 0;var Ue=Jh(rn()),Ei=le(),tA=Jh(vr()),Fn=tn(),L_=rn(),Vr=$s(),rA=Jh(Ns()),Ws=ls();ft.CHANGE_OUTPUT_MAX_SIZE=20+4+34+4;var N_=2,$h=4294967293,nA=1e5,iA=1e5,sA=240,R_=1500;function U_(e){return{buf:e<=16?void 0:e<128?p.Buffer.from([e]):p.Buffer.from([e%256,e/256]),len:e<=16?0:e<128?1:2,opcodenum:e==0?0:e<=16?80+e:e<128?1:2}}function Ac(e){let t=Oa(e),r=Ws.varuint.encodingLength(t.opcodenum);var n=t.opcodenum;t.buf&&((n===Vr.OPS.OP_PUSHDATA1||n===Vr.OPS.OP_PUSHDATA2||n===Vr.OPS.OP_PUSHDATA4)&&(r+=Ws.varuint.encodingLength(t.len)),r+=t.buf.length);let i=L_.BufferWriter.withCapacity(r);return i.writeUInt8(t.opcodenum),t.buf&&(n<Vr.OPS.OP_PUSHDATA1?i.writeSlice(t.buf):n===Vr.OPS.OP_PUSHDATA1?(i.writeUInt8(t.len),i.writeSlice(t.buf)):n===Vr.OPS.OP_PUSHDATA2?(i.writeUInt64(t.len),i.writeSlice(t.buf)):n===Vr.OPS.OP_PUSHDATA4&&(i.writeUInt32(t.len),i.writeSlice(t.buf))),i.end()}ft.bufferToBuffer=Ac;function Oa(e){return{buf:e.length?e:void 0,len:e.length,opcodenum:e.length<=75?e.length:e.length<=255?76:77}}ft.bufferToChunk=Oa;function Zh(e){return{opcodenum:e}}var Ba=class{constructor(){this.chunks=[]}total(){return this.chunks.length==0?0:this.chunks.map(r=>{let n=Ws.varuint.encodingLength(r.opcodenum);var i=r.opcodenum;return r.buf&&(i<Vr.OPS.OP_PUSHDATA1||(i===Vr.OPS.OP_PUSHDATA1||i===Vr.OPS.OP_PUSHDATA2||i===Vr.OPS.OP_PUSHDATA4)&&(n+=Ws.varuint.encodingLength(r.len)),n+=r.buf.length),n}).reduce((r,n)=>r+n)}toBuffer(){let t=this.total(),r=L_.BufferWriter.withCapacity(t);for(var n=0;n<this.chunks.length;n++){var i=this.chunks[n],s=i.opcodenum;r.writeUInt8(i.opcodenum),i.buf&&(s<Vr.OPS.OP_PUSHDATA1?r.writeSlice(i.buf):s===Vr.OPS.OP_PUSHDATA1?(r.writeUInt8(i.len),r.writeSlice(i.buf)):s===Vr.OPS.OP_PUSHDATA2?(r.writeUInt64(i.len),r.writeSlice(i.buf)):s===Vr.OPS.OP_PUSHDATA4&&(r.writeUInt32(i.len),r.writeSlice(i.buf)))}return r.end()}};ft.DogScript=Ba;var Ma=class{constructor(){this.network=Ue.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new Ue.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[],this.fromAddr="",this.revealAddr=""}static newDogInscriptionTool(t,r){let n=new Ma;n.network=t;let i=r.revealOutValue||nA,s=r.minChangeValue||iA,o=r.commitTxPrevOutputList[0].privateKey;n.inscriptionTxCtxDataList=oA(t,r.inscriptionData,o),n.revealAddr=r.inscriptionData.revealAddr;let a=Ei.base.toHex(Ei.base.fromHex((0,Fn.privateKeyFromWIF)(o,t))),c=(0,Fn.private2public)(a);n.fromAddr=Ue.payments.p2pkh({pubkey:c,network:t}).address;let u=n.buildEmptyRevealTxs(t,i,r.revealFeeRate);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,u,i,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTxs(t,r,n){let i=0,s=[],o=[],a=[],c=0;for(let u=this.inscriptionTxCtxDataList.length-1;u>-1;u--){let d=this.inscriptionTxCtxDataList[u],f=new Ue.Transaction;f.version=N_,f.addInput(p.Buffer.alloc(32),0,$h),f.addInput(p.Buffer.alloc(32),1,$h),f.addOutput(u!=this.inscriptionTxCtxDataList.length-1?d.commitTxAddressPkScript:d.revealPkScript,r);let b=p.Buffer.alloc(72),m=p.Buffer.concat([d.inscriptionScript,Ac(b),Ac(d.redeemScript)]);f.ins[0].script=m,u!=this.inscriptionTxCtxDataList.length-1&&f.addOutput(Ue.address.toOutputScript(this.fromAddr,t),c),f.ins[1].script=p.Buffer.alloc(106);let y=Math.floor((f.dogeByteLength()+ft.CHANGE_OUTPUT_MAX_SIZE)*n);c+=y;let _=y;d.revealTxPrevOutput={pkScript:d.commitTxAddressPkScript,value:_},i+=_,s.push(f),o.push(y),a.push(d.commitTxAddress)}for(let u=0,d=s.length-1;u<d;u++,d--)[s[u],s[d]]=[s[d],s[u]],[o[u],o[d]]=[o[d],o[u]],[a[u],a[d]]=[a[d],a[u]];return this.revealTxs=s,this.mustRevealTxFees=o,this.commitAddrs=a,i+=r,i}buildCommitTx(t,r,n,i,s,o,a){let c=0,u=new Ue.Transaction;u.version=N_,r.forEach(y=>{let _=Ei.base.reverseBuffer(Ei.base.fromHex(y.txId));u.addInput(_,y.vOut,$h),this.commitTxPrevOutputFetcher.push(y.amount),c+=y.amount}),u.addOutput(this.inscriptionTxCtxDataList[0].revealTxPrevOutput.pkScript,s),u.addOutput(Ue.address.toOutputScript(this.fromAddr,t),i);let d=Ue.address.toOutputScript(n,t);u.addOutput(d,0);let f=u.clone();q_(f,r,this.network);let b=Math.floor((f.dogeByteLength()+ft.CHANGE_OUTPUT_MAX_SIZE)*o),m=c-i-b;if(m>=a)u.outs[u.outs.length-1].value=m;else{u.outs=u.outs.slice(0,u.outs.length-1),f.outs=f.outs.slice(0,f.outs.length-1);let y=Math.floor(f.dogeByteLength()*o);if(c-i-y<0)return this.mustCommitTxFee=b,!0}return this.commitTx=u,!1}signCommitTx(t){q_(this.commitTx,t,this.network)}completeRevealTx(){for(let t=0;t<this.revealTxs.length;t++){let r=this.revealTxs[t];r.ins[0].hash=t==0?this.commitTx.getHash():this.revealTxs[t-1].getHash(),r.ins[1].hash=t==0?this.commitTx.getHash():this.revealTxs[t-1].getHash(),this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[t].revealTxPrevOutput.value);let n=this.inscriptionTxCtxDataList[t].redeemScript,i=r.hashForSignature(0,n,Ue.Transaction.SIGHASH_ALL),s=Ei.base.toHex(this.inscriptionTxCtxDataList[t].privateKey),o=(0,Fn.sign)(i,s),a=Ue.script.signature.encode(o,Ue.Transaction.SIGHASH_ALL);r.ins[0].script=p.Buffer.concat([this.inscriptionTxCtxDataList[t].inscriptionScript,Ac(a),Ac(this.inscriptionTxCtxDataList[t].redeemScript)]);let c=Ue.address.toOutputScript(this.fromAddr,this.network),u=r.hashForSignature(1,c,Ue.Transaction.SIGHASH_ALL),d=(0,Fn.sign)(u,s),f=Ue.payments.p2pkh({signature:Ue.script.signature.encode(d,Ue.Transaction.SIGHASH_ALL),pubkey:(0,Fn.private2public)(s)});r.ins[1].script=f.input}}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s=this.revealTxPrevOutputFetcher[i],r.push(s)}),{commitTxFee:t,revealTxFees:r}}};ft.DogInscriptionTool=Ma;function q_(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Fn.getAddressType)(t[i].address,r),o=Ei.base.fromHex((0,Fn.privateKeyFromWIF)(t[i].privateKey,r)),a=Ei.base.toHex(o),c=(0,Fn.private2public)(a);if(s==="legacy"){let u=Ue.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,Ue.Transaction.SIGHASH_ALL),f=(0,Fn.sign)(d,a),b=Ue.payments.p2pkh({signature:Ue.script.signature.encode(f,Ue.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=tA.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,Ue.Transaction.SIGHASH_ALL),m=(0,Fn.sign)(b,a);n.witness=[Ue.script.signature.encode(m,Ue.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function oA(e,t,r){let n=Ei.base.fromHex((0,Fn.privateKeyFromWIF)(r,e)),i=(0,Fn.wif2Public)(r,e),s=Ue.script.OPS,o;typeof t.body=="string"?o=p.Buffer.from(t.body):o=t.body;let a=[];for(;o.length;){let d=o.slice(0,Math.min(sA,o.length));o=o.slice(d.length),a.push(d)}let c=new Ba;c.chunks.push(Oa(p.Buffer.from("ord"))),c.chunks.push(U_(a.length)),c.chunks.push(Oa(p.Buffer.from(t.contentType))),a.forEach((d,f)=>{c.chunks.push(U_(a.length-f-1)),c.chunks.push(Oa(d))});let u=[];for(;c.chunks.length;){let d=new Ba;for(u.length==0&&d.chunks.push(c.chunks.shift());d.total()<=R_&&c.chunks.length;)d.chunks.push(c.chunks.shift()),d.chunks.push(c.chunks.shift());d.total()>R_&&(c.chunks.unshift(d.chunks.pop()),c.chunks.unshift(d.chunks.pop()));let f=new Ba;f.chunks.push(Oa(i)),f.chunks.push(Zh(s.OP_CHECKSIGVERIFY)),d.chunks.forEach(()=>{f.chunks.push(Zh(s.OP_DROP))}),f.chunks.push(Zh(s.OP_TRUE));let b=Ei.base.ripemd160(Ei.base.sha256(f.toBuffer())),{output:m,address:y}=rA.p2sh({hash:p.Buffer.from(b),network:e}),_={privateKey:n,inscriptionScript:d.toBuffer(),redeemScript:f.toBuffer(),commitTxAddress:y,commitTxAddressPkScript:m,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:1e5},revealPkScript:Ue.address.toOutputScript(t.revealAddr,e)};u.push(_)}return u}function aA(e,t){let r=Ma.newDogInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}ft.dogInscribe=aA});var G_=H(dn=>{w();S();Object.defineProperty(dn,"__esModule",{value:!0});dn.verifyWithAddress=dn.getMPCSignedMessage=dn.verify=dn.sign=dn.toCompact=dn.magicHash=void 0;var Kf=ti(),nr=le(),cA=tn(),uA=p.Buffer.from(`Bitcoin Signed Message:
`);function D_(e){let t;return e<253?(t=p.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=p.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=p.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=p.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}function Df(e,t){let r=t?p.Buffer.from(t,"utf8"):uA,n=D_(r.length),i=p.Buffer.from(e),s=D_(i.length),o=p.Buffer.concat([n,r,s,i]);return nr.base.doubleSha256(o)}dn.magicHash=Df;function e0(e,t,r){if(!(e===0||e===1||e===2||e===3))throw new Error("i must be equal to 0, 1, 2, or 3");let n=e+27+4;return r||(n=n-4),p.Buffer.concat([Uint8Array.of(n),Uint8Array.from(t)])}dn.toCompact=e0;function fA(e,t,r,n){let i=Df(t,n);if(!e)return nr.base.toHex(i);let s=nr.base.fromHex((0,cA.privateKeyFromWIF)(e,r)),{signature:o,recovery:a}=Kf.signUtil.secp256k1.sign(p.Buffer.from(i),s);return nr.base.toBase64(e0(a,o,!0))}dn.sign=fA;function dA(e,t,r,n){let i=Df(t,n),s=nr.base.fromBase64(r),o=s[0]-27-4,a=s.slice(1);return Kf.signUtil.secp256k1.verify(p.Buffer.from(i),a,o,nr.base.fromHex(e))}dn.verify=dA;function lA(e,t,r){let n=nr.base.fromHex(t),i=n.slice(0,32),s=n.slice(32,64),o=Kf.signUtil.secp256k1.getV(nr.base.fromHex(e),nr.base.toHex(i),nr.base.toHex(s),nr.base.fromHex(r));return nr.base.toBase64(e0(o,n,!0))}dn.getMPCSignedMessage=lA;function hA(e,t,r,n){let i=Df(t,n),s=nr.base.fromBase64(r),o=s[0]-27,a=s.slice(1),c=o&3,u=o&8?o&4?Qh.P2WPKH:Qh.P2SH_P2WPKH:null,d=!!(o&12),f=Kf.signUtil.secp256k1.recover(a,c,p.Buffer.from(i),d);if(f==null)return!1;let b=p.Buffer.from(nr.base.hash160(f)),m,y;if(u)u===Qh.P2SH_P2WPKH?(m=F_(b),y=nr.base.fromBase58Check(e).slice(1)):(m=b,y=j_(e));else try{return y=j_(e),Lf(b,y)}catch{let E=F_(b),I=nr.base.fromBase58Check(e).slice(1);return Lf(b,I)||Lf(E,I)}return Lf(m,y)}dn.verifyWithAddress=hA;var Qh={P2WPKH:"p2wpkh",P2SH_P2WPKH:"p2sh(p2wpkh)"};function j_(e){let t=nr.base.bech32.decode(e),r=nr.base.bech32.fromWords(t.words.slice(1));return p.Buffer.from(r)}function F_(e){let t=p.Buffer.concat([p.Buffer.from("0014","hex"),e]);return p.Buffer.from(nr.base.hash160(t))}function Lf(e,t){if(!p.Buffer.isBuffer(e)||!p.Buffer.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return!0;if(typeof e.equals=="function")return e.equals(t);if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}});var ii=H(dt=>{w();S();var pA=dt&&dt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),bA=dt&&dt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),gA=dt&&dt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&pA(t,e,r);return bA(t,e),t};Object.defineProperty(dt,"__esModule",{value:!0});dt.convert2UtxoTx=dt.number2Hex=dt.TBtcWallet=dt.BtcWallet=dt.BITCOIN_MESSAGE_BIP0322_SIMPLE=dt.BITCOIN_MESSAGE_ECDSA=void 0;var Y=le(),V_=ti(),jf=le(),j=gA(ln()),Ce=ln();dt.BITCOIN_MESSAGE_ECDSA=0;dt.BITCOIN_MESSAGE_BIP0322_SIMPLE=1;var Ff=class extends Y.BaseWallet{network(){return j.networks.bitcoin}async getDerivedPath(t){return t.segwitType?t.segwitType==Y.segwitType.SEGWIT_NESTED?`m/84'/0'/0'/0/${t.index}`:t.segwitType==Y.segwitType.SEGWIT_NESTED_49?`m/49'/0'/0'/0/${t.index}`:t.segwitType==Y.segwitType.SEGWIT_NATIVE?`m/84'/0'/0'/0/${t.index}`:t.segwitType==Y.segwitType.SEGWIT_TAPROOT?`m/86'/0'/0'/0/${t.index}`:Promise.reject(Y.DerivePathError):`m/44'/0'/0'/0/${t.index}`}async validPrivateKey(t){let r;try{let{version:i}=j.wif.decode(t.privateKey);r=i===this.network().wif}catch{r=!1}let n={isValid:r,privateKey:t.privateKey};return Promise.resolve(n)}async getNewAddress(t){try{let r=this.network(),n=t.privateKey,i=t.addressType||"Legacy",s=j.wif2Public(n,r),o;i==="Legacy"?o=j.payments.p2pkh({pubkey:s,network:r}).address:i==="segwit_native"?o=j.payments.p2wpkh({pubkey:s,network:r}).address:i==="segwit_nested"?o=j.payments.p2sh({redeem:j.payments.p2wpkh({pubkey:s,network:r})}).address:i==="segwit_taproot"&&(o=j.payments.p2tr({internalPubkey:s.slice(1),network:r}).address);let a={address:o||"",publicKey:jf.base.toHex(i==="segwit_taproot"?s.slice(1):s),compressedPublicKey:jf.base.toHex(s)};return Promise.resolve(a)}catch{return Promise.reject(Y.NewAddressError)}}async validAddress(t){let r=!1,n=this.network();try{j.address.toOutputScript(t.address,n)&&(r=!0)}catch{}t.addressType&&(r=t.addressType===j.getAddressType(t.address,n));let i={isValid:r,address:t.address};return Promise.resolve(i)}async signTransaction(t){let r=t.data.type||0;if(r===j.BtcXrcTypes.INSCRIBE)try{return Promise.resolve(j.inscribe(this.network(),t.data))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT)try{return Promise.resolve(j.psbtSign(t.data.psbt,t.privateKey,this.network()))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_DECODE)try{return Promise.resolve(j.psbtDecode(t.data.psbt,this.network()))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_MPC_UNSIGNED_LIST)try{return Promise.resolve(j.generateMPCUnsignedListingPSBT(t.data.psbt,t.data.publicKey,this.network()))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_MPC_SIGNED_LIST)try{return Promise.resolve(j.generateMPCSignedListingPSBT(t.data.psbt,t.data.publicKey,t.data.signature,this.network()))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_MPC_UNSIGNED_BUY)try{return Promise.resolve(j.generateMPCUnsignedBuyingPSBT(t.data.psbt,t.data.publicKey,this.network(),t.data.batchSize))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_MPC_SIGNED_BUY)try{return Promise.resolve(j.generateMPCSignedBuyingTx(t.data.psbt,t.data.publicKey,t.data.signatureList,this.network(),t.data.batchSize))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_MPC_UNSIGNED)try{return Promise.resolve(j.generateMPCUnsignedPSBT(t.data.psbt,t.data.publicKey,this.network()))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_MPC_SIGNED)try{return Promise.resolve(j.generateMPCSignedPSBT(t.data.psbt,t.data.publicKey,t.data.signatureList,this.network()))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_KEY_SCRIPT_PATH)try{return Promise.resolve(j.signPsbtWithKeyPathAndScriptPath(t.data.psbt,t.privateKey,this.network(),{autoFinalized:t.data.autoFinalized,toSignInputs:t.data.toSignInputs}))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.PSBT_KEY_SCRIPT_PATH_BATCH)try{return Promise.resolve(j.signPsbtWithKeyPathAndScriptPathBatch(t.data.psbtHexs,t.privateKey,this.network(),t.data.options))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.SRC20)try{return Promise.resolve(j.srcInscribe(this.network(),t.data))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.RUNE)try{let n=new Ce.RuneWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.RuneTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.RUNEMAIN)try{let n=new Ce.RuneMainWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.RuneMainTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.ARC20)try{let n=new Ce.AtomicalWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.AtomicalTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Y.SignTxError)}else if(r===j.BtcXrcTypes.CAT20){let n=new Ce.CatWallet;try{return Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Y.SignTxError)}}else if(r===j.BtcXrcTypes.PSBT_RUNEMAIN)try{let n=new Ce.RuneMainWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.RuneMainTestWallet),Promise.resolve(n.buildPsbt(t))}catch{return Promise.reject(Y.SignTxError)}else{let n=null;try{let i=t.privateKey,s=Ic(t.data);return n=j.signBtc(s,i,this.network()),Promise.resolve(n)}catch{return Promise.reject(Y.SignTxError)}}}getRandomPrivateKey(){try{let t=this.network();for(;;){let r=jf.base.randomBytes(32);if((0,Y.secp256k1SignTest)(r)){let n=j.private2Wif(r,t);return Promise.resolve(n)}}}catch{return Promise.reject(Y.GenPrivateKeyError)}}getDerivedPrivateKey(t){let r=this.network();return V_.bip39.mnemonicToSeedV2(t.mnemonic).then(n=>{let i=V_.bip32.fromSeedV2(n,t.hdPath);if(!i.privateKey)return Promise.reject(Y.GenPrivateKeyError);let s=j.private2Wif(p.Buffer.from(i.privateKey),r);return Promise.resolve(s)}).catch(n=>Promise.reject(Y.GenPrivateKeyError))}getAddressByPublicKey(t){try{let r=this.network(),n=jf.base.fromHex(t.publicKey);if(t.addressType){if(t.addressType==="Legacy")return Promise.resolve(j.payments.p2pkh({pubkey:n,network:r}).address);if(t.addressType==="segwit_nested")return Promise.resolve(j.payments.p2sh({redeem:j.payments.p2wpkh({pubkey:n,network:r})}).address);if(t.addressType==="segwit_native")return Promise.resolve(j.payments.p2wpkh({pubkey:n,network:r}).address);if(t.addressType==="segwit_taproot")return Promise.resolve(j.payments.p2tr({internalPubkey:n.slice(1),network:r}).address)}else{let i=[];return i.push({addressType:"Legacy",address:j.payments.p2pkh({pubkey:n,network:r}).address}),i.push({addressType:"segwit_nested",address:j.payments.p2sh({redeem:j.payments.p2wpkh({pubkey:n,network:r})}).address}),i.push({addressType:"segwit_native",address:j.payments.p2wpkh({pubkey:n,network:r}).address}),Promise.resolve(i)}}catch{}return Promise.reject(Y.NewAddressError)}getMPCRawTransaction(t){try{let r=Ic(t.data),n=[],s={raw:j.signBtc(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(Y.GetMpcRawTransactionError)}}getMPCTransaction(t){try{let r=j.getMPCTransaction(t.raw,t.sigs,!1);return Promise.resolve(r)}catch{return Promise.reject(Y.GetMpcTransactionError)}}async getMPCRawMessage(t){try{let r=await this.signMessage0(t);return Promise.resolve({hash:r})}catch{return Promise.reject(Y.GetMpcRawTransactionError)}}async getMPCSignedMessage(t){try{return Promise.resolve(j.message.getMPCSignedMessage(t.hash,t.sigs,t.publicKey))}catch{return Promise.reject(Y.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=t.data.type||0,n=Ic(t.data);if(r===2){let i=j.signBtc(n,"",this.network(),void 0,!0,!0),s=n.dustSize||546;if(parseInt(i)>=s){let a={address:n.address,amount:parseInt(i),bip32Derivation:n.bip32Derivation};n.outputs.push(a)}let o=j.buildPsbt(n,this.network());return Promise.resolve(o)}else{let i=j.signBtc(n,"",this.network(),void 0,!0);return Promise.resolve(i)}}catch{return Promise.reject(Y.GetHardwareRawTransactionError)}}async calcTxHash(t){try{return Promise.resolve(j.Transaction.fromHex(t.data).getId())}catch{return Promise.reject(Y.CalcTxHashError)}}async signMessage(t){if(!t.privateKey)return Promise.reject(`${Y.InvalidPrivateKeyError}: cannot be empty`);let{isValid:r}=await this.validPrivateKey({privateKey:t.privateKey});return r?this.signMessage0(t):Promise.reject(`${Y.InvalidPrivateKeyError}: not valid private key`)}signMessage0(t){try{let r=t.data,n;return r.type===dt.BITCOIN_MESSAGE_ECDSA?n=j.message.sign(t.privateKey,r.message,this.network()):n=j.bip0322.signSimple(r.message,r.address,t.privateKey,this.network()),Promise.resolve(n)}catch{return Promise.reject(Y.SignMsgError)}}async signCommonMsg(t){let r=await this.getNewAddress({privateKey:t.privateKey,addressType:t.addressType}),n=r.compressedPublicKey?r.compressedPublicKey:r.publicKey;n.startsWith("0x")&&(n=n.substring(2));let i=(0,Ce.privateKeyFromWIF)(t.privateKey,this.network());return super.signCommonMsg({privateKey:t.privateKey,privateKeyHex:i,publicKey:n,addressType:t.addressType,message:t.message,signType:Y.SignType.Secp256k1})}async verifyMessage(t){try{let r=t.data;if(r.type===dt.BITCOIN_MESSAGE_ECDSA){let n=j.message.verify(r.publicKey,r.message,t.signature);return Promise.resolve(n)}else{let n=j.bip0322.verifySimple(r.message,r.address,t.signature,r.publicKey,this.network());return Promise.resolve(n)}}catch{return Promise.reject(Y.SignMsgError)}}static async extractPsbtTransaction(t){try{return Promise.resolve(j.extractPsbtTransaction(t))}catch{return Promise.reject(Y.SignMsgError)}}async validSignedTransaction(t){try{t.data&&t.data.forEach(n=>n.value=n.amount);let r=j.ValidSignedTransaction(t.tx,t.data,this.network());return Promise.resolve((0,Y.jsonStringifyUniform)(r))}catch{return Promise.reject(Y.validSignedTransactionError)}}async estimateFee(t){try{let r=t.data.type||0;if(r===j.BtcXrcTypes.INSCRIBE)return Promise.reject(Y.EstimateFeeError);if(r===j.BtcXrcTypes.PSBT)return Promise.reject(Y.EstimateFeeError);if(r===j.BtcXrcTypes.RUNE)try{let n=new Ce.RuneWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.RuneTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Y.EstimateFeeError)}else if(r===j.BtcXrcTypes.RUNEMAIN)try{let n=new Ce.RuneMainWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.RuneMainTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Y.EstimateFeeError)}else if(r===j.BtcXrcTypes.ARC20)try{let n=new Ce.AtomicalWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.AtomicalTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Y.EstimateFeeError)}else if(r===j.BtcXrcTypes.CAT20)try{let n=new Ce.CatWallet;return Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Y.EstimateFeeError)}else{let n=Ic(t.data),i=j.estimateBtcFee(n,this.network());return Promise.resolve(i)}}catch{return Promise.reject(Y.EstimateFeeError)}}static async oneKeyBuildBtcTx(t){try{return Promise.resolve(j.oneKeyBuildBtcTx(t))}catch{return Promise.reject(Y.SignTxError)}}async buildPsbt(t){if((t.data.type||0)===j.BtcXrcTypes.RUNEMAIN)try{let n=new Ce.RuneMainWallet;return this.network()===Ce.networks.testnet&&(n=new Ce.RuneMainTestWallet),Promise.resolve(n.buildPsbt(t))}catch{return Promise.reject(Y.SignTxError)}else{let n=null;return Promise.resolve(n)}}};dt.BtcWallet=Ff;var t0=class extends Ff{network(){return j.networks.testnet}};dt.TBtcWallet=t0;function yA(e,t){let r=e.toString(16),n=t-r.length;if(n>0)for(let i=0;i<n;i++)r="0"+r;return r}dt.number2Hex=yA;function Ic(e){let t=(0,Y.cloneObject)(e);return t.inputs.forEach(r=>{r.amount=(0,Y.convert2Number)(r.amount)}),t.outputs.forEach(r=>{r.amount=(0,Y.convert2Number)(r.amount)}),t.omni&&(t.omni.amount=(0,Y.convert2Number)(t.omni.amount)),e.dustSize&&(t.dustSize=(0,Y.convert2Number)(e.dustSize)),t}dt.convert2UtxoTx=Ic});var z_=H(Ai=>{w();S();var mA=Ai&&Ai.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),_A=Ai&&Ai.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),vA=Ai&&Ai.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&mA(t,e,r);return _A(t,e),t};Object.defineProperty(Ai,"__esModule",{value:!0});Ai.BchWallet=void 0;var Ca=le(),W_=le(),Oc=ii(),qe=vA(ln()),r0=class extends Oc.BtcWallet{network(){return{...super.network(),bech32:""}}async getDerivedPath(t){return`m/44'/145'/0'/0/${t.index}`}async getNewAddress(t){try{let r=this.network(),n=t.privateKey,i=qe.wif2Public(n,r),a={address:qe.GetBitcashP2PkHAddressByPublicKey(i).replace("bitcoincash:","")||"",publicKey:W_.base.toHex(i)};return Promise.resolve(a)}catch{return Promise.reject(Ca.NewAddressError)}}async validAddress(t){let r=!1;try{let i=this.network();qe.address.toOutputScript(t.address,i)&&(r=!0)}catch{}r||(r=qe.ValidateBitcashP2PkHAddress(t.address));let n={isValid:r,address:t.address};return Promise.resolve(n)}async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Oc.convert2UtxoTx)(t.data);return i.outputs.forEach(s=>{qe.isCashAddress(s.address)&&(s.address=qe.convert2LegacyAddress(s.address,this.network()))}),qe.isCashAddress(i.address)&&(i.address=qe.convert2LegacyAddress(i.address,this.network())),r=qe.signBch(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(Ca.SignTxError)}}async estimateFee(t){try{let r=(0,Oc.convert2UtxoTx)(t.data);r.outputs.forEach(i=>{qe.isCashAddress(i.address)&&(i.address=qe.convert2LegacyAddress(i.address,this.network()))}),qe.isCashAddress(r.address)&&(r.address=qe.convert2LegacyAddress(r.address,this.network()));let n=qe.estimateBchFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(Ca.EstimateFeeError)}}getMPCRawTransaction(t){try{let r=(0,Oc.convert2UtxoTx)(t.data);r.outputs.forEach(o=>{qe.isCashAddress(o.address)&&(o.address=qe.convert2LegacyAddress(o.address,this.network()))}),qe.isCashAddress(r.address)&&(r.address=qe.convert2LegacyAddress(r.address,this.network()));let n=[],s={raw:qe.signBch(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(Ca.GetMpcRawTransactionError)}}getAddressByPublicKey(t){let r=W_.base.fromHex(t.publicKey),n=qe.GetBitcashP2PkHAddressByPublicKey(r);return Promise.resolve(n.replace("bitcoincash:",""))}getMPCTransaction(t){try{let r=qe.getMPCTransaction(t.raw,t.sigs,!0);return Promise.resolve(r)}catch{return Promise.reject(Ca.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=(0,Oc.convert2UtxoTx)(t.data);r.outputs.forEach(i=>{qe.isCashAddress(i.address)&&(i.address=qe.convert2LegacyAddress(i.address,this.network()))}),qe.isCashAddress(r.address)&&(r.address=qe.convert2LegacyAddress(r.address,this.network()));let n=qe.signBch(r,"",this.network(),void 0,!0);return Promise.resolve(n)}catch{return Promise.reject(Ca.GetHardwareRawTransactionError)}}};Ai.BchWallet=r0});var X_=H(Ii=>{w();S();var wA=Ii&&Ii.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),SA=Ii&&Ii.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),xA=Ii&&Ii.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&wA(t,e,r);return SA(t,e),t};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.BsvWallet=void 0;var Bc=le(),Mc=ii(),Cc=xA(ln()),n0=class extends Mc.BtcWallet{network(){return{...super.network(),bech32:""}}async getDerivedPath(t){return`m/44'/236'/0'/0/${t.index}`}async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Mc.convert2UtxoTx)(t.data);return r=Cc.signBch(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(Bc.SignTxError)}}async estimateFee(t){try{let r=(0,Mc.convert2UtxoTx)(t.data),n=Cc.estimateBchFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(Bc.EstimateFeeError)}}getMPCRawTransaction(t){try{let r=(0,Mc.convert2UtxoTx)(t.data),n=[],s={raw:Cc.signBch(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(Bc.GetMpcRawTransactionError)}}getMPCTransaction(t){try{let r=Cc.getMPCTransaction(t.raw,t.sigs,!0);return Promise.resolve(r)}catch{return Promise.reject(Bc.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=(0,Mc.convert2UtxoTx)(t.data),n=Cc.signBch(r,"",this.network(),void 0,!0);return Promise.resolve(n)}catch{return Promise.reject(Bc.GetHardwareRawTransactionError)}}};Ii.BsvWallet=n0});var Y_=H(Ur=>{w();S();var PA=Ur&&Ur.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),TA=Ur&&Ur.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),EA=Ur&&Ur.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&PA(t,e,r);return TA(t,e),t};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.DogeWallet=Ur.dogeCoin=void 0;var Gf=EA(ln()),Vf=le(),AA=ii();Ur.dogeCoin={messagePrefix:`Dogecoin Signed Message:
`,bech32:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158};var i0=class extends AA.BtcWallet{network(){return Ur.dogeCoin}async getDerivedPath(t){return`m/44'/3'/0'/0/${t.index}`}async signTransaction(t){let r=t.data.type||0;if(r===1)try{return Promise.resolve(Gf.dogInscribe(Ur.dogeCoin,t.data))}catch{return Promise.reject(Vf.SignTxError)}else if(r===2)try{return Promise.resolve(Gf.psbtSign(t.data.psbt,t.privateKey,this.network(),t.data.maximumFeeRate?t.data.maximumFeeRate:1e5))}catch{return Promise.reject(Vf.SignTxError)}else return super.signTransaction(t)}signMessage0(t){try{let r=t.data,n=Gf.message.sign(t.privateKey,r.message,this.network(),Ur.dogeCoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Vf.SignMsgError)}}async verifyMessage(t){try{let r=t.data,n=Gf.message.verify(r.publicKey,r.message,t.signature,Ur.dogeCoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Vf.SignMsgError)}}};Ur.DogeWallet=i0});var Z_=H(Wr=>{w();S();var IA=Wr&&Wr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),OA=Wr&&Wr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),BA=Wr&&Wr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&IA(t,e,r);return OA(t,e),t};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.LtcWallet=Wr.litecoin=void 0;var ka=le(),MA=ii(),$_=BA(ln());Wr.litecoin={messagePrefix:`Litecoin Signed Message:
`,bech32:"ltc",bip32:{public:27108450,private:27106558},pubKeyHash:48,scriptHash:50,wif:176};var s0=class extends MA.BtcWallet{network(){return Wr.litecoin}async getDerivedPath(t){return t.segwitType?t.segwitType==ka.segwitType.SEGWIT_NESTED?`m/84'/2'/0'/0/${t.index}`:t.segwitType==ka.segwitType.SEGWIT_NESTED_49?`m/49'/2'/0'/0/${t.index}`:t.segwitType==ka.segwitType.SEGWIT_NATIVE?`m/84'/2'/0'/0/${t.index}`:Promise.reject(ka.DerivePathError):`m/44'/2'/0'/0/${t.index}`}signMessage0(t){try{let r=t.data,n=$_.message.sign(t.privateKey,r.message,this.network(),Wr.litecoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(ka.SignMsgError)}}async verifyMessage(t){try{let r=t.data,n=$_.message.verify(r.publicKey,r.message,t.signature,Wr.litecoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(ka.SignMsgError)}}};Wr.LtcWallet=s0});var J_=H(Gn=>{w();S();var CA=Gn&&Gn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),kA=Gn&&Gn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),HA=Gn&&Gn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&CA(t,e,r);return kA(t,e),t};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.UsdtTestWallet=Gn.UsdtWallet=void 0;var Ha=le(),Oi=ii(),Na=HA(ln()),Wf=class extends Oi.BtcWallet{async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Oi.convert2UtxoTx)(t.data);if(!i.omni)return Promise.reject(Ha.SignTxError);let s=(0,Oi.number2Hex)(i.omni.coinType||31,8),o=(0,Oi.number2Hex)(i.omni.amount,16),c={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+s+o};return i.outputs.push(c),r=Na.signBtc(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(Ha.SignTxError)}}async estimateFee(t){try{let r=(0,Oi.convert2UtxoTx)(t.data);if(!r.omni)return Promise.reject(Ha.EstimateFeeError);let n=(0,Oi.number2Hex)(r.omni.coinType||31,8),i=(0,Oi.number2Hex)(r.omni.amount,16),o={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+n+i};r.outputs.push(o);let a=Na.estimateBtcFee(r,this.network());return Promise.resolve(a)}catch{return Promise.reject(Ha.EstimateFeeError)}}getHardWareRawTransaction(t){try{let r=t.data.type||0,n=(0,Oi.convert2UtxoTx)(t.data);if(!n.omni)return Promise.reject(Ha.SignTxError);let i=(0,Oi.number2Hex)(n.omni.coinType||31,8),s=(0,Oi.number2Hex)(n.omni.amount,16),a={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+i+s};n.outputs.push(a);let c;if(r===2){let u=Na.signBtc(n,"",this.network(),void 0,!0,!0),d={address:n.address,amount:parseInt(u),bip32Derivation:n.bip32Derivation};n.outputs.push(d),c=Na.buildPsbt(n,this.network())}else c=Na.signBtc(n,"",this.network(),void 0,!0);return Promise.resolve(c)}catch{return Promise.reject(Ha.GetHardwareRawTransactionError)}}};Gn.UsdtWallet=Wf;var o0=class extends Wf{network(){return Na.networks.testnet}};Gn.UsdtTestWallet=o0});var c0=H(Ze=>{w();S();var NA=Ze&&Ze.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),RA=Ze&&Ze.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),UA=Ze&&Ze.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&NA(t,e,r);return RA(t,e),t};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.buildRuneMainMintOp=Ze.buildRuneMainMintData=Ze.buildRuneData=Ze.encodeToVecV2=Ze.toVarIntV2=Ze.fromVarInt=Ze.encodeToVec=Ze.toVarInt=void 0;var a0=UA(Ft()),kc=$s(),Q_=Xf(),qA=le(),ev=BigInt(0),CU=BigInt(2),kU=BigInt(4),HU=BigInt(6),NU=BigInt(8),RU=BigInt(10),UU=BigInt(12),qU=BigInt(14),LU=BigInt(16),KU=BigInt(118),zf=BigInt(20),tv=BigInt(22),DU=BigInt(126),jU=BigInt(1),FU=BigInt(3),GU=BigInt(5),VU=BigInt(127);function LA(e){let t=[];return Ra(e,t),new Uint8Array(t)}Ze.toVarInt=LA;function Ra(e,t){let r=18,n=new Array(19).fill(0);for(n[r]=Number(e&BigInt(127));e>BigInt(127);)e=e/BigInt(128)-BigInt(1),r--,n[r]=Number(e&BigInt(255))|128;t.push(...n.slice(r))}Ze.encodeToVec=Ra;function KA(e){let t=[];return ir(e,t),new Uint8Array(t)}Ze.toVarIntV2=KA;function ir(e,t){for(;e>>7n>0n;)t.push(Number(e&0x7fn|0x80n)),e>>=7n;return t.push(Number(e&0x7fn)),t}Ze.encodeToVecV2=ir;function DA(e){let t=BigInt(0),r=0;for(;;){let n=BigInt(e[r]);if(n<BigInt(128))return[t+n,r+1];if(t+=n-BigInt(127),t=t*BigInt(128),r++,r>=e.length)throw new Error("Varint decoding error: buffer overflow")}}Ze.fromVarInt=DA;function jA(e,t){let r=[];for(let s of t)typeof s.amount=="string"&&(s.amount=BigInt(s.amount));if(t.length>0){Ra(ev,r),t.sort((o,a)=>o.id-a.id);let s=0;for(let o of t)Ra(BigInt(o.id-s),r),Ra(BigInt(o.amount),r),Ra(BigInt(o.output),r),s=o.id}let n;return e?n="R":n="RUNE_TEST",a0.compile([kc.OPS.OP_RETURN,p.Buffer.from(n),p.Buffer.from(r)])}Ze.buildRuneData=jA;function FA(e,t,r,n,i,s){let o=[];for(let c of t)typeof c.amount=="string"&&(c.amount=BigInt(c.amount));if(i!=null&&i&&t[0].block!=null&&(ir(zf,o),ir(BigInt(t[0].block),o),ir(zf,o),ir(BigInt(t[0].id),o)),r&&(ir(tv,o),ir(BigInt(n),o)),t.length>0){ir(ev,o),t.sort((d,f)=>d.block===f.block?d.id<f.id?-1:d.id>f.id?1:0:d.block-f.block);let c=0,u=0;for(let d of t)ir(BigInt(d.block-u),o),ir(BigInt(d.id-c),o),ir(BigInt(d.amount),o),ir(BigInt(d.output),o),c=d.id,u=d.block}if(o.length>80)throw new Error(JSON.stringify({errCode:Q_.ErrCodeOpreturnExceeds,date:{payloadLenth:o.length}}));return a0.compile([kc.OPS.OP_RETURN,kc.OPS.OP_13,p.Buffer.from(o)])}Ze.buildRuneMainMintData=FA;function GA(e,t,r,n){let i=[],s=parseInt(e.split(":")[0]),o=parseInt(e.split(":")[1]);if(n!=null&&n&&o!=null&&(ir(zf,i),ir(BigInt(s),i),ir(zf,i),ir(BigInt(o),i)),t&&(ir(tv,i),ir(BigInt(r),i)),i.length>80)throw new Error(JSON.stringify({errCode:Q_.ErrCodeOpreturnExceeds,date:{payloadLenth:i.length}}));let a=a0.compile([kc.OPS.OP_RETURN,kc.OPS.OP_13,p.Buffer.from(i)]);return{address:"",amount:0,omniScript:qA.base.toHex(a)}}Ze.buildRuneMainMintOp=GA});var iv=H(Vn=>{w();S();var VA=Vn&&Vn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),WA=Vn&&Vn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),zA=Vn&&Vn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&VA(t,e,r);return WA(t,e),t};Object.defineProperty(Vn,"__esModule",{value:!0});Vn.RuneTestWallet=Vn.RuneWallet=void 0;var u0=le(),XA=ii(),nv=zA(ln()),rv=ln(),YA=c0(),$A=le(),Yf=class extends XA.BtcWallet{convert2RuneTx(t){let r=(0,u0.cloneObject)(t);for(let f of r.inputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(m.amount=BigInt(m.amount))}for(let f of r.outputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(m.amount=BigInt(m.amount))}let n=r.inputs,i=new Map;for(let f of n){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b){let y=m.id,_=BigInt(m.amount);if(y==null||_==null)continue;let E=i.get(y);E==null?i.set(y,_):i.set(y,BigInt(E)+BigInt(_))}}let s=r.outputs,o=new Map;for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(b.amount);if(m==null||y==null)continue;let _=o.get(m);_==null?o.set(m,y):o.set(m,BigInt(_)+BigInt(y))}}let a=!1;for(let f of i.keys()){let b=i.get(f),m=o.get(f);(b!=null&&m!=null&&b>m||b!=null&&m==null)&&(a=!0),a=!0}let c=0,u=[];if(a){let f={address:r.address,amount:546};u.push(f),c++}let d=[];for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(b.amount);if(m==null||y==null)continue;let _={id:parseInt("0x"+m),amount:BigInt(y),output:c};d.push(_)}f.data=null,u.push(f),c++}return{inputs:r.inputs,outputs:u,address:r.address,feePerB:r.feePerB,runeData:{edicts:d,etching:r.runeData.etching,burn:r.runeData.burn}}}async signTransaction(t){let r=this.network(),n=null;try{let i=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let s=this.convert2RuneTx(t.data),o=this.getOpReturnOutput(r,s.runeData);return s.outputs.push(o),n=(0,rv.signBtc)(s,i,r),Promise.resolve(n)}catch{return Promise.reject(u0.SignTxError)}}getOpReturnOutput(t,r){let n=!1;rv.networks.bitcoin===t&&(n=!0),r.edicts==null&&(r.edicts=[]);let i=(0,YA.buildRuneData)(n,r.edicts);return{address:"",amount:0,omniScript:$A.base.toHex(i)}}async estimateFee(t){try{if(!t.data.runeData)return Promise.reject("missing runeData");let r=this.convert2RuneTx(t.data),n=this.getOpReturnOutput(this.network(),r.runeData);r.outputs.push(n);let i=nv.estimateBtcFee(r,this.network());return Promise.resolve(i)}catch{return Promise.reject(u0.EstimateFeeError)}}};Vn.RuneWallet=Yf;var f0=class extends Yf{network(){return nv.networks.testnet}};Vn.RuneTestWallet=f0});var cv=H(Le=>{w();S();Object.defineProperty(Le,"__esModule",{value:!0});Le.isUpper=Le.commitment=Le.Tag=Le.Flag=Le.removeSpacers=Le.getSpacersVal=Le.applySpacers=Le.decodeLEB128=Le.encodeLEB128=Le.base26Decode=Le.base26Encode=void 0;var ZA=le();function sv(e){let t=0n;for(let r=0;r<e.length;r++){let n=BigInt(e.charCodeAt(r)-"A".charCodeAt(0)),i=BigInt(e.length)-1n-BigInt(r);if(i==0n)t+=n;else{let s=26n**i;t+=s*(n+1n)}}return t}Le.base26Encode=sv;function JA(e){if(e===340282366920938463463374607431768211455n)return"BCGDENLQRQWDSLRUGSNLBTMFIJAV";e+=1n;let t=[];for(;e>0;){let r=(e-1n)%26n;t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Number(r))),e=(e-1n)/26n}return t.reverse(),t.join("")}Le.base26Decode=JA;function QA(e){let t=[],r=!0;for(;r;){let n=Number(e&BigInt(127));e>>=BigInt(7),e===BigInt(0)?r=!1:n|=128,t.push(n)}return t}Le.encodeLEB128=QA;function eI(e){let t=BigInt(0);for(let r=0;r<e.length;r++){let n=BigInt(e[r]);if(r>18)throw new Error("Overlong");let i=n&BigInt(127);if(r==18&&(i&BigInt(124))!=BigInt(0))throw new Error("Overflow");if(t|=i<<BigInt(7)*BigInt(r),(n&BigInt(128))==BigInt(0))return{n:t,len:r+1}}throw new Error("Unterminated")}Le.decodeLEB128=eI;function tI(e,t){let r="";for(let n=0;n<e.length;n++)r+=e.charAt(n),t>0&&((t&1)===1&&(r+="\u2022"),t>>=1);return r}Le.applySpacers=tI;function rI(e){let t=0,r=0;for(let n=0;n<e.length;n++){let i=e.charAt(n);(i==="\u2022"||i==".")&&(t+=1<<n-1-r,r++)}return t}Le.getSpacersVal=rI;function ov(e){return e.replace(/[.]+/g,"")}Le.removeSpacers=ov;var nI;(function(e){e[e.Etching=0]="Etching",e[e.Terms=1]="Terms",e[e.Turbo=2]="Turbo",e[e.Cenotaph=127]="Cenotaph"})(nI=Le.Flag||(Le.Flag={}));var iI;(function(e){e[e.Body=0]="Body",e[e.Flags=2]="Flags",e[e.Rune=4]="Rune",e[e.Premine=6]="Premine",e[e.Cap=8]="Cap",e[e.Amount=10]="Amount",e[e.HeightStart=12]="HeightStart",e[e.HeightEnd=14]="HeightEnd",e[e.OffsetStart=16]="OffsetStart",e[e.OffsetEnd=18]="OffsetEnd",e[e.Mint=20]="Mint",e[e.Pointer=22]="Pointer",e[e.Cenotaph=126]="Cenotaph",e[e.Divisibility=1]="Divisibility",e[e.Spacers=3]="Spacers",e[e.Symbol=5]="Symbol",e[e.Nop=127]="Nop"})(iI=Le.Tag||(Le.Tag={}));function sI(e){let t;if(typeof e.value=="string"){let n=ov(e.value);if(!av(n))throw new Error("invalid rune");t=sv(n)}else t=e.value;let r=t.toString(16);return r.length%2===1&&(r="0"+r),ZA.base.fromHex(r).reverse()}Le.commitment=sI;function av(e){return/^[A-Z]+$/.test(e)}Le.isUpper=av});var yv=H(ve=>{w();S();var oI=ve&&ve.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),aI=ve&&ve.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$f=ve&&ve.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&oI(t,e,r);return aI(t,e),t};Object.defineProperty(ve,"__esModule",{value:!0});ve.buildRuneMainDeployData=ve.inscribe=ve.runesMainInscribe=ve.checkEtching=ve.MAX_SPACERS=ve.uint64Max=ve.uint128Max=ve.RunesMainInscriptionTool=void 0;var Qe=$f(rn()),cI=ti(),zs=le(),uI=$f(Si()),fI=$f(vr()),dI=qs(),Bi=tn(),lI=$f(Ft()),uv=pa(),Je=cv(),pv=cI.signUtil.schnorr.secp256k1.schnorr,fv=2,dv=4294967293,hI=546,pI=546,lv=4e6/10,wo=class{constructor(){this.network=Qe.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new Qe.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newInscriptionTool(t,r){let n=new wo;n.network=t;let i=r.revealOutValue||hI,s=r.minChangeValue||pI,o=r.runeData.useDefaultOutput||!1,a=r.runeData.defaultOutput||0,c=r.commitTxPrevOutputList[0].privateKey;if(!r.runeData.etching||!r.runeData.revealAddr)throw new Error("etching is null");if(!bv(r.runeData.etching))throw new Error("invalid etching parameter");let u=r.runeData.etching,d=(0,Je.commitment)(u.rune),f=gv(u,o,a);r.runeData.etching.contentType&&r.runeData.etching.body?n.inscriptionTxCtxDataList.push(mI(t,{contentType:r.runeData.etching.contentType,body:r.runeData.etching.body,revealAddr:r.runeData.revealAddr},c,d)):n.inscriptionTxCtxDataList.push(yI(t,c,r.runeData.revealAddr,d));let b=n.buildEmptyRevealTx(t,i,r.revealFeeRate,f);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,b,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTx(t,r,n,i){let s=0,o=[],a=[],c=[];return this.inscriptionTxCtxDataList.forEach((u,d)=>{let f=new Qe.Transaction;f.version=fv,f.addInput(p.Buffer.alloc(32),d,dv),i&&f.addOutput(i,0),f.addOutput(u.revealPkScript,r);let b=p.Buffer.alloc(64),m=p.Buffer.alloc(33),y=[];y.push(b),y.push(u.inscriptionScript),y.push(m);let _=Math.floor((f.byteLength()+Math.floor(((0,dI.vectorSize)(y)+2+3)/4))*n),E=r+_;u.revealTxPrevOutput={pkScript:u.commitTxAddressPkScript,value:E},s+=E,o.push(f),a.push(_),c.push(u.commitTxAddress)}),this.revealTxs=o,this.mustRevealTxFees=a,this.commitAddrs=c,s}buildCommitTx(t,r,n,i,s,o){let a=0,c=new Qe.Transaction;c.version=fv,r.forEach(y=>{let _=zs.base.reverseBuffer(zs.base.fromHex(y.txId));c.addInput(_,y.vOut,dv),this.commitTxPrevOutputFetcher.push(y.amount),a+=y.amount}),this.inscriptionTxCtxDataList.forEach(y=>{c.addOutput(y.revealTxPrevOutput.pkScript,y.revealTxPrevOutput.value)});let u=Qe.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();hv(d,r.map(y=>({...y,privateKey:""})),this.network);let f=(0,uv.countAdjustedVsize)(d,r.map(y=>y.address),t),b=Math.floor(f*s),m=a-i-b;if(m>=o)c.outs[c.outs.length-1].value=m;else{c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let y=(0,uv.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(y*s);if(a-i-_<0)return this.mustCommitTxFee=b,!0}return this.commitTx=c,!1}signCommitTx(t){hv(this.commitTx,t,this.network)}completeRevealTx(){this.revealTxs.forEach((t,r)=>{t.ins[0].hash=this.commitTx.getHash();let n=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.pkScript],i=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value];this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value);let s=t.hashForWitnessV1(0,n,i,Qe.Transaction.SIGHASH_DEFAULT,this.inscriptionTxCtxDataList[r].hash),o=p.Buffer.from(pv.sign(s,this.inscriptionTxCtxDataList[r].privateKey,zs.base.randomBytes(32)));t.ins[0].witness=[p.Buffer.from(o),...this.inscriptionTxCtxDataList[r].witness];let a=t.weight();if(a>lv)throw new Error(`reveal(index ${r}) transaction weight greater than ${lv} (MAX_STANDARD_TX_WEIGHT): ${a}`)})}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};ve.RunesMainInscriptionTool=wo;ve.uint128Max=(BigInt(1)<<BigInt(128))-BigInt(1);ve.uint64Max=(BigInt(1)<<BigInt(64))-BigInt(1);var bI=38;ve.MAX_SPACERS=134217727;function bv(e){let t=e.premine?BigInt(e.premine):BigInt(0);if(t>ve.uint128Max||t<0)return!1;if(e.terms){let r=e.terms.amount?BigInt(e.terms.amount):BigInt(0),n=e.terms.cap?BigInt(e.terms.cap):BigInt(0);if(r<0||r>ve.uint128Max||n<0||n>ve.uint128Max||r*n>ve.uint128Max||t+r*n>ve.uint128Max||e.terms.height&&(e.terms.height.start&&(e.terms.height.start<0||e.terms.height.start>ve.uint64Max)||e.terms.height.end&&(e.terms.height.end<0||e.terms.height.end>ve.uint64Max)))return!1}return!(e.divisibility&&(e.divisibility<0||e.divisibility>bI)||typeof e.rune.value=="string"&&((0,Je.getSpacersVal)(e.rune.value)>ve.MAX_SPACERS||(0,Je.base26Encode)((0,Je.removeSpacers)(e.rune.value))>ve.uint128Max))}ve.checkEtching=bv;function gI(e,t){let r=wo.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}ve.runesMainInscribe=gI;function hv(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Bi.getAddressType)(t[i].address,r);if(t[i].privateKey==""){let{witness:u,script:d}=(0,Bi.fakeSign)(s);u!==void 0&&(n.witness=u),d!==void 0&&(n.script=d);return}let o=zs.base.fromHex((0,Bi.privateKeyFromWIF)(t[i].privateKey,r)),a=zs.base.toHex(o),c=(0,Bi.private2public)(a);if(s==="segwit_taproot"){let u=t.map(y=>Qe.address.toOutputScript(y.address,r)),d=t.map(y=>y.amount),f=e.hashForWitnessV1(i,u,d,Qe.Transaction.SIGHASH_DEFAULT),b=uI.taprootTweakPrivKey(o),m=p.Buffer.from(pv.sign(f,b,zs.base.randomBytes(32)));n.witness=[p.Buffer.from(m)]}else if(s==="legacy"){let u=Qe.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,Qe.Transaction.SIGHASH_ALL),f=(0,Bi.sign)(d,a),b=Qe.payments.p2pkh({signature:Qe.script.signature.encode(f,Qe.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=fI.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,Qe.Transaction.SIGHASH_ALL),m=(0,Bi.sign)(b,a);n.witness=[Qe.script.signature.encode(m,Qe.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function yI(e,t,r,n){let i=zs.base.fromHex((0,Bi.privateKeyFromWIF)(t,e)),s=(0,Bi.wif2Public)(t,e).slice(1),o=[];o.push(s);let a=Qe.script.OPS;o.push(a.OP_CHECKSIG),o.push(a.OP_FALSE),o.push(a.OP_IF),o.push(n),o.push(a.OP_ENDIF);let c=Qe.script.compile(o),u={output:c},d={output:c,redeemVersion:192},{output:f,witness:b,hash:m,address:y}=Qe.payments.p2tr({internalPubkey:s,scriptTree:u,redeem:d,network:e});return{privateKey:i,inscriptionScript:c,commitTxAddress:y,commitTxAddressPkScript:f,witness:b,hash:m,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:Qe.address.toOutputScript(r,e)}}function mI(e,t,r,n){let i=zs.base.fromHex((0,Bi.privateKeyFromWIF)(r,e)),s=(0,Bi.wif2Public)(r,e).slice(1),o=Qe.script.OPS,a=[];a.push(s),a.push(o.OP_CHECKSIG),n&&n.length>0&&(a.push(n),a.push(o.OP_DROP)),a.push(o.OP_FALSE),a.push(o.OP_IF),a.push(p.Buffer.from("ord")),a.push(o.OP_DATA_1),a.push(o.OP_DATA_1),a.push(p.Buffer.from(t.contentType)),a.push(o.OP_0);let c=520,u=p.Buffer.from(t.body),d=u.length;for(let k=0;k<d;k+=c){let C=k+c;C>d&&(C=d),a.push(u.slice(k,C))}a.push(o.OP_ENDIF);let f=Qe.script.compile(a),b={output:f},m={output:f,redeemVersion:192},{output:y,witness:_,hash:E,address:I}=Qe.payments.p2tr({internalPubkey:s,scriptTree:b,redeem:m,network:e});return{privateKey:i,inscriptionScript:f,commitTxAddress:I,commitTxAddressPkScript:y,witness:_,hash:E,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:Qe.address.toOutputScript(t.revealAddr,e)}}function _I(e,t){let r=wo.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}ve.inscribe=_I;function gv(e,t,r){let n=wI(e,t,r),i=vI(n),s=p.Buffer.from("6a5d","hex"),o;if(i.length<76)o=p.Buffer.alloc(1),o.writeUint8(i.length);else if(i.length<256)o=p.Buffer.alloc(2),o.writeUint8(76),o.writeUint8(i.length,1);else if(i.length<65536)o=p.Buffer.alloc(3),o.writeUint8(77),o.writeUint16LE(i.length,1);else if(i.length<4294967296)o=p.Buffer.alloc(5),o.writeUint8(78),o.writeUint32LE(i.length,1);else throw new Error("runestone too big!");return lI.compile(p.Buffer.concat([s,o,i]))}ve.buildRuneMainDeployData=gv;function vI(e){let t=[];for(let[r,n]of e)for(let i of n){let s=p.Buffer.alloc(1);s.writeUInt8(r),t.push(s),t.push(p.Buffer.from((0,Je.encodeLEB128)(i)))}return p.Buffer.concat(t)}function wI(e,t,r){let n=new Map,i=1;if(e.terms){let o=1<<Je.Flag.Terms;i|=o}if(e.turbo){let o=1<<Je.Flag.Turbo;i|=o}n.set(Je.Tag.Flags,[BigInt(i)]);let s;if(typeof e.rune.value=="string"?s=(0,Je.base26Encode)((0,Je.removeSpacers)(e.rune.value)):s=e.rune.value,n.set(Je.Tag.Rune,[BigInt(s)]),e.divisibility&&n.set(Je.Tag.Divisibility,[BigInt(e.divisibility)]),e.spacers)n.set(Je.Tag.Spacers,[BigInt(e.spacers)]);else{let o;typeof e.rune.value=="bigint"?o=0:o=(0,Je.getSpacersVal)(e.rune.value),o!==0&&n.set(Je.Tag.Spacers,[BigInt(o)])}if(e.symbol&&n.set(Je.Tag.Symbol,[BigInt(e.symbol.charCodeAt(0))]),e.premine&&n.set(Je.Tag.Premine,[BigInt(e.premine)]),e.terms){if(e.terms.amount&&n.set(Je.Tag.Amount,[BigInt(e.terms.amount)]),e.terms.cap&&n.set(Je.Tag.Cap,[BigInt(e.terms.cap)]),e.terms.height){let o=e.terms.height.start;o&&n.set(Je.Tag.HeightStart,[BigInt(o)]);let a=e.terms.height.end;a&&n.set(Je.Tag.HeightEnd,[BigInt(a)])}if(e.terms.offset){let o=e.terms.offset.start;o&&n.set(Je.Tag.OffsetStart,[BigInt(o)]);let a=e.terms.offset.end;a&&n.set(Je.Tag.OffsetEnd,[BigInt(a)])}}return t&&r&&n.set(Je.Tag.Pointer,[BigInt(r)]),n}});var mv=H(rt=>{w();S();var SI=rt&&rt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),xI=rt&&rt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),PI=rt&&rt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&SI(t,e,r);return xI(t,e),t};Object.defineProperty(rt,"__esModule",{value:!0});rt.RuneMainTestWallet=rt.RuneMainWallet=rt.ErrCodeMultipleRuneId=rt.ErrCodeRuneIdNotStandard=rt.ErrCodeOpreturnExceeds=rt.ErrCodeLessRunesMainAmt=void 0;var So=le(),TI=ii(),xo=PI(ln()),Wn=ln(),d0=c0(),EI=le(),AI=yv();rt.ErrCodeLessRunesMainAmt=2010300;rt.ErrCodeOpreturnExceeds=2010301;rt.ErrCodeRuneIdNotStandard=2010302;rt.ErrCodeMultipleRuneId=2010303;var Zf=class extends TI.BtcWallet{convert2RuneTx(t){let r=(0,So.cloneObject)(t);r.runeData.useDefaultOutput==!0&&r.runeData.defaultOutput==null&&(r.runeData.defaultOutput=0),r.runeData.mint==!0&&r.runeData.mintNum==null&&(r.runeData.mintNUm=1);for(let f of r.inputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(r.runeData.mint?m.amount=BigInt(1):m.amount=BigInt(m.amount))}for(let f of r.outputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(r.runeData.mint?m.amount=BigInt(1):m.amount=BigInt(m.amount))}let n=r.inputs,i=new Map;for(let f of n){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b){let y=m.id,_=BigInt(1);if(r.runeData.mint||(_=BigInt(m.amount)),y==null||_==null)continue;if(y.split(":").length<=1)throw new Error(JSON.stringify({errCode:rt.ErrCodeRuneIdNotStandard,date:{runeId:y}}));let E=i.get(y);E==null?i.set(y,_):i.set(y,BigInt(E)+BigInt(_))}}if(i.size>1)throw new Error(JSON.stringify({errCode:rt.ErrCodeMultipleRuneId,date:{runeInputMapSize:i.size}}));let s=r.outputs,o=new Map;for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(1);if(r.runeData.mint||(y=BigInt(b.amount)),m==null||y==null)continue;let _=o.get(m);_==null?o.set(m,y):o.set(m,BigInt(_)+BigInt(y))}}let a=!1;for(let f of i.keys()){let b=i.get(f),m=o.get(f);(b!=null&&m!=null&&b>m||b!=null&&m==null)&&r.runeData.useDefaultOutput==!1&&(a=!0)}let c=0,u=[];if(a){let f={address:r.address,amount:546};u.push(f),c++}let d=[];for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(1);if(r.runeData.mint||(y=BigInt(b.amount)),m==null||y==null)continue;let _={block:parseInt(m.split(":")[0]),id:parseInt(m.split(":")[1]),amount:BigInt(y),output:c};d.push(_)}f.data=null,u.push(f),c++}if(r.runeData.useDefaultOutput==!0&&r.runeData.defaultOutput>u.length-1)throw new Error(JSON.stringify({errCode:rt.ErrCodeLessRunesMainAmt,date:{defaultOutput:r.runeData.defaultOutput,ouputLenth:u.length}}));return{inputs:r.inputs,outputs:u,address:r.address,feePerB:r.feePerB,runeData:{edicts:d,etching:r.runeData.etching,burn:r.runeData.burn,defaultOutput:r.runeData.defaultOutput,mint:r.runeData.mint,mintNum:r.runeData.mintNum}}}getMockMinRuneTx(t,r){let n=(0,So.cloneObject)(t),i=[],s={block:parseInt(r.id.split(":")[0]),id:parseInt(r.id.split(":")[1]),amount:BigInt(1),output:0};return i.push(s),{inputs:[{txId:n.inputs[0].txId,vOut:0,amount:600,data:[r]}],outputs:[{address:n.address,amount:546,data:r}],address:n.address,feePerB:n.feePerB,runeData:{edicts:i,etching:n.runeData.etching,burn:n.runeData.burn,defaultOutput:n.runeData.defaultOutput,mint:n.runeData.mint,mintNum:n.runeData.mintNum}}}getMinRuneTx(t,r,n,i){let s=(0,So.cloneObject)(t);return{inputs:[n],outputs:[i],address:s.address,feePerB:s.feePerB,RuneData:s.runeData}}async signTransaction(t){try{let r=this.network(),n=null;if(t.data.runeData.etching)return(0,AI.runesMainInscribe)(r,t.data);if(t.data.runeData.mintNum==null||t.data.runeData.mintNum<=1){let i=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let s=this.convert2RuneTx(t.data),o=this.getRuneMainOpReturnOutput(r,s.runeData);return s.outputs.push(o),n=(0,Wn.signBtc)(s,i,r),Promise.resolve(n)}else if(t.data.runeData.mint&&!t.data.runeData.serialMint){let i=[],s=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let o={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum},a=this.getMockMinRuneTx(t.data,o),c=this.getRuneMainOpReturnOutput(r,a.runeData);a.outputs.push(c),n=(0,Wn.signBtc)(a,s,r);let u=xo.estimateBtcFee(a,this.network())+546,d=this.convert2RuneTx(t.data),f=d.outputs.length;for(let y=0;y<o.mintNum-1;y++)d.outputs.push({address:t.data.address,amount:u});let b=this.getRuneMainOpReturnOutput(r,d.runeData);d.outputs.push(b),n=(0,Wn.signBtc)(d,s,r);let m=Wn.Transaction.fromHex(n).getId();i.push(n);for(let y=0;y<o.mintNum-1;y++){let _={txId:m,vOut:f,address:t.data.address,amount:u,data:[o]},E={address:t.data.address,amount:546};f+=1;let I=this.getMinRuneTx(t.data,o,_,E);I.outputs.push(b);let k=(0,Wn.signBtc)(I,s,r);i.push(k)}return Promise.resolve(i)}else{let i=[],s=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let o={id:t.data.outputs[0].data.id,amount:1,mintNum:t.data.runeData.mintNum},a=this.getMockMinRuneTx(t.data,o),c=(0,d0.buildRuneMainMintOp)(o.id,!1,0,!0);a.outputs.push(c);let u=xo.estimateBtcFee(a,this.network()),d=(o.mintNum-1)*u+546,f=this.convert2RuneTxSerialMint(t.data,d);f.outputs.push(c),n=(0,Wn.signBtc)(f,s,r);let b=Wn.Transaction.fromHex(n).getId();i.push(n);for(let m=1;m<o.mintNum;m++){let y={txId:b,vOut:0,address:t.data.address,amount:d};d=d-u;let _={address:t.data.address,amount:d},E=this.getMinRuneTx(t.data,o,y,_);E.outputs.push(c);let I=(0,Wn.signBtc)(E,s,r);b=Wn.Transaction.fromHex(I).getId(),i.push(I)}return Promise.resolve(i)}}catch{return Promise.reject(So.SignTxError)}}getRuneMainOpReturnOutput(t,r){let n=!1;Wn.networks.bitcoin===t&&(n=!0),r.useDefaultOutput==null&&(r.useDefaultOutput=!1),r.defaultOutput==null&&(r.defaultOutput=0),r.mint==null&&(r.mint=!1),r.mintNum==null&&(r.mintNum=0);let i=(0,d0.buildRuneMainMintData)(n,r.edicts,r.useDefaultOutput,r.defaultOutput,r.mint,r.mintNum);return{address:"",amount:0,omniScript:EI.base.toHex(i)}}async estimateFee(t){try{let r=this.network();if(!t.data.runeData)return Promise.reject("missing runeData");let n=this.convert2RuneTx(t.data),i=this.getRuneMainOpReturnOutput(this.network(),n.runeData);n.outputs.push(i);let s={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum};for(let a=0;a<s.mintNum-1;a++)n.outputs.push({address:t.data.address,amount:8e3});let o=xo.estimateBtcFee(n,this.network());if(t.data.runeData.mintNum==null||t.data.runeData.mintNum<=1)return Promise.resolve(o);if(t.data.runeData.mint&&!t.data.runeData.serialMint){let a=[];a.push(o);let c={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum},u=this.getMockMinRuneTx(t.data,c),d=this.getRuneMainOpReturnOutput(this.network(),u.runeData);u.outputs.push(d);let f=xo.estimateBtcFee(u,this.network());for(let b=0;b<t.data.runeData.mintNum-1;b++)a.push(f);return Promise.resolve(a)}else if(t.data.runeData.mint&&t.data.runeData.serialMint){let a=[];if(!t.data.runeData)return Promise.reject("missing runeData");let c={id:t.data.outputs[0].data.id,amount:1,mintNum:t.data.runeData.mintNum},u=this.getMockMinRuneTx(t.data,c),d=(0,d0.buildRuneMainMintOp)(c.id,!1,0,!0);u.outputs.push(d);let f=xo.estimateBtcFee(u,this.network()),b=(c.mintNum-1)*f+546,m=this.convert2RuneTxSerialMint(t.data,b);m.outputs.push(d);let y=xo.estimateBtcFee(m,r);a.push(y);for(let _=1;_<c.mintNum;_++)a.push(f);return Promise.resolve(a)}}catch{return Promise.reject(So.EstimateFeeError)}}convert2RuneTxSerialMint(t,r){let n=(0,So.cloneObject)(t),i=[{address:n.address,amount:r}];return{inputs:n.inputs,outputs:i,address:n.address,feePerB:n.feePerB,runeData:{edicts:n.runeData.edicts,etching:n.runeData.etching,burn:n.runeData.burn,defaultOutput:n.runeData.defaultOutput,mint:n.runeData.mint,mintNum:n.runeData.mintNum}}}convert2RuneTxPsbt(t){let r=(0,So.cloneObject)(t);return{inputs:r.inputs,outputs:r.outputs,address:r.address,feePerB:r.feePerB,runeData:{edicts:r.runeData.edicts,etching:r.runeData.etching,burn:r.runeData.burn,defaultOutput:r.runeData.defaultOutput,mint:r.runeData.mint,mintNum:r.runeData.mintNum}}}async buildPsbt(t){let r=this.network(),n=null;try{if(!t.data.runeData)return Promise.reject("missing runeData");let i=this.convert2RuneTxPsbt(t.data),s=this.getRuneMainOpReturnOutput(r,i.runeData);i.outputs.push(s);let o="KwdkfXMV2wxDVDMPPuFZsio3NeCskAUd4N2U4PriTgpj2MqAGmmc";i.dustSize==null&&(i.dustSize=546);let{inputAmount:a,outputAmount:c,virtualSize:u}=(0,Wn.calculateTxSize)(i.inputs,i.outputs,i.address,o,r,i.dustSize),d=a-c-Math.ceil(u*i.feePerB);d>i.dustSize&&i.outputs.push({address:i.address,amount:d});let b=[(0,Wn.buildPsbt)(i,r),d];return Promise.resolve(b)}catch(i){return Promise.reject(i)}}};rt.RuneMainWallet=Zf;var l0=class extends Zf{network(){return xo.networks.testnet}};rt.RuneMainTestWallet=l0});var vv=H(de=>{w();S();var II=de&&de.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),OI=de&&de.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),BI=de&&de.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&II(t,e,r);return OI(t,e),t};Object.defineProperty(de,"__esModule",{value:!0});de.AtomicalTestWallet=de.AtomicalWallet=de.ErrCodeInvalidInputAsset=de.ErrCodeAtomicalNotFullyAllocated=de.ErrCodeSemiColorOuput=de.ErrCodeMul=de.ErrCodeUnknownAsset=de.ErrCodeCommon=de.ErrCodeVoutDust=de.ErrCodeAtomicalChangeFail=de.ErrCodeLessAtomicalAmt=void 0;var h0=le(),MI=ii(),_v=BI(ln()),CI=ln();de.ErrCodeLessAtomicalAmt=2011400;de.ErrCodeAtomicalChangeFail=2011401;de.ErrCodeVoutDust=2011402;de.ErrCodeCommon=2011403;de.ErrCodeUnknownAsset=2011404;de.ErrCodeMul=2011420;de.ErrCodeSemiColorOuput=2011405;de.ErrCodeAtomicalNotFullyAllocated=2011406;de.ErrCodeInvalidInputAsset=2011407;var Jf=class extends MI.BtcWallet{convert2AtomicalTx(t){let r=(0,h0.cloneObject)(t),n=new Map,i=new Map,s=new Map,o=[],a=r.feePerB||10,c=r.dustSize||546,u=r.inputs;for(let b of u){let m=b.data;if(m!=null&&m instanceof Array)for(let y of m){let _=y.atomicalId,E=y.type,I=Number(y.amount);if(_==null||I==null||E==null||E!="FT"&&E!="NFT")continue;if(I>b.amount)throw new Error(JSON.stringify({errCode:de.ErrCodeInvalidInputAsset}));i.get(_)==null&&i.set(_,E);let k=n.get(_);k==null?n.set(_,I):n.set(_,k+I)}if(Object.keys(n).length>1)throw new Error(JSON.stringify({errCode:de.ErrCodeMul}))}let d=r.outputs,f=0;for(let b of d){let m=b.data;if(m!=null&&m instanceof Array)for(let y of m){let _=y.atomicalId,E=Number(y.amount),I=y.type;if(I=="FT"&&E!=b.amount&&E>c)throw new Error(JSON.stringify({errCode:de.ErrCodeSemiColorOuput}));if(_==null||E==null||I==null||I!="FT"&&I!="NFT")continue;if(I=="FT"&&E!=b.amount&&(f+=1,f==2))throw new Error(JSON.stringify({errCode:de.ErrCodeSemiColorOuput}));if(i.get(_)!=I)throw new Error(JSON.stringify({errCode:de.ErrCodeUnknownAsset}));let k=s.get(_);if(k==null)s.set(_,E);else if(s.set(_,k+E),I=="NFT")throw new Error(JSON.stringify({errCode:de.ErrCodeMul}))}if(Object.keys(s).length>1)throw new Error(JSON.stringify({errCode:de.ErrCodeMul}));o.push({amount:b.amount,address:b.address})}for(let b of n.keys()){let m=n.get(b),y=s.get(b);if(m!=y)throw new Error(JSON.stringify({errCode:de.ErrCodeAtomicalNotFullyAllocated,date:{atomicalId:b,inputAmount:m,sendAmount:y}}))}for(let[b,m]of o.entries())if(m.amount<c)throw new Error(JSON.stringify({errCode:de.ErrCodeVoutDust,vOut:b}));return{inputs:r.inputs,outputs:o,address:r.address,feePerB:a}}async signTransaction(t){let r=this.network(),n=null;try{let i=t.privateKey,s=this.convert2AtomicalTx(t.data);return n=(0,CI.signBtc)(s,i,r),Promise.resolve(n)}catch{return Promise.reject(h0.SignTxError)}}async estimateFee(t){try{let r=this.convert2AtomicalTx(t.data),n=_v.estimateBtcFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(h0.EstimateFeeError)}}};de.AtomicalWallet=Jf;var p0=class extends Jf{network(){return _v.networks.testnet}};de.AtomicalTestWallet=p0});var wv=H(Qf=>{w();S();Object.defineProperty(Qf,"__esModule",{value:!0});Qf.MAX_TOTAL_SUPPLY=void 0;var kI=2147483647n;Qf.MAX_TOTAL_SUPPLY=kI});var b0=H(qr=>{w();S();Object.defineProperty(qr,"__esModule",{value:!0});qr.MinterType=qr.CHANGE_MIN_POSTAGE=qr.Postage=qr.SupportedNetwork=qr.CatAddressType=void 0;var HI;(function(e){e.P2WPKH="p2wpkh",e.P2TR="p2tr"})(HI=qr.CatAddressType||(qr.CatAddressType={}));var NI;(function(e){e.btcSignet="btc-signet",e.fractalMainnet="fractal-mainnet",e.fractalTestnet="fractal-testnet"})(NI=qr.SupportedNetwork||(qr.SupportedNetwork={}));var RI;(function(e){e[e.METADATA_POSTAGE=546]="METADATA_POSTAGE",e[e.GUARD_POSTAGE=332]="GUARD_POSTAGE",e[e.MINTER_POSTAGE=331]="MINTER_POSTAGE",e[e.TOKEN_POSTAGE=330]="TOKEN_POSTAGE"})(RI=qr.Postage||(qr.Postage={}));qr.CHANGE_MIN_POSTAGE=546;var UI;(function(e){e.OPEN_MINTER_V1="21cbd2e538f2b6cc40ee180e174f1e25",e.OPEN_MINTER_V2="a6c2e92d74a23c07bb6220b676c6cb9b",e.UNKOWN_MINTER="unkown_minter"})(UI=qr.MinterType||(qr.MinterType={}))});var xv=H(Sv=>{w();S();Object.defineProperty(Sv,"__esModule",{value:!0})});var Tv=H(ed=>{w();S();Object.defineProperty(ed,"__esModule",{value:!0});ed.isOpenMinter=void 0;var Pv=b0();function qI(e){return Pv.MinterType.OPEN_MINTER_V1===e||Pv.MinterType.OPEN_MINTER_V2===e}ed.isOpenMinter=qI});var Ev=H(td=>{w();S();Object.defineProperty(td,"__esModule",{value:!0});td.btc=void 0;var LI=Ka();Object.defineProperty(td,"btc",{enumerable:!0,get:function(){return LI.btc}})});var Iv=H(Av=>{w();S();Object.defineProperty(Av,"__esModule",{value:!0})});var Mi=H(zn=>{w();S();var KI=zn&&zn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ua=zn&&zn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&KI(t,e,r)};Object.defineProperty(zn,"__esModule",{value:!0});Ua(wv(),zn);Ua(b0(),zn);Ua(xv(),zn);Ua(Tv(),zn);Ua(Ev(),zn);Ua(Iv(),zn)});var Hc=H(X=>{w();S();Object.defineProperty(X,"__esModule",{value:!0});X.getFee=X.getDummySignature=X.getDummyEcKey=X.verifyContract=X.toTokenAddress=X.resetTx=X.scaleByDecimals=X.toP2tr=X.p2tr2Address=X.toBitcoinNetwork=X.toStateScript=X.callToBufferList=X.getDummyUTXO=X.dummyUTXO=X.getDummySigner=X.outpoint2ByteString=X.outpoint2TxOutpoint=X.toTxOutpoint=X.getTokenContractP2TR=X.getTokenContract=X.getGuardsP2TR=X.GuardType=X.script2P2TR=X.contract2P2TR=X.strToByteString=X.byteStringToBuffer=X.toXOnly=void 0;var g0=Ka(),mr=Mi(),To=Kc(),Po=fw(),m0=W0(),DI=_0(),jI=tn(),rd="0250929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0";function FI(e){return e.subarray(1,33)}X.toXOnly=FI;var GI=function(e){let t=[];for(let r of e)t.push(p.Buffer.from(r,"hex"));return t};X.byteStringToBuffer=GI;function VI(e){return(0,To.toByteString)(p.Buffer.from(e,"utf-8").toString("hex"))}X.strToByteString=VI;function Ov(e){let t=e.lockingScript.toBuffer();return{...Bv(t),script:t.toString("hex"),contract:e}}X.contract2P2TR=Ov;function Bv(e){let t=Po.Tap.encodeScript(e),[r,n]=Po.Tap.getPubKey(rd,{target:t});return{p2tr:new mr.btc.Script(`OP_1 32 0x${r}}`).toHex(),tapScript:t,cblock:n}}X.script2P2TR=Bv;var y0;(function(e){e[e.Transfer=0]="Transfer",e[e.Burn=1]="Burn"})(y0=X.GuardType||(X.GuardType={}));function Mv(e=y0.Transfer){let t=new g0.BurnGuard,r=new g0.TransferGuard,n=Po.Tap.encodeScript(t.lockingScript.toBuffer()),i=Po.Tap.encodeScript(r.lockingScript.toBuffer()),s=[n,i],[o]=Po.Tap.getPubKey(rd,{tree:s}),[,a]=Po.Tap.getPubKey(rd,{target:n,tree:s}),[,c]=Po.Tap.getPubKey(rd,{target:i,tree:s}),u=new mr.btc.Script(`OP_1 32 0x${o}}`).toHex();return e===y0.Transfer?{p2tr:u,tapScript:i,cblock:c,script:r.lockingScript.toBuffer().toString("hex"),contract:r}:{p2tr:u,tapScript:n,cblock:a,script:t.lockingScript.toBuffer().toString("hex"),contract:t}}X.getGuardsP2TR=Mv;function Cv(e,t){return new g0.CAT20(e,(0,To.toByteString)(t))}X.getTokenContract=Cv;function WI(e){let{p2tr:t}=Mv();return Ov(Cv(e,t))}X.getTokenContractP2TR=WI;function kv(e,t){let r=p.Buffer.alloc(4,0);return r.writeUInt32LE(t),{txhash:p.Buffer.from(e,"hex").reverse().toString("hex"),outputIndex:r.toString("hex")}}X.toTxOutpoint=kv;function Hv(e){let[t,r]=e.split("_");return kv(t,parseInt(r))}X.outpoint2TxOutpoint=Hv;var zI=function(e){let t=Hv(e);return t.txhash+t.outputIndex};X.outpoint2ByteString=zI;function XI(e){return To.TestWallet.random(new To.DummyProvider)}X.getDummySigner=XI;X.dummyUTXO={txId:(0,m0.randomBytes)(32).toString("hex"),outputIndex:0,script:"",satoshis:1e4};function YI(e=1e4,t=!1){return t?Object.assign({},X.dummyUTXO,{satoshis:e,txId:(0,m0.randomBytes)(32).toString("hex")}):Object.assign({},X.dummyUTXO,{satoshis:e})}X.getDummyUTXO=YI;var $I=function(e){return e.tx.inputs[e.atInputIndex].script.chunks.map(r=>{if(!r.buf)if(r.opcodenum>=81&&r.opcodenum<=96){let n=(0,To.int2ByteString)(BigInt(r.opcodenum-80));return p.Buffer.from(n,"hex")}else return p.Buffer.from((0,To.toByteString)(""));return r.buf})};X.callToBufferList=$I;var ZI=function(e){return new mr.btc.Script(`6a1863617401${e.hashRoot}`)};X.toStateScript=ZI;function Nv(e){return e==="btc-signet"?mr.btc.Networks.testnet:mr.btc.Networks.mainnet}X.toBitcoinNetwork=Nv;function JI(e,t){let r=typeof e=="string"?mr.btc.Script.fromHex(e):e;return mr.btc.Address.fromScript(r,Nv(t)).toString()}X.p2tr2Address=JI;function QI(e){if((typeof e=="string"?mr.btc.Address.fromString(e):e).type!=="taproot")throw new Error(`address ${e} is not taproot`);return mr.btc.Script.fromAddress(e).toHex()}X.toP2tr=QI;function eO(e,t){return e*BigInt(Math.pow(10,t))}X.scaleByDecimals=eO;function tO(e){for(let t=0;t<e.inputs.length;t++){let r=e.inputs[t];r.hasWitnesses()&&r.setWitnesses([])}e.nLockTime=0}X.resetTx=tO;function rO(e){if(typeof e=="string"&&(e=mr.btc.Address.fromString(e)),e.type===mr.btc.Address.PayToTaproot)return(0,To.hash160)(e.hashBuffer.toString("hex"));if(e.type===mr.btc.Address.PayToWitnessPublicKeyHash)return e.hashBuffer.toString("hex");throw new Error(`Unsupported address type: ${e.type}`)}X.toTokenAddress=rO;function nO(e,t,r,n){let i=new mr.btc.Script.Interpreter,s=mr.btc.Script.Interpreter.SCRIPT_VERIFY_WITNESS|mr.btc.Script.Interpreter.SCRIPT_VERIFY_TAPROOT;return i.verify(new mr.btc.Script(""),new mr.btc.Script(e.script),t,r,s,n,e.satoshis)?!0:i.errstr}X.verifyContract=nO;function iO(){let e=(0,m0.randomBytes)(32),t=(0,jI.private2Wif)(e);return new DI.EcKeyService({privateKey:t})}X.getDummyEcKey=iO;function sO(){return mr.btc.crypto.Signature.fromString("E907831F80848D1069A5371B402410364BDF1C5F8307B0084C55F1CE2DCA821525F66A4A85EA8B71E482A74F382D2CE5EBEEE8FDB2172F477DF4900D310536C0").toString("hex")}X.getDummySignature=sO;function oO(e){return e.inputs.reduce((t,r)=>t+r.output.satoshis,0)-e.outputs.reduce((t,r)=>t+r.satoshis,0)}X.getFee=oO});var _0=H(nd=>{w();S();Object.defineProperty(nd,"__esModule",{value:!0});nd.EcKeyService=void 0;var Eo=Mi(),es=Mi(),Rv=Kc(),aO=Hc(),v0=class{constructor(t){if(this.addressType=t.addressType||es.CatAddressType.P2TR,!t.privateKey&&!t.publicKey)throw new Error("Either privateKey or publicKey must be provided");this.privateKey=t.privateKey?Eo.btc.PrivateKey.fromWIF(t.privateKey):void 0,this.publicKey=t.privateKey?this.privateKey.toPublicKey():Eo.btc.PublicKey.fromString(t.publicKey)}hasPrivateKey(){return this.privateKey!==void 0}getWif(){return this.getPrivateKey().toWIF()}getPrivateKey(){return this.privateKey}getAddressType(){return this.addressType||es.CatAddressType.P2TR}getP2TRAddress(){return this.getPublicKey().toAddress(null,Eo.btc.Address.PayToTaproot)}getAddress(){return this.getP2TRAddress()}getXOnlyPublicKey(){let t=this.getTokenPublicKey();return(0,aO.toXOnly)(t.toBuffer()).toString("hex")}getTweakedPrivateKey(){let{tweakedPrivKey:t}=this.getPrivateKey().createTapTweak();return Eo.btc.PrivateKey.fromBuffer(t)}getPublicKey(){return this.publicKey}getTokenPublicKey(){if(this.getAddressType()===es.CatAddressType.P2TR){let{tweakedPubKey:r}=this.publicKey.createTapTweak();return Eo.btc.PublicKey.fromBuffer(r)}return this.publicKey}getPubKeyPrefix(){let t=this.getAddressType();return t===es.CatAddressType.P2TR?"":t===es.CatAddressType.P2WPKH?this.getTokenPublicKey().toString().slice(0,2):""}getTokenAddress(){let t=this.getAddressType();if(t===es.CatAddressType.P2TR){let r=this.getXOnlyPublicKey();return(0,Rv.hash160)(r)}else if(t===es.CatAddressType.P2WPKH){let r=this.getTokenPublicKey();return(0,Rv.hash160)(r.toString())}else throw new Error(`Unsupported address type: ${t}`)}getTaprootPrivateKey(){return this.getTweakedPrivateKey()}getTokenPrivateKey(){let t=this.getAddressType();if(t===es.CatAddressType.P2TR)return this.getTaprootPrivateKey();if(t===es.CatAddressType.P2WPKH)return this.getPrivateKey();throw new Error(`Unsupported address type: ${t}`)}signTx(t){if(!this.hasPrivateKey())throw new Error("No private key provided");let r=this.getPrivateKey(),n=Eo.btc.crypto.Hash.sha256ripemd160(r.publicKey.toBuffer());for(let i=0;i<t.inputs.length;i++){let s=t.inputs[i];if(s.output.script.isWitnessPublicKeyHashOut()){let o=s.getSignatures(t,r,i,void 0,n,void 0,void 0);if(o.length===0)throw new Error("Could not sign input");t.applySignature(o[0])}else if(s.output.script.isTaproot()&&!s.hasWitnesses()){let o=s.getSignatures(t,r,i,Eo.btc.crypto.Signature.SIGHASH_ALL,n,void 0,void 0);if(o.length===0)throw new Error("Could not sign input");t.applySignature(o[0])}}}};nd.EcKeyService=v0});var Uv=H(Ci=>{w();S();Object.defineProperty(Ci,"__esModule",{value:!0});Ci.scaleConfig=Ci.tokenUtxoParse=Ci.feeUtxoParse=Ci.tokenInfoParse=void 0;var cO=Mi(),uO=Ka(),Ao=Hc();function fO(e,t){let r=JSON.parse(e),n=JSON.parse(JSON.stringify(r.info));if(n.max&&(n.max=BigInt(n.max),n.premine=BigInt(n.premine),n.limit=BigInt(n.limit)),r.info=n,!r.tokenAddr){let i=(0,Ao.toP2tr)(r.minterAddr);r.tokenAddr=(0,Ao.p2tr2Address)((0,Ao.getTokenContractP2TR)(i).p2tr,t)}return r}Ci.tokenInfoParse=fO;function dO(e,t){return t.map(r=>{let n=cO.btc.Script.fromAddress(e.getAddress()).toHex();return{txId:r.txId,outputIndex:r.vOut,script:n,satoshis:r.amount}})}Ci.feeUtxoParse=dO;function lO(e){let t=JSON.parse(e);return Array.isArray(t)||(t=[t]),t.map(r=>{let n=uO.ProtocolState.fromStateHashList(r.txoStateHashes);typeof r.utxo.satoshis=="string"&&(r.utxo.satoshis=parseInt(r.utxo.satoshis));let i=r.state.address;try{i=(0,Ao.toTokenAddress)(r.state.address)}catch{}return{utxo:r.utxo,state:{protocolState:n,data:{ownerAddr:i,amount:BigInt(r.state.amount)}}}})}Ci.tokenUtxoParse=lO;function hO(e){let t=Object.assign({},e);return t.max=(0,Ao.scaleByDecimals)(e.max,e.decimals),t.premine=(0,Ao.scaleByDecimals)(e.premine,e.decimals),t.limit=(0,Ao.scaleByDecimals)(e.limit,e.decimals),t}Ci.scaleConfig=hO});var Kv=H(id=>{w();S();Object.defineProperty(id,"__esModule",{value:!0});id.validatePrevTx=void 0;var qv=Mi(),Lv=Hc();function pO(e,t,r,n){let i=0,s=new qv.btc.Transaction(t);if(!s.inputs.find((u,d)=>{let f=u.getWitnesses();if(Array.isArray(f)&&f.length>2){let b=f[f.length-2],{p2tr:m}=(0,Lv.script2P2TR)(b),y=(0,Lv.p2tr2Address)(m,n);if(y===e.tokenAddr||y===e.minterAddr)return i=d,!0}}))return null;let a=s.inputs[i].prevTxId.toString("hex"),c=new qv.btc.Transaction(r);return c.id!=a?null:{prevTx:s,prevPrevTx:c,prevTokenInputIndex:i}}id.validatePrevTx=pO});var Dv=H(sd=>{w();S();Object.defineProperty(sd,"__esModule",{value:!0});sd.pickLargeFeeUtxo=void 0;function bO(e){let t=e[0];for(let r of e)r.satoshis>t.satoshis&&(t=r);return t}sd.pickLargeFeeUtxo=bO});var Rc=H(si=>{w();S();var gO=si&&si.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Nc=si&&si.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&gO(t,e,r)};Object.defineProperty(si,"__esModule",{value:!0});Nc(_0(),si);Nc(Uv(),si);Nc(Kv(),si);Nc(Hc(),si);Nc(Dv(),si)});var w0=H(Ys=>{w();S();Object.defineProperty(Ys,"__esModule",{value:!0});Ys.unlockGuard=Ys.unlockToken=Ys.createGuardContract=void 0;var yO=Rc(),Io=Mi(),Xn=Rc(),Xs=Ka(),Uc=Kc();function mO(e,t,r,n,i,s){let{p2tr:o,tapScript:a}=(0,Xn.getGuardsP2TR)(),c=Xs.ProtocolState.getEmptyState(),u=Xs.GuardProto.createEmptyState();u.tokenScript=i;for(let b=0;b<n.length;b++)u.inputTokenAmountArray[b]=n[b].state.data.amount;c.updateDataList(0,Xs.GuardProto.toByteString(u));let d=new Io.btc.Transaction().from(t).addOutput(new Io.btc.Transaction.Output({satoshis:0,script:(0,Xn.toStateScript)(c)})).addOutput(new Io.btc.Transaction.Output({satoshis:Io.Postage.GUARD_POSTAGE,script:o})).feePerByte(r).change(s);if(d.getChangeOutput()===null)throw new Error("Insufficient satoshis balance!");d.outputs[2].satoshis-=1,e.hasPrivateKey()&&e.signTx(d);let f={utxo:{txId:d.id,outputIndex:1,script:d.outputs[1].script.toHex(),satoshis:d.outputs[1].satoshis},state:{protocolState:c,data:u}};return{commitTx:d,contact:f,guardTapScript:a}}Ys.createGuardContract=mO;async function _O(e,t,r,n,i,s,o,a,c,u,d,f,b,m){let{cblock:y,contract:_}=(0,Xn.getTokenContractP2TR)(c),{shPreimage:E,prevoutsCtx:I,spentScripts:k,sighash:C}=u,R={isUserSpend:!1,userPubKeyPrefix:(0,Uc.toByteString)(""),userPubKey:(0,Uc.PubKey)(e.getXOnlyPublicKey()),userSig:(0,yO.getDummySignature)(),contractInputIndex:BigInt(m||0)};if(!b){let l;e.hasPrivateKey()?l=Io.btc.crypto.Schnorr.sign(e.getTokenPrivateKey(),C.hash):l=Io.btc.crypto.Signature.fromString(f);let g=e.getXOnlyPublicKey();R={isUserSpend:!0,userPubKeyPrefix:e.getPubKeyPrefix(),userPubKey:(0,Uc.PubKey)(g),userSig:l.toString("hex"),contractInputIndex:0n}}let N=(0,Xs.getBackTraceInfo)(n,s,i),{state:{protocolState:U,data:q}}=t;await _.connect((0,Xn.getDummySigner)());let L={statesHashRoot:U.hashRoot,txoStateHashes:U.stateHashList},V=await _.methods.unlock(R,q,L,o,N,E,I,k,{fromUTXO:(0,Xn.getDummyUTXO)(),verify:!1,exec:!1}),O=[...(0,Xn.callToBufferList)(V),_.lockingScript.toBuffer(),p.Buffer.from(y,"hex")];if(a.inputs[r].witnesses=O,d){let l=(0,Xn.verifyContract)(t.utxo,a,r,O);if(typeof l=="string")throw new Error(`unlocking token contract at input ${r} failed! ${l}`);return!0}return!0}Ys.unlockToken=_O;async function vO(e,t,r,n,i,s,o,a,c,u){let{shPreimage:d,prevoutsCtx:f,spentScripts:b}=c,m=(0,Xs.emptyTokenArray)(),y=(0,Xs.emptyTokenAmountArray)(),_=(0,Uc.fill)(!1,Xs.MAX_TOKEN_OUTPUT);m[0]=s.ownerAddr,y[0]=s.amount,_[0]=!0,o&&(m[1]=o.ownerAddr,y[1]=o.amount,_[1]=!0);let E=o===null?1:2,{cblock:I,contract:k}=(0,Xn.getGuardsP2TR)();await k.connect((0,Xn.getDummySigner)());let C=(0,Xs.emptyTokenArray)();a!=null&&(C[E]=a.satoshis,m[E]=a.script,_[E]=!1);let R=await k.methods.transfer(n.stateHashList,m,y,_,C,(0,Uc.int2ByteString)(BigInt(Io.Postage.TOKEN_POSTAGE),8n),e.state.data,t.tx,d,f,b,{fromUTXO:(0,Xn.getDummyUTXO)(),verify:!1,exec:!1}),N=[...(0,Xn.callToBufferList)(R),k.lockingScript.toBuffer(),p.Buffer.from(I,"hex")];if(i.inputs[r].witnesses=N,u){let U=(0,Xn.verifyContract)(e.utxo,i,r,N);if(typeof U=="string")throw new Error(`unlocking guard contract failed! ${U}`);return!0}return!0}Ys.unlockGuard=vO});var S0=H(od=>{w();S();Object.defineProperty(od,"__esModule",{value:!0});od.mergeFee=void 0;var wO=Mi();function SO(e,t,r){let n=e.getAddress(),i=new wO.btc.Transaction().from(t).feePerByte(r).change(n);if(i.getChangeOutput()===null)throw new Error("Insufficient satoshis balance!");let s=i.outputs[0];s.satoshis-=1,e.hasPrivateKey()&&e.signTx(i);let o={address:n,txId:i.id,outputIndex:0,script:s.script,satoshis:s.satoshis};return{mergeTx:i,feeUtxo:o}}od.mergeFee=SO});var Fv=H(ki=>{w();S();Object.defineProperty(ki,"__esModule",{value:!0});ki.calcVsizeTransfer=ki.transfer=ki.estimateFee=void 0;var zr=Mi(),x0=Kc(),Ir=Rc(),ts=Ka(),qc=w0(),xO=S0();async function PO(e){return e.data.estimateFee=!0,await jv(e)}ki.estimateFee=PO;async function jv(e){let t=e.data,r=t.estimateFee?(0,Ir.getDummyEcKey)():new Ir.EcKeyService({privateKey:e.privateKey}),n=(0,Ir.tokenInfoParse)(t.tokenMetadata,zr.SupportedNetwork.fractalMainnet),i=(0,Ir.toP2tr)(n.minterAddr),{p2tr:s,tapScript:o}=(0,Ir.getTokenContractP2TR)(i),a=t.verifyScript||!1,c,u;try{c=zr.btc.Address.fromString(t.toAddress)}catch{throw new Error(`Invalid receiver address: ${t.toAddress}`)}if(c.type!=="taproot")throw new Error(`Invalid address type: ${c.type}`);try{u=BigInt(t.tokenAmount)}catch{throw new Error(`Invalid token amount:  ${t.tokenAmount}`)}if(u<=0n)throw new Error("Invalid token amount");let d=(0,Ir.feeUtxoParse)(r,e.data.feeInputs),f=d[0],b;d.length>1&&({feeUtxo:f,mergeTx:b}=(0,xO.mergeFee)(r,d,t.feeRate));let m=(0,Ir.tokenUtxoParse)(t.tokens),y=(0,qc.createGuardContract)(r,f,t.feeRate,m,s,t.changeAddress);if(y===null)return null;let{commitTx:_,contact:E,guardTapScript:I}=y,k=ts.ProtocolState.getEmptyState(),C=ts.CAT20Proto.create(u,(0,Ir.toTokenAddress)(c));k.updateDataList(0,ts.CAT20Proto.toByteString(C));let N=m.reduce((K,F)=>K+F.state.data.amount,0n)-u,U=null;if(N>0n){let K=r.getTokenAddress();U=ts.CAT20Proto.create(N,K),k.updateDataList(1,ts.CAT20Proto.toByteString(U))}let q={txId:_.id,outputIndex:2,script:_.outputs[2].script.toHex(),satoshis:_.outputs[2].satoshis},L=[...m.map(K=>K.utxo),E.utxo,q];if(L.length>ts.MAX_INPUT)throw new Error("Too many inputs, max 4 token inputs");let V=new zr.btc.Transaction().from(L).addOutput(new zr.btc.Transaction.Output({satoshis:0,script:(0,Ir.toStateScript)(k)})).addOutput(new zr.btc.Transaction.Output({satoshis:zr.Postage.TOKEN_POSTAGE,script:s})).feePerByte(t.feeRate);U&&V.addOutput(new zr.btc.Transaction.Output({satoshis:zr.Postage.TOKEN_POSTAGE,script:s}));let O=zr.btc.Script.fromAddress(t.changeAddress);V.addOutput(new zr.btc.Transaction.Output({satoshis:0,script:O}));let l=[];if(t.tokenPrevTxs.length!==m.length)throw new Error("Invalid tokenPrevTxs length");for(let K=0;K<m.length;K++){let F=t.tokenPrevTxs[K].prevTx,Z=t.tokenPrevTxs[K].prevPrevTx,ce=(0,Ir.validatePrevTx)(n,F,Z,zr.SupportedNetwork.fractalMainnet);if(ce===null)throw new Error("prevTx does not match prevPrevTx");l.push(ce)}let g=(0,ts.getTxHeaderCheck)(_,E.utxo.outputIndex),v=m.length,P={outputIndex:(0,Ir.toTxOutpoint)(E.utxo.txId,E.utxo.outputIndex).outputIndex,inputIndexVal:BigInt(v),tx:g.tx,guardState:E.state.data},{vsize:x}=await(0,ki.calcVsizeTransfer)(m,E,V,P,l,o,I,k,C,U,O,i),B=U===null?2:3,M=V.inputAmount-x*t.feeRate-zr.Postage.TOKEN_POSTAGE-(U===null?0:zr.Postage.TOKEN_POSTAGE),T=x*t.feeRate;if(M<=zr.CHANGE_MIN_POSTAGE){M=0,V.removeOutput(B);let{vsize:K,fee:F}=await(0,ki.calcVsizeTransfer)(m,E,V,P,l,o,I,k,C,U,O,i);x=K,T=F}else V.outputs[B].satoshis=M;if(t.estimateFee)return b?{mergeTx:(0,Ir.getFee)(b),commitTx:(0,Ir.getFee)(_),revealTx:T}:{commitTx:(0,Ir.getFee)(_),revealTx:T};let h=null;M>BigInt(0)&&(h={script:(0,x0.toByteString)(O.toHex()),satoshis:(0,x0.int2ByteString)(BigInt(M),BigInt(8))});let A=(0,ts.getTxCtxMulti)(V,m.map((K,F)=>F).concat([m.length]),[...new Array(m.length).fill(p.Buffer.from(o,"hex")),p.Buffer.from(I,"hex")]);for(let K=0;K<m.length;K++)if(!await(0,qc.unlockToken)(r,m[K],K,l[K].prevTx,l[K].prevTokenInputIndex,l[K].prevPrevTx,P,V,i,A[K],a))return null;return await(0,qc.unlockGuard)(E,P,v,k,V,C,U,h,A[v],a)?(r.signTx(V),b?{mergeTx:b.uncheckedSerialize(),commitTx:_.uncheckedSerialize(),revealTx:V.uncheckedSerialize()}:{commitTx:_.uncheckedSerialize(),revealTx:V.uncheckedSerialize()}):null}ki.transfer=jv;var TO=async(e,t,r,n,i,s,o,a,c,u,d,f)=>{let b=(0,Ir.getDummyEcKey)(),m=zr.btc.Script.fromAddress(b.getAddress()),y=r.inputs.length-1,_=r.inputs[y].output.script;r.inputs[y].output.setScript(m);let E=(0,ts.getTxCtxMulti)(r,e.map((N,U)=>U).concat([e.length]),[...new Array(e.length).fill(p.Buffer.from(s,"hex")),p.Buffer.from(o,"hex")]),I=e.length,k={script:d.toHex(),satoshis:(0,x0.int2ByteString)(0n,8n)};for(let N=0;N<e.length;N++)await(0,qc.unlockToken)(b,e[N],N,i[N].prevTx,i[N].prevTokenInputIndex,i[N].prevPrevTx,n,r,f,E[N],!1);await(0,qc.unlockGuard)(t,n,I,a,r,c,u,k,E[I],!1),b.signTx(r);let C=r.vsize,R=(0,Ir.getFee)(r);return(0,Ir.resetTx)(r),r.inputs[y].output.setScript(_),{vsize:C,fee:R}};ki.calcVsizeTransfer=TO});var Gv=H(rs=>{w();S();var EO=rs&&rs.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),P0=rs&&rs.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&EO(t,e,r)};Object.defineProperty(rs,"__esModule",{value:!0});P0(w0(),rs);P0(S0(),rs);P0(Fv(),rs)});var E0=H(ns=>{w();S();var AO=ns&&ns.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),T0=ns&&ns.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&AO(t,e,r)};Object.defineProperty(ns,"__esModule",{value:!0});T0(Mi(),ns);T0(Gv(),ns);T0(Rc(),ns)});var zv=H(ad=>{w();S();Object.defineProperty(ad,"__esModule",{value:!0});ad.CatWallet=void 0;var Vv=le(),IO=ii(),Wv=E0(),A0=class extends IO.BtcWallet{async signTransaction(t){try{let r=await(0,Wv.transfer)(t);return Promise.resolve(r)}catch{return Promise.reject(Vv.SignTxError)}}async estimateFee(t){try{t.data.estimateFee=!0;let r=await(0,Wv.transfer)(t);return Promise.resolve(r)}catch{return Promise.reject(Vv.EstimateFeeError)}}};ad.CatWallet=A0});var Xf=H(Lr=>{w();S();var OO=Lr&&Lr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Hi=Lr&&Lr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&OO(t,e,r)};Object.defineProperty(Lr,"__esModule",{value:!0});Hi(ii(),Lr);Hi(z_(),Lr);Hi(X_(),Lr);Hi(Y_(),Lr);Hi(Z_(),Lr);Hi(J_(),Lr);Hi(iv(),Lr);Hi(mv(),Lr);Hi(vv(),Lr);Hi(zv(),Lr)});var Yv=H(cd=>{w();S();Object.defineProperty(cd,"__esModule",{value:!0});cd.oneKeyBuildBtcTx=void 0;var BO=rn(),MO=ls(),I0=le(),O0=Xf(),B0=tn(),CO=pn(),kO={legacy:"SPENDADDRESS",segwit_native:"SPENDWITNESS",segwit_nested:"SPENDP2SHWITNESS",segwit_taproot:"SPENDTAPROOT"},HO={legacy:"PAYTOADDRESS",segwit_native:"PAYTOWITNESS",segwit_nested:"PAYTOP2SHWITNESS",segwit_taproot:"PAYTOTAPROOT"};function NO(e,t=CO.bitcoin){let r=(0,O0.convert2UtxoTx)(e);if(r.omni){let c=(0,O0.number2Hex)(r.omni.coinType||31,8),u=(0,O0.number2Hex)(r.omni.amount,16),d="6f6d6e6900000000"+c+u;r.outputs.push({address:"",amount:0,omniScript:d})}let n=parseInt((0,B0.signBtc)(r,"",t,void 0,!0,!0)),i=e.dustSize||546;n>=i&&r.outputs.push({address:r.address,amount:n,derivationPath:r.derivationPath,isChange:!0});let s=[],o=[];r.inputs.forEach(c=>{let u=Xv(c.derivationPath);s.push({address_n:u,prev_hash:c.txId,prev_index:c.vOut,amount:c.amount.toString(),script_type:kO[(0,B0.getAddressType)(c.address,t)]}),o.push(RO(c.nonWitnessUtxo,c.txId))});let a=[];return r.outputs.forEach(c=>{c.isChange?a.push({address_n:Xv(c.derivationPath),amount:c.amount.toString(),script_type:HO[(0,B0.getAddressType)(c.address,t)]}):c.omniScript?a.push({amount:"0",op_return_data:c.omniScript,script_type:"PAYTOOPRETURN"}):a.push({address:c.address,amount:c.amount.toString(),script_type:"PAYTOADDRESS"})}),{inputs:s,outputs:a,refTxs:o,coin:"btc"}}cd.oneKeyBuildBtcTx=NO;function RO(e,t){let r=BO.Transaction.fromHex(e),n=[];r.ins.forEach(s=>{n.push({prev_hash:I0.base.toHex((0,MO.reverseBuffer)(s.hash)),prev_index:s.index,script_sig:I0.base.toHex(s.script),sequence:s.sequence})});let i=[];return r.outs.forEach(s=>{i.push({amount:s.value,script_pubkey:I0.base.toHex(s.script)})}),{hash:t,inputs:n,bin_outputs:i,lock_time:r.locktime,version:r.version}}function Xv(e){let t=e.split("/");t[0]==="m"&&(t=t.slice(1));let r=[];return t.forEach(n=>{let i;n.slice(-1)==="'"?i=UO(parseInt(n.slice(0,-1),10)):i=parseInt(n,10),r.push(i)}),r}function UO(e){return 2147483648+e}});var $v=H(Lc=>{w();S();Object.defineProperty(Lc,"__esModule",{value:!0});Lc.BtcXrcTypes=void 0;var qO;(function(e){e[e.INSCRIBE=1]="INSCRIBE",e[e.PSBT=2]="PSBT",e[e.PSBT_MPC_UNSIGNED_LIST=21]="PSBT_MPC_UNSIGNED_LIST",e[e.PSBT_MPC_SIGNED_LIST=22]="PSBT_MPC_SIGNED_LIST",e[e.PSBT_MPC_UNSIGNED_BUY=23]="PSBT_MPC_UNSIGNED_BUY",e[e.PSBT_MPC_SIGNED_BUY=24]="PSBT_MPC_SIGNED_BUY",e[e.PSBT_MPC_UNSIGNED=25]="PSBT_MPC_UNSIGNED",e[e.PSBT_MPC_SIGNED=26]="PSBT_MPC_SIGNED",e[e.PSBT_RUNEMAIN=27]="PSBT_RUNEMAIN",e[e.PSBT_KEY_SCRIPT_PATH=3]="PSBT_KEY_SCRIPT_PATH",e[e.PSBT_KEY_SCRIPT_PATH_BATCH=4]="PSBT_KEY_SCRIPT_PATH_BATCH",e[e.SRC20=101]="SRC20",e[e.RUNE=102]="RUNE",e[e.RUNEMAIN=103]="RUNEMAIN",e[e.PSBT_DECODE=104]="PSBT_DECODE",e[e.ARC20=114]="ARC20",e[e.CAT20=115]="CAT20"})(qO=Lc.BtcXrcTypes||(Lc.BtcXrcTypes={}))});var ln=H(Me=>{w();S();var Zv=Me&&Me.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),LO=Me&&Me.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),hn=Me&&Me.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Zv(t,e,r)},Jv=Me&&Me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Zv(t,e,r);return LO(t,e),t};Object.defineProperty(Me,"__esModule",{value:!0});Me.message=Me.wif=void 0;hn(rn(),Me);hn(b_(),Me);hn(tn(),Me);hn(y_(),Me);Me.wif=Jv(eh());hn(S_(),Me);hn(B_(),Me);hn(H_(),Me);hn(K_(),Me);hn(Dh(),Me);Me.message=Jv(G_());hn(Xf(),Me);hn(Yv(),Me);hn($v(),Me);hn(E0(),Me);hn(Si(),Me)});export{ln as a};
//# sourceMappingURL=chunk-57GJ76IX.js.map
