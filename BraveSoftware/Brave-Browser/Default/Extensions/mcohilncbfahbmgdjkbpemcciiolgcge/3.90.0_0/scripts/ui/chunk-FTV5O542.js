import{a as ne}from"./chunk-2KVSCBMV.js";import{a as te,b as re}from"./chunk-XEUEKI2J.js";import{a as oe}from"./chunk-K4DJNG3I.js";import{d as Y}from"./chunk-AVG63QW4.js";import{a as ee}from"./chunk-OB65JCC3.js";import{c as b,d as K}from"./chunk-LZL7SWT5.js";import{E as W}from"./chunk-VHMBEOFX.js";import{e as V}from"./chunk-M43NTBTB.js";import{a as q}from"./chunk-WXD7TULU.js";import{c as J}from"./chunk-PMG6IXOR.js";import{v as H}from"./chunk-MT3ANHCR.js";import{g as X}from"./chunk-XJ2EVWVX.js";import{Q as E}from"./chunk-NS5EW6UN.js";import{b as Q}from"./chunk-YVLQLIW6.js";import{h as x}from"./chunk-WYX7GFOD.js";import{a as O}from"./chunk-G6PA2JD3.js";import{g as $}from"./chunk-MJSLAJV6.js";import{a as y,c as z}from"./chunk-KC2XLVFC.js";import{b as P,f as M,ra as S}from"./chunk-MJDO2VHF.js";import{I as G}from"./chunk-QF42JCDG.js";import{c as T}from"./chunk-EAE2NUFS.js";import{l as D}from"./chunk-HZOYPVSA.js";import{c as Z}from"./chunk-3FMJDUGT.js";import{c as F}from"./chunk-2O5TMJZM.js";import{O as L}from"./chunk-UI4IZNSB.js";import{yb as R}from"./chunk-EQ34WRCJ.js";import{p as f}from"./chunk-DSNMNSMD.js";import{a as fe}from"./chunk-DOSBJ3L3.js";import{I as j,q as w}from"./chunk-URGJ6D4O.js";import{t as U,w as I}from"./chunk-XYWWXNVK.js";import{a as _e}from"./chunk-FB3ILH2L.js";import{b as p}from"./chunk-FLSAETOH.js";import{f as u,o as i,q as s}from"./chunk-UWURTNRY.js";i();s();var k=u(p());i();s();var _={"list-title":"_list-title_6m0y6_1",listTitle:"_list-title_6m0y6_1","empty-box":"_empty-box_6m0y6_6",emptyBox:"_empty-box_6m0y6_6","search-text":"_search-text_6m0y6_10",searchText:"_search-text_6m0y6_10","coin-box":"_coin-box_6m0y6_13",coinBox:"_coin-box_6m0y6_13","icon-add":"_icon-add_6m0y6_13",iconAdd:"_icon-add_6m0y6_13","icon-remove":"_icon-remove_6m0y6_16",iconRemove:"_icon-remove_6m0y6_16","icon-not-remove":"_icon-not-remove_6m0y6_20",iconNotRemove:"_icon-not-remove_6m0y6_20","clear-icon":"_clear-icon_6m0y6_24",clearIcon:"_clear-icon_6m0y6_24"};var Ue=({coin:e,deleteAddedCoinAbled:t,onAction:o,isSearchStatus:r,hideBalance:a=!1,hideMarket:n=!1})=>{let[m]=q(),c="",C="",h=re(),N=e?.aggregation;e?.added?t?(c="okx-wallet-plugin-take",C="icon-remove"):(c="okx-wallet-plugin-take",C="icon-not-remove"):(c="okx-wallet-plugin-add",C="icon-add");let Ce=O({coinId:e?.baseCoinId})&&!!e?.address,ue=r&&!N&&!Ce&&!!e?.address,A=z(()=>h(e),[e?.coinId,h]),ge=!a&&A,pe=!n&&A;return k.default.createElement(V.Coin,{className:_["coin-box"],hovered:!1,name:e?.coinId===R?e?.chainName:e?.name,icon:e.image,symbol:e.symbol,address:ue&&`${f("wallet_manage_crypto_label_contract_address")}: ${$(e?.address)}`,tag:N?f("wallet_manage_crypto_labels_crypto_multichain"):e.tokenType,hidden:m,balance:ge?e.coinAmount:void 0,market:pe?e.currencyAmount:void 0,displayPrecision:e?.displayPrecision??e?.childrenCoin?.[0]?.displayPrecision,stableCoin:e?.stableCoin??e?.childrenCoin?.[0]?.stableCoin},!A&&e?.added?k.default.createElement(te,{coinId:e?.coinId,from:G}):k.default.createElement(J.IconButton,{className:_[C],disabled:e?.added&&!t,onClick:()=>{o(e)},icon:{icon:c}}))};i();s();i();s();var B=u(p());function ie(e,t){let o=(0,B.useRef)(null),r=(0,B.useRef)(Date.now());return y((...n)=>{o.current||(e(...n),r.current=Date.now(),o.current=setTimeout(()=>{o.current=null},t))})}i();s();function se(){let e=x();return y(async t=>{try{let{code:o}=await L(F.registerCustomCoinAddr,{coinAddrRegisterList:[{accountId:e,coinId:t}]},{needSign:!0});return o===0}catch{return!1}})}i();s();var ae=(e,t)=>{if(e.aggregation){let o=t(e.childrenCoin);return{...e,childrenCoin:o}}return e};var he=(e,t)=>{t&&W({token_symbol:e.symbol,chain_symbol:e.chainName,token_contract_address:e.address,source_page:t})},yo=(e={})=>{let t=ne(),o=se();return ie(async r=>{he(r,e.source_page);let a=H(r),n;if(a){if(n=await E(r),!n&&!r.added&&(await T().removeReducedCoins(r.aggregation?r.childrenCoin??[]:[r]),j.warn(f("wallet_extension_assets_toast_desc_crypto_updated"))),!n)return}else n=r;if(n=ae(n,t),r.added){await K(n);return}if(n.aggregation){await b(n);return}await o(n.coinId)&&await b(n)},500)};i();s();var l=u(p());var ye=e=>e.reduceRight((o,r)=>{let a=X(r);if(r.aggregation){if(!o.aggregationCoinMap.has(r.symbol)){let m={...a,childrenCoin:[]};o.aggregationCoinMap.set(r.symbol,m),o.aggregatedCoins.push(m)}let n=o.aggregationCoinMap.get(r.symbol);n&&n.childrenCoin&&n.childrenCoin.push(a)}else o.aggregatedCoins.push(a);return o},{aggregationCoinMap:new Map,aggregatedCoins:[]}).aggregatedCoins,xe=()=>{let e=ee();return(0,l.useCallback)(o=>o.map(r=>e[r.coinId]||r).filter(Boolean),[e])},ke=()=>{let e=S(M),t=(0,l.useMemo)(()=>new Set(e||[]),[e]);return(0,l.useCallback)(r=>r.filter(n=>n.aggregation&&Array.isArray(n.childrenCoin)?n.childrenCoin.some(m=>t.has(m.chainId)):t.has(n.chainId)),[t])},ve=()=>{let e=x(),t=S(P);return(0,l.useMemo)(()=>!e||!t?[]:t[e]||[],[e,t])},Ae=()=>{let e=oe();return(0,l.useCallback)(o=>D(o,e),[e])},Se=()=>{let e=ve(),t=ke(),o=xe(),r=Ae();return(0,l.useMemo)(()=>{let n=o(e),m=ye(n),c=t(m);return r(c)},[e,o,t,r])},Fo=()=>Se().length>0;i();s();var g=u(p()),le=u(fe());i();s();var v=u(p()),me=u(_e());var de=v.default.memo(({search:e,setSearch:t,spinLoading:o})=>!e||e.length===0?null:o?v.default.createElement(I.Circle,{size:I.SIZE.sm}):v.default.createElement(U,{className:(0,me.default)("okx-wallet-plugin-clear-filled",_.clearIcon),onClick:()=>{t("")}}));i();s();var ce={search:"_search_2a321_1"};function Ie({search:e="",spinLoading:t=!1,placeholderText:o,onSearch:r,onBack:a,title:n,dataTestId:m,setSearch:c,showSearch:C=!0}){let h=(0,le.useHistory)();return g.default.createElement(Q,{offsetTop:0,style:{zIndex:100}},g.default.createElement(Y,{sticky:!1,closeable:!1,onBack:()=>{a?a():h.goBack()},title:n}),C&&g.default.createElement(Z.Box,{className:ce.search},g.default.createElement(w.Search,{value:e,size:w.SIZE.md,placeholder:o,onChange:r,cleanable:!1,suffix:g.default.createElement(de,{search:e,setSearch:c,spinLoading:t}),"data-testid":m})))}var Xo=Ie;export{_ as a,Ue as b,ie as c,ae as d,yo as e,Se as f,Fo as g,Xo as h};
//# sourceMappingURL=chunk-FTV5O542.js.map
