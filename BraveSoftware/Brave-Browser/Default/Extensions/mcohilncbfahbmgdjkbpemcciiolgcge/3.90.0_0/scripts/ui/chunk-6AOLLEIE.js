import{a as Z}from"./chunk-S32HDRQT.js";import{a as k}from"./chunk-YKQL2NOR.js";import{b}from"./chunk-S63SUKPS.js";import{b as K}from"./chunk-U44ZBWPF.js";import{L as T,M as w}from"./chunk-NS5EW6UN.js";import{a as p}from"./chunk-XBUPORYF.js";import{i as A}from"./chunk-KC2XLVFC.js";import{Da as R}from"./chunk-QF42JCDG.js";import{o as f}from"./chunk-3F7OC7N7.js";import{La as y,Nb as L,la as m}from"./chunk-EQ34WRCJ.js";import{p as i}from"./chunk-DSNMNSMD.js";import{a as F}from"./chunk-DOSBJ3L3.js";import{o as S}from"./chunk-URGJ6D4O.js";import{b as E}from"./chunk-FLSAETOH.js";import{Aa as N,Q as _}from"./chunk-4C5HF6J2.js";import{f as C,o as I,q as x}from"./chunk-UWURTNRY.js";I();x();var h=C(E()),P=C(F());N();var O=async({chainId:s,address:e,contractAddress:o})=>{let a={chainId:s,address:e,contractAddress:o};try{return await T(a)}catch{return{status:f.NONE,register:!1}}},v=async({chainId:s,contractAddress:e})=>{let o={chainId:s,contractAddress:e};try{return await w(o)}catch{return{result:!1}}},$=()=>{let s=(0,P.useHistory)(),e=p(m),o=K();return async({coinId:t})=>{let{coin:n,baseCoin:c}=await o(t,!0);if(![String(t),String(c.coinId)].includes(String(y)))return!0;let[r,u]=await Promise.all([O({chainId:n.chainId,address:e,contractAddress:n.address}),v({chainId:n.chainId,contractAddress:n.address})]);if(!u.result){let l=S.warn({title:i("wallet_send_modaltitle_crypto_not_supported"),text:i("wallet_dialog_modal_crypto_notavailable"),confirmText:i("wallet_send_modal_notsupported_okbtn"),alignBottom:!1,onConfirm:()=>{l.destroy()}});return!1}let g=r.status===f.NONE||r.status===f.TIMEOUT||r.status===f.ERROR;if(!r.register&&g){let l=S.warn({title:i("wallet_dialog_modal_not_registered"),text:i("wallet_dialog_modal_register_before_using"),confirmText:i("wallet_dialog_modal_registerbtn"),cancelText:i("wallet_dialog_modal_backbtn"),alignBottom:!1,onConfirm:()=>{l.destroy(),s.push(R)},onCancel:()=>{l.destroy()}});return!1}return!0}};function tt(){let s=Z(),e=p(m),[o,a]=(0,h.useState)(!1),[t,n]=(0,h.useState)(null);return A(()=>{(async()=>{a(!0);let d={coinId:y,fromAddr:e,toAddr:e,value:"0"};try{let r=await s("ChangePubKey",d);n(r)}finally{a(!1)}})()}),{loading:o,feeResult:t}}function et(){let s=k(),e=p(m),o=async t=>{let{fee:n,feeCoin:c,info:d}=t||{},{accountId:r,nonce:u}=d||{},g={type:"changePubkey",accountId:_(r)?null:parseInt(r,10),nonce:_(u)?null:parseInt(u,10),from:e,fees:n,tokenId:parseInt(c?.tokenId,10)};return{signedTx:await b(g,e,m),feeResult:t}},a=async({signedTx:t,feeResult:n})=>{if(t?.code)return{error:t};let{tx:c}=t||{},{txHash:d,...r}=c||{},u={txSource:L.DAPP,signedTx:JSON.stringify({tx:r}),fromAdr:e,serviceCharge:t?.tx?.fee,coinAmount:"0",coinId:y,txHash:d,extJson:JSON.stringify({type:"ChangePubKey",serviceChargeCoinId:n?.feeCoin?.coinId})};return await s(u)};return async t=>{let n=await o(t);return a(n)}}export{$ as a,tt as b,et as c};
//# sourceMappingURL=chunk-6AOLLEIE.js.map
