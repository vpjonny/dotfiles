import{a as vt}from"./chunk-56DCHSYA.js";import{a as It,b as ht}from"./chunk-QVUB5VBO.js";import{b as bt}from"./chunk-44W7375N.js";import{a as gt}from"./chunk-VPMJYCJE.js";import{b as yt}from"./chunk-ITR7YSQV.js";import{a as Q,b as X,d as $,e as tt}from"./chunk-GZUN7S34.js";import"./chunk-KANP3CMI.js";import"./chunk-NM4WOM75.js";import{d as dt,f as _t,l as xt}from"./chunk-E2GB7AO4.js";import"./chunk-HRKKQNEB.js";import"./chunk-FOIG34R3.js";import"./chunk-HJASUAAI.js";import{K as j,M as ot,N as J,Oc as ct,Sb as st,Tb as it,h as I,md as lt,pd as mt,qd as pt,rb as nt,sd as ft,tc as l,w as Z}from"./chunk-CS663DOD.js";import"./chunk-L3SRMZJF.js";import"./chunk-OSJ66QVC.js";import"./chunk-PHQSAPCN.js";import"./chunk-H7A2GXA7.js";import"./chunk-SRAKDH5C.js";import{t as at,u as ut,z as h}from"./chunk-K36OLSUR.js";import"./chunk-VYWNZTTM.js";import{N as Mt,d as B}from"./chunk-4RYTWPZK.js";import{e as N,n as o,p as n}from"./chunk-N62DF26F.js";o();n();var E=N(B());o();n();var A=N(B());o();n();var M={root:"_root_1ir3w_1",actions:"_actions_1ir3w_10",tip:"_tip_1ir3w_15"};o();n();var wt=({status:t,onCancel:e,onComplete:r})=>{let s=t===1,i=t===0;return A.default.createElement(l.Box,{className:M.root},A.default.createElement(l.Box,{className:M.actions},s?A.default.createElement(h,{category:h.CATEGORY.outline,type:h.TYPE.primary,onClick:e,size:h.SIZE.xl,block:!0},I("wallet_extension_private_key_btn_stop_import")):!i&&A.default.createElement(h,{category:h.CATEGORY.fill,type:h.TYPE.highlight,size:h.SIZE.xl,onClick:r,block:!0},I("wallet_extension_private_key_btn_ok"))),s&&A.default.createElement(l.Box,{className:M.tip},I("wallet_extension_private_key_text_dont_close_page")))};o();n();var D=N(B()),Tt=N(Mt());o();n();var L={root:"_root_na3xe_1",icon:"_icon_na3xe_12",loading:"_loading_na3xe_16",finished:"_finished_na3xe_22",failed:"_failed_na3xe_25"};var kt=(t,e)=>()=>D.default.createElement(at,{className:(0,Tt.default)(t,L.icon,e)}),zt=kt("okx-wallet-plugin-completed",L.finished),Ht=kt("okx-wallet-plugin-warning-circle",L.failed),Ut=()=>D.default.createElement(ut,{loaderClassName:L.loading}),Vt=()=>null,Yt={[0]:Vt,[1]:Ut,[2]:zt,[3]:Ht},Nt=({status:t})=>{let e=Yt[t];return D.default.createElement(l.Box,{className:L.root},D.default.createElement(e,null))};o();n();var W=N(B());o();n();var G={root:"_root_a49x9_1",item:"_item_a49x9_8",retry:"_retry_a49x9_15",divider:"_divider_a49x9_26"};function qt({status:t,total:e=0,success:r=0,failed:s=0,duplicated:i=0}){let a={importing:{key:"wallet_extension_private_key_text_importing_num_entries",params:{num:r},retry:!1},success:{key:"wallet_extension_private_key_text_num_entries_imported",params:{num:r},retry:!1},duplicated:{key:"wallet_extension_private_key_duplicate_imports",params:{num:i},retry:!1},failed:{key:"wallet_extension_private_key_text_num_failed_entries",params:{num:s},retry:s>0}};return{items:{[0]:[],[1]:[a.importing],[2]:[r===e?a.success:void 0,i>0?a.duplicated:void 0,s>0?a.failed:void 0].filter(Boolean),[3]:[i>0?a.duplicated:void 0,s>0?a.failed:void 0].filter(Boolean)}[t]}}var Et=({status:t,total:e,success:r,failed:s,duplicated:i,onRetry:a})=>{let{items:m=[]}=qt({status:t,total:e,success:r,failed:s,duplicated:i});return W.default.createElement(l.Box,{className:G.root},m.map((d,x)=>{let{key:_,params:b,retry:w}=d;return W.default.createElement(l.Box,{key:x,className:G.item},I(_,b),x===0&&m.length>1&&W.default.createElement(l.Box,{className:G.divider}),w&&W.default.createElement(l.Box,{onClick:a,className:G.retry},I("wallet_extension_private_key_btn_try_again")))}))};o();n();var St=N(B());o();n();var Pt={root:"_root_mrqdw_1"};var Bt=({status:t,success:e=0,failed:r=0,duplicated:s=0})=>{let a={[0]:null,[1]:{key:"wallet_extension_private_key_title_importing_private_key",params:{}},[2]:{key:r>0||s>0?"wallet_extension_private_key_title_num_imports_successful":"wallet_extension_private_key_title_import_successful",params:{num:e}},[3]:{key:"wallet_extension_private_key_title_import_failed",params:{}}}[t],m=a?I(a.key,a.params):"";return m?St.default.createElement(l.Box,{className:Pt.root},m):null};o();n();var At={root:"_root_80chm_1"};o();n();var u=N(B());o();n();var y={uninitialized:0,initialized:1,waiting:2,paused:3,working:4,canceled:5,unknown:6},O=class{constructor(e){this.status=y.uninitialized;this.nextInfo=null;this.cb=null;this.args=[];this.next=(...e)=>{[y.waiting,y.canceled,y.paused].includes(this.status)||!this.cb||(e.length>0&&(this.args=e),this.nextInfo=this.generator(this.execute,...this.args),this.status=y.waiting,this.nextInfo.execute())};this.execute=()=>{this.status=y.working,this.cb?.(this.next)};this.cancel=()=>{this.status=y.canceled,this.nextInfo?.cancel?.(),this.cb=void 0};this.pause=()=>{this.status=y.paused,this.nextInfo?.pause?.()};this.start=(e,...r)=>{this.cb=e,r.length>0&&(this.args=r),this.next()};this.continue=()=>{this.status=y.initialized,this.next()};this.generator=e,this.status=y.initialized,this.nextInfo=null,this.cb=null}};o();n();o();n();var Zt=()=>pt(async()=>{let t=await globalThis.platform.getActiveTabs();await globalThis.platform.closeTab(t.map(({id:e})=>e))}),Lt=Zt;var Ct=Lt;function jt(){let t=e=>({execute:e,cancel:Z,start:Z});return new O(t)}var Jt=t=>t===nt?[t,...bt]:[t],Qt=(t,e)=>t>0&&t>e,Xt=(t,e,r)=>t===r||e===r||t+e===r,$t=({importedResultsLength:t,counter:e,count:r})=>t>=10||r===e,Ft=async t=>{if(t.length===0)return;let e=[...t];try{await J().createWalletsToServer(e,yt.PRIVATE_KEY)}catch{}},te=({hasRun:t,remainAccountAmount:e,success:r,failed:s,total:i})=>!t&&e>0&&r+s<i,ee=({success:t,failed:e,duplicated:r,total:s,setStatus:i})=>{(0,u.useEffect)(()=>{s<=0||(t===s&&i(2),Xt(e,r,s)&&i(3))},[e,t,r,s,i])};function re(){let t=st(),{value:e}=Q(),{value:r}=X(),{value:s}=$(),i=e.filter(c=>c.value).map(c=>c.value),[a,m]=(0,u.useState)(0),d=(0,u.useRef)(i),x=(0,u.useRef)([]),_=(0,u.useRef)([]),b=(0,u.useRef)([]),w=(0,u.useRef)(!1),T=(0,u.useRef)(void 0),[g]=(0,u.useState)(i.length),[v,H]=(0,u.useState)(0),[R,C]=(0,u.useState)(0),[K,P]=(0,u.useState)(0),S=(0,u.useRef)(0),U=g-v,Gt=c=>c>0,Wt=it(ct),et=(0,u.useRef)(Wt);ee({status:a,success:v,failed:R,duplicated:K,total:g,setStatus:m});let Ot=c=>{$t({importedResultsLength:b.current.length,counter:S.current,count:c})&&Ft(b.current)},Rt=(c,V)=>{c?.message===vt?P(k=>k+1):_.current.push(V)},rt=c=>{!Gt(c)||(m(1),T.current=jt(),T.current.start(async V=>{if(Qt(c,S.current)){let k=d.current[S.current],Y=Jt(r),Kt=dt({privateKey:k,baseChains:Y}),q;try{if(w.current=!0,await J().checkPrivateKeyIsImported({__secretData__:{baseChains:Y,wallets:[{privateKey:k}]}}),et.current)q=await t(Kt);else{let F=_t({privateKey:k,baseChains:Y,password:s},{noticeBackend:!1});q=await t(F),await t(xt()),et.current=!0}b.current.push(q?.walletId),await tt(200),H(F=>F+1),x.current.push(k)}catch(F){Rt(F,k)}finally{w.current=!1,S.current+=1,Ot(c),V()}}else m(2)}))};return{start:()=>{v>0||(S.current=0,rt(g))},cancel:async()=>{for(m(2),T.current?.cancel();w.current;)await tt(100);Ft(b.current);let c=ot(d.current,[...x.current,..._.current]);C(j(c).length+_.current.length),d.current=j(c),x.current=[],_.current=[]},retry:()=>{U>0&&(S.current=0,C(0),P(0),rt(U))},failed:R,success:v,total:g,duplicated:K,remain:U,status:a}}var Dt=()=>{let t=Ct(),{value:e,setValue:r}=Q(),{value:s,setValue:i}=X(),{setValue:a}=$();(!e.filter(P=>P.value).map(P=>P.value).length||!s)&&mt.replace(lt);let{remainAccountAmount:d}=ht(),x=(0,u.useRef)(!1),{start:_,cancel:b,retry:w,success:T,failed:g,total:v,duplicated:H,status:R}=re(),C=async()=>{r([{id:Date.now(),show:!1,value:"",error:!1}]),i(""),a(""),await gt.copyText()},K=async()=>{await C(),await t()};return(0,u.useEffect)(()=>{te({hasRun:x.current,remainAccountAmount:d,success:T,failed:g,total:v})&&(_(),x.current=!0)},[g,d,_,T,v]),ft(async()=>{await C()}),{start:_,cancel:b,retry:w,complete:K,success:T,failed:g,total:v,duplicated:H,status:R}};var to=()=>{let{status:t,success:e,failed:r,total:s,duplicated:i,cancel:a,retry:m,complete:d}=Dt();return E.default.createElement(It,null,E.default.createElement(l.Box,{className:At.root},E.default.createElement(Nt,{status:t}),E.default.createElement(Bt,{status:t,success:e,failed:r,duplicated:i}),E.default.createElement(Et,{status:t,total:s,success:e,failed:r,duplicated:i,onRetry:m}),E.default.createElement(wt,{status:t,onCancel:a,onComplete:d})))};export{to as default};
//# sourceMappingURL=Confirm-KMC4NE57.js.map
