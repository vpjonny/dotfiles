import{a as T3,b as cu,c as rc,d as P3}from"./chunk-LDXOKT52.js";import{a as tl,d as w3,l as S3,m as Rp,n as x3,p as ae}from"./chunk-UGRF6UE3.js";import{a as _3,b as v3}from"./chunk-4GQL426X.js";import{G as p3,H as b3,I as g3,L as Np,M as y3,N as Up,O as m3,a as el,d as tc}from"./chunk-HONEWRHX.js";import{c as H,o as v,p as h,q as w}from"./chunk-LHDKEQAM.js";var Lp=H(qp=>{v();w();Object.defineProperty(qp,"__esModule",{value:!0})});var Kp=H(bs=>{v();w();Object.defineProperty(bs,"__esModule",{value:!0});bs.base58=bs.fromBase58=bs.toBase58=void 0;var rl=tl();Object.defineProperty(bs,"base58",{enumerable:!0,get:function(){return rl.base58}});function E3(e){let t=h.Buffer.from(e);return rl.base58.encode(Uint8Array.from(t))}bs.toBase58=E3;function I3(e){return rl.base58.decode(e)}bs.fromBase58=I3});var Dp=H(jo=>{v();w();Object.defineProperty(jo,"__esModule",{value:!0});jo.validateHexString=jo.isHexString=void 0;function A3(e,t){return e.match(/^0x[0-9A-Fa-f]*$/)?!(t&&e.length!==2+2*t):!1}jo.isHexString=A3;function O3(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||t.length%2!==0||!t.match(/^[0-9A-Fa-f]*$/))}jo.validateHexString=O3});var jp=H(pi=>{v();w();Object.defineProperty(pi,"__esModule",{value:!0});pi.isHexPrefixed=pi.stripHexPrefix=pi.fromHex=pi.toHex=void 0;var B3=Dp();function M3(e,t=!1){let r=h.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}pi.toHex=M3;function C3(e){if((e.startsWith("0x")||e.startsWith("0X"))&&(e=e.substring(2)),e.length%2!=0&&(e="0"+e),!(0,B3.validateHexString)(e))throw new Error("invalid hex string");return h.Buffer.from(e,"hex")}pi.fromHex=C3;function k3(e){return e.startsWith("0x")?e.substring(2):e}pi.stripHexPrefix=k3;function H3(e){return e.startsWith("0x")}pi.isHexPrefixed=H3});var Wi=H(co=>{v();w();Object.defineProperty(co,"__esModule",{value:!0});co.anumber=nl;co.abytes=Fp;co.ahash=U3;co.aexists=R3;co.aoutput=q3;function nl(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function N3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Fp(e,...t){if(!N3(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function U3(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");nl(e.outputLen),nl(e.blockLen)}function R3(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function q3(e,t){Fp(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}});var Vp=H(uu=>{v();w();Object.defineProperty(uu,"__esModule",{value:!0});uu.crypto=void 0;uu.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var xr=H(Ae=>{v();w();Object.defineProperty(Ae,"__esModule",{value:!0});Ae.Hash=Ae.nextTick=Ae.byteSwapIfBE=Ae.isLE=void 0;Ae.isBytes=L3;Ae.u8=K3;Ae.u32=D3;Ae.createView=j3;Ae.rotr=F3;Ae.rotl=V3;Ae.byteSwap=ol;Ae.byteSwap32=G3;Ae.bytesToHex=z3;Ae.hexToBytes=X3;Ae.asyncLoop=$3;Ae.utf8ToBytes=zp;Ae.toBytes=fu;Ae.concatBytes=Z3;Ae.checkOpts=J3;Ae.wrapConstructor=Q3;Ae.wrapConstructorWithOpts=eS;Ae.wrapXOFConstructorWithOpts=tS;Ae.randomBytes=rS;var Fo=Vp(),sl=Wi();function L3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function K3(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function D3(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function j3(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function F3(e,t){return e<<32-t|e>>>t}function V3(e,t){return e<<t|e>>>32-t>>>0}Ae.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function ol(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}Ae.byteSwapIfBE=Ae.isLE?e=>e:e=>ol(e);function G3(e){for(let t=0;t<e.length;t++)e[t]=ol(e[t])}var Wp=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",W3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function z3(e){if((0,sl.abytes)(e),Wp)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=W3[e[r]];return t}var zi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Gp(e){if(e>=zi._0&&e<=zi._9)return e-zi._0;if(e>=zi.A&&e<=zi.F)return e-(zi.A-10);if(e>=zi.a&&e<=zi.f)return e-(zi.a-10)}function X3(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Wp)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let o=Gp(e.charCodeAt(s)),a=Gp(e.charCodeAt(s+1));if(o===void 0||a===void 0){let c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}var Y3=async()=>{};Ae.nextTick=Y3;async function $3(e,t,r){let n=Date.now();for(let i=0;i<e;i++){r(i);let s=Date.now()-n;s>=0&&s<t||(await(0,Ae.nextTick)(),n+=s)}}function zp(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function fu(e){return typeof e=="string"&&(e=zp(e)),(0,sl.abytes)(e),e}function Z3(...e){let t=0;for(let n=0;n<e.length;n++){let i=e[n];(0,sl.abytes)(i),t+=i.length}let r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var il=class{clone(){return this._cloneInto()}};Ae.Hash=il;function J3(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function Q3(e){let t=n=>e().update(fu(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function eS(e){let t=(n,i)=>e(i).update(fu(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function tS(e){let t=(n,i)=>e(i).update(fu(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function rS(e=32){if(Fo.crypto&&typeof Fo.crypto.getRandomValues=="function")return Fo.crypto.getRandomValues(new Uint8Array(e));if(Fo.crypto&&typeof Fo.crypto.randomBytes=="function")return Uint8Array.from(Fo.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var du=H(uo=>{v();w();Object.defineProperty(uo,"__esModule",{value:!0});uo.HashMD=void 0;uo.setBigUint64=Xp;uo.Chi=nS;uo.Maj=iS;var al=Wi(),nc=xr();function Xp(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+u,a,n)}function nS(e,t,r){return e&t^~e&r}function iS(e,t,r){return e&t^e&r^t&r}var cl=class extends nc.Hash{constructor(t,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(t),this.view=(0,nc.createView)(this.buffer)}update(t){(0,al.aexists)(this);let{view:r,buffer:n,blockLen:i}=this;t=(0,nc.toBytes)(t);let s=t.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=(0,nc.createView)(t);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,al.aexists)(this),(0,al.aoutput)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;Xp(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=(0,nc.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)a.setUint32(4*f,d[f],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};uo.HashMD=cl});var Vo=H(ms=>{v();w();Object.defineProperty(ms,"__esModule",{value:!0});ms.sha224=ms.sha256=ms.SHA256=void 0;var ul=du(),xn=xr(),sS=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ys=new Uint32Array(64),ic=class extends ul.HashMD{constructor(t=32){super(64,t,8,!1),this.A=gs[0]|0,this.B=gs[1]|0,this.C=gs[2]|0,this.D=gs[3]|0,this.E=gs[4]|0,this.F=gs[5]|0,this.G=gs[6]|0,this.H=gs[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,r){for(let f=0;f<16;f++,r+=4)ys[f]=t.getUint32(r,!1);for(let f=16;f<64;f++){let p=ys[f-15],y=ys[f-2],m=(0,xn.rotr)(p,7)^(0,xn.rotr)(p,18)^p>>>3,_=(0,xn.rotr)(y,17)^(0,xn.rotr)(y,19)^y>>>10;ys[f]=_+ys[f-7]+m+ys[f-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:d}=this;for(let f=0;f<64;f++){let p=(0,xn.rotr)(a,6)^(0,xn.rotr)(a,11)^(0,xn.rotr)(a,25),y=d+p+(0,ul.Chi)(a,c,u)+sS[f]+ys[f]|0,_=((0,xn.rotr)(n,2)^(0,xn.rotr)(n,13)^(0,xn.rotr)(n,22))+(0,ul.Maj)(n,i,s)|0;d=u,u=c,c=a,a=o+y|0,o=s,s=i,i=n,n=y+_|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(n,i,s,o,a,c,u,d)}roundClean(){ys.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};ms.SHA256=ic;var fl=class extends ic{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}};ms.sha256=(0,xn.wrapConstructor)(()=>new ic);ms.sha224=(0,xn.wrapConstructor)(()=>new fl)});var Go=H(re=>{v();w();Object.defineProperty(re,"__esModule",{value:!0});re.add5L=re.add5H=re.add4H=re.add4L=re.add3H=re.add3L=re.rotlBL=re.rotlBH=re.rotlSL=re.rotlSH=re.rotr32L=re.rotr32H=re.rotrBL=re.rotrBH=re.rotrSL=re.rotrSH=re.shrSL=re.shrSH=re.toBig=void 0;re.fromBig=ll;re.split=Yp;re.add=ub;var lu=BigInt(2**32-1),dl=BigInt(32);function ll(e,t=!1){return t?{h:Number(e&lu),l:Number(e>>dl&lu)}:{h:Number(e>>dl&lu)|0,l:Number(e&lu)|0}}function Yp(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:o}=ll(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]}var $p=(e,t)=>BigInt(e>>>0)<<dl|BigInt(t>>>0);re.toBig=$p;var Zp=(e,t,r)=>e>>>r;re.shrSH=Zp;var Jp=(e,t,r)=>e<<32-r|t>>>r;re.shrSL=Jp;var Qp=(e,t,r)=>e>>>r|t<<32-r;re.rotrSH=Qp;var eb=(e,t,r)=>e<<32-r|t>>>r;re.rotrSL=eb;var tb=(e,t,r)=>e<<64-r|t>>>r-32;re.rotrBH=tb;var rb=(e,t,r)=>e>>>r-32|t<<64-r;re.rotrBL=rb;var nb=(e,t)=>t;re.rotr32H=nb;var ib=(e,t)=>e;re.rotr32L=ib;var sb=(e,t,r)=>e<<r|t>>>32-r;re.rotlSH=sb;var ob=(e,t,r)=>t<<r|e>>>32-r;re.rotlSL=ob;var ab=(e,t,r)=>t<<r-32|e>>>64-r;re.rotlBH=ab;var cb=(e,t,r)=>e<<r-32|t>>>64-r;re.rotlBL=cb;function ub(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var fb=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);re.add3L=fb;var db=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;re.add3H=db;var lb=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);re.add4L=lb;var hb=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;re.add4H=hb;var pb=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);re.add5L=pb;var bb=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;re.add5H=bb;var oS={fromBig:ll,split:Yp,toBig:$p,shrSH:Zp,shrSL:Jp,rotrSH:Qp,rotrSL:eb,rotrBH:tb,rotrBL:rb,rotr32H:nb,rotr32L:ib,rotlSH:sb,rotlSL:ob,rotlBH:ab,rotlBL:cb,add:ub,add3L:fb,add3H:db,add4L:lb,add4H:hb,add5H:bb,add5L:pb};re.default=oS});var sc=H(ar=>{v();w();Object.defineProperty(ar,"__esModule",{value:!0});ar.sha384=ar.sha512_256=ar.sha512_224=ar.sha512=ar.SHA384=ar.SHA512_256=ar.SHA512_224=ar.SHA512=void 0;var aS=du(),de=Go(),gu=xr(),[cS,uS]=(()=>de.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),_s=new Uint32Array(80),vs=new Uint32Array(80),fo=class extends aS.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:d,Fh:f,Fl:p,Gh:y,Gl:m,Hh:_,Hl:E}=this;return[t,r,n,i,s,o,a,c,u,d,f,p,y,m,_,E]}set(t,r,n,i,s,o,a,c,u,d,f,p,y,m,_,E){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=p|0,this.Gh=y|0,this.Gl=m|0,this.Hh=_|0,this.Hl=E|0}process(t,r){for(let C=0;C<16;C++,r+=4)_s[C]=t.getUint32(r),vs[C]=t.getUint32(r+=4);for(let C=16;C<80;C++){let R=_s[C-15]|0,U=vs[C-15]|0,q=de.default.rotrSH(R,U,1)^de.default.rotrSH(R,U,8)^de.default.shrSH(R,U,7),L=de.default.rotrSL(R,U,1)^de.default.rotrSL(R,U,8)^de.default.shrSL(R,U,7),K=_s[C-2]|0,W=vs[C-2]|0,O=de.default.rotrSH(K,W,19)^de.default.rotrBH(K,W,61)^de.default.shrSH(K,W,6),l=de.default.rotrSL(K,W,19)^de.default.rotrBL(K,W,61)^de.default.shrSL(K,W,6),g=de.default.add4L(L,l,vs[C-7],vs[C-16]),S=de.default.add4H(g,q,O,_s[C-7],_s[C-16]);_s[C]=S|0,vs[C]=g|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:d,Eh:f,El:p,Fh:y,Fl:m,Gh:_,Gl:E,Hh:I,Hl:k}=this;for(let C=0;C<80;C++){let R=de.default.rotrSH(f,p,14)^de.default.rotrSH(f,p,18)^de.default.rotrBH(f,p,41),U=de.default.rotrSL(f,p,14)^de.default.rotrSL(f,p,18)^de.default.rotrBL(f,p,41),q=f&y^~f&_,L=p&m^~p&E,K=de.default.add5L(k,U,L,uS[C],vs[C]),W=de.default.add5H(K,I,R,q,cS[C],_s[C]),O=K|0,l=de.default.rotrSH(n,i,28)^de.default.rotrBH(n,i,34)^de.default.rotrBH(n,i,39),g=de.default.rotrSL(n,i,28)^de.default.rotrBL(n,i,34)^de.default.rotrBL(n,i,39),S=n&s^n&a^s&a,T=i&o^i&c^o&c;I=_|0,k=E|0,_=y|0,E=m|0,y=f|0,m=p|0,{h:f,l:p}=de.default.add(u|0,d|0,W|0,O|0),u=a|0,d=c|0,a=s|0,c=o|0,s=n|0,o=i|0;let x=de.default.add3L(O,g,T);n=de.default.add3H(x,W,l,S),i=x|0}({h:n,l:i}=de.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=de.default.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=de.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:d}=de.default.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l:p}=de.default.add(this.Eh|0,this.El|0,f|0,p|0),{h:y,l:m}=de.default.add(this.Fh|0,this.Fl|0,y|0,m|0),{h:_,l:E}=de.default.add(this.Gh|0,this.Gl|0,_|0,E|0),{h:I,l:k}=de.default.add(this.Hh|0,this.Hl|0,I|0,k|0),this.set(n,i,s,o,a,c,u,d,f,p,y,m,_,E,I,k)}roundClean(){_s.fill(0),vs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ar.SHA512=fo;var hu=class extends fo{constructor(){super(28),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735}};ar.SHA512_224=hu;var pu=class extends fo{constructor(){super(32),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414}};ar.SHA512_256=pu;var bu=class extends fo{constructor(){super(48),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868}};ar.SHA384=bu;ar.sha512=(0,gu.wrapConstructor)(()=>new fo);ar.sha512_224=(0,gu.wrapConstructor)(()=>new hu);ar.sha512_256=(0,gu.wrapConstructor)(()=>new pu);ar.sha384=(0,gu.wrapConstructor)(()=>new bu)});var bl=H(Wo=>{v();w();Object.defineProperty(Wo,"__esModule",{value:!0});Wo.ripemd160=Wo.RIPEMD160=void 0;var fS=du(),oc=xr(),dS=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),yb=new Uint8Array(new Array(16).fill(0).map((e,t)=>t)),lS=yb.map(e=>(9*e+5)%16),hl=[yb],pl=[lS];for(let e=0;e<4;e++)for(let t of[hl,pl])t.push(t[e].map(r=>dS[r]));var mb=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),hS=hl.map((e,t)=>e.map(r=>mb[t][r])),pS=pl.map((e,t)=>e.map(r=>mb[t][r])),bS=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),gS=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function gb(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}var yu=new Uint32Array(16),mu=class extends fS.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:r,h2:n,h3:i,h4:s}=this;return[t,r,n,i,s]}set(t,r,n,i,s){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(t,r){for(let y=0;y<16;y++,r+=4)yu[y]=t.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,o=s,a=this.h2|0,c=a,u=this.h3|0,d=u,f=this.h4|0,p=f;for(let y=0;y<5;y++){let m=4-y,_=bS[y],E=gS[y],I=hl[y],k=pl[y],C=hS[y],R=pS[y];for(let U=0;U<16;U++){let q=(0,oc.rotl)(n+gb(y,s,a,u)+yu[I[U]]+_,C[U])+f|0;n=f,f=u,u=(0,oc.rotl)(a,10)|0,a=s,s=q}for(let U=0;U<16;U++){let q=(0,oc.rotl)(i+gb(m,o,c,d)+yu[k[U]]+E,R[U])+p|0;i=p,p=d,d=(0,oc.rotl)(c,10)|0,c=o,o=q}}this.set(this.h1+a+d|0,this.h2+u+p|0,this.h3+f+i|0,this.h4+n+o|0,this.h0+s+c|0)}roundClean(){yu.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};Wo.RIPEMD160=mu;Wo.ripemd160=(0,oc.wrapConstructor)(()=>new mu)});var _u=H(Fe=>{v();w();Object.defineProperty(Fe,"__esModule",{value:!0});Fe.shake256=Fe.shake128=Fe.keccak_512=Fe.keccak_384=Fe.keccak_256=Fe.keccak_224=Fe.sha3_512=Fe.sha3_384=Fe.sha3_256=Fe.sha3_224=Fe.Keccak=void 0;Fe.keccakP=Tb;var zo=Wi(),cc=Go(),Xi=xr(),wb=[],Sb=[],xb=[],yS=BigInt(0),ac=BigInt(1),mS=BigInt(2),_S=BigInt(7),vS=BigInt(256),wS=BigInt(113);for(let e=0,t=ac,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],wb.push(2*(5*n+r)),Sb.push((e+1)*(e+2)/2%64);let i=yS;for(let s=0;s<7;s++)t=(t<<ac^(t>>_S)*wS)%vS,t&mS&&(i^=ac<<(ac<<BigInt(s))-ac);xb.push(i)}var[SS,xS]=(0,cc.split)(xb,!0),_b=(e,t,r)=>r>32?(0,cc.rotlBH)(e,t,r):(0,cc.rotlSH)(e,t,r),vb=(e,t,r)=>r>32?(0,cc.rotlBL)(e,t,r):(0,cc.rotlSL)(e,t,r);function Tb(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let o=0;o<10;o++)r[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,c=(o+2)%10,u=r[c],d=r[c+1],f=_b(u,d,1)^r[a],p=vb(u,d,1)^r[a+1];for(let y=0;y<50;y+=10)e[o+y]^=f,e[o+y+1]^=p}let i=e[2],s=e[3];for(let o=0;o<24;o++){let a=Sb[o],c=_b(i,s,a),u=vb(i,s,a),d=wb[o];i=e[d],s=e[d+1],e[d]=c,e[d+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=SS[n],e[1]^=xS[n]}r.fill(0)}var lo=class extends Xi.Hash{constructor(t,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,(0,zo.anumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,Xi.u32)(this.state)}keccak(){Xi.isLE||(0,Xi.byteSwap32)(this.state32),Tb(this.state32,this.rounds),Xi.isLE||(0,Xi.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,zo.aexists)(this);let{blockLen:r,state:n}=this;t=(0,Xi.toBytes)(t);let i=t.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){(0,zo.aexists)(this,!1),(0,zo.abytes)(t),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=n&&this.keccak();let o=Math.min(n-this.posOut,s-i);t.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,zo.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,zo.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new lo(r,n,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=n,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}};Fe.Keccak=lo;var ws=(e,t,r)=>(0,Xi.wrapConstructor)(()=>new lo(t,e,r));Fe.sha3_224=ws(6,144,224/8);Fe.sha3_256=ws(6,136,256/8);Fe.sha3_384=ws(6,104,384/8);Fe.sha3_512=ws(6,72,512/8);Fe.keccak_224=ws(1,144,224/8);Fe.keccak_256=ws(1,136,256/8);Fe.keccak_384=ws(1,104,384/8);Fe.keccak_512=ws(1,72,512/8);var Pb=(e,t,r)=>(0,Xi.wrapXOFConstructorWithOpts)((n={})=>new lo(t,e,n.dkLen===void 0?r:n.dkLen,!0));Fe.shake128=Pb(31,168,128/8);Fe.shake256=Pb(31,136,256/8)});var vu=H(Yo=>{v();w();Object.defineProperty(Yo,"__esModule",{value:!0});Yo.BLAKE=Yo.SIGMA=void 0;var Xo=Wi(),Tr=xr();Yo.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var gl=class extends Tr.Hash{constructor(t,r,n={},i,s,o){if(super(),this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,Xo.anumber)(t),(0,Xo.anumber)(r),(0,Xo.anumber)(i),r<0||r>i)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error("key length must be undefined or 1.."+i);if(n.salt!==void 0&&n.salt.length!==s)throw new Error("salt must be undefined or "+s);if(n.personalization!==void 0&&n.personalization.length!==o)throw new Error("personalization must be undefined or "+o);this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=(0,Tr.u32)(this.buffer)}update(t){(0,Xo.aexists)(this);let{blockLen:r,buffer:n,buffer32:i}=this;t=(0,Tr.toBytes)(t);let s=t.length,o=t.byteOffset,a=t.buffer;for(let c=0;c<s;){this.pos===r&&(Tr.isLE||(0,Tr.byteSwap32)(i),this.compress(i,0,!1),Tr.isLE||(0,Tr.byteSwap32)(i),this.pos=0);let u=Math.min(r-this.pos,s-c),d=o+c;if(u===r&&!(d%4)&&c+u<s){let f=new Uint32Array(a,d,Math.floor((s-c)/4));Tr.isLE||(0,Tr.byteSwap32)(f);for(let p=0;c+r<s;p+=i.length,c+=r)this.length+=r,this.compress(f,p,!1);Tr.isLE||(0,Tr.byteSwap32)(f);continue}n.set(t.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(t){(0,Xo.aexists)(this),(0,Xo.aoutput)(t,this);let{pos:r,buffer32:n}=this;this.finished=!0,this.buffer.subarray(r).fill(0),Tr.isLE||(0,Tr.byteSwap32)(n),this.compress(n,0,!0),Tr.isLE||(0,Tr.byteSwap32)(n);let i=(0,Tr.u32)(t);this.get().forEach((s,o)=>i[o]=(0,Tr.byteSwapIfBE)(s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=n,t.finished=i,t.destroyed=s,t.outputLen=o,t.buffer.set(r),t.pos=a,t}};Yo.BLAKE=gl});var yl=H($o=>{v();w();Object.defineProperty($o,"__esModule",{value:!0});$o.blake2b=$o.BLAKE2b=void 0;var Eb=vu(),Vr=Go(),Qr=xr(),er=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),G=new Uint32Array(32);function Ss(e,t,r,n,i,s){let o=i[s],a=i[s+1],c=G[2*e],u=G[2*e+1],d=G[2*t],f=G[2*t+1],p=G[2*r],y=G[2*r+1],m=G[2*n],_=G[2*n+1],E=Vr.default.add3L(c,d,o);u=Vr.default.add3H(E,u,f,a),c=E|0,{Dh:_,Dl:m}={Dh:_^u,Dl:m^c},{Dh:_,Dl:m}={Dh:Vr.default.rotr32H(_,m),Dl:Vr.default.rotr32L(_,m)},{h:y,l:p}=Vr.default.add(y,p,_,m),{Bh:f,Bl:d}={Bh:f^y,Bl:d^p},{Bh:f,Bl:d}={Bh:Vr.default.rotrSH(f,d,24),Bl:Vr.default.rotrSL(f,d,24)},G[2*e]=c,G[2*e+1]=u,G[2*t]=d,G[2*t+1]=f,G[2*r]=p,G[2*r+1]=y,G[2*n]=m,G[2*n+1]=_}function xs(e,t,r,n,i,s){let o=i[s],a=i[s+1],c=G[2*e],u=G[2*e+1],d=G[2*t],f=G[2*t+1],p=G[2*r],y=G[2*r+1],m=G[2*n],_=G[2*n+1],E=Vr.default.add3L(c,d,o);u=Vr.default.add3H(E,u,f,a),c=E|0,{Dh:_,Dl:m}={Dh:_^u,Dl:m^c},{Dh:_,Dl:m}={Dh:Vr.default.rotrSH(_,m,16),Dl:Vr.default.rotrSL(_,m,16)},{h:y,l:p}=Vr.default.add(y,p,_,m),{Bh:f,Bl:d}={Bh:f^y,Bl:d^p},{Bh:f,Bl:d}={Bh:Vr.default.rotrBH(f,d,63),Bl:Vr.default.rotrBL(f,d,63)},G[2*e]=c,G[2*e+1]=u,G[2*t]=d,G[2*t+1]=f,G[2*r]=p,G[2*r+1]=y,G[2*n]=m,G[2*n+1]=_}var wu=class extends Eb.BLAKE{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=er[0]|0,this.v0h=er[1]|0,this.v1l=er[2]|0,this.v1h=er[3]|0,this.v2l=er[4]|0,this.v2h=er[5]|0,this.v3l=er[6]|0,this.v3h=er[7]|0,this.v4l=er[8]|0,this.v4h=er[9]|0,this.v5l=er[10]|0,this.v5h=er[11]|0,this.v6l=er[12]|0,this.v6h=er[13]|0,this.v7l=er[14]|0,this.v7h=er[15]|0;let r=t.key?t.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,Qr.u32)((0,Qr.toBytes)(t.salt));this.v4l^=(0,Qr.byteSwapIfBE)(n[0]),this.v4h^=(0,Qr.byteSwapIfBE)(n[1]),this.v5l^=(0,Qr.byteSwapIfBE)(n[2]),this.v5h^=(0,Qr.byteSwapIfBE)(n[3])}if(t.personalization){let n=(0,Qr.u32)((0,Qr.toBytes)(t.personalization));this.v6l^=(0,Qr.byteSwapIfBE)(n[0]),this.v6h^=(0,Qr.byteSwapIfBE)(n[1]),this.v7l^=(0,Qr.byteSwapIfBE)(n[2]),this.v7h^=(0,Qr.byteSwapIfBE)(n[3])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,Qr.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:u,v4h:d,v5l:f,v5h:p,v6l:y,v6h:m,v7l:_,v7h:E}=this;return[t,r,n,i,s,o,a,c,u,d,f,p,y,m,_,E]}set(t,r,n,i,s,o,a,c,u,d,f,p,y,m,_,E){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=u|0,this.v4h=d|0,this.v5l=f|0,this.v5h=p|0,this.v6l=y|0,this.v6h=m|0,this.v7l=_|0,this.v7h=E|0}compress(t,r,n){this.get().forEach((c,u)=>G[u]=c),G.set(er,16);let{h:i,l:s}=Vr.default.fromBig(BigInt(this.length));G[24]=er[8]^s,G[25]=er[9]^i,n&&(G[28]=~G[28],G[29]=~G[29]);let o=0,a=Eb.SIGMA;for(let c=0;c<12;c++)Ss(0,4,8,12,t,r+2*a[o++]),xs(0,4,8,12,t,r+2*a[o++]),Ss(1,5,9,13,t,r+2*a[o++]),xs(1,5,9,13,t,r+2*a[o++]),Ss(2,6,10,14,t,r+2*a[o++]),xs(2,6,10,14,t,r+2*a[o++]),Ss(3,7,11,15,t,r+2*a[o++]),xs(3,7,11,15,t,r+2*a[o++]),Ss(0,5,10,15,t,r+2*a[o++]),xs(0,5,10,15,t,r+2*a[o++]),Ss(1,6,11,12,t,r+2*a[o++]),xs(1,6,11,12,t,r+2*a[o++]),Ss(2,7,8,13,t,r+2*a[o++]),xs(2,7,8,13,t,r+2*a[o++]),Ss(3,4,9,14,t,r+2*a[o++]),xs(3,4,9,14,t,r+2*a[o++]);this.v0l^=G[0]^G[16],this.v0h^=G[1]^G[17],this.v1l^=G[2]^G[18],this.v1h^=G[3]^G[19],this.v2l^=G[4]^G[20],this.v2h^=G[5]^G[21],this.v3l^=G[6]^G[22],this.v3h^=G[7]^G[23],this.v4l^=G[8]^G[24],this.v4h^=G[9]^G[25],this.v5l^=G[10]^G[26],this.v5h^=G[11]^G[27],this.v6l^=G[12]^G[28],this.v6h^=G[13]^G[29],this.v7l^=G[14]^G[30],this.v7h^=G[15]^G[31],G.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};$o.BLAKE2b=wu;$o.blake2b=(0,Qr.wrapConstructorWithOpts)(e=>new wu(e))});var xu=H(Ve=>{v();w();Object.defineProperty(Ve,"__esModule",{value:!0});Ve.sha3_512=Ve.sha3_256=Ve.ripemd160=Ve.sha512=Ve.sha256=Ve.magicHash=Ve.blake2=Ve.keccak256=Ve.keccak=Ve.hash160=Ve.doubleSha256=void 0;var Su=Vo();Object.defineProperty(Ve,"sha256",{enumerable:!0,get:function(){return Su.sha256}});var TS=sc();Object.defineProperty(Ve,"sha512",{enumerable:!0,get:function(){return TS.sha512}});var Ab=bl();Object.defineProperty(Ve,"ripemd160",{enumerable:!0,get:function(){return Ab.ripemd160}});var Zo=_u();Object.defineProperty(Ve,"sha3_256",{enumerable:!0,get:function(){return Zo.sha3_256}});Object.defineProperty(Ve,"sha3_512",{enumerable:!0,get:function(){return Zo.sha3_512}});var PS=yl();function Ob(e){let t=(0,Su.sha256)(e);return(0,Su.sha256)(t)}Ve.doubleSha256=Ob;function ES(e){let t=(0,Su.sha256)(e);return(0,Ab.ripemd160)(t)}Ve.hash160=ES;var IS=function(e,t=256){let r=h.Buffer.from(e);switch(t){case 224:return h.Buffer.from((0,Zo.keccak_224)(r));case 256:return h.Buffer.from((0,Zo.keccak_256)(r));case 384:return h.Buffer.from((0,Zo.keccak_384)(r));case 512:return h.Buffer.from((0,Zo.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${t}`)}};Ve.keccak=IS;var AS=function(e){return(0,Ve.keccak)(e)};Ve.keccak256=AS;function OS(e,t,r){let n=Math.ceil(t/8);return(0,PS.blake2b)(e,{dkLen:n,key:r})}Ve.blake2=OS;function Ib(e){let t;return e<253?(t=h.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=h.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=h.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=h.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}var BS=h.Buffer.from(`Bitcoin Signed Message:
`);function MS(e,t){let r=t?h.Buffer.from(t,"utf8"):BS,n=Ib(r.length),i=h.Buffer.from(e),s=Ib(i.length),o=h.Buffer.concat([n,r,s,i]);return Ob(o)}Ve.magicHash=MS});var fc=H(ho=>{v();w();Object.defineProperty(ho,"__esModule",{value:!0});ho.hmac=ho.HMAC=void 0;var Tu=Wi(),Bb=xr(),uc=class extends Bb.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,Tu.ahash)(t);let n=(0,Bb.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,Tu.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,Tu.aexists)(this),(0,Tu.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};ho.HMAC=uc;var CS=(e,t,r)=>new uc(e,t).update(r).digest();ho.hmac=CS;ho.hmac.create=(e,t)=>new uc(e,t)});var kb=H(Jo=>{v();w();Object.defineProperty(Jo,"__esModule",{value:!0});Jo.hmacSHA512=Jo.hmacSHA256=void 0;var Mb=fc(),Cb=xu();function kS(e,t){return h.Buffer.from((0,Mb.hmac)(Cb.sha256,e,t))}Jo.hmacSHA256=kS;function HS(e,t){return h.Buffer.from((0,Mb.hmac)(Cb.sha512,e,t))}Jo.hmacSHA512=HS});var ml=H(Ce=>{v();w();Object.defineProperty(Ce,"__esModule",{value:!0});Ce.blake2s=Ce.BLAKE2s=Ce.B2S_IV=void 0;Ce.G1s=Yi;Ce.G2s=$i;Ce.compress=Nb;var Hb=vu(),NS=Go(),en=xr();Ce.B2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function Yi(e,t,r,n,i){return e=e+t+i|0,n=(0,en.rotr)(n^e,16),r=r+n|0,t=(0,en.rotr)(t^r,12),{a:e,b:t,c:r,d:n}}function $i(e,t,r,n,i){return e=e+t+i|0,n=(0,en.rotr)(n^e,8),r=r+n|0,t=(0,en.rotr)(t^r,7),{a:e,b:t,c:r,d:n}}function Nb(e,t,r,n,i,s,o,a,c,u,d,f,p,y,m,_,E,I,k,C){let R=0;for(let U=0;U<n;U++)({a:i,b:c,c:p,d:E}=Yi(i,c,p,E,r[t+e[R++]])),{a:i,b:c,c:p,d:E}=$i(i,c,p,E,r[t+e[R++]]),{a:s,b:u,c:y,d:I}=Yi(s,u,y,I,r[t+e[R++]]),{a:s,b:u,c:y,d:I}=$i(s,u,y,I,r[t+e[R++]]),{a:o,b:d,c:m,d:k}=Yi(o,d,m,k,r[t+e[R++]]),{a:o,b:d,c:m,d:k}=$i(o,d,m,k,r[t+e[R++]]),{a,b:f,c:_,d:C}=Yi(a,f,_,C,r[t+e[R++]]),{a,b:f,c:_,d:C}=$i(a,f,_,C,r[t+e[R++]]),{a:i,b:u,c:m,d:C}=Yi(i,u,m,C,r[t+e[R++]]),{a:i,b:u,c:m,d:C}=$i(i,u,m,C,r[t+e[R++]]),{a:s,b:d,c:_,d:E}=Yi(s,d,_,E,r[t+e[R++]]),{a:s,b:d,c:_,d:E}=$i(s,d,_,E,r[t+e[R++]]),{a:o,b:f,c:p,d:I}=Yi(o,f,p,I,r[t+e[R++]]),{a:o,b:f,c:p,d:I}=$i(o,f,p,I,r[t+e[R++]]),{a,b:c,c:y,d:k}=Yi(a,c,y,k,r[t+e[R++]]),{a,b:c,c:y,d:k}=$i(a,c,y,k,r[t+e[R++]]);return{v0:i,v1:s,v2:o,v3:a,v4:c,v5:u,v6:d,v7:f,v8:p,v9:y,v10:m,v11:_,v12:E,v13:I,v14:k,v15:C}}var Pu=class extends Hb.BLAKE{constructor(t={}){super(64,t.dkLen===void 0?32:t.dkLen,t,32,8,8),this.v0=Ce.B2S_IV[0]|0,this.v1=Ce.B2S_IV[1]|0,this.v2=Ce.B2S_IV[2]|0,this.v3=Ce.B2S_IV[3]|0,this.v4=Ce.B2S_IV[4]|0,this.v5=Ce.B2S_IV[5]|0,this.v6=Ce.B2S_IV[6]|0,this.v7=Ce.B2S_IV[7]|0;let r=t.key?t.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,en.u32)((0,en.toBytes)(t.salt));this.v4^=(0,en.byteSwapIfBE)(n[0]),this.v5^=(0,en.byteSwapIfBE)(n[1])}if(t.personalization){let n=(0,en.u32)((0,en.toBytes)(t.personalization));this.v6^=(0,en.byteSwapIfBE)(n[0]),this.v7^=(0,en.byteSwapIfBE)(n[1])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,en.toBytes)(t.key)),this.update(n)}}get(){let{v0:t,v1:r,v2:n,v3:i,v4:s,v5:o,v6:a,v7:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=o|0,this.v6=a|0,this.v7=c|0}compress(t,r,n){let{h:i,l:s}=(0,NS.fromBig)(BigInt(this.length)),{v0:o,v1:a,v2:c,v3:u,v4:d,v5:f,v6:p,v7:y,v8:m,v9:_,v10:E,v11:I,v12:k,v13:C,v14:R,v15:U}=Nb(Hb.SIGMA,r,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,Ce.B2S_IV[0],Ce.B2S_IV[1],Ce.B2S_IV[2],Ce.B2S_IV[3],s^Ce.B2S_IV[4],i^Ce.B2S_IV[5],n?~Ce.B2S_IV[6]:Ce.B2S_IV[6],Ce.B2S_IV[7]);this.v0^=o^m,this.v1^=a^_,this.v2^=c^E,this.v3^=u^I,this.v4^=d^k,this.v5^=f^C,this.v6^=p^R,this.v7^=y^U}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};Ce.BLAKE2s=Pu;Ce.blake2s=(0,en.wrapConstructorWithOpts)(e=>new Pu(e))});var Au=H(Iu=>{v();w();Object.defineProperty(Iu,"__esModule",{value:!0});Iu.pbkdf2=RS;Iu.pbkdf2Async=qS;var Eu=Wi(),US=fc(),Qo=xr();function Ub(e,t,r,n){(0,Eu.ahash)(e);let i=(0,Qo.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:o,asyncTick:a}=i;if((0,Eu.anumber)(s),(0,Eu.anumber)(o),(0,Eu.anumber)(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let c=(0,Qo.toBytes)(t),u=(0,Qo.toBytes)(r),d=new Uint8Array(o),f=US.hmac.create(e,c),p=f._cloneInto().update(u);return{c:s,dkLen:o,asyncTick:a,DK:d,PRF:f,PRFSalt:p}}function Rb(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}function RS(e,t,r,n){let{c:i,dkLen:s,DK:o,PRF:a,PRFSalt:c}=Ub(e,t,r,n),u,d=new Uint8Array(4),f=(0,Qo.createView)(d),p=new Uint8Array(a.outputLen);for(let y=1,m=0;m<s;y++,m+=a.outputLen){let _=o.subarray(m,m+a.outputLen);f.setInt32(0,y,!1),(u=c._cloneInto(u)).update(d).digestInto(p),_.set(p.subarray(0,_.length));for(let E=1;E<i;E++){a._cloneInto(u).update(p).digestInto(p);for(let I=0;I<_.length;I++)_[I]^=p[I]}}return Rb(a,c,o,u,p)}async function qS(e,t,r,n){let{c:i,dkLen:s,asyncTick:o,DK:a,PRF:c,PRFSalt:u}=Ub(e,t,r,n),d,f=new Uint8Array(4),p=(0,Qo.createView)(f),y=new Uint8Array(c.outputLen);for(let m=1,_=0;_<s;m++,_+=c.outputLen){let E=a.subarray(_,_+c.outputLen);p.setInt32(0,m,!1),(d=u._cloneInto(d)).update(f).digestInto(y),E.set(y.subarray(0,E.length)),await(0,Qo.asyncLoop)(i-1,o,()=>{c._cloneInto(d).update(y).digestInto(y);for(let I=0;I<E.length;I++)E[I]^=y[I]})}return Rb(c,u,a,d,y)}});var Fb=H(Ou=>{v();w();Object.defineProperty(Ou,"__esModule",{value:!0});Ou.scrypt=LS;Ou.scryptAsync=KS;var ea=Wi(),Lb=Au(),Kb=Vo(),te=xr();function qb(e,t,r,n,i,s){let o=e[t++]^r[n++],a=e[t++]^r[n++],c=e[t++]^r[n++],u=e[t++]^r[n++],d=e[t++]^r[n++],f=e[t++]^r[n++],p=e[t++]^r[n++],y=e[t++]^r[n++],m=e[t++]^r[n++],_=e[t++]^r[n++],E=e[t++]^r[n++],I=e[t++]^r[n++],k=e[t++]^r[n++],C=e[t++]^r[n++],R=e[t++]^r[n++],U=e[t++]^r[n++],q=o,L=a,K=c,W=u,O=d,l=f,g=p,S=y,T=m,x=_,B=E,M=I,P=k,b=C,A=R,j=U;for(let D=0;D<8;D+=2)O^=(0,te.rotl)(q+P|0,7),T^=(0,te.rotl)(O+q|0,9),P^=(0,te.rotl)(T+O|0,13),q^=(0,te.rotl)(P+T|0,18),x^=(0,te.rotl)(l+L|0,7),b^=(0,te.rotl)(x+l|0,9),L^=(0,te.rotl)(b+x|0,13),l^=(0,te.rotl)(L+b|0,18),A^=(0,te.rotl)(B+g|0,7),K^=(0,te.rotl)(A+B|0,9),g^=(0,te.rotl)(K+A|0,13),B^=(0,te.rotl)(g+K|0,18),W^=(0,te.rotl)(j+M|0,7),S^=(0,te.rotl)(W+j|0,9),M^=(0,te.rotl)(S+W|0,13),j^=(0,te.rotl)(M+S|0,18),L^=(0,te.rotl)(q+W|0,7),K^=(0,te.rotl)(L+q|0,9),W^=(0,te.rotl)(K+L|0,13),q^=(0,te.rotl)(W+K|0,18),g^=(0,te.rotl)(l+O|0,7),S^=(0,te.rotl)(g+l|0,9),O^=(0,te.rotl)(S+g|0,13),l^=(0,te.rotl)(O+S|0,18),M^=(0,te.rotl)(B+x|0,7),T^=(0,te.rotl)(M+B|0,9),x^=(0,te.rotl)(T+M|0,13),B^=(0,te.rotl)(x+T|0,18),P^=(0,te.rotl)(j+A|0,7),b^=(0,te.rotl)(P+j|0,9),A^=(0,te.rotl)(b+P|0,13),j^=(0,te.rotl)(A+b|0,18);i[s++]=o+q|0,i[s++]=a+L|0,i[s++]=c+K|0,i[s++]=u+W|0,i[s++]=d+O|0,i[s++]=f+l|0,i[s++]=p+g|0,i[s++]=y+S|0,i[s++]=m+T|0,i[s++]=_+x|0,i[s++]=E+B|0,i[s++]=I+M|0,i[s++]=k+P|0,i[s++]=C+b|0,i[s++]=R+A|0,i[s++]=U+j|0}function ta(e,t,r,n,i){let s=n+0,o=n+16*i;for(let a=0;a<16;a++)r[o+a]=e[t+(2*i-1)*16+a];for(let a=0;a<i;a++,s+=16,t+=16)qb(r,o,e,t,r,s),a>0&&(o+=16),qb(r,s,e,t+=16,r,o)}function Db(e,t,r){let n=(0,te.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:o,dkLen:a,asyncTick:c,maxmem:u,onProgress:d}=n;if((0,ea.anumber)(i),(0,ea.anumber)(s),(0,ea.anumber)(o),(0,ea.anumber)(a),(0,ea.anumber)(c),(0,ea.anumber)(u),d!==void 0&&typeof d!="function")throw new Error("progressCb should be function");let f=128*s,p=f/4;if(i<=1||(i&i-1)!==0||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(o<0||o>(2**32-1)*32/f)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(f*(i+o)>u)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+u);let m=(0,Lb.pbkdf2)(Kb.sha256,e,t,{c:1,dkLen:f*o}),_=(0,te.u32)(m),E=(0,te.u32)(new Uint8Array(f*i)),I=(0,te.u32)(new Uint8Array(f)),k=()=>{};if(d){let C=2*i*o,R=Math.max(Math.floor(C/1e4),1),U=0;k=()=>{U++,d&&(!(U%R)||U===C)&&d(U/C)}}return{N:i,r:s,p:o,dkLen:a,blockSize32:p,V:E,B32:_,B:m,tmp:I,blockMixCb:k,asyncTick:c}}function jb(e,t,r,n,i){let s=(0,Lb.pbkdf2)(Kb.sha256,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),i.fill(0),s}function LS(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:u,B:d,tmp:f,blockMixCb:p}=Db(e,t,r);te.isLE||(0,te.byteSwap32)(u);for(let y=0;y<s;y++){let m=a*y;for(let _=0;_<a;_++)c[_]=u[m+_];for(let _=0,E=0;_<n-1;_++)ta(c,E,c,E+=a,i),p();ta(c,(n-1)*a,u,m,i),p();for(let _=0;_<n;_++){let E=u[m+a-16]%n;for(let I=0;I<a;I++)f[I]=u[m+I]^c[E*a+I];ta(f,0,u,m,i),p()}}return te.isLE||(0,te.byteSwap32)(u),jb(e,o,d,c,f)}async function KS(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:u,B:d,tmp:f,blockMixCb:p,asyncTick:y}=Db(e,t,r);te.isLE||(0,te.byteSwap32)(u);for(let m=0;m<s;m++){let _=a*m;for(let I=0;I<a;I++)c[I]=u[_+I];let E=0;await(0,te.asyncLoop)(n-1,y,()=>{ta(c,E,c,E+=a,i),p()}),ta(c,(n-1)*a,u,_,i),p(),await(0,te.asyncLoop)(n,y,()=>{let I=u[_+a-16]%n;for(let k=0;k<a;k++)f[k]=u[_+k]^c[I*a+k];ta(f,0,u,_,i),p()})}return te.isLE||(0,te.byteSwap32)(u),jb(e,o,d,c,f)}});var Wb=H(na=>{v();w();Object.defineProperty(na,"__esModule",{value:!0});na.blake3=na.BLAKE3=void 0;var dc=Wi(),DS=vu(),Vb=Go(),ni=ml(),cr=xr(),bi={CHUNK_START:1<<0,CHUNK_END:1<<1,PARENT:1<<2,ROOT:1<<3,KEYED_HASH:1<<4,DERIVE_KEY_CONTEXT:1<<5,DERIVE_KEY_MATERIAL:1<<6},Gb=(()=>{let e=Array.from({length:16},(n,i)=>i),t=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=e;n<7;n++,i=t(i))r.push(...i);return Uint8Array.from(r)})(),ra=class extends DS.BLAKE{constructor(t={},r=0){let n=t.dkLen===void 0?32:t.dkLen;if(super(64,n,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,(0,dc.anumber)(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){let i=(0,cr.toBytes)(t.key).slice();if(i.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,cr.u32)(i),cr.isLE||(0,cr.byteSwap32)(this.IV),this.flags=r|bi.KEYED_HASH}else if(t.context!==void 0){let i=new ra({dkLen:32},bi.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=(0,cr.u32)(i),cr.isLE||(0,cr.byteSwap32)(this.IV),this.flags=r|bi.DERIVE_KEY_MATERIAL}else this.IV=ni.B2S_IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,cr.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,r,n,i=0){let{state:s,pos:o}=this,{h:a,l:c}=(0,Vb.fromBig)(BigInt(t),!0),{v0:u,v1:d,v2:f,v3:p,v4:y,v5:m,v6:_,v7:E,v8:I,v9:k,v10:C,v11:R,v12:U,v13:q,v14:L,v15:K}=(0,ni.compress)(Gb,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],ni.B2S_IV[0],ni.B2S_IV[1],ni.B2S_IV[2],ni.B2S_IV[3],a,c,o,r);s[0]=u^I,s[1]=d^k,s[2]=f^C,s[3]=p^R,s[4]=y^U,s[5]=m^q,s[6]=_^L,s[7]=E^K}compress(t,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=bi.CHUNK_START),(this.chunkPos===15||n)&&(i|=bi.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,t,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let o,a=this.chunksDone+1;(n||!(a&1))&&(o=this.stack.pop());a>>=1)this.buffer32.set(o,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|bi.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:r,flags:n,state:i,chunkPos:s,posOut:o,chunkOut:a,stack:c,chunksDone:u}=this;return t.state.set(i.slice()),t.stack=c.map(d=>Uint32Array.from(d)),t.IV.set(r),t.flags=n,t.chunkPos=s,t.chunksDone=u,t.posOut=o,t.chunkOut=a,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){let{state:t,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:o,l:a}=(0,Vb.fromBig)(BigInt(this.chunkOut++));cr.isLE||(0,cr.byteSwap32)(i);let{v0:c,v1:u,v2:d,v3:f,v4:p,v5:y,v6:m,v7:_,v8:E,v9:I,v10:k,v11:C,v12:R,v13:U,v14:q,v15:L}=(0,ni.compress)(Gb,0,i,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],ni.B2S_IV[0],ni.B2S_IV[1],ni.B2S_IV[2],ni.B2S_IV[3],a,o,r,n);s[0]=c^E,s[1]=u^I,s[2]=d^k,s[3]=f^C,s[4]=p^R,s[5]=y^U,s[6]=m^q,s[7]=_^L,s[8]=t[0]^E,s[9]=t[1]^I,s[10]=t[2]^k,s[11]=t[3]^C,s[12]=t[4]^R,s[13]=t[5]^U,s[14]=t[6]^q,s[15]=t[7]^L,cr.isLE||((0,cr.byteSwap32)(i),(0,cr.byteSwap32)(s)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|bi.ROOT;this.stack.length?(t|=bi.PARENT,cr.isLE||(0,cr.byteSwap32)(this.buffer32),this.compress(this.buffer32,0,!0),cr.isLE||(0,cr.byteSwap32)(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:bi.CHUNK_START)|bi.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){(0,dc.aexists)(this,!1),(0,dc.abytes)(t),this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.b2CompressOut();let o=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return(0,dc.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,dc.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};na.BLAKE3=ra;na.blake3=(0,cr.wrapXOFConstructorWithOpts)(e=>new ra(e))});var lc=H(Oe=>{v();w();var zb=Oe&&Oe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),jS=Oe&&Oe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Gr=Oe&&Oe.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&zb(t,e,r)},FS=Oe&&Oe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&zb(t,e,r);return jS(t,e),t};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.randomBytes=Oe.concatBytes=Oe.reverseBuffer=void 0;Gr(Kp(),Oe);Gr(jp(),Oe);Gr(xu(),Oe);Gr(kb(),Oe);Gr(tl(),Oe);Gr(Vo(),Oe);Gr(fc(),Oe);Gr(bl(),Oe);Gr(sc(),Oe);Gr(_u(),Oe);Gr(yl(),Oe);Gr(ml(),Oe);Gr(Au(),Oe);Gr(Fb(),Oe);Gr(Wb(),Oe);var VS=FS(xr()),GS=g3();function WS(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Oe.reverseBuffer=WS;function zS(e,t){return VS.concatBytes(Uint8Array.from(e),Uint8Array.from(t))}Oe.concatBytes=zS;function XS(e){return GS(e)}Oe.randomBytes=XS});var tn=H((Xb,_l)=>{v();w();(function(e,t){"use strict";function r(O,l){if(!O)throw new Error(l||"Assertion failed")}function n(O,l){O.super_=l;var g=function(){};g.prototype=l.prototype,O.prototype=new g,O.prototype.constructor=O}function i(O,l,g){if(i.isBN(O))return O;this.negative=0,this.words=null,this.length=0,this.red=null,O!==null&&((l==="le"||l==="be")&&(g=l,l=10),this._init(O||0,l||10,g||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=tc().Buffer}catch{}i.isBN=function(l){return l instanceof i?!0:l!==null&&typeof l=="object"&&l.constructor.wordSize===i.wordSize&&Array.isArray(l.words)},i.max=function(l,g){return l.cmp(g)>0?l:g},i.min=function(l,g){return l.cmp(g)<0?l:g},i.prototype._init=function(l,g,S){if(typeof l=="number")return this._initNumber(l,g,S);if(typeof l=="object")return this._initArray(l,g,S);g==="hex"&&(g=16),r(g===(g|0)&&g>=2&&g<=36),l=l.toString().replace(/\s+/g,"");var T=0;l[0]==="-"&&(T++,this.negative=1),T<l.length&&(g===16?this._parseHex(l,T,S):(this._parseBase(l,g,T),S==="le"&&this._initArray(this.toArray(),g,S)))},i.prototype._initNumber=function(l,g,S){l<0&&(this.negative=1,l=-l),l<67108864?(this.words=[l&67108863],this.length=1):l<4503599627370496?(this.words=[l&67108863,l/67108864&67108863],this.length=2):(r(l<9007199254740992),this.words=[l&67108863,l/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),g,S)},i.prototype._initArray=function(l,g,S){if(r(typeof l.length=="number"),l.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(l.length/3),this.words=new Array(this.length);for(var T=0;T<this.length;T++)this.words[T]=0;var x,B,M=0;if(S==="be")for(T=l.length-1,x=0;T>=0;T-=3)B=l[T]|l[T-1]<<8|l[T-2]<<16,this.words[x]|=B<<M&67108863,this.words[x+1]=B>>>26-M&67108863,M+=24,M>=26&&(M-=26,x++);else if(S==="le")for(T=0,x=0;T<l.length;T+=3)B=l[T]|l[T+1]<<8|l[T+2]<<16,this.words[x]|=B<<M&67108863,this.words[x+1]=B>>>26-M&67108863,M+=24,M>=26&&(M-=26,x++);return this.strip()};function o(O,l){var g=O.charCodeAt(l);return g>=65&&g<=70?g-55:g>=97&&g<=102?g-87:g-48&15}function a(O,l,g){var S=o(O,g);return g-1>=l&&(S|=o(O,g-1)<<4),S}i.prototype._parseHex=function(l,g,S){this.length=Math.ceil((l.length-g)/6),this.words=new Array(this.length);for(var T=0;T<this.length;T++)this.words[T]=0;var x=0,B=0,M;if(S==="be")for(T=l.length-1;T>=g;T-=2)M=a(l,g,T)<<x,this.words[B]|=M&67108863,x>=18?(x-=18,B+=1,this.words[B]|=M>>>26):x+=8;else{var P=l.length-g;for(T=P%2===0?g+1:g;T<l.length;T+=2)M=a(l,g,T)<<x,this.words[B]|=M&67108863,x>=18?(x-=18,B+=1,this.words[B]|=M>>>26):x+=8}this.strip()};function c(O,l,g,S){for(var T=0,x=Math.min(O.length,g),B=l;B<x;B++){var M=O.charCodeAt(B)-48;T*=S,M>=49?T+=M-49+10:M>=17?T+=M-17+10:T+=M}return T}i.prototype._parseBase=function(l,g,S){this.words=[0],this.length=1;for(var T=0,x=1;x<=67108863;x*=g)T++;T--,x=x/g|0;for(var B=l.length-S,M=B%T,P=Math.min(B,B-M)+S,b=0,A=S;A<P;A+=T)b=c(l,A,A+T,g),this.imuln(x),this.words[0]+b<67108864?this.words[0]+=b:this._iaddn(b);if(M!==0){var j=1;for(b=c(l,A,l.length,g),A=0;A<M;A++)j*=g;this.imuln(j),this.words[0]+b<67108864?this.words[0]+=b:this._iaddn(b)}this.strip()},i.prototype.copy=function(l){l.words=new Array(this.length);for(var g=0;g<this.length;g++)l.words[g]=this.words[g];l.length=this.length,l.negative=this.negative,l.red=this.red},i.prototype.clone=function(){var l=new i(null);return this.copy(l),l},i.prototype._expand=function(l){for(;this.length<l;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(l,g){l=l||10,g=g|0||1;var S;if(l===16||l==="hex"){S="";for(var T=0,x=0,B=0;B<this.length;B++){var M=this.words[B],P=((M<<T|x)&16777215).toString(16);x=M>>>24-T&16777215,x!==0||B!==this.length-1?S=u[6-P.length]+P+S:S=P+S,T+=2,T>=26&&(T-=26,B--)}for(x!==0&&(S=x.toString(16)+S);S.length%g!==0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(l===(l|0)&&l>=2&&l<=36){var b=d[l],A=f[l];S="";var j=this.clone();for(j.negative=0;!j.isZero();){var D=j.modn(A).toString(l);j=j.idivn(A),j.isZero()?S=D+S:S=u[b-D.length]+D+S}for(this.isZero()&&(S="0"+S);S.length%g!==0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var l=this.words[0];return this.length===2?l+=this.words[1]*67108864:this.length===3&&this.words[2]===1?l+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-l:l},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(l,g){return r(typeof s<"u"),this.toArrayLike(s,l,g)},i.prototype.toArray=function(l,g){return this.toArrayLike(Array,l,g)},i.prototype.toArrayLike=function(l,g,S){var T=this.byteLength(),x=S||Math.max(1,T);r(T<=x,"byte array longer than desired length"),r(x>0,"Requested array length <= 0"),this.strip();var B=g==="le",M=new l(x),P,b,A=this.clone();if(B){for(b=0;!A.isZero();b++)P=A.andln(255),A.iushrn(8),M[b]=P;for(;b<x;b++)M[b]=0}else{for(b=0;b<x-T;b++)M[b]=0;for(b=0;!A.isZero();b++)P=A.andln(255),A.iushrn(8),M[x-b-1]=P}return M},Math.clz32?i.prototype._countBits=function(l){return 32-Math.clz32(l)}:i.prototype._countBits=function(l){var g=l,S=0;return g>=4096&&(S+=13,g>>>=13),g>=64&&(S+=7,g>>>=7),g>=8&&(S+=4,g>>>=4),g>=2&&(S+=2,g>>>=2),S+g},i.prototype._zeroBits=function(l){if(l===0)return 26;var g=l,S=0;return(g&8191)===0&&(S+=13,g>>>=13),(g&127)===0&&(S+=7,g>>>=7),(g&15)===0&&(S+=4,g>>>=4),(g&3)===0&&(S+=2,g>>>=2),(g&1)===0&&S++,S},i.prototype.bitLength=function(){var l=this.words[this.length-1],g=this._countBits(l);return(this.length-1)*26+g};function p(O){for(var l=new Array(O.bitLength()),g=0;g<l.length;g++){var S=g/26|0,T=g%26;l[g]=(O.words[S]&1<<T)>>>T}return l}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var l=0,g=0;g<this.length;g++){var S=this._zeroBits(this.words[g]);if(l+=S,S!==26)break}return l},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(l){return this.negative!==0?this.abs().inotn(l).iaddn(1):this.clone()},i.prototype.fromTwos=function(l){return this.testn(l-1)?this.notn(l).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(l){for(;this.length<l.length;)this.words[this.length++]=0;for(var g=0;g<l.length;g++)this.words[g]=this.words[g]|l.words[g];return this.strip()},i.prototype.ior=function(l){return r((this.negative|l.negative)===0),this.iuor(l)},i.prototype.or=function(l){return this.length>l.length?this.clone().ior(l):l.clone().ior(this)},i.prototype.uor=function(l){return this.length>l.length?this.clone().iuor(l):l.clone().iuor(this)},i.prototype.iuand=function(l){var g;this.length>l.length?g=l:g=this;for(var S=0;S<g.length;S++)this.words[S]=this.words[S]&l.words[S];return this.length=g.length,this.strip()},i.prototype.iand=function(l){return r((this.negative|l.negative)===0),this.iuand(l)},i.prototype.and=function(l){return this.length>l.length?this.clone().iand(l):l.clone().iand(this)},i.prototype.uand=function(l){return this.length>l.length?this.clone().iuand(l):l.clone().iuand(this)},i.prototype.iuxor=function(l){var g,S;this.length>l.length?(g=this,S=l):(g=l,S=this);for(var T=0;T<S.length;T++)this.words[T]=g.words[T]^S.words[T];if(this!==g)for(;T<g.length;T++)this.words[T]=g.words[T];return this.length=g.length,this.strip()},i.prototype.ixor=function(l){return r((this.negative|l.negative)===0),this.iuxor(l)},i.prototype.xor=function(l){return this.length>l.length?this.clone().ixor(l):l.clone().ixor(this)},i.prototype.uxor=function(l){return this.length>l.length?this.clone().iuxor(l):l.clone().iuxor(this)},i.prototype.inotn=function(l){r(typeof l=="number"&&l>=0);var g=Math.ceil(l/26)|0,S=l%26;this._expand(g),S>0&&g--;for(var T=0;T<g;T++)this.words[T]=~this.words[T]&67108863;return S>0&&(this.words[T]=~this.words[T]&67108863>>26-S),this.strip()},i.prototype.notn=function(l){return this.clone().inotn(l)},i.prototype.setn=function(l,g){r(typeof l=="number"&&l>=0);var S=l/26|0,T=l%26;return this._expand(S+1),g?this.words[S]=this.words[S]|1<<T:this.words[S]=this.words[S]&~(1<<T),this.strip()},i.prototype.iadd=function(l){var g;if(this.negative!==0&&l.negative===0)return this.negative=0,g=this.isub(l),this.negative^=1,this._normSign();if(this.negative===0&&l.negative!==0)return l.negative=0,g=this.isub(l),l.negative=1,g._normSign();var S,T;this.length>l.length?(S=this,T=l):(S=l,T=this);for(var x=0,B=0;B<T.length;B++)g=(S.words[B]|0)+(T.words[B]|0)+x,this.words[B]=g&67108863,x=g>>>26;for(;x!==0&&B<S.length;B++)g=(S.words[B]|0)+x,this.words[B]=g&67108863,x=g>>>26;if(this.length=S.length,x!==0)this.words[this.length]=x,this.length++;else if(S!==this)for(;B<S.length;B++)this.words[B]=S.words[B];return this},i.prototype.add=function(l){var g;return l.negative!==0&&this.negative===0?(l.negative=0,g=this.sub(l),l.negative^=1,g):l.negative===0&&this.negative!==0?(this.negative=0,g=l.sub(this),this.negative=1,g):this.length>l.length?this.clone().iadd(l):l.clone().iadd(this)},i.prototype.isub=function(l){if(l.negative!==0){l.negative=0;var g=this.iadd(l);return l.negative=1,g._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(l),this.negative=1,this._normSign();var S=this.cmp(l);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var T,x;S>0?(T=this,x=l):(T=l,x=this);for(var B=0,M=0;M<x.length;M++)g=(T.words[M]|0)-(x.words[M]|0)+B,B=g>>26,this.words[M]=g&67108863;for(;B!==0&&M<T.length;M++)g=(T.words[M]|0)+B,B=g>>26,this.words[M]=g&67108863;if(B===0&&M<T.length&&T!==this)for(;M<T.length;M++)this.words[M]=T.words[M];return this.length=Math.max(this.length,M),T!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(l){return this.clone().isub(l)};function y(O,l,g){g.negative=l.negative^O.negative;var S=O.length+l.length|0;g.length=S,S=S-1|0;var T=O.words[0]|0,x=l.words[0]|0,B=T*x,M=B&67108863,P=B/67108864|0;g.words[0]=M;for(var b=1;b<S;b++){for(var A=P>>>26,j=P&67108863,D=Math.min(b,l.length-1),V=Math.max(0,b-O.length+1);V<=D;V++){var J=b-V|0;T=O.words[J]|0,x=l.words[V]|0,B=T*x+j,A+=B/67108864|0,j=B&67108863}g.words[b]=j|0,P=A|0}return P!==0?g.words[b]=P|0:g.length--,g.strip()}var m=function(l,g,S){var T=l.words,x=g.words,B=S.words,M=0,P,b,A,j=T[0]|0,D=j&8191,V=j>>>13,J=T[1]|0,fe=J&8191,xe=J>>>13,Sr=T[2]|0,Be=Sr&8191,Te=Sr>>>13,Vi=T[3]|0,rt=Vi&8191,Ie=Vi>>>13,Gi=T[4]|0,je=Gi&8191,nt=Gi>>>13,ec=T[5]|0,bt=ec&8191,gt=ec>>>13,wp=T[6]|0,yt=wp&8191,mt=wp>>>13,Sp=T[7]|0,_t=Sp&8191,vt=Sp>>>13,xp=T[8]|0,wt=xp&8191,St=xp>>>13,Tp=T[9]|0,xt=Tp&8191,Tt=Tp>>>13,Pp=x[0]|0,Pt=Pp&8191,Et=Pp>>>13,Ep=x[1]|0,It=Ep&8191,At=Ep>>>13,Ip=x[2]|0,Ot=Ip&8191,Bt=Ip>>>13,Ap=x[3]|0,Mt=Ap&8191,Ct=Ap>>>13,Op=x[4]|0,kt=Op&8191,Ht=Op>>>13,Bp=x[5]|0,Nt=Bp&8191,Ut=Bp>>>13,Mp=x[6]|0,Rt=Mp&8191,qt=Mp>>>13,Cp=x[7]|0,Lt=Cp&8191,Kt=Cp>>>13,kp=x[8]|0,Dt=kp&8191,jt=kp>>>13,Hp=x[9]|0,Ft=Hp&8191,Vt=Hp>>>13;S.negative=l.negative^g.negative,S.length=19,P=Math.imul(D,Pt),b=Math.imul(D,Et),b=b+Math.imul(V,Pt)|0,A=Math.imul(V,Et);var Nd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Nd>>>26)|0,Nd&=67108863,P=Math.imul(fe,Pt),b=Math.imul(fe,Et),b=b+Math.imul(xe,Pt)|0,A=Math.imul(xe,Et),P=P+Math.imul(D,It)|0,b=b+Math.imul(D,At)|0,b=b+Math.imul(V,It)|0,A=A+Math.imul(V,At)|0;var Ud=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Ud>>>26)|0,Ud&=67108863,P=Math.imul(Be,Pt),b=Math.imul(Be,Et),b=b+Math.imul(Te,Pt)|0,A=Math.imul(Te,Et),P=P+Math.imul(fe,It)|0,b=b+Math.imul(fe,At)|0,b=b+Math.imul(xe,It)|0,A=A+Math.imul(xe,At)|0,P=P+Math.imul(D,Ot)|0,b=b+Math.imul(D,Bt)|0,b=b+Math.imul(V,Ot)|0,A=A+Math.imul(V,Bt)|0;var Rd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Rd>>>26)|0,Rd&=67108863,P=Math.imul(rt,Pt),b=Math.imul(rt,Et),b=b+Math.imul(Ie,Pt)|0,A=Math.imul(Ie,Et),P=P+Math.imul(Be,It)|0,b=b+Math.imul(Be,At)|0,b=b+Math.imul(Te,It)|0,A=A+Math.imul(Te,At)|0,P=P+Math.imul(fe,Ot)|0,b=b+Math.imul(fe,Bt)|0,b=b+Math.imul(xe,Ot)|0,A=A+Math.imul(xe,Bt)|0,P=P+Math.imul(D,Mt)|0,b=b+Math.imul(D,Ct)|0,b=b+Math.imul(V,Mt)|0,A=A+Math.imul(V,Ct)|0;var qd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(qd>>>26)|0,qd&=67108863,P=Math.imul(je,Pt),b=Math.imul(je,Et),b=b+Math.imul(nt,Pt)|0,A=Math.imul(nt,Et),P=P+Math.imul(rt,It)|0,b=b+Math.imul(rt,At)|0,b=b+Math.imul(Ie,It)|0,A=A+Math.imul(Ie,At)|0,P=P+Math.imul(Be,Ot)|0,b=b+Math.imul(Be,Bt)|0,b=b+Math.imul(Te,Ot)|0,A=A+Math.imul(Te,Bt)|0,P=P+Math.imul(fe,Mt)|0,b=b+Math.imul(fe,Ct)|0,b=b+Math.imul(xe,Mt)|0,A=A+Math.imul(xe,Ct)|0,P=P+Math.imul(D,kt)|0,b=b+Math.imul(D,Ht)|0,b=b+Math.imul(V,kt)|0,A=A+Math.imul(V,Ht)|0;var Ld=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Ld>>>26)|0,Ld&=67108863,P=Math.imul(bt,Pt),b=Math.imul(bt,Et),b=b+Math.imul(gt,Pt)|0,A=Math.imul(gt,Et),P=P+Math.imul(je,It)|0,b=b+Math.imul(je,At)|0,b=b+Math.imul(nt,It)|0,A=A+Math.imul(nt,At)|0,P=P+Math.imul(rt,Ot)|0,b=b+Math.imul(rt,Bt)|0,b=b+Math.imul(Ie,Ot)|0,A=A+Math.imul(Ie,Bt)|0,P=P+Math.imul(Be,Mt)|0,b=b+Math.imul(Be,Ct)|0,b=b+Math.imul(Te,Mt)|0,A=A+Math.imul(Te,Ct)|0,P=P+Math.imul(fe,kt)|0,b=b+Math.imul(fe,Ht)|0,b=b+Math.imul(xe,kt)|0,A=A+Math.imul(xe,Ht)|0,P=P+Math.imul(D,Nt)|0,b=b+Math.imul(D,Ut)|0,b=b+Math.imul(V,Nt)|0,A=A+Math.imul(V,Ut)|0;var Kd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Kd>>>26)|0,Kd&=67108863,P=Math.imul(yt,Pt),b=Math.imul(yt,Et),b=b+Math.imul(mt,Pt)|0,A=Math.imul(mt,Et),P=P+Math.imul(bt,It)|0,b=b+Math.imul(bt,At)|0,b=b+Math.imul(gt,It)|0,A=A+Math.imul(gt,At)|0,P=P+Math.imul(je,Ot)|0,b=b+Math.imul(je,Bt)|0,b=b+Math.imul(nt,Ot)|0,A=A+Math.imul(nt,Bt)|0,P=P+Math.imul(rt,Mt)|0,b=b+Math.imul(rt,Ct)|0,b=b+Math.imul(Ie,Mt)|0,A=A+Math.imul(Ie,Ct)|0,P=P+Math.imul(Be,kt)|0,b=b+Math.imul(Be,Ht)|0,b=b+Math.imul(Te,kt)|0,A=A+Math.imul(Te,Ht)|0,P=P+Math.imul(fe,Nt)|0,b=b+Math.imul(fe,Ut)|0,b=b+Math.imul(xe,Nt)|0,A=A+Math.imul(xe,Ut)|0,P=P+Math.imul(D,Rt)|0,b=b+Math.imul(D,qt)|0,b=b+Math.imul(V,Rt)|0,A=A+Math.imul(V,qt)|0;var Dd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Dd>>>26)|0,Dd&=67108863,P=Math.imul(_t,Pt),b=Math.imul(_t,Et),b=b+Math.imul(vt,Pt)|0,A=Math.imul(vt,Et),P=P+Math.imul(yt,It)|0,b=b+Math.imul(yt,At)|0,b=b+Math.imul(mt,It)|0,A=A+Math.imul(mt,At)|0,P=P+Math.imul(bt,Ot)|0,b=b+Math.imul(bt,Bt)|0,b=b+Math.imul(gt,Ot)|0,A=A+Math.imul(gt,Bt)|0,P=P+Math.imul(je,Mt)|0,b=b+Math.imul(je,Ct)|0,b=b+Math.imul(nt,Mt)|0,A=A+Math.imul(nt,Ct)|0,P=P+Math.imul(rt,kt)|0,b=b+Math.imul(rt,Ht)|0,b=b+Math.imul(Ie,kt)|0,A=A+Math.imul(Ie,Ht)|0,P=P+Math.imul(Be,Nt)|0,b=b+Math.imul(Be,Ut)|0,b=b+Math.imul(Te,Nt)|0,A=A+Math.imul(Te,Ut)|0,P=P+Math.imul(fe,Rt)|0,b=b+Math.imul(fe,qt)|0,b=b+Math.imul(xe,Rt)|0,A=A+Math.imul(xe,qt)|0,P=P+Math.imul(D,Lt)|0,b=b+Math.imul(D,Kt)|0,b=b+Math.imul(V,Lt)|0,A=A+Math.imul(V,Kt)|0;var jd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(jd>>>26)|0,jd&=67108863,P=Math.imul(wt,Pt),b=Math.imul(wt,Et),b=b+Math.imul(St,Pt)|0,A=Math.imul(St,Et),P=P+Math.imul(_t,It)|0,b=b+Math.imul(_t,At)|0,b=b+Math.imul(vt,It)|0,A=A+Math.imul(vt,At)|0,P=P+Math.imul(yt,Ot)|0,b=b+Math.imul(yt,Bt)|0,b=b+Math.imul(mt,Ot)|0,A=A+Math.imul(mt,Bt)|0,P=P+Math.imul(bt,Mt)|0,b=b+Math.imul(bt,Ct)|0,b=b+Math.imul(gt,Mt)|0,A=A+Math.imul(gt,Ct)|0,P=P+Math.imul(je,kt)|0,b=b+Math.imul(je,Ht)|0,b=b+Math.imul(nt,kt)|0,A=A+Math.imul(nt,Ht)|0,P=P+Math.imul(rt,Nt)|0,b=b+Math.imul(rt,Ut)|0,b=b+Math.imul(Ie,Nt)|0,A=A+Math.imul(Ie,Ut)|0,P=P+Math.imul(Be,Rt)|0,b=b+Math.imul(Be,qt)|0,b=b+Math.imul(Te,Rt)|0,A=A+Math.imul(Te,qt)|0,P=P+Math.imul(fe,Lt)|0,b=b+Math.imul(fe,Kt)|0,b=b+Math.imul(xe,Lt)|0,A=A+Math.imul(xe,Kt)|0,P=P+Math.imul(D,Dt)|0,b=b+Math.imul(D,jt)|0,b=b+Math.imul(V,Dt)|0,A=A+Math.imul(V,jt)|0;var Fd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Fd>>>26)|0,Fd&=67108863,P=Math.imul(xt,Pt),b=Math.imul(xt,Et),b=b+Math.imul(Tt,Pt)|0,A=Math.imul(Tt,Et),P=P+Math.imul(wt,It)|0,b=b+Math.imul(wt,At)|0,b=b+Math.imul(St,It)|0,A=A+Math.imul(St,At)|0,P=P+Math.imul(_t,Ot)|0,b=b+Math.imul(_t,Bt)|0,b=b+Math.imul(vt,Ot)|0,A=A+Math.imul(vt,Bt)|0,P=P+Math.imul(yt,Mt)|0,b=b+Math.imul(yt,Ct)|0,b=b+Math.imul(mt,Mt)|0,A=A+Math.imul(mt,Ct)|0,P=P+Math.imul(bt,kt)|0,b=b+Math.imul(bt,Ht)|0,b=b+Math.imul(gt,kt)|0,A=A+Math.imul(gt,Ht)|0,P=P+Math.imul(je,Nt)|0,b=b+Math.imul(je,Ut)|0,b=b+Math.imul(nt,Nt)|0,A=A+Math.imul(nt,Ut)|0,P=P+Math.imul(rt,Rt)|0,b=b+Math.imul(rt,qt)|0,b=b+Math.imul(Ie,Rt)|0,A=A+Math.imul(Ie,qt)|0,P=P+Math.imul(Be,Lt)|0,b=b+Math.imul(Be,Kt)|0,b=b+Math.imul(Te,Lt)|0,A=A+Math.imul(Te,Kt)|0,P=P+Math.imul(fe,Dt)|0,b=b+Math.imul(fe,jt)|0,b=b+Math.imul(xe,Dt)|0,A=A+Math.imul(xe,jt)|0,P=P+Math.imul(D,Ft)|0,b=b+Math.imul(D,Vt)|0,b=b+Math.imul(V,Ft)|0,A=A+Math.imul(V,Vt)|0;var Vd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Vd>>>26)|0,Vd&=67108863,P=Math.imul(xt,It),b=Math.imul(xt,At),b=b+Math.imul(Tt,It)|0,A=Math.imul(Tt,At),P=P+Math.imul(wt,Ot)|0,b=b+Math.imul(wt,Bt)|0,b=b+Math.imul(St,Ot)|0,A=A+Math.imul(St,Bt)|0,P=P+Math.imul(_t,Mt)|0,b=b+Math.imul(_t,Ct)|0,b=b+Math.imul(vt,Mt)|0,A=A+Math.imul(vt,Ct)|0,P=P+Math.imul(yt,kt)|0,b=b+Math.imul(yt,Ht)|0,b=b+Math.imul(mt,kt)|0,A=A+Math.imul(mt,Ht)|0,P=P+Math.imul(bt,Nt)|0,b=b+Math.imul(bt,Ut)|0,b=b+Math.imul(gt,Nt)|0,A=A+Math.imul(gt,Ut)|0,P=P+Math.imul(je,Rt)|0,b=b+Math.imul(je,qt)|0,b=b+Math.imul(nt,Rt)|0,A=A+Math.imul(nt,qt)|0,P=P+Math.imul(rt,Lt)|0,b=b+Math.imul(rt,Kt)|0,b=b+Math.imul(Ie,Lt)|0,A=A+Math.imul(Ie,Kt)|0,P=P+Math.imul(Be,Dt)|0,b=b+Math.imul(Be,jt)|0,b=b+Math.imul(Te,Dt)|0,A=A+Math.imul(Te,jt)|0,P=P+Math.imul(fe,Ft)|0,b=b+Math.imul(fe,Vt)|0,b=b+Math.imul(xe,Ft)|0,A=A+Math.imul(xe,Vt)|0;var Gd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Gd>>>26)|0,Gd&=67108863,P=Math.imul(xt,Ot),b=Math.imul(xt,Bt),b=b+Math.imul(Tt,Ot)|0,A=Math.imul(Tt,Bt),P=P+Math.imul(wt,Mt)|0,b=b+Math.imul(wt,Ct)|0,b=b+Math.imul(St,Mt)|0,A=A+Math.imul(St,Ct)|0,P=P+Math.imul(_t,kt)|0,b=b+Math.imul(_t,Ht)|0,b=b+Math.imul(vt,kt)|0,A=A+Math.imul(vt,Ht)|0,P=P+Math.imul(yt,Nt)|0,b=b+Math.imul(yt,Ut)|0,b=b+Math.imul(mt,Nt)|0,A=A+Math.imul(mt,Ut)|0,P=P+Math.imul(bt,Rt)|0,b=b+Math.imul(bt,qt)|0,b=b+Math.imul(gt,Rt)|0,A=A+Math.imul(gt,qt)|0,P=P+Math.imul(je,Lt)|0,b=b+Math.imul(je,Kt)|0,b=b+Math.imul(nt,Lt)|0,A=A+Math.imul(nt,Kt)|0,P=P+Math.imul(rt,Dt)|0,b=b+Math.imul(rt,jt)|0,b=b+Math.imul(Ie,Dt)|0,A=A+Math.imul(Ie,jt)|0,P=P+Math.imul(Be,Ft)|0,b=b+Math.imul(Be,Vt)|0,b=b+Math.imul(Te,Ft)|0,A=A+Math.imul(Te,Vt)|0;var Wd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Wd>>>26)|0,Wd&=67108863,P=Math.imul(xt,Mt),b=Math.imul(xt,Ct),b=b+Math.imul(Tt,Mt)|0,A=Math.imul(Tt,Ct),P=P+Math.imul(wt,kt)|0,b=b+Math.imul(wt,Ht)|0,b=b+Math.imul(St,kt)|0,A=A+Math.imul(St,Ht)|0,P=P+Math.imul(_t,Nt)|0,b=b+Math.imul(_t,Ut)|0,b=b+Math.imul(vt,Nt)|0,A=A+Math.imul(vt,Ut)|0,P=P+Math.imul(yt,Rt)|0,b=b+Math.imul(yt,qt)|0,b=b+Math.imul(mt,Rt)|0,A=A+Math.imul(mt,qt)|0,P=P+Math.imul(bt,Lt)|0,b=b+Math.imul(bt,Kt)|0,b=b+Math.imul(gt,Lt)|0,A=A+Math.imul(gt,Kt)|0,P=P+Math.imul(je,Dt)|0,b=b+Math.imul(je,jt)|0,b=b+Math.imul(nt,Dt)|0,A=A+Math.imul(nt,jt)|0,P=P+Math.imul(rt,Ft)|0,b=b+Math.imul(rt,Vt)|0,b=b+Math.imul(Ie,Ft)|0,A=A+Math.imul(Ie,Vt)|0;var zd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(zd>>>26)|0,zd&=67108863,P=Math.imul(xt,kt),b=Math.imul(xt,Ht),b=b+Math.imul(Tt,kt)|0,A=Math.imul(Tt,Ht),P=P+Math.imul(wt,Nt)|0,b=b+Math.imul(wt,Ut)|0,b=b+Math.imul(St,Nt)|0,A=A+Math.imul(St,Ut)|0,P=P+Math.imul(_t,Rt)|0,b=b+Math.imul(_t,qt)|0,b=b+Math.imul(vt,Rt)|0,A=A+Math.imul(vt,qt)|0,P=P+Math.imul(yt,Lt)|0,b=b+Math.imul(yt,Kt)|0,b=b+Math.imul(mt,Lt)|0,A=A+Math.imul(mt,Kt)|0,P=P+Math.imul(bt,Dt)|0,b=b+Math.imul(bt,jt)|0,b=b+Math.imul(gt,Dt)|0,A=A+Math.imul(gt,jt)|0,P=P+Math.imul(je,Ft)|0,b=b+Math.imul(je,Vt)|0,b=b+Math.imul(nt,Ft)|0,A=A+Math.imul(nt,Vt)|0;var Xd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Xd>>>26)|0,Xd&=67108863,P=Math.imul(xt,Nt),b=Math.imul(xt,Ut),b=b+Math.imul(Tt,Nt)|0,A=Math.imul(Tt,Ut),P=P+Math.imul(wt,Rt)|0,b=b+Math.imul(wt,qt)|0,b=b+Math.imul(St,Rt)|0,A=A+Math.imul(St,qt)|0,P=P+Math.imul(_t,Lt)|0,b=b+Math.imul(_t,Kt)|0,b=b+Math.imul(vt,Lt)|0,A=A+Math.imul(vt,Kt)|0,P=P+Math.imul(yt,Dt)|0,b=b+Math.imul(yt,jt)|0,b=b+Math.imul(mt,Dt)|0,A=A+Math.imul(mt,jt)|0,P=P+Math.imul(bt,Ft)|0,b=b+Math.imul(bt,Vt)|0,b=b+Math.imul(gt,Ft)|0,A=A+Math.imul(gt,Vt)|0;var Yd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Yd>>>26)|0,Yd&=67108863,P=Math.imul(xt,Rt),b=Math.imul(xt,qt),b=b+Math.imul(Tt,Rt)|0,A=Math.imul(Tt,qt),P=P+Math.imul(wt,Lt)|0,b=b+Math.imul(wt,Kt)|0,b=b+Math.imul(St,Lt)|0,A=A+Math.imul(St,Kt)|0,P=P+Math.imul(_t,Dt)|0,b=b+Math.imul(_t,jt)|0,b=b+Math.imul(vt,Dt)|0,A=A+Math.imul(vt,jt)|0,P=P+Math.imul(yt,Ft)|0,b=b+Math.imul(yt,Vt)|0,b=b+Math.imul(mt,Ft)|0,A=A+Math.imul(mt,Vt)|0;var $d=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+($d>>>26)|0,$d&=67108863,P=Math.imul(xt,Lt),b=Math.imul(xt,Kt),b=b+Math.imul(Tt,Lt)|0,A=Math.imul(Tt,Kt),P=P+Math.imul(wt,Dt)|0,b=b+Math.imul(wt,jt)|0,b=b+Math.imul(St,Dt)|0,A=A+Math.imul(St,jt)|0,P=P+Math.imul(_t,Ft)|0,b=b+Math.imul(_t,Vt)|0,b=b+Math.imul(vt,Ft)|0,A=A+Math.imul(vt,Vt)|0;var Zd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Zd>>>26)|0,Zd&=67108863,P=Math.imul(xt,Dt),b=Math.imul(xt,jt),b=b+Math.imul(Tt,Dt)|0,A=Math.imul(Tt,jt),P=P+Math.imul(wt,Ft)|0,b=b+Math.imul(wt,Vt)|0,b=b+Math.imul(St,Ft)|0,A=A+Math.imul(St,Vt)|0;var Jd=(M+P|0)+((b&8191)<<13)|0;M=(A+(b>>>13)|0)+(Jd>>>26)|0,Jd&=67108863,P=Math.imul(xt,Ft),b=Math.imul(xt,Vt),b=b+Math.imul(Tt,Ft)|0,A=Math.imul(Tt,Vt);var Qd=(M+P|0)+((b&8191)<<13)|0;return M=(A+(b>>>13)|0)+(Qd>>>26)|0,Qd&=67108863,B[0]=Nd,B[1]=Ud,B[2]=Rd,B[3]=qd,B[4]=Ld,B[5]=Kd,B[6]=Dd,B[7]=jd,B[8]=Fd,B[9]=Vd,B[10]=Gd,B[11]=Wd,B[12]=zd,B[13]=Xd,B[14]=Yd,B[15]=$d,B[16]=Zd,B[17]=Jd,B[18]=Qd,M!==0&&(B[19]=M,S.length++),S};Math.imul||(m=y);function _(O,l,g){g.negative=l.negative^O.negative,g.length=O.length+l.length;for(var S=0,T=0,x=0;x<g.length-1;x++){var B=T;T=0;for(var M=S&67108863,P=Math.min(x,l.length-1),b=Math.max(0,x-O.length+1);b<=P;b++){var A=x-b,j=O.words[A]|0,D=l.words[b]|0,V=j*D,J=V&67108863;B=B+(V/67108864|0)|0,J=J+M|0,M=J&67108863,B=B+(J>>>26)|0,T+=B>>>26,B&=67108863}g.words[x]=M,S=B,B=T}return S!==0?g.words[x]=S:g.length--,g.strip()}function E(O,l,g){var S=new I;return S.mulp(O,l,g)}i.prototype.mulTo=function(l,g){var S,T=this.length+l.length;return this.length===10&&l.length===10?S=m(this,l,g):T<63?S=y(this,l,g):T<1024?S=_(this,l,g):S=E(this,l,g),S};function I(O,l){this.x=O,this.y=l}I.prototype.makeRBT=function(l){for(var g=new Array(l),S=i.prototype._countBits(l)-1,T=0;T<l;T++)g[T]=this.revBin(T,S,l);return g},I.prototype.revBin=function(l,g,S){if(l===0||l===S-1)return l;for(var T=0,x=0;x<g;x++)T|=(l&1)<<g-x-1,l>>=1;return T},I.prototype.permute=function(l,g,S,T,x,B){for(var M=0;M<B;M++)T[M]=g[l[M]],x[M]=S[l[M]]},I.prototype.transform=function(l,g,S,T,x,B){this.permute(B,l,g,S,T,x);for(var M=1;M<x;M<<=1)for(var P=M<<1,b=Math.cos(2*Math.PI/P),A=Math.sin(2*Math.PI/P),j=0;j<x;j+=P)for(var D=b,V=A,J=0;J<M;J++){var fe=S[j+J],xe=T[j+J],Sr=S[j+J+M],Be=T[j+J+M],Te=D*Sr-V*Be;Be=D*Be+V*Sr,Sr=Te,S[j+J]=fe+Sr,T[j+J]=xe+Be,S[j+J+M]=fe-Sr,T[j+J+M]=xe-Be,J!==P&&(Te=b*D-A*V,V=b*V+A*D,D=Te)}},I.prototype.guessLen13b=function(l,g){var S=Math.max(g,l)|1,T=S&1,x=0;for(S=S/2|0;S;S=S>>>1)x++;return 1<<x+1+T},I.prototype.conjugate=function(l,g,S){if(!(S<=1))for(var T=0;T<S/2;T++){var x=l[T];l[T]=l[S-T-1],l[S-T-1]=x,x=g[T],g[T]=-g[S-T-1],g[S-T-1]=-x}},I.prototype.normalize13b=function(l,g){for(var S=0,T=0;T<g/2;T++){var x=Math.round(l[2*T+1]/g)*8192+Math.round(l[2*T]/g)+S;l[T]=x&67108863,x<67108864?S=0:S=x/67108864|0}return l},I.prototype.convert13b=function(l,g,S,T){for(var x=0,B=0;B<g;B++)x=x+(l[B]|0),S[2*B]=x&8191,x=x>>>13,S[2*B+1]=x&8191,x=x>>>13;for(B=2*g;B<T;++B)S[B]=0;r(x===0),r((x&-8192)===0)},I.prototype.stub=function(l){for(var g=new Array(l),S=0;S<l;S++)g[S]=0;return g},I.prototype.mulp=function(l,g,S){var T=2*this.guessLen13b(l.length,g.length),x=this.makeRBT(T),B=this.stub(T),M=new Array(T),P=new Array(T),b=new Array(T),A=new Array(T),j=new Array(T),D=new Array(T),V=S.words;V.length=T,this.convert13b(l.words,l.length,M,T),this.convert13b(g.words,g.length,A,T),this.transform(M,B,P,b,T,x),this.transform(A,B,j,D,T,x);for(var J=0;J<T;J++){var fe=P[J]*j[J]-b[J]*D[J];b[J]=P[J]*D[J]+b[J]*j[J],P[J]=fe}return this.conjugate(P,b,T),this.transform(P,b,V,B,T,x),this.conjugate(V,B,T),this.normalize13b(V,T),S.negative=l.negative^g.negative,S.length=l.length+g.length,S.strip()},i.prototype.mul=function(l){var g=new i(null);return g.words=new Array(this.length+l.length),this.mulTo(l,g)},i.prototype.mulf=function(l){var g=new i(null);return g.words=new Array(this.length+l.length),E(this,l,g)},i.prototype.imul=function(l){return this.clone().mulTo(l,this)},i.prototype.imuln=function(l){r(typeof l=="number"),r(l<67108864);for(var g=0,S=0;S<this.length;S++){var T=(this.words[S]|0)*l,x=(T&67108863)+(g&67108863);g>>=26,g+=T/67108864|0,g+=x>>>26,this.words[S]=x&67108863}return g!==0&&(this.words[S]=g,this.length++),this},i.prototype.muln=function(l){return this.clone().imuln(l)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(l){var g=p(l);if(g.length===0)return new i(1);for(var S=this,T=0;T<g.length&&g[T]===0;T++,S=S.sqr());if(++T<g.length)for(var x=S.sqr();T<g.length;T++,x=x.sqr())g[T]!==0&&(S=S.mul(x));return S},i.prototype.iushln=function(l){r(typeof l=="number"&&l>=0);var g=l%26,S=(l-g)/26,T=67108863>>>26-g<<26-g,x;if(g!==0){var B=0;for(x=0;x<this.length;x++){var M=this.words[x]&T,P=(this.words[x]|0)-M<<g;this.words[x]=P|B,B=M>>>26-g}B&&(this.words[x]=B,this.length++)}if(S!==0){for(x=this.length-1;x>=0;x--)this.words[x+S]=this.words[x];for(x=0;x<S;x++)this.words[x]=0;this.length+=S}return this.strip()},i.prototype.ishln=function(l){return r(this.negative===0),this.iushln(l)},i.prototype.iushrn=function(l,g,S){r(typeof l=="number"&&l>=0);var T;g?T=(g-g%26)/26:T=0;var x=l%26,B=Math.min((l-x)/26,this.length),M=67108863^67108863>>>x<<x,P=S;if(T-=B,T=Math.max(0,T),P){for(var b=0;b<B;b++)P.words[b]=this.words[b];P.length=B}if(B!==0)if(this.length>B)for(this.length-=B,b=0;b<this.length;b++)this.words[b]=this.words[b+B];else this.words[0]=0,this.length=1;var A=0;for(b=this.length-1;b>=0&&(A!==0||b>=T);b--){var j=this.words[b]|0;this.words[b]=A<<26-x|j>>>x,A=j&M}return P&&A!==0&&(P.words[P.length++]=A),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(l,g,S){return r(this.negative===0),this.iushrn(l,g,S)},i.prototype.shln=function(l){return this.clone().ishln(l)},i.prototype.ushln=function(l){return this.clone().iushln(l)},i.prototype.shrn=function(l){return this.clone().ishrn(l)},i.prototype.ushrn=function(l){return this.clone().iushrn(l)},i.prototype.testn=function(l){r(typeof l=="number"&&l>=0);var g=l%26,S=(l-g)/26,T=1<<g;if(this.length<=S)return!1;var x=this.words[S];return!!(x&T)},i.prototype.imaskn=function(l){r(typeof l=="number"&&l>=0);var g=l%26,S=(l-g)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(g!==0&&S++,this.length=Math.min(S,this.length),g!==0){var T=67108863^67108863>>>g<<g;this.words[this.length-1]&=T}return this.strip()},i.prototype.maskn=function(l){return this.clone().imaskn(l)},i.prototype.iaddn=function(l){return r(typeof l=="number"),r(l<67108864),l<0?this.isubn(-l):this.negative!==0?this.length===1&&(this.words[0]|0)<l?(this.words[0]=l-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(l),this.negative=1,this):this._iaddn(l)},i.prototype._iaddn=function(l){this.words[0]+=l;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},i.prototype.isubn=function(l){if(r(typeof l=="number"),r(l<67108864),l<0)return this.iaddn(-l);if(this.negative!==0)return this.negative=0,this.iaddn(l),this.negative=1,this;if(this.words[0]-=l,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this.strip()},i.prototype.addn=function(l){return this.clone().iaddn(l)},i.prototype.subn=function(l){return this.clone().isubn(l)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(l,g,S){var T=l.length+S,x;this._expand(T);var B,M=0;for(x=0;x<l.length;x++){B=(this.words[x+S]|0)+M;var P=(l.words[x]|0)*g;B-=P&67108863,M=(B>>26)-(P/67108864|0),this.words[x+S]=B&67108863}for(;x<this.length-S;x++)B=(this.words[x+S]|0)+M,M=B>>26,this.words[x+S]=B&67108863;if(M===0)return this.strip();for(r(M===-1),M=0,x=0;x<this.length;x++)B=-(this.words[x]|0)+M,M=B>>26,this.words[x]=B&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(l,g){var S=this.length-l.length,T=this.clone(),x=l,B=x.words[x.length-1]|0,M=this._countBits(B);S=26-M,S!==0&&(x=x.ushln(S),T.iushln(S),B=x.words[x.length-1]|0);var P=T.length-x.length,b;if(g!=="mod"){b=new i(null),b.length=P+1,b.words=new Array(b.length);for(var A=0;A<b.length;A++)b.words[A]=0}var j=T.clone()._ishlnsubmul(x,1,P);j.negative===0&&(T=j,b&&(b.words[P]=1));for(var D=P-1;D>=0;D--){var V=(T.words[x.length+D]|0)*67108864+(T.words[x.length+D-1]|0);for(V=Math.min(V/B|0,67108863),T._ishlnsubmul(x,V,D);T.negative!==0;)V--,T.negative=0,T._ishlnsubmul(x,1,D),T.isZero()||(T.negative^=1);b&&(b.words[D]=V)}return b&&b.strip(),T.strip(),g!=="div"&&S!==0&&T.iushrn(S),{div:b||null,mod:T}},i.prototype.divmod=function(l,g,S){if(r(!l.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var T,x,B;return this.negative!==0&&l.negative===0?(B=this.neg().divmod(l,g),g!=="mod"&&(T=B.div.neg()),g!=="div"&&(x=B.mod.neg(),S&&x.negative!==0&&x.iadd(l)),{div:T,mod:x}):this.negative===0&&l.negative!==0?(B=this.divmod(l.neg(),g),g!=="mod"&&(T=B.div.neg()),{div:T,mod:B.mod}):(this.negative&l.negative)!==0?(B=this.neg().divmod(l.neg(),g),g!=="div"&&(x=B.mod.neg(),S&&x.negative!==0&&x.isub(l)),{div:B.div,mod:x}):l.length>this.length||this.cmp(l)<0?{div:new i(0),mod:this}:l.length===1?g==="div"?{div:this.divn(l.words[0]),mod:null}:g==="mod"?{div:null,mod:new i(this.modn(l.words[0]))}:{div:this.divn(l.words[0]),mod:new i(this.modn(l.words[0]))}:this._wordDiv(l,g)},i.prototype.div=function(l){return this.divmod(l,"div",!1).div},i.prototype.mod=function(l){return this.divmod(l,"mod",!1).mod},i.prototype.umod=function(l){return this.divmod(l,"mod",!0).mod},i.prototype.divRound=function(l){var g=this.divmod(l);if(g.mod.isZero())return g.div;var S=g.div.negative!==0?g.mod.isub(l):g.mod,T=l.ushrn(1),x=l.andln(1),B=S.cmp(T);return B<0||x===1&&B===0?g.div:g.div.negative!==0?g.div.isubn(1):g.div.iaddn(1)},i.prototype.modn=function(l){r(l<=67108863);for(var g=(1<<26)%l,S=0,T=this.length-1;T>=0;T--)S=(g*S+(this.words[T]|0))%l;return S},i.prototype.idivn=function(l){r(l<=67108863);for(var g=0,S=this.length-1;S>=0;S--){var T=(this.words[S]|0)+g*67108864;this.words[S]=T/l|0,g=T%l}return this.strip()},i.prototype.divn=function(l){return this.clone().idivn(l)},i.prototype.egcd=function(l){r(l.negative===0),r(!l.isZero());var g=this,S=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var T=new i(1),x=new i(0),B=new i(0),M=new i(1),P=0;g.isEven()&&S.isEven();)g.iushrn(1),S.iushrn(1),++P;for(var b=S.clone(),A=g.clone();!g.isZero();){for(var j=0,D=1;(g.words[0]&D)===0&&j<26;++j,D<<=1);if(j>0)for(g.iushrn(j);j-- >0;)(T.isOdd()||x.isOdd())&&(T.iadd(b),x.isub(A)),T.iushrn(1),x.iushrn(1);for(var V=0,J=1;(S.words[0]&J)===0&&V<26;++V,J<<=1);if(V>0)for(S.iushrn(V);V-- >0;)(B.isOdd()||M.isOdd())&&(B.iadd(b),M.isub(A)),B.iushrn(1),M.iushrn(1);g.cmp(S)>=0?(g.isub(S),T.isub(B),x.isub(M)):(S.isub(g),B.isub(T),M.isub(x))}return{a:B,b:M,gcd:S.iushln(P)}},i.prototype._invmp=function(l){r(l.negative===0),r(!l.isZero());var g=this,S=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var T=new i(1),x=new i(0),B=S.clone();g.cmpn(1)>0&&S.cmpn(1)>0;){for(var M=0,P=1;(g.words[0]&P)===0&&M<26;++M,P<<=1);if(M>0)for(g.iushrn(M);M-- >0;)T.isOdd()&&T.iadd(B),T.iushrn(1);for(var b=0,A=1;(S.words[0]&A)===0&&b<26;++b,A<<=1);if(b>0)for(S.iushrn(b);b-- >0;)x.isOdd()&&x.iadd(B),x.iushrn(1);g.cmp(S)>=0?(g.isub(S),T.isub(x)):(S.isub(g),x.isub(T))}var j;return g.cmpn(1)===0?j=T:j=x,j.cmpn(0)<0&&j.iadd(l),j},i.prototype.gcd=function(l){if(this.isZero())return l.abs();if(l.isZero())return this.abs();var g=this.clone(),S=l.clone();g.negative=0,S.negative=0;for(var T=0;g.isEven()&&S.isEven();T++)g.iushrn(1),S.iushrn(1);do{for(;g.isEven();)g.iushrn(1);for(;S.isEven();)S.iushrn(1);var x=g.cmp(S);if(x<0){var B=g;g=S,S=B}else if(x===0||S.cmpn(1)===0)break;g.isub(S)}while(!0);return S.iushln(T)},i.prototype.invm=function(l){return this.egcd(l).a.umod(l)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(l){return this.words[0]&l},i.prototype.bincn=function(l){r(typeof l=="number");var g=l%26,S=(l-g)/26,T=1<<g;if(this.length<=S)return this._expand(S+1),this.words[S]|=T,this;for(var x=T,B=S;x!==0&&B<this.length;B++){var M=this.words[B]|0;M+=x,x=M>>>26,M&=67108863,this.words[B]=M}return x!==0&&(this.words[B]=x,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(l){var g=l<0;if(this.negative!==0&&!g)return-1;if(this.negative===0&&g)return 1;this.strip();var S;if(this.length>1)S=1;else{g&&(l=-l),r(l<=67108863,"Number is too big");var T=this.words[0]|0;S=T===l?0:T<l?-1:1}return this.negative!==0?-S|0:S},i.prototype.cmp=function(l){if(this.negative!==0&&l.negative===0)return-1;if(this.negative===0&&l.negative!==0)return 1;var g=this.ucmp(l);return this.negative!==0?-g|0:g},i.prototype.ucmp=function(l){if(this.length>l.length)return 1;if(this.length<l.length)return-1;for(var g=0,S=this.length-1;S>=0;S--){var T=this.words[S]|0,x=l.words[S]|0;if(T!==x){T<x?g=-1:T>x&&(g=1);break}}return g},i.prototype.gtn=function(l){return this.cmpn(l)===1},i.prototype.gt=function(l){return this.cmp(l)===1},i.prototype.gten=function(l){return this.cmpn(l)>=0},i.prototype.gte=function(l){return this.cmp(l)>=0},i.prototype.ltn=function(l){return this.cmpn(l)===-1},i.prototype.lt=function(l){return this.cmp(l)===-1},i.prototype.lten=function(l){return this.cmpn(l)<=0},i.prototype.lte=function(l){return this.cmp(l)<=0},i.prototype.eqn=function(l){return this.cmpn(l)===0},i.prototype.eq=function(l){return this.cmp(l)===0},i.red=function(l){return new K(l)},i.prototype.toRed=function(l){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),l.convertTo(this)._forceRed(l)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(l){return this.red=l,this},i.prototype.forceRed=function(l){return r(!this.red,"Already a number in reduction context"),this._forceRed(l)},i.prototype.redAdd=function(l){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,l)},i.prototype.redIAdd=function(l){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,l)},i.prototype.redSub=function(l){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,l)},i.prototype.redISub=function(l){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,l)},i.prototype.redShl=function(l){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,l)},i.prototype.redMul=function(l){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.mul(this,l)},i.prototype.redIMul=function(l){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.imul(this,l)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(l){return r(this.red&&!l.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,l)};var k={k256:null,p224:null,p192:null,p25519:null};function C(O,l){this.name=O,this.p=new i(l,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}C.prototype._tmp=function(){var l=new i(null);return l.words=new Array(Math.ceil(this.n/13)),l},C.prototype.ireduce=function(l){var g=l,S;do this.split(g,this.tmp),g=this.imulK(g),g=g.iadd(this.tmp),S=g.bitLength();while(S>this.n);var T=S<this.n?-1:g.ucmp(this.p);return T===0?(g.words[0]=0,g.length=1):T>0?g.isub(this.p):g.strip!==void 0?g.strip():g._strip(),g},C.prototype.split=function(l,g){l.iushrn(this.n,0,g)},C.prototype.imulK=function(l){return l.imul(this.k)};function R(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(R,C),R.prototype.split=function(l,g){for(var S=4194303,T=Math.min(l.length,9),x=0;x<T;x++)g.words[x]=l.words[x];if(g.length=T,l.length<=9){l.words[0]=0,l.length=1;return}var B=l.words[9];for(g.words[g.length++]=B&S,x=10;x<l.length;x++){var M=l.words[x]|0;l.words[x-10]=(M&S)<<4|B>>>22,B=M}B>>>=22,l.words[x-10]=B,B===0&&l.length>10?l.length-=10:l.length-=9},R.prototype.imulK=function(l){l.words[l.length]=0,l.words[l.length+1]=0,l.length+=2;for(var g=0,S=0;S<l.length;S++){var T=l.words[S]|0;g+=T*977,l.words[S]=g&67108863,g=T*64+(g/67108864|0)}return l.words[l.length-1]===0&&(l.length--,l.words[l.length-1]===0&&l.length--),l};function U(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(U,C);function q(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(q,C);function L(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(L,C),L.prototype.imulK=function(l){for(var g=0,S=0;S<l.length;S++){var T=(l.words[S]|0)*19+g,x=T&67108863;T>>>=26,l.words[S]=x,g=T}return g!==0&&(l.words[l.length++]=g),l},i._prime=function(l){if(k[l])return k[l];var g;if(l==="k256")g=new R;else if(l==="p224")g=new U;else if(l==="p192")g=new q;else if(l==="p25519")g=new L;else throw new Error("Unknown prime "+l);return k[l]=g,g};function K(O){if(typeof O=="string"){var l=i._prime(O);this.m=l.p,this.prime=l}else r(O.gtn(1),"modulus must be greater than 1"),this.m=O,this.prime=null}K.prototype._verify1=function(l){r(l.negative===0,"red works only with positives"),r(l.red,"red works only with red numbers")},K.prototype._verify2=function(l,g){r((l.negative|g.negative)===0,"red works only with positives"),r(l.red&&l.red===g.red,"red works only with red numbers")},K.prototype.imod=function(l){return this.prime?this.prime.ireduce(l)._forceRed(this):l.umod(this.m)._forceRed(this)},K.prototype.neg=function(l){return l.isZero()?l.clone():this.m.sub(l)._forceRed(this)},K.prototype.add=function(l,g){this._verify2(l,g);var S=l.add(g);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},K.prototype.iadd=function(l,g){this._verify2(l,g);var S=l.iadd(g);return S.cmp(this.m)>=0&&S.isub(this.m),S},K.prototype.sub=function(l,g){this._verify2(l,g);var S=l.sub(g);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},K.prototype.isub=function(l,g){this._verify2(l,g);var S=l.isub(g);return S.cmpn(0)<0&&S.iadd(this.m),S},K.prototype.shl=function(l,g){return this._verify1(l),this.imod(l.ushln(g))},K.prototype.imul=function(l,g){return this._verify2(l,g),this.imod(l.imul(g))},K.prototype.mul=function(l,g){return this._verify2(l,g),this.imod(l.mul(g))},K.prototype.isqr=function(l){return this.imul(l,l.clone())},K.prototype.sqr=function(l){return this.mul(l,l)},K.prototype.sqrt=function(l){if(l.isZero())return l.clone();var g=this.m.andln(3);if(r(g%2===1),g===3){var S=this.m.add(new i(1)).iushrn(2);return this.pow(l,S)}for(var T=this.m.subn(1),x=0;!T.isZero()&&T.andln(1)===0;)x++,T.iushrn(1);r(!T.isZero());var B=new i(1).toRed(this),M=B.redNeg(),P=this.m.subn(1).iushrn(1),b=this.m.bitLength();for(b=new i(2*b*b).toRed(this);this.pow(b,P).cmp(M)!==0;)b.redIAdd(M);for(var A=this.pow(b,T),j=this.pow(l,T.addn(1).iushrn(1)),D=this.pow(l,T),V=x;D.cmp(B)!==0;){for(var J=D,fe=0;J.cmp(B)!==0;fe++)J=J.redSqr();r(fe<V);var xe=this.pow(A,new i(1).iushln(V-fe-1));j=j.redMul(xe),A=xe.redSqr(),D=D.redMul(A),V=fe}return j},K.prototype.invm=function(l){var g=l._invmp(this.m);return g.negative!==0?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},K.prototype.pow=function(l,g){if(g.isZero())return new i(1).toRed(this);if(g.cmpn(1)===0)return l.clone();var S=4,T=new Array(1<<S);T[0]=new i(1).toRed(this),T[1]=l;for(var x=2;x<T.length;x++)T[x]=this.mul(T[x-1],l);var B=T[0],M=0,P=0,b=g.bitLength()%26;for(b===0&&(b=26),x=g.length-1;x>=0;x--){for(var A=g.words[x],j=b-1;j>=0;j--){var D=A>>j&1;if(B!==T[0]&&(B=this.sqr(B)),D===0&&M===0){P=0;continue}M<<=1,M|=D,P++,!(P!==S&&(x!==0||j!==0))&&(B=this.mul(B,T[M]),P=0,M=0)}b=26}return B},K.prototype.convertTo=function(l){var g=l.umod(this.m);return g===l?g.clone():g},K.prototype.convertFrom=function(l){var g=l.clone();return g.red=null,g},i.mont=function(l){return new W(l)};function W(O){K.call(this,O),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(W,K),W.prototype.convertTo=function(l){return this.imod(l.ushln(this.shift))},W.prototype.convertFrom=function(l){var g=this.imod(l.mul(this.rinv));return g.red=null,g},W.prototype.imul=function(l,g){if(l.isZero()||g.isZero())return l.words[0]=0,l.length=1,l;var S=l.imul(g),T=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=S.isub(T).iushrn(this.shift),B=x;return x.cmp(this.m)>=0?B=x.isub(this.m):x.cmpn(0)<0&&(B=x.iadd(this.m)),B._forceRed(this)},W.prototype.mul=function(l,g){if(l.isZero()||g.isZero())return new i(0)._forceRed(this);var S=l.mul(g),T=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=S.isub(T).iushrn(this.shift),B=x;return x.cmp(this.m)>=0?B=x.isub(this.m):x.cmpn(0)<0&&(B=x.iadd(this.m)),B._forceRed(this)},W.prototype.invm=function(l){var g=this.imod(l._invmp(this.m).mul(this.r2));return g._forceRed(this)}})(typeof _l>"u"||_l,Xb)});var _n=H(Yb=>{v();w();var ii=Yb,YS=tn(),$S=p3(),Bu=b3();ii.assert=$S;ii.toArray=Bu.toArray;ii.zero2=Bu.zero2;ii.toHex=Bu.toHex;ii.encode=Bu.encode;function ZS(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),o=0;o<n.length;o++){var a,c=s.andln(i-1);s.isOdd()?(c>(i>>1)-1?a=(i>>1)-c:a=c,s.isubn(a)):a=0,n[o]=a,s.iushrn(1)}return n}ii.getNAF=ZS;function JS(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n=0,i=0,s;e.cmpn(-n)>0||t.cmpn(-i)>0;){var o=e.andln(3)+n&3,a=t.andln(3)+i&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)===0?c=0:(s=e.andln(7)+n&7,(s===3||s===5)&&a===2?c=-o:c=o),r[0].push(c);var u;(a&1)===0?u=0:(s=t.andln(7)+i&7,(s===3||s===5)&&o===2?u=-a:u=a),r[1].push(u),2*n===c+1&&(n=1-n),2*i===u+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return r}ii.getJSF=JS;function QS(e,t,r){var n="_"+t;e.prototype[t]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}ii.cachedProperty=QS;function e6(e){return typeof e=="string"?ii.toArray(e,"hex"):e}ii.parseBytes=e6;function t6(e){return new YS(e,"hex","le")}ii.intFromLE=t6});var pc=H((rk,$b)=>{v();w();var hc=_n(),po=tn(),Mu=hc.getNAF,r6=hc.getJSF,Cu=hc.assert;function Ts(e,t){this.type=e,this.p=new po(t.p,16),this.red=t.prime?po.red(t.prime):po.mont(this.p),this.zero=new po(0).toRed(this.red),this.one=new po(1).toRed(this.red),this.two=new po(2).toRed(this.red),this.n=t.n&&new po(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}$b.exports=Ts;Ts.prototype.point=function(){throw new Error("Not implemented")};Ts.prototype.validate=function(){throw new Error("Not implemented")};Ts.prototype._fixedNafMul=function(t,r){Cu(t.precomputed);var n=t._getDoubles(),i=Mu(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<i.length;a+=n.step){c=0;for(var u=a+n.step-1;u>=a;u--)c=(c<<1)+i[u];o.push(c)}for(var d=this.jpoint(null,null,null),f=this.jpoint(null,null,null),p=s;p>0;p--){for(a=0;a<o.length;a++)c=o[a],c===p?f=f.mixedAdd(n.points[a]):c===-p&&(f=f.mixedAdd(n.points[a].neg()));d=d.add(f)}return d.toP()};Ts.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=Mu(r,n,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var d=o[c];Cu(d!==0),t.type==="affine"?d>0?a=a.mixedAdd(s[d-1>>1]):a=a.mixedAdd(s[-d-1>>1].neg()):d>0?a=a.add(s[d-1>>1]):a=a.add(s[-d-1>>1].neg())}return t.type==="affine"?a.toP():a};Ts.prototype._wnafMulAdd=function(t,r,n,i,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,d,f,p;for(d=0;d<i;d++){p=r[d];var y=p._getNAFPoints(t);o[d]=y.wnd,a[d]=y.points}for(d=i-1;d>=1;d-=2){var m=d-1,_=d;if(o[m]!==1||o[_]!==1){c[m]=Mu(n[m],o[m],this._bitLength),c[_]=Mu(n[_],o[_],this._bitLength),u=Math.max(c[m].length,u),u=Math.max(c[_].length,u);continue}var E=[r[m],null,null,r[_]];r[m].y.cmp(r[_].y)===0?(E[1]=r[m].add(r[_]),E[2]=r[m].toJ().mixedAdd(r[_].neg())):r[m].y.cmp(r[_].y.redNeg())===0?(E[1]=r[m].toJ().mixedAdd(r[_]),E[2]=r[m].add(r[_].neg())):(E[1]=r[m].toJ().mixedAdd(r[_]),E[2]=r[m].toJ().mixedAdd(r[_].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],k=r6(n[m],n[_]);for(u=Math.max(k[0].length,u),c[m]=new Array(u),c[_]=new Array(u),f=0;f<u;f++){var C=k[0][f]|0,R=k[1][f]|0;c[m][f]=I[(C+1)*3+(R+1)],c[_][f]=0,a[m]=E}}var U=this.jpoint(null,null,null),q=this._wnafT4;for(d=u;d>=0;d--){for(var L=0;d>=0;){var K=!0;for(f=0;f<i;f++)q[f]=c[f][d]|0,q[f]!==0&&(K=!1);if(!K)break;L++,d--}if(d>=0&&L++,U=U.dblp(L),d<0)break;for(f=0;f<i;f++){var W=q[f];W!==0&&(W>0?p=a[f][W-1>>1]:W<0&&(p=a[f][-W-1>>1].neg()),p.type==="affine"?U=U.mixedAdd(p):U=U.add(p))}}for(d=0;d<i;d++)a[d]=null;return s?U:U.toP()};function Tn(e,t){this.curve=e,this.type=t,this.precomputed=null}Ts.BasePoint=Tn;Tn.prototype.eq=function(){throw new Error("Not implemented")};Tn.prototype.validate=function(){return this.curve.validate(this)};Ts.prototype.decodePoint=function(t,r){t=hc.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*n){t[0]===6?Cu(t[t.length-1]%2===0):t[0]===7&&Cu(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};Tn.prototype.encodeCompressed=function(t){return this.encode(t,!0)};Tn.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};Tn.prototype.encode=function(t,r){return hc.encode(this._encode(r),t)};Tn.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};Tn.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};Tn.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=t){for(var o=0;o<t;o++)i=i.dbl();n.push(i)}return{step:t,points:n}};Tn.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:t,points:r}};Tn.prototype._getBeta=function(){return null};Tn.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r}});var Jb=H((sk,Zb)=>{v();w();var n6=_n(),st=tn(),vl=el(),ia=pc(),i6=n6.assert;function Pn(e){ia.call(this,"short",e),this.a=new st(e.a,16).toRed(this.red),this.b=new st(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}vl(Pn,ia);Zb.exports=Pn;Pn.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new st(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new st(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],i6(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return t.basis?o=t.basis.map(function(a){return{a:new st(a.a,16),b:new st(a.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}};Pn.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:st.mont(t),n=new st(2).toRed(r).redInvm(),i=n.redNeg(),s=new st(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]};Pn.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),s=new st(1),o=new st(0),a=new st(0),c=new st(1),u,d,f,p,y,m,_,E=0,I,k;n.cmpn(0)!==0;){var C=i.div(n);I=i.sub(C.mul(n)),k=a.sub(C.mul(s));var R=c.sub(C.mul(o));if(!f&&I.cmp(r)<0)u=_.neg(),d=s,f=I.neg(),p=k;else if(f&&++E===2)break;_=I,i=n,n=I,a=s,s=k,c=o,o=R}y=I.neg(),m=k;var U=f.sqr().add(p.sqr()),q=y.sqr().add(m.sqr());return q.cmp(U)>=0&&(y=u,m=d),f.negative&&(f=f.neg(),p=p.neg()),y.negative&&(y=y.neg(),m=m.neg()),[{a:f,b:p},{a:y,b:m}]};Pn.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(t).divRound(this.n),o=n.b.neg().mul(t).divRound(this.n),a=s.mul(n.a),c=o.mul(i.a),u=s.mul(n.b),d=o.mul(i.b),f=t.sub(a).sub(c),p=u.add(d).neg();return{k1:f,k2:p}};Pn.prototype.pointFromX=function(t,r){t=new st(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(t,i)};Pn.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};Pn.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<t.length;o++){var a=this._endoSplit(r[o]),c=t[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),i[o*2]=c,i[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var d=this._wnafMulAdd(1,i,s,o*2,n),f=0;f<o*2;f++)i[f]=null,s[f]=null;return d};function ur(e,t,r,n){ia.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new st(t,16),this.y=new st(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}vl(ur,ia.BasePoint);Pn.prototype.point=function(t,r,n){return new ur(this,t,r,n)};Pn.prototype.pointFromJSON=function(t,r){return ur.fromJSON(this,t,r)};ur.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};ur.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};ur.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function s(a){return t.point(a[0],a[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};ur.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};ur.prototype.isInfinity=function(){return this.inf};ur.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};ur.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};ur.prototype.getX=function(){return this.x.fromRed()};ur.prototype.getY=function(){return this.y.fromRed()};ur.prototype.mul=function(t){return t=new st(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};ur.prototype.mulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};ur.prototype.jmulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};ur.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};ur.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};ur.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function Pr(e,t,r,n){ia.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new st(0)):(this.x=new st(t,16),this.y=new st(r,16),this.z=new st(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}vl(Pr,ia.BasePoint);Pn.prototype.jpoint=function(t,r,n){return new Pr(this,t,r,n)};Pr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};Pr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Pr.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(n),o=this.y.redMul(r.redMul(t.z)),a=t.y.redMul(n.redMul(this.z)),c=i.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var d=c.redSqr(),f=d.redMul(c),p=i.redMul(d),y=u.redSqr().redIAdd(f).redISub(p).redISub(p),m=u.redMul(p.redISub(y)).redISub(o.redMul(f)),_=this.z.redMul(t.z).redMul(c);return this.curve.jpoint(y,m,_)};Pr.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),s=this.y,o=t.y.redMul(r).redMul(this.z),a=n.redSub(i),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),d=u.redMul(a),f=n.redMul(u),p=c.redSqr().redIAdd(d).redISub(f).redISub(f),y=c.redMul(f.redISub(p)).redISub(s.redMul(d)),m=this.z.redMul(a);return this.curve.jpoint(p,y,m)};Pr.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),d=a.redAdd(a);for(r=0;r<t;r++){var f=o.redSqr(),p=d.redSqr(),y=p.redSqr(),m=f.redAdd(f).redIAdd(f).redIAdd(i.redMul(u)),_=o.redMul(p),E=m.redSqr().redISub(_.redAdd(_)),I=_.redISub(E),k=m.redMul(I);k=k.redIAdd(k).redISub(y);var C=d.redMul(c);r+1<t&&(u=u.redMul(y)),o=E,c=C,d=k}return this.curve.jpoint(o,d.redMul(s),c)};Pr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Pr.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i),u=c.redSqr().redISub(a).redISub(a),d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),t=u,r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var f=this.x.redSqr(),p=this.y.redSqr(),y=p.redSqr(),m=this.x.redAdd(p).redSqr().redISub(f).redISub(y);m=m.redIAdd(m);var _=f.redAdd(f).redIAdd(f),E=_.redSqr(),I=y.redIAdd(y);I=I.redIAdd(I),I=I.redIAdd(I),t=E.redISub(m).redISub(m),r=_.redMul(m.redISub(t)).redISub(I),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};Pr.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);t=u;var d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var f=this.z.redSqr(),p=this.y.redSqr(),y=this.x.redMul(p),m=this.x.redSub(f).redMul(this.x.redAdd(f));m=m.redAdd(m).redIAdd(m);var _=y.redIAdd(y);_=_.redIAdd(_);var E=_.redAdd(_);t=m.redSqr().redISub(E),n=this.y.redAdd(this.z).redSqr().redISub(p).redISub(f);var I=p.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I),r=m.redMul(_.redISub(t)).redISub(I)}return this.curve.jpoint(t,r,n)};Pr.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),a=n.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(t.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var d=u.redMul(a),f=c.redSqr().redISub(d.redAdd(d)),p=d.redISub(f),y=a.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var m=c.redMul(p).redISub(y),_=n.redAdd(n).redMul(i);return this.curve.jpoint(f,m,_)};Pr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=t.redAdd(t).redIAdd(t),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(t).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var d=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),f=r.redMul(d);f=f.redIAdd(f),f=f.redIAdd(f);var p=this.x.redMul(c).redISub(f);p=p.redIAdd(p),p=p.redIAdd(p);var y=this.y.redMul(d.redMul(u.redISub(d)).redISub(a.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var m=this.z.redAdd(a).redSqr().redISub(n).redISub(c);return this.curve.jpoint(p,y,m)};Pr.prototype.mul=function(t,r){return t=new st(t,r),this.curve._wnafMul(this,t)};Pr.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(i)).cmpn(0)===0};Pr.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};Pr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Pr.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var tg=H((ck,eg)=>{v();w();var sa=tn(),Qb=el(),ku=pc(),s6=_n();function oa(e){ku.call(this,"mont",e),this.a=new sa(e.a,16).toRed(this.red),this.b=new sa(e.b,16).toRed(this.red),this.i4=new sa(4).toRed(this.red).redInvm(),this.two=new sa(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Qb(oa,ku);eg.exports=oa;oa.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function fr(e,t,r){ku.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new sa(t,16),this.z=new sa(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Qb(fr,ku.BasePoint);oa.prototype.decodePoint=function(t,r){return this.point(s6.toArray(t,r),1)};oa.prototype.point=function(t,r){return new fr(this,t,r)};oa.prototype.pointFromJSON=function(t){return fr.fromJSON(this,t)};fr.prototype.precompute=function(){};fr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};fr.fromJSON=function(t,r){return new fr(t,r[0],r[1]||t.one)};fr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};fr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};fr.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),a=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};fr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};fr.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=t.x.redAdd(t.z),o=t.x.redSub(t.z),a=o.redMul(n),c=s.redMul(i),u=r.z.redMul(a.redAdd(c).redSqr()),d=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,d)};fr.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};fr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};fr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};fr.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};fr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};fr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var ig=H((dk,ng)=>{v();w();var o6=_n(),Zi=tn(),rg=el(),Hu=pc(),a6=o6.assert;function gi(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,Hu.call(this,"edwards",e),this.a=new Zi(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Zi(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Zi(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a6(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}rg(gi,Hu);ng.exports=gi;gi.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};gi.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};gi.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};gi.prototype.pointFromX=function(t,r){t=new Zi(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(t,a)};gi.prototype.pointFromY=function(t,r){t=new Zi(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,t)};gi.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function Ne(e,t,r,n,i){Hu.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Zi(t,16),this.y=new Zi(r,16),this.z=n?new Zi(n,16):this.curve.one,this.t=i&&new Zi(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}rg(Ne,Hu.BasePoint);gi.prototype.pointFromJSON=function(t){return Ne.fromJSON(this,t)};gi.prototype.point=function(t,r,n,i){return new Ne(this,t,r,n,i)};Ne.fromJSON=function(t,r){return new Ne(t,r[0],r[1],r[2])};Ne.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ne.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Ne.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),o=i.redAdd(r),a=o.redSub(n),c=i.redSub(r),u=s.redMul(a),d=o.redMul(c),f=s.redMul(c),p=a.redMul(o);return this.curve.point(u,d,p,f)};Ne.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(r);var d=a.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(d.redSub(this.curve.two)),s=d.redMul(a.redSub(n)),o=d.redSqr().redSub(d).redSub(d)):(c=this.z.redSqr(),u=d.redSub(c).redISub(c),i=t.redSub(r).redISub(n).redMul(u),s=d.redMul(a.redSub(n)),o=d.redMul(u))}else a=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),i=this.curve._mulC(t.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(n)),o=a.redMul(u);return this.curve.point(i,s,o)};Ne.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Ne.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),o=n.redSub(r),a=s.redSub(i),c=s.redAdd(i),u=n.redAdd(r),d=o.redMul(a),f=c.redMul(u),p=o.redMul(u),y=a.redMul(c);return this.curve.point(d,f,y,p)};Ne.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),s=this.y.redMul(t.y),o=this.curve.d.redMul(i).redMul(s),a=n.redSub(o),c=n.redAdd(o),u=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),d=r.redMul(a).redMul(u),f,p;return this.curve.twisted?(f=r.redMul(c).redMul(s.redSub(this.curve._mulA(i))),p=a.redMul(c)):(f=r.redMul(c).redMul(s.redSub(i)),p=this.curve._mulC(a).redMul(c)),this.curve.point(d,f,p)};Ne.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};Ne.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};Ne.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};Ne.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};Ne.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};Ne.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Ne.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Ne.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Ne.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};Ne.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};Ne.prototype.toP=Ne.prototype.normalize;Ne.prototype.mixedAdd=Ne.prototype.add});var wl=H(sg=>{v();w();var Nu=sg;Nu.base=pc();Nu.short=Jb();Nu.mont=tg();Nu.edwards=ig()});var ag=H((yk,og)=>{v();w();og.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Uu=H(fg=>{v();w();var xl=fg,Ps=Np(),Sl=wl(),c6=_n(),cg=c6.assert;function ug(e){e.type==="short"?this.curve=new Sl.short(e):e.type==="edwards"?this.curve=new Sl.edwards(e):this.curve=new Sl.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,cg(this.g.validate(),"Invalid curve"),cg(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}xl.PresetCurve=ug;function Es(e,t){Object.defineProperty(xl,e,{configurable:!0,enumerable:!0,get:function(){var r=new ug(t);return Object.defineProperty(xl,e,{configurable:!0,enumerable:!0,value:r}),r}})}Es("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ps.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Es("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ps.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Es("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ps.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Es("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ps.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Es("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ps.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Es("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ps.sha256,gRed:!1,g:["9"]});Es("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ps.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var Tl;try{Tl=ag()}catch{Tl=void 0}Es("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ps.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",Tl]})});var lg=H((xk,dg)=>{v();w();var u6=tn(),f6=_n(),Pl=f6.assert;function Cr(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}dg.exports=Cr;Cr.fromPublic=function(t,r,n){return r instanceof Cr?r:new Cr(t,{pub:r,pubEnc:n})};Cr.fromPrivate=function(t,r,n){return r instanceof Cr?r:new Cr(t,{priv:r,privEnc:n})};Cr.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Cr.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};Cr.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};Cr.prototype._importPrivate=function(t,r){this.priv=new u6(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};Cr.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?Pl(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Pl(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};Cr.prototype.derive=function(t){return t.validate()||Pl(t.validate(),"public point not validated"),t.mul(this.priv).getX()};Cr.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};Cr.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};Cr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var bg=H((Ek,pg)=>{v();w();var Ru=tn(),Al=_n(),d6=Al.assert;function bc(e,t,r){if(t instanceof bc)return t;this._importDER(t,r)||(d6(t.r&&t.s,"Signature without r or s"),this.r=new Ru(t.r,16),this.s=new Ru(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam,this.curve=e,this.byteLength=this.curve.n.byteLength())}pg.exports=bc;function l6(){this.place=0}function El(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,o=t.place;s<n;s++,o++)i<<=8,i|=e[o],i>>>=0;return i<=127?!1:(t.place=o,i)}function hg(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}bc.prototype._importDER=function(t,r){t=Al.toArray(t,r);var n=new l6;if(t[n.place++]!==48)return!1;var i=El(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var s=El(t,n);if(s===!1)return!1;var o=t.slice(n.place,s+n.place);if(n.place+=s,t[n.place++]!==2)return!1;var a=El(t,n);if(a===!1||t.length!==a+n.place)return!1;var c=t.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Ru(o),this.s=new Ru(c),this.recoveryParam=null,!0};function Il(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}bc.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=hg(r),n=hg(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];Il(i,r.length),i=i.concat(r),i.push(2),Il(i,n.length);var s=i.concat(n),o=[48];return Il(o,s.length),o=o.concat(s),Al.encode(o,t)};bc.prototype.toBytes=function(){let t=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return t.concat(r)}});var mg=H((Ok,yg)=>{v();w();var Ji=tn(),gg=y3(),h6=_n(),Ol=Uu(),p6=m3(),bo=h6.assert,Bl=lg(),qu=bg();function En(e){if(!(this instanceof En))return new En(e);typeof e=="string"&&(bo(Object.prototype.hasOwnProperty.call(Ol,e),"Unknown curve "+e),e=Ol[e]),e instanceof Ol.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}yg.exports=En;En.prototype.keyPair=function(t){return new Bl(this,t)};En.prototype.keyFromPrivate=function(t,r){return Bl.fromPrivate(this,t,r)};En.prototype.keyFromPublic=function(t,r){return Bl.fromPublic(this,t,r)};En.prototype.genKeyPair=function(t){t||(t={});for(var r=new gg({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||p6(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Ji(2));;){var s=new Ji(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};En.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};En.prototype.sign=function(t,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof t!="string"&&typeof t!="number"&&!Ji.isBN(t)){bo(typeof t=="object"&&t&&typeof t.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),bo(t.length>>>0===t.length);for(var s=0;s<t.length;s++)bo((t[s]&255)===t[s])}r=this.keyFromPrivate(r,n),t=this._truncateToN(new Ji(t,16)),bo(!t.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=r.getPrivate().toArray("be",o),c=t.toArray("be",o);bo(new Ji(c).eq(t),"Can not sign message");for(var u=new gg({hash:this.hash,entropy:a,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),d=this.n.sub(new Ji(1)),f=0;;f++){var p=i.k?i.k(f):new Ji(u.generate(this.n.byteLength()));if(p=this._truncateToN(p,!0),!(p.cmpn(1)<=0||p.cmp(d)>=0)){var y=this.g.mul(p);if(!y.isInfinity()){var m=y.getX(),_=m.umod(this.n);if(_.cmpn(0)!==0){var E=p.invm(this.n).mul(_.mul(r.getPrivate()).iadd(t));if(E=E.umod(this.n),E.cmpn(0)!==0){var I=(y.getY().isOdd()?1:0)|(m.cmp(_)!==0?2:0);return i.canonical&&E.cmp(this.nh)>0&&(E=this.n.sub(E),I^=1),new qu(this.curve,{r:_,s:E,recoveryParam:I})}}}}}};En.prototype.verify=function(t,r,n,i){t=this._truncateToN(new Ji(t,16)),n=this.keyFromPublic(n,i),r=new qu(this.curve,r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(t).umod(this.n),u=a.mul(s).umod(this.n),d;return this.curve._maxwellTrick?(d=this.g.jmulAdd(c,n.getPublic(),u),d.isInfinity()?!1:d.eqXToP(s)):(d=this.g.mulAdd(c,n.getPublic(),u),d.isInfinity()?!1:d.getX().umod(this.n).cmp(s)===0)};En.prototype.recoverPubKey=function(e,t,r,n){bo((3&r)===r,"The recovery param is more than two bits"),t=new qu(this.curve,t,n);var i=this.n,s=new Ji(e),o=t.r,a=t.s,c=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var d=t.r.invm(i),f=i.sub(s).mul(d).umod(i),p=a.mul(d).umod(i);return this.g.mulAdd(f,o,p)};En.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new qu(this.curve,t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var Sg=H((Ck,wg)=>{v();w();var gc=_n(),vg=gc.assert,_g=gc.parseBytes,aa=gc.cachedProperty;function dr(e,t){this.eddsa=e,this._secret=_g(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=_g(t.pub)}dr.fromPublic=function(t,r){return r instanceof dr?r:new dr(t,{pub:r})};dr.fromSecret=function(t,r){return r instanceof dr?r:new dr(t,{secret:r})};dr.prototype.secret=function(){return this._secret};aa(dr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});aa(dr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});aa(dr,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});aa(dr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});aa(dr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});aa(dr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});dr.prototype.sign=function(t){return vg(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};dr.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};dr.prototype.getSecret=function(t){return vg(this._secret,"KeyPair is public only"),gc.encode(this.secret(),t)};dr.prototype.getPublic=function(t){return gc.encode(this.pubBytes(),t)};wg.exports=dr});var Tg=H((Nk,xg)=>{v();w();var b6=tn(),Lu=_n(),g6=Lu.assert,Ku=Lu.cachedProperty,y6=Lu.parseBytes;function go(e,t){this.eddsa=e,typeof t!="object"&&(t=y6(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),g6(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof b6&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Ku(go,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Ku(go,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Ku(go,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Ku(go,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});go.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};go.prototype.toHex=function(){return Lu.encode(this.toBytes(),"hex").toUpperCase()};xg.exports=go});var Og=H((qk,Ag)=>{v();w();var m6=Np(),_6=Uu(),ca=_n(),v6=ca.assert,Eg=ca.parseBytes,Ig=Sg(),Pg=Tg();function rn(e){if(v6(e==="ed25519","only tested with ed25519 so far"),!(this instanceof rn))return new rn(e);e=_6[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=m6.sha512}Ag.exports=rn;rn.prototype.sign=function(t,r){t=Eg(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),s=this.g.mul(i),o=this.encodePoint(s),a=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),c=i.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};rn.prototype.verify=function(t,r,n){t=Eg(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),t),o=this.g.mul(r.S()),a=r.R().add(i.pub().mul(s));return a.eq(o)};rn.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return ca.intFromLE(t.digest()).umod(this.curve.n)};rn.prototype.keyFromPublic=function(t){return Ig.fromPublic(this,t)};rn.prototype.keyFromSecret=function(t){return Ig.fromSecret(this,t)};rn.prototype.makeSignature=function(t){return t instanceof Pg?t:new Pg(this,t)};rn.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};rn.prototype.decodePoint=function(t){t=ca.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&-129),i=(t[r]&128)!==0,s=ca.intFromLE(n);return this.curve.pointFromY(s,i)};rn.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};rn.prototype.decodeInt=function(t){return ca.intFromLE(t)};rn.prototype.isPoint=function(t){return t instanceof this.pointClass}});var ua=H(In=>{v();w();Object.defineProperty(In,"__esModule",{value:!0});In.utils=In.curves=In.curve=In.eddsa=In.ec=void 0;var w6=wl();In.curve=w6;var S6=Uu();In.curves=S6;var x6=mg();In.ec=x6;var T6=Og();In.eddsa=T6;var P6=_n();In.utils=P6});var Cg=H((Bg,Mg)=>{v();w();Object.defineProperty(Bg,"__esModule",{value:!0});var E6=ua(),yi=new E6.ec("secp256k1"),ye=yi.curve,Ue=tn();function I6(e,t){let r=new Ue(t);if(r.cmp(ye.p)>=0)return null;r=r.toRed(ye.red);let n=r.redSqr().redIMul(r).redIAdd(ye.b).redSqrt();e===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(ye.b)).isZero()?yi.keyPair({pub:{x:r,y:n}}):null}function A6(e,t,r){let n=new Ue(t),i=new Ue(r);if(n.cmp(ye.p)>=0||i.cmp(ye.p)>=0||(n=n.toRed(ye.red),i=i.toRed(ye.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(ye.b)).isZero()?yi.keyPair({pub:{x:n,y:i}}):null}function Is(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:I6(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:A6(t,e.subarray(1,33),e.subarray(33,65));default:return null}}Mg.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new Ue(e);return t.cmp(ye.n)<0&&!t.isZero()},privateKeyNegate(e){let t=new Ue(e);return h.Buffer.from(ye.n.sub(t).umod(ye.n).toArray("be",32))},privateKeyTweakAdd(e,t){let r=new Ue(t);return r.cmp(ye.n)>=0||(r.iadd(new Ue(e)),r.cmp(ye.n)>=0&&r.isub(ye.n),r.isZero())?null:h.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(e,t){let r=new Ue(t);return r.cmp(ye.n)>=0||r.isZero()?1:(r.imul(new Ue(e)),r.cmp(ye.n)>=0&&(r=r.umod(ye.n)),h.Buffer.from(r.toArray("be",32)))},publicKeyVerify(e){let t=Is(e);return t==null?null:t.validate().result},publicKeyCreate(e,t){let r=new Ue(e);if(r.cmp(ye.n)>=0||r.isZero())return null;let n=yi.keyFromPrivate(e,null).getPublic();return h.Buffer.from(n.encode(null,t))},publicKeyConvert(e,t){let n=Is(e).getPublic();return h.Buffer.from(n.encode(null,t))},publicKeyNegate(e,t){let r=Is(e);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),h.Buffer.from(n.encode(null,t))},publicKeyCombine(e,t){let r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=Is(e[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:h.Buffer.from(n.encode(null,t))},publicKeyTweakAdd(e,t,r){let n=Is(e);if(n===null||new Ue(t).cmp(ye.n)>=0)return null;let s=n.getPublic().add(ye.g.mul(t));return s.isInfinity()?null:h.Buffer.from(s.encode(null,r))},publicKeyTweakMul(e,t,r){let n=Is(e);if(n===null)return null;let i=new Ue(t);if(i.cmp(ye.n)>=0||i.isZero())return null;let s=n.getPublic().mul(t);return h.Buffer.from(s.encode(null,r))},signatureNormalize(e){let t=new Ue(e.subarray(0,32)),r=new Ue(e.subarray(32,64));return t.cmp(ye.n)>=0||r.cmp(ye.n)>=0?null:(r.cmp(yi.nh)===1&&e.set(ye.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new Ue(r).cmp(ye.n)>=0||new Ue(n).cmp(ye.n)>=0)return 1;let{output:i}=e,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=i.subarray(6+33,6+33+33);c[0]=0,c.set(n,1);let u=33,d=0;for(;u>1&&c[d]===0&&!(c[d+1]&128);--u,++d);return c=c.subarray(d),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(e.outputlen=6+o+u,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+o]=2,i[5+o]=c.length,i.set(c,6+o),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let i=t.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new Ue(i);o.cmp(ye.n)>=0&&(o=new Ue(0));let a=new Ue(t.subarray(6+r));return a.cmp(ye.n)>=0&&(a=new Ue(0)),e.set(o.toArrayLike(Uint8Array,"be",32),0),e.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t){let r=new Ue(t);return r.cmp(ye.n)>=0||r.isZero()?null:yi.sign(e,t,{canonical:!0}).toBytes()},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},i=new Ue(n.r),s=new Ue(n.s);if(i.cmp(ye.n)>=0||s.cmp(ye.n)>=0)return 1;if(s.cmp(yi.nh)===1||i.isZero()||s.isZero())return 3;let o=Is(r);if(o===null)return 2;let a=o.getPublic();return yi.verify(t,n,a)},ecdsaRecover(e,t,r,n){let i={r:e.slice(0,32),s:e.slice(32,64)},s=new Ue(i.r),o=new Ue(i.s);if(s.cmp(ye.n)>=0||o.cmp(ye.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=yi.recoverPubKey(r,i,t,null)}catch{return 2}return h.Buffer.from(a.encode(null,n))},ecdh(e,t,r,n,i,s,o){let a=Is(t);if(a===null)return 1;let c=new Ue(r);if(c.cmp(ye.n)>=0||c.isZero())return 2;let u=a.getPublic().mul(c);if(i===void 0){let d=u.encode(null,!0),f=yi.hash().update(d).digest();for(let p=0;p<32;++p)e[p]=f[p]}else{s||(s=new Uint8Array(32));let d=u.getX().toArray("be",32);for(let m=0;m<32;++m)s[m]=d[m];o||(o=new Uint8Array(32));let f=u.getY().toArray("be",32);for(let m=0;m<32;++m)o[m]=f[m];let p=i(s,o,n);if(!(p instanceof Uint8Array&&p.length===e.length))return 2;e.set(p)}return 0}}});var Rg=H(lr=>{v();w();var O6=lr&&lr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),B6=lr&&lr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),M6=lr&&lr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&O6(t,e,r);return B6(t,e),t};Object.defineProperty(lr,"__esModule",{value:!0});lr.fromSeed=lr.fromPublicKey=lr.fromPrivateKey=lr.fromBase58=lr.tinySecp256k1Interface=void 0;var Ml=M6(lc()),C6=tl(),k6=xu(),Hg=(0,C6.base58check)(k6.sha256),Ng=Cg(),Er=_3(),H6=v3();function N6(e){return{isPoint:t=>e.publicKeyVerify(t),isPrivate:t=>e.privateKeyVerify(t),pointAddScalar:(t,r,n)=>e.publicKeyTweakAdd(t,r,n),pointFromScalar:(t,r)=>e.publicKeyCreate(t,r),privateAdd:(t,r)=>e.privateKeyTweakAdd(new Uint8Array(t),r),sign:(t,r)=>e.ecdsaSign(t,r),verify:(t,r,n)=>e.ecdsaVerify(n,t,r)}}function U6(e){return{isPoint:t=>e.publicKeyVerify(t),pointCompress:(t,r)=>Uint8Array.from(e.publicKeyConvert(t,r??!0)),isPrivate:t=>e.privateKeyVerify(t),pointFromScalar:(t,r)=>{let n=e.publicKeyCreate(t,r??!0);return n==null?null:Uint8Array.from(n)},sign:(t,r,n)=>Uint8Array.from(e.ecdsaSign(t,r)),verify:(t,r,n,i)=>e.ecdsaVerify(n,t,r)}}var As=N6(Ng);lr.tinySecp256k1Interface=U6(Ng);var Cl=Er.BufferN(32),R6=Er.compile({wif:Er.UInt8,bip32:{public:Er.UInt32,private:Er.UInt32}}),Fu={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},kg=2147483648,q6=Math.pow(2,31)-1;function L6(e){return Er.String(e)&&e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function K6(e){return Er.UInt32(e)&&e<=q6}var Du=class{constructor(t,r,n,i,s=0,o=0,a=0){this.__D=t,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=o,this.__PARENT_FINGERPRINT=a,Er(R6,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=h.Buffer.from(As.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return h.Buffer.from(Ml.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return ju(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=h.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),Hg.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return H6.encode(this.network.wif,this.privateKey,!0)}derive(t){Er(Er.UInt32,t);let r=t>=kg,n=h.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(t,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(t,33);let i=Ml.hmacSHA512(this.chainCode,n),s=i.slice(0,32),o=i.slice(32);if(!As.isPrivate(s))return this.derive(t+1);let a;if(this.isNeutered()){let c=As.pointAddScalar(this.publicKey,s,!0);if(c===null)return this.derive(t+1);a=ju(c,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{let c=As.privateAdd(this.privateKey,s);if(c==null)return this.derive(t+1);a=kl(c,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return a}deriveHardened(t){return Er(K6,t),this.derive(t+kg)}derivePath(t){Er(L6,t);let r=t.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(t){if(!this.privateKey)throw new Error("Missing private key");return As.sign(t,this.privateKey)}verify(t,r){return As.verify(t,this.publicKey,r)}};function D6(e,t){let r=h.Buffer.from(Hg.decode(e));if(r.length!==78)throw new TypeError("Invalid buffer length");t=t||Fu;let n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let o=r.readUInt32BE(9);if(i===0&&o!==0)throw new TypeError("Invalid index");let a=r.slice(13,45),c;if(n===t.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let u=r.slice(46,78);c=kl(u,a,t,i,o,s)}else{let u=r.slice(45,78);c=ju(u,a,t,i,o,s)}return c}lr.fromBase58=D6;function Ug(e,t,r){return kl(e,t,r)}lr.fromPrivateKey=Ug;function kl(e,t,r,n,i,s){if(Er({privateKey:Cl,chainCode:Cl},{privateKey:e,chainCode:t}),r=r||Fu,!As.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new Du(e,void 0,t,r,n,i,s)}function j6(e,t,r){return ju(e,t,r)}lr.fromPublicKey=j6;function ju(e,t,r,n,i,s){if(Er({publicKey:Er.BufferN(33),chainCode:Cl},{publicKey:e,chainCode:t}),r=r||Fu,!As.isPoint(e))throw new TypeError("Point is not on the curve");return new Du(void 0,e,t,r,n,i,s)}function F6(e,t){if(Er(Er.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||Fu;let r=Ml.hmacSHA512(h.Buffer.from("Bitcoin seed","utf8"),e),n=r.slice(0,32),i=r.slice(32);return Ug(n,i,t)}lr.fromSeed=F6});var qg=H(Vu=>{v();w();Object.defineProperty(Vu,"__esModule",{value:!0});Vu.fromSeedV2=void 0;var V6=w3();function G6(e,t){return V6.HDKey.fromMasterSeed(new Uint8Array([...e])).derive(t)}Vu.fromSeedV2=G6});var Lg=H(nn=>{v();w();Object.defineProperty(nn,"__esModule",{value:!0});nn.fromSeedV2=nn.fromPrivateKey=nn.fromPublicKey=nn.fromBase58=nn.fromSeed=nn.tinySecp256k1Interface=void 0;var yc=Rg();Object.defineProperty(nn,"tinySecp256k1Interface",{enumerable:!0,get:function(){return yc.tinySecp256k1Interface}});Object.defineProperty(nn,"fromSeed",{enumerable:!0,get:function(){return yc.fromSeed}});Object.defineProperty(nn,"fromBase58",{enumerable:!0,get:function(){return yc.fromBase58}});Object.defineProperty(nn,"fromPublicKey",{enumerable:!0,get:function(){return yc.fromPublicKey}});Object.defineProperty(nn,"fromPrivateKey",{enumerable:!0,get:function(){return yc.fromPrivateKey}});var W6=qg();Object.defineProperty(nn,"fromSeedV2",{enumerable:!0,get:function(){return W6.fromSeedV2}})});var Kg=H((tH,z6)=>{z6.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var Nl=H(yo=>{v();w();Object.defineProperty(yo,"__esModule",{value:!0});yo._default=yo.wordlists=void 0;var Hl={};yo.wordlists=Hl;var Gu;yo._default=Gu;try{yo._default=Gu=Kg(),Hl.english=Gu,Hl.EN=Gu}catch{}});var Ul=H(ot=>{v();w();Object.defineProperty(ot,"__esModule",{value:!0});ot.wordlists=ot.getDefaultWordlist=ot.setDefaultWordlist=ot.validateMnemonic=ot.generateMnemonic=ot.entropyToMnemonic=ot.mnemonicToEntropy=ot.mnemonicToSeedV2=ot.mnemonicToSeed=ot.mnemonicToSeedSync=void 0;var jg=lc(),Fg=Au(),Wu=Nl(),Vg=sc(),X6=S3(),fa=Wu._default,Dg="Invalid mnemonic",mo="Invalid entropy",Y6="Invalid mnemonic checksum",Gg=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function $6(e,t,r,n,i){let s=(0,Fg.pbkdf2)(Vg.sha512,e,t,{c:r,dkLen:n});return Promise.resolve(h.Buffer.from(s))}function mc(e){return(e||"").normalize("NFKD")}function Wg(e,t,r){for(;e.length<r;)e=t+e;return e}function zg(e){return parseInt(e,2)}function Xg(e){return e.map(t=>Wg(t.toString(2),"0",8)).join("")}function Yg(e){let r=e.length*8/32,n=(0,jg.sha256)(e);return Xg(Array.from(n)).slice(0,r)}function $g(e){return"mnemonic"+(e||"")}function Z6(e,t){let r=h.Buffer.from(mc(e),"utf8"),n=h.Buffer.from($g(mc(t)),"utf8"),i=(0,Fg.pbkdf2)(Vg.sha512,r,n,{c:2048,dkLen:64});return h.Buffer.from(i)}ot.mnemonicToSeedSync=Z6;function J6(e,t){return Promise.resolve().then(()=>{let r=h.Buffer.from(mc(e),"utf8"),n=h.Buffer.from($g(mc(t)),"utf8");return $6(r,n,2048,64,"sha512")})}ot.mnemonicToSeed=J6;async function Q6(e,t){let r=e.split(" ").map(s=>fa.indexOf(s)),n=new Uint8Array(new Uint16Array(r).buffer),i=await(0,X6.mnemonicToSeed)(n,t);return h.Buffer.from(i)}ot.mnemonicToSeedV2=Q6;function Zg(e,t){if(t=t||fa,!t)throw new Error(Gg);let r=mc(e).split(" ");if(r.length%3!==0)throw new Error(Dg);let n=r.map(d=>{let f=t.indexOf(d);if(f===-1)throw new Error(Dg);return Wg(f.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),o=n.slice(i),a=s.match(/(.{1,8})/g).map(zg);if(a.length<16)throw new Error(mo);if(a.length>32)throw new Error(mo);if(a.length%4!==0)throw new Error(mo);let c=h.Buffer.from(a);if(Yg(c)!==o)throw new Error(Y6);return c.toString("hex")}ot.mnemonicToEntropy=Zg;function Jg(e,t){if(h.Buffer.isBuffer(e)||(e=h.Buffer.from(e,"hex")),t=t||fa,!t)throw new Error(Gg);if(e.length<16)throw new TypeError(mo);if(e.length>32)throw new TypeError(mo);if(e.length%4!==0)throw new TypeError(mo);let r=Xg(Array.from(e)),n=Yg(e),o=(r+n).match(/(.{1,11})/g).map(a=>{let c=zg(a);return t[c]});return t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?o.join("\u3000"):o.join(" ")}ot.entropyToMnemonic=Jg;function e4(e,t,r){if(e=e||128,e%32!==0)throw new TypeError(mo);return t=t||jg.randomBytes,Jg(t(e/8),r)}ot.generateMnemonic=e4;function t4(e,t){try{Zg(e,t)}catch{return!1}return!0}ot.validateMnemonic=t4;function r4(e){let t=Wu.wordlists[e];if(t)fa=t;else throw new Error('Could not find wordlist for language "'+e+'"')}ot.setDefaultWordlist=r4;function n4(){if(!fa)throw new Error("No Default Wordlist set");return Object.keys(Wu.wordlists).filter(e=>e==="JA"||e==="EN"?!1:Wu.wordlists[e].every((t,r)=>t===fa[r]))[0]}ot.getDefaultWordlist=n4;var i4=Nl();Object.defineProperty(ot,"wordlists",{enumerable:!0,get:function(){return i4.wordlists}})});var iy=H(_e=>{v();w();var s4=_e&&_e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),o4=_e&&_e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a4=_e&&_e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&s4(t,e,r);return o4(t,e),t},c4=_e&&_e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_e,"__esModule",{value:!0});_e.loadUncompressedPublicKey=_e.loadCompressedPublicKey=_e.publicKeyConvert=_e.publicKeyCreate=_e.publicKeyVerify=_e.privateKeyVerify=_e.loadPublicKey=_e.recover=_e.verifyWithNoRecovery=_e.verify=_e.getV=_e.sign=void 0;var u4=a4(ua()),tr=new u4.ec("secp256k1"),Qg=lc(),da=c4(tn());function f4(e,t,r=!0){let n=tr.sign(Array.from(e),h.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}_e.sign=f4;function d4(e,t,r,n,i=!0){let s=_c(n);if(s==null)throw new Error("pubkey error");let o=tr.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return tr.getKeyRecoveryParam(e,{r:t,s:r},o,i)}_e.getV=d4;function l4(e,t,r,n){let i=ey(t,r,e,!0);if(i==null)return!1;let s=ty(n,!0);return s==null?!1:i.equals(s)}_e.verify=l4;function h4(e,t,r){let n=_c(r);if(n==null)throw new Error("pubkey error");let i=tr.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,Qg.toHex)(t.slice(0,32)),s:(0,Qg.toHex)(t.slice(32,64))};return i.verify(e,s)}_e.verifyWithNoRecovery=h4;function ey(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new da.default(i.r),o=new da.default(i.s);if(s.cmp(tr.curve.n)>=0||o.cmp(tr.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=tr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return h.Buffer.from(a.encode(null,n))}_e.recover=ey;function _c(e){let t=h.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:ry(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:ny(r,t.subarray(1,33),t.subarray(33,65));default:return null}}_e.loadPublicKey=_c;function p4(e){let t=new da.default(Array.from(e));return t.cmp(tr.curve.n)<0&&!t.isZero()}_e.privateKeyVerify=p4;function b4(e){return _c(e)!==null}_e.publicKeyVerify=b4;function g4(e,t){let r=tr.keyFromPrivate(Array.from(e),"bytes").getPublic();return h.Buffer.from(r.encode(null,t))}_e.publicKeyCreate=g4;function ty(e,t){let r=_c(e);if(r==null)return null;let n=tr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return h.Buffer.from(n.encode(null,t))}_e.publicKeyConvert=ty;function ry(e,t){let r=new da.default(Array.from(t));if(r.cmp(tr.curve.p)>=0)return null;let n=r.toRed(tr.curve.red),i=n.redSqr().redIMul(n).redIAdd(tr.curve.b).redSqrt();e===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(tr.curve.b)).isZero()?{x:n,y:i}:null}_e.loadCompressedPublicKey=ry;function ny(e,t,r){let n=new da.default(Array.from(t)),i=new da.default(Array.from(r));if(n.cmp(tr.curve.p)>=0||i.cmp(tr.curve.p)>=0)return null;let s=n.toRed(tr.curve.red),o=i.toRed(tr.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(tr.curve.b)).isZero()?{x:s,y:o}:null}_e.loadUncompressedPublicKey=ny});var hy=H(me=>{v();w();var y4=me&&me.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),m4=me&&me.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),sy=me&&me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&y4(t,e,r);return m4(t,e),t},_4=me&&me.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(me,"__esModule",{value:!0});me.ed25519_getDerivedPrivateKey=me.isValidPath=me.ed25519_getRandomPrivateKey=me.ed25519SignTest=me.fromSecret=me.fromSeed=me.privateKeyVerify=me.publicKeyVerify=me.publicKeyCreate=me.verify=me.sign=me.ed25519MulBase=void 0;var oy=sy(ua()),si=lc(),v4=_4(tn()),w4=Ul(),Rl=sy(Rp()),S4=sc();Rl.utils.sha512Sync=(...e)=>(0,S4.sha512)(Rl.utils.concatBytes(...e));var Os=new oy.eddsa("ed25519"),ay=Os.curve;function x4(e){let t=Os.curve.g;return Os.encodePoint(t.mul(oy.utils.intFromLE(e)))}me.ed25519MulBase=x4;function cy(e,t){let r=t;r.length==64&&(r=r.slice(0,32));let n=Rl.sync.sign(e,r);return Uint8Array.from(n)}me.sign=cy;function uy(e,t,r){return Os.keyFromPublic(Array.from(r)).verify(Array.from(e),Array.from(t))}me.verify=uy;function zu(e){let t=e;t.length==64&&(t=t.slice(0,32));let n=Os.keyFromSecret(Array.from(t)).getPublic();if(e.length==64&&!T4(e.slice(32,64),n))throw new Error("invalid public key");return Uint8Array.from(n)}me.publicKeyCreate=zu;function T4(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function P4(e){let t=Os.decodePoint(Array.from(e));return ay.validate(t)}me.publicKeyVerify=P4;function fy(e){let t=new v4.default(Array.from(e));return t.cmp(ay.n)<0&&!t.isZero()}me.privateKeyVerify=fy;function E4(e){let t=Os.keyFromSecret(Array.from(e)),r=Uint8Array.from(t.getPublic());return{publicKey:r,secretKey:(0,si.concatBytes)(e,r)}}me.fromSeed=E4;function I4(e){let t=e.slice(0,32),r=Os.keyFromSecret(Array.from(t));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(t)}}me.fromSecret=I4;function dy(e){let t=(0,si.sha256)("ed25519-test"),r=zu(e),n=cy(t,e);return uy(t,n,r)}me.ed25519SignTest=dy;function A4(e,t){for(;;){let r=(0,si.randomBytes)(32);if(fy(r)&&dy(r)){let n=zu(r),i=e?(0,si.concatBytes)(r,n):r;return t==="base58"?(0,si.toBase58)(i):(0,si.toHex)(i)}}}me.ed25519_getRandomPrivateKey=A4;var O4=new RegExp("^m(\\/[0-9]+')+$"),ly=e=>e.replace("'",""),B4=2147483648;function M4(e){let t=(0,si.hmacSHA512)("ed25519 seed",e),r=t.slice(0,32),n=t.slice(32);return{key:r,chainCode:n}}function C4({key:e,chainCode:t},r){let n=h.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=h.Buffer.concat([h.Buffer.alloc(1,0),e,n]),s=(0,si.hmacSHA512)(t,i),o=s.slice(0,32),a=s.slice(32);return{key:o,chainCode:a}}var k4=e=>O4.test(e)?!e.split("/").slice(1).map(ly).some(isNaN):!1;me.isValidPath=k4;function H4(e,t,r=B4){if(!(0,me.isValidPath)(e))throw new Error("Invalid derivation path");let{key:n,chainCode:i}=M4(t);return e.split("/").slice(1).map(ly).map(o=>parseInt(o,10)).reduce((o,a)=>C4(o,a+r),{key:n,chainCode:i})}async function N4(e,t,r,n){let i=await(0,w4.mnemonicToSeedV2)(e),s=H4(t,i).key,o=zu(s),a=r?(0,si.concatBytes)(s,o):s;return n==="base58"?Promise.resolve((0,si.toBase58)(a)):Promise.resolve((0,si.toHex)(a))}me.ed25519_getDerivedPrivateKey=N4});var yy=H(Me=>{v();w();var U4=Me&&Me.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),R4=Me&&Me.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),q4=Me&&Me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&U4(t,e,r);return R4(t,e),t},L4=Me&&Me.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Me,"__esModule",{value:!0});Me.loadUncompressedPublicKey=Me.loadCompressedPublicKey=Me.publicKeyConvert=Me.publicKeyCreate=Me.publicKeyVerify=Me.privateKeyVerify=Me.loadPublicKey=Me.recover=Me.verify=Me.sign=void 0;var K4=q4(ua()),Wr=new K4.ec("p256"),la=L4(tn());function D4(e,t,r=!0){let n=Wr.sign(Array.from(e),h.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}Me.sign=D4;function j4(e,t,r,n){let i=py(t,r,e,!1);return i==null?!1:i.equals(n)}Me.verify=j4;function py(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new la.default(i.r),o=new la.default(i.s);if(s.cmp(Wr.curve.n)>=0||o.cmp(Wr.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=Wr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return h.Buffer.from(a.encode(null,n))}Me.recover=py;function ql(e){let t=h.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:by(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:gy(r,t.subarray(1,33),t.subarray(33,65));default:return null}}Me.loadPublicKey=ql;function F4(e){let t=new la.default(Array.from(e));return t.cmp(Wr.curve.n)<0&&!t.isZero()}Me.privateKeyVerify=F4;function V4(e){return ql(e)!==null}Me.publicKeyVerify=V4;function G4(e,t){let r=Wr.keyFromPrivate(Array.from(e),"bytes").getPublic();return h.Buffer.from(r.encode(null,t))}Me.publicKeyCreate=G4;function W4(e,t){let r=ql(e);if(r==null)return null;let n=Wr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return h.Buffer.from(n.encode(null,t))}Me.publicKeyConvert=W4;function by(e,t){let r=new la.default(Array.from(t));if(r.cmp(Wr.curve.p)>=0)return null;let n=r.toRed(Wr.curve.red),i=n.redSqr().redIMul(n).redIAdd(Wr.curve.b).redSqrt();return e===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}Me.loadCompressedPublicKey=by;function gy(e,t,r){let n=new la.default(Array.from(t)),i=new la.default(Array.from(r));if(n.cmp(Wr.curve.p)>=0||i.cmp(Wr.curve.p)>=0)return null;let s=n.toRed(Wr.curve.red),o=i.toRed(Wr.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(Wr.curve.b)).isZero()?{x:s,y:o}:null}Me.loadUncompressedPublicKey=gy});var Qi=H(ce=>{v();w();Object.defineProperty(ce,"__esModule",{value:!0});ce.validateObject=ce.createHmacDrbg=ce.bitMask=ce.bitSet=ce.bitGet=ce.bitLen=ce.utf8ToBytes=ce.equalBytes=ce.concatBytes=ce.ensureBytes=ce.numberToVarBytesBE=ce.numberToBytesLE=ce.numberToBytesBE=ce.bytesToNumberLE=ce.bytesToNumberBE=ce.hexToBytes=ce.hexToNumber=ce.numberToHexUnpadded=ce.bytesToHex=void 0;var _y=BigInt(0),Xu=BigInt(1),z4=BigInt(2),Yu=e=>e instanceof Uint8Array,X4=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Kl(e){if(!Yu(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=X4[e[r]];return t}ce.bytesToHex=Kl;function vy(e){let t=e.toString(16);return t.length&1?`0${t}`:t}ce.numberToHexUnpadded=vy;function Dl(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}ce.hexToNumber=Dl;function $u(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");t[r]=s}return t}ce.hexToBytes=$u;function Y4(e){return Dl(Kl(e))}ce.bytesToNumberBE=Y4;function $4(e){if(!Yu(e))throw new Error("Uint8Array expected");return Dl(Kl(Uint8Array.from(e).reverse()))}ce.bytesToNumberLE=$4;var Z4=(e,t)=>$u(e.toString(16).padStart(t*2,"0"));ce.numberToBytesBE=Z4;var J4=(e,t)=>(0,ce.numberToBytesBE)(e,t).reverse();ce.numberToBytesLE=J4;var Q4=e=>$u(vy(e));ce.numberToVarBytesBE=Q4;function e8(e,t,r){let n;if(typeof t=="string")try{n=$u(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Yu(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}ce.ensureBytes=e8;function wy(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Yu(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}ce.concatBytes=wy;function t8(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}ce.equalBytes=t8;function r8(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}ce.utf8ToBytes=r8;function n8(e){let t;for(t=0;e>_y;e>>=Xu,t+=1);return t}ce.bitLen=n8;var i8=(e,t)=>e>>BigInt(t)&Xu;ce.bitGet=i8;var s8=(e,t,r)=>e|(r?Xu:_y)<<BigInt(t);ce.bitSet=s8;var o8=e=>(z4<<BigInt(e-1))-Xu;ce.bitMask=o8;var Ll=e=>new Uint8Array(e),my=e=>Uint8Array.from(e);function a8(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Ll(e),i=Ll(e),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...f)=>r(i,n,...f),c=(f=Ll())=>{i=a(my([0]),f),n=a(),f.length!==0&&(i=a(my([1]),f),n=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,p=[];for(;f<t;){n=a();let y=n.slice();p.push(y),f+=n.length}return wy(...p)};return(f,p)=>{o(),c(f);let y;for(;!(y=p(u()));)c();return o(),y}}ce.createHmacDrbg=a8;var c8={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function u8(e,t,r={}){let n=(i,s,o)=>{let a=c8[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=e[i];if(!(o&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}ce.validateObject=u8});var _o=H(be=>{v();w();Object.defineProperty(be,"__esModule",{value:!0});be.hashToPrivateScalar=be.FpSqrtEven=be.FpSqrtOdd=be.Field=be.nLength=be.FpIsSquare=be.FpDiv=be.FpInvertBatch=be.FpPow=be.validateField=be.isNegativeLE=be.FpSqrt=be.tonelliShanks=be.invert=be.pow2=be.pow=be.mod=void 0;var es=Qi(),rr=BigInt(0),Ge=BigInt(1),Bs=BigInt(2),f8=BigInt(3),jl=BigInt(4),Sy=BigInt(5),xy=BigInt(8),d8=BigInt(9),l8=BigInt(16);function An(e,t){let r=e%t;return r>=rr?r:t+r}be.mod=An;function Ty(e,t,r){if(r<=rr||t<rr)throw new Error("Expected power/modulo > 0");if(r===Ge)return rr;let n=Ge;for(;t>rr;)t&Ge&&(n=n*e%r),e=e*e%r,t>>=Ge;return n}be.pow=Ty;function h8(e,t,r){let n=e;for(;t-- >rr;)n*=n,n%=r;return n}be.pow2=h8;function Zu(e,t){if(e===rr||t<=rr)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=An(e,t),n=t,i=rr,s=Ge,o=Ge,a=rr;for(;r!==rr;){let u=n/r,d=n%r,f=i-o*u,p=s-a*u;n=r,r=d,i=o,s=a,o=f,a=p}if(n!==Ge)throw new Error("invert: does not exist");return An(i,t)}be.invert=Zu;function Py(e){let t=(e-Ge)/Bs,r,n,i;for(r=e-Ge,n=0;r%Bs===rr;r/=Bs,n++);for(i=Bs;i<e&&Ty(i,t,e)!==e-Ge;i++);if(n===1){let o=(e+Ge)/jl;return function(c,u){let d=c.pow(u,o);if(!c.eql(c.sqr(d),u))throw new Error("Cannot find square root");return d}}let s=(r+Ge)/Bs;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,d=a.pow(a.mul(a.ONE,i),r),f=a.pow(c,s),p=a.pow(c,r);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let y=1;for(let _=a.sqr(p);y<u&&!a.eql(_,a.ONE);y++)_=a.sqr(_);let m=a.pow(d,Ge<<BigInt(u-y-1));d=a.sqr(m),f=a.mul(f,m),p=a.mul(p,d),u=y}return f}}be.tonelliShanks=Py;function Ey(e){if(e%jl===f8){let t=(e+Ge)/jl;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%xy===Sy){let t=(e-Sy)/xy;return function(n,i){let s=n.mul(i,Bs),o=n.pow(s,t),a=n.mul(i,o),c=n.mul(n.mul(a,Bs),o),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%l8,Py(e)}be.FpSqrt=Ey;var p8=(e,t)=>(An(e,t)&Ge)===Ge;be.isNegativeLE=p8;var b8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function g8(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=b8.reduce((n,i)=>(n[i]="function",n),t);return(0,es.validateObject)(e,r)}be.validateField=g8;function Iy(e,t,r){if(r<rr)throw new Error("Expected power > 0");if(r===rr)return e.ONE;if(r===Ge)return t;let n=e.ONE,i=t;for(;r>rr;)r&Ge&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Ge;return n}be.FpPow=Iy;function Ay(e,t){let r=new Array(t.length),n=t.reduce((s,o,a)=>e.is0(o)?s:(r[a]=s,e.mul(s,o)),e.ONE),i=e.inv(n);return t.reduceRight((s,o,a)=>e.is0(o)?s:(r[a]=e.mul(s,r[a]),e.mul(s,o)),i),r}be.FpInvertBatch=Ay;function y8(e,t,r){return e.mul(t,typeof r=="bigint"?Zu(r,e.ORDER):e.inv(r))}be.FpDiv=y8;function m8(e){let t=(e.ORDER-Ge)/Bs;return r=>{let n=e.pow(r,t);return e.eql(n,e.ZERO)||e.eql(n,e.ONE)}}be.FpIsSquare=m8;function Fl(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}be.nLength=Fl;function _8(e,t,r=!1,n={}){if(e<=rr)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=Fl(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Ey(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:(0,es.bitMask)(i),ZERO:rr,ONE:Ge,create:c=>An(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return rr<=c&&c<e},is0:c=>c===rr,isOdd:c=>(c&Ge)===Ge,neg:c=>An(-c,e),eql:(c,u)=>c===u,sqr:c=>An(c*c,e),add:(c,u)=>An(c+u,e),sub:(c,u)=>An(c-u,e),mul:(c,u)=>An(c*u,e),pow:(c,u)=>Iy(a,c,u),div:(c,u)=>An(c*Zu(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Zu(c,e),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>Ay(a,c),cmov:(c,u,d)=>d?u:c,toBytes:c=>r?(0,es.numberToBytesLE)(c,s):(0,es.numberToBytesBE)(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?(0,es.bytesToNumberLE)(c):(0,es.bytesToNumberBE)(c)}});return Object.freeze(a)}be.Field=_8;function v8(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}be.FpSqrtOdd=v8;function w8(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}be.FpSqrtEven=w8;function S8(e,t,r=!1){e=(0,es.ensureBytes)("privateHash",e);let n=e.length,i=Fl(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,es.bytesToNumberLE)(e):(0,es.bytesToNumberBE)(e);return An(s,t-Ge)+Ge}be.hashToPrivateScalar=S8});var By=H(ha=>{v();w();Object.defineProperty(ha,"__esModule",{value:!0});ha.validateBasic=ha.wNAF=void 0;var Oy=_o(),x8=Qi(),T8=BigInt(0),Vl=BigInt(1);function P8(e,t){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(t/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=e.ZERO,a=i;for(;s>T8;)s&Vl&&(o=o.add(a)),a=a.double(),s>>=Vl;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),c=[],u=i,d=u;for(let f=0;f<o;f++){d=u,c.push(d);for(let p=1;p<a;p++)d=d.add(u),c.push(d);u=d.double()}return c},wNAF(i,s,o){let{windows:a,windowSize:c}=n(i),u=e.ZERO,d=e.BASE,f=BigInt(2**i-1),p=2**i,y=BigInt(i);for(let m=0;m<a;m++){let _=m*c,E=Number(o&f);o>>=y,E>c&&(E-=p,o+=Vl);let I=_,k=_+Math.abs(E)-1,C=m%2!==0,R=E<0;E===0?d=d.add(r(C,s[I])):u=u.add(r(R,s[k]))}return{p:u,f:d}},wNAFCached(i,s,o,a){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,a(u))),this.wNAF(c,u,o)}}}ha.wNAF=P8;function E8(e){return(0,Oy.validateField)(e.Fp),(0,x8.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Oy.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}ha.validateBasic=E8});var Qu=H(We=>{v();w();var I8=We&&We.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),A8=We&&We.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Cy=We&&We.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&I8(t,e,r);return A8(t,e),t};Object.defineProperty(We,"__esModule",{value:!0});We.mapToCurveSimpleSWU=We.SWUFpSqrtRatio=We.weierstrass=We.weierstrassPoints=We.DER=void 0;var vc=Cy(_o()),Gt=Cy(Qi()),mi=Qi(),Gl=By();function O8(e){let t=(0,Gl.validateBasic)(e);Gt.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:B8,hexToBytes:M8}=Gt;We.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=We.DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:B8(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=We.DER,r=typeof e=="string"?M8(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=We.DER._parseInt(r.subarray(2)),{d:o,l:a}=We.DER._parseInt(s);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let d=u.toString(16);return d.length&1?`0${d}`:d},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,o=i.length/2,a=r(s),c=r(o);return`30${r(o+s+4)}02${c}${i}02${a}${n}`}};var oi=BigInt(0),at=BigInt(1),Ms=BigInt(2),Ju=BigInt(3),My=BigInt(4);function ky(e){let t=O8(e),{Fp:r}=t,n=t.toBytes||((m,_,E)=>{let I=_.toAffine();return Gt.concatBytes(Uint8Array.from([4]),r.toBytes(I.x),r.toBytes(I.y))}),i=t.fromBytes||(m=>{let _=m.subarray(1),E=r.fromBytes(_.subarray(0,r.BYTES)),I=r.fromBytes(_.subarray(r.BYTES,2*r.BYTES));return{x:E,y:I}});function s(m){let{a:_,b:E}=t,I=r.sqr(m),k=r.mul(I,m);return r.add(r.add(k,r.mul(m,_)),E)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(m){return typeof m=="bigint"&&oi<m&&m<t.n}function a(m){if(!o(m))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(m){let{allowedPrivateKeyLengths:_,nByteLength:E,wrapPrivateKey:I,n:k}=t;if(_&&typeof m!="bigint"){if(m instanceof Uint8Array&&(m=Gt.bytesToHex(m)),typeof m!="string"||!_.includes(m.length))throw new Error("Invalid key");m=m.padStart(E*2,"0")}let C;try{C=typeof m=="bigint"?m:Gt.bytesToNumberBE((0,mi.ensureBytes)("private key",m,E))}catch{throw new Error(`private key must be ${E} bytes, hex or bigint, not ${typeof m}`)}return I&&(C=vc.mod(C,k)),a(C),C}let u=new Map;function d(m){if(!(m instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(_,E,I){if(this.px=_,this.py=E,this.pz=I,_==null||!r.isValid(_))throw new Error("x required");if(E==null||!r.isValid(E))throw new Error("y required");if(I==null||!r.isValid(I))throw new Error("z required")}static fromAffine(_){let{x:E,y:I}=_||{};if(!_||!r.isValid(E)||!r.isValid(I))throw new Error("invalid affine point");if(_ instanceof f)throw new Error("projective point not allowed");let k=C=>r.eql(C,r.ZERO);return k(E)&&k(I)?f.ZERO:new f(E,I,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){let E=r.invertBatch(_.map(I=>I.pz));return _.map((I,k)=>I.toAffine(E[k])).map(f.fromAffine)}static fromHex(_){let E=f.fromAffine(i((0,mi.ensureBytes)("pointHex",_)));return E.assertValidity(),E}static fromPrivateKey(_){return f.BASE.multiply(c(_))}_setWindowSize(_){this._WINDOW_SIZE=_,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:_,y:E}=this.toAffine();if(!r.isValid(_)||!r.isValid(E))throw new Error("bad point: x or y not FE");let I=r.sqr(E),k=s(_);if(!r.eql(I,k))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:_}=this.toAffine();if(r.isOdd)return!r.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){d(_);let{px:E,py:I,pz:k}=this,{px:C,py:R,pz:U}=_,q=r.eql(r.mul(E,U),r.mul(C,k)),L=r.eql(r.mul(I,U),r.mul(R,k));return q&&L}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){let{a:_,b:E}=t,I=r.mul(E,Ju),{px:k,py:C,pz:R}=this,U=r.ZERO,q=r.ZERO,L=r.ZERO,K=r.mul(k,k),W=r.mul(C,C),O=r.mul(R,R),l=r.mul(k,C);return l=r.add(l,l),L=r.mul(k,R),L=r.add(L,L),U=r.mul(_,L),q=r.mul(I,O),q=r.add(U,q),U=r.sub(W,q),q=r.add(W,q),q=r.mul(U,q),U=r.mul(l,U),L=r.mul(I,L),O=r.mul(_,O),l=r.sub(K,O),l=r.mul(_,l),l=r.add(l,L),L=r.add(K,K),K=r.add(L,K),K=r.add(K,O),K=r.mul(K,l),q=r.add(q,K),O=r.mul(C,R),O=r.add(O,O),K=r.mul(O,l),U=r.sub(U,K),L=r.mul(O,W),L=r.add(L,L),L=r.add(L,L),new f(U,q,L)}add(_){d(_);let{px:E,py:I,pz:k}=this,{px:C,py:R,pz:U}=_,q=r.ZERO,L=r.ZERO,K=r.ZERO,W=t.a,O=r.mul(t.b,Ju),l=r.mul(E,C),g=r.mul(I,R),S=r.mul(k,U),T=r.add(E,I),x=r.add(C,R);T=r.mul(T,x),x=r.add(l,g),T=r.sub(T,x),x=r.add(E,k);let B=r.add(C,U);return x=r.mul(x,B),B=r.add(l,S),x=r.sub(x,B),B=r.add(I,k),q=r.add(R,U),B=r.mul(B,q),q=r.add(g,S),B=r.sub(B,q),K=r.mul(W,x),q=r.mul(O,S),K=r.add(q,K),q=r.sub(g,K),K=r.add(g,K),L=r.mul(q,K),g=r.add(l,l),g=r.add(g,l),S=r.mul(W,S),x=r.mul(O,x),g=r.add(g,S),S=r.sub(l,S),S=r.mul(W,S),x=r.add(x,S),l=r.mul(g,x),L=r.add(L,l),l=r.mul(B,x),q=r.mul(T,q),q=r.sub(q,l),l=r.mul(T,g),K=r.mul(B,K),K=r.add(K,l),new f(q,L,K)}subtract(_){return this.add(_.negate())}is0(){return this.equals(f.ZERO)}wNAF(_){return y.wNAFCached(this,u,_,E=>{let I=r.invertBatch(E.map(k=>k.pz));return E.map((k,C)=>k.toAffine(I[C])).map(f.fromAffine)})}multiplyUnsafe(_){let E=f.ZERO;if(_===oi)return E;if(a(_),_===at)return this;let{endo:I}=t;if(!I)return y.unsafeLadder(this,_);let{k1neg:k,k1:C,k2neg:R,k2:U}=I.splitScalar(_),q=E,L=E,K=this;for(;C>oi||U>oi;)C&at&&(q=q.add(K)),U&at&&(L=L.add(K)),K=K.double(),C>>=at,U>>=at;return k&&(q=q.negate()),R&&(L=L.negate()),L=new f(r.mul(L.px,I.beta),L.py,L.pz),q.add(L)}multiply(_){a(_);let E=_,I,k,{endo:C}=t;if(C){let{k1neg:R,k1:U,k2neg:q,k2:L}=C.splitScalar(E),{p:K,f:W}=this.wNAF(U),{p:O,f:l}=this.wNAF(L);K=y.constTimeNegate(R,K),O=y.constTimeNegate(q,O),O=new f(r.mul(O.px,C.beta),O.py,O.pz),I=K.add(O),k=W.add(l)}else{let{p:R,f:U}=this.wNAF(E);I=R,k=U}return f.normalizeZ([I,k])[0]}multiplyAndAddUnsafe(_,E,I){let k=f.BASE,C=(U,q)=>q===oi||q===at||!U.equals(k)?U.multiplyUnsafe(q):U.multiply(q),R=C(this,E).add(C(_,I));return R.is0()?void 0:R}toAffine(_){let{px:E,py:I,pz:k}=this,C=this.is0();_==null&&(_=C?r.ONE:r.inv(k));let R=r.mul(E,_),U=r.mul(I,_),q=r.mul(k,_);if(C)return{x:r.ZERO,y:r.ZERO};if(!r.eql(q,r.ONE))throw new Error("invZ was invalid");return{x:R,y:U}}isTorsionFree(){let{h:_,isTorsionFree:E}=t;if(_===at)return!0;if(E)return E(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:_,clearCofactor:E}=t;return _===at?this:E?E(f,this):this.multiplyUnsafe(t.h)}toRawBytes(_=!0){return this.assertValidity(),n(f,this,_)}toHex(_=!0){return Gt.bytesToHex(this.toRawBytes(_))}}f.BASE=new f(t.Gx,t.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);let p=t.nBitLength,y=(0,Gl.wNAF)(f,t.endo?Math.ceil(p/2):p);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}We.weierstrassPoints=ky;function C8(e){let t=(0,Gl.validateBasic)(e);return Gt.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function k8(e){let t=C8(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function o(x){return oi<x&&x<r.ORDER}function a(x){return vc.mod(x,n)}function c(x){return vc.invert(x,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:p}=ky({...t,toBytes(x,B,M){let P=B.toAffine(),b=r.toBytes(P.x),A=Gt.concatBytes;return M?A(Uint8Array.from([B.hasEvenY()?2:3]),b):A(Uint8Array.from([4]),b,r.toBytes(P.y))},fromBytes(x){let B=x.length,M=x[0],P=x.subarray(1);if(B===i&&(M===2||M===3)){let b=Gt.bytesToNumberBE(P);if(!o(b))throw new Error("Point is not on curve");let A=f(b),j=r.sqrt(A),D=(j&at)===at;return(M&1)===1!==D&&(j=r.neg(j)),{x:b,y:j}}else if(B===s&&M===4){let b=r.fromBytes(P.subarray(0,r.BYTES)),A=r.fromBytes(P.subarray(r.BYTES,2*r.BYTES));return{x:b,y:A}}else throw new Error(`Point of length ${B} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),y=x=>Gt.bytesToHex(Gt.numberToBytesBE(x,t.nByteLength));function m(x){let B=n>>at;return x>B}function _(x){return m(x)?a(-x):x}let E=(x,B,M)=>Gt.bytesToNumberBE(x.slice(B,M));class I{constructor(B,M,P){this.r=B,this.s=M,this.recovery=P,this.assertValidity()}static fromCompact(B){let M=t.nByteLength;return B=(0,mi.ensureBytes)("compactSignature",B,M*2),new I(E(B,0,M),E(B,M,2*M))}static fromDER(B){let{r:M,s:P}=We.DER.toSig((0,mi.ensureBytes)("DER",B));return new I(M,P)}assertValidity(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(B){return new I(this.r,this.s,B)}recoverPublicKey(B){let{r:M,s:P,recovery:b}=this,A=L((0,mi.ensureBytes)("msgHash",B));if(b==null||![0,1,2,3].includes(b))throw new Error("recovery id invalid");let j=b===2||b===3?M+t.n:M;if(j>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let D=(b&1)===0?"02":"03",V=u.fromHex(D+y(j)),J=c(j),fe=a(-A*J),xe=a(P*J),Sr=u.BASE.multiplyAndAddUnsafe(V,fe,xe);if(!Sr)throw new Error("point at infinify");return Sr.assertValidity(),Sr}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Gt.hexToBytes(this.toDERHex())}toDERHex(){return We.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Gt.hexToBytes(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let k={isValidPrivateKey(x){try{return d(x),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{let x=t.randomBytes(r.BYTES+8),B=vc.hashToPrivateScalar(x,n);return Gt.numberToBytesBE(B,t.nByteLength)},precompute(x=8,B=u.BASE){return B._setWindowSize(x),B.multiply(BigInt(3)),B}};function C(x,B=!0){return u.fromPrivateKey(x).toRawBytes(B)}function R(x){let B=x instanceof Uint8Array,M=typeof x=="string",P=(B||M)&&x.length;return B?P===i||P===s:M?P===2*i||P===2*s:x instanceof u}function U(x,B,M=!0){if(R(x))throw new Error("first arg must be private key");if(!R(B))throw new Error("second arg must be public key");return u.fromHex(B).multiply(d(x)).toRawBytes(M)}let q=t.bits2int||function(x){let B=Gt.bytesToNumberBE(x),M=x.length*8-t.nBitLength;return M>0?B>>BigInt(M):B},L=t.bits2int_modN||function(x){return a(q(x))},K=Gt.bitMask(t.nBitLength);function W(x){if(typeof x!="bigint")throw new Error("bigint expected");if(!(oi<=x&&x<K))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Gt.numberToBytesBE(x,t.nByteLength)}function O(x,B,M=l){if(["recovered","canonical"].some(Te=>Te in M))throw new Error("sign() legacy options not supported");let{hash:P,randomBytes:b}=t,{lowS:A,prehash:j,extraEntropy:D}=M;A==null&&(A=!0),x=(0,mi.ensureBytes)("msgHash",x),j&&(x=(0,mi.ensureBytes)("prehashed msgHash",P(x)));let V=L(x),J=d(B),fe=[W(J),W(V)];if(D!=null){let Te=D===!0?b(r.BYTES):D;fe.push((0,mi.ensureBytes)("extraEntropy",Te,r.BYTES))}let xe=Gt.concatBytes(...fe),Sr=V;function Be(Te){let Vi=q(Te);if(!p(Vi))return;let rt=c(Vi),Ie=u.BASE.multiply(Vi).toAffine(),Gi=a(Ie.x);if(Gi===oi)return;let je=a(rt*a(Sr+Gi*J));if(je===oi)return;let nt=(Ie.x===Gi?0:2)|Number(Ie.y&at),ec=je;return A&&m(je)&&(ec=_(je),nt^=1),new I(Gi,ec,nt)}return{seed:xe,k2sig:Be}}let l={lowS:t.lowS,prehash:!1},g={lowS:t.lowS,prehash:!1};function S(x,B,M=l){let{seed:P,k2sig:b}=O(x,B,M),A=t;return Gt.createHmacDrbg(A.hash.outputLen,A.nByteLength,A.hmac)(P,b)}u.BASE._setWindowSize(8);function T(x,B,M,P=g){let b=x;if(B=(0,mi.ensureBytes)("msgHash",B),M=(0,mi.ensureBytes)("publicKey",M),"strict"in P)throw new Error("options.strict was renamed to lowS");let{lowS:A,prehash:j}=P,D,V;try{if(typeof b=="string"||b instanceof Uint8Array)try{D=I.fromDER(b)}catch(Ie){if(!(Ie instanceof We.DER.Err))throw Ie;D=I.fromCompact(b)}else if(typeof b=="object"&&typeof b.r=="bigint"&&typeof b.s=="bigint"){let{r:Ie,s:Gi}=b;D=new I(Ie,Gi)}else throw new Error("PARSE");V=u.fromHex(M)}catch(Ie){if(Ie.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(A&&D.hasHighS())return!1;j&&(B=t.hash(B));let{r:J,s:fe}=D,xe=L(B),Sr=c(fe),Be=a(xe*Sr),Te=a(J*Sr),Vi=u.BASE.multiplyAndAddUnsafe(V,Be,Te)?.toAffine();return Vi?a(Vi.x)===J:!1}return{CURVE:t,getPublicKey:C,getSharedSecret:U,sign:S,verify:T,ProjectivePoint:u,Signature:I,utils:k}}We.weierstrass=k8;function Hy(e,t){let r=e.ORDER,n=oi;for(let m=r-at;m%Ms===oi;m/=Ms)n+=at;let i=n,s=Ms<<i-at-at,o=s*Ms,a=(r-at)/o,c=(a-at)/Ms,u=o-at,d=s,f=e.pow(t,a),p=e.pow(t,(a+at)/Ms),y=(m,_)=>{let E=f,I=e.pow(_,u),k=e.sqr(I);k=e.mul(k,_);let C=e.mul(m,k);C=e.pow(C,c),C=e.mul(C,I),I=e.mul(C,_),k=e.mul(C,m);let R=e.mul(k,I);C=e.pow(R,d);let U=e.eql(C,e.ONE);I=e.mul(k,p),C=e.mul(R,E),k=e.cmov(I,k,U),R=e.cmov(C,R,U);for(let q=i;q>at;q--){let L=q-Ms;L=Ms<<L-at;let K=e.pow(R,L),W=e.eql(K,e.ONE);I=e.mul(k,E),E=e.mul(E,E),K=e.mul(R,E),k=e.cmov(I,k,W),R=e.cmov(K,R,W)}return{isValid:U,value:k}};if(e.ORDER%My===Ju){let m=(e.ORDER-Ju)/My,_=e.sqrt(e.neg(t));y=(E,I)=>{let k=e.sqr(I),C=e.mul(E,I);k=e.mul(k,C);let R=e.pow(k,m);R=e.mul(R,C);let U=e.mul(R,_),q=e.mul(e.sqr(R),I),L=e.eql(q,E),K=e.cmov(U,R,L);return{isValid:L,value:K}}}return y}We.SWUFpSqrtRatio=Hy;function H8(e,t){if(vc.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=Hy(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,a,c,u,d,f;i=e.sqr(n),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),u=e.sqr(a),c=e.mul(u,t.A),s=e.add(s,c),s=e.mul(s,o),u=e.mul(u,a),c=e.mul(u,t.B),s=e.add(s,c),d=e.mul(i,o);let{isValid:p,value:y}=r(s,u);f=e.mul(i,n),f=e.mul(f,y),d=e.cmov(d,o,p),f=e.cmov(f,y,p);let m=e.isOdd(n)===e.isOdd(f);return f=e.cmov(e.neg(f),f,m),d=e.div(d,a),{x:d,y:f}}}We.mapToCurveSimpleSWU=H8});var Ly=H(ct=>{v();w();Object.defineProperty(ct,"__esModule",{value:!0});ct.createHasher=ct.isogenyMap=ct.hash_to_field=ct.expand_message_xof=ct.expand_message_xmd=ct.isNum=ct.isBytes=ct.strxor=ct.i2osp=ct.validateDST=void 0;var N8=_o(),ai=Qi();function Ny(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,ai.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}ct.validateDST=Ny;var U8=ai.bytesToNumberBE;function ts(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}ct.i2osp=ts;function Uy(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}ct.strxor=Uy;function pa(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected")}ct.isBytes=pa;function ef(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}ct.isNum=ef;function Ry(e,t,r,n){pa(e),pa(t),ef(r),t.length>255&&(t=n((0,ai.concatBytes)((0,ai.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(o>255)throw new Error("Invalid xmd length");let a=(0,ai.concatBytes)(t,ts(t.length,1)),c=ts(0,s),u=ts(r,2),d=new Array(o),f=n((0,ai.concatBytes)(c,e,u,ts(0,1),a));d[0]=n((0,ai.concatBytes)(f,ts(1,1),a));for(let y=1;y<=o;y++){let m=[Uy(f,d[y-1]),ts(y+1,1),a];d[y]=n((0,ai.concatBytes)(...m))}return(0,ai.concatBytes)(...d).slice(0,r)}ct.expand_message_xmd=Ry;function qy(e,t,r,n,i){if(pa(e),pa(t),ef(r),t.length>255){let s=Math.ceil(2*n/8);t=i.create({dkLen:s}).update((0,ai.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(ts(r,2)).update(t).update(ts(t.length,1)).digest()}ct.expand_message_xof=qy;function Wl(e,t,r){(0,ai.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:o,expand:a,DST:c}=r;pa(e),ef(t);let u=Ny(c),d=n.toString(2).length,f=Math.ceil((d+i)/8),p=t*s*f,y;if(a==="xmd")y=Ry(e,u,p,o);else if(a==="xof")y=qy(e,u,p,i,o);else if(a==="_internal_pass")y=e;else throw new Error('expand must be "xmd" or "xof"');let m=new Array(t);for(let _=0;_<t;_++){let E=new Array(s);for(let I=0;I<s;I++){let k=f*(I+_*s),C=y.subarray(k,k+f);E[I]=(0,N8.mod)(U8(C),n)}m[_]=E}return m}ct.hash_to_field=Wl;function R8(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,o,a,c]=r.map(u=>u.reduce((d,f)=>e.add(e.mul(d,n),f)));return n=e.div(s,o),i=e.mul(i,e.div(a,c)),{x:n,y:i}}}ct.isogenyMap=R8;function q8(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=Wl(n,2,{...r,DST:r.DST,...i}),o=e.fromAffine(t(s[0])),a=e.fromAffine(t(s[1])),c=o.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,i){let s=Wl(n,1,{...r,DST:r.encodeDST,...i}),o=e.fromAffine(t(s[0])).clearCofactor();return o.assertValidity(),o}}}ct.createHasher=q8});var zl=H(ba=>{v();w();Object.defineProperty(ba,"__esModule",{value:!0});ba.createCurve=ba.getHash=void 0;var L8=fc(),Ky=xr(),K8=Qu();function Dy(e){return{hash:e,hmac:(t,...r)=>(0,L8.hmac)(e,t,(0,Ky.concatBytes)(...r)),randomBytes:Ky.randomBytes}}ba.getHash=Dy;function D8(e,t){let r=n=>(0,K8.weierstrass)({...e,...Dy(n)});return Object.freeze({...r(t),create:r})}ba.createCurve=D8});var Zy=H(Wt=>{v();w();var j8=Wt&&Wt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),F8=Wt&&Wt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),V8=Wt&&Wt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&j8(t,e,r);return F8(t,e),t},Xl;Object.defineProperty(Wt,"__esModule",{value:!0});Wt.encodeToCurve=Wt.hashToCurve=Wt.schnorr=Wt.secp256k1=void 0;var tf=Vo(),G8=xr(),hr=_o(),W8=Qu(),kr=Qi(),Vy=V8(Ly()),z8=zl(),of=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),rf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Gy=BigInt(1),nf=BigInt(2),jy=(e,t)=>(e+t/nf)/t;function Wy(e){let t=of,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,d=u*u*e%t,f=(0,hr.pow2)(d,r,t)*d%t,p=(0,hr.pow2)(f,r,t)*d%t,y=(0,hr.pow2)(p,nf,t)*u%t,m=(0,hr.pow2)(y,i,t)*y%t,_=(0,hr.pow2)(m,s,t)*m%t,E=(0,hr.pow2)(_,a,t)*_%t,I=(0,hr.pow2)(E,c,t)*E%t,k=(0,hr.pow2)(I,a,t)*_%t,C=(0,hr.pow2)(k,r,t)*d%t,R=(0,hr.pow2)(C,o,t)*m%t,U=(0,hr.pow2)(R,n,t)*u%t,q=(0,hr.pow2)(U,nf,t);if(!Cs.eql(Cs.sqr(q),e))throw new Error("Cannot find square root");return q}var Cs=(0,hr.Field)(of,void 0,void 0,{sqrt:Wy});Wt.secp256k1=(0,z8.createCurve)({a:BigInt(0),b:BigInt(7),Fp:Cs,n:rf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=rf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Gy*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=jy(s*e,t),c=jy(-n*e,t),u=(0,hr.mod)(e-a*r-c*i,t),d=(0,hr.mod)(-a*n-c*s,t),f=u>o,p=d>o;if(f&&(u=t-u),p&&(d=t-d),u>o||d>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:u,k2neg:p,k2:d}}}},tf.sha256);var af=BigInt(0),zy=e=>typeof e=="bigint"&&af<e&&e<of,X8=e=>typeof e=="bigint"&&af<e&&e<rf,Fy={};function sf(e,...t){let r=Fy[e];if(r===void 0){let n=(0,tf.sha256)(Uint8Array.from(e,i=>i.charCodeAt(0)));r=(0,kr.concatBytes)(n,n),Fy[e]=r}return(0,tf.sha256)((0,kr.concatBytes)(r,...t))}var Jl=e=>e.toRawBytes(!0).slice(1),$l=e=>(0,kr.numberToBytesBE)(e,32),Yl=e=>(0,hr.mod)(e,of),wc=e=>(0,hr.mod)(e,rf),Ql=Wt.secp256k1.ProjectivePoint,Y8=(e,t,r)=>Ql.BASE.multiplyAndAddUnsafe(e,t,r);function Zl(e){let t=Wt.secp256k1.utils.normPrivateKeyToScalar(e),r=Ql.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:wc(-t),bytes:Jl(r)}}function Xy(e){if(!zy(e))throw new Error("bad x: need 0 < x < p");let t=Yl(e*e),r=Yl(t*e+BigInt(7)),n=Wy(r);n%nf!==af&&(n=Yl(-n));let i=new Ql(e,n,Gy);return i.assertValidity(),i}function Yy(...e){return wc((0,kr.bytesToNumberBE)(sf("BIP0340/challenge",...e)))}function $8(e){return Zl(e).bytes}function Z8(e,t,r=(0,G8.randomBytes)(32)){let n=(0,kr.ensureBytes)("message",e),{bytes:i,scalar:s}=Zl(t),o=(0,kr.ensureBytes)("auxRand",r,32),a=$l(s^(0,kr.bytesToNumberBE)(sf("BIP0340/aux",o))),c=sf("BIP0340/nonce",a,i,n),u=wc((0,kr.bytesToNumberBE)(c));if(u===af)throw new Error("sign failed: k is zero");let{bytes:d,scalar:f}=Zl(u),p=Yy(d,i,n),y=new Uint8Array(64);if(y.set(d,0),y.set($l(wc(f+p*s)),32),!$y(y,n,i))throw new Error("sign: Invalid signature produced");return y}function $y(e,t,r){let n=(0,kr.ensureBytes)("signature",e,64),i=(0,kr.ensureBytes)("message",t),s=(0,kr.ensureBytes)("publicKey",r,32);try{let o=Xy((0,kr.bytesToNumberBE)(s)),a=(0,kr.bytesToNumberBE)(n.subarray(0,32));if(!zy(a))return!1;let c=(0,kr.bytesToNumberBE)(n.subarray(32,64));if(!X8(c))return!1;let u=Yy($l(a),Jl(o),i),d=Y8(o,c,wc(-u));return!(!d||!d.hasEvenY()||d.toAffine().x!==a)}catch{return!1}}Wt.schnorr={getPublicKey:$8,sign:Z8,verify:$y,utils:{randomPrivateKey:Wt.secp256k1.utils.randomPrivateKey,lift_x:Xy,pointToBytes:Jl,numberToBytesBE:kr.numberToBytesBE,bytesToNumberBE:kr.bytesToNumberBE,taggedHash:sf,mod:hr.mod}};var J8=Vy.isogenyMap(Cs,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),Q8=(0,W8.mapToCurveSimpleSWU)(Cs,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Cs.create(BigInt("-11"))});Xl=Vy.createHasher(Wt.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=Q8(Cs.create(e[0]));return J8(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Cs.ORDER,m:1,k:128,expand:"xmd",hash:tf.sha256}),Wt.hashToCurve=Xl.hashToCurve,Wt.encodeToCurve=Xl.encodeToCurve});var e1=H(ks=>{v();w();Object.defineProperty(ks,"__esModule",{value:!0});ks.poseidon=ks.splitConstants=ks.validateOpts=void 0;var Jy=_o();function Qy(e){let{Fp:t}=e;(0,Jy.validateField)(t);for(let c of["t","roundsFull","roundsPartial"])if(typeof e[c]!="number"||!Number.isSafeInteger(e[c]))throw new Error(`Poseidon: invalid param ${c}=${e[c]} (${typeof e[c]})`);if(e.reversePartialPowIdx!==void 0&&typeof e.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${e.reversePartialPowIdx}`);let r=e.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=c=>(0,Jy.FpPow)(t,c,n);if(r===3?i=c=>t.mul(t.sqrN(c),c):r===5&&(i=c=>t.mul(t.sqrN(t.sqrN(c)),c)),e.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${e.roundsFull}`);let s=e.roundsFull+e.roundsPartial;if(!Array.isArray(e.roundConstants)||e.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let o=e.roundConstants.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon wrong round constants: ${c}`);return c.map(u=>{if(typeof u!="bigint"||!t.isValid(u))throw new Error(`Poseidon wrong round constant=${u}`);return t.create(u)})});if(!Array.isArray(e.mds)||e.mds.length!==e.t)throw new Error("Poseidon: wrong MDS matrix");let a=e.mds.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon MDS matrix row: ${c}`);return c.map(u=>{if(typeof u!="bigint")throw new Error(`Poseidon MDS matrix value=${u}`);return t.create(u)})});return Object.freeze({...e,rounds:s,sboxFn:i,roundConstants:o,mds:a})}ks.validateOpts=Qy;function e5(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<e.length;i++)n.push(e[i]),n.length===t&&(r.push(n),n=[]);return r}ks.splitConstants=e5;function t5(e){let{t,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=Qy(e),o=Math.floor(e.roundsFull/2),a=s?t-1:0,c=(d,f,p)=>(d=d.map((y,m)=>r.add(y,e.roundConstants[p][m])),f?d=d.map(y=>i(y)):d[a]=i(d[a]),d=e.mds.map(y=>y.reduce((m,_,E)=>r.add(m,r.mulN(_,d[E])),r.ZERO)),d),u=function(f){if(!Array.isArray(f)||f.length!==t)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${t})`);f=f.map(y=>{if(typeof y!="bigint")throw new Error(`Poseidon: wrong value=${y} (${typeof y})`);return r.create(y)});let p=0;for(let y=0;y<o;y++)f=c(f,!0,p++);for(let y=0;y<e.roundsPartial;y++)f=c(f,!1,p++);for(let y=0;y<o;y++)f=c(f,!0,p++);if(p!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${p}, total=${n}`);return f};return u.roundConstants=e.roundConstants,u}ks.poseidon=t5});var h1=H(z=>{v();w();var r5=z&&z.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),n5=z&&z.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i5=z&&z.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&r5(t,e,r);return n5(t,e),t};Object.defineProperty(z,"__esModule",{value:!0});z.poseidonHashMany=z.poseidonHashSingle=z.poseidonHashFunc=z.poseidonHash=z.poseidonSmall=z.poseidonCreate=z.poseidonBasic=z._poseidonMDS=z.Fp251=z.Fp253=z.keccak=z.computeHashOnElements=z.hashChain=z.pedersen=z.getAccountPath=z.ethSigToPrivate=z.getStarkKey=z.grindKey=z.utils=z.Signature=z.ProjectivePoint=z.CURVE=z.verify=z.sign=z.getSharedSecret=z.getPublicKey=z._starkCurve=void 0;var s5=_u(),rh=Vo(),o5=xr(),wo=_o(),a5=e1(),c5=Qu(),Hr=i5(Qi()),u5=zl(),uf=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),n1=252;function t1(e){for(;e[0]===0;)e=e.subarray(1);let t=e.length*8-n1,r=Hr.bytesToNumberBE(e);return t>0?r>>BigInt(t):r}function i1(e){return typeof e=="string"&&(e=ih(e),e.length&1&&(e="0"+e)),Hr.hexToBytes(e)}var So=(0,c5.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,wo.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:uf,nBitLength:n1,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,u5.getHash)(rh.sha256),bits2int:t1,bits2int_modN:e=>{let t=Hr.bytesToNumberBE(e).toString(16);return t.length===63&&(e=i1(t+"0")),(0,wo.mod)(t1(e),uf)}});z._starkCurve=So;function vo(e){return Hr.ensureBytes("",typeof e=="string"?i1(e):e)}function nh(e){return Hr.bytesToHex(vo(e)).padStart(64,"0")}function s1(e,t=!1){return So.getPublicKey(nh(e),t)}z.getPublicKey=s1;function f5(e,t){return So.getSharedSecret(nh(e),t)}z.getSharedSecret=f5;function d5(e,t,r){return So.sign(vo(e),nh(t),r)}z.sign=d5;function l5(e,t,r){let n=e instanceof o1?e:vo(e);return So.verify(n,vo(t),vo(r))}z.verify=l5;var{CURVE:h5,ProjectivePoint:ga,Signature:o1,utils:p5}=So;z.CURVE=h5;z.ProjectivePoint=ga;z.Signature=o1;z.utils=p5;function a1(e){return`0x${Hr.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function ih(e){return e.replace(/^0x/i,"")}function b5(e){return`0x${e.toString(16)}`}function c1(e){let t=vo(e),r=2n**256n,n=r-(0,wo.mod)(r,uf);for(let i=0;;i++){let s=eh(Hr.concatBytes(t,Hr.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,wo.mod)(s,uf).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}z.grindKey=c1;function g5(e){return a1(s1(e,!0))}z.getStarkKey=g5;function y5(e){if(e=ih(e),e.length!==130)throw new Error("Wrong ethereum signature");return c1(e.substring(0,64))}z.ethSigToPrivate=y5;var m5=2n**31n-1n,cf=e=>Number(e&m5);function _5(e,t,r,n){let i=cf(eh(e)),s=cf(eh(t)),o=Hr.hexToNumber(ih(r));return`m/2645'/${i}'/${s}'/${cf(o)}'/${cf(o>>31n)}'/${n}`}z.getAccountPath=_5;var Sc=[new ga(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new ga(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new ga(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new ga(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new ga(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function u1(e,t){let r=[],n=e;for(let i=0;i<248;i++)r.push(n),n=n.double();n=t;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var v5=u1(Sc[1],Sc[2]),w5=u1(Sc[3],Sc[4]);function f1(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=Hr.bytesToNumberBE(vo(e));if(!(0n<=t&&t<So.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function r1(e,t,r){let n=f1(t);for(let i=0;i<252;i++){let s=r[i];if(s.equals(e))throw new Error("Same point");(n&1n)!==0n&&(e=e.add(s)),n>>=1n}return e}function sh(e,t){let r=Sc[0];return r=r1(r,e,v5),r=r1(r,t,w5),a1(r.toRawBytes(!0))}z.pedersen=sh;function S5(e,t=sh){if(!Array.isArray(e)||e.length<1)throw new Error("data should be array of at least 1 element");return e.length===1?b5(f1(e[0])):Array.from(e).reverse().reduce((r,n)=>t(n,r))}z.hashChain=S5;var x5=(e,t=sh)=>[0,...e,e.length].reduce((r,n)=>t(r,n));z.computeHashOnElements=x5;var T5=Hr.bitMask(250),P5=e=>Hr.bytesToNumberBE((0,s5.keccak_256)(e))&T5;z.keccak=P5;var eh=e=>Hr.bytesToNumberBE((0,rh.sha256)(e));z.Fp253=(0,wo.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));z.Fp251=(0,wo.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function th(e,t,r){let n=e.fromBytes((0,rh.sha256)((0,o5.utf8ToBytes)(`${t}${r}`)));return e.create(n)}function d1(e,t,r,n=0){let i=[],s=[];for(let o=0;o<r;o++)i.push(th(e,`${t}x`,n*r+o)),s.push(th(e,`${t}y`,n*r+o));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(o=>s.map(a=>e.inv(e.sub(o,a))))}z._poseidonMDS=d1;var E5=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function oh(e,t){if((0,wo.validateField)(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);let r=e.rate+e.capacity,n=e.roundsFull+e.roundsPartial,i=[];for(let o=0;o<n;o++){let a=[];for(let c=0;c<r;c++)a.push(th(e.Fp,"Hades",r*o+c));i.push(a)}let s=(0,a5.poseidon)({...e,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:i});return s.m=r,s.rate=e.rate,s.capacity=e.capacity,s}z.poseidonBasic=oh;function I5(e,t=0){let r=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return oh(e,d1(e.Fp,"HadesMDS",r,t))}z.poseidonCreate=I5;z.poseidonSmall=oh({Fp:z.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},E5);function l1(e,t,r=z.poseidonSmall){return r([e,t,2n])[0]}z.poseidonHash=l1;function A5(e,t,r=z.poseidonSmall){return Hr.numberToVarBytesBE(l1(Hr.bytesToNumberBE(e),Hr.bytesToNumberBE(t),r))}z.poseidonHashFunc=A5;function O5(e,t=z.poseidonSmall){return t([e,0n,1n])[0]}z.poseidonHashSingle=O5;function B5(e,t=z.poseidonSmall){let{m:r,rate:n}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");let i=Array.from(e);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let o=0;o<i.length;o+=n){for(let a=0;a<n;a++)s[a]+=i[o+a];s=t(s)}return s[0]}z.poseidonHashMany=B5});var g1=H(Nr=>{v();w();var M5=Nr&&Nr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),C5=Nr&&Nr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p1=Nr&&Nr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&M5(t,e,r);return C5(t,e),t};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.bytesToHex=Nr.hexToBytes=Nr.stark=Nr.secp256k1=void 0;Nr.secp256k1=p1(Zy());Nr.stark=p1(h1());var b1=Qi();Object.defineProperty(Nr,"hexToBytes",{enumerable:!0,get:function(){return b1.hexToBytes}});Object.defineProperty(Nr,"bytesToHex",{enumerable:!0,get:function(){return b1.bytesToHex}})});var y1=H(Ur=>{v();w();var k5=Ur&&Ur.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),H5=Ur&&Ur.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ff=Ur&&Ur.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&k5(t,e,r);return H5(t,e),t};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.schnorr=Ur.p256=Ur.ed25519=Ur.secp256k1=void 0;Ur.secp256k1=ff(iy());Ur.ed25519=ff(hy());Ur.p256=ff(yy());Ur.schnorr=ff(g1())});var sn=H(zt=>{v();w();var N5=zt&&zt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),U5=zt&&zt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ya=zt&&zt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&N5(t,e,r);return U5(t,e),t};Object.defineProperty(zt,"__esModule",{value:!0});zt.secp256k1=zt.ed25519=zt.signUtil=zt.elliptic=zt.bip39=zt.bip32=void 0;zt.bip32=ya(Lg());zt.bip39=ya(Ul());zt.elliptic=ya(ua());zt.signUtil=ya(y1());zt.ed25519=ya(Rp());zt.secp256k1=ya(x3())});var uh=H(On=>{v();w();Object.defineProperty(On,"__esModule",{value:!0});On.pushData=On.readCompactInt=On.writeCompactInt=On.BufferReader=On.BufferWriter=void 0;var ah=class{constructor(){this.chunks=[]}writeUInt32LE(t){let r=h.Buffer.alloc(4);return r.writeUInt32LE(t>>>0),this.chunks.push(r),this}writeBigInt64LE(t){let r=h.Buffer.alloc(8);return r.writeBigInt64LE(BigInt(t)),this.chunks.push(r),this}writeBytes(t){return this.chunks.push(h.Buffer.from(t)),this}writeHex(t){return this.chunks.push(h.Buffer.from(t,"hex")),this}writeHexReversed(t){let r=h.Buffer.from(t,"hex");return r.reverse(),this.chunks.push(r),this}writeByte(t){return this.chunks.push(h.Buffer.from([t])),this}writeCompactInt(t){return this.chunks.push(m1(t)),this}toBuffer(){return h.Buffer.concat(this.chunks)}toHex(){return this.toBuffer().toString("hex")}};On.BufferWriter=ah;var ch=class{constructor(t){this.offset=0,this.buf=typeof t=="string"?h.Buffer.from(t,"hex"):t}readUInt32LE(){let t=this.buf.readUInt32LE(this.offset);return this.offset+=4,t}readBigInt64LE(){let t=this.buf.readBigInt64LE(this.offset);return this.offset+=8,t}readBytes(t){let r=this.buf.subarray(this.offset,this.offset+t);return this.offset+=t,h.Buffer.from(r)}readBytesReversed(t){let r=h.Buffer.from(this.buf.subarray(this.offset,this.offset+t));return r.reverse(),this.offset+=t,r}readByte(){return this.buf[this.offset++]}peekByte(){return this.buf[this.offset]}readCompactInt(){let{value:t,bytesRead:r}=_1(this.buf,this.offset);return this.offset+=r,t}readHex(t){return this.readBytes(t).toString("hex")}readHexReversed(t){return this.readBytesReversed(t).toString("hex")}skip(t){return this.offset+=t,this}getOffset(){return this.offset}remaining(){return this.buf.length-this.offset}};On.BufferReader=ch;function m1(e){if(e<253)return h.Buffer.from([e]);if(e<=65535){let t=h.Buffer.alloc(3);return t[0]=253,t.writeUInt16LE(e,1),t}else if(e<=4294967295){let t=h.Buffer.alloc(5);return t[0]=254,t.writeUInt32LE(e,1),t}else{let t=h.Buffer.alloc(9);return t[0]=255,t.writeBigUInt64LE(BigInt(e),1),t}}On.writeCompactInt=m1;function _1(e,t){let r=e[t];return r<253?{value:r,bytesRead:1}:r===253?{value:e.readUInt16LE(t+1),bytesRead:3}:r===254?{value:e.readUInt32LE(t+1),bytesRead:5}:{value:Number(e.readBigUInt64LE(t+1)),bytesRead:9}}On.readCompactInt=_1;function R5(e){let t=h.Buffer.alloc(2),r=0;return e<76?(t[0]=e,r+=1):(t[0]=76,t[1]=e,r+=2),t.subarray(0,r)}On.pushData=R5});var df=H(ma=>{v();w();Object.defineProperty(ma,"__esModule",{value:!0});ma.writeSigScript=ma.SCRIPT_SIZE=void 0;var v1=uh();ma.SCRIPT_SIZE={p2pkh:26,p2sh:24};function q5(e,t){let r=h.Buffer.alloc(5+e.length+t.length),n=0,i=(0,v1.pushData)(e.length+1);i.copy(r,n),n+=i.length,h.Buffer.from(e).copy(r,n),n+=e.length,r[n]=1,n+=1;let s=(0,v1.pushData)(t.length);return s.copy(r,n),n+=s.length,h.Buffer.from(t).copy(r,n),n+=t.length,r.subarray(0,n)}ma.writeSigScript=q5});var fh=H(Rr=>{v();w();Object.defineProperty(Rr,"__esModule",{value:!0});Rr.addressToScript=Rr.p2shAddressToScript=Rr.p2pkhAddressToScript=Rr.pkToAddr=Rr.skToAddr=Rr.getAddressType=Rr.isValidAddr=void 0;var L5=sn(),xo=ae(),w1=df();function K5(e,t){try{let r=xo.base.fromBase58Check(e),n=h.Buffer.from(r.slice(0,2)),i=h.Buffer.from(t.p2pkhPrefix),s=h.Buffer.from(t.p2shPrefix);return n.compare(i)===0||n.compare(s)===0}catch{return!1}}Rr.isValidAddr=K5;function S1(e,t){try{let n=xo.base.fromBase58Check(e).slice(0,2);if(h.Buffer.from(n).compare(t.p2pkhPrefix)===0)return"p2pkh";if(h.Buffer.from(n).compare(t.p2shPrefix)===0)return"p2sh";throw new Error("Unknown address type")}catch{throw new Error("Invalid address format")}}Rr.getAddressType=S1;function D5(e,t){let r=L5.secp256k1.getPublicKey(e,!0);return{address:x1(r,t),publicKey:h.Buffer.from(r).toString("hex")}}Rr.skToAddr=D5;function x1(e,t){let r=xo.base.sha256(e),n=xo.base.ripemd160(r),i=h.Buffer.alloc(22);return h.Buffer.from(t).copy(i),h.Buffer.from(n).copy(i,2),xo.base.toBase58Check(i)}Rr.pkToAddr=x1;function T1(e){let t=xo.base.fromBase58Check(e),r=h.Buffer.alloc(20);h.Buffer.from(t.slice(2)).copy(r);let n=h.Buffer.alloc(w1.SCRIPT_SIZE.p2pkh);return h.Buffer.from("1976a914","hex").copy(n),h.Buffer.from(r).copy(n,4),h.Buffer.from("88ac","hex").copy(n,24),n}Rr.p2pkhAddressToScript=T1;function P1(e){let t=xo.base.fromBase58Check(e),r=h.Buffer.alloc(20);h.Buffer.from(t.slice(2)).copy(r);let n=h.Buffer.alloc(w1.SCRIPT_SIZE.p2sh);return h.Buffer.from("17a914","hex").copy(n),h.Buffer.from(r).copy(n,3),h.Buffer.from("87","hex").copy(n,23),n}Rr.p2shAddressToScript=P1;function j5(e,t){return S1(e,t)==="p2sh"?P1(e):T1(e)}Rr.addressToScript=j5});var dh=H(_a=>{v();w();Object.defineProperty(_a,"__esModule",{value:!0});_a.TESTNET=_a.MAINNET=void 0;_a.MAINNET={p2pkhPrefix:new Uint8Array([28,184]),p2shPrefix:new Uint8Array([28,189]),wif:128};_a.TESTNET={p2pkhPrefix:new Uint8Array([29,37]),p2shPrefix:new Uint8Array([28,186]),wif:239}});var H1=H(ge=>{v();w();Object.defineProperty(ge,"__esModule",{value:!0});ge.signTx=ge.buildTx=ge.getFee=ge.deserializeTx=ge.serializeTx=ge.calcTxHash=ge.txDigest=ge.transparentSigDigest=ge.transparentDigestV5=ge.hashTxIn=ge.hashScripts=ge.hashAmounts=ge.hashOutputs=ge.hashSequence=ge.hashPrevouts=ge.headerDigest=ge.serializeHeader=void 0;var hh=sn(),Tc=ae(),F5=df(),pr=uh(),xc=fh(),V5=dh(),Bn=4,Hs=5,I1={[Bn]:2301567109,[Hs]:648488714},ph=2147483648,G5=1307332080,A1=h.Buffer.from("6f2fc8f98feafd94e74a0df4bed74391ee0b5a69945e4ced8ca8a095206f00ae","hex"),O1=h.Buffer.from("9fbe4ed13b0c08e671c11a3407d84e1117cd45028a2eee1b9feae78b48a6e2c1","hex"),W5="ZTxIdHeadersHash",bh="ZTxIdTranspaHash",z5="ZTxIdPrevoutHash",X5="ZTxIdSequencHash",Y5="ZTxIdOutputsHash",$5="ZTxTrAmountsHash",Z5="ZTxTrScriptsHash",J5="Zcash___TxInHash",B1="ZcashTxHash_",Q5="ZcashPrevoutHash",ex="ZcashSequencHash",tx="ZcashOutputsHash",rx="ZcashSigHash",gh=1,lf=4294967295,nx=5e3,ix=2,E1={p2pkh:34,p2sh:32};function hf(e,t){let r=typeof t=="string"?new TextEncoder().encode(t):t;return Tc.base.blake2b(e,{dkLen:32,key:void 0,salt:void 0,personalization:r})}function _i(e,t){let r=hf(e,t);return Tc.base.toHex(r)}function yh(e){let t=new pr.BufferWriter;return t.writeUInt32LE(e.version|ph),t.writeUInt32LE(I1[e.version]),e.version===Hs&&(t.writeUInt32LE(e.consensusBranchId),t.writeUInt32LE(e.locktime),t.writeUInt32LE(e.height)),t.toBuffer()}ge.serializeHeader=yh;function mh(e){let t=yh(e);return _i(t,W5)}ge.headerDigest=mh;function Pc(e,t=Hs){let r=new pr.BufferWriter;for(let i of e)r.writeHexReversed(i.txId),r.writeUInt32LE(i.vOut);let n=t===Bn?Q5:z5;return _i(r.toBuffer(),n)}ge.hashPrevouts=Pc;function Ec(e,t=Hs){let r=new pr.BufferWriter;for(let i=0;i<e.length;i++)r.writeUInt32LE(lf);let n=t===Bn?ex:X5;return _i(r.toBuffer(),n)}ge.hashSequence=Ec;function Ic(e,t=Hs){let r=new pr.BufferWriter;for(let i of e)r.writeBigInt64LE(i.amount),r.writeBytes(i.script);let n=t===Bn?tx:Y5;return _i(r.toBuffer(),n)}ge.hashOutputs=Ic;function _h(e){let t=new pr.BufferWriter;for(let r of e)t.writeBigInt64LE(r.amount);return _i(t.toBuffer(),$5)}ge.hashAmounts=_h;function vh(e){let t=new pr.BufferWriter;for(let r of e)t.writeBytes(r.script);return _i(t.toBuffer(),Z5)}ge.hashScripts=vh;function wh(e){let t=new pr.BufferWriter;return t.writeHexReversed(e.txId),t.writeUInt32LE(e.vOut),t.writeBigInt64LE(e.amount),t.writeBytes(e.script),t.writeUInt32LE(lf),_i(t.toBuffer(),J5)}ge.hashTxIn=wh;function M1(e,t){let r=new pr.BufferWriter;return r.writeHex(Pc(e)),r.writeHex(Ec(e)),r.writeHex(Ic(t)),_i(r.toBuffer(),bh)}ge.transparentDigestV5=M1;function sx(e,t,r){let n=new pr.BufferWriter;return n.writeByte(gh),n.writeHex(Pc(e)),n.writeHex(_h(e)),n.writeHex(vh(e)),n.writeHex(Ec(e)),n.writeHex(Ic(t)),n.writeHex(wh(e[r])),_i(n.toBuffer(),bh)}ge.transparentSigDigest=sx;function C1(e,t){let r=new pr.BufferWriter;r.writeHex(mh(e)),r.writeHex(t),r.writeBytes(A1),r.writeBytes(O1);let n=new pr.BufferWriter;return n.writeBytes(h.Buffer.from(B1)),n.writeUInt32LE(e.consensusBranchId),h.Buffer.from(hf(r.toBuffer(),n.toBuffer()))}ge.txDigest=C1;function ox(e){let t=k1(e);if(t.version===Bn)return Tc.base.toHex(Tc.base.doubleSha256(Tc.base.fromHex(e)).reverse());let r=M1(t.inputs,t.outputs),n=C1(t,r);return h.Buffer.from(n).reverse().toString("hex")}ge.calcTxHash=ox;function ax(e){let t=new pr.BufferWriter;t.writeBytes(yh(e)),t.writeCompactInt(e.inputs.length);for(let[r,n]of e.inputs.entries()){t.writeHexReversed(n.txId),t.writeUInt32LE(n.vOut);let i=n.scriptSig??(0,F5.writeSigScript)(e.signatures[r],e.pk);t.writeCompactInt(i.length),t.writeBytes(i),t.writeUInt32LE(n.sequence??lf)}t.writeCompactInt(e.outputs.length);for(let r of e.outputs)t.writeBigInt64LE(r.amount),t.writeBytes(r.script);return e.version===Bn?(t.writeUInt32LE(e.locktime),t.writeUInt32LE(e.height),t.writeBigInt64LE(0),t.writeByte(0),t.writeByte(0),t.writeByte(0)):t.writeBytes(h.Buffer.from([0,0,0])),t.toHex()}ge.serializeTx=ax;function k1(e){let t=new pr.BufferReader(e),r=t.readUInt32LE()&~ph;if(t.skip(4),r!==Hs&&r!==Bn)throw new Error(`Unsupported version: ${r}`);let n={version:r,consensusBranchId:0,locktime:0,height:0,inputs:[],outputs:[],fee:0,pk:new Uint8Array,signatures:[]};r===Hs&&(n.consensusBranchId=t.readUInt32LE(),n.locktime=t.readUInt32LE(),n.height=t.readUInt32LE());let i=t.readCompactInt();for(let o=0;o<i;o++){let a=t.readHexReversed(32),c=t.readUInt32LE(),u=t.readCompactInt(),d=t.readBytes(u),f=t.readUInt32LE();n.inputs.push({txId:a,vOut:c,address:"",amount:0,sequence:f,scriptSig:d})}let s=t.readCompactInt();for(let o=0;o<s;o++){let a=Number(t.readBigInt64LE()),c=t.peekByte(),u;if(c===25)u=26;else if(c===23)u=24;else throw new Error(`Unknown script type at offset ${t.getOffset()}: 0x${c.toString(16)}`);n.outputs.push({address:"",script:t.readBytes(u),amount:a})}return r===Bn&&(n.locktime=t.readUInt32LE(),n.height=t.readUInt32LE()),n}ge.deserializeTx=k1;function cx(e,t){let r=Math.max(e,t);return nx*Math.max(ix,r)}function lh(e,t,r){let n=e.length,i=Math.ceil(t.reduce((s,o)=>s+E1[(0,xc.getAddressType)(o.address,r)],0)/E1.p2pkh);return cx(n,i)}ge.getFee=lh;function ux(e,t,r,n=V5.MAINNET,i=Hs,s=0,o=546,a=1){if(o<=0&&(o=546),a<1)throw new Error("Fee rate must be at least 1");r.push({address:e,amount:0}),t.forEach(p=>{if(!(0,xc.isValidAddr)(p.address,n))throw new Error(`Invalid input address: ${p.address}`);(p.script===void 0||p.script.length===0)&&(p.script=(0,xc.addressToScript)(p.address,n))}),r.forEach(p=>{if(!(0,xc.isValidAddr)(p.address,n))throw new Error(`Invalid output address: ${p.address}`);(p.script===void 0||p.script.length===0)&&(p.script=(0,xc.addressToScript)(p.address,n))});let c=lh(t,r,n)*a,u=t.reduce((p,y)=>p+y.amount,0),d=r.reduce((p,y)=>p+y.amount,0),f=u-d-c;if(f<o){r.pop();let p=lh(t,r,n)*a;if(u-d-p<0)throw new Error("Not enough funds")}else r[r.length-1].amount=f;return{version:i,consensusBranchId:G5,locktime:0,height:s,inputs:t,outputs:r,fee:c}}ge.buildTx=ux;async function fx(e,t,r){let{inputs:n,outputs:i}=r,s=Pc(n,Bn),o=Ec(n,Bn),a=Ic(i,Bn),c=new pr.BufferWriter;c.writeBytes(h.Buffer.from(rx)),c.writeUInt32LE(r.consensusBranchId);let u=c.toBuffer(),d=[];for(let f of n){let p=new pr.BufferWriter;p.writeUInt32LE(r.version>>>0|ph),p.writeUInt32LE(I1[r.version]),p.writeHex(s),p.writeHex(o),p.writeHex(a),p.writeBytes(h.Buffer.alloc(32)),p.writeBytes(h.Buffer.alloc(32)),p.writeBytes(h.Buffer.alloc(32)),p.writeUInt32LE(r.locktime),p.writeUInt32LE(r.height),p.writeBigInt64LE(0),p.writeUInt32LE(gh),p.writeHexReversed(f.txId),p.writeUInt32LE(f.vOut),p.writeBytes(f.script),p.writeBigInt64LE(f.amount),p.writeUInt32LE(lf);let y=hf(p.toBuffer(),u),m=await hh.secp256k1.sign(y,e,{canonical:!0,der:!0});d.push(m)}return{...r,pk:t,signatures:d}}async function dx(e,t,r){let{inputs:n,outputs:i}=r,s=mh(r),o=Pc(n),a=_h(n),c=vh(n),u=Ec(n),d=Ic(i),f=new pr.BufferWriter;f.writeBytes(h.Buffer.from(B1)),f.writeUInt32LE(r.consensusBranchId);let p=f.toBuffer(),y=[];for(let m of n){let _=new pr.BufferWriter;_.writeByte(gh),_.writeHex(o),_.writeHex(a),_.writeHex(c),_.writeHex(u),_.writeHex(d),_.writeHex(wh(m));let E=_i(_.toBuffer(),bh),I=new pr.BufferWriter;I.writeHex(s),I.writeHex(E),I.writeBytes(A1),I.writeBytes(O1);let k=hf(I.toBuffer(),p),C=await hh.secp256k1.sign(k,e,{canonical:!0,der:!0});y.push(C)}return{...r,pk:t,signatures:y}}async function lx(e,t){let r=hh.secp256k1.getPublicKey(e,!0);return t.version===Bn?fx(e,r,t):dx(e,r,t)}ge.signTx=lx});var Sh=H(ci=>{v();w();var hx=ci&&ci.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ac=ci&&ci.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&hx(t,e,r)};Object.defineProperty(ci,"__esModule",{value:!0});Ac(Lp(),ci);Ac(fh(),ci);Ac(H1(),ci);Ac(df(),ci);Ac(dh(),ci)});var vn=H(Ns=>{v();w();Object.defineProperty(Ns,"__esModule",{value:!0});Ns.testnet=Ns.regtest=Ns.bitcoin=void 0;Ns.bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};Ns.regtest={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};Ns.testnet={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}});var xh=H(Us=>{v();w();Object.defineProperty(Us,"__esModule",{value:!0});Us.encode=Us.decode=Us.check=void 0;function px(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;let t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;let r=e[5+t];return!(r===0||6+t+r!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||r>1&&e[t+6]===0&&!(e[t+7]&128))}Us.check=px;function bx(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");let t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");let r=e[5+t];if(r===0)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(r>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}Us.decode=bx;function gx(e,t){let r=e.length,n=t.length;if(r===0)throw new Error("R length is zero");if(n===0)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(n>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(n>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");let i=h.Buffer.allocUnsafe(6+r+n);return i[0]=48,i[1]=i.length-2,i[2]=2,i[3]=e.length,e.copy(i,4),i[4+r]=2,i[5+r]=t.length,t.copy(i,6+r),i}Us.encode=gx});var To=H(va=>{v();w();Object.defineProperty(va,"__esModule",{value:!0});va.REVERSE_OPS=va.OPS=void 0;var Th={OP_FALSE:0,OP_0:0,OP_DATA_1:1,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};va.OPS=Th;var N1={};va.REVERSE_OPS=N1;for(let e of Object.keys(Th)){let t=Th[e];N1[t]=e}});var R1=H(qs=>{v();w();Object.defineProperty(qs,"__esModule",{value:!0});qs.decode=qs.encode=qs.encodingLength=void 0;var Rs=To();function U1(e){return e<Rs.OPS.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}qs.encodingLength=U1;function yx(e,t,r){let n=U1(t);return n===1?e.writeUInt8(t,r):n===2?(e.writeUInt8(Rs.OPS.OP_PUSHDATA1,r),e.writeUInt8(t,r+1)):n===3?(e.writeUInt8(Rs.OPS.OP_PUSHDATA2,r),e.writeUInt16LE(t,r+1)):(e.writeUInt8(Rs.OPS.OP_PUSHDATA4,r),e.writeUInt32LE(t,r+1)),n}qs.encode=yx;function mx(e,t){let r=e.readUInt8(t),n,i;if(r<Rs.OPS.OP_PUSHDATA1)n=r,i=1;else if(r===Rs.OPS.OP_PUSHDATA1){if(t+2>e.length)return null;n=e.readUInt8(t+1),i=2}else if(r===Rs.OPS.OP_PUSHDATA2){if(t+3>e.length)return null;n=e.readUInt16LE(t+1),i=3}else{if(t+5>e.length)return null;if(r!==Rs.OPS.OP_PUSHDATA4)throw new Error("Unexpected opcode");n=e.readUInt32LE(t+1),i=5}return{opcode:r,number:n,size:i}}qs.decode=mx});var q1=H(wa=>{v();w();Object.defineProperty(wa,"__esModule",{value:!0});wa.encode=wa.decode=void 0;function _x(e,t,r){t=t||4,r=r===void 0?!0:r;let n=e.length;if(n===0)return 0;if(n>t)throw new TypeError("Script number overflow");if(r&&(e[n-1]&127)===0&&(n<=1||(e[n-2]&128)===0))throw new Error("Non-minimally encoded script number");if(n===5){let s=e.readUInt32LE(0),o=e.readUInt8(4);return o&128?-((o&-129)*4294967296+s):o*4294967296+s}let i=0;for(let s=0;s<n;++s)i|=e[s]<<8*s;return e[n-1]&128?-(i&~(128<<8*(n-1))):i}wa.decode=_x;function vx(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function wx(e){let t=Math.abs(e),r=vx(t),n=h.Buffer.allocUnsafe(r),i=e<0;for(let s=0;s<r;++s)n.writeUInt8(t&255,s),t>>=8;return n[r-1]&128?n.writeUInt8(i?128:0,r-1):i&&(n[r-1]|=128),n}wa.encode=wx});var qr=H($=>{v();w();Object.defineProperty($,"__esModule",{value:!0});$.oneOf=$.Null=$.BufferN=$.Function=$.UInt32=$.UInt8=$.tuple=$.maybe=$.Hex=$.Buffer=$.String=$.Boolean=$.Array=$.Number=$.Hash256bit=$.Hash160bit=$.Buffer256bit=$.isTaptree=$.isTapleaf=$.TAPLEAF_VERSION_MASK=$.Satoshi=$.Signer=$.BIP32Path=$.UInt31=$.isPoint=$.typeforce=void 0;var pf=tc(),ut=ae();Object.defineProperty($,"typeforce",{enumerable:!0,get:function(){return ut.typeforce}});var L1=pf.Buffer.alloc(32,0),K1=pf.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");function Sx(e){if(!pf.Buffer.isBuffer(e)||e.length<33)return!1;let t=e[0],r=e.slice(1,33);if(r.compare(L1)===0||r.compare(K1)>=0)return!1;if((t===2||t===3)&&e.length===33)return!0;let n=e.slice(33);return n.compare(L1)===0||n.compare(K1)>=0?!1:t===4&&e.length===65}$.isPoint=Sx;var xx=Math.pow(2,31)-1;function Tx(e){return ut.typeforce.UInt32(e)&&e<=xx}$.UInt31=Tx;function D1(e){return ut.typeforce.String(e)&&!!e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}$.BIP32Path=D1;D1.toJSON=()=>"BIP32 derivation path";function Px(e){return(ut.typeforce.Buffer(e.publicKey)||typeof e.getPublicKey=="function")&&typeof e.sign=="function"}$.Signer=Px;var Ex=21*1e14;function Ix(e){return ut.typeforce.UInt53(e)&&e<=Ex}$.Satoshi=Ix;$.TAPLEAF_VERSION_MASK=254;function j1(e){return!e||!("output"in e)||!pf.Buffer.isBuffer(e.output)?!1:e.version!==void 0?(e.version&$.TAPLEAF_VERSION_MASK)===e.version:!0}$.isTapleaf=j1;function F1(e){return(0,$.Array)(e)?e.length!==2?!1:e.every(t=>F1(t)):j1(e)}$.isTaptree=F1;$.Buffer256bit=ut.typeforce.BufferN(32);$.Hash160bit=ut.typeforce.BufferN(20);$.Hash256bit=ut.typeforce.BufferN(32);$.Number=ut.typeforce.Number;$.Array=ut.typeforce.Array;$.Boolean=ut.typeforce.Boolean;$.String=ut.typeforce.String;$.Buffer=ut.typeforce.Buffer;$.Hex=ut.typeforce.Hex;$.maybe=ut.typeforce.maybe;$.tuple=ut.typeforce.tuple;$.UInt8=ut.typeforce.UInt8;$.UInt32=ut.typeforce.UInt32;$.Function=ut.typeforce.Function;$.BufferN=ut.typeforce.BufferN;$.Null=ut.typeforce.Null;$.oneOf=ut.typeforce.oneOf});var Y1=H(Mn=>{v();w();var Ax=Mn&&Mn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ox=Mn&&Mn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),z1=Mn&&Mn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Ax(t,e,r);return Ox(t,e),t};Object.defineProperty(Mn,"__esModule",{value:!0});Mn.encode=Mn.decode=void 0;var X1=z1(xh()),Ph=z1(qr()),{typeforce:Bx}=Ph,V1=h.Buffer.alloc(1,0);function G1(e){let t=0;for(;e[t]===0;)++t;return t===e.length?V1:(e=e.slice(t),e[0]&128?h.Buffer.concat([V1,e],1+e.length):e)}function W1(e){e[0]===0&&(e=e.slice(1));let t=h.Buffer.alloc(32,0),r=Math.max(0,32-e.length);return e.copy(t,r),t}function Mx(e){let t=e.readUInt8(e.length-1),r=t&-193;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);let n=X1.decode(e.slice(0,-1)),i=W1(n.r),s=W1(n.s);return{signature:h.Buffer.concat([i,s],64),hashType:t}}Mn.decode=Mx;function Cx(e,t){Bx({signature:Ph.BufferN(64),hashType:Ph.UInt8},{signature:e,hashType:t});let r=t&-193;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);let n=h.Buffer.allocUnsafe(1);n.writeUInt8(t,0);let i=G1(e.slice(0,32)),s=G1(e.slice(32,64));return h.Buffer.concat([X1.encode(i,s),n])}Mn.encode=Cx});var Xt=H(Pe=>{v();w();var kx=Pe&&Pe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Hx=Pe&&Pe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Bc=Pe&&Pe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&kx(t,e,r);return Hx(t,e),t};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.signature=Pe.number=Pe.isCanonicalScriptSignature=Pe.isDefinedHashType=Pe.isCanonicalPubKey=Pe.toStack=Pe.fromASM=Pe.toASM=Pe.decompile=Pe.compile=Pe.isPushOnly=Pe.OPS=void 0;var Nx=Bc(xh()),on=To();Object.defineProperty(Pe,"OPS",{enumerable:!0,get:function(){return on.OPS}});var Eh=Bc(R1()),$1=Bc(q1()),Ux=Bc(Y1()),vi=Bc(qr()),{typeforce:Oc}=vi,Z1=on.OPS.OP_RESERVED;function Rx(e){return vi.Number(e)&&(e===on.OPS.OP_0||e>=on.OPS.OP_1&&e<=on.OPS.OP_16||e===on.OPS.OP_1NEGATE)}function qx(e){return vi.Buffer(e)||Rx(e)}function J1(e){return vi.Array(e)&&e.every(qx)}Pe.isPushOnly=J1;function bf(e){if(e.length===0)return on.OPS.OP_0;if(e.length===1){if(e[0]>=1&&e[0]<=16)return Z1+e[0];if(e[0]===129)return on.OPS.OP_1NEGATE}}function Q1(e){return h.Buffer.isBuffer(e)}function Lx(e){return vi.Array(e)}function gf(e){return h.Buffer.isBuffer(e)}function em(e){if(Q1(e))return e;Oc(vi.Array,e);let t=e.reduce((i,s)=>gf(s)?s.length===1&&bf(s)!==void 0?i+1:i+Eh.encodingLength(s.length)+s.length:i+1,0),r=h.Buffer.allocUnsafe(t),n=0;if(e.forEach(i=>{if(gf(i)){let s=bf(i);if(s!==void 0){r.writeUInt8(s,n),n+=1;return}n+=Eh.encode(r,i.length,n),i.copy(r,n),n+=i.length}else r.writeUInt8(i,n),n+=1}),n!==r.length)throw new Error("Could not decode chunks");return r}Pe.compile=em;function Ih(e){if(Lx(e))return e;Oc(vi.Buffer,e);let t=[],r=0;for(;r<e.length;){let n=e[r];if(n>on.OPS.OP_0&&n<=on.OPS.OP_PUSHDATA4){let i=Eh.decode(e,r);if(i===null||(r+=i.size,r+i.number>e.length))return null;let s=e.slice(r,r+i.number);r+=i.number;let o=bf(s);o!==void 0?t.push(o):t.push(s)}else t.push(n),r+=1}return t}Pe.decompile=Ih;function Kx(e){return Q1(e)&&(e=Ih(e)),e.map(t=>{if(gf(t)){let r=bf(t);if(r===void 0)return t.toString("hex");t=r}return on.REVERSE_OPS[t]}).join(" ")}Pe.toASM=Kx;function Dx(e){return Oc(vi.String,e),em(e.split(" ").map(t=>on.OPS[t]!==void 0?on.OPS[t]:(Oc(vi.Hex,t),h.Buffer.from(t,"hex"))))}Pe.fromASM=Dx;function jx(e){return e=Ih(e),Oc(J1,e),e.map(t=>gf(t)?t:t===on.OPS.OP_0?h.Buffer.allocUnsafe(0):$1.encode(t-Z1))}Pe.toStack=jx;function Fx(e){return vi.isPoint(e)}Pe.isCanonicalPubKey=Fx;function tm(e){let t=e;return t&128&&(t=t&-129),t&64&&(t=t&-65),t>0&&t<4}Pe.isDefinedHashType=tm;function Vx(e){return!h.Buffer.isBuffer(e)||!tm(e[e.length-1])?!1:Nx.check(e.slice(0,-1))}Pe.isCanonicalScriptSignature=Vx;Pe.number=$1;Pe.signature=Ux});var rs=H(Sa=>{v();w();Object.defineProperty(Sa,"__esModule",{value:!0});Sa.value=Sa.prop=void 0;function Gx(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){let n=r.call(this);return this[t]=n,n},set(n){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:n,writable:!0})}})}Sa.prop=Gx;function Wx(e){let t;return()=>(t!==void 0||(t=e()),t)}Sa.value=Wx});var sm=H(wi=>{v();w();var zx=wi&&wi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Xx=wi&&wi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),im=wi&&wi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&zx(t,e,r);return Xx(t,e),t};Object.defineProperty(wi,"__esModule",{value:!0});wi.p2data=void 0;var Yx=vn(),yf=im(Xt()),ns=qr(),rm=im(rs()),nm=yf.OPS;function $x(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Zx(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,ns.typeforce)({network:ns.typeforce.maybe(ns.typeforce.Object),output:ns.typeforce.maybe(ns.typeforce.Buffer),data:ns.typeforce.maybe(ns.typeforce.arrayOf(ns.typeforce.Buffer))},e);let n={name:"embed",network:e.network||Yx.bitcoin};if(rm.prop(n,"output",()=>{if(!!e.data)return yf.compile([nm.OP_RETURN].concat(e.data))}),rm.prop(n,"data",()=>{if(!!e.output)return yf.decompile(e.output).slice(1)}),t.validate&&e.output){let i=yf.decompile(e.output);if(i[0]!==nm.OP_RETURN)throw new TypeError("Output is invalid");if(!i.slice(1).every(ns.typeforce.Buffer))throw new TypeError("Output is invalid");if(e.data&&!$x(e.data,n.data))throw new TypeError("Data mismatch")}return Object.assign(n,e)}wi.p2data=Zx});var cm=H(Si=>{v();w();var Jx=Si&&Si.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Qx=Si&&Si.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),am=Si&&Si.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Jx(t,e,r);return Qx(t,e),t};Object.defineProperty(Si,"__esModule",{value:!0});Si.p2ms=void 0;var eT=vn(),xa=am(Xt()),nr=qr(),Ls=am(rs()),Ta=xa.OPS,mf=Ta.OP_RESERVED;function om(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function tT(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==void 0)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{});function r(c){return xa.isCanonicalScriptSignature(c)||(t.allowIncomplete&&c===Ta.OP_0)!==void 0}(0,nr.typeforce)({network:nr.typeforce.maybe(nr.typeforce.Object),m:nr.typeforce.maybe(nr.typeforce.Number),n:nr.typeforce.maybe(nr.typeforce.Number),output:nr.typeforce.maybe(nr.typeforce.Buffer),pubkeys:nr.typeforce.maybe(nr.typeforce.arrayOf(nr.isPoint)),signatures:nr.typeforce.maybe(nr.typeforce.arrayOf(r)),input:nr.typeforce.maybe(nr.typeforce.Buffer)},e);let i={network:e.network||eT.bitcoin},s=[],o=!1;function a(c){o||(o=!0,s=xa.decompile(c),i.m=s[0]-mf,i.n=s[s.length-2]-mf,i.pubkeys=s.slice(1,-2))}if(Ls.prop(i,"output",()=>{if(!!e.m&&!!i.n&&!!e.pubkeys)return xa.compile([].concat(mf+e.m,e.pubkeys,mf+i.n,Ta.OP_CHECKMULTISIG))}),Ls.prop(i,"m",()=>{if(!!i.output)return a(i.output),i.m}),Ls.prop(i,"n",()=>{if(!!i.pubkeys)return i.pubkeys.length}),Ls.prop(i,"pubkeys",()=>{if(!!e.output)return a(e.output),i.pubkeys}),Ls.prop(i,"signatures",()=>{if(!!e.input)return xa.decompile(e.input).slice(1)}),Ls.prop(i,"input",()=>{if(!!e.signatures)return xa.compile([Ta.OP_0].concat(e.signatures))}),Ls.prop(i,"witness",()=>{if(!!i.input)return[]}),Ls.prop(i,"name",()=>{if(!(!i.m||!i.n))return`p2ms(${i.m} of ${i.n})`}),t.validate){if(e.output){if(a(e.output),!nr.typeforce.Number(s[0]))throw new TypeError("Output is invalid");if(!nr.typeforce.Number(s[s.length-2]))throw new TypeError("Output is invalid");if(s[s.length-1]!==Ta.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(i.m<=0||i.n>16||i.m>i.n||i.n!==s.length-3)throw new TypeError("Output is invalid");if(!i.pubkeys.every(c=>(0,nr.isPoint)(c)))throw new TypeError("Output is invalid");if(e.m!==void 0&&e.m!==i.m)throw new TypeError("m mismatch");if(e.n!==void 0&&e.n!==i.n)throw new TypeError("n mismatch");if(e.pubkeys&&!om(e.pubkeys,i.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==void 0&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(i.n=e.pubkeys.length,i.n<i.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<i.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>i.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==Ta.OP_0)throw new TypeError("Input is invalid");if(i.signatures.length===0||!i.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!om(e.signatures,i.signatures))throw new TypeError("Signature mismatch");if(e.m!==void 0&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(i,e)}Si.p2ms=tT});var dm=H(xi=>{v();w();var rT=xi&&xi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),nT=xi&&xi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),fm=xi&&xi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&rT(t,e,r);return nT(t,e),t};Object.defineProperty(xi,"__esModule",{value:!0});xi.p2pk=void 0;var iT=vn(),Ea=fm(Xt()),ui=qr(),Pa=fm(rs()),um=Ea.OPS;function sT(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,ui.typeforce)({network:ui.typeforce.maybe(ui.typeforce.Object),output:ui.typeforce.maybe(ui.typeforce.Buffer),pubkey:ui.typeforce.maybe(ui.isPoint),signature:ui.typeforce.maybe(Ea.isCanonicalScriptSignature),input:ui.typeforce.maybe(ui.typeforce.Buffer)},e);let r=Pa.value(()=>Ea.decompile(e.input)),i={name:"p2pk",network:e.network||iT.bitcoin};if(Pa.prop(i,"output",()=>{if(!!e.pubkey)return Ea.compile([e.pubkey,um.OP_CHECKSIG])}),Pa.prop(i,"pubkey",()=>{if(!!e.output)return e.output.slice(1,-1)}),Pa.prop(i,"signature",()=>{if(!!e.input)return r()[0]}),Pa.prop(i,"input",()=>{if(!!e.signature)return Ea.compile([e.signature])}),Pa.prop(i,"witness",()=>{if(!!i.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==um.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!(0,ui.isPoint)(i.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(i.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(i.input))throw new TypeError("Signature mismatch");if(e.input){if(r().length!==1)throw new TypeError("Input is invalid");if(!Ea.isCanonicalScriptSignature(i.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(i,e)}xi.p2pk=sT});var Ir=H(Cn=>{v();w();Object.defineProperty(Cn,"__esModule",{value:!0});Cn.taggedHash=Cn.hash256=Cn.hash160=Cn.sha256=Cn.ripemd160=void 0;var lm=ae();function hm(e){return h.Buffer.from(lm.base.ripemd160(e))}Cn.ripemd160=hm;function Ia(e){return h.Buffer.from(lm.base.sha256(e))}Cn.sha256=Ia;function oT(e){return hm(Ia(e))}Cn.hash160=oT;function aT(e){return Ia(Ia(e))}Cn.hash256=aT;var cT=["BIP0340/challenge","BIP0340/aux","BIP0340/nonce","TapLeaf","TapBranch","TapSighash","TapTweak","KeyAgg list","KeyAgg coefficient"],uT=Object.fromEntries(cT.map(e=>{let t=Ia(h.Buffer.from(e));return[e,h.Buffer.concat([t,t])]}));function fT(e,t){return Ia(h.Buffer.concat([uT[e],t]))}Cn.taggedHash=fT});var bm=H(Ti=>{v();w();var dT=Ti&&Ti.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),lT=Ti&&Ti.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Oh=Ti&&Ti.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&dT(t,e,r);return lT(t,e),t};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.p2pkh=void 0;var Ah=Oh(Ir()),hT=vn(),Aa=Oh(Xt()),zr=qr(),is=Oh(rs()),Ks=Aa.OPS,pm=ae();function pT(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,zr.typeforce)({network:zr.typeforce.maybe(zr.typeforce.Object),address:zr.typeforce.maybe(zr.typeforce.String),hash:zr.typeforce.maybe(zr.typeforce.BufferN(20)),output:zr.typeforce.maybe(zr.typeforce.BufferN(25)),pubkey:zr.typeforce.maybe(zr.isPoint),signature:zr.typeforce.maybe(Aa.isCanonicalScriptSignature),input:zr.typeforce.maybe(zr.typeforce.Buffer)},e);let r=is.value(()=>{let o=pm.base.fromBase58Check(e.address),a=o.readUInt8(0),c=o.slice(1);return{version:a,hash:c}}),n=is.value(()=>Aa.decompile(e.input)),i=e.network||hT.bitcoin,s={name:"p2pkh",network:i};if(is.prop(s,"address",()=>{if(!s.hash)return;let o=h.Buffer.allocUnsafe(21);return o.writeUInt8(i.pubKeyHash,0),s.hash.copy(o,1),pm.base.toBase58Check(o)}),is.prop(s,"hash",()=>{if(e.output)return e.output.slice(3,23);if(e.address)return r().hash;if(e.pubkey||s.pubkey)return Ah.hash160(e.pubkey||s.pubkey)}),is.prop(s,"output",()=>{if(!!s.hash)return Aa.compile([Ks.OP_DUP,Ks.OP_HASH160,s.hash,Ks.OP_EQUALVERIFY,Ks.OP_CHECKSIG])}),is.prop(s,"pubkey",()=>{if(!!e.input)return n()[1]}),is.prop(s,"signature",()=>{if(!!e.input)return n()[0]}),is.prop(s,"input",()=>{if(!!e.pubkey&&!!e.signature)return Aa.compile([e.signature,e.pubkey])}),is.prop(s,"witness",()=>{if(!!s.input)return[]}),t.validate){let o=h.Buffer.from([]);if(e.address){if(r().version!==i.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(r().hash.length!==20)throw new TypeError("Invalid address");o=r().hash}if(e.hash){if(o.length>0&&!o.equals(e.hash))throw new TypeError("Hash mismatch");o=e.hash}if(e.output){if(e.output.length!==25||e.output[0]!==Ks.OP_DUP||e.output[1]!==Ks.OP_HASH160||e.output[2]!==20||e.output[23]!==Ks.OP_EQUALVERIFY||e.output[24]!==Ks.OP_CHECKSIG)throw new TypeError("Output is invalid");let a=e.output.slice(3,23);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.pubkey){let a=Ah.hash160(e.pubkey);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.input){let a=n();if(a.length!==2)throw new TypeError("Input is invalid");if(!Aa.isCanonicalScriptSignature(a[0]))throw new TypeError("Input has invalid signature");if(!(0,zr.isPoint)(a[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(a[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(a[1]))throw new TypeError("Pubkey mismatch");let c=Ah.hash160(a[1]);if(o.length>0&&!o.equals(c))throw new TypeError("Hash mismatch")}}return Object.assign(s,e)}Ti.p2pkh=pT});var mm=H(Ei=>{v();w();var bT=Ei&&Ei.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),gT=Ei&&Ei.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Bh=Ei&&Ei.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&bT(t,e,r);return gT(t,e),t};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.p2sh=void 0;var gm=Bh(Ir()),yT=vn(),ss=Bh(Xt()),Ze=qr(),Pi=Bh(rs()),ym=ae(),_f=ss.OPS;function mT(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function _T(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Ze.typeforce)({network:Ze.typeforce.maybe(Ze.typeforce.Object),address:Ze.typeforce.maybe(Ze.typeforce.String),hash:Ze.typeforce.maybe(Ze.typeforce.BufferN(20)),output:Ze.typeforce.maybe(Ze.typeforce.BufferN(23)),redeem:Ze.typeforce.maybe({network:Ze.typeforce.maybe(Ze.typeforce.Object),output:Ze.typeforce.maybe(Ze.typeforce.Buffer),input:Ze.typeforce.maybe(Ze.typeforce.Buffer),witness:Ze.typeforce.maybe(Ze.typeforce.arrayOf(Ze.typeforce.Buffer))}),input:Ze.typeforce.maybe(Ze.typeforce.Buffer),witness:Ze.typeforce.maybe(Ze.typeforce.arrayOf(Ze.typeforce.Buffer))},e);let r=e.network;r||(r=e.redeem&&e.redeem.network||yT.bitcoin);let n={network:r},i=Pi.value(()=>{let a=ym.base.fromBase58Check(e.address),c=a.readUInt8(0),u=a.slice(1);return{version:c,hash:u}}),s=Pi.value(()=>ss.decompile(e.input)),o=Pi.value(()=>{let a=s();return{network:r,output:a[a.length-1],input:ss.compile(a.slice(0,-1)),witness:e.witness||[]}});if(Pi.prop(n,"address",()=>{if(!n.hash)return;let a=h.Buffer.allocUnsafe(21);return a.writeUInt8(n.network.scriptHash,0),n.hash.copy(a,1),ym.base.toBase58Check(a)}),Pi.prop(n,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return i().hash;if(n.redeem&&n.redeem.output)return gm.hash160(n.redeem.output)}),Pi.prop(n,"output",()=>{if(!!n.hash)return ss.compile([_f.OP_HASH160,n.hash,_f.OP_EQUAL])}),Pi.prop(n,"redeem",()=>{if(!!e.input)return o()}),Pi.prop(n,"input",()=>{if(!(!e.redeem||!e.redeem.input||!e.redeem.output))return ss.compile([].concat(ss.decompile(e.redeem.input),e.redeem.output))}),Pi.prop(n,"witness",()=>{if(n.redeem&&n.redeem.witness)return n.redeem.witness;if(n.input)return[]}),Pi.prop(n,"name",()=>{let a=["p2sh"];return n.redeem!==void 0&&n.redeem.name!==void 0&&a.push(n.redeem.name),a.join("-")}),t.validate){let a=h.Buffer.from([]);if(e.address){if(i().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(i().hash.length!==20)throw new TypeError("Invalid address");a=i().hash}if(e.hash){if(a.length>0&&!a.equals(e.hash))throw new TypeError("Hash mismatch");a=e.hash}if(e.output){if(e.output.length!==23||e.output[0]!==_f.OP_HASH160||e.output[1]!==20||e.output[22]!==_f.OP_EQUAL)throw new TypeError("Output is invalid");let u=e.output.slice(2,22);if(a.length>0&&!a.equals(u))throw new TypeError("Hash mismatch");a=u}let c=u=>{if(u.output){let d=ss.decompile(u.output);if(!d||d.length<1)throw new TypeError("Redeem.output too short");let f=gm.hash160(u.output);if(a.length>0&&!a.equals(f))throw new TypeError("Hash mismatch");a=f}if(u.input){let d=u.input.length>0,f=u.witness&&u.witness.length>0;if(!d&&!f)throw new TypeError("Empty input");if(d&&f)throw new TypeError("Input and witness provided");if(d){let p=ss.decompile(u.input);if(!ss.isPushOnly(p))throw new TypeError("Non push-only scriptSig")}}};if(e.input){let u=s();if(!u||u.length<1)throw new TypeError("Input too short");if(!h.Buffer.isBuffer(o().output))throw new TypeError("Input is invalid");c(o())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw new TypeError("Network mismatch");if(e.input){let u=o();if(e.redeem.output&&!e.redeem.output.equals(u.output))throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(u.input))throw new TypeError("Redeem.input mismatch")}c(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!mT(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(n,e)}Ei.p2sh=_T});var vm=H(Ii=>{v();w();var vT=Ii&&Ii.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),wT=Ii&&Ii.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ch=Ii&&Ii.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&vT(t,e,r);return wT(t,e),t};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.p2wpkh=void 0;var Mh=Ch(Ir()),ST=vn(),wf=Ch(Xt()),ir=qr(),Ds=Ch(rs()),vf=ae(),_m=wf.OPS,xT=h.Buffer.alloc(0);function TT(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,ir.typeforce)({address:ir.typeforce.maybe(ir.typeforce.String),hash:ir.typeforce.maybe(ir.typeforce.BufferN(20)),input:ir.typeforce.maybe(ir.typeforce.BufferN(0)),network:ir.typeforce.maybe(ir.typeforce.Object),output:ir.typeforce.maybe(ir.typeforce.BufferN(22)),pubkey:ir.typeforce.maybe(ir.isPoint),signature:ir.typeforce.maybe(wf.isCanonicalScriptSignature),witness:ir.typeforce.maybe(ir.typeforce.arrayOf(ir.typeforce.Buffer))},e);let r=Ds.value(()=>{let s=vf.base.bech32.decode(e.address),o=s.words.shift(),a=vf.base.bech32.fromWords(s.words);return{version:o,prefix:s.prefix,data:h.Buffer.from(a)}}),n=e.network||ST.bitcoin,i={name:"p2wpkh",network:n};if(Ds.prop(i,"address",()=>{if(!i.hash)return;let s=vf.base.bech32.toWords(i.hash);return s.unshift(0),vf.base.bech32.encode(n.bech32,s)}),Ds.prop(i,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return r().data;if(e.pubkey||i.pubkey)return Mh.hash160(e.pubkey||i.pubkey)}),Ds.prop(i,"output",()=>{if(!!i.hash)return wf.compile([_m.OP_0,i.hash])}),Ds.prop(i,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(!!e.witness)return e.witness[1]}),Ds.prop(i,"signature",()=>{if(!!e.witness)return e.witness[0]}),Ds.prop(i,"input",()=>{if(!!i.witness)return xT}),Ds.prop(i,"witness",()=>{if(!!e.pubkey&&!!e.signature)return[e.signature,e.pubkey]}),t.validate){let s=h.Buffer.from([]);if(e.address){if(n&&n.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==20)throw new TypeError("Invalid address data");s=r().data}if(e.hash){if(s.length>0&&!s.equals(e.hash))throw new TypeError("Hash mismatch");s=e.hash}if(e.output){if(e.output.length!==22||e.output[0]!==_m.OP_0||e.output[1]!==20)throw new TypeError("Output is invalid");if(s.length>0&&!s.equals(e.output.slice(2)))throw new TypeError("Hash mismatch");s=e.output.slice(2)}if(e.pubkey){let o=Mh.hash160(e.pubkey);if(s.length>0&&!s.equals(o))throw new TypeError("Hash mismatch");if(s=o,!(0,ir.isPoint)(e.pubkey)||e.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(e.witness.length!==2)throw new TypeError("Witness is invalid");if(!wf.isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!(0,ir.isPoint)(e.witness[1])||e.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw new TypeError("Pubkey mismatch");let o=Mh.hash160(e.witness[1]);if(s.length>0&&!s.equals(o))throw new TypeError("Hash mismatch")}}return Object.assign(i,e)}Ii.p2wpkh=TT});var xm=H(Ai=>{v();w();var PT=Ai&&Ai.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ET=Ai&&Ai.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Hh=Ai&&Ai.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&PT(t,e,r);return ET(t,e),t};Object.defineProperty(Ai,"__esModule",{value:!0});Ai.p2wsh=void 0;var wm=Hh(Ir()),IT=vn(),js=Hh(Xt()),ze=qr(),os=Hh(rs()),Sf=ae(),Sm=js.OPS,kh=h.Buffer.alloc(0);function AT(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function xf(e){return!!(h.Buffer.isBuffer(e)&&e.length===65&&e[0]===4&&(0,ze.isPoint)(e))}function OT(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,ze.typeforce)({network:ze.typeforce.maybe(ze.typeforce.Object),address:ze.typeforce.maybe(ze.typeforce.String),hash:ze.typeforce.maybe(ze.typeforce.BufferN(32)),output:ze.typeforce.maybe(ze.typeforce.BufferN(34)),redeem:ze.typeforce.maybe({input:ze.typeforce.maybe(ze.typeforce.Buffer),network:ze.typeforce.maybe(ze.typeforce.Object),output:ze.typeforce.maybe(ze.typeforce.Buffer),witness:ze.typeforce.maybe(ze.typeforce.arrayOf(ze.typeforce.Buffer))}),input:ze.typeforce.maybe(ze.typeforce.BufferN(0)),witness:ze.typeforce.maybe(ze.typeforce.arrayOf(ze.typeforce.Buffer))},e);let r=os.value(()=>{let o=Sf.base.bech32.decode(e.address),a=o.words.shift(),c=Sf.base.bech32.fromWords(o.words);return{version:a,prefix:o.prefix,data:h.Buffer.from(c)}}),n=os.value(()=>js.decompile(e.redeem.input)),i=e.network;i||(i=e.redeem&&e.redeem.network||IT.bitcoin);let s={network:i};if(os.prop(s,"address",()=>{if(!s.hash)return;let o=Sf.base.bech32.toWords(s.hash);return o.unshift(0),Sf.base.bech32.encode(i.bech32,o)}),os.prop(s,"hash",()=>{if(e.output)return e.output.slice(2);if(e.address)return r().data;if(s.redeem&&s.redeem.output)return wm.sha256(s.redeem.output)}),os.prop(s,"output",()=>{if(!!s.hash)return js.compile([Sm.OP_0,s.hash])}),os.prop(s,"redeem",()=>{if(!!e.witness)return{output:e.witness[e.witness.length-1],input:kh,witness:e.witness.slice(0,-1)}}),os.prop(s,"input",()=>{if(!!s.witness)return kh}),os.prop(s,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){let o=js.toStack(n());return s.redeem=Object.assign({witness:o},e.redeem),s.redeem.input=kh,[].concat(o,e.redeem.output)}if(!!e.redeem&&!!e.redeem.output&&!!e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),os.prop(s,"name",()=>{let o=["p2wsh"];return s.redeem!==void 0&&s.redeem.name!==void 0&&o.push(s.redeem.name),o.join("-")}),t.validate){let o=h.Buffer.from([]);if(e.address){if(r().prefix!==i.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");o=r().data}if(e.hash){if(o.length>0&&!o.equals(e.hash))throw new TypeError("Hash mismatch");o=e.hash}if(e.output){if(e.output.length!==34||e.output[0]!==Sm.OP_0||e.output[1]!==32)throw new TypeError("Output is invalid");let a=e.output.slice(2);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.redeem){if(e.redeem.network&&e.redeem.network!==i)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){if(js.decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");let a=wm.sha256(e.redeem.output);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.redeem.input&&!js.isPushOnly(n()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!AT(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&n().some(xf)||e.redeem.output&&(js.decompile(e.redeem.output)||[]).some(xf))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){let a=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(a))throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(xf)||(js.decompile(a)||[]).some(xf))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(s,e)}Ai.p2wsh=OT});var Em=H((Nh,Pm)=>{v();w();var Tf=tc(),Oi=Tf.Buffer;function Tm(e,t){for(var r in e)t[r]=e[r]}Oi.from&&Oi.alloc&&Oi.allocUnsafe&&Oi.allocUnsafeSlow?Pm.exports=Tf:(Tm(Tf,Nh),Nh.Buffer=Po);function Po(e,t,r){return Oi(e,t,r)}Po.prototype=Object.create(Oi.prototype);Tm(Oi,Po);Po.from=function(e,t,r){if(typeof e=="number")throw new TypeError("Argument must not be a number");return Oi(e,t,r)};Po.alloc=function(e,t,r){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=Oi(e);return t!==void 0?typeof r=="string"?n.fill(t,r):n.fill(t):n.fill(0),n};Po.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Oi(e)};Po.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Tf.SlowBuffer(e)}});var qh=H((yU,Am)=>{v();w();var Uh=Em().Buffer,BT=9007199254740991;function Rh(e){if(e<0||e>BT||e%1!==0)throw new RangeError("value out of range")}function Mc(e,t,r){if(Rh(e),t||(t=Uh.allocUnsafe(Im(e))),!Uh.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),Mc.bytes=1):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),Mc.bytes=3):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),Mc.bytes=5):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),Mc.bytes=9),t}function Cc(e,t){if(!Uh.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);var r=e.readUInt8(t);if(r<253)return Cc.bytes=1,r;if(r===253)return Cc.bytes=3,e.readUInt16LE(t+1);if(r===254)return Cc.bytes=5,e.readUInt32LE(t+1);Cc.bytes=9;var n=e.readUInt32LE(t+1),i=e.readUInt32LE(t+5),s=i*4294967296+n;return Rh(s),s}function Im(e){return Rh(e),e<253?1:e<=65535?3:e<=4294967295?5:9}Am.exports={encode:Mc,decode:Cc,encodingLength:Im}});var Fs=H(ft=>{v();w();var MT=ft&&ft.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),CT=ft&&ft.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Om=ft&&ft.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&MT(t,e,r);return CT(t,e),t};Object.defineProperty(ft,"__esModule",{value:!0});ft.BufferReader=ft.BufferWriter=ft.cloneBuffer=ft.reverseBuffer=ft.writeUInt64LE=ft.readUInt64LE=ft.varuint=void 0;var Eo=Om(qr()),{typeforce:Bm}=Eo,kc=Om(qh());ft.varuint=kc;function Mm(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function Cm(e,t){let r=e.readUInt32LE(t),n=e.readUInt32LE(t+4);return n*=4294967296,Mm(n+r,9007199254740991),n+r}ft.readUInt64LE=Cm;function km(e,t,r){return Mm(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}ft.writeUInt64LE=km;function kT(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}ft.reverseBuffer=kT;function HT(e){let t=h.Buffer.allocUnsafe(e.length);return e.copy(t),t}ft.cloneBuffer=HT;var Hc=class{static withCapacity(t){return new Hc(h.Buffer.alloc(t))}constructor(t,r=0){this.buffer=t,this.offset=r,Bm(Eo.tuple(Eo.Buffer,Eo.UInt32),[t,r])}writeUInt8(t){this.offset=this.buffer.writeUInt8(t,this.offset)}writeInt32(t){this.offset=this.buffer.writeInt32LE(t,this.offset)}writeUInt32(t){this.offset=this.buffer.writeUInt32LE(t,this.offset)}writeUInt64(t){this.offset=km(this.buffer,t,this.offset)}writeVarInt(t){kc.encode(t,this.buffer,this.offset),this.offset+=kc.encode.bytes}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.offset+=t.copy(this.buffer,this.offset)}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(r=>this.writeVarSlice(r))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}};ft.BufferWriter=Hc;var Lh=class{constructor(t,r=0){this.buffer=t,this.offset=r,Bm(Eo.tuple(Eo.Buffer,Eo.UInt32),[t,r])}readUInt8(){let t=this.buffer.readUInt8(this.offset);return this.offset++,t}readInt32(){let t=this.buffer.readInt32LE(this.offset);return this.offset+=4,t}readUInt32(){let t=this.buffer.readUInt32LE(this.offset);return this.offset+=4,t}readUInt64(){let t=Cm(this.buffer,this.offset);return this.offset+=8,t}readVarInt(){let t=kc.decode(this.buffer,this.offset);return this.offset+=kc.decode.bytes,t}readSlice(t){if(this.buffer.length<this.offset+t)throw new Error("Cannot read slice out of bounds");let r=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,r}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){let t=this.readVarInt(),r=[];for(let n=0;n<t;n++)r.push(this.readVarSlice());return r}};ft.BufferReader=Lh});var jh=H(Bi=>{v();w();Object.defineProperty(Bi,"__esModule",{value:!0});Bi.encode=Bi.decode=Bi.encodeRaw=Bi.decodeRaw=void 0;var Kh=ae();function Hm(e,t){if(t!==void 0&&e[0]!==t)throw new Error("Invalid network version");if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}Bi.decodeRaw=Hm;function Dh(e,t,r){let n=h.Buffer.alloc(r?34:33);return n.writeUInt8(e,0),t.copy(n,1),r&&(n[33]=1),n}Bi.encodeRaw=Dh;function NT(e,t){return Hm(Kh.base.fromBase58Check(e),t)}Bi.decode=NT;function UT(e,t,r){return typeof e=="number"?Kh.base.toBase58Check(Dh(e,t,r)):Kh.base.toBase58Check(Dh(e.version,e.privateKey,e.compressed))}Bi.encode=UT});var Oa=H(an=>{v();w();var RT=an&&an.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qT=an&&an.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),LT=an&&an.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&RT(t,e,r);return qT(t,e),t};Object.defineProperty(an,"__esModule",{value:!0});an.countAdjustedVsize=an.convertScriptSigAsm=an.countScriptSigops=void 0;var KT=To(),DT=cn(),Nm=ae(),jT=LT(un());function Nc(e,t=!1,r=!1){if(!e?.length)return 0;let n=0;if(n+=e.match(/OP_CHECKSIG/g)?.length||0,t)n+=20*(e.match(/OP_CHECKMULTISIG/g)?.length||0);else{let i=e.matchAll(/(?:OP_(?:PUSHNUM_)?(\d+))? OP_CHECKMULTISIG/g);for(let s of i){let o=parseInt(s[1]);Number.isInteger(o)?n+=o:n+=20}}return r?n:n*4}an.countScriptSigops=Nc;function Uc(e){if(e?.length==0)return"";let t=[],r=0;for(;r<e.length;){let n=e[r];if(n>=1&&n<=78){r++;let i;n===76?(i=e.readUInt8(r),t.push("OP_PUSHDATA1"),r+=1):n===77?(i=e.readUInt16LE(r),t.push("OP_PUSHDATA2"),r+=2):n===78?(i=e.readUInt32LE(r),t.push("OP_PUSHDATA4"),r+=4):(i=n,t.push("OP_PUSHBYTES_"+i));let s=e.slice(r,r+i);if(s.length!==i)break;t.push(s.toString("hex")),r+=s.length}else{if(n===0)t.push("OP_0");else if(n===79)t.push("OP_PUSHNUM_NEG1");else if(n===177)t.push("OP_CLTV");else if(n===178)t.push("OP_CSV");else if(n===186)t.push("OP_CHECKSIGADD");else{let i=KT.REVERSE_OPS[n];i&&n<253?/^OP_(\d+)$/.test(i)?t.push(i.replace(/^OP_(\d+)$/,"OP_PUSHNUM_$1")):t.push(i):t.push("OP_RETURN_"+n)}r+=1}}return t.join(" ")}an.convertScriptSigAsm=Uc;function FT(e,t,r){if(e==null)return 0;r==null&&(r=jT.networks.bitcoin);let n=0;(t!=null||null)&&t.length==e.ins.length&&e.ins.forEach((s,o)=>{if(s.script!=null&&(n+=Nc(Uc(s.script),!0)),t.length<=o||t[o]==null||null||t[o]=="")return;let a=(0,DT.getAddressType)(t[o],r);switch(!0){case(a==="segwit_nested"&&s.witness?.length===2&&s.script&&Nm.base.toHex(s.script).startsWith("160014")):case a==="segwit_native":n+=1;break;case(a==="segwit_nested"&&s.witness?.length&&s.script&&Nm.base.toHex(s.script).startsWith("220020")):case a==="segwit_native":s.witness?.length&&(n+=Nc(Uc(s.witness[s.witness.length-1]),!1,!0));break;case a==="segwit_nested":s.script&&(n+=Nc(Uc(s.script)));break}});for(let s of e.outs)s&&(n+=Nc(Uc(s.script),!0));let i=e.virtualSize();return i>n*5?i:n*5}an.countAdjustedVsize=FT});var cn=H(ne=>{v();w();var VT=ne&&ne.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),GT=ne&&ne.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),qc=ne&&ne.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&VT(t,e,r);return GT(t,e),t};Object.defineProperty(ne,"__esModule",{value:!0});ne.fakeSign=ne.estimateBchFee=ne.estimateBtcFee=ne.ValidSignedTransaction=ne.getMPCTransaction=ne.calculateBchTxSize=ne.calculateTxSize=ne.signBch=ne.getAddressType=ne.signBtc=ne.TxBuild=ne.private2Wif=ne.wif2Public=ne.sign=ne.private2public=ne.privateKeyFromWIF=ne.Array=void 0;var pe=qc(un()),Rm=un(),Rc=sn(),X=ae(),qm=qc(jh()),Um=Ba(),Lm=qc(Ir()),Km=qc(Mi()),as=qc(Xt()),Vs=To(),WT=Oa(),Dm=Rc.signUtil.schnorr.secp256k1.schnorr;ne.Array=X.typeforce.Array;function Fh(e,t){let r=qm.decode(e),n=r.version;if((0,ne.Array)(t)){if(t=t.filter(i=>n===i.wif).pop(),!t)throw new Error("Unknown network version")}else if(t=t||pe.networks.bitcoin,n!==t.wif)throw new Error("Invalid network version");return X.base.toHex(r.privateKey)}ne.privateKeyFromWIF=Fh;function Vh(e){return Rc.signUtil.secp256k1.publicKeyCreate(X.base.fromHex(e),!0)}ne.private2public=Vh;function Pf(e,t){let{signature:r}=Rc.signUtil.secp256k1.sign(e,X.base.fromHex(t));return h.Buffer.from(r)}ne.sign=Pf;function zT(e,t){let r=Fh(e,t);return Vh(r)}ne.wif2Public=zT;function Lc(e,t){return t=t||pe.networks.bitcoin,qm.encode(t.wif,e,!0)}ne.private2Wif=Lc;var Io=class{constructor(t,r,n,i,s){this.tx=new pe.Transaction,this.network=pe.networks.bitcoin,t?this.tx.version=t:this.tx.version=2,r&&(this.network=r),this.inputs=[],this.outputs=[],this.bitcoinCash=n||!1,this.hardware=i||!1,this.fakeKey=s||!1}addInput(t,r,n,i,s,o,a,c){this.inputs.push({txId:t,index:r,privateKey:n,address:i,script:s,value:o,publicKey:a,sequence:c})}addOutput(t,r,n){this.outputs.push({address:t,value:r,omniScript:n})}build(t){let r=[];for(let n of this.inputs){let i=X.base.reverseBuffer(h.Buffer.from(n.txId,"hex"));this.tx.addInput(i,n.index,n.sequence),n.privateKey?r.push(Fh(n.privateKey,this.network)):r.push("")}for(let n of this.outputs)if(n.omniScript)this.tx.addOutput(X.base.fromHex(n.omniScript),0);else{let i=pe.address.toOutputScript(n.address,this.network);this.tx.addOutput(i,n.value)}if(this.hardware)return this.tx.toHex();for(let n=0;n<r.length;n++){let i=r[n],s;i?s=Vh(i):this.hardware||(s=X.base.fromHex(this.inputs[n].publicKey));let o,a=pe.Transaction.SIGHASH_ALL;if(this.bitcoinCash){let c=pe.payments.p2pkh({pubkey:s}).output;a=pe.Transaction.SIGHASH_ALL|pe.Transaction.SIGHASH_BITCOINCASHBIP143;let u=this.inputs[n].value||0;o=this.tx.hashForCashSignature(n,c,u,a);let d;t?(t.push(X.base.toHex(o)),d=h.Buffer.alloc(64,0)):d=Pf(o,i);let f=pe.payments.p2pkh({output:c,pubkey:s,signature:pe.script.signature.encode(d,a)});f.input&&(this.tx.ins[n].script=f.input)}else{let c=jm(this.inputs[n].address,this.network);if(this.fakeKey){let{witness:u,script:d}=Fm(c);u!==void 0&&(this.tx.ins[n].witness=u),d!==void 0&&(this.tx.ins[n].script=d);continue}if(c==="legacy"){let u=pe.payments.p2pkh({pubkey:s}).output;o=this.tx.hashForSignature(n,u,a);let d;t?(t.push(X.base.toHex(o)),d=h.Buffer.alloc(64,0)):d=Pf(o,i);let f=pe.payments.p2pkh({output:u,pubkey:s,signature:pe.script.signature.encode(d,a)});f.input&&(this.tx.ins[n].script=f.input)}else if(c==="segwit_taproot"){let u=this.inputs.map(p=>pe.address.toOutputScript(p.address,this.network)),d=this.inputs.map(p=>p.value);o=this.tx.hashForWitnessV1(n,u,d,pe.Transaction.SIGHASH_DEFAULT);let f;if(t)t.push(X.base.toHex(o)),f=h.Buffer.alloc(64,0);else{let p=Km.taprootTweakPrivKey(X.base.fromHex(i));f=h.Buffer.from(Dm.sign(o,p,X.base.randomBytes(32)))}this.tx.ins[n].witness=[h.Buffer.from(f)]}else{let u=Lm.hash160(s),d=h.Buffer.of(25,118,169,20,...u,136,172),f=this.inputs[n].value||0;o=this.tx.hashForWitness(n,d,f,a);let p;t?(t.push(X.base.toHex(o)),p=h.Buffer.alloc(64,0)):p=Pf(o,i),this.tx.ins[n].witness=[],this.tx.ins[n].witness.push(pe.script.signature.encode(p,a)),this.tx.ins[n].witness.push(s);let y=h.Buffer.of(22,0,20,...u);c!=="segwit_native"&&(this.tx.ins[n].script=y)}}}return this.tx.toHex()}virtualSize(){return(0,WT.countAdjustedVsize)(this.tx,this.inputs.map(t=>t.address),this.network||pe.networks.bitcoin)}};ne.TxBuild=Io;function XT(e,t,r,n,i,s){let o=e.inputs,a=e.outputs,c=e.address,u=e.feePerB||10,d=e.dustSize||546;if(r=r||pe.networks.bitcoin,e.memo&&(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):h.Buffer.from(X.base.toUtf8(e.memo))).length>80)throw new Error("data after op_return is  too long");let f=t;if(f||(f=Lc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),r)),s){let{inputAmount:I,outputAmount:k,virtualSize:C}=Ef(o,a,c,f,r,d,!1,e.memo,e.memoPos);return(I-k-Math.ceil(C*u)).toString()}let{inputAmount:p,outputAmount:y,virtualSize:m}=Ef(o,a,c,f,r,d,!1,e.memo,e.memoPos),_=p-y-Math.ceil(m*u),E=new Io(2,r,!1,i);for(let I=0;I<o.length;I++){let k=o[I],C=k.privateKey||t,R=k.address||c;E.addInput(k.txId,k.vOut,C,R,k.reedScript,k.amount,k.publicKey,k.sequence)}e.memo&&e.memoPos==0&&E.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):h.Buffer.from(X.base.toUtf8(e.memo))))));for(let I=0;I<a.length;I++){let k=a[I];E.addOutput(k.address,k.amount,k.omniScript),e.memo&&e.memoPos&&E.outputs.length==e.memoPos&&E.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):h.Buffer.from(X.base.toUtf8(e.memo))))))}return _>d&&(E.addOutput(c,_),e.memo&&e.memoPos&&E.outputs.length==e.memoPos&&E.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):h.Buffer.from(X.base.toUtf8(e.memo))))))),e.memo&&(e.memoPos==null||e.memoPos<0||e.memoPos>E.outputs.length)&&E.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):h.Buffer.from(X.base.toUtf8(e.memo)))))),E.build(n)}ne.signBtc=XT;function jm(e,t){let r,n;try{r=(0,Um.fromBase58Check)(e)}catch{}if(r){if(r.version===t.pubKeyHash)return"legacy";if(r.version===t.scriptHash)return"segwit_nested"}else{try{n=(0,Um.fromBech32)(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0)return"segwit_native";if(n.version===1)return"segwit_taproot"}}return"legacy"}ne.getAddressType=jm;function YT(e,t,r,n,i){let s=e.inputs,o=e.outputs,a=e.address,c=e.feePerB||10,u=e.dustSize||546;r=r||pe.networks.bitcoin;let d=t;d||(d=Lc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),r));let{inputAmount:f,outputAmount:p,virtualSize:y}=Gh(s,o,a,d,r,u),m=f-p-y*c,_=new Io(2,r,!0,i);for(let E=0;E<s.length;E++){let I=s[E];_.addInput(I.txId,I.vOut,t,a,void 0,I.amount,I.publicKey,I.sequence)}for(let E=0;E<o.length;E++){let I=o[E];_.addOutput(I.address,I.amount)}return m>u&&_.addOutput(a,m),_.build(n)}ne.signBch=YT;function Ef(e,t,r,n,i,s,o,a,c){let u=new Io(2,i,!1,o,!0),d=0;for(let m=0;m<e.length;m++){let _=e[m],E=_.privateKey||n,I=_.address||r;u.addInput(_.txId,_.vOut,E,I,_.reedScript,_.amount,_.publicKey,_.sequence),d=d+(_.amount||0)}a&&c==0&&u.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):h.Buffer.from(X.base.toUtf8(a))))));let f=0;for(let m=0;m<t.length;m++){let _=t[m];u.addOutput(_.address,_.amount,_.omniScript),f=f+_.amount,a&&c&&u.outputs.length==c&&u.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):h.Buffer.from(X.base.toUtf8(a))))))}d-f>s&&(u.addOutput(r,d-f),a&&c&&u.outputs.length==c&&u.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):h.Buffer.from(X.base.toUtf8(a))))))),a&&(c==null||c<0||c>u.outputs.length)&&u.addOutput("",0,X.base.toHex(as.compile([Vs.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):h.Buffer.from(X.base.toUtf8(a))))));let p=u.build(),y=u.virtualSize();return{inputAmount:d,outputAmount:f,virtualSize:y,txHex:p}}ne.calculateTxSize=Ef;function Gh(e,t,r,n,i,s,o){let a=new Io(2,i,!0,o),c=0;for(let p=0;p<e.length;p++){let y=e[p];a.addInput(y.txId,y.vOut,n,r,void 0,y.amount,y.publicKey,y.sequence),c=c+(y.amount||0)}let u=0;for(let p=0;p<t.length;p++){let y=t[p];a.addOutput(y.address,y.amount),u=u+y.amount}c-u>s&&a.addOutput(r,c-u);let d=a.build(),f=a.tx.virtualSize();return{inputAmount:c,outputAmount:u,virtualSize:f,txHex:d}}ne.calculateBchTxSize=Gh;function $T(e,t,r){let n=Rm.Transaction.fromBuffer(X.base.fromHex(e),!1);for(let i=0;i<n.ins.length;i++){let s=n.ins[i],o=X.base.fromHex(t[i]),a=pe.Transaction.SIGHASH_ALL;if(r){a=pe.Transaction.SIGHASH_ALL|pe.Transaction.SIGHASH_BITCOINCASHBIP143;let c=pe.payments.p2pkh({input:s.script}),u=pe.payments.p2pkh({pubkey:c.pubkey,signature:pe.script.signature.encode(o,a)});u.input&&(s.script=u.input)}else{let c;if(s.witness.length===2)c="segwit_native";else if(s.witness.length===1)c="segwit_taproot";else if(s.witness.length===0)c="legacy";else throw Error("unknown witness length");if(c==="legacy"){let u=pe.payments.p2pkh({input:s.script}),d=pe.payments.p2pkh({pubkey:u.pubkey,signature:pe.script.signature.encode(o,a)});d.input&&(s.script=d.input)}else c==="segwit_taproot"?s.witness=[o]:s.witness[0]=pe.script.signature.encode(o,a)}}return n.toHex()}ne.getMPCTransaction=$T;function ZT(e,t,r){let n=Rm.Transaction.fromBuffer(X.base.fromHex(e),!1);if(!t)return n;for(let i=0;i<n.ins.length;i++){let s=n.ins[i],o=t[i],a;if(s.witness.length===2)a="segwit_native";else if(s.witness.length===1)a="segwit_taproot";else if(s.witness.length===0)a="legacy";else throw Error("unknown witness length");if(a==="legacy"){let c=as.decompile(s.script),u=c[0],d=c[1],f=pe.script.signature.decode(u),p=pe.address.toOutputScript(o.address,r),y=n.hashForSignature(i,p,f.hashType);if(!Rc.signUtil.secp256k1.verifyWithNoRecovery(y,f.signature,d))throw Error("signature error")}else if(a==="segwit_native"){let c=s.witness[0],u=s.witness[1],d=pe.script.signature.decode(c),f=h.Buffer.of(25,118,169,20,...Lm.hash160(u),136,172),p=n.hashForWitness(i,f,o.value,d.hashType);if(!Rc.signUtil.secp256k1.verifyWithNoRecovery(p,d.signature,u))throw Error("signature error")}else{let c=s.witness[0],u=t.map(y=>pe.address.toOutputScript(y.address,r)),d=t.map(y=>y.value),f=n.hashForWitnessV1(i,u,d,pe.Transaction.SIGHASH_DEFAULT),p=Km.taprootTweakPubkey(X.base.fromHex(o.publicKey).slice(1))[0];if(!Dm.verify(X.base.toHex(c),X.base.toHex(f),X.base.toHex(p)))throw Error("signature error")}}for(let i of n.ins)i.hash=X.base.reverseBuffer(i.hash);return n}ne.ValidSignedTransaction=ZT;function JT(e,t){let r=e.inputs,n=e.outputs,i=e.feePerB||10,s=e.dustSize||546;t=t||pe.networks.bitcoin;let o=Lc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),t),{virtualSize:a}=Ef(r,n,e.address,o,t,s,!1,e.memo);return Math.ceil(a*i)}ne.estimateBtcFee=JT;function QT(e,t){let r=e.inputs,n=e.outputs,i=e.feePerB||10,s=e.dustSize||546;t=t||pe.networks.bitcoin;let o=Lc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),t),{virtualSize:a}=Gh(r,n,e.address,o,t,s);return a*i}ne.estimateBchFee=QT;function Fm(e){let t,r;return e==="segwit_taproot"?t=[h.Buffer.alloc(64)]:e==="legacy"?r=h.Buffer.alloc(107):(t=[h.Buffer.alloc(72),h.Buffer.alloc(33)],e==="segwit_nested"&&(r=h.Buffer.alloc(23))),{witness:t,script:r}}ne.fakeSign=Fm});var Mi=H(Gs=>{v();w();Object.defineProperty(Gs,"__esModule",{value:!0});Gs.taprootSignSighash=Gs.taprootTweakPubkey=Gs.taprootTweakPrivKey=void 0;var eP=sn(),Vm=ae(),tP=cn(),zh=eP.signUtil.schnorr.secp256k1,If=zh.schnorr,Gm=zh.secp256k1.ProjectivePoint,Wh=zh.secp256k1.CURVE.n;function Wm(e,t){let r=If.utils,n=r.taggedHash("TapTweak",e,t),i=r.bytesToNumberBE(n);if(i>=Wh)throw new Error("tweak higher than curve order");return i}function zm(e,t=new Uint8Array){let r=If.utils,n=r.bytesToNumberBE(e),i=Gm.fromPrivateKey(n),s=i.hasEvenY()?n:r.mod(-n,Wh),o=r.pointToBytes(i),a=Wm(o,t);return r.numberToBytesBE(r.mod(s+a,Wh),32)}Gs.taprootTweakPrivKey=zm;function rP(e,t){t||(t=new Uint8Array);let r=If.utils,n=Wm(e,t),s=r.lift_x(r.bytesToNumberBE(e)).add(Gm.fromPrivateKey(n)),o=s.hasEvenY()?0:1;return[r.pointToBytes(s),o]}Gs.taprootTweakPubkey=rP;function nP(e,t,r){let n=zm(Vm.base.fromHex((0,tP.privateKeyFromWIF)(e)));return t.map(s=>{let o=h.Buffer.from(If.sign(s,n,r));return Vm.base.toHex(o)})}Gs.taprootSignSighash=nP});var Af=H(Xe=>{v();w();var iP=Xe&&Xe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),sP=Xe&&Xe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),oP=Xe&&Xe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&iP(t,e,r);return sP(t,e),t};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.tweakKey=Xe.tapTweakHash=Xe.tapleafHash=Xe.findScriptPath=Xe.toHashTree=Xe.rootHashFromPath=Xe.MAX_TAPTREE_DEPTH=Xe.LEAF_VERSION_TAPSCRIPT=void 0;var Ws=tc(),Zh=oP(Ir()),Xm=Fs(),aP=qr(),cP=Mi();Xe.LEAF_VERSION_TAPSCRIPT=192;Xe.MAX_TAPTREE_DEPTH=128;var uP=e=>"left"in e&&"right"in e;function fP(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);let r=(e.length-33)/32,n=t;for(let i=0;i<r;i++){let s=e.slice(33+32*i,65+32*i);n.compare(s)<0?n=$h(n,s):n=$h(s,n)}return n}Xe.rootHashFromPath=fP;function Xh(e){if((0,aP.isTapleaf)(e))return{hash:Ym(e)};let t=[Xh(e[0]),Xh(e[1])];t.sort((i,s)=>i.hash.compare(s.hash));let[r,n]=t;return{hash:$h(r.hash,n.hash),left:r,right:n}}Xe.toHashTree=Xh;function Yh(e,t){if(uP(e)){let r=Yh(e.left,t);if(r!==void 0)return[...r,e.right.hash];let n=Yh(e.right,t);if(n!==void 0)return[...n,e.left.hash]}else if(e.hash.equals(t))return[]}Xe.findScriptPath=Yh;function Ym(e){let t=e.version||Xe.LEAF_VERSION_TAPSCRIPT;return Zh.taggedHash("TapLeaf",Ws.Buffer.concat([Ws.Buffer.from([t]),hP(e.output)]))}Xe.tapleafHash=Ym;function dP(e,t){return Zh.taggedHash("TapTweak",Ws.Buffer.concat(t?[e,t]:[e]))}Xe.tapTweakHash=dP;function lP(e,t){if(!Ws.Buffer.isBuffer(e)||e.length!==32||t&&t.length!==32)return null;let r=(0,cP.taprootTweakPubkey)(e,t);return{parity:r[1],x:Ws.Buffer.from(r[0])}}Xe.tweakKey=lP;function $h(e,t){return Zh.taggedHash("TapBranch",Ws.Buffer.concat([e,t]))}function hP(e){let t=Xm.varuint.encodingLength(e.length),r=Ws.Buffer.allocUnsafe(t);return Xm.varuint.encode(e.length,r),Ws.Buffer.concat([r,e])}});var Qm=H(Ci=>{v();w();var pP=Ci&&Ci.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),bP=Ci&&Ci.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Jm=Ci&&Ci.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&pP(t,e,r);return bP(t,e),t};Object.defineProperty(Ci,"__esModule",{value:!0});Ci.p2tr=void 0;var Of=tc(),gP=vn(),Jh=Jm(Xt()),we=qr(),fn=Af(),kn=Jm(rs()),Bf=ae(),$m=Jh.OPS,Zm=1,yP=80;function mP(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,we.typeforce)({address:we.typeforce.maybe(we.typeforce.String),input:we.typeforce.maybe(we.typeforce.BufferN(0)),network:we.typeforce.maybe(we.typeforce.Object),output:we.typeforce.maybe(we.typeforce.BufferN(34)),internalPubkey:we.typeforce.maybe(we.typeforce.BufferN(32)),hash:we.typeforce.maybe(we.typeforce.BufferN(32)),pubkey:we.typeforce.maybe(we.typeforce.BufferN(32)),witness:we.typeforce.maybe(we.typeforce.arrayOf(we.typeforce.Buffer)),scriptTree:we.typeforce.maybe(we.isTaptree),redeem:we.typeforce.maybe({output:we.typeforce.maybe(we.typeforce.Buffer),redeemVersion:we.typeforce.maybe(we.typeforce.Number),witness:we.typeforce.maybe(we.typeforce.arrayOf(we.typeforce.Buffer))}),redeemVersion:we.typeforce.maybe(we.typeforce.Number)},e);let r=kn.value(()=>{let a=Bf.base.bech32m.decode(e.address),c=a.words.shift(),u=Bf.base.bech32m.fromWords(a.words);return{version:c,prefix:a.prefix,data:Of.Buffer.from(u)}}),n=kn.value(()=>{if(!(!e.witness||!e.witness.length))return e.witness.length>=2&&e.witness[e.witness.length-1][0]===yP?e.witness.slice(0,-1):e.witness.slice()}),i=kn.value(()=>{if(e.scriptTree)return(0,fn.toHashTree)(e.scriptTree);if(e.hash)return{hash:e.hash}}),s=e.network||gP.bitcoin,o={name:"p2tr",network:s};if(kn.prop(o,"address",()=>{if(!o.pubkey)return;let a=Bf.base.bech32m.toWords(o.pubkey);return a.unshift(Zm),Bf.base.bech32m.encode(s.bech32,a)}),kn.prop(o,"hash",()=>{let a=i();if(a)return a.hash;let c=n();if(c&&c.length>1){let u=c[c.length-1],d=u[0]&we.TAPLEAF_VERSION_MASK,f=c[c.length-2],p=(0,fn.tapleafHash)({output:f,version:d});return(0,fn.rootHashFromPath)(u,p)}return null}),kn.prop(o,"output",()=>{if(!!o.pubkey)return Jh.compile([$m.OP_1,o.pubkey])}),kn.prop(o,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&e.redeem.redeemVersion!==void 0&&e.redeem.redeemVersion!==null?e.redeem.redeemVersion:fn.LEAF_VERSION_TAPSCRIPT),kn.prop(o,"redeem",()=>{let a=n();if(!(!a||a.length<2))return{output:a[a.length-2],witness:a.slice(0,-2),redeemVersion:a[a.length-1][0]&we.TAPLEAF_VERSION_MASK}}),kn.prop(o,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return r().data;if(o.internalPubkey){let a=(0,fn.tweakKey)(o.internalPubkey,o.hash);if(a)return a.x}}),kn.prop(o,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;let a=n();if(a&&a.length>1)return a[a.length-1].slice(1,33)}),kn.prop(o,"signature",()=>{if(e.signature)return e.signature;let a=n();if(!(!a||a.length!==1))return a[0]}),kn.prop(o,"witness",()=>{if(e.witness)return e.witness;let a=i();if(a&&e.redeem&&e.redeem.output&&e.internalPubkey){let c=(0,fn.tapleafHash)({output:e.redeem.output,version:o.redeemVersion}),u=(0,fn.findScriptPath)(a,c);if(!u)return;let d=(0,fn.tweakKey)(e.internalPubkey,a.hash);if(!d)return;let f=Of.Buffer.concat([Of.Buffer.from([o.redeemVersion|d.parity]),e.internalPubkey].concat(u));return[e.redeem.output,f]}if(e.signature)return[e.signature]}),t.validate){let a=Of.Buffer.from([]);if(e.address){if(s&&s.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==Zm)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");a=r().data}if(e.pubkey){if(a.length>0&&!a.equals(e.pubkey))throw new TypeError("Pubkey mismatch");a=e.pubkey}if(e.output){if(e.output.length!==34||e.output[0]!==$m.OP_1||e.output[1]!==32)throw new TypeError("Output is invalid");if(a.length>0&&!a.equals(e.output.slice(2)))throw new TypeError("Pubkey mismatch");a=e.output.slice(2)}if(e.internalPubkey){let d=(0,fn.tweakKey)(e.internalPubkey,o.hash);if(a.length>0&&!a.equals(d.x))throw new TypeError("Pubkey mismatch");a=d.x}if(a&&a.length&&a.length!==32)throw new TypeError("Invalid pubkey for p2tr");let c=i();if(e.hash&&c&&!e.hash.equals(c.hash))throw new TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&c){let d=(0,fn.tapleafHash)({output:e.redeem.output,version:o.redeemVersion});if(!(0,fn.findScriptPath)(c,d))throw new TypeError("Redeem script not in tree")}let u=n();if(e.redeem&&o.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==o.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(Jh.decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(o.redeem.output&&!e.redeem.output.equals(o.redeem.output))throw new TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&o.redeem.witness&&!_P(e.redeem.witness,o.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(u&&u.length)if(u.length===1){if(e.signature&&!e.signature.equals(u[0]))throw new TypeError("Signature mismatch")}else{let d=u[u.length-1];if(d.length<33)throw new TypeError(`The control-block length is too small. Got ${d.length}, expected min 33.`);if((d.length-33)%32!==0)throw new TypeError(`The control-block length of ${d.length} is incorrect!`);let f=(d.length-33)/32;if(f>128)throw new TypeError(`The script path is too long. Got ${f}, expected max 128.`);let p=d.slice(1,33);if(e.internalPubkey&&!e.internalPubkey.equals(p))throw new TypeError("Internal pubkey mismatch");if(p.length!==32)throw new TypeError("Invalid internalPubkey for p2tr witness");let y=d[0]&we.TAPLEAF_VERSION_MASK,m=u[u.length-2],_=(0,fn.tapleafHash)({output:m,version:y}),E=(0,fn.rootHashFromPath)(d,_),I=(0,fn.tweakKey)(p,E);if(!I)throw new TypeError("Invalid outputKey for p2tr witness");if(a.length&&!a.equals(I.x))throw new TypeError("Pubkey mismatch for p2tr witness");if(I.parity!==(d[0]&1))throw new Error("Incorrect parity")}}return Object.assign(o,e)}Ci.p2tr=mP;function _P(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}});var zs=H(br=>{v();w();Object.defineProperty(br,"__esModule",{value:!0});br.p2tr=br.p2wsh=br.p2wpkh=br.p2sh=br.p2pkh=br.p2pk=br.p2ms=br.embed=void 0;var vP=sm();Object.defineProperty(br,"embed",{enumerable:!0,get:function(){return vP.p2data}});var wP=cm();Object.defineProperty(br,"p2ms",{enumerable:!0,get:function(){return wP.p2ms}});var SP=dm();Object.defineProperty(br,"p2pk",{enumerable:!0,get:function(){return SP.p2pk}});var xP=bm();Object.defineProperty(br,"p2pkh",{enumerable:!0,get:function(){return xP.p2pkh}});var TP=mm();Object.defineProperty(br,"p2sh",{enumerable:!0,get:function(){return TP.p2sh}});var PP=vm();Object.defineProperty(br,"p2wpkh",{enumerable:!0,get:function(){return PP.p2wpkh}});var EP=xm();Object.defineProperty(br,"p2wsh",{enumerable:!0,get:function(){return EP.p2wsh}});var IP=Qm();Object.defineProperty(br,"p2tr",{enumerable:!0,get:function(){return IP.p2tr}})});var Ba=H(Yt=>{v();w();var AP=Yt&&Yt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),OP=Yt&&Yt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Cf=Yt&&Yt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&AP(t,e,r);return OP(t,e),t};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.toOutputScript=Yt.fromOutputScript=Yt.toBech32=Yt.toBase58Check=Yt.fromBech32=Yt.fromBase58Check=void 0;var e2=Cf(vn()),ki=Cf(zs()),t2=Cf(Xt()),Mf=Cf(qr()),Xs=ae(),{typeforce:BP}=Mf,r2=40,n2=2,i2=16,s2=2,o2=80,a2="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.";function MP(e,t){let r=e.slice(2);if(r.length<n2||r.length>r2)throw new TypeError("Invalid program length for segwit address");let n=e[0]-o2;if(n<s2||n>i2)throw new TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw new TypeError("Invalid script for segwit address");return console.warn(a2),f2(r,n,t.bech32)}function c2(e){let t=Xs.base.fromBase58Check(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");let r=t.readUInt8(0),n=t.slice(1);return{version:r,hash:n}}Yt.fromBase58Check=c2;function u2(e){let t,r;try{t=Xs.base.bech32.decode(e)}catch{}if(t){if(r=t.words[0],r!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=Xs.base.bech32m.decode(e),r=t.words[0],r===0)throw new TypeError(e+" uses wrong encoding");let n=Xs.base.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:h.Buffer.from(n)}}Yt.fromBech32=u2;function CP(e,t){BP(Mf.tuple(Mf.Hash160bit,Mf.UInt8),arguments);let r=h.Buffer.allocUnsafe(21);return r.writeUInt8(t,0),e.copy(r,1),Xs.base.toBase58Check(r)}Yt.toBase58Check=CP;function f2(e,t,r){let n=Xs.base.bech32.toWords(e);return n.unshift(t),t===0?Xs.base.bech32.encode(r,n):Xs.base.bech32m.encode(r,n)}Yt.toBech32=f2;function kP(e,t){t=t||e2.bitcoin;try{return ki.p2pkh({output:e,network:t}).address}catch{}try{return ki.p2sh({output:e,network:t}).address}catch{}try{return ki.p2wpkh({output:e,network:t}).address}catch{}try{return ki.p2wsh({output:e,network:t}).address}catch{}try{return ki.p2tr({output:e,network:t}).address}catch{}try{return MP(e,t)}catch{}throw new Error(t2.toASM(e)+" has no matching Address")}Yt.fromOutputScript=kP;function HP(e,t){t=t||e2.bitcoin;let r,n;try{r=c2(e)}catch{}if(r){if(r.version===t.pubKeyHash)return ki.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return ki.p2sh({hash:r.hash}).output}else{try{n=u2(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0){if(n.data.length===20)return ki.p2wpkh({hash:n.data}).output;if(n.data.length===32)return ki.p2wsh({hash:n.data}).output}else if(n.version===1){if(n.data.length===32)return ki.p2tr({pubkey:n.data}).output}else if(n.version>=s2&&n.version<=i2&&n.data.length>=n2&&n.data.length<=r2)return console.warn(a2),t2.compile([n.version+o2,n.data])}}throw new Error(e+" has no matching Script")}Yt.toOutputScript=HP});var $s=H(ln=>{v();w();var NP=ln&&ln.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),UP=ln&&ln.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Qh=ln&&ln.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&NP(t,e,r);return UP(t,e),t};Object.defineProperty(ln,"__esModule",{value:!0});ln.Transaction=ln.vectorSize=ln.varSliceSize=void 0;var Ye=Fs(),$t=Qh(Ir()),d2=Qh(Xt()),RP=Xt(),le=Qh(qr()),{typeforce:fi}=le;function dn(e){let t=e.length;return Ye.varuint.encodingLength(t)+t}ln.varSliceSize=dn;function p2(e){let t=e.length;return Ye.varuint.encodingLength(t)+e.reduce((r,n)=>r+dn(n),0)}ln.vectorSize=p2;var Ys=h.Buffer.allocUnsafe(0),l2=[],Ma=h.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),h2=h.Buffer.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),qP=h.Buffer.from("ffffffffffffffff","hex"),LP={script:Ys,valueBuffer:qP};function KP(e){return e.value!==void 0}var Q=class{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(t,r){let n=new Ye.BufferReader(t),i=new Q;i.version=n.readInt32();let s=n.readUInt8(),o=n.readUInt8(),a=!1;s===Q.ADVANCED_TRANSACTION_MARKER&&o===Q.ADVANCED_TRANSACTION_FLAG?a=!0:n.offset-=2;let c=n.readVarInt();for(let d=0;d<c;++d)i.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:l2});let u=n.readVarInt();for(let d=0;d<u;++d)i.outs.push({value:n.readUInt64(),script:n.readVarSlice()});if(a){for(let d=0;d<c;++d)i.ins[d].witness=n.readVector();if(!i.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(i.locktime=n.readUInt32(),r)return i;if(n.offset!==t.length)throw new Error("Transaction has unexpected data");return i}static fromHex(t){return Q.fromBuffer(h.Buffer.from(t,"hex"),!1)}static isCoinbaseHash(t){fi(le.Hash256bit,t);for(let r=0;r<32;++r)if(t[r]!==0)return!1;return!0}isCoinbase(){return this.ins.length===1&&Q.isCoinbaseHash(this.ins[0].hash)}addInput(t,r,n,i){return fi(le.tuple(le.Hash256bit,le.UInt32,le.maybe(le.UInt32),le.maybe(le.Buffer)),arguments),le.Null(n)&&(n=Q.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:r,script:i||Ys,sequence:n,witness:l2})-1}addOutput(t,r){return fi(le.tuple(le.Buffer,le.Satoshi),arguments),this.outs.push({script:t,value:r})-1}hasWitnesses(){return this.ins.some(t=>t.witness.length!==0)}weight(){let t=this.byteLength(!1),r=this.byteLength(!0);return t*3+r}virtualSize(){return Math.ceil(this.weight()/4)}dogeByteLength(){let t=26+this.ins.reduce((r,n)=>{let i=40+dn(n.script);return r+32+4+i},0)+this.outs.reduce((r,n)=>r+9+n.script.length,0);return Math.ceil(t)}byteLength(t=!0){let r=t&&this.hasWitnesses();return(r?10:8)+Ye.varuint.encodingLength(this.ins.length)+Ye.varuint.encodingLength(this.outs.length)+this.ins.reduce((n,i)=>n+40+dn(i.script),0)+this.outs.reduce((n,i)=>n+8+dn(i.script),0)+(r?this.ins.reduce((n,i)=>n+p2(i.witness),0):0)}clone(){let t=new Q;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(r=>({hash:r.hash,index:r.index,script:r.script,sequence:r.sequence,witness:r.witness})),t.outs=this.outs.map(r=>({script:r.script,value:r.value})),t}hashForSignature(t,r,n){if(fi(le.tuple(le.UInt32,le.Buffer,le.Number),arguments),t>=this.ins.length)return h2;let i=d2.compile(d2.decompile(r).filter(a=>a!==RP.OPS.OP_CODESEPARATOR)),s=this.clone();if((n&31)===Q.SIGHASH_NONE)s.outs=[],s.ins.forEach((a,c)=>{c!==t&&(a.sequence=0)});else if((n&31)===Q.SIGHASH_SINGLE){if(t>=this.outs.length)return h2;s.outs.length=t+1;for(let a=0;a<t;a++)s.outs[a]=LP;s.ins.forEach((a,c)=>{c!==t&&(a.sequence=0)})}n&Q.SIGHASH_ANYONECANPAY?(s.ins=[s.ins[t]],s.ins[0].script=i):(s.ins.forEach(a=>{a.script=Ys}),s.ins[t].script=i);let o=h.Buffer.allocUnsafe(s.byteLength(!1)+4);return o.writeInt32LE(n,o.length-4),s.__toBuffer(o,0,!1),$t.hash256(o)}hashForCashSignature(t,r,n,i){if(i&Q.SIGHASH_BITCOINCASHBIP143){if(le.Null(n))throw new Error("Bitcoin Cash sighash requires value of input to be signed.");return this.hashForWitnessV0(t,r,n,i)}else return this.hashForSignature(t,r,i)}hashForWitnessV1(t,r,n,i,s,o){if(fi(le.tuple(le.UInt32,fi.arrayOf(le.Buffer),fi.arrayOf(le.Satoshi),le.UInt32),arguments),n.length!==this.ins.length||r.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");let a=i===Q.SIGHASH_DEFAULT?Q.SIGHASH_ALL:i&Q.SIGHASH_OUTPUT_MASK,u=(i&Q.SIGHASH_INPUT_MASK)===Q.SIGHASH_ANYONECANPAY,d=a===Q.SIGHASH_NONE,f=a===Q.SIGHASH_SINGLE,p=Ys,y=Ys,m=Ys,_=Ys,E=Ys;if(!u){let R=Ye.BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(U=>{R.writeSlice(U.hash),R.writeUInt32(U.index)}),p=$t.sha256(R.end()),R=Ye.BufferWriter.withCapacity(8*this.ins.length),n.forEach(U=>R.writeUInt64(U)),y=$t.sha256(R.end()),R=Ye.BufferWriter.withCapacity(r.map(dn).reduce((U,q)=>U+q)),r.forEach(U=>R.writeVarSlice(U)),m=$t.sha256(R.end()),R=Ye.BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(U=>R.writeUInt32(U.sequence)),_=$t.sha256(R.end())}if(d||f){if(f&&t<this.outs.length){let R=this.outs[t],U=Ye.BufferWriter.withCapacity(8+dn(R.script));U.writeUInt64(R.value),U.writeVarSlice(R.script),E=$t.sha256(U.end())}}else{let R=this.outs.map(q=>8+dn(q.script)).reduce((q,L)=>q+L),U=Ye.BufferWriter.withCapacity(R);this.outs.forEach(q=>{U.writeUInt64(q.value),U.writeVarSlice(q.script)}),E=$t.sha256(U.end())}let I=(s?2:0)+(o?1:0),k=174-(u?49:0)-(d?32:0)+(o?32:0)+(s?37:0),C=Ye.BufferWriter.withCapacity(k);if(C.writeUInt8(i),C.writeInt32(this.version),C.writeUInt32(this.locktime),C.writeSlice(p),C.writeSlice(y),C.writeSlice(m),C.writeSlice(_),d||f||C.writeSlice(E),C.writeUInt8(I),u){let R=this.ins[t];C.writeSlice(R.hash),C.writeUInt32(R.index),C.writeUInt64(n[t]),C.writeVarSlice(r[t]),C.writeUInt32(R.sequence)}else C.writeUInt32(t);if(o){let R=Ye.BufferWriter.withCapacity(dn(o));R.writeVarSlice(o),C.writeSlice($t.sha256(R.end()))}return f&&C.writeSlice(E),s&&(C.writeSlice(s),C.writeUInt8(0),C.writeUInt32(4294967295)),$t.taggedHash("TapSighash",h.Buffer.concat([h.Buffer.of(0),C.end()]))}hashForWitnessV0(t,r,n,i){fi(le.tuple(le.UInt32,le.Buffer,le.Satoshi,le.UInt32),arguments);let s=h.Buffer.from([]),o,a=Ma,c=Ma,u=Ma;if(i&Q.SIGHASH_ANYONECANPAY||(s=h.Buffer.allocUnsafe(36*this.ins.length),o=new Ye.BufferWriter(s,0),this.ins.forEach(f=>{o.writeSlice(f.hash),o.writeUInt32(f.index)}),c=$t.hash256(s)),!(i&Q.SIGHASH_ANYONECANPAY)&&(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE&&(s=h.Buffer.allocUnsafe(4*this.ins.length),o=new Ye.BufferWriter(s,0),this.ins.forEach(f=>{o.writeUInt32(f.sequence)}),u=$t.hash256(s)),(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE){let f=this.outs.reduce((p,y)=>p+8+dn(y.script),0);s=h.Buffer.allocUnsafe(f),o=new Ye.BufferWriter(s,0),this.outs.forEach(p=>{o.writeUInt64(p.value),o.writeVarSlice(p.script)}),a=$t.hash256(s)}else if((i&31)===Q.SIGHASH_SINGLE&&t<this.outs.length){let f=this.outs[t];s=h.Buffer.allocUnsafe(8+dn(f.script)),o=new Ye.BufferWriter(s,0),o.writeUInt64(f.value),o.writeVarSlice(f.script),a=$t.hash256(s)}s=h.Buffer.allocUnsafe(156+dn(r)),o=new Ye.BufferWriter(s,0);let d=this.ins[t];return o.writeInt32(this.version),o.writeSlice(c),o.writeSlice(u),o.writeSlice(d.hash),o.writeUInt32(d.index),o.writeVarSlice(r),o.writeUInt64(n),o.writeUInt32(d.sequence),o.writeSlice(a),o.writeUInt32(this.locktime),o.writeUInt32(i),$t.hash256(s)}getHash(t){return t&&this.isCoinbase()?h.Buffer.alloc(32,0):$t.hash256(this.__toBuffer(void 0,void 0,t))}getId(){return(0,Ye.reverseBuffer)(this.getHash(!1)).toString("hex")}toBuffer(t,r){return this.__toBuffer(t,r,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(t,r){fi(le.tuple(le.Number,le.Buffer),arguments),this.ins[t].script=r}setWitness(t,r){fi(le.tuple(le.Number,[le.Buffer]),arguments),this.ins[t].witness=r}__toBuffer(t,r,n=!1){t||(t=h.Buffer.allocUnsafe(this.byteLength(n)));let i=new Ye.BufferWriter(t,r||0);i.writeInt32(this.version);let s=n&&this.hasWitnesses();return s&&(i.writeUInt8(Q.ADVANCED_TRANSACTION_MARKER),i.writeUInt8(Q.ADVANCED_TRANSACTION_FLAG)),i.writeVarInt(this.ins.length),this.ins.forEach(o=>{i.writeSlice(o.hash),i.writeUInt32(o.index),i.writeVarSlice(o.script),i.writeUInt32(o.sequence)}),i.writeVarInt(this.outs.length),this.outs.forEach(o=>{KP(o)?i.writeUInt64(o.value):i.writeSlice(o.valueBuffer),i.writeVarSlice(o.script)}),s&&this.ins.forEach(o=>{i.writeVector(o.witness)}),i.writeUInt32(this.locktime),r!==void 0?t.slice(r,i.offset):t}hashForWitness(t,r,n,i){fi(le.tuple(le.UInt32,le.Buffer,le.Satoshi,le.UInt32),arguments);let s=h.Buffer.from([]),o,a=Ma,c=Ma,u=Ma;if(i&Q.SIGHASH_ANYONECANPAY||(s=h.Buffer.allocUnsafe(36*this.ins.length),o=new Ye.BufferWriter(s,0),this.ins.forEach(f=>{o.writeSlice(f.hash),o.writeUInt32(f.index)}),c=$t.hash256(s)),!(i&Q.SIGHASH_ANYONECANPAY)&&(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE&&(s=h.Buffer.allocUnsafe(4*this.ins.length),o=new Ye.BufferWriter(s,0),this.ins.forEach(f=>{o.writeUInt32(f.sequence)}),u=$t.hash256(s)),(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE){let f=this.outs.reduce((p,y)=>p+8+dn(y.script),0);s=h.Buffer.allocUnsafe(f),o=new Ye.BufferWriter(s,0),this.outs.forEach(p=>{o.writeUInt64(p.value),o.writeVarSlice(p.script)}),a=$t.hash256(s)}else if((i&31)===Q.SIGHASH_SINGLE&&t<this.outs.length){let f=this.outs[t];s=h.Buffer.allocUnsafe(8+dn(f.script)),o=new Ye.BufferWriter(s,0),o.writeUInt64(f.value),o.writeVarSlice(f.script),a=$t.hash256(s)}s=h.Buffer.allocUnsafe(156+r.length),o=new Ye.BufferWriter(s,0);let d=this.ins[t];return o.writeInt32(this.version),o.writeSlice(c),o.writeSlice(u),o.writeSlice(d.hash),o.writeUInt32(d.index),o.writeSlice(r),o.writeUInt64(n),o.writeUInt32(d.sequence),o.writeSlice(a),o.writeUInt32(this.locktime),o.writeUInt32(i),$t.hash256(s)}};ln.Transaction=Q;Q.DEFAULT_SEQUENCE=4294967295;Q.SIGHASH_DEFAULT=0;Q.SIGHASH_ALL=1;Q.SIGHASH_NONE=2;Q.SIGHASH_SINGLE=3;Q.SIGHASH_ANYONECANPAY=128;Q.SIGHASH_OUTPUT_MASK=3;Q.SIGHASH_INPUT_MASK=128;Q.SIGHASH_BITCOINCASHBIP143=64;Q.ADVANCED_TRANSACTION_MARKER=0;Q.ADVANCED_TRANSACTION_FLAG=1});var gr=H(Ar=>{v();w();Object.defineProperty(Ar,"__esModule",{value:!0});Ar.OUTPUT_TYPE_NAMES=Ar.OutputTypes=Ar.INPUT_TYPE_NAMES=Ar.InputTypes=Ar.GLOBAL_TYPE_NAMES=Ar.GlobalTypes=void 0;var DP;(function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"})(DP=Ar.GlobalTypes||(Ar.GlobalTypes={}));Ar.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"];var jP;(function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"})(jP=Ar.InputTypes||(Ar.InputTypes={}));Ar.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"];var FP;(function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"})(FP=Ar.OutputTypes||(Ar.OutputTypes={}));Ar.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"]});var g2=H(Hn=>{v();w();Object.defineProperty(Hn,"__esModule",{value:!0});Hn.canAddToArray=Hn.check=Hn.expected=Hn.encode=Hn.decode=void 0;var b2=gr(),VP=e=>[...Array(e).keys()];function GP(e){if(e.key[0]!==b2.GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"));if(e.key.length!==79||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");let t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(let n of VP(e.value.length/4-1)){let i=e.value.readUInt32LE(n*4+4),s=!!(i&2147483648),o=i&2147483647;r.path+="/"+o.toString(10)+(s?"'":"")}return r}Hn.decode=GP;function WP(e){let t=h.Buffer.from([b2.GlobalTypes.GLOBAL_XPUB]),r=h.Buffer.concat([t,e.extendedPubkey]),n=e.path.split("/"),i=h.Buffer.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let s=4;return n.slice(1).forEach(o=>{let a=o.slice(-1)==="'",c=2147483647&parseInt(a?o.slice(0,-1):o,10);a&&(c+=2147483648),i.writeUInt32LE(c,s),s+=4}),{key:r,value:i}}Hn.encode=WP;Hn.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }";function zP(e){let t=e.extendedPubkey,r=e.masterFingerprint,n=e.path;return h.Buffer.isBuffer(t)&&t.length===78&&[2,3].indexOf(t[45])>-1&&h.Buffer.isBuffer(r)&&r.length===4&&typeof n=="string"&&!!n.match(/^m(\/\d+'?)*$/)}Hn.check=zP;function XP(e,t,r){let n=t.extendedPubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.extendedPubkey.equals(t.extendedPubkey)).length===0)}Hn.canAddToArray=XP});var y2=H(kf=>{v();w();Object.defineProperty(kf,"__esModule",{value:!0});kf.encode=void 0;var YP=gr();function $P(e){return{key:h.Buffer.from([YP.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}kf.encode=$P});var _2=H(Nn=>{v();w();Object.defineProperty(Nn,"__esModule",{value:!0});Nn.canAdd=Nn.check=Nn.expected=Nn.encode=Nn.decode=void 0;var m2=gr();function ZP(e){if(e.key[0]!==m2.InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"));return e.value}Nn.decode=ZP;function JP(e){return{key:h.Buffer.from([m2.InputTypes.FINAL_SCRIPTSIG]),value:e}}Nn.encode=JP;Nn.expected="Buffer";function QP(e){return h.Buffer.isBuffer(e)}Nn.check=QP;function e7(e,t){return!!e&&!!t&&e.finalScriptSig===void 0}Nn.canAdd=e7});var w2=H(Un=>{v();w();Object.defineProperty(Un,"__esModule",{value:!0});Un.canAdd=Un.check=Un.expected=Un.encode=Un.decode=void 0;var v2=gr();function t7(e){if(e.key[0]!==v2.InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"));return e.value}Un.decode=t7;function r7(e){return{key:h.Buffer.from([v2.InputTypes.FINAL_SCRIPTWITNESS]),value:e}}Un.encode=r7;Un.expected="Buffer";function n7(e){return h.Buffer.isBuffer(e)}Un.check=n7;function i7(e,t){return!!e&&!!t&&e.finalScriptWitness===void 0}Un.canAdd=i7});var x2=H(Rn=>{v();w();Object.defineProperty(Rn,"__esModule",{value:!0});Rn.canAdd=Rn.check=Rn.expected=Rn.encode=Rn.decode=void 0;var S2=gr();function s7(e){if(e.key[0]!==S2.InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"));return e.value}Rn.decode=s7;function o7(e){return{key:h.Buffer.from([S2.InputTypes.NON_WITNESS_UTXO]),value:e}}Rn.encode=o7;Rn.expected="Buffer";function a7(e){return h.Buffer.isBuffer(e)}Rn.check=a7;function c7(e,t){return!!e&&!!t&&e.nonWitnessUtxo===void 0}Rn.canAdd=c7});var P2=H(qn=>{v();w();Object.defineProperty(qn,"__esModule",{value:!0});qn.canAddToArray=qn.check=qn.expected=qn.encode=qn.decode=void 0;var T2=gr();function u7(e){if(e.key[0]!==T2.InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"));if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"));return{pubkey:e.key.slice(1),signature:e.value}}qn.decode=u7;function f7(e){let t=h.Buffer.from([T2.InputTypes.PARTIAL_SIG]);return{key:h.Buffer.concat([t,e.pubkey]),value:e.signature}}qn.encode=f7;qn.expected="{ pubkey: Buffer; signature: Buffer; }";function d7(e){return h.Buffer.isBuffer(e.pubkey)&&h.Buffer.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&l7(e.signature)}qn.check=d7;function l7(e){if(!h.Buffer.isBuffer(e)||e.length<9||e[0]!==48||e.length!==e[1]+3||e[2]!==2)return!1;let t=e[3];if(t>33||t<1||e[3+t+1]!==2)return!1;let r=e[3+t+2];return!(r>33||r<1||e.length!==3+t+2+r+2)}function h7(e,t,r){let n=t.pubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)).length===0)}qn.canAddToArray=h7});var I2=H(Ln=>{v();w();Object.defineProperty(Ln,"__esModule",{value:!0});Ln.canAdd=Ln.check=Ln.expected=Ln.encode=Ln.decode=void 0;var E2=gr();function p7(e){if(e.key[0]!==E2.InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"));return e.value.toString("utf8")}Ln.decode=p7;function b7(e){return{key:h.Buffer.from([E2.InputTypes.POR_COMMITMENT]),value:h.Buffer.from(e,"utf8")}}Ln.encode=b7;Ln.expected="string";function g7(e){return typeof e=="string"}Ln.check=g7;function y7(e,t){return!!e&&!!t&&e.porCommitment===void 0}Ln.canAdd=y7});var O2=H(Kn=>{v();w();Object.defineProperty(Kn,"__esModule",{value:!0});Kn.canAdd=Kn.check=Kn.expected=Kn.encode=Kn.decode=void 0;var A2=gr();function m7(e){if(e.key[0]!==A2.InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"));return e.value.readUInt32LE(0)}Kn.decode=m7;function _7(e){let t=h.Buffer.from([A2.InputTypes.SIGHASH_TYPE]),r=h.Buffer.allocUnsafe(4);return r.writeUInt32LE(e,0),{key:t,value:r}}Kn.encode=_7;Kn.expected="number";function v7(e){return typeof e=="number"}Kn.check=v7;function w7(e,t){return!!e&&!!t&&e.sighashType===void 0}Kn.canAdd=w7});var C2=H(Dn=>{v();w();Object.defineProperty(Dn,"__esModule",{value:!0});Dn.canAdd=Dn.check=Dn.expected=Dn.encode=Dn.decode=void 0;var B2=gr();function S7(e){if(e.key[0]!==B2.InputTypes.TAP_KEY_SIG||e.key.length!==1)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+e.key.toString("hex"));if(!M2(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}Dn.decode=S7;function x7(e){return{key:h.Buffer.from([B2.InputTypes.TAP_KEY_SIG]),value:e}}Dn.encode=x7;Dn.expected="Buffer";function M2(e){return h.Buffer.isBuffer(e)&&(e.length===64||e.length===65)}Dn.check=M2;function T7(e,t){return!!e&&!!t&&e.tapKeySig===void 0}Dn.canAdd=T7});var H2=H(jn=>{v();w();Object.defineProperty(jn,"__esModule",{value:!0});jn.canAddToArray=jn.check=jn.expected=jn.encode=jn.decode=void 0;var k2=gr();function P7(e){if(e.key[0]!==k2.InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+e.key.toString("hex"));if((e.key.length-2)%32!==0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+e.key.toString("hex"));let t=e.value[e.value.length-1];if((e.key[1]&254)!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+e.key.toString("hex"));let r=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:r,leafVersion:t}}jn.decode=P7;function E7(e){let t=h.Buffer.from([k2.InputTypes.TAP_LEAF_SCRIPT]),r=h.Buffer.from([e.leafVersion]);return{key:h.Buffer.concat([t,e.controlBlock]),value:h.Buffer.concat([e.script,r])}}jn.encode=E7;jn.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }";function I7(e){return h.Buffer.isBuffer(e.controlBlock)&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&h.Buffer.isBuffer(e.script)}jn.check=I7;function A7(e,t,r){let n=t.controlBlock.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.controlBlock.equals(t.controlBlock)).length===0)}jn.canAddToArray=A7});var R2=H(Fn=>{v();w();Object.defineProperty(Fn,"__esModule",{value:!0});Fn.canAdd=Fn.check=Fn.expected=Fn.encode=Fn.decode=void 0;var N2=gr();function O7(e){if(e.key[0]!==N2.InputTypes.TAP_MERKLE_ROOT||e.key.length!==1)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+e.key.toString("hex"));if(!U2(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}Fn.decode=O7;function B7(e){return{key:h.Buffer.from([N2.InputTypes.TAP_MERKLE_ROOT]),value:e}}Fn.encode=B7;Fn.expected="Buffer";function U2(e){return h.Buffer.isBuffer(e)&&e.length===32}Fn.check=U2;function M7(e,t){return!!e&&!!t&&e.tapMerkleRoot===void 0}Fn.canAdd=M7});var L2=H(Vn=>{v();w();Object.defineProperty(Vn,"__esModule",{value:!0});Vn.canAddToArray=Vn.check=Vn.expected=Vn.encode=Vn.decode=void 0;var q2=gr();function C7(e){if(e.key[0]!==q2.InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+e.key.toString("hex"));if(e.key.length!==65)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+e.key.toString("hex"));if(e.value.length!==64&&e.value.length!==65)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+e.key.toString("hex"));let t=e.key.slice(1,33),r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}Vn.decode=C7;function k7(e){let t=h.Buffer.from([q2.InputTypes.TAP_SCRIPT_SIG]);return{key:h.Buffer.concat([t,e.pubkey,e.leafHash]),value:e.signature}}Vn.encode=k7;Vn.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }";function H7(e){return h.Buffer.isBuffer(e.pubkey)&&h.Buffer.isBuffer(e.leafHash)&&h.Buffer.isBuffer(e.signature)&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}Vn.check=H7;function N7(e,t,r){let n=t.pubkey.toString("hex")+t.leafHash.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)&&i.leafHash.equals(t.leafHash)).length===0)}Vn.canAddToArray=N7});var Js=H(Zs=>{v();w();Object.defineProperty(Zs,"__esModule",{value:!0});Zs.encodingLength=Zs.decode=Zs.encode=void 0;var U7=9007199254740991;function e0(e){if(e<0||e>U7||e%1!==0)throw new RangeError("value out of range")}function Kc(e,t,r){if(e0(e),t||(t=h.Buffer.allocUnsafe(K2(e))),!h.Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),Object.assign(Kc,{bytes:1})):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),Object.assign(Kc,{bytes:3})):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),Object.assign(Kc,{bytes:5})):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),Object.assign(Kc,{bytes:9})),t}Zs.encode=Kc;function Dc(e,t){if(!h.Buffer.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);let r=e.readUInt8(t);if(r<253)return Object.assign(Dc,{bytes:1}),r;if(r===253)return Object.assign(Dc,{bytes:3}),e.readUInt16LE(t+1);if(r===254)return Object.assign(Dc,{bytes:5}),e.readUInt32LE(t+1);{Object.assign(Dc,{bytes:9});let n=e.readUInt32LE(t+1),s=e.readUInt32LE(t+5)*4294967296+n;return e0(s),s}}Zs.decode=Dc;function K2(e){return e0(e),e<253?1:e<=65535?3:e<=4294967295?5:9}Zs.encodingLength=K2});var Nf=H(Zt=>{v();w();var R7=Zt&&Zt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),q7=Zt&&Zt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),L7=Zt&&Zt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&R7(t,e,r);return q7(t,e),t};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.writeUInt64LE=Zt.readUInt64LE=Zt.keyValToBuffer=Zt.keyValsToBuffer=Zt.reverseBuffer=Zt.range=void 0;var Hf=L7(Js()),K7=e=>[...Array(e).keys()];Zt.range=K7;function D7(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Zt.reverseBuffer=D7;function j7(e){let t=e.map(D2);return t.push(h.Buffer.from([0])),h.Buffer.concat(t)}Zt.keyValsToBuffer=j7;function D2(e){let t=e.key.length,r=e.value.length,n=Hf.encodingLength(t),i=Hf.encodingLength(r),s=h.Buffer.allocUnsafe(n+t+i+r);return Hf.encode(t,s,0),e.key.copy(s,n),Hf.encode(r,s,n+t),e.value.copy(s,n+t+i),s}Zt.keyValToBuffer=D2;function j2(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function F7(e,t){let r=e.readUInt32LE(t),n=e.readUInt32LE(t+4);return n*=4294967296,j2(n+r,9007199254740991),n+r}Zt.readUInt64LE=F7;function V7(e,t,r){return j2(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}Zt.writeUInt64LE=V7});var G2=H(yr=>{v();w();var G7=yr&&yr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),W7=yr&&yr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),z7=yr&&yr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&G7(t,e,r);return W7(t,e),t};Object.defineProperty(yr,"__esModule",{value:!0});yr.canAdd=yr.check=yr.expected=yr.encode=yr.decode=void 0;var F2=gr(),V2=Nf(),Uf=z7(Js());function X7(e){if(e.key[0]!==F2.InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"));let t=(0,V2.readUInt64LE)(e.value,0),r=8,n=Uf.decode(e.value,r);r+=Uf.encodingLength(n);let i=e.value.slice(r);if(i.length!==n)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:i,value:t}}yr.decode=X7;function Y7(e){let{script:t,value:r}=e,n=Uf.encodingLength(t.length),i=h.Buffer.allocUnsafe(8+n+t.length);return(0,V2.writeUInt64LE)(i,r,0),Uf.encode(t.length,i,8),t.copy(i,8+n),{key:h.Buffer.from([F2.InputTypes.WITNESS_UTXO]),value:i}}yr.encode=Y7;yr.expected="{ script: Buffer; value: number; }";function $7(e){return h.Buffer.isBuffer(e.script)&&typeof e.value=="number"}yr.check=$7;function Z7(e,t){return!!e&&!!t&&e.witnessUtxo===void 0}yr.canAdd=Z7});var z2=H(mr=>{v();w();var J7=mr&&mr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Q7=mr&&mr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),eE=mr&&mr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&J7(t,e,r);return Q7(t,e),t};Object.defineProperty(mr,"__esModule",{value:!0});mr.canAdd=mr.check=mr.expected=mr.encode=mr.decode=void 0;var W2=gr(),t0=eE(Js());function tE(e){if(e.key[0]!==W2.OutputTypes.TAP_TREE||e.key.length!==1)throw new Error("Decode Error: could not decode tapTree with key 0x"+e.key.toString("hex"));let t=0,r=[];for(;t<e.value.length;){let n=e.value[t++],i=e.value[t++],s=t0.decode(e.value,t);t+=t0.encodingLength(s),r.push({depth:n,leafVersion:i,script:e.value.slice(t,t+s)}),t+=s}return{leaves:r}}mr.decode=tE;function rE(e){let t=h.Buffer.from([W2.OutputTypes.TAP_TREE]),r=[].concat(...e.leaves.map(n=>[h.Buffer.of(n.depth,n.leafVersion),t0.encode(n.script.length),n.script]));return{key:t,value:h.Buffer.concat(r)}}mr.encode=rE;mr.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }";function nE(e){return Array.isArray(e.leaves)&&e.leaves.every(t=>t.depth>=0&&t.depth<=128&&(t.leafVersion&254)===t.leafVersion&&h.Buffer.isBuffer(t.script))}mr.check=nE;function iE(e,t){return!!e&&!!t&&e.tapTree===void 0}mr.canAdd=iE});var r0=H(Rf=>{v();w();Object.defineProperty(Rf,"__esModule",{value:!0});Rf.makeConverter=void 0;var sE=e=>[...Array(e).keys()],oE=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function aE(e,t=oE){function r(a){if(a.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+a.key.toString("hex"));let c=a.key.slice(1);if(!t(c))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+a.key.toString("hex"));if(a.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");let u={masterFingerprint:a.value.slice(0,4),pubkey:c,path:"m"};for(let d of sE(a.value.length/4-1)){let f=a.value.readUInt32LE(d*4+4),p=!!(f&2147483648),y=f&2147483647;u.path+="/"+y.toString(10)+(p?"'":"")}return u}function n(a){let c=h.Buffer.from([e]),u=h.Buffer.concat([c,a.pubkey]),d=a.path.split("/"),f=h.Buffer.allocUnsafe(d.length*4);a.masterFingerprint.copy(f,0);let p=4;return d.slice(1).forEach(y=>{let m=y.slice(-1)==="'",_=2147483647&parseInt(m?y.slice(0,-1):y,10);m&&(_+=2147483648),f.writeUInt32LE(_,p),p+=4}),{key:u,value:f}}let i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }";function s(a){return h.Buffer.isBuffer(a.pubkey)&&h.Buffer.isBuffer(a.masterFingerprint)&&typeof a.path=="string"&&t(a.pubkey)&&a.masterFingerprint.length===4}function o(a,c,u){let d=c.pubkey.toString("hex");return u.has(d)?!1:(u.add(d),a.filter(f=>f.pubkey.equals(c.pubkey)).length===0)}return{decode:r,encode:n,check:s,expected:i,canAddToArray:o}}Rf.makeConverter=aE});var X2=H(qf=>{v();w();Object.defineProperty(qf,"__esModule",{value:!0});qf.makeChecker=void 0;function cE(e){return t;function t(r){let n;if(e.includes(r.key[0])&&(n=r.key.slice(1),!(n.length===33||n.length===65)||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+r.key.toString("hex"));return n}}qf.makeChecker=cE});var Y2=H(Lf=>{v();w();Object.defineProperty(Lf,"__esModule",{value:!0});Lf.makeConverter=void 0;function uE(e){function t(o){if(o.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+o.key.toString("hex"));return o.value}function r(o){return{key:h.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return h.Buffer.isBuffer(o)}function s(o,a){return!!o&&!!a&&o.redeemScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}Lf.makeConverter=uE});var Z2=H(Hi=>{v();w();var fE=Hi&&Hi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),dE=Hi&&Hi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$2=Hi&&Hi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&fE(t,e,r);return dE(t,e),t};Object.defineProperty(Hi,"__esModule",{value:!0});Hi.makeConverter=void 0;var Kf=$2(Js()),lE=$2(r0()),hE=e=>e.length===32;function pE(e){let t=lE.makeConverter(e,hE);function r(o){let a=Kf.decode(o.value),c=Kf.encodingLength(a),u=t.decode({key:o.key,value:o.value.slice(c+a*32)}),d=new Array(a);for(let f=0,p=c;f<a;f++,p+=32)d[f]=o.value.slice(p,p+32);return{...u,leafHashes:d}}function n(o){let a=t.encode(o),c=Kf.encodingLength(o.leafHashes.length),u=h.Buffer.allocUnsafe(c);Kf.encode(o.leafHashes.length,u);let d=h.Buffer.concat([u,...o.leafHashes,a.value]);return{...a,value:d}}let i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; leafHashes: Buffer[]; }";function s(o){return Array.isArray(o.leafHashes)&&o.leafHashes.every(a=>h.Buffer.isBuffer(a)&&a.length===32)&&t.check(o)}return{decode:r,encode:n,check:s,expected:i,canAddToArray:t.canAddToArray}}Hi.makeConverter=pE});var J2=H(Df=>{v();w();Object.defineProperty(Df,"__esModule",{value:!0});Df.makeConverter=void 0;function bE(e){function t(o){if(o.key[0]!==e||o.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+o.key.toString("hex"));if(o.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return o.value}function r(o){return{key:h.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return h.Buffer.isBuffer(o)&&o.length===32}function s(o,a){return!!o&&!!a&&o.tapInternalKey===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}Df.makeConverter=bE});var Q2=H(jf=>{v();w();Object.defineProperty(jf,"__esModule",{value:!0});jf.makeConverter=void 0;function gE(e){function t(o){if(o.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+o.key.toString("hex"));return o.value}function r(o){return{key:h.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return h.Buffer.isBuffer(o)}function s(o,a){return!!o&&!!a&&o.witnessScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}jf.makeConverter=gE});var Ff=H(hn=>{v();w();var yE=hn&&hn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),mE=hn&&hn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Jt=hn&&hn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&yE(t,e,r);return mE(t,e),t};Object.defineProperty(hn,"__esModule",{value:!0});hn.outputs=hn.inputs=hn.globals=void 0;var wn=gr(),_E=Jt(g2()),vE=Jt(y2()),wE=Jt(_2()),SE=Jt(w2()),xE=Jt(x2()),TE=Jt(P2()),PE=Jt(I2()),EE=Jt(O2()),IE=Jt(C2()),AE=Jt(H2()),OE=Jt(R2()),BE=Jt(L2()),ME=Jt(G2()),CE=Jt(z2()),e_=Jt(r0()),n0=Jt(X2()),t_=Jt(Y2()),r_=Jt(Z2()),n_=Jt(J2()),i_=Jt(Q2()),kE={unsignedTx:vE,globalXpub:_E,checkPubkey:n0.makeChecker([])};hn.globals=kE;var HE={nonWitnessUtxo:xE,partialSig:TE,sighashType:EE,finalScriptSig:wE,finalScriptWitness:SE,porCommitment:PE,witnessUtxo:ME,bip32Derivation:e_.makeConverter(wn.InputTypes.BIP32_DERIVATION),redeemScript:t_.makeConverter(wn.InputTypes.REDEEM_SCRIPT),witnessScript:i_.makeConverter(wn.InputTypes.WITNESS_SCRIPT),checkPubkey:n0.makeChecker([wn.InputTypes.PARTIAL_SIG,wn.InputTypes.BIP32_DERIVATION]),tapKeySig:IE,tapScriptSig:BE,tapLeafScript:AE,tapBip32Derivation:r_.makeConverter(wn.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:n_.makeConverter(wn.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:OE};hn.inputs=HE;var NE={bip32Derivation:e_.makeConverter(wn.OutputTypes.BIP32_DERIVATION),redeemScript:t_.makeConverter(wn.OutputTypes.REDEEM_SCRIPT),witnessScript:i_.makeConverter(wn.OutputTypes.WITNESS_SCRIPT),checkPubkey:n0.makeChecker([wn.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:r_.makeConverter(wn.OutputTypes.TAP_BIP32_DERIVATION),tapTree:CE,tapInternalKey:n_.makeConverter(wn.OutputTypes.TAP_INTERNAL_KEY)};hn.outputs=NE});var c_=H(pn=>{v();w();var UE=pn&&pn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),RE=pn&&pn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o_=pn&&pn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&UE(t,e,r);return RE(t,e),t};Object.defineProperty(pn,"__esModule",{value:!0});pn.psbtFromKeyVals=pn.checkKeyBuffer=pn.psbtFromBuffer=void 0;var $e=o_(Ff()),Vf=Nf(),s_=o_(Js()),ue=gr();function qE(e,t){let r=0;function n(){let E=s_.decode(e,r);r+=s_.encodingLength(E);let I=e.slice(r,r+E);return r+=E,I}function i(){let E=e.readUInt32BE(r);return r+=4,E}function s(){let E=e.readUInt8(r);return r+=1,E}function o(){let E=n(),I=n();return{key:E,value:I}}function a(){if(r>=e.length)throw new Error("Format Error: Unexpected End of PSBT");let E=e.readUInt8(r)===0;return E&&r++,E}if(i()!==1886610036)throw new Error("Format Error: Invalid Magic Number");if(s()!==255)throw new Error("Format Error: Magic Number must be followed by 0xff separator");let c=[],u={};for(;!a();){let E=o(),I=E.key.toString("hex");if(u[I])throw new Error("Format Error: Keys must be unique for global keymap: key "+I);u[I]=1,c.push(E)}let d=c.filter(E=>E.key[0]===ue.GlobalTypes.UNSIGNED_TX);if(d.length!==1)throw new Error("Format Error: Only one UNSIGNED_TX allowed");let f=t(d[0].value),{inputCount:p,outputCount:y}=f.getInputOutputCounts(),m=[],_=[];for(let E of(0,Vf.range)(p)){let I={},k=[];for(;!a();){let C=o(),R=C.key.toString("hex");if(I[R])throw new Error("Format Error: Keys must be unique for each input: input index "+E+" key "+R);I[R]=1,k.push(C)}m.push(k)}for(let E of(0,Vf.range)(y)){let I={},k=[];for(;!a();){let C=o(),R=C.key.toString("hex");if(I[R])throw new Error("Format Error: Keys must be unique for each output: output index "+E+" key "+R);I[R]=1,k.push(C)}_.push(k)}return a_(f,{globalMapKeyVals:c,inputKeyVals:m,outputKeyVals:_})}pn.psbtFromBuffer=qE;function Or(e,t,r){if(!t.equals(h.Buffer.from([r])))throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}pn.checkKeyBuffer=Or;function a_(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){let i={unsignedTx:e},s=0;for(let d of t)switch(d.key[0]){case ue.GlobalTypes.UNSIGNED_TX:if(Or("global",d.key,ue.GlobalTypes.UNSIGNED_TX),s>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");s++;break;case ue.GlobalTypes.GLOBAL_XPUB:i.globalXpub===void 0&&(i.globalXpub=[]),i.globalXpub.push($e.globals.globalXpub.decode(d));break;default:i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(d)}let o=r.length,a=n.length,c=[],u=[];for(let d of(0,Vf.range)(o)){let f={};for(let p of r[d])switch($e.inputs.checkPubkey(p),p.key[0]){case ue.InputTypes.NON_WITNESS_UTXO:if(Or("input",p.key,ue.InputTypes.NON_WITNESS_UTXO),f.nonWitnessUtxo!==void 0)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");f.nonWitnessUtxo=$e.inputs.nonWitnessUtxo.decode(p);break;case ue.InputTypes.WITNESS_UTXO:if(Or("input",p.key,ue.InputTypes.WITNESS_UTXO),f.witnessUtxo!==void 0)throw new Error("Format Error: Input has multiple WITNESS_UTXO");f.witnessUtxo=$e.inputs.witnessUtxo.decode(p);break;case ue.InputTypes.PARTIAL_SIG:f.partialSig===void 0&&(f.partialSig=[]),f.partialSig.push($e.inputs.partialSig.decode(p));break;case ue.InputTypes.SIGHASH_TYPE:if(Or("input",p.key,ue.InputTypes.SIGHASH_TYPE),f.sighashType!==void 0)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");f.sighashType=$e.inputs.sighashType.decode(p);break;case ue.InputTypes.REDEEM_SCRIPT:if(Or("input",p.key,ue.InputTypes.REDEEM_SCRIPT),f.redeemScript!==void 0)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");f.redeemScript=$e.inputs.redeemScript.decode(p);break;case ue.InputTypes.WITNESS_SCRIPT:if(Or("input",p.key,ue.InputTypes.WITNESS_SCRIPT),f.witnessScript!==void 0)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");f.witnessScript=$e.inputs.witnessScript.decode(p);break;case ue.InputTypes.BIP32_DERIVATION:f.bip32Derivation===void 0&&(f.bip32Derivation=[]),f.bip32Derivation.push($e.inputs.bip32Derivation.decode(p));break;case ue.InputTypes.FINAL_SCRIPTSIG:Or("input",p.key,ue.InputTypes.FINAL_SCRIPTSIG),f.finalScriptSig=$e.inputs.finalScriptSig.decode(p);break;case ue.InputTypes.FINAL_SCRIPTWITNESS:Or("input",p.key,ue.InputTypes.FINAL_SCRIPTWITNESS),f.finalScriptWitness=$e.inputs.finalScriptWitness.decode(p);break;case ue.InputTypes.POR_COMMITMENT:Or("input",p.key,ue.InputTypes.POR_COMMITMENT),f.porCommitment=$e.inputs.porCommitment.decode(p);break;case ue.InputTypes.TAP_KEY_SIG:Or("input",p.key,ue.InputTypes.TAP_KEY_SIG),f.tapKeySig=$e.inputs.tapKeySig.decode(p);break;case ue.InputTypes.TAP_SCRIPT_SIG:f.tapScriptSig===void 0&&(f.tapScriptSig=[]),f.tapScriptSig.push($e.inputs.tapScriptSig.decode(p));break;case ue.InputTypes.TAP_LEAF_SCRIPT:f.tapLeafScript===void 0&&(f.tapLeafScript=[]),f.tapLeafScript.push($e.inputs.tapLeafScript.decode(p));break;case ue.InputTypes.TAP_BIP32_DERIVATION:f.tapBip32Derivation===void 0&&(f.tapBip32Derivation=[]),f.tapBip32Derivation.push($e.inputs.tapBip32Derivation.decode(p));break;case ue.InputTypes.TAP_INTERNAL_KEY:Or("input",p.key,ue.InputTypes.TAP_INTERNAL_KEY),f.tapInternalKey=$e.inputs.tapInternalKey.decode(p);break;case ue.InputTypes.TAP_MERKLE_ROOT:Or("input",p.key,ue.InputTypes.TAP_MERKLE_ROOT),f.tapMerkleRoot=$e.inputs.tapMerkleRoot.decode(p);break;default:f.unknownKeyVals||(f.unknownKeyVals=[]),f.unknownKeyVals.push(p)}c.push(f)}for(let d of(0,Vf.range)(a)){let f={};for(let p of n[d])switch($e.outputs.checkPubkey(p),p.key[0]){case ue.OutputTypes.REDEEM_SCRIPT:if(Or("output",p.key,ue.OutputTypes.REDEEM_SCRIPT),f.redeemScript!==void 0)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");f.redeemScript=$e.outputs.redeemScript.decode(p);break;case ue.OutputTypes.WITNESS_SCRIPT:if(Or("output",p.key,ue.OutputTypes.WITNESS_SCRIPT),f.witnessScript!==void 0)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");f.witnessScript=$e.outputs.witnessScript.decode(p);break;case ue.OutputTypes.BIP32_DERIVATION:f.bip32Derivation===void 0&&(f.bip32Derivation=[]),f.bip32Derivation.push($e.outputs.bip32Derivation.decode(p));break;case ue.OutputTypes.TAP_INTERNAL_KEY:Or("output",p.key,ue.OutputTypes.TAP_INTERNAL_KEY),f.tapInternalKey=$e.outputs.tapInternalKey.decode(p);break;case ue.OutputTypes.TAP_TREE:Or("output",p.key,ue.OutputTypes.TAP_TREE),f.tapTree=$e.outputs.tapTree.decode(p);break;case ue.OutputTypes.TAP_BIP32_DERIVATION:f.tapBip32Derivation===void 0&&(f.tapBip32Derivation=[]),f.tapBip32Derivation.push($e.outputs.tapBip32Derivation.decode(p));break;default:f.unknownKeyVals||(f.unknownKeyVals=[]),f.unknownKeyVals.push(p)}u.push(f)}return{globalMap:i,inputs:c,outputs:u}}pn.psbtFromKeyVals=a_});var d_=H(Gn=>{v();w();var LE=Gn&&Gn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),KE=Gn&&Gn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),DE=Gn&&Gn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&LE(t,e,r);return KE(t,e),t};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.psbtToKeyVals=Gn.psbtToBuffer=void 0;var i0=DE(Ff()),u_=Nf();function jE({globalMap:e,inputs:t,outputs:r}){let{globalKeyVals:n,inputKeyVals:i,outputKeyVals:s}=f_({globalMap:e,inputs:t,outputs:r}),o=(0,u_.keyValsToBuffer)(n),a=f=>f.length===0?[h.Buffer.from([0])]:f.map(u_.keyValsToBuffer),c=a(i),u=a(s),d=h.Buffer.allocUnsafe(5);return d.writeUIntBE(482972169471,0,5),h.Buffer.concat([d,o].concat(c,u))}Gn.psbtToBuffer=jE;var FE=(e,t)=>e.key.compare(t.key);function s0(e,t){let r=new Set,n=Object.entries(e).reduce((s,[o,a])=>{if(o==="unknownKeyVals")return s;let c=t[o];if(c===void 0)return s;let u=(Array.isArray(a)?a:[a]).map(c.encode);return u.map(f=>f.key.toString("hex")).forEach(f=>{if(r.has(f))throw new Error("Serialize Error: Duplicate key: "+f);r.add(f)}),s.concat(u)},[]),i=e.unknownKeyVals?e.unknownKeyVals.filter(s=>!r.has(s.key.toString("hex"))):[];return n.concat(i).sort(FE)}function f_({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:s0(e,i0.globals),inputKeyVals:t.map(n=>s0(n,i0.inputs)),outputKeyVals:r.map(n=>s0(n,i0.outputs))}}Gn.psbtToKeyVals=f_});var o0=H(Qs=>{v();w();var VE=Qs&&Qs.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),l_=Qs&&Qs.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&VE(t,e,r)};Object.defineProperty(Qs,"__esModule",{value:!0});l_(c_(),Qs);l_(d_(),Qs)});var p_=H(Gf=>{v();w();Object.defineProperty(Gf,"__esModule",{value:!0});Gf.combine=void 0;var a0=o0();function GE(e){let t=e[0],r=(0,a0.psbtToKeyVals)(t),n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");let i=h_(t);if(i===void 0)throw new Error("Combine: Self missing transaction");let s=Ca(r.globalKeyVals),o=r.inputKeyVals.map(Ca),a=r.outputKeyVals.map(Ca);for(let c of n){let u=h_(c);if(u===void 0||!u.toBuffer().equals(i.toBuffer()))throw new Error("Combine: One of the Psbts does not have the same transaction.");let d=(0,a0.psbtToKeyVals)(c);Ca(d.globalKeyVals).forEach(c0(s,r.globalKeyVals,d.globalKeyVals)),d.inputKeyVals.map(Ca).forEach((m,_)=>m.forEach(c0(o[_],r.inputKeyVals[_],d.inputKeyVals[_]))),d.outputKeyVals.map(Ca).forEach((m,_)=>m.forEach(c0(a[_],r.outputKeyVals[_],d.outputKeyVals[_])))}return(0,a0.psbtFromKeyVals)(i,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}Gf.combine=GE;function c0(e,t,r){return n=>{if(e.has(n))return;let i=r.filter(s=>s.key.toString("hex")===n)[0];t.push(i),e.add(n)}}function h_(e){return e.globalMap.unsignedTx}function Ca(e){let t=new Set;return e.forEach(r=>{let n=r.key.toString("hex");if(t.has(n))throw new Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}});var f0=H(ve=>{v();w();var WE=ve&&ve.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zE=ve&&ve.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),XE=ve&&ve.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&WE(t,e,r);return zE(t,e),t};Object.defineProperty(ve,"__esModule",{value:!0});ve.defaultLocktimeSetter=ve.defaultVersionSetter=ve.addOutputAttributes=ve.addInputAttributes=ve.updateOutput=ve.updateInput=ve.updateGlobal=ve.inputCheckUncleanFinalized=ve.getEnumLength=ve.checkHasKey=ve.checkForOutput=ve.checkForInput=void 0;var YE=XE(Ff());function g_(e,t){let r=e[t];if(r===void 0)throw new Error(`No input #${t}`);return r}ve.checkForInput=g_;function y_(e,t){let r=e[t];if(r===void 0)throw new Error(`No output #${t}`);return r}ve.checkForOutput=y_;function $E(e,t,r){if(e.key[0]<r)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&t.filter(n=>n.key.equals(e.key)).length!==0)throw new Error(`Duplicate Key: ${e.key.toString("hex")}`)}ve.checkHasKey=$E;function ZE(e){let t=0;return Object.keys(e).forEach(r=>{Number(isNaN(Number(r)))&&t++}),t}ve.getEnumLength=ZE;function JE(e,t){let r=!1;if(t.nonWitnessUtxo||t.witnessUtxo){let n=!!t.redeemScript,i=!!t.witnessScript,s=!n||!!t.finalScriptSig,o=!i||!!t.finalScriptWitness,a=!!t.finalScriptSig||!!t.finalScriptWitness;r=s&&o&&a}if(r===!1)throw new Error(`Input #${e} has too much or too little data to clean`)}ve.inputCheckUncleanFinalized=JE;function b_(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${r} and got ${JSON.stringify(n)}`)}function u0(e){return(t,r)=>{for(let n of Object.keys(t)){let i=t[n],{canAdd:s,canAddToArray:o,check:a,expected:c}=YE[e+"s"][n]||{},u=!!o;if(a)if(u){if(!Array.isArray(i)||r[n]&&!Array.isArray(r[n]))throw new Error(`Key type ${n} must be an array`);i.every(a)||b_(e,n,c,i);let d=r[n]||[],f=new Set;if(!i.every(p=>o(d,p,f)))throw new Error("Can not add duplicate data to array");r[n]=d.concat(i)}else{if(a(i)||b_(e,n,c,i),!s(r,i))throw new Error(`Can not add duplicate data to ${e}`);r[n]=i}}}}ve.updateGlobal=u0("global");ve.updateInput=u0("input");ve.updateOutput=u0("output");function QE(e,t){let r=e.length-1,n=g_(e,r);(0,ve.updateInput)(t,n)}ve.addInputAttributes=QE;function e9(e,t){let r=e.length-1,n=y_(e,r);(0,ve.updateOutput)(t,n)}ve.addOutputAttributes=e9;function t9(e,t){if(!h.Buffer.isBuffer(t)||t.length<4)throw new Error("Set Version: Invalid Transaction");return t.writeUInt32LE(e,0),t}ve.defaultVersionSetter=t9;function r9(e,t){if(!h.Buffer.isBuffer(t)||t.length<4)throw new Error("Set Locktime: Invalid Transaction");return t.writeUInt32LE(e,t.length-4),t}ve.defaultLocktimeSetter=r9});var __=H(Wf=>{v();w();Object.defineProperty(Wf,"__esModule",{value:!0});Wf.Psbt=void 0;var n9=p_(),m_=o0(),d0=gr(),Br=f0(),l0=class{static fromBase64(t,r){let n=h.Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r){let n=h.Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r){let n=(0,m_.psbtFromBuffer)(t,r),i=new this(n.globalMap.unsignedTx);return Object.assign(i,n),i}constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}toBase64(){return this.toBuffer().toString("base64")}toHex(){return this.toBuffer().toString("hex")}toBuffer(){return(0,m_.psbtToBuffer)(this)}updateGlobal(t){return(0,Br.updateGlobal)(t,this.globalMap),this}updateInput(t,r){let n=(0,Br.checkForInput)(this.inputs,t);return(0,Br.updateInput)(r,n),this}updateOutput(t,r){let n=(0,Br.checkForOutput)(this.outputs,t);return(0,Br.updateOutput)(r,n),this}addUnknownKeyValToGlobal(t){return(0,Br.checkHasKey)(t,this.globalMap.unknownKeyVals,(0,Br.getEnumLength)(d0.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,r){let n=(0,Br.checkForInput)(this.inputs,t);return(0,Br.checkHasKey)(r,n.unknownKeyVals,(0,Br.getEnumLength)(d0.InputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addUnknownKeyValToOutput(t,r){let n=(0,Br.checkForOutput)(this.outputs,t);return(0,Br.checkHasKey)(r,n.unknownKeyVals,(0,Br.getEnumLength)(d0.OutputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});let r=t.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),(0,Br.addInputAttributes)(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});let r=t.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),(0,Br.addOutputAttributes)(this.outputs,t),this}clearFinalizedInput(t){let r=(0,Br.checkForInput)(this.inputs,t);(0,Br.inputCheckUncleanFinalized)(t,r);for(let n of Object.keys(r))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete r[n];return this}combine(...t){let r=(0,n9.combine)([this].concat(t));return Object.assign(this,r),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};Wf.Psbt=l0});var Bo=H(Ee=>{v();w();var i9=Ee&&Ee.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),s9=Ee&&Ee.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),h0=Ee&&Ee.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&i9(t,e,r);return s9(t,e),t};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.signatureBlocksAction=Ee.checkInputForSig=Ee.pubkeyInScript=Ee.pubkeyPositionInScript=Ee.witnessStackToScriptWitness=Ee.isP2TR=Ee.isP2SHScript=Ee.isP2WSHScript=Ee.isP2WPKH=Ee.isP2PKH=Ee.isP2PK=Ee.isP2MS=void 0;var v_=h0(Js()),jc=h0(Xt()),zf=$s(),o9=Ir(),Ao=h0(zs());function Oo(e){return t=>{try{return e({output:t}),!0}catch{return!1}}}Ee.isP2MS=Oo(Ao.p2ms);Ee.isP2PK=Oo(Ao.p2pk);Ee.isP2PKH=Oo(Ao.p2pkh);Ee.isP2WPKH=Oo(Ao.p2wpkh);Ee.isP2WSHScript=Oo(Ao.p2wsh);Ee.isP2SHScript=Oo(Ao.p2sh);Ee.isP2TR=Oo(Ao.p2tr);function a9(e){let t=h.Buffer.allocUnsafe(0);function r(o){t=h.Buffer.concat([t,h.Buffer.from(o)])}function n(o){let a=t.length,c=v_.encodingLength(o);t=h.Buffer.concat([t,h.Buffer.allocUnsafe(c)]),v_.encode(o,t,a)}function i(o){n(o.length),r(o)}function s(o){n(o.length),o.forEach(i)}return s(e),t}Ee.witnessStackToScriptWitness=a9;function w_(e,t){let r=(0,o9.hash160)(e),n=e.slice(1,33),i=jc.decompile(t);if(i===null)throw new Error("Unknown script error");return i.findIndex(s=>typeof s=="number"?!1:s.equals(e)||s.equals(r)||s.equals(n))}Ee.pubkeyPositionInScript=w_;function c9(e,t){return w_(e,t)!==-1}Ee.pubkeyInScript=c9;function u9(e,t){return f9(e).some(n=>S_(n,jc.signature.decode,t))}Ee.checkInputForSig=u9;function S_(e,t,r){let{hashType:n}=t(e),i=[];switch(n&zf.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput"),n&31){case zf.Transaction.SIGHASH_ALL:break;case zf.Transaction.SIGHASH_SINGLE:case zf.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence");break}return i.indexOf(r)===-1}Ee.signatureBlocksAction=S_;function f9(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=d9(e)}else t=e.partialSig;return t.map(r=>r.signature)}function d9(e){let t=e.finalScriptSig?jc.decompile(e.finalScriptSig)||[]:[],r=e.finalScriptWitness?jc.decompile(e.finalScriptWitness)||[]:[];return t.concat(r).filter(n=>h.Buffer.isBuffer(n)&&jc.isCanonicalScriptSignature(n)).map(n=>({signature:n}))}});var m0=H(Je=>{v();w();Object.defineProperty(Je,"__esModule",{value:!0});Je.checkTaprootInputForSigs=Je.tapTreeFromList=Je.tapTreeToList=Je.tweakInternalPubKey=Je.checkTaprootOutputFields=Je.checkTaprootInputFields=Je.isTaprootOutput=Je.isTaprootInput=Je.serializeTaprootSignature=Je.tapScriptFinalizer=Je.toXOnly=void 0;var y0=qr(),l9=$s(),$f=Bo(),eo=Af(),h9=zs(),p9=Bo(),b9=e=>e.length===32?e:e.slice(1,33);Je.toXOnly=b9;function g9(e,t,r){let n=H9(t,e,r);try{let s=C9(t,n).concat(n.script).concat(n.controlBlock);return{finalScriptWitness:(0,$f.witnessStackToScriptWitness)(s)}}catch(i){throw new Error(`Can not finalize taproot input #${e}: ${i}`)}}Je.tapScriptFinalizer=g9;function y9(e,t){let r=t?h.Buffer.from([t]):h.Buffer.from([]);return h.Buffer.concat([e,r])}Je.serializeTaprootSignature=y9;function Xf(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&(0,$f.isP2TR)(e.witnessUtxo.script))}Je.isTaprootInput=Xf;function Yf(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t&&(0,$f.isP2TR)(t))}Je.isTaprootOutput=Yf;function m9(e,t,r){O9(e,t,r),M9(e,t,r)}Je.checkTaprootInputFields=m9;function _9(e,t,r){B9(e,t,r),v9(e,t)}Je.checkTaprootOutputFields=_9;function v9(e,t){if(!t.tapTree&&!t.tapInternalKey)return;let r=t.tapInternalKey||e.tapInternalKey,n=t.tapTree||e.tapTree;if(r){let{script:i}=e,s=w9(r,n);if(i&&!i.equals(s))throw new Error("Error adding output. Script or address missmatch.")}}function w9(e,t){let r=t&&x_(t.leaves),{output:n}=(0,h9.p2tr)({internalPubkey:e,scriptTree:r});return n}function S9(e,t){let r=t.tapInternalKey,n=r&&(0,eo.tweakKey)(r,t.tapMerkleRoot);if(!n)throw new Error(`Cannot tweak tap internal key for input #${e}. Public key: ${r&&r.toString("hex")}`);return n.x}Je.tweakInternalPubKey=S9;function x9(e){if(!(0,y0.isTaptree)(e))throw new Error("Cannot convert taptree to tapleaf list. Expecting a tapree structure.");return b0(e)}Je.tapTreeToList=x9;function x_(e=[]){return e.length===1&&e[0].depth===0?{output:e[0].script,version:e[0].leafVersion}:A9(e)}Je.tapTreeFromList=x_;function T9(e,t){return E9(e).some(n=>(0,p9.signatureBlocksAction)(n,P9,t))}Je.checkTaprootInputForSigs=T9;function P9(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||l9.Transaction.SIGHASH_DEFAULT}}function E9(e){let t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(r=>r.signature)),!t.length){let r=I9(e.finalScriptWitness);r&&t.push(r)}return t}function I9(e){if(!e)return;let t=e.slice(2);if(t.length===64||t.length===65)return t}function b0(e,t=[],r=0){if(r>eo.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");return e?(0,y0.isTapleaf)(e)?(t.push({depth:r,leafVersion:e.version||eo.LEAF_VERSION_TAPSCRIPT,script:e.output}),t):(e[0]&&b0(e[0],t,r+1),e[1]&&b0(e[1],t,r+1),t):[]}function A9(e){let t;for(let r of e)if(t=g0(r,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}function g0(e,t,r=0){if(r>eo.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===r)return t?void 0:{output:e.script,version:e.leafVersion};if((0,y0.isTapleaf)(t))return;let n=g0(e,t&&t[0],r+1);if(n)return[n,t&&t[1]];let i=g0(e,t&&t[1],r+1);if(i)return[t&&t[0],i]}function O9(e,t,r){let n=Xf(e)&&ka(t),i=ka(e)&&Xf(t),s=e===t&&Xf(t)&&ka(t);if(n||i||s)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function B9(e,t,r){let n=Yf(e)&&ka(t),i=ka(e)&&Yf(t),s=e===t&&Yf(t)&&ka(t);if(n||i||s)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function M9(e,t,r){if(t.tapMerkleRoot){let n=(t.tapLeafScript||[]).every(s=>p0(s,t.tapMerkleRoot)),i=(e.tapLeafScript||[]).every(s=>p0(s,t.tapMerkleRoot));if(!n||!i)throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(i=>p0(i,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}function p0(e,t){if(!t)return!0;let r=(0,eo.tapleafHash)({output:e.script,version:e.leafVersion});return(0,eo.rootHashFromPath)(e.controlBlock,r).equals(t)}function C9(e,t){let r=(0,eo.tapleafHash)({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(n=>n.leafHash.equals(r)).map(n=>k9(t.script,n)).sort((n,i)=>i.positionInScript-n.positionInScript).map(n=>n.signature)}function k9(e,t){return Object.assign({positionInScript:(0,$f.pubkeyPositionInScript)(t.pubkey,e)},t)}function H9(e,t,r){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);let n=(e.tapLeafScript||[]).sort((i,s)=>i.controlBlock.length-s.controlBlock.length).find(i=>N9(i,e.tapScriptSig,r));if(!n)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return n}function N9(e,t,r){let n=(0,eo.tapleafHash)({output:e.script,version:e.leafVersion});return(!r||r.equals(n))&&t.find(s=>s.leafHash.equals(n))!==void 0}function ka(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}});var rd=H(zn=>{v();w();var U9=zn&&zn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),R9=zn&&zn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),x0=zn&&zn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&U9(t,e,r);return R9(t,e),t};Object.defineProperty(zn,"__esModule",{value:!0});zn.getHashAndSighashType=zn.Psbt=void 0;var T_=__(),P_=x0(Js()),Xr=f0(),E_=Ba(),Ha=Fs(),q9=vn(),Wn=x0(zs()),L9=Af(),cs=x0(Xt()),dt=$s(),Re=m0(),_r=Bo(),k_=sn(),_0=ae(),K9=Xt(),D9=Mi(),j9=k_.signUtil.schnorr.secp256k1.schnorr,F9={network:q9.bitcoin,maximumFeeRate:5e3},Na=class{static fromBase64(t,r={}){let n=h.Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r={}){let n=h.Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r={}){let n=T_.Psbt.fromBuffer(t,V9),i=new Na(r,n);return Y9(i.__CACHE.__TX,i.__CACHE),i}constructor(t={},r=new T_.Psbt(new Jf)){this.data=r,this.opts=Object.assign({},F9,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},this.data.inputs.length===0&&this.setVersion(2);let n=(i,s,o,a)=>Object.defineProperty(i,s,{enumerable:o,writable:a});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:(0,Ha.cloneBuffer)(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let r;try{r=(0,E_.fromOutputScript)(t.script,this.opts.network)}catch{}return{script:(0,Ha.cloneBuffer)(t.script),value:t.value,address:r}})}combine(...t){return this.data.combine(...t.map(r=>r.data)),this}clone(){let t=Na.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){Zf(t),this.opts.maximumFeeRate=t}setVersion(t){Zf(t),Fc(this.data.inputs,"setVersion");let r=this.__CACHE;return r.__TX.version=t,r.__EXTRACTED_TX=void 0,this}setLocktime(t){Zf(t),Fc(this.data.inputs,"setLocktime");let r=this.__CACHE;return r.__TX.locktime=t,r.__EXTRACTED_TX=void 0,this}setInputSequence(t,r){Zf(r),Fc(this.data.inputs,"setInputSequence");let n=this.__CACHE;if(n.__TX.ins.length<=t)throw new Error("Input index too high");return n.__TX.ins[t].sequence=r,n.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(r=>this.addInput(r)),this}addInput(t){if(arguments.length>1||!t||t.hash===void 0||t.index===void 0)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");(0,Re.checkTaprootInputFields)(t,t,"addInput"),Fc(this.data.inputs,"addInput"),t.witnessScript&&Qf(t.witnessScript);let r=this.__CACHE;this.data.addInput(t);let n=r.__TX.ins[r.__TX.ins.length-1];U_(r,n);let i=this.data.inputs.length-1,s=this.data.inputs[i];return s.nonWitnessUtxo&&S0(this.__CACHE,s,i),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(r=>this.addOutput(r)),this}addOutput(t){if(arguments.length>1||!t||t.value===void 0||t.address===void 0&&t.script===void 0)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");Fc(this.data.inputs,"addOutput");let{address:r}=t;if(typeof r=="string"){let{network:i}=this.opts,s=(0,E_.toOutputScript)(r,i);t=Object.assign(t,{script:s})}(0,Re.checkTaprootOutputFields)(t,t,"addOutput");let n=this.__CACHE;return this.data.addOutput(t),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(H_))throw new Error("Not finalized");let r=this.__CACHE;if(t||W9(this,r,this.opts),r.__EXTRACTED_TX)return r.__EXTRACTED_TX;let n=r.__TX.clone();return D_(this.data.inputs,n,r,!0),n}getFeeRate(){return M_("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return M_("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return(0,Xr.checkForInput)(this.data.inputs,0),Vc(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,r){let n=(0,Xr.checkForInput)(this.data.inputs,t);return(0,Re.isTaprootInput)(n)?this._finalizeTaprootInput(t,n,void 0,r):this._finalizeInput(t,n,r)}finalizeTaprootInput(t,r,n=Re.tapScriptFinalizer){let i=(0,Xr.checkForInput)(this.data.inputs,t);if((0,Re.isTaprootInput)(i))return this._finalizeTaprootInput(t,i,r,n);throw new Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,r,n=$9){let{script:i,isP2SH:s,isP2WSH:o,isSegwit:a}=eI(t,r,this.__CACHE);if(!i)throw new Error(`No script found for input #${t}`);z9(r);let{finalScriptSig:c,finalScriptWitness:u}=n(t,r,i,a,s,o);if(c&&this.data.updateInput(t,{finalScriptSig:c}),u&&this.data.updateInput(t,{finalScriptWitness:u}),!c&&!u)throw new Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,r,n,i=Re.tapScriptFinalizer){if(!r.witnessUtxo)throw new Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(r.tapKeySig){let s=Wn.p2tr({output:r.witnessUtxo.script,signature:r.tapKeySig}),o=(0,_r.witnessStackToScriptWitness)(s.witness);this.data.updateInput(t,{finalScriptWitness:o})}else{let{finalScriptWitness:s}=i(t,r,n);this.data.updateInput(t,{finalScriptWitness:s})}return this.data.clearFinalizedInput(t),this}getInputType(t){let r=(0,Xr.checkForInput)(this.data.inputs,t),n=j_(t,r,this.__CACHE),i=td(n,t,"input",r.redeemScript||sI(r.finalScriptSig),r.witnessScript||oI(r.finalScriptWitness)),s=i.type==="raw"?"":i.type+"-",o=G_(i.meaningfulScript);return s+o}inputHasPubkey(t,r){let n=(0,Xr.checkForInput)(this.data.inputs,t);return nI(r,n,t,this.__CACHE)}inputHasHDKey(t,r){let n=(0,Xr.checkForInput)(this.data.inputs,t),i=A_(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}outputHasPubkey(t,r){let n=(0,Xr.checkForOutput)(this.data.outputs,t);return iI(r,n,t,this.__CACHE)}outputHasHDKey(t,r){let n=(0,Xr.checkForOutput)(this.data.outputs,t),i=A_(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}validateSignaturesOfAllInputs(t){return(0,Xr.checkForInput)(this.data.inputs,0),Vc(this.data.inputs.length).map(n=>this.validateSignaturesOfInput(n,t)).reduce((n,i)=>i===!0&&n,!0)}validateSignaturesOfInput(t,r,n){let i=this.data.inputs[t];return(0,Re.isTaprootInput)(i)?this.validateSignaturesOfTaprootInput(t,r,n):this._validateSignaturesOfInput(t,r,n)}_validateSignaturesOfInput(t,r,n){let i=this.data.inputs[t],s=(i||{}).partialSig;if(!i||!s||s.length<1)throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");let o=n?s.filter(f=>f.pubkey.equals(n)):s;if(o.length<1)throw new Error("No signatures for this pubkey");let a=[],c,u,d;for(let f of o){let p=cs.signature.decode(f.signature),{hash:y,script:m}=d!==p.hashType?q_(t,Object.assign({},i,{sighashType:p.hashType}),this.__CACHE,!0):{hash:c,script:u};d=p.hashType,c=y,u=m,N_(f.pubkey,m,"verify"),a.push(r(f.pubkey,y,p.signature))}return a.every(f=>f===!0)}validateSignaturesOfTaprootInput(t,r,n){let i=this.data.inputs[t],s=(i||{}).tapKeySig,o=(i||{}).tapScriptSig;if(!i&&!s&&!(o&&!o.length))throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");n=n&&(0,Re.toXOnly)(n);let a=n?w0(t,i,this.data.inputs,n,this.__CACHE):J9(t,i,this.data.inputs,this.__CACHE);if(!a.length)throw new Error("No signatures for this pubkey");let c=a.find(u=>!!u.leafHash);if(s&&c&&!r(c.pubkey,c.hash,s))return!1;if(o)for(let u of o){let d=a.find(f=>u.pubkey.equals(f.pubkey));if(d&&!r(u.pubkey,d.hash,u.signature))return!1}return!0}signAllInputsHD(t,r=[dt.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");let n=[];for(let i of Vc(this.data.inputs.length))try{this.signInputHD(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,r=[dt.Transaction.SIGHASH_ALL]){return new Promise((n,i)=>{if(!t||!t.publicKey||!t.fingerprint)return i(new Error("Need HDSigner to sign input"));let s=[],o=[];for(let a of Vc(this.data.inputs.length))o.push(this.signInputHDAsync(a,t,r).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(a=>a===!1))return i(new Error("No inputs were signed"));n()})})}signInputHD(t,r,n=[dt.Transaction.SIGHASH_ALL]){if(!r||!r.publicKey||!r.fingerprint)throw new Error("Need HDSigner to sign input");return C_(t,this.data.inputs,r).forEach(s=>this.signInput(t,s,n)),this}signInputHDAsync(t,r,n=[dt.Transaction.SIGHASH_ALL]){return new Promise((i,s)=>{if(!r||!r.publicKey||!r.fingerprint)return s(new Error("Need HDSigner to sign input"));let a=C_(t,this.data.inputs,r).map(c=>this.signInputAsync(t,c,n));return Promise.all(a).then(()=>{i()}).catch(s)})}signAllInputs(t,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");let n=[];for(let i of Vc(this.data.inputs.length))try{this.signInput(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,r){return new Promise((n,i)=>{if(!t||!t.publicKey)return i(new Error("Need Signer to sign input"));let s=[],o=[];for(let[a]of this.data.inputs.entries())o.push(this.signInputAsync(a,t,r).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(a=>a===!1))return i(new Error("No inputs were signed"));n()})})}signInput(t,r,n,i){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Xr.checkForInput)(this.data.inputs,t);return(0,Re.isTaprootInput)(s)?this._signTaprootInput(t,s,r,i,n):this._signInput(t,r,n)}signTaprootInput(t,r,n,i){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Xr.checkForInput)(this.data.inputs,t);if((0,Re.isTaprootInput)(s))return this._signTaprootInput(t,s,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)}getHashAndSighashType(t,r,n=[dt.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=Gc(this.data.inputs,t,r,this.__CACHE,n);return{hash:i,sighashType:s}}_signInput(t,r,n=[dt.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=Gc(this.data.inputs,t,r.publicKey,this.__CACHE,n),o=[{pubkey:r.publicKey,signature:cs.signature.encode(r.sign(i),s)}];return this.data.updateInput(t,{partialSig:o}),this}_signTaprootInput(t,r,n,i,s=[dt.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,r,n,i,s),a=o.filter(u=>!u.leafHash).map(u=>(0,Re.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType))[0],c=o.filter(u=>!!u.leafHash).map(u=>({pubkey:(0,Re.toXOnly)(n.publicKey),signature:(0,Re.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType),leafHash:u.leafHash}));return a&&this.data.updateInput(t,{tapKeySig:a}),c.length&&this.data.updateInput(t,{tapScriptSig:c}),this}signInputAsync(t,r,n){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let i=(0,Xr.checkForInput)(this.data.inputs,t);return(0,Re.isTaprootInput)(i)?this._signTaprootInputAsync(t,i,r,void 0,n):this._signInputAsync(t,r,n)})}signTaprootInputAsync(t,r,n,i){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Xr.checkForInput)(this.data.inputs,t);if((0,Re.isTaprootInput)(s))return this._signTaprootInputAsync(t,s,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,r,n=[dt.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=Gc(this.data.inputs,t,r.publicKey,this.__CACHE,n);return Promise.resolve(r.sign(i)).then(o=>{let a=[{pubkey:r.publicKey,signature:cs.signature.encode(o,s)}];this.data.updateInput(t,{partialSig:a})})}async _signTaprootInputAsync(t,r,n,i,s=[dt.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,r,n,i,s),a=[],c=o.filter(d=>!d.leafHash)[0];if(c){let d=Promise.resolve(n.signSchnorr(c.hash)).then(f=>({tapKeySig:(0,Re.serializeTaprootSignature)(f,r.sighashType)}));a.push(d)}let u=o.filter(d=>!!d.leafHash);if(u.length){let d=u.map(f=>Promise.resolve(n.signSchnorr(f.hash)).then(p=>({tapScriptSig:[{pubkey:(0,Re.toXOnly)(n.publicKey),signature:(0,Re.serializeTaprootSignature)(p,r.sighashType),leafHash:f.leafHash}]})));a.push(...d)}return Promise.all(a).then(d=>{d.forEach(f=>this.data.updateInput(t,f))})}checkTaprootHashesForSig(t,r,n,i,s){if(typeof n.signSchnorr!="function")throw new Error(`Need Schnorr Signer to sign taproot input #${t}.`);let o=w0(t,r,this.data.inputs,n.publicKey,this.__CACHE,i,s);if(!o||!o.length)throw new Error(`Can not sign for input #${t} with the key ${n.publicKey.toString("hex")}`);return o}toBuffer(){return v0(this.__CACHE),this.data.toBuffer()}toHex(){return v0(this.__CACHE),this.data.toHex()}toBase64(){return v0(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,r){return r.witnessScript&&Qf(r.witnessScript),(0,Re.checkTaprootInputFields)(this.data.inputs[t],r,"updateInput"),this.data.updateInput(t,r),r.nonWitnessUtxo&&S0(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,r){let n=this.data.outputs[t];return(0,Re.checkTaprootOutputFields)(n,r,"updateOutput"),this.data.updateOutput(t,r),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,r){return this.data.addUnknownKeyValToInput(t,r),this}addUnknownKeyValToOutput(t,r){return this.data.addUnknownKeyValToOutput(t,r),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}verify(t,r){let n=[dt.Transaction.SIGHASH_SINGLE|dt.Transaction.SIGHASH_ANYONECANPAY,dt.Transaction.SIGHASH_ALL,dt.Transaction.SIGHASH_DEFAULT];for(let i=0;i<this.inputCount;i++)if((0,Re.isTaprootInput)(this.data.inputs[i])){let s=h.Buffer.from((0,D9.taprootTweakPubkey)(t.slice(1))[0]),a=new Ha.BufferReader(r).readVector(),c={publicKey:s,sign(f){return h.Buffer.alloc(64)},signSchnorr(f){return h.Buffer.alloc(64)}},d=this.checkTaprootHashesForSig(i,this.data.inputs[i],c,void 0,n).filter(f=>!f.leafHash)[0].hash;if(!j9.verify(_0.base.toHex(a[0]),_0.base.toHex(d),_0.base.toHex(s)))return!1}else{let{hash:s}=Gc(this.data.inputs,i,t,this.__CACHE,n),a=new Ha.BufferReader(r).readVector(),c=K9.signature.decode(a[0]).signature,u=a[1];if(!t.equals(u))throw Error("pubKey error");if(!k_.signUtil.secp256k1.verifyWithNoRecovery(s,c,t))return!1}return!0}};zn.Psbt=Na;var V9=e=>new Jf(e),Jf=class{constructor(t=h.Buffer.from([2,0,0,0,0,0,0,0,0,0])){this.tx=dt.Transaction.fromBuffer(t),X9(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(t.hash===void 0||t.index===void 0||!h.Buffer.isBuffer(t.hash)&&typeof t.hash!="string"||typeof t.index!="number")throw new Error("Error adding input.");let r=typeof t.hash=="string"?(0,Ha.reverseBuffer)(h.Buffer.from(t.hash,"hex")):t.hash;this.tx.addInput(r,t.index,t.sequence)}addOutput(t){if(t.script===void 0||t.value===void 0||!h.Buffer.isBuffer(t.script)||typeof t.value!="number")throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}};function G9(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return I_(1,e.partialSig);case"multisig":let n=Wn.p2ms({output:t});return I_(n.m,e.partialSig,n.pubkeys);default:return!1}}function v0(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==!1)throw new Error("Not BIP174 compliant, can not export")}function I_(e,t,r){if(!t)return!1;let n;if(r?n=r.map(i=>{let s=aI(i);return t.find(o=>o.pubkey.equals(s))}).filter(i=>!!i):n=t,n.length>e)throw new Error("Too many signatures");return n.length===e}function H_(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function A_(e){return t=>!(!t.masterFingerprint.equals(e.fingerprint)||!e.derivePath(t.path).publicKey.equals(t.pubkey))}function Zf(e){if(typeof e!="number"||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function W9(e,t,r){let n=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize(),s=n*i;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(s/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}function Fc(e,t){e.forEach(r=>{if((0,Re.isTaprootInput)(r)?(0,Re.checkTaprootInputForSigs)(r,t):(0,_r.checkInputForSig)(r,t))throw new Error("Can not modify transaction, signatures exist.")})}function z9(e){if(!e.sighashType||!e.partialSig)return;let{partialSig:t,sighashType:r}=e;t.forEach(n=>{let{hashType:i}=cs.signature.decode(n.signature);if(r!==i)throw new Error("Signature sighash does not match input sighash type")})}function N_(e,t,r){if(!(0,_r.pubkeyInScript)(e,t))throw new Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}function X9(e){if(!e.ins.every(r=>r.script&&r.script.length===0&&r.witness&&r.witness.length===0))throw new Error("Format Error: Transaction ScriptSigs are not empty")}function Y9(e,t){e.ins.forEach(r=>{U_(t,r)})}function U_(e,t){let r=(0,Ha.reverseBuffer)(h.Buffer.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function R_(e,t){return(r,n,i,s)=>{let o=e({redeem:{output:i}}).output;if(!n.equals(o))throw new Error(`${t} for ${s} #${r} doesn't match the scriptPubKey in the prevout`)}}var O_=R_(Wn.p2sh,"Redeem script"),B_=R_(Wn.p2wsh,"Witness script");function M_(e,t,r,n){if(!r.every(H_))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&n.__FEE_RATE)return n.__FEE_RATE;if(e==="__FEE"&&n.__FEE)return n.__FEE;let i,s=!0;if(n.__EXTRACTED_TX?(i=n.__EXTRACTED_TX,s=!1):i=n.__TX.clone(),D_(r,i,n,s),e==="__FEE_RATE")return n.__FEE_RATE;if(e==="__FEE")return n.__FEE}function $9(e,t,r,n,i,s){let o=G_(r);if(!G9(t,r,o))throw new Error(`Can not finalize input #${e}`);return Z9(r,o,t.partialSig,n,i,s)}function Z9(e,t,r,n,i,s){let o,a,c=Q9(e,t,r),u=s?Wn.p2wsh({redeem:c}):null,d=i?Wn.p2sh({redeem:u||c}):null;return n?(u?a=(0,_r.witnessStackToScriptWitness)(u.witness):a=(0,_r.witnessStackToScriptWitness)(c.witness),d&&(o=d.input)):d?o=d.input:o=c.input,{finalScriptSig:o,finalScriptWitness:a}}function Gc(e,t,r,n,i){let s=(0,Xr.checkForInput)(e,t),{hash:o,sighashType:a,script:c}=q_(t,s,n,!1,i);return N_(r,c,"sign"),{hash:o,sighashType:a}}zn.getHashAndSighashType=Gc;function q_(e,t,r,n,i){let s=r.__TX,o=t.sighashType||dt.Transaction.SIGHASH_ALL;L_(o,i);let a,c;if(t.nonWitnessUtxo){let f=ed(r,t,e),p=s.ins[e].hash,y=f.getHash();if(!p.equals(y))throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);let m=s.ins[e].index;c=f.outs[m]}else if(t.witnessUtxo)c=t.witnessUtxo;else throw new Error("Need a Utxo input item for signing");let{meaningfulScript:u,type:d}=td(c.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(d)>=0)a=s.hashForWitnessV0(e,u,c.value,o);else if((0,_r.isP2WPKH)(u)){let f=Wn.p2pkh({hash:u.slice(2)}).output;a=s.hashForWitnessV0(e,f,c.value,o)}else{if(t.nonWitnessUtxo===void 0&&r.__UNSAFE_SIGN_NONSEGWIT===!1)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${u.toString("hex")}`);!n&&r.__UNSAFE_SIGN_NONSEGWIT!==!1&&console.warn(`Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecesor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.
*********************
PROCEED WITH CAUTION!
*********************`),a=s.hashForSignature(e,u,o)}return{script:u,sighashType:o,hash:a}}function J9(e,t,r,n){let i=[];if(t.tapInternalKey){let o=(0,Re.tweakInternalPubKey)(e,t);i.push(o)}if(t.tapScriptSig){let o=t.tapScriptSig.map(a=>a.pubkey);i.push(...o)}return i.map(o=>w0(e,t,r,o,n)).flat()}function w0(e,t,r,n,i,s,o){let a=i.__TX,c=t.sighashType||dt.Transaction.SIGHASH_DEFAULT;L_(c,o);let u=r.map((m,_)=>F_(_,m,i)),d=u.map(m=>m.script),f=u.map(m=>m.value),p=[];if(t.tapInternalKey&&!s){let m=(0,Re.tweakInternalPubKey)(e,t);if((0,Re.toXOnly)(n).equals(m)){let _=a.hashForWitnessV1(e,d,f,c);p.push({pubkey:n,hash:_})}}let y=(t.tapLeafScript||[]).map(m=>{let _=(0,L9.tapleafHash)({output:m.script,version:m.leafVersion});return Object.assign({hash:_},m)}).filter(m=>!s||s.equals(m.hash)).map(m=>{let _=a.hashForWitnessV1(e,d,f,dt.Transaction.SIGHASH_DEFAULT,m.hash);return{pubkey:n,hash:_,leafHash:m.hash}});return p.concat(y)}function L_(e,t){if(t&&t.indexOf(e)<0){let r=rI(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${r}`)}}function Q9(e,t,r){let n;switch(t){case"multisig":let i=tI(e,r);n=Wn.p2ms({output:e,signatures:i});break;case"pubkey":n=Wn.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=Wn.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=Wn.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break}return n}function eI(e,t,r){let n=r.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){let s=ed(r,t,e),o=n.ins[e].index;i.script=s.outs[o].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);return(t.witnessScript||(0,_r.isP2WPKH)(i.script))&&(i.isSegwit=!0),i}function C_(e,t,r){let n=(0,Xr.checkForInput)(t,e);if(!n.bip32Derivation||n.bip32Derivation.length===0)throw new Error("Need bip32Derivation to sign with HD");let i=n.bip32Derivation.map(o=>{if(o.masterFingerprint.equals(r.fingerprint))return o}).filter(o=>!!o);if(i.length===0)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(o=>{let a=r.derivePath(o.path);if(!o.pubkey.equals(a.publicKey))throw new Error("pubkey did not match bip32Derivation");return a})}function tI(e,t){return Wn.p2ms({output:e}).pubkeys.map(n=>(t.filter(i=>i.pubkey.equals(n))[0]||{}).signature).filter(n=>!!n)}function K_(e){let t=0;function r(o){return t+=o,e.slice(t-o,t)}function n(){let o=P_.decode(e,t);return t+=P_.decode.bytes,o}function i(){return r(n())}function s(){let o=n(),a=[];for(let c=0;c<o;c++)a.push(i());return a}return s()}function rI(e){let t=e&dt.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(e&31){case dt.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case dt.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case dt.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function S0(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;let n=dt.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;let i=e,s=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){let o=i.__NON_WITNESS_UTXO_BUF_CACHE[s],a=i.__NON_WITNESS_UTXO_TX_CACHE[s];if(o!==void 0)return o;{let c=a.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[s]=c,c}},set(o){i.__NON_WITNESS_UTXO_BUF_CACHE[s]=o}})}function D_(e,t,r,n){let i=0;e.forEach((c,u)=>{if(n&&c.finalScriptSig&&(t.ins[u].script=c.finalScriptSig),n&&c.finalScriptWitness&&(t.ins[u].witness=K_(c.finalScriptWitness)),c.witnessUtxo)i+=c.witnessUtxo.value;else if(c.nonWitnessUtxo){let d=ed(r,c,u),f=t.ins[u].index,p=d.outs[f];i+=p.value}});let s=t.outs.reduce((c,u)=>c+u.value,0),o=i-s;if(o<0)throw new Error("Outputs are spending more than Inputs");let a=t.virtualSize();r.__FEE=o,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(o/a)}function ed(e,t,r){let n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||S0(e,t,r),n[r]}function j_(e,t,r){let{script:n}=F_(e,t,r);return n}function F_(e,t,r){if(t.witnessUtxo!==void 0)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(t.nonWitnessUtxo!==void 0){let i=ed(r,t,e).outs[r.__TX.ins[e].index];return{script:i.script,value:i.value}}else throw new Error("Can't find pubkey in input without Utxo data")}function nI(e,t,r,n){let i=j_(r,t,n),{meaningfulScript:s}=td(i,r,"input",t.redeemScript,t.witnessScript);return(0,_r.pubkeyInScript)(e,s)}function iI(e,t,r,n){let i=n.__TX.outs[r].script,{meaningfulScript:s}=td(i,r,"output",t.redeemScript,t.witnessScript);return(0,_r.pubkeyInScript)(e,s)}function sI(e){if(!e)return;let t=cs.decompile(e);if(!t)return;let r=t[t.length-1];if(!(!h.Buffer.isBuffer(r)||V_(r)||cI(r)||!cs.decompile(r)))return r}function oI(e){if(!e)return;let t=K_(e),r=t[t.length-1];if(!(V_(r)||!cs.decompile(r)))return r}function aI(e){if(e.length===65){let t=e[64]&1,r=e.slice(0,33);return r[0]=2|t,r}return e.slice()}function V_(e){return e.length===33&&cs.isCanonicalPubKey(e)}function cI(e){return cs.isCanonicalScriptSignature(e)}function td(e,t,r,n,i){let s=(0,_r.isP2SHScript)(e),o=s&&n&&(0,_r.isP2WSHScript)(n),a=(0,_r.isP2WSHScript)(e);if(s&&n===void 0)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((a||o)&&i===void 0)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let c;return o?(c=i,O_(t,e,n,r),B_(t,n,i,r),Qf(c)):a?(c=i,B_(t,e,i,r),Qf(c)):s?(c=n,O_(t,e,n,r)):c=e,{meaningfulScript:c,type:o?"p2sh-p2wsh":s?"p2sh":a?"p2wsh":"raw"}}function Qf(e){if((0,_r.isP2WPKH)(e)||(0,_r.isP2SHScript)(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function G_(e){return(0,_r.isP2WPKH)(e)?"witnesspubkeyhash":(0,_r.isP2PKH)(e)?"pubkeyhash":(0,_r.isP2MS)(e)?"multisig":(0,_r.isP2PK)(e)?"pubkey":"nonstandard"}function Vc(e){return[...Array(e).keys()]}});var O0=H(ee=>{v();w();var uI=ee&&ee.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),fI=ee&&ee.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),X_=ee&&ee.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&uI(t,e,r);return fI(t,e),t};Object.defineProperty(ee,"__esModule",{value:!0});ee.generateMPCSignedPSBT=ee.generateMPCUnsignedPSBT=ee.generateMPCSignedBuyingTx=ee.generateMPCUnsignedBuyingPSBT=ee.generateMPCSignedListingPSBT=ee.generateMPCUnsignedListingPSBT=ee.generateSignedBuyingTx=ee.mergeSignedBuyingPsbt=ee.generateUnsignedBuyingPsbt=ee.generateSignedListingPsbt=ee.generateUnsignedListingPsbt=ee.extractPsbtTransaction=ee.psbtSignImpl=ee.signPsbtWithKeyPathAndScriptPathImpl=ee.signPsbtWithKeyPathAndScriptPath=ee.signPsbtWithKeyPathAndScriptPathBatch=ee.psbtDecode=ee.psbtSign=ee.classicToPsbt=ee.buildPsbt=void 0;var bn=rd(),dI=sn(),ie=ae(),pt=cn(),oe=un(),to=X_(Mi()),di=m0(),lI=Ba(),hI=Fs(),W_=Bo(),T0=X_(Xt()),pI=Ir(),bI=Up(),Wc=dI.signUtil.schnorr.secp256k1.schnorr,zc=5e3;function P0(e,t,r){return Y_(e,t,r).toHex()}ee.buildPsbt=P0;function Y_(e,t,r){let n=new bn.Psbt({network:t,maximumFeeRate:r||zc});return e.inputs.forEach(i=>{let s=(0,lI.toOutputScript)(i.address,t),o={hash:i.txId,index:i.vOut,witnessUtxo:{script:s,value:i.amount}},a=(0,pt.getAddressType)(i.address,t||oe.networks.bitcoin);i.bip32Derivation&&(a==="segwit_taproot"?o.tapBip32Derivation=i.bip32Derivation.map(c=>{let u=ie.base.fromHex(c.pubkey);return u.length!=32&&(u=u.slice(1)),{masterFingerprint:ie.base.fromHex(c.masterFingerprint),pubkey:u,path:c.path,leafHashes:c.leafHashes.map(d=>h.Buffer.from(d,"hex"))}}):o.bip32Derivation=i.bip32Derivation.map(c=>({masterFingerprint:ie.base.fromHex(c.masterFingerprint),pubkey:ie.base.fromHex(c.pubkey),path:c.path}))),a==="legacy"?o.nonWitnessUtxo=ie.base.fromHex(i.nonWitnessUtxo):a==="segwit_taproot"?i.publicKey&&(o.tapInternalKey=(0,di.toXOnly)(ie.base.fromHex(i.publicKey))):a==="segwit_nested"&&(o.redeemScript=oe.payments.p2wpkh({pubkey:h.Buffer.from(i.publicKey,"hex"),network:t}).output),i.sighashType&&(o.sighashType=i.sighashType),n.addInput(o)}),e.outputs.forEach(i=>{if(i.omniScript)n.addOutput({script:ie.base.fromHex(i.omniScript),value:0});else{let s={address:i.address,value:i.amount};i.bip32Derivation&&(s.bip32Derivation=i.bip32Derivation.map(o=>({masterFingerprint:ie.base.fromHex(o.masterFingerprint),pubkey:ie.base.fromHex(o.pubkey),path:o.path}))),n.addOutput(s)}}),n}ee.classicToPsbt=Y_;function E0(e,t,r,n){let i=bn.Psbt.fromBase64(e,{network:r,maximumFeeRate:n||zc});return J_(i,t,r),i.toBase64()}ee.psbtSign=E0;function gI(e,t,r){try{let n=bn.Psbt.fromHex(e,{network:t,maximumFeeRate:r||zc});return n.txInputs?n.txInputs.filter(i=>!i.hash.equals(h.Buffer.alloc(32))).map(i=>({txId:ie.base.toHex(ie.base.reverseBuffer(i.hash)),vOut:i.index})):[]}catch{let i=bn.Psbt.fromBase64(e,{network:t,maximumFeeRate:r||zc});return i.txInputs?i.txInputs.filter(s=>!s.hash.equals(h.Buffer.alloc(32))).map(s=>({txId:ie.base.toHex(ie.base.reverseBuffer(s.hash)),vOut:s.index})):[]}}ee.psbtDecode=gI;function yI(e,t,r,n){if(e==null||e.length==0)return[];let i=[],s=n==null?0:n.length,o=0;for(o=0;o<e.length;o++){let a={};o<s&&n&&(a=n[o]);let c=$_(e[o],t,r,{autoFinalized:a.autoFinalized,toSignInputs:a.toSignInputs});i.push(c)}return i}ee.signPsbtWithKeyPathAndScriptPathBatch=yI;function $_(e,t,r,n={}){let i=A0(e,r);return Z_(i,t,r,n.autoFinalized,n.toSignInputs),i.toHex()}ee.signPsbtWithKeyPathAndScriptPath=$_;function Z_(e,t,r,n,i){r=r||oe.networks.bitcoin;let s=(0,pt.privateKeyFromWIF)(t,r),o=new Map;i?.forEach(f=>{o.set(f.index,f)});let a={psbtIndex:0,needTweak:!0,tweakHash:h.Buffer.alloc(0),toSignInputsMap:o,publicKey:h.Buffer.alloc(0),sign(f){return(0,pt.sign)(f,s)},signSchnorr(f){let p=to.taprootTweakPrivKey(ie.base.fromHex(s));return this.toSignInputsMap?.has(this.psbtIndex)&&this.toSignInputsMap.get(this.psbtIndex)?.disableTweakSigner?h.Buffer.from(Wc.sign(f,s,ie.base.randomBytes(32))):this.needTweak?(this.needTweak&&this.tweakHash.length>0&&(p=to.taprootTweakPrivKey(ie.base.fromHex(s),this.tweakHash)),h.Buffer.from(Wc.sign(f,p,ie.base.randomBytes(32)))):h.Buffer.from(Wc.sign(f,s,ie.base.randomBytes(32)))}},c=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT],u=()=>({psbtIndex:0,needTweak:!0,tweakHash:h.Buffer.alloc(0),toSignInputsMap:o,publicKey:h.Buffer.alloc(0),getPrivateKey(){let f=ie.base.fromHex(s);return this.needTweak&&(f=h.Buffer.from(to.taprootTweakPrivKey(f,this.tweakHash))),f},sign(f){return(0,pt.sign)(f,this.getPrivateKey().toString("hex"))},signSchnorr(f){return h.Buffer.from(Wc.sign(f,this.getPrivateKey(),ie.base.randomBytes(32)))}}),d=()=>[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT];for(let f=0;f<e.inputCount;f++)if(!(o?.size>0&&!o?.has(f)))if(o?.get(f)?.useTweakSigner!==void 0){let p=e.data.inputs[f],y,m=u(),_=d();m.psbtIndex=f,m.publicKey=(0,pt.wif2Public)(t,r);let E=o.get(f);E.sighashTypes!==void 0&&(_=E.sighashTypes),m.needTweak=E.useTweakSigner,m.needTweak&&(m.publicKey=h.Buffer.from(to.taprootTweakPubkey((0,di.toXOnly)((0,pt.wif2Public)(t,r)),m.tweakHash)[0])),(0,di.isTaprootInput)(p)&&(!p.tapInternalKey&&!p.tapLeafScript&&(p.tapInternalKey=(0,di.toXOnly)((0,pt.wif2Public)(t,r))),E.tapLeafHashToSign!==void 0&&(y=h.Buffer.from(E.tapLeafHashToSign,"hex")));try{if(e.signInput(f,m,_,y),n!=null&&!n)continue;e.finalizeInput(f)}catch(I){throw I}}else{a.psbtIndex=f;let p=e.data.inputs[f];(0,di.isTaprootInput)(p)?(p.tapInternalKey||(p.tapInternalKey=(0,di.toXOnly)((0,pt.wif2Public)(t,r))),a.needTweak=!0,a.publicKey=h.Buffer.from(to.taprootTweakPubkey((0,di.toXOnly)((0,pt.wif2Public)(t,r)))[0]),o?.has(f)&&o?.get(f)?.disableTweakSigner&&(a.publicKey=(0,pt.wif2Public)(t,r),a.needTweak=!1),p.tapLeafScript&&p.tapLeafScript?.length>0&&!p.tapMerkleRoot?p.tapLeafScript.forEach(y=>{y.controlBlock&&y.script&&(a.publicKey=(0,pt.wif2Public)(t,r),a.needTweak=!1)}):p.tapMerkleRoot&&(a.needTweak=!0,a.tweakHash=p.tapMerkleRoot,a.publicKey=h.Buffer.from(to.taprootTweakPubkey((0,di.toXOnly)((0,pt.wif2Public)(t,r)),p.tapMerkleRoot)[0]))):(a.needTweak=!1,a.tweakHash=h.Buffer.alloc(0),a.publicKey=(0,pt.wif2Public)(t,r));try{if(o?.has(f)){let y=o?.get(f)?.sighashTypes;y!=null&&(c=y)}if(e.signInput(f,a,c),n!=null&&!n)continue;e.finalizeInput(f)}catch(y){if(o?.size>0&&o?.has(f))throw y}}}ee.signPsbtWithKeyPathAndScriptPathImpl=Z_;function J_(e,t,r){r=r||oe.networks.bitcoin;let n=(0,pt.privateKeyFromWIF)(t,r),i={publicKey:h.Buffer.alloc(0),sign(o){return(0,pt.sign)(o,n)},signSchnorr(o){let a=to.taprootTweakPrivKey(ie.base.fromHex(n));return h.Buffer.from(Wc.sign(o,a,ie.base.randomBytes(32)))}},s=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT];for(let o=0;o<e.inputCount;o++){if((0,di.isTaprootInput)(e.data.inputs[o])){let a=e.data.inputs[o];a.tapInternalKey||(a.tapInternalKey=(0,di.toXOnly)((0,pt.wif2Public)(t,r))),i.publicKey=h.Buffer.from(to.taprootTweakPubkey((0,di.toXOnly)((0,pt.wif2Public)(t,r)))[0])}else i.publicKey=(0,pt.wif2Public)(t,r);try{e.signInput(o,i,s)}catch{}}}ee.psbtSignImpl=J_;function I0(e,t,r){let n=bn.Psbt.fromHex(e,{network:t,maximumFeeRate:r||zc}),i;try{i=n.finalizeAllInputs().extractTransaction()}catch(s){i=n.extractTransaction(),console.log(s)}return i.toHex()}ee.extractPsbtTransaction=I0;function Q_(e,t,r){let n=oe.address.toOutputScript(e.nftAddress,t);if(((0,W_.isP2SHScript)(n)||(0,W_.isP2TR)(n))&&!r)throw new Error("Missing publicKey");let i={inputs:[],outputs:[]},s="bc1pcyj5mt2q4t4py8jnur8vpxvxxchke4pzy7tdr9yvj3u3kdfgrj6sw3rzmr";t===oe.networks.testnet&&(s="tb1pcyj5mt2q4t4py8jnur8vpxvxxchke4pzy7tdr9yvj3u3kdfgrj6see4dpv"),i.inputs.push({txId:"0".repeat(64),vOut:0,amount:0,address:s},{txId:"0".repeat(64),vOut:1,amount:0,address:s}),i.outputs.push({address:s,amount:0},{address:s,amount:0}),i.inputs.push({txId:e.nftUtxo.txHash,vOut:e.nftUtxo.vout,address:e.nftAddress,amount:e.nftUtxo.coinAmount,publicKey:r,nonWitnessUtxo:e.nftUtxo.rawTransation,sighashType:oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY}),i.outputs.push({address:e.receiveBtcAddress,amount:e.price});let o=P0(i,t);return ie.base.toBase64(ie.base.fromHex(o))}ee.generateUnsignedListingPsbt=Q_;function mI(e,t,r){let n=ie.base.toHex((0,pt.wif2Public)(t,r));return E0(Q_(e,r,n),t,r)}ee.generateSignedListingPsbt=mI;var ro=2,_I=600,vI=546;function ev(e,t,r){let n={inputs:[],outputs:[],address:e.paymentAndChangeAddress,feePerB:e.feeRate};e.dummyUtxos.forEach(o=>{n.inputs.push({txId:o.txHash,vOut:o.vout,address:e.paymentAndChangeAddress,amount:o.coinAmount,publicKey:r,nonWitnessUtxo:o.rawTransation})}),n.outputs.push({address:e.paymentAndChangeAddress,amount:e.dummyUtxos.reduce((o,a)=>o+a.coinAmount,0)});let i=[];e.sellerPsbts.forEach(o=>{let a=bn.Psbt.fromBase64(o,{network:t}),c=a.data.globalMap.unsignedTx.tx.ins[ro];i.push(a.data.globalMap.unsignedTx.tx.outs[ro]);let u=a.data.inputs[ro].witnessUtxo;u||(u=oe.Transaction.fromBuffer(a.data.inputs[ro].nonWitnessUtxo).outs[c.index]),n.inputs.push({txId:ie.base.toHex((0,hI.reverseBuffer)(c.hash)),vOut:c.index,address:oe.address.fromOutputScript(u.script,t),amount:u.value,sighashType:oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY}),n.outputs.push({address:e.receiveNftAddress,amount:u.value})}),i.forEach(o=>{n.outputs.push({address:oe.address.fromOutputScript(o.script,t),amount:o.value})}),e.paymentUtxos.forEach(o=>{n.inputs.push({txId:o.txHash,vOut:o.vout,address:e.paymentAndChangeAddress,amount:o.coinAmount,publicKey:r,nonWitnessUtxo:o.rawTransation})}),e.dummyUtxos.forEach(()=>{n.outputs.push({address:e.paymentAndChangeAddress,amount:_I})});let s=parseInt((0,pt.signBtc)(n,"",t,void 0,!1,!0));return s>=vI&&n.outputs.push({address:e.paymentAndChangeAddress,amount:s}),ie.base.toBase64(ie.base.fromHex(P0(n,t)))}ee.generateUnsignedBuyingPsbt=ev;function tv(e,t){let r=bn.Psbt.fromBase64(e),n=t.length+1;return t.forEach((i,s)=>{let o=bn.Psbt.fromBase64(i);r.data.globalMap.unsignedTx.tx.ins[n+s]=o.data.globalMap.unsignedTx.tx.ins[ro],r.data.inputs[n+s]=o.data.inputs[ro]}),r}ee.mergeSignedBuyingPsbt=tv;function wI(e,t,r){let n=ie.base.toHex((0,pt.wif2Public)(t,r)),i=E0(ev(e,r,n),t,r);return I0(tv(i,e.sellerPsbts).toHex(),r)}ee.generateSignedBuyingTx=wI;function SI(e,t,r){let n=bn.Psbt.fromBase64(e,{network:r}),i=ie.base.fromHex(t),s=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY],o=[];for(let a=0;a<n.inputCount;a++){if(a!=ro)continue;let{hash:c}=n.getHashAndSighashType(a,i,s);o.push(ie.base.toHex(c))}return{psbtBase64:e,signHashList:o}}ee.generateMPCUnsignedListingPSBT=SI;function xI(e,t,r,n){let i=bn.Psbt.fromBase64(e,{network:n}),o=[{pubkey:ie.base.fromHex(t),signature:T0.signature.encode(ie.base.fromHex(r),oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY)}];return i.data.updateInput(ro,{partialSig:o}),i.toBase64()}ee.generateMPCSignedListingPSBT=xI;function TI(e,t,r,n=1){let i=bn.Psbt.fromBase64(e,{network:r}),s=ie.base.fromHex(t),o=[oe.Transaction.SIGHASH_ALL],a=[],c=n+1;for(let u=0;u<i.inputCount;u++){if(u>=c&&u<c+n)continue;let{hash:d}=i.getHashAndSighashType(u,s,o);a.push(ie.base.toHex(d))}return{psbtBase64:e,signHashList:a}}ee.generateMPCUnsignedBuyingPSBT=TI;function PI(e,t,r,n,i=1){let s=bn.Psbt.fromBase64(e,{network:n}),o=ie.base.fromHex(t),a=i+1;for(let c=0;c<s.inputCount;c++){if(c>=a&&c<a+i)continue;let u=[{pubkey:o,signature:T0.signature.encode(ie.base.fromHex(r[c]),oe.Transaction.SIGHASH_ALL)}];s.data.updateInput(c,{partialSig:u})}return I0(s.toHex(),n)}ee.generateMPCSignedBuyingTx=PI;function rv(e,t,r){let n=A0(e,r),i=ie.base.fromHex(t),s=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT],o=[];for(let c=0;c<n.inputCount;c++)try{let{hash:u}=n.getHashAndSighashType(c,i,s);o.push(ie.base.toHex(u))}catch{let d=z_();o.push(d)}let a=new Map;return o.forEach((c,u)=>{let d=a.get(c);d=d??0,d!=null&&d>=1&&(o[u]=z_()),a.set(c,d+1)}),{psbtStr:e,signHashList:o}}ee.generateMPCUnsignedPSBT=rv;function z_(){let e=(0,pI.sha256)((0,bI.randomBytes)(32));return"ffffffff"+ie.base.toHex(e.slice(0,28))}function EI(e,t,r,n){let i=A0(e,n),s=ie.base.fromHex(t),o=oe.Transaction.SIGHASH_ALL,c=rv(e,t,n).signHashList;for(let u=0;u<i.inputCount;u++){if(c[u].slice(0,8)=="ffffffff")continue;i.data.inputs[u].sighashType!=null&&(o=i.data.inputs[u].sighashType);let d=[{pubkey:s,signature:T0.signature.encode(ie.base.fromHex(r[u]),o)}];try{i.data.updateInput(u,{partialSig:d})}catch{}}return i.toHex()}ee.generateMPCSignedPSBT=EI;function A0(e,t){let r;return ie.base.isHexString("0x"+e)?r=bn.Psbt.fromHex(e,{network:t}):r=bn.Psbt.fromBase64(e,{network:t}),r}});var uv=H(Ra=>{v();w();Object.defineProperty(Ra,"__esModule",{value:!0});Ra.verifySimple=Ra.signSimple=void 0;var Ua=ae(),iv=Ba(),sv=$s(),ov=rd(),nv=qh(),II=O0(),AI=cn(),av=Bo();function cv(e){let t="BIP0322-signed-message",r=Ua.base.sha256(h.Buffer.from(t)),n=Ua.base.sha256(h.Buffer.concat([r,r,h.Buffer.from(e)]));return Ua.base.toHex(n)}async function OI(e,t,r,n){let i=(0,iv.toOutputScript)(t,n),s=h.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),o=4294967295,a=0,c=h.Buffer.concat([h.Buffer.from("0020","hex"),h.Buffer.from(cv(e),"hex")]),u=new sv.Transaction;u.version=0,u.addInput(s,o,a,c),u.addOutput(i,0);let d=new ov.Psbt({network:n});d.setVersion(0),d.addInput({hash:u.getHash(),index:0,sequence:0,witnessUtxo:{script:i,value:0}}),(0,av.isP2TR)(i)&&d.updateInput(0,{tapInternalKey:(0,AI.wif2Public)(r,n).slice(1)}),d.addOutput({script:h.Buffer.from("6a","hex"),value:0}),(0,II.psbtSignImpl)(d,r,n),d.finalizeAllInputs();let f=d.extractTransaction();function p(_){return h.Buffer.concat([(0,nv.encode)(_.byteLength),_])}let y=(0,nv.encode)(f.ins[0].witness.length),m=h.Buffer.concat([y,...f.ins[0].witness.map(_=>p(_))]);return Ua.base.toBase64(m)}Ra.signSimple=OI;function BI(e,t,r,n,i){let s=(0,iv.toOutputScript)(t,i),o=h.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),a=4294967295,c=0,u=h.Buffer.concat([h.Buffer.from("0020","hex"),h.Buffer.from(cv(e),"hex")]),d=new sv.Transaction;d.version=0,d.addInput(o,a,c,u),d.addOutput(s,0);let f=new ov.Psbt;f.setVersion(0),f.addInput({hash:d.getHash(),index:0,sequence:0,witnessUtxo:{script:s,value:0}});let p=Ua.base.fromHex(n);return(0,av.isP2TR)(s)&&f.updateInput(0,{tapInternalKey:p.slice(1)}),f.addOutput({script:h.Buffer.from("6a","hex"),value:0}),f.verify(p,h.Buffer.from(Ua.base.fromBase64(r)))}Ra.verifySimple=BI});var un=H(qe=>{v();w();var MI=qe&&qe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),CI=qe&&qe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Mo=qe&&qe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&MI(t,e,r);return CI(t,e),t};Object.defineProperty(qe,"__esModule",{value:!0});qe.BufferWriter=qe.Transaction=qe.psbt=qe.bip0322=qe.script=qe.payments=qe.networks=qe.crypto=qe.address=void 0;var kI=Mo(Ba());qe.address=kI;var HI=Mo(Ir());qe.crypto=HI;var NI=Mo(vn());qe.networks=NI;var UI=Mo(zs());qe.payments=UI;var RI=Mo(Xt());qe.script=RI;var qI=Mo(uv());qe.bip0322=qI;var LI=Mo(rd());qe.psbt=LI;var KI=$s();Object.defineProperty(qe,"Transaction",{enumerable:!0,get:function(){return KI.Transaction}});var DI=Fs();Object.defineProperty(qe,"BufferWriter",{enumerable:!0,get:function(){return DI.BufferWriter}})});var id=H(nd=>{v();w();Object.defineProperty(nd,"__esModule",{value:!0});nd.validate=void 0;function jI(e,t){if(!e)throw new Error(t)}nd.validate=jI});var lv=H(qa=>{v();w();Object.defineProperty(qa,"__esModule",{value:!0});qa.decode=qa.encode=void 0;var dv=id(),FI="qpzry9x8gf2tvdw0s3jn54khce6mua7l",fv={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};function VI(e){for(var t="",r=0;r<e.length;++r){var n=e[r];(0,dv.validate)(0<=n&&n<32,"Invalid value: "+n+"."),t+=FI[n]}return t}qa.encode=VI;function GI(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r){var n=e[r];(0,dv.validate)(n in fv,"Invalid value: "+n+"."),t[r]=fv[n]}return t}qa.decode=GI});var pv=H(sd=>{v();w();Object.defineProperty(sd,"__esModule",{value:!0});sd.convert=void 0;var hv=id();function WI(e,t,r,n){for(var i=n?Math.floor(e.length*t/r):Math.ceil(e.length*t/r),s=(1<<r)-1,o=new Uint8Array(i),a=0,c=0,u=0,d=0;d<e.length;++d){var f=e[d];for((0,hv.validate)(0<=f&&f>>t===0,"Invalid value: "+f+"."),c=c<<t|f,u+=t;u>=r;)u-=r,o[a]=c>>u&s,++a}return n?(0,hv.validate)(u<t&&(c<<r-u&s)===0,"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):u>0&&(o[a]=c<<r-u&s,++a),o}sd.convert=WI});var vv=H(Xn=>{v();w();var zI=Xn&&Xn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),XI=Xn&&Xn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),bv=Xn&&Xn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&zI(t,e,r);return XI(t,e),t};Object.defineProperty(Xn,"__esModule",{value:!0});Xn.decode=Xn.encode=void 0;var gv=bv(lv()),YI=T3(),yv=bv(pv()),B0=id();function $I(e,t,r){let n=Co(mv(e),new Uint8Array(1)),i=QI(t)+tA(r),s=nA(Co(new Uint8Array([i]),r)),o=Co(Co(n,s),new Uint8Array(8)),a=Co(s,JI(_v(o)));return e+":"+gv.encode(a)}Xn.encode=$I;function ZI(e){let t=e.toLowerCase().split(":");(0,B0.validate)(t.length===2,"Missing prefix: "+e+".");let r=t[0],n=gv.decode(t[1]);(0,B0.validate)(sA(r,n),"Invalid checksum: "+e+".");let i=iA(n.subarray(0,-8)),s=i[0],o=i.subarray(1);(0,B0.validate)(rA(s)===o.length*8,"Invalid hash size: "+e+".");let a=eA(s);return{prefix:r,type:a,hash:o}}Xn.decode=ZI;function mv(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0)&31;return t}function JI(e){for(var t=new Uint8Array(8),r=0;r<8;++r)t[7-r]=e.and(31).toJSNumber(),e=e.shiftRight(5);return t}function QI(e){switch(e){case"P2PKH":return 0;case"P2SH":return 8;default:throw new Error("Invalid type: "+e+".")}}function eA(e){switch(e&120){case 0:return"P2PKH";case 8:return"P2SH";default:throw new Error("Invalid address type in version byte: "+e+".")}}function tA(e){switch(e.length*8){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new Error("Invalid hash size: "+e.length+".")}}function rA(e){switch(e&7){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512}}function nA(e){return yv.convert(e,8,5,!1)}function iA(e){return yv.convert(e,5,8,!0)}function Co(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function _v(e){for(var t=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336],r=YI(1),n=0;n<e.length;++n){var i=e[n],s=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(i);for(var o=0;o<t.length;++o)s.shiftRight(o).and(1).equals(1)&&(r=r.xor(t[o]))}return r.xor(1)}function sA(e,t){var r=Co(mv(e),new Uint8Array(1)),n=Co(r,t);return _v(n).equals(0)}});var Tv=H(Qt=>{v();w();var oA=Qt&&Qt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),aA=Qt&&Qt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Sv=Qt&&Qt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&oA(t,e,r);return aA(t,e),t};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.convert2LegacyAddress=Qt.isCashAddress=Qt.ValidateBitcashP2PkHAddress=Qt.GetBitcashP2PkHAddressByPublicKey=Qt.GetBitcashAddressByPublicKey=Qt.GetBitcashAddressByHash=void 0;var xv=Ir(),od=Sv(vv()),wv=Sv(zs());function M0(e,t,r){return od.encode(e,t,r)}Qt.GetBitcashAddressByHash=M0;function cA(e,t,r){let n=(0,xv.hash160)(h.Buffer.from(r));return M0(e,t,n)}Qt.GetBitcashAddressByPublicKey=cA;function uA(e){let t=(0,xv.hash160)(h.Buffer.from(e));return M0("bitcoincash","P2PKH",t)}Qt.GetBitcashP2PkHAddressByPublicKey=uA;function fA(e){try{e.indexOf(":")===-1&&(e="bitcoincash:"+e);let{prefix:t,type:r,hash:n}=od.decode(e);return r==="P2PKH"&&n.length===20}catch{return!1}}Qt.ValidateBitcashP2PkHAddress=fA;function dA(e){try{return e.startsWith("bitcoincash:")||(e="bitcoincash:"+e,od.decode(e)),!0}catch{return!1}}Qt.isCashAddress=dA;function lA(e,t){e.indexOf(":")===-1&&(e="bitcoincash:"+e);let{type:r,hash:n}=od.decode(e);if(r=="P2PKH")return wv.p2pkh({hash:h.Buffer.from(n),network:t}).address;if(r=="P2SH")return wv.p2sh({hash:h.Buffer.from(n),network:t}).address;throw new Error("convert2LegacyAddress error")}Qt.convert2LegacyAddress=lA});var Ev=H(Pv=>{v();w();Object.defineProperty(Pv,"__esModule",{value:!0})});var Mv=H(Yn=>{v();w();var hA=Yn&&Yn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),pA=Yn&&Yn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),C0=Yn&&Yn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&hA(t,e,r);return pA(t,e),t};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.srcInscribe=Yn.SrcInscriptionTool=void 0;var Lr=C0(un()),bA=sn(),La=ae(),gA=C0(Mi()),yA=C0(Ir()),Xc=cn(),mA=un(),Iv=Oa(),_A=bA.signUtil.schnorr.secp256k1.schnorr,vA=2,Av=31,wA=4294967293,SA=7800,xA=7800,pL=4e6/10,Ka=class{constructor(){this.network=Lr.networks.bitcoin,this.revealTxs=[],this.commitTx=new Lr.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newSrcInscriptionTool(t,r){let n=new Ka;n.network=t;let i=r.revealOutValue||SA,s=r.minChangeValue||xA;return n.buildCommitTx(t,r.inscriptionData,i,r.commitTxPrevOutputList,r.changeAddress,r.commitFeeRate,s)||n.signCommitTx(r.commitTxPrevOutputList),n}buildCommitTx(t,r,n,i,s,o,a){let c=h.Buffer.from(r.contentType),u=h.Buffer.from(r.body);for(;u[u.length-1]==0;)u=u.slice(0,u.length-1);let d=2+c.length+u.length,f=d%62==0?d:d+62-d%62,p=mA.BufferWriter.withCapacity(f);p.writeSlice(h.Buffer.from([(c.length+u.length)/256,(c.length+u.length)%256])),p.writeSlice(c),p.writeSlice(u),f>d&&p.writeSlice(h.Buffer.alloc(f-d));let y=p.end(),m=La.base.fromHex(IA(i[0].txId,y.toString("hex"))),_=0,E=0,I=new Lr.Transaction;for(I.version=vA,E+=n,I.addOutput(Lr.address.toOutputScript(r.revealAddr,t),n);m.length;){let L=m.slice(0,Math.min(Av,m.length)),K=L.toString("hex");K.length<62&&(K=K+"0".repeat(62-K.length)),m=m.slice(L.length);let O=m.slice(0,Math.min(Av,m.length)).toString("hex");O.length<62&&(O=O+"0".repeat(62-O.length)),m=m.slice(L.length);let l=["03"+K+"00","02"+O+"00","020202020202020202020202020202020202020202020202020202020202020202"].map(S=>h.Buffer.from(S,"hex")),g=Lr.payments.p2ms({m:1,pubkeys:l});I.addOutput(g.output,n),E+=n}i.forEach(L=>{let K=La.base.reverseBuffer(La.base.fromHex(L.txId));I.addInput(K,L.vOut,wA),this.commitTxPrevOutputFetcher.push(L.amount),_+=L.amount});let k=Lr.address.toOutputScript(s,t);I.addOutput(k,0);let C=I.clone();Ov(C,i,this.network);let R=(0,Iv.countAdjustedVsize)(C,i.map(L=>L.address),t),U=Math.floor(R*o),q=_-E-U;if(q>=a)I.outs[I.outs.length-1].value=q;else{I.outs=I.outs.slice(0,I.outs.length-1),C.outs=C.outs.slice(0,C.outs.length-1);let L=(0,Iv.countAdjustedVsize)(C,i.map(W=>W.address),t),K=Math.floor(L*o);if(_-E-K<0)return this.mustCommitTxFee=U,!0}return this.commitTx=I,!1}signCommitTx(t){Ov(this.commitTx,t,this.network)}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};Yn.SrcInscriptionTool=Ka;function Ov(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Xc.getAddressType)(t[i].address,r),o=La.base.fromHex((0,Xc.privateKeyFromWIF)(t[i].privateKey,r)),a=La.base.toHex(o),c=(0,Xc.private2public)(a);if(s==="segwit_taproot"){let u=t.map(m=>Lr.address.toOutputScript(m.address,r)),d=t.map(m=>m.amount),f=e.hashForWitnessV1(i,u,d,Lr.Transaction.SIGHASH_DEFAULT),p=gA.taprootTweakPrivKey(o),y=h.Buffer.from(_A.sign(f,p,La.base.randomBytes(32)));n.witness=[h.Buffer.from(y)]}else if(s==="legacy"){let u=Lr.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,Lr.Transaction.SIGHASH_ALL),f=(0,Xc.sign)(d,a),p=Lr.payments.p2pkh({signature:Lr.script.signature.encode(f,Lr.Transaction.SIGHASH_ALL),pubkey:c});n.script=p.input}else{let u=yA.hash160(c),d=h.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,p=e.hashForWitness(i,d,f,Lr.Transaction.SIGHASH_ALL),y=(0,Xc.sign)(p,a);n.witness=[Lr.script.signature.encode(y,Lr.Transaction.SIGHASH_ALL),c];let m=h.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=m)}})}function TA(e,t){let r=Ka.newSrcInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}Yn.srcInscribe=TA;function PA(e,t){for(var r=[],n=0,i,s="",o=0;o<256;o++)r[o]=o;for(o=0;o<256;o++)n=(n+r[o]+e.charCodeAt(o%e.length))%256,i=r[o],r[o]=r[n],r[n]=i;o=0,n=0;for(var a=0;a<t.length;a++)o=(o+1)%256,n=(n+r[o])%256,i=r[o],r[o]=r[n],r[n]=i,s+=String.fromCharCode(t.charCodeAt(a)^r[(r[o]+r[n])%256]);return s}function Bv(e){for(var t=[],r,n=0;n<e.length-1;n+=2){var i=parseInt(e.substr(n,2),16);t.push(i)}return r=String.fromCharCode.apply(String,t),r}function EA(e){var t,r,n="",i;for(e+="",t=0,r=e.length;t<r;t++)i=e.charCodeAt(t).toString(16),n+=i.length<2?"0"+i:i;return n}function IA(e,t){return EA(PA(Bv(e),Bv(t)))}});var Lv=H(Kr=>{v();w();var AA=Kr&&Kr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),OA=Kr&&Kr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),N0=Kr&&Kr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&AA(t,e,r);return OA(t,e),t};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.inscribeForMPCSigned=Kr.inscribeForMPCUnsigned=Kr.inscribe=Kr.InscriptionTool=void 0;var se=N0(un()),BA=sn(),Sn=ae(),MA=N0(Mi()),kv=N0(Ir()),Hv=$s(),no=cn(),k0=Bo(),ad=Oa(),U0=BA.signUtil.schnorr.secp256k1.schnorr,cd=2,ud=4294967293,Nv=546,Uv=546,Cv=4e6/10,Da=class{constructor(){this.network=se.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new se.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newInscriptionTool(t,r){let n=new Da;n.network=t;let i=r.revealOutValue||Nv,s=r.minChangeValue||Uv,o=r.commitTxPrevOutputList[0].privateKey;r.inscriptionDataList.forEach(u=>{n.inscriptionTxCtxDataList.push(Rv(t,u,o))});let a=n.buildEmptyRevealTx(t,i,r.revealFeeRate);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,a,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTx(t,r,n){let i=0,s=[],o=[],a=[];return this.inscriptionTxCtxDataList.forEach((c,u)=>{let d=new se.Transaction;d.version=cd,d.addInput(h.Buffer.alloc(32),u,ud),d.addOutput(c.revealPkScript,r);let f=h.Buffer.alloc(64),p=h.Buffer.alloc(33),y=[];y.push(f),y.push(c.inscriptionScript),y.push(p);let m=Math.floor((d.byteLength()+Math.floor(((0,Hv.vectorSize)(y)+2+3)/4))*n),_=r+m;c.revealTxPrevOutput={pkScript:c.commitTxAddressPkScript,value:_},i+=_,s.push(d),o.push(m),a.push(c.commitTxAddress)}),this.revealTxs=s,this.mustRevealTxFees=o,this.commitAddrs=a,i}buildCommitTx(t,r,n,i,s,o){let a=0,c=new se.Transaction;c.version=cd,r.forEach(m=>{let _=Sn.base.reverseBuffer(Sn.base.fromHex(m.txId));c.addInput(_,m.vOut,ud),this.commitTxPrevOutputFetcher.push(m.amount),a+=m.amount}),this.inscriptionTxCtxDataList.forEach(m=>{c.addOutput(m.revealTxPrevOutput.pkScript,m.revealTxPrevOutput.value)});let u=se.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();H0(d,r.map(m=>({...m,privateKey:""})),this.network);let f=(0,ad.countAdjustedVsize)(d,r.map(m=>m.address),t),p=Math.floor(f*s),y=a-i-p;if(y>=o)c.outs[c.outs.length-1].value=y;else{c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let m=(0,ad.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(m*s);if(a-i-_<0)return this.mustCommitTxFee=p,!0}return this.commitTx=c,!1}signCommitTx(t){H0(this.commitTx,t,this.network)}completeRevealTx(){this.revealTxs.forEach((t,r)=>{t.ins[0].hash=this.commitTx.getHash();let n=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.pkScript],i=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value];this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value);let s=t.hashForWitnessV1(0,n,i,se.Transaction.SIGHASH_DEFAULT,this.inscriptionTxCtxDataList[r].hash),o=h.Buffer.from(U0.sign(s,this.inscriptionTxCtxDataList[r].privateKey,Sn.base.randomBytes(32)));t.ins[0].witness=[h.Buffer.from(o),...this.inscriptionTxCtxDataList[r].witness];let a=t.weight();if(a>Cv)throw new Error(`reveal(index ${r}) transaction weight greater than ${Cv} (MAX_STANDARD_TX_WEIGHT): ${a}`)})}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};Kr.InscriptionTool=Da;function H0(e,t,r){e.ins.forEach((n,i)=>{let s=(0,no.getAddressType)(t[i].address,r);if(t[i].privateKey==""){let{witness:u,script:d}=(0,no.fakeSign)(s);u!==void 0&&(n.witness=u),d!==void 0&&(n.script=d);return}let o=Sn.base.fromHex((0,no.privateKeyFromWIF)(t[i].privateKey,r)),a=Sn.base.toHex(o),c=(0,no.private2public)(a);if(s==="segwit_taproot"){let u=t.map(m=>se.address.toOutputScript(m.address,r)),d=t.map(m=>m.amount),f=e.hashForWitnessV1(i,u,d,se.Transaction.SIGHASH_DEFAULT),p=MA.taprootTweakPrivKey(o),y=h.Buffer.from(U0.sign(f,p,Sn.base.randomBytes(32)));n.witness=[h.Buffer.from(y)]}else if(s==="legacy"){let u=se.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,se.Transaction.SIGHASH_ALL),f=(0,no.sign)(d,a),p=se.payments.p2pkh({signature:se.script.signature.encode(f,se.Transaction.SIGHASH_ALL),pubkey:c});n.script=p.input}else{let u=kv.hash160(c),d=h.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,p=e.hashForWitness(i,d,f,se.Transaction.SIGHASH_ALL),y=(0,no.sign)(p,a);n.witness=[se.script.signature.encode(y,se.Transaction.SIGHASH_ALL),c];let m=h.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=m)}})}function Rv(e,t,r){let n=Sn.base.fromHex((0,no.privateKeyFromWIF)(r,e)),i=(0,no.wif2Public)(r,e).slice(1),s=se.script.OPS,o=[];o.push(i),o.push(s.OP_CHECKSIG),o.push(s.OP_FALSE),o.push(s.OP_IF),o.push(h.Buffer.from("ord")),o.push(s.OP_DATA_1),o.push(s.OP_DATA_1),o.push(h.Buffer.from(t.contentType)),o.push(s.OP_0);let a=520,c=h.Buffer.from(t.body),u=c.length;for(let I=0;I<u;I+=a){let k=I+a;k>u&&(k=u),o.push(c.slice(I,k))}o.push(s.OP_ENDIF);let d=se.script.compile(o),f={output:d},p={output:d,redeemVersion:192},{output:y,witness:m,hash:_,address:E}=se.payments.p2tr({internalPubkey:i,scriptTree:f,redeem:p,network:e});return{privateKey:n,inscriptionScript:d,commitTxAddress:E,commitTxAddressPkScript:y,witness:m,hash:_,revealTxPrevOutput:{pkScript:h.Buffer.alloc(0),value:0},revealPkScript:se.address.toOutputScript(t.revealAddr,e)}}function CA(e,t){let r=Da.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}Kr.inscribe=CA;function qv(e,t,r,n){let i=e.commitTxPrevOutputList[0].privateKey,s=[];e.inscriptionDataList.forEach(U=>{s.push(Rv(t,U,i))});let o=0,a=e.revealOutValue||Nv,c=[];s.forEach((U,q)=>{let L=new se.Transaction;L.version=cd,L.addInput(h.Buffer.alloc(32),q,ud),L.addOutput(U.revealPkScript,a),c.push(L);let K=h.Buffer.alloc(64),W=h.Buffer.alloc(33),O=[];O.push(K),O.push(U.inscriptionScript),O.push(W);let l=Math.floor((L.byteLength()+Math.floor(((0,Hv.vectorSize)(O)+2+3)/4))*e.revealFeeRate),g=a+l;U.revealTxPrevOutput={pkScript:U.commitTxAddressPkScript,value:g},o+=g});let u=0,d=new se.Transaction;d.version=cd,e.commitTxPrevOutputList.forEach(U=>{d.addInput(Sn.base.reverseBuffer(Sn.base.fromHex(U.txId)),U.vOut,ud),u+=U.amount});let f=[];s.forEach(U=>{d.addOutput(U.revealTxPrevOutput.pkScript,U.revealTxPrevOutput.value),f.push(U.commitTxAddress)});let p=se.address.toOutputScript(e.changeAddress,t);d.addOutput(p,0);let y=d.clone();H0(y,e.commitTxPrevOutputList,t);let m=(0,ad.countAdjustedVsize)(y,e.commitTxPrevOutputList.map(U=>U.address),t),_=Math.floor(m*e.commitFeeRate),E=u-o-_;if(E>=(e.minChangeValue||Uv))d.outs[d.outs.length-1].value=E;else{d.outs=d.outs.slice(0,d.outs.length-1),y.outs=y.outs.slice(0,y.outs.length-1);let U=(0,ad.countAdjustedVsize)(y,e.commitTxPrevOutputList.map(L=>L.address),t),q=Math.floor(U*e.commitFeeRate);if(u-o-q<0)throw new Error("insufficient balance")}let I=HA(d,e.commitTxPrevOutputList,t),k=d.getHash();n&&(k=n),c.forEach((U,q)=>{U.ins[0].hash=k;let L=[s[q].revealTxPrevOutput.pkScript],K=[s[q].revealTxPrevOutput.value],W=U.hashForWitnessV1(0,L,K,se.Transaction.SIGHASH_DEFAULT,s[q].hash),O=h.Buffer.from(U0.sign(W,s[q].privateKey,Sn.base.randomBytes(32)));U.ins[0].witness=[O,...s[q].witness]});let C=0;d.ins.forEach((U,q)=>{C+=e.commitTxPrevOutputList[q].amount}),d.outs.forEach(U=>{C-=U.value});let R=[];return c.forEach((U,q)=>{let L=0;L+=s[q].revealTxPrevOutput.value,L-=U.outs[0].value,R.push(L)}),{signHashList:I,commitTx:d.toHex(),revealTxs:c.map(U=>U.toHex()),commitTxFee:C,revealTxFees:R,commitAddrs:f}}Kr.inscribeForMPCUnsigned=qv;function kA(e,t){let r=e.commitTx,n=e.signatureList,i=se.Transaction.fromHex(r),s=i.getHash();i.ins.forEach((c,u)=>{let d=Sn.base.fromHex(n[u]);!c.witness||c.witness.length==0?c.script=se.payments.p2pkh({pubkey:se.payments.p2pkh({input:c.script}).pubkey,signature:se.script.signature.encode(d,se.Transaction.SIGHASH_ALL)}).input:c.witness[0]=se.script.signature.encode(d,se.Transaction.SIGHASH_ALL)});let o=i.getHash(),a=qv(e,t,s,o);return{signHashList:null,commitTx:i.toHex(),revealTxs:a.revealTxs,commitTxFee:a.commitTxFee,revealTxFees:a.revealTxFees,commitAddrs:a.commitAddrs}}Kr.inscribeForMPCSigned=kA;function HA(e,t,r){let n=[];return e.ins.forEach((i,s)=>{let o=Sn.base.fromHex(t[s].publicKey),a=se.address.toOutputScript(t[s].address,r),c=h.Buffer.alloc(64,0),u;if((0,k0.isP2TR)(a)){let d=t.map(p=>se.address.toOutputScript(p.address,r)),f=t.map(p=>p.amount);u=e.hashForWitnessV1(s,d,f,se.Transaction.SIGHASH_DEFAULT),i.witness=[c]}else if((0,k0.isP2PKH)(a)){let d=se.address.toOutputScript(t[s].address,r);u=e.hashForSignature(s,d,se.Transaction.SIGHASH_ALL),i.script=se.payments.p2pkh({pubkey:o,signature:se.script.signature.encode(c,se.Transaction.SIGHASH_ALL)}).input}else{let d=kv.hash160(o),f=h.Buffer.of(25,118,169,20,...d,136,172);u=e.hashForWitness(s,f,t[s].amount,se.Transaction.SIGHASH_ALL),i.witness=se.payments.p2wpkh({pubkey:o,signature:se.script.signature.encode(c,se.Transaction.SIGHASH_ALL)}).witness;let p=h.Buffer.of(22,0,20,...d);(0,k0.isP2SHScript)(a)&&(i.script=p)}n.push(Sn.base.toHex(u))}),n}});var Fv=H(gn=>{v();w();var NA=gn&&gn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),UA=gn&&gn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),R0=gn&&gn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&NA(t,e,r);return UA(t,e),t};Object.defineProperty(gn,"__esModule",{value:!0});gn.inscribeRefundFee=gn.createInscriptionTxCtxData=gn.InscriptionRefundFeeTool=void 0;var vr=R0(un()),RA=sn(),ja=ae(),qA=R0(Mi()),LA=R0(Ir()),ko=cn(),Kv=Oa(),KA=RA.signUtil.schnorr.secp256k1.schnorr,DA=2,jA=4294967293,FA=546,wL=4e6/10,Fa=class{constructor(){this.network=vr.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.refundFeeTx=new vr.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustTxFee=0,this.dustChange=0,this.commitAddrs=[],this.merkleRoot=new Uint8Array}static newInscriptionRefundFeeTool(t,r){let n=new Fa;n.network=t;let i=r.minChangeValue||FA;if(r.inputs&&r.inputs.length>600)throw new Error("invalid amount of inputs");let s=100;r.maxAmountOfInput&&(s=r.maxAmountOfInput),s>r.inputs.length&&(s=r.inputs.length);let o=r.inputs[0].privateKey;if(r.inscriptionRefundFeeDataList.forEach(c=>{n.inscriptionTxCtxDataList.push(jv(t,c,o))}),r.middleAddress&&r.middleAddress!=n.inscriptionTxCtxDataList[0].commitTxAddress)throw new Error("invalid middle address");return n.commitAddrs=[n.inscriptionTxCtxDataList[0].commitTxAddress],n.merkleRoot=n.inscriptionTxCtxDataList[0].hash,n.buildrRefundFeeTx(t,r.inputs.slice(0,s),r.changeAddress,0,r.feeRate,i)||n.signRefundFeeTx(r.inputs.slice(0,s)),n}buildrRefundFeeTx(t,r,n,i,s,o){let a=0,c=new vr.Transaction;c.version=DA,r.forEach(m=>{let _=ja.base.reverseBuffer(ja.base.fromHex(m.txId));c.addInput(_,m.vOut,jA),this.commitTxPrevOutputFetcher.push(m.amount),a+=m.amount});let u=vr.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();Dv(d,r,this.network);let f=(0,Kv.countAdjustedVsize)(d,r.map(m=>m.address),t),p=Math.floor(f*s),y=a-i-p;if(y>=o)c.outs[c.outs.length-1].value=y;else{if(c.outs.length<=1)return this.dustChange=y,!0;c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let m=(0,Kv.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(m*s);if(a-i-_<0)return this.mustTxFee=p,!0}return this.refundFeeTx=c,!1}signRefundFeeTx(t){Dv(this.refundFeeTx,t,this.network,this.merkleRoot)}calculateFee(){let t=0;return this.refundFeeTx.ins.forEach((r,n)=>{t+=this.commitTxPrevOutputFetcher[n]}),this.refundFeeTx.outs.forEach(r=>{t-=r.value}),{refundFeeTxFee:t}}};gn.InscriptionRefundFeeTool=Fa;function Dv(e,t,r,n=new Uint8Array){e.ins.forEach((i,s)=>{let o=(0,ko.getAddressType)(t[s].address,r),a=ja.base.fromHex((0,ko.privateKeyFromWIF)(t[s].privateKey,r)),c=ja.base.toHex(a),u=(0,ko.private2public)(c);if(o==="segwit_taproot"){let d=t.map(_=>vr.address.toOutputScript(_.address,r)),f=t.map(_=>_.amount),p=e.hashForWitnessV1(s,d,f,vr.Transaction.SIGHASH_DEFAULT),y=qA.taprootTweakPrivKey(a,n),m=h.Buffer.from(KA.sign(p,y,ja.base.randomBytes(32)));i.witness=[h.Buffer.from(m)]}else if(o==="legacy"){let d=vr.address.toOutputScript(t[s].address,r),f=e.hashForSignature(s,d,vr.Transaction.SIGHASH_ALL),p=(0,ko.sign)(f,c),y=vr.payments.p2pkh({signature:vr.script.signature.encode(p,vr.Transaction.SIGHASH_ALL),pubkey:u});i.script=y.input}else{let d=LA.hash160(u),f=h.Buffer.of(25,118,169,20,...d,136,172),p=t[s].amount,y=e.hashForWitness(s,f,p,vr.Transaction.SIGHASH_ALL),m=(0,ko.sign)(y,c);i.witness=[vr.script.signature.encode(m,vr.Transaction.SIGHASH_ALL),u];let _=h.Buffer.of(22,0,20,...d);o==="segwit_nested"&&(i.script=_)}})}function jv(e,t,r){let n=ja.base.fromHex((0,ko.privateKeyFromWIF)(r,e)),i=(0,ko.wif2Public)(r,e).slice(1),s=vr.script.OPS,o=[];o.push(i),o.push(s.OP_CHECKSIG),o.push(s.OP_FALSE),o.push(s.OP_IF),o.push(h.Buffer.from("ord")),o.push(s.OP_DATA_1),o.push(s.OP_DATA_1),o.push(h.Buffer.from(t.contentType)),o.push(s.OP_0);let a=520,c=h.Buffer.from(t.body),u=c.length;for(let I=0;I<u;I+=a){let k=I+a;k>u&&(k=u),o.push(c.slice(I,k))}o.push(s.OP_ENDIF);let d=vr.script.compile(o),f={output:d},p={output:d,redeemVersion:192},{output:y,witness:m,hash:_,address:E}=vr.payments.p2tr({internalPubkey:i,scriptTree:f,redeem:p,network:e});return{privateKey:n,inscriptionScript:d,commitTxAddress:E,commitTxAddressPkScript:y,witness:m,hash:_,revealTxPrevOutput:{pkScript:h.Buffer.alloc(0),value:0},revealPkScript:vr.address.toOutputScript(t.revealAddr,e)}}gn.createInscriptionTxCtxData=jv;function VA(e,t){let r=Fa.newInscriptionRefundFeeTool(e,t);return r.mustTxFee>0||r.dustChange!=0?{refundFeeTx:"",mustTxFee:r.mustTxFee,dustChange:r.dustChange}:{refundFeeTx:r.refundFeeTx.toHex(),...r.calculateFee(),middleAddresses:r.commitAddrs}}gn.inscribeRefundFee=VA});var Yv=H(lt=>{v();w();var GA=lt&&lt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),WA=lt&&lt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),K0=lt&&lt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&GA(t,e,r);return WA(t,e),t};Object.defineProperty(lt,"__esModule",{value:!0});lt.dogInscribe=lt.DogInscriptionTool=lt.DogScript=lt.bufferToChunk=lt.bufferToBuffer=lt.CHANGE_OUTPUT_MAX_SIZE=void 0;var Le=K0(un()),Ni=ae(),zA=K0(Ir()),$n=cn(),Xv=un(),Yr=To(),XA=K0(zs()),io=Fs();lt.CHANGE_OUTPUT_MAX_SIZE=20+4+34+4;var Vv=2,q0=4294967293,YA=1e5,$A=1e5,ZA=240,Gv=1500;function Wv(e){return{buf:e<=16?void 0:e<128?h.Buffer.from([e]):h.Buffer.from([e%256,e/256]),len:e<=16?0:e<128?1:2,opcodenum:e==0?0:e<=16?80+e:e<128?1:2}}function Yc(e){let t=Va(e),r=io.varuint.encodingLength(t.opcodenum);var n=t.opcodenum;t.buf&&((n===Yr.OPS.OP_PUSHDATA1||n===Yr.OPS.OP_PUSHDATA2||n===Yr.OPS.OP_PUSHDATA4)&&(r+=io.varuint.encodingLength(t.len)),r+=t.buf.length);let i=Xv.BufferWriter.withCapacity(r);return i.writeUInt8(t.opcodenum),t.buf&&(n<Yr.OPS.OP_PUSHDATA1?i.writeSlice(t.buf):n===Yr.OPS.OP_PUSHDATA1?(i.writeUInt8(t.len),i.writeSlice(t.buf)):n===Yr.OPS.OP_PUSHDATA2?(i.writeUInt64(t.len),i.writeSlice(t.buf)):n===Yr.OPS.OP_PUSHDATA4&&(i.writeUInt32(t.len),i.writeSlice(t.buf))),i.end()}lt.bufferToBuffer=Yc;function Va(e){return{buf:e.length?e:void 0,len:e.length,opcodenum:e.length<=75?e.length:e.length<=255?76:77}}lt.bufferToChunk=Va;function L0(e){return{opcodenum:e}}var Ga=class{constructor(){this.chunks=[]}total(){return this.chunks.length==0?0:this.chunks.map(r=>{let n=io.varuint.encodingLength(r.opcodenum);var i=r.opcodenum;return r.buf&&(i<Yr.OPS.OP_PUSHDATA1||(i===Yr.OPS.OP_PUSHDATA1||i===Yr.OPS.OP_PUSHDATA2||i===Yr.OPS.OP_PUSHDATA4)&&(n+=io.varuint.encodingLength(r.len)),n+=r.buf.length),n}).reduce((r,n)=>r+n)}toBuffer(){let t=this.total(),r=Xv.BufferWriter.withCapacity(t);for(var n=0;n<this.chunks.length;n++){var i=this.chunks[n],s=i.opcodenum;r.writeUInt8(i.opcodenum),i.buf&&(s<Yr.OPS.OP_PUSHDATA1?r.writeSlice(i.buf):s===Yr.OPS.OP_PUSHDATA1?(r.writeUInt8(i.len),r.writeSlice(i.buf)):s===Yr.OPS.OP_PUSHDATA2?(r.writeUInt64(i.len),r.writeSlice(i.buf)):s===Yr.OPS.OP_PUSHDATA4&&(r.writeUInt32(i.len),r.writeSlice(i.buf)))}return r.end()}};lt.DogScript=Ga;var Wa=class{constructor(){this.network=Le.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new Le.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[],this.fromAddr="",this.revealAddr=""}static newDogInscriptionTool(t,r){let n=new Wa;n.network=t;let i=r.revealOutValue||YA,s=r.minChangeValue||$A,o=r.commitTxPrevOutputList[0].privateKey;n.inscriptionTxCtxDataList=JA(t,r.inscriptionData,o),n.revealAddr=r.inscriptionData.revealAddr;let a=Ni.base.toHex(Ni.base.fromHex((0,$n.privateKeyFromWIF)(o,t))),c=(0,$n.private2public)(a);n.fromAddr=Le.payments.p2pkh({pubkey:c,network:t}).address;let u=n.buildEmptyRevealTxs(t,i,r.revealFeeRate);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,u,i,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTxs(t,r,n){let i=0,s=[],o=[],a=[],c=0;for(let u=this.inscriptionTxCtxDataList.length-1;u>-1;u--){let d=this.inscriptionTxCtxDataList[u],f=new Le.Transaction;f.version=Vv,f.addInput(h.Buffer.alloc(32),0,q0),f.addInput(h.Buffer.alloc(32),1,q0),f.addOutput(u!=this.inscriptionTxCtxDataList.length-1?d.commitTxAddressPkScript:d.revealPkScript,r);let p=h.Buffer.alloc(72),y=h.Buffer.concat([d.inscriptionScript,Yc(p),Yc(d.redeemScript)]);f.ins[0].script=y,u!=this.inscriptionTxCtxDataList.length-1&&f.addOutput(Le.address.toOutputScript(this.fromAddr,t),c),f.ins[1].script=h.Buffer.alloc(106);let m=Math.floor((f.dogeByteLength()+lt.CHANGE_OUTPUT_MAX_SIZE)*n);c+=m;let _=m;d.revealTxPrevOutput={pkScript:d.commitTxAddressPkScript,value:_},i+=_,s.push(f),o.push(m),a.push(d.commitTxAddress)}for(let u=0,d=s.length-1;u<d;u++,d--)[s[u],s[d]]=[s[d],s[u]],[o[u],o[d]]=[o[d],o[u]],[a[u],a[d]]=[a[d],a[u]];return this.revealTxs=s,this.mustRevealTxFees=o,this.commitAddrs=a,i+=r,i}buildCommitTx(t,r,n,i,s,o,a){let c=0,u=new Le.Transaction;u.version=Vv,r.forEach(m=>{let _=Ni.base.reverseBuffer(Ni.base.fromHex(m.txId));u.addInput(_,m.vOut,q0),this.commitTxPrevOutputFetcher.push(m.amount),c+=m.amount}),u.addOutput(this.inscriptionTxCtxDataList[0].revealTxPrevOutput.pkScript,s),u.addOutput(Le.address.toOutputScript(this.fromAddr,t),i);let d=Le.address.toOutputScript(n,t);u.addOutput(d,0);let f=u.clone();zv(f,r,this.network);let p=Math.floor((f.dogeByteLength()+lt.CHANGE_OUTPUT_MAX_SIZE)*o),y=c-i-p;if(y>=a)u.outs[u.outs.length-1].value=y;else{u.outs=u.outs.slice(0,u.outs.length-1),f.outs=f.outs.slice(0,f.outs.length-1);let m=Math.floor(f.dogeByteLength()*o);if(c-i-m<0)return this.mustCommitTxFee=p,!0}return this.commitTx=u,!1}signCommitTx(t){zv(this.commitTx,t,this.network)}completeRevealTx(){for(let t=0;t<this.revealTxs.length;t++){let r=this.revealTxs[t];r.ins[0].hash=t==0?this.commitTx.getHash():this.revealTxs[t-1].getHash(),r.ins[1].hash=t==0?this.commitTx.getHash():this.revealTxs[t-1].getHash(),this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[t].revealTxPrevOutput.value);let n=this.inscriptionTxCtxDataList[t].redeemScript,i=r.hashForSignature(0,n,Le.Transaction.SIGHASH_ALL),s=Ni.base.toHex(this.inscriptionTxCtxDataList[t].privateKey),o=(0,$n.sign)(i,s),a=Le.script.signature.encode(o,Le.Transaction.SIGHASH_ALL);r.ins[0].script=h.Buffer.concat([this.inscriptionTxCtxDataList[t].inscriptionScript,Yc(a),Yc(this.inscriptionTxCtxDataList[t].redeemScript)]);let c=Le.address.toOutputScript(this.fromAddr,this.network),u=r.hashForSignature(1,c,Le.Transaction.SIGHASH_ALL),d=(0,$n.sign)(u,s),f=Le.payments.p2pkh({signature:Le.script.signature.encode(d,Le.Transaction.SIGHASH_ALL),pubkey:(0,$n.private2public)(s)});r.ins[1].script=f.input}}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s=this.revealTxPrevOutputFetcher[i],r.push(s)}),{commitTxFee:t,revealTxFees:r}}};lt.DogInscriptionTool=Wa;function zv(e,t,r){e.ins.forEach((n,i)=>{let s=(0,$n.getAddressType)(t[i].address,r),o=Ni.base.fromHex((0,$n.privateKeyFromWIF)(t[i].privateKey,r)),a=Ni.base.toHex(o),c=(0,$n.private2public)(a);if(s==="legacy"){let u=Le.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,Le.Transaction.SIGHASH_ALL),f=(0,$n.sign)(d,a),p=Le.payments.p2pkh({signature:Le.script.signature.encode(f,Le.Transaction.SIGHASH_ALL),pubkey:c});n.script=p.input}else{let u=zA.hash160(c),d=h.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,p=e.hashForWitness(i,d,f,Le.Transaction.SIGHASH_ALL),y=(0,$n.sign)(p,a);n.witness=[Le.script.signature.encode(y,Le.Transaction.SIGHASH_ALL),c];let m=h.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=m)}})}function JA(e,t,r){let n=Ni.base.fromHex((0,$n.privateKeyFromWIF)(r,e)),i=(0,$n.wif2Public)(r,e),s=Le.script.OPS,o;typeof t.body=="string"?o=h.Buffer.from(t.body):o=t.body;let a=[];for(;o.length;){let d=o.slice(0,Math.min(ZA,o.length));o=o.slice(d.length),a.push(d)}let c=new Ga;c.chunks.push(Va(h.Buffer.from("ord"))),c.chunks.push(Wv(a.length)),c.chunks.push(Va(h.Buffer.from(t.contentType))),a.forEach((d,f)=>{c.chunks.push(Wv(a.length-f-1)),c.chunks.push(Va(d))});let u=[];for(;c.chunks.length;){let d=new Ga;for(u.length==0&&d.chunks.push(c.chunks.shift());d.total()<=Gv&&c.chunks.length;)d.chunks.push(c.chunks.shift()),d.chunks.push(c.chunks.shift());d.total()>Gv&&(c.chunks.unshift(d.chunks.pop()),c.chunks.unshift(d.chunks.pop()));let f=new Ga;f.chunks.push(Va(i)),f.chunks.push(L0(s.OP_CHECKSIGVERIFY)),d.chunks.forEach(()=>{f.chunks.push(L0(s.OP_DROP))}),f.chunks.push(L0(s.OP_TRUE));let p=Ni.base.ripemd160(Ni.base.sha256(f.toBuffer())),{output:y,address:m}=XA.p2sh({hash:h.Buffer.from(p),network:e}),_={privateKey:n,inscriptionScript:d.toBuffer(),redeemScript:f.toBuffer(),commitTxAddress:m,commitTxAddressPkScript:y,revealTxPrevOutput:{pkScript:h.Buffer.alloc(0),value:1e5},revealPkScript:Le.address.toOutputScript(t.revealAddr,e)};u.push(_)}return u}function QA(e,t){let r=Wa.newDogInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}lt.dogInscribe=QA});var Qv=H(yn=>{v();w();Object.defineProperty(yn,"__esModule",{value:!0});yn.verifyWithAddress=yn.getMPCSignedMessage=yn.verify=yn.sign=yn.toCompact=yn.magicHash=void 0;var dd=sn(),sr=ae(),eO=cn(),tO=h.Buffer.from(`Bitcoin Signed Message:
`);function $v(e){let t;return e<253?(t=h.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=h.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=h.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=h.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}function ld(e,t){let r=t?h.Buffer.from(t,"utf8"):tO,n=$v(r.length),i=h.Buffer.from(e),s=$v(i.length),o=h.Buffer.concat([n,r,s,i]);return sr.base.doubleSha256(o)}yn.magicHash=ld;function j0(e,t,r){if(!(e===0||e===1||e===2||e===3))throw new Error("i must be equal to 0, 1, 2, or 3");let n=e+27+4;return r||(n=n-4),h.Buffer.concat([Uint8Array.of(n),Uint8Array.from(t)])}yn.toCompact=j0;function rO(e,t,r,n){let i=ld(t,n);if(!e)return sr.base.toHex(i);let s=sr.base.fromHex((0,eO.privateKeyFromWIF)(e,r)),{signature:o,recovery:a}=dd.signUtil.secp256k1.sign(h.Buffer.from(i),s);return sr.base.toBase64(j0(a,o,!0))}yn.sign=rO;function nO(e,t,r,n){let i=ld(t,n),s=sr.base.fromBase64(r),o=s[0]-27-4,a=s.slice(1);return dd.signUtil.secp256k1.verify(h.Buffer.from(i),a,o,sr.base.fromHex(e))}yn.verify=nO;function iO(e,t,r){let n=sr.base.fromHex(t),i=n.slice(0,32),s=n.slice(32,64),o=dd.signUtil.secp256k1.getV(sr.base.fromHex(e),sr.base.toHex(i),sr.base.toHex(s),sr.base.fromHex(r));return sr.base.toBase64(j0(o,n,!0))}yn.getMPCSignedMessage=iO;function sO(e,t,r,n){let i=ld(t,n),s=sr.base.fromBase64(r),o=s[0]-27,a=s.slice(1),c=o&3,u=o&8?o&4?D0.P2WPKH:D0.P2SH_P2WPKH:null,d=!!(o&12),f=dd.signUtil.secp256k1.recover(a,c,h.Buffer.from(i),d);if(f==null)return!1;let p=h.Buffer.from(sr.base.hash160(f)),y,m;if(u)u===D0.P2SH_P2WPKH?(y=Jv(p),m=sr.base.fromBase58Check(e).slice(1)):(y=p,m=Zv(e));else try{return m=Zv(e),fd(p,m)}catch{let E=Jv(p),I=sr.base.fromBase58Check(e).slice(1);return fd(p,I)||fd(E,I)}return fd(y,m)}yn.verifyWithAddress=sO;var D0={P2WPKH:"p2wpkh",P2SH_P2WPKH:"p2sh(p2wpkh)"};function Zv(e){let t=sr.base.bech32.decode(e),r=sr.base.bech32.fromWords(t.words.slice(1));return h.Buffer.from(r)}function Jv(e){let t=h.Buffer.concat([h.Buffer.from("0014","hex"),e]);return h.Buffer.from(sr.base.hash160(t))}function fd(e,t){if(!h.Buffer.isBuffer(e)||!h.Buffer.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return!0;if(typeof e.equals=="function")return e.equals(t);if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}});var li=H(ht=>{v();w();var oO=ht&&ht.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),aO=ht&&ht.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cO=ht&&ht.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&oO(t,e,r);return aO(t,e),t};Object.defineProperty(ht,"__esModule",{value:!0});ht.convert2UtxoTx=ht.number2Hex=ht.TBtcWallet=ht.BtcWallet=ht.BITCOIN_MESSAGE_BIP0322_SIMPLE=ht.BITCOIN_MESSAGE_ECDSA=void 0;var Z=ae(),ew=sn(),hd=ae(),F=cO($r()),He=$r();ht.BITCOIN_MESSAGE_ECDSA=0;ht.BITCOIN_MESSAGE_BIP0322_SIMPLE=1;var pd=class extends Z.BaseWallet{network(){return F.networks.bitcoin}async getDerivedPath(t){return t.segwitType?t.segwitType==Z.segwitType.SEGWIT_NESTED?`m/84'/0'/0'/0/${t.index}`:t.segwitType==Z.segwitType.SEGWIT_NESTED_49?`m/49'/0'/0'/0/${t.index}`:t.segwitType==Z.segwitType.SEGWIT_NATIVE?`m/84'/0'/0'/0/${t.index}`:t.segwitType==Z.segwitType.SEGWIT_TAPROOT?`m/86'/0'/0'/0/${t.index}`:Promise.reject(Z.DerivePathError):`m/44'/0'/0'/0/${t.index}`}async validPrivateKey(t){let r;try{let{version:i}=F.wif.decode(t.privateKey);r=i===this.network().wif}catch{r=!1}let n={isValid:r,privateKey:t.privateKey};return Promise.resolve(n)}async getNewAddress(t){try{let r=this.network(),n=t.privateKey,i=t.addressType||"Legacy",s=F.wif2Public(n,r),o;i==="Legacy"?o=F.payments.p2pkh({pubkey:s,network:r}).address:i==="segwit_native"?o=F.payments.p2wpkh({pubkey:s,network:r}).address:i==="segwit_nested"?o=F.payments.p2sh({redeem:F.payments.p2wpkh({pubkey:s,network:r})}).address:i==="segwit_taproot"&&(o=F.payments.p2tr({internalPubkey:s.slice(1),network:r}).address);let a={address:o||"",publicKey:hd.base.toHex(i==="segwit_taproot"?s.slice(1):s),compressedPublicKey:hd.base.toHex(s)};return Promise.resolve(a)}catch{return Promise.reject(Z.NewAddressError)}}async validAddress(t){let r=!1,n=this.network();try{F.address.toOutputScript(t.address,n)&&(r=!0)}catch{}t.addressType&&(r=t.addressType===F.getAddressType(t.address,n));let i={isValid:r,address:t.address};return Promise.resolve(i)}async signTransaction(t){let r=t.data.type||0;if(r===F.BtcXrcTypes.INSCRIBE)try{return Promise.resolve(F.inscribe(this.network(),t.data))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT)try{return Promise.resolve(F.psbtSign(t.data.psbt,t.privateKey,this.network()))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_DECODE)try{return Promise.resolve(F.psbtDecode(t.data.psbt,this.network()))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_UNSIGNED_LIST)try{return Promise.resolve(F.generateMPCUnsignedListingPSBT(t.data.psbt,t.data.publicKey,this.network()))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_SIGNED_LIST)try{return Promise.resolve(F.generateMPCSignedListingPSBT(t.data.psbt,t.data.publicKey,t.data.signature,this.network()))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_UNSIGNED_BUY)try{return Promise.resolve(F.generateMPCUnsignedBuyingPSBT(t.data.psbt,t.data.publicKey,this.network(),t.data.batchSize))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_SIGNED_BUY)try{return Promise.resolve(F.generateMPCSignedBuyingTx(t.data.psbt,t.data.publicKey,t.data.signatureList,this.network(),t.data.batchSize))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_UNSIGNED)try{return Promise.resolve(F.generateMPCUnsignedPSBT(t.data.psbt,t.data.publicKey,this.network()))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_SIGNED)try{return Promise.resolve(F.generateMPCSignedPSBT(t.data.psbt,t.data.publicKey,t.data.signatureList,this.network()))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_KEY_SCRIPT_PATH)try{return Promise.resolve(F.signPsbtWithKeyPathAndScriptPath(t.data.psbt,t.privateKey,this.network(),{autoFinalized:t.data.autoFinalized,toSignInputs:t.data.toSignInputs}))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_KEY_SCRIPT_PATH_BATCH)try{return Promise.resolve(F.signPsbtWithKeyPathAndScriptPathBatch(t.data.psbtHexs,t.privateKey,this.network(),t.data.options))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.SRC20)try{return Promise.resolve(F.srcInscribe(this.network(),t.data))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.RUNE)try{let n=new He.RuneWallet;return this.network()===He.networks.testnet&&(n=new He.RuneTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.RUNEMAIN)try{let n=new He.RuneMainWallet;return this.network()===He.networks.testnet&&(n=new He.RuneMainTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.ARC20)try{let n=new He.AtomicalWallet;return this.network()===He.networks.testnet&&(n=new He.AtomicalTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Z.SignTxError)}else if(r===F.BtcXrcTypes.CAT20){let n=new He.CatWallet;try{return Promise.resolve(n.signTransaction(t))}catch{return Promise.reject(Z.SignTxError)}}else if(r===F.BtcXrcTypes.PSBT_RUNEMAIN)try{let n=new He.RuneMainWallet;return this.network()===He.networks.testnet&&(n=new He.RuneMainTestWallet),Promise.resolve(n.buildPsbt(t))}catch{return Promise.reject(Z.SignTxError)}else{let n=null;try{let i=t.privateKey,s=$c(t.data);return n=F.signBtc(s,i,this.network()),Promise.resolve(n)}catch{return Promise.reject(Z.SignTxError)}}}getRandomPrivateKey(){try{let t=this.network();for(;;){let r=hd.base.randomBytes(32);if((0,Z.secp256k1SignTest)(r)){let n=F.private2Wif(r,t);return Promise.resolve(n)}}}catch{return Promise.reject(Z.GenPrivateKeyError)}}getDerivedPrivateKey(t){let r=this.network();return ew.bip39.mnemonicToSeedV2(t.mnemonic).then(n=>{let i=ew.bip32.fromSeedV2(n,t.hdPath);if(!i.privateKey)return Promise.reject(Z.GenPrivateKeyError);let s=F.private2Wif(h.Buffer.from(i.privateKey),r);return Promise.resolve(s)}).catch(n=>Promise.reject(Z.GenPrivateKeyError))}getAddressByPublicKey(t){try{let r=this.network(),n=hd.base.fromHex(t.publicKey);if(t.addressType){if(t.addressType==="Legacy")return Promise.resolve(F.payments.p2pkh({pubkey:n,network:r}).address);if(t.addressType==="segwit_nested")return Promise.resolve(F.payments.p2sh({redeem:F.payments.p2wpkh({pubkey:n,network:r})}).address);if(t.addressType==="segwit_native")return Promise.resolve(F.payments.p2wpkh({pubkey:n,network:r}).address);if(t.addressType==="segwit_taproot")return Promise.resolve(F.payments.p2tr({internalPubkey:n.slice(1),network:r}).address)}else{let i=[];return i.push({addressType:"Legacy",address:F.payments.p2pkh({pubkey:n,network:r}).address}),i.push({addressType:"segwit_nested",address:F.payments.p2sh({redeem:F.payments.p2wpkh({pubkey:n,network:r})}).address}),i.push({addressType:"segwit_native",address:F.payments.p2wpkh({pubkey:n,network:r}).address}),Promise.resolve(i)}}catch{}return Promise.reject(Z.NewAddressError)}getMPCRawTransaction(t){try{let r=$c(t.data),n=[],s={raw:F.signBtc(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(Z.GetMpcRawTransactionError)}}getMPCTransaction(t){try{let r=F.getMPCTransaction(t.raw,t.sigs,!1);return Promise.resolve(r)}catch{return Promise.reject(Z.GetMpcTransactionError)}}async getMPCRawMessage(t){try{let r=await this.signMessage(t);return Promise.resolve({hash:r})}catch{return Promise.reject(Z.GetMpcRawTransactionError)}}async getMPCSignedMessage(t){try{return Promise.resolve(F.message.getMPCSignedMessage(t.hash,t.sigs,t.publicKey))}catch{return Promise.reject(Z.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=t.data.type||0,n=$c(t.data);if(r===2){let i=F.signBtc(n,"",this.network(),void 0,!0,!0),s=n.dustSize||546;if(parseInt(i)>=s){let a={address:n.address,amount:parseInt(i),bip32Derivation:n.bip32Derivation};n.outputs.push(a)}let o=F.buildPsbt(n,this.network());return Promise.resolve(o)}else{let i=F.signBtc(n,"",this.network(),void 0,!0);return Promise.resolve(i)}}catch{return Promise.reject(Z.GetHardwareRawTransactionError)}}async calcTxHash(t){try{return Promise.resolve(F.Transaction.fromHex(t.data).getId())}catch{return Promise.reject(Z.CalcTxHashError)}}signMessage(t){try{let r=t.data,n;return r.type===ht.BITCOIN_MESSAGE_ECDSA?n=F.message.sign(t.privateKey,r.message,this.network()):n=F.bip0322.signSimple(r.message,r.address,t.privateKey,this.network()),Promise.resolve(n)}catch{return Promise.reject(Z.SignMsgError)}}async signCommonMsg(t){let r=await this.getNewAddress({privateKey:t.privateKey,addressType:t.addressType}),n=r.compressedPublicKey?r.compressedPublicKey:r.publicKey;n.startsWith("0x")&&(n=n.substring(2));let i=(0,He.privateKeyFromWIF)(t.privateKey,this.network());return super.signCommonMsg({privateKey:t.privateKey,privateKeyHex:i,publicKey:n,addressType:t.addressType,message:t.message,signType:Z.SignType.Secp256k1})}async verifyMessage(t){try{let r=t.data;if(r.type===ht.BITCOIN_MESSAGE_ECDSA){let n=F.message.verify(r.publicKey,r.message,t.signature);return Promise.resolve(n)}else{let n=F.bip0322.verifySimple(r.message,r.address,t.signature,r.publicKey,this.network());return Promise.resolve(n)}}catch{return Promise.reject(Z.SignMsgError)}}static async extractPsbtTransaction(t){try{return Promise.resolve(F.extractPsbtTransaction(t))}catch{return Promise.reject(Z.SignMsgError)}}async validSignedTransaction(t){try{t.data&&t.data.forEach(n=>n.value=n.amount);let r=F.ValidSignedTransaction(t.tx,t.data,this.network());return Promise.resolve((0,Z.jsonStringifyUniform)(r))}catch{return Promise.reject(Z.validSignedTransactionError)}}async estimateFee(t){try{let r=t.data.type||0;if(r===F.BtcXrcTypes.INSCRIBE)return Promise.reject(Z.EstimateFeeError);if(r===F.BtcXrcTypes.PSBT)return Promise.reject(Z.EstimateFeeError);if(r===F.BtcXrcTypes.RUNE)try{let n=new He.RuneWallet;return this.network()===He.networks.testnet&&(n=new He.RuneTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Z.EstimateFeeError)}else if(r===F.BtcXrcTypes.RUNEMAIN)try{let n=new He.RuneMainWallet;return this.network()===He.networks.testnet&&(n=new He.RuneMainTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Z.EstimateFeeError)}else if(r===F.BtcXrcTypes.ARC20)try{let n=new He.AtomicalWallet;return this.network()===He.networks.testnet&&(n=new He.AtomicalTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Z.EstimateFeeError)}else if(r===F.BtcXrcTypes.CAT20)try{let n=new He.CatWallet;return Promise.resolve(n.estimateFee(t))}catch{return Promise.reject(Z.EstimateFeeError)}else{let n=$c(t.data),i=F.estimateBtcFee(n,this.network());return Promise.resolve(i)}}catch{return Promise.reject(Z.EstimateFeeError)}}static async oneKeyBuildBtcTx(t){try{return Promise.resolve(F.oneKeyBuildBtcTx(t))}catch{return Promise.reject(Z.SignTxError)}}async buildPsbt(t){if((t.data.type||0)===F.BtcXrcTypes.RUNEMAIN)try{let n=new He.RuneMainWallet;return this.network()===He.networks.testnet&&(n=new He.RuneMainTestWallet),Promise.resolve(n.buildPsbt(t))}catch{return Promise.reject(Z.SignTxError)}else{let n=null;return Promise.resolve(n)}}};ht.BtcWallet=pd;var F0=class extends pd{network(){return F.networks.testnet}};ht.TBtcWallet=F0;function uO(e,t){let r=e.toString(16),n=t-r.length;if(n>0)for(let i=0;i<n;i++)r="0"+r;return r}ht.number2Hex=uO;function $c(e){let t=(0,Z.cloneObject)(e);return t.inputs.forEach(r=>{r.amount=(0,Z.convert2Number)(r.amount)}),t.outputs.forEach(r=>{r.amount=(0,Z.convert2Number)(r.amount)}),t.omni&&(t.omni.amount=(0,Z.convert2Number)(t.omni.amount)),e.dustSize&&(t.dustSize=(0,Z.convert2Number)(e.dustSize)),t}ht.convert2UtxoTx=$c});var rw=H(Ui=>{v();w();var fO=Ui&&Ui.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),dO=Ui&&Ui.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),lO=Ui&&Ui.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&fO(t,e,r);return dO(t,e),t};Object.defineProperty(Ui,"__esModule",{value:!0});Ui.BchWallet=void 0;var za=ae(),tw=ae(),Zc=li(),Ke=lO($r()),V0=class extends Zc.BtcWallet{network(){return{...super.network(),bech32:""}}async getDerivedPath(t){return`m/44'/145'/0'/0/${t.index}`}async getNewAddress(t){try{let r=this.network(),n=t.privateKey,i=Ke.wif2Public(n,r),a={address:Ke.GetBitcashP2PkHAddressByPublicKey(i).replace("bitcoincash:","")||"",publicKey:tw.base.toHex(i)};return Promise.resolve(a)}catch{return Promise.reject(za.NewAddressError)}}async validAddress(t){let r=!1;try{let i=this.network();Ke.address.toOutputScript(t.address,i)&&(r=!0)}catch{}r||(r=Ke.ValidateBitcashP2PkHAddress(t.address));let n={isValid:r,address:t.address};return Promise.resolve(n)}async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Zc.convert2UtxoTx)(t.data);return i.outputs.forEach(s=>{Ke.isCashAddress(s.address)&&(s.address=Ke.convert2LegacyAddress(s.address,this.network()))}),Ke.isCashAddress(i.address)&&(i.address=Ke.convert2LegacyAddress(i.address,this.network())),r=Ke.signBch(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(za.SignTxError)}}async estimateFee(t){try{let r=(0,Zc.convert2UtxoTx)(t.data);r.outputs.forEach(i=>{Ke.isCashAddress(i.address)&&(i.address=Ke.convert2LegacyAddress(i.address,this.network()))}),Ke.isCashAddress(r.address)&&(r.address=Ke.convert2LegacyAddress(r.address,this.network()));let n=Ke.estimateBchFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(za.EstimateFeeError)}}getMPCRawTransaction(t){try{let r=(0,Zc.convert2UtxoTx)(t.data);r.outputs.forEach(o=>{Ke.isCashAddress(o.address)&&(o.address=Ke.convert2LegacyAddress(o.address,this.network()))}),Ke.isCashAddress(r.address)&&(r.address=Ke.convert2LegacyAddress(r.address,this.network()));let n=[],s={raw:Ke.signBch(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(za.GetMpcRawTransactionError)}}getAddressByPublicKey(t){let r=tw.base.fromHex(t.publicKey),n=Ke.GetBitcashP2PkHAddressByPublicKey(r);return Promise.resolve(n.replace("bitcoincash:",""))}getMPCTransaction(t){try{let r=Ke.getMPCTransaction(t.raw,t.sigs,!0);return Promise.resolve(r)}catch{return Promise.reject(za.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=(0,Zc.convert2UtxoTx)(t.data);r.outputs.forEach(i=>{Ke.isCashAddress(i.address)&&(i.address=Ke.convert2LegacyAddress(i.address,this.network()))}),Ke.isCashAddress(r.address)&&(r.address=Ke.convert2LegacyAddress(r.address,this.network()));let n=Ke.signBch(r,"",this.network(),void 0,!0);return Promise.resolve(n)}catch{return Promise.reject(za.GetHardwareRawTransactionError)}}};Ui.BchWallet=V0});var nw=H(Ri=>{v();w();var hO=Ri&&Ri.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),pO=Ri&&Ri.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),bO=Ri&&Ri.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&hO(t,e,r);return pO(t,e),t};Object.defineProperty(Ri,"__esModule",{value:!0});Ri.BsvWallet=void 0;var Jc=ae(),Qc=li(),eu=bO($r()),G0=class extends Qc.BtcWallet{network(){return{...super.network(),bech32:""}}async getDerivedPath(t){return`m/44'/236'/0'/0/${t.index}`}async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Qc.convert2UtxoTx)(t.data);return r=eu.signBch(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(Jc.SignTxError)}}async estimateFee(t){try{let r=(0,Qc.convert2UtxoTx)(t.data),n=eu.estimateBchFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(Jc.EstimateFeeError)}}getMPCRawTransaction(t){try{let r=(0,Qc.convert2UtxoTx)(t.data),n=[],s={raw:eu.signBch(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(Jc.GetMpcRawTransactionError)}}getMPCTransaction(t){try{let r=eu.getMPCTransaction(t.raw,t.sigs,!0);return Promise.resolve(r)}catch{return Promise.reject(Jc.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=(0,Qc.convert2UtxoTx)(t.data),n=eu.signBch(r,"",this.network(),void 0,!0);return Promise.resolve(n)}catch{return Promise.reject(Jc.GetHardwareRawTransactionError)}}};Ri.BsvWallet=G0});var iw=H(Dr=>{v();w();var gO=Dr&&Dr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),yO=Dr&&Dr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),mO=Dr&&Dr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&gO(t,e,r);return yO(t,e),t};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.DogeWallet=Dr.dogeCoin=void 0;var bd=mO($r()),gd=ae(),_O=li();Dr.dogeCoin={messagePrefix:`Dogecoin Signed Message:
`,bech32:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158};var W0=class extends _O.BtcWallet{network(){return Dr.dogeCoin}async getDerivedPath(t){return`m/44'/3'/0'/0/${t.index}`}async signTransaction(t){let r=t.data.type||0;if(r===1)try{return Promise.resolve(bd.dogInscribe(Dr.dogeCoin,t.data))}catch{return Promise.reject(gd.SignTxError)}else if(r===2)try{return Promise.resolve(bd.psbtSign(t.data.psbt,t.privateKey,this.network(),t.data.maximumFeeRate?t.data.maximumFeeRate:1e5))}catch{return Promise.reject(gd.SignTxError)}else return super.signTransaction(t)}signMessage(t){try{let r=t.data,n=bd.message.sign(t.privateKey,r.message,this.network(),Dr.dogeCoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(gd.SignMsgError)}}async verifyMessage(t){try{let r=t.data,n=bd.message.verify(r.publicKey,r.message,t.signature,Dr.dogeCoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(gd.SignMsgError)}}};Dr.DogeWallet=W0});var ow=H(Zr=>{v();w();var vO=Zr&&Zr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),wO=Zr&&Zr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),SO=Zr&&Zr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&vO(t,e,r);return wO(t,e),t};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.LtcWallet=Zr.litecoin=void 0;var Xa=ae(),xO=li(),sw=SO($r());Zr.litecoin={messagePrefix:`Litecoin Signed Message:
`,bech32:"ltc",bip32:{public:27108450,private:27106558},pubKeyHash:48,scriptHash:50,wif:176};var z0=class extends xO.BtcWallet{network(){return Zr.litecoin}async getDerivedPath(t){return t.segwitType?t.segwitType==Xa.segwitType.SEGWIT_NESTED?`m/84'/2'/0'/0/${t.index}`:t.segwitType==Xa.segwitType.SEGWIT_NESTED_49?`m/49'/2'/0'/0/${t.index}`:t.segwitType==Xa.segwitType.SEGWIT_NATIVE?`m/84'/2'/0'/0/${t.index}`:Promise.reject(Xa.DerivePathError):`m/44'/2'/0'/0/${t.index}`}signMessage(t){try{let r=t.data,n=sw.message.sign(t.privateKey,r.message,this.network(),Zr.litecoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Xa.SignMsgError)}}async verifyMessage(t){try{let r=t.data,n=sw.message.verify(r.publicKey,r.message,t.signature,Zr.litecoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Xa.SignMsgError)}}};Zr.LtcWallet=z0});var aw=H(Zn=>{v();w();var TO=Zn&&Zn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),PO=Zn&&Zn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),EO=Zn&&Zn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&TO(t,e,r);return PO(t,e),t};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.UsdtTestWallet=Zn.UsdtWallet=void 0;var Ya=ae(),qi=li(),$a=EO($r()),yd=class extends qi.BtcWallet{async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,qi.convert2UtxoTx)(t.data);if(!i.omni)return Promise.reject(Ya.SignTxError);let s=(0,qi.number2Hex)(i.omni.coinType||31,8),o=(0,qi.number2Hex)(i.omni.amount,16),c={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+s+o};return i.outputs.push(c),r=$a.signBtc(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(Ya.SignTxError)}}async estimateFee(t){try{let r=(0,qi.convert2UtxoTx)(t.data);if(!r.omni)return Promise.reject(Ya.EstimateFeeError);let n=(0,qi.number2Hex)(r.omni.coinType||31,8),i=(0,qi.number2Hex)(r.omni.amount,16),o={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+n+i};r.outputs.push(o);let a=$a.estimateBtcFee(r,this.network());return Promise.resolve(a)}catch{return Promise.reject(Ya.EstimateFeeError)}}getHardWareRawTransaction(t){try{let r=t.data.type||0,n=(0,qi.convert2UtxoTx)(t.data);if(!n.omni)return Promise.reject(Ya.SignTxError);let i=(0,qi.number2Hex)(n.omni.coinType||31,8),s=(0,qi.number2Hex)(n.omni.amount,16),a={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+i+s};n.outputs.push(a);let c;if(r===2){let u=$a.signBtc(n,"",this.network(),void 0,!0,!0),d={address:n.address,amount:parseInt(u),bip32Derivation:n.bip32Derivation};n.outputs.push(d),c=$a.buildPsbt(n,this.network())}else c=$a.signBtc(n,"",this.network(),void 0,!0);return Promise.resolve(c)}catch{return Promise.reject(Ya.GetHardwareRawTransactionError)}}};Zn.UsdtWallet=yd;var X0=class extends yd{network(){return $a.networks.testnet}};Zn.UsdtTestWallet=X0});var $0=H(Qe=>{v();w();var IO=Qe&&Qe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),AO=Qe&&Qe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),OO=Qe&&Qe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&IO(t,e,r);return AO(t,e),t};Object.defineProperty(Qe,"__esModule",{value:!0});Qe.buildRuneMainMintOp=Qe.buildRuneMainMintData=Qe.buildRuneData=Qe.encodeToVecV2=Qe.toVarIntV2=Qe.fromVarInt=Qe.encodeToVec=Qe.toVarInt=void 0;var Y0=OO(Xt()),tu=To(),cw=_d(),BO=ae(),uw=BigInt(0),YL=BigInt(2),$L=BigInt(4),ZL=BigInt(6),JL=BigInt(8),QL=BigInt(10),eK=BigInt(12),tK=BigInt(14),rK=BigInt(16),nK=BigInt(118),md=BigInt(20),fw=BigInt(22),iK=BigInt(126),sK=BigInt(1),oK=BigInt(3),aK=BigInt(5),cK=BigInt(127);function MO(e){let t=[];return Za(e,t),new Uint8Array(t)}Qe.toVarInt=MO;function Za(e,t){let r=18,n=new Array(19).fill(0);for(n[r]=Number(e&BigInt(127));e>BigInt(127);)e=e/BigInt(128)-BigInt(1),r--,n[r]=Number(e&BigInt(255))|128;t.push(...n.slice(r))}Qe.encodeToVec=Za;function CO(e){let t=[];return or(e,t),new Uint8Array(t)}Qe.toVarIntV2=CO;function or(e,t){for(;e>>7n>0n;)t.push(Number(e&0x7fn|0x80n)),e>>=7n;return t.push(Number(e&0x7fn)),t}Qe.encodeToVecV2=or;function kO(e){let t=BigInt(0),r=0;for(;;){let n=BigInt(e[r]);if(n<BigInt(128))return[t+n,r+1];if(t+=n-BigInt(127),t=t*BigInt(128),r++,r>=e.length)throw new Error("Varint decoding error: buffer overflow")}}Qe.fromVarInt=kO;function HO(e,t){let r=[];for(let s of t)typeof s.amount=="string"&&(s.amount=BigInt(s.amount));if(t.length>0){Za(uw,r),t.sort((o,a)=>o.id-a.id);let s=0;for(let o of t)Za(BigInt(o.id-s),r),Za(BigInt(o.amount),r),Za(BigInt(o.output),r),s=o.id}let n;return e?n="R":n="RUNE_TEST",Y0.compile([tu.OPS.OP_RETURN,h.Buffer.from(n),h.Buffer.from(r)])}Qe.buildRuneData=HO;function NO(e,t,r,n,i,s){let o=[];for(let c of t)typeof c.amount=="string"&&(c.amount=BigInt(c.amount));if(i!=null&&i&&t[0].block!=null&&(or(md,o),or(BigInt(t[0].block),o),or(md,o),or(BigInt(t[0].id),o)),r&&(or(fw,o),or(BigInt(n),o)),t.length>0){or(uw,o),t.sort((d,f)=>d.block===f.block?d.id<f.id?-1:d.id>f.id?1:0:d.block-f.block);let c=0,u=0;for(let d of t)or(BigInt(d.block-u),o),or(BigInt(d.id-c),o),or(BigInt(d.amount),o),or(BigInt(d.output),o),c=d.id,u=d.block}if(o.length>80)throw new Error(JSON.stringify({errCode:cw.ErrCodeOpreturnExceeds,date:{payloadLenth:o.length}}));return Y0.compile([tu.OPS.OP_RETURN,tu.OPS.OP_13,h.Buffer.from(o)])}Qe.buildRuneMainMintData=NO;function UO(e,t,r,n){let i=[],s=parseInt(e.split(":")[0]),o=parseInt(e.split(":")[1]);if(n!=null&&n&&o!=null&&(or(md,i),or(BigInt(s),i),or(md,i),or(BigInt(o),i)),t&&(or(fw,i),or(BigInt(r),i)),i.length>80)throw new Error(JSON.stringify({errCode:cw.ErrCodeOpreturnExceeds,date:{payloadLenth:i.length}}));let a=Y0.compile([tu.OPS.OP_RETURN,tu.OPS.OP_13,h.Buffer.from(i)]);return{address:"",amount:0,omniScript:BO.base.toHex(a)}}Qe.buildRuneMainMintOp=UO});var hw=H(Jn=>{v();w();var RO=Jn&&Jn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qO=Jn&&Jn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),LO=Jn&&Jn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&RO(t,e,r);return qO(t,e),t};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.RuneTestWallet=Jn.RuneWallet=void 0;var Z0=ae(),KO=li(),lw=LO($r()),dw=$r(),DO=$0(),jO=ae(),vd=class extends KO.BtcWallet{convert2RuneTx(t){let r=(0,Z0.cloneObject)(t);for(let f of r.inputs){let p=f.data;if(p!=null&&p instanceof Array)for(let y of p)typeof y.amount=="string"&&(y.amount=BigInt(y.amount))}for(let f of r.outputs){let p=f.data;if(p!=null&&p instanceof Array)for(let y of p)typeof y.amount=="string"&&(y.amount=BigInt(y.amount))}let n=r.inputs,i=new Map;for(let f of n){let p=f.data;if(p!=null&&p instanceof Array)for(let y of p){let m=y.id,_=BigInt(y.amount);if(m==null||_==null)continue;let E=i.get(m);E==null?i.set(m,_):i.set(m,BigInt(E)+BigInt(_))}}let s=r.outputs,o=new Map;for(let f of s){let p=f.data;if(p!=null){let y=p.id,m=BigInt(p.amount);if(y==null||m==null)continue;let _=o.get(y);_==null?o.set(y,m):o.set(y,BigInt(_)+BigInt(m))}}let a=!1;for(let f of i.keys()){let p=i.get(f),y=o.get(f);(p!=null&&y!=null&&p>y||p!=null&&y==null)&&(a=!0),a=!0}let c=0,u=[];if(a){let f={address:r.address,amount:546};u.push(f),c++}let d=[];for(let f of s){let p=f.data;if(p!=null){let y=p.id,m=BigInt(p.amount);if(y==null||m==null)continue;let _={id:parseInt("0x"+y),amount:BigInt(m),output:c};d.push(_)}f.data=null,u.push(f),c++}return{inputs:r.inputs,outputs:u,address:r.address,feePerB:r.feePerB,runeData:{edicts:d,etching:r.runeData.etching,burn:r.runeData.burn}}}async signTransaction(t){let r=this.network(),n=null;try{let i=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let s=this.convert2RuneTx(t.data),o=this.getOpReturnOutput(r,s.runeData);return s.outputs.push(o),n=(0,dw.signBtc)(s,i,r),Promise.resolve(n)}catch{return Promise.reject(Z0.SignTxError)}}getOpReturnOutput(t,r){let n=!1;dw.networks.bitcoin===t&&(n=!0),r.edicts==null&&(r.edicts=[]);let i=(0,DO.buildRuneData)(n,r.edicts);return{address:"",amount:0,omniScript:jO.base.toHex(i)}}async estimateFee(t){try{if(!t.data.runeData)return Promise.reject("missing runeData");let r=this.convert2RuneTx(t.data),n=this.getOpReturnOutput(this.network(),r.runeData);r.outputs.push(n);let i=lw.estimateBtcFee(r,this.network());return Promise.resolve(i)}catch{return Promise.reject(Z0.EstimateFeeError)}}};Jn.RuneWallet=vd;var J0=class extends vd{network(){return lw.networks.testnet}};Jn.RuneTestWallet=J0});var yw=H(De=>{v();w();Object.defineProperty(De,"__esModule",{value:!0});De.isUpper=De.commitment=De.Tag=De.Flag=De.removeSpacers=De.getSpacersVal=De.applySpacers=De.decodeLEB128=De.encodeLEB128=De.base26Decode=De.base26Encode=void 0;var FO=ae();function pw(e){let t=0n;for(let r=0;r<e.length;r++){let n=BigInt(e.charCodeAt(r)-"A".charCodeAt(0)),i=BigInt(e.length)-1n-BigInt(r);if(i==0n)t+=n;else{let s=26n**i;t+=s*(n+1n)}}return t}De.base26Encode=pw;function VO(e){if(e===340282366920938463463374607431768211455n)return"BCGDENLQRQWDSLRUGSNLBTMFIJAV";e+=1n;let t=[];for(;e>0;){let r=(e-1n)%26n;t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Number(r))),e=(e-1n)/26n}return t.reverse(),t.join("")}De.base26Decode=VO;function GO(e){let t=[],r=!0;for(;r;){let n=Number(e&BigInt(127));e>>=BigInt(7),e===BigInt(0)?r=!1:n|=128,t.push(n)}return t}De.encodeLEB128=GO;function WO(e){let t=BigInt(0);for(let r=0;r<e.length;r++){let n=BigInt(e[r]);if(r>18)throw new Error("Overlong");let i=n&BigInt(127);if(r==18&&(i&BigInt(124))!=BigInt(0))throw new Error("Overflow");if(t|=i<<BigInt(7)*BigInt(r),(n&BigInt(128))==BigInt(0))return{n:t,len:r+1}}throw new Error("Unterminated")}De.decodeLEB128=WO;function zO(e,t){let r="";for(let n=0;n<e.length;n++)r+=e.charAt(n),t>0&&((t&1)===1&&(r+="\u2022"),t>>=1);return r}De.applySpacers=zO;function XO(e){let t=0,r=0;for(let n=0;n<e.length;n++){let i=e.charAt(n);(i==="\u2022"||i==".")&&(t+=1<<n-1-r,r++)}return t}De.getSpacersVal=XO;function bw(e){return e.replace(/[.]+/g,"")}De.removeSpacers=bw;var YO;(function(e){e[e.Etching=0]="Etching",e[e.Terms=1]="Terms",e[e.Turbo=2]="Turbo",e[e.Cenotaph=127]="Cenotaph"})(YO=De.Flag||(De.Flag={}));var $O;(function(e){e[e.Body=0]="Body",e[e.Flags=2]="Flags",e[e.Rune=4]="Rune",e[e.Premine=6]="Premine",e[e.Cap=8]="Cap",e[e.Amount=10]="Amount",e[e.HeightStart=12]="HeightStart",e[e.HeightEnd=14]="HeightEnd",e[e.OffsetStart=16]="OffsetStart",e[e.OffsetEnd=18]="OffsetEnd",e[e.Mint=20]="Mint",e[e.Pointer=22]="Pointer",e[e.Cenotaph=126]="Cenotaph",e[e.Divisibility=1]="Divisibility",e[e.Spacers=3]="Spacers",e[e.Symbol=5]="Symbol",e[e.Nop=127]="Nop"})($O=De.Tag||(De.Tag={}));function ZO(e){let t;if(typeof e.value=="string"){let n=bw(e.value);if(!gw(n))throw new Error("invalid rune");t=pw(n)}else t=e.value;let r=t.toString(16);return r.length%2===1&&(r="0"+r),FO.base.fromHex(r).reverse()}De.commitment=ZO;function gw(e){return/^[A-Z]+$/.test(e)}De.isUpper=gw});var Ew=H(Se=>{v();w();var JO=Se&&Se.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),QO=Se&&Se.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),wd=Se&&Se.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&JO(t,e,r);return QO(t,e),t};Object.defineProperty(Se,"__esModule",{value:!0});Se.buildRuneMainDeployData=Se.inscribe=Se.runesMainInscribe=Se.checkEtching=Se.MAX_SPACERS=Se.uint64Max=Se.uint128Max=Se.RunesMainInscriptionTool=void 0;var tt=wd(un()),eB=sn(),so=ae(),tB=wd(Mi()),rB=wd(Ir()),nB=$s(),Li=cn(),iB=wd(Xt()),mw=Oa(),et=yw(),xw=eB.signUtil.schnorr.secp256k1.schnorr,_w=2,vw=4294967293,sB=546,oB=546,ww=4e6/10,Ho=class{constructor(){this.network=tt.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new tt.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newInscriptionTool(t,r){let n=new Ho;n.network=t;let i=r.revealOutValue||sB,s=r.minChangeValue||oB,o=r.runeData.useDefaultOutput||!1,a=r.runeData.defaultOutput||0,c=r.commitTxPrevOutputList[0].privateKey;if(!r.runeData.etching||!r.runeData.revealAddr)throw new Error("etching is null");if(!Tw(r.runeData.etching))throw new Error("invalid etching parameter");let u=r.runeData.etching,d=(0,et.commitment)(u.rune),f=Pw(u,o,a);r.runeData.etching.contentType&&r.runeData.etching.body?n.inscriptionTxCtxDataList.push(fB(t,{contentType:r.runeData.etching.contentType,body:r.runeData.etching.body,revealAddr:r.runeData.revealAddr},c,d)):n.inscriptionTxCtxDataList.push(uB(t,c,r.runeData.revealAddr,d));let p=n.buildEmptyRevealTx(t,i,r.revealFeeRate,f);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,p,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTx(t,r,n,i){let s=0,o=[],a=[],c=[];return this.inscriptionTxCtxDataList.forEach((u,d)=>{let f=new tt.Transaction;f.version=_w,f.addInput(h.Buffer.alloc(32),d,vw),i&&f.addOutput(i,0),f.addOutput(u.revealPkScript,r);let p=h.Buffer.alloc(64),y=h.Buffer.alloc(33),m=[];m.push(p),m.push(u.inscriptionScript),m.push(y);let _=Math.floor((f.byteLength()+Math.floor(((0,nB.vectorSize)(m)+2+3)/4))*n),E=r+_;u.revealTxPrevOutput={pkScript:u.commitTxAddressPkScript,value:E},s+=E,o.push(f),a.push(_),c.push(u.commitTxAddress)}),this.revealTxs=o,this.mustRevealTxFees=a,this.commitAddrs=c,s}buildCommitTx(t,r,n,i,s,o){let a=0,c=new tt.Transaction;c.version=_w,r.forEach(m=>{let _=so.base.reverseBuffer(so.base.fromHex(m.txId));c.addInput(_,m.vOut,vw),this.commitTxPrevOutputFetcher.push(m.amount),a+=m.amount}),this.inscriptionTxCtxDataList.forEach(m=>{c.addOutput(m.revealTxPrevOutput.pkScript,m.revealTxPrevOutput.value)});let u=tt.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();Sw(d,r.map(m=>({...m,privateKey:""})),this.network);let f=(0,mw.countAdjustedVsize)(d,r.map(m=>m.address),t),p=Math.floor(f*s),y=a-i-p;if(y>=o)c.outs[c.outs.length-1].value=y;else{c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let m=(0,mw.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(m*s);if(a-i-_<0)return this.mustCommitTxFee=p,!0}return this.commitTx=c,!1}signCommitTx(t){Sw(this.commitTx,t,this.network)}completeRevealTx(){this.revealTxs.forEach((t,r)=>{t.ins[0].hash=this.commitTx.getHash();let n=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.pkScript],i=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value];this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value);let s=t.hashForWitnessV1(0,n,i,tt.Transaction.SIGHASH_DEFAULT,this.inscriptionTxCtxDataList[r].hash),o=h.Buffer.from(xw.sign(s,this.inscriptionTxCtxDataList[r].privateKey,so.base.randomBytes(32)));t.ins[0].witness=[h.Buffer.from(o),...this.inscriptionTxCtxDataList[r].witness];let a=t.weight();if(a>ww)throw new Error(`reveal(index ${r}) transaction weight greater than ${ww} (MAX_STANDARD_TX_WEIGHT): ${a}`)})}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};Se.RunesMainInscriptionTool=Ho;Se.uint128Max=(BigInt(1)<<BigInt(128))-BigInt(1);Se.uint64Max=(BigInt(1)<<BigInt(64))-BigInt(1);var aB=38;Se.MAX_SPACERS=134217727;function Tw(e){let t=e.premine?BigInt(e.premine):BigInt(0);if(t>Se.uint128Max||t<0)return!1;if(e.terms){let r=e.terms.amount?BigInt(e.terms.amount):BigInt(0),n=e.terms.cap?BigInt(e.terms.cap):BigInt(0);if(r<0||r>Se.uint128Max||n<0||n>Se.uint128Max||r*n>Se.uint128Max||t+r*n>Se.uint128Max||e.terms.height&&(e.terms.height.start&&(e.terms.height.start<0||e.terms.height.start>Se.uint64Max)||e.terms.height.end&&(e.terms.height.end<0||e.terms.height.end>Se.uint64Max)))return!1}return!(e.divisibility&&(e.divisibility<0||e.divisibility>aB)||typeof e.rune.value=="string"&&((0,et.getSpacersVal)(e.rune.value)>Se.MAX_SPACERS||(0,et.base26Encode)((0,et.removeSpacers)(e.rune.value))>Se.uint128Max))}Se.checkEtching=Tw;function cB(e,t){let r=Ho.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}Se.runesMainInscribe=cB;function Sw(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Li.getAddressType)(t[i].address,r);if(t[i].privateKey==""){let{witness:u,script:d}=(0,Li.fakeSign)(s);u!==void 0&&(n.witness=u),d!==void 0&&(n.script=d);return}let o=so.base.fromHex((0,Li.privateKeyFromWIF)(t[i].privateKey,r)),a=so.base.toHex(o),c=(0,Li.private2public)(a);if(s==="segwit_taproot"){let u=t.map(m=>tt.address.toOutputScript(m.address,r)),d=t.map(m=>m.amount),f=e.hashForWitnessV1(i,u,d,tt.Transaction.SIGHASH_DEFAULT),p=tB.taprootTweakPrivKey(o),y=h.Buffer.from(xw.sign(f,p,so.base.randomBytes(32)));n.witness=[h.Buffer.from(y)]}else if(s==="legacy"){let u=tt.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,tt.Transaction.SIGHASH_ALL),f=(0,Li.sign)(d,a),p=tt.payments.p2pkh({signature:tt.script.signature.encode(f,tt.Transaction.SIGHASH_ALL),pubkey:c});n.script=p.input}else{let u=rB.hash160(c),d=h.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,p=e.hashForWitness(i,d,f,tt.Transaction.SIGHASH_ALL),y=(0,Li.sign)(p,a);n.witness=[tt.script.signature.encode(y,tt.Transaction.SIGHASH_ALL),c];let m=h.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=m)}})}function uB(e,t,r,n){let i=so.base.fromHex((0,Li.privateKeyFromWIF)(t,e)),s=(0,Li.wif2Public)(t,e).slice(1),o=[];o.push(s);let a=tt.script.OPS;o.push(a.OP_CHECKSIG),o.push(a.OP_FALSE),o.push(a.OP_IF),o.push(n),o.push(a.OP_ENDIF);let c=tt.script.compile(o),u={output:c},d={output:c,redeemVersion:192},{output:f,witness:p,hash:y,address:m}=tt.payments.p2tr({internalPubkey:s,scriptTree:u,redeem:d,network:e});return{privateKey:i,inscriptionScript:c,commitTxAddress:m,commitTxAddressPkScript:f,witness:p,hash:y,revealTxPrevOutput:{pkScript:h.Buffer.alloc(0),value:0},revealPkScript:tt.address.toOutputScript(r,e)}}function fB(e,t,r,n){let i=so.base.fromHex((0,Li.privateKeyFromWIF)(r,e)),s=(0,Li.wif2Public)(r,e).slice(1),o=tt.script.OPS,a=[];a.push(s),a.push(o.OP_CHECKSIG),n&&n.length>0&&(a.push(n),a.push(o.OP_DROP)),a.push(o.OP_FALSE),a.push(o.OP_IF),a.push(h.Buffer.from("ord")),a.push(o.OP_DATA_1),a.push(o.OP_DATA_1),a.push(h.Buffer.from(t.contentType)),a.push(o.OP_0);let c=520,u=h.Buffer.from(t.body),d=u.length;for(let k=0;k<d;k+=c){let C=k+c;C>d&&(C=d),a.push(u.slice(k,C))}a.push(o.OP_ENDIF);let f=tt.script.compile(a),p={output:f},y={output:f,redeemVersion:192},{output:m,witness:_,hash:E,address:I}=tt.payments.p2tr({internalPubkey:s,scriptTree:p,redeem:y,network:e});return{privateKey:i,inscriptionScript:f,commitTxAddress:I,commitTxAddressPkScript:m,witness:_,hash:E,revealTxPrevOutput:{pkScript:h.Buffer.alloc(0),value:0},revealPkScript:tt.address.toOutputScript(t.revealAddr,e)}}function dB(e,t){let r=Ho.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}Se.inscribe=dB;function Pw(e,t,r){let n=hB(e,t,r),i=lB(n),s=h.Buffer.from("6a5d","hex"),o;if(i.length<76)o=h.Buffer.alloc(1),o.writeUint8(i.length);else if(i.length<256)o=h.Buffer.alloc(2),o.writeUint8(76),o.writeUint8(i.length,1);else if(i.length<65536)o=h.Buffer.alloc(3),o.writeUint8(77),o.writeUint16LE(i.length,1);else if(i.length<4294967296)o=h.Buffer.alloc(5),o.writeUint8(78),o.writeUint32LE(i.length,1);else throw new Error("runestone too big!");return iB.compile(h.Buffer.concat([s,o,i]))}Se.buildRuneMainDeployData=Pw;function lB(e){let t=[];for(let[r,n]of e)for(let i of n){let s=h.Buffer.alloc(1);s.writeUInt8(r),t.push(s),t.push(h.Buffer.from((0,et.encodeLEB128)(i)))}return h.Buffer.concat(t)}function hB(e,t,r){let n=new Map,i=1;if(e.terms){let o=1<<et.Flag.Terms;i|=o}if(e.turbo){let o=1<<et.Flag.Turbo;i|=o}n.set(et.Tag.Flags,[BigInt(i)]);let s;if(typeof e.rune.value=="string"?s=(0,et.base26Encode)((0,et.removeSpacers)(e.rune.value)):s=e.rune.value,n.set(et.Tag.Rune,[BigInt(s)]),e.divisibility&&n.set(et.Tag.Divisibility,[BigInt(e.divisibility)]),e.spacers)n.set(et.Tag.Spacers,[BigInt(e.spacers)]);else{let o;typeof e.rune.value=="bigint"?o=0:o=(0,et.getSpacersVal)(e.rune.value),o!==0&&n.set(et.Tag.Spacers,[BigInt(o)])}if(e.symbol&&n.set(et.Tag.Symbol,[BigInt(e.symbol.charCodeAt(0))]),e.premine&&n.set(et.Tag.Premine,[BigInt(e.premine)]),e.terms){if(e.terms.amount&&n.set(et.Tag.Amount,[BigInt(e.terms.amount)]),e.terms.cap&&n.set(et.Tag.Cap,[BigInt(e.terms.cap)]),e.terms.height){let o=e.terms.height.start;o&&n.set(et.Tag.HeightStart,[BigInt(o)]);let a=e.terms.height.end;a&&n.set(et.Tag.HeightEnd,[BigInt(a)])}if(e.terms.offset){let o=e.terms.offset.start;o&&n.set(et.Tag.OffsetStart,[BigInt(o)]);let a=e.terms.offset.end;a&&n.set(et.Tag.OffsetEnd,[BigInt(a)])}}return t&&r&&n.set(et.Tag.Pointer,[BigInt(r)]),n}});var Iw=H(it=>{v();w();var pB=it&&it.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),bB=it&&it.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),gB=it&&it.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&pB(t,e,r);return bB(t,e),t};Object.defineProperty(it,"__esModule",{value:!0});it.RuneMainTestWallet=it.RuneMainWallet=it.ErrCodeMultipleRuneId=it.ErrCodeRuneIdNotStandard=it.ErrCodeOpreturnExceeds=it.ErrCodeLessRunesMainAmt=void 0;var No=ae(),yB=li(),Uo=gB($r()),Qn=$r(),Q0=$0(),mB=ae(),_B=Ew();it.ErrCodeLessRunesMainAmt=2010300;it.ErrCodeOpreturnExceeds=2010301;it.ErrCodeRuneIdNotStandard=2010302;it.ErrCodeMultipleRuneId=2010303;var Sd=class extends yB.BtcWallet{convert2RuneTx(t){let r=(0,No.cloneObject)(t);r.runeData.useDefaultOutput==!0&&r.runeData.defaultOutput==null&&(r.runeData.defaultOutput=0),r.runeData.mint==!0&&r.runeData.mintNum==null&&(r.runeData.mintNUm=1);for(let f of r.inputs){let p=f.data;if(p!=null&&p instanceof Array)for(let y of p)typeof y.amount=="string"&&(r.runeData.mint?y.amount=BigInt(1):y.amount=BigInt(y.amount))}for(let f of r.outputs){let p=f.data;if(p!=null&&p instanceof Array)for(let y of p)typeof y.amount=="string"&&(r.runeData.mint?y.amount=BigInt(1):y.amount=BigInt(y.amount))}let n=r.inputs,i=new Map;for(let f of n){let p=f.data;if(p!=null&&p instanceof Array)for(let y of p){let m=y.id,_=BigInt(1);if(r.runeData.mint||(_=BigInt(y.amount)),m==null||_==null)continue;if(m.split(":").length<=1)throw new Error(JSON.stringify({errCode:it.ErrCodeRuneIdNotStandard,date:{runeId:m}}));let E=i.get(m);E==null?i.set(m,_):i.set(m,BigInt(E)+BigInt(_))}}if(i.size>1)throw new Error(JSON.stringify({errCode:it.ErrCodeMultipleRuneId,date:{runeInputMapSize:i.size}}));let s=r.outputs,o=new Map;for(let f of s){let p=f.data;if(p!=null){let y=p.id,m=BigInt(1);if(r.runeData.mint||(m=BigInt(p.amount)),y==null||m==null)continue;let _=o.get(y);_==null?o.set(y,m):o.set(y,BigInt(_)+BigInt(m))}}let a=!1;for(let f of i.keys()){let p=i.get(f),y=o.get(f);(p!=null&&y!=null&&p>y||p!=null&&y==null)&&r.runeData.useDefaultOutput==!1&&(a=!0)}let c=0,u=[];if(a){let f={address:r.address,amount:546};u.push(f),c++}let d=[];for(let f of s){let p=f.data;if(p!=null){let y=p.id,m=BigInt(1);if(r.runeData.mint||(m=BigInt(p.amount)),y==null||m==null)continue;let _={block:parseInt(y.split(":")[0]),id:parseInt(y.split(":")[1]),amount:BigInt(m),output:c};d.push(_)}f.data=null,u.push(f),c++}if(r.runeData.useDefaultOutput==!0&&r.runeData.defaultOutput>u.length-1)throw new Error(JSON.stringify({errCode:it.ErrCodeLessRunesMainAmt,date:{defaultOutput:r.runeData.defaultOutput,ouputLenth:u.length}}));return{inputs:r.inputs,outputs:u,address:r.address,feePerB:r.feePerB,runeData:{edicts:d,etching:r.runeData.etching,burn:r.runeData.burn,defaultOutput:r.runeData.defaultOutput,mint:r.runeData.mint,mintNum:r.runeData.mintNum}}}getMockMinRuneTx(t,r){let n=(0,No.cloneObject)(t),i=[],s={block:parseInt(r.id.split(":")[0]),id:parseInt(r.id.split(":")[1]),amount:BigInt(1),output:0};return i.push(s),{inputs:[{txId:n.inputs[0].txId,vOut:0,amount:600,data:[r]}],outputs:[{address:n.address,amount:546,data:r}],address:n.address,feePerB:n.feePerB,runeData:{edicts:i,etching:n.runeData.etching,burn:n.runeData.burn,defaultOutput:n.runeData.defaultOutput,mint:n.runeData.mint,mintNum:n.runeData.mintNum}}}getMinRuneTx(t,r,n,i){let s=(0,No.cloneObject)(t);return{inputs:[n],outputs:[i],address:s.address,feePerB:s.feePerB,RuneData:s.runeData}}async signTransaction(t){try{let r=this.network(),n=null;if(t.data.runeData.etching)return(0,_B.runesMainInscribe)(r,t.data);if(t.data.runeData.mintNum==null||t.data.runeData.mintNum<=1){let i=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let s=this.convert2RuneTx(t.data),o=this.getRuneMainOpReturnOutput(r,s.runeData);return s.outputs.push(o),n=(0,Qn.signBtc)(s,i,r),Promise.resolve(n)}else if(t.data.runeData.mint&&!t.data.runeData.serialMint){let i=[],s=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let o={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum},a=this.getMockMinRuneTx(t.data,o),c=this.getRuneMainOpReturnOutput(r,a.runeData);a.outputs.push(c),n=(0,Qn.signBtc)(a,s,r);let u=Uo.estimateBtcFee(a,this.network())+546,d=this.convert2RuneTx(t.data),f=d.outputs.length;for(let m=0;m<o.mintNum-1;m++)d.outputs.push({address:t.data.address,amount:u});let p=this.getRuneMainOpReturnOutput(r,d.runeData);d.outputs.push(p),n=(0,Qn.signBtc)(d,s,r);let y=Qn.Transaction.fromHex(n).getId();i.push(n);for(let m=0;m<o.mintNum-1;m++){let _={txId:y,vOut:f,address:t.data.address,amount:u,data:[o]},E={address:t.data.address,amount:546};f+=1;let I=this.getMinRuneTx(t.data,o,_,E);I.outputs.push(p);let k=(0,Qn.signBtc)(I,s,r);i.push(k)}return Promise.resolve(i)}else{let i=[],s=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let o={id:t.data.outputs[0].data.id,amount:1,mintNum:t.data.runeData.mintNum},a=this.getMockMinRuneTx(t.data,o),c=(0,Q0.buildRuneMainMintOp)(o.id,!1,0,!0);a.outputs.push(c);let u=Uo.estimateBtcFee(a,this.network()),d=(o.mintNum-1)*u+546,f=this.convert2RuneTxSerialMint(t.data,d);f.outputs.push(c),n=(0,Qn.signBtc)(f,s,r);let p=Qn.Transaction.fromHex(n).getId();i.push(n);for(let y=1;y<o.mintNum;y++){let m={txId:p,vOut:0,address:t.data.address,amount:d};d=d-u;let _={address:t.data.address,amount:d},E=this.getMinRuneTx(t.data,o,m,_);E.outputs.push(c);let I=(0,Qn.signBtc)(E,s,r);p=Qn.Transaction.fromHex(I).getId(),i.push(I)}return Promise.resolve(i)}}catch{return Promise.reject(No.SignTxError)}}getRuneMainOpReturnOutput(t,r){let n=!1;Qn.networks.bitcoin===t&&(n=!0),r.useDefaultOutput==null&&(r.useDefaultOutput=!1),r.defaultOutput==null&&(r.defaultOutput=0),r.mint==null&&(r.mint=!1),r.mintNum==null&&(r.mintNum=0);let i=(0,Q0.buildRuneMainMintData)(n,r.edicts,r.useDefaultOutput,r.defaultOutput,r.mint,r.mintNum);return{address:"",amount:0,omniScript:mB.base.toHex(i)}}async estimateFee(t){try{let r=this.network();if(!t.data.runeData)return Promise.reject("missing runeData");let n=this.convert2RuneTx(t.data),i=this.getRuneMainOpReturnOutput(this.network(),n.runeData);n.outputs.push(i);let s={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum};for(let a=0;a<s.mintNum-1;a++)n.outputs.push({address:t.data.address,amount:8e3});let o=Uo.estimateBtcFee(n,this.network());if(t.data.runeData.mintNum==null||t.data.runeData.mintNum<=1)return Promise.resolve(o);if(t.data.runeData.mint&&!t.data.runeData.serialMint){let a=[];a.push(o);let c={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum},u=this.getMockMinRuneTx(t.data,c),d=this.getRuneMainOpReturnOutput(this.network(),u.runeData);u.outputs.push(d);let f=Uo.estimateBtcFee(u,this.network());for(let p=0;p<t.data.runeData.mintNum-1;p++)a.push(f);return Promise.resolve(a)}else if(t.data.runeData.mint&&t.data.runeData.serialMint){let a=[];if(!t.data.runeData)return Promise.reject("missing runeData");let c={id:t.data.outputs[0].data.id,amount:1,mintNum:t.data.runeData.mintNum},u=this.getMockMinRuneTx(t.data,c),d=(0,Q0.buildRuneMainMintOp)(c.id,!1,0,!0);u.outputs.push(d);let f=Uo.estimateBtcFee(u,this.network()),p=(c.mintNum-1)*f+546,y=this.convert2RuneTxSerialMint(t.data,p);y.outputs.push(d);let m=Uo.estimateBtcFee(y,r);a.push(m);for(let _=1;_<c.mintNum;_++)a.push(f);return Promise.resolve(a)}}catch{return Promise.reject(No.EstimateFeeError)}}convert2RuneTxSerialMint(t,r){let n=(0,No.cloneObject)(t),i=[{address:n.address,amount:r}];return{inputs:n.inputs,outputs:i,address:n.address,feePerB:n.feePerB,runeData:{edicts:n.runeData.edicts,etching:n.runeData.etching,burn:n.runeData.burn,defaultOutput:n.runeData.defaultOutput,mint:n.runeData.mint,mintNum:n.runeData.mintNum}}}convert2RuneTxPsbt(t){let r=(0,No.cloneObject)(t);return{inputs:r.inputs,outputs:r.outputs,address:r.address,feePerB:r.feePerB,runeData:{edicts:r.runeData.edicts,etching:r.runeData.etching,burn:r.runeData.burn,defaultOutput:r.runeData.defaultOutput,mint:r.runeData.mint,mintNum:r.runeData.mintNum}}}async buildPsbt(t){let r=this.network(),n=null;try{if(!t.data.runeData)return Promise.reject("missing runeData");let i=this.convert2RuneTxPsbt(t.data),s=this.getRuneMainOpReturnOutput(r,i.runeData);i.outputs.push(s);let o="KwdkfXMV2wxDVDMPPuFZsio3NeCskAUd4N2U4PriTgpj2MqAGmmc";i.dustSize==null&&(i.dustSize=546);let{inputAmount:a,outputAmount:c,virtualSize:u}=(0,Qn.calculateTxSize)(i.inputs,i.outputs,i.address,o,r,i.dustSize),d=a-c-Math.ceil(u*i.feePerB);d>i.dustSize&&i.outputs.push({address:i.address,amount:d});let p=[(0,Qn.buildPsbt)(i,r),d];return Promise.resolve(p)}catch(i){return Promise.reject(i)}}};it.RuneMainWallet=Sd;var ep=class extends Sd{network(){return Uo.networks.testnet}};it.RuneMainTestWallet=ep});var Ow=H(he=>{v();w();var vB=he&&he.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),wB=he&&he.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),SB=he&&he.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&vB(t,e,r);return wB(t,e),t};Object.defineProperty(he,"__esModule",{value:!0});he.AtomicalTestWallet=he.AtomicalWallet=he.ErrCodeInvalidInputAsset=he.ErrCodeAtomicalNotFullyAllocated=he.ErrCodeSemiColorOuput=he.ErrCodeMul=he.ErrCodeUnknownAsset=he.ErrCodeCommon=he.ErrCodeVoutDust=he.ErrCodeAtomicalChangeFail=he.ErrCodeLessAtomicalAmt=void 0;var tp=ae(),xB=li(),Aw=SB($r()),TB=$r();he.ErrCodeLessAtomicalAmt=2011400;he.ErrCodeAtomicalChangeFail=2011401;he.ErrCodeVoutDust=2011402;he.ErrCodeCommon=2011403;he.ErrCodeUnknownAsset=2011404;he.ErrCodeMul=2011420;he.ErrCodeSemiColorOuput=2011405;he.ErrCodeAtomicalNotFullyAllocated=2011406;he.ErrCodeInvalidInputAsset=2011407;var xd=class extends xB.BtcWallet{convert2AtomicalTx(t){let r=(0,tp.cloneObject)(t),n=new Map,i=new Map,s=new Map,o=[],a=r.feePerB||10,c=r.dustSize||546,u=r.inputs;for(let p of u){let y=p.data;if(y!=null&&y instanceof Array)for(let m of y){let _=m.atomicalId,E=m.type,I=Number(m.amount);if(_==null||I==null||E==null||E!="FT"&&E!="NFT")continue;if(I>p.amount)throw new Error(JSON.stringify({errCode:he.ErrCodeInvalidInputAsset}));i.get(_)==null&&i.set(_,E);let k=n.get(_);k==null?n.set(_,I):n.set(_,k+I)}if(Object.keys(n).length>1)throw new Error(JSON.stringify({errCode:he.ErrCodeMul}))}let d=r.outputs,f=0;for(let p of d){let y=p.data;if(y!=null&&y instanceof Array)for(let m of y){let _=m.atomicalId,E=Number(m.amount),I=m.type;if(I=="FT"&&E!=p.amount&&E>c)throw new Error(JSON.stringify({errCode:he.ErrCodeSemiColorOuput}));if(_==null||E==null||I==null||I!="FT"&&I!="NFT")continue;if(I=="FT"&&E!=p.amount&&(f+=1,f==2))throw new Error(JSON.stringify({errCode:he.ErrCodeSemiColorOuput}));if(i.get(_)!=I)throw new Error(JSON.stringify({errCode:he.ErrCodeUnknownAsset}));let k=s.get(_);if(k==null)s.set(_,E);else if(s.set(_,k+E),I=="NFT")throw new Error(JSON.stringify({errCode:he.ErrCodeMul}))}if(Object.keys(s).length>1)throw new Error(JSON.stringify({errCode:he.ErrCodeMul}));o.push({amount:p.amount,address:p.address})}for(let p of n.keys()){let y=n.get(p),m=s.get(p);if(y!=m)throw new Error(JSON.stringify({errCode:he.ErrCodeAtomicalNotFullyAllocated,date:{atomicalId:p,inputAmount:y,sendAmount:m}}))}for(let[p,y]of o.entries())if(y.amount<c)throw new Error(JSON.stringify({errCode:he.ErrCodeVoutDust,vOut:p}));return{inputs:r.inputs,outputs:o,address:r.address,feePerB:a}}async signTransaction(t){let r=this.network(),n=null;try{let i=t.privateKey,s=this.convert2AtomicalTx(t.data);return n=(0,TB.signBtc)(s,i,r),Promise.resolve(n)}catch{return Promise.reject(tp.SignTxError)}}async estimateFee(t){try{let r=this.convert2AtomicalTx(t.data),n=Aw.estimateBtcFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(tp.EstimateFeeError)}}};he.AtomicalWallet=xd;var rp=class extends xd{network(){return Aw.networks.testnet}};he.AtomicalTestWallet=rp});var Bw=H(Td=>{v();w();Object.defineProperty(Td,"__esModule",{value:!0});Td.MAX_TOTAL_SUPPLY=void 0;var PB=2147483647n;Td.MAX_TOTAL_SUPPLY=PB});var np=H(jr=>{v();w();Object.defineProperty(jr,"__esModule",{value:!0});jr.MinterType=jr.CHANGE_MIN_POSTAGE=jr.Postage=jr.SupportedNetwork=jr.CatAddressType=void 0;var EB;(function(e){e.P2WPKH="p2wpkh",e.P2TR="p2tr"})(EB=jr.CatAddressType||(jr.CatAddressType={}));var IB;(function(e){e.btcSignet="btc-signet",e.fractalMainnet="fractal-mainnet",e.fractalTestnet="fractal-testnet"})(IB=jr.SupportedNetwork||(jr.SupportedNetwork={}));var AB;(function(e){e[e.METADATA_POSTAGE=546]="METADATA_POSTAGE",e[e.GUARD_POSTAGE=332]="GUARD_POSTAGE",e[e.MINTER_POSTAGE=331]="MINTER_POSTAGE",e[e.TOKEN_POSTAGE=330]="TOKEN_POSTAGE"})(AB=jr.Postage||(jr.Postage={}));jr.CHANGE_MIN_POSTAGE=546;var OB;(function(e){e.OPEN_MINTER_V1="21cbd2e538f2b6cc40ee180e174f1e25",e.OPEN_MINTER_V2="a6c2e92d74a23c07bb6220b676c6cb9b",e.UNKOWN_MINTER="unkown_minter"})(OB=jr.MinterType||(jr.MinterType={}))});var Cw=H(Mw=>{v();w();Object.defineProperty(Mw,"__esModule",{value:!0})});var Hw=H(Pd=>{v();w();Object.defineProperty(Pd,"__esModule",{value:!0});Pd.isOpenMinter=void 0;var kw=np();function BB(e){return kw.MinterType.OPEN_MINTER_V1===e||kw.MinterType.OPEN_MINTER_V2===e}Pd.isOpenMinter=BB});var Nw=H(Ed=>{v();w();Object.defineProperty(Ed,"__esModule",{value:!0});Ed.btc=void 0;var MB=rc();Object.defineProperty(Ed,"btc",{enumerable:!0,get:function(){return MB.btc}})});var Rw=H(Uw=>{v();w();Object.defineProperty(Uw,"__esModule",{value:!0})});var Ki=H(ei=>{v();w();var CB=ei&&ei.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ja=ei&&ei.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&CB(t,e,r)};Object.defineProperty(ei,"__esModule",{value:!0});Ja(Bw(),ei);Ja(np(),ei);Ja(Cw(),ei);Ja(Hw(),ei);Ja(Nw(),ei);Ja(Rw(),ei)});var ru=H(Y=>{v();w();Object.defineProperty(Y,"__esModule",{value:!0});Y.getFee=Y.getDummySignature=Y.getDummyEcKey=Y.verifyContract=Y.toTokenAddress=Y.resetTx=Y.scaleByDecimals=Y.toP2tr=Y.p2tr2Address=Y.toBitcoinNetwork=Y.toStateScript=Y.callToBufferList=Y.getDummyUTXO=Y.dummyUTXO=Y.getDummySigner=Y.outpoint2ByteString=Y.outpoint2TxOutpoint=Y.toTxOutpoint=Y.getTokenContractP2TR=Y.getTokenContract=Y.getGuardsP2TR=Y.GuardType=Y.script2P2TR=Y.contract2P2TR=Y.strToByteString=Y.byteStringToBuffer=Y.toXOnly=void 0;var ip=rc(),wr=Ki(),qo=cu(),Ro=P3(),op=Up(),kB=ap(),HB=cn(),Id="0250929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0";function NB(e){return e.subarray(1,33)}Y.toXOnly=NB;var UB=function(e){let t=[];for(let r of e)t.push(h.Buffer.from(r,"hex"));return t};Y.byteStringToBuffer=UB;function RB(e){return(0,qo.toByteString)(h.Buffer.from(e,"utf-8").toString("hex"))}Y.strToByteString=RB;function qw(e){let t=e.lockingScript.toBuffer();return{...Lw(t),script:t.toString("hex"),contract:e}}Y.contract2P2TR=qw;function Lw(e){let t=Ro.Tap.encodeScript(e),[r,n]=Ro.Tap.getPubKey(Id,{target:t});return{p2tr:new wr.btc.Script(`OP_1 32 0x${r}}`).toHex(),tapScript:t,cblock:n}}Y.script2P2TR=Lw;var sp;(function(e){e[e.Transfer=0]="Transfer",e[e.Burn=1]="Burn"})(sp=Y.GuardType||(Y.GuardType={}));function Kw(e=sp.Transfer){let t=new ip.BurnGuard,r=new ip.TransferGuard,n=Ro.Tap.encodeScript(t.lockingScript.toBuffer()),i=Ro.Tap.encodeScript(r.lockingScript.toBuffer()),s=[n,i],[o]=Ro.Tap.getPubKey(Id,{tree:s}),[,a]=Ro.Tap.getPubKey(Id,{target:n,tree:s}),[,c]=Ro.Tap.getPubKey(Id,{target:i,tree:s}),u=new wr.btc.Script(`OP_1 32 0x${o}}`).toHex();return e===sp.Transfer?{p2tr:u,tapScript:i,cblock:c,script:r.lockingScript.toBuffer().toString("hex"),contract:r}:{p2tr:u,tapScript:n,cblock:a,script:t.lockingScript.toBuffer().toString("hex"),contract:t}}Y.getGuardsP2TR=Kw;function Dw(e,t){return new ip.CAT20(e,(0,qo.toByteString)(t))}Y.getTokenContract=Dw;function qB(e){let{p2tr:t}=Kw();return qw(Dw(e,t))}Y.getTokenContractP2TR=qB;function jw(e,t){let r=h.Buffer.alloc(4,0);return r.writeUInt32LE(t),{txhash:h.Buffer.from(e,"hex").reverse().toString("hex"),outputIndex:r.toString("hex")}}Y.toTxOutpoint=jw;function Fw(e){let[t,r]=e.split("_");return jw(t,parseInt(r))}Y.outpoint2TxOutpoint=Fw;var LB=function(e){let t=Fw(e);return t.txhash+t.outputIndex};Y.outpoint2ByteString=LB;function KB(e){return qo.TestWallet.random(new qo.DummyProvider)}Y.getDummySigner=KB;Y.dummyUTXO={txId:(0,op.randomBytes)(32).toString("hex"),outputIndex:0,script:"",satoshis:1e4};function DB(e=1e4,t=!1){return t?Object.assign({},Y.dummyUTXO,{satoshis:e,txId:(0,op.randomBytes)(32).toString("hex")}):Object.assign({},Y.dummyUTXO,{satoshis:e})}Y.getDummyUTXO=DB;var jB=function(e){return e.tx.inputs[e.atInputIndex].script.chunks.map(r=>{if(!r.buf)if(r.opcodenum>=81&&r.opcodenum<=96){let n=(0,qo.int2ByteString)(BigInt(r.opcodenum-80));return h.Buffer.from(n,"hex")}else return h.Buffer.from((0,qo.toByteString)(""));return r.buf})};Y.callToBufferList=jB;var FB=function(e){return new wr.btc.Script(`6a1863617401${e.hashRoot}`)};Y.toStateScript=FB;function Vw(e){return e==="btc-signet"?wr.btc.Networks.testnet:wr.btc.Networks.mainnet}Y.toBitcoinNetwork=Vw;function VB(e,t){let r=typeof e=="string"?wr.btc.Script.fromHex(e):e;return wr.btc.Address.fromScript(r,Vw(t)).toString()}Y.p2tr2Address=VB;function GB(e){if((typeof e=="string"?wr.btc.Address.fromString(e):e).type!=="taproot")throw new Error(`address ${e} is not taproot`);return wr.btc.Script.fromAddress(e).toHex()}Y.toP2tr=GB;function WB(e,t){return e*BigInt(Math.pow(10,t))}Y.scaleByDecimals=WB;function zB(e){for(let t=0;t<e.inputs.length;t++){let r=e.inputs[t];r.hasWitnesses()&&r.setWitnesses([])}e.nLockTime=0}Y.resetTx=zB;function XB(e){if(typeof e=="string"&&(e=wr.btc.Address.fromString(e)),e.type===wr.btc.Address.PayToTaproot)return(0,qo.hash160)(e.hashBuffer.toString("hex"));if(e.type===wr.btc.Address.PayToWitnessPublicKeyHash)return e.hashBuffer.toString("hex");throw new Error(`Unsupported address type: ${e.type}`)}Y.toTokenAddress=XB;function YB(e,t,r,n){let i=new wr.btc.Script.Interpreter,s=wr.btc.Script.Interpreter.SCRIPT_VERIFY_WITNESS|wr.btc.Script.Interpreter.SCRIPT_VERIFY_TAPROOT;return i.verify(new wr.btc.Script(""),new wr.btc.Script(e.script),t,r,s,n,e.satoshis)?!0:i.errstr}Y.verifyContract=YB;function $B(){let e=(0,op.randomBytes)(32),t=(0,HB.private2Wif)(e);return new kB.EcKeyService({privateKey:t})}Y.getDummyEcKey=$B;function ZB(){return wr.btc.crypto.Signature.fromString("E907831F80848D1069A5371B402410364BDF1C5F8307B0084C55F1CE2DCA821525F66A4A85EA8B71E482A74F382D2CE5EBEEE8FDB2172F477DF4900D310536C0").toString("hex")}Y.getDummySignature=ZB;function JB(e){return e.inputs.reduce((t,r)=>t+r.output.satoshis,0)-e.outputs.reduce((t,r)=>t+r.satoshis,0)}Y.getFee=JB});var ap=H(Ad=>{v();w();Object.defineProperty(Ad,"__esModule",{value:!0});Ad.EcKeyService=void 0;var Lo=Ki(),us=Ki(),Gw=cu(),QB=ru(),cp=class{constructor(t){if(this.addressType=t.addressType||us.CatAddressType.P2TR,!t.privateKey&&!t.publicKey)throw new Error("Either privateKey or publicKey must be provided");this.privateKey=t.privateKey?Lo.btc.PrivateKey.fromWIF(t.privateKey):void 0,this.publicKey=t.privateKey?this.privateKey.toPublicKey():Lo.btc.PublicKey.fromString(t.publicKey)}hasPrivateKey(){return this.privateKey!==void 0}getWif(){return this.getPrivateKey().toWIF()}getPrivateKey(){return this.privateKey}getAddressType(){return this.addressType||us.CatAddressType.P2TR}getP2TRAddress(){return this.getPublicKey().toAddress(null,Lo.btc.Address.PayToTaproot)}getAddress(){return this.getP2TRAddress()}getXOnlyPublicKey(){let t=this.getTokenPublicKey();return(0,QB.toXOnly)(t.toBuffer()).toString("hex")}getTweakedPrivateKey(){let{tweakedPrivKey:t}=this.getPrivateKey().createTapTweak();return Lo.btc.PrivateKey.fromBuffer(t)}getPublicKey(){return this.publicKey}getTokenPublicKey(){if(this.getAddressType()===us.CatAddressType.P2TR){let{tweakedPubKey:r}=this.publicKey.createTapTweak();return Lo.btc.PublicKey.fromBuffer(r)}return this.publicKey}getPubKeyPrefix(){let t=this.getAddressType();return t===us.CatAddressType.P2TR?"":t===us.CatAddressType.P2WPKH?this.getTokenPublicKey().toString().slice(0,2):""}getTokenAddress(){let t=this.getAddressType();if(t===us.CatAddressType.P2TR){let r=this.getXOnlyPublicKey();return(0,Gw.hash160)(r)}else if(t===us.CatAddressType.P2WPKH){let r=this.getTokenPublicKey();return(0,Gw.hash160)(r.toString())}else throw new Error(`Unsupported address type: ${t}`)}getTaprootPrivateKey(){return this.getTweakedPrivateKey()}getTokenPrivateKey(){let t=this.getAddressType();if(t===us.CatAddressType.P2TR)return this.getTaprootPrivateKey();if(t===us.CatAddressType.P2WPKH)return this.getPrivateKey();throw new Error(`Unsupported address type: ${t}`)}signTx(t){if(!this.hasPrivateKey())throw new Error("No private key provided");let r=this.getPrivateKey(),n=Lo.btc.crypto.Hash.sha256ripemd160(r.publicKey.toBuffer());for(let i=0;i<t.inputs.length;i++){let s=t.inputs[i];if(s.output.script.isWitnessPublicKeyHashOut()){let o=s.getSignatures(t,r,i,void 0,n,void 0,void 0);if(o.length===0)throw new Error("Could not sign input");t.applySignature(o[0])}else if(s.output.script.isTaproot()&&!s.hasWitnesses()){let o=s.getSignatures(t,r,i,Lo.btc.crypto.Signature.SIGHASH_ALL,n,void 0,void 0);if(o.length===0)throw new Error("Could not sign input");t.applySignature(o[0])}}}};Ad.EcKeyService=cp});var Ww=H(Di=>{v();w();Object.defineProperty(Di,"__esModule",{value:!0});Di.scaleConfig=Di.tokenUtxoParse=Di.feeUtxoParse=Di.tokenInfoParse=void 0;var eM=Ki(),tM=rc(),Ko=ru();function rM(e,t){let r=JSON.parse(e),n=JSON.parse(JSON.stringify(r.info));if(n.max&&(n.max=BigInt(n.max),n.premine=BigInt(n.premine),n.limit=BigInt(n.limit)),r.info=n,!r.tokenAddr){let i=(0,Ko.toP2tr)(r.minterAddr);r.tokenAddr=(0,Ko.p2tr2Address)((0,Ko.getTokenContractP2TR)(i).p2tr,t)}return r}Di.tokenInfoParse=rM;function nM(e,t){return t.map(r=>{let n=eM.btc.Script.fromAddress(e.getAddress()).toHex();return{txId:r.txId,outputIndex:r.vOut,script:n,satoshis:r.amount}})}Di.feeUtxoParse=nM;function iM(e){let t=JSON.parse(e);return Array.isArray(t)||(t=[t]),t.map(r=>{let n=tM.ProtocolState.fromStateHashList(r.txoStateHashes);typeof r.utxo.satoshis=="string"&&(r.utxo.satoshis=parseInt(r.utxo.satoshis));let i=r.state.address;try{i=(0,Ko.toTokenAddress)(r.state.address)}catch{}return{utxo:r.utxo,state:{protocolState:n,data:{ownerAddr:i,amount:BigInt(r.state.amount)}}}})}Di.tokenUtxoParse=iM;function sM(e){let t=Object.assign({},e);return t.max=(0,Ko.scaleByDecimals)(e.max,e.decimals),t.premine=(0,Ko.scaleByDecimals)(e.premine,e.decimals),t.limit=(0,Ko.scaleByDecimals)(e.limit,e.decimals),t}Di.scaleConfig=sM});var Yw=H(Od=>{v();w();Object.defineProperty(Od,"__esModule",{value:!0});Od.validatePrevTx=void 0;var zw=Ki(),Xw=ru();function oM(e,t,r,n){let i=0,s=new zw.btc.Transaction(t);if(!s.inputs.find((u,d)=>{let f=u.getWitnesses();if(Array.isArray(f)&&f.length>2){let p=f[f.length-2],{p2tr:y}=(0,Xw.script2P2TR)(p),m=(0,Xw.p2tr2Address)(y,n);if(m===e.tokenAddr||m===e.minterAddr)return i=d,!0}}))return null;let a=s.inputs[i].prevTxId.toString("hex"),c=new zw.btc.Transaction(r);return c.id!=a?null:{prevTx:s,prevPrevTx:c,prevTokenInputIndex:i}}Od.validatePrevTx=oM});var $w=H(Bd=>{v();w();Object.defineProperty(Bd,"__esModule",{value:!0});Bd.pickLargeFeeUtxo=void 0;function aM(e){let t=e[0];for(let r of e)r.satoshis>t.satoshis&&(t=r);return t}Bd.pickLargeFeeUtxo=aM});var iu=H(hi=>{v();w();var cM=hi&&hi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),nu=hi&&hi.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&cM(t,e,r)};Object.defineProperty(hi,"__esModule",{value:!0});nu(ap(),hi);nu(Ww(),hi);nu(Yw(),hi);nu(ru(),hi);nu($w(),hi)});var up=H(ao=>{v();w();Object.defineProperty(ao,"__esModule",{value:!0});ao.unlockGuard=ao.unlockToken=ao.createGuardContract=void 0;var uM=iu(),Do=Ki(),ti=iu(),oo=rc(),su=cu();function fM(e,t,r,n,i,s){let{p2tr:o,tapScript:a}=(0,ti.getGuardsP2TR)(),c=oo.ProtocolState.getEmptyState(),u=oo.GuardProto.createEmptyState();u.tokenScript=i;for(let p=0;p<n.length;p++)u.inputTokenAmountArray[p]=n[p].state.data.amount;c.updateDataList(0,oo.GuardProto.toByteString(u));let d=new Do.btc.Transaction().from(t).addOutput(new Do.btc.Transaction.Output({satoshis:0,script:(0,ti.toStateScript)(c)})).addOutput(new Do.btc.Transaction.Output({satoshis:Do.Postage.GUARD_POSTAGE,script:o})).feePerByte(r).change(s);if(d.getChangeOutput()===null)throw new Error("Insufficient satoshis balance!");d.outputs[2].satoshis-=1,e.hasPrivateKey()&&e.signTx(d);let f={utxo:{txId:d.id,outputIndex:1,script:d.outputs[1].script.toHex(),satoshis:d.outputs[1].satoshis},state:{protocolState:c,data:u}};return{commitTx:d,contact:f,guardTapScript:a}}ao.createGuardContract=fM;async function dM(e,t,r,n,i,s,o,a,c,u,d,f,p,y){let{cblock:m,contract:_}=(0,ti.getTokenContractP2TR)(c),{shPreimage:E,prevoutsCtx:I,spentScripts:k,sighash:C}=u,R={isUserSpend:!1,userPubKeyPrefix:(0,su.toByteString)(""),userPubKey:(0,su.PubKey)(e.getXOnlyPublicKey()),userSig:(0,uM.getDummySignature)(),contractInputIndex:BigInt(y||0)};if(!p){let l;e.hasPrivateKey()?l=Do.btc.crypto.Schnorr.sign(e.getTokenPrivateKey(),C.hash):l=Do.btc.crypto.Signature.fromString(f);let g=e.getXOnlyPublicKey();R={isUserSpend:!0,userPubKeyPrefix:e.getPubKeyPrefix(),userPubKey:(0,su.PubKey)(g),userSig:l.toString("hex"),contractInputIndex:0n}}let U=(0,oo.getBackTraceInfo)(n,s,i),{state:{protocolState:q,data:L}}=t;await _.connect((0,ti.getDummySigner)());let K={statesHashRoot:q.hashRoot,txoStateHashes:q.stateHashList},W=await _.methods.unlock(R,L,K,o,U,E,I,k,{fromUTXO:(0,ti.getDummyUTXO)(),verify:!1,exec:!1}),O=[...(0,ti.callToBufferList)(W),_.lockingScript.toBuffer(),h.Buffer.from(m,"hex")];if(a.inputs[r].witnesses=O,d){let l=(0,ti.verifyContract)(t.utxo,a,r,O);if(typeof l=="string")throw new Error(`unlocking token contract at input ${r} failed! ${l}`);return!0}return!0}ao.unlockToken=dM;async function lM(e,t,r,n,i,s,o,a,c,u){let{shPreimage:d,prevoutsCtx:f,spentScripts:p}=c,y=(0,oo.emptyTokenArray)(),m=(0,oo.emptyTokenAmountArray)(),_=(0,su.fill)(!1,oo.MAX_TOKEN_OUTPUT);y[0]=s.ownerAddr,m[0]=s.amount,_[0]=!0,o&&(y[1]=o.ownerAddr,m[1]=o.amount,_[1]=!0);let E=o===null?1:2,{cblock:I,contract:k}=(0,ti.getGuardsP2TR)();await k.connect((0,ti.getDummySigner)());let C=(0,oo.emptyTokenArray)();a!=null&&(C[E]=a.satoshis,y[E]=a.script,_[E]=!1);let R=await k.methods.transfer(n.stateHashList,y,m,_,C,(0,su.int2ByteString)(BigInt(Do.Postage.TOKEN_POSTAGE),8n),e.state.data,t.tx,d,f,p,{fromUTXO:(0,ti.getDummyUTXO)(),verify:!1,exec:!1}),U=[...(0,ti.callToBufferList)(R),k.lockingScript.toBuffer(),h.Buffer.from(I,"hex")];if(i.inputs[r].witnesses=U,u){let q=(0,ti.verifyContract)(e.utxo,i,r,U);if(typeof q=="string")throw new Error(`unlocking guard contract failed! ${q}`);return!0}return!0}ao.unlockGuard=lM});var fp=H(Md=>{v();w();Object.defineProperty(Md,"__esModule",{value:!0});Md.mergeFee=void 0;var hM=Ki();function pM(e,t,r){let n=e.getAddress(),i=new hM.btc.Transaction().from(t).feePerByte(r).change(n);if(i.getChangeOutput()===null)throw new Error("Insufficient satoshis balance!");let s=i.outputs[0];s.satoshis-=1,e.hasPrivateKey()&&e.signTx(i);let o={address:n,txId:i.id,outputIndex:0,script:s.script,satoshis:s.satoshis};return{mergeTx:i,feeUtxo:o}}Md.mergeFee=pM});var Jw=H(ji=>{v();w();Object.defineProperty(ji,"__esModule",{value:!0});ji.calcVsizeTransfer=ji.transfer=ji.estimateFee=void 0;var Jr=Ki(),dp=cu(),Mr=iu(),fs=rc(),ou=up(),bM=fp();async function gM(e){return e.data.estimateFee=!0,await Zw(e)}ji.estimateFee=gM;async function Zw(e){let t=e.data,r=t.estimateFee?(0,Mr.getDummyEcKey)():new Mr.EcKeyService({privateKey:e.privateKey}),n=(0,Mr.tokenInfoParse)(t.tokenMetadata,Jr.SupportedNetwork.fractalMainnet),i=(0,Mr.toP2tr)(n.minterAddr),{p2tr:s,tapScript:o}=(0,Mr.getTokenContractP2TR)(i),a=t.verifyScript||!1,c,u;try{c=Jr.btc.Address.fromString(t.toAddress)}catch{throw new Error(`Invalid receiver address: ${t.toAddress}`)}if(c.type!=="taproot")throw new Error(`Invalid address type: ${c.type}`);try{u=BigInt(t.tokenAmount)}catch{throw new Error(`Invalid token amount:  ${t.tokenAmount}`)}if(u<=0n)throw new Error("Invalid token amount");let d=(0,Mr.feeUtxoParse)(r,e.data.feeInputs),f=d[0],p;d.length>1&&({feeUtxo:f,mergeTx:p}=(0,bM.mergeFee)(r,d,t.feeRate));let y=(0,Mr.tokenUtxoParse)(t.tokens),m=(0,ou.createGuardContract)(r,f,t.feeRate,y,s,t.changeAddress);if(m===null)return null;let{commitTx:_,contact:E,guardTapScript:I}=m,k=fs.ProtocolState.getEmptyState(),C=fs.CAT20Proto.create(u,(0,Mr.toTokenAddress)(c));k.updateDataList(0,fs.CAT20Proto.toByteString(C));let U=y.reduce((D,V)=>D+V.state.data.amount,0n)-u,q=null;if(U>0n){let D=r.getTokenAddress();q=fs.CAT20Proto.create(U,D),k.updateDataList(1,fs.CAT20Proto.toByteString(q))}let L={txId:_.id,outputIndex:2,script:_.outputs[2].script.toHex(),satoshis:_.outputs[2].satoshis},K=[...y.map(D=>D.utxo),E.utxo,L];if(K.length>fs.MAX_INPUT)throw new Error("Too many inputs, max 4 token inputs");let W=new Jr.btc.Transaction().from(K).addOutput(new Jr.btc.Transaction.Output({satoshis:0,script:(0,Mr.toStateScript)(k)})).addOutput(new Jr.btc.Transaction.Output({satoshis:Jr.Postage.TOKEN_POSTAGE,script:s})).feePerByte(t.feeRate);q&&W.addOutput(new Jr.btc.Transaction.Output({satoshis:Jr.Postage.TOKEN_POSTAGE,script:s}));let O=Jr.btc.Script.fromAddress(t.changeAddress);W.addOutput(new Jr.btc.Transaction.Output({satoshis:0,script:O}));let l=[];if(t.tokenPrevTxs.length!==y.length)throw new Error("Invalid tokenPrevTxs length");for(let D=0;D<y.length;D++){let V=t.tokenPrevTxs[D].prevTx,J=t.tokenPrevTxs[D].prevPrevTx,fe=(0,Mr.validatePrevTx)(n,V,J,Jr.SupportedNetwork.fractalMainnet);if(fe===null)throw new Error("prevTx does not match prevPrevTx");l.push(fe)}let g=(0,fs.getTxHeaderCheck)(_,E.utxo.outputIndex),S=y.length,T={outputIndex:(0,Mr.toTxOutpoint)(E.utxo.txId,E.utxo.outputIndex).outputIndex,inputIndexVal:BigInt(S),tx:g.tx,guardState:E.state.data},{vsize:x}=await(0,ji.calcVsizeTransfer)(y,E,W,T,l,o,I,k,C,q,O,i),B=q===null?2:3,M=W.inputAmount-x*t.feeRate-Jr.Postage.TOKEN_POSTAGE-(q===null?0:Jr.Postage.TOKEN_POSTAGE),P=x*t.feeRate;if(M<=Jr.CHANGE_MIN_POSTAGE){M=0,W.removeOutput(B);let{vsize:D,fee:V}=await(0,ji.calcVsizeTransfer)(y,E,W,T,l,o,I,k,C,q,O,i);x=D,P=V}else W.outputs[B].satoshis=M;if(t.estimateFee)return p?{mergeTx:(0,Mr.getFee)(p),commitTx:(0,Mr.getFee)(_),revealTx:P}:{commitTx:(0,Mr.getFee)(_),revealTx:P};let b=null;M>BigInt(0)&&(b={script:(0,dp.toByteString)(O.toHex()),satoshis:(0,dp.int2ByteString)(BigInt(M),BigInt(8))});let A=(0,fs.getTxCtxMulti)(W,y.map((D,V)=>V).concat([y.length]),[...new Array(y.length).fill(h.Buffer.from(o,"hex")),h.Buffer.from(I,"hex")]);for(let D=0;D<y.length;D++)if(!await(0,ou.unlockToken)(r,y[D],D,l[D].prevTx,l[D].prevTokenInputIndex,l[D].prevPrevTx,T,W,i,A[D],a))return null;return await(0,ou.unlockGuard)(E,T,S,k,W,C,q,b,A[S],a)?(r.signTx(W),p?{mergeTx:p.uncheckedSerialize(),commitTx:_.uncheckedSerialize(),revealTx:W.uncheckedSerialize()}:{commitTx:_.uncheckedSerialize(),revealTx:W.uncheckedSerialize()}):null}ji.transfer=Zw;var yM=async(e,t,r,n,i,s,o,a,c,u,d,f)=>{let p=(0,Mr.getDummyEcKey)(),y=Jr.btc.Script.fromAddress(p.getAddress()),m=r.inputs.length-1,_=r.inputs[m].output.script;r.inputs[m].output.setScript(y);let E=(0,fs.getTxCtxMulti)(r,e.map((U,q)=>q).concat([e.length]),[...new Array(e.length).fill(h.Buffer.from(s,"hex")),h.Buffer.from(o,"hex")]),I=e.length,k={script:d.toHex(),satoshis:(0,dp.int2ByteString)(0n,8n)};for(let U=0;U<e.length;U++)await(0,ou.unlockToken)(p,e[U],U,i[U].prevTx,i[U].prevTokenInputIndex,i[U].prevPrevTx,n,r,f,E[U],!1);await(0,ou.unlockGuard)(t,n,I,a,r,c,u,k,E[I],!1),p.signTx(r);let C=r.vsize,R=(0,Mr.getFee)(r);return(0,Mr.resetTx)(r),r.inputs[m].output.setScript(_),{vsize:C,fee:R}};ji.calcVsizeTransfer=yM});var Qw=H(ds=>{v();w();var mM=ds&&ds.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),lp=ds&&ds.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&mM(t,e,r)};Object.defineProperty(ds,"__esModule",{value:!0});lp(up(),ds);lp(fp(),ds);lp(Jw(),ds)});var pp=H(ls=>{v();w();var _M=ls&&ls.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),hp=ls&&ls.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&_M(t,e,r)};Object.defineProperty(ls,"__esModule",{value:!0});hp(Ki(),ls);hp(Qw(),ls);hp(iu(),ls)});var r3=H(Cd=>{v();w();Object.defineProperty(Cd,"__esModule",{value:!0});Cd.CatWallet=void 0;var e3=ae(),vM=li(),t3=pp(),bp=class extends vM.BtcWallet{async signTransaction(t){try{let r=await(0,t3.transfer)(t);return Promise.resolve(r)}catch{return Promise.reject(e3.SignTxError)}}async estimateFee(t){try{t.data.estimateFee=!0;let r=await(0,t3.transfer)(t);return Promise.resolve(r)}catch{return Promise.reject(e3.EstimateFeeError)}}};Cd.CatWallet=bp});var _d=H(Fr=>{v();w();var wM=Fr&&Fr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Fi=Fr&&Fr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&wM(t,e,r)};Object.defineProperty(Fr,"__esModule",{value:!0});Fi(li(),Fr);Fi(rw(),Fr);Fi(nw(),Fr);Fi(iw(),Fr);Fi(ow(),Fr);Fi(aw(),Fr);Fi(hw(),Fr);Fi(Iw(),Fr);Fi(Ow(),Fr);Fi(r3(),Fr)});var i3=H(kd=>{v();w();Object.defineProperty(kd,"__esModule",{value:!0});kd.oneKeyBuildBtcTx=void 0;var SM=un(),xM=Fs(),gp=ae(),yp=_d(),mp=cn(),TM=vn(),PM={legacy:"SPENDADDRESS",segwit_native:"SPENDWITNESS",segwit_nested:"SPENDP2SHWITNESS",segwit_taproot:"SPENDTAPROOT"},EM={legacy:"PAYTOADDRESS",segwit_native:"PAYTOWITNESS",segwit_nested:"PAYTOP2SHWITNESS",segwit_taproot:"PAYTOTAPROOT"};function IM(e,t=TM.bitcoin){let r=(0,yp.convert2UtxoTx)(e);if(r.omni){let c=(0,yp.number2Hex)(r.omni.coinType||31,8),u=(0,yp.number2Hex)(r.omni.amount,16),d="6f6d6e6900000000"+c+u;r.outputs.push({address:"",amount:0,omniScript:d})}let n=parseInt((0,mp.signBtc)(r,"",t,void 0,!0,!0)),i=e.dustSize||546;n>=i&&r.outputs.push({address:r.address,amount:n,derivationPath:r.derivationPath,isChange:!0});let s=[],o=[];r.inputs.forEach(c=>{let u=n3(c.derivationPath);s.push({address_n:u,prev_hash:c.txId,prev_index:c.vOut,amount:c.amount.toString(),script_type:PM[(0,mp.getAddressType)(c.address,t)]}),o.push(AM(c.nonWitnessUtxo,c.txId))});let a=[];return r.outputs.forEach(c=>{c.isChange?a.push({address_n:n3(c.derivationPath),amount:c.amount.toString(),script_type:EM[(0,mp.getAddressType)(c.address,t)]}):c.omniScript?a.push({amount:"0",op_return_data:c.omniScript,script_type:"PAYTOOPRETURN"}):a.push({address:c.address,amount:c.amount.toString(),script_type:"PAYTOADDRESS"})}),{inputs:s,outputs:a,refTxs:o,coin:"btc"}}kd.oneKeyBuildBtcTx=IM;function AM(e,t){let r=SM.Transaction.fromHex(e),n=[];r.ins.forEach(s=>{n.push({prev_hash:gp.base.toHex((0,xM.reverseBuffer)(s.hash)),prev_index:s.index,script_sig:gp.base.toHex(s.script),sequence:s.sequence})});let i=[];return r.outs.forEach(s=>{i.push({amount:s.value,script_pubkey:gp.base.toHex(s.script)})}),{hash:t,inputs:n,bin_outputs:i,lock_time:r.locktime,version:r.version}}function n3(e){let t=e.split("/");t[0]==="m"&&(t=t.slice(1));let r=[];return t.forEach(n=>{let i;n.slice(-1)==="'"?i=OM(parseInt(n.slice(0,-1),10)):i=parseInt(n,10),r.push(i)}),r}function OM(e){return 2147483648+e}});var s3=H(au=>{v();w();Object.defineProperty(au,"__esModule",{value:!0});au.BtcXrcTypes=void 0;var BM;(function(e){e[e.INSCRIBE=1]="INSCRIBE",e[e.PSBT=2]="PSBT",e[e.PSBT_MPC_UNSIGNED_LIST=21]="PSBT_MPC_UNSIGNED_LIST",e[e.PSBT_MPC_SIGNED_LIST=22]="PSBT_MPC_SIGNED_LIST",e[e.PSBT_MPC_UNSIGNED_BUY=23]="PSBT_MPC_UNSIGNED_BUY",e[e.PSBT_MPC_SIGNED_BUY=24]="PSBT_MPC_SIGNED_BUY",e[e.PSBT_MPC_UNSIGNED=25]="PSBT_MPC_UNSIGNED",e[e.PSBT_MPC_SIGNED=26]="PSBT_MPC_SIGNED",e[e.PSBT_RUNEMAIN=27]="PSBT_RUNEMAIN",e[e.PSBT_KEY_SCRIPT_PATH=3]="PSBT_KEY_SCRIPT_PATH",e[e.PSBT_KEY_SCRIPT_PATH_BATCH=4]="PSBT_KEY_SCRIPT_PATH_BATCH",e[e.SRC20=101]="SRC20",e[e.RUNE=102]="RUNE",e[e.RUNEMAIN=103]="RUNEMAIN",e[e.PSBT_DECODE=104]="PSBT_DECODE",e[e.ARC20=114]="ARC20",e[e.CAT20=115]="CAT20"})(BM=au.BtcXrcTypes||(au.BtcXrcTypes={}))});var $r=H(ke=>{v();w();var o3=ke&&ke.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),MM=ke&&ke.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),mn=ke&&ke.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&o3(t,e,r)},a3=ke&&ke.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&o3(t,e,r);return MM(t,e),t};Object.defineProperty(ke,"__esModule",{value:!0});ke.message=ke.wif=void 0;mn(un(),ke);mn(Tv(),ke);mn(cn(),ke);mn(Ev(),ke);ke.wif=a3(jh());mn(Mv(),ke);mn(Lv(),ke);mn(Fv(),ke);mn(Yv(),ke);mn(O0(),ke);ke.message=a3(Qv());mn(_d(),ke);mn(i3(),ke);mn(s3(),ke);mn(pp(),ke);mn(Mi(),ke)});var d3=H(ri=>{v();w();var CM=ri&&ri.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),kM=ri&&ri.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f3=ri&&ri.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&CM(t,e,r);return kM(t,e),t};Object.defineProperty(ri,"__esModule",{value:!0});ri.ZcashTestnetWallet=ri.ZcashWallet=void 0;var Qa=ae(),hs=f3(Sh()),c3=sn(),u3=f3($r()),Hd=class extends Qa.BaseWallet{network(){return hs.MAINNET}getPrivateKey(t){return u3.wif.decode(t,this.network().wif).privateKey}async getDerivedPath(t){return Promise.resolve(`m/44'/133'/0'/0/${t.index}`)}async getDerivedPrivateKey(t){let r=this.network();return c3.bip39.mnemonicToSeedV2(t.mnemonic).then(n=>{let i=c3.bip32.fromSeedV2(n,t.hdPath);if(!i.privateKey)return Promise.reject(Qa.GenPrivateKeyError);let s=u3.wif.encode(r.wif,h.Buffer.from(i.privateKey),!0);return Promise.resolve(s)}).catch(n=>Promise.reject(Qa.GenPrivateKeyError))}async validPrivateKey(t){let r;try{this.getPrivateKey(t.privateKey),r=!0}catch{r=!1}let n={isValid:r,privateKey:t.privateKey};return Promise.resolve(n)}async getNewAddress(t){let r=this.getPrivateKey(t.privateKey),n=hs.skToAddr(r,this.network().p2pkhPrefix);return Promise.resolve(n)}async validAddress(t){let r=hs.isValidAddr(t.address,this.network());return Promise.resolve({isValid:r,address:t.address})}async signTransaction(t){try{let r=t.data,n=hs.buildTx(r.address,r.inputs,r.outputs,this.network(),r.version,r.height,r.dust,r.feeRate),i=this.getPrivateKey(t.privateKey),s=await hs.signTx(i,n),o=hs.serializeTx(s);return Promise.resolve(o)}catch{return Promise.reject(Qa.SignTxError)}}async estimateFee(t){let r=t.data,{fee:n}=hs.buildTx(r.address,r.inputs,r.outputs,this.network(),r.version,r.height,r.dust,r.feeRate);return Promise.resolve(n)}async calcTxHash(t){try{return Promise.resolve(hs.calcTxHash(t.data))}catch{return Promise.reject(Qa.CalcTxHashError)}}async signCommonMsg(t){let r=await this.getNewAddress({privateKey:t.privateKey,addressType:t.addressType}),n=r.compressedPublicKey?r.compressedPublicKey:r.publicKey;n.startsWith("0x")&&(n=n.substring(2));let i=this.getPrivateKey(t.privateKey);return super.signCommonMsg({privateKey:t.privateKey,privateKeyHex:i.toString("hex"),publicKey:n,addressType:t.addressType,message:t.message,signType:Qa.SignType.Secp256k1})}};ri.ZcashWallet=Hd;var _p=class extends Hd{network(){return hs.TESTNET}};ri.ZcashTestnetWallet=_p});var h3=H(l3=>{v();w();Object.defineProperty(l3,"__esModule",{value:!0})});var NM=H(ps=>{v();w();var HM=ps&&ps.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),vp=ps&&ps.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&HM(t,e,r)};Object.defineProperty(ps,"__esModule",{value:!0});vp(d3(),ps);vp(h3(),ps);vp(Sh(),ps)});export{NM as a};
//# sourceMappingURL=chunk-AG2P5JVK.js.map
