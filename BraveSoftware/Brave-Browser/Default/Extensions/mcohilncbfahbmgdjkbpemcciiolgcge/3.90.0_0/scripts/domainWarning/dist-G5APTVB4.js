import{a as JA}from"./chunk-NSX4KF3O.js";import{a as w2}from"./chunk-FXVZPPQ7.js";import{a as ZA}from"./chunk-Q7HUNUA7.js";import"./chunk-OAMYZMR4.js";import{a as lc,d as Pm,l as Cm,m as rl,n as Im,p as ar}from"./chunk-UGRF6UE3.js";import{a as Em,b as Am}from"./chunk-4GQL426X.js";import"./chunk-DFE56MUO.js";import{G as mm,H as wm,I as _m,L as tl,M as Sm,O as xm,a as cf,d as ym}from"./chunk-HONEWRHX.js";import{b as el,c as K,d as m2,g as ws,o as D,p as H,q as N}from"./chunk-LHDKEQAM.js";var Bm=K(Fa=>{D();N();Object.defineProperty(Fa,"__esModule",{value:!0});Fa.base58=Fa.fromBase58=Fa.toBase58=void 0;var _2=lc();Object.defineProperty(Fa,"base58",{enumerable:!0,get:function(){return _2.base58}});function QA(e){let t=H.Buffer.from(e);return _2.base58.encode(Uint8Array.from(t))}Fa.toBase58=QA;function eP(e){return _2.base58.decode(e)}Fa.fromBase58=eP});var Mm=K(ff=>{D();N();Object.defineProperty(ff,"__esModule",{value:!0});ff.validateHexString=ff.isHexString=void 0;function tP(e,t){return e.match(/^0x[0-9A-Fa-f]*$/)?!(t&&e.length!==2+2*t):!1}ff.isHexString=tP;function rP(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||t.length%2!==0||!t.match(/^[0-9A-Fa-f]*$/))}ff.validateHexString=rP});var Tm=K(_s=>{D();N();Object.defineProperty(_s,"__esModule",{value:!0});_s.isHexPrefixed=_s.stripHexPrefix=_s.fromHex=_s.toHex=void 0;var nP=Mm();function iP(e,t=!1){let r=H.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}_s.toHex=iP;function sP(e){if((e.startsWith("0x")||e.startsWith("0X"))&&(e=e.substring(2)),e.length%2!=0&&(e="0"+e),!(0,nP.validateHexString)(e))throw new Error("invalid hex string");return H.Buffer.from(e,"hex")}_s.fromHex=sP;function aP(e){return e.startsWith("0x")?e.substring(2):e}_s.stripHexPrefix=aP;function oP(e){return e.startsWith("0x")}_s.isHexPrefixed=oP});var ta=K(hc=>{D();N();Object.defineProperty(hc,"__esModule",{value:!0});hc.anumber=S2;hc.abytes=Om;hc.ahash=fP;hc.aexists=uP;hc.aoutput=dP;function S2(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function cP(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Om(e,...t){if(!cP(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function fP(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");S2(e.outputLen),S2(e.blockLen)}function uP(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function dP(e,t){Om(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}});var Dm=K(nl=>{D();N();Object.defineProperty(nl,"__esModule",{value:!0});nl.crypto=void 0;nl.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var un=K(_t=>{D();N();Object.defineProperty(_t,"__esModule",{value:!0});_t.Hash=_t.nextTick=_t.byteSwapIfBE=_t.isLE=void 0;_t.isBytes=lP;_t.u8=hP;_t.u32=pP;_t.createView=bP;_t.rotr=gP;_t.rotl=vP;_t.byteSwap=A2;_t.byteSwap32=yP;_t.bytesToHex=wP;_t.hexToBytes=_P;_t.asyncLoop=xP;_t.utf8ToBytes=Fm;_t.toBytes=il;_t.concatBytes=EP;_t.checkOpts=AP;_t.wrapConstructor=PP;_t.wrapConstructorWithOpts=CP;_t.wrapXOFConstructorWithOpts=IP;_t.randomBytes=BP;var uf=Dm(),E2=ta();function lP(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function hP(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function pP(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function bP(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gP(e,t){return e<<32-t|e>>>t}function vP(e,t){return e<<t|e>>>32-t>>>0}_t.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function A2(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}_t.byteSwapIfBE=_t.isLE?e=>e:e=>A2(e);function yP(e){for(let t=0;t<e.length;t++)e[t]=A2(e[t])}var Rm=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",mP=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function wP(e){if((0,E2.abytes)(e),Rm)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=mP[e[r]];return t}var ra={_0:48,_9:57,A:65,F:70,a:97,f:102};function Nm(e){if(e>=ra._0&&e<=ra._9)return e-ra._0;if(e>=ra.A&&e<=ra.F)return e-(ra.A-10);if(e>=ra.a&&e<=ra.f)return e-(ra.a-10)}function _P(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Rm)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let a=Nm(e.charCodeAt(s)),o=Nm(e.charCodeAt(s+1));if(a===void 0||o===void 0){let c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=a*16+o}return n}var SP=async()=>{};_t.nextTick=SP;async function xP(e,t,r){let n=Date.now();for(let i=0;i<e;i++){r(i);let s=Date.now()-n;s>=0&&s<t||(await(0,_t.nextTick)(),n+=s)}}function Fm(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function il(e){return typeof e=="string"&&(e=Fm(e)),(0,E2.abytes)(e),e}function EP(...e){let t=0;for(let n=0;n<e.length;n++){let i=e[n];(0,E2.abytes)(i),t+=i.length}let r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var x2=class{clone(){return this._cloneInto()}};_t.Hash=x2;function AP(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function PP(e){let t=n=>e().update(il(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function CP(e){let t=(n,i)=>e(i).update(il(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function IP(e){let t=(n,i)=>e(i).update(il(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function BP(e=32){if(uf.crypto&&typeof uf.crypto.getRandomValues=="function")return uf.crypto.getRandomValues(new Uint8Array(e));if(uf.crypto&&typeof uf.crypto.randomBytes=="function")return Uint8Array.from(uf.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var sl=K(pc=>{D();N();Object.defineProperty(pc,"__esModule",{value:!0});pc.HashMD=void 0;pc.setBigUint64=qm;pc.Chi=MP;pc.Maj=TP;var P2=ta(),Sd=un();function qm(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,a,n),e.setUint32(t+u,o,n)}function MP(e,t,r){return e&t^~e&r}function TP(e,t,r){return e&t^e&r^t&r}var C2=class extends Sd.Hash{constructor(t,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(t),this.view=(0,Sd.createView)(this.buffer)}update(t){(0,P2.aexists)(this);let{view:r,buffer:n,blockLen:i}=this;t=(0,Sd.toBytes)(t);let s=t.length;for(let a=0;a<s;){let o=Math.min(i-this.pos,s-a);if(o===i){let c=(0,Sd.createView)(t);for(;i<=s-a;a+=i)this.process(c,a);continue}n.set(t.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,P2.aexists)(this),(0,P2.aoutput)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let h=a;h<i;h++)r[h]=0;qm(n,i-8,BigInt(this.length*8),s),this.process(n,0);let o=(0,Sd.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,b=this.get();if(u>b.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)o.setUint32(4*h,b[h],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:a,pos:o}=this;return t.length=i,t.pos=o,t.finished=s,t.destroyed=a,i%r&&t.buffer.set(n),t}};pc.HashMD=C2});var df=K(ja=>{D();N();Object.defineProperty(ja,"__esModule",{value:!0});ja.sha224=ja.sha256=ja.SHA256=void 0;var I2=sl(),Ii=un(),OP=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qa=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ha=new Uint32Array(64),xd=class extends I2.HashMD{constructor(t=32){super(64,t,8,!1),this.A=qa[0]|0,this.B=qa[1]|0,this.C=qa[2]|0,this.D=qa[3]|0,this.E=qa[4]|0,this.F=qa[5]|0,this.G=qa[6]|0,this.H=qa[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:a,G:o,H:c}=this;return[t,r,n,i,s,a,o,c]}set(t,r,n,i,s,a,o,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=a|0,this.G=o|0,this.H=c|0}process(t,r){for(let h=0;h<16;h++,r+=4)Ha[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let d=Ha[h-15],l=Ha[h-2],y=(0,Ii.rotr)(d,7)^(0,Ii.rotr)(d,18)^d>>>3,p=(0,Ii.rotr)(l,17)^(0,Ii.rotr)(l,19)^l>>>10;Ha[h]=p+Ha[h-7]+y+Ha[h-16]|0}let{A:n,B:i,C:s,D:a,E:o,F:c,G:u,H:b}=this;for(let h=0;h<64;h++){let d=(0,Ii.rotr)(o,6)^(0,Ii.rotr)(o,11)^(0,Ii.rotr)(o,25),l=b+d+(0,I2.Chi)(o,c,u)+OP[h]+Ha[h]|0,p=((0,Ii.rotr)(n,2)^(0,Ii.rotr)(n,13)^(0,Ii.rotr)(n,22))+(0,I2.Maj)(n,i,s)|0;b=u,u=c,c=o,o=a+l|0,a=s,s=i,i=n,n=l+p|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,u=u+this.G|0,b=b+this.H|0,this.set(n,i,s,a,o,c,u,b)}roundClean(){Ha.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};ja.SHA256=xd;var B2=class extends xd{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}};ja.sha256=(0,Ii.wrapConstructor)(()=>new xd);ja.sha224=(0,Ii.wrapConstructor)(()=>new B2)});var lf=K(Me=>{D();N();Object.defineProperty(Me,"__esModule",{value:!0});Me.add5L=Me.add5H=Me.add4H=Me.add4L=Me.add3H=Me.add3L=Me.rotlBL=Me.rotlBH=Me.rotlSL=Me.rotlSH=Me.rotr32L=Me.rotr32H=Me.rotrBL=Me.rotrBH=Me.rotrSL=Me.rotrSH=Me.shrSL=Me.shrSH=Me.toBig=void 0;Me.fromBig=T2;Me.split=Hm;Me.add=Jm;var al=BigInt(2**32-1),M2=BigInt(32);function T2(e,t=!1){return t?{h:Number(e&al),l:Number(e>>M2&al)}:{h:Number(e>>M2&al)|0,l:Number(e&al)|0}}function Hm(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:a}=T2(e[i],t);[r[i],n[i]]=[s,a]}return[r,n]}var jm=(e,t)=>BigInt(e>>>0)<<M2|BigInt(t>>>0);Me.toBig=jm;var km=(e,t,r)=>e>>>r;Me.shrSH=km;var Lm=(e,t,r)=>e<<32-r|t>>>r;Me.shrSL=Lm;var Km=(e,t,r)=>e>>>r|t<<32-r;Me.rotrSH=Km;var Vm=(e,t,r)=>e<<32-r|t>>>r;Me.rotrSL=Vm;var Um=(e,t,r)=>e<<64-r|t>>>r-32;Me.rotrBH=Um;var zm=(e,t,r)=>e>>>r-32|t<<64-r;Me.rotrBL=zm;var $m=(e,t)=>t;Me.rotr32H=$m;var Gm=(e,t)=>e;Me.rotr32L=Gm;var Wm=(e,t,r)=>e<<r|t>>>32-r;Me.rotlSH=Wm;var Xm=(e,t,r)=>t<<r|e>>>32-r;Me.rotlSL=Xm;var Ym=(e,t,r)=>t<<r-32|e>>>64-r;Me.rotlBH=Ym;var Zm=(e,t,r)=>e<<r-32|t>>>64-r;Me.rotlBL=Zm;function Jm(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var Qm=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);Me.add3L=Qm;var e3=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;Me.add3H=e3;var t3=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);Me.add4L=t3;var r3=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;Me.add4H=r3;var n3=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);Me.add5L=n3;var i3=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;Me.add5H=i3;var DP={fromBig:T2,split:Hm,toBig:jm,shrSH:km,shrSL:Lm,rotrSH:Km,rotrSL:Vm,rotrBH:Um,rotrBL:zm,rotr32H:$m,rotr32L:Gm,rotlSH:Wm,rotlSL:Xm,rotlBH:Ym,rotlBL:Zm,add:Jm,add3L:Qm,add3H:e3,add4L:t3,add4H:r3,add5H:i3,add5L:n3};Me.default=DP});var Ed=K(Kr=>{D();N();Object.defineProperty(Kr,"__esModule",{value:!0});Kr.sha384=Kr.sha512_256=Kr.sha512_224=Kr.sha512=Kr.SHA384=Kr.SHA512_256=Kr.SHA512_224=Kr.SHA512=void 0;var NP=sl(),it=lf(),ul=un(),[RP,FP]=(()=>it.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),ka=new Uint32Array(80),La=new Uint32Array(80),bc=class extends NP.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:u,El:b,Fh:h,Fl:d,Gh:l,Gl:y,Hh:p,Hl:m}=this;return[t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m]}set(t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=a|0,this.Dh=o|0,this.Dl=c|0,this.Eh=u|0,this.El=b|0,this.Fh=h|0,this.Fl=d|0,this.Gh=l|0,this.Gl=y|0,this.Hh=p|0,this.Hl=m|0}process(t,r){for(let T=0;T<16;T++,r+=4)ka[T]=t.getUint32(r),La[T]=t.getUint32(r+=4);for(let T=16;T<80;T++){let q=ka[T-15]|0,F=La[T-15]|0,j=it.default.rotrSH(q,F,1)^it.default.rotrSH(q,F,8)^it.default.shrSH(q,F,7),k=it.default.rotrSL(q,F,1)^it.default.rotrSL(q,F,8)^it.default.shrSL(q,F,7),I=ka[T-2]|0,R=La[T-2]|0,A=it.default.rotrSH(I,R,19)^it.default.rotrBH(I,R,61)^it.default.shrSH(I,R,6),f=it.default.rotrSL(I,R,19)^it.default.rotrBL(I,R,61)^it.default.shrSL(I,R,6),g=it.default.add4L(k,f,La[T-7],La[T-16]),E=it.default.add4H(g,j,A,ka[T-7],ka[T-16]);ka[T]=E|0,La[T]=g|0}let{Ah:n,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:u,Dl:b,Eh:h,El:d,Fh:l,Fl:y,Gh:p,Gl:m,Hh:w,Hl:C}=this;for(let T=0;T<80;T++){let q=it.default.rotrSH(h,d,14)^it.default.rotrSH(h,d,18)^it.default.rotrBH(h,d,41),F=it.default.rotrSL(h,d,14)^it.default.rotrSL(h,d,18)^it.default.rotrBL(h,d,41),j=h&l^~h&p,k=d&y^~d&m,I=it.default.add5L(C,F,k,FP[T],La[T]),R=it.default.add5H(I,w,q,j,RP[T],ka[T]),A=I|0,f=it.default.rotrSH(n,i,28)^it.default.rotrBH(n,i,34)^it.default.rotrBH(n,i,39),g=it.default.rotrSL(n,i,28)^it.default.rotrBL(n,i,34)^it.default.rotrBL(n,i,39),E=n&s^n&o^s&o,x=i&a^i&c^a&c;w=p|0,C=m|0,p=l|0,m=y|0,l=h|0,y=d|0,{h,l:d}=it.default.add(u|0,b|0,R|0,A|0),u=o|0,b=c|0,o=s|0,c=a|0,s=n|0,a=i|0;let S=it.default.add3L(A,g,x);n=it.default.add3H(S,R,f,E),i=S|0}({h:n,l:i}=it.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:a}=it.default.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:o,l:c}=it.default.add(this.Ch|0,this.Cl|0,o|0,c|0),{h:u,l:b}=it.default.add(this.Dh|0,this.Dl|0,u|0,b|0),{h,l:d}=it.default.add(this.Eh|0,this.El|0,h|0,d|0),{h:l,l:y}=it.default.add(this.Fh|0,this.Fl|0,l|0,y|0),{h:p,l:m}=it.default.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:w,l:C}=it.default.add(this.Hh|0,this.Hl|0,w|0,C|0),this.set(n,i,s,a,o,c,u,b,h,d,l,y,p,m,w,C)}roundClean(){ka.fill(0),La.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Kr.SHA512=bc;var ol=class extends bc{constructor(){super(28),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735}};Kr.SHA512_224=ol;var cl=class extends bc{constructor(){super(32),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414}};Kr.SHA512_256=cl;var fl=class extends bc{constructor(){super(48),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868}};Kr.SHA384=fl;Kr.sha512=(0,ul.wrapConstructor)(()=>new bc);Kr.sha512_224=(0,ul.wrapConstructor)(()=>new ol);Kr.sha512_256=(0,ul.wrapConstructor)(()=>new cl);Kr.sha384=(0,ul.wrapConstructor)(()=>new fl)});var N2=K(hf=>{D();N();Object.defineProperty(hf,"__esModule",{value:!0});hf.ripemd160=hf.RIPEMD160=void 0;var qP=sl(),Ad=un(),HP=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),a3=new Uint8Array(new Array(16).fill(0).map((e,t)=>t)),jP=a3.map(e=>(9*e+5)%16),O2=[a3],D2=[jP];for(let e=0;e<4;e++)for(let t of[O2,D2])t.push(t[e].map(r=>HP[r]));var o3=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),kP=O2.map((e,t)=>e.map(r=>o3[t][r])),LP=D2.map((e,t)=>e.map(r=>o3[t][r])),KP=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),VP=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function s3(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}var dl=new Uint32Array(16),ll=class extends qP.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:r,h2:n,h3:i,h4:s}=this;return[t,r,n,i,s]}set(t,r,n,i,s){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(t,r){for(let l=0;l<16;l++,r+=4)dl[l]=t.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,a=s,o=this.h2|0,c=o,u=this.h3|0,b=u,h=this.h4|0,d=h;for(let l=0;l<5;l++){let y=4-l,p=KP[l],m=VP[l],w=O2[l],C=D2[l],T=kP[l],q=LP[l];for(let F=0;F<16;F++){let j=(0,Ad.rotl)(n+s3(l,s,o,u)+dl[w[F]]+p,T[F])+h|0;n=h,h=u,u=(0,Ad.rotl)(o,10)|0,o=s,s=j}for(let F=0;F<16;F++){let j=(0,Ad.rotl)(i+s3(y,a,c,b)+dl[C[F]]+m,q[F])+d|0;i=d,d=b,b=(0,Ad.rotl)(c,10)|0,c=a,a=j}}this.set(this.h1+o+b|0,this.h2+u+d|0,this.h3+h+i|0,this.h4+n+a|0,this.h0+s+c|0)}roundClean(){dl.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};hf.RIPEMD160=ll;hf.ripemd160=(0,Ad.wrapConstructor)(()=>new ll)});var hl=K(Gt=>{D();N();Object.defineProperty(Gt,"__esModule",{value:!0});Gt.shake256=Gt.shake128=Gt.keccak_512=Gt.keccak_384=Gt.keccak_256=Gt.keccak_224=Gt.sha3_512=Gt.sha3_384=Gt.sha3_256=Gt.sha3_224=Gt.Keccak=void 0;Gt.keccakP=h3;var pf=ta(),Cd=lf(),na=un(),u3=[],d3=[],l3=[],UP=BigInt(0),Pd=BigInt(1),zP=BigInt(2),$P=BigInt(7),GP=BigInt(256),WP=BigInt(113);for(let e=0,t=Pd,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],u3.push(2*(5*n+r)),d3.push((e+1)*(e+2)/2%64);let i=UP;for(let s=0;s<7;s++)t=(t<<Pd^(t>>$P)*WP)%GP,t&zP&&(i^=Pd<<(Pd<<BigInt(s))-Pd);l3.push(i)}var[XP,YP]=(0,Cd.split)(l3,!0),c3=(e,t,r)=>r>32?(0,Cd.rotlBH)(e,t,r):(0,Cd.rotlSH)(e,t,r),f3=(e,t,r)=>r>32?(0,Cd.rotlBL)(e,t,r):(0,Cd.rotlSL)(e,t,r);function h3(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let a=0;a<10;a++)r[a]=e[a]^e[a+10]^e[a+20]^e[a+30]^e[a+40];for(let a=0;a<10;a+=2){let o=(a+8)%10,c=(a+2)%10,u=r[c],b=r[c+1],h=c3(u,b,1)^r[o],d=f3(u,b,1)^r[o+1];for(let l=0;l<50;l+=10)e[a+l]^=h,e[a+l+1]^=d}let i=e[2],s=e[3];for(let a=0;a<24;a++){let o=d3[a],c=c3(i,s,o),u=f3(i,s,o),b=u3[a];i=e[b],s=e[b+1],e[b]=c,e[b+1]=u}for(let a=0;a<50;a+=10){for(let o=0;o<10;o++)r[o]=e[a+o];for(let o=0;o<10;o++)e[a+o]^=~r[(o+2)%10]&r[(o+4)%10]}e[0]^=XP[n],e[1]^=YP[n]}r.fill(0)}var gc=class extends na.Hash{constructor(t,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,(0,pf.anumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,na.u32)(this.state)}keccak(){na.isLE||(0,na.byteSwap32)(this.state32),h3(this.state32,this.rounds),na.isLE||(0,na.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,pf.aexists)(this);let{blockLen:r,state:n}=this;t=(0,na.toBytes)(t);let i=t.length;for(let s=0;s<i;){let a=Math.min(r-this.pos,i-s);for(let o=0;o<a;o++)n[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){(0,pf.aexists)(this,!1),(0,pf.abytes)(t),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=n&&this.keccak();let a=Math.min(n-this.posOut,s-i);t.set(r.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,pf.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,pf.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:a}=this;return t||(t=new gc(r,n,i,a,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=n,t.outputLen=i,t.enableXOF=a,t.destroyed=this.destroyed,t}};Gt.Keccak=gc;var Ka=(e,t,r)=>(0,na.wrapConstructor)(()=>new gc(t,e,r));Gt.sha3_224=Ka(6,144,224/8);Gt.sha3_256=Ka(6,136,256/8);Gt.sha3_384=Ka(6,104,384/8);Gt.sha3_512=Ka(6,72,512/8);Gt.keccak_224=Ka(1,144,224/8);Gt.keccak_256=Ka(1,136,256/8);Gt.keccak_384=Ka(1,104,384/8);Gt.keccak_512=Ka(1,72,512/8);var p3=(e,t,r)=>(0,na.wrapXOFConstructorWithOpts)((n={})=>new gc(t,e,n.dkLen===void 0?r:n.dkLen,!0));Gt.shake128=p3(31,168,128/8);Gt.shake256=p3(31,136,256/8)});var pl=K(gf=>{D();N();Object.defineProperty(gf,"__esModule",{value:!0});gf.BLAKE=gf.SIGMA=void 0;var bf=ta(),dn=un();gf.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var R2=class extends dn.Hash{constructor(t,r,n={},i,s,a){if(super(),this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,bf.anumber)(t),(0,bf.anumber)(r),(0,bf.anumber)(i),r<0||r>i)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error("key length must be undefined or 1.."+i);if(n.salt!==void 0&&n.salt.length!==s)throw new Error("salt must be undefined or "+s);if(n.personalization!==void 0&&n.personalization.length!==a)throw new Error("personalization must be undefined or "+a);this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=(0,dn.u32)(this.buffer)}update(t){(0,bf.aexists)(this);let{blockLen:r,buffer:n,buffer32:i}=this;t=(0,dn.toBytes)(t);let s=t.length,a=t.byteOffset,o=t.buffer;for(let c=0;c<s;){this.pos===r&&(dn.isLE||(0,dn.byteSwap32)(i),this.compress(i,0,!1),dn.isLE||(0,dn.byteSwap32)(i),this.pos=0);let u=Math.min(r-this.pos,s-c),b=a+c;if(u===r&&!(b%4)&&c+u<s){let h=new Uint32Array(o,b,Math.floor((s-c)/4));dn.isLE||(0,dn.byteSwap32)(h);for(let d=0;c+r<s;d+=i.length,c+=r)this.length+=r,this.compress(h,d,!1);dn.isLE||(0,dn.byteSwap32)(h);continue}n.set(t.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(t){(0,bf.aexists)(this),(0,bf.aoutput)(t,this);let{pos:r,buffer32:n}=this;this.finished=!0,this.buffer.subarray(r).fill(0),dn.isLE||(0,dn.byteSwap32)(n),this.compress(n,0,!0),dn.isLE||(0,dn.byteSwap32)(n);let i=(0,dn.u32)(t);this.get().forEach((s,a)=>i[a]=(0,dn.byteSwapIfBE)(s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:a,pos:o}=this;return t||(t=new this.constructor({dkLen:a})),t.set(...this.get()),t.length=n,t.finished=i,t.destroyed=s,t.outputLen=a,t.buffer.set(r),t.pos=o,t}};gf.BLAKE=R2});var F2=K(vf=>{D();N();Object.defineProperty(vf,"__esModule",{value:!0});vf.blake2b=vf.BLAKE2b=void 0;var b3=pl(),zn=lf(),Jn=un(),Tr=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ae=new Uint32Array(32);function Va(e,t,r,n,i,s){let a=i[s],o=i[s+1],c=ae[2*e],u=ae[2*e+1],b=ae[2*t],h=ae[2*t+1],d=ae[2*r],l=ae[2*r+1],y=ae[2*n],p=ae[2*n+1],m=zn.default.add3L(c,b,a);u=zn.default.add3H(m,u,h,o),c=m|0,{Dh:p,Dl:y}={Dh:p^u,Dl:y^c},{Dh:p,Dl:y}={Dh:zn.default.rotr32H(p,y),Dl:zn.default.rotr32L(p,y)},{h:l,l:d}=zn.default.add(l,d,p,y),{Bh:h,Bl:b}={Bh:h^l,Bl:b^d},{Bh:h,Bl:b}={Bh:zn.default.rotrSH(h,b,24),Bl:zn.default.rotrSL(h,b,24)},ae[2*e]=c,ae[2*e+1]=u,ae[2*t]=b,ae[2*t+1]=h,ae[2*r]=d,ae[2*r+1]=l,ae[2*n]=y,ae[2*n+1]=p}function Ua(e,t,r,n,i,s){let a=i[s],o=i[s+1],c=ae[2*e],u=ae[2*e+1],b=ae[2*t],h=ae[2*t+1],d=ae[2*r],l=ae[2*r+1],y=ae[2*n],p=ae[2*n+1],m=zn.default.add3L(c,b,a);u=zn.default.add3H(m,u,h,o),c=m|0,{Dh:p,Dl:y}={Dh:p^u,Dl:y^c},{Dh:p,Dl:y}={Dh:zn.default.rotrSH(p,y,16),Dl:zn.default.rotrSL(p,y,16)},{h:l,l:d}=zn.default.add(l,d,p,y),{Bh:h,Bl:b}={Bh:h^l,Bl:b^d},{Bh:h,Bl:b}={Bh:zn.default.rotrBH(h,b,63),Bl:zn.default.rotrBL(h,b,63)},ae[2*e]=c,ae[2*e+1]=u,ae[2*t]=b,ae[2*t+1]=h,ae[2*r]=d,ae[2*r+1]=l,ae[2*n]=y,ae[2*n+1]=p}var bl=class extends b3.BLAKE{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=Tr[0]|0,this.v0h=Tr[1]|0,this.v1l=Tr[2]|0,this.v1h=Tr[3]|0,this.v2l=Tr[4]|0,this.v2h=Tr[5]|0,this.v3l=Tr[6]|0,this.v3h=Tr[7]|0,this.v4l=Tr[8]|0,this.v4h=Tr[9]|0,this.v5l=Tr[10]|0,this.v5h=Tr[11]|0,this.v6l=Tr[12]|0,this.v6h=Tr[13]|0,this.v7l=Tr[14]|0,this.v7h=Tr[15]|0;let r=t.key?t.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,Jn.u32)((0,Jn.toBytes)(t.salt));this.v4l^=(0,Jn.byteSwapIfBE)(n[0]),this.v4h^=(0,Jn.byteSwapIfBE)(n[1]),this.v5l^=(0,Jn.byteSwapIfBE)(n[2]),this.v5h^=(0,Jn.byteSwapIfBE)(n[3])}if(t.personalization){let n=(0,Jn.u32)((0,Jn.toBytes)(t.personalization));this.v6l^=(0,Jn.byteSwapIfBE)(n[0]),this.v6h^=(0,Jn.byteSwapIfBE)(n[1]),this.v7l^=(0,Jn.byteSwapIfBE)(n[2]),this.v7h^=(0,Jn.byteSwapIfBE)(n[3])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,Jn.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:i,v2l:s,v2h:a,v3l:o,v3h:c,v4l:u,v4h:b,v5l:h,v5h:d,v6l:l,v6h:y,v7l:p,v7h:m}=this;return[t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m]}set(t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=a|0,this.v3l=o|0,this.v3h=c|0,this.v4l=u|0,this.v4h=b|0,this.v5l=h|0,this.v5h=d|0,this.v6l=l|0,this.v6h=y|0,this.v7l=p|0,this.v7h=m|0}compress(t,r,n){this.get().forEach((c,u)=>ae[u]=c),ae.set(Tr,16);let{h:i,l:s}=zn.default.fromBig(BigInt(this.length));ae[24]=Tr[8]^s,ae[25]=Tr[9]^i,n&&(ae[28]=~ae[28],ae[29]=~ae[29]);let a=0,o=b3.SIGMA;for(let c=0;c<12;c++)Va(0,4,8,12,t,r+2*o[a++]),Ua(0,4,8,12,t,r+2*o[a++]),Va(1,5,9,13,t,r+2*o[a++]),Ua(1,5,9,13,t,r+2*o[a++]),Va(2,6,10,14,t,r+2*o[a++]),Ua(2,6,10,14,t,r+2*o[a++]),Va(3,7,11,15,t,r+2*o[a++]),Ua(3,7,11,15,t,r+2*o[a++]),Va(0,5,10,15,t,r+2*o[a++]),Ua(0,5,10,15,t,r+2*o[a++]),Va(1,6,11,12,t,r+2*o[a++]),Ua(1,6,11,12,t,r+2*o[a++]),Va(2,7,8,13,t,r+2*o[a++]),Ua(2,7,8,13,t,r+2*o[a++]),Va(3,4,9,14,t,r+2*o[a++]),Ua(3,4,9,14,t,r+2*o[a++]);this.v0l^=ae[0]^ae[16],this.v0h^=ae[1]^ae[17],this.v1l^=ae[2]^ae[18],this.v1h^=ae[3]^ae[19],this.v2l^=ae[4]^ae[20],this.v2h^=ae[5]^ae[21],this.v3l^=ae[6]^ae[22],this.v3h^=ae[7]^ae[23],this.v4l^=ae[8]^ae[24],this.v4h^=ae[9]^ae[25],this.v5l^=ae[10]^ae[26],this.v5h^=ae[11]^ae[27],this.v6l^=ae[12]^ae[28],this.v6h^=ae[13]^ae[29],this.v7l^=ae[14]^ae[30],this.v7h^=ae[15]^ae[31],ae.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};vf.BLAKE2b=bl;vf.blake2b=(0,Jn.wrapConstructorWithOpts)(e=>new bl(e))});var vl=K(Wt=>{D();N();Object.defineProperty(Wt,"__esModule",{value:!0});Wt.sha3_512=Wt.sha3_256=Wt.ripemd160=Wt.sha512=Wt.sha256=Wt.magicHash=Wt.blake2=Wt.keccak256=Wt.keccak=Wt.hash160=Wt.doubleSha256=void 0;var gl=df();Object.defineProperty(Wt,"sha256",{enumerable:!0,get:function(){return gl.sha256}});var ZP=Ed();Object.defineProperty(Wt,"sha512",{enumerable:!0,get:function(){return ZP.sha512}});var v3=N2();Object.defineProperty(Wt,"ripemd160",{enumerable:!0,get:function(){return v3.ripemd160}});var yf=hl();Object.defineProperty(Wt,"sha3_256",{enumerable:!0,get:function(){return yf.sha3_256}});Object.defineProperty(Wt,"sha3_512",{enumerable:!0,get:function(){return yf.sha3_512}});var JP=F2();function y3(e){let t=(0,gl.sha256)(e);return(0,gl.sha256)(t)}Wt.doubleSha256=y3;function QP(e){let t=(0,gl.sha256)(e);return(0,v3.ripemd160)(t)}Wt.hash160=QP;var eC=function(e,t=256){let r=H.Buffer.from(e);switch(t){case 224:return H.Buffer.from((0,yf.keccak_224)(r));case 256:return H.Buffer.from((0,yf.keccak_256)(r));case 384:return H.Buffer.from((0,yf.keccak_384)(r));case 512:return H.Buffer.from((0,yf.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${t}`)}};Wt.keccak=eC;var tC=function(e){return(0,Wt.keccak)(e)};Wt.keccak256=tC;function rC(e,t,r){let n=Math.ceil(t/8);return(0,JP.blake2b)(e,{dkLen:n,key:r})}Wt.blake2=rC;function g3(e){let t;return e<253?(t=H.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=H.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=H.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=H.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}var nC=H.Buffer.from(`Bitcoin Signed Message:
`);function iC(e,t){let r=t?H.Buffer.from(t,"utf8"):nC,n=g3(r.length),i=H.Buffer.from(e),s=g3(i.length),a=H.Buffer.concat([n,r,s,i]);return y3(a)}Wt.magicHash=iC});var Bd=K(vc=>{D();N();Object.defineProperty(vc,"__esModule",{value:!0});vc.hmac=vc.HMAC=void 0;var yl=ta(),m3=un(),Id=class extends m3.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,yl.ahash)(t);let n=(0,m3.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,yl.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,yl.aexists)(this),(0,yl.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=a,t.outputLen=o,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};vc.HMAC=Id;var sC=(e,t,r)=>new Id(e,t).update(r).digest();vc.hmac=sC;vc.hmac.create=(e,t)=>new Id(e,t)});var S3=K(mf=>{D();N();Object.defineProperty(mf,"__esModule",{value:!0});mf.hmacSHA512=mf.hmacSHA256=void 0;var w3=Bd(),_3=vl();function aC(e,t){return H.Buffer.from((0,w3.hmac)(_3.sha256,e,t))}mf.hmacSHA256=aC;function oC(e,t){return H.Buffer.from((0,w3.hmac)(_3.sha512,e,t))}mf.hmacSHA512=oC});var q2=K(Ot=>{D();N();Object.defineProperty(Ot,"__esModule",{value:!0});Ot.blake2s=Ot.BLAKE2s=Ot.B2S_IV=void 0;Ot.G1s=ia;Ot.G2s=sa;Ot.compress=E3;var x3=pl(),cC=lf(),Qn=un();Ot.B2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function ia(e,t,r,n,i){return e=e+t+i|0,n=(0,Qn.rotr)(n^e,16),r=r+n|0,t=(0,Qn.rotr)(t^r,12),{a:e,b:t,c:r,d:n}}function sa(e,t,r,n,i){return e=e+t+i|0,n=(0,Qn.rotr)(n^e,8),r=r+n|0,t=(0,Qn.rotr)(t^r,7),{a:e,b:t,c:r,d:n}}function E3(e,t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m,w,C,T){let q=0;for(let F=0;F<n;F++)({a:i,b:c,c:d,d:m}=ia(i,c,d,m,r[t+e[q++]])),{a:i,b:c,c:d,d:m}=sa(i,c,d,m,r[t+e[q++]]),{a:s,b:u,c:l,d:w}=ia(s,u,l,w,r[t+e[q++]]),{a:s,b:u,c:l,d:w}=sa(s,u,l,w,r[t+e[q++]]),{a,b,c:y,d:C}=ia(a,b,y,C,r[t+e[q++]]),{a,b,c:y,d:C}=sa(a,b,y,C,r[t+e[q++]]),{a:o,b:h,c:p,d:T}=ia(o,h,p,T,r[t+e[q++]]),{a:o,b:h,c:p,d:T}=sa(o,h,p,T,r[t+e[q++]]),{a:i,b:u,c:y,d:T}=ia(i,u,y,T,r[t+e[q++]]),{a:i,b:u,c:y,d:T}=sa(i,u,y,T,r[t+e[q++]]),{a:s,b,c:p,d:m}=ia(s,b,p,m,r[t+e[q++]]),{a:s,b,c:p,d:m}=sa(s,b,p,m,r[t+e[q++]]),{a,b:h,c:d,d:w}=ia(a,h,d,w,r[t+e[q++]]),{a,b:h,c:d,d:w}=sa(a,h,d,w,r[t+e[q++]]),{a:o,b:c,c:l,d:C}=ia(o,c,l,C,r[t+e[q++]]),{a:o,b:c,c:l,d:C}=sa(o,c,l,C,r[t+e[q++]]);return{v0:i,v1:s,v2:a,v3:o,v4:c,v5:u,v6:b,v7:h,v8:d,v9:l,v10:y,v11:p,v12:m,v13:w,v14:C,v15:T}}var ml=class extends x3.BLAKE{constructor(t={}){super(64,t.dkLen===void 0?32:t.dkLen,t,32,8,8),this.v0=Ot.B2S_IV[0]|0,this.v1=Ot.B2S_IV[1]|0,this.v2=Ot.B2S_IV[2]|0,this.v3=Ot.B2S_IV[3]|0,this.v4=Ot.B2S_IV[4]|0,this.v5=Ot.B2S_IV[5]|0,this.v6=Ot.B2S_IV[6]|0,this.v7=Ot.B2S_IV[7]|0;let r=t.key?t.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,Qn.u32)((0,Qn.toBytes)(t.salt));this.v4^=(0,Qn.byteSwapIfBE)(n[0]),this.v5^=(0,Qn.byteSwapIfBE)(n[1])}if(t.personalization){let n=(0,Qn.u32)((0,Qn.toBytes)(t.personalization));this.v6^=(0,Qn.byteSwapIfBE)(n[0]),this.v7^=(0,Qn.byteSwapIfBE)(n[1])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,Qn.toBytes)(t.key)),this.update(n)}}get(){let{v0:t,v1:r,v2:n,v3:i,v4:s,v5:a,v6:o,v7:c}=this;return[t,r,n,i,s,a,o,c]}set(t,r,n,i,s,a,o,c){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=a|0,this.v6=o|0,this.v7=c|0}compress(t,r,n){let{h:i,l:s}=(0,cC.fromBig)(BigInt(this.length)),{v0:a,v1:o,v2:c,v3:u,v4:b,v5:h,v6:d,v7:l,v8:y,v9:p,v10:m,v11:w,v12:C,v13:T,v14:q,v15:F}=E3(x3.SIGMA,r,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,Ot.B2S_IV[0],Ot.B2S_IV[1],Ot.B2S_IV[2],Ot.B2S_IV[3],s^Ot.B2S_IV[4],i^Ot.B2S_IV[5],n?~Ot.B2S_IV[6]:Ot.B2S_IV[6],Ot.B2S_IV[7]);this.v0^=a^y,this.v1^=o^p,this.v2^=c^m,this.v3^=u^w,this.v4^=b^C,this.v5^=h^T,this.v6^=d^q,this.v7^=l^F}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};Ot.BLAKE2s=ml;Ot.blake2s=(0,Qn.wrapConstructorWithOpts)(e=>new ml(e))});var Sl=K(_l=>{D();N();Object.defineProperty(_l,"__esModule",{value:!0});_l.pbkdf2=uC;_l.pbkdf2Async=dC;var wl=ta(),fC=Bd(),wf=un();function A3(e,t,r,n){(0,wl.ahash)(e);let i=(0,wf.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:a,asyncTick:o}=i;if((0,wl.anumber)(s),(0,wl.anumber)(a),(0,wl.anumber)(o),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let c=(0,wf.toBytes)(t),u=(0,wf.toBytes)(r),b=new Uint8Array(a),h=fC.hmac.create(e,c),d=h._cloneInto().update(u);return{c:s,dkLen:a,asyncTick:o,DK:b,PRF:h,PRFSalt:d}}function P3(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}function uC(e,t,r,n){let{c:i,dkLen:s,DK:a,PRF:o,PRFSalt:c}=A3(e,t,r,n),u,b=new Uint8Array(4),h=(0,wf.createView)(b),d=new Uint8Array(o.outputLen);for(let l=1,y=0;y<s;l++,y+=o.outputLen){let p=a.subarray(y,y+o.outputLen);h.setInt32(0,l,!1),(u=c._cloneInto(u)).update(b).digestInto(d),p.set(d.subarray(0,p.length));for(let m=1;m<i;m++){o._cloneInto(u).update(d).digestInto(d);for(let w=0;w<p.length;w++)p[w]^=d[w]}}return P3(o,c,a,u,d)}async function dC(e,t,r,n){let{c:i,dkLen:s,asyncTick:a,DK:o,PRF:c,PRFSalt:u}=A3(e,t,r,n),b,h=new Uint8Array(4),d=(0,wf.createView)(h),l=new Uint8Array(c.outputLen);for(let y=1,p=0;p<s;y++,p+=c.outputLen){let m=o.subarray(p,p+c.outputLen);d.setInt32(0,y,!1),(b=u._cloneInto(b)).update(h).digestInto(l),m.set(l.subarray(0,m.length)),await(0,wf.asyncLoop)(i-1,a,()=>{c._cloneInto(b).update(l).digestInto(l);for(let w=0;w<m.length;w++)m[w]^=l[w]})}return P3(c,u,o,b,l)}});var O3=K(xl=>{D();N();Object.defineProperty(xl,"__esModule",{value:!0});xl.scrypt=lC;xl.scryptAsync=hC;var _f=ta(),I3=Sl(),B3=df(),Ce=un();function C3(e,t,r,n,i,s){let a=e[t++]^r[n++],o=e[t++]^r[n++],c=e[t++]^r[n++],u=e[t++]^r[n++],b=e[t++]^r[n++],h=e[t++]^r[n++],d=e[t++]^r[n++],l=e[t++]^r[n++],y=e[t++]^r[n++],p=e[t++]^r[n++],m=e[t++]^r[n++],w=e[t++]^r[n++],C=e[t++]^r[n++],T=e[t++]^r[n++],q=e[t++]^r[n++],F=e[t++]^r[n++],j=a,k=o,I=c,R=u,A=b,f=h,g=d,E=l,x=y,S=p,P=m,O=w,B=C,v=T,M=q,V=F;for(let z=0;z<8;z+=2)A^=(0,Ce.rotl)(j+B|0,7),x^=(0,Ce.rotl)(A+j|0,9),B^=(0,Ce.rotl)(x+A|0,13),j^=(0,Ce.rotl)(B+x|0,18),S^=(0,Ce.rotl)(f+k|0,7),v^=(0,Ce.rotl)(S+f|0,9),k^=(0,Ce.rotl)(v+S|0,13),f^=(0,Ce.rotl)(k+v|0,18),M^=(0,Ce.rotl)(P+g|0,7),I^=(0,Ce.rotl)(M+P|0,9),g^=(0,Ce.rotl)(I+M|0,13),P^=(0,Ce.rotl)(g+I|0,18),R^=(0,Ce.rotl)(V+O|0,7),E^=(0,Ce.rotl)(R+V|0,9),O^=(0,Ce.rotl)(E+R|0,13),V^=(0,Ce.rotl)(O+E|0,18),k^=(0,Ce.rotl)(j+R|0,7),I^=(0,Ce.rotl)(k+j|0,9),R^=(0,Ce.rotl)(I+k|0,13),j^=(0,Ce.rotl)(R+I|0,18),g^=(0,Ce.rotl)(f+A|0,7),E^=(0,Ce.rotl)(g+f|0,9),A^=(0,Ce.rotl)(E+g|0,13),f^=(0,Ce.rotl)(A+E|0,18),O^=(0,Ce.rotl)(P+S|0,7),x^=(0,Ce.rotl)(O+P|0,9),S^=(0,Ce.rotl)(x+O|0,13),P^=(0,Ce.rotl)(S+x|0,18),B^=(0,Ce.rotl)(V+M|0,7),v^=(0,Ce.rotl)(B+V|0,9),M^=(0,Ce.rotl)(v+B|0,13),V^=(0,Ce.rotl)(M+v|0,18);i[s++]=a+j|0,i[s++]=o+k|0,i[s++]=c+I|0,i[s++]=u+R|0,i[s++]=b+A|0,i[s++]=h+f|0,i[s++]=d+g|0,i[s++]=l+E|0,i[s++]=y+x|0,i[s++]=p+S|0,i[s++]=m+P|0,i[s++]=w+O|0,i[s++]=C+B|0,i[s++]=T+v|0,i[s++]=q+M|0,i[s++]=F+V|0}function Sf(e,t,r,n,i){let s=n+0,a=n+16*i;for(let o=0;o<16;o++)r[a+o]=e[t+(2*i-1)*16+o];for(let o=0;o<i;o++,s+=16,t+=16)C3(r,a,e,t,r,s),o>0&&(a+=16),C3(r,s,e,t+=16,r,a)}function M3(e,t,r){let n=(0,Ce.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:a,dkLen:o,asyncTick:c,maxmem:u,onProgress:b}=n;if((0,_f.anumber)(i),(0,_f.anumber)(s),(0,_f.anumber)(a),(0,_f.anumber)(o),(0,_f.anumber)(c),(0,_f.anumber)(u),b!==void 0&&typeof b!="function")throw new Error("progressCb should be function");let h=128*s,d=h/4;if(i<=1||(i&i-1)!==0||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(a<0||a>(2**32-1)*32/h)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(o<0||o>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(h*(i+a)>u)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+u);let y=(0,I3.pbkdf2)(B3.sha256,e,t,{c:1,dkLen:h*a}),p=(0,Ce.u32)(y),m=(0,Ce.u32)(new Uint8Array(h*i)),w=(0,Ce.u32)(new Uint8Array(h)),C=()=>{};if(b){let T=2*i*a,q=Math.max(Math.floor(T/1e4),1),F=0;C=()=>{F++,b&&(!(F%q)||F===T)&&b(F/T)}}return{N:i,r:s,p:a,dkLen:o,blockSize32:d,V:m,B32:p,B:y,tmp:w,blockMixCb:C,asyncTick:c}}function T3(e,t,r,n,i){let s=(0,I3.pbkdf2)(B3.sha256,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),i.fill(0),s}function lC(e,t,r){let{N:n,r:i,p:s,dkLen:a,blockSize32:o,V:c,B32:u,B:b,tmp:h,blockMixCb:d}=M3(e,t,r);Ce.isLE||(0,Ce.byteSwap32)(u);for(let l=0;l<s;l++){let y=o*l;for(let p=0;p<o;p++)c[p]=u[y+p];for(let p=0,m=0;p<n-1;p++)Sf(c,m,c,m+=o,i),d();Sf(c,(n-1)*o,u,y,i),d();for(let p=0;p<n;p++){let m=u[y+o-16]%n;for(let w=0;w<o;w++)h[w]=u[y+w]^c[m*o+w];Sf(h,0,u,y,i),d()}}return Ce.isLE||(0,Ce.byteSwap32)(u),T3(e,a,b,c,h)}async function hC(e,t,r){let{N:n,r:i,p:s,dkLen:a,blockSize32:o,V:c,B32:u,B:b,tmp:h,blockMixCb:d,asyncTick:l}=M3(e,t,r);Ce.isLE||(0,Ce.byteSwap32)(u);for(let y=0;y<s;y++){let p=o*y;for(let w=0;w<o;w++)c[w]=u[p+w];let m=0;await(0,Ce.asyncLoop)(n-1,l,()=>{Sf(c,m,c,m+=o,i),d()}),Sf(c,(n-1)*o,u,p,i),d(),await(0,Ce.asyncLoop)(n,l,()=>{let w=u[p+o-16]%n;for(let C=0;C<o;C++)h[C]=u[p+C]^c[w*o+C];Sf(h,0,u,p,i),d()})}return Ce.isLE||(0,Ce.byteSwap32)(u),T3(e,a,b,c,h)}});var R3=K(Ef=>{D();N();Object.defineProperty(Ef,"__esModule",{value:!0});Ef.blake3=Ef.BLAKE3=void 0;var Md=ta(),pC=pl(),D3=lf(),ns=q2(),Vr=un(),Ss={CHUNK_START:1<<0,CHUNK_END:1<<1,PARENT:1<<2,ROOT:1<<3,KEYED_HASH:1<<4,DERIVE_KEY_CONTEXT:1<<5,DERIVE_KEY_MATERIAL:1<<6},N3=(()=>{let e=Array.from({length:16},(n,i)=>i),t=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=e;n<7;n++,i=t(i))r.push(...i);return Uint8Array.from(r)})(),xf=class extends pC.BLAKE{constructor(t={},r=0){let n=t.dkLen===void 0?32:t.dkLen;if(super(64,n,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,(0,Md.anumber)(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){let i=(0,Vr.toBytes)(t.key).slice();if(i.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,Vr.u32)(i),Vr.isLE||(0,Vr.byteSwap32)(this.IV),this.flags=r|Ss.KEYED_HASH}else if(t.context!==void 0){let i=new xf({dkLen:32},Ss.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=(0,Vr.u32)(i),Vr.isLE||(0,Vr.byteSwap32)(this.IV),this.flags=r|Ss.DERIVE_KEY_MATERIAL}else this.IV=ns.B2S_IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,Vr.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,r,n,i=0){let{state:s,pos:a}=this,{h:o,l:c}=(0,D3.fromBig)(BigInt(t),!0),{v0:u,v1:b,v2:h,v3:d,v4:l,v5:y,v6:p,v7:m,v8:w,v9:C,v10:T,v11:q,v12:F,v13:j,v14:k,v15:I}=(0,ns.compress)(N3,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],ns.B2S_IV[0],ns.B2S_IV[1],ns.B2S_IV[2],ns.B2S_IV[3],o,c,a,r);s[0]=u^w,s[1]=b^C,s[2]=h^T,s[3]=d^q,s[4]=l^F,s[5]=y^j,s[6]=p^k,s[7]=m^I}compress(t,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=Ss.CHUNK_START),(this.chunkPos===15||n)&&(i|=Ss.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,t,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let a,o=this.chunksDone+1;(n||!(o&1))&&(a=this.stack.pop());o>>=1)this.buffer32.set(a,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|Ss.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:r,flags:n,state:i,chunkPos:s,posOut:a,chunkOut:o,stack:c,chunksDone:u}=this;return t.state.set(i.slice()),t.stack=c.map(b=>Uint32Array.from(b)),t.IV.set(r),t.flags=n,t.chunkPos=s,t.chunksDone=u,t.posOut=a,t.chunkOut=o,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){let{state:t,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:a,l:o}=(0,D3.fromBig)(BigInt(this.chunkOut++));Vr.isLE||(0,Vr.byteSwap32)(i);let{v0:c,v1:u,v2:b,v3:h,v4:d,v5:l,v6:y,v7:p,v8:m,v9:w,v10:C,v11:T,v12:q,v13:F,v14:j,v15:k}=(0,ns.compress)(N3,0,i,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],ns.B2S_IV[0],ns.B2S_IV[1],ns.B2S_IV[2],ns.B2S_IV[3],o,a,r,n);s[0]=c^m,s[1]=u^w,s[2]=b^C,s[3]=h^T,s[4]=d^q,s[5]=l^F,s[6]=y^j,s[7]=p^k,s[8]=t[0]^m,s[9]=t[1]^w,s[10]=t[2]^C,s[11]=t[3]^T,s[12]=t[4]^q,s[13]=t[5]^F,s[14]=t[6]^j,s[15]=t[7]^k,Vr.isLE||((0,Vr.byteSwap32)(i),(0,Vr.byteSwap32)(s)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|Ss.ROOT;this.stack.length?(t|=Ss.PARENT,Vr.isLE||(0,Vr.byteSwap32)(this.buffer32),this.compress(this.buffer32,0,!0),Vr.isLE||(0,Vr.byteSwap32)(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:Ss.CHUNK_START)|Ss.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){(0,Md.aexists)(this,!1),(0,Md.abytes)(t),this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.b2CompressOut();let a=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return(0,Md.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,Md.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};Ef.BLAKE3=xf;Ef.blake3=(0,Vr.wrapXOFConstructorWithOpts)(e=>new xf(e))});var Td=K(St=>{D();N();var F3=St&&St.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),bC=St&&St.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$n=St&&St.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&F3(t,e,r)},gC=St&&St.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&F3(t,e,r);return bC(t,e),t};Object.defineProperty(St,"__esModule",{value:!0});St.randomBytes=St.concatBytes=St.reverseBuffer=void 0;$n(Bm(),St);$n(Tm(),St);$n(vl(),St);$n(S3(),St);$n(lc(),St);$n(df(),St);$n(Bd(),St);$n(N2(),St);$n(Ed(),St);$n(hl(),St);$n(F2(),St);$n(q2(),St);$n(Sl(),St);$n(O3(),St);$n(R3(),St);var vC=gC(un()),yC=_m();function mC(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}St.reverseBuffer=mC;function wC(e,t){return vC.concatBytes(Uint8Array.from(e),Uint8Array.from(t))}St.concatBytes=wC;function _C(e){return yC(e)}St.randomBytes=_C});var ei=K((q3,H2)=>{D();N();(function(e,t){"use strict";function r(A,f){if(!A)throw new Error(f||"Assertion failed")}function n(A,f){A.super_=f;var g=function(){};g.prototype=f.prototype,A.prototype=new g,A.prototype.constructor=A}function i(A,f,g){if(i.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((f==="le"||f==="be")&&(g=f,f=10),this._init(A||0,f||10,g||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=ym().Buffer}catch{}i.isBN=function(f){return f instanceof i?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===i.wordSize&&Array.isArray(f.words)},i.max=function(f,g){return f.cmp(g)>0?f:g},i.min=function(f,g){return f.cmp(g)<0?f:g},i.prototype._init=function(f,g,E){if(typeof f=="number")return this._initNumber(f,g,E);if(typeof f=="object")return this._initArray(f,g,E);g==="hex"&&(g=16),r(g===(g|0)&&g>=2&&g<=36),f=f.toString().replace(/\s+/g,"");var x=0;f[0]==="-"&&(x++,this.negative=1),x<f.length&&(g===16?this._parseHex(f,x,E):(this._parseBase(f,g,x),E==="le"&&this._initArray(this.toArray(),g,E)))},i.prototype._initNumber=function(f,g,E){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(r(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),E==="le"&&this._initArray(this.toArray(),g,E)},i.prototype._initArray=function(f,g,E){if(r(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var S,P,O=0;if(E==="be")for(x=f.length-1,S=0;x>=0;x-=3)P=f[x]|f[x-1]<<8|f[x-2]<<16,this.words[S]|=P<<O&67108863,this.words[S+1]=P>>>26-O&67108863,O+=24,O>=26&&(O-=26,S++);else if(E==="le")for(x=0,S=0;x<f.length;x+=3)P=f[x]|f[x+1]<<8|f[x+2]<<16,this.words[S]|=P<<O&67108863,this.words[S+1]=P>>>26-O&67108863,O+=24,O>=26&&(O-=26,S++);return this.strip()};function a(A,f){var g=A.charCodeAt(f);return g>=65&&g<=70?g-55:g>=97&&g<=102?g-87:g-48&15}function o(A,f,g){var E=a(A,g);return g-1>=f&&(E|=a(A,g-1)<<4),E}i.prototype._parseHex=function(f,g,E){this.length=Math.ceil((f.length-g)/6),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var S=0,P=0,O;if(E==="be")for(x=f.length-1;x>=g;x-=2)O=o(f,g,x)<<S,this.words[P]|=O&67108863,S>=18?(S-=18,P+=1,this.words[P]|=O>>>26):S+=8;else{var B=f.length-g;for(x=B%2===0?g+1:g;x<f.length;x+=2)O=o(f,g,x)<<S,this.words[P]|=O&67108863,S>=18?(S-=18,P+=1,this.words[P]|=O>>>26):S+=8}this.strip()};function c(A,f,g,E){for(var x=0,S=Math.min(A.length,g),P=f;P<S;P++){var O=A.charCodeAt(P)-48;x*=E,O>=49?x+=O-49+10:O>=17?x+=O-17+10:x+=O}return x}i.prototype._parseBase=function(f,g,E){this.words=[0],this.length=1;for(var x=0,S=1;S<=67108863;S*=g)x++;x--,S=S/g|0;for(var P=f.length-E,O=P%x,B=Math.min(P,P-O)+E,v=0,M=E;M<B;M+=x)v=c(f,M,M+x,g),this.imuln(S),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v);if(O!==0){var V=1;for(v=c(f,M,f.length,g),M=0;M<O;M++)V*=g;this.imuln(V),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v)}this.strip()},i.prototype.copy=function(f){f.words=new Array(this.length);for(var g=0;g<this.length;g++)f.words[g]=this.words[g];f.length=this.length,f.negative=this.negative,f.red=this.red},i.prototype.clone=function(){var f=new i(null);return this.copy(f),f},i.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(f,g){f=f||10,g=g|0||1;var E;if(f===16||f==="hex"){E="";for(var x=0,S=0,P=0;P<this.length;P++){var O=this.words[P],B=((O<<x|S)&16777215).toString(16);S=O>>>24-x&16777215,S!==0||P!==this.length-1?E=u[6-B.length]+B+E:E=B+E,x+=2,x>=26&&(x-=26,P--)}for(S!==0&&(E=S.toString(16)+E);E.length%g!==0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}if(f===(f|0)&&f>=2&&f<=36){var v=b[f],M=h[f];E="";var V=this.clone();for(V.negative=0;!V.isZero();){var z=V.modn(M).toString(f);V=V.idivn(M),V.isZero()?E=z+E:E=u[v-z.length]+z+E}for(this.isZero()&&(E="0"+E);E.length%g!==0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(f,g){return r(typeof s<"u"),this.toArrayLike(s,f,g)},i.prototype.toArray=function(f,g){return this.toArrayLike(Array,f,g)},i.prototype.toArrayLike=function(f,g,E){var x=this.byteLength(),S=E||Math.max(1,x);r(x<=S,"byte array longer than desired length"),r(S>0,"Requested array length <= 0"),this.strip();var P=g==="le",O=new f(S),B,v,M=this.clone();if(P){for(v=0;!M.isZero();v++)B=M.andln(255),M.iushrn(8),O[v]=B;for(;v<S;v++)O[v]=0}else{for(v=0;v<S-x;v++)O[v]=0;for(v=0;!M.isZero();v++)B=M.andln(255),M.iushrn(8),O[S-v-1]=B}return O},Math.clz32?i.prototype._countBits=function(f){return 32-Math.clz32(f)}:i.prototype._countBits=function(f){var g=f,E=0;return g>=4096&&(E+=13,g>>>=13),g>=64&&(E+=7,g>>>=7),g>=8&&(E+=4,g>>>=4),g>=2&&(E+=2,g>>>=2),E+g},i.prototype._zeroBits=function(f){if(f===0)return 26;var g=f,E=0;return(g&8191)===0&&(E+=13,g>>>=13),(g&127)===0&&(E+=7,g>>>=7),(g&15)===0&&(E+=4,g>>>=4),(g&3)===0&&(E+=2,g>>>=2),(g&1)===0&&E++,E},i.prototype.bitLength=function(){var f=this.words[this.length-1],g=this._countBits(f);return(this.length-1)*26+g};function d(A){for(var f=new Array(A.bitLength()),g=0;g<f.length;g++){var E=g/26|0,x=g%26;f[g]=(A.words[E]&1<<x)>>>x}return f}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,g=0;g<this.length;g++){var E=this._zeroBits(this.words[g]);if(f+=E,E!==26)break}return f},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},i.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var g=0;g<f.length;g++)this.words[g]=this.words[g]|f.words[g];return this.strip()},i.prototype.ior=function(f){return r((this.negative|f.negative)===0),this.iuor(f)},i.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},i.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},i.prototype.iuand=function(f){var g;this.length>f.length?g=f:g=this;for(var E=0;E<g.length;E++)this.words[E]=this.words[E]&f.words[E];return this.length=g.length,this.strip()},i.prototype.iand=function(f){return r((this.negative|f.negative)===0),this.iuand(f)},i.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},i.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},i.prototype.iuxor=function(f){var g,E;this.length>f.length?(g=this,E=f):(g=f,E=this);for(var x=0;x<E.length;x++)this.words[x]=g.words[x]^E.words[x];if(this!==g)for(;x<g.length;x++)this.words[x]=g.words[x];return this.length=g.length,this.strip()},i.prototype.ixor=function(f){return r((this.negative|f.negative)===0),this.iuxor(f)},i.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},i.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},i.prototype.inotn=function(f){r(typeof f=="number"&&f>=0);var g=Math.ceil(f/26)|0,E=f%26;this._expand(g),E>0&&g--;for(var x=0;x<g;x++)this.words[x]=~this.words[x]&67108863;return E>0&&(this.words[x]=~this.words[x]&67108863>>26-E),this.strip()},i.prototype.notn=function(f){return this.clone().inotn(f)},i.prototype.setn=function(f,g){r(typeof f=="number"&&f>=0);var E=f/26|0,x=f%26;return this._expand(E+1),g?this.words[E]=this.words[E]|1<<x:this.words[E]=this.words[E]&~(1<<x),this.strip()},i.prototype.iadd=function(f){var g;if(this.negative!==0&&f.negative===0)return this.negative=0,g=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,g=this.isub(f),f.negative=1,g._normSign();var E,x;this.length>f.length?(E=this,x=f):(E=f,x=this);for(var S=0,P=0;P<x.length;P++)g=(E.words[P]|0)+(x.words[P]|0)+S,this.words[P]=g&67108863,S=g>>>26;for(;S!==0&&P<E.length;P++)g=(E.words[P]|0)+S,this.words[P]=g&67108863,S=g>>>26;if(this.length=E.length,S!==0)this.words[this.length]=S,this.length++;else if(E!==this)for(;P<E.length;P++)this.words[P]=E.words[P];return this},i.prototype.add=function(f){var g;return f.negative!==0&&this.negative===0?(f.negative=0,g=this.sub(f),f.negative^=1,g):f.negative===0&&this.negative!==0?(this.negative=0,g=f.sub(this),this.negative=1,g):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},i.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var g=this.iadd(f);return f.negative=1,g._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var E=this.cmp(f);if(E===0)return this.negative=0,this.length=1,this.words[0]=0,this;var x,S;E>0?(x=this,S=f):(x=f,S=this);for(var P=0,O=0;O<S.length;O++)g=(x.words[O]|0)-(S.words[O]|0)+P,P=g>>26,this.words[O]=g&67108863;for(;P!==0&&O<x.length;O++)g=(x.words[O]|0)+P,P=g>>26,this.words[O]=g&67108863;if(P===0&&O<x.length&&x!==this)for(;O<x.length;O++)this.words[O]=x.words[O];return this.length=Math.max(this.length,O),x!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(f){return this.clone().isub(f)};function l(A,f,g){g.negative=f.negative^A.negative;var E=A.length+f.length|0;g.length=E,E=E-1|0;var x=A.words[0]|0,S=f.words[0]|0,P=x*S,O=P&67108863,B=P/67108864|0;g.words[0]=O;for(var v=1;v<E;v++){for(var M=B>>>26,V=B&67108863,z=Math.min(v,f.length-1),$=Math.max(0,v-A.length+1);$<=z;$++){var G=v-$|0;x=A.words[G]|0,S=f.words[$]|0,P=x*S+V,M+=P/67108864|0,V=P&67108863}g.words[v]=V|0,B=M|0}return B!==0?g.words[v]=B|0:g.length--,g.strip()}var y=function(f,g,E){var x=f.words,S=g.words,P=E.words,O=0,B,v,M,V=x[0]|0,z=V&8191,$=V>>>13,G=x[1]|0,Q=G&8191,re=G>>>13,me=x[2]|0,ne=me&8191,te=me>>>13,_e=x[3]|0,ce=_e&8191,J=_e>>>13,De=x[4]|0,fe=De&8191,ie=De>>>13,qt=x[5]|0,Ae=qt&8191,Se=qt>>>13,zo=x[6]|0,we=zo&8191,Ee=zo>>>13,$o=x[7]|0,Be=$o&8191,ue=$o>>>13,En=x[8]|0,se=En&8191,xe=En>>>13,dd=x[9]|0,Ne=dd&8191,Re=dd>>>13,ld=S[0]|0,Fe=ld&8191,qe=ld>>>13,hd=S[1]|0,He=hd&8191,je=hd>>>13,pd=S[2]|0,ke=pd&8191,Le=pd>>>13,bd=S[3]|0,Ke=bd&8191,Ve=bd>>>13,gd=S[4]|0,Ue=gd&8191,ze=gd>>>13,vd=S[5]|0,$e=vd&8191,Ge=vd>>>13,yd=S[6]|0,We=yd&8191,Xe=yd>>>13,md=S[7]|0,Ye=md&8191,Ze=md>>>13,wd=S[8]|0,Je=wd&8191,Qe=wd>>>13,_d=S[9]|0,et=_d&8191,tt=_d>>>13;E.negative=f.negative^g.negative,E.length=19,B=Math.imul(z,Fe),v=Math.imul(z,qe),v=v+Math.imul($,Fe)|0,M=Math.imul($,qe);var Go=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Go>>>26)|0,Go&=67108863,B=Math.imul(Q,Fe),v=Math.imul(Q,qe),v=v+Math.imul(re,Fe)|0,M=Math.imul(re,qe),B=B+Math.imul(z,He)|0,v=v+Math.imul(z,je)|0,v=v+Math.imul($,He)|0,M=M+Math.imul($,je)|0;var Wo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Wo>>>26)|0,Wo&=67108863,B=Math.imul(ne,Fe),v=Math.imul(ne,qe),v=v+Math.imul(te,Fe)|0,M=Math.imul(te,qe),B=B+Math.imul(Q,He)|0,v=v+Math.imul(Q,je)|0,v=v+Math.imul(re,He)|0,M=M+Math.imul(re,je)|0,B=B+Math.imul(z,ke)|0,v=v+Math.imul(z,Le)|0,v=v+Math.imul($,ke)|0,M=M+Math.imul($,Le)|0;var Xo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Xo>>>26)|0,Xo&=67108863,B=Math.imul(ce,Fe),v=Math.imul(ce,qe),v=v+Math.imul(J,Fe)|0,M=Math.imul(J,qe),B=B+Math.imul(ne,He)|0,v=v+Math.imul(ne,je)|0,v=v+Math.imul(te,He)|0,M=M+Math.imul(te,je)|0,B=B+Math.imul(Q,ke)|0,v=v+Math.imul(Q,Le)|0,v=v+Math.imul(re,ke)|0,M=M+Math.imul(re,Le)|0,B=B+Math.imul(z,Ke)|0,v=v+Math.imul(z,Ve)|0,v=v+Math.imul($,Ke)|0,M=M+Math.imul($,Ve)|0;var Yo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Yo>>>26)|0,Yo&=67108863,B=Math.imul(fe,Fe),v=Math.imul(fe,qe),v=v+Math.imul(ie,Fe)|0,M=Math.imul(ie,qe),B=B+Math.imul(ce,He)|0,v=v+Math.imul(ce,je)|0,v=v+Math.imul(J,He)|0,M=M+Math.imul(J,je)|0,B=B+Math.imul(ne,ke)|0,v=v+Math.imul(ne,Le)|0,v=v+Math.imul(te,ke)|0,M=M+Math.imul(te,Le)|0,B=B+Math.imul(Q,Ke)|0,v=v+Math.imul(Q,Ve)|0,v=v+Math.imul(re,Ke)|0,M=M+Math.imul(re,Ve)|0,B=B+Math.imul(z,Ue)|0,v=v+Math.imul(z,ze)|0,v=v+Math.imul($,Ue)|0,M=M+Math.imul($,ze)|0;var Zo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Zo>>>26)|0,Zo&=67108863,B=Math.imul(Ae,Fe),v=Math.imul(Ae,qe),v=v+Math.imul(Se,Fe)|0,M=Math.imul(Se,qe),B=B+Math.imul(fe,He)|0,v=v+Math.imul(fe,je)|0,v=v+Math.imul(ie,He)|0,M=M+Math.imul(ie,je)|0,B=B+Math.imul(ce,ke)|0,v=v+Math.imul(ce,Le)|0,v=v+Math.imul(J,ke)|0,M=M+Math.imul(J,Le)|0,B=B+Math.imul(ne,Ke)|0,v=v+Math.imul(ne,Ve)|0,v=v+Math.imul(te,Ke)|0,M=M+Math.imul(te,Ve)|0,B=B+Math.imul(Q,Ue)|0,v=v+Math.imul(Q,ze)|0,v=v+Math.imul(re,Ue)|0,M=M+Math.imul(re,ze)|0,B=B+Math.imul(z,$e)|0,v=v+Math.imul(z,Ge)|0,v=v+Math.imul($,$e)|0,M=M+Math.imul($,Ge)|0;var Jo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Jo>>>26)|0,Jo&=67108863,B=Math.imul(we,Fe),v=Math.imul(we,qe),v=v+Math.imul(Ee,Fe)|0,M=Math.imul(Ee,qe),B=B+Math.imul(Ae,He)|0,v=v+Math.imul(Ae,je)|0,v=v+Math.imul(Se,He)|0,M=M+Math.imul(Se,je)|0,B=B+Math.imul(fe,ke)|0,v=v+Math.imul(fe,Le)|0,v=v+Math.imul(ie,ke)|0,M=M+Math.imul(ie,Le)|0,B=B+Math.imul(ce,Ke)|0,v=v+Math.imul(ce,Ve)|0,v=v+Math.imul(J,Ke)|0,M=M+Math.imul(J,Ve)|0,B=B+Math.imul(ne,Ue)|0,v=v+Math.imul(ne,ze)|0,v=v+Math.imul(te,Ue)|0,M=M+Math.imul(te,ze)|0,B=B+Math.imul(Q,$e)|0,v=v+Math.imul(Q,Ge)|0,v=v+Math.imul(re,$e)|0,M=M+Math.imul(re,Ge)|0,B=B+Math.imul(z,We)|0,v=v+Math.imul(z,Xe)|0,v=v+Math.imul($,We)|0,M=M+Math.imul($,Xe)|0;var Qo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Qo>>>26)|0,Qo&=67108863,B=Math.imul(Be,Fe),v=Math.imul(Be,qe),v=v+Math.imul(ue,Fe)|0,M=Math.imul(ue,qe),B=B+Math.imul(we,He)|0,v=v+Math.imul(we,je)|0,v=v+Math.imul(Ee,He)|0,M=M+Math.imul(Ee,je)|0,B=B+Math.imul(Ae,ke)|0,v=v+Math.imul(Ae,Le)|0,v=v+Math.imul(Se,ke)|0,M=M+Math.imul(Se,Le)|0,B=B+Math.imul(fe,Ke)|0,v=v+Math.imul(fe,Ve)|0,v=v+Math.imul(ie,Ke)|0,M=M+Math.imul(ie,Ve)|0,B=B+Math.imul(ce,Ue)|0,v=v+Math.imul(ce,ze)|0,v=v+Math.imul(J,Ue)|0,M=M+Math.imul(J,ze)|0,B=B+Math.imul(ne,$e)|0,v=v+Math.imul(ne,Ge)|0,v=v+Math.imul(te,$e)|0,M=M+Math.imul(te,Ge)|0,B=B+Math.imul(Q,We)|0,v=v+Math.imul(Q,Xe)|0,v=v+Math.imul(re,We)|0,M=M+Math.imul(re,Xe)|0,B=B+Math.imul(z,Ye)|0,v=v+Math.imul(z,Ze)|0,v=v+Math.imul($,Ye)|0,M=M+Math.imul($,Ze)|0;var ec=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(ec>>>26)|0,ec&=67108863,B=Math.imul(se,Fe),v=Math.imul(se,qe),v=v+Math.imul(xe,Fe)|0,M=Math.imul(xe,qe),B=B+Math.imul(Be,He)|0,v=v+Math.imul(Be,je)|0,v=v+Math.imul(ue,He)|0,M=M+Math.imul(ue,je)|0,B=B+Math.imul(we,ke)|0,v=v+Math.imul(we,Le)|0,v=v+Math.imul(Ee,ke)|0,M=M+Math.imul(Ee,Le)|0,B=B+Math.imul(Ae,Ke)|0,v=v+Math.imul(Ae,Ve)|0,v=v+Math.imul(Se,Ke)|0,M=M+Math.imul(Se,Ve)|0,B=B+Math.imul(fe,Ue)|0,v=v+Math.imul(fe,ze)|0,v=v+Math.imul(ie,Ue)|0,M=M+Math.imul(ie,ze)|0,B=B+Math.imul(ce,$e)|0,v=v+Math.imul(ce,Ge)|0,v=v+Math.imul(J,$e)|0,M=M+Math.imul(J,Ge)|0,B=B+Math.imul(ne,We)|0,v=v+Math.imul(ne,Xe)|0,v=v+Math.imul(te,We)|0,M=M+Math.imul(te,Xe)|0,B=B+Math.imul(Q,Ye)|0,v=v+Math.imul(Q,Ze)|0,v=v+Math.imul(re,Ye)|0,M=M+Math.imul(re,Ze)|0,B=B+Math.imul(z,Je)|0,v=v+Math.imul(z,Qe)|0,v=v+Math.imul($,Je)|0,M=M+Math.imul($,Qe)|0;var tc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(tc>>>26)|0,tc&=67108863,B=Math.imul(Ne,Fe),v=Math.imul(Ne,qe),v=v+Math.imul(Re,Fe)|0,M=Math.imul(Re,qe),B=B+Math.imul(se,He)|0,v=v+Math.imul(se,je)|0,v=v+Math.imul(xe,He)|0,M=M+Math.imul(xe,je)|0,B=B+Math.imul(Be,ke)|0,v=v+Math.imul(Be,Le)|0,v=v+Math.imul(ue,ke)|0,M=M+Math.imul(ue,Le)|0,B=B+Math.imul(we,Ke)|0,v=v+Math.imul(we,Ve)|0,v=v+Math.imul(Ee,Ke)|0,M=M+Math.imul(Ee,Ve)|0,B=B+Math.imul(Ae,Ue)|0,v=v+Math.imul(Ae,ze)|0,v=v+Math.imul(Se,Ue)|0,M=M+Math.imul(Se,ze)|0,B=B+Math.imul(fe,$e)|0,v=v+Math.imul(fe,Ge)|0,v=v+Math.imul(ie,$e)|0,M=M+Math.imul(ie,Ge)|0,B=B+Math.imul(ce,We)|0,v=v+Math.imul(ce,Xe)|0,v=v+Math.imul(J,We)|0,M=M+Math.imul(J,Xe)|0,B=B+Math.imul(ne,Ye)|0,v=v+Math.imul(ne,Ze)|0,v=v+Math.imul(te,Ye)|0,M=M+Math.imul(te,Ze)|0,B=B+Math.imul(Q,Je)|0,v=v+Math.imul(Q,Qe)|0,v=v+Math.imul(re,Je)|0,M=M+Math.imul(re,Qe)|0,B=B+Math.imul(z,et)|0,v=v+Math.imul(z,tt)|0,v=v+Math.imul($,et)|0,M=M+Math.imul($,tt)|0;var rc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(rc>>>26)|0,rc&=67108863,B=Math.imul(Ne,He),v=Math.imul(Ne,je),v=v+Math.imul(Re,He)|0,M=Math.imul(Re,je),B=B+Math.imul(se,ke)|0,v=v+Math.imul(se,Le)|0,v=v+Math.imul(xe,ke)|0,M=M+Math.imul(xe,Le)|0,B=B+Math.imul(Be,Ke)|0,v=v+Math.imul(Be,Ve)|0,v=v+Math.imul(ue,Ke)|0,M=M+Math.imul(ue,Ve)|0,B=B+Math.imul(we,Ue)|0,v=v+Math.imul(we,ze)|0,v=v+Math.imul(Ee,Ue)|0,M=M+Math.imul(Ee,ze)|0,B=B+Math.imul(Ae,$e)|0,v=v+Math.imul(Ae,Ge)|0,v=v+Math.imul(Se,$e)|0,M=M+Math.imul(Se,Ge)|0,B=B+Math.imul(fe,We)|0,v=v+Math.imul(fe,Xe)|0,v=v+Math.imul(ie,We)|0,M=M+Math.imul(ie,Xe)|0,B=B+Math.imul(ce,Ye)|0,v=v+Math.imul(ce,Ze)|0,v=v+Math.imul(J,Ye)|0,M=M+Math.imul(J,Ze)|0,B=B+Math.imul(ne,Je)|0,v=v+Math.imul(ne,Qe)|0,v=v+Math.imul(te,Je)|0,M=M+Math.imul(te,Qe)|0,B=B+Math.imul(Q,et)|0,v=v+Math.imul(Q,tt)|0,v=v+Math.imul(re,et)|0,M=M+Math.imul(re,tt)|0;var nc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(nc>>>26)|0,nc&=67108863,B=Math.imul(Ne,ke),v=Math.imul(Ne,Le),v=v+Math.imul(Re,ke)|0,M=Math.imul(Re,Le),B=B+Math.imul(se,Ke)|0,v=v+Math.imul(se,Ve)|0,v=v+Math.imul(xe,Ke)|0,M=M+Math.imul(xe,Ve)|0,B=B+Math.imul(Be,Ue)|0,v=v+Math.imul(Be,ze)|0,v=v+Math.imul(ue,Ue)|0,M=M+Math.imul(ue,ze)|0,B=B+Math.imul(we,$e)|0,v=v+Math.imul(we,Ge)|0,v=v+Math.imul(Ee,$e)|0,M=M+Math.imul(Ee,Ge)|0,B=B+Math.imul(Ae,We)|0,v=v+Math.imul(Ae,Xe)|0,v=v+Math.imul(Se,We)|0,M=M+Math.imul(Se,Xe)|0,B=B+Math.imul(fe,Ye)|0,v=v+Math.imul(fe,Ze)|0,v=v+Math.imul(ie,Ye)|0,M=M+Math.imul(ie,Ze)|0,B=B+Math.imul(ce,Je)|0,v=v+Math.imul(ce,Qe)|0,v=v+Math.imul(J,Je)|0,M=M+Math.imul(J,Qe)|0,B=B+Math.imul(ne,et)|0,v=v+Math.imul(ne,tt)|0,v=v+Math.imul(te,et)|0,M=M+Math.imul(te,tt)|0;var ic=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(ic>>>26)|0,ic&=67108863,B=Math.imul(Ne,Ke),v=Math.imul(Ne,Ve),v=v+Math.imul(Re,Ke)|0,M=Math.imul(Re,Ve),B=B+Math.imul(se,Ue)|0,v=v+Math.imul(se,ze)|0,v=v+Math.imul(xe,Ue)|0,M=M+Math.imul(xe,ze)|0,B=B+Math.imul(Be,$e)|0,v=v+Math.imul(Be,Ge)|0,v=v+Math.imul(ue,$e)|0,M=M+Math.imul(ue,Ge)|0,B=B+Math.imul(we,We)|0,v=v+Math.imul(we,Xe)|0,v=v+Math.imul(Ee,We)|0,M=M+Math.imul(Ee,Xe)|0,B=B+Math.imul(Ae,Ye)|0,v=v+Math.imul(Ae,Ze)|0,v=v+Math.imul(Se,Ye)|0,M=M+Math.imul(Se,Ze)|0,B=B+Math.imul(fe,Je)|0,v=v+Math.imul(fe,Qe)|0,v=v+Math.imul(ie,Je)|0,M=M+Math.imul(ie,Qe)|0,B=B+Math.imul(ce,et)|0,v=v+Math.imul(ce,tt)|0,v=v+Math.imul(J,et)|0,M=M+Math.imul(J,tt)|0;var sc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(sc>>>26)|0,sc&=67108863,B=Math.imul(Ne,Ue),v=Math.imul(Ne,ze),v=v+Math.imul(Re,Ue)|0,M=Math.imul(Re,ze),B=B+Math.imul(se,$e)|0,v=v+Math.imul(se,Ge)|0,v=v+Math.imul(xe,$e)|0,M=M+Math.imul(xe,Ge)|0,B=B+Math.imul(Be,We)|0,v=v+Math.imul(Be,Xe)|0,v=v+Math.imul(ue,We)|0,M=M+Math.imul(ue,Xe)|0,B=B+Math.imul(we,Ye)|0,v=v+Math.imul(we,Ze)|0,v=v+Math.imul(Ee,Ye)|0,M=M+Math.imul(Ee,Ze)|0,B=B+Math.imul(Ae,Je)|0,v=v+Math.imul(Ae,Qe)|0,v=v+Math.imul(Se,Je)|0,M=M+Math.imul(Se,Qe)|0,B=B+Math.imul(fe,et)|0,v=v+Math.imul(fe,tt)|0,v=v+Math.imul(ie,et)|0,M=M+Math.imul(ie,tt)|0;var ac=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(ac>>>26)|0,ac&=67108863,B=Math.imul(Ne,$e),v=Math.imul(Ne,Ge),v=v+Math.imul(Re,$e)|0,M=Math.imul(Re,Ge),B=B+Math.imul(se,We)|0,v=v+Math.imul(se,Xe)|0,v=v+Math.imul(xe,We)|0,M=M+Math.imul(xe,Xe)|0,B=B+Math.imul(Be,Ye)|0,v=v+Math.imul(Be,Ze)|0,v=v+Math.imul(ue,Ye)|0,M=M+Math.imul(ue,Ze)|0,B=B+Math.imul(we,Je)|0,v=v+Math.imul(we,Qe)|0,v=v+Math.imul(Ee,Je)|0,M=M+Math.imul(Ee,Qe)|0,B=B+Math.imul(Ae,et)|0,v=v+Math.imul(Ae,tt)|0,v=v+Math.imul(Se,et)|0,M=M+Math.imul(Se,tt)|0;var oc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(oc>>>26)|0,oc&=67108863,B=Math.imul(Ne,We),v=Math.imul(Ne,Xe),v=v+Math.imul(Re,We)|0,M=Math.imul(Re,Xe),B=B+Math.imul(se,Ye)|0,v=v+Math.imul(se,Ze)|0,v=v+Math.imul(xe,Ye)|0,M=M+Math.imul(xe,Ze)|0,B=B+Math.imul(Be,Je)|0,v=v+Math.imul(Be,Qe)|0,v=v+Math.imul(ue,Je)|0,M=M+Math.imul(ue,Qe)|0,B=B+Math.imul(we,et)|0,v=v+Math.imul(we,tt)|0,v=v+Math.imul(Ee,et)|0,M=M+Math.imul(Ee,tt)|0;var cc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(cc>>>26)|0,cc&=67108863,B=Math.imul(Ne,Ye),v=Math.imul(Ne,Ze),v=v+Math.imul(Re,Ye)|0,M=Math.imul(Re,Ze),B=B+Math.imul(se,Je)|0,v=v+Math.imul(se,Qe)|0,v=v+Math.imul(xe,Je)|0,M=M+Math.imul(xe,Qe)|0,B=B+Math.imul(Be,et)|0,v=v+Math.imul(Be,tt)|0,v=v+Math.imul(ue,et)|0,M=M+Math.imul(ue,tt)|0;var fc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(fc>>>26)|0,fc&=67108863,B=Math.imul(Ne,Je),v=Math.imul(Ne,Qe),v=v+Math.imul(Re,Je)|0,M=Math.imul(Re,Qe),B=B+Math.imul(se,et)|0,v=v+Math.imul(se,tt)|0,v=v+Math.imul(xe,et)|0,M=M+Math.imul(xe,tt)|0;var uc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(uc>>>26)|0,uc&=67108863,B=Math.imul(Ne,et),v=Math.imul(Ne,tt),v=v+Math.imul(Re,et)|0,M=Math.imul(Re,tt);var dc=(O+B|0)+((v&8191)<<13)|0;return O=(M+(v>>>13)|0)+(dc>>>26)|0,dc&=67108863,P[0]=Go,P[1]=Wo,P[2]=Xo,P[3]=Yo,P[4]=Zo,P[5]=Jo,P[6]=Qo,P[7]=ec,P[8]=tc,P[9]=rc,P[10]=nc,P[11]=ic,P[12]=sc,P[13]=ac,P[14]=oc,P[15]=cc,P[16]=fc,P[17]=uc,P[18]=dc,O!==0&&(P[19]=O,E.length++),E};Math.imul||(y=l);function p(A,f,g){g.negative=f.negative^A.negative,g.length=A.length+f.length;for(var E=0,x=0,S=0;S<g.length-1;S++){var P=x;x=0;for(var O=E&67108863,B=Math.min(S,f.length-1),v=Math.max(0,S-A.length+1);v<=B;v++){var M=S-v,V=A.words[M]|0,z=f.words[v]|0,$=V*z,G=$&67108863;P=P+($/67108864|0)|0,G=G+O|0,O=G&67108863,P=P+(G>>>26)|0,x+=P>>>26,P&=67108863}g.words[S]=O,E=P,P=x}return E!==0?g.words[S]=E:g.length--,g.strip()}function m(A,f,g){var E=new w;return E.mulp(A,f,g)}i.prototype.mulTo=function(f,g){var E,x=this.length+f.length;return this.length===10&&f.length===10?E=y(this,f,g):x<63?E=l(this,f,g):x<1024?E=p(this,f,g):E=m(this,f,g),E};function w(A,f){this.x=A,this.y=f}w.prototype.makeRBT=function(f){for(var g=new Array(f),E=i.prototype._countBits(f)-1,x=0;x<f;x++)g[x]=this.revBin(x,E,f);return g},w.prototype.revBin=function(f,g,E){if(f===0||f===E-1)return f;for(var x=0,S=0;S<g;S++)x|=(f&1)<<g-S-1,f>>=1;return x},w.prototype.permute=function(f,g,E,x,S,P){for(var O=0;O<P;O++)x[O]=g[f[O]],S[O]=E[f[O]]},w.prototype.transform=function(f,g,E,x,S,P){this.permute(P,f,g,E,x,S);for(var O=1;O<S;O<<=1)for(var B=O<<1,v=Math.cos(2*Math.PI/B),M=Math.sin(2*Math.PI/B),V=0;V<S;V+=B)for(var z=v,$=M,G=0;G<O;G++){var Q=E[V+G],re=x[V+G],me=E[V+G+O],ne=x[V+G+O],te=z*me-$*ne;ne=z*ne+$*me,me=te,E[V+G]=Q+me,x[V+G]=re+ne,E[V+G+O]=Q-me,x[V+G+O]=re-ne,G!==B&&(te=v*z-M*$,$=v*$+M*z,z=te)}},w.prototype.guessLen13b=function(f,g){var E=Math.max(g,f)|1,x=E&1,S=0;for(E=E/2|0;E;E=E>>>1)S++;return 1<<S+1+x},w.prototype.conjugate=function(f,g,E){if(!(E<=1))for(var x=0;x<E/2;x++){var S=f[x];f[x]=f[E-x-1],f[E-x-1]=S,S=g[x],g[x]=-g[E-x-1],g[E-x-1]=-S}},w.prototype.normalize13b=function(f,g){for(var E=0,x=0;x<g/2;x++){var S=Math.round(f[2*x+1]/g)*8192+Math.round(f[2*x]/g)+E;f[x]=S&67108863,S<67108864?E=0:E=S/67108864|0}return f},w.prototype.convert13b=function(f,g,E,x){for(var S=0,P=0;P<g;P++)S=S+(f[P]|0),E[2*P]=S&8191,S=S>>>13,E[2*P+1]=S&8191,S=S>>>13;for(P=2*g;P<x;++P)E[P]=0;r(S===0),r((S&-8192)===0)},w.prototype.stub=function(f){for(var g=new Array(f),E=0;E<f;E++)g[E]=0;return g},w.prototype.mulp=function(f,g,E){var x=2*this.guessLen13b(f.length,g.length),S=this.makeRBT(x),P=this.stub(x),O=new Array(x),B=new Array(x),v=new Array(x),M=new Array(x),V=new Array(x),z=new Array(x),$=E.words;$.length=x,this.convert13b(f.words,f.length,O,x),this.convert13b(g.words,g.length,M,x),this.transform(O,P,B,v,x,S),this.transform(M,P,V,z,x,S);for(var G=0;G<x;G++){var Q=B[G]*V[G]-v[G]*z[G];v[G]=B[G]*z[G]+v[G]*V[G],B[G]=Q}return this.conjugate(B,v,x),this.transform(B,v,$,P,x,S),this.conjugate($,P,x),this.normalize13b($,x),E.negative=f.negative^g.negative,E.length=f.length+g.length,E.strip()},i.prototype.mul=function(f){var g=new i(null);return g.words=new Array(this.length+f.length),this.mulTo(f,g)},i.prototype.mulf=function(f){var g=new i(null);return g.words=new Array(this.length+f.length),m(this,f,g)},i.prototype.imul=function(f){return this.clone().mulTo(f,this)},i.prototype.imuln=function(f){r(typeof f=="number"),r(f<67108864);for(var g=0,E=0;E<this.length;E++){var x=(this.words[E]|0)*f,S=(x&67108863)+(g&67108863);g>>=26,g+=x/67108864|0,g+=S>>>26,this.words[E]=S&67108863}return g!==0&&(this.words[E]=g,this.length++),this},i.prototype.muln=function(f){return this.clone().imuln(f)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(f){var g=d(f);if(g.length===0)return new i(1);for(var E=this,x=0;x<g.length&&g[x]===0;x++,E=E.sqr());if(++x<g.length)for(var S=E.sqr();x<g.length;x++,S=S.sqr())g[x]!==0&&(E=E.mul(S));return E},i.prototype.iushln=function(f){r(typeof f=="number"&&f>=0);var g=f%26,E=(f-g)/26,x=67108863>>>26-g<<26-g,S;if(g!==0){var P=0;for(S=0;S<this.length;S++){var O=this.words[S]&x,B=(this.words[S]|0)-O<<g;this.words[S]=B|P,P=O>>>26-g}P&&(this.words[S]=P,this.length++)}if(E!==0){for(S=this.length-1;S>=0;S--)this.words[S+E]=this.words[S];for(S=0;S<E;S++)this.words[S]=0;this.length+=E}return this.strip()},i.prototype.ishln=function(f){return r(this.negative===0),this.iushln(f)},i.prototype.iushrn=function(f,g,E){r(typeof f=="number"&&f>=0);var x;g?x=(g-g%26)/26:x=0;var S=f%26,P=Math.min((f-S)/26,this.length),O=67108863^67108863>>>S<<S,B=E;if(x-=P,x=Math.max(0,x),B){for(var v=0;v<P;v++)B.words[v]=this.words[v];B.length=P}if(P!==0)if(this.length>P)for(this.length-=P,v=0;v<this.length;v++)this.words[v]=this.words[v+P];else this.words[0]=0,this.length=1;var M=0;for(v=this.length-1;v>=0&&(M!==0||v>=x);v--){var V=this.words[v]|0;this.words[v]=M<<26-S|V>>>S,M=V&O}return B&&M!==0&&(B.words[B.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(f,g,E){return r(this.negative===0),this.iushrn(f,g,E)},i.prototype.shln=function(f){return this.clone().ishln(f)},i.prototype.ushln=function(f){return this.clone().iushln(f)},i.prototype.shrn=function(f){return this.clone().ishrn(f)},i.prototype.ushrn=function(f){return this.clone().iushrn(f)},i.prototype.testn=function(f){r(typeof f=="number"&&f>=0);var g=f%26,E=(f-g)/26,x=1<<g;if(this.length<=E)return!1;var S=this.words[E];return!!(S&x)},i.prototype.imaskn=function(f){r(typeof f=="number"&&f>=0);var g=f%26,E=(f-g)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=E)return this;if(g!==0&&E++,this.length=Math.min(E,this.length),g!==0){var x=67108863^67108863>>>g<<g;this.words[this.length-1]&=x}return this.strip()},i.prototype.maskn=function(f){return this.clone().imaskn(f)},i.prototype.iaddn=function(f){return r(typeof f=="number"),r(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},i.prototype._iaddn=function(f){this.words[0]+=f;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},i.prototype.isubn=function(f){if(r(typeof f=="number"),r(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this.strip()},i.prototype.addn=function(f){return this.clone().iaddn(f)},i.prototype.subn=function(f){return this.clone().isubn(f)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(f,g,E){var x=f.length+E,S;this._expand(x);var P,O=0;for(S=0;S<f.length;S++){P=(this.words[S+E]|0)+O;var B=(f.words[S]|0)*g;P-=B&67108863,O=(P>>26)-(B/67108864|0),this.words[S+E]=P&67108863}for(;S<this.length-E;S++)P=(this.words[S+E]|0)+O,O=P>>26,this.words[S+E]=P&67108863;if(O===0)return this.strip();for(r(O===-1),O=0,S=0;S<this.length;S++)P=-(this.words[S]|0)+O,O=P>>26,this.words[S]=P&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(f,g){var E=this.length-f.length,x=this.clone(),S=f,P=S.words[S.length-1]|0,O=this._countBits(P);E=26-O,E!==0&&(S=S.ushln(E),x.iushln(E),P=S.words[S.length-1]|0);var B=x.length-S.length,v;if(g!=="mod"){v=new i(null),v.length=B+1,v.words=new Array(v.length);for(var M=0;M<v.length;M++)v.words[M]=0}var V=x.clone()._ishlnsubmul(S,1,B);V.negative===0&&(x=V,v&&(v.words[B]=1));for(var z=B-1;z>=0;z--){var $=(x.words[S.length+z]|0)*67108864+(x.words[S.length+z-1]|0);for($=Math.min($/P|0,67108863),x._ishlnsubmul(S,$,z);x.negative!==0;)$--,x.negative=0,x._ishlnsubmul(S,1,z),x.isZero()||(x.negative^=1);v&&(v.words[z]=$)}return v&&v.strip(),x.strip(),g!=="div"&&E!==0&&x.iushrn(E),{div:v||null,mod:x}},i.prototype.divmod=function(f,g,E){if(r(!f.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var x,S,P;return this.negative!==0&&f.negative===0?(P=this.neg().divmod(f,g),g!=="mod"&&(x=P.div.neg()),g!=="div"&&(S=P.mod.neg(),E&&S.negative!==0&&S.iadd(f)),{div:x,mod:S}):this.negative===0&&f.negative!==0?(P=this.divmod(f.neg(),g),g!=="mod"&&(x=P.div.neg()),{div:x,mod:P.mod}):(this.negative&f.negative)!==0?(P=this.neg().divmod(f.neg(),g),g!=="div"&&(S=P.mod.neg(),E&&S.negative!==0&&S.isub(f)),{div:P.div,mod:S}):f.length>this.length||this.cmp(f)<0?{div:new i(0),mod:this}:f.length===1?g==="div"?{div:this.divn(f.words[0]),mod:null}:g==="mod"?{div:null,mod:new i(this.modn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new i(this.modn(f.words[0]))}:this._wordDiv(f,g)},i.prototype.div=function(f){return this.divmod(f,"div",!1).div},i.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},i.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},i.prototype.divRound=function(f){var g=this.divmod(f);if(g.mod.isZero())return g.div;var E=g.div.negative!==0?g.mod.isub(f):g.mod,x=f.ushrn(1),S=f.andln(1),P=E.cmp(x);return P<0||S===1&&P===0?g.div:g.div.negative!==0?g.div.isubn(1):g.div.iaddn(1)},i.prototype.modn=function(f){r(f<=67108863);for(var g=(1<<26)%f,E=0,x=this.length-1;x>=0;x--)E=(g*E+(this.words[x]|0))%f;return E},i.prototype.idivn=function(f){r(f<=67108863);for(var g=0,E=this.length-1;E>=0;E--){var x=(this.words[E]|0)+g*67108864;this.words[E]=x/f|0,g=x%f}return this.strip()},i.prototype.divn=function(f){return this.clone().idivn(f)},i.prototype.egcd=function(f){r(f.negative===0),r(!f.isZero());var g=this,E=f.clone();g.negative!==0?g=g.umod(f):g=g.clone();for(var x=new i(1),S=new i(0),P=new i(0),O=new i(1),B=0;g.isEven()&&E.isEven();)g.iushrn(1),E.iushrn(1),++B;for(var v=E.clone(),M=g.clone();!g.isZero();){for(var V=0,z=1;(g.words[0]&z)===0&&V<26;++V,z<<=1);if(V>0)for(g.iushrn(V);V-- >0;)(x.isOdd()||S.isOdd())&&(x.iadd(v),S.isub(M)),x.iushrn(1),S.iushrn(1);for(var $=0,G=1;(E.words[0]&G)===0&&$<26;++$,G<<=1);if($>0)for(E.iushrn($);$-- >0;)(P.isOdd()||O.isOdd())&&(P.iadd(v),O.isub(M)),P.iushrn(1),O.iushrn(1);g.cmp(E)>=0?(g.isub(E),x.isub(P),S.isub(O)):(E.isub(g),P.isub(x),O.isub(S))}return{a:P,b:O,gcd:E.iushln(B)}},i.prototype._invmp=function(f){r(f.negative===0),r(!f.isZero());var g=this,E=f.clone();g.negative!==0?g=g.umod(f):g=g.clone();for(var x=new i(1),S=new i(0),P=E.clone();g.cmpn(1)>0&&E.cmpn(1)>0;){for(var O=0,B=1;(g.words[0]&B)===0&&O<26;++O,B<<=1);if(O>0)for(g.iushrn(O);O-- >0;)x.isOdd()&&x.iadd(P),x.iushrn(1);for(var v=0,M=1;(E.words[0]&M)===0&&v<26;++v,M<<=1);if(v>0)for(E.iushrn(v);v-- >0;)S.isOdd()&&S.iadd(P),S.iushrn(1);g.cmp(E)>=0?(g.isub(E),x.isub(S)):(E.isub(g),S.isub(x))}var V;return g.cmpn(1)===0?V=x:V=S,V.cmpn(0)<0&&V.iadd(f),V},i.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var g=this.clone(),E=f.clone();g.negative=0,E.negative=0;for(var x=0;g.isEven()&&E.isEven();x++)g.iushrn(1),E.iushrn(1);do{for(;g.isEven();)g.iushrn(1);for(;E.isEven();)E.iushrn(1);var S=g.cmp(E);if(S<0){var P=g;g=E,E=P}else if(S===0||E.cmpn(1)===0)break;g.isub(E)}while(!0);return E.iushln(x)},i.prototype.invm=function(f){return this.egcd(f).a.umod(f)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(f){return this.words[0]&f},i.prototype.bincn=function(f){r(typeof f=="number");var g=f%26,E=(f-g)/26,x=1<<g;if(this.length<=E)return this._expand(E+1),this.words[E]|=x,this;for(var S=x,P=E;S!==0&&P<this.length;P++){var O=this.words[P]|0;O+=S,S=O>>>26,O&=67108863,this.words[P]=O}return S!==0&&(this.words[P]=S,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(f){var g=f<0;if(this.negative!==0&&!g)return-1;if(this.negative===0&&g)return 1;this.strip();var E;if(this.length>1)E=1;else{g&&(f=-f),r(f<=67108863,"Number is too big");var x=this.words[0]|0;E=x===f?0:x<f?-1:1}return this.negative!==0?-E|0:E},i.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var g=this.ucmp(f);return this.negative!==0?-g|0:g},i.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var g=0,E=this.length-1;E>=0;E--){var x=this.words[E]|0,S=f.words[E]|0;if(x!==S){x<S?g=-1:x>S&&(g=1);break}}return g},i.prototype.gtn=function(f){return this.cmpn(f)===1},i.prototype.gt=function(f){return this.cmp(f)===1},i.prototype.gten=function(f){return this.cmpn(f)>=0},i.prototype.gte=function(f){return this.cmp(f)>=0},i.prototype.ltn=function(f){return this.cmpn(f)===-1},i.prototype.lt=function(f){return this.cmp(f)===-1},i.prototype.lten=function(f){return this.cmpn(f)<=0},i.prototype.lte=function(f){return this.cmp(f)<=0},i.prototype.eqn=function(f){return this.cmpn(f)===0},i.prototype.eq=function(f){return this.cmp(f)===0},i.red=function(f){return new I(f)},i.prototype.toRed=function(f){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(f){return this.red=f,this},i.prototype.forceRed=function(f){return r(!this.red,"Already a number in reduction context"),this._forceRed(f)},i.prototype.redAdd=function(f){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},i.prototype.redIAdd=function(f){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},i.prototype.redSub=function(f){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},i.prototype.redISub=function(f){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},i.prototype.redShl=function(f){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},i.prototype.redMul=function(f){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},i.prototype.redIMul=function(f){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(f){return r(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var C={k256:null,p224:null,p192:null,p25519:null};function T(A,f){this.name=A,this.p=new i(f,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}T.prototype._tmp=function(){var f=new i(null);return f.words=new Array(Math.ceil(this.n/13)),f},T.prototype.ireduce=function(f){var g=f,E;do this.split(g,this.tmp),g=this.imulK(g),g=g.iadd(this.tmp),E=g.bitLength();while(E>this.n);var x=E<this.n?-1:g.ucmp(this.p);return x===0?(g.words[0]=0,g.length=1):x>0?g.isub(this.p):g.strip!==void 0?g.strip():g._strip(),g},T.prototype.split=function(f,g){f.iushrn(this.n,0,g)},T.prototype.imulK=function(f){return f.imul(this.k)};function q(){T.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(q,T),q.prototype.split=function(f,g){for(var E=4194303,x=Math.min(f.length,9),S=0;S<x;S++)g.words[S]=f.words[S];if(g.length=x,f.length<=9){f.words[0]=0,f.length=1;return}var P=f.words[9];for(g.words[g.length++]=P&E,S=10;S<f.length;S++){var O=f.words[S]|0;f.words[S-10]=(O&E)<<4|P>>>22,P=O}P>>>=22,f.words[S-10]=P,P===0&&f.length>10?f.length-=10:f.length-=9},q.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var g=0,E=0;E<f.length;E++){var x=f.words[E]|0;g+=x*977,f.words[E]=g&67108863,g=x*64+(g/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function F(){T.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(F,T);function j(){T.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(j,T);function k(){T.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(k,T),k.prototype.imulK=function(f){for(var g=0,E=0;E<f.length;E++){var x=(f.words[E]|0)*19+g,S=x&67108863;x>>>=26,f.words[E]=S,g=x}return g!==0&&(f.words[f.length++]=g),f},i._prime=function(f){if(C[f])return C[f];var g;if(f==="k256")g=new q;else if(f==="p224")g=new F;else if(f==="p192")g=new j;else if(f==="p25519")g=new k;else throw new Error("Unknown prime "+f);return C[f]=g,g};function I(A){if(typeof A=="string"){var f=i._prime(A);this.m=f.p,this.prime=f}else r(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}I.prototype._verify1=function(f){r(f.negative===0,"red works only with positives"),r(f.red,"red works only with red numbers")},I.prototype._verify2=function(f,g){r((f.negative|g.negative)===0,"red works only with positives"),r(f.red&&f.red===g.red,"red works only with red numbers")},I.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):f.umod(this.m)._forceRed(this)},I.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},I.prototype.add=function(f,g){this._verify2(f,g);var E=f.add(g);return E.cmp(this.m)>=0&&E.isub(this.m),E._forceRed(this)},I.prototype.iadd=function(f,g){this._verify2(f,g);var E=f.iadd(g);return E.cmp(this.m)>=0&&E.isub(this.m),E},I.prototype.sub=function(f,g){this._verify2(f,g);var E=f.sub(g);return E.cmpn(0)<0&&E.iadd(this.m),E._forceRed(this)},I.prototype.isub=function(f,g){this._verify2(f,g);var E=f.isub(g);return E.cmpn(0)<0&&E.iadd(this.m),E},I.prototype.shl=function(f,g){return this._verify1(f),this.imod(f.ushln(g))},I.prototype.imul=function(f,g){return this._verify2(f,g),this.imod(f.imul(g))},I.prototype.mul=function(f,g){return this._verify2(f,g),this.imod(f.mul(g))},I.prototype.isqr=function(f){return this.imul(f,f.clone())},I.prototype.sqr=function(f){return this.mul(f,f)},I.prototype.sqrt=function(f){if(f.isZero())return f.clone();var g=this.m.andln(3);if(r(g%2===1),g===3){var E=this.m.add(new i(1)).iushrn(2);return this.pow(f,E)}for(var x=this.m.subn(1),S=0;!x.isZero()&&x.andln(1)===0;)S++,x.iushrn(1);r(!x.isZero());var P=new i(1).toRed(this),O=P.redNeg(),B=this.m.subn(1).iushrn(1),v=this.m.bitLength();for(v=new i(2*v*v).toRed(this);this.pow(v,B).cmp(O)!==0;)v.redIAdd(O);for(var M=this.pow(v,x),V=this.pow(f,x.addn(1).iushrn(1)),z=this.pow(f,x),$=S;z.cmp(P)!==0;){for(var G=z,Q=0;G.cmp(P)!==0;Q++)G=G.redSqr();r(Q<$);var re=this.pow(M,new i(1).iushln($-Q-1));V=V.redMul(re),M=re.redSqr(),z=z.redMul(M),$=Q}return V},I.prototype.invm=function(f){var g=f._invmp(this.m);return g.negative!==0?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},I.prototype.pow=function(f,g){if(g.isZero())return new i(1).toRed(this);if(g.cmpn(1)===0)return f.clone();var E=4,x=new Array(1<<E);x[0]=new i(1).toRed(this),x[1]=f;for(var S=2;S<x.length;S++)x[S]=this.mul(x[S-1],f);var P=x[0],O=0,B=0,v=g.bitLength()%26;for(v===0&&(v=26),S=g.length-1;S>=0;S--){for(var M=g.words[S],V=v-1;V>=0;V--){var z=M>>V&1;if(P!==x[0]&&(P=this.sqr(P)),z===0&&O===0){B=0;continue}O<<=1,O|=z,B++,!(B!==E&&(S!==0||V!==0))&&(P=this.mul(P,x[O]),B=0,O=0)}v=26}return P},I.prototype.convertTo=function(f){var g=f.umod(this.m);return g===f?g.clone():g},I.prototype.convertFrom=function(f){var g=f.clone();return g.red=null,g},i.mont=function(f){return new R(f)};function R(A){I.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(R,I),R.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},R.prototype.convertFrom=function(f){var g=this.imod(f.mul(this.rinv));return g.red=null,g},R.prototype.imul=function(f,g){if(f.isZero()||g.isZero())return f.words[0]=0,f.length=1,f;var E=f.imul(g),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=E.isub(x).iushrn(this.shift),P=S;return S.cmp(this.m)>=0?P=S.isub(this.m):S.cmpn(0)<0&&(P=S.iadd(this.m)),P._forceRed(this)},R.prototype.mul=function(f,g){if(f.isZero()||g.isZero())return new i(0)._forceRed(this);var E=f.mul(g),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=E.isub(x).iushrn(this.shift),P=S;return S.cmp(this.m)>=0?P=S.isub(this.m):S.cmpn(0)<0&&(P=S.iadd(this.m)),P._forceRed(this)},R.prototype.invm=function(f){var g=this.imod(f._invmp(this.m).mul(this.r2));return g._forceRed(this)}})(typeof H2>"u"||H2,q3)});var vi=K(H3=>{D();N();var is=H3,SC=ei(),xC=mm(),El=wm();is.assert=xC;is.toArray=El.toArray;is.zero2=El.zero2;is.toHex=El.toHex;is.encode=El.encode;function EC(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),a=0;a<n.length;a++){var o,c=s.andln(i-1);s.isOdd()?(c>(i>>1)-1?o=(i>>1)-c:o=c,s.isubn(o)):o=0,n[a]=o,s.iushrn(1)}return n}is.getNAF=EC;function AC(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n=0,i=0,s;e.cmpn(-n)>0||t.cmpn(-i)>0;){var a=e.andln(3)+n&3,o=t.andln(3)+i&3;a===3&&(a=-1),o===3&&(o=-1);var c;(a&1)===0?c=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?c=-a:c=a),r[0].push(c);var u;(o&1)===0?u=0:(s=t.andln(7)+i&7,(s===3||s===5)&&a===2?u=-o:u=o),r[1].push(u),2*n===c+1&&(n=1-n),2*i===u+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return r}is.getJSF=AC;function PC(e,t,r){var n="_"+t;e.prototype[t]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}is.cachedProperty=PC;function CC(e){return typeof e=="string"?is.toArray(e,"hex"):e}is.parseBytes=CC;function IC(e){return new SC(e,"hex","le")}is.intFromLE=IC});var Dd=K((KY,j3)=>{D();N();var Od=vi(),yc=ei(),Al=Od.getNAF,BC=Od.getJSF,Pl=Od.assert;function za(e,t){this.type=e,this.p=new yc(t.p,16),this.red=t.prime?yc.red(t.prime):yc.mont(this.p),this.zero=new yc(0).toRed(this.red),this.one=new yc(1).toRed(this.red),this.two=new yc(2).toRed(this.red),this.n=t.n&&new yc(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}j3.exports=za;za.prototype.point=function(){throw new Error("Not implemented")};za.prototype.validate=function(){throw new Error("Not implemented")};za.prototype._fixedNafMul=function(t,r){Pl(t.precomputed);var n=t._getDoubles(),i=Al(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var a=[],o,c;for(o=0;o<i.length;o+=n.step){c=0;for(var u=o+n.step-1;u>=o;u--)c=(c<<1)+i[u];a.push(c)}for(var b=this.jpoint(null,null,null),h=this.jpoint(null,null,null),d=s;d>0;d--){for(o=0;o<a.length;o++)c=a[o],c===d?h=h.mixedAdd(n.points[o]):c===-d&&(h=h.mixedAdd(n.points[o].neg()));b=b.add(h)}return b.toP()};za.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var s=i.points,a=Al(r,n,this._bitLength),o=this.jpoint(null,null,null),c=a.length-1;c>=0;c--){for(var u=0;c>=0&&a[c]===0;c--)u++;if(c>=0&&u++,o=o.dblp(u),c<0)break;var b=a[c];Pl(b!==0),t.type==="affine"?b>0?o=o.mixedAdd(s[b-1>>1]):o=o.mixedAdd(s[-b-1>>1].neg()):b>0?o=o.add(s[b-1>>1]):o=o.add(s[-b-1>>1].neg())}return t.type==="affine"?o.toP():o};za.prototype._wnafMulAdd=function(t,r,n,i,s){var a=this._wnafT1,o=this._wnafT2,c=this._wnafT3,u=0,b,h,d;for(b=0;b<i;b++){d=r[b];var l=d._getNAFPoints(t);a[b]=l.wnd,o[b]=l.points}for(b=i-1;b>=1;b-=2){var y=b-1,p=b;if(a[y]!==1||a[p]!==1){c[y]=Al(n[y],a[y],this._bitLength),c[p]=Al(n[p],a[p],this._bitLength),u=Math.max(c[y].length,u),u=Math.max(c[p].length,u);continue}var m=[r[y],null,null,r[p]];r[y].y.cmp(r[p].y)===0?(m[1]=r[y].add(r[p]),m[2]=r[y].toJ().mixedAdd(r[p].neg())):r[y].y.cmp(r[p].y.redNeg())===0?(m[1]=r[y].toJ().mixedAdd(r[p]),m[2]=r[y].add(r[p].neg())):(m[1]=r[y].toJ().mixedAdd(r[p]),m[2]=r[y].toJ().mixedAdd(r[p].neg()));var w=[-3,-1,-5,-7,0,7,5,1,3],C=BC(n[y],n[p]);for(u=Math.max(C[0].length,u),c[y]=new Array(u),c[p]=new Array(u),h=0;h<u;h++){var T=C[0][h]|0,q=C[1][h]|0;c[y][h]=w[(T+1)*3+(q+1)],c[p][h]=0,o[y]=m}}var F=this.jpoint(null,null,null),j=this._wnafT4;for(b=u;b>=0;b--){for(var k=0;b>=0;){var I=!0;for(h=0;h<i;h++)j[h]=c[h][b]|0,j[h]!==0&&(I=!1);if(!I)break;k++,b--}if(b>=0&&k++,F=F.dblp(k),b<0)break;for(h=0;h<i;h++){var R=j[h];R!==0&&(R>0?d=o[h][R-1>>1]:R<0&&(d=o[h][-R-1>>1].neg()),d.type==="affine"?F=F.mixedAdd(d):F=F.add(d))}}for(b=0;b<i;b++)o[b]=null;return s?F:F.toP()};function Bi(e,t){this.curve=e,this.type=t,this.precomputed=null}za.BasePoint=Bi;Bi.prototype.eq=function(){throw new Error("Not implemented")};Bi.prototype.validate=function(){return this.curve.validate(this)};za.prototype.decodePoint=function(t,r){t=Od.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*n){t[0]===6?Pl(t[t.length-1]%2===0):t[0]===7&&Pl(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};Bi.prototype.encodeCompressed=function(t){return this.encode(t,!0)};Bi.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};Bi.prototype.encode=function(t,r){return Od.encode(this._encode(r),t)};Bi.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};Bi.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};Bi.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=t){for(var a=0;a<t;a++)i=i.dbl();n.push(i)}return{step:t,points:n}};Bi.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:t,points:r}};Bi.prototype._getBeta=function(){return null};Bi.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r}});var L3=K((zY,k3)=>{D();N();var MC=vi(),fr=ei(),j2=cf(),Af=Dd(),TC=MC.assert;function Mi(e){Af.call(this,"short",e),this.a=new fr(e.a,16).toRed(this.red),this.b=new fr(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}j2(Mi,Af);k3.exports=Mi;Mi.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new fr(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new fr(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],TC(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var a;return t.basis?a=t.basis.map(function(o){return{a:new fr(o.a,16),b:new fr(o.b,16)}}):a=this._getEndoBasis(n),{beta:r,lambda:n,basis:a}}};Mi.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:fr.mont(t),n=new fr(2).toRed(r).redInvm(),i=n.redNeg(),s=new fr(3).toRed(r).redNeg().redSqrt().redMul(n),a=i.redAdd(s).fromRed(),o=i.redSub(s).fromRed();return[a,o]};Mi.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),s=new fr(1),a=new fr(0),o=new fr(0),c=new fr(1),u,b,h,d,l,y,p,m=0,w,C;n.cmpn(0)!==0;){var T=i.div(n);w=i.sub(T.mul(n)),C=o.sub(T.mul(s));var q=c.sub(T.mul(a));if(!h&&w.cmp(r)<0)u=p.neg(),b=s,h=w.neg(),d=C;else if(h&&++m===2)break;p=w,i=n,n=w,o=s,s=C,c=a,a=q}l=w.neg(),y=C;var F=h.sqr().add(d.sqr()),j=l.sqr().add(y.sqr());return j.cmp(F)>=0&&(l=u,y=b),h.negative&&(h=h.neg(),d=d.neg()),l.negative&&(l=l.neg(),y=y.neg()),[{a:h,b:d},{a:l,b:y}]};Mi.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(t).divRound(this.n),a=n.b.neg().mul(t).divRound(this.n),o=s.mul(n.a),c=a.mul(i.a),u=s.mul(n.b),b=a.mul(i.b),h=t.sub(o).sub(c),d=u.add(b).neg();return{k1:h,k2:d}};Mi.prototype.pointFromX=function(t,r){t=new fr(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(t,i)};Mi.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};Mi.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,a=0;a<t.length;a++){var o=this._endoSplit(r[a]),c=t[a],u=c._getBeta();o.k1.negative&&(o.k1.ineg(),c=c.neg(!0)),o.k2.negative&&(o.k2.ineg(),u=u.neg(!0)),i[a*2]=c,i[a*2+1]=u,s[a*2]=o.k1,s[a*2+1]=o.k2}for(var b=this._wnafMulAdd(1,i,s,a*2,n),h=0;h<a*2;h++)i[h]=null,s[h]=null;return b};function Ur(e,t,r,n){Af.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new fr(t,16),this.y=new fr(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}j2(Ur,Af.BasePoint);Mi.prototype.point=function(t,r,n){return new Ur(this,t,r,n)};Mi.prototype.pointFromJSON=function(t,r){return Ur.fromJSON(this,t,r)};Ur.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};Ur.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Ur.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function s(o){return t.point(o[0],o[1],n)}var a=r[2];return i.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[i].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[i].concat(a.naf.points.map(s))}},i};Ur.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Ur.prototype.isInfinity=function(){return this.inf};Ur.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Ur.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),a=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,o)};Ur.prototype.getX=function(){return this.x.fromRed()};Ur.prototype.getY=function(){return this.y.fromRed()};Ur.prototype.mul=function(t){return t=new fr(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};Ur.prototype.mulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};Ur.prototype.jmulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};Ur.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};Ur.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};Ur.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function ln(e,t,r,n){Af.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new fr(0)):(this.x=new fr(t,16),this.y=new fr(r,16),this.z=new fr(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}j2(ln,Af.BasePoint);Mi.prototype.jpoint=function(t,r,n){return new ln(this,t,r,n)};ln.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};ln.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};ln.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(n),a=this.y.redMul(r.redMul(t.z)),o=t.y.redMul(n.redMul(this.z)),c=i.redSub(s),u=a.redSub(o);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=c.redSqr(),h=b.redMul(c),d=i.redMul(b),l=u.redSqr().redIAdd(h).redISub(d).redISub(d),y=u.redMul(d.redISub(l)).redISub(a.redMul(h)),p=this.z.redMul(t.z).redMul(c);return this.curve.jpoint(l,y,p)};ln.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),s=this.y,a=t.y.redMul(r).redMul(this.z),o=n.redSub(i),c=s.redSub(a);if(o.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=o.redSqr(),b=u.redMul(o),h=n.redMul(u),d=c.redSqr().redIAdd(b).redISub(h).redISub(h),l=c.redMul(h.redISub(d)).redISub(s.redMul(b)),y=this.z.redMul(o);return this.curve.jpoint(d,l,y)};ln.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,a=this.x,o=this.y,c=this.z,u=c.redSqr().redSqr(),b=o.redAdd(o);for(r=0;r<t;r++){var h=a.redSqr(),d=b.redSqr(),l=d.redSqr(),y=h.redAdd(h).redIAdd(h).redIAdd(i.redMul(u)),p=a.redMul(d),m=y.redSqr().redISub(p.redAdd(p)),w=p.redISub(m),C=y.redMul(w);C=C.redIAdd(C).redISub(l);var T=b.redMul(c);r+1<t&&(u=u.redMul(l)),a=m,c=T,b=C}return this.curve.jpoint(a,b.redMul(s),c)};ln.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};ln.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(a);o=o.redIAdd(o);var c=i.redAdd(i).redIAdd(i),u=c.redSqr().redISub(o).redISub(o),b=a.redIAdd(a);b=b.redIAdd(b),b=b.redIAdd(b),t=u,r=c.redMul(o.redISub(u)).redISub(b),n=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),d=this.y.redSqr(),l=d.redSqr(),y=this.x.redAdd(d).redSqr().redISub(h).redISub(l);y=y.redIAdd(y);var p=h.redAdd(h).redIAdd(h),m=p.redSqr(),w=l.redIAdd(l);w=w.redIAdd(w),w=w.redIAdd(w),t=m.redISub(y).redISub(y),r=p.redMul(y.redISub(t)).redISub(w),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};ln.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(a);o=o.redIAdd(o);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=c.redSqr().redISub(o).redISub(o);t=u;var b=a.redIAdd(a);b=b.redIAdd(b),b=b.redIAdd(b),r=c.redMul(o.redISub(u)).redISub(b),n=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),d=this.y.redSqr(),l=this.x.redMul(d),y=this.x.redSub(h).redMul(this.x.redAdd(h));y=y.redAdd(y).redIAdd(y);var p=l.redIAdd(l);p=p.redIAdd(p);var m=p.redAdd(p);t=y.redSqr().redISub(m),n=this.y.redAdd(this.z).redSqr().redISub(d).redISub(h);var w=d.redSqr();w=w.redIAdd(w),w=w.redIAdd(w),w=w.redIAdd(w),r=y.redMul(p.redISub(t)).redISub(w)}return this.curve.jpoint(t,r,n)};ln.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),a=r.redSqr(),o=n.redSqr(),c=a.redAdd(a).redIAdd(a).redIAdd(t.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var b=u.redMul(o),h=c.redSqr().redISub(b.redAdd(b)),d=b.redISub(h),l=o.redSqr();l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var y=c.redMul(d).redISub(l),p=n.redAdd(n).redMul(i);return this.curve.jpoint(h,y,p)};ln.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=t.redAdd(t).redIAdd(t),a=s.redSqr(),o=this.x.redAdd(r).redSqr().redISub(t).redISub(i);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(a);var c=o.redSqr(),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var b=s.redIAdd(o).redSqr().redISub(a).redISub(c).redISub(u),h=r.redMul(b);h=h.redIAdd(h),h=h.redIAdd(h);var d=this.x.redMul(c).redISub(h);d=d.redIAdd(d),d=d.redIAdd(d);var l=this.y.redMul(b.redMul(u.redISub(b)).redISub(o.redMul(c)));l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var y=this.z.redAdd(o).redSqr().redISub(n).redISub(c);return this.curve.jpoint(d,l,y)};ln.prototype.mul=function(t,r){return t=new fr(t,r),this.curve._wnafMul(this,t)};ln.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(i)).cmpn(0)===0};ln.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};ln.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};ln.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var U3=K((WY,V3)=>{D();N();var Pf=ei(),K3=cf(),Cl=Dd(),OC=vi();function Cf(e){Cl.call(this,"mont",e),this.a=new Pf(e.a,16).toRed(this.red),this.b=new Pf(e.b,16).toRed(this.red),this.i4=new Pf(4).toRed(this.red).redInvm(),this.two=new Pf(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}K3(Cf,Cl);V3.exports=Cf;Cf.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function zr(e,t,r){Cl.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Pf(t,16),this.z=new Pf(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}K3(zr,Cl.BasePoint);Cf.prototype.decodePoint=function(t,r){return this.point(OC.toArray(t,r),1)};Cf.prototype.point=function(t,r){return new zr(this,t,r)};Cf.prototype.pointFromJSON=function(t){return zr.fromJSON(this,t)};zr.prototype.precompute=function(){};zr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};zr.fromJSON=function(t,r){return new zr(t,r[0],r[1]||t.one)};zr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};zr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};zr.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),a=r.redMul(i),o=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(a,o)};zr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};zr.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=t.x.redAdd(t.z),a=t.x.redSub(t.z),o=a.redMul(n),c=s.redMul(i),u=r.z.redMul(o.redAdd(c).redSqr()),b=r.x.redMul(o.redISub(c).redSqr());return this.curve.point(u,b)};zr.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),s=this,a=[];r.cmpn(0)!==0;r.iushrn(1))a.push(r.andln(1));for(var o=a.length-1;o>=0;o--)a[o]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};zr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};zr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};zr.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};zr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};zr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var G3=K((ZY,$3)=>{D();N();var DC=vi(),aa=ei(),z3=cf(),Il=Dd(),NC=DC.assert;function xs(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,Il.call(this,"edwards",e),this.a=new aa(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new aa(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new aa(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),NC(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}z3(xs,Il);$3.exports=xs;xs.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};xs.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};xs.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};xs.prototype.pointFromX=function(t,r){t=new aa(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),a=i.redMul(s.redInvm()),o=a.redSqrt();if(o.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");var c=o.fromRed().isOdd();return(r&&!c||!r&&c)&&(o=o.redNeg()),this.point(t,o)};xs.prototype.pointFromY=function(t,r){t=new aa(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),a=i.redMul(s.redInvm());if(a.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var o=a.redSqrt();if(o.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");return o.fromRed().isOdd()!==r&&(o=o.redNeg()),this.point(o,t)};xs.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function Ht(e,t,r,n,i){Il.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new aa(t,16),this.y=new aa(r,16),this.z=n?new aa(n,16):this.curve.one,this.t=i&&new aa(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}z3(Ht,Il.BasePoint);xs.prototype.pointFromJSON=function(t){return Ht.fromJSON(this,t)};xs.prototype.point=function(t,r,n,i){return new Ht(this,t,r,n,i)};Ht.fromJSON=function(t,r){return new Ht(t,r[0],r[1],r[2])};Ht.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ht.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Ht.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),a=i.redAdd(r),o=a.redSub(n),c=i.redSub(r),u=s.redMul(o),b=a.redMul(c),h=s.redMul(c),d=o.redMul(a);return this.curve.point(u,b,d,h)};Ht.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,a,o,c,u;if(this.curve.twisted){o=this.curve._mulA(r);var b=o.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(b.redSub(this.curve.two)),s=b.redMul(o.redSub(n)),a=b.redSqr().redSub(b).redSub(b)):(c=this.z.redSqr(),u=b.redSub(c).redISub(c),i=t.redSub(r).redISub(n).redMul(u),s=b.redMul(o.redSub(n)),a=b.redMul(u))}else o=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),u=o.redSub(c).redSub(c),i=this.curve._mulC(t.redISub(o)).redMul(u),s=this.curve._mulC(o).redMul(r.redISub(n)),a=o.redMul(u);return this.curve.point(i,s,a)};Ht.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Ht.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),a=n.redSub(r),o=s.redSub(i),c=s.redAdd(i),u=n.redAdd(r),b=a.redMul(o),h=c.redMul(u),d=a.redMul(u),l=o.redMul(c);return this.curve.point(b,h,l,d)};Ht.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),s=this.y.redMul(t.y),a=this.curve.d.redMul(i).redMul(s),o=n.redSub(a),c=n.redAdd(a),u=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),b=r.redMul(o).redMul(u),h,d;return this.curve.twisted?(h=r.redMul(c).redMul(s.redSub(this.curve._mulA(i))),d=o.redMul(c)):(h=r.redMul(c).redMul(s.redSub(i)),d=this.curve._mulC(o).redMul(c)),this.curve.point(b,h,d)};Ht.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};Ht.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};Ht.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};Ht.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};Ht.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};Ht.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Ht.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Ht.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Ht.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};Ht.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};Ht.prototype.toP=Ht.prototype.normalize;Ht.prototype.mixedAdd=Ht.prototype.add});var k2=K(W3=>{D();N();var Bl=W3;Bl.base=Dd();Bl.short=L3();Bl.mont=U3();Bl.edwards=G3()});var Y3=K((nZ,X3)=>{D();N();X3.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Ml=K(Q3=>{D();N();var K2=Q3,$a=tl(),L2=k2(),RC=vi(),Z3=RC.assert;function J3(e){e.type==="short"?this.curve=new L2.short(e):e.type==="edwards"?this.curve=new L2.edwards(e):this.curve=new L2.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,Z3(this.g.validate(),"Invalid curve"),Z3(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}K2.PresetCurve=J3;function Ga(e,t){Object.defineProperty(K2,e,{configurable:!0,enumerable:!0,get:function(){var r=new J3(t);return Object.defineProperty(K2,e,{configurable:!0,enumerable:!0,value:r}),r}})}Ga("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:$a.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Ga("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:$a.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Ga("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:$a.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Ga("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:$a.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Ga("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:$a.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Ga("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:$a.sha256,gRed:!1,g:["9"]});Ga("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:$a.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var V2;try{V2=Y3()}catch{V2=void 0}Ga("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:$a.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",V2]})});var t5=K((fZ,e5)=>{D();N();var FC=ei(),qC=vi(),U2=qC.assert;function An(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e5.exports=An;An.fromPublic=function(t,r,n){return r instanceof An?r:new An(t,{pub:r,pubEnc:n})};An.fromPrivate=function(t,r,n){return r instanceof An?r:new An(t,{priv:r,privEnc:n})};An.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};An.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};An.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};An.prototype._importPrivate=function(t,r){this.priv=new FC(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};An.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?U2(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&U2(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};An.prototype.derive=function(t){return t.validate()||U2(t.validate(),"public point not validated"),t.mul(this.priv).getX()};An.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};An.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};An.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var i5=K((lZ,n5)=>{D();N();var Tl=ei(),G2=vi(),HC=G2.assert;function Nd(e,t,r){if(t instanceof Nd)return t;this._importDER(t,r)||(HC(t.r&&t.s,"Signature without r or s"),this.r=new Tl(t.r,16),this.s=new Tl(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam,this.curve=e,this.byteLength=this.curve.n.byteLength())}n5.exports=Nd;function jC(){this.place=0}function z2(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,a=t.place;s<n;s++,a++)i<<=8,i|=e[a],i>>>=0;return i<=127?!1:(t.place=a,i)}function r5(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}Nd.prototype._importDER=function(t,r){t=G2.toArray(t,r);var n=new jC;if(t[n.place++]!==48)return!1;var i=z2(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var s=z2(t,n);if(s===!1)return!1;var a=t.slice(n.place,s+n.place);if(n.place+=s,t[n.place++]!==2)return!1;var o=z2(t,n);if(o===!1||t.length!==o+n.place)return!1;var c=t.slice(n.place,o+n.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Tl(a),this.s=new Tl(c),this.recoveryParam=null,!0};function $2(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}Nd.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=r5(r),n=r5(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];$2(i,r.length),i=i.concat(r),i.push(2),$2(i,n.length);var s=i.concat(n),a=[48];return $2(a,s.length),a=a.concat(s),G2.encode(a,t)};Nd.prototype.toBytes=function(){let t=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return t.concat(r)}});var o5=K((bZ,a5)=>{D();N();var oa=ei(),s5=Sm(),kC=vi(),W2=Ml(),LC=xm(),mc=kC.assert,X2=t5(),Ol=i5();function Ti(e){if(!(this instanceof Ti))return new Ti(e);typeof e=="string"&&(mc(Object.prototype.hasOwnProperty.call(W2,e),"Unknown curve "+e),e=W2[e]),e instanceof W2.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}a5.exports=Ti;Ti.prototype.keyPair=function(t){return new X2(this,t)};Ti.prototype.keyFromPrivate=function(t,r){return X2.fromPrivate(this,t,r)};Ti.prototype.keyFromPublic=function(t,r){return X2.fromPublic(this,t,r)};Ti.prototype.genKeyPair=function(t){t||(t={});for(var r=new s5({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||LC(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new oa(2));;){var s=new oa(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Ti.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};Ti.prototype.sign=function(t,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof t!="string"&&typeof t!="number"&&!oa.isBN(t)){mc(typeof t=="object"&&t&&typeof t.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),mc(t.length>>>0===t.length);for(var s=0;s<t.length;s++)mc((t[s]&255)===t[s])}r=this.keyFromPrivate(r,n),t=this._truncateToN(new oa(t,16)),mc(!t.isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),o=r.getPrivate().toArray("be",a),c=t.toArray("be",a);mc(new oa(c).eq(t),"Can not sign message");for(var u=new s5({hash:this.hash,entropy:o,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),b=this.n.sub(new oa(1)),h=0;;h++){var d=i.k?i.k(h):new oa(u.generate(this.n.byteLength()));if(d=this._truncateToN(d,!0),!(d.cmpn(1)<=0||d.cmp(b)>=0)){var l=this.g.mul(d);if(!l.isInfinity()){var y=l.getX(),p=y.umod(this.n);if(p.cmpn(0)!==0){var m=d.invm(this.n).mul(p.mul(r.getPrivate()).iadd(t));if(m=m.umod(this.n),m.cmpn(0)!==0){var w=(l.getY().isOdd()?1:0)|(y.cmp(p)!==0?2:0);return i.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),w^=1),new Ol(this.curve,{r:p,s:m,recoveryParam:w})}}}}}};Ti.prototype.verify=function(t,r,n,i){t=this._truncateToN(new oa(t,16)),n=this.keyFromPublic(n,i),r=new Ol(this.curve,r,"hex");var s=r.r,a=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var o=a.invm(this.n),c=o.mul(t).umod(this.n),u=o.mul(s).umod(this.n),b;return this.curve._maxwellTrick?(b=this.g.jmulAdd(c,n.getPublic(),u),b.isInfinity()?!1:b.eqXToP(s)):(b=this.g.mulAdd(c,n.getPublic(),u),b.isInfinity()?!1:b.getX().umod(this.n).cmp(s)===0)};Ti.prototype.recoverPubKey=function(e,t,r,n){mc((3&r)===r,"The recovery param is more than two bits"),t=new Ol(this.curve,t,n);var i=this.n,s=new oa(e),a=t.r,o=t.s,c=r&1,u=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?a=this.curve.pointFromX(a.add(this.curve.n),c):a=this.curve.pointFromX(a,c);var b=t.r.invm(i),h=i.sub(s).mul(b).umod(i),d=o.mul(b).umod(i);return this.g.mulAdd(h,a,d)};Ti.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new Ol(this.curve,t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var d5=K((yZ,u5)=>{D();N();var Rd=vi(),f5=Rd.assert,c5=Rd.parseBytes,If=Rd.cachedProperty;function $r(e,t){this.eddsa=e,this._secret=c5(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=c5(t.pub)}$r.fromPublic=function(t,r){return r instanceof $r?r:new $r(t,{pub:r})};$r.fromSecret=function(t,r){return r instanceof $r?r:new $r(t,{secret:r})};$r.prototype.secret=function(){return this._secret};If($r,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});If($r,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});If($r,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});If($r,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});If($r,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});If($r,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});$r.prototype.sign=function(t){return f5(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};$r.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};$r.prototype.getSecret=function(t){return f5(this._secret,"KeyPair is public only"),Rd.encode(this.secret(),t)};$r.prototype.getPublic=function(t){return Rd.encode(this.pubBytes(),t)};u5.exports=$r});var h5=K((_Z,l5)=>{D();N();var KC=ei(),Dl=vi(),VC=Dl.assert,Nl=Dl.cachedProperty,UC=Dl.parseBytes;function wc(e,t){this.eddsa=e,typeof t!="object"&&(t=UC(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),VC(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof KC&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Nl(wc,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Nl(wc,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Nl(wc,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Nl(wc,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});wc.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};wc.prototype.toHex=function(){return Dl.encode(this.toBytes(),"hex").toUpperCase()};l5.exports=wc});var y5=K((EZ,v5)=>{D();N();var zC=tl(),$C=Ml(),Bf=vi(),GC=Bf.assert,b5=Bf.parseBytes,g5=d5(),p5=h5();function ti(e){if(GC(e==="ed25519","only tested with ed25519 so far"),!(this instanceof ti))return new ti(e);e=$C[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=zC.sha512}v5.exports=ti;ti.prototype.sign=function(t,r){t=b5(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),s=this.g.mul(i),a=this.encodePoint(s),o=this.hashInt(a,n.pubBytes(),t).mul(n.priv()),c=i.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:a})};ti.prototype.verify=function(t,r,n){t=b5(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),t),a=this.g.mul(r.S()),o=r.R().add(i.pub().mul(s));return o.eq(a)};ti.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return Bf.intFromLE(t.digest()).umod(this.curve.n)};ti.prototype.keyFromPublic=function(t){return g5.fromPublic(this,t)};ti.prototype.keyFromSecret=function(t){return g5.fromSecret(this,t)};ti.prototype.makeSignature=function(t){return t instanceof p5?t:new p5(this,t)};ti.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};ti.prototype.decodePoint=function(t){t=Bf.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&-129),i=(t[r]&128)!==0,s=Bf.intFromLE(n);return this.curve.pointFromY(s,i)};ti.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};ti.prototype.decodeInt=function(t){return Bf.intFromLE(t)};ti.prototype.isPoint=function(t){return t instanceof this.pointClass}});var Mf=K(Oi=>{D();N();Object.defineProperty(Oi,"__esModule",{value:!0});Oi.utils=Oi.curves=Oi.curve=Oi.eddsa=Oi.ec=void 0;var WC=k2();Oi.curve=WC;var XC=Ml();Oi.curves=XC;var YC=o5();Oi.ec=YC;var ZC=y5();Oi.eddsa=ZC;var JC=vi();Oi.utils=JC});var _5=K((m5,w5)=>{D();N();Object.defineProperty(m5,"__esModule",{value:!0});var QC=Mf(),Es=new QC.ec("secp256k1"),ft=Es.curve,jt=ei();function eI(e,t){let r=new jt(t);if(r.cmp(ft.p)>=0)return null;r=r.toRed(ft.red);let n=r.redSqr().redIMul(r).redIAdd(ft.b).redSqrt();e===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(ft.b)).isZero()?Es.keyPair({pub:{x:r,y:n}}):null}function tI(e,t,r){let n=new jt(t),i=new jt(r);if(n.cmp(ft.p)>=0||i.cmp(ft.p)>=0||(n=n.toRed(ft.red),i=i.toRed(ft.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(ft.b)).isZero()?Es.keyPair({pub:{x:n,y:i}}):null}function Wa(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:eI(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:tI(t,e.subarray(1,33),e.subarray(33,65));default:return null}}w5.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new jt(e);return t.cmp(ft.n)<0&&!t.isZero()},privateKeyNegate(e){let t=new jt(e);return H.Buffer.from(ft.n.sub(t).umod(ft.n).toArray("be",32))},privateKeyTweakAdd(e,t){let r=new jt(t);return r.cmp(ft.n)>=0||(r.iadd(new jt(e)),r.cmp(ft.n)>=0&&r.isub(ft.n),r.isZero())?null:H.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(e,t){let r=new jt(t);return r.cmp(ft.n)>=0||r.isZero()?1:(r.imul(new jt(e)),r.cmp(ft.n)>=0&&(r=r.umod(ft.n)),H.Buffer.from(r.toArray("be",32)))},publicKeyVerify(e){let t=Wa(e);return t==null?null:t.validate().result},publicKeyCreate(e,t){let r=new jt(e);if(r.cmp(ft.n)>=0||r.isZero())return null;let n=Es.keyFromPrivate(e,null).getPublic();return H.Buffer.from(n.encode(null,t))},publicKeyConvert(e,t){let n=Wa(e).getPublic();return H.Buffer.from(n.encode(null,t))},publicKeyNegate(e,t){let r=Wa(e);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),H.Buffer.from(n.encode(null,t))},publicKeyCombine(e,t){let r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=Wa(e[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:H.Buffer.from(n.encode(null,t))},publicKeyTweakAdd(e,t,r){let n=Wa(e);if(n===null||new jt(t).cmp(ft.n)>=0)return null;let s=n.getPublic().add(ft.g.mul(t));return s.isInfinity()?null:H.Buffer.from(s.encode(null,r))},publicKeyTweakMul(e,t,r){let n=Wa(e);if(n===null)return null;let i=new jt(t);if(i.cmp(ft.n)>=0||i.isZero())return null;let s=n.getPublic().mul(t);return H.Buffer.from(s.encode(null,r))},signatureNormalize(e){let t=new jt(e.subarray(0,32)),r=new jt(e.subarray(32,64));return t.cmp(ft.n)>=0||r.cmp(ft.n)>=0?null:(r.cmp(Es.nh)===1&&e.set(ft.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new jt(r).cmp(ft.n)>=0||new jt(n).cmp(ft.n)>=0)return 1;let{output:i}=e,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let a=33,o=0;for(;a>1&&s[o]===0&&!(s[o+1]&128);--a,++o);if(s=s.subarray(o),s[0]&128||a>1&&s[0]===0&&!(s[1]&128))return 1;let c=i.subarray(6+33,6+33+33);c[0]=0,c.set(n,1);let u=33,b=0;for(;u>1&&c[b]===0&&!(c[b+1]&128);--u,++b);return c=c.subarray(b),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(e.outputlen=6+a+u,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+a]=2,i[5+a]=c.length,i.set(c,6+a),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let i=t.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let a=new jt(i);a.cmp(ft.n)>=0&&(a=new jt(0));let o=new jt(t.subarray(6+r));return o.cmp(ft.n)>=0&&(o=new jt(0)),e.set(a.toArrayLike(Uint8Array,"be",32),0),e.set(o.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t){let r=new jt(t);return r.cmp(ft.n)>=0||r.isZero()?null:Es.sign(e,t,{canonical:!0}).toBytes()},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},i=new jt(n.r),s=new jt(n.s);if(i.cmp(ft.n)>=0||s.cmp(ft.n)>=0)return 1;if(s.cmp(Es.nh)===1||i.isZero()||s.isZero())return 3;let a=Wa(r);if(a===null)return 2;let o=a.getPublic();return Es.verify(t,n,o)},ecdsaRecover(e,t,r,n){let i={r:e.slice(0,32),s:e.slice(32,64)},s=new jt(i.r),a=new jt(i.s);if(s.cmp(ft.n)>=0||a.cmp(ft.n)>=0)return 1;if(s.isZero()||a.isZero())return 2;let o;try{o=Es.recoverPubKey(r,i,t,null)}catch{return 2}return H.Buffer.from(o.encode(null,n))},ecdh(e,t,r,n,i,s,a){let o=Wa(t);if(o===null)return 1;let c=new jt(r);if(c.cmp(ft.n)>=0||c.isZero())return 2;let u=o.getPublic().mul(c);if(i===void 0){let b=u.encode(null,!0),h=Es.hash().update(b).digest();for(let d=0;d<32;++d)e[d]=h[d]}else{s||(s=new Uint8Array(32));let b=u.getX().toArray("be",32);for(let y=0;y<32;++y)s[y]=b[y];a||(a=new Uint8Array(32));let h=u.getY().toArray("be",32);for(let y=0;y<32;++y)a[y]=h[y];let d=i(s,a,n);if(!(d instanceof Uint8Array&&d.length===e.length))return 2;e.set(d)}return 0}}});var P5=K(Gr=>{D();N();var rI=Gr&&Gr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),nI=Gr&&Gr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),iI=Gr&&Gr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&rI(t,e,r);return nI(t,e),t};Object.defineProperty(Gr,"__esModule",{value:!0});Gr.fromSeed=Gr.fromPublicKey=Gr.fromPrivateKey=Gr.fromBase58=Gr.tinySecp256k1Interface=void 0;var Y2=iI(Td()),sI=lc(),aI=vl(),x5=(0,sI.base58check)(aI.sha256),E5=_5(),hn=Em(),oI=Am();function cI(e){return{isPoint:t=>e.publicKeyVerify(t),isPrivate:t=>e.privateKeyVerify(t),pointAddScalar:(t,r,n)=>e.publicKeyTweakAdd(t,r,n),pointFromScalar:(t,r)=>e.publicKeyCreate(t,r),privateAdd:(t,r)=>e.privateKeyTweakAdd(new Uint8Array(t),r),sign:(t,r)=>e.ecdsaSign(t,r),verify:(t,r,n)=>e.ecdsaVerify(n,t,r)}}function fI(e){return{isPoint:t=>e.publicKeyVerify(t),pointCompress:(t,r)=>Uint8Array.from(e.publicKeyConvert(t,r??!0)),isPrivate:t=>e.privateKeyVerify(t),pointFromScalar:(t,r)=>{let n=e.publicKeyCreate(t,r??!0);return n==null?null:Uint8Array.from(n)},sign:(t,r,n)=>Uint8Array.from(e.ecdsaSign(t,r)),verify:(t,r,n,i)=>e.ecdsaVerify(n,t,r)}}var Xa=cI(E5);Gr.tinySecp256k1Interface=fI(E5);var Z2=hn.BufferN(32),uI=hn.compile({wif:hn.UInt8,bip32:{public:hn.UInt32,private:hn.UInt32}}),ql={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},S5=2147483648,dI=Math.pow(2,31)-1;function lI(e){return hn.String(e)&&e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function hI(e){return hn.UInt32(e)&&e<=dI}var Rl=class{constructor(t,r,n,i,s=0,a=0,o=0){this.__D=t,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=a,this.__PARENT_FINGERPRINT=o,hn(uI,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=H.Buffer.from(Xa.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return H.Buffer.from(Y2.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return Fl(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=H.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),x5.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return oI.encode(this.network.wif,this.privateKey,!0)}derive(t){hn(hn.UInt32,t);let r=t>=S5,n=H.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(t,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(t,33);let i=Y2.hmacSHA512(this.chainCode,n),s=i.slice(0,32),a=i.slice(32);if(!Xa.isPrivate(s))return this.derive(t+1);let o;if(this.isNeutered()){let c=Xa.pointAddScalar(this.publicKey,s,!0);if(c===null)return this.derive(t+1);o=Fl(c,a,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{let c=Xa.privateAdd(this.privateKey,s);if(c==null)return this.derive(t+1);o=J2(c,a,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return o}deriveHardened(t){return hn(hI,t),this.derive(t+S5)}derivePath(t){hn(lI,t);let r=t.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(t){if(!this.privateKey)throw new Error("Missing private key");return Xa.sign(t,this.privateKey)}verify(t,r){return Xa.verify(t,this.publicKey,r)}};function pI(e,t){let r=H.Buffer.from(x5.decode(e));if(r.length!==78)throw new TypeError("Invalid buffer length");t=t||ql;let n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let a=r.readUInt32BE(9);if(i===0&&a!==0)throw new TypeError("Invalid index");let o=r.slice(13,45),c;if(n===t.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let u=r.slice(46,78);c=J2(u,o,t,i,a,s)}else{let u=r.slice(45,78);c=Fl(u,o,t,i,a,s)}return c}Gr.fromBase58=pI;function A5(e,t,r){return J2(e,t,r)}Gr.fromPrivateKey=A5;function J2(e,t,r,n,i,s){if(hn({privateKey:Z2,chainCode:Z2},{privateKey:e,chainCode:t}),r=r||ql,!Xa.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new Rl(e,void 0,t,r,n,i,s)}function bI(e,t,r){return Fl(e,t,r)}Gr.fromPublicKey=bI;function Fl(e,t,r,n,i,s){if(hn({publicKey:hn.BufferN(33),chainCode:Z2},{publicKey:e,chainCode:t}),r=r||ql,!Xa.isPoint(e))throw new TypeError("Point is not on the curve");return new Rl(void 0,e,t,r,n,i,s)}function gI(e,t){if(hn(hn.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||ql;let r=Y2.hmacSHA512(H.Buffer.from("Bitcoin seed","utf8"),e),n=r.slice(0,32),i=r.slice(32);return A5(n,i,t)}Gr.fromSeed=gI});var C5=K(Hl=>{D();N();Object.defineProperty(Hl,"__esModule",{value:!0});Hl.fromSeedV2=void 0;var vI=Pm();function yI(e,t){return vI.HDKey.fromMasterSeed(new Uint8Array([...e])).derive(t)}Hl.fromSeedV2=yI});var I5=K(ri=>{D();N();Object.defineProperty(ri,"__esModule",{value:!0});ri.fromSeedV2=ri.fromPrivateKey=ri.fromPublicKey=ri.fromBase58=ri.fromSeed=ri.tinySecp256k1Interface=void 0;var Fd=P5();Object.defineProperty(ri,"tinySecp256k1Interface",{enumerable:!0,get:function(){return Fd.tinySecp256k1Interface}});Object.defineProperty(ri,"fromSeed",{enumerable:!0,get:function(){return Fd.fromSeed}});Object.defineProperty(ri,"fromBase58",{enumerable:!0,get:function(){return Fd.fromBase58}});Object.defineProperty(ri,"fromPublicKey",{enumerable:!0,get:function(){return Fd.fromPublicKey}});Object.defineProperty(ri,"fromPrivateKey",{enumerable:!0,get:function(){return Fd.fromPrivateKey}});var mI=C5();Object.defineProperty(ri,"fromSeedV2",{enumerable:!0,get:function(){return mI.fromSeedV2}})});var B5=K((LZ,wI)=>{wI.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var eb=K(_c=>{D();N();Object.defineProperty(_c,"__esModule",{value:!0});_c._default=_c.wordlists=void 0;var Q2={};_c.wordlists=Q2;var jl;_c._default=jl;try{_c._default=jl=B5(),Q2.english=jl,Q2.EN=jl}catch{}});var tb=K(ur=>{D();N();Object.defineProperty(ur,"__esModule",{value:!0});ur.wordlists=ur.getDefaultWordlist=ur.setDefaultWordlist=ur.validateMnemonic=ur.generateMnemonic=ur.entropyToMnemonic=ur.mnemonicToEntropy=ur.mnemonicToSeedV2=ur.mnemonicToSeed=ur.mnemonicToSeedSync=void 0;var T5=Td(),O5=Sl(),kl=eb(),D5=Ed(),_I=Cm(),Tf=kl._default,M5="Invalid mnemonic",Sc="Invalid entropy",SI="Invalid mnemonic checksum",N5=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function xI(e,t,r,n,i){let s=(0,O5.pbkdf2)(D5.sha512,e,t,{c:r,dkLen:n});return Promise.resolve(H.Buffer.from(s))}function qd(e){return(e||"").normalize("NFKD")}function R5(e,t,r){for(;e.length<r;)e=t+e;return e}function F5(e){return parseInt(e,2)}function q5(e){return e.map(t=>R5(t.toString(2),"0",8)).join("")}function H5(e){let r=e.length*8/32,n=(0,T5.sha256)(e);return q5(Array.from(n)).slice(0,r)}function j5(e){return"mnemonic"+(e||"")}function EI(e,t){let r=H.Buffer.from(qd(e),"utf8"),n=H.Buffer.from(j5(qd(t)),"utf8"),i=(0,O5.pbkdf2)(D5.sha512,r,n,{c:2048,dkLen:64});return H.Buffer.from(i)}ur.mnemonicToSeedSync=EI;function AI(e,t){return Promise.resolve().then(()=>{let r=H.Buffer.from(qd(e),"utf8"),n=H.Buffer.from(j5(qd(t)),"utf8");return xI(r,n,2048,64,"sha512")})}ur.mnemonicToSeed=AI;async function PI(e,t){let r=e.split(" ").map(s=>Tf.indexOf(s)),n=new Uint8Array(new Uint16Array(r).buffer),i=await(0,_I.mnemonicToSeed)(n,t);return H.Buffer.from(i)}ur.mnemonicToSeedV2=PI;function k5(e,t){if(t=t||Tf,!t)throw new Error(N5);let r=qd(e).split(" ");if(r.length%3!==0)throw new Error(M5);let n=r.map(b=>{let h=t.indexOf(b);if(h===-1)throw new Error(M5);return R5(h.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),a=n.slice(i),o=s.match(/(.{1,8})/g).map(F5);if(o.length<16)throw new Error(Sc);if(o.length>32)throw new Error(Sc);if(o.length%4!==0)throw new Error(Sc);let c=H.Buffer.from(o);if(H5(c)!==a)throw new Error(SI);return c.toString("hex")}ur.mnemonicToEntropy=k5;function L5(e,t){if(H.Buffer.isBuffer(e)||(e=H.Buffer.from(e,"hex")),t=t||Tf,!t)throw new Error(N5);if(e.length<16)throw new TypeError(Sc);if(e.length>32)throw new TypeError(Sc);if(e.length%4!==0)throw new TypeError(Sc);let r=q5(Array.from(e)),n=H5(e),a=(r+n).match(/(.{1,11})/g).map(o=>{let c=F5(o);return t[c]});return t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?a.join("\u3000"):a.join(" ")}ur.entropyToMnemonic=L5;function CI(e,t,r){if(e=e||128,e%32!==0)throw new TypeError(Sc);return t=t||T5.randomBytes,L5(t(e/8),r)}ur.generateMnemonic=CI;function II(e,t){try{k5(e,t)}catch{return!1}return!0}ur.validateMnemonic=II;function BI(e){let t=kl.wordlists[e];if(t)Tf=t;else throw new Error('Could not find wordlist for language "'+e+'"')}ur.setDefaultWordlist=BI;function MI(){if(!Tf)throw new Error("No Default Wordlist set");return Object.keys(kl.wordlists).filter(e=>e==="JA"||e==="EN"?!1:kl.wordlists[e].every((t,r)=>t===Tf[r]))[0]}ur.getDefaultWordlist=MI;var TI=eb();Object.defineProperty(ur,"wordlists",{enumerable:!0,get:function(){return TI.wordlists}})});var G5=K(bt=>{D();N();var OI=bt&&bt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),DI=bt&&bt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),NI=bt&&bt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&OI(t,e,r);return DI(t,e),t},RI=bt&&bt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bt,"__esModule",{value:!0});bt.loadUncompressedPublicKey=bt.loadCompressedPublicKey=bt.publicKeyConvert=bt.publicKeyCreate=bt.publicKeyVerify=bt.privateKeyVerify=bt.loadPublicKey=bt.recover=bt.verifyWithNoRecovery=bt.verify=bt.getV=bt.sign=void 0;var FI=NI(Mf()),Or=new FI.ec("secp256k1"),K5=Td(),Of=RI(ei());function qI(e,t,r=!0){let n=Or.sign(Array.from(e),H.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}bt.sign=qI;function HI(e,t,r,n,i=!0){let s=Hd(n);if(s==null)throw new Error("pubkey error");let a=Or.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return Or.getKeyRecoveryParam(e,{r:t,s:r},a,i)}bt.getV=HI;function jI(e,t,r,n){let i=V5(t,r,e,!0);if(i==null)return!1;let s=U5(n,!0);return s==null?!1:i.equals(s)}bt.verify=jI;function kI(e,t,r){let n=Hd(r);if(n==null)throw new Error("pubkey error");let i=Or.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,K5.toHex)(t.slice(0,32)),s:(0,K5.toHex)(t.slice(32,64))};return i.verify(e,s)}bt.verifyWithNoRecovery=kI;function V5(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new Of.default(i.r),a=new Of.default(i.s);if(s.cmp(Or.curve.n)>=0||a.cmp(Or.curve.n)>=0||s.isZero()||a.isZero())return null;let o;try{o=Or.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return H.Buffer.from(o.encode(null,n))}bt.recover=V5;function Hd(e){let t=H.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:z5(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:$5(r,t.subarray(1,33),t.subarray(33,65));default:return null}}bt.loadPublicKey=Hd;function LI(e){let t=new Of.default(Array.from(e));return t.cmp(Or.curve.n)<0&&!t.isZero()}bt.privateKeyVerify=LI;function KI(e){return Hd(e)!==null}bt.publicKeyVerify=KI;function VI(e,t){let r=Or.keyFromPrivate(Array.from(e),"bytes").getPublic();return H.Buffer.from(r.encode(null,t))}bt.publicKeyCreate=VI;function U5(e,t){let r=Hd(e);if(r==null)return null;let n=Or.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return H.Buffer.from(n.encode(null,t))}bt.publicKeyConvert=U5;function z5(e,t){let r=new Of.default(Array.from(t));if(r.cmp(Or.curve.p)>=0)return null;let n=r.toRed(Or.curve.red),i=n.redSqr().redIMul(n).redIAdd(Or.curve.b).redSqrt();e===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(Or.curve.b)).isZero()?{x:n,y:i}:null}bt.loadCompressedPublicKey=z5;function $5(e,t,r){let n=new Of.default(Array.from(t)),i=new Of.default(Array.from(r));if(n.cmp(Or.curve.p)>=0||i.cmp(Or.curve.p)>=0)return null;let s=n.toRed(Or.curve.red),a=i.toRed(Or.curve.red);if((e===6||e===7)&&a.isOdd()!==(e===7))return null;let o=s.redSqr().redIMul(s);return a.redSqr().redISub(o.redIAdd(Or.curve.b)).isZero()?{x:s,y:a}:null}bt.loadUncompressedPublicKey=$5});var r6=K(ut=>{D();N();var UI=ut&&ut.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zI=ut&&ut.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),W5=ut&&ut.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&UI(t,e,r);return zI(t,e),t},$I=ut&&ut.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ut,"__esModule",{value:!0});ut.ed25519_getDerivedPrivateKey=ut.isValidPath=ut.ed25519_getRandomPrivateKey=ut.ed25519SignTest=ut.fromSecret=ut.fromSeed=ut.privateKeyVerify=ut.publicKeyVerify=ut.publicKeyCreate=ut.verify=ut.sign=ut.ed25519MulBase=void 0;var X5=W5(Mf()),ss=Td(),GI=$I(ei()),WI=tb(),rb=W5(rl()),XI=Ed();rb.utils.sha512Sync=(...e)=>(0,XI.sha512)(rb.utils.concatBytes(...e));var Ya=new X5.eddsa("ed25519"),Y5=Ya.curve;function YI(e){let t=Ya.curve.g;return Ya.encodePoint(t.mul(X5.utils.intFromLE(e)))}ut.ed25519MulBase=YI;function Z5(e,t){let r=t;r.length==64&&(r=r.slice(0,32));let n=rb.sync.sign(e,r);return Uint8Array.from(n)}ut.sign=Z5;function J5(e,t,r){return Ya.keyFromPublic(Array.from(r)).verify(Array.from(e),Array.from(t))}ut.verify=J5;function Ll(e){let t=e;t.length==64&&(t=t.slice(0,32));let n=Ya.keyFromSecret(Array.from(t)).getPublic();if(e.length==64&&!ZI(e.slice(32,64),n))throw new Error("invalid public key");return Uint8Array.from(n)}ut.publicKeyCreate=Ll;function ZI(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function JI(e){let t=Ya.decodePoint(Array.from(e));return Y5.validate(t)}ut.publicKeyVerify=JI;function Q5(e){let t=new GI.default(Array.from(e));return t.cmp(Y5.n)<0&&!t.isZero()}ut.privateKeyVerify=Q5;function QI(e){let t=Ya.keyFromSecret(Array.from(e)),r=Uint8Array.from(t.getPublic());return{publicKey:r,secretKey:(0,ss.concatBytes)(e,r)}}ut.fromSeed=QI;function eB(e){let t=e.slice(0,32),r=Ya.keyFromSecret(Array.from(t));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(t)}}ut.fromSecret=eB;function e6(e){let t=(0,ss.sha256)("ed25519-test"),r=Ll(e),n=Z5(t,e);return J5(t,n,r)}ut.ed25519SignTest=e6;function tB(e,t){for(;;){let r=(0,ss.randomBytes)(32);if(Q5(r)&&e6(r)){let n=Ll(r),i=e?(0,ss.concatBytes)(r,n):r;return t==="base58"?(0,ss.toBase58)(i):(0,ss.toHex)(i)}}}ut.ed25519_getRandomPrivateKey=tB;var rB=new RegExp("^m(\\/[0-9]+')+$"),t6=e=>e.replace("'",""),nB=2147483648;function iB(e){let t=(0,ss.hmacSHA512)("ed25519 seed",e),r=t.slice(0,32),n=t.slice(32);return{key:r,chainCode:n}}function sB({key:e,chainCode:t},r){let n=H.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=H.Buffer.concat([H.Buffer.alloc(1,0),e,n]),s=(0,ss.hmacSHA512)(t,i),a=s.slice(0,32),o=s.slice(32);return{key:a,chainCode:o}}var aB=e=>rB.test(e)?!e.split("/").slice(1).map(t6).some(isNaN):!1;ut.isValidPath=aB;function oB(e,t,r=nB){if(!(0,ut.isValidPath)(e))throw new Error("Invalid derivation path");let{key:n,chainCode:i}=iB(t);return e.split("/").slice(1).map(t6).map(a=>parseInt(a,10)).reduce((a,o)=>sB(a,o+r),{key:n,chainCode:i})}async function cB(e,t,r,n){let i=await(0,WI.mnemonicToSeedV2)(e),s=oB(t,i).key,a=Ll(s),o=r?(0,ss.concatBytes)(s,a):s;return n==="base58"?Promise.resolve((0,ss.toBase58)(o)):Promise.resolve((0,ss.toHex)(o))}ut.ed25519_getDerivedPrivateKey=cB});var a6=K(Pt=>{D();N();var fB=Pt&&Pt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),uB=Pt&&Pt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),dB=Pt&&Pt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&fB(t,e,r);return uB(t,e),t},lB=Pt&&Pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.loadUncompressedPublicKey=Pt.loadCompressedPublicKey=Pt.publicKeyConvert=Pt.publicKeyCreate=Pt.publicKeyVerify=Pt.privateKeyVerify=Pt.loadPublicKey=Pt.recover=Pt.verify=Pt.sign=void 0;var hB=dB(Mf()),Gn=new hB.ec("p256"),Df=lB(ei());function pB(e,t,r=!0){let n=Gn.sign(Array.from(e),H.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}Pt.sign=pB;function bB(e,t,r,n){let i=n6(t,r,e,!1);return i==null?!1:i.equals(n)}Pt.verify=bB;function n6(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new Df.default(i.r),a=new Df.default(i.s);if(s.cmp(Gn.curve.n)>=0||a.cmp(Gn.curve.n)>=0||s.isZero()||a.isZero())return null;let o;try{o=Gn.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return H.Buffer.from(o.encode(null,n))}Pt.recover=n6;function nb(e){let t=H.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:i6(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:s6(r,t.subarray(1,33),t.subarray(33,65));default:return null}}Pt.loadPublicKey=nb;function gB(e){let t=new Df.default(Array.from(e));return t.cmp(Gn.curve.n)<0&&!t.isZero()}Pt.privateKeyVerify=gB;function vB(e){return nb(e)!==null}Pt.publicKeyVerify=vB;function yB(e,t){let r=Gn.keyFromPrivate(Array.from(e),"bytes").getPublic();return H.Buffer.from(r.encode(null,t))}Pt.publicKeyCreate=yB;function mB(e,t){let r=nb(e);if(r==null)return null;let n=Gn.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return H.Buffer.from(n.encode(null,t))}Pt.publicKeyConvert=mB;function i6(e,t){let r=new Df.default(Array.from(t));if(r.cmp(Gn.curve.p)>=0)return null;let n=r.toRed(Gn.curve.red),i=n.redSqr().redIMul(n).redIAdd(Gn.curve.b).redSqrt();return e===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}Pt.loadCompressedPublicKey=i6;function s6(e,t,r){let n=new Df.default(Array.from(t)),i=new Df.default(Array.from(r));if(n.cmp(Gn.curve.p)>=0||i.cmp(Gn.curve.p)>=0)return null;let s=n.toRed(Gn.curve.red),a=i.toRed(Gn.curve.red);if((e===6||e===7)&&a.isOdd()!==(e===7))return null;let o=s.redSqr().redIMul(s);return a.redSqr().redISub(o.redIAdd(Gn.curve.b)).isZero()?{x:s,y:a}:null}Pt.loadUncompressedPublicKey=s6});var ca=K(rt=>{D();N();Object.defineProperty(rt,"__esModule",{value:!0});rt.validateObject=rt.createHmacDrbg=rt.bitMask=rt.bitSet=rt.bitGet=rt.bitLen=rt.utf8ToBytes=rt.equalBytes=rt.concatBytes=rt.ensureBytes=rt.numberToVarBytesBE=rt.numberToBytesLE=rt.numberToBytesBE=rt.bytesToNumberLE=rt.bytesToNumberBE=rt.hexToBytes=rt.hexToNumber=rt.numberToHexUnpadded=rt.bytesToHex=void 0;var c6=BigInt(0),Kl=BigInt(1),wB=BigInt(2),Vl=e=>e instanceof Uint8Array,_B=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function sb(e){if(!Vl(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=_B[e[r]];return t}rt.bytesToHex=sb;function f6(e){let t=e.toString(16);return t.length&1?`0${t}`:t}rt.numberToHexUnpadded=f6;function ab(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}rt.hexToNumber=ab;function Ul(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");t[r]=s}return t}rt.hexToBytes=Ul;function SB(e){return ab(sb(e))}rt.bytesToNumberBE=SB;function xB(e){if(!Vl(e))throw new Error("Uint8Array expected");return ab(sb(Uint8Array.from(e).reverse()))}rt.bytesToNumberLE=xB;var EB=(e,t)=>Ul(e.toString(16).padStart(t*2,"0"));rt.numberToBytesBE=EB;var AB=(e,t)=>(0,rt.numberToBytesBE)(e,t).reverse();rt.numberToBytesLE=AB;var PB=e=>Ul(f6(e));rt.numberToVarBytesBE=PB;function CB(e,t,r){let n;if(typeof t=="string")try{n=Ul(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Vl(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}rt.ensureBytes=CB;function u6(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Vl(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}rt.concatBytes=u6;function IB(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}rt.equalBytes=IB;function BB(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}rt.utf8ToBytes=BB;function MB(e){let t;for(t=0;e>c6;e>>=Kl,t+=1);return t}rt.bitLen=MB;var TB=(e,t)=>e>>BigInt(t)&Kl;rt.bitGet=TB;var OB=(e,t,r)=>e|(r?Kl:c6)<<BigInt(t);rt.bitSet=OB;var DB=e=>(wB<<BigInt(e-1))-Kl;rt.bitMask=DB;var ib=e=>new Uint8Array(e),o6=e=>Uint8Array.from(e);function NB(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ib(e),i=ib(e),s=0,a=()=>{n.fill(1),i.fill(0),s=0},o=(...h)=>r(i,n,...h),c=(h=ib())=>{i=o(o6([0]),h),n=o(),h.length!==0&&(i=o(o6([1]),h),n=o())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,d=[];for(;h<t;){n=o();let l=n.slice();d.push(l),h+=n.length}return u6(...d)};return(h,d)=>{a(),c(h);let l;for(;!(l=d(u()));)c();return a(),l}}rt.createHmacDrbg=NB;var RB={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function FB(e,t,r={}){let n=(i,s,a)=>{let o=RB[s];if(typeof o!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=e[i];if(!(a&&c===void 0)&&!o(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}rt.validateObject=FB});var xc=K(ot=>{D();N();Object.defineProperty(ot,"__esModule",{value:!0});ot.hashToPrivateScalar=ot.FpSqrtEven=ot.FpSqrtOdd=ot.Field=ot.nLength=ot.FpIsSquare=ot.FpDiv=ot.FpInvertBatch=ot.FpPow=ot.validateField=ot.isNegativeLE=ot.FpSqrt=ot.tonelliShanks=ot.invert=ot.pow2=ot.pow=ot.mod=void 0;var fa=ca(),Dr=BigInt(0),Xt=BigInt(1),Za=BigInt(2),qB=BigInt(3),ob=BigInt(4),d6=BigInt(5),l6=BigInt(8),HB=BigInt(9),jB=BigInt(16);function Di(e,t){let r=e%t;return r>=Dr?r:t+r}ot.mod=Di;function h6(e,t,r){if(r<=Dr||t<Dr)throw new Error("Expected power/modulo > 0");if(r===Xt)return Dr;let n=Xt;for(;t>Dr;)t&Xt&&(n=n*e%r),e=e*e%r,t>>=Xt;return n}ot.pow=h6;function kB(e,t,r){let n=e;for(;t-- >Dr;)n*=n,n%=r;return n}ot.pow2=kB;function zl(e,t){if(e===Dr||t<=Dr)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=Di(e,t),n=t,i=Dr,s=Xt,a=Xt,o=Dr;for(;r!==Dr;){let u=n/r,b=n%r,h=i-a*u,d=s-o*u;n=r,r=b,i=a,s=o,a=h,o=d}if(n!==Xt)throw new Error("invert: does not exist");return Di(i,t)}ot.invert=zl;function p6(e){let t=(e-Xt)/Za,r,n,i;for(r=e-Xt,n=0;r%Za===Dr;r/=Za,n++);for(i=Za;i<e&&h6(i,t,e)!==e-Xt;i++);if(n===1){let a=(e+Xt)/ob;return function(c,u){let b=c.pow(u,a);if(!c.eql(c.sqr(b),u))throw new Error("Cannot find square root");return b}}let s=(r+Xt)/Za;return function(o,c){if(o.pow(c,t)===o.neg(o.ONE))throw new Error("Cannot find square root");let u=n,b=o.pow(o.mul(o.ONE,i),r),h=o.pow(c,s),d=o.pow(c,r);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let l=1;for(let p=o.sqr(d);l<u&&!o.eql(p,o.ONE);l++)p=o.sqr(p);let y=o.pow(b,Xt<<BigInt(u-l-1));b=o.sqr(y),h=o.mul(h,y),d=o.mul(d,b),u=l}return h}}ot.tonelliShanks=p6;function b6(e){if(e%ob===qB){let t=(e+Xt)/ob;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%l6===d6){let t=(e-d6)/l6;return function(n,i){let s=n.mul(i,Za),a=n.pow(s,t),o=n.mul(i,a),c=n.mul(n.mul(o,Za),a),u=n.mul(o,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%jB,p6(e)}ot.FpSqrt=b6;var LB=(e,t)=>(Di(e,t)&Xt)===Xt;ot.isNegativeLE=LB;var KB=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function VB(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=KB.reduce((n,i)=>(n[i]="function",n),t);return(0,fa.validateObject)(e,r)}ot.validateField=VB;function g6(e,t,r){if(r<Dr)throw new Error("Expected power > 0");if(r===Dr)return e.ONE;if(r===Xt)return t;let n=e.ONE,i=t;for(;r>Dr;)r&Xt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Xt;return n}ot.FpPow=g6;function v6(e,t){let r=new Array(t.length),n=t.reduce((s,a,o)=>e.is0(a)?s:(r[o]=s,e.mul(s,a)),e.ONE),i=e.inv(n);return t.reduceRight((s,a,o)=>e.is0(a)?s:(r[o]=e.mul(s,r[o]),e.mul(s,a)),i),r}ot.FpInvertBatch=v6;function UB(e,t,r){return e.mul(t,typeof r=="bigint"?zl(r,e.ORDER):e.inv(r))}ot.FpDiv=UB;function zB(e){let t=(e.ORDER-Xt)/Za;return r=>{let n=e.pow(r,t);return e.eql(n,e.ZERO)||e.eql(n,e.ONE)}}ot.FpIsSquare=zB;function cb(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}ot.nLength=cb;function $B(e,t,r=!1,n={}){if(e<=Dr)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=cb(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let a=b6(e),o=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:(0,fa.bitMask)(i),ZERO:Dr,ONE:Xt,create:c=>Di(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Dr<=c&&c<e},is0:c=>c===Dr,isOdd:c=>(c&Xt)===Xt,neg:c=>Di(-c,e),eql:(c,u)=>c===u,sqr:c=>Di(c*c,e),add:(c,u)=>Di(c+u,e),sub:(c,u)=>Di(c-u,e),mul:(c,u)=>Di(c*u,e),pow:(c,u)=>g6(o,c,u),div:(c,u)=>Di(c*zl(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>zl(c,e),sqrt:n.sqrt||(c=>a(o,c)),invertBatch:c=>v6(o,c),cmov:(c,u,b)=>b?u:c,toBytes:c=>r?(0,fa.numberToBytesLE)(c,s):(0,fa.numberToBytesBE)(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?(0,fa.bytesToNumberLE)(c):(0,fa.bytesToNumberBE)(c)}});return Object.freeze(o)}ot.Field=$B;function GB(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}ot.FpSqrtOdd=GB;function WB(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}ot.FpSqrtEven=WB;function XB(e,t,r=!1){e=(0,fa.ensureBytes)("privateHash",e);let n=e.length,i=cb(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,fa.bytesToNumberLE)(e):(0,fa.bytesToNumberBE)(e);return Di(s,t-Xt)+Xt}ot.hashToPrivateScalar=XB});var m6=K(Nf=>{D();N();Object.defineProperty(Nf,"__esModule",{value:!0});Nf.validateBasic=Nf.wNAF=void 0;var y6=xc(),YB=ca(),ZB=BigInt(0),fb=BigInt(1);function JB(e,t){let r=(i,s)=>{let a=s.negate();return i?a:s},n=i=>{let s=Math.ceil(t/i)+1,a=2**(i-1);return{windows:s,windowSize:a}};return{constTimeNegate:r,unsafeLadder(i,s){let a=e.ZERO,o=i;for(;s>ZB;)s&fb&&(a=a.add(o)),o=o.double(),s>>=fb;return a},precomputeWindow(i,s){let{windows:a,windowSize:o}=n(s),c=[],u=i,b=u;for(let h=0;h<a;h++){b=u,c.push(b);for(let d=1;d<o;d++)b=b.add(u),c.push(b);u=b.double()}return c},wNAF(i,s,a){let{windows:o,windowSize:c}=n(i),u=e.ZERO,b=e.BASE,h=BigInt(2**i-1),d=2**i,l=BigInt(i);for(let y=0;y<o;y++){let p=y*c,m=Number(a&h);a>>=l,m>c&&(m-=d,a+=fb);let w=p,C=p+Math.abs(m)-1,T=y%2!==0,q=m<0;m===0?b=b.add(r(T,s[w])):u=u.add(r(q,s[C]))}return{p:u,f:b}},wNAFCached(i,s,a,o){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,o(u))),this.wNAF(c,u,a)}}}Nf.wNAF=JB;function QB(e){return(0,y6.validateField)(e.Fp),(0,YB.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,y6.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}Nf.validateBasic=QB});var Gl=K(Yt=>{D();N();var eM=Yt&&Yt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),tM=Yt&&Yt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),_6=Yt&&Yt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&eM(t,e,r);return tM(t,e),t};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.mapToCurveSimpleSWU=Yt.SWUFpSqrtRatio=Yt.weierstrass=Yt.weierstrassPoints=Yt.DER=void 0;var jd=_6(xc()),Sr=_6(ca()),As=ca(),ub=m6();function rM(e){let t=(0,ub.validateBasic)(e);Sr.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:nM,hexToBytes:iM}=Sr;Yt.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=Yt.DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:nM(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=Yt.DER,r=typeof e=="string"?iM(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=Yt.DER._parseInt(r.subarray(2)),{d:a,l:o}=Yt.DER._parseInt(s);if(o.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:a}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let b=u.toString(16);return b.length&1?`0${b}`:b},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,a=i.length/2,o=r(s),c=r(a);return`30${r(a+s+4)}02${c}${i}02${o}${n}`}};var as=BigInt(0),dr=BigInt(1),Ja=BigInt(2),$l=BigInt(3),w6=BigInt(4);function S6(e){let t=rM(e),{Fp:r}=t,n=t.toBytes||((y,p,m)=>{let w=p.toAffine();return Sr.concatBytes(Uint8Array.from([4]),r.toBytes(w.x),r.toBytes(w.y))}),i=t.fromBytes||(y=>{let p=y.subarray(1),m=r.fromBytes(p.subarray(0,r.BYTES)),w=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:m,y:w}});function s(y){let{a:p,b:m}=t,w=r.sqr(y),C=r.mul(w,y);return r.add(r.add(C,r.mul(y,p)),m)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function a(y){return typeof y=="bigint"&&as<y&&y<t.n}function o(y){if(!a(y))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(y){let{allowedPrivateKeyLengths:p,nByteLength:m,wrapPrivateKey:w,n:C}=t;if(p&&typeof y!="bigint"){if(y instanceof Uint8Array&&(y=Sr.bytesToHex(y)),typeof y!="string"||!p.includes(y.length))throw new Error("Invalid key");y=y.padStart(m*2,"0")}let T;try{T=typeof y=="bigint"?y:Sr.bytesToNumberBE((0,As.ensureBytes)("private key",y,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof y}`)}return w&&(T=jd.mod(T,C)),o(T),T}let u=new Map;function b(y){if(!(y instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,m,w){if(this.px=p,this.py=m,this.pz=w,p==null||!r.isValid(p))throw new Error("x required");if(m==null||!r.isValid(m))throw new Error("y required");if(w==null||!r.isValid(w))throw new Error("z required")}static fromAffine(p){let{x:m,y:w}=p||{};if(!p||!r.isValid(m)||!r.isValid(w))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let C=T=>r.eql(T,r.ZERO);return C(m)&&C(w)?h.ZERO:new h(m,w,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let m=r.invertBatch(p.map(w=>w.pz));return p.map((w,C)=>w.toAffine(m[C])).map(h.fromAffine)}static fromHex(p){let m=h.fromAffine(i((0,As.ensureBytes)("pointHex",p)));return m.assertValidity(),m}static fromPrivateKey(p){return h.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:p,y:m}=this.toAffine();if(!r.isValid(p)||!r.isValid(m))throw new Error("bad point: x or y not FE");let w=r.sqr(m),C=s(p);if(!r.eql(w,C))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){b(p);let{px:m,py:w,pz:C}=this,{px:T,py:q,pz:F}=p,j=r.eql(r.mul(m,F),r.mul(T,C)),k=r.eql(r.mul(w,F),r.mul(q,C));return j&&k}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:m}=t,w=r.mul(m,$l),{px:C,py:T,pz:q}=this,F=r.ZERO,j=r.ZERO,k=r.ZERO,I=r.mul(C,C),R=r.mul(T,T),A=r.mul(q,q),f=r.mul(C,T);return f=r.add(f,f),k=r.mul(C,q),k=r.add(k,k),F=r.mul(p,k),j=r.mul(w,A),j=r.add(F,j),F=r.sub(R,j),j=r.add(R,j),j=r.mul(F,j),F=r.mul(f,F),k=r.mul(w,k),A=r.mul(p,A),f=r.sub(I,A),f=r.mul(p,f),f=r.add(f,k),k=r.add(I,I),I=r.add(k,I),I=r.add(I,A),I=r.mul(I,f),j=r.add(j,I),A=r.mul(T,q),A=r.add(A,A),I=r.mul(A,f),F=r.sub(F,I),k=r.mul(A,R),k=r.add(k,k),k=r.add(k,k),new h(F,j,k)}add(p){b(p);let{px:m,py:w,pz:C}=this,{px:T,py:q,pz:F}=p,j=r.ZERO,k=r.ZERO,I=r.ZERO,R=t.a,A=r.mul(t.b,$l),f=r.mul(m,T),g=r.mul(w,q),E=r.mul(C,F),x=r.add(m,w),S=r.add(T,q);x=r.mul(x,S),S=r.add(f,g),x=r.sub(x,S),S=r.add(m,C);let P=r.add(T,F);return S=r.mul(S,P),P=r.add(f,E),S=r.sub(S,P),P=r.add(w,C),j=r.add(q,F),P=r.mul(P,j),j=r.add(g,E),P=r.sub(P,j),I=r.mul(R,S),j=r.mul(A,E),I=r.add(j,I),j=r.sub(g,I),I=r.add(g,I),k=r.mul(j,I),g=r.add(f,f),g=r.add(g,f),E=r.mul(R,E),S=r.mul(A,S),g=r.add(g,E),E=r.sub(f,E),E=r.mul(R,E),S=r.add(S,E),f=r.mul(g,S),k=r.add(k,f),f=r.mul(P,S),j=r.mul(x,j),j=r.sub(j,f),f=r.mul(x,g),I=r.mul(P,I),I=r.add(I,f),new h(j,k,I)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return l.wNAFCached(this,u,p,m=>{let w=r.invertBatch(m.map(C=>C.pz));return m.map((C,T)=>C.toAffine(w[T])).map(h.fromAffine)})}multiplyUnsafe(p){let m=h.ZERO;if(p===as)return m;if(o(p),p===dr)return this;let{endo:w}=t;if(!w)return l.unsafeLadder(this,p);let{k1neg:C,k1:T,k2neg:q,k2:F}=w.splitScalar(p),j=m,k=m,I=this;for(;T>as||F>as;)T&dr&&(j=j.add(I)),F&dr&&(k=k.add(I)),I=I.double(),T>>=dr,F>>=dr;return C&&(j=j.negate()),q&&(k=k.negate()),k=new h(r.mul(k.px,w.beta),k.py,k.pz),j.add(k)}multiply(p){o(p);let m=p,w,C,{endo:T}=t;if(T){let{k1neg:q,k1:F,k2neg:j,k2:k}=T.splitScalar(m),{p:I,f:R}=this.wNAF(F),{p:A,f}=this.wNAF(k);I=l.constTimeNegate(q,I),A=l.constTimeNegate(j,A),A=new h(r.mul(A.px,T.beta),A.py,A.pz),w=I.add(A),C=R.add(f)}else{let{p:q,f:F}=this.wNAF(m);w=q,C=F}return h.normalizeZ([w,C])[0]}multiplyAndAddUnsafe(p,m,w){let C=h.BASE,T=(F,j)=>j===as||j===dr||!F.equals(C)?F.multiplyUnsafe(j):F.multiply(j),q=T(this,m).add(T(p,w));return q.is0()?void 0:q}toAffine(p){let{px:m,py:w,pz:C}=this,T=this.is0();p==null&&(p=T?r.ONE:r.inv(C));let q=r.mul(m,p),F=r.mul(w,p),j=r.mul(C,p);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(j,r.ONE))throw new Error("invZ was invalid");return{x:q,y:F}}isTorsionFree(){let{h:p,isTorsionFree:m}=t;if(p===dr)return!0;if(m)return m(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:m}=t;return p===dr?this:m?m(h,this):this.multiplyUnsafe(t.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return Sr.bytesToHex(this.toRawBytes(p))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let d=t.nBitLength,l=(0,ub.wNAF)(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:a}}Yt.weierstrassPoints=S6;function sM(e){let t=(0,ub.validateBasic)(e);return Sr.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function aM(e){let t=sM(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function a(S){return as<S&&S<r.ORDER}function o(S){return jd.mod(S,n)}function c(S){return jd.invert(S,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:b,weierstrassEquation:h,isWithinCurveOrder:d}=S6({...t,toBytes(S,P,O){let B=P.toAffine(),v=r.toBytes(B.x),M=Sr.concatBytes;return O?M(Uint8Array.from([P.hasEvenY()?2:3]),v):M(Uint8Array.from([4]),v,r.toBytes(B.y))},fromBytes(S){let P=S.length,O=S[0],B=S.subarray(1);if(P===i&&(O===2||O===3)){let v=Sr.bytesToNumberBE(B);if(!a(v))throw new Error("Point is not on curve");let M=h(v),V=r.sqrt(M),z=(V&dr)===dr;return(O&1)===1!==z&&(V=r.neg(V)),{x:v,y:V}}else if(P===s&&O===4){let v=r.fromBytes(B.subarray(0,r.BYTES)),M=r.fromBytes(B.subarray(r.BYTES,2*r.BYTES));return{x:v,y:M}}else throw new Error(`Point of length ${P} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),l=S=>Sr.bytesToHex(Sr.numberToBytesBE(S,t.nByteLength));function y(S){let P=n>>dr;return S>P}function p(S){return y(S)?o(-S):S}let m=(S,P,O)=>Sr.bytesToNumberBE(S.slice(P,O));class w{constructor(P,O,B){this.r=P,this.s=O,this.recovery=B,this.assertValidity()}static fromCompact(P){let O=t.nByteLength;return P=(0,As.ensureBytes)("compactSignature",P,O*2),new w(m(P,0,O),m(P,O,2*O))}static fromDER(P){let{r:O,s:B}=Yt.DER.toSig((0,As.ensureBytes)("DER",P));return new w(O,B)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(P){return new w(this.r,this.s,P)}recoverPublicKey(P){let{r:O,s:B,recovery:v}=this,M=k((0,As.ensureBytes)("msgHash",P));if(v==null||![0,1,2,3].includes(v))throw new Error("recovery id invalid");let V=v===2||v===3?O+t.n:O;if(V>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let z=(v&1)===0?"02":"03",$=u.fromHex(z+l(V)),G=c(V),Q=o(-M*G),re=o(B*G),me=u.BASE.multiplyAndAddUnsafe($,Q,re);if(!me)throw new Error("point at infinify");return me.assertValidity(),me}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Sr.hexToBytes(this.toDERHex())}toDERHex(){return Yt.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Sr.hexToBytes(this.toCompactHex())}toCompactHex(){return l(this.r)+l(this.s)}}let C={isValidPrivateKey(S){try{return b(S),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{let S=t.randomBytes(r.BYTES+8),P=jd.hashToPrivateScalar(S,n);return Sr.numberToBytesBE(P,t.nByteLength)},precompute(S=8,P=u.BASE){return P._setWindowSize(S),P.multiply(BigInt(3)),P}};function T(S,P=!0){return u.fromPrivateKey(S).toRawBytes(P)}function q(S){let P=S instanceof Uint8Array,O=typeof S=="string",B=(P||O)&&S.length;return P?B===i||B===s:O?B===2*i||B===2*s:S instanceof u}function F(S,P,O=!0){if(q(S))throw new Error("first arg must be private key");if(!q(P))throw new Error("second arg must be public key");return u.fromHex(P).multiply(b(S)).toRawBytes(O)}let j=t.bits2int||function(S){let P=Sr.bytesToNumberBE(S),O=S.length*8-t.nBitLength;return O>0?P>>BigInt(O):P},k=t.bits2int_modN||function(S){return o(j(S))},I=Sr.bitMask(t.nBitLength);function R(S){if(typeof S!="bigint")throw new Error("bigint expected");if(!(as<=S&&S<I))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Sr.numberToBytesBE(S,t.nByteLength)}function A(S,P,O=f){if(["recovered","canonical"].some(te=>te in O))throw new Error("sign() legacy options not supported");let{hash:B,randomBytes:v}=t,{lowS:M,prehash:V,extraEntropy:z}=O;M==null&&(M=!0),S=(0,As.ensureBytes)("msgHash",S),V&&(S=(0,As.ensureBytes)("prehashed msgHash",B(S)));let $=k(S),G=b(P),Q=[R(G),R($)];if(z!=null){let te=z===!0?v(r.BYTES):z;Q.push((0,As.ensureBytes)("extraEntropy",te,r.BYTES))}let re=Sr.concatBytes(...Q),me=$;function ne(te){let _e=j(te);if(!d(_e))return;let ce=c(_e),J=u.BASE.multiply(_e).toAffine(),De=o(J.x);if(De===as)return;let fe=o(ce*o(me+De*G));if(fe===as)return;let ie=(J.x===De?0:2)|Number(J.y&dr),qt=fe;return M&&y(fe)&&(qt=p(fe),ie^=1),new w(De,qt,ie)}return{seed:re,k2sig:ne}}let f={lowS:t.lowS,prehash:!1},g={lowS:t.lowS,prehash:!1};function E(S,P,O=f){let{seed:B,k2sig:v}=A(S,P,O),M=t;return Sr.createHmacDrbg(M.hash.outputLen,M.nByteLength,M.hmac)(B,v)}u.BASE._setWindowSize(8);function x(S,P,O,B=g){let v=S;if(P=(0,As.ensureBytes)("msgHash",P),O=(0,As.ensureBytes)("publicKey",O),"strict"in B)throw new Error("options.strict was renamed to lowS");let{lowS:M,prehash:V}=B,z,$;try{if(typeof v=="string"||v instanceof Uint8Array)try{z=w.fromDER(v)}catch(J){if(!(J instanceof Yt.DER.Err))throw J;z=w.fromCompact(v)}else if(typeof v=="object"&&typeof v.r=="bigint"&&typeof v.s=="bigint"){let{r:J,s:De}=v;z=new w(J,De)}else throw new Error("PARSE");$=u.fromHex(O)}catch(J){if(J.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(M&&z.hasHighS())return!1;V&&(P=t.hash(P));let{r:G,s:Q}=z,re=k(P),me=c(Q),ne=o(re*me),te=o(G*me),_e=u.BASE.multiplyAndAddUnsafe($,ne,te)?.toAffine();return _e?o(_e.x)===G:!1}return{CURVE:t,getPublicKey:T,getSharedSecret:F,sign:E,verify:x,ProjectivePoint:u,Signature:w,utils:C}}Yt.weierstrass=aM;function x6(e,t){let r=e.ORDER,n=as;for(let y=r-dr;y%Ja===as;y/=Ja)n+=dr;let i=n,s=Ja<<i-dr-dr,a=s*Ja,o=(r-dr)/a,c=(o-dr)/Ja,u=a-dr,b=s,h=e.pow(t,o),d=e.pow(t,(o+dr)/Ja),l=(y,p)=>{let m=h,w=e.pow(p,u),C=e.sqr(w);C=e.mul(C,p);let T=e.mul(y,C);T=e.pow(T,c),T=e.mul(T,w),w=e.mul(T,p),C=e.mul(T,y);let q=e.mul(C,w);T=e.pow(q,b);let F=e.eql(T,e.ONE);w=e.mul(C,d),T=e.mul(q,m),C=e.cmov(w,C,F),q=e.cmov(T,q,F);for(let j=i;j>dr;j--){let k=j-Ja;k=Ja<<k-dr;let I=e.pow(q,k),R=e.eql(I,e.ONE);w=e.mul(C,m),m=e.mul(m,m),I=e.mul(q,m),C=e.cmov(w,C,R),q=e.cmov(I,q,R)}return{isValid:F,value:C}};if(e.ORDER%w6===$l){let y=(e.ORDER-$l)/w6,p=e.sqrt(e.neg(t));l=(m,w)=>{let C=e.sqr(w),T=e.mul(m,w);C=e.mul(C,T);let q=e.pow(C,y);q=e.mul(q,T);let F=e.mul(q,p),j=e.mul(e.sqr(q),w),k=e.eql(j,m),I=e.cmov(F,q,k);return{isValid:k,value:I}}}return l}Yt.SWUFpSqrtRatio=x6;function oM(e,t){if(jd.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=x6(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,a,o,c,u,b,h;i=e.sqr(n),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),a=e.add(s,e.ONE),a=e.mul(a,t.B),o=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),o=e.mul(o,t.A),s=e.sqr(a),u=e.sqr(o),c=e.mul(u,t.A),s=e.add(s,c),s=e.mul(s,a),u=e.mul(u,o),c=e.mul(u,t.B),s=e.add(s,c),b=e.mul(i,a);let{isValid:d,value:l}=r(s,u);h=e.mul(i,n),h=e.mul(h,l),b=e.cmov(b,a,d),h=e.cmov(h,l,d);let y=e.isOdd(n)===e.isOdd(h);return h=e.cmov(e.neg(h),h,y),b=e.div(b,o),{x:b,y:h}}}Yt.mapToCurveSimpleSWU=oM});var I6=K(lr=>{D();N();Object.defineProperty(lr,"__esModule",{value:!0});lr.createHasher=lr.isogenyMap=lr.hash_to_field=lr.expand_message_xof=lr.expand_message_xmd=lr.isNum=lr.isBytes=lr.strxor=lr.i2osp=lr.validateDST=void 0;var cM=xc(),os=ca();function E6(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,os.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}lr.validateDST=E6;var fM=os.bytesToNumberBE;function ua(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}lr.i2osp=ua;function A6(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}lr.strxor=A6;function Rf(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected")}lr.isBytes=Rf;function Wl(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}lr.isNum=Wl;function P6(e,t,r,n){Rf(e),Rf(t),Wl(r),t.length>255&&(t=n((0,os.concatBytes)((0,os.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:s}=n,a=Math.ceil(r/i);if(a>255)throw new Error("Invalid xmd length");let o=(0,os.concatBytes)(t,ua(t.length,1)),c=ua(0,s),u=ua(r,2),b=new Array(a),h=n((0,os.concatBytes)(c,e,u,ua(0,1),o));b[0]=n((0,os.concatBytes)(h,ua(1,1),o));for(let l=1;l<=a;l++){let y=[A6(h,b[l-1]),ua(l+1,1),o];b[l]=n((0,os.concatBytes)(...y))}return(0,os.concatBytes)(...b).slice(0,r)}lr.expand_message_xmd=P6;function C6(e,t,r,n,i){if(Rf(e),Rf(t),Wl(r),t.length>255){let s=Math.ceil(2*n/8);t=i.create({dkLen:s}).update((0,os.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(ua(r,2)).update(t).update(ua(t.length,1)).digest()}lr.expand_message_xof=C6;function db(e,t,r){(0,os.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:a,expand:o,DST:c}=r;Rf(e),Wl(t);let u=E6(c),b=n.toString(2).length,h=Math.ceil((b+i)/8),d=t*s*h,l;if(o==="xmd")l=P6(e,u,d,a);else if(o==="xof")l=C6(e,u,d,i,a);else if(o==="_internal_pass")l=e;else throw new Error('expand must be "xmd" or "xof"');let y=new Array(t);for(let p=0;p<t;p++){let m=new Array(s);for(let w=0;w<s;w++){let C=h*(w+p*s),T=l.subarray(C,C+h);m[w]=(0,cM.mod)(fM(T),n)}y[p]=m}return y}lr.hash_to_field=db;function uM(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,a,o,c]=r.map(u=>u.reduce((b,h)=>e.add(e.mul(b,n),h)));return n=e.div(s,a),i=e.mul(i,e.div(o,c)),{x:n,y:i}}}lr.isogenyMap=uM;function dM(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=db(n,2,{...r,DST:r.DST,...i}),a=e.fromAffine(t(s[0])),o=e.fromAffine(t(s[1])),c=a.add(o).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,i){let s=db(n,1,{...r,DST:r.encodeDST,...i}),a=e.fromAffine(t(s[0])).clearCofactor();return a.assertValidity(),a}}}lr.createHasher=dM});var lb=K(Ff=>{D();N();Object.defineProperty(Ff,"__esModule",{value:!0});Ff.createCurve=Ff.getHash=void 0;var lM=Bd(),B6=un(),hM=Gl();function M6(e){return{hash:e,hmac:(t,...r)=>(0,lM.hmac)(e,t,(0,B6.concatBytes)(...r)),randomBytes:B6.randomBytes}}Ff.getHash=M6;function pM(e,t){let r=n=>(0,hM.weierstrass)({...e,...M6(n)});return Object.freeze({...r(t),create:r})}Ff.createCurve=pM});var k6=K(xr=>{D();N();var bM=xr&&xr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),gM=xr&&xr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),vM=xr&&xr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&bM(t,e,r);return gM(t,e),t},hb;Object.defineProperty(xr,"__esModule",{value:!0});xr.encodeToCurve=xr.hashToCurve=xr.schnorr=xr.secp256k1=void 0;var Xl=df(),yM=un(),Wr=xc(),mM=Gl(),Pn=ca(),D6=vM(I6()),wM=lb(),Ql=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Yl=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),N6=BigInt(1),Zl=BigInt(2),T6=(e,t)=>(e+t/Zl)/t;function R6(e){let t=Ql,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=e*e*e%t,b=u*u*e%t,h=(0,Wr.pow2)(b,r,t)*b%t,d=(0,Wr.pow2)(h,r,t)*b%t,l=(0,Wr.pow2)(d,Zl,t)*u%t,y=(0,Wr.pow2)(l,i,t)*l%t,p=(0,Wr.pow2)(y,s,t)*y%t,m=(0,Wr.pow2)(p,o,t)*p%t,w=(0,Wr.pow2)(m,c,t)*m%t,C=(0,Wr.pow2)(w,o,t)*p%t,T=(0,Wr.pow2)(C,r,t)*b%t,q=(0,Wr.pow2)(T,a,t)*y%t,F=(0,Wr.pow2)(q,n,t)*u%t,j=(0,Wr.pow2)(F,Zl,t);if(!Qa.eql(Qa.sqr(j),e))throw new Error("Cannot find square root");return j}var Qa=(0,Wr.Field)(Ql,void 0,void 0,{sqrt:R6});xr.secp256k1=(0,wM.createCurve)({a:BigInt(0),b:BigInt(7),Fp:Qa,n:Yl,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=Yl,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-N6*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=T6(s*e,t),c=T6(-n*e,t),u=(0,Wr.mod)(e-o*r-c*i,t),b=(0,Wr.mod)(-o*n-c*s,t),h=u>a,d=b>a;if(h&&(u=t-u),d&&(b=t-b),u>a||b>a)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:d,k2:b}}}},Xl.sha256);var eh=BigInt(0),F6=e=>typeof e=="bigint"&&eh<e&&e<Ql,_M=e=>typeof e=="bigint"&&eh<e&&e<Yl,O6={};function Jl(e,...t){let r=O6[e];if(r===void 0){let n=(0,Xl.sha256)(Uint8Array.from(e,i=>i.charCodeAt(0)));r=(0,Pn.concatBytes)(n,n),O6[e]=r}return(0,Xl.sha256)((0,Pn.concatBytes)(r,...t))}var vb=e=>e.toRawBytes(!0).slice(1),bb=e=>(0,Pn.numberToBytesBE)(e,32),pb=e=>(0,Wr.mod)(e,Ql),kd=e=>(0,Wr.mod)(e,Yl),yb=xr.secp256k1.ProjectivePoint,SM=(e,t,r)=>yb.BASE.multiplyAndAddUnsafe(e,t,r);function gb(e){let t=xr.secp256k1.utils.normPrivateKeyToScalar(e),r=yb.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:kd(-t),bytes:vb(r)}}function q6(e){if(!F6(e))throw new Error("bad x: need 0 < x < p");let t=pb(e*e),r=pb(t*e+BigInt(7)),n=R6(r);n%Zl!==eh&&(n=pb(-n));let i=new yb(e,n,N6);return i.assertValidity(),i}function H6(...e){return kd((0,Pn.bytesToNumberBE)(Jl("BIP0340/challenge",...e)))}function xM(e){return gb(e).bytes}function EM(e,t,r=(0,yM.randomBytes)(32)){let n=(0,Pn.ensureBytes)("message",e),{bytes:i,scalar:s}=gb(t),a=(0,Pn.ensureBytes)("auxRand",r,32),o=bb(s^(0,Pn.bytesToNumberBE)(Jl("BIP0340/aux",a))),c=Jl("BIP0340/nonce",o,i,n),u=kd((0,Pn.bytesToNumberBE)(c));if(u===eh)throw new Error("sign failed: k is zero");let{bytes:b,scalar:h}=gb(u),d=H6(b,i,n),l=new Uint8Array(64);if(l.set(b,0),l.set(bb(kd(h+d*s)),32),!j6(l,n,i))throw new Error("sign: Invalid signature produced");return l}function j6(e,t,r){let n=(0,Pn.ensureBytes)("signature",e,64),i=(0,Pn.ensureBytes)("message",t),s=(0,Pn.ensureBytes)("publicKey",r,32);try{let a=q6((0,Pn.bytesToNumberBE)(s)),o=(0,Pn.bytesToNumberBE)(n.subarray(0,32));if(!F6(o))return!1;let c=(0,Pn.bytesToNumberBE)(n.subarray(32,64));if(!_M(c))return!1;let u=H6(bb(o),vb(a),i),b=SM(a,c,kd(-u));return!(!b||!b.hasEvenY()||b.toAffine().x!==o)}catch{return!1}}xr.schnorr={getPublicKey:xM,sign:EM,verify:j6,utils:{randomPrivateKey:xr.secp256k1.utils.randomPrivateKey,lift_x:q6,pointToBytes:vb,numberToBytesBE:Pn.numberToBytesBE,bytesToNumberBE:Pn.bytesToNumberBE,taggedHash:Jl,mod:Wr.mod}};var AM=D6.isogenyMap(Qa,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),PM=(0,mM.mapToCurveSimpleSWU)(Qa,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Qa.create(BigInt("-11"))});hb=D6.createHasher(xr.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=PM(Qa.create(e[0]));return AM(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Qa.ORDER,m:1,k:128,expand:"xmd",hash:Xl.sha256}),xr.hashToCurve=hb.hashToCurve,xr.encodeToCurve=hb.encodeToCurve});var V6=K(eo=>{D();N();Object.defineProperty(eo,"__esModule",{value:!0});eo.poseidon=eo.splitConstants=eo.validateOpts=void 0;var L6=xc();function K6(e){let{Fp:t}=e;(0,L6.validateField)(t);for(let c of["t","roundsFull","roundsPartial"])if(typeof e[c]!="number"||!Number.isSafeInteger(e[c]))throw new Error(`Poseidon: invalid param ${c}=${e[c]} (${typeof e[c]})`);if(e.reversePartialPowIdx!==void 0&&typeof e.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${e.reversePartialPowIdx}`);let r=e.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=c=>(0,L6.FpPow)(t,c,n);if(r===3?i=c=>t.mul(t.sqrN(c),c):r===5&&(i=c=>t.mul(t.sqrN(t.sqrN(c)),c)),e.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${e.roundsFull}`);let s=e.roundsFull+e.roundsPartial;if(!Array.isArray(e.roundConstants)||e.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let a=e.roundConstants.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon wrong round constants: ${c}`);return c.map(u=>{if(typeof u!="bigint"||!t.isValid(u))throw new Error(`Poseidon wrong round constant=${u}`);return t.create(u)})});if(!Array.isArray(e.mds)||e.mds.length!==e.t)throw new Error("Poseidon: wrong MDS matrix");let o=e.mds.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon MDS matrix row: ${c}`);return c.map(u=>{if(typeof u!="bigint")throw new Error(`Poseidon MDS matrix value=${u}`);return t.create(u)})});return Object.freeze({...e,rounds:s,sboxFn:i,roundConstants:a,mds:o})}eo.validateOpts=K6;function CM(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<e.length;i++)n.push(e[i]),n.length===t&&(r.push(n),n=[]);return r}eo.splitConstants=CM;function IM(e){let{t,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=K6(e),a=Math.floor(e.roundsFull/2),o=s?t-1:0,c=(b,h,d)=>(b=b.map((l,y)=>r.add(l,e.roundConstants[d][y])),h?b=b.map(l=>i(l)):b[o]=i(b[o]),b=e.mds.map(l=>l.reduce((y,p,m)=>r.add(y,r.mulN(p,b[m])),r.ZERO)),b),u=function(h){if(!Array.isArray(h)||h.length!==t)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${t})`);h=h.map(l=>{if(typeof l!="bigint")throw new Error(`Poseidon: wrong value=${l} (${typeof l})`);return r.create(l)});let d=0;for(let l=0;l<a;l++)h=c(h,!0,d++);for(let l=0;l<e.roundsPartial;l++)h=c(h,!1,d++);for(let l=0;l<a;l++)h=c(h,!0,d++);if(d!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${d}, total=${n}`);return h};return u.roundConstants=e.roundConstants,u}eo.poseidon=IM});var r4=K(de=>{D();N();var BM=de&&de.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),MM=de&&de.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),TM=de&&de.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&BM(t,e,r);return MM(t,e),t};Object.defineProperty(de,"__esModule",{value:!0});de.poseidonHashMany=de.poseidonHashSingle=de.poseidonHashFunc=de.poseidonHash=de.poseidonSmall=de.poseidonCreate=de.poseidonBasic=de._poseidonMDS=de.Fp251=de.Fp253=de.keccak=de.computeHashOnElements=de.hashChain=de.pedersen=de.getAccountPath=de.ethSigToPrivate=de.getStarkKey=de.grindKey=de.utils=de.Signature=de.ProjectivePoint=de.CURVE=de.verify=de.sign=de.getSharedSecret=de.getPublicKey=de._starkCurve=void 0;var OM=hl(),_b=df(),DM=un(),Ac=xc(),NM=V6(),RM=Gl(),Cn=TM(ca()),FM=lb(),rh=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),$6=252;function U6(e){for(;e[0]===0;)e=e.subarray(1);let t=e.length*8-$6,r=Cn.bytesToNumberBE(e);return t>0?r>>BigInt(t):r}function G6(e){return typeof e=="string"&&(e=xb(e),e.length&1&&(e="0"+e)),Cn.hexToBytes(e)}var Pc=(0,RM.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,Ac.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:rh,nBitLength:$6,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,FM.getHash)(_b.sha256),bits2int:U6,bits2int_modN:e=>{let t=Cn.bytesToNumberBE(e).toString(16);return t.length===63&&(e=G6(t+"0")),(0,Ac.mod)(U6(e),rh)}});de._starkCurve=Pc;function Ec(e){return Cn.ensureBytes("",typeof e=="string"?G6(e):e)}function Sb(e){return Cn.bytesToHex(Ec(e)).padStart(64,"0")}function W6(e,t=!1){return Pc.getPublicKey(Sb(e),t)}de.getPublicKey=W6;function qM(e,t){return Pc.getSharedSecret(Sb(e),t)}de.getSharedSecret=qM;function HM(e,t,r){return Pc.sign(Ec(e),Sb(t),r)}de.sign=HM;function jM(e,t,r){let n=e instanceof X6?e:Ec(e);return Pc.verify(n,Ec(t),Ec(r))}de.verify=jM;var{CURVE:kM,ProjectivePoint:qf,Signature:X6,utils:LM}=Pc;de.CURVE=kM;de.ProjectivePoint=qf;de.Signature=X6;de.utils=LM;function Y6(e){return`0x${Cn.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function xb(e){return e.replace(/^0x/i,"")}function KM(e){return`0x${e.toString(16)}`}function Z6(e){let t=Ec(e),r=2n**256n,n=r-(0,Ac.mod)(r,rh);for(let i=0;;i++){let s=mb(Cn.concatBytes(t,Cn.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,Ac.mod)(s,rh).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}de.grindKey=Z6;function VM(e){return Y6(W6(e,!0))}de.getStarkKey=VM;function UM(e){if(e=xb(e),e.length!==130)throw new Error("Wrong ethereum signature");return Z6(e.substring(0,64))}de.ethSigToPrivate=UM;var zM=2n**31n-1n,th=e=>Number(e&zM);function $M(e,t,r,n){let i=th(mb(e)),s=th(mb(t)),a=Cn.hexToNumber(xb(r));return`m/2645'/${i}'/${s}'/${th(a)}'/${th(a>>31n)}'/${n}`}de.getAccountPath=$M;var Ld=[new qf(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new qf(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new qf(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new qf(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new qf(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function J6(e,t){let r=[],n=e;for(let i=0;i<248;i++)r.push(n),n=n.double();n=t;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var GM=J6(Ld[1],Ld[2]),WM=J6(Ld[3],Ld[4]);function Q6(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=Cn.bytesToNumberBE(Ec(e));if(!(0n<=t&&t<Pc.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function z6(e,t,r){let n=Q6(t);for(let i=0;i<252;i++){let s=r[i];if(s.equals(e))throw new Error("Same point");(n&1n)!==0n&&(e=e.add(s)),n>>=1n}return e}function Eb(e,t){let r=Ld[0];return r=z6(r,e,GM),r=z6(r,t,WM),Y6(r.toRawBytes(!0))}de.pedersen=Eb;function XM(e,t=Eb){if(!Array.isArray(e)||e.length<1)throw new Error("data should be array of at least 1 element");return e.length===1?KM(Q6(e[0])):Array.from(e).reverse().reduce((r,n)=>t(n,r))}de.hashChain=XM;var YM=(e,t=Eb)=>[0,...e,e.length].reduce((r,n)=>t(r,n));de.computeHashOnElements=YM;var ZM=Cn.bitMask(250),JM=e=>Cn.bytesToNumberBE((0,OM.keccak_256)(e))&ZM;de.keccak=JM;var mb=e=>Cn.bytesToNumberBE((0,_b.sha256)(e));de.Fp253=(0,Ac.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));de.Fp251=(0,Ac.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function wb(e,t,r){let n=e.fromBytes((0,_b.sha256)((0,DM.utf8ToBytes)(`${t}${r}`)));return e.create(n)}function e4(e,t,r,n=0){let i=[],s=[];for(let a=0;a<r;a++)i.push(wb(e,`${t}x`,n*r+a)),s.push(wb(e,`${t}y`,n*r+a));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(a=>s.map(o=>e.inv(e.sub(a,o))))}de._poseidonMDS=e4;var QM=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function Ab(e,t){if((0,Ac.validateField)(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);let r=e.rate+e.capacity,n=e.roundsFull+e.roundsPartial,i=[];for(let a=0;a<n;a++){let o=[];for(let c=0;c<r;c++)o.push(wb(e.Fp,"Hades",r*a+c));i.push(o)}let s=(0,NM.poseidon)({...e,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:i});return s.m=r,s.rate=e.rate,s.capacity=e.capacity,s}de.poseidonBasic=Ab;function eT(e,t=0){let r=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return Ab(e,e4(e.Fp,"HadesMDS",r,t))}de.poseidonCreate=eT;de.poseidonSmall=Ab({Fp:de.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},QM);function t4(e,t,r=de.poseidonSmall){return r([e,t,2n])[0]}de.poseidonHash=t4;function tT(e,t,r=de.poseidonSmall){return Cn.numberToVarBytesBE(t4(Cn.bytesToNumberBE(e),Cn.bytesToNumberBE(t),r))}de.poseidonHashFunc=tT;function rT(e,t=de.poseidonSmall){return t([e,0n,1n])[0]}de.poseidonHashSingle=rT;function nT(e,t=de.poseidonSmall){let{m:r,rate:n}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");let i=Array.from(e);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let a=0;a<i.length;a+=n){for(let o=0;o<n;o++)s[o]+=i[a+o];s=t(s)}return s[0]}de.poseidonHashMany=nT});var s4=K(In=>{D();N();var iT=In&&In.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),sT=In&&In.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n4=In&&In.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&iT(t,e,r);return sT(t,e),t};Object.defineProperty(In,"__esModule",{value:!0});In.bytesToHex=In.hexToBytes=In.stark=In.secp256k1=void 0;In.secp256k1=n4(k6());In.stark=n4(r4());var i4=ca();Object.defineProperty(In,"hexToBytes",{enumerable:!0,get:function(){return i4.hexToBytes}});Object.defineProperty(In,"bytesToHex",{enumerable:!0,get:function(){return i4.bytesToHex}})});var a4=K(Bn=>{D();N();var aT=Bn&&Bn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),oT=Bn&&Bn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),nh=Bn&&Bn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&aT(t,e,r);return oT(t,e),t};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.schnorr=Bn.p256=Bn.ed25519=Bn.secp256k1=void 0;Bn.secp256k1=nh(G5());Bn.ed25519=nh(r6());Bn.p256=nh(a6());Bn.schnorr=nh(s4())});var da=K(Er=>{D();N();var cT=Er&&Er.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),fT=Er&&Er.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Hf=Er&&Er.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&cT(t,e,r);return fT(t,e),t};Object.defineProperty(Er,"__esModule",{value:!0});Er.secp256k1=Er.ed25519=Er.signUtil=Er.elliptic=Er.bip39=Er.bip32=void 0;Er.bip32=Hf(I5());Er.bip39=Hf(tb());Er.elliptic=Hf(Mf());Er.signUtil=Hf(a4());Er.ed25519=Hf(rl());Er.secp256k1=Hf(Im())});var ih=K(ge=>{D();N();Object.defineProperty(ge,"__esModule",{value:!0});ge.estimateFee=ge.validSignedTransaction=ge.getRawTransaction=ge.hardwareDerivePubKey=ge.calcTxHash=ge.getHardWareMessageHash=ge.getHardWareSignedTransaction=ge.getHardWareRawTransaction=ge.getMPCSignedMessage=ge.getMPCRawMessage=ge.getMPCTransaction=ge.getMPCRawTransaction=ge.getAddressByPublicKey=ge.getDerivedPath=ge.signTransaction=ge.ecRecover=ge.verifyMessage=ge.signMessage=ge.validPrivateKey=ge.validAddress=ge.getNewAddress=ge.getDerivedPrivateKey=ge.getRandomPrivateKey=ge.getMnemonic=ge.unRegister=ge.register=void 0;var Tt=ar(),o4=da(),ir=new Map;function uT(e,t){ir.set(e,t)}ge.register=uT;function dT(e,t){ir.delete(e)}ge.unRegister=dT;async function lT(e){try{let t=o4.bip39.generateMnemonic(e);return Promise.resolve(t)}catch{return Promise.reject(Tt.GenMnemonicError)}}ge.getMnemonic=lT;async function hT(e){let t=ir.get(e);return t!=null?await t.getRandomPrivateKey():Promise.reject(Tt.NotImplementedError)}ge.getRandomPrivateKey=hT;async function pT(e,t){let r=ir.get(e);return r!=null?await r.getDerivedPrivateKey(t):Promise.reject(Tt.NotImplementedError)}ge.getDerivedPrivateKey=pT;async function bT(e,t){let r=ir.get(e);if(r!=null){if(!await r.validPrivateKey({privateKey:t.privateKey}))throw Tt.InvalidPrivateKeyError;return await r.getNewAddress(t)}return Promise.reject(Tt.NotImplementedError)}ge.getNewAddress=bT;async function gT(e,t){let r=ir.get(e);return r!=null?await r.validAddress(t):Promise.reject(Tt.NotImplementedError)}ge.validAddress=gT;async function vT(e,t){let r=ir.get(e);return r!=null?await r.validPrivateKey(t):Promise.reject(Tt.NotImplementedError)}ge.validPrivateKey=vT;async function yT(e,t){let r=ir.get(e);return r!=null?await r.signMessage(t):Promise.reject(Tt.NotImplementedError)}ge.signMessage=yT;async function mT(e,t){let r=ir.get(e);return r!=null?await r.verifyMessage(t):Promise.reject(Tt.NotImplementedError)}ge.verifyMessage=mT;async function wT(e,t){let r=ir.get(e);if(r!=null){let n=t.signature,i=t.data;return await r.ecRecover(i,n)}return Promise.reject(Tt.NotImplementedError)}ge.ecRecover=wT;async function _T(e,t){let r=ir.get(e);return r!=null?await r.signTransaction(t):Promise.reject(Tt.NotImplementedError)}ge.signTransaction=_T;async function ST(e,t){let r=ir.get(e);return r!=null?await r.getDerivedPath(t):Promise.reject(Tt.NotImplementedError)}ge.getDerivedPath=ST;async function xT(e,t){let r=ir.get(e);return r!=null?await r.getAddressByPublicKey(t):Promise.reject(Tt.NotImplementedError)}ge.getAddressByPublicKey=xT;async function ET(e,t){let r=ir.get(e);return r!=null?await r.getMPCRawTransaction(t):Promise.reject(Tt.NotImplementedError)}ge.getMPCRawTransaction=ET;async function AT(e,t){let r=ir.get(e);return r!=null?await r.getMPCTransaction(t):Promise.reject(Tt.NotImplementedError)}ge.getMPCTransaction=AT;async function PT(e,t){let r=ir.get(e);return r!=null?await r.getMPCRawMessage(t):Promise.reject(Tt.NotImplementedError)}ge.getMPCRawMessage=PT;async function CT(e,t){let r=ir.get(e);return r!=null?await r.getMPCSignedMessage(t):Promise.reject(Tt.NotImplementedError)}ge.getMPCSignedMessage=CT;async function IT(e,t){let r=ir.get(e);return r!=null?await r.getHardWareRawTransaction(t):Promise.reject(Tt.NotImplementedError)}ge.getHardWareRawTransaction=IT;async function BT(e,t){let r=ir.get(e);return r!=null?await r.getHardWareSignedTransaction(t):Promise.reject(Tt.NotImplementedError)}ge.getHardWareSignedTransaction=BT;async function MT(e,t){let r=ir.get(e);return r!=null?await r.getHardWareMessageHash(t):Promise.reject(Tt.NotImplementedError)}ge.getHardWareMessageHash=MT;async function TT(e,t){let r=ir.get(e);return r!=null?await r.calcTxHash(t):Promise.reject(Tt.NotImplementedError)}ge.calcTxHash=TT;async function OT(e,t){try{if(e.slice(0,4)!=="xpub"){let s=Tt.base.fromBase58Check(e).slice(4);s=H.Buffer.concat([Tt.base.fromHex("0488b21e"),s]),e=Tt.base.toBase58Check(s)}let n=o4.bip32.fromBase58(e).derivePath(t);return Promise.resolve(Tt.base.toHex(n.publicKey))}catch{return Promise.reject(Tt.HardwareDerivePubKeyError)}}ge.hardwareDerivePubKey=OT;async function DT(e,t){let r=ir.get(e);return r!=null?await r.getRawTransaction(t):Promise.reject(Tt.NotImplementedError)}ge.getRawTransaction=DT;async function NT(e,t){let r=ir.get(e);return r!=null?await r.validSignedTransaction(t):Promise.reject(Tt.NotImplementedError)}ge.validSignedTransaction=NT;async function RT(e,t){let r=ir.get(e);return r!=null?await r.estimateFee(t):Promise.reject(Tt.NotImplementedError)}ge.estimateFee=RT});function c4(e,t=!1,r=!0){let n="";return n=(i=>{let s=[];for(let a=0;a<i.length;a+=32768)s.push(String.fromCharCode.apply(null,i.subarray(a,a+32768)));return btoa(s.join(""))})(typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e)),t&&(n=function(i){return i.replace(/\+/g,"-").replace(/\//g,"_")}(n)),r||(n=n.replace(/=/g,"")),n}function f4(e,t=!1){{let r=!1;if(/^[0-9a-zA-Z_-]+={0,2}$/.test(e))r=!0;else if(!/^[0-9a-zA-Z+/]*={0,2}$/.test(e))throw new Error("Not a valid base64 input");r&&(e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/=/g,""));let n=new Uint8Array(atob(e).split("").map(i=>i.charCodeAt(0)));return t?new TextDecoder().decode(n):n}}var u4=el(()=>{D();N()});var Kd={};m2(Kd,{base64ToBigint:()=>kT,bigintToBase64:()=>jT,bigintToBuf:()=>d4,bigintToHex:()=>h4,bigintToText:()=>qT,bufToBigint:()=>l4,bufToHex:()=>v4,bufToText:()=>b4,hexToBigint:()=>p4,hexToBuf:()=>Pb,parseHex:()=>jf,textToBigint:()=>HT,textToBuf:()=>g4});function jf(e,t=!1,r){let n=e.match(/^(0x)?([\da-fA-F]+)$/);if(n==null)throw new RangeError("input must be a hexadecimal string, e.g. '0x124fe3a' or '0214f1b2'");let i=n[2];if(r!==void 0){if(r<i.length/2)throw new RangeError(`expected byte length ${r} < input hex byte length ${Math.ceil(i.length/2)}`);i=i.padStart(2*r,"0")}return t?"0x"+i:i}function d4(e,t=!1){if(e<0)throw RangeError("a should be a non-negative integer. Negative values are not supported");return Pb(h4(e),t)}function l4(e){let t=8n;ArrayBuffer.isView(e)?t=BigInt(8*e.BYTES_PER_ELEMENT):e=new Uint8Array(e);let r=0n;for(let n of e.values())r=(r<<t)+BigInt(n);return r}function h4(e,t=!1,r){if(e<0)throw RangeError("a should be a non-negative integer. Negative values are not supported");return jf(e.toString(16),t,r)}function p4(e){return BigInt(jf(e,!0))}function qT(e){if(e<0)throw RangeError("a should be a non-negative integer. Negative values are not supported");return b4(Pb(e.toString(16)))}function HT(e){return p4(v4(g4(e)))}function b4(e){return new TextDecoder().decode(new Uint8Array(e))}function g4(e,t=!1){return new TextEncoder().encode(e).buffer}function v4(e,t=!1,r){{let n="",i="0123456789abcdef";return(e=ArrayBuffer.isView(e)?new Uint8Array(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)):new Uint8Array(e)).forEach(s=>{n+=i[s>>4]+i[15&s]}),jf(n,t,r)}}function Pb(e,t=!1){let r=jf(e);return r=jf(e,!1,Math.ceil(r.length/2)),Uint8Array.from(r.match(/[\da-fA-F]{2}/g).map(n=>parseInt(n,16))).buffer}function jT(e,t=!1,r=!0){return c4(d4(e),t,r)}function kT(e){return l4(f4(e))}var Vd=el(()=>{D();N();u4()});var ch={};m2(ch,{abs:()=>Cc,bitLength:()=>Ib,crt:()=>y4,eGcd:()=>sh,gcd:()=>m4,isProbablyPrime:()=>Cb,lcm:()=>LT,max:()=>KT,min:()=>VT,modAdd:()=>UT,modInv:()=>Ud,modMultiply:()=>zT,modPow:()=>Ic,phi:()=>w4,prime:()=>$T,primeSync:()=>GT,randBetween:()=>oh,randBits:()=>S4,randBitsSync:()=>Bc,randBytes:()=>_4,randBytesSync:()=>ah,toZn:()=>la});function Cc(e){return e>=0?e:-e}function Ib(e){if(typeof e=="number"&&(e=BigInt(e)),e===1n)return 1;let t=1;do t++;while((e>>=1n)>1n);return t}function sh(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e<=0n||t<=0n)throw new RangeError("a and b MUST be > 0");let r=0n,n=1n,i=1n,s=0n;for(;e!==0n;){let a=t/e,o=t%e,c=r-i*a,u=n-s*a;t=e,e=o,r=i,n=s,i=c,s=u}return{g:t,x:r,y:n}}function la(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),t<=0n)throw new RangeError("n must be > 0");let r=e%t;return r<0n?r+t:r}function Ud(e,t){let r=sh(la(e,t),t);if(r.g!==1n)throw new RangeError(`${e.toString()} does not have inverse modulo ${t.toString()}`);return la(r.x,t)}function y4(e,t,r){if(e.length!==t.length)throw new RangeError("The remainders and modulos arrays should have the same length");let n=r??t.reduce((i,s)=>i*s,1n);return t.reduce((i,s,a)=>{let o=n/s;return la(i+o*Ud(o,s)%n*e[a]%n,n)},0n)}function m4(e,t){let r=typeof e=="number"?BigInt(Cc(e)):Cc(e),n=typeof t=="number"?BigInt(Cc(t)):Cc(t);if(r===0n)return n;if(n===0n)return r;let i=0n;for(;(1n&(r|n))===0n;)r>>=1n,n>>=1n,i++;for(;(1n&r)===0n;)r>>=1n;do{for(;(1n&n)===0n;)n>>=1n;if(r>n){let s=r;r=n,n=s}n-=r}while(n!==0n);return r<<i}function LT(e,t){return typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e===0n&&t===0n?BigInt(0):Cc(e/m4(e,t)*t)}function KT(e,t){return e>=t?e:t}function VT(e,t){return e>=t?t:e}function UT(e,t){let r=BigInt(t);return la(e.map(n=>BigInt(n)%r).reduce((n,i)=>n+i%r,0n),r)}function zT(e,t){let r=BigInt(t);return la(e.map(n=>BigInt(n)%r).reduce((n,i)=>n*i%r,1n),r)}function w4(e){return e.map(t=>t[0]**(t[1]-1n)*(t[0]-1n)).reduce((t,r)=>r*t,1n)}function Ic(e,t,r,n){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),typeof r=="number"&&(r=BigInt(r)),r<=0n)throw new RangeError("n must be > 0");if(r===1n)return 0n;if(e=la(e,r),t<0n)return Ud(Ic(e,Cc(t),r,n),r);if(n!==void 0)return function(s,a,o,c){let u=c.map(d=>d[0]**d[1]),b=c.map(d=>w4([d])),h=b.map((d,l)=>Ic(s,a%d,u[l]));return y4(h,u,o)}(e,t,r,function(s){let a={};return s.forEach(o=>{if(typeof o=="bigint"||typeof o=="number"){let c=String(o);a[c]===void 0?a[c]={p:BigInt(o),k:1n}:a[c].k+=1n}else{let c=String(o[0]);a[c]===void 0?a[c]={p:BigInt(o[0]),k:BigInt(o[1])}:a[c].k+=BigInt(o[1])}}),Object.values(a).map(o=>[o.p,o.k])}(n));let i=1n;for(;t>0;)t%2n===1n&&(i=i*e%r),t/=2n,e=e**2n%r;return i}function kf(e){let t=0n;for(let r of e.values())t=(t<<8n)+BigInt(r);return t}function _4(e,t=!1){if(e<1)throw new RangeError("byteLength MUST be > 0");return new Promise(function(r,n){{let i=new Uint8Array(e);if(e<=65536)self.crypto.getRandomValues(i);else for(let s=0;s<Math.ceil(e/65536);s++){let a=65536*s,o=a+65535<e?a+65535:e-1;self.crypto.getRandomValues(i.subarray(a,o))}t&&(i[0]=128|i[0]),r(i)}})}function ah(e,t=!1){if(e<1)throw new RangeError("byteLength MUST be > 0");{let r=new Uint8Array(e);if(e<=65536)self.crypto.getRandomValues(r);else for(let n=0;n<Math.ceil(e/65536);n++){let i=65536*n,s=i+65535<e?i+65535:e-1;self.crypto.getRandomValues(r.subarray(i,s))}return t&&(r[0]=128|r[0]),r}}function S4(e,t=!1){if(e<1)throw new RangeError("bitLength MUST be > 0");let r=Math.ceil(e/8),n=e%8;return new Promise((i,s)=>{_4(r,!1).then(function(a){if(n!==0&&(a[0]=a[0]&2**n-1),t){let o=n!==0?2**(n-1):128;a[0]=a[0]|o}i(a)})})}function Bc(e,t=!1){if(e<1)throw new RangeError("bitLength MUST be > 0");let r=ah(Math.ceil(e/8),!1),n=e%8;if(n!==0&&(r[0]=r[0]&2**n-1),t){let i=n!==0?2**(n-1):128;r[0]=r[0]|i}return r}function oh(e,t=1n){if(e<=t)throw new RangeError("Arguments MUST be: max > min");let r=e-t,n=Ib(r),i;do i=kf(Bc(n));while(i>r);return i+t}function Cb(e,t=16,r=!1){if(typeof e=="number"&&(e=BigInt(e)),e<0n)throw RangeError("w MUST be >= 0");return new Promise((n,i)=>{let s=new Worker(E4());s.onmessage=o=>{o?.data?._bcu?.isPrime!==void 0&&(s.terminate(),n(o.data._bcu.isPrime))},s.onmessageerror=o=>{i(o)};let a={_bcu:{rnd:e,iterations:t,id:0}};s.postMessage(a)})}function Bb(e,t){if(e===2n)return!0;if((1n&e)===0n||e===1n)return!1;let r=[3n,5n,7n,11n,13n,17n,19n,23n,29n,31n,37n,41n,43n,47n,53n,59n,61n,67n,71n,73n,79n,83n,89n,97n,101n,103n,107n,109n,113n,127n,131n,137n,139n,149n,151n,157n,163n,167n,173n,179n,181n,191n,193n,197n,199n,211n,223n,227n,229n,233n,239n,241n,251n,257n,263n,269n,271n,277n,281n,283n,293n,307n,311n,313n,317n,331n,337n,347n,349n,353n,359n,367n,373n,379n,383n,389n,397n,401n,409n,419n,421n,431n,433n,439n,443n,449n,457n,461n,463n,467n,479n,487n,491n,499n,503n,509n,521n,523n,541n,547n,557n,563n,569n,571n,577n,587n,593n,599n,601n,607n,613n,617n,619n,631n,641n,643n,647n,653n,659n,661n,673n,677n,683n,691n,701n,709n,719n,727n,733n,739n,743n,751n,757n,761n,769n,773n,787n,797n,809n,811n,821n,823n,827n,829n,839n,853n,857n,859n,863n,877n,881n,883n,887n,907n,911n,919n,929n,937n,941n,947n,953n,967n,971n,977n,983n,991n,997n,1009n,1013n,1019n,1021n,1031n,1033n,1039n,1049n,1051n,1061n,1063n,1069n,1087n,1091n,1093n,1097n,1103n,1109n,1117n,1123n,1129n,1151n,1153n,1163n,1171n,1181n,1187n,1193n,1201n,1213n,1217n,1223n,1229n,1231n,1237n,1249n,1259n,1277n,1279n,1283n,1289n,1291n,1297n,1301n,1303n,1307n,1319n,1321n,1327n,1361n,1367n,1373n,1381n,1399n,1409n,1423n,1427n,1429n,1433n,1439n,1447n,1451n,1453n,1459n,1471n,1481n,1483n,1487n,1489n,1493n,1499n,1511n,1523n,1531n,1543n,1549n,1553n,1559n,1567n,1571n,1579n,1583n,1597n];for(let o=0;o<r.length&&r[o]<=e;o++){let c=r[o];if(e===c)return!0;if(e%c===0n)return!1}let n=0n,i=e-1n,s=i;for(;s%2n===0n;)s/=2n,++n;let a=i/2n**n;do{let o=Ic(oh(i,2n),a,e);if(o===1n||o===i)continue;let c=1;for(;c<n&&(o=Ic(o,2n,e),o!==i);){if(o===1n)return!1;c++}if(o!==i)return!1}while(--t!=0);return!0}function E4(){let e=`
  'use strict';
  const ${sh.name} = ${sh.toString()};
  const ${Ud.name} = ${Ud.toString()};
  const ${Ic.name} = ${Ic.toString()};
  const ${la.name} = ${la.toString()};
  const ${Bc.name} = ${Bc.toString()};
  const ${ah.name} = ${ah.toString()};
  const ${oh.name} = ${oh.toString()};
  const ${Cb.name} = ${Bb.toString()};
  ${Ib.toString()};
  ${kf.toString()};`;return e+=`
  onmessage = async function(msg) {
    if (msg !== undefined && msg.data !== undefined && msg.data._bcu !== undefined && msg.data._bcu.id !== undefined && msg.data._bcu.iterations !== undefined && msg.data._bcu.rnd !== undefined) {
      const msgToParent = {
        _bcu: {
          isPrime: await ${Cb.name}(msg.data._bcu.rnd, msg.data._bcu.iterations),
          value: msg.data._bcu.rnd,
          id: msg.data._bcu.id
        }
      };
      postMessage(msgToParent);
    }
  }`,function(t){t=`(() => {${t}})()`;let r=new Blob([t],{type:"text/javascript"});return window.URL.createObjectURL(r)}(e)}function $T(e,t=16){if(e<1)throw new RangeError("bitLength MUST be > 0");if(!x4){let r=0n;do r=kf(Bc(e,!0));while(!Bb(r,t));return new Promise(n=>{n(r)})}return new Promise((r,n)=>{let i=[],s=(a,o)=>{if(a._bcu.isPrime){for(let c=0;c<i.length;c++)i[c].terminate();for(;i.length>0;)i.pop();r(a._bcu.value)}else{let c=kf(Bc(e,!0));try{let u={_bcu:{rnd:c,iterations:t,id:a._bcu.id}};o.postMessage(u)}catch{}}};{let a=E4();for(let o=0;o<self.navigator.hardwareConcurrency-1;o++){let c=new Worker(a);c.onmessage=u=>s(u.data,c),i.push(c)}}for(let a=0;a<i.length;a++)S4(e,!0).then(function(o){let c=kf(o);i[a].postMessage({_bcu:{rnd:c,iterations:t,id:a}})}).catch(n)})}function GT(e,t=16){if(e<1)throw new RangeError("bitLength MUST be > 0");let r=0n;do r=kf(Bc(e,!0));while(!Bb(r,t));return r}var x4,fh=el(()=>{D();N();x4=!1;self.Worker!==void 0&&(x4=!0)});var Ni=K(hr=>{D();N();var WT=hr&&hr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),XT=hr&&hr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),YT=hr&&hr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&WT(t,e,r);return XT(t,e),t};Object.defineProperty(hr,"__esModule",{value:!0});hr.cvtBigintToUint8arrayNoPadding=hr.cvtBigintToUint8array=hr.cvtUint8arrayToBigint=hr.randomSafePrime=hr.RandomNum=hr.HmacSHA512Int=hr.SHA256Int=void 0;var ZT=(Vd(),ws(Kd)),uh=(fh(),ws(ch)),A4=ar(),Mb=YT(w2());function JT(e){let t=A4.base.sha256.create();for(let r of e){if(r<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${r}`);let n=r.toString(16);n.length%2&&(n="0"+n),t.update(H.Buffer.from(n,"hex"))}return(0,ZT.bufToBigint)(t.digest())}hr.SHA256Int=JT;function QT(e){return e.length%2!==0&&(e="0"+e),e}function eO(e){let n=e.map(s=>QT(new A4.BN(s.toString()).toString(16))).map(s=>Mb.enc.Hex.parse(s)).reduce((s,a)=>s.concat(a)),i=Mb.HmacSHA512(n,"");return BigInt(`0x${Mb.enc.Hex.stringify(i)}`)}hr.HmacSHA512Int=eO;function tO(e){let t=BigInt(1),r=BigInt(2);if(e<=r)throw new Error("max has to be greater than two");return(0,uh.randBetween)(e-t,r)}hr.RandomNum=tO;async function rO(e){let t=8*e-1;for(;;){let r=await(0,uh.prime)(t);for(;r<BigInt(3)<<BigInt(t-2);)r=await(0,uh.prime)(t);let n=2n*r+1n;if(await(0,uh.isProbablyPrime)(n))return n}}hr.randomSafePrime=rO;function nO(e){let t=BigInt(0);for(let r=0;r<e.length;r++)t=t*BigInt(256)+BigInt(e[r]);return t}hr.cvtUint8arrayToBigint=nO;function iO(e){let t=new Uint8Array(32),r=t.length-1;for(;e>0&&r>=0;)t[r]=Number(e%BigInt(256)),e=e/BigInt(256),r--;return t}hr.cvtBigintToUint8array=iO;function sO(e){let t=[];for(;e>0n;){let n=Number(e%256n);t.push(n),e/=256n}return new Uint8Array(t).reverse()}hr.cvtBigintToUint8arrayNoPadding=sO});var P4=K(zd=>{D();N();Object.defineProperty(zd,"__esModule",{value:!0});zd.Commitment=void 0;var Tb=Ni(),aO;(function(e){function t(i){let s=(0,Tb.RandomNum)(2n**256n);return i.unshift(s),{C:(0,Tb.HmacSHA512Int)(i.slice()),Msg:i}}e.NewCommitment=t;function r(i){return n(i)?i.Msg.slice(1):null}e.Open=r;function n(i){let s=(0,Tb.HmacSHA512Int)(i.Msg);return i.C==s}e.Verify=n})(aO=zd.Commitment||(zd.Commitment={}))});var Ps=K(yt=>{D();N();Object.defineProperty(yt,"__esModule",{value:!0});yt.GenRSAKeyPairError=yt.DecodeRsaPublicKeyError=yt.DecodeRSAPrivateKeyError=yt.RSADecodeError=yt.RSAEncodeError=yt.AESDecryptError=yt.AESEncryptError=yt.Bip32DeriveError=yt.Bip32NewChildKeyError=yt.CommitmentDeCommitfail=yt.SchnorrVerifyFail=yt.SchnorrVerifyError=yt.SchnorrProveError=yt.CreatPailKeyError=yt.MPCError=void 0;var Ob=class extends Error{constructor(t,r){super(r.toString()),this.name=t}};yt.MPCError=Ob;var oO="create paillier key error";yt.CreatPailKeyError=oO;var cO="schnorr prove error";yt.SchnorrProveError=cO;var fO="schnorr verify error";yt.SchnorrVerifyError=fO;var uO="schnorr verify fail";yt.SchnorrVerifyFail=uO;var dO="commitment DeCommit fail";yt.CommitmentDeCommitfail=dO;var lO="bip32 new child key error";yt.Bip32NewChildKeyError=lO;var hO="bip32 derive error";yt.Bip32DeriveError=hO;var pO="aes encrypt error";yt.AESEncryptError=pO;var bO="aes decrypt error";yt.AESDecryptError=bO;var gO="rsa encode error";yt.RSAEncodeError=gO;var vO="rsa decode error";yt.RSADecodeError=vO;var yO="decode rsa private key error";yt.DecodeRSAPrivateKeyError=yO;var mO="decode rsa public key error";yt.DecodeRsaPublicKeyError=mO;var wO="gen rsa key pair error";yt.GenRSAKeyPairError=wO});var B4=K(to=>{D();N();Object.defineProperty(to,"__esModule",{value:!0});to.createPailKeyPair=to.PailPrivKey=to.PailPubKey=void 0;var Db=Ni(),_O=(fh(),ws(ch)),Cs=ar(),C4=Ps(),dh=class{constructor(t){this.n=t}n2(){return this.n.sqr()}g(){return this.n.addn(1)}encryptWithR(t,r){let n=this.n2(),i=Cs.BN.red(n),s=r.toRed(i),a=this.n.toRed(i).redMul(t.toRed(i)).addn(1),o=s.redPow(this.n);return a.redMul(o).fromRed()}encrypt(t){let r=BigInt(this.n.toString());for(;;){let n=new Cs.BN((0,Db.RandomNum)(r).toString());if(n.gcd(this.n).eqn(1))return this.encryptWithR(t,n)}}HomoAdd(t,r){let n=Cs.BN.red(this.n2());return t.toRed(n).redMul(r.toRed(n)).fromRed()}homomorphicAddPlain(t,r){let n=Cs.BN.red(this.n2()),i=this.n.toRed(n).redMul(r.toRed(n)).addn(1);return t.toRed(n).redMul(i).fromRed()}homomorphicMulPlain(t,r){let n=Cs.BN.red(this.n2());return t.toRed(n).redPow(r).fromRed()}};to.PailPubKey=dh;var lh=class{constructor(t,r){this.lambda=t,this.pailPubKey=r}decrypt(t){let r=this.pailPubKey.n2(),n=this.pailPubKey.n,i=this.pailPubKey.g(),s=t.toRed(Cs.BN.red(r)).redPow(this.lambda),a=I4(s.fromRed(),n),o=i.toRed(Cs.BN.red(r)).redPow(this.lambda),u=I4(o.fromRed(),n).toRed(Cs.BN.red(n)).redInvm();return a.mul(u).mod(n)}};to.PailPrivKey=lh;function I4(e,t){return e.subn(1).div(t)}async function SO(e){try{let t=0n,r=0n;for(;t==r;)t=await(0,Db.randomSafePrime)(e/2),r=await(0,Db.randomSafePrime)(e/2);if(t<r){let b=t;t=r,r=b}let n=t*r,i=t-1n,s=r-1n,a=i*s,o=(0,_O.eGcd)(i,s).g,c=a/o,u=new dh(new Cs.BN(n.toString()));return[new lh(new Cs.BN(c.toString()),u),u]}catch(t){return Promise.reject(new C4.MPCError(C4.CreatPailKeyError,t))}}to.createPailKeyPair=SO});var Nb=K(cs=>{D();N();var xO=cs&&cs.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),EO=cs&&cs.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),AO=cs&&cs.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&xO(t,e,r);return EO(t,e),t};Object.defineProperty(cs,"__esModule",{value:!0});cs.polynomial=void 0;var M4=AO((fh(),ws(ch))),PO;(function(e){async function t(s,a,o){let c=new Array(o+1);c[0]=a;for(let u=1;u<=o;u++){let b=await M4.prime(s.toString(2).length);c[u]=b}return{coefficients:c,qMod:s}}e.initPolynomial=t;function r(s,a){let o=s.coefficients[0],c=0n;for(let b=1;b<s.coefficients.length;b++){c*=a;let h=c*s.coefficients[b];o+=h}let u=s.qMod;return o=(o%u+u)%u,{id:a,y:o}}e.evaluatePolynomial=r;function n(s,a){let o=new Array(a.length);for(let u in a)o[u]=a[u].id;let c=0n;for(let u of a){let b=i(s,u.id,u.y,o);c+=b}return c=(c%s+s)%s,c}e.recoverSecret=n;function i(s,a,o,c){let u=o;for(let b=0;b<c.length;b++){let h=c[b];if(h===a)continue;let d=h-a;d=M4.modInv(d,s),d*=h,u*=d}return u=(u%s+s)%s,u}e.calLagrangian=i})(PO=cs.polynomial||(cs.polynomial={}))});var T4=K(ro=>{D();N();Object.defineProperty(ro,"__esModule",{value:!0});ro.base58=ro.fromBase58=ro.toBase58=void 0;var Rb=lc();Object.defineProperty(ro,"base58",{enumerable:!0,get:function(){return Rb.base58}});function CO(e){let t=H.Buffer.from(e);return Rb.base58.encode(Uint8Array.from(t))}ro.toBase58=CO;function IO(e){return Rb.base58.decode(e)}ro.fromBase58=IO});var O4=K(Lf=>{D();N();Object.defineProperty(Lf,"__esModule",{value:!0});Lf.validateHexString=Lf.isHexString=void 0;function BO(e,t){return e.match(/^0x[0-9A-Fa-f]*$/)?!(t&&e.length!==2+2*t):!1}Lf.isHexString=BO;function MO(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||t.length%2!==0||!t.match(/^[0-9A-Fa-f]*$/))}Lf.validateHexString=MO});var D4=K(Is=>{D();N();Object.defineProperty(Is,"__esModule",{value:!0});Is.isHexPrefixed=Is.stripHexPrefix=Is.fromHex=Is.toHex=void 0;var TO=O4();function OO(e,t=!1){let r=H.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}Is.toHex=OO;function DO(e){if((e.startsWith("0x")||e.startsWith("0X"))&&(e=e.substring(2)),e.length%2!=0&&(e="0"+e),!(0,TO.validateHexString)(e))throw new Error("invalid hex string");return H.Buffer.from(e,"hex")}Is.fromHex=DO;function NO(e){return e.startsWith("0x")?e.substring(2):e}Is.stripHexPrefix=NO;function RO(e){return e.startsWith("0x")}Is.isHexPrefixed=RO});var ha=K(Mc=>{D();N();Object.defineProperty(Mc,"__esModule",{value:!0});Mc.anumber=Fb;Mc.abytes=N4;Mc.ahash=qO;Mc.aexists=HO;Mc.aoutput=jO;function Fb(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function FO(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function N4(e,...t){if(!FO(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function qO(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Fb(e.outputLen),Fb(e.blockLen)}function HO(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function jO(e,t){N4(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}});var R4=K(hh=>{D();N();Object.defineProperty(hh,"__esModule",{value:!0});hh.crypto=void 0;hh.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var pn=K(xt=>{D();N();Object.defineProperty(xt,"__esModule",{value:!0});xt.Hash=xt.nextTick=xt.byteSwapIfBE=xt.isLE=void 0;xt.isBytes=kO;xt.u8=LO;xt.u32=KO;xt.createView=VO;xt.rotr=UO;xt.rotl=zO;xt.byteSwap=jb;xt.byteSwap32=$O;xt.bytesToHex=WO;xt.hexToBytes=XO;xt.asyncLoop=ZO;xt.utf8ToBytes=H4;xt.toBytes=ph;xt.concatBytes=JO;xt.checkOpts=QO;xt.wrapConstructor=eD;xt.wrapConstructorWithOpts=tD;xt.wrapXOFConstructorWithOpts=rD;xt.randomBytes=nD;var Kf=R4(),Hb=ha();function kO(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function LO(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function KO(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function VO(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function UO(e,t){return e<<32-t|e>>>t}function zO(e,t){return e<<t|e>>>32-t>>>0}xt.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function jb(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}xt.byteSwapIfBE=xt.isLE?e=>e:e=>jb(e);function $O(e){for(let t=0;t<e.length;t++)e[t]=jb(e[t])}var q4=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",GO=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function WO(e){if((0,Hb.abytes)(e),q4)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=GO[e[r]];return t}var pa={_0:48,_9:57,A:65,F:70,a:97,f:102};function F4(e){if(e>=pa._0&&e<=pa._9)return e-pa._0;if(e>=pa.A&&e<=pa.F)return e-(pa.A-10);if(e>=pa.a&&e<=pa.f)return e-(pa.a-10)}function XO(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(q4)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let a=F4(e.charCodeAt(s)),o=F4(e.charCodeAt(s+1));if(a===void 0||o===void 0){let c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=a*16+o}return n}var YO=async()=>{};xt.nextTick=YO;async function ZO(e,t,r){let n=Date.now();for(let i=0;i<e;i++){r(i);let s=Date.now()-n;s>=0&&s<t||(await(0,xt.nextTick)(),n+=s)}}function H4(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function ph(e){return typeof e=="string"&&(e=H4(e)),(0,Hb.abytes)(e),e}function JO(...e){let t=0;for(let n=0;n<e.length;n++){let i=e[n];(0,Hb.abytes)(i),t+=i.length}let r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var qb=class{clone(){return this._cloneInto()}};xt.Hash=qb;function QO(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function eD(e){let t=n=>e().update(ph(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function tD(e){let t=(n,i)=>e(i).update(ph(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function rD(e){let t=(n,i)=>e(i).update(ph(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function nD(e=32){if(Kf.crypto&&typeof Kf.crypto.getRandomValues=="function")return Kf.crypto.getRandomValues(new Uint8Array(e));if(Kf.crypto&&typeof Kf.crypto.randomBytes=="function")return Uint8Array.from(Kf.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var bh=K(Tc=>{D();N();Object.defineProperty(Tc,"__esModule",{value:!0});Tc.HashMD=void 0;Tc.setBigUint64=j4;Tc.Chi=iD;Tc.Maj=sD;var kb=ha(),$d=pn();function j4(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,a,n),e.setUint32(t+u,o,n)}function iD(e,t,r){return e&t^~e&r}function sD(e,t,r){return e&t^e&r^t&r}var Lb=class extends $d.Hash{constructor(t,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(t),this.view=(0,$d.createView)(this.buffer)}update(t){(0,kb.aexists)(this);let{view:r,buffer:n,blockLen:i}=this;t=(0,$d.toBytes)(t);let s=t.length;for(let a=0;a<s;){let o=Math.min(i-this.pos,s-a);if(o===i){let c=(0,$d.createView)(t);for(;i<=s-a;a+=i)this.process(c,a);continue}n.set(t.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,kb.aexists)(this),(0,kb.aoutput)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let h=a;h<i;h++)r[h]=0;j4(n,i-8,BigInt(this.length*8),s),this.process(n,0);let o=(0,$d.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,b=this.get();if(u>b.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)o.setUint32(4*h,b[h],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:a,pos:o}=this;return t.length=i,t.pos=o,t.finished=s,t.destroyed=a,i%r&&t.buffer.set(n),t}};Tc.HashMD=Lb});var Vf=K(so=>{D();N();Object.defineProperty(so,"__esModule",{value:!0});so.sha224=so.sha256=so.SHA256=void 0;var Kb=bh(),Ri=pn(),aD=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),no=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),io=new Uint32Array(64),Gd=class extends Kb.HashMD{constructor(t=32){super(64,t,8,!1),this.A=no[0]|0,this.B=no[1]|0,this.C=no[2]|0,this.D=no[3]|0,this.E=no[4]|0,this.F=no[5]|0,this.G=no[6]|0,this.H=no[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:a,G:o,H:c}=this;return[t,r,n,i,s,a,o,c]}set(t,r,n,i,s,a,o,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=a|0,this.G=o|0,this.H=c|0}process(t,r){for(let h=0;h<16;h++,r+=4)io[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let d=io[h-15],l=io[h-2],y=(0,Ri.rotr)(d,7)^(0,Ri.rotr)(d,18)^d>>>3,p=(0,Ri.rotr)(l,17)^(0,Ri.rotr)(l,19)^l>>>10;io[h]=p+io[h-7]+y+io[h-16]|0}let{A:n,B:i,C:s,D:a,E:o,F:c,G:u,H:b}=this;for(let h=0;h<64;h++){let d=(0,Ri.rotr)(o,6)^(0,Ri.rotr)(o,11)^(0,Ri.rotr)(o,25),l=b+d+(0,Kb.Chi)(o,c,u)+aD[h]+io[h]|0,p=((0,Ri.rotr)(n,2)^(0,Ri.rotr)(n,13)^(0,Ri.rotr)(n,22))+(0,Kb.Maj)(n,i,s)|0;b=u,u=c,c=o,o=a+l|0,a=s,s=i,i=n,n=l+p|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,u=u+this.G|0,b=b+this.H|0,this.set(n,i,s,a,o,c,u,b)}roundClean(){io.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};so.SHA256=Gd;var Vb=class extends Gd{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}};so.sha256=(0,Ri.wrapConstructor)(()=>new Gd);so.sha224=(0,Ri.wrapConstructor)(()=>new Vb)});var Uf=K(Te=>{D();N();Object.defineProperty(Te,"__esModule",{value:!0});Te.add5L=Te.add5H=Te.add4H=Te.add4L=Te.add3H=Te.add3L=Te.rotlBL=Te.rotlBH=Te.rotlSL=Te.rotlSH=Te.rotr32L=Te.rotr32H=Te.rotrBL=Te.rotrBH=Te.rotrSL=Te.rotrSH=Te.shrSL=Te.shrSH=Te.toBig=void 0;Te.fromBig=zb;Te.split=k4;Te.add=e8;var gh=BigInt(2**32-1),Ub=BigInt(32);function zb(e,t=!1){return t?{h:Number(e&gh),l:Number(e>>Ub&gh)}:{h:Number(e>>Ub&gh)|0,l:Number(e&gh)|0}}function k4(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:a}=zb(e[i],t);[r[i],n[i]]=[s,a]}return[r,n]}var L4=(e,t)=>BigInt(e>>>0)<<Ub|BigInt(t>>>0);Te.toBig=L4;var K4=(e,t,r)=>e>>>r;Te.shrSH=K4;var V4=(e,t,r)=>e<<32-r|t>>>r;Te.shrSL=V4;var U4=(e,t,r)=>e>>>r|t<<32-r;Te.rotrSH=U4;var z4=(e,t,r)=>e<<32-r|t>>>r;Te.rotrSL=z4;var $4=(e,t,r)=>e<<64-r|t>>>r-32;Te.rotrBH=$4;var G4=(e,t,r)=>e>>>r-32|t<<64-r;Te.rotrBL=G4;var W4=(e,t)=>t;Te.rotr32H=W4;var X4=(e,t)=>e;Te.rotr32L=X4;var Y4=(e,t,r)=>e<<r|t>>>32-r;Te.rotlSH=Y4;var Z4=(e,t,r)=>t<<r|e>>>32-r;Te.rotlSL=Z4;var J4=(e,t,r)=>t<<r-32|e>>>64-r;Te.rotlBH=J4;var Q4=(e,t,r)=>e<<r-32|t>>>64-r;Te.rotlBL=Q4;function e8(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var t8=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);Te.add3L=t8;var r8=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;Te.add3H=r8;var n8=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);Te.add4L=n8;var i8=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;Te.add4H=i8;var s8=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);Te.add5L=s8;var a8=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;Te.add5H=a8;var oD={fromBig:zb,split:k4,toBig:L4,shrSH:K4,shrSL:V4,rotrSH:U4,rotrSL:z4,rotrBH:$4,rotrBL:G4,rotr32H:W4,rotr32L:X4,rotlSH:Y4,rotlSL:Z4,rotlBH:J4,rotlBL:Q4,add:e8,add3L:t8,add3H:r8,add4L:n8,add4H:i8,add5H:a8,add5L:s8};Te.default=oD});var Wd=K(Xr=>{D();N();Object.defineProperty(Xr,"__esModule",{value:!0});Xr.sha384=Xr.sha512_256=Xr.sha512_224=Xr.sha512=Xr.SHA384=Xr.SHA512_256=Xr.SHA512_224=Xr.SHA512=void 0;var cD=bh(),st=Uf(),wh=pn(),[fD,uD]=(()=>st.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),ao=new Uint32Array(80),oo=new Uint32Array(80),Oc=class extends cD.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:u,El:b,Fh:h,Fl:d,Gh:l,Gl:y,Hh:p,Hl:m}=this;return[t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m]}set(t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=a|0,this.Dh=o|0,this.Dl=c|0,this.Eh=u|0,this.El=b|0,this.Fh=h|0,this.Fl=d|0,this.Gh=l|0,this.Gl=y|0,this.Hh=p|0,this.Hl=m|0}process(t,r){for(let T=0;T<16;T++,r+=4)ao[T]=t.getUint32(r),oo[T]=t.getUint32(r+=4);for(let T=16;T<80;T++){let q=ao[T-15]|0,F=oo[T-15]|0,j=st.default.rotrSH(q,F,1)^st.default.rotrSH(q,F,8)^st.default.shrSH(q,F,7),k=st.default.rotrSL(q,F,1)^st.default.rotrSL(q,F,8)^st.default.shrSL(q,F,7),I=ao[T-2]|0,R=oo[T-2]|0,A=st.default.rotrSH(I,R,19)^st.default.rotrBH(I,R,61)^st.default.shrSH(I,R,6),f=st.default.rotrSL(I,R,19)^st.default.rotrBL(I,R,61)^st.default.shrSL(I,R,6),g=st.default.add4L(k,f,oo[T-7],oo[T-16]),E=st.default.add4H(g,j,A,ao[T-7],ao[T-16]);ao[T]=E|0,oo[T]=g|0}let{Ah:n,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:u,Dl:b,Eh:h,El:d,Fh:l,Fl:y,Gh:p,Gl:m,Hh:w,Hl:C}=this;for(let T=0;T<80;T++){let q=st.default.rotrSH(h,d,14)^st.default.rotrSH(h,d,18)^st.default.rotrBH(h,d,41),F=st.default.rotrSL(h,d,14)^st.default.rotrSL(h,d,18)^st.default.rotrBL(h,d,41),j=h&l^~h&p,k=d&y^~d&m,I=st.default.add5L(C,F,k,uD[T],oo[T]),R=st.default.add5H(I,w,q,j,fD[T],ao[T]),A=I|0,f=st.default.rotrSH(n,i,28)^st.default.rotrBH(n,i,34)^st.default.rotrBH(n,i,39),g=st.default.rotrSL(n,i,28)^st.default.rotrBL(n,i,34)^st.default.rotrBL(n,i,39),E=n&s^n&o^s&o,x=i&a^i&c^a&c;w=p|0,C=m|0,p=l|0,m=y|0,l=h|0,y=d|0,{h,l:d}=st.default.add(u|0,b|0,R|0,A|0),u=o|0,b=c|0,o=s|0,c=a|0,s=n|0,a=i|0;let S=st.default.add3L(A,g,x);n=st.default.add3H(S,R,f,E),i=S|0}({h:n,l:i}=st.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:a}=st.default.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:o,l:c}=st.default.add(this.Ch|0,this.Cl|0,o|0,c|0),{h:u,l:b}=st.default.add(this.Dh|0,this.Dl|0,u|0,b|0),{h,l:d}=st.default.add(this.Eh|0,this.El|0,h|0,d|0),{h:l,l:y}=st.default.add(this.Fh|0,this.Fl|0,l|0,y|0),{h:p,l:m}=st.default.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:w,l:C}=st.default.add(this.Hh|0,this.Hl|0,w|0,C|0),this.set(n,i,s,a,o,c,u,b,h,d,l,y,p,m,w,C)}roundClean(){ao.fill(0),oo.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Xr.SHA512=Oc;var vh=class extends Oc{constructor(){super(28),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735}};Xr.SHA512_224=vh;var yh=class extends Oc{constructor(){super(32),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414}};Xr.SHA512_256=yh;var mh=class extends Oc{constructor(){super(48),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868}};Xr.SHA384=mh;Xr.sha512=(0,wh.wrapConstructor)(()=>new Oc);Xr.sha512_224=(0,wh.wrapConstructor)(()=>new vh);Xr.sha512_256=(0,wh.wrapConstructor)(()=>new yh);Xr.sha384=(0,wh.wrapConstructor)(()=>new mh)});var Wb=K(zf=>{D();N();Object.defineProperty(zf,"__esModule",{value:!0});zf.ripemd160=zf.RIPEMD160=void 0;var dD=bh(),Xd=pn(),lD=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),c8=new Uint8Array(new Array(16).fill(0).map((e,t)=>t)),hD=c8.map(e=>(9*e+5)%16),$b=[c8],Gb=[hD];for(let e=0;e<4;e++)for(let t of[$b,Gb])t.push(t[e].map(r=>lD[r]));var f8=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),pD=$b.map((e,t)=>e.map(r=>f8[t][r])),bD=Gb.map((e,t)=>e.map(r=>f8[t][r])),gD=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),vD=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function o8(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}var _h=new Uint32Array(16),Sh=class extends dD.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:r,h2:n,h3:i,h4:s}=this;return[t,r,n,i,s]}set(t,r,n,i,s){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(t,r){for(let l=0;l<16;l++,r+=4)_h[l]=t.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,a=s,o=this.h2|0,c=o,u=this.h3|0,b=u,h=this.h4|0,d=h;for(let l=0;l<5;l++){let y=4-l,p=gD[l],m=vD[l],w=$b[l],C=Gb[l],T=pD[l],q=bD[l];for(let F=0;F<16;F++){let j=(0,Xd.rotl)(n+o8(l,s,o,u)+_h[w[F]]+p,T[F])+h|0;n=h,h=u,u=(0,Xd.rotl)(o,10)|0,o=s,s=j}for(let F=0;F<16;F++){let j=(0,Xd.rotl)(i+o8(y,a,c,b)+_h[C[F]]+m,q[F])+d|0;i=d,d=b,b=(0,Xd.rotl)(c,10)|0,c=a,a=j}}this.set(this.h1+o+b|0,this.h2+u+d|0,this.h3+h+i|0,this.h4+n+a|0,this.h0+s+c|0)}roundClean(){_h.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};zf.RIPEMD160=Sh;zf.ripemd160=(0,Xd.wrapConstructor)(()=>new Sh)});var xh=K(Zt=>{D();N();Object.defineProperty(Zt,"__esModule",{value:!0});Zt.shake256=Zt.shake128=Zt.keccak_512=Zt.keccak_384=Zt.keccak_256=Zt.keccak_224=Zt.sha3_512=Zt.sha3_384=Zt.sha3_256=Zt.sha3_224=Zt.Keccak=void 0;Zt.keccakP=b8;var $f=ha(),Zd=Uf(),ba=pn(),l8=[],h8=[],p8=[],yD=BigInt(0),Yd=BigInt(1),mD=BigInt(2),wD=BigInt(7),_D=BigInt(256),SD=BigInt(113);for(let e=0,t=Yd,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],l8.push(2*(5*n+r)),h8.push((e+1)*(e+2)/2%64);let i=yD;for(let s=0;s<7;s++)t=(t<<Yd^(t>>wD)*SD)%_D,t&mD&&(i^=Yd<<(Yd<<BigInt(s))-Yd);p8.push(i)}var[xD,ED]=(0,Zd.split)(p8,!0),u8=(e,t,r)=>r>32?(0,Zd.rotlBH)(e,t,r):(0,Zd.rotlSH)(e,t,r),d8=(e,t,r)=>r>32?(0,Zd.rotlBL)(e,t,r):(0,Zd.rotlSL)(e,t,r);function b8(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let a=0;a<10;a++)r[a]=e[a]^e[a+10]^e[a+20]^e[a+30]^e[a+40];for(let a=0;a<10;a+=2){let o=(a+8)%10,c=(a+2)%10,u=r[c],b=r[c+1],h=u8(u,b,1)^r[o],d=d8(u,b,1)^r[o+1];for(let l=0;l<50;l+=10)e[a+l]^=h,e[a+l+1]^=d}let i=e[2],s=e[3];for(let a=0;a<24;a++){let o=h8[a],c=u8(i,s,o),u=d8(i,s,o),b=l8[a];i=e[b],s=e[b+1],e[b]=c,e[b+1]=u}for(let a=0;a<50;a+=10){for(let o=0;o<10;o++)r[o]=e[a+o];for(let o=0;o<10;o++)e[a+o]^=~r[(o+2)%10]&r[(o+4)%10]}e[0]^=xD[n],e[1]^=ED[n]}r.fill(0)}var Dc=class extends ba.Hash{constructor(t,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,(0,$f.anumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,ba.u32)(this.state)}keccak(){ba.isLE||(0,ba.byteSwap32)(this.state32),b8(this.state32,this.rounds),ba.isLE||(0,ba.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,$f.aexists)(this);let{blockLen:r,state:n}=this;t=(0,ba.toBytes)(t);let i=t.length;for(let s=0;s<i;){let a=Math.min(r-this.pos,i-s);for(let o=0;o<a;o++)n[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){(0,$f.aexists)(this,!1),(0,$f.abytes)(t),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=n&&this.keccak();let a=Math.min(n-this.posOut,s-i);t.set(r.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,$f.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,$f.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:a}=this;return t||(t=new Dc(r,n,i,a,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=n,t.outputLen=i,t.enableXOF=a,t.destroyed=this.destroyed,t}};Zt.Keccak=Dc;var co=(e,t,r)=>(0,ba.wrapConstructor)(()=>new Dc(t,e,r));Zt.sha3_224=co(6,144,224/8);Zt.sha3_256=co(6,136,256/8);Zt.sha3_384=co(6,104,384/8);Zt.sha3_512=co(6,72,512/8);Zt.keccak_224=co(1,144,224/8);Zt.keccak_256=co(1,136,256/8);Zt.keccak_384=co(1,104,384/8);Zt.keccak_512=co(1,72,512/8);var g8=(e,t,r)=>(0,ba.wrapXOFConstructorWithOpts)((n={})=>new Dc(t,e,n.dkLen===void 0?r:n.dkLen,!0));Zt.shake128=g8(31,168,128/8);Zt.shake256=g8(31,136,256/8)});var Eh=K(Wf=>{D();N();Object.defineProperty(Wf,"__esModule",{value:!0});Wf.BLAKE=Wf.SIGMA=void 0;var Gf=ha(),bn=pn();Wf.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var Xb=class extends bn.Hash{constructor(t,r,n={},i,s,a){if(super(),this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,Gf.anumber)(t),(0,Gf.anumber)(r),(0,Gf.anumber)(i),r<0||r>i)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error("key length must be undefined or 1.."+i);if(n.salt!==void 0&&n.salt.length!==s)throw new Error("salt must be undefined or "+s);if(n.personalization!==void 0&&n.personalization.length!==a)throw new Error("personalization must be undefined or "+a);this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=(0,bn.u32)(this.buffer)}update(t){(0,Gf.aexists)(this);let{blockLen:r,buffer:n,buffer32:i}=this;t=(0,bn.toBytes)(t);let s=t.length,a=t.byteOffset,o=t.buffer;for(let c=0;c<s;){this.pos===r&&(bn.isLE||(0,bn.byteSwap32)(i),this.compress(i,0,!1),bn.isLE||(0,bn.byteSwap32)(i),this.pos=0);let u=Math.min(r-this.pos,s-c),b=a+c;if(u===r&&!(b%4)&&c+u<s){let h=new Uint32Array(o,b,Math.floor((s-c)/4));bn.isLE||(0,bn.byteSwap32)(h);for(let d=0;c+r<s;d+=i.length,c+=r)this.length+=r,this.compress(h,d,!1);bn.isLE||(0,bn.byteSwap32)(h);continue}n.set(t.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(t){(0,Gf.aexists)(this),(0,Gf.aoutput)(t,this);let{pos:r,buffer32:n}=this;this.finished=!0,this.buffer.subarray(r).fill(0),bn.isLE||(0,bn.byteSwap32)(n),this.compress(n,0,!0),bn.isLE||(0,bn.byteSwap32)(n);let i=(0,bn.u32)(t);this.get().forEach((s,a)=>i[a]=(0,bn.byteSwapIfBE)(s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:a,pos:o}=this;return t||(t=new this.constructor({dkLen:a})),t.set(...this.get()),t.length=n,t.finished=i,t.destroyed=s,t.outputLen=a,t.buffer.set(r),t.pos=o,t}};Wf.BLAKE=Xb});var Yb=K(Xf=>{D();N();Object.defineProperty(Xf,"__esModule",{value:!0});Xf.blake2b=Xf.BLAKE2b=void 0;var v8=Eh(),Wn=Uf(),ni=pn(),Nr=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),oe=new Uint32Array(32);function fo(e,t,r,n,i,s){let a=i[s],o=i[s+1],c=oe[2*e],u=oe[2*e+1],b=oe[2*t],h=oe[2*t+1],d=oe[2*r],l=oe[2*r+1],y=oe[2*n],p=oe[2*n+1],m=Wn.default.add3L(c,b,a);u=Wn.default.add3H(m,u,h,o),c=m|0,{Dh:p,Dl:y}={Dh:p^u,Dl:y^c},{Dh:p,Dl:y}={Dh:Wn.default.rotr32H(p,y),Dl:Wn.default.rotr32L(p,y)},{h:l,l:d}=Wn.default.add(l,d,p,y),{Bh:h,Bl:b}={Bh:h^l,Bl:b^d},{Bh:h,Bl:b}={Bh:Wn.default.rotrSH(h,b,24),Bl:Wn.default.rotrSL(h,b,24)},oe[2*e]=c,oe[2*e+1]=u,oe[2*t]=b,oe[2*t+1]=h,oe[2*r]=d,oe[2*r+1]=l,oe[2*n]=y,oe[2*n+1]=p}function uo(e,t,r,n,i,s){let a=i[s],o=i[s+1],c=oe[2*e],u=oe[2*e+1],b=oe[2*t],h=oe[2*t+1],d=oe[2*r],l=oe[2*r+1],y=oe[2*n],p=oe[2*n+1],m=Wn.default.add3L(c,b,a);u=Wn.default.add3H(m,u,h,o),c=m|0,{Dh:p,Dl:y}={Dh:p^u,Dl:y^c},{Dh:p,Dl:y}={Dh:Wn.default.rotrSH(p,y,16),Dl:Wn.default.rotrSL(p,y,16)},{h:l,l:d}=Wn.default.add(l,d,p,y),{Bh:h,Bl:b}={Bh:h^l,Bl:b^d},{Bh:h,Bl:b}={Bh:Wn.default.rotrBH(h,b,63),Bl:Wn.default.rotrBL(h,b,63)},oe[2*e]=c,oe[2*e+1]=u,oe[2*t]=b,oe[2*t+1]=h,oe[2*r]=d,oe[2*r+1]=l,oe[2*n]=y,oe[2*n+1]=p}var Ah=class extends v8.BLAKE{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=Nr[0]|0,this.v0h=Nr[1]|0,this.v1l=Nr[2]|0,this.v1h=Nr[3]|0,this.v2l=Nr[4]|0,this.v2h=Nr[5]|0,this.v3l=Nr[6]|0,this.v3h=Nr[7]|0,this.v4l=Nr[8]|0,this.v4h=Nr[9]|0,this.v5l=Nr[10]|0,this.v5h=Nr[11]|0,this.v6l=Nr[12]|0,this.v6h=Nr[13]|0,this.v7l=Nr[14]|0,this.v7h=Nr[15]|0;let r=t.key?t.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,ni.u32)((0,ni.toBytes)(t.salt));this.v4l^=(0,ni.byteSwapIfBE)(n[0]),this.v4h^=(0,ni.byteSwapIfBE)(n[1]),this.v5l^=(0,ni.byteSwapIfBE)(n[2]),this.v5h^=(0,ni.byteSwapIfBE)(n[3])}if(t.personalization){let n=(0,ni.u32)((0,ni.toBytes)(t.personalization));this.v6l^=(0,ni.byteSwapIfBE)(n[0]),this.v6h^=(0,ni.byteSwapIfBE)(n[1]),this.v7l^=(0,ni.byteSwapIfBE)(n[2]),this.v7h^=(0,ni.byteSwapIfBE)(n[3])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,ni.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:i,v2l:s,v2h:a,v3l:o,v3h:c,v4l:u,v4h:b,v5l:h,v5h:d,v6l:l,v6h:y,v7l:p,v7h:m}=this;return[t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m]}set(t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=a|0,this.v3l=o|0,this.v3h=c|0,this.v4l=u|0,this.v4h=b|0,this.v5l=h|0,this.v5h=d|0,this.v6l=l|0,this.v6h=y|0,this.v7l=p|0,this.v7h=m|0}compress(t,r,n){this.get().forEach((c,u)=>oe[u]=c),oe.set(Nr,16);let{h:i,l:s}=Wn.default.fromBig(BigInt(this.length));oe[24]=Nr[8]^s,oe[25]=Nr[9]^i,n&&(oe[28]=~oe[28],oe[29]=~oe[29]);let a=0,o=v8.SIGMA;for(let c=0;c<12;c++)fo(0,4,8,12,t,r+2*o[a++]),uo(0,4,8,12,t,r+2*o[a++]),fo(1,5,9,13,t,r+2*o[a++]),uo(1,5,9,13,t,r+2*o[a++]),fo(2,6,10,14,t,r+2*o[a++]),uo(2,6,10,14,t,r+2*o[a++]),fo(3,7,11,15,t,r+2*o[a++]),uo(3,7,11,15,t,r+2*o[a++]),fo(0,5,10,15,t,r+2*o[a++]),uo(0,5,10,15,t,r+2*o[a++]),fo(1,6,11,12,t,r+2*o[a++]),uo(1,6,11,12,t,r+2*o[a++]),fo(2,7,8,13,t,r+2*o[a++]),uo(2,7,8,13,t,r+2*o[a++]),fo(3,4,9,14,t,r+2*o[a++]),uo(3,4,9,14,t,r+2*o[a++]);this.v0l^=oe[0]^oe[16],this.v0h^=oe[1]^oe[17],this.v1l^=oe[2]^oe[18],this.v1h^=oe[3]^oe[19],this.v2l^=oe[4]^oe[20],this.v2h^=oe[5]^oe[21],this.v3l^=oe[6]^oe[22],this.v3h^=oe[7]^oe[23],this.v4l^=oe[8]^oe[24],this.v4h^=oe[9]^oe[25],this.v5l^=oe[10]^oe[26],this.v5h^=oe[11]^oe[27],this.v6l^=oe[12]^oe[28],this.v6h^=oe[13]^oe[29],this.v7l^=oe[14]^oe[30],this.v7h^=oe[15]^oe[31],oe.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Xf.BLAKE2b=Ah;Xf.blake2b=(0,ni.wrapConstructorWithOpts)(e=>new Ah(e))});var Ch=K(Jt=>{D();N();Object.defineProperty(Jt,"__esModule",{value:!0});Jt.sha3_512=Jt.sha3_256=Jt.ripemd160=Jt.sha512=Jt.sha256=Jt.magicHash=Jt.blake2=Jt.keccak256=Jt.keccak=Jt.hash160=Jt.doubleSha256=void 0;var Ph=Vf();Object.defineProperty(Jt,"sha256",{enumerable:!0,get:function(){return Ph.sha256}});var AD=Wd();Object.defineProperty(Jt,"sha512",{enumerable:!0,get:function(){return AD.sha512}});var m8=Wb();Object.defineProperty(Jt,"ripemd160",{enumerable:!0,get:function(){return m8.ripemd160}});var Yf=xh();Object.defineProperty(Jt,"sha3_256",{enumerable:!0,get:function(){return Yf.sha3_256}});Object.defineProperty(Jt,"sha3_512",{enumerable:!0,get:function(){return Yf.sha3_512}});var PD=Yb();function w8(e){let t=(0,Ph.sha256)(e);return(0,Ph.sha256)(t)}Jt.doubleSha256=w8;function CD(e){let t=(0,Ph.sha256)(e);return(0,m8.ripemd160)(t)}Jt.hash160=CD;var ID=function(e,t=256){let r=H.Buffer.from(e);switch(t){case 224:return H.Buffer.from((0,Yf.keccak_224)(r));case 256:return H.Buffer.from((0,Yf.keccak_256)(r));case 384:return H.Buffer.from((0,Yf.keccak_384)(r));case 512:return H.Buffer.from((0,Yf.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${t}`)}};Jt.keccak=ID;var BD=function(e){return(0,Jt.keccak)(e)};Jt.keccak256=BD;function MD(e,t,r){let n=Math.ceil(t/8);return(0,PD.blake2b)(e,{dkLen:n,key:r})}Jt.blake2=MD;function y8(e){let t;return e<253?(t=H.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=H.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=H.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=H.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}var TD=H.Buffer.from(`Bitcoin Signed Message:
`);function OD(e,t){let r=t?H.Buffer.from(t,"utf8"):TD,n=y8(r.length),i=H.Buffer.from(e),s=y8(i.length),a=H.Buffer.concat([n,r,s,i]);return w8(a)}Jt.magicHash=OD});var Qd=K(Nc=>{D();N();Object.defineProperty(Nc,"__esModule",{value:!0});Nc.hmac=Nc.HMAC=void 0;var Ih=ha(),_8=pn(),Jd=class extends _8.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,Ih.ahash)(t);let n=(0,_8.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=t.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,Ih.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,Ih.aexists)(this),(0,Ih.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=a,t.outputLen=o,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Nc.HMAC=Jd;var DD=(e,t,r)=>new Jd(e,t).update(r).digest();Nc.hmac=DD;Nc.hmac.create=(e,t)=>new Jd(e,t)});var E8=K(Zf=>{D();N();Object.defineProperty(Zf,"__esModule",{value:!0});Zf.hmacSHA512=Zf.hmacSHA256=void 0;var S8=Qd(),x8=Ch();function ND(e,t){return H.Buffer.from((0,S8.hmac)(x8.sha256,e,t))}Zf.hmacSHA256=ND;function RD(e,t){return H.Buffer.from((0,S8.hmac)(x8.sha512,e,t))}Zf.hmacSHA512=RD});var Zb=K(Dt=>{D();N();Object.defineProperty(Dt,"__esModule",{value:!0});Dt.blake2s=Dt.BLAKE2s=Dt.B2S_IV=void 0;Dt.G1s=ga;Dt.G2s=va;Dt.compress=P8;var A8=Eh(),FD=Uf(),ii=pn();Dt.B2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function ga(e,t,r,n,i){return e=e+t+i|0,n=(0,ii.rotr)(n^e,16),r=r+n|0,t=(0,ii.rotr)(t^r,12),{a:e,b:t,c:r,d:n}}function va(e,t,r,n,i){return e=e+t+i|0,n=(0,ii.rotr)(n^e,8),r=r+n|0,t=(0,ii.rotr)(t^r,7),{a:e,b:t,c:r,d:n}}function P8(e,t,r,n,i,s,a,o,c,u,b,h,d,l,y,p,m,w,C,T){let q=0;for(let F=0;F<n;F++)({a:i,b:c,c:d,d:m}=ga(i,c,d,m,r[t+e[q++]])),{a:i,b:c,c:d,d:m}=va(i,c,d,m,r[t+e[q++]]),{a:s,b:u,c:l,d:w}=ga(s,u,l,w,r[t+e[q++]]),{a:s,b:u,c:l,d:w}=va(s,u,l,w,r[t+e[q++]]),{a,b,c:y,d:C}=ga(a,b,y,C,r[t+e[q++]]),{a,b,c:y,d:C}=va(a,b,y,C,r[t+e[q++]]),{a:o,b:h,c:p,d:T}=ga(o,h,p,T,r[t+e[q++]]),{a:o,b:h,c:p,d:T}=va(o,h,p,T,r[t+e[q++]]),{a:i,b:u,c:y,d:T}=ga(i,u,y,T,r[t+e[q++]]),{a:i,b:u,c:y,d:T}=va(i,u,y,T,r[t+e[q++]]),{a:s,b,c:p,d:m}=ga(s,b,p,m,r[t+e[q++]]),{a:s,b,c:p,d:m}=va(s,b,p,m,r[t+e[q++]]),{a,b:h,c:d,d:w}=ga(a,h,d,w,r[t+e[q++]]),{a,b:h,c:d,d:w}=va(a,h,d,w,r[t+e[q++]]),{a:o,b:c,c:l,d:C}=ga(o,c,l,C,r[t+e[q++]]),{a:o,b:c,c:l,d:C}=va(o,c,l,C,r[t+e[q++]]);return{v0:i,v1:s,v2:a,v3:o,v4:c,v5:u,v6:b,v7:h,v8:d,v9:l,v10:y,v11:p,v12:m,v13:w,v14:C,v15:T}}var Bh=class extends A8.BLAKE{constructor(t={}){super(64,t.dkLen===void 0?32:t.dkLen,t,32,8,8),this.v0=Dt.B2S_IV[0]|0,this.v1=Dt.B2S_IV[1]|0,this.v2=Dt.B2S_IV[2]|0,this.v3=Dt.B2S_IV[3]|0,this.v4=Dt.B2S_IV[4]|0,this.v5=Dt.B2S_IV[5]|0,this.v6=Dt.B2S_IV[6]|0,this.v7=Dt.B2S_IV[7]|0;let r=t.key?t.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,ii.u32)((0,ii.toBytes)(t.salt));this.v4^=(0,ii.byteSwapIfBE)(n[0]),this.v5^=(0,ii.byteSwapIfBE)(n[1])}if(t.personalization){let n=(0,ii.u32)((0,ii.toBytes)(t.personalization));this.v6^=(0,ii.byteSwapIfBE)(n[0]),this.v7^=(0,ii.byteSwapIfBE)(n[1])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,ii.toBytes)(t.key)),this.update(n)}}get(){let{v0:t,v1:r,v2:n,v3:i,v4:s,v5:a,v6:o,v7:c}=this;return[t,r,n,i,s,a,o,c]}set(t,r,n,i,s,a,o,c){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=a|0,this.v6=o|0,this.v7=c|0}compress(t,r,n){let{h:i,l:s}=(0,FD.fromBig)(BigInt(this.length)),{v0:a,v1:o,v2:c,v3:u,v4:b,v5:h,v6:d,v7:l,v8:y,v9:p,v10:m,v11:w,v12:C,v13:T,v14:q,v15:F}=P8(A8.SIGMA,r,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,Dt.B2S_IV[0],Dt.B2S_IV[1],Dt.B2S_IV[2],Dt.B2S_IV[3],s^Dt.B2S_IV[4],i^Dt.B2S_IV[5],n?~Dt.B2S_IV[6]:Dt.B2S_IV[6],Dt.B2S_IV[7]);this.v0^=a^y,this.v1^=o^p,this.v2^=c^m,this.v3^=u^w,this.v4^=b^C,this.v5^=h^T,this.v6^=d^q,this.v7^=l^F}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};Dt.BLAKE2s=Bh;Dt.blake2s=(0,ii.wrapConstructorWithOpts)(e=>new Bh(e))});var Oh=K(Th=>{D();N();Object.defineProperty(Th,"__esModule",{value:!0});Th.pbkdf2=HD;Th.pbkdf2Async=jD;var Mh=ha(),qD=Qd(),Jf=pn();function C8(e,t,r,n){(0,Mh.ahash)(e);let i=(0,Jf.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:a,asyncTick:o}=i;if((0,Mh.anumber)(s),(0,Mh.anumber)(a),(0,Mh.anumber)(o),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let c=(0,Jf.toBytes)(t),u=(0,Jf.toBytes)(r),b=new Uint8Array(a),h=qD.hmac.create(e,c),d=h._cloneInto().update(u);return{c:s,dkLen:a,asyncTick:o,DK:b,PRF:h,PRFSalt:d}}function I8(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}function HD(e,t,r,n){let{c:i,dkLen:s,DK:a,PRF:o,PRFSalt:c}=C8(e,t,r,n),u,b=new Uint8Array(4),h=(0,Jf.createView)(b),d=new Uint8Array(o.outputLen);for(let l=1,y=0;y<s;l++,y+=o.outputLen){let p=a.subarray(y,y+o.outputLen);h.setInt32(0,l,!1),(u=c._cloneInto(u)).update(b).digestInto(d),p.set(d.subarray(0,p.length));for(let m=1;m<i;m++){o._cloneInto(u).update(d).digestInto(d);for(let w=0;w<p.length;w++)p[w]^=d[w]}}return I8(o,c,a,u,d)}async function jD(e,t,r,n){let{c:i,dkLen:s,asyncTick:a,DK:o,PRF:c,PRFSalt:u}=C8(e,t,r,n),b,h=new Uint8Array(4),d=(0,Jf.createView)(h),l=new Uint8Array(c.outputLen);for(let y=1,p=0;p<s;y++,p+=c.outputLen){let m=o.subarray(p,p+c.outputLen);d.setInt32(0,y,!1),(b=u._cloneInto(b)).update(h).digestInto(l),m.set(l.subarray(0,m.length)),await(0,Jf.asyncLoop)(i-1,a,()=>{c._cloneInto(b).update(l).digestInto(l);for(let w=0;w<m.length;w++)m[w]^=l[w]})}return I8(c,u,o,b,l)}});var N8=K(Dh=>{D();N();Object.defineProperty(Dh,"__esModule",{value:!0});Dh.scrypt=kD;Dh.scryptAsync=LD;var Qf=ha(),M8=Oh(),T8=Vf(),Ie=pn();function B8(e,t,r,n,i,s){let a=e[t++]^r[n++],o=e[t++]^r[n++],c=e[t++]^r[n++],u=e[t++]^r[n++],b=e[t++]^r[n++],h=e[t++]^r[n++],d=e[t++]^r[n++],l=e[t++]^r[n++],y=e[t++]^r[n++],p=e[t++]^r[n++],m=e[t++]^r[n++],w=e[t++]^r[n++],C=e[t++]^r[n++],T=e[t++]^r[n++],q=e[t++]^r[n++],F=e[t++]^r[n++],j=a,k=o,I=c,R=u,A=b,f=h,g=d,E=l,x=y,S=p,P=m,O=w,B=C,v=T,M=q,V=F;for(let z=0;z<8;z+=2)A^=(0,Ie.rotl)(j+B|0,7),x^=(0,Ie.rotl)(A+j|0,9),B^=(0,Ie.rotl)(x+A|0,13),j^=(0,Ie.rotl)(B+x|0,18),S^=(0,Ie.rotl)(f+k|0,7),v^=(0,Ie.rotl)(S+f|0,9),k^=(0,Ie.rotl)(v+S|0,13),f^=(0,Ie.rotl)(k+v|0,18),M^=(0,Ie.rotl)(P+g|0,7),I^=(0,Ie.rotl)(M+P|0,9),g^=(0,Ie.rotl)(I+M|0,13),P^=(0,Ie.rotl)(g+I|0,18),R^=(0,Ie.rotl)(V+O|0,7),E^=(0,Ie.rotl)(R+V|0,9),O^=(0,Ie.rotl)(E+R|0,13),V^=(0,Ie.rotl)(O+E|0,18),k^=(0,Ie.rotl)(j+R|0,7),I^=(0,Ie.rotl)(k+j|0,9),R^=(0,Ie.rotl)(I+k|0,13),j^=(0,Ie.rotl)(R+I|0,18),g^=(0,Ie.rotl)(f+A|0,7),E^=(0,Ie.rotl)(g+f|0,9),A^=(0,Ie.rotl)(E+g|0,13),f^=(0,Ie.rotl)(A+E|0,18),O^=(0,Ie.rotl)(P+S|0,7),x^=(0,Ie.rotl)(O+P|0,9),S^=(0,Ie.rotl)(x+O|0,13),P^=(0,Ie.rotl)(S+x|0,18),B^=(0,Ie.rotl)(V+M|0,7),v^=(0,Ie.rotl)(B+V|0,9),M^=(0,Ie.rotl)(v+B|0,13),V^=(0,Ie.rotl)(M+v|0,18);i[s++]=a+j|0,i[s++]=o+k|0,i[s++]=c+I|0,i[s++]=u+R|0,i[s++]=b+A|0,i[s++]=h+f|0,i[s++]=d+g|0,i[s++]=l+E|0,i[s++]=y+x|0,i[s++]=p+S|0,i[s++]=m+P|0,i[s++]=w+O|0,i[s++]=C+B|0,i[s++]=T+v|0,i[s++]=q+M|0,i[s++]=F+V|0}function eu(e,t,r,n,i){let s=n+0,a=n+16*i;for(let o=0;o<16;o++)r[a+o]=e[t+(2*i-1)*16+o];for(let o=0;o<i;o++,s+=16,t+=16)B8(r,a,e,t,r,s),o>0&&(a+=16),B8(r,s,e,t+=16,r,a)}function O8(e,t,r){let n=(0,Ie.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:a,dkLen:o,asyncTick:c,maxmem:u,onProgress:b}=n;if((0,Qf.anumber)(i),(0,Qf.anumber)(s),(0,Qf.anumber)(a),(0,Qf.anumber)(o),(0,Qf.anumber)(c),(0,Qf.anumber)(u),b!==void 0&&typeof b!="function")throw new Error("progressCb should be function");let h=128*s,d=h/4;if(i<=1||(i&i-1)!==0||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(a<0||a>(2**32-1)*32/h)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(o<0||o>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(h*(i+a)>u)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+u);let y=(0,M8.pbkdf2)(T8.sha256,e,t,{c:1,dkLen:h*a}),p=(0,Ie.u32)(y),m=(0,Ie.u32)(new Uint8Array(h*i)),w=(0,Ie.u32)(new Uint8Array(h)),C=()=>{};if(b){let T=2*i*a,q=Math.max(Math.floor(T/1e4),1),F=0;C=()=>{F++,b&&(!(F%q)||F===T)&&b(F/T)}}return{N:i,r:s,p:a,dkLen:o,blockSize32:d,V:m,B32:p,B:y,tmp:w,blockMixCb:C,asyncTick:c}}function D8(e,t,r,n,i){let s=(0,M8.pbkdf2)(T8.sha256,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),i.fill(0),s}function kD(e,t,r){let{N:n,r:i,p:s,dkLen:a,blockSize32:o,V:c,B32:u,B:b,tmp:h,blockMixCb:d}=O8(e,t,r);Ie.isLE||(0,Ie.byteSwap32)(u);for(let l=0;l<s;l++){let y=o*l;for(let p=0;p<o;p++)c[p]=u[y+p];for(let p=0,m=0;p<n-1;p++)eu(c,m,c,m+=o,i),d();eu(c,(n-1)*o,u,y,i),d();for(let p=0;p<n;p++){let m=u[y+o-16]%n;for(let w=0;w<o;w++)h[w]=u[y+w]^c[m*o+w];eu(h,0,u,y,i),d()}}return Ie.isLE||(0,Ie.byteSwap32)(u),D8(e,a,b,c,h)}async function LD(e,t,r){let{N:n,r:i,p:s,dkLen:a,blockSize32:o,V:c,B32:u,B:b,tmp:h,blockMixCb:d,asyncTick:l}=O8(e,t,r);Ie.isLE||(0,Ie.byteSwap32)(u);for(let y=0;y<s;y++){let p=o*y;for(let w=0;w<o;w++)c[w]=u[p+w];let m=0;await(0,Ie.asyncLoop)(n-1,l,()=>{eu(c,m,c,m+=o,i),d()}),eu(c,(n-1)*o,u,p,i),d(),await(0,Ie.asyncLoop)(n,l,()=>{let w=u[p+o-16]%n;for(let C=0;C<o;C++)h[C]=u[p+C]^c[w*o+C];eu(h,0,u,p,i),d()})}return Ie.isLE||(0,Ie.byteSwap32)(u),D8(e,a,b,c,h)}});var q8=K(ru=>{D();N();Object.defineProperty(ru,"__esModule",{value:!0});ru.blake3=ru.BLAKE3=void 0;var e0=ha(),KD=Eh(),R8=Uf(),fs=Zb(),Yr=pn(),Bs={CHUNK_START:1<<0,CHUNK_END:1<<1,PARENT:1<<2,ROOT:1<<3,KEYED_HASH:1<<4,DERIVE_KEY_CONTEXT:1<<5,DERIVE_KEY_MATERIAL:1<<6},F8=(()=>{let e=Array.from({length:16},(n,i)=>i),t=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=e;n<7;n++,i=t(i))r.push(...i);return Uint8Array.from(r)})(),tu=class extends KD.BLAKE{constructor(t={},r=0){let n=t.dkLen===void 0?32:t.dkLen;if(super(64,n,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,(0,e0.anumber)(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){let i=(0,Yr.toBytes)(t.key).slice();if(i.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,Yr.u32)(i),Yr.isLE||(0,Yr.byteSwap32)(this.IV),this.flags=r|Bs.KEYED_HASH}else if(t.context!==void 0){let i=new tu({dkLen:32},Bs.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=(0,Yr.u32)(i),Yr.isLE||(0,Yr.byteSwap32)(this.IV),this.flags=r|Bs.DERIVE_KEY_MATERIAL}else this.IV=fs.B2S_IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,Yr.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,r,n,i=0){let{state:s,pos:a}=this,{h:o,l:c}=(0,R8.fromBig)(BigInt(t),!0),{v0:u,v1:b,v2:h,v3:d,v4:l,v5:y,v6:p,v7:m,v8:w,v9:C,v10:T,v11:q,v12:F,v13:j,v14:k,v15:I}=(0,fs.compress)(F8,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],fs.B2S_IV[0],fs.B2S_IV[1],fs.B2S_IV[2],fs.B2S_IV[3],o,c,a,r);s[0]=u^w,s[1]=b^C,s[2]=h^T,s[3]=d^q,s[4]=l^F,s[5]=y^j,s[6]=p^k,s[7]=m^I}compress(t,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=Bs.CHUNK_START),(this.chunkPos===15||n)&&(i|=Bs.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,t,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let a,o=this.chunksDone+1;(n||!(o&1))&&(a=this.stack.pop());o>>=1)this.buffer32.set(a,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|Bs.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:r,flags:n,state:i,chunkPos:s,posOut:a,chunkOut:o,stack:c,chunksDone:u}=this;return t.state.set(i.slice()),t.stack=c.map(b=>Uint32Array.from(b)),t.IV.set(r),t.flags=n,t.chunkPos=s,t.chunksDone=u,t.posOut=a,t.chunkOut=o,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){let{state:t,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:a,l:o}=(0,R8.fromBig)(BigInt(this.chunkOut++));Yr.isLE||(0,Yr.byteSwap32)(i);let{v0:c,v1:u,v2:b,v3:h,v4:d,v5:l,v6:y,v7:p,v8:m,v9:w,v10:C,v11:T,v12:q,v13:F,v14:j,v15:k}=(0,fs.compress)(F8,0,i,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],fs.B2S_IV[0],fs.B2S_IV[1],fs.B2S_IV[2],fs.B2S_IV[3],o,a,r,n);s[0]=c^m,s[1]=u^w,s[2]=b^C,s[3]=h^T,s[4]=d^q,s[5]=l^F,s[6]=y^j,s[7]=p^k,s[8]=t[0]^m,s[9]=t[1]^w,s[10]=t[2]^C,s[11]=t[3]^T,s[12]=t[4]^q,s[13]=t[5]^F,s[14]=t[6]^j,s[15]=t[7]^k,Yr.isLE||((0,Yr.byteSwap32)(i),(0,Yr.byteSwap32)(s)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|Bs.ROOT;this.stack.length?(t|=Bs.PARENT,Yr.isLE||(0,Yr.byteSwap32)(this.buffer32),this.compress(this.buffer32,0,!0),Yr.isLE||(0,Yr.byteSwap32)(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:Bs.CHUNK_START)|Bs.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){(0,e0.aexists)(this,!1),(0,e0.abytes)(t),this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.b2CompressOut();let a=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return(0,e0.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,e0.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};ru.BLAKE3=tu;ru.blake3=(0,Yr.wrapXOFConstructorWithOpts)(e=>new tu(e))});var t0=K(Et=>{D();N();var H8=Et&&Et.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),VD=Et&&Et.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Xn=Et&&Et.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&H8(t,e,r)},UD=Et&&Et.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&H8(t,e,r);return VD(t,e),t};Object.defineProperty(Et,"__esModule",{value:!0});Et.randomBytes=Et.concatBytes=Et.reverseBuffer=void 0;Xn(T4(),Et);Xn(D4(),Et);Xn(Ch(),Et);Xn(E8(),Et);Xn(lc(),Et);Xn(Vf(),Et);Xn(Qd(),Et);Xn(Wb(),Et);Xn(Wd(),Et);Xn(xh(),Et);Xn(Yb(),Et);Xn(Zb(),Et);Xn(Oh(),Et);Xn(N8(),Et);Xn(q8(),Et);var zD=UD(pn()),$D=_m();function GD(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Et.reverseBuffer=GD;function WD(e,t){return zD.concatBytes(Uint8Array.from(e),Uint8Array.from(t))}Et.concatBytes=WD;function XD(e){return $D(e)}Et.randomBytes=XD});var si=K((j8,Jb)=>{D();N();(function(e,t){"use strict";function r(A,f){if(!A)throw new Error(f||"Assertion failed")}function n(A,f){A.super_=f;var g=function(){};g.prototype=f.prototype,A.prototype=new g,A.prototype.constructor=A}function i(A,f,g){if(i.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((f==="le"||f==="be")&&(g=f,f=10),this._init(A||0,f||10,g||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=ym().Buffer}catch{}i.isBN=function(f){return f instanceof i?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===i.wordSize&&Array.isArray(f.words)},i.max=function(f,g){return f.cmp(g)>0?f:g},i.min=function(f,g){return f.cmp(g)<0?f:g},i.prototype._init=function(f,g,E){if(typeof f=="number")return this._initNumber(f,g,E);if(typeof f=="object")return this._initArray(f,g,E);g==="hex"&&(g=16),r(g===(g|0)&&g>=2&&g<=36),f=f.toString().replace(/\s+/g,"");var x=0;f[0]==="-"&&(x++,this.negative=1),x<f.length&&(g===16?this._parseHex(f,x,E):(this._parseBase(f,g,x),E==="le"&&this._initArray(this.toArray(),g,E)))},i.prototype._initNumber=function(f,g,E){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(r(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),E==="le"&&this._initArray(this.toArray(),g,E)},i.prototype._initArray=function(f,g,E){if(r(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var S,P,O=0;if(E==="be")for(x=f.length-1,S=0;x>=0;x-=3)P=f[x]|f[x-1]<<8|f[x-2]<<16,this.words[S]|=P<<O&67108863,this.words[S+1]=P>>>26-O&67108863,O+=24,O>=26&&(O-=26,S++);else if(E==="le")for(x=0,S=0;x<f.length;x+=3)P=f[x]|f[x+1]<<8|f[x+2]<<16,this.words[S]|=P<<O&67108863,this.words[S+1]=P>>>26-O&67108863,O+=24,O>=26&&(O-=26,S++);return this.strip()};function a(A,f){var g=A.charCodeAt(f);return g>=65&&g<=70?g-55:g>=97&&g<=102?g-87:g-48&15}function o(A,f,g){var E=a(A,g);return g-1>=f&&(E|=a(A,g-1)<<4),E}i.prototype._parseHex=function(f,g,E){this.length=Math.ceil((f.length-g)/6),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var S=0,P=0,O;if(E==="be")for(x=f.length-1;x>=g;x-=2)O=o(f,g,x)<<S,this.words[P]|=O&67108863,S>=18?(S-=18,P+=1,this.words[P]|=O>>>26):S+=8;else{var B=f.length-g;for(x=B%2===0?g+1:g;x<f.length;x+=2)O=o(f,g,x)<<S,this.words[P]|=O&67108863,S>=18?(S-=18,P+=1,this.words[P]|=O>>>26):S+=8}this.strip()};function c(A,f,g,E){for(var x=0,S=Math.min(A.length,g),P=f;P<S;P++){var O=A.charCodeAt(P)-48;x*=E,O>=49?x+=O-49+10:O>=17?x+=O-17+10:x+=O}return x}i.prototype._parseBase=function(f,g,E){this.words=[0],this.length=1;for(var x=0,S=1;S<=67108863;S*=g)x++;x--,S=S/g|0;for(var P=f.length-E,O=P%x,B=Math.min(P,P-O)+E,v=0,M=E;M<B;M+=x)v=c(f,M,M+x,g),this.imuln(S),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v);if(O!==0){var V=1;for(v=c(f,M,f.length,g),M=0;M<O;M++)V*=g;this.imuln(V),this.words[0]+v<67108864?this.words[0]+=v:this._iaddn(v)}this.strip()},i.prototype.copy=function(f){f.words=new Array(this.length);for(var g=0;g<this.length;g++)f.words[g]=this.words[g];f.length=this.length,f.negative=this.negative,f.red=this.red},i.prototype.clone=function(){var f=new i(null);return this.copy(f),f},i.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(f,g){f=f||10,g=g|0||1;var E;if(f===16||f==="hex"){E="";for(var x=0,S=0,P=0;P<this.length;P++){var O=this.words[P],B=((O<<x|S)&16777215).toString(16);S=O>>>24-x&16777215,S!==0||P!==this.length-1?E=u[6-B.length]+B+E:E=B+E,x+=2,x>=26&&(x-=26,P--)}for(S!==0&&(E=S.toString(16)+E);E.length%g!==0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}if(f===(f|0)&&f>=2&&f<=36){var v=b[f],M=h[f];E="";var V=this.clone();for(V.negative=0;!V.isZero();){var z=V.modn(M).toString(f);V=V.idivn(M),V.isZero()?E=z+E:E=u[v-z.length]+z+E}for(this.isZero()&&(E="0"+E);E.length%g!==0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(f,g){return r(typeof s<"u"),this.toArrayLike(s,f,g)},i.prototype.toArray=function(f,g){return this.toArrayLike(Array,f,g)},i.prototype.toArrayLike=function(f,g,E){var x=this.byteLength(),S=E||Math.max(1,x);r(x<=S,"byte array longer than desired length"),r(S>0,"Requested array length <= 0"),this.strip();var P=g==="le",O=new f(S),B,v,M=this.clone();if(P){for(v=0;!M.isZero();v++)B=M.andln(255),M.iushrn(8),O[v]=B;for(;v<S;v++)O[v]=0}else{for(v=0;v<S-x;v++)O[v]=0;for(v=0;!M.isZero();v++)B=M.andln(255),M.iushrn(8),O[S-v-1]=B}return O},Math.clz32?i.prototype._countBits=function(f){return 32-Math.clz32(f)}:i.prototype._countBits=function(f){var g=f,E=0;return g>=4096&&(E+=13,g>>>=13),g>=64&&(E+=7,g>>>=7),g>=8&&(E+=4,g>>>=4),g>=2&&(E+=2,g>>>=2),E+g},i.prototype._zeroBits=function(f){if(f===0)return 26;var g=f,E=0;return(g&8191)===0&&(E+=13,g>>>=13),(g&127)===0&&(E+=7,g>>>=7),(g&15)===0&&(E+=4,g>>>=4),(g&3)===0&&(E+=2,g>>>=2),(g&1)===0&&E++,E},i.prototype.bitLength=function(){var f=this.words[this.length-1],g=this._countBits(f);return(this.length-1)*26+g};function d(A){for(var f=new Array(A.bitLength()),g=0;g<f.length;g++){var E=g/26|0,x=g%26;f[g]=(A.words[E]&1<<x)>>>x}return f}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,g=0;g<this.length;g++){var E=this._zeroBits(this.words[g]);if(f+=E,E!==26)break}return f},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},i.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var g=0;g<f.length;g++)this.words[g]=this.words[g]|f.words[g];return this.strip()},i.prototype.ior=function(f){return r((this.negative|f.negative)===0),this.iuor(f)},i.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},i.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},i.prototype.iuand=function(f){var g;this.length>f.length?g=f:g=this;for(var E=0;E<g.length;E++)this.words[E]=this.words[E]&f.words[E];return this.length=g.length,this.strip()},i.prototype.iand=function(f){return r((this.negative|f.negative)===0),this.iuand(f)},i.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},i.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},i.prototype.iuxor=function(f){var g,E;this.length>f.length?(g=this,E=f):(g=f,E=this);for(var x=0;x<E.length;x++)this.words[x]=g.words[x]^E.words[x];if(this!==g)for(;x<g.length;x++)this.words[x]=g.words[x];return this.length=g.length,this.strip()},i.prototype.ixor=function(f){return r((this.negative|f.negative)===0),this.iuxor(f)},i.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},i.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},i.prototype.inotn=function(f){r(typeof f=="number"&&f>=0);var g=Math.ceil(f/26)|0,E=f%26;this._expand(g),E>0&&g--;for(var x=0;x<g;x++)this.words[x]=~this.words[x]&67108863;return E>0&&(this.words[x]=~this.words[x]&67108863>>26-E),this.strip()},i.prototype.notn=function(f){return this.clone().inotn(f)},i.prototype.setn=function(f,g){r(typeof f=="number"&&f>=0);var E=f/26|0,x=f%26;return this._expand(E+1),g?this.words[E]=this.words[E]|1<<x:this.words[E]=this.words[E]&~(1<<x),this.strip()},i.prototype.iadd=function(f){var g;if(this.negative!==0&&f.negative===0)return this.negative=0,g=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,g=this.isub(f),f.negative=1,g._normSign();var E,x;this.length>f.length?(E=this,x=f):(E=f,x=this);for(var S=0,P=0;P<x.length;P++)g=(E.words[P]|0)+(x.words[P]|0)+S,this.words[P]=g&67108863,S=g>>>26;for(;S!==0&&P<E.length;P++)g=(E.words[P]|0)+S,this.words[P]=g&67108863,S=g>>>26;if(this.length=E.length,S!==0)this.words[this.length]=S,this.length++;else if(E!==this)for(;P<E.length;P++)this.words[P]=E.words[P];return this},i.prototype.add=function(f){var g;return f.negative!==0&&this.negative===0?(f.negative=0,g=this.sub(f),f.negative^=1,g):f.negative===0&&this.negative!==0?(this.negative=0,g=f.sub(this),this.negative=1,g):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},i.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var g=this.iadd(f);return f.negative=1,g._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var E=this.cmp(f);if(E===0)return this.negative=0,this.length=1,this.words[0]=0,this;var x,S;E>0?(x=this,S=f):(x=f,S=this);for(var P=0,O=0;O<S.length;O++)g=(x.words[O]|0)-(S.words[O]|0)+P,P=g>>26,this.words[O]=g&67108863;for(;P!==0&&O<x.length;O++)g=(x.words[O]|0)+P,P=g>>26,this.words[O]=g&67108863;if(P===0&&O<x.length&&x!==this)for(;O<x.length;O++)this.words[O]=x.words[O];return this.length=Math.max(this.length,O),x!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(f){return this.clone().isub(f)};function l(A,f,g){g.negative=f.negative^A.negative;var E=A.length+f.length|0;g.length=E,E=E-1|0;var x=A.words[0]|0,S=f.words[0]|0,P=x*S,O=P&67108863,B=P/67108864|0;g.words[0]=O;for(var v=1;v<E;v++){for(var M=B>>>26,V=B&67108863,z=Math.min(v,f.length-1),$=Math.max(0,v-A.length+1);$<=z;$++){var G=v-$|0;x=A.words[G]|0,S=f.words[$]|0,P=x*S+V,M+=P/67108864|0,V=P&67108863}g.words[v]=V|0,B=M|0}return B!==0?g.words[v]=B|0:g.length--,g.strip()}var y=function(f,g,E){var x=f.words,S=g.words,P=E.words,O=0,B,v,M,V=x[0]|0,z=V&8191,$=V>>>13,G=x[1]|0,Q=G&8191,re=G>>>13,me=x[2]|0,ne=me&8191,te=me>>>13,_e=x[3]|0,ce=_e&8191,J=_e>>>13,De=x[4]|0,fe=De&8191,ie=De>>>13,qt=x[5]|0,Ae=qt&8191,Se=qt>>>13,zo=x[6]|0,we=zo&8191,Ee=zo>>>13,$o=x[7]|0,Be=$o&8191,ue=$o>>>13,En=x[8]|0,se=En&8191,xe=En>>>13,dd=x[9]|0,Ne=dd&8191,Re=dd>>>13,ld=S[0]|0,Fe=ld&8191,qe=ld>>>13,hd=S[1]|0,He=hd&8191,je=hd>>>13,pd=S[2]|0,ke=pd&8191,Le=pd>>>13,bd=S[3]|0,Ke=bd&8191,Ve=bd>>>13,gd=S[4]|0,Ue=gd&8191,ze=gd>>>13,vd=S[5]|0,$e=vd&8191,Ge=vd>>>13,yd=S[6]|0,We=yd&8191,Xe=yd>>>13,md=S[7]|0,Ye=md&8191,Ze=md>>>13,wd=S[8]|0,Je=wd&8191,Qe=wd>>>13,_d=S[9]|0,et=_d&8191,tt=_d>>>13;E.negative=f.negative^g.negative,E.length=19,B=Math.imul(z,Fe),v=Math.imul(z,qe),v=v+Math.imul($,Fe)|0,M=Math.imul($,qe);var Go=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Go>>>26)|0,Go&=67108863,B=Math.imul(Q,Fe),v=Math.imul(Q,qe),v=v+Math.imul(re,Fe)|0,M=Math.imul(re,qe),B=B+Math.imul(z,He)|0,v=v+Math.imul(z,je)|0,v=v+Math.imul($,He)|0,M=M+Math.imul($,je)|0;var Wo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Wo>>>26)|0,Wo&=67108863,B=Math.imul(ne,Fe),v=Math.imul(ne,qe),v=v+Math.imul(te,Fe)|0,M=Math.imul(te,qe),B=B+Math.imul(Q,He)|0,v=v+Math.imul(Q,je)|0,v=v+Math.imul(re,He)|0,M=M+Math.imul(re,je)|0,B=B+Math.imul(z,ke)|0,v=v+Math.imul(z,Le)|0,v=v+Math.imul($,ke)|0,M=M+Math.imul($,Le)|0;var Xo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Xo>>>26)|0,Xo&=67108863,B=Math.imul(ce,Fe),v=Math.imul(ce,qe),v=v+Math.imul(J,Fe)|0,M=Math.imul(J,qe),B=B+Math.imul(ne,He)|0,v=v+Math.imul(ne,je)|0,v=v+Math.imul(te,He)|0,M=M+Math.imul(te,je)|0,B=B+Math.imul(Q,ke)|0,v=v+Math.imul(Q,Le)|0,v=v+Math.imul(re,ke)|0,M=M+Math.imul(re,Le)|0,B=B+Math.imul(z,Ke)|0,v=v+Math.imul(z,Ve)|0,v=v+Math.imul($,Ke)|0,M=M+Math.imul($,Ve)|0;var Yo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Yo>>>26)|0,Yo&=67108863,B=Math.imul(fe,Fe),v=Math.imul(fe,qe),v=v+Math.imul(ie,Fe)|0,M=Math.imul(ie,qe),B=B+Math.imul(ce,He)|0,v=v+Math.imul(ce,je)|0,v=v+Math.imul(J,He)|0,M=M+Math.imul(J,je)|0,B=B+Math.imul(ne,ke)|0,v=v+Math.imul(ne,Le)|0,v=v+Math.imul(te,ke)|0,M=M+Math.imul(te,Le)|0,B=B+Math.imul(Q,Ke)|0,v=v+Math.imul(Q,Ve)|0,v=v+Math.imul(re,Ke)|0,M=M+Math.imul(re,Ve)|0,B=B+Math.imul(z,Ue)|0,v=v+Math.imul(z,ze)|0,v=v+Math.imul($,Ue)|0,M=M+Math.imul($,ze)|0;var Zo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Zo>>>26)|0,Zo&=67108863,B=Math.imul(Ae,Fe),v=Math.imul(Ae,qe),v=v+Math.imul(Se,Fe)|0,M=Math.imul(Se,qe),B=B+Math.imul(fe,He)|0,v=v+Math.imul(fe,je)|0,v=v+Math.imul(ie,He)|0,M=M+Math.imul(ie,je)|0,B=B+Math.imul(ce,ke)|0,v=v+Math.imul(ce,Le)|0,v=v+Math.imul(J,ke)|0,M=M+Math.imul(J,Le)|0,B=B+Math.imul(ne,Ke)|0,v=v+Math.imul(ne,Ve)|0,v=v+Math.imul(te,Ke)|0,M=M+Math.imul(te,Ve)|0,B=B+Math.imul(Q,Ue)|0,v=v+Math.imul(Q,ze)|0,v=v+Math.imul(re,Ue)|0,M=M+Math.imul(re,ze)|0,B=B+Math.imul(z,$e)|0,v=v+Math.imul(z,Ge)|0,v=v+Math.imul($,$e)|0,M=M+Math.imul($,Ge)|0;var Jo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Jo>>>26)|0,Jo&=67108863,B=Math.imul(we,Fe),v=Math.imul(we,qe),v=v+Math.imul(Ee,Fe)|0,M=Math.imul(Ee,qe),B=B+Math.imul(Ae,He)|0,v=v+Math.imul(Ae,je)|0,v=v+Math.imul(Se,He)|0,M=M+Math.imul(Se,je)|0,B=B+Math.imul(fe,ke)|0,v=v+Math.imul(fe,Le)|0,v=v+Math.imul(ie,ke)|0,M=M+Math.imul(ie,Le)|0,B=B+Math.imul(ce,Ke)|0,v=v+Math.imul(ce,Ve)|0,v=v+Math.imul(J,Ke)|0,M=M+Math.imul(J,Ve)|0,B=B+Math.imul(ne,Ue)|0,v=v+Math.imul(ne,ze)|0,v=v+Math.imul(te,Ue)|0,M=M+Math.imul(te,ze)|0,B=B+Math.imul(Q,$e)|0,v=v+Math.imul(Q,Ge)|0,v=v+Math.imul(re,$e)|0,M=M+Math.imul(re,Ge)|0,B=B+Math.imul(z,We)|0,v=v+Math.imul(z,Xe)|0,v=v+Math.imul($,We)|0,M=M+Math.imul($,Xe)|0;var Qo=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(Qo>>>26)|0,Qo&=67108863,B=Math.imul(Be,Fe),v=Math.imul(Be,qe),v=v+Math.imul(ue,Fe)|0,M=Math.imul(ue,qe),B=B+Math.imul(we,He)|0,v=v+Math.imul(we,je)|0,v=v+Math.imul(Ee,He)|0,M=M+Math.imul(Ee,je)|0,B=B+Math.imul(Ae,ke)|0,v=v+Math.imul(Ae,Le)|0,v=v+Math.imul(Se,ke)|0,M=M+Math.imul(Se,Le)|0,B=B+Math.imul(fe,Ke)|0,v=v+Math.imul(fe,Ve)|0,v=v+Math.imul(ie,Ke)|0,M=M+Math.imul(ie,Ve)|0,B=B+Math.imul(ce,Ue)|0,v=v+Math.imul(ce,ze)|0,v=v+Math.imul(J,Ue)|0,M=M+Math.imul(J,ze)|0,B=B+Math.imul(ne,$e)|0,v=v+Math.imul(ne,Ge)|0,v=v+Math.imul(te,$e)|0,M=M+Math.imul(te,Ge)|0,B=B+Math.imul(Q,We)|0,v=v+Math.imul(Q,Xe)|0,v=v+Math.imul(re,We)|0,M=M+Math.imul(re,Xe)|0,B=B+Math.imul(z,Ye)|0,v=v+Math.imul(z,Ze)|0,v=v+Math.imul($,Ye)|0,M=M+Math.imul($,Ze)|0;var ec=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(ec>>>26)|0,ec&=67108863,B=Math.imul(se,Fe),v=Math.imul(se,qe),v=v+Math.imul(xe,Fe)|0,M=Math.imul(xe,qe),B=B+Math.imul(Be,He)|0,v=v+Math.imul(Be,je)|0,v=v+Math.imul(ue,He)|0,M=M+Math.imul(ue,je)|0,B=B+Math.imul(we,ke)|0,v=v+Math.imul(we,Le)|0,v=v+Math.imul(Ee,ke)|0,M=M+Math.imul(Ee,Le)|0,B=B+Math.imul(Ae,Ke)|0,v=v+Math.imul(Ae,Ve)|0,v=v+Math.imul(Se,Ke)|0,M=M+Math.imul(Se,Ve)|0,B=B+Math.imul(fe,Ue)|0,v=v+Math.imul(fe,ze)|0,v=v+Math.imul(ie,Ue)|0,M=M+Math.imul(ie,ze)|0,B=B+Math.imul(ce,$e)|0,v=v+Math.imul(ce,Ge)|0,v=v+Math.imul(J,$e)|0,M=M+Math.imul(J,Ge)|0,B=B+Math.imul(ne,We)|0,v=v+Math.imul(ne,Xe)|0,v=v+Math.imul(te,We)|0,M=M+Math.imul(te,Xe)|0,B=B+Math.imul(Q,Ye)|0,v=v+Math.imul(Q,Ze)|0,v=v+Math.imul(re,Ye)|0,M=M+Math.imul(re,Ze)|0,B=B+Math.imul(z,Je)|0,v=v+Math.imul(z,Qe)|0,v=v+Math.imul($,Je)|0,M=M+Math.imul($,Qe)|0;var tc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(tc>>>26)|0,tc&=67108863,B=Math.imul(Ne,Fe),v=Math.imul(Ne,qe),v=v+Math.imul(Re,Fe)|0,M=Math.imul(Re,qe),B=B+Math.imul(se,He)|0,v=v+Math.imul(se,je)|0,v=v+Math.imul(xe,He)|0,M=M+Math.imul(xe,je)|0,B=B+Math.imul(Be,ke)|0,v=v+Math.imul(Be,Le)|0,v=v+Math.imul(ue,ke)|0,M=M+Math.imul(ue,Le)|0,B=B+Math.imul(we,Ke)|0,v=v+Math.imul(we,Ve)|0,v=v+Math.imul(Ee,Ke)|0,M=M+Math.imul(Ee,Ve)|0,B=B+Math.imul(Ae,Ue)|0,v=v+Math.imul(Ae,ze)|0,v=v+Math.imul(Se,Ue)|0,M=M+Math.imul(Se,ze)|0,B=B+Math.imul(fe,$e)|0,v=v+Math.imul(fe,Ge)|0,v=v+Math.imul(ie,$e)|0,M=M+Math.imul(ie,Ge)|0,B=B+Math.imul(ce,We)|0,v=v+Math.imul(ce,Xe)|0,v=v+Math.imul(J,We)|0,M=M+Math.imul(J,Xe)|0,B=B+Math.imul(ne,Ye)|0,v=v+Math.imul(ne,Ze)|0,v=v+Math.imul(te,Ye)|0,M=M+Math.imul(te,Ze)|0,B=B+Math.imul(Q,Je)|0,v=v+Math.imul(Q,Qe)|0,v=v+Math.imul(re,Je)|0,M=M+Math.imul(re,Qe)|0,B=B+Math.imul(z,et)|0,v=v+Math.imul(z,tt)|0,v=v+Math.imul($,et)|0,M=M+Math.imul($,tt)|0;var rc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(rc>>>26)|0,rc&=67108863,B=Math.imul(Ne,He),v=Math.imul(Ne,je),v=v+Math.imul(Re,He)|0,M=Math.imul(Re,je),B=B+Math.imul(se,ke)|0,v=v+Math.imul(se,Le)|0,v=v+Math.imul(xe,ke)|0,M=M+Math.imul(xe,Le)|0,B=B+Math.imul(Be,Ke)|0,v=v+Math.imul(Be,Ve)|0,v=v+Math.imul(ue,Ke)|0,M=M+Math.imul(ue,Ve)|0,B=B+Math.imul(we,Ue)|0,v=v+Math.imul(we,ze)|0,v=v+Math.imul(Ee,Ue)|0,M=M+Math.imul(Ee,ze)|0,B=B+Math.imul(Ae,$e)|0,v=v+Math.imul(Ae,Ge)|0,v=v+Math.imul(Se,$e)|0,M=M+Math.imul(Se,Ge)|0,B=B+Math.imul(fe,We)|0,v=v+Math.imul(fe,Xe)|0,v=v+Math.imul(ie,We)|0,M=M+Math.imul(ie,Xe)|0,B=B+Math.imul(ce,Ye)|0,v=v+Math.imul(ce,Ze)|0,v=v+Math.imul(J,Ye)|0,M=M+Math.imul(J,Ze)|0,B=B+Math.imul(ne,Je)|0,v=v+Math.imul(ne,Qe)|0,v=v+Math.imul(te,Je)|0,M=M+Math.imul(te,Qe)|0,B=B+Math.imul(Q,et)|0,v=v+Math.imul(Q,tt)|0,v=v+Math.imul(re,et)|0,M=M+Math.imul(re,tt)|0;var nc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(nc>>>26)|0,nc&=67108863,B=Math.imul(Ne,ke),v=Math.imul(Ne,Le),v=v+Math.imul(Re,ke)|0,M=Math.imul(Re,Le),B=B+Math.imul(se,Ke)|0,v=v+Math.imul(se,Ve)|0,v=v+Math.imul(xe,Ke)|0,M=M+Math.imul(xe,Ve)|0,B=B+Math.imul(Be,Ue)|0,v=v+Math.imul(Be,ze)|0,v=v+Math.imul(ue,Ue)|0,M=M+Math.imul(ue,ze)|0,B=B+Math.imul(we,$e)|0,v=v+Math.imul(we,Ge)|0,v=v+Math.imul(Ee,$e)|0,M=M+Math.imul(Ee,Ge)|0,B=B+Math.imul(Ae,We)|0,v=v+Math.imul(Ae,Xe)|0,v=v+Math.imul(Se,We)|0,M=M+Math.imul(Se,Xe)|0,B=B+Math.imul(fe,Ye)|0,v=v+Math.imul(fe,Ze)|0,v=v+Math.imul(ie,Ye)|0,M=M+Math.imul(ie,Ze)|0,B=B+Math.imul(ce,Je)|0,v=v+Math.imul(ce,Qe)|0,v=v+Math.imul(J,Je)|0,M=M+Math.imul(J,Qe)|0,B=B+Math.imul(ne,et)|0,v=v+Math.imul(ne,tt)|0,v=v+Math.imul(te,et)|0,M=M+Math.imul(te,tt)|0;var ic=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(ic>>>26)|0,ic&=67108863,B=Math.imul(Ne,Ke),v=Math.imul(Ne,Ve),v=v+Math.imul(Re,Ke)|0,M=Math.imul(Re,Ve),B=B+Math.imul(se,Ue)|0,v=v+Math.imul(se,ze)|0,v=v+Math.imul(xe,Ue)|0,M=M+Math.imul(xe,ze)|0,B=B+Math.imul(Be,$e)|0,v=v+Math.imul(Be,Ge)|0,v=v+Math.imul(ue,$e)|0,M=M+Math.imul(ue,Ge)|0,B=B+Math.imul(we,We)|0,v=v+Math.imul(we,Xe)|0,v=v+Math.imul(Ee,We)|0,M=M+Math.imul(Ee,Xe)|0,B=B+Math.imul(Ae,Ye)|0,v=v+Math.imul(Ae,Ze)|0,v=v+Math.imul(Se,Ye)|0,M=M+Math.imul(Se,Ze)|0,B=B+Math.imul(fe,Je)|0,v=v+Math.imul(fe,Qe)|0,v=v+Math.imul(ie,Je)|0,M=M+Math.imul(ie,Qe)|0,B=B+Math.imul(ce,et)|0,v=v+Math.imul(ce,tt)|0,v=v+Math.imul(J,et)|0,M=M+Math.imul(J,tt)|0;var sc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(sc>>>26)|0,sc&=67108863,B=Math.imul(Ne,Ue),v=Math.imul(Ne,ze),v=v+Math.imul(Re,Ue)|0,M=Math.imul(Re,ze),B=B+Math.imul(se,$e)|0,v=v+Math.imul(se,Ge)|0,v=v+Math.imul(xe,$e)|0,M=M+Math.imul(xe,Ge)|0,B=B+Math.imul(Be,We)|0,v=v+Math.imul(Be,Xe)|0,v=v+Math.imul(ue,We)|0,M=M+Math.imul(ue,Xe)|0,B=B+Math.imul(we,Ye)|0,v=v+Math.imul(we,Ze)|0,v=v+Math.imul(Ee,Ye)|0,M=M+Math.imul(Ee,Ze)|0,B=B+Math.imul(Ae,Je)|0,v=v+Math.imul(Ae,Qe)|0,v=v+Math.imul(Se,Je)|0,M=M+Math.imul(Se,Qe)|0,B=B+Math.imul(fe,et)|0,v=v+Math.imul(fe,tt)|0,v=v+Math.imul(ie,et)|0,M=M+Math.imul(ie,tt)|0;var ac=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(ac>>>26)|0,ac&=67108863,B=Math.imul(Ne,$e),v=Math.imul(Ne,Ge),v=v+Math.imul(Re,$e)|0,M=Math.imul(Re,Ge),B=B+Math.imul(se,We)|0,v=v+Math.imul(se,Xe)|0,v=v+Math.imul(xe,We)|0,M=M+Math.imul(xe,Xe)|0,B=B+Math.imul(Be,Ye)|0,v=v+Math.imul(Be,Ze)|0,v=v+Math.imul(ue,Ye)|0,M=M+Math.imul(ue,Ze)|0,B=B+Math.imul(we,Je)|0,v=v+Math.imul(we,Qe)|0,v=v+Math.imul(Ee,Je)|0,M=M+Math.imul(Ee,Qe)|0,B=B+Math.imul(Ae,et)|0,v=v+Math.imul(Ae,tt)|0,v=v+Math.imul(Se,et)|0,M=M+Math.imul(Se,tt)|0;var oc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(oc>>>26)|0,oc&=67108863,B=Math.imul(Ne,We),v=Math.imul(Ne,Xe),v=v+Math.imul(Re,We)|0,M=Math.imul(Re,Xe),B=B+Math.imul(se,Ye)|0,v=v+Math.imul(se,Ze)|0,v=v+Math.imul(xe,Ye)|0,M=M+Math.imul(xe,Ze)|0,B=B+Math.imul(Be,Je)|0,v=v+Math.imul(Be,Qe)|0,v=v+Math.imul(ue,Je)|0,M=M+Math.imul(ue,Qe)|0,B=B+Math.imul(we,et)|0,v=v+Math.imul(we,tt)|0,v=v+Math.imul(Ee,et)|0,M=M+Math.imul(Ee,tt)|0;var cc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(cc>>>26)|0,cc&=67108863,B=Math.imul(Ne,Ye),v=Math.imul(Ne,Ze),v=v+Math.imul(Re,Ye)|0,M=Math.imul(Re,Ze),B=B+Math.imul(se,Je)|0,v=v+Math.imul(se,Qe)|0,v=v+Math.imul(xe,Je)|0,M=M+Math.imul(xe,Qe)|0,B=B+Math.imul(Be,et)|0,v=v+Math.imul(Be,tt)|0,v=v+Math.imul(ue,et)|0,M=M+Math.imul(ue,tt)|0;var fc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(fc>>>26)|0,fc&=67108863,B=Math.imul(Ne,Je),v=Math.imul(Ne,Qe),v=v+Math.imul(Re,Je)|0,M=Math.imul(Re,Qe),B=B+Math.imul(se,et)|0,v=v+Math.imul(se,tt)|0,v=v+Math.imul(xe,et)|0,M=M+Math.imul(xe,tt)|0;var uc=(O+B|0)+((v&8191)<<13)|0;O=(M+(v>>>13)|0)+(uc>>>26)|0,uc&=67108863,B=Math.imul(Ne,et),v=Math.imul(Ne,tt),v=v+Math.imul(Re,et)|0,M=Math.imul(Re,tt);var dc=(O+B|0)+((v&8191)<<13)|0;return O=(M+(v>>>13)|0)+(dc>>>26)|0,dc&=67108863,P[0]=Go,P[1]=Wo,P[2]=Xo,P[3]=Yo,P[4]=Zo,P[5]=Jo,P[6]=Qo,P[7]=ec,P[8]=tc,P[9]=rc,P[10]=nc,P[11]=ic,P[12]=sc,P[13]=ac,P[14]=oc,P[15]=cc,P[16]=fc,P[17]=uc,P[18]=dc,O!==0&&(P[19]=O,E.length++),E};Math.imul||(y=l);function p(A,f,g){g.negative=f.negative^A.negative,g.length=A.length+f.length;for(var E=0,x=0,S=0;S<g.length-1;S++){var P=x;x=0;for(var O=E&67108863,B=Math.min(S,f.length-1),v=Math.max(0,S-A.length+1);v<=B;v++){var M=S-v,V=A.words[M]|0,z=f.words[v]|0,$=V*z,G=$&67108863;P=P+($/67108864|0)|0,G=G+O|0,O=G&67108863,P=P+(G>>>26)|0,x+=P>>>26,P&=67108863}g.words[S]=O,E=P,P=x}return E!==0?g.words[S]=E:g.length--,g.strip()}function m(A,f,g){var E=new w;return E.mulp(A,f,g)}i.prototype.mulTo=function(f,g){var E,x=this.length+f.length;return this.length===10&&f.length===10?E=y(this,f,g):x<63?E=l(this,f,g):x<1024?E=p(this,f,g):E=m(this,f,g),E};function w(A,f){this.x=A,this.y=f}w.prototype.makeRBT=function(f){for(var g=new Array(f),E=i.prototype._countBits(f)-1,x=0;x<f;x++)g[x]=this.revBin(x,E,f);return g},w.prototype.revBin=function(f,g,E){if(f===0||f===E-1)return f;for(var x=0,S=0;S<g;S++)x|=(f&1)<<g-S-1,f>>=1;return x},w.prototype.permute=function(f,g,E,x,S,P){for(var O=0;O<P;O++)x[O]=g[f[O]],S[O]=E[f[O]]},w.prototype.transform=function(f,g,E,x,S,P){this.permute(P,f,g,E,x,S);for(var O=1;O<S;O<<=1)for(var B=O<<1,v=Math.cos(2*Math.PI/B),M=Math.sin(2*Math.PI/B),V=0;V<S;V+=B)for(var z=v,$=M,G=0;G<O;G++){var Q=E[V+G],re=x[V+G],me=E[V+G+O],ne=x[V+G+O],te=z*me-$*ne;ne=z*ne+$*me,me=te,E[V+G]=Q+me,x[V+G]=re+ne,E[V+G+O]=Q-me,x[V+G+O]=re-ne,G!==B&&(te=v*z-M*$,$=v*$+M*z,z=te)}},w.prototype.guessLen13b=function(f,g){var E=Math.max(g,f)|1,x=E&1,S=0;for(E=E/2|0;E;E=E>>>1)S++;return 1<<S+1+x},w.prototype.conjugate=function(f,g,E){if(!(E<=1))for(var x=0;x<E/2;x++){var S=f[x];f[x]=f[E-x-1],f[E-x-1]=S,S=g[x],g[x]=-g[E-x-1],g[E-x-1]=-S}},w.prototype.normalize13b=function(f,g){for(var E=0,x=0;x<g/2;x++){var S=Math.round(f[2*x+1]/g)*8192+Math.round(f[2*x]/g)+E;f[x]=S&67108863,S<67108864?E=0:E=S/67108864|0}return f},w.prototype.convert13b=function(f,g,E,x){for(var S=0,P=0;P<g;P++)S=S+(f[P]|0),E[2*P]=S&8191,S=S>>>13,E[2*P+1]=S&8191,S=S>>>13;for(P=2*g;P<x;++P)E[P]=0;r(S===0),r((S&-8192)===0)},w.prototype.stub=function(f){for(var g=new Array(f),E=0;E<f;E++)g[E]=0;return g},w.prototype.mulp=function(f,g,E){var x=2*this.guessLen13b(f.length,g.length),S=this.makeRBT(x),P=this.stub(x),O=new Array(x),B=new Array(x),v=new Array(x),M=new Array(x),V=new Array(x),z=new Array(x),$=E.words;$.length=x,this.convert13b(f.words,f.length,O,x),this.convert13b(g.words,g.length,M,x),this.transform(O,P,B,v,x,S),this.transform(M,P,V,z,x,S);for(var G=0;G<x;G++){var Q=B[G]*V[G]-v[G]*z[G];v[G]=B[G]*z[G]+v[G]*V[G],B[G]=Q}return this.conjugate(B,v,x),this.transform(B,v,$,P,x,S),this.conjugate($,P,x),this.normalize13b($,x),E.negative=f.negative^g.negative,E.length=f.length+g.length,E.strip()},i.prototype.mul=function(f){var g=new i(null);return g.words=new Array(this.length+f.length),this.mulTo(f,g)},i.prototype.mulf=function(f){var g=new i(null);return g.words=new Array(this.length+f.length),m(this,f,g)},i.prototype.imul=function(f){return this.clone().mulTo(f,this)},i.prototype.imuln=function(f){r(typeof f=="number"),r(f<67108864);for(var g=0,E=0;E<this.length;E++){var x=(this.words[E]|0)*f,S=(x&67108863)+(g&67108863);g>>=26,g+=x/67108864|0,g+=S>>>26,this.words[E]=S&67108863}return g!==0&&(this.words[E]=g,this.length++),this},i.prototype.muln=function(f){return this.clone().imuln(f)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(f){var g=d(f);if(g.length===0)return new i(1);for(var E=this,x=0;x<g.length&&g[x]===0;x++,E=E.sqr());if(++x<g.length)for(var S=E.sqr();x<g.length;x++,S=S.sqr())g[x]!==0&&(E=E.mul(S));return E},i.prototype.iushln=function(f){r(typeof f=="number"&&f>=0);var g=f%26,E=(f-g)/26,x=67108863>>>26-g<<26-g,S;if(g!==0){var P=0;for(S=0;S<this.length;S++){var O=this.words[S]&x,B=(this.words[S]|0)-O<<g;this.words[S]=B|P,P=O>>>26-g}P&&(this.words[S]=P,this.length++)}if(E!==0){for(S=this.length-1;S>=0;S--)this.words[S+E]=this.words[S];for(S=0;S<E;S++)this.words[S]=0;this.length+=E}return this.strip()},i.prototype.ishln=function(f){return r(this.negative===0),this.iushln(f)},i.prototype.iushrn=function(f,g,E){r(typeof f=="number"&&f>=0);var x;g?x=(g-g%26)/26:x=0;var S=f%26,P=Math.min((f-S)/26,this.length),O=67108863^67108863>>>S<<S,B=E;if(x-=P,x=Math.max(0,x),B){for(var v=0;v<P;v++)B.words[v]=this.words[v];B.length=P}if(P!==0)if(this.length>P)for(this.length-=P,v=0;v<this.length;v++)this.words[v]=this.words[v+P];else this.words[0]=0,this.length=1;var M=0;for(v=this.length-1;v>=0&&(M!==0||v>=x);v--){var V=this.words[v]|0;this.words[v]=M<<26-S|V>>>S,M=V&O}return B&&M!==0&&(B.words[B.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(f,g,E){return r(this.negative===0),this.iushrn(f,g,E)},i.prototype.shln=function(f){return this.clone().ishln(f)},i.prototype.ushln=function(f){return this.clone().iushln(f)},i.prototype.shrn=function(f){return this.clone().ishrn(f)},i.prototype.ushrn=function(f){return this.clone().iushrn(f)},i.prototype.testn=function(f){r(typeof f=="number"&&f>=0);var g=f%26,E=(f-g)/26,x=1<<g;if(this.length<=E)return!1;var S=this.words[E];return!!(S&x)},i.prototype.imaskn=function(f){r(typeof f=="number"&&f>=0);var g=f%26,E=(f-g)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=E)return this;if(g!==0&&E++,this.length=Math.min(E,this.length),g!==0){var x=67108863^67108863>>>g<<g;this.words[this.length-1]&=x}return this.strip()},i.prototype.maskn=function(f){return this.clone().imaskn(f)},i.prototype.iaddn=function(f){return r(typeof f=="number"),r(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},i.prototype._iaddn=function(f){this.words[0]+=f;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},i.prototype.isubn=function(f){if(r(typeof f=="number"),r(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this.strip()},i.prototype.addn=function(f){return this.clone().iaddn(f)},i.prototype.subn=function(f){return this.clone().isubn(f)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(f,g,E){var x=f.length+E,S;this._expand(x);var P,O=0;for(S=0;S<f.length;S++){P=(this.words[S+E]|0)+O;var B=(f.words[S]|0)*g;P-=B&67108863,O=(P>>26)-(B/67108864|0),this.words[S+E]=P&67108863}for(;S<this.length-E;S++)P=(this.words[S+E]|0)+O,O=P>>26,this.words[S+E]=P&67108863;if(O===0)return this.strip();for(r(O===-1),O=0,S=0;S<this.length;S++)P=-(this.words[S]|0)+O,O=P>>26,this.words[S]=P&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(f,g){var E=this.length-f.length,x=this.clone(),S=f,P=S.words[S.length-1]|0,O=this._countBits(P);E=26-O,E!==0&&(S=S.ushln(E),x.iushln(E),P=S.words[S.length-1]|0);var B=x.length-S.length,v;if(g!=="mod"){v=new i(null),v.length=B+1,v.words=new Array(v.length);for(var M=0;M<v.length;M++)v.words[M]=0}var V=x.clone()._ishlnsubmul(S,1,B);V.negative===0&&(x=V,v&&(v.words[B]=1));for(var z=B-1;z>=0;z--){var $=(x.words[S.length+z]|0)*67108864+(x.words[S.length+z-1]|0);for($=Math.min($/P|0,67108863),x._ishlnsubmul(S,$,z);x.negative!==0;)$--,x.negative=0,x._ishlnsubmul(S,1,z),x.isZero()||(x.negative^=1);v&&(v.words[z]=$)}return v&&v.strip(),x.strip(),g!=="div"&&E!==0&&x.iushrn(E),{div:v||null,mod:x}},i.prototype.divmod=function(f,g,E){if(r(!f.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var x,S,P;return this.negative!==0&&f.negative===0?(P=this.neg().divmod(f,g),g!=="mod"&&(x=P.div.neg()),g!=="div"&&(S=P.mod.neg(),E&&S.negative!==0&&S.iadd(f)),{div:x,mod:S}):this.negative===0&&f.negative!==0?(P=this.divmod(f.neg(),g),g!=="mod"&&(x=P.div.neg()),{div:x,mod:P.mod}):(this.negative&f.negative)!==0?(P=this.neg().divmod(f.neg(),g),g!=="div"&&(S=P.mod.neg(),E&&S.negative!==0&&S.isub(f)),{div:P.div,mod:S}):f.length>this.length||this.cmp(f)<0?{div:new i(0),mod:this}:f.length===1?g==="div"?{div:this.divn(f.words[0]),mod:null}:g==="mod"?{div:null,mod:new i(this.modn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new i(this.modn(f.words[0]))}:this._wordDiv(f,g)},i.prototype.div=function(f){return this.divmod(f,"div",!1).div},i.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},i.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},i.prototype.divRound=function(f){var g=this.divmod(f);if(g.mod.isZero())return g.div;var E=g.div.negative!==0?g.mod.isub(f):g.mod,x=f.ushrn(1),S=f.andln(1),P=E.cmp(x);return P<0||S===1&&P===0?g.div:g.div.negative!==0?g.div.isubn(1):g.div.iaddn(1)},i.prototype.modn=function(f){r(f<=67108863);for(var g=(1<<26)%f,E=0,x=this.length-1;x>=0;x--)E=(g*E+(this.words[x]|0))%f;return E},i.prototype.idivn=function(f){r(f<=67108863);for(var g=0,E=this.length-1;E>=0;E--){var x=(this.words[E]|0)+g*67108864;this.words[E]=x/f|0,g=x%f}return this.strip()},i.prototype.divn=function(f){return this.clone().idivn(f)},i.prototype.egcd=function(f){r(f.negative===0),r(!f.isZero());var g=this,E=f.clone();g.negative!==0?g=g.umod(f):g=g.clone();for(var x=new i(1),S=new i(0),P=new i(0),O=new i(1),B=0;g.isEven()&&E.isEven();)g.iushrn(1),E.iushrn(1),++B;for(var v=E.clone(),M=g.clone();!g.isZero();){for(var V=0,z=1;(g.words[0]&z)===0&&V<26;++V,z<<=1);if(V>0)for(g.iushrn(V);V-- >0;)(x.isOdd()||S.isOdd())&&(x.iadd(v),S.isub(M)),x.iushrn(1),S.iushrn(1);for(var $=0,G=1;(E.words[0]&G)===0&&$<26;++$,G<<=1);if($>0)for(E.iushrn($);$-- >0;)(P.isOdd()||O.isOdd())&&(P.iadd(v),O.isub(M)),P.iushrn(1),O.iushrn(1);g.cmp(E)>=0?(g.isub(E),x.isub(P),S.isub(O)):(E.isub(g),P.isub(x),O.isub(S))}return{a:P,b:O,gcd:E.iushln(B)}},i.prototype._invmp=function(f){r(f.negative===0),r(!f.isZero());var g=this,E=f.clone();g.negative!==0?g=g.umod(f):g=g.clone();for(var x=new i(1),S=new i(0),P=E.clone();g.cmpn(1)>0&&E.cmpn(1)>0;){for(var O=0,B=1;(g.words[0]&B)===0&&O<26;++O,B<<=1);if(O>0)for(g.iushrn(O);O-- >0;)x.isOdd()&&x.iadd(P),x.iushrn(1);for(var v=0,M=1;(E.words[0]&M)===0&&v<26;++v,M<<=1);if(v>0)for(E.iushrn(v);v-- >0;)S.isOdd()&&S.iadd(P),S.iushrn(1);g.cmp(E)>=0?(g.isub(E),x.isub(S)):(E.isub(g),S.isub(x))}var V;return g.cmpn(1)===0?V=x:V=S,V.cmpn(0)<0&&V.iadd(f),V},i.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var g=this.clone(),E=f.clone();g.negative=0,E.negative=0;for(var x=0;g.isEven()&&E.isEven();x++)g.iushrn(1),E.iushrn(1);do{for(;g.isEven();)g.iushrn(1);for(;E.isEven();)E.iushrn(1);var S=g.cmp(E);if(S<0){var P=g;g=E,E=P}else if(S===0||E.cmpn(1)===0)break;g.isub(E)}while(!0);return E.iushln(x)},i.prototype.invm=function(f){return this.egcd(f).a.umod(f)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(f){return this.words[0]&f},i.prototype.bincn=function(f){r(typeof f=="number");var g=f%26,E=(f-g)/26,x=1<<g;if(this.length<=E)return this._expand(E+1),this.words[E]|=x,this;for(var S=x,P=E;S!==0&&P<this.length;P++){var O=this.words[P]|0;O+=S,S=O>>>26,O&=67108863,this.words[P]=O}return S!==0&&(this.words[P]=S,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(f){var g=f<0;if(this.negative!==0&&!g)return-1;if(this.negative===0&&g)return 1;this.strip();var E;if(this.length>1)E=1;else{g&&(f=-f),r(f<=67108863,"Number is too big");var x=this.words[0]|0;E=x===f?0:x<f?-1:1}return this.negative!==0?-E|0:E},i.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var g=this.ucmp(f);return this.negative!==0?-g|0:g},i.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var g=0,E=this.length-1;E>=0;E--){var x=this.words[E]|0,S=f.words[E]|0;if(x!==S){x<S?g=-1:x>S&&(g=1);break}}return g},i.prototype.gtn=function(f){return this.cmpn(f)===1},i.prototype.gt=function(f){return this.cmp(f)===1},i.prototype.gten=function(f){return this.cmpn(f)>=0},i.prototype.gte=function(f){return this.cmp(f)>=0},i.prototype.ltn=function(f){return this.cmpn(f)===-1},i.prototype.lt=function(f){return this.cmp(f)===-1},i.prototype.lten=function(f){return this.cmpn(f)<=0},i.prototype.lte=function(f){return this.cmp(f)<=0},i.prototype.eqn=function(f){return this.cmpn(f)===0},i.prototype.eq=function(f){return this.cmp(f)===0},i.red=function(f){return new I(f)},i.prototype.toRed=function(f){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(f){return this.red=f,this},i.prototype.forceRed=function(f){return r(!this.red,"Already a number in reduction context"),this._forceRed(f)},i.prototype.redAdd=function(f){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},i.prototype.redIAdd=function(f){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},i.prototype.redSub=function(f){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},i.prototype.redISub=function(f){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},i.prototype.redShl=function(f){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},i.prototype.redMul=function(f){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},i.prototype.redIMul=function(f){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(f){return r(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var C={k256:null,p224:null,p192:null,p25519:null};function T(A,f){this.name=A,this.p=new i(f,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}T.prototype._tmp=function(){var f=new i(null);return f.words=new Array(Math.ceil(this.n/13)),f},T.prototype.ireduce=function(f){var g=f,E;do this.split(g,this.tmp),g=this.imulK(g),g=g.iadd(this.tmp),E=g.bitLength();while(E>this.n);var x=E<this.n?-1:g.ucmp(this.p);return x===0?(g.words[0]=0,g.length=1):x>0?g.isub(this.p):g.strip!==void 0?g.strip():g._strip(),g},T.prototype.split=function(f,g){f.iushrn(this.n,0,g)},T.prototype.imulK=function(f){return f.imul(this.k)};function q(){T.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(q,T),q.prototype.split=function(f,g){for(var E=4194303,x=Math.min(f.length,9),S=0;S<x;S++)g.words[S]=f.words[S];if(g.length=x,f.length<=9){f.words[0]=0,f.length=1;return}var P=f.words[9];for(g.words[g.length++]=P&E,S=10;S<f.length;S++){var O=f.words[S]|0;f.words[S-10]=(O&E)<<4|P>>>22,P=O}P>>>=22,f.words[S-10]=P,P===0&&f.length>10?f.length-=10:f.length-=9},q.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var g=0,E=0;E<f.length;E++){var x=f.words[E]|0;g+=x*977,f.words[E]=g&67108863,g=x*64+(g/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function F(){T.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(F,T);function j(){T.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(j,T);function k(){T.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(k,T),k.prototype.imulK=function(f){for(var g=0,E=0;E<f.length;E++){var x=(f.words[E]|0)*19+g,S=x&67108863;x>>>=26,f.words[E]=S,g=x}return g!==0&&(f.words[f.length++]=g),f},i._prime=function(f){if(C[f])return C[f];var g;if(f==="k256")g=new q;else if(f==="p224")g=new F;else if(f==="p192")g=new j;else if(f==="p25519")g=new k;else throw new Error("Unknown prime "+f);return C[f]=g,g};function I(A){if(typeof A=="string"){var f=i._prime(A);this.m=f.p,this.prime=f}else r(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}I.prototype._verify1=function(f){r(f.negative===0,"red works only with positives"),r(f.red,"red works only with red numbers")},I.prototype._verify2=function(f,g){r((f.negative|g.negative)===0,"red works only with positives"),r(f.red&&f.red===g.red,"red works only with red numbers")},I.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):f.umod(this.m)._forceRed(this)},I.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},I.prototype.add=function(f,g){this._verify2(f,g);var E=f.add(g);return E.cmp(this.m)>=0&&E.isub(this.m),E._forceRed(this)},I.prototype.iadd=function(f,g){this._verify2(f,g);var E=f.iadd(g);return E.cmp(this.m)>=0&&E.isub(this.m),E},I.prototype.sub=function(f,g){this._verify2(f,g);var E=f.sub(g);return E.cmpn(0)<0&&E.iadd(this.m),E._forceRed(this)},I.prototype.isub=function(f,g){this._verify2(f,g);var E=f.isub(g);return E.cmpn(0)<0&&E.iadd(this.m),E},I.prototype.shl=function(f,g){return this._verify1(f),this.imod(f.ushln(g))},I.prototype.imul=function(f,g){return this._verify2(f,g),this.imod(f.imul(g))},I.prototype.mul=function(f,g){return this._verify2(f,g),this.imod(f.mul(g))},I.prototype.isqr=function(f){return this.imul(f,f.clone())},I.prototype.sqr=function(f){return this.mul(f,f)},I.prototype.sqrt=function(f){if(f.isZero())return f.clone();var g=this.m.andln(3);if(r(g%2===1),g===3){var E=this.m.add(new i(1)).iushrn(2);return this.pow(f,E)}for(var x=this.m.subn(1),S=0;!x.isZero()&&x.andln(1)===0;)S++,x.iushrn(1);r(!x.isZero());var P=new i(1).toRed(this),O=P.redNeg(),B=this.m.subn(1).iushrn(1),v=this.m.bitLength();for(v=new i(2*v*v).toRed(this);this.pow(v,B).cmp(O)!==0;)v.redIAdd(O);for(var M=this.pow(v,x),V=this.pow(f,x.addn(1).iushrn(1)),z=this.pow(f,x),$=S;z.cmp(P)!==0;){for(var G=z,Q=0;G.cmp(P)!==0;Q++)G=G.redSqr();r(Q<$);var re=this.pow(M,new i(1).iushln($-Q-1));V=V.redMul(re),M=re.redSqr(),z=z.redMul(M),$=Q}return V},I.prototype.invm=function(f){var g=f._invmp(this.m);return g.negative!==0?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},I.prototype.pow=function(f,g){if(g.isZero())return new i(1).toRed(this);if(g.cmpn(1)===0)return f.clone();var E=4,x=new Array(1<<E);x[0]=new i(1).toRed(this),x[1]=f;for(var S=2;S<x.length;S++)x[S]=this.mul(x[S-1],f);var P=x[0],O=0,B=0,v=g.bitLength()%26;for(v===0&&(v=26),S=g.length-1;S>=0;S--){for(var M=g.words[S],V=v-1;V>=0;V--){var z=M>>V&1;if(P!==x[0]&&(P=this.sqr(P)),z===0&&O===0){B=0;continue}O<<=1,O|=z,B++,!(B!==E&&(S!==0||V!==0))&&(P=this.mul(P,x[O]),B=0,O=0)}v=26}return P},I.prototype.convertTo=function(f){var g=f.umod(this.m);return g===f?g.clone():g},I.prototype.convertFrom=function(f){var g=f.clone();return g.red=null,g},i.mont=function(f){return new R(f)};function R(A){I.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(R,I),R.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},R.prototype.convertFrom=function(f){var g=this.imod(f.mul(this.rinv));return g.red=null,g},R.prototype.imul=function(f,g){if(f.isZero()||g.isZero())return f.words[0]=0,f.length=1,f;var E=f.imul(g),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=E.isub(x).iushrn(this.shift),P=S;return S.cmp(this.m)>=0?P=S.isub(this.m):S.cmpn(0)<0&&(P=S.iadd(this.m)),P._forceRed(this)},R.prototype.mul=function(f,g){if(f.isZero()||g.isZero())return new i(0)._forceRed(this);var E=f.mul(g),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=E.isub(x).iushrn(this.shift),P=S;return S.cmp(this.m)>=0?P=S.isub(this.m):S.cmpn(0)<0&&(P=S.iadd(this.m)),P._forceRed(this)},R.prototype.invm=function(f){var g=this.imod(f._invmp(this.m).mul(this.r2));return g._forceRed(this)}})(typeof Jb>"u"||Jb,j8)});var yi=K(k8=>{D();N();var us=k8,YD=si(),ZD=mm(),Nh=wm();us.assert=ZD;us.toArray=Nh.toArray;us.zero2=Nh.zero2;us.toHex=Nh.toHex;us.encode=Nh.encode;function JD(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),a=0;a<n.length;a++){var o,c=s.andln(i-1);s.isOdd()?(c>(i>>1)-1?o=(i>>1)-c:o=c,s.isubn(o)):o=0,n[a]=o,s.iushrn(1)}return n}us.getNAF=JD;function QD(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n=0,i=0,s;e.cmpn(-n)>0||t.cmpn(-i)>0;){var a=e.andln(3)+n&3,o=t.andln(3)+i&3;a===3&&(a=-1),o===3&&(o=-1);var c;(a&1)===0?c=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?c=-a:c=a),r[0].push(c);var u;(o&1)===0?u=0:(s=t.andln(7)+i&7,(s===3||s===5)&&a===2?u=-o:u=o),r[1].push(u),2*n===c+1&&(n=1-n),2*i===u+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return r}us.getJSF=QD;function eN(e,t,r){var n="_"+t;e.prototype[t]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}us.cachedProperty=eN;function tN(e){return typeof e=="string"?us.toArray(e,"hex"):e}us.parseBytes=tN;function rN(e){return new YD(e,"hex","le")}us.intFromLE=rN});var n0=K((Cee,L8)=>{D();N();var r0=yi(),Rc=si(),Rh=r0.getNAF,nN=r0.getJSF,Fh=r0.assert;function lo(e,t){this.type=e,this.p=new Rc(t.p,16),this.red=t.prime?Rc.red(t.prime):Rc.mont(this.p),this.zero=new Rc(0).toRed(this.red),this.one=new Rc(1).toRed(this.red),this.two=new Rc(2).toRed(this.red),this.n=t.n&&new Rc(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}L8.exports=lo;lo.prototype.point=function(){throw new Error("Not implemented")};lo.prototype.validate=function(){throw new Error("Not implemented")};lo.prototype._fixedNafMul=function(t,r){Fh(t.precomputed);var n=t._getDoubles(),i=Rh(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var a=[],o,c;for(o=0;o<i.length;o+=n.step){c=0;for(var u=o+n.step-1;u>=o;u--)c=(c<<1)+i[u];a.push(c)}for(var b=this.jpoint(null,null,null),h=this.jpoint(null,null,null),d=s;d>0;d--){for(o=0;o<a.length;o++)c=a[o],c===d?h=h.mixedAdd(n.points[o]):c===-d&&(h=h.mixedAdd(n.points[o].neg()));b=b.add(h)}return b.toP()};lo.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var s=i.points,a=Rh(r,n,this._bitLength),o=this.jpoint(null,null,null),c=a.length-1;c>=0;c--){for(var u=0;c>=0&&a[c]===0;c--)u++;if(c>=0&&u++,o=o.dblp(u),c<0)break;var b=a[c];Fh(b!==0),t.type==="affine"?b>0?o=o.mixedAdd(s[b-1>>1]):o=o.mixedAdd(s[-b-1>>1].neg()):b>0?o=o.add(s[b-1>>1]):o=o.add(s[-b-1>>1].neg())}return t.type==="affine"?o.toP():o};lo.prototype._wnafMulAdd=function(t,r,n,i,s){var a=this._wnafT1,o=this._wnafT2,c=this._wnafT3,u=0,b,h,d;for(b=0;b<i;b++){d=r[b];var l=d._getNAFPoints(t);a[b]=l.wnd,o[b]=l.points}for(b=i-1;b>=1;b-=2){var y=b-1,p=b;if(a[y]!==1||a[p]!==1){c[y]=Rh(n[y],a[y],this._bitLength),c[p]=Rh(n[p],a[p],this._bitLength),u=Math.max(c[y].length,u),u=Math.max(c[p].length,u);continue}var m=[r[y],null,null,r[p]];r[y].y.cmp(r[p].y)===0?(m[1]=r[y].add(r[p]),m[2]=r[y].toJ().mixedAdd(r[p].neg())):r[y].y.cmp(r[p].y.redNeg())===0?(m[1]=r[y].toJ().mixedAdd(r[p]),m[2]=r[y].add(r[p].neg())):(m[1]=r[y].toJ().mixedAdd(r[p]),m[2]=r[y].toJ().mixedAdd(r[p].neg()));var w=[-3,-1,-5,-7,0,7,5,1,3],C=nN(n[y],n[p]);for(u=Math.max(C[0].length,u),c[y]=new Array(u),c[p]=new Array(u),h=0;h<u;h++){var T=C[0][h]|0,q=C[1][h]|0;c[y][h]=w[(T+1)*3+(q+1)],c[p][h]=0,o[y]=m}}var F=this.jpoint(null,null,null),j=this._wnafT4;for(b=u;b>=0;b--){for(var k=0;b>=0;){var I=!0;for(h=0;h<i;h++)j[h]=c[h][b]|0,j[h]!==0&&(I=!1);if(!I)break;k++,b--}if(b>=0&&k++,F=F.dblp(k),b<0)break;for(h=0;h<i;h++){var R=j[h];R!==0&&(R>0?d=o[h][R-1>>1]:R<0&&(d=o[h][-R-1>>1].neg()),d.type==="affine"?F=F.mixedAdd(d):F=F.add(d))}}for(b=0;b<i;b++)o[b]=null;return s?F:F.toP()};function Fi(e,t){this.curve=e,this.type=t,this.precomputed=null}lo.BasePoint=Fi;Fi.prototype.eq=function(){throw new Error("Not implemented")};Fi.prototype.validate=function(){return this.curve.validate(this)};lo.prototype.decodePoint=function(t,r){t=r0.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*n){t[0]===6?Fh(t[t.length-1]%2===0):t[0]===7&&Fh(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};Fi.prototype.encodeCompressed=function(t){return this.encode(t,!0)};Fi.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};Fi.prototype.encode=function(t,r){return r0.encode(this._encode(r),t)};Fi.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};Fi.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};Fi.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=t){for(var a=0;a<t;a++)i=i.dbl();n.push(i)}return{step:t,points:n}};Fi.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:t,points:r}};Fi.prototype._getBeta=function(){return null};Fi.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r}});var V8=K((Mee,K8)=>{D();N();var iN=yi(),pr=si(),Qb=cf(),nu=n0(),sN=iN.assert;function qi(e){nu.call(this,"short",e),this.a=new pr(e.a,16).toRed(this.red),this.b=new pr(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Qb(qi,nu);K8.exports=qi;qi.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new pr(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new pr(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],sN(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var a;return t.basis?a=t.basis.map(function(o){return{a:new pr(o.a,16),b:new pr(o.b,16)}}):a=this._getEndoBasis(n),{beta:r,lambda:n,basis:a}}};qi.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:pr.mont(t),n=new pr(2).toRed(r).redInvm(),i=n.redNeg(),s=new pr(3).toRed(r).redNeg().redSqrt().redMul(n),a=i.redAdd(s).fromRed(),o=i.redSub(s).fromRed();return[a,o]};qi.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),s=new pr(1),a=new pr(0),o=new pr(0),c=new pr(1),u,b,h,d,l,y,p,m=0,w,C;n.cmpn(0)!==0;){var T=i.div(n);w=i.sub(T.mul(n)),C=o.sub(T.mul(s));var q=c.sub(T.mul(a));if(!h&&w.cmp(r)<0)u=p.neg(),b=s,h=w.neg(),d=C;else if(h&&++m===2)break;p=w,i=n,n=w,o=s,s=C,c=a,a=q}l=w.neg(),y=C;var F=h.sqr().add(d.sqr()),j=l.sqr().add(y.sqr());return j.cmp(F)>=0&&(l=u,y=b),h.negative&&(h=h.neg(),d=d.neg()),l.negative&&(l=l.neg(),y=y.neg()),[{a:h,b:d},{a:l,b:y}]};qi.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(t).divRound(this.n),a=n.b.neg().mul(t).divRound(this.n),o=s.mul(n.a),c=a.mul(i.a),u=s.mul(n.b),b=a.mul(i.b),h=t.sub(o).sub(c),d=u.add(b).neg();return{k1:h,k2:d}};qi.prototype.pointFromX=function(t,r){t=new pr(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(t,i)};qi.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};qi.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,a=0;a<t.length;a++){var o=this._endoSplit(r[a]),c=t[a],u=c._getBeta();o.k1.negative&&(o.k1.ineg(),c=c.neg(!0)),o.k2.negative&&(o.k2.ineg(),u=u.neg(!0)),i[a*2]=c,i[a*2+1]=u,s[a*2]=o.k1,s[a*2+1]=o.k2}for(var b=this._wnafMulAdd(1,i,s,a*2,n),h=0;h<a*2;h++)i[h]=null,s[h]=null;return b};function Zr(e,t,r,n){nu.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new pr(t,16),this.y=new pr(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Qb(Zr,nu.BasePoint);qi.prototype.point=function(t,r,n){return new Zr(this,t,r,n)};qi.prototype.pointFromJSON=function(t,r){return Zr.fromJSON(this,t,r)};Zr.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};Zr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Zr.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function s(o){return t.point(o[0],o[1],n)}var a=r[2];return i.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[i].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[i].concat(a.naf.points.map(s))}},i};Zr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Zr.prototype.isInfinity=function(){return this.inf};Zr.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Zr.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),a=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,o)};Zr.prototype.getX=function(){return this.x.fromRed()};Zr.prototype.getY=function(){return this.y.fromRed()};Zr.prototype.mul=function(t){return t=new pr(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};Zr.prototype.mulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};Zr.prototype.jmulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};Zr.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};Zr.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};Zr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function gn(e,t,r,n){nu.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new pr(0)):(this.x=new pr(t,16),this.y=new pr(r,16),this.z=new pr(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Qb(gn,nu.BasePoint);qi.prototype.jpoint=function(t,r,n){return new gn(this,t,r,n)};gn.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};gn.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};gn.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(n),a=this.y.redMul(r.redMul(t.z)),o=t.y.redMul(n.redMul(this.z)),c=i.redSub(s),u=a.redSub(o);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=c.redSqr(),h=b.redMul(c),d=i.redMul(b),l=u.redSqr().redIAdd(h).redISub(d).redISub(d),y=u.redMul(d.redISub(l)).redISub(a.redMul(h)),p=this.z.redMul(t.z).redMul(c);return this.curve.jpoint(l,y,p)};gn.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),s=this.y,a=t.y.redMul(r).redMul(this.z),o=n.redSub(i),c=s.redSub(a);if(o.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=o.redSqr(),b=u.redMul(o),h=n.redMul(u),d=c.redSqr().redIAdd(b).redISub(h).redISub(h),l=c.redMul(h.redISub(d)).redISub(s.redMul(b)),y=this.z.redMul(o);return this.curve.jpoint(d,l,y)};gn.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,a=this.x,o=this.y,c=this.z,u=c.redSqr().redSqr(),b=o.redAdd(o);for(r=0;r<t;r++){var h=a.redSqr(),d=b.redSqr(),l=d.redSqr(),y=h.redAdd(h).redIAdd(h).redIAdd(i.redMul(u)),p=a.redMul(d),m=y.redSqr().redISub(p.redAdd(p)),w=p.redISub(m),C=y.redMul(w);C=C.redIAdd(C).redISub(l);var T=b.redMul(c);r+1<t&&(u=u.redMul(l)),a=m,c=T,b=C}return this.curve.jpoint(a,b.redMul(s),c)};gn.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};gn.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(a);o=o.redIAdd(o);var c=i.redAdd(i).redIAdd(i),u=c.redSqr().redISub(o).redISub(o),b=a.redIAdd(a);b=b.redIAdd(b),b=b.redIAdd(b),t=u,r=c.redMul(o.redISub(u)).redISub(b),n=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),d=this.y.redSqr(),l=d.redSqr(),y=this.x.redAdd(d).redSqr().redISub(h).redISub(l);y=y.redIAdd(y);var p=h.redAdd(h).redIAdd(h),m=p.redSqr(),w=l.redIAdd(l);w=w.redIAdd(w),w=w.redIAdd(w),t=m.redISub(y).redISub(y),r=p.redMul(y.redISub(t)).redISub(w),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};gn.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(a);o=o.redIAdd(o);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=c.redSqr().redISub(o).redISub(o);t=u;var b=a.redIAdd(a);b=b.redIAdd(b),b=b.redIAdd(b),r=c.redMul(o.redISub(u)).redISub(b),n=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),d=this.y.redSqr(),l=this.x.redMul(d),y=this.x.redSub(h).redMul(this.x.redAdd(h));y=y.redAdd(y).redIAdd(y);var p=l.redIAdd(l);p=p.redIAdd(p);var m=p.redAdd(p);t=y.redSqr().redISub(m),n=this.y.redAdd(this.z).redSqr().redISub(d).redISub(h);var w=d.redSqr();w=w.redIAdd(w),w=w.redIAdd(w),w=w.redIAdd(w),r=y.redMul(p.redISub(t)).redISub(w)}return this.curve.jpoint(t,r,n)};gn.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),a=r.redSqr(),o=n.redSqr(),c=a.redAdd(a).redIAdd(a).redIAdd(t.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var b=u.redMul(o),h=c.redSqr().redISub(b.redAdd(b)),d=b.redISub(h),l=o.redSqr();l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var y=c.redMul(d).redISub(l),p=n.redAdd(n).redMul(i);return this.curve.jpoint(h,y,p)};gn.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=t.redAdd(t).redIAdd(t),a=s.redSqr(),o=this.x.redAdd(r).redSqr().redISub(t).redISub(i);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(a);var c=o.redSqr(),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var b=s.redIAdd(o).redSqr().redISub(a).redISub(c).redISub(u),h=r.redMul(b);h=h.redIAdd(h),h=h.redIAdd(h);var d=this.x.redMul(c).redISub(h);d=d.redIAdd(d),d=d.redIAdd(d);var l=this.y.redMul(b.redMul(u.redISub(b)).redISub(o.redMul(c)));l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var y=this.z.redAdd(o).redSqr().redISub(n).redISub(c);return this.curve.jpoint(d,l,y)};gn.prototype.mul=function(t,r){return t=new pr(t,r),this.curve._wnafMul(this,t)};gn.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(i)).cmpn(0)===0};gn.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};gn.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};gn.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var $8=K((Dee,z8)=>{D();N();var iu=si(),U8=cf(),qh=n0(),aN=yi();function su(e){qh.call(this,"mont",e),this.a=new iu(e.a,16).toRed(this.red),this.b=new iu(e.b,16).toRed(this.red),this.i4=new iu(4).toRed(this.red).redInvm(),this.two=new iu(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}U8(su,qh);z8.exports=su;su.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function Jr(e,t,r){qh.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new iu(t,16),this.z=new iu(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}U8(Jr,qh.BasePoint);su.prototype.decodePoint=function(t,r){return this.point(aN.toArray(t,r),1)};su.prototype.point=function(t,r){return new Jr(this,t,r)};su.prototype.pointFromJSON=function(t){return Jr.fromJSON(this,t)};Jr.prototype.precompute=function(){};Jr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Jr.fromJSON=function(t,r){return new Jr(t,r[0],r[1]||t.one)};Jr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Jr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Jr.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),a=r.redMul(i),o=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(a,o)};Jr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Jr.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=t.x.redAdd(t.z),a=t.x.redSub(t.z),o=a.redMul(n),c=s.redMul(i),u=r.z.redMul(o.redAdd(c).redSqr()),b=r.x.redMul(o.redISub(c).redSqr());return this.curve.point(u,b)};Jr.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),s=this,a=[];r.cmpn(0)!==0;r.iushrn(1))a.push(r.andln(1));for(var o=a.length-1;o>=0;o--)a[o]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};Jr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Jr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Jr.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};Jr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Jr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var X8=K((Fee,W8)=>{D();N();var oN=yi(),ya=si(),G8=cf(),Hh=n0(),cN=oN.assert;function Ms(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,Hh.call(this,"edwards",e),this.a=new ya(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new ya(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new ya(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),cN(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}G8(Ms,Hh);W8.exports=Ms;Ms.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};Ms.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};Ms.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};Ms.prototype.pointFromX=function(t,r){t=new ya(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),a=i.redMul(s.redInvm()),o=a.redSqrt();if(o.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");var c=o.fromRed().isOdd();return(r&&!c||!r&&c)&&(o=o.redNeg()),this.point(t,o)};Ms.prototype.pointFromY=function(t,r){t=new ya(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),a=i.redMul(s.redInvm());if(a.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var o=a.redSqrt();if(o.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");return o.fromRed().isOdd()!==r&&(o=o.redNeg()),this.point(o,t)};Ms.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function kt(e,t,r,n,i){Hh.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new ya(t,16),this.y=new ya(r,16),this.z=n?new ya(n,16):this.curve.one,this.t=i&&new ya(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}G8(kt,Hh.BasePoint);Ms.prototype.pointFromJSON=function(t){return kt.fromJSON(this,t)};Ms.prototype.point=function(t,r,n,i){return new kt(this,t,r,n,i)};kt.fromJSON=function(t,r){return new kt(t,r[0],r[1],r[2])};kt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};kt.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};kt.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),a=i.redAdd(r),o=a.redSub(n),c=i.redSub(r),u=s.redMul(o),b=a.redMul(c),h=s.redMul(c),d=o.redMul(a);return this.curve.point(u,b,d,h)};kt.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,a,o,c,u;if(this.curve.twisted){o=this.curve._mulA(r);var b=o.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(b.redSub(this.curve.two)),s=b.redMul(o.redSub(n)),a=b.redSqr().redSub(b).redSub(b)):(c=this.z.redSqr(),u=b.redSub(c).redISub(c),i=t.redSub(r).redISub(n).redMul(u),s=b.redMul(o.redSub(n)),a=b.redMul(u))}else o=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),u=o.redSub(c).redSub(c),i=this.curve._mulC(t.redISub(o)).redMul(u),s=this.curve._mulC(o).redMul(r.redISub(n)),a=o.redMul(u);return this.curve.point(i,s,a)};kt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};kt.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),a=n.redSub(r),o=s.redSub(i),c=s.redAdd(i),u=n.redAdd(r),b=a.redMul(o),h=c.redMul(u),d=a.redMul(u),l=o.redMul(c);return this.curve.point(b,h,l,d)};kt.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),s=this.y.redMul(t.y),a=this.curve.d.redMul(i).redMul(s),o=n.redSub(a),c=n.redAdd(a),u=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),b=r.redMul(o).redMul(u),h,d;return this.curve.twisted?(h=r.redMul(c).redMul(s.redSub(this.curve._mulA(i))),d=o.redMul(c)):(h=r.redMul(c).redMul(s.redSub(i)),d=this.curve._mulC(o).redMul(c)),this.curve.point(b,h,d)};kt.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};kt.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};kt.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};kt.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};kt.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};kt.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};kt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};kt.prototype.getY=function(){return this.normalize(),this.y.fromRed()};kt.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};kt.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};kt.prototype.toP=kt.prototype.normalize;kt.prototype.mixedAdd=kt.prototype.add});var eg=K(Y8=>{D();N();var jh=Y8;jh.base=n0();jh.short=V8();jh.mont=$8();jh.edwards=X8()});var J8=K((Kee,Z8)=>{D();N();Z8.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var kh=K(t9=>{D();N();var rg=t9,ho=tl(),tg=eg(),fN=yi(),Q8=fN.assert;function e9(e){e.type==="short"?this.curve=new tg.short(e):e.type==="edwards"?this.curve=new tg.edwards(e):this.curve=new tg.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,Q8(this.g.validate(),"Invalid curve"),Q8(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}rg.PresetCurve=e9;function po(e,t){Object.defineProperty(rg,e,{configurable:!0,enumerable:!0,get:function(){var r=new e9(t);return Object.defineProperty(rg,e,{configurable:!0,enumerable:!0,value:r}),r}})}po("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:ho.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});po("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:ho.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});po("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:ho.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});po("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:ho.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});po("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:ho.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});po("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:ho.sha256,gRed:!1,g:["9"]});po("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:ho.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var ng;try{ng=J8()}catch{ng=void 0}po("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:ho.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",ng]})});var n9=K((Wee,r9)=>{D();N();var uN=si(),dN=yi(),ig=dN.assert;function Mn(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}r9.exports=Mn;Mn.fromPublic=function(t,r,n){return r instanceof Mn?r:new Mn(t,{pub:r,pubEnc:n})};Mn.fromPrivate=function(t,r,n){return r instanceof Mn?r:new Mn(t,{priv:r,privEnc:n})};Mn.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Mn.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};Mn.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};Mn.prototype._importPrivate=function(t,r){this.priv=new uN(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};Mn.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?ig(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&ig(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};Mn.prototype.derive=function(t){return t.validate()||ig(t.validate(),"public point not validated"),t.mul(this.priv).getX()};Mn.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};Mn.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};Mn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var a9=K((Zee,s9)=>{D();N();var Lh=si(),og=yi(),lN=og.assert;function i0(e,t,r){if(t instanceof i0)return t;this._importDER(t,r)||(lN(t.r&&t.s,"Signature without r or s"),this.r=new Lh(t.r,16),this.s=new Lh(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam,this.curve=e,this.byteLength=this.curve.n.byteLength())}s9.exports=i0;function hN(){this.place=0}function sg(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,a=t.place;s<n;s++,a++)i<<=8,i|=e[a],i>>>=0;return i<=127?!1:(t.place=a,i)}function i9(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}i0.prototype._importDER=function(t,r){t=og.toArray(t,r);var n=new hN;if(t[n.place++]!==48)return!1;var i=sg(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var s=sg(t,n);if(s===!1)return!1;var a=t.slice(n.place,s+n.place);if(n.place+=s,t[n.place++]!==2)return!1;var o=sg(t,n);if(o===!1||t.length!==o+n.place)return!1;var c=t.slice(n.place,o+n.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Lh(a),this.s=new Lh(c),this.recoveryParam=null,!0};function ag(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}i0.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=i9(r),n=i9(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];ag(i,r.length),i=i.concat(r),i.push(2),ag(i,n.length);var s=i.concat(n),a=[48];return ag(a,s.length),a=a.concat(s),og.encode(a,t)};i0.prototype.toBytes=function(){let t=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return t.concat(r)}});var f9=K((ete,c9)=>{D();N();var ma=si(),o9=Sm(),pN=yi(),cg=kh(),bN=xm(),Fc=pN.assert,fg=n9(),Kh=a9();function Hi(e){if(!(this instanceof Hi))return new Hi(e);typeof e=="string"&&(Fc(Object.prototype.hasOwnProperty.call(cg,e),"Unknown curve "+e),e=cg[e]),e instanceof cg.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}c9.exports=Hi;Hi.prototype.keyPair=function(t){return new fg(this,t)};Hi.prototype.keyFromPrivate=function(t,r){return fg.fromPrivate(this,t,r)};Hi.prototype.keyFromPublic=function(t,r){return fg.fromPublic(this,t,r)};Hi.prototype.genKeyPair=function(t){t||(t={});for(var r=new o9({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||bN(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new ma(2));;){var s=new ma(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Hi.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};Hi.prototype.sign=function(t,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof t!="string"&&typeof t!="number"&&!ma.isBN(t)){Fc(typeof t=="object"&&t&&typeof t.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Fc(t.length>>>0===t.length);for(var s=0;s<t.length;s++)Fc((t[s]&255)===t[s])}r=this.keyFromPrivate(r,n),t=this._truncateToN(new ma(t,16)),Fc(!t.isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),o=r.getPrivate().toArray("be",a),c=t.toArray("be",a);Fc(new ma(c).eq(t),"Can not sign message");for(var u=new o9({hash:this.hash,entropy:o,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),b=this.n.sub(new ma(1)),h=0;;h++){var d=i.k?i.k(h):new ma(u.generate(this.n.byteLength()));if(d=this._truncateToN(d,!0),!(d.cmpn(1)<=0||d.cmp(b)>=0)){var l=this.g.mul(d);if(!l.isInfinity()){var y=l.getX(),p=y.umod(this.n);if(p.cmpn(0)!==0){var m=d.invm(this.n).mul(p.mul(r.getPrivate()).iadd(t));if(m=m.umod(this.n),m.cmpn(0)!==0){var w=(l.getY().isOdd()?1:0)|(y.cmp(p)!==0?2:0);return i.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),w^=1),new Kh(this.curve,{r:p,s:m,recoveryParam:w})}}}}}};Hi.prototype.verify=function(t,r,n,i){t=this._truncateToN(new ma(t,16)),n=this.keyFromPublic(n,i),r=new Kh(this.curve,r,"hex");var s=r.r,a=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var o=a.invm(this.n),c=o.mul(t).umod(this.n),u=o.mul(s).umod(this.n),b;return this.curve._maxwellTrick?(b=this.g.jmulAdd(c,n.getPublic(),u),b.isInfinity()?!1:b.eqXToP(s)):(b=this.g.mulAdd(c,n.getPublic(),u),b.isInfinity()?!1:b.getX().umod(this.n).cmp(s)===0)};Hi.prototype.recoverPubKey=function(e,t,r,n){Fc((3&r)===r,"The recovery param is more than two bits"),t=new Kh(this.curve,t,n);var i=this.n,s=new ma(e),a=t.r,o=t.s,c=r&1,u=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?a=this.curve.pointFromX(a.add(this.curve.n),c):a=this.curve.pointFromX(a,c);var b=t.r.invm(i),h=i.sub(s).mul(b).umod(i),d=o.mul(b).umod(i);return this.g.mulAdd(h,a,d)};Hi.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new Kh(this.curve,t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var h9=K((nte,l9)=>{D();N();var s0=yi(),d9=s0.assert,u9=s0.parseBytes,au=s0.cachedProperty;function Qr(e,t){this.eddsa=e,this._secret=u9(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=u9(t.pub)}Qr.fromPublic=function(t,r){return r instanceof Qr?r:new Qr(t,{pub:r})};Qr.fromSecret=function(t,r){return r instanceof Qr?r:new Qr(t,{secret:r})};Qr.prototype.secret=function(){return this._secret};au(Qr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});au(Qr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});au(Qr,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});au(Qr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});au(Qr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});au(Qr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Qr.prototype.sign=function(t){return d9(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};Qr.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};Qr.prototype.getSecret=function(t){return d9(this._secret,"KeyPair is public only"),s0.encode(this.secret(),t)};Qr.prototype.getPublic=function(t){return s0.encode(this.pubBytes(),t)};l9.exports=Qr});var b9=K((ate,p9)=>{D();N();var gN=si(),Vh=yi(),vN=Vh.assert,Uh=Vh.cachedProperty,yN=Vh.parseBytes;function qc(e,t){this.eddsa=e,typeof t!="object"&&(t=yN(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),vN(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof gN&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Uh(qc,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Uh(qc,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Uh(qc,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Uh(qc,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});qc.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};qc.prototype.toHex=function(){return Vh.encode(this.toBytes(),"hex").toUpperCase()};p9.exports=qc});var w9=K((fte,m9)=>{D();N();var mN=tl(),wN=kh(),ou=yi(),_N=ou.assert,v9=ou.parseBytes,y9=h9(),g9=b9();function ai(e){if(_N(e==="ed25519","only tested with ed25519 so far"),!(this instanceof ai))return new ai(e);e=wN[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=mN.sha512}m9.exports=ai;ai.prototype.sign=function(t,r){t=v9(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),s=this.g.mul(i),a=this.encodePoint(s),o=this.hashInt(a,n.pubBytes(),t).mul(n.priv()),c=i.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:a})};ai.prototype.verify=function(t,r,n){t=v9(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),t),a=this.g.mul(r.S()),o=r.R().add(i.pub().mul(s));return o.eq(a)};ai.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return ou.intFromLE(t.digest()).umod(this.curve.n)};ai.prototype.keyFromPublic=function(t){return y9.fromPublic(this,t)};ai.prototype.keyFromSecret=function(t){return y9.fromSecret(this,t)};ai.prototype.makeSignature=function(t){return t instanceof g9?t:new g9(this,t)};ai.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};ai.prototype.decodePoint=function(t){t=ou.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&-129),i=(t[r]&128)!==0,s=ou.intFromLE(n);return this.curve.pointFromY(s,i)};ai.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};ai.prototype.decodeInt=function(t){return ou.intFromLE(t)};ai.prototype.isPoint=function(t){return t instanceof this.pointClass}});var cu=K(ji=>{D();N();Object.defineProperty(ji,"__esModule",{value:!0});ji.utils=ji.curves=ji.curve=ji.eddsa=ji.ec=void 0;var SN=eg();ji.curve=SN;var xN=kh();ji.curves=xN;var EN=f9();ji.ec=EN;var AN=w9();ji.eddsa=AN;var PN=yi();ji.utils=PN});var x9=K((_9,S9)=>{D();N();Object.defineProperty(_9,"__esModule",{value:!0});var CN=cu(),Ts=new CN.ec("secp256k1"),dt=Ts.curve,Lt=si();function IN(e,t){let r=new Lt(t);if(r.cmp(dt.p)>=0)return null;r=r.toRed(dt.red);let n=r.redSqr().redIMul(r).redIAdd(dt.b).redSqrt();e===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(dt.b)).isZero()?Ts.keyPair({pub:{x:r,y:n}}):null}function BN(e,t,r){let n=new Lt(t),i=new Lt(r);if(n.cmp(dt.p)>=0||i.cmp(dt.p)>=0||(n=n.toRed(dt.red),i=i.toRed(dt.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(dt.b)).isZero()?Ts.keyPair({pub:{x:n,y:i}}):null}function bo(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:IN(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:BN(t,e.subarray(1,33),e.subarray(33,65));default:return null}}S9.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new Lt(e);return t.cmp(dt.n)<0&&!t.isZero()},privateKeyNegate(e){let t=new Lt(e);return H.Buffer.from(dt.n.sub(t).umod(dt.n).toArray("be",32))},privateKeyTweakAdd(e,t){let r=new Lt(t);return r.cmp(dt.n)>=0||(r.iadd(new Lt(e)),r.cmp(dt.n)>=0&&r.isub(dt.n),r.isZero())?null:H.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(e,t){let r=new Lt(t);return r.cmp(dt.n)>=0||r.isZero()?1:(r.imul(new Lt(e)),r.cmp(dt.n)>=0&&(r=r.umod(dt.n)),H.Buffer.from(r.toArray("be",32)))},publicKeyVerify(e){let t=bo(e);return t==null?null:t.validate().result},publicKeyCreate(e,t){let r=new Lt(e);if(r.cmp(dt.n)>=0||r.isZero())return null;let n=Ts.keyFromPrivate(e,null).getPublic();return H.Buffer.from(n.encode(null,t))},publicKeyConvert(e,t){let n=bo(e).getPublic();return H.Buffer.from(n.encode(null,t))},publicKeyNegate(e,t){let r=bo(e);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),H.Buffer.from(n.encode(null,t))},publicKeyCombine(e,t){let r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=bo(e[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:H.Buffer.from(n.encode(null,t))},publicKeyTweakAdd(e,t,r){let n=bo(e);if(n===null||new Lt(t).cmp(dt.n)>=0)return null;let s=n.getPublic().add(dt.g.mul(t));return s.isInfinity()?null:H.Buffer.from(s.encode(null,r))},publicKeyTweakMul(e,t,r){let n=bo(e);if(n===null)return null;let i=new Lt(t);if(i.cmp(dt.n)>=0||i.isZero())return null;let s=n.getPublic().mul(t);return H.Buffer.from(s.encode(null,r))},signatureNormalize(e){let t=new Lt(e.subarray(0,32)),r=new Lt(e.subarray(32,64));return t.cmp(dt.n)>=0||r.cmp(dt.n)>=0?null:(r.cmp(Ts.nh)===1&&e.set(dt.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new Lt(r).cmp(dt.n)>=0||new Lt(n).cmp(dt.n)>=0)return 1;let{output:i}=e,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let a=33,o=0;for(;a>1&&s[o]===0&&!(s[o+1]&128);--a,++o);if(s=s.subarray(o),s[0]&128||a>1&&s[0]===0&&!(s[1]&128))return 1;let c=i.subarray(6+33,6+33+33);c[0]=0,c.set(n,1);let u=33,b=0;for(;u>1&&c[b]===0&&!(c[b+1]&128);--u,++b);return c=c.subarray(b),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(e.outputlen=6+a+u,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+a]=2,i[5+a]=c.length,i.set(c,6+a),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let i=t.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let a=new Lt(i);a.cmp(dt.n)>=0&&(a=new Lt(0));let o=new Lt(t.subarray(6+r));return o.cmp(dt.n)>=0&&(o=new Lt(0)),e.set(a.toArrayLike(Uint8Array,"be",32),0),e.set(o.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t){let r=new Lt(t);return r.cmp(dt.n)>=0||r.isZero()?null:Ts.sign(e,t,{canonical:!0}).toBytes()},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},i=new Lt(n.r),s=new Lt(n.s);if(i.cmp(dt.n)>=0||s.cmp(dt.n)>=0)return 1;if(s.cmp(Ts.nh)===1||i.isZero()||s.isZero())return 3;let a=bo(r);if(a===null)return 2;let o=a.getPublic();return Ts.verify(t,n,o)},ecdsaRecover(e,t,r,n){let i={r:e.slice(0,32),s:e.slice(32,64)},s=new Lt(i.r),a=new Lt(i.s);if(s.cmp(dt.n)>=0||a.cmp(dt.n)>=0)return 1;if(s.isZero()||a.isZero())return 2;let o;try{o=Ts.recoverPubKey(r,i,t,null)}catch{return 2}return H.Buffer.from(o.encode(null,n))},ecdh(e,t,r,n,i,s,a){let o=bo(t);if(o===null)return 1;let c=new Lt(r);if(c.cmp(dt.n)>=0||c.isZero())return 2;let u=o.getPublic().mul(c);if(i===void 0){let b=u.encode(null,!0),h=Ts.hash().update(b).digest();for(let d=0;d<32;++d)e[d]=h[d]}else{s||(s=new Uint8Array(32));let b=u.getX().toArray("be",32);for(let y=0;y<32;++y)s[y]=b[y];a||(a=new Uint8Array(32));let h=u.getY().toArray("be",32);for(let y=0;y<32;++y)a[y]=h[y];let d=i(s,a,n);if(!(d instanceof Uint8Array&&d.length===e.length))return 2;e.set(d)}return 0}}});var I9=K(en=>{D();N();var MN=en&&en.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),TN=en&&en.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ON=en&&en.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&MN(t,e,r);return TN(t,e),t};Object.defineProperty(en,"__esModule",{value:!0});en.fromSeed=en.fromPublicKey=en.fromPrivateKey=en.fromBase58=en.tinySecp256k1Interface=void 0;var ug=ON(t0()),DN=lc(),NN=Ch(),A9=(0,DN.base58check)(NN.sha256),P9=x9(),vn=Em(),RN=Am();function FN(e){return{isPoint:t=>e.publicKeyVerify(t),isPrivate:t=>e.privateKeyVerify(t),pointAddScalar:(t,r,n)=>e.publicKeyTweakAdd(t,r,n),pointFromScalar:(t,r)=>e.publicKeyCreate(t,r),privateAdd:(t,r)=>e.privateKeyTweakAdd(new Uint8Array(t),r),sign:(t,r)=>e.ecdsaSign(t,r),verify:(t,r,n)=>e.ecdsaVerify(n,t,r)}}function qN(e){return{isPoint:t=>e.publicKeyVerify(t),pointCompress:(t,r)=>Uint8Array.from(e.publicKeyConvert(t,r??!0)),isPrivate:t=>e.privateKeyVerify(t),pointFromScalar:(t,r)=>{let n=e.publicKeyCreate(t,r??!0);return n==null?null:Uint8Array.from(n)},sign:(t,r,n)=>Uint8Array.from(e.ecdsaSign(t,r)),verify:(t,r,n,i)=>e.ecdsaVerify(n,t,r)}}var go=FN(P9);en.tinySecp256k1Interface=qN(P9);var dg=vn.BufferN(32),HN=vn.compile({wif:vn.UInt8,bip32:{public:vn.UInt32,private:vn.UInt32}}),Gh={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},E9=2147483648,jN=Math.pow(2,31)-1;function kN(e){return vn.String(e)&&e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function LN(e){return vn.UInt32(e)&&e<=jN}var zh=class{constructor(t,r,n,i,s=0,a=0,o=0){this.__D=t,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=a,this.__PARENT_FINGERPRINT=o,vn(HN,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=H.Buffer.from(go.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return H.Buffer.from(ug.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return $h(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=H.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),A9.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return RN.encode(this.network.wif,this.privateKey,!0)}derive(t){vn(vn.UInt32,t);let r=t>=E9,n=H.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(t,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(t,33);let i=ug.hmacSHA512(this.chainCode,n),s=i.slice(0,32),a=i.slice(32);if(!go.isPrivate(s))return this.derive(t+1);let o;if(this.isNeutered()){let c=go.pointAddScalar(this.publicKey,s,!0);if(c===null)return this.derive(t+1);o=$h(c,a,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{let c=go.privateAdd(this.privateKey,s);if(c==null)return this.derive(t+1);o=lg(c,a,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return o}deriveHardened(t){return vn(LN,t),this.derive(t+E9)}derivePath(t){vn(kN,t);let r=t.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(t){if(!this.privateKey)throw new Error("Missing private key");return go.sign(t,this.privateKey)}verify(t,r){return go.verify(t,this.publicKey,r)}};function KN(e,t){let r=H.Buffer.from(A9.decode(e));if(r.length!==78)throw new TypeError("Invalid buffer length");t=t||Gh;let n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let a=r.readUInt32BE(9);if(i===0&&a!==0)throw new TypeError("Invalid index");let o=r.slice(13,45),c;if(n===t.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let u=r.slice(46,78);c=lg(u,o,t,i,a,s)}else{let u=r.slice(45,78);c=$h(u,o,t,i,a,s)}return c}en.fromBase58=KN;function C9(e,t,r){return lg(e,t,r)}en.fromPrivateKey=C9;function lg(e,t,r,n,i,s){if(vn({privateKey:dg,chainCode:dg},{privateKey:e,chainCode:t}),r=r||Gh,!go.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new zh(e,void 0,t,r,n,i,s)}function VN(e,t,r){return $h(e,t,r)}en.fromPublicKey=VN;function $h(e,t,r,n,i,s){if(vn({publicKey:vn.BufferN(33),chainCode:dg},{publicKey:e,chainCode:t}),r=r||Gh,!go.isPoint(e))throw new TypeError("Point is not on the curve");return new zh(void 0,e,t,r,n,i,s)}function UN(e,t){if(vn(vn.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||Gh;let r=ug.hmacSHA512(H.Buffer.from("Bitcoin seed","utf8"),e),n=r.slice(0,32),i=r.slice(32);return C9(n,i,t)}en.fromSeed=UN});var B9=K(Wh=>{D();N();Object.defineProperty(Wh,"__esModule",{value:!0});Wh.fromSeedV2=void 0;var zN=Pm();function $N(e,t){return zN.HDKey.fromMasterSeed(new Uint8Array([...e])).derive(t)}Wh.fromSeedV2=$N});var M9=K(oi=>{D();N();Object.defineProperty(oi,"__esModule",{value:!0});oi.fromSeedV2=oi.fromPrivateKey=oi.fromPublicKey=oi.fromBase58=oi.fromSeed=oi.tinySecp256k1Interface=void 0;var a0=I9();Object.defineProperty(oi,"tinySecp256k1Interface",{enumerable:!0,get:function(){return a0.tinySecp256k1Interface}});Object.defineProperty(oi,"fromSeed",{enumerable:!0,get:function(){return a0.fromSeed}});Object.defineProperty(oi,"fromBase58",{enumerable:!0,get:function(){return a0.fromBase58}});Object.defineProperty(oi,"fromPublicKey",{enumerable:!0,get:function(){return a0.fromPublicKey}});Object.defineProperty(oi,"fromPrivateKey",{enumerable:!0,get:function(){return a0.fromPrivateKey}});var GN=B9();Object.defineProperty(oi,"fromSeedV2",{enumerable:!0,get:function(){return GN.fromSeedV2}})});var T9=K((Pte,WN)=>{WN.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var pg=K(Hc=>{D();N();Object.defineProperty(Hc,"__esModule",{value:!0});Hc._default=Hc.wordlists=void 0;var hg={};Hc.wordlists=hg;var Xh;Hc._default=Xh;try{Hc._default=Xh=T9(),hg.english=Xh,hg.EN=Xh}catch{}});var bg=K(br=>{D();N();Object.defineProperty(br,"__esModule",{value:!0});br.wordlists=br.getDefaultWordlist=br.setDefaultWordlist=br.validateMnemonic=br.generateMnemonic=br.entropyToMnemonic=br.mnemonicToEntropy=br.mnemonicToSeedV2=br.mnemonicToSeed=br.mnemonicToSeedSync=void 0;var D9=t0(),N9=Oh(),Yh=pg(),R9=Wd(),XN=Cm(),fu=Yh._default,O9="Invalid mnemonic",jc="Invalid entropy",YN="Invalid mnemonic checksum",F9=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function ZN(e,t,r,n,i){let s=(0,N9.pbkdf2)(R9.sha512,e,t,{c:r,dkLen:n});return Promise.resolve(H.Buffer.from(s))}function o0(e){return(e||"").normalize("NFKD")}function q9(e,t,r){for(;e.length<r;)e=t+e;return e}function H9(e){return parseInt(e,2)}function j9(e){return e.map(t=>q9(t.toString(2),"0",8)).join("")}function k9(e){let r=e.length*8/32,n=(0,D9.sha256)(e);return j9(Array.from(n)).slice(0,r)}function L9(e){return"mnemonic"+(e||"")}function JN(e,t){let r=H.Buffer.from(o0(e),"utf8"),n=H.Buffer.from(L9(o0(t)),"utf8"),i=(0,N9.pbkdf2)(R9.sha512,r,n,{c:2048,dkLen:64});return H.Buffer.from(i)}br.mnemonicToSeedSync=JN;function QN(e,t){return Promise.resolve().then(()=>{let r=H.Buffer.from(o0(e),"utf8"),n=H.Buffer.from(L9(o0(t)),"utf8");return ZN(r,n,2048,64,"sha512")})}br.mnemonicToSeed=QN;async function eR(e,t){let r=e.split(" ").map(s=>fu.indexOf(s)),n=new Uint8Array(new Uint16Array(r).buffer),i=await(0,XN.mnemonicToSeed)(n,t);return H.Buffer.from(i)}br.mnemonicToSeedV2=eR;function K9(e,t){if(t=t||fu,!t)throw new Error(F9);let r=o0(e).split(" ");if(r.length%3!==0)throw new Error(O9);let n=r.map(b=>{let h=t.indexOf(b);if(h===-1)throw new Error(O9);return q9(h.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),a=n.slice(i),o=s.match(/(.{1,8})/g).map(H9);if(o.length<16)throw new Error(jc);if(o.length>32)throw new Error(jc);if(o.length%4!==0)throw new Error(jc);let c=H.Buffer.from(o);if(k9(c)!==a)throw new Error(YN);return c.toString("hex")}br.mnemonicToEntropy=K9;function V9(e,t){if(H.Buffer.isBuffer(e)||(e=H.Buffer.from(e,"hex")),t=t||fu,!t)throw new Error(F9);if(e.length<16)throw new TypeError(jc);if(e.length>32)throw new TypeError(jc);if(e.length%4!==0)throw new TypeError(jc);let r=j9(Array.from(e)),n=k9(e),a=(r+n).match(/(.{1,11})/g).map(o=>{let c=H9(o);return t[c]});return t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?a.join("\u3000"):a.join(" ")}br.entropyToMnemonic=V9;function tR(e,t,r){if(e=e||128,e%32!==0)throw new TypeError(jc);return t=t||D9.randomBytes,V9(t(e/8),r)}br.generateMnemonic=tR;function rR(e,t){try{K9(e,t)}catch{return!1}return!0}br.validateMnemonic=rR;function nR(e){let t=Yh.wordlists[e];if(t)fu=t;else throw new Error('Could not find wordlist for language "'+e+'"')}br.setDefaultWordlist=nR;function iR(){if(!fu)throw new Error("No Default Wordlist set");return Object.keys(Yh.wordlists).filter(e=>e==="JA"||e==="EN"?!1:Yh.wordlists[e].every((t,r)=>t===fu[r]))[0]}br.getDefaultWordlist=iR;var sR=pg();Object.defineProperty(br,"wordlists",{enumerable:!0,get:function(){return sR.wordlists}})});var X9=K(gt=>{D();N();var aR=gt&&gt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),oR=gt&&gt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cR=gt&&gt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&aR(t,e,r);return oR(t,e),t},fR=gt&&gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gt,"__esModule",{value:!0});gt.loadUncompressedPublicKey=gt.loadCompressedPublicKey=gt.publicKeyConvert=gt.publicKeyCreate=gt.publicKeyVerify=gt.privateKeyVerify=gt.loadPublicKey=gt.recover=gt.verifyWithNoRecovery=gt.verify=gt.getV=gt.sign=void 0;var uR=cR(cu()),Rr=new uR.ec("secp256k1"),U9=t0(),uu=fR(si());function dR(e,t,r=!0){let n=Rr.sign(Array.from(e),H.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}gt.sign=dR;function lR(e,t,r,n,i=!0){let s=c0(n);if(s==null)throw new Error("pubkey error");let a=Rr.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return Rr.getKeyRecoveryParam(e,{r:t,s:r},a,i)}gt.getV=lR;function hR(e,t,r,n){let i=z9(t,r,e,!0);if(i==null)return!1;let s=$9(n,!0);return s==null?!1:i.equals(s)}gt.verify=hR;function pR(e,t,r){let n=c0(r);if(n==null)throw new Error("pubkey error");let i=Rr.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,U9.toHex)(t.slice(0,32)),s:(0,U9.toHex)(t.slice(32,64))};return i.verify(e,s)}gt.verifyWithNoRecovery=pR;function z9(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new uu.default(i.r),a=new uu.default(i.s);if(s.cmp(Rr.curve.n)>=0||a.cmp(Rr.curve.n)>=0||s.isZero()||a.isZero())return null;let o;try{o=Rr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return H.Buffer.from(o.encode(null,n))}gt.recover=z9;function c0(e){let t=H.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:G9(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:W9(r,t.subarray(1,33),t.subarray(33,65));default:return null}}gt.loadPublicKey=c0;function bR(e){let t=new uu.default(Array.from(e));return t.cmp(Rr.curve.n)<0&&!t.isZero()}gt.privateKeyVerify=bR;function gR(e){return c0(e)!==null}gt.publicKeyVerify=gR;function vR(e,t){let r=Rr.keyFromPrivate(Array.from(e),"bytes").getPublic();return H.Buffer.from(r.encode(null,t))}gt.publicKeyCreate=vR;function $9(e,t){let r=c0(e);if(r==null)return null;let n=Rr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return H.Buffer.from(n.encode(null,t))}gt.publicKeyConvert=$9;function G9(e,t){let r=new uu.default(Array.from(t));if(r.cmp(Rr.curve.p)>=0)return null;let n=r.toRed(Rr.curve.red),i=n.redSqr().redIMul(n).redIAdd(Rr.curve.b).redSqrt();e===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(Rr.curve.b)).isZero()?{x:n,y:i}:null}gt.loadCompressedPublicKey=G9;function W9(e,t,r){let n=new uu.default(Array.from(t)),i=new uu.default(Array.from(r));if(n.cmp(Rr.curve.p)>=0||i.cmp(Rr.curve.p)>=0)return null;let s=n.toRed(Rr.curve.red),a=i.toRed(Rr.curve.red);if((e===6||e===7)&&a.isOdd()!==(e===7))return null;let o=s.redSqr().redIMul(s);return a.redSqr().redISub(o.redIAdd(Rr.curve.b)).isZero()?{x:s,y:a}:null}gt.loadUncompressedPublicKey=W9});var i7=K(lt=>{D();N();var yR=lt&&lt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),mR=lt&&lt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Y9=lt&&lt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&yR(t,e,r);return mR(t,e),t},wR=lt&&lt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lt,"__esModule",{value:!0});lt.ed25519_getDerivedPrivateKey=lt.isValidPath=lt.ed25519_getRandomPrivateKey=lt.ed25519SignTest=lt.fromSecret=lt.fromSeed=lt.privateKeyVerify=lt.publicKeyVerify=lt.publicKeyCreate=lt.verify=lt.sign=lt.ed25519MulBase=void 0;var Z9=Y9(cu()),ds=t0(),_R=wR(si()),SR=bg(),gg=Y9(rl()),xR=Wd();gg.utils.sha512Sync=(...e)=>(0,xR.sha512)(gg.utils.concatBytes(...e));var vo=new Z9.eddsa("ed25519"),J9=vo.curve;function ER(e){let t=vo.curve.g;return vo.encodePoint(t.mul(Z9.utils.intFromLE(e)))}lt.ed25519MulBase=ER;function Q9(e,t){let r=t;r.length==64&&(r=r.slice(0,32));let n=gg.sync.sign(e,r);return Uint8Array.from(n)}lt.sign=Q9;function e7(e,t,r){return vo.keyFromPublic(Array.from(r)).verify(Array.from(e),Array.from(t))}lt.verify=e7;function Zh(e){let t=e;t.length==64&&(t=t.slice(0,32));let n=vo.keyFromSecret(Array.from(t)).getPublic();if(e.length==64&&!AR(e.slice(32,64),n))throw new Error("invalid public key");return Uint8Array.from(n)}lt.publicKeyCreate=Zh;function AR(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function PR(e){let t=vo.decodePoint(Array.from(e));return J9.validate(t)}lt.publicKeyVerify=PR;function t7(e){let t=new _R.default(Array.from(e));return t.cmp(J9.n)<0&&!t.isZero()}lt.privateKeyVerify=t7;function CR(e){let t=vo.keyFromSecret(Array.from(e)),r=Uint8Array.from(t.getPublic());return{publicKey:r,secretKey:(0,ds.concatBytes)(e,r)}}lt.fromSeed=CR;function IR(e){let t=e.slice(0,32),r=vo.keyFromSecret(Array.from(t));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(t)}}lt.fromSecret=IR;function r7(e){let t=(0,ds.sha256)("ed25519-test"),r=Zh(e),n=Q9(t,e);return e7(t,n,r)}lt.ed25519SignTest=r7;function BR(e,t){for(;;){let r=(0,ds.randomBytes)(32);if(t7(r)&&r7(r)){let n=Zh(r),i=e?(0,ds.concatBytes)(r,n):r;return t==="base58"?(0,ds.toBase58)(i):(0,ds.toHex)(i)}}}lt.ed25519_getRandomPrivateKey=BR;var MR=new RegExp("^m(\\/[0-9]+')+$"),n7=e=>e.replace("'",""),TR=2147483648;function OR(e){let t=(0,ds.hmacSHA512)("ed25519 seed",e),r=t.slice(0,32),n=t.slice(32);return{key:r,chainCode:n}}function DR({key:e,chainCode:t},r){let n=H.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=H.Buffer.concat([H.Buffer.alloc(1,0),e,n]),s=(0,ds.hmacSHA512)(t,i),a=s.slice(0,32),o=s.slice(32);return{key:a,chainCode:o}}var NR=e=>MR.test(e)?!e.split("/").slice(1).map(n7).some(isNaN):!1;lt.isValidPath=NR;function RR(e,t,r=TR){if(!(0,lt.isValidPath)(e))throw new Error("Invalid derivation path");let{key:n,chainCode:i}=OR(t);return e.split("/").slice(1).map(n7).map(a=>parseInt(a,10)).reduce((a,o)=>DR(a,o+r),{key:n,chainCode:i})}async function FR(e,t,r,n){let i=await(0,SR.mnemonicToSeedV2)(e),s=RR(t,i).key,a=Zh(s),o=r?(0,ds.concatBytes)(s,a):s;return n==="base58"?Promise.resolve((0,ds.toBase58)(o)):Promise.resolve((0,ds.toHex)(o))}lt.ed25519_getDerivedPrivateKey=FR});var c7=K(Ct=>{D();N();var qR=Ct&&Ct.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),HR=Ct&&Ct.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jR=Ct&&Ct.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&qR(t,e,r);return HR(t,e),t},kR=Ct&&Ct.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.loadUncompressedPublicKey=Ct.loadCompressedPublicKey=Ct.publicKeyConvert=Ct.publicKeyCreate=Ct.publicKeyVerify=Ct.privateKeyVerify=Ct.loadPublicKey=Ct.recover=Ct.verify=Ct.sign=void 0;var LR=jR(cu()),Yn=new LR.ec("p256"),du=kR(si());function KR(e,t,r=!0){let n=Yn.sign(Array.from(e),H.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}Ct.sign=KR;function VR(e,t,r,n){let i=s7(t,r,e,!1);return i==null?!1:i.equals(n)}Ct.verify=VR;function s7(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new du.default(i.r),a=new du.default(i.s);if(s.cmp(Yn.curve.n)>=0||a.cmp(Yn.curve.n)>=0||s.isZero()||a.isZero())return null;let o;try{o=Yn.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return H.Buffer.from(o.encode(null,n))}Ct.recover=s7;function vg(e){let t=H.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:a7(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:o7(r,t.subarray(1,33),t.subarray(33,65));default:return null}}Ct.loadPublicKey=vg;function UR(e){let t=new du.default(Array.from(e));return t.cmp(Yn.curve.n)<0&&!t.isZero()}Ct.privateKeyVerify=UR;function zR(e){return vg(e)!==null}Ct.publicKeyVerify=zR;function $R(e,t){let r=Yn.keyFromPrivate(Array.from(e),"bytes").getPublic();return H.Buffer.from(r.encode(null,t))}Ct.publicKeyCreate=$R;function GR(e,t){let r=vg(e);if(r==null)return null;let n=Yn.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return H.Buffer.from(n.encode(null,t))}Ct.publicKeyConvert=GR;function a7(e,t){let r=new du.default(Array.from(t));if(r.cmp(Yn.curve.p)>=0)return null;let n=r.toRed(Yn.curve.red),i=n.redSqr().redIMul(n).redIAdd(Yn.curve.b).redSqrt();return e===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}Ct.loadCompressedPublicKey=a7;function o7(e,t,r){let n=new du.default(Array.from(t)),i=new du.default(Array.from(r));if(n.cmp(Yn.curve.p)>=0||i.cmp(Yn.curve.p)>=0)return null;let s=n.toRed(Yn.curve.red),a=i.toRed(Yn.curve.red);if((e===6||e===7)&&a.isOdd()!==(e===7))return null;let o=s.redSqr().redIMul(s);return a.redSqr().redISub(o.redIAdd(Yn.curve.b)).isZero()?{x:s,y:a}:null}Ct.loadUncompressedPublicKey=o7});var wa=K(nt=>{D();N();Object.defineProperty(nt,"__esModule",{value:!0});nt.validateObject=nt.createHmacDrbg=nt.bitMask=nt.bitSet=nt.bitGet=nt.bitLen=nt.utf8ToBytes=nt.equalBytes=nt.concatBytes=nt.ensureBytes=nt.numberToVarBytesBE=nt.numberToBytesLE=nt.numberToBytesBE=nt.bytesToNumberLE=nt.bytesToNumberBE=nt.hexToBytes=nt.hexToNumber=nt.numberToHexUnpadded=nt.bytesToHex=void 0;var u7=BigInt(0),Jh=BigInt(1),WR=BigInt(2),Qh=e=>e instanceof Uint8Array,XR=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function mg(e){if(!Qh(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=XR[e[r]];return t}nt.bytesToHex=mg;function d7(e){let t=e.toString(16);return t.length&1?`0${t}`:t}nt.numberToHexUnpadded=d7;function wg(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}nt.hexToNumber=wg;function e1(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");t[r]=s}return t}nt.hexToBytes=e1;function YR(e){return wg(mg(e))}nt.bytesToNumberBE=YR;function ZR(e){if(!Qh(e))throw new Error("Uint8Array expected");return wg(mg(Uint8Array.from(e).reverse()))}nt.bytesToNumberLE=ZR;var JR=(e,t)=>e1(e.toString(16).padStart(t*2,"0"));nt.numberToBytesBE=JR;var QR=(e,t)=>(0,nt.numberToBytesBE)(e,t).reverse();nt.numberToBytesLE=QR;var eF=e=>e1(d7(e));nt.numberToVarBytesBE=eF;function tF(e,t,r){let n;if(typeof t=="string")try{n=e1(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Qh(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}nt.ensureBytes=tF;function l7(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Qh(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}nt.concatBytes=l7;function rF(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}nt.equalBytes=rF;function nF(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}nt.utf8ToBytes=nF;function iF(e){let t;for(t=0;e>u7;e>>=Jh,t+=1);return t}nt.bitLen=iF;var sF=(e,t)=>e>>BigInt(t)&Jh;nt.bitGet=sF;var aF=(e,t,r)=>e|(r?Jh:u7)<<BigInt(t);nt.bitSet=aF;var oF=e=>(WR<<BigInt(e-1))-Jh;nt.bitMask=oF;var yg=e=>new Uint8Array(e),f7=e=>Uint8Array.from(e);function cF(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=yg(e),i=yg(e),s=0,a=()=>{n.fill(1),i.fill(0),s=0},o=(...h)=>r(i,n,...h),c=(h=yg())=>{i=o(f7([0]),h),n=o(),h.length!==0&&(i=o(f7([1]),h),n=o())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,d=[];for(;h<t;){n=o();let l=n.slice();d.push(l),h+=n.length}return l7(...d)};return(h,d)=>{a(),c(h);let l;for(;!(l=d(u()));)c();return a(),l}}nt.createHmacDrbg=cF;var fF={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function uF(e,t,r={}){let n=(i,s,a)=>{let o=fF[s];if(typeof o!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=e[i];if(!(a&&c===void 0)&&!o(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}nt.validateObject=uF});var kc=K(ct=>{D();N();Object.defineProperty(ct,"__esModule",{value:!0});ct.hashToPrivateScalar=ct.FpSqrtEven=ct.FpSqrtOdd=ct.Field=ct.nLength=ct.FpIsSquare=ct.FpDiv=ct.FpInvertBatch=ct.FpPow=ct.validateField=ct.isNegativeLE=ct.FpSqrt=ct.tonelliShanks=ct.invert=ct.pow2=ct.pow=ct.mod=void 0;var _a=wa(),Fr=BigInt(0),Qt=BigInt(1),yo=BigInt(2),dF=BigInt(3),_g=BigInt(4),h7=BigInt(5),p7=BigInt(8),lF=BigInt(9),hF=BigInt(16);function ki(e,t){let r=e%t;return r>=Fr?r:t+r}ct.mod=ki;function b7(e,t,r){if(r<=Fr||t<Fr)throw new Error("Expected power/modulo > 0");if(r===Qt)return Fr;let n=Qt;for(;t>Fr;)t&Qt&&(n=n*e%r),e=e*e%r,t>>=Qt;return n}ct.pow=b7;function pF(e,t,r){let n=e;for(;t-- >Fr;)n*=n,n%=r;return n}ct.pow2=pF;function t1(e,t){if(e===Fr||t<=Fr)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=ki(e,t),n=t,i=Fr,s=Qt,a=Qt,o=Fr;for(;r!==Fr;){let u=n/r,b=n%r,h=i-a*u,d=s-o*u;n=r,r=b,i=a,s=o,a=h,o=d}if(n!==Qt)throw new Error("invert: does not exist");return ki(i,t)}ct.invert=t1;function g7(e){let t=(e-Qt)/yo,r,n,i;for(r=e-Qt,n=0;r%yo===Fr;r/=yo,n++);for(i=yo;i<e&&b7(i,t,e)!==e-Qt;i++);if(n===1){let a=(e+Qt)/_g;return function(c,u){let b=c.pow(u,a);if(!c.eql(c.sqr(b),u))throw new Error("Cannot find square root");return b}}let s=(r+Qt)/yo;return function(o,c){if(o.pow(c,t)===o.neg(o.ONE))throw new Error("Cannot find square root");let u=n,b=o.pow(o.mul(o.ONE,i),r),h=o.pow(c,s),d=o.pow(c,r);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let l=1;for(let p=o.sqr(d);l<u&&!o.eql(p,o.ONE);l++)p=o.sqr(p);let y=o.pow(b,Qt<<BigInt(u-l-1));b=o.sqr(y),h=o.mul(h,y),d=o.mul(d,b),u=l}return h}}ct.tonelliShanks=g7;function v7(e){if(e%_g===dF){let t=(e+Qt)/_g;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%p7===h7){let t=(e-h7)/p7;return function(n,i){let s=n.mul(i,yo),a=n.pow(s,t),o=n.mul(i,a),c=n.mul(n.mul(o,yo),a),u=n.mul(o,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%hF,g7(e)}ct.FpSqrt=v7;var bF=(e,t)=>(ki(e,t)&Qt)===Qt;ct.isNegativeLE=bF;var gF=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function vF(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=gF.reduce((n,i)=>(n[i]="function",n),t);return(0,_a.validateObject)(e,r)}ct.validateField=vF;function y7(e,t,r){if(r<Fr)throw new Error("Expected power > 0");if(r===Fr)return e.ONE;if(r===Qt)return t;let n=e.ONE,i=t;for(;r>Fr;)r&Qt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Qt;return n}ct.FpPow=y7;function m7(e,t){let r=new Array(t.length),n=t.reduce((s,a,o)=>e.is0(a)?s:(r[o]=s,e.mul(s,a)),e.ONE),i=e.inv(n);return t.reduceRight((s,a,o)=>e.is0(a)?s:(r[o]=e.mul(s,r[o]),e.mul(s,a)),i),r}ct.FpInvertBatch=m7;function yF(e,t,r){return e.mul(t,typeof r=="bigint"?t1(r,e.ORDER):e.inv(r))}ct.FpDiv=yF;function mF(e){let t=(e.ORDER-Qt)/yo;return r=>{let n=e.pow(r,t);return e.eql(n,e.ZERO)||e.eql(n,e.ONE)}}ct.FpIsSquare=mF;function Sg(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}ct.nLength=Sg;function wF(e,t,r=!1,n={}){if(e<=Fr)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=Sg(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let a=v7(e),o=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:(0,_a.bitMask)(i),ZERO:Fr,ONE:Qt,create:c=>ki(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Fr<=c&&c<e},is0:c=>c===Fr,isOdd:c=>(c&Qt)===Qt,neg:c=>ki(-c,e),eql:(c,u)=>c===u,sqr:c=>ki(c*c,e),add:(c,u)=>ki(c+u,e),sub:(c,u)=>ki(c-u,e),mul:(c,u)=>ki(c*u,e),pow:(c,u)=>y7(o,c,u),div:(c,u)=>ki(c*t1(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>t1(c,e),sqrt:n.sqrt||(c=>a(o,c)),invertBatch:c=>m7(o,c),cmov:(c,u,b)=>b?u:c,toBytes:c=>r?(0,_a.numberToBytesLE)(c,s):(0,_a.numberToBytesBE)(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?(0,_a.bytesToNumberLE)(c):(0,_a.bytesToNumberBE)(c)}});return Object.freeze(o)}ct.Field=wF;function _F(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}ct.FpSqrtOdd=_F;function SF(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}ct.FpSqrtEven=SF;function xF(e,t,r=!1){e=(0,_a.ensureBytes)("privateHash",e);let n=e.length,i=Sg(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,_a.bytesToNumberLE)(e):(0,_a.bytesToNumberBE)(e);return ki(s,t-Qt)+Qt}ct.hashToPrivateScalar=xF});var _7=K(lu=>{D();N();Object.defineProperty(lu,"__esModule",{value:!0});lu.validateBasic=lu.wNAF=void 0;var w7=kc(),EF=wa(),AF=BigInt(0),xg=BigInt(1);function PF(e,t){let r=(i,s)=>{let a=s.negate();return i?a:s},n=i=>{let s=Math.ceil(t/i)+1,a=2**(i-1);return{windows:s,windowSize:a}};return{constTimeNegate:r,unsafeLadder(i,s){let a=e.ZERO,o=i;for(;s>AF;)s&xg&&(a=a.add(o)),o=o.double(),s>>=xg;return a},precomputeWindow(i,s){let{windows:a,windowSize:o}=n(s),c=[],u=i,b=u;for(let h=0;h<a;h++){b=u,c.push(b);for(let d=1;d<o;d++)b=b.add(u),c.push(b);u=b.double()}return c},wNAF(i,s,a){let{windows:o,windowSize:c}=n(i),u=e.ZERO,b=e.BASE,h=BigInt(2**i-1),d=2**i,l=BigInt(i);for(let y=0;y<o;y++){let p=y*c,m=Number(a&h);a>>=l,m>c&&(m-=d,a+=xg);let w=p,C=p+Math.abs(m)-1,T=y%2!==0,q=m<0;m===0?b=b.add(r(T,s[w])):u=u.add(r(q,s[C]))}return{p:u,f:b}},wNAFCached(i,s,a,o){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,o(u))),this.wNAF(c,u,a)}}}lu.wNAF=PF;function CF(e){return(0,w7.validateField)(e.Fp),(0,EF.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,w7.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}lu.validateBasic=CF});var n1=K(er=>{D();N();var IF=er&&er.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),BF=er&&er.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),x7=er&&er.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&IF(t,e,r);return BF(t,e),t};Object.defineProperty(er,"__esModule",{value:!0});er.mapToCurveSimpleSWU=er.SWUFpSqrtRatio=er.weierstrass=er.weierstrassPoints=er.DER=void 0;var f0=x7(kc()),Ar=x7(wa()),Os=wa(),Eg=_7();function MF(e){let t=(0,Eg.validateBasic)(e);Ar.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:TF,hexToBytes:OF}=Ar;er.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=er.DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:TF(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=er.DER,r=typeof e=="string"?OF(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=er.DER._parseInt(r.subarray(2)),{d:a,l:o}=er.DER._parseInt(s);if(o.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:a}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let b=u.toString(16);return b.length&1?`0${b}`:b},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,a=i.length/2,o=r(s),c=r(a);return`30${r(a+s+4)}02${c}${i}02${o}${n}`}};var ls=BigInt(0),gr=BigInt(1),mo=BigInt(2),r1=BigInt(3),S7=BigInt(4);function E7(e){let t=MF(e),{Fp:r}=t,n=t.toBytes||((y,p,m)=>{let w=p.toAffine();return Ar.concatBytes(Uint8Array.from([4]),r.toBytes(w.x),r.toBytes(w.y))}),i=t.fromBytes||(y=>{let p=y.subarray(1),m=r.fromBytes(p.subarray(0,r.BYTES)),w=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:m,y:w}});function s(y){let{a:p,b:m}=t,w=r.sqr(y),C=r.mul(w,y);return r.add(r.add(C,r.mul(y,p)),m)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function a(y){return typeof y=="bigint"&&ls<y&&y<t.n}function o(y){if(!a(y))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(y){let{allowedPrivateKeyLengths:p,nByteLength:m,wrapPrivateKey:w,n:C}=t;if(p&&typeof y!="bigint"){if(y instanceof Uint8Array&&(y=Ar.bytesToHex(y)),typeof y!="string"||!p.includes(y.length))throw new Error("Invalid key");y=y.padStart(m*2,"0")}let T;try{T=typeof y=="bigint"?y:Ar.bytesToNumberBE((0,Os.ensureBytes)("private key",y,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof y}`)}return w&&(T=f0.mod(T,C)),o(T),T}let u=new Map;function b(y){if(!(y instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,m,w){if(this.px=p,this.py=m,this.pz=w,p==null||!r.isValid(p))throw new Error("x required");if(m==null||!r.isValid(m))throw new Error("y required");if(w==null||!r.isValid(w))throw new Error("z required")}static fromAffine(p){let{x:m,y:w}=p||{};if(!p||!r.isValid(m)||!r.isValid(w))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let C=T=>r.eql(T,r.ZERO);return C(m)&&C(w)?h.ZERO:new h(m,w,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let m=r.invertBatch(p.map(w=>w.pz));return p.map((w,C)=>w.toAffine(m[C])).map(h.fromAffine)}static fromHex(p){let m=h.fromAffine(i((0,Os.ensureBytes)("pointHex",p)));return m.assertValidity(),m}static fromPrivateKey(p){return h.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:p,y:m}=this.toAffine();if(!r.isValid(p)||!r.isValid(m))throw new Error("bad point: x or y not FE");let w=r.sqr(m),C=s(p);if(!r.eql(w,C))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){b(p);let{px:m,py:w,pz:C}=this,{px:T,py:q,pz:F}=p,j=r.eql(r.mul(m,F),r.mul(T,C)),k=r.eql(r.mul(w,F),r.mul(q,C));return j&&k}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:m}=t,w=r.mul(m,r1),{px:C,py:T,pz:q}=this,F=r.ZERO,j=r.ZERO,k=r.ZERO,I=r.mul(C,C),R=r.mul(T,T),A=r.mul(q,q),f=r.mul(C,T);return f=r.add(f,f),k=r.mul(C,q),k=r.add(k,k),F=r.mul(p,k),j=r.mul(w,A),j=r.add(F,j),F=r.sub(R,j),j=r.add(R,j),j=r.mul(F,j),F=r.mul(f,F),k=r.mul(w,k),A=r.mul(p,A),f=r.sub(I,A),f=r.mul(p,f),f=r.add(f,k),k=r.add(I,I),I=r.add(k,I),I=r.add(I,A),I=r.mul(I,f),j=r.add(j,I),A=r.mul(T,q),A=r.add(A,A),I=r.mul(A,f),F=r.sub(F,I),k=r.mul(A,R),k=r.add(k,k),k=r.add(k,k),new h(F,j,k)}add(p){b(p);let{px:m,py:w,pz:C}=this,{px:T,py:q,pz:F}=p,j=r.ZERO,k=r.ZERO,I=r.ZERO,R=t.a,A=r.mul(t.b,r1),f=r.mul(m,T),g=r.mul(w,q),E=r.mul(C,F),x=r.add(m,w),S=r.add(T,q);x=r.mul(x,S),S=r.add(f,g),x=r.sub(x,S),S=r.add(m,C);let P=r.add(T,F);return S=r.mul(S,P),P=r.add(f,E),S=r.sub(S,P),P=r.add(w,C),j=r.add(q,F),P=r.mul(P,j),j=r.add(g,E),P=r.sub(P,j),I=r.mul(R,S),j=r.mul(A,E),I=r.add(j,I),j=r.sub(g,I),I=r.add(g,I),k=r.mul(j,I),g=r.add(f,f),g=r.add(g,f),E=r.mul(R,E),S=r.mul(A,S),g=r.add(g,E),E=r.sub(f,E),E=r.mul(R,E),S=r.add(S,E),f=r.mul(g,S),k=r.add(k,f),f=r.mul(P,S),j=r.mul(x,j),j=r.sub(j,f),f=r.mul(x,g),I=r.mul(P,I),I=r.add(I,f),new h(j,k,I)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return l.wNAFCached(this,u,p,m=>{let w=r.invertBatch(m.map(C=>C.pz));return m.map((C,T)=>C.toAffine(w[T])).map(h.fromAffine)})}multiplyUnsafe(p){let m=h.ZERO;if(p===ls)return m;if(o(p),p===gr)return this;let{endo:w}=t;if(!w)return l.unsafeLadder(this,p);let{k1neg:C,k1:T,k2neg:q,k2:F}=w.splitScalar(p),j=m,k=m,I=this;for(;T>ls||F>ls;)T&gr&&(j=j.add(I)),F&gr&&(k=k.add(I)),I=I.double(),T>>=gr,F>>=gr;return C&&(j=j.negate()),q&&(k=k.negate()),k=new h(r.mul(k.px,w.beta),k.py,k.pz),j.add(k)}multiply(p){o(p);let m=p,w,C,{endo:T}=t;if(T){let{k1neg:q,k1:F,k2neg:j,k2:k}=T.splitScalar(m),{p:I,f:R}=this.wNAF(F),{p:A,f}=this.wNAF(k);I=l.constTimeNegate(q,I),A=l.constTimeNegate(j,A),A=new h(r.mul(A.px,T.beta),A.py,A.pz),w=I.add(A),C=R.add(f)}else{let{p:q,f:F}=this.wNAF(m);w=q,C=F}return h.normalizeZ([w,C])[0]}multiplyAndAddUnsafe(p,m,w){let C=h.BASE,T=(F,j)=>j===ls||j===gr||!F.equals(C)?F.multiplyUnsafe(j):F.multiply(j),q=T(this,m).add(T(p,w));return q.is0()?void 0:q}toAffine(p){let{px:m,py:w,pz:C}=this,T=this.is0();p==null&&(p=T?r.ONE:r.inv(C));let q=r.mul(m,p),F=r.mul(w,p),j=r.mul(C,p);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(j,r.ONE))throw new Error("invZ was invalid");return{x:q,y:F}}isTorsionFree(){let{h:p,isTorsionFree:m}=t;if(p===gr)return!0;if(m)return m(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:m}=t;return p===gr?this:m?m(h,this):this.multiplyUnsafe(t.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return Ar.bytesToHex(this.toRawBytes(p))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let d=t.nBitLength,l=(0,Eg.wNAF)(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:a}}er.weierstrassPoints=E7;function DF(e){let t=(0,Eg.validateBasic)(e);return Ar.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function NF(e){let t=DF(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function a(S){return ls<S&&S<r.ORDER}function o(S){return f0.mod(S,n)}function c(S){return f0.invert(S,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:b,weierstrassEquation:h,isWithinCurveOrder:d}=E7({...t,toBytes(S,P,O){let B=P.toAffine(),v=r.toBytes(B.x),M=Ar.concatBytes;return O?M(Uint8Array.from([P.hasEvenY()?2:3]),v):M(Uint8Array.from([4]),v,r.toBytes(B.y))},fromBytes(S){let P=S.length,O=S[0],B=S.subarray(1);if(P===i&&(O===2||O===3)){let v=Ar.bytesToNumberBE(B);if(!a(v))throw new Error("Point is not on curve");let M=h(v),V=r.sqrt(M),z=(V&gr)===gr;return(O&1)===1!==z&&(V=r.neg(V)),{x:v,y:V}}else if(P===s&&O===4){let v=r.fromBytes(B.subarray(0,r.BYTES)),M=r.fromBytes(B.subarray(r.BYTES,2*r.BYTES));return{x:v,y:M}}else throw new Error(`Point of length ${P} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),l=S=>Ar.bytesToHex(Ar.numberToBytesBE(S,t.nByteLength));function y(S){let P=n>>gr;return S>P}function p(S){return y(S)?o(-S):S}let m=(S,P,O)=>Ar.bytesToNumberBE(S.slice(P,O));class w{constructor(P,O,B){this.r=P,this.s=O,this.recovery=B,this.assertValidity()}static fromCompact(P){let O=t.nByteLength;return P=(0,Os.ensureBytes)("compactSignature",P,O*2),new w(m(P,0,O),m(P,O,2*O))}static fromDER(P){let{r:O,s:B}=er.DER.toSig((0,Os.ensureBytes)("DER",P));return new w(O,B)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(P){return new w(this.r,this.s,P)}recoverPublicKey(P){let{r:O,s:B,recovery:v}=this,M=k((0,Os.ensureBytes)("msgHash",P));if(v==null||![0,1,2,3].includes(v))throw new Error("recovery id invalid");let V=v===2||v===3?O+t.n:O;if(V>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let z=(v&1)===0?"02":"03",$=u.fromHex(z+l(V)),G=c(V),Q=o(-M*G),re=o(B*G),me=u.BASE.multiplyAndAddUnsafe($,Q,re);if(!me)throw new Error("point at infinify");return me.assertValidity(),me}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Ar.hexToBytes(this.toDERHex())}toDERHex(){return er.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ar.hexToBytes(this.toCompactHex())}toCompactHex(){return l(this.r)+l(this.s)}}let C={isValidPrivateKey(S){try{return b(S),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{let S=t.randomBytes(r.BYTES+8),P=f0.hashToPrivateScalar(S,n);return Ar.numberToBytesBE(P,t.nByteLength)},precompute(S=8,P=u.BASE){return P._setWindowSize(S),P.multiply(BigInt(3)),P}};function T(S,P=!0){return u.fromPrivateKey(S).toRawBytes(P)}function q(S){let P=S instanceof Uint8Array,O=typeof S=="string",B=(P||O)&&S.length;return P?B===i||B===s:O?B===2*i||B===2*s:S instanceof u}function F(S,P,O=!0){if(q(S))throw new Error("first arg must be private key");if(!q(P))throw new Error("second arg must be public key");return u.fromHex(P).multiply(b(S)).toRawBytes(O)}let j=t.bits2int||function(S){let P=Ar.bytesToNumberBE(S),O=S.length*8-t.nBitLength;return O>0?P>>BigInt(O):P},k=t.bits2int_modN||function(S){return o(j(S))},I=Ar.bitMask(t.nBitLength);function R(S){if(typeof S!="bigint")throw new Error("bigint expected");if(!(ls<=S&&S<I))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Ar.numberToBytesBE(S,t.nByteLength)}function A(S,P,O=f){if(["recovered","canonical"].some(te=>te in O))throw new Error("sign() legacy options not supported");let{hash:B,randomBytes:v}=t,{lowS:M,prehash:V,extraEntropy:z}=O;M==null&&(M=!0),S=(0,Os.ensureBytes)("msgHash",S),V&&(S=(0,Os.ensureBytes)("prehashed msgHash",B(S)));let $=k(S),G=b(P),Q=[R(G),R($)];if(z!=null){let te=z===!0?v(r.BYTES):z;Q.push((0,Os.ensureBytes)("extraEntropy",te,r.BYTES))}let re=Ar.concatBytes(...Q),me=$;function ne(te){let _e=j(te);if(!d(_e))return;let ce=c(_e),J=u.BASE.multiply(_e).toAffine(),De=o(J.x);if(De===ls)return;let fe=o(ce*o(me+De*G));if(fe===ls)return;let ie=(J.x===De?0:2)|Number(J.y&gr),qt=fe;return M&&y(fe)&&(qt=p(fe),ie^=1),new w(De,qt,ie)}return{seed:re,k2sig:ne}}let f={lowS:t.lowS,prehash:!1},g={lowS:t.lowS,prehash:!1};function E(S,P,O=f){let{seed:B,k2sig:v}=A(S,P,O),M=t;return Ar.createHmacDrbg(M.hash.outputLen,M.nByteLength,M.hmac)(B,v)}u.BASE._setWindowSize(8);function x(S,P,O,B=g){let v=S;if(P=(0,Os.ensureBytes)("msgHash",P),O=(0,Os.ensureBytes)("publicKey",O),"strict"in B)throw new Error("options.strict was renamed to lowS");let{lowS:M,prehash:V}=B,z,$;try{if(typeof v=="string"||v instanceof Uint8Array)try{z=w.fromDER(v)}catch(J){if(!(J instanceof er.DER.Err))throw J;z=w.fromCompact(v)}else if(typeof v=="object"&&typeof v.r=="bigint"&&typeof v.s=="bigint"){let{r:J,s:De}=v;z=new w(J,De)}else throw new Error("PARSE");$=u.fromHex(O)}catch(J){if(J.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(M&&z.hasHighS())return!1;V&&(P=t.hash(P));let{r:G,s:Q}=z,re=k(P),me=c(Q),ne=o(re*me),te=o(G*me),_e=u.BASE.multiplyAndAddUnsafe($,ne,te)?.toAffine();return _e?o(_e.x)===G:!1}return{CURVE:t,getPublicKey:T,getSharedSecret:F,sign:E,verify:x,ProjectivePoint:u,Signature:w,utils:C}}er.weierstrass=NF;function A7(e,t){let r=e.ORDER,n=ls;for(let y=r-gr;y%mo===ls;y/=mo)n+=gr;let i=n,s=mo<<i-gr-gr,a=s*mo,o=(r-gr)/a,c=(o-gr)/mo,u=a-gr,b=s,h=e.pow(t,o),d=e.pow(t,(o+gr)/mo),l=(y,p)=>{let m=h,w=e.pow(p,u),C=e.sqr(w);C=e.mul(C,p);let T=e.mul(y,C);T=e.pow(T,c),T=e.mul(T,w),w=e.mul(T,p),C=e.mul(T,y);let q=e.mul(C,w);T=e.pow(q,b);let F=e.eql(T,e.ONE);w=e.mul(C,d),T=e.mul(q,m),C=e.cmov(w,C,F),q=e.cmov(T,q,F);for(let j=i;j>gr;j--){let k=j-mo;k=mo<<k-gr;let I=e.pow(q,k),R=e.eql(I,e.ONE);w=e.mul(C,m),m=e.mul(m,m),I=e.mul(q,m),C=e.cmov(w,C,R),q=e.cmov(I,q,R)}return{isValid:F,value:C}};if(e.ORDER%S7===r1){let y=(e.ORDER-r1)/S7,p=e.sqrt(e.neg(t));l=(m,w)=>{let C=e.sqr(w),T=e.mul(m,w);C=e.mul(C,T);let q=e.pow(C,y);q=e.mul(q,T);let F=e.mul(q,p),j=e.mul(e.sqr(q),w),k=e.eql(j,m),I=e.cmov(F,q,k);return{isValid:k,value:I}}}return l}er.SWUFpSqrtRatio=A7;function RF(e,t){if(f0.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=A7(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,a,o,c,u,b,h;i=e.sqr(n),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),a=e.add(s,e.ONE),a=e.mul(a,t.B),o=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),o=e.mul(o,t.A),s=e.sqr(a),u=e.sqr(o),c=e.mul(u,t.A),s=e.add(s,c),s=e.mul(s,a),u=e.mul(u,o),c=e.mul(u,t.B),s=e.add(s,c),b=e.mul(i,a);let{isValid:d,value:l}=r(s,u);h=e.mul(i,n),h=e.mul(h,l),b=e.cmov(b,a,d),h=e.cmov(h,l,d);let y=e.isOdd(n)===e.isOdd(h);return h=e.cmov(e.neg(h),h,y),b=e.div(b,o),{x:b,y:h}}}er.mapToCurveSimpleSWU=RF});var M7=K(vr=>{D();N();Object.defineProperty(vr,"__esModule",{value:!0});vr.createHasher=vr.isogenyMap=vr.hash_to_field=vr.expand_message_xof=vr.expand_message_xmd=vr.isNum=vr.isBytes=vr.strxor=vr.i2osp=vr.validateDST=void 0;var FF=kc(),hs=wa();function P7(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,hs.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}vr.validateDST=P7;var qF=hs.bytesToNumberBE;function Sa(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}vr.i2osp=Sa;function C7(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}vr.strxor=C7;function hu(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected")}vr.isBytes=hu;function i1(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}vr.isNum=i1;function I7(e,t,r,n){hu(e),hu(t),i1(r),t.length>255&&(t=n((0,hs.concatBytes)((0,hs.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:s}=n,a=Math.ceil(r/i);if(a>255)throw new Error("Invalid xmd length");let o=(0,hs.concatBytes)(t,Sa(t.length,1)),c=Sa(0,s),u=Sa(r,2),b=new Array(a),h=n((0,hs.concatBytes)(c,e,u,Sa(0,1),o));b[0]=n((0,hs.concatBytes)(h,Sa(1,1),o));for(let l=1;l<=a;l++){let y=[C7(h,b[l-1]),Sa(l+1,1),o];b[l]=n((0,hs.concatBytes)(...y))}return(0,hs.concatBytes)(...b).slice(0,r)}vr.expand_message_xmd=I7;function B7(e,t,r,n,i){if(hu(e),hu(t),i1(r),t.length>255){let s=Math.ceil(2*n/8);t=i.create({dkLen:s}).update((0,hs.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(Sa(r,2)).update(t).update(Sa(t.length,1)).digest()}vr.expand_message_xof=B7;function Ag(e,t,r){(0,hs.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:a,expand:o,DST:c}=r;hu(e),i1(t);let u=P7(c),b=n.toString(2).length,h=Math.ceil((b+i)/8),d=t*s*h,l;if(o==="xmd")l=I7(e,u,d,a);else if(o==="xof")l=B7(e,u,d,i,a);else if(o==="_internal_pass")l=e;else throw new Error('expand must be "xmd" or "xof"');let y=new Array(t);for(let p=0;p<t;p++){let m=new Array(s);for(let w=0;w<s;w++){let C=h*(w+p*s),T=l.subarray(C,C+h);m[w]=(0,FF.mod)(qF(T),n)}y[p]=m}return y}vr.hash_to_field=Ag;function HF(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,a,o,c]=r.map(u=>u.reduce((b,h)=>e.add(e.mul(b,n),h)));return n=e.div(s,a),i=e.mul(i,e.div(o,c)),{x:n,y:i}}}vr.isogenyMap=HF;function jF(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=Ag(n,2,{...r,DST:r.DST,...i}),a=e.fromAffine(t(s[0])),o=e.fromAffine(t(s[1])),c=a.add(o).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,i){let s=Ag(n,1,{...r,DST:r.encodeDST,...i}),a=e.fromAffine(t(s[0])).clearCofactor();return a.assertValidity(),a}}}vr.createHasher=jF});var Pg=K(pu=>{D();N();Object.defineProperty(pu,"__esModule",{value:!0});pu.createCurve=pu.getHash=void 0;var kF=Qd(),T7=pn(),LF=n1();function O7(e){return{hash:e,hmac:(t,...r)=>(0,kF.hmac)(e,t,(0,T7.concatBytes)(...r)),randomBytes:T7.randomBytes}}pu.getHash=O7;function KF(e,t){let r=n=>(0,LF.weierstrass)({...e,...O7(n)});return Object.freeze({...r(t),create:r})}pu.createCurve=KF});var K7=K(Pr=>{D();N();var VF=Pr&&Pr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),UF=Pr&&Pr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),zF=Pr&&Pr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&VF(t,e,r);return UF(t,e),t},Cg;Object.defineProperty(Pr,"__esModule",{value:!0});Pr.encodeToCurve=Pr.hashToCurve=Pr.schnorr=Pr.secp256k1=void 0;var s1=Vf(),$F=pn(),tn=kc(),GF=n1(),Tn=wa(),R7=zF(M7()),WF=Pg(),f1=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),a1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),F7=BigInt(1),o1=BigInt(2),D7=(e,t)=>(e+t/o1)/t;function q7(e){let t=f1,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=e*e*e%t,b=u*u*e%t,h=(0,tn.pow2)(b,r,t)*b%t,d=(0,tn.pow2)(h,r,t)*b%t,l=(0,tn.pow2)(d,o1,t)*u%t,y=(0,tn.pow2)(l,i,t)*l%t,p=(0,tn.pow2)(y,s,t)*y%t,m=(0,tn.pow2)(p,o,t)*p%t,w=(0,tn.pow2)(m,c,t)*m%t,C=(0,tn.pow2)(w,o,t)*p%t,T=(0,tn.pow2)(C,r,t)*b%t,q=(0,tn.pow2)(T,a,t)*y%t,F=(0,tn.pow2)(q,n,t)*u%t,j=(0,tn.pow2)(F,o1,t);if(!wo.eql(wo.sqr(j),e))throw new Error("Cannot find square root");return j}var wo=(0,tn.Field)(f1,void 0,void 0,{sqrt:q7});Pr.secp256k1=(0,WF.createCurve)({a:BigInt(0),b:BigInt(7),Fp:wo,n:a1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=a1,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-F7*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=D7(s*e,t),c=D7(-n*e,t),u=(0,tn.mod)(e-o*r-c*i,t),b=(0,tn.mod)(-o*n-c*s,t),h=u>a,d=b>a;if(h&&(u=t-u),d&&(b=t-b),u>a||b>a)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:d,k2:b}}}},s1.sha256);var u1=BigInt(0),H7=e=>typeof e=="bigint"&&u1<e&&e<f1,XF=e=>typeof e=="bigint"&&u1<e&&e<a1,N7={};function c1(e,...t){let r=N7[e];if(r===void 0){let n=(0,s1.sha256)(Uint8Array.from(e,i=>i.charCodeAt(0)));r=(0,Tn.concatBytes)(n,n),N7[e]=r}return(0,s1.sha256)((0,Tn.concatBytes)(r,...t))}var Tg=e=>e.toRawBytes(!0).slice(1),Bg=e=>(0,Tn.numberToBytesBE)(e,32),Ig=e=>(0,tn.mod)(e,f1),u0=e=>(0,tn.mod)(e,a1),Og=Pr.secp256k1.ProjectivePoint,YF=(e,t,r)=>Og.BASE.multiplyAndAddUnsafe(e,t,r);function Mg(e){let t=Pr.secp256k1.utils.normPrivateKeyToScalar(e),r=Og.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:u0(-t),bytes:Tg(r)}}function j7(e){if(!H7(e))throw new Error("bad x: need 0 < x < p");let t=Ig(e*e),r=Ig(t*e+BigInt(7)),n=q7(r);n%o1!==u1&&(n=Ig(-n));let i=new Og(e,n,F7);return i.assertValidity(),i}function k7(...e){return u0((0,Tn.bytesToNumberBE)(c1("BIP0340/challenge",...e)))}function ZF(e){return Mg(e).bytes}function JF(e,t,r=(0,$F.randomBytes)(32)){let n=(0,Tn.ensureBytes)("message",e),{bytes:i,scalar:s}=Mg(t),a=(0,Tn.ensureBytes)("auxRand",r,32),o=Bg(s^(0,Tn.bytesToNumberBE)(c1("BIP0340/aux",a))),c=c1("BIP0340/nonce",o,i,n),u=u0((0,Tn.bytesToNumberBE)(c));if(u===u1)throw new Error("sign failed: k is zero");let{bytes:b,scalar:h}=Mg(u),d=k7(b,i,n),l=new Uint8Array(64);if(l.set(b,0),l.set(Bg(u0(h+d*s)),32),!L7(l,n,i))throw new Error("sign: Invalid signature produced");return l}function L7(e,t,r){let n=(0,Tn.ensureBytes)("signature",e,64),i=(0,Tn.ensureBytes)("message",t),s=(0,Tn.ensureBytes)("publicKey",r,32);try{let a=j7((0,Tn.bytesToNumberBE)(s)),o=(0,Tn.bytesToNumberBE)(n.subarray(0,32));if(!H7(o))return!1;let c=(0,Tn.bytesToNumberBE)(n.subarray(32,64));if(!XF(c))return!1;let u=k7(Bg(o),Tg(a),i),b=YF(a,c,u0(-u));return!(!b||!b.hasEvenY()||b.toAffine().x!==o)}catch{return!1}}Pr.schnorr={getPublicKey:ZF,sign:JF,verify:L7,utils:{randomPrivateKey:Pr.secp256k1.utils.randomPrivateKey,lift_x:j7,pointToBytes:Tg,numberToBytesBE:Tn.numberToBytesBE,bytesToNumberBE:Tn.bytesToNumberBE,taggedHash:c1,mod:tn.mod}};var QF=R7.isogenyMap(wo,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),eq=(0,GF.mapToCurveSimpleSWU)(wo,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:wo.create(BigInt("-11"))});Cg=R7.createHasher(Pr.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=eq(wo.create(e[0]));return QF(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:wo.ORDER,m:1,k:128,expand:"xmd",hash:s1.sha256}),Pr.hashToCurve=Cg.hashToCurve,Pr.encodeToCurve=Cg.encodeToCurve});var z7=K(_o=>{D();N();Object.defineProperty(_o,"__esModule",{value:!0});_o.poseidon=_o.splitConstants=_o.validateOpts=void 0;var V7=kc();function U7(e){let{Fp:t}=e;(0,V7.validateField)(t);for(let c of["t","roundsFull","roundsPartial"])if(typeof e[c]!="number"||!Number.isSafeInteger(e[c]))throw new Error(`Poseidon: invalid param ${c}=${e[c]} (${typeof e[c]})`);if(e.reversePartialPowIdx!==void 0&&typeof e.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${e.reversePartialPowIdx}`);let r=e.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=c=>(0,V7.FpPow)(t,c,n);if(r===3?i=c=>t.mul(t.sqrN(c),c):r===5&&(i=c=>t.mul(t.sqrN(t.sqrN(c)),c)),e.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${e.roundsFull}`);let s=e.roundsFull+e.roundsPartial;if(!Array.isArray(e.roundConstants)||e.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let a=e.roundConstants.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon wrong round constants: ${c}`);return c.map(u=>{if(typeof u!="bigint"||!t.isValid(u))throw new Error(`Poseidon wrong round constant=${u}`);return t.create(u)})});if(!Array.isArray(e.mds)||e.mds.length!==e.t)throw new Error("Poseidon: wrong MDS matrix");let o=e.mds.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon MDS matrix row: ${c}`);return c.map(u=>{if(typeof u!="bigint")throw new Error(`Poseidon MDS matrix value=${u}`);return t.create(u)})});return Object.freeze({...e,rounds:s,sboxFn:i,roundConstants:a,mds:o})}_o.validateOpts=U7;function tq(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<e.length;i++)n.push(e[i]),n.length===t&&(r.push(n),n=[]);return r}_o.splitConstants=tq;function rq(e){let{t,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=U7(e),a=Math.floor(e.roundsFull/2),o=s?t-1:0,c=(b,h,d)=>(b=b.map((l,y)=>r.add(l,e.roundConstants[d][y])),h?b=b.map(l=>i(l)):b[o]=i(b[o]),b=e.mds.map(l=>l.reduce((y,p,m)=>r.add(y,r.mulN(p,b[m])),r.ZERO)),b),u=function(h){if(!Array.isArray(h)||h.length!==t)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${t})`);h=h.map(l=>{if(typeof l!="bigint")throw new Error(`Poseidon: wrong value=${l} (${typeof l})`);return r.create(l)});let d=0;for(let l=0;l<a;l++)h=c(h,!0,d++);for(let l=0;l<e.roundsPartial;l++)h=c(h,!1,d++);for(let l=0;l<a;l++)h=c(h,!0,d++);if(d!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${d}, total=${n}`);return h};return u.roundConstants=e.roundConstants,u}_o.poseidon=rq});var iw=K(le=>{D();N();var nq=le&&le.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),iq=le&&le.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),sq=le&&le.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&nq(t,e,r);return iq(t,e),t};Object.defineProperty(le,"__esModule",{value:!0});le.poseidonHashMany=le.poseidonHashSingle=le.poseidonHashFunc=le.poseidonHash=le.poseidonSmall=le.poseidonCreate=le.poseidonBasic=le._poseidonMDS=le.Fp251=le.Fp253=le.keccak=le.computeHashOnElements=le.hashChain=le.pedersen=le.getAccountPath=le.ethSigToPrivate=le.getStarkKey=le.grindKey=le.utils=le.Signature=le.ProjectivePoint=le.CURVE=le.verify=le.sign=le.getSharedSecret=le.getPublicKey=le._starkCurve=void 0;var aq=xh(),Rg=Vf(),oq=pn(),Kc=kc(),cq=z7(),fq=n1(),On=sq(wa()),uq=Pg(),l1=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),W7=252;function $7(e){for(;e[0]===0;)e=e.subarray(1);let t=e.length*8-W7,r=On.bytesToNumberBE(e);return t>0?r>>BigInt(t):r}function X7(e){return typeof e=="string"&&(e=qg(e),e.length&1&&(e="0"+e)),On.hexToBytes(e)}var Vc=(0,fq.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,Kc.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:l1,nBitLength:W7,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,uq.getHash)(Rg.sha256),bits2int:$7,bits2int_modN:e=>{let t=On.bytesToNumberBE(e).toString(16);return t.length===63&&(e=X7(t+"0")),(0,Kc.mod)($7(e),l1)}});le._starkCurve=Vc;function Lc(e){return On.ensureBytes("",typeof e=="string"?X7(e):e)}function Fg(e){return On.bytesToHex(Lc(e)).padStart(64,"0")}function Y7(e,t=!1){return Vc.getPublicKey(Fg(e),t)}le.getPublicKey=Y7;function dq(e,t){return Vc.getSharedSecret(Fg(e),t)}le.getSharedSecret=dq;function lq(e,t,r){return Vc.sign(Lc(e),Fg(t),r)}le.sign=lq;function hq(e,t,r){let n=e instanceof Z7?e:Lc(e);return Vc.verify(n,Lc(t),Lc(r))}le.verify=hq;var{CURVE:pq,ProjectivePoint:bu,Signature:Z7,utils:bq}=Vc;le.CURVE=pq;le.ProjectivePoint=bu;le.Signature=Z7;le.utils=bq;function J7(e){return`0x${On.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function qg(e){return e.replace(/^0x/i,"")}function gq(e){return`0x${e.toString(16)}`}function Q7(e){let t=Lc(e),r=2n**256n,n=r-(0,Kc.mod)(r,l1);for(let i=0;;i++){let s=Dg(On.concatBytes(t,On.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,Kc.mod)(s,l1).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}le.grindKey=Q7;function vq(e){return J7(Y7(e,!0))}le.getStarkKey=vq;function yq(e){if(e=qg(e),e.length!==130)throw new Error("Wrong ethereum signature");return Q7(e.substring(0,64))}le.ethSigToPrivate=yq;var mq=2n**31n-1n,d1=e=>Number(e&mq);function wq(e,t,r,n){let i=d1(Dg(e)),s=d1(Dg(t)),a=On.hexToNumber(qg(r));return`m/2645'/${i}'/${s}'/${d1(a)}'/${d1(a>>31n)}'/${n}`}le.getAccountPath=wq;var d0=[new bu(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new bu(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new bu(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new bu(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new bu(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function ew(e,t){let r=[],n=e;for(let i=0;i<248;i++)r.push(n),n=n.double();n=t;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var _q=ew(d0[1],d0[2]),Sq=ew(d0[3],d0[4]);function tw(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=On.bytesToNumberBE(Lc(e));if(!(0n<=t&&t<Vc.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function G7(e,t,r){let n=tw(t);for(let i=0;i<252;i++){let s=r[i];if(s.equals(e))throw new Error("Same point");(n&1n)!==0n&&(e=e.add(s)),n>>=1n}return e}function Hg(e,t){let r=d0[0];return r=G7(r,e,_q),r=G7(r,t,Sq),J7(r.toRawBytes(!0))}le.pedersen=Hg;function xq(e,t=Hg){if(!Array.isArray(e)||e.length<1)throw new Error("data should be array of at least 1 element");return e.length===1?gq(tw(e[0])):Array.from(e).reverse().reduce((r,n)=>t(n,r))}le.hashChain=xq;var Eq=(e,t=Hg)=>[0,...e,e.length].reduce((r,n)=>t(r,n));le.computeHashOnElements=Eq;var Aq=On.bitMask(250),Pq=e=>On.bytesToNumberBE((0,aq.keccak_256)(e))&Aq;le.keccak=Pq;var Dg=e=>On.bytesToNumberBE((0,Rg.sha256)(e));le.Fp253=(0,Kc.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));le.Fp251=(0,Kc.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function Ng(e,t,r){let n=e.fromBytes((0,Rg.sha256)((0,oq.utf8ToBytes)(`${t}${r}`)));return e.create(n)}function rw(e,t,r,n=0){let i=[],s=[];for(let a=0;a<r;a++)i.push(Ng(e,`${t}x`,n*r+a)),s.push(Ng(e,`${t}y`,n*r+a));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(a=>s.map(o=>e.inv(e.sub(a,o))))}le._poseidonMDS=rw;var Cq=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function jg(e,t){if((0,Kc.validateField)(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);let r=e.rate+e.capacity,n=e.roundsFull+e.roundsPartial,i=[];for(let a=0;a<n;a++){let o=[];for(let c=0;c<r;c++)o.push(Ng(e.Fp,"Hades",r*a+c));i.push(o)}let s=(0,cq.poseidon)({...e,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:i});return s.m=r,s.rate=e.rate,s.capacity=e.capacity,s}le.poseidonBasic=jg;function Iq(e,t=0){let r=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return jg(e,rw(e.Fp,"HadesMDS",r,t))}le.poseidonCreate=Iq;le.poseidonSmall=jg({Fp:le.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},Cq);function nw(e,t,r=le.poseidonSmall){return r([e,t,2n])[0]}le.poseidonHash=nw;function Bq(e,t,r=le.poseidonSmall){return On.numberToVarBytesBE(nw(On.bytesToNumberBE(e),On.bytesToNumberBE(t),r))}le.poseidonHashFunc=Bq;function Mq(e,t=le.poseidonSmall){return t([e,0n,1n])[0]}le.poseidonHashSingle=Mq;function Tq(e,t=le.poseidonSmall){let{m:r,rate:n}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");let i=Array.from(e);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let a=0;a<i.length;a+=n){for(let o=0;o<n;o++)s[o]+=i[a+o];s=t(s)}return s[0]}le.poseidonHashMany=Tq});var ow=K(Dn=>{D();N();var Oq=Dn&&Dn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Dq=Dn&&Dn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),sw=Dn&&Dn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Oq(t,e,r);return Dq(t,e),t};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.bytesToHex=Dn.hexToBytes=Dn.stark=Dn.secp256k1=void 0;Dn.secp256k1=sw(K7());Dn.stark=sw(iw());var aw=wa();Object.defineProperty(Dn,"hexToBytes",{enumerable:!0,get:function(){return aw.hexToBytes}});Object.defineProperty(Dn,"bytesToHex",{enumerable:!0,get:function(){return aw.bytesToHex}})});var cw=K(Nn=>{D();N();var Nq=Nn&&Nn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Rq=Nn&&Nn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),h1=Nn&&Nn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Nq(t,e,r);return Rq(t,e),t};Object.defineProperty(Nn,"__esModule",{value:!0});Nn.schnorr=Nn.p256=Nn.ed25519=Nn.secp256k1=void 0;Nn.secp256k1=h1(X9());Nn.ed25519=h1(i7());Nn.p256=h1(c7());Nn.schnorr=h1(ow())});var ci=K(Cr=>{D();N();var Fq=Cr&&Cr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qq=Cr&&Cr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),gu=Cr&&Cr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Fq(t,e,r);return qq(t,e),t};Object.defineProperty(Cr,"__esModule",{value:!0});Cr.secp256k1=Cr.ed25519=Cr.signUtil=Cr.elliptic=Cr.bip39=Cr.bip32=void 0;Cr.bip32=gu(M9());Cr.bip39=gu(bg());Cr.elliptic=gu(cu());Cr.signUtil=gu(cw());Cr.ed25519=gu(rl());Cr.secp256k1=gu(Im())});var uw=K(b1=>{D();N();Object.defineProperty(b1,"__esModule",{value:!0});b1.Feldman=void 0;var fw=Nb(),p1=ci(),kg=class{constructor(t,r,n){if(!Number.isInteger(t))throw new Error("Expect integer threshold");if(t<2)throw new Error("Expect threshold >= 2");if(this.threshold=t,!Number.isInteger(r))throw new Error("Expect integer limit");if(r<t)throw new Error("Expect limit >= threshold");if(this.limit=r,n=="ed25519")this.primeOrder=p1.ed25519.CURVE.n;else if(n=="secp256k1")this.primeOrder=p1.secp256k1.CURVE.n;else throw new Error("Expect ed25519 or secp256k1 curve");this.curve=n}async evaluate(t){let r=await fw.polynomial.initPolynomial(this.primeOrder,t,this.threshold-1),n=new Array(this.limit);for(let s=1;s<=this.limit;s++){let a=BigInt(s);n[s-1]=fw.polynomial.evaluatePolynomial(r,a)}let i=new Array(r.coefficients.length);for(let s in r.coefficients)i[s]=await p1.ed25519.Point.fromPrivateKey(r.coefficients[s]);return{verifiers:i,shares:n}}async verify(t,r){if(r.length<this.threshold)throw new Error("not enough number of verifiers");let n=await p1.ed25519.Point.fromPrivateKey(t.y),i=1n,s=r[0];for(let a=1;a<=r.length;a++){i*=t.id;let o=r[a].multiply(i);s=s.add(o)}return n===s}};b1.Feldman=kg});var l0=K(xa=>{D();N();Object.defineProperty(xa,"__esModule",{value:!0});xa.Signature=xa.ECPoint=xa.CurveName=void 0;var vu=ci(),dw=Ni(),g1;(function(e){e.Secp256k1="secp256k1",e.Ed25519="ed25519"})(g1=xa.CurveName||(xa.CurveName={}));var yu=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}toHex(){return this.Curve===g1.Secp256k1?this.toEcdsaPoint().toHex(!0):this.toEd25519Point().toHex()}toEcdsaPoint(){return new vu.secp256k1.Point(this.X,this.Y)}toEd25519Point(){return new vu.ed25519.Point(this.X,this.Y)}static fromEcdsaPoint(t){return new yu(g1.Secp256k1.toString(),t.x,t.y)}static fromEd25519Point(t){return new yu(g1.Ed25519.toString(),t.x,t.y)}};xa.ECPoint=yu;var mu=class{constructor(t,r){this.r=t,this.s=r}toEcdsaSignature(){return new vu.secp256k1.Signature(this.r,this.s)}toEd25519Signature(){let t=new Uint8Array((0,dw.cvtBigintToUint8array)(this.r)).reverse(),r=vu.ed25519.Point.fromHex(vu.ed25519.utils.bytesToHex(t));return new vu.ed25519.Signature(r,this.s)}static fromEcdsaSignature(t){return new mu(t.r,t.s)}static fromEd25519Signature(t){let r=new Uint8Array(t.r.toRawBytes()).reverse(),n=(0,dw.cvtUint8arrayToBigint)(r);return new mu(n,t.s)}};xa.Signature=mu});var Kg=K(So=>{D();N();Object.defineProperty(So,"__esModule",{value:!0});So.verify=So.prove=So.Proof=void 0;var lw=l0(),Lg=Ni(),Uc=ci(),v1=Ps(),y1=class{constructor(t,r){this.R=t,this.S=r}};So.Proof=y1;async function Hq(e,t,r){try{let n=Uc.secp256k1.CURVE.n,i=(0,Lg.RandomNum)(n),s=Uc.secp256k1.Point.fromPrivateKey(i),a=Uc.secp256k1.Point.fromPrivateKey(BigInt(1)),o=(0,Lg.SHA256Int)([e,a.x,a.y,r.x,r.y,s.x,s.y])%n,c=(i+o*t)%n;return new y1(new lw.ECPoint(lw.CurveName.Secp256k1,s.x,s.y),c)}catch(n){return Promise.reject(new v1.MPCError(v1.SchnorrProveError,n))}}So.prove=Hq;function jq(e,t,r){try{let n=new Uc.secp256k1.Point(t.R.X,t.R.Y),i=Uc.secp256k1.CURVE.n,s=Uc.secp256k1.Point.fromPrivateKey(BigInt(1)),a=(0,Lg.SHA256Int)([e,s.x,s.y,r.x,r.y,n.x,n.y])%i,o=Uc.secp256k1.Point.fromPrivateKey(BigInt(t.S.toString(10))),c=r.multiply(a);return n.add(c).equals(o)}catch(n){throw new v1.MPCError(v1.SchnorrVerifyError,n)}}So.verify=jq});var Ug=K(Ds=>{D();N();Object.defineProperty(Ds,"__esModule",{value:!0});Ds.verify=Ds.prove=Ds.Proof=Ds.Ed25519Point=void 0;var Vg=Ni(),h0=ci(),m1=l0(),w1=Ps(),_1=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}};Ds.Ed25519Point=_1;var wu=class{constructor(t,r){this.R=t,this.S=r}JsonStringify(){let t=new _1("ed25519",this.R.X,this.R.Y);return JSON.stringify({R:t,S:this.S},(r,n)=>typeof n=="bigint"?n.toString():n)}static JsonParse(t){let r=JSON.parse(t),n=new m1.ECPoint(m1.CurveName.Ed25519.toString(),BigInt(r.R.X),BigInt(r.R.Y));return new wu(n,r.S)}};Ds.Proof=wu;async function kq(e,t){try{let r=h0.ed25519.CURVE.n,n=(0,Vg.RandomNum)(r),i=BigInt(n.toString()),s=h0.ed25519.Point.BASE.multiply(BigInt(n.toString())),a=(0,Vg.SHA256Int)([t.x,t.y,s.x,s.y])%r,o=(i+a*e)%r;return new wu(new m1.ECPoint(m1.CurveName.Ed25519,s.x,s.y),o)}catch(r){return Promise.reject(new w1.MPCError(w1.SchnorrProveError,r))}}Ds.prove=kq;function Lq(e,t){try{let r=new h0.ed25519.Point(e.R.X,e.R.Y),n=h0.ed25519.CURVE.n,i=(0,Vg.SHA256Int)([t.x,t.y,r.x,r.y])%n,s=BigInt(e.S.toString())%n,a=h0.ed25519.Point.BASE.multiply(s),o=t.multiply(i);return r.add(o).equals(a)}catch(r){throw new w1.MPCError(w1.SchnorrVerifyError,r)}}Ds.verify=Lq});var _u=K(qr=>{D();N();var hw=qr&&qr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Kq=qr&&qr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p0=qr&&qr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&hw(t,e,r)},pw=qr&&qr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&hw(t,e,r);return Kq(t,e),t};Object.defineProperty(qr,"__esModule",{value:!0});qr.ed25519Schnorr=qr.ecdsaSchnorr=void 0;p0(P4(),qr);p0(B4(),qr);p0(uw(),qr);p0(Nb(),qr);qr.ecdsaSchnorr=pw(Kg());qr.ed25519Schnorr=pw(Ug());p0(l0(),qr)});var vw=K(Su=>{D();N();Object.defineProperty(Su,"__esModule",{value:!0});Su.Ed25519Verify=Su.Ed25519Sign=void 0;var b0=_u(),Ns=ci(),bw=Ni(),Vq=e=>e.length!==0&&e.length%2===0&&!/[^a-fA-F0-9]/u.test(e),Uq=e=>Uint8Array.from(e.match(/.{1,2}/g).map(t=>parseInt(t,16))),zg=class{constructor(t,r,n,i,s,a){this.deviceNumber=t,this.threshold=r,this.partList=n,this.publicKey=s,this.message=a,this.roundNumber=1;let o=new Array(n.length);for(let c=0;c<n.length;c++)o[c]=BigInt(n[c]);this.wi=b0.polynomial.calLagrangian(Ns.ed25519.CURVE.n,BigInt(t),i,o)}async signStep1(){if(this.roundNumber!=1)throw new Error("not in round 1");this.ki=(0,bw.RandomNum)(Ns.ed25519.CURVE.n);let t=Ns.ed25519.Point.BASE.multiply(this.ki),r=b0.Commitment.NewCommitment([t.x,t.y]);this.cmtD=r.Msg,this.roundNumber=2;let n=new Map;for(let i of this.partList){if(i==this.deviceNumber)continue;let s={c:r.C},a={from:this.deviceNumber,to:i,data:s};n.set(i,a)}return n}async signStep2(t){if(this.roundNumber!=2)throw new Error("not in round 2");if(t.length!=this.threshold-1)throw new Error("message number error");this.commitmentMap=new Map;for(let s of t){if(s.to!=this.deviceNumber)throw new Error("message sending error");let a=s.data;this.commitmentMap.set(s.from,a.c)}let r=Ns.ed25519.Point.BASE.multiply(this.ki),n=await b0.ed25519Schnorr.prove(this.ki,r);this.roundNumber=3;let i=new Map;for(let s of this.partList){if(s==this.deviceNumber)continue;let a={witness:this.cmtD,proof:n},o={from:this.deviceNumber,to:s,data:a};i.set(s,o)}return i}async signStep3(t){if(this.roundNumber!=3)throw new Error("not in round 3");if(t.length!=this.threshold-1)throw new Error("message number error");let r=Ns.ed25519.Point.BASE.multiply(this.ki);for(let o of t){if(o.to!=this.deviceNumber)throw new Error("message sending error");let c=o.data,b={C:this.commitmentMap.get(o.from),Msg:c.witness},h=b0.Commitment.Open(b);if(!h)throw new Error("commitment DeCommit fail");let d=BigInt(h[0].toString()),l=BigInt(h[1].toString()),y=new Ns.ed25519.Point(d,l),p=c.proof;if(!b0.ed25519Schnorr.verify(p,y))throw new Error("schnorr verify fail");r=r.add(y)}let n=$q(r.toRawBytes());if(!Vq(this.message))throw new Error("stored message not hex");let i=await Ns.ed25519.utils.sha512(r.toRawBytes(),this.publicKey.toRawBytes(),Uq(this.message)),s=Gq(i);return[gw(this.ki+s*this.wi,Ns.ed25519.CURVE.n),n]}};Su.Ed25519Sign=zg;async function zq(e,t,r){let n=e.toEd25519Signature(),i=r.toEd25519Point(),s=await Ns.ed25519.verify(n,t,i);return[e,s]}Su.Ed25519Verify=zq;function $q(e){let t=new Uint8Array(e);return t.reverse(),(0,bw.cvtUint8arrayToBigint)(t)}function Gq(e){let t=BigInt("0x"+Xq(Uint8Array.from(e).reverse()));return gw(t,Ns.ed25519.CURVE.l)}function gw(e,t){let r=e%t;return r>=BigInt(0)?r:t+r}var Wq=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Xq(e){let t="";for(let r=0;r<e.length;r++)t+=Wq[e[r]];return t}});var S1=K(xu=>{D();N();Object.defineProperty(xu,"__esModule",{value:!0});xu.calPrivateOffset=xu.TssKey=void 0;var ww=ci(),g0=ar(),Yq=Ni(),yw=Ps(),mw=ww.secp256k1.CURVE,v0=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new g0.BN(0)}async NewChildKey(t){try{let r=H.Buffer.from((0,Yq.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=_w(r,this.chaincode,t),i=new g0.BN(n.slice(0,32)),s=ww.secp256k1.Point.fromPrivateKey(BigInt(i.toString(10))),a=this.publicKey.add(s),o=this.shareI;o!=null&&(o=o.add(i),o=o.mod(new g0.BN(mw.n.toString())));let c=this.offsetSonPri.add(i);c=c.mod(new g0.BN(mw.n.toString()));let u=new v0(o,a,n.slice(32));return u.offsetSonPri=c,u}catch(r){return Promise.reject(new yw.MPCError(yw.Bip32NewChildKeyError,r))}}};xu.TssKey=v0;function _w(e,t,r){let n=H.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=H.Buffer.allocUnsafe(t.length+e.length+n.length);return t.copy(i,0),e.copy(i,t.length),n.copy(i,t.length+e.length),g0.base.hmacSHA512(H.Buffer.from(`Key share derivation:
`,"utf8"),i)}xu.calPrivateOffset=_w});var Gg=K(E1=>{D();N();Object.defineProperty(E1,"__esModule",{value:!0});E1.TssKey=void 0;var xw=ci(),x1=ar(),Zq=S1(),Jq=Ni(),Sw=Ps(),$g=xw.ed25519.CURVE,y0=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new x1.BN(0)}async NewChildKey(t){try{let r=H.Buffer.from((0,Jq.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=(0,Zq.calPrivateOffset)(r,this.chaincode,t),i=new x1.BN(n.slice(0,32)),s=xw.ed25519.Point.BASE.multiply(BigInt(i.toString(10))%$g.n),a=this.publicKey.add(s),o=this.shareI;o!=null&&(o=o.add(i),o=o.mod(new x1.BN($g.n.toString())));let c=this.offsetSonPri.add(i);c=c.mod(new x1.BN($g.n.toString()));let u=new y0(o,a,n.slice(32));return u.offsetSonPri=c,u}catch(r){return Promise.reject(new Sw.MPCError(Sw.Bip32NewChildKeyError,r))}}};E1.TssKey=y0});var A1={};m2(A1,{abs:()=>zc,bitLength:()=>Qq,crt:()=>Aw,eGcd:()=>Ew,gcd:()=>Pw,lcm:()=>eH,max:()=>tH,min:()=>rH,modAdd:()=>nH,modInv:()=>Xg,modMultiply:()=>iH,modPow:()=>Wg,phi:()=>Cw,toZn:()=>$c});function zc(e){return e>=0?e:-e}function Qq(e){if(typeof e=="number"&&(e=BigInt(e)),e===1n)return 1;let t=1;do t++;while((e>>=1n)>1n);return t}function Ew(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e<=0n||t<=0n)throw new RangeError("a and b MUST be > 0");let r=0n,n=1n,i=1n,s=0n;for(;e!==0n;){let a=t/e,o=t%e,c=r-i*a,u=n-s*a;t=e,e=o,r=i,n=s,i=c,s=u}return{g:t,x:r,y:n}}function $c(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),t<=0n)throw new RangeError("n must be > 0");let r=e%t;return r<0n?r+t:r}function Xg(e,t){let r=Ew($c(e,t),t);if(r.g!==1n)throw new RangeError(`${e.toString()} does not have inverse modulo ${t.toString()}`);return $c(r.x,t)}function Aw(e,t,r){if(e.length!==t.length)throw new RangeError("The remainders and modulos arrays should have the same length");let n=r??t.reduce((i,s)=>i*s,1n);return t.reduce((i,s,a)=>{let o=n/s;return $c(i+o*Xg(o,s)%n*e[a]%n,n)},0n)}function Pw(e,t){let r=typeof e=="number"?BigInt(zc(e)):zc(e),n=typeof t=="number"?BigInt(zc(t)):zc(t);if(r===0n)return n;if(n===0n)return r;let i=0n;for(;(1n&(r|n))===0n;)r>>=1n,n>>=1n,i++;for(;(1n&r)===0n;)r>>=1n;do{for(;(1n&n)===0n;)n>>=1n;if(r>n){let s=r;r=n,n=s}n-=r}while(n!==0n);return r<<i}function eH(e,t){return typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e===0n&&t===0n?BigInt(0):zc(e/Pw(e,t)*t)}function tH(e,t){return e>=t?e:t}function rH(e,t){return e>=t?t:e}function nH(e,t){let r=BigInt(t);return $c(e.map(n=>BigInt(n)%r).reduce((n,i)=>n+i%r,0n),r)}function iH(e,t){let r=BigInt(t);return $c(e.map(n=>BigInt(n)%r).reduce((n,i)=>n*i%r,1n),r)}function Cw(e){return e.map(t=>t[0]**(t[1]-1n)*(t[0]-1n)).reduce((t,r)=>r*t,1n)}function Wg(e,t,r,n){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),typeof r=="number"&&(r=BigInt(r)),r<=0n)throw new RangeError("n must be > 0");if(r===1n)return 0n;if(e=$c(e,r),t<0n)return Xg(Wg(e,zc(t),r,n),r);if(n!==void 0)return function(s,a,o,c){let u=c.map(d=>d[0]**d[1]),b=c.map(d=>Cw([d])),h=b.map((d,l)=>Wg(s,a%d,u[l]));return Aw(h,u,o)}(e,t,r,function(s){let a={};return s.forEach(o=>{if(typeof o=="bigint"||typeof o=="number"){let c=String(o);a[c]===void 0?a[c]={p:BigInt(o),k:1n}:a[c].k+=1n}else{let c=String(o[0]);a[c]===void 0?a[c]={p:BigInt(o[0]),k:BigInt(o[1])}:a[c].k+=BigInt(o[1])}}),Object.values(a).map(o=>[o.p,o.k])}(n));let i=1n;for(;t>0;)t%2n===1n&&(i=i*e%r),t/=2n,e=e**2n%r;return i}var P1=el(()=>{D();N()});var Zg=K(Eu=>{D();N();Object.defineProperty(Eu,"__esModule",{value:!0});Eu.PaillierAffineVerify=Eu.PaillierAffineProve=void 0;var Gc=ci(),Iw=l0(),Ea=Ni(),Rs=(P1(),ws(A1)),C1=Gc.secp256k1.CURVE,Zre=BigInt(2),Yg=2*256,Bw=3*256,I1=3*256;function sH(e,t,r){let n=t.N*t.N,i=1n<<BigInt(Yg+I1),s=1n<<BigInt(Bw+I1),a=1n<<BigInt(Yg),o=(0,Ea.RandomNum)(i),c=(0,Ea.RandomNum)(s),u=(0,Ea.RandomNum)(t.N),b=(0,Ea.RandomNum)(i*e.Ntilde),h=(0,Ea.RandomNum)(a*e.Ntilde),d=(0,Ea.RandomNum)(i*e.Ntilde),l=(0,Ea.RandomNum)(a*e.Ntilde),y=(0,Rs.modPow)(t.C,o,n);y=y*(0,Rs.modPow)(1n+t.N,c,n)%n,y=y*(0,Rs.modPow)(u,t.N,n)%n;let p=Iw.ECPoint.fromEcdsaPoint(Gc.secp256k1.Point.fromPrivateKey(o%C1.n)),m=Iw.ECPoint.fromEcdsaPoint(Gc.secp256k1.Point.fromPrivateKey(c%C1.n)),w=e.Commit(o,b),C=e.Commit(r.X,h),T=e.Commit(c,d),q=e.Commit(r.Y,l),j=(0,Ea.SHA256Int)([t.N,t.C,t.D,t.X.X,t.Y.X,y,p.X,m.X,w,C,T,q])%Gc.secp256k1.CURVE.n,k=o+j*r.X,I=c+j*r.Y,R=b+j*h,A=d+j*l,f=u*(0,Rs.modPow)(r.Rho,j,t.N)%t.N;return{A:y,Bx:p,By:m,E:w,S:C,F:T,T:q,Z1:k,Z2:I,Z3:R,Z4:A,W:f,X:t.X,Y:t.Y}}Eu.PaillierAffineProve=sH;function aH(e,t,r){let n=r.N*r.N,s=(0,Ea.SHA256Int)([r.N,r.C,r.D,r.X.X,r.Y.X,t.A,t.Bx.X,t.By.X,t.E,t.S,t.F,t.T])%Gc.secp256k1.CURVE.n,a=(0,Rs.modPow)(r.C,t.Z1,n);a=a*(0,Rs.modPow)(1n+r.N,t.Z2,n)%n*(0,Rs.modPow)(t.W,r.N,n)%n;let o=t.A*(0,Rs.modPow)(r.D,s,n)%n;if(a!==o)return!1;let c=Gc.secp256k1.Point.fromPrivateKey(t.Z1%C1.n),u=t.Bx.toEcdsaPoint().add(r.X.toEcdsaPoint().multiply(s));if(!c.equals(u))return!1;let b=Gc.secp256k1.Point.fromPrivateKey(t.Z2%C1.n),h=t.By.toEcdsaPoint().add(r.Y.toEcdsaPoint().multiply(s));if(!b.equals(h))return!1;let d=e.Commit(t.Z1,t.Z3),l=t.E*(0,Rs.modPow)(t.S,s,e.Ntilde)%e.Ntilde;if(d!==l)return!1;let y=e.Commit(t.Z2,t.Z4),p=t.F*(0,Rs.modPow)(t.T,s,e.Ntilde)%e.Ntilde;return!(y!==p||t.Z1>=1n<<BigInt(Yg+I1)||t.Z2>=1n<<BigInt(Bw+I1))}Eu.PaillierAffineVerify=aH});var Ow=K(M1=>{D();N();Object.defineProperty(M1,"__esModule",{value:!0});M1.P1=void 0;var B1=ar(),oH=(Vd(),ws(Kd)),Jg=_u(),m0=ci(),Mw=Ni(),cH=Zg(),fH=Jg.Commitment.NewCommitment,Tw=m0.secp256k1.CURVE,Qg=class{constructor(t,r,n,i,s){let a;try{a=(0,oH.hexToBigint)(i)}catch{throw new Error(`message not hex: ${i}`)}this.sessionId=(0,Mw.SHA256Int)([r.x,r.y,a]),this.k1=new B1.BN((0,Mw.RandomNum)(Tw.n).toString()),this.publicKey=r,this.paiPrivKey=n,this.message=i,this.cmtD=[],this.E_x1=t,this.ped=s}step1(){let t=m0.secp256k1.Point.fromPrivateKey(BigInt(this.k1.toString())),r=fH([this.sessionId,t.x,t.y]);return this.cmtD=r.Msg,r.C}step2(t,r){let n=BigInt(this.k1.toString()),i=m0.secp256k1.Point.fromPrivateKey(n);if(!Jg.ecdsaSchnorr.verify(this.sessionId,t,r))throw new Error("schnorr verify fail");return this.R2=r,[Jg.ecdsaSchnorr.prove(this.sessionId,n,i),this.cmtD]}step3(t,r){let n={N:BigInt(this.paiPrivKey.pailPubKey.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(t.toString()),X:r.X,Y:r.Y};if(!(0,cH.PaillierAffineVerify)(this.ped,r,n))throw new Error("Paillier Affine verify fail");let s=new B1.BN(Tw.n.toString()),o=this.R2?.multiply(BigInt(this.k1.toString()))?.x,c=new B1.BN(o.toString()).mod(new B1.BN(s)),u=this.paiPrivKey.decrypt(t),b=this.k1.invm(s),h=u.mul(b).mod(s),d=s.shrn(1);if(h.cmp(d)==1&&(h=s.sub(h)),h.isZero())throw new Error("calculated S is zero");let l=new m0.secp256k1.Signature(BigInt(c.toString()),BigInt(h.toString()));if(!m0.secp256k1.verify(l,this.message,this.publicKey))throw new Error("ecdsa sign verify fail");return[c,h]}};M1.P1=Qg});var Fw=K(Fs=>{D();N();Object.defineProperty(Fs,"__esModule",{value:!0});Fs.truncateHash=Fs.toU8=Fs.bits2int_modN=void 0;var Dw=2n**256n,uH=Dw-0x1000003d1n,dH=Dw-0x14551231950b75fc4402da1732fc9bebfn,lH=e=>Array.from(e).map(t=>hH(t,2)).join(""),hH=(e,t)=>e.toString(16).padStart(t,"0"),pH=e=>BigInt(`0x${lH(e)||"0"}`),bH=e=>{let t=e.length*8-256,r=pH(e);return t>0?r>>BigInt(t):r},gH=e=>vH(bH(e),dH);Fs.bits2int_modN=gH;var vH=(e,t=uH)=>{let r=e%t;return r>=0n?r:t+r},Nw=e=>typeof e=="string",yH=(e,t)=>!(e instanceof Uint8Array)||typeof t=="number"&&t>0&&e.length!==t?ev("Uint8Array expected"):e,Rw=e=>new Uint8Array(e),mH=(e,t)=>yH(Nw(e)?wH(e):Rw(e),t);Fs.toU8=mH;var wH=e=>{let t=e.length;(!Nw(e)||t%2)&&ev("hex invalid 1");let r=Rw(t/2);for(let n=0;n<r.length;n++){let i=n*2,s=e.slice(i,i+2),a=Number.parseInt(s,16);(Number.isNaN(a)||a<0)&&ev("hex invalid 2"),r[n]=a}return r},ev=(e="")=>{throw new Error(e)},_H=e=>(0,Fs.bits2int_modN)((0,Fs.toU8)(e,32));Fs.truncateHash=_H});var Hw=K(D1=>{D();N();Object.defineProperty(D1,"__esModule",{value:!0});D1.P2=void 0;var Au=ar(),SH=(Vd(),ws(Kd)),w0=_u(),_0=ci(),T1=Ni(),qw=Fw(),xH=Zg(),EH=(P1(),ws(A1)),O1=_0.secp256k1.CURVE,tv=class{constructor(t,r,n,i,s,a){let o;try{o=(0,SH.hexToBigint)(s)}catch{throw new Error(`message not hex: ${s}`)}this.sessionId=(0,T1.SHA256Int)([i.x,i.y,o]),this.x2=t,this.E_x1=r,this.paiPub=n,this.publicKey=i,this.message=s,this.k2=new Au.BN((0,T1.RandomNum)(O1.n).toString()),this.cmtC=0n,this.ped=a}step1(t){this.cmtC=t;let r=_0.secp256k1.Point.fromPrivateKey(BigInt(this.k2.toString()));return[w0.ecdsaSchnorr.prove(this.sessionId,BigInt(this.k2.toString()),r),r]}step2(t,r){let n=new Au.BN(O1.n.toString()),i={C:this.cmtC,Msg:r},s=w0.Commitment.Open(i);if(!s)throw new Error("commitment DeCommit fail");if(this.sessionId!==s[0])throw new Error("p2 Step2 commitment sessionId error");let a=new _0.secp256k1.Point(s[1],s[2]);if(!w0.ecdsaSchnorr.verify(this.sessionId,t,a))throw new Error("schnorr verify fail");let u=a.multiply(BigInt(this.k2.toString()))?.x,b=new Au.BN(u.toString()).mod(n),h=this.k2.invm(n),d=AH(this.message);d=d.mul(h);let y=new Au.BN((0,T1.RandomNum)(O1.n*O1.n).toString()).mul(n),p=d.add(y),m=b.mul(h),w=p.add(m.mul(this.x2)),C=(0,T1.RandomNum)(BigInt(this.paiPub.n.toString())),T=this.paiPub.homomorphicMulPlain(this.E_x1,m),q=this.paiPub.homomorphicAddPlain(T,w),F=BigInt(this.paiPub.n.toString()),j=BigInt(this.paiPub.n2().toString()),k=new Au.BN((0,EH.modPow)(C,F,j).toString()),I=q.mul(k).mod(this.paiPub.n2()),R=w0.ECPoint.fromEcdsaPoint(_0.secp256k1.Point.fromPrivateKey(BigInt(m.mod(n).toString()))),A=w0.ECPoint.fromEcdsaPoint(_0.secp256k1.Point.fromPrivateKey(BigInt(w.mod(n).toString()))),f={N:BigInt(this.paiPub.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(I.toString()),X:R,Y:A},g={X:BigInt(m.toString()),Y:BigInt(w.toString()),Rho:BigInt(C.toString())},E=(0,xH.PaillierAffineProve)(this.ped,f,g);return[I,E]}};D1.P2=tv;function AH(e){let t=(0,qw.bits2int_modN)((0,qw.toU8)(e,32));return new Au.BN(t.toString())}});var Lw=K(yn=>{D();N();var jw=yn&&yn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),PH=yn&&yn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),rv=yn&&yn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&jw(t,e,r)},kw=yn&&yn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&jw(t,e,r);return PH(t,e),t};Object.defineProperty(yn,"__esModule",{value:!0});yn.ed25519TssKey=yn.ecdsaTssKey=void 0;rv(vw(),yn);yn.ecdsaTssKey=kw(S1());yn.ed25519TssKey=kw(Gg());rv(Ow(),yn);rv(Hw(),yn)});var Vw=K(Kw=>{D();N();Object.defineProperty(Kw,"__esModule",{value:!0})});var R1=K(N1=>{D();N();Object.defineProperty(N1,"__esModule",{value:!0});N1.md5=void 0;function CH(e){var t="0123456789abcdef";function r(F){var j,k="";for(j=0;j<=3;j++)k+=t.charAt(F>>j*8+4&15)+t.charAt(F>>j*8&15);return k}function n(F,j){var k=(F&65535)+(j&65535),I=(F>>16)+(j>>16)+(k>>16);return I<<16|k&65535}function i(F,j){return F<<j|F>>>32-j}function s(F,j,k,I,R,A){return n(i(n(n(j,F),n(I,A)),R),k)}function a(F,j,k,I,R,A,f){return s(j&k|~j&I,F,j,R,A,f)}function o(F,j,k,I,R,A,f){return s(j&I|k&~I,F,j,R,A,f)}function c(F,j,k,I,R,A,f){return s(j^k^I,F,j,R,A,f)}function u(F,j,k,I,R,A,f){return s(k^(j|~I),F,j,R,A,f)}function b(F){var j,k=(F.length+8>>6)+1,I=new Array(k*16);for(j=0;j<k*16;j++)I[j]=0;for(j=0;j<F.length;j++)I[j>>2]|=F.charCodeAt(j)<<j%4*8;return I[j>>2]|=128<<j%4*8,I[k*16-2]=F.length*8,I}var h,d=b(""+e),l=1732584193,y=-271733879,p=-1732584194,m=271733878,w,C,T,q;for(h=0;h<d.length;h+=16)w=l,C=y,T=p,q=m,l=a(l,y,p,m,d[h+0],7,-680876936),m=a(m,l,y,p,d[h+1],12,-389564586),p=a(p,m,l,y,d[h+2],17,606105819),y=a(y,p,m,l,d[h+3],22,-1044525330),l=a(l,y,p,m,d[h+4],7,-176418897),m=a(m,l,y,p,d[h+5],12,1200080426),p=a(p,m,l,y,d[h+6],17,-1473231341),y=a(y,p,m,l,d[h+7],22,-45705983),l=a(l,y,p,m,d[h+8],7,1770035416),m=a(m,l,y,p,d[h+9],12,-1958414417),p=a(p,m,l,y,d[h+10],17,-42063),y=a(y,p,m,l,d[h+11],22,-1990404162),l=a(l,y,p,m,d[h+12],7,1804603682),m=a(m,l,y,p,d[h+13],12,-40341101),p=a(p,m,l,y,d[h+14],17,-1502002290),y=a(y,p,m,l,d[h+15],22,1236535329),l=o(l,y,p,m,d[h+1],5,-165796510),m=o(m,l,y,p,d[h+6],9,-1069501632),p=o(p,m,l,y,d[h+11],14,643717713),y=o(y,p,m,l,d[h+0],20,-373897302),l=o(l,y,p,m,d[h+5],5,-701558691),m=o(m,l,y,p,d[h+10],9,38016083),p=o(p,m,l,y,d[h+15],14,-660478335),y=o(y,p,m,l,d[h+4],20,-405537848),l=o(l,y,p,m,d[h+9],5,568446438),m=o(m,l,y,p,d[h+14],9,-1019803690),p=o(p,m,l,y,d[h+3],14,-187363961),y=o(y,p,m,l,d[h+8],20,1163531501),l=o(l,y,p,m,d[h+13],5,-1444681467),m=o(m,l,y,p,d[h+2],9,-51403784),p=o(p,m,l,y,d[h+7],14,1735328473),y=o(y,p,m,l,d[h+12],20,-1926607734),l=c(l,y,p,m,d[h+5],4,-378558),m=c(m,l,y,p,d[h+8],11,-2022574463),p=c(p,m,l,y,d[h+11],16,1839030562),y=c(y,p,m,l,d[h+14],23,-35309556),l=c(l,y,p,m,d[h+1],4,-1530992060),m=c(m,l,y,p,d[h+4],11,1272893353),p=c(p,m,l,y,d[h+7],16,-155497632),y=c(y,p,m,l,d[h+10],23,-1094730640),l=c(l,y,p,m,d[h+13],4,681279174),m=c(m,l,y,p,d[h+0],11,-358537222),p=c(p,m,l,y,d[h+3],16,-722521979),y=c(y,p,m,l,d[h+6],23,76029189),l=c(l,y,p,m,d[h+9],4,-640364487),m=c(m,l,y,p,d[h+12],11,-421815835),p=c(p,m,l,y,d[h+15],16,530742520),y=c(y,p,m,l,d[h+2],23,-995338651),l=u(l,y,p,m,d[h+0],6,-198630844),m=u(m,l,y,p,d[h+7],10,1126891415),p=u(p,m,l,y,d[h+14],15,-1416354905),y=u(y,p,m,l,d[h+5],21,-57434055),l=u(l,y,p,m,d[h+12],6,1700485571),m=u(m,l,y,p,d[h+3],10,-1894986606),p=u(p,m,l,y,d[h+10],15,-1051523),y=u(y,p,m,l,d[h+1],21,-2054922799),l=u(l,y,p,m,d[h+8],6,1873313359),m=u(m,l,y,p,d[h+15],10,-30611744),p=u(p,m,l,y,d[h+6],15,-1560198380),y=u(y,p,m,l,d[h+13],21,1309151649),l=u(l,y,p,m,d[h+4],6,-145523070),m=u(m,l,y,p,d[h+11],10,-1120210379),p=u(p,m,l,y,d[h+2],15,718787259),y=u(y,p,m,l,d[h+9],21,-343485551),l=n(l,w),y=n(y,C),p=n(p,T),m=n(m,q);return r(l)+r(y)+r(p)+r(m)}N1.md5=CH});var zw=K(_r=>{D();N();Object.defineProperty(_r,"__esModule",{value:!0});_r.sha256HexMsg=_r.GetMapKeyTssSign=_r.MpcVersion=_r.Status=_r.SignStep=_r.FuncType=_r.DeviceNumber=void 0;var IH=ci(),BH=ar(),Uw=(Vd(),ws(Kd)),MH=R1(),TH;(function(e){e[e.P1_No=1]="P1_No",e[e.P2_No=2]="P2_No",e[e.P3_No=3]="P3_No"})(TH=_r.DeviceNumber||(_r.DeviceNumber={}));var OH;(function(e){e[e.ShakeHands=0]="ShakeHands",e[e.KeyGen=1]="KeyGen",e[e.ReShare=2]="ReShare",e[e.TssSign=3]="TssSign"})(OH=_r.FuncType||(_r.FuncType={}));var DH;(function(e){e[e.Step1=1]="Step1",e[e.Step2=2]="Step2",e[e.Step3=3]="Step3"})(DH=_r.SignStep||(_r.SignStep={}));var NH;(function(e){e[e.Success=1]="Success",e[e.Fail=2]="Fail"})(NH=_r.Status||(_r.Status={}));var RH;(function(e){e[e.Version_v0=0]="Version_v0",e[e.Version_v1=1]="Version_v1"})(RH=_r.MpcVersion||(_r.MpcVersion={}));function FH(e,t){let r=(0,MH.md5)(t);return`${e}-${r}`}_r.GetMapKeyTssSign=FH;function qH(e){let t=IH.secp256k1.CURVE.n,r=BH.base.sha256(e),n=(0,Uw.bufToBigint)(r)%t,i=(0,Uw.bigintToHex)(n);return i.length%2&&(i="0"+i),i}_r.sha256HexMsg=qH});var Gw=K(Li=>{D();N();Object.defineProperty(Li,"__esModule",{value:!0});Li.bigintStringify=Li.cvtEd25519MapToObj=Li.cvtObjToEd25519Map=Li.cvtEcdsaMapToObj=Li.cvtObjToEcdsaMap=void 0;var Rn=ps(),HH=Kg(),jH=Ug();function kH(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],i={};if(n.hasOwnProperty("CmtC")&&n.CmtC!==null&&(i.CmtC=e[r].CmtC),n.hasOwnProperty("Witness")&&n.Witness!==null){i.Witness=[];for(let s of n.Witness)i.Witness.push(s)}n.hasOwnProperty("Proof")&&n.Proof!==null&&(i.Proof=new HH.Proof(new Rn.ECPoint(Rn.CurveName.Secp256k1.toString(),BigInt(n.Proof.R.X),BigInt(n.Proof.R.Y)),n.Proof.S)),n.hasOwnProperty("R2")&&n.R2!==null&&(i.R2=new Rn.ECPoint(Rn.CurveName.Secp256k1.toString(),BigInt(n.R2.X),BigInt(n.R2.Y))),n.hasOwnProperty("E_k2_h_rx")&&n.E_k2_h_rx!==null&&(i.E_k2_h_rx=BigInt(n.E_k2_h_rx)),n.hasOwnProperty("Signature")&&n.Signature!==null&&(i.Signature=new Rn.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,i)}return t}Li.cvtObjToEcdsaMap=kH;function LH(e){let t=Object.fromEntries(e.entries()),r={};for(let n of Object.keys(t)){let i={},s=t[n];if(s.CmtC!=null&&(i.CmtC=s.CmtC.toString(10)),s.Witness!=null){i.Witness=[];for(let a of s.Witness)i.Witness.push(a.toString(10))}s.Proof!=null&&(i.Proof={R:{Curve:Rn.CurveName.Secp256k1,X:s.Proof.R.X,Y:s.Proof.R.Y},S:s.Proof.S.toString(10)}),s.R2!=null&&(i.R2={Curve:Rn.CurveName.Secp256k1,X:s.R2.X,Y:s.R2.Y}),s.E_k2_h_rx!=null&&(i.E_k2_h_rx=s.E_k2_h_rx.toString()),s.Signature!=null&&(i.Signature={r:s.Signature.r,s:s.Signature.s}),r[n]=i}return r}Li.cvtEcdsaMapToObj=LH;function KH(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],i={};if(n.hasOwnProperty("OutputDataMap")&&n.OutputDataMap!=null){i.TssInput=[];for(let s of Object.keys(n.OutputDataMap))Number(s)===Rn.DeviceNumber.P2_No&&i.TssInput.push(VH(n.OutputDataMap[s]))}n.hasOwnProperty("Signature")&&n.Signature!=null&&(i.Signature=new Rn.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,i)}return t}Li.cvtObjToEd25519Map=KH;function VH(e){let t={};if(e==null)return t;t.from=e.From,t.to=e.To;let r=(0,Rn.JsonParseBigInt)(e.Data);if(t.data={},r.C!==void 0&&(t.data.c=r.C),r.Witness!==void 0){let n=[];if(r.hasOwnProperty("Witness"))for(let i of r.Witness)n.push(i);t.data.witness=n}return r.Proof!==void 0&&(t.data.proof=new jH.Proof(new Rn.ECPoint(Rn.CurveName.Ed25519.toString(),BigInt(r.Proof.R.X),BigInt(r.Proof.R.Y)),BigInt(r.Proof.S))),t}function UH(e){let t={};for(let[r,n]of e.entries()){let i={};if(n.OutputDataMap!=null){let s=[];for(let[a,o]of n.OutputDataMap.entries())a===Rn.DeviceNumber.P1_No&&s.push({From:Rn.DeviceNumber.P2_No,To:Rn.DeviceNumber.P1_No,Data:zH(o.data)});i.TssInput=s}n.Signature!=null&&(i.Signature={r:n.Signature.r,s:n.Signature.s}),t[r]=i}return t}Li.cvtEd25519MapToObj=UH;function zH(e){let t={};if(e.c!==void 0)t.C=e.c.toString(10);else if(e.witness!==void 0&&e.proof!==void 0){let r=[];for(let n of e.witness)r.push(n.toString(10));t.Witness=r,t.Proof={R:{Curve:Rn.CurveName.Ed25519,X:e.proof.R.X,Y:e.proof.R.Y},S:e.proof.S}}return $w(t)}function $w(e){return JSON.stringify(e,(n,i)=>typeof i=="bigint"?i.toString():i).replace(/"(\d{16,})"/g,(n,i)=>i)}Li.bigintStringify=$w});var wv=K(Z=>{D();N();var S0={};S0.userAgent=!1;var Pu={},$H="10.9.0",GH="jsrsasign(all) 10.9.0 (2023-11-27) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";var ee=ee||function(e,t){var r={},n=r.lib={},i=n.Base=function(){function l(){}return{extend:function(y){l.prototype=this;var p=new l;return y&&p.mixIn(y),p.hasOwnProperty("init")||(p.init=function(){p.$super.init.apply(this,arguments)}),p.init.prototype=p,p.$super=this,p},create:function(){var y=this.extend();return y.init.apply(y,arguments),y},init:function(){},mixIn:function(y){for(var p in y)y.hasOwnProperty(p)&&(this[p]=y[p]);y.hasOwnProperty("toString")&&(this.toString=y.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=n.WordArray=i.extend({init:function(l,y){l=this.words=l||[],y!=t?this.sigBytes=y:this.sigBytes=l.length*4},toString:function(l){return(l||o).stringify(this)},concat:function(l){var y=this.words,p=l.words,m=this.sigBytes,w=l.sigBytes;if(this.clamp(),m%4)for(var C=0;C<w;C++){var T=p[C>>>2]>>>24-C%4*8&255;y[m+C>>>2]|=T<<24-(m+C)%4*8}else for(var C=0;C<w;C+=4)y[m+C>>>2]=p[C>>>2];return this.sigBytes+=w,this},clamp:function(){var l=this.words,y=this.sigBytes;l[y>>>2]&=4294967295<<32-y%4*8,l.length=e.ceil(y/4)},clone:function(){var l=i.clone.call(this);return l.words=this.words.slice(0),l},random:function(l){for(var y=[],p=0;p<l;p+=4)y.push(e.random()*4294967296|0);return new s.init(y,l)}}),a=r.enc={},o=a.Hex={stringify:function(l){for(var y=l.words,p=l.sigBytes,m=[],w=0;w<p;w++){var C=y[w>>>2]>>>24-w%4*8&255;m.push((C>>>4).toString(16)),m.push((C&15).toString(16))}return m.join("")},parse:function(l){for(var y=l.length,p=[],m=0;m<y;m+=2)p[m>>>3]|=parseInt(l.substr(m,2),16)<<24-m%8*4;return new s.init(p,y/2)}},c=a.Latin1={stringify:function(l){for(var y=l.words,p=l.sigBytes,m=[],w=0;w<p;w++){var C=y[w>>>2]>>>24-w%4*8&255;m.push(String.fromCharCode(C))}return m.join("")},parse:function(l){for(var y=l.length,p=[],m=0;m<y;m++)p[m>>>2]|=(l.charCodeAt(m)&255)<<24-m%4*8;return new s.init(p,y)}},u=a.Utf8={stringify:function(l){try{return decodeURIComponent(escape(c.stringify(l)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(l){return c.parse(unescape(encodeURIComponent(l)))}},b=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(l){typeof l=="string"&&(l=u.parse(l)),this._data.concat(l),this._nDataBytes+=l.sigBytes},_process:function(l){var y=this._data,p=y.words,m=y.sigBytes,w=this.blockSize,C=w*4,T=m/C;l?T=e.ceil(T):T=e.max((T|0)-this._minBufferSize,0);var q=T*w,F=e.min(q*4,m);if(q){for(var j=0;j<q;j+=w)this._doProcessBlock(p,j);var k=p.splice(0,q);y.sigBytes-=F}return new s.init(k,F)},clone:function(){var l=i.clone.call(this);return l._data=this._data.clone(),l},_minBufferSize:0}),h=n.Hasher=b.extend({cfg:i.extend(),init:function(l){this.cfg=this.cfg.extend(l),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(l){return this._append(l),this._process(),this},finalize:function(l){l&&this._append(l);var y=this._doFinalize();return y},blockSize:512/32,_createHelper:function(l){return function(y,p){return new l.init(p).finalize(y)}},_createHmacHelper:function(l){return function(y,p){return new d.HMAC.init(l,p).finalize(y)}}}),d=r.algo={};return r}(Math);(function(e){var i=ee,t=i.lib,r=t.Base,n=t.WordArray,i=i.x64={};i.Word=r.extend({init:function(s,a){this.high=s,this.low=a}}),i.WordArray=r.extend({init:function(s,a){s=this.words=s||[],this.sigBytes=a!=e?a:8*s.length},toX32:function(){for(var s=this.words,a=s.length,o=[],c=0;c<a;c++){var u=s[c];o.push(u.high),o.push(u.low)}return n.create(o,this.sigBytes)},clone:function(){for(var s=r.clone.call(this),a=s.words=this.words.slice(0),o=a.length,c=0;c<o;c++)a[c]=a[c].clone();return s}})})();ee.lib.Cipher||function(e){var l=ee,t=l.lib,r=t.Base,n=t.WordArray,i=t.BufferedBlockAlgorithm,s=l.enc.Base64,a=l.algo.EvpKDF,o=t.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(p,m){return this.create(this._ENC_XFORM_MODE,p,m)},createDecryptor:function(p,m){return this.create(this._DEC_XFORM_MODE,p,m)},init:function(p,m,w){this.cfg=this.cfg.extend(w),this._xformMode=p,this._key=m,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(p){return this._append(p),this._process()},finalize:function(p){return p&&this._append(p),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(p){return{encrypt:function(m,w,C){return(typeof w=="string"?y:d).encrypt(p,m,w,C)},decrypt:function(m,w,C){return(typeof w=="string"?y:d).decrypt(p,m,w,C)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=l.mode={},c=function(p,m,w){var C=this._iv;C?this._iv=e:C=this._prevBlock;for(var T=0;T<w;T++)p[m+T]^=C[T]},u=(t.BlockCipherMode=r.extend({createEncryptor:function(p,m){return this.Encryptor.create(p,m)},createDecryptor:function(p,m){return this.Decryptor.create(p,m)},init:function(p,m){this._cipher=p,this._iv=m}})).extend();u.Encryptor=u.extend({processBlock:function(p,m){var w=this._cipher,C=w.blockSize;c.call(this,p,m,C),w.encryptBlock(p,m),this._prevBlock=p.slice(m,m+C)}}),u.Decryptor=u.extend({processBlock:function(p,m){var w=this._cipher,C=w.blockSize,T=p.slice(m,m+C);w.decryptBlock(p,m),c.call(this,p,m,C),this._prevBlock=T}}),h=h.CBC=u,u=(l.pad={}).Pkcs7={pad:function(p,m){for(var w=4*m,w=w-p.sigBytes%w,C=w<<24|w<<16|w<<8|w,T=[],q=0;q<w;q+=4)T.push(C);w=n.create(T,w),p.concat(w)},unpad:function(p){p.sigBytes-=p.words[p.sigBytes-1>>>2]&255}},t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:h,padding:u}),reset:function(){o.reset.call(this);var m=this.cfg,p=m.iv,m=m.mode;if(this._xformMode==this._ENC_XFORM_MODE)var w=m.createEncryptor;else w=m.createDecryptor,this._minBufferSize=1;this._mode=w.call(m,this,p&&p.words)},_doProcessBlock:function(p,m){this._mode.processBlock(p,m)},_doFinalize:function(){var p=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){p.pad(this._data,this.blockSize);var m=this._process(!0)}else m=this._process(!0),p.unpad(m);return m},blockSize:4});var b=t.CipherParams=r.extend({init:function(p){this.mixIn(p)},toString:function(p){return(p||this.formatter).stringify(this)}}),h=(l.format={}).OpenSSL={stringify:function(p){var m=p.ciphertext;return p=p.salt,(p?n.create([1398893684,1701076831]).concat(p).concat(m):m).toString(s)},parse:function(p){p=s.parse(p);var m=p.words;if(m[0]==1398893684&&m[1]==1701076831){var w=n.create(m.slice(2,4));m.splice(0,4),p.sigBytes-=16}return b.create({ciphertext:p,salt:w})}},d=t.SerializableCipher=r.extend({cfg:r.extend({format:h}),encrypt:function(p,m,w,C){C=this.cfg.extend(C);var T=p.createEncryptor(w,C);return m=T.finalize(m),T=T.cfg,b.create({ciphertext:m,key:w,iv:T.iv,algorithm:p,mode:T.mode,padding:T.padding,blockSize:p.blockSize,formatter:C.format})},decrypt:function(p,m,w,C){return C=this.cfg.extend(C),m=this._parse(m,C.format),p.createDecryptor(w,C).finalize(m.ciphertext)},_parse:function(p,m){return typeof p=="string"?m.parse(p,this):p}}),l=(l.kdf={}).OpenSSL={execute:function(p,m,w,C){return C||(C=n.random(8)),p=a.create({keySize:m+w}).compute(p,C),w=n.create(p.words.slice(m),4*w),p.sigBytes=4*m,b.create({key:p,iv:w,salt:C})}},y=t.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:l}),encrypt:function(p,m,w,C){return C=this.cfg.extend(C),w=C.kdf.execute(w,p.keySize,p.ivSize),C.iv=w.iv,p=d.encrypt.call(this,p,m,w.key,C),p.mixIn(w),p},decrypt:function(p,m,w,C){return C=this.cfg.extend(C),m=this._parse(m,C.format),w=C.kdf.execute(w,p.keySize,p.ivSize,m.salt),C.iv=w.iv,d.decrypt.call(this,p,m,w.key,C)}})}();(function(){for(var e=ee,t=e.lib.BlockCipher,j=e.algo,r=[],n=[],i=[],s=[],a=[],o=[],c=[],u=[],b=[],h=[],d=[],l=0;256>l;l++)d[l]=128>l?l<<1:l<<1^283;for(var y=0,p=0,l=0;256>l;l++){var m=p^p<<1^p<<2^p<<3^p<<4,m=m>>>8^m&255^99;r[y]=m,n[m]=y;var w=d[y],C=d[w],T=d[C],q=257*d[m]^16843008*m;i[y]=q<<24|q>>>8,s[y]=q<<16|q>>>16,a[y]=q<<8|q>>>24,o[y]=q,q=16843009*T^65537*C^257*w^16843008*y,c[m]=q<<24|q>>>8,u[m]=q<<16|q>>>16,b[m]=q<<8|q>>>24,h[m]=q,y?(y=w^d[d[d[T^w]]],p^=d[d[p]]):y=p=1}var F=[0,1,2,4,8,16,32,64,128,27,54],j=j.AES=t.extend({_doReset:function(){for(var R=this._key,k=R.words,I=R.sigBytes/4,R=4*((this._nRounds=I+6)+1),A=this._keySchedule=[],f=0;f<R;f++)if(f<I)A[f]=k[f];else{var g=A[f-1];f%I?6<I&&f%I==4&&(g=r[g>>>24]<<24|r[g>>>16&255]<<16|r[g>>>8&255]<<8|r[g&255]):(g=g<<8|g>>>24,g=r[g>>>24]<<24|r[g>>>16&255]<<16|r[g>>>8&255]<<8|r[g&255],g^=F[f/I|0]<<24),A[f]=A[f-I]^g}for(k=this._invKeySchedule=[],I=0;I<R;I++)f=R-I,g=I%4?A[f]:A[f-4],k[I]=4>I||4>=f?g:c[r[g>>>24]]^u[r[g>>>16&255]]^b[r[g>>>8&255]]^h[r[g&255]]},encryptBlock:function(k,I){this._doCryptBlock(k,I,this._keySchedule,i,s,a,o,r)},decryptBlock:function(k,I){var R=k[I+1];k[I+1]=k[I+3],k[I+3]=R,this._doCryptBlock(k,I,this._invKeySchedule,c,u,b,h,n),R=k[I+1],k[I+1]=k[I+3],k[I+3]=R},_doCryptBlock:function(k,I,R,A,f,g,E,x){for(var S=this._nRounds,z=k[I]^R[0],$=k[I+1]^R[1],G=k[I+2]^R[2],V=k[I+3]^R[3],P=4,O=1;O<S;O++)var B=A[z>>>24]^f[$>>>16&255]^g[G>>>8&255]^E[V&255]^R[P++],v=A[$>>>24]^f[G>>>16&255]^g[V>>>8&255]^E[z&255]^R[P++],M=A[G>>>24]^f[V>>>16&255]^g[z>>>8&255]^E[$&255]^R[P++],V=A[V>>>24]^f[z>>>16&255]^g[$>>>8&255]^E[G&255]^R[P++],z=B,$=v,G=M;B=(x[z>>>24]<<24|x[$>>>16&255]<<16|x[G>>>8&255]<<8|x[V&255])^R[P++],v=(x[$>>>24]<<24|x[G>>>16&255]<<16|x[V>>>8&255]<<8|x[z&255])^R[P++],M=(x[G>>>24]<<24|x[V>>>16&255]<<16|x[z>>>8&255]<<8|x[$&255])^R[P++],V=(x[V>>>24]<<24|x[z>>>16&255]<<16|x[$>>>8&255]<<8|x[G&255])^R[P++],k[I]=B,k[I+1]=v,k[I+2]=M,k[I+3]=V},keySize:8});e.AES=t._createHelper(j)})();(function(){function e(d,l){var y=(this._lBlock>>>d^this._rBlock)&l;this._rBlock^=y,this._lBlock^=y<<d}function t(d,l){var y=(this._rBlock>>>d^this._lBlock)&l;this._lBlock^=y,this._rBlock^=y<<d}var r=ee,i=r.lib,n=i.WordArray,i=i.BlockCipher,s=r.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],b=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=s.DES=i.extend({_doReset:function(){for(var d=this._key.words,l=[],y=0;56>y;y++){var p=a[y]-1;l[y]=d[p>>>5]>>>31-p%32&1}for(d=this._subKeys=[],p=0;16>p;p++){for(var m=d[p]=[],w=c[p],y=0;24>y;y++)m[y/6|0]|=l[(o[y]-1+w)%28]<<31-y%6,m[4+(y/6|0)]|=l[28+(o[y+24]-1+w)%28]<<31-y%6;for(m[0]=m[0]<<1|m[0]>>>31,y=1;7>y;y++)m[y]>>>=4*(y-1)+3;m[7]=m[7]<<5|m[7]>>>27}for(l=this._invSubKeys=[],y=0;16>y;y++)l[y]=d[15-y]},encryptBlock:function(d,l){this._doCryptBlock(d,l,this._subKeys)},decryptBlock:function(d,l){this._doCryptBlock(d,l,this._invSubKeys)},_doCryptBlock:function(d,l,y){this._lBlock=d[l],this._rBlock=d[l+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var p=0;16>p;p++){for(var m=y[p],w=this._lBlock,C=this._rBlock,T=0,q=0;8>q;q++)T|=u[q][((C^m[q])&b[q])>>>0];this._lBlock=C,this._rBlock=w^T}y=this._lBlock,this._lBlock=this._rBlock,this._rBlock=y,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),d[l]=this._lBlock,d[l+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=i._createHelper(h),s=s.TripleDES=i.extend({_doReset:function(){var d=this._key.words;this._des1=h.createEncryptor(n.create(d.slice(0,2))),this._des2=h.createEncryptor(n.create(d.slice(2,4))),this._des3=h.createEncryptor(n.create(d.slice(4,6)))},encryptBlock:function(d,l){this._des1.encryptBlock(d,l),this._des2.decryptBlock(d,l),this._des3.encryptBlock(d,l)},decryptBlock:function(d,l){this._des3.decryptBlock(d,l),this._des2.encryptBlock(d,l),this._des1.decryptBlock(d,l)},keySize:6,ivSize:2,blockSize:2}),r.TripleDES=i._createHelper(s)})();(function(){var e=ee,t=e.lib.WordArray;e.enc.Base64={stringify:function(r){var n=r.words,i=r.sigBytes,s=this._map;r.clamp(),r=[];for(var a=0;a<i;a+=3)for(var o=(n[a>>>2]>>>24-8*(a%4)&255)<<16|(n[a+1>>>2]>>>24-8*((a+1)%4)&255)<<8|n[a+2>>>2]>>>24-8*((a+2)%4)&255,c=0;4>c&&a+.75*c<i;c++)r.push(s.charAt(o>>>6*(3-c)&63));if(n=s.charAt(64))for(;r.length%4;)r.push(n);return r.join("")},parse:function(r){var n=r.length,i=this._map,s=i.charAt(64);s&&(s=r.indexOf(s),s!=-1&&(n=s));for(var s=[],a=0,o=0;o<n;o++)if(o%4){var c=i.indexOf(r.charAt(o-1))<<2*(o%4),u=i.indexOf(r.charAt(o))>>>6-2*(o%4);s[a>>>2]|=(c|u)<<24-8*(a%4),a++}return t.create(s,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(e){function t(h,d,l,y,p,m,w){return h=h+(d&l|~d&y)+p+w,(h<<m|h>>>32-m)+d}function r(h,d,l,y,p,m,w){return h=h+(d&y|l&~y)+p+w,(h<<m|h>>>32-m)+d}function n(h,d,l,y,p,m,w){return h=h+(d^l^y)+p+w,(h<<m|h>>>32-m)+d}function i(h,d,l,y,p,m,w){return h=h+(l^(d|~y))+p+w,(h<<m|h>>>32-m)+d}for(var s=ee,c=s.lib,a=c.WordArray,o=c.Hasher,c=s.algo,u=[],b=0;64>b;b++)u[b]=4294967296*e.abs(e.sin(b+1))|0;c=c.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(h,d){for(var l=0;16>l;l++){var y=d+l,p=h[y];h[y]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360}var l=this._hash.words,y=h[d+0],p=h[d+1],m=h[d+2],w=h[d+3],C=h[d+4],T=h[d+5],q=h[d+6],F=h[d+7],j=h[d+8],k=h[d+9],I=h[d+10],R=h[d+11],A=h[d+12],f=h[d+13],g=h[d+14],E=h[d+15],x=l[0],O=l[1],P=l[2],S=l[3],x=t(x,O,P,S,y,7,u[0]),S=t(S,x,O,P,p,12,u[1]),P=t(P,S,x,O,m,17,u[2]),O=t(O,P,S,x,w,22,u[3]),x=t(x,O,P,S,C,7,u[4]),S=t(S,x,O,P,T,12,u[5]),P=t(P,S,x,O,q,17,u[6]),O=t(O,P,S,x,F,22,u[7]),x=t(x,O,P,S,j,7,u[8]),S=t(S,x,O,P,k,12,u[9]),P=t(P,S,x,O,I,17,u[10]),O=t(O,P,S,x,R,22,u[11]),x=t(x,O,P,S,A,7,u[12]),S=t(S,x,O,P,f,12,u[13]),P=t(P,S,x,O,g,17,u[14]),O=t(O,P,S,x,E,22,u[15]),x=r(x,O,P,S,p,5,u[16]),S=r(S,x,O,P,q,9,u[17]),P=r(P,S,x,O,R,14,u[18]),O=r(O,P,S,x,y,20,u[19]),x=r(x,O,P,S,T,5,u[20]),S=r(S,x,O,P,I,9,u[21]),P=r(P,S,x,O,E,14,u[22]),O=r(O,P,S,x,C,20,u[23]),x=r(x,O,P,S,k,5,u[24]),S=r(S,x,O,P,g,9,u[25]),P=r(P,S,x,O,w,14,u[26]),O=r(O,P,S,x,j,20,u[27]),x=r(x,O,P,S,f,5,u[28]),S=r(S,x,O,P,m,9,u[29]),P=r(P,S,x,O,F,14,u[30]),O=r(O,P,S,x,A,20,u[31]),x=n(x,O,P,S,T,4,u[32]),S=n(S,x,O,P,j,11,u[33]),P=n(P,S,x,O,R,16,u[34]),O=n(O,P,S,x,g,23,u[35]),x=n(x,O,P,S,p,4,u[36]),S=n(S,x,O,P,C,11,u[37]),P=n(P,S,x,O,F,16,u[38]),O=n(O,P,S,x,I,23,u[39]),x=n(x,O,P,S,f,4,u[40]),S=n(S,x,O,P,y,11,u[41]),P=n(P,S,x,O,w,16,u[42]),O=n(O,P,S,x,q,23,u[43]),x=n(x,O,P,S,k,4,u[44]),S=n(S,x,O,P,A,11,u[45]),P=n(P,S,x,O,E,16,u[46]),O=n(O,P,S,x,m,23,u[47]),x=i(x,O,P,S,y,6,u[48]),S=i(S,x,O,P,F,10,u[49]),P=i(P,S,x,O,g,15,u[50]),O=i(O,P,S,x,T,21,u[51]),x=i(x,O,P,S,A,6,u[52]),S=i(S,x,O,P,w,10,u[53]),P=i(P,S,x,O,I,15,u[54]),O=i(O,P,S,x,p,21,u[55]),x=i(x,O,P,S,j,6,u[56]),S=i(S,x,O,P,E,10,u[57]),P=i(P,S,x,O,q,15,u[58]),O=i(O,P,S,x,f,21,u[59]),x=i(x,O,P,S,C,6,u[60]),S=i(S,x,O,P,R,10,u[61]),P=i(P,S,x,O,m,15,u[62]),O=i(O,P,S,x,k,21,u[63]);l[0]=l[0]+x|0,l[1]=l[1]+O|0,l[2]=l[2]+P|0,l[3]=l[3]+S|0},_doFinalize:function(){var h=this._data,d=h.words,l=8*this._nDataBytes,y=8*h.sigBytes;d[y>>>5]|=128<<24-y%32;var p=e.floor(l/4294967296);for(d[(y+64>>>9<<4)+15]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,d[(y+64>>>9<<4)+14]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,h.sigBytes=4*(d.length+1),this._process(),h=this._hash,d=h.words,l=0;4>l;l++)y=d[l],d[l]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360;return h},clone:function(){var h=o.clone.call(this);return h._hash=this._hash.clone(),h}}),s.MD5=o._createHelper(c),s.HmacMD5=o._createHmacHelper(c)})(Math);(function(){var e=ee,i=e.lib,t=i.WordArray,r=i.Hasher,n=[],i=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(s,a){for(var o=this._hash.words,c=o[0],u=o[1],b=o[2],h=o[3],d=o[4],l=0;80>l;l++){if(16>l)n[l]=s[a+l]|0;else{var y=n[l-3]^n[l-8]^n[l-14]^n[l-16];n[l]=y<<1|y>>>31}y=(c<<5|c>>>27)+d+n[l],y=20>l?y+((u&b|~u&h)+1518500249):40>l?y+((u^b^h)+1859775393):60>l?y+((u&b|u&h|b&h)-1894007588):y+((u^b^h)-899497514),d=h,h=b,b=u<<30|u>>>2,u=c,c=y}o[0]=o[0]+c|0,o[1]=o[1]+u|0,o[2]=o[2]+b|0,o[3]=o[3]+h|0,o[4]=o[4]+d|0},_doFinalize:function(){var s=this._data,a=s.words,o=8*this._nDataBytes,c=8*s.sigBytes;return a[c>>>5]|=128<<24-c%32,a[(c+64>>>9<<4)+14]=Math.floor(o/4294967296),a[(c+64>>>9<<4)+15]=o,s.sigBytes=4*a.length,this._process(),this._hash},clone:function(){var s=r.clone.call(this);return s._hash=this._hash.clone(),s}});e.SHA1=r._createHelper(i),e.HmacSHA1=r._createHmacHelper(i)})();(function(e){for(var t=ee,l=t.lib,r=l.WordArray,n=l.Hasher,l=t.algo,i=[],s=[],a=function(p){return 4294967296*(p-(p|0))|0},o=2,c=0;64>c;){var u;e:{u=o;for(var b=e.sqrt(u),h=2;h<=b;h++)if(!(u%h)){u=!1;break e}u=!0}u&&(8>c&&(i[c]=a(e.pow(o,.5))),s[c]=a(e.pow(o,1/3)),c++),o++}var d=[],l=l.SHA256=n.extend({_doReset:function(){this._hash=new r.init(i.slice(0))},_doProcessBlock:function(y,p){for(var m=this._hash.words,w=m[0],C=m[1],T=m[2],q=m[3],F=m[4],j=m[5],k=m[6],I=m[7],R=0;64>R;R++){if(16>R)d[R]=y[p+R]|0;else{var A=d[R-15],f=d[R-2];d[R]=((A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3)+d[R-7]+((f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10)+d[R-16]}A=I+((F<<26|F>>>6)^(F<<21|F>>>11)^(F<<7|F>>>25))+(F&j^~F&k)+s[R]+d[R],f=((w<<30|w>>>2)^(w<<19|w>>>13)^(w<<10|w>>>22))+(w&C^w&T^C&T),I=k,k=j,j=F,F=q+A|0,q=T,T=C,C=w,w=A+f|0}m[0]=m[0]+w|0,m[1]=m[1]+C|0,m[2]=m[2]+T|0,m[3]=m[3]+q|0,m[4]=m[4]+F|0,m[5]=m[5]+j|0,m[6]=m[6]+k|0,m[7]=m[7]+I|0},_doFinalize:function(){var y=this._data,p=y.words,m=8*this._nDataBytes,w=8*y.sigBytes;return p[w>>>5]|=128<<24-w%32,p[(w+64>>>9<<4)+14]=e.floor(m/4294967296),p[(w+64>>>9<<4)+15]=m,y.sigBytes=4*p.length,this._process(),this._hash},clone:function(){var y=n.clone.call(this);return y._hash=this._hash.clone(),y}});t.SHA256=n._createHelper(l),t.HmacSHA256=n._createHmacHelper(l)})(Math);(function(){var e=ee,t=e.lib.WordArray,n=e.algo,r=n.SHA256,n=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=r._doFinalize.call(this);return i.sigBytes-=4,i}});e.SHA224=r._createHelper(n),e.HmacSHA224=r._createHmacHelper(n)})();(function(){function e(){return n.create.apply(n,arguments)}for(var t=ee,r=t.lib.Hasher,s=t.x64,n=s.Word,i=s.WordArray,s=t.algo,a=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],o=[],c=0;80>c;c++)o[c]=e();s=s.SHA512=r.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(u,b){for(var C=this._hash.words,h=C[0],d=C[1],l=C[2],y=C[3],p=C[4],m=C[5],w=C[6],C=C[7],T=h.high,q=h.low,F=d.high,j=d.low,k=l.high,I=l.low,R=y.high,A=y.low,f=p.high,g=p.low,E=m.high,x=m.low,S=w.high,P=w.low,O=C.high,B=C.low,v=T,M=q,V=F,z=j,$=k,G=I,Q=R,re=A,me=f,ne=g,te=E,_e=x,ce=S,J=P,De=O,fe=B,ie=0;80>ie;ie++){var xe=o[ie];if(16>ie)var qt=xe.high=u[b+2*ie]|0,se=xe.low=u[b+2*ie+1]|0;else{var qt=o[ie-15],se=qt.high,we=qt.low,qt=(se>>>1|we<<31)^(se>>>8|we<<24)^se>>>7,we=(we>>>1|se<<31)^(we>>>8|se<<24)^(we>>>7|se<<25),Ee=o[ie-2],se=Ee.high,ue=Ee.low,Ee=(se>>>19|ue<<13)^(se<<3|ue>>>29)^se>>>6,ue=(ue>>>19|se<<13)^(ue<<3|se>>>29)^(ue>>>6|se<<26),se=o[ie-7],Ae=se.high,Se=o[ie-16],En=Se.high,Se=Se.low,se=we+se.low,qt=qt+Ae+(se>>>0<we>>>0?1:0),se=se+ue,qt=qt+Ee+(se>>>0<ue>>>0?1:0),se=se+Se,qt=qt+En+(se>>>0<Se>>>0?1:0);xe.high=qt,xe.low=se}var Ae=me&te^~me&ce,Se=ne&_e^~ne&J,xe=v&V^v&$^V&$,zo=M&z^M&G^z&G,we=(v>>>28|M<<4)^(v<<30|M>>>2)^(v<<25|M>>>7),Ee=(M>>>28|v<<4)^(M<<30|v>>>2)^(M<<25|v>>>7),ue=a[ie],$o=ue.high,Be=ue.low,ue=fe+((ne>>>14|me<<18)^(ne>>>18|me<<14)^(ne<<23|me>>>9)),En=De+((me>>>14|ne<<18)^(me>>>18|ne<<14)^(me<<23|ne>>>9))+(ue>>>0<fe>>>0?1:0),ue=ue+Se,En=En+Ae+(ue>>>0<Se>>>0?1:0),ue=ue+Be,En=En+$o+(ue>>>0<Be>>>0?1:0),ue=ue+se,En=En+qt+(ue>>>0<se>>>0?1:0),se=Ee+zo,xe=we+xe+(se>>>0<Ee>>>0?1:0),De=ce,fe=J,ce=te,J=_e,te=me,_e=ne,ne=re+ue|0,me=Q+En+(ne>>>0<re>>>0?1:0)|0,Q=$,re=G,$=V,G=z,V=v,z=M,M=ue+se|0,v=En+xe+(M>>>0<ue>>>0?1:0)|0}q=h.low=q+M,h.high=T+v+(q>>>0<M>>>0?1:0),j=d.low=j+z,d.high=F+V+(j>>>0<z>>>0?1:0),I=l.low=I+G,l.high=k+$+(I>>>0<G>>>0?1:0),A=y.low=A+re,y.high=R+Q+(A>>>0<re>>>0?1:0),g=p.low=g+ne,p.high=f+me+(g>>>0<ne>>>0?1:0),x=m.low=x+_e,m.high=E+te+(x>>>0<_e>>>0?1:0),P=w.low=P+J,w.high=S+ce+(P>>>0<J>>>0?1:0),B=C.low=B+fe,C.high=O+De+(B>>>0<fe>>>0?1:0)},_doFinalize:function(){var u=this._data,b=u.words,h=8*this._nDataBytes,d=8*u.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+128>>>10<<5)+30]=Math.floor(h/4294967296),b[(d+128>>>10<<5)+31]=h,u.sigBytes=4*b.length,this._process(),this._hash.toX32()},clone:function(){var u=r.clone.call(this);return u._hash=this._hash.clone(),u},blockSize:32}),t.SHA512=r._createHelper(s),t.HmacSHA512=r._createHmacHelper(s)})();(function(){var e=ee,i=e.x64,t=i.Word,r=i.WordArray,i=e.algo,n=i.SHA512,i=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var s=n._doFinalize.call(this);return s.sigBytes-=16,s}});e.SHA384=n._createHelper(i),e.HmacSHA384=n._createHmacHelper(i)})();(function(){var e=ee,u=e.lib,t=u.WordArray,r=u.Hasher,u=e.algo,n=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),i=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),s=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),o=t.create([0,1518500249,1859775393,2400959708,2840853838]),c=t.create([1352829926,1548603684,1836072691,2053994217,0]),u=u.RIPEMD160=r.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(b,h){for(var d=0;16>d;d++){var l=h+d,y=b[l];b[l]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360}var l=this._hash.words,y=o.words,p=c.words,m=n.words,w=i.words,C=s.words,T=a.words,q,F,j,k,I,R,A,f,g,E;R=q=l[0],A=F=l[1],f=j=l[2],g=k=l[3],E=I=l[4];for(var x,d=0;80>d;d+=1)x=q+b[h+m[d]]|0,x=16>d?x+((F^j^k)+y[0]):32>d?x+((F&j|~F&k)+y[1]):48>d?x+(((F|~j)^k)+y[2]):64>d?x+((F&k|j&~k)+y[3]):x+((F^(j|~k))+y[4]),x|=0,x=x<<C[d]|x>>>32-C[d],x=x+I|0,q=I,I=k,k=j<<10|j>>>22,j=F,F=x,x=R+b[h+w[d]]|0,x=16>d?x+((A^(f|~g))+p[0]):32>d?x+((A&g|f&~g)+p[1]):48>d?x+(((A|~f)^g)+p[2]):64>d?x+((A&f|~A&g)+p[3]):x+((A^f^g)+p[4]),x|=0,x=x<<T[d]|x>>>32-T[d],x=x+E|0,R=E,E=g,g=f<<10|f>>>22,f=A,A=x;x=l[1]+j+g|0,l[1]=l[2]+k+E|0,l[2]=l[3]+I+R|0,l[3]=l[4]+q+A|0,l[4]=l[0]+F+f|0,l[0]=x},_doFinalize:function(){var b=this._data,h=b.words,d=8*this._nDataBytes,l=8*b.sigBytes;for(h[l>>>5]|=128<<24-l%32,h[(l+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,b.sigBytes=4*(h.length+1),this._process(),b=this._hash,h=b.words,d=0;5>d;d++)l=h[d],h[d]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360;return b},clone:function(){var b=r.clone.call(this);return b._hash=this._hash.clone(),b}});e.RIPEMD160=r._createHelper(u),e.HmacRIPEMD160=r._createHmacHelper(u)})(Math);(function(){var e=ee,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(r,n){r=this._hasher=new r.init,typeof n=="string"&&(n=t.parse(n));var i=r.blockSize,s=4*i;n.sigBytes>s&&(n=r.finalize(n)),n.clamp();for(var a=this._oKey=n.clone(),o=this._iKey=n.clone(),c=a.words,u=o.words,b=0;b<i;b++)c[b]^=1549556828,u[b]^=909522486;a.sigBytes=o.sigBytes=s,this.reset()},reset:function(){var r=this._hasher;r.reset(),r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var n=this._hasher;return r=n.finalize(r),n.reset(),n.finalize(this._oKey.clone().concat(r))}})})();(function(){var e=ee,n=e.lib,t=n.Base,r=n.WordArray,n=e.algo,i=n.HMAC,s=n.PBKDF2=t.extend({cfg:t.extend({keySize:4,hasher:n.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,o){for(var y=this.cfg,c=i.create(y.hasher,a),u=r.create(),b=r.create([1]),h=u.words,d=b.words,l=y.keySize,y=y.iterations;h.length<l;){var p=c.update(o).finalize(b);c.reset();for(var m=p.words,w=m.length,C=p,T=1;T<y;T++){C=c.finalize(C),c.reset();for(var q=C.words,F=0;F<w;F++)m[F]^=q[F]}u.concat(p),d[0]++}return u.sigBytes=4*l,u}});e.PBKDF2=function(a,o,c){return s.create(c).compute(a,o)}})();var Cu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",av="=";function Pa(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=Cu.charAt(r>>6)+Cu.charAt(r&63);if(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=Cu.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=Cu.charAt(r>>2)+Cu.charAt((r&3)<<4)),av)for(;(n.length&3)>0;)n+=av;return n}function Bu(e){var t="",r,n=0,i,s;for(r=0;r<e.length&&e.charAt(r)!=av;++r)s=Cu.indexOf(e.charAt(r)),!(s<0)&&(n==0?(t+=Aa(s>>2),i=s&3,n=1):n==1?(t+=Aa(i<<2|s>>4),i=s&15,n=2):n==2?(t+=Aa(i),t+=Aa(s>>2),i=s&3,n=3):(t+=Aa(i<<2|s>>4),t+=Aa(s&15),n=0));return n==1&&(t+=Aa(i<<2)),t}function Qw(e){var t=Bu(e),r,n=new Array;for(r=0;2*r<t.length;++r)n[r]=parseInt(t.substring(2*r,2*r+2),16);return n}var Eo,WH=0xdeadbeefcafe,Ww=(WH&16777215)==15715070;function U(e,t,r){e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}function ht(){return new U(null)}function XH(e,t,r,n,i,s){for(;--s>=0;){var a=t*this[e++]+r[n]+i;i=Math.floor(a/67108864),r[n++]=a&67108863}return i}function YH(e,t,r,n,i,s){for(var a=t&32767,o=t>>15;--s>=0;){var c=this[e]&32767,u=this[e++]>>15,b=o*c+u*a;c=a*c+((b&32767)<<15)+r[n]+(i&1073741823),i=(c>>>30)+(b>>>15)+o*u+(i>>>30),r[n++]=c&1073741823}return i}function ZH(e,t,r,n,i,s){for(var a=t&16383,o=t>>14;--s>=0;){var c=this[e]&16383,u=this[e++]>>14,b=o*c+u*a;c=a*c+((b&16383)<<14)+r[n]+i,i=(c>>28)+(b>>14)+o*u,r[n++]=c&268435455}return i}Ww&&S0.appName=="Microsoft Internet Explorer"?(U.prototype.am=YH,Eo=30):Ww&&S0.appName!="Netscape"?(U.prototype.am=XH,Eo=26):(U.prototype.am=ZH,Eo=28);U.prototype.DB=Eo;U.prototype.DM=(1<<Eo)-1;U.prototype.DV=1<<Eo;var dv=52;U.prototype.FV=Math.pow(2,dv);U.prototype.F1=dv-Eo;U.prototype.F2=2*Eo-dv;var JH="0123456789abcdefghijklmnopqrstuvwxyz",k1=new Array,Mu,Vi;Mu="0".charCodeAt(0);for(Vi=0;Vi<=9;++Vi)k1[Mu++]=Vi;Mu="a".charCodeAt(0);for(Vi=10;Vi<36;++Vi)k1[Mu++]=Vi;Mu="A".charCodeAt(0);for(Vi=10;Vi<36;++Vi)k1[Mu++]=Vi;function Aa(e){return JH.charAt(e)}function e_(e,t){var r=k1[e.charCodeAt(t)];return r??-1}function QH(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function ej(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function xo(e){var t=ht();return t.fromInt(e),t}function tj(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=r==8?e[n]&255:e_(e,n);if(a<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this[this.t++]=a:s+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&U.ZERO.subTo(this,this)}function rj(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function nj(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(n=this[a]>>o)>0&&(i=!0,s=Aa(n));a>=0;)o<t?(n=(this[a]&(1<<o)-1)<<t-o,n|=this[--a]>>(o+=this.DB-t)):(n=this[a]>>(o-=t)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=Aa(n));return i?s:"0"}function ij(){var e=ht();return U.ZERO.subTo(this,e),e}function sj(){return this.s<0?this.negate():this}function aj(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function L1(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function oj(){return this.t<=0?0:this.DB*(this.t-1)+L1(this[this.t-1]^this.s&this.DM)}function cj(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function fj(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function uj(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t[o+s+1]=this[o]>>n|a,a=(this[o]&i)<<r;for(o=s-1;o>=0;--o)t[o]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function dj(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t[0]=this[r]>>n;for(var a=r+1;a<this.t;++a)t[a-r-1]|=(this[a]&s)<<i,t[a-r]=this[a]>>n;n>0&&(t[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function lj(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function hj(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&U.ZERO.subTo(t,t)}function pj(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function bj(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ht());var s=ht(),a=this.s,o=e.s,c=this.DB-L1(n[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,b=s[u-1];if(b!=0){var h=b*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),d=this.FV/h,l=(1<<this.F1)/h,y=1<<this.F2,p=r.t,m=p-u,w=t??ht();for(s.dlShiftTo(m,w),r.compareTo(w)>=0&&(r[r.t++]=1,r.subTo(w,r)),U.ONE.dlShiftTo(u,w),w.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--m>=0;){var C=r[--p]==b?this.DM:Math.floor(r[p]*d+(r[p-1]+y)*l);if((r[p]+=s.am(0,C,r,m,0,u))<C)for(s.dlShiftTo(m,w),r.subTo(w,r);r[p]<--C;)r.subTo(w,r)}t!=null&&(r.drShiftTo(u,t),a!=o&&U.ZERO.subTo(t,t)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),a<0&&U.ZERO.subTo(r,r)}}}function gj(e){var t=ht();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(U.ZERO)>0&&e.subTo(t,t),t}function Wc(e){this.m=e}function vj(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function yj(e){return e}function mj(e){e.divRemTo(this.m,null,e)}function wj(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function _j(e,t){e.squareTo(t),this.reduce(t)}Wc.prototype.convert=vj;Wc.prototype.revert=yj;Wc.prototype.reduce=mj;Wc.prototype.mulTo=wj;Wc.prototype.sqrTo=_j;function Sj(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Xc(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function xj(e){var t=ht();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(U.ZERO)>0&&this.m.subTo(t,t),t}function Ej(e){var t=ht();return e.copyTo(t),this.reduce(t),t}function Aj(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767,n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Pj(e,t){e.squareTo(t),this.reduce(t)}function Cj(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Xc.prototype.convert=xj;Xc.prototype.revert=Ej;Xc.prototype.reduce=Aj;Xc.prototype.mulTo=Cj;Xc.prototype.sqrTo=Pj;function Ij(){return(this.t>0?this[0]&1:this.s)==0}function Bj(e,t){if(e>4294967295||e<1)return U.ONE;var r=ht(),n=ht(),i=t.convert(this),s=L1(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)}function Mj(e,t){var r;return e<256||t.isEven()?r=new Wc(t):r=new Xc(t),this.exp(e,r)}U.prototype.copyTo=QH;U.prototype.fromInt=ej;U.prototype.fromString=tj;U.prototype.clamp=rj;U.prototype.dlShiftTo=cj;U.prototype.drShiftTo=fj;U.prototype.lShiftTo=uj;U.prototype.rShiftTo=dj;U.prototype.subTo=lj;U.prototype.multiplyTo=hj;U.prototype.squareTo=pj;U.prototype.divRemTo=bj;U.prototype.invDigit=Sj;U.prototype.isEven=Ij;U.prototype.exp=Bj;U.prototype.toString=nj;U.prototype.negate=ij;U.prototype.abs=sj;U.prototype.compareTo=aj;U.prototype.bitLength=oj;U.prototype.mod=gj;U.prototype.modPowInt=Mj;U.ZERO=xo(0);U.ONE=xo(1);function Tj(){var e=ht();return this.copyTo(e),e}function Oj(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Dj(){return this.t==0?this.s:this[0]<<24>>24}function Nj(){return this.t==0?this.s:this[0]<<16>>16}function Rj(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Fj(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function qj(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=xo(r),i=ht(),s=ht(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a}function Hj(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var c=e_(e,o);if(c<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=t*a+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&U.ZERO.subTo(this,this)}function jj(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(U.ONE.shiftLeft(e-1),lv,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(U.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function kj(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Lj(e){return this.compareTo(e)==0}function Kj(e){return this.compareTo(e)<0?this:e}function Vj(e){return this.compareTo(e)>0?this:e}function Uj(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function zj(e,t){return e&t}function $j(e){var t=ht();return this.bitwiseTo(e,zj,t),t}function lv(e,t){return e|t}function Gj(e){var t=ht();return this.bitwiseTo(e,lv,t),t}function t_(e,t){return e^t}function Wj(e){var t=ht();return this.bitwiseTo(e,t_,t),t}function r_(e,t){return e&~t}function Xj(e){var t=ht();return this.bitwiseTo(e,r_,t),t}function Yj(){for(var e=ht(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function Zj(e){var t=ht();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Jj(e){var t=ht();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Qj(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function ek(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+Qj(this[e]);return this.s<0?this.t*this.DB:-1}function tk(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function rk(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=tk(this[r]^t);return e}function nk(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function ik(e,t){var r=U.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function sk(e){return this.changeBit(e,lv)}function ak(e){return this.changeBit(e,r_)}function ok(e){return this.changeBit(e,t_)}function ck(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function fk(e){var t=ht();return this.addTo(e,t),t}function uk(e){var t=ht();return this.subTo(e,t),t}function dk(e){var t=ht();return this.multiplyTo(e,t),t}function lk(){var e=ht();return this.squareTo(e),e}function hk(e){var t=ht();return this.divRemTo(e,t,null),t}function pk(e){var t=ht();return this.divRemTo(e,null,t),t}function bk(e){var t=ht(),r=ht();return this.divRemTo(e,t,r),new Array(t,r)}function gk(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function vk(e,t){if(e!=0){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function E0(){}function n_(e){return e}function yk(e,t,r){e.multiplyTo(t,r)}function mk(e,t){e.squareTo(t)}E0.prototype.convert=n_;E0.prototype.revert=n_;E0.prototype.mulTo=yk;E0.prototype.sqrTo=mk;function wk(e){return this.exp(e,new E0)}function _k(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()}function Sk(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Tu(e){this.r2=ht(),this.q3=ht(),U.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function xk(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ht();return e.copyTo(t),this.reduce(t),t}function Ek(e){return e}function Ak(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Pk(e,t){e.squareTo(t),this.reduce(t)}function Ck(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Tu.prototype.convert=xk;Tu.prototype.revert=Ek;Tu.prototype.reduce=Ak;Tu.prototype.mulTo=Ck;Tu.prototype.sqrTo=Pk;function Ik(e,t){var r=e.bitLength(),n,i=xo(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Wc(t):t.isEven()?s=new Tu(t):s=new Xc(t);var a=new Array,o=3,c=n-1,u=(1<<n)-1;if(a[1]=s.convert(this),n>1){var b=ht();for(s.sqrTo(a[1],b);o<=u;)a[o]=ht(),s.mulTo(b,a[o-2],a[o]),o+=2}var h=e.t-1,d,l=!0,y=ht(),p;for(r=L1(e[h])-1;h>=0;){for(r>=c?d=e[h]>>r-c&u:(d=(e[h]&(1<<r+1)-1)<<c-r,h>0&&(d|=e[h-1]>>this.DB+r-c)),o=n;(d&1)==0;)d>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),l)a[d].copyTo(i),l=!1;else{for(;o>1;)s.sqrTo(i,y),s.sqrTo(y,i),o-=2;o>0?s.sqrTo(i,y):(p=i,i=y,y=p),s.mulTo(y,a[d],i)}for(;h>=0&&(e[h]&1<<r)==0;)s.sqrTo(i,y),p=i,i=y,y=p,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function Bk(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Mk(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r}function Tk(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return U.ZERO;for(var r=e.clone(),n=this.clone(),i=xo(1),s=xo(0),a=xo(0),o=xo(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(U.ONE)!=0)return U.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var Zn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ok=(1<<26)/Zn[Zn.length-1];function Dk(e){var t,r=this.abs();if(r.t==1&&r[0]<=Zn[Zn.length-1]){for(t=0;t<Zn.length;++t)if(r[0]==Zn[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<Zn.length;){for(var n=Zn[t],i=t+1;i<Zn.length&&n<Ok;)n*=Zn[i++];for(n=r.modInt(n);t<i;)if(n%Zn[t++]==0)return!1}return r.millerRabin(e)}function Nk(e){var t=this.subtract(U.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);e=e+1>>1,e>Zn.length&&(e=Zn.length);for(var i=ht(),s=0;s<e;++s){i.fromInt(Zn[Math.floor(Math.random()*Zn.length)]);var a=i.modPow(n,this);if(a.compareTo(U.ONE)!=0&&a.compareTo(t)!=0){for(var o=1;o++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(U.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}U.prototype.chunkSize=Rj;U.prototype.toRadix=qj;U.prototype.fromRadix=Hj;U.prototype.fromNumber=jj;U.prototype.bitwiseTo=Uj;U.prototype.changeBit=ik;U.prototype.addTo=ck;U.prototype.dMultiply=gk;U.prototype.dAddOffset=vk;U.prototype.multiplyLowerTo=_k;U.prototype.multiplyUpperTo=Sk;U.prototype.modInt=Mk;U.prototype.millerRabin=Nk;U.prototype.clone=Tj;U.prototype.intValue=Oj;U.prototype.byteValue=Dj;U.prototype.shortValue=Nj;U.prototype.signum=Fj;U.prototype.toByteArray=kj;U.prototype.equals=Lj;U.prototype.min=Kj;U.prototype.max=Vj;U.prototype.and=$j;U.prototype.or=Gj;U.prototype.xor=Wj;U.prototype.andNot=Xj;U.prototype.not=Yj;U.prototype.shiftLeft=Zj;U.prototype.shiftRight=Jj;U.prototype.getLowestSetBit=ek;U.prototype.bitCount=rk;U.prototype.testBit=nk;U.prototype.setBit=sk;U.prototype.clearBit=ak;U.prototype.flipBit=ok;U.prototype.add=fk;U.prototype.subtract=uk;U.prototype.multiply=dk;U.prototype.divide=hk;U.prototype.remainder=pk;U.prototype.divideAndRemainder=bk;U.prototype.modPow=Ik;U.prototype.modInverse=Tk;U.prototype.pow=wk;U.prototype.gcd=Bk;U.prototype.isProbablePrime=Dk;U.prototype.square=lk;function hv(){this.i=0,this.j=0,this.S=new Array}function Rk(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function Fk(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}hv.prototype.init=Rk;hv.prototype.next=Fk;function qk(){return new hv}var ov=256;var F1,mi,rn;function Hk(e){mi[rn++]^=e&255,mi[rn++]^=e>>8&255,mi[rn++]^=e>>16&255,mi[rn++]^=e>>24&255,rn>=ov&&(rn-=ov)}function pv(){Hk(new Date().getTime())}if(mi==null){if(mi=new Array,rn=0,Pu!==void 0&&(Pu.crypto!==void 0||Pu.msCrypto!==void 0)){if(nv=Pu.crypto||Pu.msCrypto,nv.getRandomValues)for(iv=new Uint8Array(32),nv.getRandomValues(iv),Ki=0;Ki<32;++Ki)mi[rn++]=iv[Ki];else if(S0.appName=="Netscape"&&S0.appVersion<"5")for(sv=Pu.crypto.random(32),Ki=0;Ki<sv.length;++Ki)mi[rn++]=sv.charCodeAt(Ki)&255}for(;rn<ov;)Ki=Math.floor(65536*Math.random()),mi[rn++]=Ki>>>8,mi[rn++]=Ki&255;rn=0,pv()}var Ki,nv,iv,sv;function jk(){if(F1==null){for(pv(),F1=qk(),F1.init(mi),rn=0;rn<mi.length;++rn)mi[rn]=0;rn=0}return F1.next()}function kk(e){var t;for(t=0;t<e.length;++t)e[t]=jk()}function Ao(){}Ao.prototype.nextBytes=kk;function qn(e,t){return new U(e,t)}function Lk(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=i&63|128,r[--t]=i>>6|192):(r[--t]=i&63|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var s=new Ao,a=new Array;t>2;){for(a[0]=0;a[0]==0;)s.nextBytes(a);r[--t]=a[0]}return r[--t]=2,r[--t]=0,new U(r)}function Xw(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255]))),i+=1;return n}function Kk(e,t,r,n){var i=_.crypto.MessageDigest,s=_.crypto.Util,a=null;if(r||(r="sha1"),typeof r=="string"&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(p){return Hn(s.hashHex(Ui(p),a))}),e.length+2*n+2>t)throw"Message too long for RSA";var o="",c;for(c=0;c<t-e.length-2*n-2;c+=1)o+="\0";var u=r("")+o+""+e,b=new Array(n);new Ao().nextBytes(b);var h=Xw(b,u.length,r),d=[];for(c=0;c<u.length;c+=1)d[c]=u.charCodeAt(c)^h.charCodeAt(c);var l=Xw(d,b.length,r),y=[0];for(c=0;c<b.length;c+=1)y[c+1]=b[c]^l.charCodeAt(c);return new U(y.concat(d))}function ve(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Vk(e,t){if(this.isPublic=!0,this.isPrivate=!1,typeof e!="string")this.n=e,this.e=t;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=qn(e,16),this.e=parseInt(t,16);else throw"Invalid RSA public key"}function Uk(e){return e.modPowInt(this.e,this.n)}function zk(e){var t=Lk(e,this.n.bitLength()+7>>3);if(t==null)return null;var r=this.doPublic(t);if(r==null)return null;var n=r.toString(16);return(n.length&1)==0?n:"0"+n}function $k(e,t,r){var n=this.n.bitLength()+7>>3,i=Kk(e,n,t,r);if(i==null)return null;var s=this.doPublic(i);if(s==null)return null;for(var a=s.toString(16);a.length<n*2;)a="0"+a;return a}ve.prototype.doPublic=Uk;ve.prototype.setPublic=Vk;ve.prototype.encrypt=zk;ve.prototype.encryptOAEP=$k;ve.prototype.type="RSA";function Gk(e,t){for(var r=e.toByteArray(),n=0;n<r.length&&r[n]==0;)++n;if(r.length-n!=t-1||r[n]!=2)return null;for(++n;r[n]!=0;)if(++n>=r.length)return null;for(var i="";++n<r.length;){var s=r[n]&255;s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((s&31)<<6|r[n+1]&63),++n):(i+=String.fromCharCode((s&15)<<12|(r[n+1]&63)<<6|r[n+2]&63),n+=2)}return i}function Yw(e,t,r){for(var n="",i=0;n.length<t;)n+=r(e+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])),i+=1;return n}function Wk(e,t,r,n){var i=_.crypto.MessageDigest,s=_.crypto.Util,a=null;r||(r="sha1"),typeof r=="string"&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(m){return Hn(s.hashHex(Ui(m),a))}),e=e.toByteArray();var h;for(h=0;h<e.length;h+=1)e[h]&=255;for(;e.length<t;)e.unshift(0);if(e=String.fromCharCode.apply(String,e),e.length<2*n+2)throw"Cipher too short";var o=e.substr(1,n),c=e.substr(n+1),u=Yw(c,n,r),b=[],h;for(h=0;h<o.length;h+=1)b[h]=o.charCodeAt(h)^u.charCodeAt(h);var d=Yw(String.fromCharCode.apply(String,b),e.length-n,r),l=[];for(h=0;h<c.length;h+=1)l[h]=c.charCodeAt(h)^d.charCodeAt(h);if(l=String.fromCharCode.apply(String,l),l.substr(0,n)!==r(""))throw"Hash mismatch";l=l.substr(n);var y=l.indexOf(""),p=y!=-1?l.substr(0,y).lastIndexOf("\0"):-1;if(p+1!=y)throw"Malformed data";return l.substr(y+1)}function Xk(e,t,r){if(this.isPrivate=!0,typeof e!="string")this.n=e,this.e=t,this.d=r;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=qn(e,16),this.e=parseInt(t,16),this.d=qn(r,16);else throw"Invalid RSA private key"}function Yk(e,t,r,n,i,s,a,o){if(this.isPrivate=!0,this.isPublic=!1,e==null)throw"RSASetPrivateEx N == null";if(t==null)throw"RSASetPrivateEx E == null";if(e.length==0)throw"RSASetPrivateEx N.length == 0";if(t.length==0)throw"RSASetPrivateEx E.length == 0";if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=qn(e,16),this.e=parseInt(t,16),this.d=qn(r,16),this.p=qn(n,16),this.q=qn(i,16),this.dmp1=qn(s,16),this.dmq1=qn(a,16),this.coeff=qn(o,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function Zk(e,t){var r=new Ao,n=e>>1;this.e=parseInt(t,16);for(var i=new U(t,16),s=e/2-100,a=U.ONE.shiftLeft(s);;){for(;this.p=new U(e-n,1,r),!(this.p.subtract(U.ONE).gcd(i).compareTo(U.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new U(n,1,r),!(this.q.subtract(U.ONE).gcd(i).compareTo(U.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var c=this.q.subtract(this.p).abs();if(!(c.bitLength()<s||c.compareTo(a)<=0)){var u=this.p.subtract(U.ONE),b=this.q.subtract(U.ONE),h=u.multiply(b);if(h.gcd(i).compareTo(U.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=i.modInverse(h),this.dmp1=this.d.mod(u),this.dmq1=this.d.mod(b),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function Jk(e){if(this.p==null||this.q==null)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)}function Qk(e){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var t=qn(e,16),r=this.doPrivate(t);return r==null?null:Gk(r,this.n.bitLength()+7>>3)}function eL(e,t,r){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var n=qn(e,16),i=this.doPrivate(n);return i==null?null:Wk(i,this.n.bitLength()+7>>3,t,r)}ve.prototype.doPrivate=Jk;ve.prototype.setPrivate=Xk;ve.prototype.setPrivateEx=Yk;ve.prototype.generate=Zk;ve.prototype.decrypt=Qk;ve.prototype.decryptOAEP=eL;function jr(e,t){this.x=t,this.q=e}function tL(e){return e==this?!0:this.q.equals(e.q)&&this.x.equals(e.x)}function rL(){return this.x}function nL(){return new jr(this.q,this.x.negate().mod(this.q))}function iL(e){return new jr(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function sL(e){return new jr(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function aL(e){return new jr(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function oL(){return new jr(this.q,this.x.square().mod(this.q))}function cL(e){return new jr(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}jr.prototype.equals=tL;jr.prototype.toBigInteger=rL;jr.prototype.negate=nL;jr.prototype.add=iL;jr.prototype.subtract=sL;jr.prototype.multiply=aL;jr.prototype.square=oL;jr.prototype.divide=cL;jr.prototype.sqrt=function(){return new jr(this.q,this.x.sqrt().mod(this.q))};function mt(e,t,r,n){this.curve=e,this.x=t,this.y=r,n==null?this.z=U.ONE:this.z=n,this.zinv=null}function fL(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function uL(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function dL(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();var t,r;return t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),t.equals(U.ZERO)?(r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q),r.equals(U.ZERO)):!1}function lL(){return this.x==null&&this.y==null?!0:this.z.equals(U.ZERO)&&!this.y.toBigInteger().equals(U.ZERO)}function hL(){return new mt(this.curve,this.x,this.y.negate(),this.z)}function pL(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(U.ZERO.equals(r))return U.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new U("3"),i=this.x.toBigInteger(),s=this.y.toBigInteger(),a=e.x.toBigInteger(),o=e.y.toBigInteger(),c=r.square(),u=c.multiply(r),b=i.multiply(c),h=t.square().multiply(this.z),d=h.subtract(b.shiftLeft(1)).multiply(e.z).subtract(u).multiply(r).mod(this.curve.q),l=b.multiply(n).multiply(t).subtract(s.multiply(u)).subtract(h.multiply(t)).multiply(e.z).add(t.multiply(u)).mod(this.curve.q),y=u.multiply(this.z).multiply(e.z).mod(this.curve.q);return new mt(this.curve,this.curve.fromBigInteger(d),this.curve.fromBigInteger(l),y)}function bL(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=new U("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),a=t.square().multiply(e);U.ZERO.equals(s)||(a=a.add(this.z.square().multiply(s))),a=a.mod(this.curve.q);var o=a.square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),c=a.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(a.square().multiply(a)).mod(this.curve.q),u=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new mt(this.curve,this.curve.fromBigInteger(o),this.curve.fromBigInteger(c),u)}function gL(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new U("3")),n=this.negate(),i=this,s=this.curve.q.subtract(e),a=s.multiply(new U("3")),o=new mt(this.curve,this.x,this.y),c=o.negate(),u;for(u=r.bitLength()-2;u>0;--u){i=i.twice();var b=r.testBit(u),h=t.testBit(u);b!=h&&(i=i.add(b?this:n))}for(u=a.bitLength()-2;u>0;--u){o=o.twice();var d=a.testBit(u),l=s.testBit(u);d!=l&&(o=o.add(d?o:c))}return i}function vL(e,t,r){var n;e.bitLength()>r.bitLength()?n=e.bitLength()-1:n=r.bitLength()-1;for(var i=this.curve.getInfinity(),s=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?r.testBit(n)?i=i.add(s):i=i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i}mt.prototype.getX=fL;mt.prototype.getY=uL;mt.prototype.equals=dL;mt.prototype.isInfinity=lL;mt.prototype.negate=hL;mt.prototype.add=pL;mt.prototype.twice=bL;mt.prototype.multiply=gL;mt.prototype.multiplyTwo=vL;function Ca(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new mt(this,null,null)}function yL(){return this.q}function mL(){return this.a}function wL(){return this.b}function _L(e){return e==this?!0:this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function SL(){return this.infinity}function xL(e){return new jr(this.q,e)}function EL(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=e.substr(0,2),r=e.substr(2),n=this.fromBigInteger(new U(u,16)),i=this.getA(),s=this.getB(),a=n.square().add(i).multiply(n).add(s),o=a.sqrt();return t=="03"&&(o=o.negate()),new mt(this,n,o);case 4:case 6:case 7:var c=(e.length-2)/2,u=e.substr(2,c),b=e.substr(c+2,c);return new mt(this,this.fromBigInteger(new U(u,16)),this.fromBigInteger(new U(b,16)));default:return null}}Ca.prototype.getQ=yL;Ca.prototype.getA=mL;Ca.prototype.getB=wL;Ca.prototype.equals=_L;Ca.prototype.getInfinity=SL;Ca.prototype.fromBigInteger=xL;Ca.prototype.decodePointHex=EL;jr.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};mt.prototype.getEncoded=function(e){var t=function(s,a){var o=s.toByteArrayUnsigned();if(a<o.length)o=o.slice(o.length-a);else for(;a>o.length;)o.unshift(0);return o},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),i=t(r,32);return e?n.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(n,32))),i};mt.decodeFrom=function(e,t){var r=t[0],n=t.length-1,i=t.slice(1,1+n/2),s=t.slice(1+n/2,1+n);i.unshift(0),s.unshift(0);var a=new U(i),o=new U(s);return new mt(e,e.fromBigInteger(a),e.fromBigInteger(o))};mt.decodeFromHex=function(e,t){var r=t.substr(0,2),n=t.length-2,i=t.substr(2,n/2),s=t.substr(2+n/2,n/2),a=new U(i,16),o=new U(s,16);return new mt(e,e.fromBigInteger(a),e.fromBigInteger(o))};mt.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y),n=r.divide(t),i=n.square().subtract(this.x).subtract(e.x),s=n.multiply(this.x.subtract(i)).subtract(this.y);return new mt(this.curve,i,s)};mt.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=this.curve.fromBigInteger(U.valueOf(2)),t=this.curve.fromBigInteger(U.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new mt(this.curve,n,i)};mt.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new U("3")),n=this.negate(),i=this,s;for(s=r.bitLength()-2;s>0;--s){i=i.twice();var a=r.testBit(s),o=t.testBit(s);a!=o&&(i=i.add2D(a?this:n))}return i};mt.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),i=this.curve.getQ(),s=t.multiply(t).mod(i),a=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(i);return s.equals(a)};mt.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};mt.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(U.ONE)<0||t.compareTo(e.subtract(U.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(U.ONE)<0||r.compareTo(e.subtract(U.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var i_=function(){var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",t='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',r='(?:"'+t+'*")',n=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+r+")","g"),i=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),s={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function a(h,d,l){return d?s[d]:String.fromCharCode(parseInt(l,16))}var o=new String(""),c="\\",u={"{":Object,"[":Array},b=Object.hasOwnProperty;return function(h,d){var l=h.match(n),y,p=l[0],m=!1;p==="{"?y={}:p==="["?y=[]:(y=[],m=!0);for(var w,C=[y],T=1-m,q=l.length;T<q;++T){p=l[T];var F;switch(p.charCodeAt(0)){default:F=C[0],F[w||F.length]=+p,w=void 0;break;case 34:if(p=p.substring(1,p.length-1),p.indexOf(c)!==-1&&(p=p.replace(i,a)),F=C[0],!w)if(F instanceof Array)w=F.length;else{w=p||o;break}F[w]=p,w=void 0;break;case 91:F=C[0],C.unshift(F[w||F.length]=[]),w=void 0;break;case 93:C.shift();break;case 102:F=C[0],F[w||F.length]=!1,w=void 0;break;case 110:F=C[0],F[w||F.length]=null,w=void 0;break;case 116:F=C[0],F[w||F.length]=!0,w=void 0;break;case 123:F=C[0],C.unshift(F[w||F.length]={}),w=void 0;break;case 125:C.shift();break}}if(m){if(C.length!==1)throw new Error;y=y[0]}else if(C.length)throw new Error;if(d){var j=function(k,I){var R=k[I];if(R&&typeof R=="object"){var A=null;for(var f in R)if(b.call(R,f)&&R!==k){var g=j(R,f);g!==void 0?R[f]=g:(A||(A=[]),A.push(f))}if(A)for(var E=A.length;--E>=0;)delete R[A[E]]}return d.call(k,I,R)};y=j({"":y},"")}return y}}();(typeof _>"u"||!_)&&(_={});(typeof _.asn1>"u"||!_.asn1)&&(_.asn1={});_.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){return P0(e)},this.getPEMStringFromHex=function(e,t){return Fn(e,t)},this.newObject=function(e){var t=_,r=t.asn1,n=r.ASN1Object,i=r.DERBoolean,s=r.DERInteger,a=r.DERBitString,o=r.DEROctetString,c=r.DERNull,u=r.DERObjectIdentifier,b=r.DEREnumerated,h=r.DERUTF8String,d=r.DERNumericString,l=r.DERPrintableString,y=r.DERTeletexString,p=r.DERIA5String,m=r.DERUTCTime,w=r.DERGeneralizedTime,C=r.DERVisibleString,T=r.DERBMPString,q=r.DERSequence,F=r.DERSet,j=r.DERTaggedObject,k=r.ASN1Util.newObject;if(e instanceof r.ASN1Object)return e;var I=Object.keys(e);if(I.length!=1)throw new Error("key of param shall be only one.");var R=I[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+R+":")==-1)throw new Error("undefined key: "+R);if(R=="bool")return new i(e[R]);if(R=="int")return new s(e[R]);if(R=="bitstr")return new a(e[R]);if(R=="octstr")return new o(e[R]);if(R=="null")return new c(e[R]);if(R=="oid")return new u(e[R]);if(R=="enum")return new b(e[R]);if(R=="utf8str")return new h(e[R]);if(R=="numstr")return new d(e[R]);if(R=="prnstr")return new l(e[R]);if(R=="telstr")return new y(e[R]);if(R=="ia5str")return new p(e[R]);if(R=="utctime")return new m(e[R]);if(R=="gentime")return new w(e[R]);if(R=="visstr")return new C(e[R]);if(R=="bmpstr")return new T(e[R]);if(R=="asn1")return new n(e[R]);if(R=="seq"){for(var A=e[R],f=[],g=0;g<A.length;g++){var E=k(A[g]);f.push(E)}return new q({array:f})}if(R=="set"){for(var A=e[R],f=[],g=0;g<A.length;g++){var E=k(A[g]);f.push(E)}return new F({array:f})}if(R=="tag"){var x=e[R];if(Object.prototype.toString.call(x)==="[object Array]"&&x.length==3){var S=k(x[2]);return new j({tag:x[0],explicit:x[1],obj:S})}else return new j(x)}},this.jsonToASN1HEX=function(e){var t=this.newObject(e);return t.tohex()}};_.asn1.ASN1Util.oidHexToInt=function(e){for(var i="",t=parseInt(e.substr(0,2),16),r=Math.floor(t/40),n=t%40,i=r+"."+n,s="",a=2;a<e.length;a+=2){var o=parseInt(e.substr(a,2),16),c=("00000000"+o.toString(2)).slice(-8);if(s=s+c.substr(1,7),c.substr(0,1)=="0"){var u=new U(s,2);i=i+"."+u.toString(10),s=""}}return i};_.asn1.ASN1Util.oidIntToHex=function(e){var t=function(o){var c=o.toString(16);return c.length==1&&(c="0"+c),c},r=function(o){var c="",u=new U(o,10),b=u.toString(2),h=7-b.length%7;h==7&&(h=0);for(var d="",l=0;l<h;l++)d+="0";b=d+b;for(var l=0;l<b.length-1;l+=7){var y=b.substr(l,7);l!=b.length-7&&(y="1"+y),c+=t(parseInt(y,2))}return c};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),s=parseInt(i[0])*40+parseInt(i[1]);n+=t(s),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n};_.asn1.ASN1Object=function(e){var t=!0,r=null,n="00",i="00",s="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+s.length+",v="+this.hV);var a=this.hV.length/2,o=a.toString(16);if(o.length%2==1&&(o="0"+o),a<128)return o;var c=o.length/2;if(c>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+a.toString(16));var u=128+c;return u.toString(16)+o},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(a){this.params=a},e!=null&&e.tlv!=null&&(this.hTLV=e.tlv,this.isModified=!1)};_.asn1.DERAbstractString=function(e){_.asn1.DERAbstractString.superclass.constructor.call(this);var t=null,r=null;this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=V1(this.s).toLowerCase()},this.setStringHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"?this.setString(e):typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"&&this.setStringHex(e.hex))};W(_.asn1.DERAbstractString,_.asn1.ASN1Object);_.asn1.DERAbstractTime=function(e){_.asn1.DERAbstractTime.superclass.constructor.call(this);var t=null,r=null;this.localDateToUTC=function(n){var i=n.getTime()+n.getTimezoneOffset()*6e4,s=new Date(i);return s},this.formatDate=function(n,i,s){var a=this.zeroPadding,o=this.localDateToUTC(n),c=String(o.getFullYear());i=="utc"&&(c=c.substr(2,2));var u=a(String(o.getMonth()+1),2),b=a(String(o.getDate()),2),h=a(String(o.getHours()),2),d=a(String(o.getMinutes()),2),l=a(String(o.getSeconds()),2),y=c+u+b+h+d+l;if(s===!0){var p=o.getMilliseconds();if(p!=0){var m=a(String(p),3);m=m.replace(/[0]+$/,""),y=y+"."+m}}return y+"Z"},this.zeroPadding=function(n,i){return n.length>=i?n:new Array(i-n.length+1).join("0")+n},this.setByParam=function(n){this.hV=null,this.hTLV=null,this.params=n},this.getString=function(){},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=n},this.setByDate=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=n},this.setByDateValue=function(n,i,s,a,o,c){var u=new Date(Date.UTC(n,i-1,s,a,o,c,0));this.setByDate(u)},this.getFreshValueHex=function(){return this.hV}};W(_.asn1.DERAbstractTime,_.asn1.ASN1Object);_.asn1.DERAbstractStructured=function(e){_.asn1.DERAbstractString.superclass.constructor.call(this);var t=null;this.setByASN1ObjectArray=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array=r},this.appendASN1Object=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array.push(r)},this.asn1Array=new Array,typeof e<"u"&&typeof e.array<"u"&&(this.asn1Array=e.array)};W(_.asn1.DERAbstractStructured,_.asn1.ASN1Object);_.asn1.DERBoolean=function(e){_.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",e==!1?this.hTLV="010100":this.hTLV="0101ff"};W(_.asn1.DERBoolean,_.asn1.ASN1Object);_.asn1.DERInteger=function(e){_.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var t=P0;this.setByBigInteger=function(r){this.isModified=!0,this.params={bigint:r}},this.setByInteger=function(r){this.isModified=!0,this.params=r},this.setValueHex=function(r){this.isModified=!0,this.params={hex:r}},this.getFreshValueHex=function(){var r=this.params,n=null;if(r==null)throw new Error("value not set");if(typeof r=="object"&&r.hex!=null)return this.hV=r.hex,this.hV;if(typeof r=="number")n=new U(String(r),10);else if(r.int!=null)n=new U(String(r.int),10);else if(r.bigint!=null)n=r.bigint;else throw new Error("wrong parameter");return this.hV=t(n),this.hV},e!=null&&(this.params=e)};W(_.asn1.DERInteger,_.asn1.ASN1Object);_.asn1.DERBitString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=_.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.tohex()}_.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(r){this.hTLV=null,this.isModified=!0,this.hV=r},this.setUnusedBitsAndHexValue=function(r,n){if(r<0||7<r)throw"unused bits shall be from 0 to 7: u = "+r;var i="0"+r;this.hTLV=null,this.isModified=!0,this.hV=i+n},this.setByBinaryString=function(r){r=r.replace(/0+$/,"");var n=8-r.length%8;n==8&&(n=0),r+="0000000".substr(0,n);for(var i="",s=0;s<r.length-1;s+=8){var a=r.substr(s,8),o=parseInt(a,2).toString(16);o.length==1&&(o="0"+o),i+=o}this.hTLV=null,this.isModified=!0,this.hV="0"+n+i},this.setByBooleanArray=function(r){for(var n="",i=0;i<r.length;i++)r[i]==!0?n+="1":n+="0";this.setByBinaryString(n)},this.newFalseArray=function(r){for(var n=new Array(r),i=0;i<r;i++)n[i]=!1;return n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):typeof e.hex<"u"?this.setHexValueIncludingUnusedBits(e.hex):typeof e.bin<"u"?this.setByBinaryString(e.bin):typeof e.array<"u"&&this.setByBooleanArray(e.array))};W(_.asn1.DERBitString,_.asn1.ASN1Object);_.asn1.DEROctetString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=_.asn1.ASN1Util.newObject(e.obj);e.hex=t.tohex()}_.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"};W(_.asn1.DEROctetString,_.asn1.DERAbstractString);_.asn1.DERNull=function(){_.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};W(_.asn1.DERNull,_.asn1.ASN1Object);_.asn1.DERObjectIdentifier=function(e){_.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){var r=d_(t);if(r==null)throw new Error("malformed oid string: "+t);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var r=_.asn1.x509.OID.name2oid(t);if(r!=="")this.setValueOidString(r);else throw new Error("DERObjectIdentifier oidName undefined: "+t)},this.setValueNameOrOid=function(t){t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(t){typeof t=="string"?this.setValueNameOrOid(t):t.oid!==void 0?this.setValueNameOrOid(t.oid):t.name!==void 0?this.setValueNameOrOid(t.name):t.hex!==void 0&&this.setValueHex(t.hex)},e!==void 0&&this.setByParam(e)};W(_.asn1.DERObjectIdentifier,_.asn1.ASN1Object);_.asn1.DEREnumerated=function(e){_.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=P0(t)},this.setByInteger=function(t){var r=new U(String(t),10);this.setByBigInteger(r)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.int<"u"?this.setByInteger(e.int):typeof e=="number"?this.setByInteger(e):typeof e.hex<"u"&&this.setValueHex(e.hex))};W(_.asn1.DEREnumerated,_.asn1.ASN1Object);_.asn1.DERUTF8String=function(e){_.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"};W(_.asn1.DERUTF8String,_.asn1.DERAbstractString);_.asn1.DERNumericString=function(e){_.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"};W(_.asn1.DERNumericString,_.asn1.DERAbstractString);_.asn1.DERPrintableString=function(e){_.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"};W(_.asn1.DERPrintableString,_.asn1.DERAbstractString);_.asn1.DERTeletexString=function(e){_.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"};W(_.asn1.DERTeletexString,_.asn1.DERAbstractString);_.asn1.DERIA5String=function(e){_.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"};W(_.asn1.DERIA5String,_.asn1.DERAbstractString);_.asn1.DERVisibleString=function(e){_.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"};W(_.asn1.DERVisibleString,_.asn1.DERAbstractString);_.asn1.DERBMPString=function(e){_.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"};W(_.asn1.DERBMPString,_.asn1.DERAbstractString);_.asn1.DERUTCTime=function(e){_.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{12}Z$/)||t.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=fi(t);else throw new Error("malformed string for UTCTime: "+t);else if(t.str!=null)this.hV=fi(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=fi(this.formatDate(r,"utc",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=fi(this.formatDate(t.date,"utc",n))}else t instanceof Date&&(this.hV=fi(this.formatDate(t,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},e!=null&&this.setByParam(e)};W(_.asn1.DERUTCTime,_.asn1.DERAbstractTime);_.asn1.DERGeneralizedTime=function(e){_.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.params=e,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{14}Z$/)||t.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=fi(t);else throw new Error("malformed string for GeneralizedTime: "+t);else if(t.str!=null)this.hV=fi(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=fi(this.formatDate(r,"gen",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=fi(this.formatDate(t.date,"gen",n))}else t instanceof Date&&(this.hV=fi(this.formatDate(t,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},e!=null&&this.setByParam(e)};W(_.asn1.DERGeneralizedTime,_.asn1.DERAbstractTime);_.asn1.DERSequence=function(e){_.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var t="",r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t+=n.tohex()}return this.hV=t,this.hV}};W(_.asn1.DERSequence,_.asn1.DERAbstractStructured);_.asn1.DERSet=function(e){_.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t.push(n.tohex())}return this.sortFlag==!0&&t.sort(),this.hV=t.join(""),this.hV},typeof e<"u"&&typeof e.sortflag<"u"&&e.sortflag==!1&&(this.sortFlag=!1)};W(_.asn1.DERSet,_.asn1.DERAbstractStructured);_.asn1.DERTaggedObject=function(e){_.asn1.DERTaggedObject.superclass.constructor.call(this);var t=_.asn1,r=X,n=r.getV,i=r.isASN1HEX,s=t.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(a,o,c){this.params={tag:o,explicit:a,obj:c}},this.getFreshValueHex=function(){var a=this.params;if(a.explicit==null&&(a.explicit=!0),a.tage!=null&&(a.tag=a.tage,a.explicit=!0),a.tagi!=null&&(a.tag=a.tagi,a.explicit=!1),a.str!=null)this.hV=V1(a.str);else if(a.hex!=null)this.hV=a.hex;else if(a.obj!=null){var o;a.obj instanceof t.ASN1Object?o=a.obj.tohex():typeof a.obj=="object"&&(o=s(a.obj).tohex()),a.explicit?this.hV=o:this.hV=n(o,0)}else throw new Error("str, hex nor obj not specified");return a.tag==null&&(a.tag="a0"),this.hT=a.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(a){this.params=a},e!==void 0&&this.setByParam(e)};W(_.asn1.DERTaggedObject,_.asn1.ASN1Object);var X=new function(){};X.getLblen=function(e,t){if(e.substr(t+2,1)!="8")return 1;var r=parseInt(e.substr(t+3,1));return r==0?-1:0<r&&r<10?r+1:-2};X.getL=function(e,t){var r=X.getLblen(e,t);return r<1?"":e.substr(t+2,r*2)};X.getVblen=function(e,t){var r,n;return r=X.getL(e,t),r==""?-1:(r.substr(0,1)==="8"?n=new U(r.substr(2),16):n=new U(r,16),n.intValue())};X.getVidx=function(e,t){var r=X.getLblen(e,t);return r<0?r:t+(r+1)*2};X.getV=function(e,t){var r=X.getVidx(e,t),n=X.getVblen(e,t);return e.substr(r,n*2)};X.getTLV=function(e,t){return e.substr(t,2)+X.getL(e,t)+X.getV(e,t)};X.getTLVblen=function(e,t){return 2+X.getLblen(e,t)*2+X.getVblen(e,t)*2};X.getNextSiblingIdx=function(e,t){var r=X.getVidx(e,t),n=X.getVblen(e,t);return r+n*2};X.getChildIdx=function(e,t){var r=X,n=[],i,s,a;i=r.getVidx(e,t),s=r.getVblen(e,t)*2,e.substr(t,2)=="03"&&(i+=2,s-=2),a=0;for(var o=i;a<=s;){var c=r.getTLVblen(e,o);if(a+=c,a<=s&&n.push(o),o+=c,a>=s)break}return n};X.getNthChildIdx=function(e,t,r){var n=X.getChildIdx(e,t);return n[r]};X.getIdxbyList=function(e,t,r,n){var i=X,s,a;return r.length==0?n!==void 0&&e.substr(t,2)!==n?-1:t:(s=r.shift(),a=i.getChildIdx(e,t),s>=a.length?-1:i.getIdxbyList(e,a[s],r,n))};X.getIdxbyListEx=function(e,t,r,n){var i=X,s,a;if(r.length==0)return n!==void 0&&e.substr(t,2)!==n?-1:t;s=r.shift(),a=i.getChildIdx(e,t);for(var o=0,c=0;c<a.length;c++){var u=e.substr(a[c],2);if(typeof s=="number"&&!i.isContextTag(u)&&o==s||typeof s=="string"&&i.isContextTag(u,s))return i.getIdxbyListEx(e,a[c],r,n);i.isContextTag(u)||o++}return-1};X.getTLVbyList=function(e,t,r,n){var i=X,s=i.getIdxbyList(e,t,r,n);return s==-1||s>=e.length?null:i.getTLV(e,s)};X.getTLVbyListEx=function(e,t,r,n){var i=X,s=i.getIdxbyListEx(e,t,r,n);return s==-1?null:i.getTLV(e,s)};X.getVbyList=function(e,t,r,n,i){var s=X,a,o;return a=s.getIdxbyList(e,t,r,n),a==-1||a>=e.length?null:(o=s.getV(e,a),i===!0&&(o=o.substr(2)),o)};X.getVbyListEx=function(e,t,r,n,i){var s=X,a,o,c;return a=s.getIdxbyListEx(e,t,r,n),a==-1?null:(c=s.getV(e,a),e.substr(a,2)=="03"&&i!==!1&&(c=c.substr(2)),c)};X.getInt=function(e,t,r){r==null&&(r=-1);try{var n=e.substr(t,2);if(n!="02"&&n!="03")return r;var i=X.getV(e,t);return n=="02"?parseInt(i,16):h_(i)}catch{return r}};X.getOID=function(e,t,r){r==null&&(r=null);try{if(e.substr(t,2)!="06")return r;var n=X.getV(e,t);return W1(n)}catch{return r}};X.getOIDName=function(e,t,r){r==null&&(r=null);try{var n=X.getOID(e,t,r);if(n==r)return r;var i=_.asn1.x509.OID.oid2name(n);return i==""?n:i}catch{return r}};X.getString=function(e,t,r){r==null&&(r=null);try{var n=X.getV(e,t);return Hn(n)}catch{return r}};X.hextooidstr=function(e){var t=function(h,d){return h.length>=d?h:new Array(d-h.length+1).join("0")+h},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var s=e.substr(2),a=[],o=0;o<s.length/2;o++)a.push(parseInt(s.substr(o*2,2),16));for(var c=[],u="",o=0;o<a.length;o++)a[o]&128?u=u+t((a[o]&127).toString(2),7):(u=u+t((a[o]&127).toString(2),7),c.push(new String(parseInt(u,2))),u="");var b=r.join(".");return c.length>0&&(b=b+"."+c.join(".")),b};X.dump=function(e,t,r,n){var i=X,s=i.getV,a=i.dump,o=i.getChildIdx,c=e;e instanceof _.asn1.ASN1Object&&(c=e.tohex());var u=function(k,I){if(k.length<=I*2)return k;var R=k.substr(0,I)+"..(total "+k.length/2+"bytes).."+k.substr(k.length-I,I);return R};t===void 0&&(t={ommit_long_octet:32}),r===void 0&&(r=0),n===void 0&&(n="");var b=t.ommit_long_octet,F=c.substr(r,2);if(F=="01"){var h=s(c,r);return h=="00"?n+`BOOLEAN FALSE
`:n+`BOOLEAN TRUE
`}if(F=="02"){var h=s(c,r);return n+"INTEGER "+u(h,b)+`
`}if(F=="03"){var h=s(c,r);if(i.isASN1HEX(h.substr(2))){var d=n+`BITSTRING, encapsulates
`;return d=d+a(h.substr(2),t,0,n+"  "),d}else return n+"BITSTRING "+u(h,b)+`
`}if(F=="04"){var h=s(c,r);if(i.isASN1HEX(h)){var d=n+`OCTETSTRING, encapsulates
`;return d=d+a(h,t,0,n+"  "),d}else return n+"OCTETSTRING "+u(h,b)+`
`}if(F=="05")return n+`NULL
`;if(F=="06"){var l=s(c,r),y=_.asn1.ASN1Util.oidHexToInt(l),p=_.asn1.x509.OID.oid2name(y),m=y.replace(/\./g," ");return p!=""?n+"ObjectIdentifier "+p+" ("+m+`)
`:n+"ObjectIdentifier ("+m+`)
`}if(F=="0a")return n+"ENUMERATED "+parseInt(s(c,r))+`
`;if(F=="0c")return n+"UTF8String '"+It(s(c,r))+`'
`;if(F=="13")return n+"PrintableString '"+It(s(c,r))+`'
`;if(F=="14")return n+"TeletexString '"+It(s(c,r))+`'
`;if(F=="16")return n+"IA5String '"+It(s(c,r))+`'
`;if(F=="17")return n+"UTCTime "+It(s(c,r))+`
`;if(F=="18")return n+"GeneralizedTime "+It(s(c,r))+`
`;if(F=="1a")return n+"VisualString '"+It(s(c,r))+`'
`;if(F=="1e")return n+"BMPString '"+yv(s(c,r))+`'
`;if(F=="30"){if(c.substr(r,4)=="3000")return n+`SEQUENCE {}
`;var d=n+`SEQUENCE
`,w=o(c,r),C=t;if((w.length==2||w.length==3)&&c.substr(w[0],2)=="06"&&c.substr(w[w.length-1],2)=="04"){var p=i.oidname(s(c,w[0])),T=JSON.parse(JSON.stringify(t));T.x509ExtName=p,C=T}for(var q=0;q<w.length;q++)d=d+a(c,C,w[q],n+"  ");return d}if(F=="31"){for(var d=n+`SET
`,w=o(c,r),q=0;q<w.length;q++)d=d+a(c,t,w[q],n+"  ");return d}var F=parseInt(F,16);if((F&128)!=0){var j=F&31;if((F&32)!=0){for(var d=n+"["+j+`]
`,w=o(c,r),q=0;q<w.length;q++)d=d+a(c,t,w[q],n+"  ");return d}else{var h=s(c,r);if(X.isASN1HEX(h)){var d=n+"["+j+`]
`;return d=d+a(h,t,0,n+"  "),d}else(h.substr(0,8)=="68747470"||t.x509ExtName==="subjectAltName"&&j==2)&&(h=It(h));var d=n+"["+j+"] "+h+`
`;return d}}return n+"UNKNOWN("+F+") "+s(c,r)+`
`};X.parse=function(e){var t=X,r=t.parse,n=t.isASN1HEX,i=t.getV,s=t.getTLV,a=t.getChildIdx,o=_.asn1,c=o.ASN1Util.oidHexToInt,u=o.x509.OID.oid2name,b=It,h=yv,d=ML,l={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},y=function(R){for(var A=[],f=a(R,0),g=0;g<f.length;g++){var E=f[g],x=s(R,E),S=r(x);A.push(S)}return A},p=e.substr(0,2),m={},w=i(e,0);if(p=="01")return e=="0101ff"?{bool:!0}:{bool:!1};if(p=="02")return{int:{hex:w}};if(p=="03")try{if(w.substr(0,2)!="00")throw"not encap";var C=w.substr(2);if(!n(C))throw"not encap";return{bitstr:{obj:r(C)}}}catch{var T=null;return w.length<=10&&(T=b_(w)),T==null?{bitstr:{hex:w}}:{bitstr:{bin:T}}}else if(p=="04")try{if(!n(w))throw"not encap";return{octstr:{obj:r(w)}}}catch{return{octstr:{hex:w}}}else{if(p=="05")return{null:""};if(p=="06"){var q=c(w),F=u(q);return F==""?{oid:q}:{oid:F}}else{if(p=="0a")return w.length>4?{enum:{hex:w}}:{enum:parseInt(w,16)};if(p=="30"||p=="31")return m[l[p]]=y(e),m;if(p=="14"){var j=d(w);return m[l[p]]={str:j},m}else if(p=="1e"){var j=h(w);return m[l[p]]={str:j},m}else if(":0c:12:13:16:17:18:1a:".indexOf(p)!=-1){var j=b(w);return m[l[p]]={str:j},m}else if(p.match(/^8[0-9]$/)){var j=b(w);return j==null|j==""?{tag:{tag:p,explicit:!1,hex:w}}:j.match(/[\x00-\x1F\x7F-\x9F]/)!=null||j.match(/[\u0000-\u001F\u0080\u009F]/)!=null?{tag:{tag:p,explicit:!1,hex:w}}:{tag:{tag:p,explicit:!1,str:j}}}else if(p.match(/^a[0-9]$/))try{if(!n(w))throw new Error("not encap");return{tag:{tag:p,explicit:!0,obj:r(w)}}}catch{return{tag:{tag:p,explicit:!0,hex:w}}}else{var k=new _.asn1.ASN1Object;k.hV=w;var I=k.getLengthHexFromValue();return{asn1:{tlv:p+I+w}}}}}};X.isContextTag=function(e,t){e=e.toLowerCase();var r,n;try{r=parseInt(e,16)}catch{return-1}if(t===void 0)return(r&192)==128;try{var i=t.match(/^\[[0-9]+\]$/);return i==null||(n=parseInt(t.substr(1,t.length-1),10),n>31)?!1:(r&192)==128&&(r&31)==n}catch{return!1}};X.isASN1HEX=function(e){var t=X;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0),s=e.length-n.length-i.length;return s==r*2};X.checkStrictDER=function(e,t,r,n,i){var s=X;if(r===void 0){if(typeof e!="string")throw new Error("not hex string");if(e=e.toLowerCase(),!_.lang.String.isHex(e))throw new Error("not hex string");r=e.length,n=e.length/2,n<128?i=1:i=Math.ceil(n.toString(16))+1}var a=s.getL(e,t);if(a.length>i*2)throw new Error("L of TLV too long: idx="+t);var o=s.getVblen(e,t);if(o>n)throw new Error("value of L too long than hex: idx="+t);var c=s.getTLV(e,t),u=c.length-2-s.getL(e,t).length;if(u!==o*2)throw new Error("V string length and L's value not the same:"+u+"/"+o*2);if(t===0&&e.length!=c.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+c.length);var b=e.substr(t,2);if(b==="02"){var h=s.getVidx(e,t);if(e.substr(h,2)=="00"&&e.charCodeAt(h+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(b,16)&32){for(var d=s.getVblen(e,t),l=0,y=s.getChildIdx(e,t),p=0;p<y.length;p++){var m=s.getTLV(e,y[p]);l+=m.length,s.checkStrictDER(e,y[p],r,n,i)}if(d*2!=l)throw new Error("sum of children's TLV length and L unmatch: "+d*2+"!="+l)}};X.oidname=function(e){var t=_.asn1;_.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return r===""&&(r=e),r};(typeof _>"u"||!_)&&(_={});(typeof _.asn1>"u"||!_.asn1)&&(_.asn1={});(typeof _.asn1.x509>"u"||!_.asn1.x509)&&(_.asn1.x509={});_.asn1.x509.Certificate=function(e){_.asn1.x509.Certificate.superclass.constructor.call(this);var t=_,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.x509,a=s.TBSCertificate,o=s.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=this.params,u=c.sigalg;c.sigalg.name!=null&&(u=c.sigalg.name);var b=c.tbsobj.tohex(),h=new _.crypto.Signature({alg:u});h.init(c.cakey),h.updateHex(b),c.sighex=h.sign()},this.getPEM=function(){return Fn(this.tohex(),"CERTIFICATE")},this.tohex=function(){var c=this.params;if((c.tbsobj==null||c.tbsobj==null)&&(c.tbsobj=new a(c)),c.sighex==null&&c.cakey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or cakey parameter not defined");var u=[];u.push(c.tbsobj),u.push(new o({name:c.sigalg})),u.push(new n({hex:"00"+c.sighex}));var b=new i({array:u});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};W(_.asn1.x509.Certificate,_.asn1.ASN1Object);_.asn1.x509.TBSCertificate=function(e){_.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=_,r=t.asn1,n=r.x509,i=r.DERTaggedObject,s=r.DERInteger,a=r.DERSequence,o=n.AlgorithmIdentifier,c=n.Time,u=n.X500Name,b=n.Extensions,h=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(d){this.params=d},this.tohex=function(){var d=[],l=this.params;if(l.version!=null||l.version!=1){var y=2;l.version!=null&&(y=l.version-1);var p=new i({obj:new s({int:y})});d.push(p)}d.push(new s(l.serial)),d.push(new o({name:l.sigalg})),d.push(new u(l.issuer)),d.push(new a({array:[new c(l.notbefore),new c(l.notafter)]})),d.push(new u(l.subject)),d.push(new h(at.getKey(l.sbjpubkey))),l.ext!==void 0&&l.ext.length>0&&d.push(new i({tag:"a3",obj:new b(l.ext)}));var m=new _.asn1.DERSequence({array:d});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.TBSCertificate,_.asn1.ASN1Object);_.asn1.x509.Extensions=function(e){_.asn1.x509.Extensions.superclass.constructor.call(this);var t=_,r=t.asn1,n=r.DERSequence,i=r.x509;this.aParam=[],this.setByParam=function(s){this.aParam=s},this.tohex=function(){for(var s=[],a=0;a<this.aParam.length;a++){var o=this.aParam[a],c=o.extname,u=null;if(o.extn!=null)u=new i.PrivateExtension(o);else if(c=="subjectKeyIdentifier")u=new i.SubjectKeyIdentifier(o);else if(c=="keyUsage")u=new i.KeyUsage(o);else if(c=="subjectAltName")u=new i.SubjectAltName(o);else if(c=="issuerAltName")u=new i.IssuerAltName(o);else if(c=="basicConstraints")u=new i.BasicConstraints(o);else if(c=="nameConstraints")u=new i.NameConstraints(o);else if(c=="cRLDistributionPoints")u=new i.CRLDistributionPoints(o);else if(c=="certificatePolicies")u=new i.CertificatePolicies(o);else if(c=="policyMappings")u=new i.PolicyMappings(o);else if(c=="policyConstraints")u=new i.PolicyConstraints(o);else if(c=="inhibitAnyPolicy")u=new i.InhibitAnyPolicy(o);else if(c=="authorityKeyIdentifier")u=new i.AuthorityKeyIdentifier(o);else if(c=="extKeyUsage")u=new i.ExtKeyUsage(o);else if(c=="authorityInfoAccess")u=new i.AuthorityInfoAccess(o);else if(c=="cRLNumber")u=new i.CRLNumber(o);else if(c=="cRLReason")u=new i.CRLReason(o);else if(c=="ocspNonce")u=new i.OCSPNonce(o);else if(c=="ocspNoCheck")u=new i.OCSPNoCheck(o);else if(c=="adobeTimeStamp")u=new i.AdobeTimeStamp(o);else if(c=="subjectDirectoryAttributes")u=new i.SubjectDirectoryAttributes(o);else throw new Error("extension not supported:"+JSON.stringify(o));u!=null&&s.push(u)}var b=new n({array:s});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.x509.Extensions,_.asn1.ASN1Object);_.asn1.x509.Extension=function(e){_.asn1.x509.Extension.superclass.constructor.call(this);var t=null,r=_,n=r.asn1,i=n.DERObjectIdentifier,s=n.DEROctetString,a=n.DERBitString,o=n.DERBoolean,c=n.DERSequence;this.tohex=function(){var u=new i({oid:this.oid}),b=new s({hex:this.getExtnValueHex()}),h=new Array;h.push(u),this.critical&&h.push(new o),h.push(b);var d=new c({array:h});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,e!==void 0&&e.critical!==void 0&&(this.critical=e.critical)};W(_.asn1.x509.Extension,_.asn1.ASN1Object);_.asn1.x509.KeyUsage=function(e){_.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Error,r={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var n=this.getBinValue();return this.asn1ExtnValue=new _.asn1.DERBitString({bin:n}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var n=this.params;if(typeof n!="object"||typeof n.names!="object"&&typeof n.bin!="string")throw new t("parameter not yet set");if(n.names!=null)return j1(n.names,r);if(n.bin!=null)return n.bin;throw new t("parameter not set properly")},this.oid="2.5.29.15",e!==void 0&&(this.params=e)};W(_.asn1.x509.KeyUsage,_.asn1.x509.Extension);_.asn1.x509.BasicConstraints=function(e){_.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=_.asn1,r=t.DERBoolean,n=t.DERInteger,i=t.DERSequence,s=!1,a=-1;this.getExtnValueHex=function(){var o=new Array;this.cA&&o.push(new r),this.pathLen>-1&&o.push(new n({int:this.pathLen}));var c=new i({array:o});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,e!==void 0&&(e.cA!==void 0&&(this.cA=e.cA),e.pathLen!==void 0&&(this.pathLen=e.pathLen))};W(_.asn1.x509.BasicConstraints,_.asn1.x509.Extension);_.asn1.x509.CRLDistributionPoints=function(e){_.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(i){for(var s=[],a=0;a<i.length;a++)if(i[a]instanceof _.asn1.ASN1Object)s.push(i[a]);else{var o=new n.DistributionPoint(i[a]);s.push(o)}this.asn1ExtnValue=new r.DERSequence({array:s})},this.setByOneURI=function(i){var s=new n.DistributionPoint({fulluri:i});this.setByDPArray([s])},this.oid="2.5.29.31",e!==void 0&&(e.array!==void 0?this.setByDPArray(e.array):e.uri!==void 0&&this.setByOneURI(e.uri))};W(_.asn1.x509.CRLDistributionPoints,_.asn1.x509.Extension);_.asn1.x509.DistributionPoint=function(e){_.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=null,r=_,n=r.asn1,i=n.x509.DistributionPointName;this.tohex=function(){var s=new n.DERSequence;if(this.asn1DP!=null){var a=new n.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});s.appendASN1Object(a)}return this.hTLV=s.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.dpobj!==void 0?this.asn1DP=e.dpobj:e.dpname!==void 0?this.asn1DP=new i(e.dpname):e.fulluri!==void 0&&(this.asn1DP=new i({full:[{uri:e.fulluri}]})))};W(_.asn1.x509.DistributionPoint,_.asn1.ASN1Object);_.asn1.x509.DistributionPointName=function(e){_.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=null,r=null,n=null,i=null,s=_,a=s.asn1,o=a.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new o({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0)if(a.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else if(e.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new a.x509.GeneralNames(e.full);else throw new Error("This class supports GeneralNames only as argument")};W(_.asn1.x509.DistributionPointName,_.asn1.ASN1Object);_.asn1.x509.CertificatePolicies=function(e){_.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.x509,i=r.DERSequence,s=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var a=[],o=0;o<this.params.array.length;o++)a.push(new s(this.params.array[o]));var c=new i({array:a});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",e!==void 0&&(this.params=e)};W(_.asn1.x509.CertificatePolicies,_.asn1.x509.Extension);_.asn1.x509.PolicyInformation=function(e){_.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=_.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var s=[new n(this.params.policyoid)];if(this.params.array!==void 0){for(var a=[],o=0;o<this.params.array.length;o++)a.push(new i(this.params.array[o]));a.length>0&&s.push(new r({array:a}))}var c=new r({array:s});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};W(_.asn1.x509.PolicyInformation,_.asn1.ASN1Object);_.asn1.x509.PolicyQualifierInfo=function(e){_.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=_.asn1,r=t.DERSequence,n=t.DERIA5String,i=t.DERObjectIdentifier,s=t.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var a=new r({array:[new i({oid:"1.3.6.1.5.5.7.2.1"}),new n({str:this.params.cps})]});return a.tohex()}if(this.params.unotice!=null){var a=new r({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new s(this.params.unotice)]});return a.tohex()}},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};W(_.asn1.x509.PolicyQualifierInfo,_.asn1.ASN1Object);_.asn1.x509.UserNotice=function(e){_.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=_.asn1.DERSequence,r=_.asn1.DERInteger,n=_.asn1.x509.DisplayText,i=_.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var s=[];this.params.noticeref!==void 0&&s.push(new i(this.params.noticeref)),this.params.exptext!==void 0&&s.push(new n(this.params.exptext));var a=new t({array:s});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};W(_.asn1.x509.UserNotice,_.asn1.ASN1Object);_.asn1.x509.NoticeReference=function(e){_.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=_.asn1.DERSequence,r=_.asn1.DERInteger,n=_.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var i=[];if(this.params.org!==void 0&&i.push(new n(this.params.org)),this.params.noticenum!==void 0){for(var s=[],a=this.params.noticenum,o=0;o<a.length;o++)s.push(new r(a[o]));i.push(new t({array:s}))}if(i.length==0)throw new Error("parameter is empty");var c=new t({array:i});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};W(_.asn1.x509.NoticeReference,_.asn1.ASN1Object);_.asn1.x509.DisplayText=function(e){_.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",e!==void 0&&(e.type==="ia5"?this.hT="16":e.type==="vis"?this.hT="1a":e.type==="bmp"&&(this.hT="1e"))};W(_.asn1.x509.DisplayText,_.asn1.DERAbstractString);_.asn1.x509.PolicyMappings=function(e){_.asn1.x509.PolicyMappings.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var s=this.params,a=[],o=0;o<s.array.length;o++){var c=s.array[o];a.push({seq:[{oid:c[0]},{oid:c[1]}]})}return this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",e!==void 0&&(this.params=e)};W(_.asn1.x509.PolicyMappings,_.asn1.x509.Extension);_.asn1.x509.PolicyConstraints=function(e){_.asn1.x509.PolicyConstraints.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var s=this.params,a=[];return s.reqexp!=null&&a.push({tag:{tagi:"80",obj:{int:s.reqexp}}}),s.inhibit!=null&&a.push({tag:{tagi:"81",obj:{int:s.inhibit}}}),this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",e!==void 0&&(this.params=e)};W(_.asn1.x509.PolicyConstraints,_.asn1.x509.Extension);_.asn1.x509.InhibitAnyPolicy=function(e){_.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=i({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",e!==void 0&&(this.params=e)};W(_.asn1.x509.InhibitAnyPolicy,_.asn1.x509.Extension);_.asn1.x509.NameConstraints=function(e){_.asn1.x509.NameConstraints.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject,s=n.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var a=this.params,o=[];if(a.permit!=null&&a.permit.length!=null){for(var c=[],u=0;u<a.permit.length;u++)c.push(new s(a.permit[u]));o.push({tag:{tagi:"a0",obj:{seq:c}}})}if(a.exclude!=null&&a.exclude.length!=null){for(var b=[],u=0;u<a.exclude.length;u++)b.push(new s(a.exclude[u]));o.push({tag:{tagi:"a1",obj:{seq:b}}})}return this.asn1ExtnValue=i({seq:o}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",e!==void 0&&(this.params=e)};W(_.asn1.x509.NameConstraints,_.asn1.x509.Extension);_.asn1.x509.GeneralSubtree=function(e){_.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var t=_.asn1,r=t.x509,n=r.GeneralName,i=t.ASN1Util.newObject;this.params=null,this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params,a=[new n(s)];s.min!=null&&a.push({tag:{tagi:"80",obj:{int:s.min}}}),s.max!=null&&a.push({tag:{tagi:"81",obj:{int:s.max}}});var o=i({seq:a});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.GeneralSubtree,_.asn1.ASN1Object);_.asn1.x509.ExtKeyUsage=function(e){_.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=_,r=t.asn1;this.setPurposeArray=function(n){this.asn1ExtnValue=new r.DERSequence;for(var i=0;i<n.length;i++){var s=new r.DERObjectIdentifier(n[i]);this.asn1ExtnValue.appendASN1Object(s)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",e!==void 0&&e.array!==void 0&&this.setPurposeArray(e.array)};W(_.asn1.x509.ExtKeyUsage,_.asn1.x509.Extension);_.asn1.x509.AuthorityKeyIdentifier=function(e){_.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.DERTaggedObject,i=r.x509.GeneralNames,s=t.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var a=new Array;this.asn1KID&&a.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&a.push(new n({explicit:!1,tag:"a1",obj:new i([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&a.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var o=new r.DERSequence({array:a});return this.asn1ExtnValue=o,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(a.str!==void 0||a.hex!==void 0)this.asn1KID=new _.asn1.DEROctetString(a);else if(typeof a=="object"&&_.crypto.Util.isKey(a)||typeof a=="string"&&a.indexOf("BEGIN ")!=-1){var o=a;typeof a=="string"&&(o=at.getKey(a));var c=at.getKeyID(o);this.asn1KID=new _.asn1.DEROctetString({hex:c})}},this.setCertIssuerByParam=function(a){a.str!==void 0||a.ldapstr!==void 0||a.hex!==void 0||a.certsubject!==void 0||a.certissuer!==void 0?this.asn1CertIssuer=new _.asn1.x509.X500Name(a):typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&a.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new _.asn1.x509.X500Name({certissuer:a}))},this.setCertSNByParam=function(a){if(a.str!==void 0||a.bigint!==void 0||a.hex!==void 0)this.asn1CertSN=new _.asn1.DERInteger(a);else if(typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&a.indexOf("CERTIFICATE")){var o=new ye;o.readCertPEM(a);var c=o.getSerialNumberHex();this.asn1CertSN=new _.asn1.DERInteger({hex:c})}},this.oid="2.5.29.35",e!==void 0&&(e.kid!==void 0&&this.setKIDByParam(e.kid),e.issuer!==void 0&&this.setCertIssuerByParam(e.issuer),e.sn!==void 0&&this.setCertSNByParam(e.sn),e.issuersn!==void 0&&typeof e.issuersn=="string"&&e.issuersn.indexOf("BEGIN ")!=-1&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))};W(_.asn1.x509.AuthorityKeyIdentifier,_.asn1.x509.Extension);_.asn1.x509.SubjectKeyIdentifier=function(e){_.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(i){if(i.str!==void 0||i.hex!==void 0)this.asn1KID=new n(i);else if(typeof i=="object"&&_.crypto.Util.isKey(i)||typeof i=="string"&&i.indexOf("BEGIN")!=-1){var s=i;typeof i=="string"&&(s=at.getKey(i));var a=at.getKeyID(s);this.asn1KID=new _.asn1.DEROctetString({hex:a})}},this.oid="2.5.29.14",e!==void 0&&e.kid!==void 0&&this.setKIDByParam(e.kid)};W(_.asn1.x509.SubjectKeyIdentifier,_.asn1.x509.Extension);_.asn1.x509.AuthorityInfoAccess=function(e){_.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(t){for(var r=new Array,n=_,i=n.asn1,s=i.DERSequence,a=i.DERObjectIdentifier,o=i.x509.GeneralName,c=0;c<t.length;c++){var u,b=t[c];if(b.ocsp!==void 0)u=new s({array:[new a({oid:"1.3.6.1.5.5.7.48.1"}),new o({uri:b.ocsp})]});else if(b.caissuer!==void 0)u=new s({array:[new a({oid:"1.3.6.1.5.5.7.48.2"}),new o({uri:b.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(b));r.push(u)}this.asn1ExtnValue=new s({array:r})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",e!==void 0&&e.array!==void 0&&this.setAccessDescriptionArray(e.array)};W(_.asn1.x509.AuthorityInfoAccess,_.asn1.x509.Extension);_.asn1.x509.SubjectAltName=function(e){_.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new _.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};W(_.asn1.x509.SubjectAltName,_.asn1.x509.Extension);_.asn1.x509.IssuerAltName=function(e){_.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new _.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};W(_.asn1.x509.IssuerAltName,_.asn1.x509.Extension);_.asn1.x509.SubjectDirectoryAttributes=function(e){_.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=_.asn1,r=t.DERSequence,n=t.ASN1Util.newObject,i=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var s=[],a=0;a<this.params.array.length;a++){var o=this.params.array[a];if(o.attr!=null&&o.array!=null){var c={seq:[{oid:o.attr},{set:o.array}]};s.push(n(c));continue}var u={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(o.attr=="dateOfBirth")u.seq[0].oid=i(o.attr),u.seq[1].set[0]={gentime:o.str};else if(o.attr=="placeOfBirth")u.seq[0].oid=i(o.attr),u.seq[1].set[0]={utf8str:o.str};else if(o.attr=="gender")u.seq[0].oid=i(o.attr),u.seq[1].set[0]={prnstr:o.str};else if(o.attr=="countryOfCitizenship")u.seq[0].oid=i(o.attr),u.seq[1].set[0]={prnstr:o.str};else if(o.attr=="countryOfResidence")u.seq[0].oid=i(o.attr),u.seq[1].set[0]={prnstr:o.str};else throw new Error("unsupported attribute: "+o.attr);s.push(new n(u))}var b=new r({array:s});return this.asn1ExtnValue=b,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",e!==void 0&&(this.params=e)};W(_.asn1.x509.SubjectDirectoryAttributes,_.asn1.x509.Extension);_.asn1.x509.PrivateExtension=function(e){_.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=_,r=t.lang.String.isHex,n=t.asn1,i=n.x509.OID.name2oid,s=n.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.oid=i(a.extname),this.params=a},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var a=this.params.extn;if(typeof a=="string"&&r(a))return a;if(typeof a=="object")try{return s(a).tohex()}catch{}throw new Error("unsupported extn value")},e!=null&&this.setByParam(e)};W(_.asn1.x509.PrivateExtension,_.asn1.x509.Extension);_.asn1.x509.CRL=function(e){_.asn1.x509.CRL.superclass.constructor.call(this);var t=_,r=t.asn1,n=r.DERSequence,i=r.DERBitString,s=r.x509,a=s.AlgorithmIdentifier,o=s.TBSCertList;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=new o(this.params).tohex(),u=new _.crypto.Signature({alg:this.params.sigalg});u.init(this.params.cakey),u.updateHex(c);var b=u.sign();this.params.sighex=b},this.getPEM=function(){return Fn(this.tohex(),"X509 CRL")},this.tohex=function(){var c=this.params;if(c.tbsobj==null&&(c.tbsobj=new o(c)),c.sighex==null&&c.cakey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or cakey parameter not defined");var u=[];u.push(c.tbsobj),u.push(new a({name:c.sigalg})),u.push(new i({hex:"00"+c.sighex}));var b=new n({array:u});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};W(_.asn1.x509.CRL,_.asn1.ASN1Object);_.asn1.x509.TBSCertList=function(e){_.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=_,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.DERTaggedObject,a=r.DERObjectIdentifier,o=r.x509,c=o.AlgorithmIdentifier,u=o.Time,b=o.Extensions,h=o.X500Name;this.params=null,this.setByParam=function(d){this.params=d},this.getRevCertSequence=function(){for(var d=[],l=this.params.revcert,y=0;y<l.length;y++){var p=[new n(l[y].sn),new u(l[y].date)];l[y].ext!=null&&p.push(new b(l[y].ext)),d.push(new i({array:p}))}return new i({array:d})},this.tohex=function(){var d=[],l=this.params;if(l.version!=null){var y=l.version-1,p=new n({int:y});d.push(p)}if(d.push(new c({name:l.sigalg})),d.push(new h(l.issuer)),d.push(new u(l.thisupdate)),l.nextupdate!=null&&d.push(new u(l.nextupdate)),l.revcert!=null&&d.push(this.getRevCertSequence()),l.ext!=null){var m=new b(l.ext);d.push(new s({tag:"a0",explicit:!0,obj:m}))}var w=new i({array:d});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.TBSCertList,_.asn1.ASN1Object);_.asn1.x509.CRLEntry=function(e){_.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=null,r=null,n=_,i=n.asn1;this.setCertSerial=function(s){this.sn=new i.DERInteger(s)},this.setRevocationDate=function(s){this.time=new i.x509.Time(s)},this.tohex=function(){var s=new i.DERSequence({array:[this.sn,this.time]});return this.TLV=s.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.time!==void 0&&this.setRevocationDate(e.time),e.sn!==void 0&&this.setCertSerial(e.sn))};W(_.asn1.x509.CRLEntry,_.asn1.ASN1Object);_.asn1.x509.CRLNumber=function(e){_.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new _.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",e!=null&&(this.params=e)};W(_.asn1.x509.CRLNumber,_.asn1.x509.Extension);_.asn1.x509.CRLReason=function(e){_.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new _.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",e!=null&&(this.params=e)};W(_.asn1.x509.CRLReason,_.asn1.x509.Extension);_.asn1.x509.OCSPNonce=function(e){_.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new _.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",e!=null&&(this.params=e)};W(_.asn1.x509.OCSPNonce,_.asn1.x509.Extension);_.asn1.x509.OCSPNoCheck=function(e){_.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new _.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",e!=null&&(this.params=e)};W(_.asn1.x509.OCSPNoCheck,_.asn1.x509.Extension);_.asn1.x509.AdobeTimeStamp=function(e){_.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=_,r=t.asn1,n=r.DERInteger,i=r.DERBoolean,s=r.DERSequence,a=r.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var o=this.params,c=[new n(1)];return c.push(new a({uri:o.uri})),o.reqauth!=null&&c.push(new i(o.reqauth)),this.asn1ExtnValue=new s({array:c}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",e!==void 0&&this.setByParam(e)};W(_.asn1.x509.AdobeTimeStamp,_.asn1.x509.Extension);_.asn1.x509.X500Name=function(e){_.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=_,r=t.asn1,n=r.x509,i=n.RDN,s=or;this.setByString=function(a,o){o!==void 0&&(this.sRule=o);var c=a.split("/");c.shift();for(var u=[],b=0;b<c.length;b++)if(c[b].match(/^[^=]+=.+$/))u.push(c[b]);else{var h=u.length-1;u[h]=u[h]+"/"+c[b]}for(var b=0;b<u.length;b++)this.asn1Array.push(new i({str:u[b],rule:this.sRule}))},this.setByLdapString=function(a,o){o!==void 0&&(this.sRule=o);var c=n.X500Name.ldapToCompat(a);this.setByString(c,o)},this.setByObject=function(a,o){o!==void 0&&(this.sRule=o);for(var c in a)if(a.hasOwnProperty(c)){var u=new i({str:c+"="+a[c],rule:this.sRule});this.asn1Array?this.asn1Array.push(u):this.asn1Array=[u]}},this.setByParam=function(a){if(a.rule!==void 0&&(this.sRule=a.rule),a.array!==void 0)this.paramArray=a.array;else if(a.str!==void 0)this.setByString(a.str);else if(a.ldapstr!==void 0)this.setByLdapString(a.ldapstr);else if(a.hex!==void 0)this.hTLV=a.hex;else if(a.certissuer!==void 0){var o=new ye;o.readCertPEM(a.certissuer),this.hTLV=o.getIssuerHex()}else if(a.certsubject!==void 0){var o=new ye;o.readCertPEM(a.certsubject),this.hTLV=o.getSubjectHex()}else typeof a=="object"&&a.certsubject===void 0&&a.certissuer===void 0&&this.setByObject(a)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var a=0;a<this.paramArray.length;a++){var o={array:this.paramArray[a]};this.sRule!="utf8"&&(o.rule=this.sRule);var c=new i(o);this.asn1Array.push(c)}var u=new r.DERSequence({array:this.asn1Array});return this.hTLV=u.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.X500Name,_.asn1.ASN1Object);_.asn1.x509.X500Name.compatToLDAP=function(e){if(e.substr(0,1)!=="/")throw"malformed input";var t="";e=e.substr(1);var r=e.split("/");return r.reverse(),r=r.map(function(n){return n.replace(/,/,"\\,")}),r.join(",")};_.asn1.x509.X500Name.onelineToLDAP=function(e){return _.asn1.x509.X500Name.compatToLDAP(e)};_.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(r===!0){var a=n.pop(),o=(a+","+s).replace(/\\,/g,",");n.push(o),r=!1}else n.push(s);s.substr(-1,1)==="\\"&&(r=!0)}return n=n.map(function(c){return c.replace("/","\\/")}),n.reverse(),"/"+n.join("/")};_.asn1.x509.X500Name.ldapToOneline=function(e){return _.asn1.x509.X500Name.ldapToCompat(e)};_.asn1.x509.RDN=function(e){_.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=_.asn1.x509.AttributeTypeAndValue;this.setByParam=function(r){r.rule!==void 0&&(this.sRule=r.rule),r.str!==void 0&&this.addByMultiValuedString(r.str),r.array!==void 0&&(this.paramArray=r.array)},this.addByString=function(r){this.asn1Array.push(new _.asn1.x509.AttributeTypeAndValue({str:r,rule:this.sRule}))},this.addByMultiValuedString=function(r){for(var n=_.asn1.x509.RDN.parseString(r),i=0;i<n.length;i++)this.addByString(n[i])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var r=0;r<this.paramArray.length;r++){var n=this.paramArray[r];n.rule!==void 0&&this.sRule!="utf8"&&(n.rule=this.sRule);var i=new t(n);this.asn1Array.push(i)}var s=new _.asn1.DERSet({array:this.asn1Array});return this.TLV=s.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.RDN,_.asn1.ASN1Object);_.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(r===!0){var a=n.pop(),o=(a+"+"+s).replace(/\\\+/g,"+");n.push(o),r=!1}else n.push(s);s.substr(-1,1)==="\\"&&(r=!0)}for(var c=!1,u=[],i=0;n.length>0;i++){var s=n.shift();if(c===!0){var b=u.pop();if(s.match(/"$/)){var o=(b+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");u.push(o),c=!1}else u.push(b+"+"+s)}else u.push(s);s.match(/^[^=]+="/)&&(c=!0)}return u};_.asn1.x509.AttributeTypeAndValue=function(e){_.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=_,r=t.asn1,n=r.DERSequence,i=r.DERUTF8String,s=r.DERPrintableString,a=r.DERTeletexString,o=r.DERIA5String,c=r.DERVisibleString,u=r.DERBMPString,b=t.lang.String.isMail,h=t.lang.String.isPrintable;this.setByParam=function(d){if(d.rule!==void 0&&(this.sRule=d.rule),d.ds!==void 0&&(this.dsType=d.ds),d.value===void 0&&d.str!==void 0){var l=d.str,y=l.match(/^([^=]+)=(.+)$/);if(y)this.sType=y[1],this.sValue=y[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=d.type,this.sValue=d.value},this.setByString=function(d,l){l!==void 0&&(this.sRule=l);var y=d.match(/^([^=]+)=(.+)$/);if(y)this.setByAttrTypeAndValueStr(y[1],y[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var d=this.sType,l=this.sValue,y=this.sRule;return y==="prn"?d=="CN"&&b(l)?"ia5":h(l)?"prn":"utf8":y==="utf8"?d=="CN"&&b(l)?"ia5":d=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(d,l,y){y!==void 0&&(this.sRule=y),this.sType=d,this.sValue=l},this.getValueObj=function(d,l){if(d=="utf8")return new i({str:l});if(d=="prn")return new s({str:l});if(d=="tel")return new a({str:l});if(d=="ia5")return new o({str:l});if(d=="vis")return new c({str:l});if(d=="bmp")return new u({str:l});throw new Error("unsupported directory string type: type="+d+" value="+l)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var d=_.asn1.x509.OID.atype2obj(this.sType),l=this.getValueObj(this.dsType,this.sValue),y=new n({array:[d,l]});return this.TLV=y.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.AttributeTypeAndValue,_.asn1.ASN1Object);_.asn1.x509.SubjectPublicKeyInfo=function(e){_.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=null,r=null,n=_,i=n.asn1,s=i.DERInteger,a=i.DERBitString,o=i.DERObjectIdentifier,c=i.DERSequence,u=i.ASN1Util.newObject,b=i.x509,h=b.AlgorithmIdentifier,d=n.crypto,l=d.ECDSA,y=d.DSA;this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var p=new c({array:[this.asn1AlgId,this.asn1SubjPKey]});return p},this.tohex=function(){var p=this.getASN1Object();return this.hTLV=p.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(p){try{if(p instanceof ve){var m=u({seq:[{int:{bigint:p.n}},{int:{int:p.e}}]}),w=m.tohex();this.asn1AlgId=new h({name:"rsaEncryption"}),this.asn1SubjPKey=new a({hex:"00"+w})}}catch{}try{if(p instanceof _.crypto.ECDSA){var C=new o({name:p.curveName});this.asn1AlgId=new h({name:"ecPublicKey",asn1params:C}),this.asn1SubjPKey=new a({hex:"00"+p.pubKeyHex})}}catch{}try{if(p instanceof _.crypto.DSA){var C=new u({seq:[{int:{bigint:p.p}},{int:{bigint:p.q}},{int:{bigint:p.g}}]});this.asn1AlgId=new h({name:"dsa",asn1params:C});var T=new s({bigint:p.y});this.asn1SubjPKey=new a({hex:"00"+T.tohex()})}}catch{}},e!==void 0&&this.setPubKey(e)};W(_.asn1.x509.SubjectPublicKeyInfo,_.asn1.ASN1Object);_.asn1.x509.Time=function(e){_.asn1.x509.Time.superclass.constructor.call(this);var t=null,r=null,n=_,i=n.asn1,s=i.DERUTCTime,a=i.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(o){this.timeParams=o},this.setByParam=function(o){this.params=o},this.getType=function(o){return o.match(/^[0-9]{12}Z$/)?"utc":o.match(/^[0-9]{14}Z$/)?"gen":o.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":o.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var o=this.params,c=null;if(typeof o=="string"&&(o={str:o}),o!=null&&o.str&&(o.type==null||o.type==null)&&(o.type=this.getType(o.str)),o!=null&&o.str?(o.type=="utc"&&(c=new s(o.str)),o.type=="gen"&&(c=new a(o.str))):this.type=="gen"?c=new a:c=new s,c==null)throw new Error("wrong setting for Time");return this.TLV=c.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};_.asn1.x509.Time_bak=function(e){_.asn1.x509.Time_bak.superclass.constructor.call(this);var t=null,r=null,n=_,i=n.asn1,s=i.DERUTCTime,a=i.DERGeneralizedTime;this.setTimeParams=function(o){this.timeParams=o},this.tohex=function(){var o=null;return this.timeParams!=null?this.type=="utc"?o=new s(this.timeParams):o=new a(this.timeParams):this.type=="utc"?o=new s:o=new a,this.TLV=o.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",e!==void 0&&(e.type!==void 0?this.type=e.type:e.str!==void 0&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)};W(_.asn1.x509.Time,_.asn1.ASN1Object);_.asn1.x509.AlgorithmIdentifier=function(e){_.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=_,r=t.asn1,n=r.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var s=null;for(var a in n)a===this.nameAlg&&(s=n[a]);if(s!==null)return this.hTLV=s,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=r.x509.OID.name2obj(this.nameAlg));var o=[this.asn1Alg];this.asn1Params!==null&&o.push(this.asn1Params);var c=new r.DERSequence({array:o});return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.name!==void 0&&(this.nameAlg=e.name),e.asn1params!==void 0&&(this.asn1Params=e.asn1params),e.paramempty!==void 0&&(this.paramEmpty=e.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var i=this.nameAlg.toLowerCase();i.substr(-7,7)!=="withdsa"&&i.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new r.DERNull)}};W(_.asn1.x509.AlgorithmIdentifier,_.asn1.ASN1Object);_.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};_.asn1.x509.GeneralName=function(e){_.asn1.x509.GeneralName.superclass.constructor.call(this);var t={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87",otherName:"a0"},r=_,n=r.asn1,i=n.x509,s=i.X500Name,a=i.OtherName,o=n.DERIA5String,c=n.DERPrintableString,u=n.DEROctetString,b=n.DERTaggedObject,h=n.ASN1Object,d=Error;this.params=null,this.setByParam=function(l){this.params=l},this.tohex=function(){var l=this.params,y,m,p,m=!1;if(l.other!==void 0)y="a0",p=new a(l.other);else if(l.rfc822!==void 0)y="81",p=new o({str:l.rfc822});else if(l.dns!==void 0)y="82",p=new o({str:l.dns});else if(l.dn!==void 0)y="a4",m=!0,typeof l.dn=="string"?p=new s({str:l.dn}):l.dn instanceof _.asn1.x509.X500Name?p=l.dn:p=new s(l.dn);else if(l.ldapdn!==void 0)y="a4",m=!0,p=new s({ldapstr:l.ldapdn});else if(l.certissuer!==void 0||l.certsubj!==void 0){y="a4",m=!0;var w,C,T=null;if(l.certsubj!==void 0?(w=!1,C=l.certsubj):(w=!0,C=l.certissuer),C.match(/^[0-9A-Fa-f]+$/)&&T==C,C.indexOf("-----BEGIN ")!=-1&&(T=or(C)),T==null)throw new Error("certsubj/certissuer not cert");var q=new ye;q.hex=T;var F;w?F=q.getIssuerHex():F=q.getSubjectHex(),p=new h,p.hTLV=F}else if(l.uri!==void 0)y="86",p=new o({str:l.uri});else if(l.ip!==void 0){y="87";var j,k=l.ip;try{if(k.match(/^[0-9a-f]+$/)){var I=k.length;if(I==8||I==16||I==32||I==64)j=k;else throw"err"}else j=vv(k)}catch(A){throw new d("malformed IP address: "+l.ip+":"+A.message)}p=new u({hex:j})}else throw new d("improper params");var R=new b({tag:y,explicit:m,obj:p});return R.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.GeneralName,_.asn1.ASN1Object);_.asn1.x509.GeneralNames=function(e){_.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=null,r=_,n=r.asn1;this.setByParamArray=function(i){for(var s=0;s<i.length;s++){var a=new n.x509.GeneralName(i[s]);this.asn1Array.push(a)}},this.tohex=function(){var i=new n.DERSequence({array:this.asn1Array});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof e<"u"&&this.setByParamArray(e)};W(_.asn1.x509.GeneralNames,_.asn1.ASN1Object);_.asn1.x509.OtherName=function(e){_.asn1.x509.OtherName.superclass.constructor.call(this);var t=null,r=null,n=_,i=n.asn1,s=i.DERObjectIdentifier,a=i.DERSequence,o=i.ASN1Util.newObject;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params;if(c.oid==null||c.value==null)throw new Error("oid or value not specified");var u=new s({oid:c.oid}),b=o({tag:{tag:"a0",explicit:!0,obj:c.value}}),h=new a({array:[u,b]});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.x509.OtherName,_.asn1.ASN1Object);_.asn1.x509.OID=new function(){var e=_.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(t){if(typeof this.objCache[t]<"u")return this.objCache[t];if(typeof this.name2oidList[t]>"u")throw"Name of ObjectIdentifier not defined: "+t;var r=this.name2oidList[t],n=new e({oid:r});return this.objCache[t]=n,n},this.atype2obj=function(t){if(this.objCache[t]!==void 0)return this.objCache[t];var r;if(t.match(/^\d+\.\d+\.[0-9.]+$/))r=t;else if(this.atype2oidList[t]!==void 0)r=this.atype2oidList[t];else if(this.name2oidList[t]!==void 0)r=this.name2oidList[t];else throw new Error("AttributeType name undefined: "+t);var n=new e({oid:r});return this.objCache[t]=n,n},this.registerOIDs=function(t){if(!!this.checkOIDs(t))for(var r in t)this.name2oidList[r]=t[r]},this.checkOIDs=function(t){try{var r=Object.keys(t);return r.length==0?!1:(r.map(function(n,i,s){var a=this[n];if(!a.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},t),!0)}catch{return!1}}};_.asn1.x509.OID.oid2name=function(e){var t=_.asn1.x509.OID.name2oidList;for(var r in t)if(t[r]==e)return r;return""};_.asn1.x509.OID.oid2atype=function(e){var t=_.asn1.x509.OID.atype2oidList;for(var r in t)if(t[r]==e)return r;return e};_.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=_.asn1.x509.OID.name2oidList;return t[e]===void 0?"":t[e]};_.asn1.x509.X509Util={};_.asn1.x509.X509Util.newCertPEM=function(e){var t=_.asn1.x509,r=t.TBSCertificate,n=t.Certificate,i=new n(e);return i.getPEM()};(typeof _>"u"||!_)&&(_={});(typeof _.asn1>"u"||!_.asn1)&&(_.asn1={});(typeof _.asn1.cms>"u"||!_.asn1.cms)&&(_.asn1.cms={});_.asn1.cms.Attribute=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.DERSet,a=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(o){this.params=o},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.tohex=function(){var o=new a({oid:this.typeOid}),c=new s({array:this.getValueArray()}),u=new i({array:[o,c]});return u.tohex()},this.getEncodedHex=function(){return this.tohex()}};W(_.asn1.cms.Attribute,_.asn1.ASN1Object);_.asn1.cms.ContentType=function(e){var t=_,r=t.asn1;r.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var n=new r.DERObjectIdentifier(this.params.type);return[n]},e!=null&&this.setByParam(e)};W(_.asn1.cms.ContentType,_.asn1.cms.Attribute);_.asn1.cms.MessageDigest=function(e){var t=_,r=t.asn1,n=r.DEROctetString,i=r.cms;i.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var s=new n(this.params);return[s]},e!=null&&this.setByParam(e)};W(_.asn1.cms.MessageDigest,_.asn1.cms.Attribute);_.asn1.cms.SigningTime=function(e){var t=_,r=t.asn1;r.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var n=new r.x509.Time(this.params);return[n]},e!=null&&this.setByParam(e)};W(_.asn1.cms.SigningTime,_.asn1.cms.Attribute);_.asn1.cms.SigningCertificate=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.cms,a=s.ESSCertID,o=r.crypto;s.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var c=this.params.array,u=[],b=0;b<c.length;b++){var h=c[b];e.hasis==!1&&typeof h=="string"&&(h.indexOf("-----BEGIN")!=-1||X.isASN1HEX(h))&&(h={cert:h}),h.hasis!=!1&&e.hasis==!1&&(h.hasis=!1),u.push(new a(h))}var d=new i({array:u}),l=new i({array:[d]});return[l]},e!=null&&this.setByParam(e)};W(_.asn1.cms.SigningCertificate,_.asn1.cms.Attribute);_.asn1.cms.ESSCertID=function(e){_.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,r=_,n=r.asn1,i=n.DEROctetString,s=n.DERSequence,a=n.cms.IssuerSerial;this.params=null,this.getCertHash=function(o,c){if(o.hash!=null)return o.hash;if(typeof o=="string"&&o.indexOf("-----BEGIN")==-1&&!X.isASN1HEX(o))return o;var u;if(typeof o=="string")u=o;else if(o.cert!=null)u=o.cert;else throw new t("hash nor cert unspecified");var b;u.indexOf("-----BEGIN")!=-1?b=or(u):b=u,typeof o=="string"&&(o.indexOf("-----BEGIN")!=-1?b=or(o):X.isASN1HEX(o)&&(b=o));var h;if(o.alg!=null)h=o.alg;else if(c!=null)h=c;else throw new t("hash alg unspecified");return r.crypto.Util.hashHex(b,h)},this.tohex=function(){var o=this.params,c=this.getCertHash(o,"sha1"),u=[];u.push(new i({hex:c})),(typeof o=="string"&&o.indexOf("-----BEGIN")!=-1||o.cert!=null&&o.hasis!=!1||o.issuer!=null&&o.serial!=null)&&u.push(new a(o));var b=new s({array:u});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.ESSCertID,_.asn1.ASN1Object);_.asn1.cms.SigningCertificateV2=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.x509,a=n.cms,o=a.ESSCertIDv2,c=r.crypto;a.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var u=this.params.array,b=[],h=0;h<u.length;h++){var d=u[h];(e.alg!=null||e.hasis==!1)&&typeof d=="string"&&(d.indexOf("-----BEGIN")!=-1||X.isASN1HEX(d))&&(d={cert:d}),d.alg==null&&e.alg!=null&&(d.alg=e.alg),d.hasis!=!1&&e.hasis==!1&&(d.hasis=!1),b.push(new o(d))}var l=new i({array:b}),y=new i({array:[l]});return[y]},e!=null&&this.setByParam(e)};W(_.asn1.cms.SigningCertificateV2,_.asn1.cms.Attribute);_.asn1.cms.ESSCertIDv2=function(e){_.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var t=Error,r=_,n=r.asn1,i=n.DEROctetString,s=n.DERSequence,a=n.cms.IssuerSerial,o=n.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var c=this.params,u=this.getCertHash(c,"sha256"),b=[];c.alg!=null&&c.alg!="sha256"&&b.push(new o({name:c.alg})),b.push(new i({hex:u})),(typeof c=="string"&&c.indexOf("-----BEGIN")!=-1||c.cert!=null&&c.hasis!=!1||c.issuer!=null&&c.serial!=null)&&b.push(new a(c));var h=new s({array:b});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.ESSCertIDv2,_.asn1.cms.ESSCertID);_.asn1.cms.IssuerSerial=function(e){var t=Error,r=_,n=r.asn1,i=n.DERInteger,s=n.DERSequence,a=n.cms,o=n.x509,c=o.GeneralNames,u=ye;a.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(b){this.params=b},this.tohex=function(){var b=this.params,h,d;if(typeof b=="string"&&b.indexOf("-----BEGIN")!=-1||b.cert!=null){var l;b.cert!=null?l=b.cert:l=b;var y=new u;y.readCertPEM(l),h=y.getIssuer(),d={hex:y.getSerialNumberHex()}}else if(b.issuer!=null&&b.serial)h=b.issuer,d=b.serial;else throw new t("cert or issuer and serial parameter not specified");var p=new c([{dn:h}]),m=new i(d),w=new s({array:[p,m]});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.IssuerSerial,_.asn1.ASN1Object);_.asn1.cms.SignerIdentifier=function(e){var t=_,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.cms,a=s.IssuerAndSerialNumber,o=s.SubjectKeyIdentifier,c=r.x509,u=c.X500Name,b=ye,h=Error;s.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params;if(d.type=="isssn"){var l=new a(d);return l.tohex()}else if(d.type=="skid"){var y=new o(d);return y.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.SignerIdentifier,_.asn1.ASN1Object);_.asn1.cms.IssuerAndSerialNumber=function(e){var t=_,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.cms,a=r.x509,o=a.X500Name,c=ye,u=Error;s.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var b=this.params,h,d;if(typeof b=="string"&&b.indexOf("-----BEGIN")!=-1||b.cert!=null){var l;b.cert!=null?l=b.cert:l=b;var y=new c;y.readCertPEM(l),h=y.getIssuer(),d={hex:y.getSerialNumberHex()}}else if(b.issuer!=null&&b.serial)h=b.issuer,d=b.serial;else throw new u("cert or issuer and serial parameter not specified");var p=new o(h),m=new n(d),w=new i({array:[p,m]});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(b){this.params=b},e!=null&&this.setByParam(e)};W(_.asn1.cms.IssuerAndSerialNumber,_.asn1.ASN1Object);_.asn1.cms.SubjectKeyIdentifier=function(e){var t=_,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.ASN1Util.newObject,a=r.cms,o=a.IssuerAndSerialName,c=a.SubjectKeyIdentifier,u=r.x509,b=u.X500Name,h=ye,d=Error;a.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var l=this.params;if(l.cert==null&&l.skid==null)throw new d("property cert nor skid undefined");var y;if(l.cert!=null){var p=new h(l.cert),m=p.getExtSubjectKeyIdentifier();y=m.kid.hex}else l.skid!=null&&(y=l.skid);var w=s({tag:{tage:"a0",obj:{octstr:{hex:y}}}});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.SubjectKeyIdentifier,_.asn1.ASN1Object);_.asn1.cms.AttributeList=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSet,s=n.cms;s.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(this.hTLV!=null)return this.hTLV;var o=!0;a.sortflag!=null&&(o=a.sortflag);for(var c=a.array,u=[],b=0;b<c.length;b++){var h=c[b],d=h.attr;if(d=="contentType")u.push(new s.ContentType(h));else if(d=="messageDigest")u.push(new s.MessageDigest(h));else if(d=="signingTime")u.push(new s.SigningTime(h));else if(d=="signingCertificate")u.push(new s.SigningCertificate(h));else if(d=="signingCertificateV2")u.push(new s.SigningCertificateV2(h));else if(d=="signaturePolicyIdentifier")u.push(new _.asn1.cades.SignaturePolicyIdentifier(h));else if(d=="signatureTimeStamp"||d=="timeStampToken")u.push(new _.asn1.cades.SignatureTimeStamp(h));else throw new t("unknown attr: "+d)}var l=new i({array:u,sortflag:o});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.AttributeList,_.asn1.ASN1Object);_.asn1.cms.SignerInfo=function(e){var t=Error,r=_,n=r.asn1,i=n.DERInteger,s=n.DEROctetString,a=n.DERSequence,o=n.DERTaggedObject,c=n.cms,u=c.SignerIdentifier,b=c.AttributeList,h=c.ContentType,d=c.EncapsulatedContentInfo,l=c.MessageDigest,y=c.SignedData,p=n.x509,m=p.AlgorithmIdentifier,w=r.crypto,C=at;c.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var T=this.params,q=T.sigalg,F=new b(T.sattrs).tohex(),j=C.getKey(T.signkey),k=new w.Signature({alg:q});k.init(j),k.updateHex(F);var I=k.sign();T.sighex=I},this.tohex=function(){var T=this.params,q=[];if(q.push(new i({int:T.version})),q.push(new u(T.id)),q.push(new m({name:T.hashalg})),T.sattrs!=null){var F=new b(T.sattrs);try{q.push(new o({tag:"a0",explicit:!1,obj:F}))}catch(k){throw new t("si sattr error: "+k)}}if(T.sigalgfield!=null?q.push(new m({name:T.sigalgfield})):q.push(new m({name:T.sigalg})),T.sighex==null&&T.signkey!=null&&this.sign(),q.push(new s({hex:T.sighex})),T.uattrs!=null){var F=new b(T.uattrs);try{q.push(new o({tag:"a1",explicit:!1,obj:F}))}catch(I){throw new t("si uattr error: "+I)}}var j=new a({array:q});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.SignerInfo,_.asn1.ASN1Object);_.asn1.cms.EncapsulatedContentInfo=function(e){var t=_,r=t.asn1,n=r.DERTaggedObject,i=r.DERSequence,s=r.DERObjectIdentifier,a=r.DEROctetString,o=r.cms;o.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,u=[];if(u.push(new s(c.type)),c.content!=null&&(c.content.hex!=null||c.content.str!=null)&&c.isDetached!=!0){var b=new a(c.content),h=new n({tag:"a0",explicit:!0,obj:b});u.push(h)}var d=new i({array:u});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},e!=null&&this.setByParam(e)};W(_.asn1.cms.EncapsulatedContentInfo,_.asn1.ASN1Object);_.asn1.cms.ContentInfo=function(e){var t=_,r=t.asn1,n=r.DERTaggedObject,i=r.DERSequence,s=r.DERObjectIdentifier,a=r.x509,o=a.OID.name2obj;_.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,u=[];u.push(new s(c.type));var b=new n({tag:"a0",explicit:!0,obj:c.obj});u.push(b);var h=new i({array:u});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},e!=null&&this.setByParam(e)};W(_.asn1.cms.ContentInfo,_.asn1.ASN1Object);_.asn1.cms.SignedData=function(e){var t=Error,r=_,n=r.asn1,i=n.ASN1Object,s=n.DERInteger,a=n.DERSet,o=n.DERSequence,c=n.DERTaggedObject,u=n.cms,b=u.EncapsulatedContentInfo,h=u.SignerInfo,d=u.ContentInfo,l=u.CertificateSet,y=u.RevocationInfoChoices,p=n.x509,m=p.AlgorithmIdentifier;_.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var w=this.params;this._setDigestAlgs(w),this._setContentTypeByEContent(w),this._setMessageDigestByEContent(w),this._setSignerInfoVersion(w),this._setSignedDataVersion(w)},this._setDigestAlgs=function(w){for(var C={},T=w.sinfos,q=0;q<T.length;q++){var F=T[q];C[F.hashalg]=1}w.hashalgs=Object.keys(C).sort()},this._setContentTypeByEContent=function(w){for(var C=w.econtent.type,T=w.sinfos,q=0;q<T.length;q++){var F=T[q],j=this._getAttrParamByName(F,"contentType");j.type=C}},this._setMessageDigestByEContent=function(w){var C=w.econtent,T=w.econtent.type,q=C.content.hex;q==null&&C.type=="data"&&C.content.str!=null&&(q=Ui(C.content.str));for(var F=w.sinfos,j=0;j<F.length;j++){var k=F[j],I=k.hashalg,R=this._getAttrParamByName(k,"messageDigest"),A=_.crypto.Util.hashHex(q,I);R.hex=A}},this._getAttrParamByName=function(w,C){for(var T=w.sattrs.array,q=0;q<T.length;q++)if(T[q].attr==C)return T[q]},this._setSignerInfoVersion=function(w){for(var C=w.sinfos,T=0;T<C.length;T++){var q=C[T],F=1;q.id.type=="skid"&&(F=3),q.version=F}},this._setSignedDataVersion=function(w){var C=this._getSignedDataVersion(w);w.version=C},this._getSignedDataVersion=function(w){if(w.revinfos!=null)for(var C=w.revinfos,T=0;T<C.length;T++){var q=C[T];if(q.ocsp!=null)return 5}for(var F=w.sinfos,T=0;T<F.length;T++){var j=w.sinfos[T];if(j.version==3)return 3}return w.econtent.type!="data"?3:1},this.tohex=function(){var w=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),w.fixed!=!0&&this.checkAndFixParam();var C=[];C.push(new s({int:w.version}));for(var T=[],q=0;q<w.hashalgs.length;q++){var F=w.hashalgs[q];T.push(new m({name:F}))}C.push(new a({array:T})),C.push(new b(w.econtent)),w.certs!=null&&C.push(new l(w.certs)),w.revinfos!=null&&C.push(new y(w.revinfos));for(var j=[],q=0;q<w.sinfos.length;q++){var k=w.sinfos[q];j.push(new h(k))}C.push(new a({array:j}));var I=new o({array:C});return I.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var w=new d({type:"signed-data",obj:this});return w},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.SignedData,_.asn1.ASN1Object);_.asn1.cms.CertificateSet=function(e){_.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,r=_.asn1,n=r.DERTaggedObject,i=r.DERSet,s=r.ASN1Object;this.params=null,this.tohex=function(){var a=this.params,o=[],c;if(a instanceof Array)c=a;else if(a.array!=null)c=a.array;else throw new t("cert array not specified");for(var u=0;u<c.length;u++){var b=c[u],h=or(b),d=new s;d.hTLV=h,o.push(d)}var l={array:o};a.sortflag==!1&&(l.sortflag=!1);var y=new i(l),p=new n({tag:"a0",explicit:!1,obj:y});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.CertificateSet,_.asn1.ASN1Object);_.asn1.cms.RevocationInfoChoices=function(e){_.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(!t instanceof Array)throw new Error("params is not array");for(var r=[],n=0;n<t.length;n++)r.push(new _.asn1.cms.RevocationInfoChoice(t[n]));var i=_.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:r}}});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.RevocationInfoChoices,_.asn1.ASN1Object);_.asn1.cms.RevocationInfoChoice=function(e){_.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.crl!=null&&typeof t.crl=="string"){var r=t.crl;return t.crl.indexOf("-----BEGIN")!=-1&&(r=or(t.crl)),r}else if(t.ocsp!=null){var n=_.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new _.asn1.cms.OtherRevocationFormat(t)}});return n.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.RevocationInfoChoice,_.asn1.ASN1Object);_.asn1.cms.OtherRevocationFormat=function(e){_.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,r=_,n=r.asn1,i=n.ASN1Util.newObject,s=r.lang.String.isHex;this.params=null,this.tohex=function(){var a=this.params;if(a.ocsp==null)throw new t("property ocsp not specified");if(!s(a.ocsp)||!X.isASN1HEX(a.ocsp))throw new t("ocsp value not ASN.1 hex string");var o=i({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:a.ocsp}}]});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cms.OtherRevocationFormat,_.asn1.ASN1Object);_.asn1.cms.CMSUtil=new function(){};_.asn1.cms.CMSUtil.newSignedData=function(e){return new _.asn1.cms.SignedData(e)};_.asn1.cms.CMSUtil.verifySignedData=function(e){var t=_,r=t.asn1,n=r.cms,i=n.SignerInfo,s=n.SignedData,a=n.SigningTime,o=n.SigningCertificate,c=n.SigningCertificateV2,u=r.cades,b=u.SignaturePolicyIdentifier,h=t.lang.String.isHex,d=X,l=d.getVbyList,y=d.getTLVbyList,p=d.getIdxbyList,m=d.getChildIdx,w=d.getTLV,C=d.oidname,T=t.crypto.Util.hashHex;e.cms===void 0&&h(e.cms);var q=e.cms,F=function(S,P){for(var O,B=3;B<6;B++)if(O=p(S,0,[1,0,B]),O!==void 0){var v=S.substr(O,2);v==="a0"&&(P.certsIdx=O),v==="a1"&&(P.revinfosIdx=O),v==="31"&&(P.signerinfosIdx=O)}},j=function(S,P){var O=P.signerinfosIdx;if(O!==void 0){var B=m(S,O);P.signerInfoIdxList=B;for(var v=0;v<B.length;v++){var M=B[v],V={idx:M};k(S,V),P.signerInfos.push(V)}}},k=function(S,P){var O=P.idx;P.signerid_issuer1=y(S,O,[1,0],"30"),P.signerid_serial1=l(S,O,[1,1],"02"),P.hashalg=C(l(S,O,[2,0],"06"));var B=p(S,O,[3],"a0");P.idxSignedAttrs=B,I(S,P,B);var v=m(S,O),M=v.length;if(M<6)throw"malformed SignerInfo";P.sigalg=C(l(S,O,[M-2,0],"06")),P.sigval=l(S,O,[M-1],"04")},I=function(S,P,O){var B=m(S,O);P.signedAttrIdxList=B;for(var v=0;v<B.length;v++){var M=B[v],V=l(S,M,[0],"06"),z;V==="2a864886f70d010905"?(z=It(l(S,M,[1,0])),P.saSigningTime=z):V==="2a864886f70d010904"&&(z=l(S,M,[1,0],"04"),P.saMessageDigest=z)}},R=function(S,P){if(l(S,0,[0],"06")!=="2a864886f70d010702")return P;P.cmsType="signedData",P.econtent=l(S,0,[1,0,2,1,0]),F(S,P),P.signerInfos=[],j(S,P)},A=function(S,P){for(var O=P.parse.signerInfos,B=O.length,v=!0,M=0;M<B;M++){var V=O[M];g(S,P,V,M),V.isValid||(v=!1)}P.isValid=v},f=function(S,P,O,B){var v=P.parse.certsIdx,M;if(P.certs===void 0){M=[],P.certkeys=[];for(var V=m(S,v),z=0;z<V.length;z++){var $=w(S,V[z]),G=new ye;G.readCertHex($),M[z]=G,P.certkeys[z]=G.getPublicKey()}P.certs=M}else M=P.certs;P.cccc=M.length,P.cccci=V.length;for(var z=0;z<M.length;z++){var Q=G.getIssuerHex(),re=G.getSerialNumberHex();O.signerid_issuer1===Q&&O.signerid_serial1===re&&(O.certkey_idx=z)}},g=function(S,P,O,B){O.verifyDetail={};var v=O.verifyDetail,M=P.parse.econtent,V=O.hashalg,z=O.saMessageDigest;v.validMessageDigest=!1,T(M,V)===z&&(v.validMessageDigest=!0),f(S,P,O,B),v.validSignatureValue=!1;var $=O.sigalg,G="31"+w(S,O.idxSignedAttrs).substr(2);O.signedattrshex=G;var Q=P.certs[O.certkey_idx].getPublicKey(),re=new _.crypto.Signature({alg:$});re.init(Q),re.updateHex(G);var me=re.verify(O.sigval);v.validSignatureValue_isValid=me,me===!0&&(v.validSignatureValue=!0),O.isValid=!1,v.validMessageDigest&&v.validSignatureValue&&(O.isValid=!0)},E=function(){},x={isValid:!1,parse:{}};return R(q,x.parse),A(q,x),x};_.asn1.cms.CMSParser=function(){var e=Error,t=ye,r=new t,n=X,i=n.getV,s=n.getTLV,a=n.getIdxbyList,o=n.getTLVbyList,c=n.getTLVbyListEx,u=n.getVbyList,b=n.getVbyListEx,h=n.getChildIdx;this.getCMSSignedData=function(d){var l=o(d,0,[1,0]),y=this.getSignedData(l);return y},this.getSignedData=function(d){var l=h(d,0),y={},p=i(d,l[0]),m=parseInt(p,16);y.version=m;var w=s(d,l[1]);y.hashalgs=this.getHashAlgArray(w);var C=s(d,l[2]);y.econtent=this.getEContent(C);var T=c(d,0,["[0]"]);T!=null&&(y.certs=this.getCertificateSet(T));var q=c(d,0,["[1]"]);q!=null;var F=c(d,0,[3]);return y.sinfos=this.getSignerInfos(F),y},this.getHashAlgArray=function(d){for(var l=h(d,0),y=new t,p=[],m=0;m<l.length;m++){var w=s(d,l[m]),C=y.getAlgorithmIdentifierName(w);p.push(C)}return p},this.getEContent=function(d){var l={},y=u(d,0,[0]),p=u(d,0,[1,0]);return l.type=_.asn1.x509.OID.oid2name(X.hextooidstr(y)),l.content={hex:p},l},this.getSignerInfos=function(d){for(var l=[],y=h(d,0),p=0;p<y.length;p++){var m=s(d,y[p]),w=this.getSignerInfo(m);l.push(w)}return l},this.getSignerInfo=function(d){var l={},y=h(d,0),p=n.getInt(d,y[0],-1);p!=-1&&(l.version=p);var m=s(d,y[1]),w=this.getIssuerAndSerialNumber(m);l.id=w;var C=s(d,y[2]),T=r.getAlgorithmIdentifierName(C);l.hashalg=T;var q=c(d,0,["[0]"]);if(q!=null){var F=this.getAttributeList(q);l.sattrs=F}var j=c(d,0,[3]),k=r.getAlgorithmIdentifierName(j);l.sigalg=k;var I=b(d,0,[4]);l.sighex=I;var R=c(d,0,["[1]"]);if(R!=null){var A=this.getAttributeList(R);l.uattrs=A}return l},this.getSignerIdentifier=function(d){if(d.substr(0,2)=="30")return this.getIssuerAndSerialNumber(d);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(d){var l={type:"isssn"},y=h(d,0),p=s(d,y[0]);l.issuer=r.getX500Name(p);var m=i(d,y[1]);return l.serial={hex:m},l},this.getAttributeList=function(d){for(var l=[],y=h(d,0),p=0;p<y.length;p++){var m=s(d,y[p]),w=this.getAttribute(m);l.push(w)}return{array:l}},this.getAttribute=function(d){var l={},y=h(d,0),p=n.getOID(d,y[0]),m=_.asn1.x509.OID.oid2name(p);l.attr=m;var w=s(d,y[1]),C=h(w,0);if(C.length==1)l.valhex=s(w,C[0]);else{for(var T=[],q=0;q<C.length;q++)T.push(s(w,C[q]));l.valhex=T}return m=="contentType"?this.setContentType(l):m=="messageDigest"?this.setMessageDigest(l):m=="signingTime"?this.setSigningTime(l):m=="signingCertificate"?this.setSigningCertificate(l):m=="signingCertificateV2"?this.setSigningCertificateV2(l):m=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(l),l},this.setContentType=function(d){var l=n.getOIDName(d.valhex,0,null);l!=null&&(d.type=l,delete d.valhex)},this.setSigningTime=function(d){var l=i(d.valhex,0),y=It(l);d.str=y,delete d.valhex},this.setMessageDigest=function(d){var l=i(d.valhex,0);d.hex=l,delete d.valhex},this.setSigningCertificate=function(d){var l=h(d.valhex,0);if(l.length>0){for(var y=s(d.valhex,l[0]),p=h(y,0),m=[],w=0;w<p.length;w++){var C=s(y,p[w]),T=this.getESSCertID(C);m.push(T)}d.array=m}if(l.length>1){var q=s(d.valhex,l[1]);d.polhex=q}delete d.valhex},this.setSignaturePolicyIdentifier=function(d){var l=h(d.valhex,0);if(l.length>0){var y=n.getOID(d.valhex,l[0]);d.oid=y}if(l.length>1){var p=new t,m=h(d.valhex,l[1]),w=s(d.valhex,m[0]),C=p.getAlgorithmIdentifierName(w);d.alg=C;var T=i(d.valhex,m[1]);d.hash=T}delete d.valhex},this.setSigningCertificateV2=function(d){var l=h(d.valhex,0);if(l.length>0){for(var y=s(d.valhex,l[0]),p=h(y,0),m=[],w=0;w<p.length;w++){var C=s(y,p[w]),T=this.getESSCertIDv2(C);m.push(T)}d.array=m}if(l.length>1){var q=s(d.valhex,l[1]);d.polhex=q}delete d.valhex},this.getESSCertID=function(d){var l={},y=h(d,0);if(y.length>0){var p=i(d,y[0]);l.hash=p}if(y.length>1){var m=s(d,y[1]),w=this.getIssuerSerial(m);w.serial!=null&&(l.serial=w.serial),w.issuer!=null&&(l.issuer=w.issuer)}return l},this.getESSCertIDv2=function(d){var l={},y=h(d,0);if(y.length<1||3<y.length)throw new e("wrong number of elements");var p=0;if(d.substr(y[0],2)=="30"){var m=s(d,y[0]);l.alg=r.getAlgorithmIdentifierName(m),p++}else l.alg="sha256";var w=i(d,y[p]);if(l.hash=w,y.length>p+1){var C=s(d,y[p+1]),T=this.getIssuerSerial(C);l.issuer=T.issuer,l.serial=T.serial}return l},this.getIssuerSerial=function(d){var l={},y=h(d,0),p=s(d,y[0]),m=r.getGeneralNames(p),w=m[0].dn;l.issuer=w;var C=i(d,y[1]);return l.serial={hex:C},l},this.getCertificateSet=function(d){for(var l=h(d,0),y=[],p=0;p<l.length;p++){var m=s(d,l[p]);if(m.substr(0,2)=="30"){var w=Fn(m,"CERTIFICATE");y.push(w)}}return{array:y,sortflag:!1}}};(typeof _>"u"||!_)&&(_={});(typeof _.asn1>"u"||!_.asn1)&&(_.asn1={});(typeof _.asn1.tsp>"u"||!_.asn1.tsp)&&(_.asn1.tsp={});_.asn1.tsp.TimeStampToken=function(e){var t=_,r=t.asn1,n=r.tsp;n.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var i=new n.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=i.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.TimeStampToken,_.asn1.cms.SignedData);_.asn1.tsp.TSTInfo=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.DERInteger,a=n.DERBoolean,o=n.DERGeneralizedTime,c=n.DERObjectIdentifier,u=n.DERTaggedObject,b=n.tsp,h=b.MessageImprint,d=b.Accuracy,l=n.x509.X500Name,y=n.x509.GeneralName;if(b.TSTInfo.superclass.constructor.call(this),this.dVersion=new s({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var p=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(p.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(p.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(p.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");p.push(this.dGenTime),this.dAccuracy!=null&&p.push(this.dAccuracy),this.dOrdering!=null&&p.push(this.dOrdering),this.dNonce!=null&&p.push(this.dNonce),this.dTsa!=null&&p.push(this.dTsa);var m=new i({array:p});return this.hTLV=m.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0){if(typeof e.policy=="string"){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new c({oid:e.policy})}e.messageImprint!==void 0&&(this.dMessageImprint=new h(e.messageImprint)),e.serial!==void 0&&(this.dSerial=new s(e.serial)),e.genTime!==void 0&&(this.dGenTime=new o(e.genTime)),e.accuracy!==void 0&&(this.dAccuracy=new d(e.accuracy)),e.ordering!==void 0&&e.ordering==!0&&(this.dOrdering=new a),e.nonce!==void 0&&(this.dNonce=new s(e.nonce)),e.tsa!==void 0&&(this.dTsa=new u({tag:"a0",explicit:!0,obj:new y({dn:e.tsa})}))}};W(_.asn1.tsp.TSTInfo,_.asn1.ASN1Object);_.asn1.tsp.Accuracy=function(e){var t=_,r=t.asn1,n=r.ASN1Util.newObject;r.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params,s=[];return i.seconds!=null&&typeof i.seconds=="number"&&s.push({int:i.seconds}),i.millis!=null&&typeof i.millis=="number"&&s.push({tag:{tagi:"80",obj:{int:i.millis}}}),i.micros!=null&&typeof i.micros=="number"&&s.push({tag:{tagi:"81",obj:{int:i.micros}}}),n({seq:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.Accuracy,_.asn1.ASN1Object);_.asn1.tsp.MessageImprint=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.DEROctetString,s=r.x509,a=s.AlgorithmIdentifier;r.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var o=this.params,c=new a({name:o.alg}),u=new i({hex:o.hash}),b=new n({array:[c,u]});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.tsp.MessageImprint,_.asn1.ASN1Object);_.asn1.tsp.TimeStampReq=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.DERInteger,s=r.DERBoolean,a=r.ASN1Object,o=r.DERObjectIdentifier,c=r.tsp,u=c.MessageImprint;c.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var b=this.params,h=[];h.push(new i({int:1})),b.messageImprint instanceof _.asn1.ASN1Object?h.push(b.messageImprint):h.push(new u(b.messageImprint)),b.policy!=null&&h.push(new o(b.policy)),b.nonce!=null&&h.push(new i(b.nonce)),b.certreq==!0&&h.push(new s);var d=new n({array:h});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.TimeStampReq,_.asn1.ASN1Object);_.asn1.tsp.TimeStampResp=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.ASN1Object,s=r.tsp,a=s.PKIStatusInfo;s.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var o=this.params,c=[];if(o.econtent!=null||o.tst!=null)if(o.statusinfo!=null?c.push(new a(o.statusinfo)):c.push(new a("granted")),o.econtent!=null)c.push(new s.TimeStampToken(o).getContentInfo());else if(o.tst instanceof r.ASN1Object)c.push(o.tst);else throw new Error("improper member tst value");else if(o.statusinfo!=null)c.push(new a(o.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var u=new n({array:c});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.TimeStampResp,_.asn1.ASN1Object);_.asn1.tsp.PKIStatusInfo=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.tsp,a=s.PKIStatus,o=s.PKIFreeText,c=s.PKIFailureInfo;s.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params,b=[];if(typeof u=="string")b.push(new a(u));else{if(u.status==null)throw new t("property 'status' unspecified");b.push(new a(u.status)),u.statusstr!=null&&b.push(new o(u.statusstr)),u.failinfo!=null&&b.push(new c(u.failinfo))}var h=new i({array:b});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.PKIStatusInfo,_.asn1.ASN1Object);_.asn1.tsp.PKIStatus=function(e){var t=Error,r=_,n=r.asn1,i=n.DERInteger,s=n.tsp;s.PKIStatus.superclass.constructor.call(this);var a={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var o=this.params,c,u;if(typeof o=="string")try{u=a[o]}catch{throw new t("undefined name: "+o)}else if(typeof o=="number")u=o;else throw new t("unsupported params");return new i({int:u}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.PKIStatus,_.asn1.ASN1Object);_.asn1.tsp.PKIFreeText=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.DERUTF8String,a=n.tsp;a.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var o=this.params;if(!o instanceof Array)throw new t("wrong params: not array");for(var c=[],u=0;u<o.length;u++)c.push(new s({str:o[u]}));var b=new i({array:c});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.PKIFreeText,_.asn1.ASN1Object);_.asn1.tsp.PKIFailureInfo=function(e){var t=Error,r=_,n=r.asn1,i=n.DERBitString,s=n.tsp,a=s.PKIFailureInfo,o={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};a.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var c=this.params,u=0;if(typeof c=="number"&&0<=c&&c<=25){u|=1<<c;for(var b=u.toString(2),h="",d=b.length-1;d>=0;d--)h+=b[d];return h}else{if(typeof c=="string"&&o[c]!=null)return j1([c],o);if(typeof c=="object"&&c.length!=null)return j1(c,o);throw new t("wrong params")}},this.tohex=function(){var c=this.params,u=this.getBinValue();return new i({bin:u}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.tsp.PKIFailureInfo,_.asn1.ASN1Object);_.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(t,r){throw"not implemented yet"}};_.asn1.tsp.SimpleTSAAdapter=function(e){var t=_,r=t.asn1,n=r.tsp,i=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(s,a){var o=i(s,a);this.params.econtent.content.messageImprint={alg:a,hash:o},this.params.econtent.content.serial={int:this.serial++};var c=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:c};var u=new n.TimeStampToken(this.params);return u.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};W(_.asn1.tsp.SimpleTSAAdapter,_.asn1.tsp.AbstractTSAAdapter);_.asn1.tsp.FixedTSAAdapter=function(e){var t=_,r=t.asn1,n=r.tsp,i=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(s,a){var o=i(s,a);this.params.econtent.content.messageImprint={alg:a,hash:o};var c=new n.TimeStampToken(this.params);return c.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};W(_.asn1.tsp.FixedTSAAdapter,_.asn1.tsp.AbstractTSAAdapter);_.asn1.tsp.TSPUtil=new function(){};_.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new _.asn1.tsp.TimeStampToken(e)};_.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=new _.asn1.tsp.TSPParser;return t.getTimeStampReq(e)};_.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=new _.asn1.tsp.TSPParser;return t.getMessageImprint(e)};_.asn1.tsp.TSPParser=function(){var e=Error,t=ye,r=new t,n=X,i=n.getV,s=n.getTLV,a=n.getIdxbyList,o=n.getTLVbyListEx,c=n.getChildIdx,u=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],b={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(h){var d=c(h,0);if(d.length==1)return this.getPKIStatusInfo(s(h,d[0]));if(d.length>1){var l=this.getPKIStatusInfo(s(h,d[0])),y=s(h,d[1]),p=this.getToken(y);return p.statusinfo=l,p}},this.getToken=function(h){var d=new _.asn1.cms.CMSParser,l=d.getCMSSignedData(h);return this.setTSTInfo(l),l},this.setTSTInfo=function(h){var d=h.econtent;if(d.type=="tstinfo"){var l=d.content.hex,y=this.getTSTInfo(l);d.content=y}},this.getTSTInfo=function(h){var d={},l=c(h,0),y=i(h,l[1]);d.policy=W1(y);var p=s(h,l[2]);d.messageImprint=this.getMessageImprint(p);var m=i(h,l[3]);d.serial={hex:m};var w=i(h,l[4]);d.genTime={str:It(w)};var C=0;if(l.length>5&&h.substr(l[5],2)=="30"){var T=s(h,l[5]);d.accuracy=this.getAccuracy(T),C++}if(l.length>5+C&&h.substr(l[5+C],2)=="01"){var q=i(h,l[5+C]);q=="ff"&&(d.ordering=!0),C++}if(l.length>5+C&&h.substr(l[5+C],2)=="02"){var F=i(h,l[5+C]);d.nonce={hex:F},C++}if(l.length>5+C&&h.substr(l[5+C],2)=="a0"){var j=s(h,l[5+C]);j="30"+j.substr(2),pGeneralNames=r.getGeneralNames(j);var k=pGeneralNames[0].dn;d.tsa=k,C++}if(l.length>5+C&&h.substr(l[5+C],2)=="a1"){var I=s(h,l[5+C]);I="30"+I.substr(2);var R=r.getExtParamArray(I);d.ext=R,C++}return d},this.getAccuracy=function(h){for(var d={},l=c(h,0),y=0;y<l.length;y++){var p=h.substr(l[y],2),m=i(h,l[y]),w=parseInt(m,16);p=="02"?d.seconds=w:p=="80"?d.millis=w:p=="81"&&(d.micros=w)}return d},this.getMessageImprint=function(h){if(h.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var d={},l=c(h,0),y=a(h,0,[0,0]),p=i(h,y),m=n.hextooidstr(p),w=_.asn1.x509.OID.oid2name(m);if(w=="")throw new Error("hashAlg name undefined: "+m);var C=w,T=a(h,0,[1]);return d.alg=C,d.hash=i(h,T),d},this.getPKIStatusInfo=function(h){var d={},l=c(h,0),y=0;try{var p=i(h,l[0]),m=parseInt(p,16);d.status=u[m]}catch{}if(l.length>1&&h.substr(l[1],2)=="30"){var w=s(h,l[1]);d.statusstr=this.getPKIFreeText(w),y++}if(l.length>y&&h.substr(l[1+y],2)=="03"){var C=s(h,l[1+y]);d.failinfo=this.getPKIFailureInfo(C)}return d},this.getPKIFreeText=function(h){for(var d=[],l=c(h,0),y=0;y<l.length;y++)d.push(n.getString(h,l[y]));return d},this.getPKIFailureInfo=function(h){var d=n.getInt(h,0);return b[d]!=null?b[d]:d},this.getTimeStampReq=function(h){var d={};d.certreq=!1;var l=c(h,0);if(l.length<2)throw new Error("TimeStampReq must have at least 2 items");var y=s(h,l[1]);d.messageImprint=_.asn1.tsp.TSPUtil.parseMessageImprint(y);for(var p=2;p<l.length;p++){var m=l[p],w=h.substr(m,2);if(w=="06"){var C=i(h,m);d.policy=n.hextooidstr(C)}w=="02"&&(d.nonce=i(h,m)),w=="01"&&(d.certreq=!0)}return d}};(typeof _>"u"||!_)&&(_={});(typeof _.asn1>"u"||!_.asn1)&&(_.asn1={});(typeof _.asn1.cades>"u"||!_.asn1.cades)&&(_.asn1.cades={});_.asn1.cades.SignaturePolicyIdentifier=function(e){var t=_,r=t.asn1,n=r.cades,i=n.SignaturePolicyId;n.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new i(this.params)]},this.setByParam=function(s){this.params=s},e!=null&&this.setByParam(e)};W(_.asn1.cades.SignaturePolicyIdentifier,_.asn1.cms.Attribute);_.asn1.cades.SignaturePolicyId=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.DERObjectIdentifier,s=r.x509,a=s.AlgorithmIdentifier,o=r.cades,c=o.SignaturePolicyId,u=o.OtherHashAlgAndValue;c.superclass.constructor.call(this),this.params=null,this.tohex=function(){var b=this.params,h=[];h.push(new i(b.oid)),h.push(new u(b));var d=new n({array:h});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(b){this.params=b},e!=null&&this.setByParam(e)};W(_.asn1.cades.SignaturePolicyId,_.asn1.ASN1Object);_.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.DEROctetString,a=n.x509,o=a.AlgorithmIdentifier,c=n.cades,u=c.OtherHashAlgAndValue;u.superclass.constructor.call(this),this.params=null,this.tohex=function(){var b=this.params;if(b.alg==null)throw new t("property 'alg' not specified");if(b.hash==null&&b.cert==null)throw new t("property 'hash' nor 'cert' not specified");var h=null;if(b.hash!=null)h=b.hash;else if(b.cert!=null){if(typeof b.cert!="string")throw new t("cert not string");var d=b.cert;b.cert.indexOf("-----BEGIN")!=-1&&(d=or(b.cert)),h=_.crypto.Util.hashHex(d,b.alg)}var l=[];l.push(new o({name:b.alg})),l.push(new s({hex:h}));var y=new i({array:l});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cades.OtherHashAlgAndValue,_.asn1.ASN1Object);_.asn1.cades.OtherHashValue=function(e){_.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,r=_,n=r.lang.String.isHex,i=r.asn1,s=i.DEROctetString,a=r.crypto.Util.hashHex;this.params=null,this.tohex=function(){var o=this.params;if(o.hash==null&&o.cert==null)throw new t("hash or cert not specified");var c=null;if(o.hash!=null)c=o.hash;else if(o.cert!=null){if(typeof o.cert!="string")throw new t("cert not string");var u=o.cert;o.cert.indexOf("-----BEGIN")!=-1&&(u=or(o.cert)),c=_.crypto.Util.hashHex(u,"sha1")}return new s({hex:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cades.OtherHashValue,_.asn1.ASN1Object);_.asn1.cades.SignatureTimeStamp=function(e){var t=Error,r=_,n=r.lang.String.isHex,i=r.asn1,s=i.ASN1Object,a=i.x509,o=i.cades;o.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var c=this.params;if(c.tst!=null)if(n(c.tst)){var u=new s;return u.hTLV=c.tst,[u]}else{if(c.tst instanceof s)return[c.tst];throw new t("params.tst has wrong value")}else if(c.res!=null){var b=c.res;if(b instanceof s&&(b=b.tohex()),typeof b!="string"||!n(b))throw new t("params.res has wrong value");var h=X.getTLVbyList(b,0,[1]),u=new s;return u.hTLV=c.tst,[u]}},e!=null&&this.setByParam(e)};W(_.asn1.cades.SignatureTimeStamp,_.asn1.cms.Attribute);_.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.cades,a=s.OtherCertID,o=r.lang.String.isHex;s.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var c=this.params,u=[],b=0;b<c.array.length;b++){var h=c.array[b];if(typeof h=="string")if(h.indexOf("-----BEGIN")!=-1)h={cert:h};else if(o(h))h={hash:h};else throw new t("unsupported value: "+h);c.alg!=null&&h.alg==null&&(h.alg=c.alg),c.hasis!=null&&h.hasis==null&&(h.hasis=c.hasis);var d=new a(h);u.push(d)}var l=new i({array:u});return[l]},e!=null&&this.setByParam(e)};W(_.asn1.cades.CompleteCertificateRefs,_.asn1.cms.Attribute);_.asn1.cades.OtherCertID=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.cms,s=i.IssuerSerial,a=r.cades,o=a.OtherHashValue,c=a.OtherHashAlgAndValue;a.OtherCertID.superclass.constructor.call(this),this.params=e,this.tohex=function(){var u=this.params;typeof u=="string"&&(u.indexOf("-----BEGIN")!=-1?u={cert:u}:_isHex(u)&&(u={hash:u}));var b=[],h=null;if(u.alg!=null?h=new c(u):h=new o(u),b.push(h),u.cert!=null&&u.hasis==!0||u.issuer!=null&&u.serial!=null){var d=new s(u);b.push(d)}var l=new n({array:b});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cades.OtherCertID,_.asn1.ASN1Object);_.asn1.cades.OtherHash=function(e){var t=Error,r=_,n=r.asn1,i=n.cms,s=n.cades,a=s.OtherHashAlgAndValue,o=s.OtherHashValue,c=r.crypto.Util.hashHex,u=r.lang.String.isHex;s.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var b=this.params;typeof b=="string"&&(b.indexOf("-----BEGIN")!=-1?b={cert:b}:u(b)&&(b={hash:b}));var h=null;return b.alg!=null?h=new a(b):h=new o(b),h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};W(_.asn1.cades.OtherHash,_.asn1.ASN1Object);_.asn1.cades.CAdESUtil=new function(){};_.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){var t=new _.asn1.cms.CMSParser,r=t.getCMSSignedData(e);return r};_.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,r){var n=X,i=n.getChildIdx,s=n.getTLV,a=n.getV,o=_,c=o.asn1,u=c.ASN1Object,b=c.cms,h=b.AttributeList,d=b.SignerInfo,l={},y=i(e,t);if(y.length!=6)throw"not supported items for SignerInfo (!=6)";var p=y.shift();l.version=s(e,p);var m=y.shift();l.si=s(e,m);var w=y.shift();l.digalg=s(e,w);var C=y.shift();l.sattrs=s(e,C);var T=y.shift();l.sigalg=s(e,T);var q=y.shift();l.sig=s(e,q),l.sigval=a(e,q);var F=null;return l.obj=new d,F=new u,F.hTLV=l.version,l.obj.dCMSVersion=F,F=new u,F.hTLV=l.si,l.obj.dSignerIdentifier=F,F=new u,F.hTLV=l.digalg,l.obj.dDigestAlgorithm=F,F=new u,F.hTLV=l.sattrs,l.obj.dSignedAttrs=F,F=new u,F.hTLV=l.sigalg,l.obj.dSigAlg=F,F=new u,F.hTLV=l.sig,l.obj.dSig=F,l.obj.dUnsignedAttrs=new h,l};(typeof _.asn1.csr>"u"||!_.asn1.csr)&&(_.asn1.csr={});_.asn1.csr.CertificationRequest=function(e){var t=_,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.csr,a=r.x509,o=s.CertificationRequestInfo;s.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(c){this.params=c},this.sign=function(){var c=new o(this.params).tohex(),u=new _.crypto.Signature({alg:this.params.sigalg});u.init(this.params.sbjprvkey),u.updateHex(c);var b=u.sign();this.params.sighex=b},this.getPEM=function(){return Fn(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var c=this.params,u=new _.asn1.csr.CertificationRequestInfo(this.params),b=new _.asn1.x509.AlgorithmIdentifier({name:c.sigalg});if(c.sighex==null&&c.sbjprvkey!=null&&this.sign(),c.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var h=new n({hex:"00"+c.sighex}),d=new i({array:[u,b,h]});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.csr.CertificationRequest,_.asn1.ASN1Object);_.asn1.csr.CertificationRequestInfo=function(e){var t=_,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.DERInteger,a=r.DERUTF8String,o=r.DERTaggedObject,c=r.ASN1Util.newObject,u=r.csr,b=r.x509,h=b.X500Name,d=b.Extensions,l=b.SubjectPublicKeyInfo,y=u.AttributeList;u.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(m){m!=null&&(this.params=m)},this.tohex=function(){var m=this.params,w=[];if(w.push(new s({int:0})),w.push(new h(m.subject)),w.push(new l(at.getKey(m.sbjpubkey))),m.attrs!=null){var C=p(m.attrs),T=c({tag:{tage:"a0",obj:C}});w.push(T)}else if(m.extreq!=null){var q=new d(m.extreq),T=c({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[q]}]}}});w.push(T)}else w.push(new o({tag:"a0",explicit:!1,obj:new a({str:""})}));var F=new i({array:w});return F.tohex()},this.getEncodedHex=function(){return this.tohex()};function p(m){for(var w=Error,C=_.asn1.x509.Extensions,T=[],q=0;q<m.length;q++){var F=m[q],j=F.attr;if(j=="extensionRequest"){var k=new C(F.ext),I={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[k]}]};T.push(I)}else if(j=="unstructuredName"){var I={seq:[{oid:"1.2.840.113549.1.9.2"},{set:F.names}]};T.push(I)}else if(j=="challengePassword"){var I={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:F.password}]}]};T.push(I)}else throw new w("unknown CSR attribute")}return{set:T}}e!=null&&this.setByParam(e)};W(_.asn1.csr.CertificationRequestInfo,_.asn1.ASN1Object);_.asn1.csr.AttributeList=function(e){function t(r){}};W(_.asn1.csr.AttributeList,_.asn1.ASN1Object);_.asn1.csr.CSRUtil=new function(){};_.asn1.csr.CSRUtil.newCSRPEM=function(e){var t=at,r=_.asn1.csr,n=new r.CertificationRequest(e),i=n.getPEM();return i};_.asn1.csr.CSRUtil.getParam=function(e,t){var r=X,n=r.getV,i=r.getIdxbyList,s=r.getTLVbyList,a=r.getTLVbyListEx,o=r.getVbyListEx,c=function(C){var T=i(C,0,[0,3,0,0],"06");return n(C,T)!="2a864886f70d01090e"?null:s(C,0,[0,3,0,1,0],"30")},u={};if(e.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var b=or(e,"CERTIFICATE REQUEST");t&&(u.tbs=s(b,0,[0]));try{var h=a(b,0,[0,1]);if(h=="3000")u.subject={};else{var p=new ye;u.subject=p.getX500Name(h)}}catch{}var d=a(b,0,[0,2]),l=at.getKey(d,null,"pkcs8pub");u.sbjpubkey=at.getPEM(l,"PKCS8PUB");var y=c(b),p=new ye;y!=null&&(u.extreq=p.getExtParamArray(y));try{var m=a(b,0,[1],"30"),p=new ye;u.sigalg=p.getAlgorithmIdentifierName(m)}catch{}try{var w=o(b,0,[2]);u.sighex=w}catch{}return u};_.asn1.csr.CSRUtil.verifySignature=function(e){try{var t=null;if(typeof e=="string"&&e.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?t=_.asn1.csr.CSRUtil.getParam(e,!0):typeof e=="object"&&e.sbjpubkey!=null&&e.sigalg!=null&&e.sighex!=null&&e.tbs!=null&&(t=e),t==null)return!1;var r=new _.crypto.Signature({alg:t.sigalg});return r.init(t.sbjpubkey),r.updateHex(t.tbs),r.verify(t.sighex)}catch(n){return alert(n),!1}};(typeof _>"u"||!_)&&(_={});(typeof _.asn1>"u"||!_.asn1)&&(_.asn1={});(typeof _.asn1.ocsp>"u"||!_.asn1.ocsp)&&(_.asn1.ocsp={});_.asn1.ocsp.DEFAULT_HASH="sha1";_.asn1.ocsp.OCSPResponse=function(e){_.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);var t=_.asn1.DEREnumerated,r=_.asn1.ASN1Util.newObject,n=_.asn1.ocsp.ResponseBytes,i=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var s=this.params.resstatus;return typeof s=="number"?s:typeof s!="string"?-1:i.indexOf(s)},this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params,a=this._getStatusCode();if(a==-1)throw new Error("responseStatus not supported: "+s.resstatus);if(a!=0)return r({seq:[{enum:{int:a}}]}).tohex();var o=new n(s);return r({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:o}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.OCSPResponse,_.asn1.ASN1Object);_.asn1.ocsp.ResponseBytes=function(e){_.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=_.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.DEROctetString,s=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(a.restype!="ocspBasic")throw new Error("not supported responseType: "+a.restype);var o=new s(a),c=[];c.push(new n({name:"ocspBasic"})),c.push(new i({hex:o.tohex()}));var u=new r({array:c});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.ResponseBytes,_.asn1.ASN1Object);_.asn1.ocsp.BasicOCSPResponse=function(e){_.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,r=_.asn1,n=r.ASN1Object,i=r.DERSequence,s=r.DERGeneralizedTime,a=r.DERTaggedObject,o=r.DERBitString,c=r.x509.Extensions,u=r.x509.AlgorithmIdentifier,b=r.ocsp,h=b.ResponderID;_SingleResponseList=b.SingleResponseList,_ResponseData=b.ResponseData,this.params=null,this.setByParam=function(d){this.params=d},this.sign=function(){var d=this.params,l=d.tbsresp.tohex(),y=new _.crypto.Signature({alg:d.sigalg});y.init(d.reskey),y.updateHex(l),d.sighex=y.sign()},this.tohex=function(){var d=this.params;d.tbsresp==null&&(d.tbsresp=new _ResponseData(d)),d.sighex==null&&d.reskey!=null&&this.sign();var l=[];if(l.push(d.tbsresp),l.push(new u({name:d.sigalg})),l.push(new o({hex:"00"+d.sighex})),d.certs!=null&&d.certs.length!=null){for(var y=[],p=0;p<d.certs.length;p++){var m=d.certs[p],w=null;if(X.isASN1HEX(m))w=m;else if(m.match(/-----BEGIN/))w=or(m);else throw new t("certs["+p+"] not hex or PEM");y.push(new n({tlv:w}))}var C=new i({array:y});l.push(new a({tag:"a0",explicit:!0,obj:C}))}var T=new i({array:l});return T.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.BasicOCSPResponse,_.asn1.ASN1Object);_.asn1.ocsp.ResponseData=function(e){_.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,r=_.asn1,n=r.DERSequence,i=r.DERGeneralizedTime,s=r.DERTaggedObject,a=r.x509.Extensions,o=r.ocsp,c=o.ResponderID;_SingleResponseList=o.SingleResponseList,this.params=null,this.tohex=function(){var u=this.params;u.respid!=null&&new t("respid not specified"),u.prodat!=null&&new t("prodat not specified"),u.array!=null&&new t("array not specified");var b=[];if(b.push(new c(u.respid)),b.push(new i(u.prodat)),b.push(new _SingleResponseList(u.array)),u.ext!=null){var h=new a(u.ext);b.push(new s({tag:"a1",explicit:!0,obj:h}))}var d=new n({array:b});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(u){this.params=u},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.ResponseData,_.asn1.ASN1Object);_.asn1.ocsp.ResponderID=function(e){_.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=_,r=t.asn1,n=r.ASN1Util.newObject,i=r.x509.X500Name,s=t.lang.String.isHex,a=Error;this.params=null,this.tohex=function(){var o=this.params;if(o.key!=null){var c=null;if(typeof o.key=="string"){if(s(o.key)&&(c=o.key),o.key.match(/-----BEGIN CERTIFICATE/)){var u=new ye(o.key),b=u.getExtSubjectKeyIdentifier();b!=null&&(c=b.kid.hex)}}else if(o.key instanceof ye){var b=o.key.getExtSubjectKeyIdentifier();b!=null&&(c=b.kid.hex)}if(c==null)throw new a("wrong key member value");var h=n({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:c}}}});return h.tohex()}else if(o.name!=null){var d=null;if(typeof o.name=="string"&&o.name.match(/-----BEGIN CERTIFICATE/)){var u=new ye(o.name);d=u.getSubject()}else o.name instanceof ye?d=o.name.getSubject():typeof o.name=="object"&&(o.name.array!=null||o.name.str!=null)&&(d=o.name);if(d==null)throw new a("wrong name member value");var h=n({tag:{tag:"a1",explicit:!0,obj:new i(d)}});return h.tohex()}throw new a("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(o){this.params=o},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.ResponderID,_.asn1.ASN1Object);_.asn1.ocsp.SingleResponseList=function(e){_.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=_.asn1,r=t.DERSequence,n=t.ocsp.SingleResponse;this.params=null,this.tohex=function(){var i=this.params;if(typeof i!="object"||i.length==null)throw new Error("params not specified properly");for(var s=[],a=0;a<i.length;a++)s.push(new n(i[a]));var o=new r({array:s});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(i){this.params=i},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.SingleResponseList,_.asn1.ASN1Object);_.asn1.ocsp.SingleResponse=function(e){var t=Error,r=_,n=r.asn1,i=n.DERSequence,s=n.DERGeneralizedTime,a=n.DERTaggedObject,o=n.ocsp,c=o.CertID,u=o.CertStatus,b=n.x509,h=b.Extensions;o.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params,l=[];if(d.certid==null)throw new t("certid unspecified");if(d.status==null)throw new t("status unspecified");if(d.thisupdate==null)throw new t("thisupdate unspecified");if(l.push(new c(d.certid)),l.push(new u(d.status)),l.push(new s(d.thisupdate)),d.nextupdate!=null){var y=new s(d.nextupdate);l.push(new a({tag:"a0",explicit:!0,obj:y}))}if(d.ext!=null){var p=new h(d.ext);l.push(new a({tag:"a1",explicit:!0,obj:p}))}var m=new i({array:l});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(d){this.params=d},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.SingleResponse,_.asn1.ASN1Object);_.asn1.ocsp.CertID=function(e){var t=_,r=t.asn1,n=r.DEROctetString,i=r.DERInteger,s=r.DERSequence,a=r.x509,o=a.AlgorithmIdentifier,c=r.ocsp,u=c.DEFAULT_HASH,b=t.crypto,h=b.Util.hashHex,d=ye,l=X,y=l.getVbyList;c.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(p,m,w,C){C==null&&(C=this.DEFAULT_HASH),this.params={alg:C,issname:p,isskey:m,sbjsn:w}},this.setByCert=function(p,m,w){w==null&&(w=this.DEFAULT_HASH),this.params={alg:w,issuerCert:p,subjectCert:m}},this.getParamByCerts=function(p,m,w){w==null&&(w=this.DEFAULT_HASH);var C=new d(p),T=new d(m),q=h(C.getSubjectHex(),w),F=C.getPublicKeyHex(),j=h(y(F,0,[1],"03",!0),w),k=T.getSerialNumberHex(),I={alg:w,issname:q,isskey:j,sbjsn:k};return I},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var p=this.params,m,w,C,T;if(p.alg==null?T=this.DEFAULT_HASH:T=p.alg,p.issuerCert!=null&&p.subjectCert!=null){var q=this.getParamByCerts(p.issuerCert,p.subjectCert,T);m=q.issname,w=q.isskey,C=q.sbjsn}else if(p.issname!=null&&p.isskey!=null&&p.sbjsn!=null)m=p.issname,w=p.isskey,C=p.sbjsn;else throw new Error("required param members not defined");var F=new o({name:T}),j=new n({hex:m}),k=new n({hex:w}),I=new i({hex:C}),R=new s({array:[F,j,k,I]});return this.hTLV=R.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.CertID,_.asn1.ASN1Object);_.asn1.ocsp.CertStatus=function(e){_.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.status=="good")return"8000";if(t.status=="unknown")return"8200";if(t.status=="revoked"){var r=[{gentime:{str:t.time}}];t.reason!=null&&r.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:t.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:r}};return _.asn1.ASN1Util.newObject({tag:n}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(t){this.params=t},e!==void 0&&this.setByParam(e)};W(_.asn1.ocsp.CertStatus,_.asn1.ASN1Object);_.asn1.ocsp.Request=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var a=[];if(this.dReqCert===null)throw"reqCert not set";a.push(this.dReqCert);var o=new n({array:a});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof e<"u"){var s=new i.CertID(e);this.dReqCert=s}};W(_.asn1.ocsp.Request,_.asn1.ASN1Object);_.asn1.ocsp.TBSRequest=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(s){for(var a=[],o=0;o<s.length;o++){var c=new i.Request(s[0]);a.push(c)}this.dRequestList=a},this.tohex=function(){var s=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var a=new n({array:this.dRequestList});if(s.push(a),this.dRequestExt!==null)throw"requestExtensions not supported";var o=new n({array:s});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0&&this.setRequestListByParam(e.reqList)};W(_.asn1.ocsp.TBSRequest,_.asn1.ASN1Object);_.asn1.ocsp.OCSPRequest=function(e){var t=_,r=t.asn1,n=r.DERSequence,i=r.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var a=[];if(this.dTbsRequest!==null)a.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var o=new n({array:a});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0){var s=new i.TBSRequest(e);this.dTbsRequest=s}};W(_.asn1.ocsp.OCSPRequest,_.asn1.ASN1Object);_.asn1.ocsp.OCSPUtil={};_.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,r){var n=_,i=n.asn1,s=i.ocsp;r===void 0&&(r=s.DEFAULT_HASH);var a={alg:r,issuerCert:e,subjectCert:t},o=new s.OCSPRequest({reqList:[a]});return o.tohex()};_.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=X,r=t.getVbyList,n=t.getVbyListEx,i=t.getIdxbyList,s=t.getIdxbyListEx,a=t.getV,o={};try{var c=n(e,0,[0],"0a");o.responseStatus=parseInt(c,16)}catch{}if(o.responseStatus!==0)return o;try{var u=i(e,0,[1,0,1,0,0,2,0,1]);e.substr(u,2)==="80"?o.certStatus="good":e.substr(u,2)==="a1"?(o.certStatus="revoked",o.revocationTime=It(r(e,u,[0]))):e.substr(u,2)==="82"&&(o.certStatus="unknown")}catch{}try{var b=i(e,0,[1,0,1,0,0,2,0,2]);o.thisUpdate=It(a(e,b))}catch{}try{var h=i(e,0,[1,0,1,0,0,2,0,3]);e.substr(h,2)==="a0"&&(o.nextUpdate=It(r(e,h,[0])))}catch{}return o};_.asn1.ocsp.OCSPParser=function(){var e=Error,t=ye,r=new t,n=X,i=n.getV,s=n.getTLV,a=n.getIdxbyList,o=n.getVbyList,c=n.getTLVbyList,u=n.getVbyListEx,b=n.getTLVbyListEx,h=n.getChildIdx;this.getOCSPRequest=function(d){var l=h(d,0);if(l.length!=1&&l.length!=2)throw new e("wrong number elements: "+l.length);var y=this.getTBSRequest(s(d,l[0]));return y},this.getTBSRequest=function(d){var l={},y=b(d,0,[0],"30");l.array=this.getRequestList(y);var p=b(d,0,["[2]",0],"30");return p!=null&&(l.ext=r.getExtParamArray(p)),l},this.getRequestList=function(d){for(var l=[],y=h(d,0),p=0;p<y.length;p++){var d=s(d,y[p]);l.push(this.getRequest(d))}return l},this.getRequest=function(d){var l=h(d,0);if(l.length!=1&&l.length!=2)throw new e("wrong number elements: "+l.length);var y=this.getCertID(s(d,l[0]));if(l.length==2){var p=a(d,0,[1,0]);y.ext=r.getExtParamArray(s(d,p))}return y},this.getCertID=function(d){var l=h(d,0);if(l.length!=4)throw new e("wrong number elements: "+l.length);var y=new t,p={};return p.alg=y.getAlgorithmIdentifierName(s(d,l[0])),p.issname=i(d,l[1]),p.isskey=i(d,l[2]),p.sbjsn=i(d,l[3]),p},this.getOCSPResponse=function(d){var l=h(d,0),y,p=i(d,l[0]),m=parseInt(p);if(l.length==1)return{resstatus:m};var w=c(d,0,[1,0]);return y=this.getResponseBytes(w),y.resstatus=m,y},this.getResponseBytes=function(d){var l=h(d,0),y,p=c(d,0,[1,0]);y=this.getBasicOCSPResponse(p);var m=i(d,l[0]);return y.restype=_.asn1.x509.OID.oid2name(W1(m)),y},this.getBasicOCSPResponse=function(d){var l=h(d,0),y;y=this.getResponseData(s(d,l[0]));var p=new ye;y.alg=p.getAlgorithmIdentifierName(s(d,l[1]));var m=i(d,l[2]);y.sighex=m.substr(2);var w=u(d,0,["[0]"]);if(w!=null){for(var C=h(w,0),T=[],q=0;q<C.length;q++){var F=s(w,C[q]);T.push(F)}y.certs=T}return y},this.getResponseData=function(d){var l=h(d,0),y=l.length,p={},m=0;d.substr(l[0],2)=="a0"&&m++,p.respid=this.getResponderID(s(d,l[m++]));var w=i(d,l[m++]);if(p.prodat=It(w),p.array=this.getSingleResponseList(s(d,l[m++])),d.substr(l[y-1],2)=="a1"){var C=c(d,l[y-1],[0]),T=new ye;p.ext=T.getExtParamArray(C)}return p},this.getResponderID=function(d){var l={};if(d.substr(0,2)=="a2"){var y=o(d,0,[0]);l.key=y}if(d.substr(0,2)=="a1"){var p=c(d,0,[0]),m=new ye;l.name=m.getX500Name(p)}return l},this.getSingleResponseList=function(d){for(var l=h(d,0),y=[],p=0;p<l.length;p++){var m=this.getSingleResponse(s(d,l[p]));y.push(m)}return y},this.getSingleResponse=function(d){var l=h(d,0),y={},p=this.getCertID(s(d,l[0]));y.certid=p;var m=this.getCertStatus(s(d,l[1]));if(y.status=m,d.substr(l[2],2)=="18"){var w=i(d,l[2]);y.thisupdate=It(w)}for(var C=3;C<l.length;C++){if(d.substr(l[C],2)=="a0"){var T=o(d,l[C],[0],"18");y.nextupdate=It(T)}if(d.substr(l[C],2)=="a1"){var q=new ye,F=c(d,0,[C,0]);y.ext=q.getExtParamArray(F)}}return y},this.getCertStatus=function(d){var l={};if(d=="8000")return{status:"good"};if(d=="8200")return{status:"unknown"};if(d.substr(0,2)=="a1"){l.status="revoked";var y=o(d,0,[0]),p=It(y);l.time=p}return l}};var _;(typeof _>"u"||!_)&&(_={});(typeof _.lang>"u"||!_.lang)&&(_.lang={});_.lang.String=function(){};function s_(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function a_(e){for(var t="",r=0;r<e.length;r++)t=t+String.fromCharCode(e[r]);return t}function K1(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length==1&&(n="0"+n),t=t+n}return t}function fi(e){return K1(s_(e))}function AL(e){return Pa(fi(e))}function PL(e){return Iu(Pa(fi(e)))}function CL(e){return a_(Qw(A0(e)))}function Iu(e){return e=e.replace(/\=/g,""),e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_"),e}function A0(e){return e.length%4==2?e=e+"==":e.length%4==3&&(e=e+"="),e=e.replace(/-/g,"+"),e=e.replace(/_/g,"/"),e}function Hr(e){return e.length%2==1&&(e="0"+e),Iu(Pa(e))}function tr(e){return Bu(A0(e))}var x0,bs;typeof H.Buffer=="function"?(x0=function(e){return Iu(H.Buffer.from(e,"utf8").toString("base64"))},bs=function(e){return H.Buffer.from(A0(e),"base64").toString("utf8")}):(x0=function(e){return Hr(z1(G1(e)))},bs=function(e){return decodeURIComponent($1(tr(e)))});function IL(e){return Pa(z1(G1(e)))}function BL(e){return decodeURIComponent($1(Bu(e)))}function V1(e){return z1(G1(e)).toLowerCase()}function It(e){try{return decodeURIComponent($1(e))}catch{return null}}function ML(e){return It(TL(e))}function TL(e){for(var t=e.match(/.{1,2}/g),r=[],n=0;n<t.length;n++){var i=parseInt(t[n],16);161<=i&&i<=191?(r.push("c2"),r.push(t[n])):192<=i&&i<=255?(r.push("c3"),r.push((i-64).toString(16))):r.push(t[n])}return r.join("")}function Hn(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function Ui(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function bv(e){return Pa(e)}function OL(e){return U1(bv(e),64)}function U1(e,t){return e=e.replace(new RegExp("(.{"+t+"})","g"),`$1\r
`),e=e.replace(/\s+$/,""),e}function o_(e){var t=e.replace(/[^0-9A-Za-z\/+=]*/g,""),r=Bu(t);return r}function DL(e,t){return"-----BEGIN "+t+`-----\r
`+U1(e,64)+`\r
-----END `+t+`-----\r
`}function Fn(e,t){return"-----BEGIN "+t+`-----\r
`+U1(bv(e),64)+`\r
-----END `+t+`-----\r
`}function or(e,t){if(e.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return t!==void 0?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),""),e=e.replace(new RegExp("-----END "+t+"-----[^]*$"),"")):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,""),e=e.replace(/-----END [^-]+-----[^]*$/,"")),o_(e)}function NL(e){return e.indexOf("-----BEGIN ")==-1||e.indexOf("-----END ")==-1?null:(e=e.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),e=e.replace(/-----END [\s\S]+$/m,""),e=e.replace(/\s+/g,""),e.match(/^[0-9a-zA-Z+/=]+$/)?e:null)}function RL(e){if(e.length%2!=0)throw"input is not even length";if(e.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(n*2,2),16));return t}function FL(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t}function gv(e){var t,r,n,i,s,a,o,c,u,b,h,d;if(e=f_(e),d=e.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),d)return t=parseInt(d[1]),r=parseInt(d[2])-1,n=parseInt(d[3]),i=parseInt(d[4]),s=parseInt(d[5]),a=parseInt(d[6]),o=0,b=d[7],b!==""&&(h=(b.substr(1)+"00").substr(0,3),o=parseInt(h)),Date.UTC(t,r,n,i,s,a,o);throw new Error("unsupported zulu format: "+e)}function qL(e){var t=new Date(e),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),i=("00"+t.getUTCDate()).slice(-2),s=("00"+t.getUTCHours()).slice(-2),a=("00"+t.getUTCMinutes()).slice(-2),o=("00"+t.getUTCSeconds()).slice(-2),c=("000"+t.getUTCMilliseconds()).slice(-3);return c=c.replace(/0+$/,""),c=c!=""?"."+c:c,r+n+i+s+a+o+c+"Z"}function c_(e){return Math.round(gv(e)/1e3)}function HL(e){return new Date(gv(e))}function jL(e,t,r){var n,i=e.getUTCFullYear();if(t){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;n=(""+i).slice(-2)}else n=("000"+i).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var s=e.getUTCMilliseconds();s!==0&&(s=("00"+s).slice(-3),s=s.replace(/0+$/g,""),n+="."+s)}return n+="Z",n}function f_(e){return e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}[.][0-9]*Z$/)?e.match(/^[0-4]/)?"20"+e:"19"+e:e}function z1(e){return e.replace(/%/g,"")}function $1(e){return e.replace(/(..)/g,"%$1")}function cv(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;e=e.toLowerCase();var r=e.split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2);e=e.replace("::",n);var i=e.split(":");if(i.length!=8)throw t;for(var s=0;s<8;s++)i[s]=("0000"+i[s]).slice(-4);return i.join("")}function fv(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+e);e=e.toLowerCase();var t=e.match(/.{1,4}/g);t=t.map(function(i){return i.replace(/^0+/,"")}),t=t.map(function(i){return i==""?"0":i}),e=":"+t.join(":")+":";var r=e.match(/:(0:){2,}/g);if(r==null)return e.slice(1,-1);var n=r.sort().slice(-1)[0];return e=e.replace(n.substr(0,n.length-1),":"),e.substr(0,2)!="::"&&(e=e.substr(1)),e.substr(-2,2)!="::"&&(e=e.substr(0,e.length-1)),e}function q1(e){var t=new Error("malformed hex value");if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(e.length==8){var r;try{return r=parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16),r}catch{throw t}}else if(e.length==16)try{return q1(e.substr(0,8))+"/"+Zw(e.substr(8))}catch{throw t}else{if(e.length==32)return fv(e);if(e.length==64){try{return fv(e.substr(0,32))+"/"+Zw(e.substr(32))}catch{throw t}return}else return e}}function Zw(e){var t=new Error("malformed mask"),r;try{r=new U(e,16).toString(2)}catch{throw t}if(!r.match(/^1*0*$/))throw t;return r.replace(/0+$/,"").length}function vv(e){var t=new Error("malformed IP address");if(e=e.toLowerCase(e),!e.match(/^[0-9a-f.:/]+$/))throw t;if(e.match(/^[0-9.]+$/)){var r=e.split(".");if(r.length!==4)throw t;var n="";try{for(var i=0;i<4;i++){var s=parseInt(r[i]);n+=("0"+s.toString(16)).slice(-2)}return n}catch{throw t}}else if(e.match(/^[0-9.]+\/[0-9]+$/)){var a=e.split("/");return vv(a[0])+Jw(parseInt(a[1]),32)}else{if(e.match(/^[0-9a-f:]+$/)&&e.indexOf(":")!==-1)return cv(e);if(e.match(/^[0-9a-f:]+\/[0-9]+$/)&&e.indexOf(":")!==-1){var a=e.split("/");return cv(a[0])+Jw(parseInt(a[1]),128)}else throw t}}function Jw(e,t){if(t==32&&e==0)return"00000000";if(t==128&&e==0)return"00000000000000000000000000000000";var r=Array(e+1).join("1")+Array(t-e+1).join("0");return new U(r,2).toString(16)}function yv(e){function t(i){var s=parseInt(i.substr(0,2),16),a=parseInt(i.substr(2),16);if(s==0&a<128)return String.fromCharCode(a);if(s<8){var o=192|(s&7)<<3|(a&192)>>6,c=128|a&63;return It(o.toString(16)+c.toString(16))}var o=224|(s&240)>>4,c=128|(s&15)<<2|(a&192)>>6,u=128|a&63;return It(o.toString(16)+c.toString(16)+u.toString(16))}var r=e.match(/.{4}/g),n=r.map(t);return n.join("")}function G1(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)t[n]=="%"?(r=r+t.substr(n,3),n=n+2):r=r+"%"+fi(t[n]);return r}function kL(e){return e=e.replace(/\r\n/mg,`
`),e}function LL(e){return e=e.replace(/\r\n/mg,`
`),e=e.replace(/\n/mg,`\r
`),e}_.lang.String.isInteger=function(e){return e.match(/^[0-9]+$/)?!0:!!e.match(/^-[0-9]+$/)};_.lang.String.isHex=function(e){return u_(e)};function u_(e){return!!(e.length%2==0&&(e.match(/^[0-9a-f]+$/)||e.match(/^[0-9A-F]+$/)))}_.lang.String.isBase64=function(e){return e=e.replace(/\s+/g,""),!!(e.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&e.length%4==0)};_.lang.String.isBase64URL=function(e){return e.match(/[+/=]/)?!1:(e=A0(e),_.lang.String.isBase64(e))};function mv(e){return!!e.match(/^[0-9A-Za-z-_.]+$/)}_.lang.String.isIntegerArray=function(e){return e=e.replace(/\s+/g,""),!!e.match(/^\[[0-9,]+\]$/)};_.lang.String.isPrintable=function(e){return e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null};_.lang.String.isIA5=function(e){return e.match(/^[\x20-\x21\x23-\x7f]*$/)!==null};_.lang.String.isMail=function(e){return e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function uv(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function KL(e){e=e.replace(/^\s*\[\s*/,""),e=e.replace(/\s*\]\s*$/,""),e=e.replace(/\s*/g,"");try{var t=e.split(/,/).map(function(r,n,i){var s=parseInt(r);if(s<0||255<s)throw"integer not in range 0-255";var a=("00"+s.toString(16)).slice(-2);return a}).join("");return t}catch(r){throw"malformed integer array string: "+r}}var VL=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1};function d_(e){var t=function(o){var c=o.toString(16);return c.length==1&&(c="0"+c),c},r=function(o){var c="",u=parseInt(o,10),b=u.toString(2),h=7-b.length%7;h==7&&(h=0);for(var d="",l=0;l<h;l++)d+="0";b=d+b;for(var l=0;l<b.length-1;l+=7){var y=b.substr(l,7);l!=b.length-7&&(y="1"+y),c+=t(parseInt(y,2))}return c};try{if(!e.match(/^[0-9.]+$/))return null;var n="",i=e.split("."),s=parseInt(i[0],10)*40+parseInt(i[1],10);n+=t(s),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n}catch{return null}}function W1(e){if(!u_(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var i=e.substr(2),s=[],a=0;a<i.length/2;a++)s.push(parseInt(i.substr(a*2,2),16));for(var o=[],c="",a=0;a<s.length;a++)s[a]&128?c=c+H1((s[a]&127).toString(2),7):(c=c+H1((s[a]&127).toString(2),7),o.push(new String(parseInt(c,2))),c="");var u=t.join(".");return o.length>0&&(u=u+"."+o.join(".")),u}catch{return null}}function l_(e){var t=new U(String(e),10);return P0(t)}function P0(e){var t=e.toString(16);if(t.substr(0,1)!="-")return t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t),t;var r=t.substr(1),n=r.length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var i="",s=0;s<n;s++)i+="f";var a=new U(i,16),o=a.xor(e).add(U.ONE);return t=o.toString(16).replace(/^-/,""),t}var H1=function(e,t,r){return r==null&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};function h_(e){if(e.length%2!=0||(e=e.toLowerCase(),e.match(/^[0-9a-f]+$/)==null))return-1;try{var t=e.substr(0,2);if(t=="00")return parseInt(e.substr(2),16);var r=parseInt(t,16);if(r>7)return-1;var n=e.substr(2),i=parseInt(n,16).toString(2);i=="0"&&(i="00000000"),i=i.slice(0,0-r);var s=parseInt(i,2);return s==NaN?-1:s}catch{return-1}}function p_(e){if(typeof e!="number"||e<0)return null;var t=Number(e).toString(2),r=8-t.length%8;r==8&&(r=0),t=t+H1("",r,"0");var n=parseInt(t,2).toString(16);n.length%2==1&&(n="0"+n);var i="0"+r;return i+n}function b_(e){if(typeof e!="string"||e.length%2!=0||!e.match(/^[0-9a-f]+$/))return null;try{var t=parseInt(e.substr(0,2),16);if(t<0||7<t)return null;for(var r=e.substr(2),n="",i=0;i<r.length;i+=2){var s=r.substr(i,2),a=parseInt(s,16).toString(2);a=("0000000"+a).slice(-8),n+=a}return n.substr(0,n.length-t)}catch{return null}}function UL(e){if(typeof e!="string"||e.match(/^[01]+$/)==null)return null;try{var t=parseInt(e,2);return p_(t)}catch{return null}}function j1(e,t){for(var r=0,n=0;n<e.length;n++)r|=1<<t[e[n]];for(var i=r.toString(2),s="",n=i.length-1;n>=0;n--)s+=i[n];return s}function Nt(e,n,r){if(typeof e=="object"){for(var n=String(n).split("."),i=0;i<n.length&&e;i++){var s=n[i];s.match(/^[0-9]+$/)&&(s=parseInt(s)),e=e[s]}return e||e===!1?e:r}}function W(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}(typeof _>"u"||!_)&&(_={});(typeof _.crypto>"u"||!_.crypto)&&(_.crypto={});_.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:ee.algo.MD5,sha1:ee.algo.SHA1,sha224:ee.algo.SHA224,sha256:ee.algo.SHA256,sha384:ee.algo.SHA384,sha512:ee.algo.SHA512,ripemd160:ee.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(typeof this.DIGESTINFOHEAD[t]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var s="0001",a="00"+n,o="",c=i-s.length-a.length,u=0;u<c;u+=2)o+="ff";var b=s+o+a;return b},this.hashString=function(e,t){var r=new _.crypto.MessageDigest({alg:t});return r.digestString(e)},this.hashHex=function(e,t){var r=new _.crypto.MessageDigest({alg:t});return r.digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof ve||e instanceof _.crypto.DSA||e instanceof _.crypto.ECDSA}};_.crypto.Util.md5=function(e){var t=new _.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return t.digestString(e)};_.crypto.Util.ripemd160=function(e){var t=new _.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return t.digestString(e)};_.crypto.Util.SECURERANDOMGEN=new Ao;_.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return _.crypto.Util.SECURERANDOMGEN.nextBytes(t),K1(t)};_.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new U(_.crypto.Util.getRandomHexOfNbytes(e),16)};_.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=(e-t)/8,n=new Array(r+1);return _.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],K1(n)};_.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new U(_.crypto.Util.getRandomHexOfNbits(e),16)};_.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=_.crypto.Util.getRandomBigIntegerOfNbits(t);if(e.compareTo(r)!=-1)return r}};_.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(r==1)throw"biMin is greater than biMax";if(r==0)return e;var n=t.subtract(e),i=_.crypto.Util.getRandomBigIntegerZeroToMax(n);return i.add(e)};_.crypto.MessageDigest=function(e){var t=null,r=null,n=null;this.setAlgAndProvider=function(i,s){if(i=_.crypto.MessageDigest.getCanonicalAlgName(i),i!==null&&s===void 0&&(s=_.crypto.Util.DEFAULTPROVIDER[i]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)!=-1&&s=="cryptojs"){try{this.md=_.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i].create()}catch(a){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var o=ee.enc.Hex.parse(a);this.md.update(o)},this.digest=function(){var a=this.md.finalize();return a.toString(ee.enc.Hex)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}if(":sha256:".indexOf(i)!=-1&&s=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(a){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var o=sjcl.codec.hex.toBits(a);this.md.update(o)},this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}},this.updateString=function(i){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(i){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(i){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(i){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},e!==void 0&&e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=_.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};_.crypto.MessageDigest.getCanonicalAlgName=function(e){return typeof e=="string"&&(e=e.toLowerCase(),e=e.replace(/-/,"")),e};_.crypto.MessageDigest.getHashLength=function(e){var t=_.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(t.HASHLENGTH[r]===void 0)throw"not supported algorithm: "+e;return t.HASHLENGTH[r]};_.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};_.crypto.Mac=function(e){var t=null,r=null,n=null,i=null,s=null;this.setAlgAndProvider=function(a,o){if(a=a.toLowerCase(),a==null&&(a="hmacsha1"),a=a.toLowerCase(),a.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+a;o===void 0&&(o=_.crypto.Util.DEFAULTPROVIDER[a]),this.algProv=a+"/"+o;var c=a.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&o=="cryptojs"){try{var u=_.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c];this.mac=ee.algo.HMAC.create(u,this.pass)}catch(b){throw"setAlgAndProvider hash alg set fail hashAlg="+c+"/"+b}this.updateString=function(b){this.mac.update(b)},this.updateHex=function(b){var h=ee.enc.Hex.parse(b);this.mac.update(h)},this.doFinal=function(){var b=this.mac.finalize();return b.toString(ee.enc.Hex)},this.doFinalString=function(b){return this.updateString(b),this.doFinal()},this.doFinalHex=function(b){return this.updateHex(b),this.doFinal()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(a){if(typeof a=="string"){var o=a;(a.length%2==1||!a.match(/^[0-9A-Fa-f]+$/))&&(o=Ui(a)),this.pass=ee.enc.Hex.parse(o);return}if(typeof a!="object")throw"KJUR.crypto.Mac unsupported password type: "+a;var o=null;if(a.hex!==void 0){if(a.hex.length%2!=0||!a.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+a.hex;o=a.hex}if(a.utf8!==void 0&&(o=V1(a.utf8)),a.rstr!==void 0&&(o=Ui(a.rstr)),a.b64!==void 0&&(o=Bu(a.b64)),a.b64u!==void 0&&(o=tr(a.b64u)),o==null)throw"KJUR.crypto.Mac unsupported password type: "+a;this.pass=ee.enc.Hex.parse(o)},e!==void 0&&(e.pass!==void 0&&this.setPassword(e.pass),e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=_.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))};_.crypto.Signature=function(e){var t=null,r=null,n=null,i=null,s=null,a=null,o=null,c=null,u=null,b=null,h=-1,d=null,l=null,y=null,p=null,m=null;if(this._setAlgNames=function(){var w=this.algName.match(/^(.+)with(.+)$/);w&&(this.mdAlgName=w[1].toLowerCase(),this.pubkeyAlgName=w[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(w,C){for(var T="",q=C/4-w.length,F=0;F<q;F++)T=T+"0";return T+w},this.setAlgAndProvider=function(w,C){if(this._setAlgNames(),C!="cryptojs/jsrsa")throw new Error("provider not supported: "+C);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new _.crypto.MessageDigest({alg:this.mdAlgName})}catch(T){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+T)}this.init=function(T,q){var F=null;try{q===void 0?F=at.getKey(T):F=at.getKey(T,q)}catch(j){throw"init failed:"+j}if(F.isPrivate===!0)this.prvKey=F,this.state="SIGN";else if(F.isPublic===!0)this.pubKey=F,this.state="VERIFY";else throw"init failed.:"+F},this.updateString=function(T){this.md.updateString(T)},this.updateHex=function(T){this.md.updateHex(T)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&_.crypto.ECDSA!==void 0&&(this.prvKey=new _.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ve&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ve&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof _.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof _.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(T){return this.updateString(T),this.sign()},this.signHex=function(T){return this.updateHex(T),this.sign()},this.verify=function(T){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&_.crypto.ECDSA!==void 0&&(this.pubKey=new _.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ve&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,T,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ve&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,T);if(_.crypto.ECDSA!==void 0&&this.pubKey instanceof _.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,T);if(_.crypto.DSA!==void 0&&this.pubKey instanceof _.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,T);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(w,C){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(w){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(w){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(w){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(w){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(w){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,e!==void 0&&(e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0?this.provName=_.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),e.psssaltlen!==void 0&&(this.pssSaltLen=e.psssaltlen),e.prvkeypem!==void 0)){if(e.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var t=at.getKey(e.prvkeypem);this.init(t)}catch(w){throw"fatal error to load pem private key: "+w}}};_.crypto.Cipher=function(e){};_.crypto.Cipher.encrypt=function(e,t,r,n){if(Nt(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var i=t,s=e;Nt(n,"key")!=null&&(i=n.key),Nt(n,"enc")!=null&&(hEnc=n.enc);var a=ee.enc.Hex.parse(i),o=ee.enc.Hex.parse(s),c=ee.enc.Hex.parse(n.iv),u;if(r=="des-EDE3-CBC")u=ee.TripleDES.encrypt(o,a,{iv:c});else if(r=="aes128-CBC"||r=="aes256-CBC")u=ee.AES.encrypt(o,a,{iv:c});else throw new Error("unsupported algorithm: "+r);return u+""}else if(t instanceof ve&&t.isPublic){var b=_.crypto.Cipher.getAlgByKeyAndName(t,r);if(b==="RSA")return t.encrypt(e);if(b==="RSAOAEP")return t.encryptOAEP(e,"sha1");var h=b.match(/^RSAOAEP(\d+)$/);if(h!==null)return t.encryptOAEP(e,"sha"+h[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.encrypt: unsupported key or algorithm"};_.crypto.Cipher.decrypt=function(e,t,r,n){if(Nt(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var i=t,s=e;Nt(n,"key")!=null&&(i=n.key),Nt(n,"enc")!=null&&(s=n.enc);var a=ee.enc.Hex.parse(i),o=ee.enc.Hex.parse(s),c=ee.enc.Hex.parse(n.iv),u;if(r=="des-EDE3-CBC")u=ee.TripleDES.decrypt({ciphertext:o},a,{iv:c});else if(r=="aes128-CBC"||r=="aes256-CBC")u=ee.AES.decrypt({ciphertext:o},a,{iv:c});else throw new Error("unsupported algorithm: "+r);return ee.enc.Hex.stringify(u)}else if(t instanceof ve&&t.isPrivate){var b=_.crypto.Cipher.getAlgByKeyAndName(t,r);if(b==="RSA")return t.decrypt(e);if(b==="RSAOAEP")return t.decryptOAEP(e,"sha1");var h=b.match(/^RSAOAEP(\d+)$/);if(h!==null)return t.decryptOAEP(e,"sha"+h[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.decrypt: unsupported key or algorithm"};_.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof ve){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t)!=-1)return t;if(t==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t};_.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};(typeof _>"u"||!_)&&(_={});(typeof _.crypto>"u"||!_.crypto)&&(_.crypto={});_.crypto.ECDSA=function(e){var t="secp256r1",r=null,n=null,i=null,s=Error,a=U,o=mt,c=_.crypto.ECDSA,u=_.crypto.ECParameterDB,b=c.getName,h=X,d=h.getVbyListEx,l=h.isASN1HEX,y=new Ao,p=null;this.type="EC",this.isPrivate=!1,this.isPublic=!1;function m(w,C,T,q){for(var F=Math.max(C.bitLength(),q.bitLength()),j=w.add2D(T),k=w.curve.getInfinity(),I=F-1;I>=0;--I)k=k.twice2D(),k.z=a.ONE,C.testBit(I)?q.testBit(I)?k=k.add2D(j):k=k.add2D(w):q.testBit(I)&&(k=k.add2D(T));return k}this.getBigRandom=function(w){return new a(w.bitLength(),y).mod(w.subtract(a.ONE)).add(a.ONE)},this.setNamedCurve=function(w){this.ecparams=u.getByName(w),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=w},this.setPrivateKeyHex=function(w){this.isPrivate=!0,this.prvKeyHex=w},this.setPublicKeyHex=function(w){this.isPublic=!0,this.pubKeyHex=w},this.getPublicKeyXYHex=function(){var w=this.pubKeyHex;if(w.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var C=this.ecparams.keycharlen;if(w.length!==2+C*2)throw"malformed public key hex length";var T={};return T.x=w.substr(2,C),T.y=w.substr(2+C),T},this.getShortNISTPCurveName=function(){var w=this.curveName;return w==="secp256r1"||w==="NIST P-256"||w==="P-256"||w==="prime256v1"?"P-256":w==="secp384r1"||w==="NIST P-384"||w==="P-384"?"P-384":w==="secp521r1"||w==="NIST P-521"||w==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var w=this.ecparams.n,C=this.getBigRandom(w),T=this.ecparams.keycharlen,q=("0000000000"+C.toString(16)).slice(-T);this.setPrivateKeyHex(q);var F=this.generatePublicKeyHex();return{ecprvhex:q,ecpubhex:F}},this.generatePublicKeyHex=function(){var w=new a(this.prvKeyHex,16),C=this.ecparams.G.multiply(w),T=C.getX().toBigInteger(),q=C.getY().toBigInteger(),F=this.ecparams.keycharlen,j=("0000000000"+T.toString(16)).slice(-F),k=("0000000000"+q.toString(16)).slice(-F),I="04"+j+k;return this.setPublicKeyHex(I),I},this.signWithMessageHash=function(w){return this.signHex(w,this.prvKeyHex)},this.signHex=function(w,C){var T=new a(C,16),q=this.ecparams.n,F=new a(w.substring(0,this.ecparams.keycharlen),16);do var j=this.getBigRandom(q),k=this.ecparams.G,I=k.multiply(j),R=I.getX().toBigInteger().mod(q);while(R.compareTo(a.ZERO)<=0);var A=j.modInverse(q).multiply(F.add(T.multiply(R))).mod(q);return c.biRSSigToASN1Sig(R,A)},this.sign=function(w,C){var T=C,q=this.ecparams.n,F=a.fromByteArrayUnsigned(w);do var j=this.getBigRandom(q),k=this.ecparams.G,I=k.multiply(j),R=I.getX().toBigInteger().mod(q);while(R.compareTo(U.ZERO)<=0);var A=j.modInverse(q).multiply(F.add(T.multiply(R))).mod(q);return this.serializeSig(R,A)},this.verifyWithMessageHash=function(w,C){return this.verifyHex(w,C,this.pubKeyHex)},this.verifyHex=function(w,C,T){try{var q,F,j=c.parseSigHex(C);q=j.r,F=j.s;var k=o.decodeFromHex(this.ecparams.curve,T),I=new a(w.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(I,q,F,k)}catch{return!1}},this.verify=function(w,C,T){var q,F;if(Bitcoin.Util.isArray(C)){var j=this.parseSig(C);q=j.r,F=j.s}else if(typeof C=="object"&&C.r&&C.s)q=C.r,F=C.s;else throw"Invalid value for signature";var k;if(T instanceof mt)k=T;else if(Bitcoin.Util.isArray(T))k=o.decodeFrom(this.ecparams.curve,T);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var I=a.fromByteArrayUnsigned(w);return this.verifyRaw(I,q,F,k)},this.verifyRaw=function(w,C,T,q){var F=this.ecparams.n,j=this.ecparams.G;if(C.compareTo(a.ONE)<0||C.compareTo(F)>=0||T.compareTo(a.ONE)<0||T.compareTo(F)>=0)return!1;var k=T.modInverse(F),I=w.multiply(k).mod(F),R=C.multiply(k).mod(F),A=j.multiply(I).add(q.multiply(R)),f=A.getX().toBigInteger().mod(F);return f.equals(C)},this.serializeSig=function(w,C){var T=w.toByteArraySigned(),q=C.toByteArraySigned(),F=[];return F.push(2),F.push(T.length),F=F.concat(T),F.push(2),F.push(q.length),F=F.concat(q),F.unshift(F.length),F.unshift(48),F},this.parseSig=function(w){var C;if(w[0]!=48)throw new Error("Signature not a valid DERSequence");if(C=2,w[C]!=2)throw new Error("First element in signature must be a DERInteger");var T=w.slice(C+2,C+2+w[C+1]);if(C+=2+w[C+1],w[C]!=2)throw new Error("Second element in signature must be a DERInteger");var q=w.slice(C+2,C+2+w[C+1]);C+=2+w[C+1];var F=a.fromByteArrayUnsigned(T),j=a.fromByteArrayUnsigned(q);return{r:F,s:j}},this.parseSigCompact=function(w){if(w.length!==65)throw"Signature has the wrong length";var C=w[0]-27;if(C<0||C>7)throw"Invalid signature type";var T=this.ecparams.n,q=a.fromByteArrayUnsigned(w.slice(1,33)).mod(T),F=a.fromByteArrayUnsigned(w.slice(33,65)).mod(T);return{r:q,s:F,i:C}},this.readPKCS5PrvKeyHex=function(w){if(l(w)===!1)throw new Error("not ASN.1 hex string");var C,T,q;try{C=d(w,0,["[0]",0],"06"),T=d(w,0,[1],"04");try{q=d(w,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=b(C),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(q),this.setPrivateKeyHex(T),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(w){if(l(w)===!1)throw new s("not ASN.1 hex string");var C,T,q,F;try{C=d(w,0,[1,0],"06"),T=d(w,0,[1,1],"06"),q=d(w,0,[2,0,1],"04");try{F=d(w,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new s("malformed PKCS#8 plain ECC private key")}if(this.curveName=b(T),this.curveName===void 0)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(F),this.setPrivateKeyHex(q),this.isPublic=!1},this.readPKCS8PubKeyHex=function(w){if(l(w)===!1)throw new s("not ASN.1 hex string");var C,T,q;try{C=d(w,0,[0,0],"06"),T=d(w,0,[0,1],"06"),q=d(w,0,[1],"03")}catch{throw new s("malformed PKCS#8 ECC public key")}if(this.curveName=b(T),this.curveName===null)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(q)},this.readCertPubKeyHex=function(w,C){if(l(w)===!1)throw new s("not ASN.1 hex string");var T,q;try{T=d(w,0,[0,5,0,1],"06"),q=d(w,0,[0,5,1],"03")}catch{throw new s("malformed X.509 certificate ECC public key")}if(this.curveName=b(T),this.curveName===null)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(q)},e!==void 0&&e.curve!==void 0&&(this.curveName=e.curve),this.curveName===void 0&&(this.curveName=t),this.setNamedCurve(this.curveName),e!==void 0&&(e.prv!==void 0&&this.setPrivateKeyHex(e.prv),e.pub!==void 0&&this.setPublicKeyHex(e.pub))};_.crypto.ECDSA.parseSigHex=function(e){var t=_.crypto.ECDSA.parseSigHexInHexRS(e),r=new U(t.r,16),n=new U(t.s,16);return{r,s:n}};_.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=X,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),e.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var i=r(e,0);if(i.length!=2)throw new Error("signature shall have two elements");var s=i[0],a=i[1];if(e.substr(s,2)!="02")throw new Error("1st item not ASN.1 integer");if(e.substr(a,2)!="02")throw new Error("2nd item not ASN.1 integer");var o=n(e,s),c=n(e,a);return{r:o,s:c}};_.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=_.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if(r.length>=130&&r.length<=134){if(r.length%2!=0)throw Error("unknown ECDSA sig r length error");if(n.length%2!=0)throw Error("unknown ECDSA sig s length error");r.substr(0,2)=="00"&&(r=r.substr(2)),n.substr(0,2)=="00"&&(n=n.substr(2));var i=Math.max(r.length,n.length);return r=("000000"+r).slice(-i),n=("000000"+n).slice(-i),r+n}if(r.substr(0,2)=="00"&&r.length%32==2&&(r=r.substr(2)),n.substr(0,2)=="00"&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw Error("unknown ECDSA sig r length error");if(n.length%32!=0)throw Error("unknown ECDSA sig s length error");return r+n};_.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return _.crypto.ECDSA.hexRSSigToASN1Sig(t,r)};_.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new U(e,16),n=new U(t,16);return _.crypto.ECDSA.biRSSigToASN1Sig(r,n)};_.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=_.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t}),s=new r.DERSequence({array:[n,i]});return s.tohex()};_.crypto.ECDSA.getName=function(e){return e==="2b8104001f"?"secp192k1":e==="2a8648ce3d030107"?"secp256r1":e==="2b8104000a"?"secp256k1":e==="2b81040021"?"secp224r1":e==="2b81040022"?"secp384r1":e==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)!==-1?"secp256r1":"|secp256k1|".indexOf(e)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(e)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(e)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(e)!==-1?"secp521r1":null};(typeof _>"u"||!_)&&(_={});(typeof _.crypto>"u"||!_.crypto)&&(_.crypto={});_.crypto.ECParameterDB=new function(){var e={},t={};function r(n){return new U(n,16)}this.getByName=function(n){var i=n;if(typeof t[i]<"u"&&(i=t[n]),typeof e[i]<"u")return e[i];throw"unregistered EC curve name: "+i},this.regist=function(n,i,s,a,o,c,u,b,h,d,l,y){e[n]={};var p=r(s),m=r(a),w=r(o),C=r(c),T=r(u),q=new Ca(p,m,w),F=q.decodePointHex("04"+b+h);e[n].name=n,e[n].keylen=i,e[n].keycharlen=Math.ceil(i/8)*2,e[n].curve=q,e[n].G=F,e[n].n=C,e[n].h=T,e[n].oid=l,e[n].info=y;for(var j=0;j<d.length;j++)t[d[j]]=n}};_.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");_.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");_.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");_.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);_.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);_.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);_.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);_.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);_.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);_.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);(typeof _>"u"||!_)&&(_={});(typeof _.crypto>"u"||!_.crypto)&&(_.crypto={});_.crypto.DSA=function(){var e=X,t=e.getVbyList,r=e.getVbyListEx,n=e.isASN1HEX,i=U;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(s,a,o,c,u){this.isPrivate=!0,this.p=s,this.q=a,this.g=o,this.y=c,this.x=u},this.setPrivateHex=function(s,a,o,c,u){var b,h,d,l,y;b=new U(s,16),h=new U(a,16),d=new U(o,16),typeof c=="string"&&c.length>1?l=new U(c,16):l=null,y=new U(u,16),this.setPrivate(b,h,d,l,y)},this.setPublic=function(s,a,o,c){this.isPublic=!0,this.p=s,this.q=a,this.g=o,this.y=c,this.x=null},this.setPublicHex=function(s,a,o,c){var u,b,h,d;u=new U(s,16),b=new U(a,16),h=new U(o,16),d=new U(c,16),this.setPublic(u,b,h,d)},this.signWithMessageHash=function(s){var a=this.p,o=this.q,c=this.g,u=this.y,b=this.x,h=_.crypto.Util.getRandomBigIntegerMinToMax(U.ONE.add(U.ONE),o.subtract(U.ONE)),d=s.substr(0,o.bitLength()/4),l=new U(d,16),y=c.modPow(h,a).mod(o),p=h.modInverse(o).multiply(l.add(b.multiply(y))).mod(o),m=_.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:y}},{int:{bigint:p}}]});return m},this.verifyWithMessageHash=function(s,a){var o=this.p,c=this.q,u=this.g,b=this.y,h=this.parseASN1Signature(a),d=h[0],l=h[1],y=s.substr(0,c.bitLength()/4),p=new U(y,16);if(U.ZERO.compareTo(d)>0||d.compareTo(c)>0||U.ZERO.compareTo(l)>=0||l.compareTo(c)>0)throw"invalid DSA signature";var m=l.modInverse(c),w=p.multiply(m).mod(c),C=d.multiply(m).mod(c),T=u.modPow(w,o).multiply(b.modPow(C,o)).mod(o).mod(c);return T.compareTo(d)==0},this.parseASN1Signature=function(s){try{var a=new i(r(s,0,[0],"02"),16),o=new i(r(s,0,[1],"02"),16);return[a,o]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(s){var a,o,c,u,b;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{a=r(s,0,[1],"02"),o=r(s,0,[2],"02"),c=r(s,0,[3],"02"),u=r(s,0,[4],"02"),b=r(s,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(a,o,c,u,b)},this.readPKCS8PrvKeyHex=function(s){var a,o,c,u;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{a=r(s,0,[1,1,0],"02"),o=r(s,0,[1,1,1],"02"),c=r(s,0,[1,1,2],"02"),u=r(s,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(a,o,c,null,u)},this.readPKCS8PubKeyHex=function(s){var a,o,c,u;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{a=r(s,0,[0,1,0],"02"),o=r(s,0,[0,1,1],"02"),c=r(s,0,[0,1,2],"02"),u=r(s,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(a,o,c,u)},this.readCertPubKeyHex=function(s,a){var o,c,u,b;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{o=r(s,0,[0,5,0,1,0],"02"),c=r(s,0,[0,5,0,1,1],"02"),u=r(s,0,[0,5,0,1,2],"02"),b=r(s,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(o,c,u,b)}};var at=function(){var e=function(p,m,w){return n(ee.AES,p,m,w)},t=function(p,m,w){return n(ee.TripleDES,p,m,w)},r=function(p,m,w){return n(ee.DES,p,m,w)},n=function(p,m,w,C){var T=ee.enc.Hex.parse(m),q=ee.enc.Hex.parse(w),F=ee.enc.Hex.parse(C),j={};j.key=q,j.iv=F,j.ciphertext=T;var k=p.decrypt(j,q,{iv:F});return ee.enc.Hex.stringify(k)},i=function(p,m,w){return o(ee.AES,p,m,w)},s=function(p,m,w){return o(ee.TripleDES,p,m,w)},a=function(p,m,w){return o(ee.DES,p,m,w)},o=function(p,m,w,C){var T=ee.enc.Hex.parse(m),q=ee.enc.Hex.parse(w),F=ee.enc.Hex.parse(C),j=p.encrypt(T,q,{iv:F}),k=ee.enc.Hex.parse(j.toString()),I=ee.enc.Base64.stringify(k);return I},c={"AES-256-CBC":{proc:e,eproc:i,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:i,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:i,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:t,eproc:s,keylen:24,ivlen:8},"DES-CBC":{proc:r,eproc:a,keylen:8,ivlen:8}},u=function(p){return c[p].proc},b=function(p){var m=ee.lib.WordArray.random(p),w=ee.enc.Hex.stringify(m);return w},h=function(p){var m={},w=p.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));w&&(m.cipher=w[1],m.ivsalt=w[2]);var C=p.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));C&&(m.type=C[1]);var T=-1,q=0;p.indexOf(`\r
\r
`)!=-1&&(T=p.indexOf(`\r
\r
`),q=2),p.indexOf(`

`)!=-1&&(T=p.indexOf(`

`),q=1);var F=p.indexOf("-----END");if(T!=-1&&F!=-1){var j=p.substring(T+q*2,F-q);j=j.replace(/\s+/g,""),m.data=j}return m},d=function(p,m,w){for(var C=w.substring(0,16),T=ee.enc.Hex.parse(C),q=ee.enc.Utf8.parse(m),F=c[p].keylen+c[p].ivlen,j="",k=null;;){var I=ee.algo.MD5.create();if(k!=null&&I.update(k),I.update(q),I.update(T),k=I.finalize(),j=j+ee.enc.Hex.stringify(k),j.length>=F*2)break}var R={};return R.keyhex=j.substr(0,c[p].keylen*2),R.ivhex=j.substr(c[p].keylen*2,c[p].ivlen*2),R},l=function(p,m,w,C){var T=ee.enc.Base64.parse(p),q=ee.enc.Hex.stringify(T),F=c[m].proc,j=F(q,w,C);return j},y=function(p,m,w,C){var T=c[m].eproc,q=T(p,w,C);return q};return{version:"1.0.0",parsePKCS5PEM:function(p){return h(p)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(p,m,w){return d(p,m,w)},decryptKeyB64:function(p,m,w,C){return l(p,m,w,C)},getDecryptedKeyHex:function(p,m){var w=h(p),C=w.type,T=w.cipher,q=w.ivsalt,F=w.data,j=d(T,m,q),k=j.keyhex,I=l(F,T,k,q);return I},getEncryptedPKCS5PEMFromPrvKeyHex:function(p,m,w,C,T){var A="";if((typeof C>"u"||C==null)&&(C="AES-256-CBC"),typeof c[C]>"u")throw new Error("KEYUTIL unsupported algorithm: "+C);if(typeof T>"u"||T==null){var q=c[C].ivlen,F=b(q);T=F.toUpperCase()}var j=d(C,w,T),k=j.keyhex,I=y(m,C,k,T),R=I.replace(/(.{64})/g,`$1\r
`),A="-----BEGIN "+p+` PRIVATE KEY-----\r
`;return A+=`Proc-Type: 4,ENCRYPTED\r
`,A+="DEK-Info: "+C+","+T+`\r
`,A+=`\r
`,A+=R,A+=`\r
-----END `+p+` PRIVATE KEY-----\r
`,A},getEncryptedPKCS8PEM:function(p,m,w){var C=this.getEncryptedPKCS8Hex(p,m,w);return Fn(C,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(p,m,w){var C;w==null||w==null?C={}:C=JSON.parse(JSON.stringify(w)),C.plain=p,this.initPBES2Param(C),this.encryptPBES2Param(C,m);var T=this.generatePBES2ASN1Param(C);return _.asn1.ASN1Util.newObject(T).tohex()},initPBES2Param:function(p){if(Nt(p,"encalg")==null&&(p.encalg="aes256-CBC"),Nt(p,"iter")==null&&(p.iter=2048),Nt(p,"prf")==null&&(p.prf="hmacWithSHA256"),Nt(p,"salt")==null&&(p.salt=ee.enc.Hex.stringify(ee.lib.WordArray.random(8))),Nt(p,"enciv")==null){var m;p.encalg=="des-EDE3-CBC"&&(m=8),p.encalg=="aes128-CBC"&&(m=16),p.encalg=="aes256-CBC"&&(m=16),p.enciv=ee.enc.Hex.stringify(ee.lib.WordArray.random(m))}},encryptPBES2Param:function(p,m){var w=at.getDKFromPBES2Param(p,m);try{var C=_.crypto.Cipher.encrypt(p.plain,w,p.encalg,{iv:p.enciv})}catch{throw new Error("encrypt error: "+p.plain+" "+w+" "+p.encalg+" "+p.enciv)}p.enc=C},generatePBES2ASN1Param:function(p){var m={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:p.salt}},{int:{hex:l_(p.iter)}}]}]},{seq:[{oid:p.encalg},{octstr:{hex:p.enciv}}]}]}]},{octstr:{hex:p.enc}}]};return p.prf!="hmacWithSHA1"&&m.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:p.prf},{null:""}]}),m},parseHexOfEncryptedPKCS8:function(p){var m=X,w=m.getChildIdx,C=m.getV,T={},q=w(p,0);if(q.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+q.length);T.ciphertext=C(p,q[1]);var F=w(p,q[0]);if(F.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+F.length);if(C(p,F[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var j=w(p,F[1]);if(F.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+j.length);var k=w(p,j[1]);if(k.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+k.length);if(C(p,k[0])!="2a864886f70d0307")throw"this only supports TripleDES";T.encryptionSchemeAlg="TripleDES",T.encryptionSchemeIV=C(p,k[1]);var I=w(p,j[0]);if(I.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+I.length);if(C(p,I[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var R=w(p,I[1]);if(R.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+R.length);T.pbkdf2Salt=C(p,R[0]);var A=C(p,R[1]);try{T.pbkdf2Iter=parseInt(A,16)}catch{throw new Error("malformed format pbkdf2Iter: "+A)}return T},getPBKDF2KeyHexFromParam:function(p,m){var w=ee.enc.Hex.parse(p.pbkdf2Salt),C=p.pbkdf2Iter,T=ee.PBKDF2(m,w,{keySize:192/32,iterations:C}),q=ee.enc.Hex.stringify(T);return q},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(p,m){var w=or(p,"ENCRYPTED PRIVATE KEY"),C=this.parseHexOfEncryptedPKCS8(w),T=at.getPBKDF2KeyHexFromParam(C,m),q={};q.ciphertext=ee.enc.Hex.parse(C.ciphertext);var F=ee.enc.Hex.parse(T),j=ee.enc.Hex.parse(C.encryptionSchemeIV),k=ee.TripleDES.decrypt(q,F,{iv:j}),I=ee.enc.Hex.stringify(k);return I},parsePBES2:function(p){var m=X.parse(p);if(Nt(m,"seq.0.seq.0.oid")!="pkcs5PBES2"||Nt(m,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var w=Nt(m,"seq.0.seq.1.seq.0.seq.1.seq");if(w==null)throw new Error("PBKDF2 parameter not found");var C=Nt(w,"0.octstr.hex"),T=Nt(w,"1.int.hex"),q=Nt(w,"2.seq.0.oid","hmacWithSHA1"),F=-1;try{F=parseInt(T,16)}catch{throw new Error("iter not proper value")}var j=Nt(m,"seq.0.seq.1.seq.1.seq.0.oid"),k=Nt(m,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),I=Nt(m,"seq.1.octstr.hex");if(j==null||k==null||I==null)throw new Error("encalg, enciv or enc is undefined");var R={salt:C,iter:F,prf:q,encalg:j,enciv:k,enc:I};return R},getDKFromPBES2Param:function(p,m){var w={hmacWithSHA1:ee.algo.SHA1,hmacWithSHA224:ee.algo.SHA224,hmacWithSHA256:ee.algo.SHA256,hmacWithSHA384:ee.algo.SHA384,hmacWithSHA512:ee.algo.SHA512},C={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},T=w[p.prf];if(T==null)throw new Error("unsupported prf");var q=C[p.encalg];if(q==null)throw new Error("unsupported encalg");var F=ee.enc.Hex.parse(p.salt),j=p.iter;try{var k=ee.PBKDF2(m,F,{keySize:q,iterations:j,hasher:T});return ee.enc.Hex.stringify(k)}catch(I){throw new Error("PBKDF2 error: "+I+" "+JSON.stringify(p)+" "+m)}},getPlainHexFromEncryptedPKCS8PEM:function(p,m){if(p.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var w=or(p),C;try{C=at.parsePBES2(w)}catch(q){throw new Error("malformed PBES2 format: "+q.message)}var T=at.getDKFromPBES2Param(C,m);return _.crypto.Cipher.decrypt(C.enc,T,C.encalg,{iv:C.enciv})},getKeyFromEncryptedPKCS8PEM:function(p,m){var w=this.getPlainHexFromEncryptedPKCS8PEM(p,m),C=this.getKeyFromPlainPrivatePKCS8Hex(w);return C},parsePlainPrivatePKCS8Hex:function(p){var m=X,w=m.getChildIdx,C=m.getV,T={};if(T.algparam=null,p.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var q=w(p,0);if(q.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(p.substr(q[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var F=w(p,q[1]);if(F.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(p.substr(F[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(T.algoid=C(p,F[0]),p.substr(F[1],2)=="06"&&(T.algparam=C(p,F[1])),p.substr(q[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return T.keyidx=m.getVidx(p,q[2]),T},getKeyFromPlainPrivatePKCS8PEM:function(p){var m=or(p,"PRIVATE KEY"),w=this.getKeyFromPlainPrivatePKCS8Hex(m);return w},getKeyFromPlainPrivatePKCS8Hex:function(p){var m=this.parsePlainPrivatePKCS8Hex(p),w;if(m.algoid=="2a864886f70d010101")w=new ve;else if(m.algoid=="2a8648ce380401")w=new _.crypto.DSA;else if(m.algoid=="2a8648ce3d0201")w=new _.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return w.readPKCS8PrvKeyHex(p),w},_getKeyFromPublicPKCS8Hex:function(p){var m,w=X.getVbyList(p,0,[0,0],"06");if(w==="2a864886f70d010101")m=new ve;else if(w==="2a8648ce380401")m=new _.crypto.DSA;else if(w==="2a8648ce3d0201")m=new _.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return m.readPKCS8PubKeyHex(p),m},parsePublicRawRSAKeyHex:function(p){var m=X,w=m.getChildIdx,C=m.getV,T={};if(p.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var q=w(p,0);if(q.length!=2)throw new Error("malformed RSA key(code:002)");if(p.substr(q[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(T.n=C(p,q[0]),p.substr(q[1],2)!="02")throw new Error("malformed RSA key(code:004)");return T.e=C(p,q[1]),T},parsePublicPKCS8Hex:function(p){var m=X,w=m.getChildIdx,C=m.getV,T={};T.algparam=null;var q=w(p,0);if(q.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+q.length);var F=q[0];if(p.substr(F,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var j=w(p,F);if(j.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(p.substr(j[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(T.algoid=C(p,j[0]),p.substr(j[1],2)=="06"?T.algparam=C(p,j[1]):p.substr(j[1],2)=="30"&&(T.algparam={},T.algparam.p=m.getVbyList(p,j[1],[0],"02"),T.algparam.q=m.getVbyList(p,j[1],[1],"02"),T.algparam.g=m.getVbyList(p,j[1],[2],"02")),p.substr(q[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return T.key=C(p,q[1]).substr(2),T}}}();at.getKey=function(e,t,r){var n=X,i=n.getChildIdx,s=n.getV,a=n.getVbyList,o=_.crypto,c=o.ECDSA,u=o.DSA,b=ve,h=or,d=at;if(typeof b<"u"&&e instanceof b||typeof c<"u"&&e instanceof c||typeof u<"u"&&e instanceof u)return e;if(e.curve!==void 0&&e.xy!==void 0&&e.d===void 0)return new c({pub:e.xy,curve:e.curve});if(e.curve!==void 0&&e.d!==void 0)return new c({prv:e.d,curve:e.curve});if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var l=new b;return l.setPublic(e.n,e.e),l}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.co!==void 0&&e.qi===void 0){var l=new b;return l.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),l}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p===void 0){var l=new b;return l.setPrivate(e.n,e.e,e.d),l}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x===void 0){var l=new u;return l.setPublic(e.p,e.q,e.g,e.y),l}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x!==void 0){var l=new u;return l.setPrivate(e.p,e.q,e.g,e.y,e.x),l}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var l=new b;return l.setPublic(tr(e.n),tr(e.e)),l}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.qi!==void 0){var l=new b;return l.setPrivateEx(tr(e.n),tr(e.e),tr(e.d),tr(e.p),tr(e.q),tr(e.dp),tr(e.dq),tr(e.qi)),l}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0){var l=new b;return l.setPrivate(tr(e.n),tr(e.e),tr(e.d)),l}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d===void 0){var y=new c({curve:e.crv}),p=y.ecparams.keycharlen,m=("0000000000"+tr(e.x)).slice(-p),w=("0000000000"+tr(e.y)).slice(-p),C="04"+m+w;return y.setPublicKeyHex(C),y}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d!==void 0){var y=new c({curve:e.crv}),p=y.ecparams.keycharlen,m=("0000000000"+tr(e.x)).slice(-p),w=("0000000000"+tr(e.y)).slice(-p),C="04"+m+w,T=("0000000000"+tr(e.d)).slice(-p);return y.setPublicKeyHex(C),y.setPrivateKeyHex(T),y}if(r==="pkcs5prv"){var q=e,n=X,F,l;if(F=i(q,0),F.length===9)l=new b,l.readPKCS5PrvKeyHex(q);else if(F.length===6)l=new u,l.readPKCS5PrvKeyHex(q);else if(F.length>2&&q.substr(F[1],2)==="04")l=new c,l.readPKCS5PrvKeyHex(q);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return l}if(r==="pkcs8prv"){var l=d.getKeyFromPlainPrivatePKCS8Hex(e);return l}if(r==="pkcs8pub")return d._getKeyFromPublicPKCS8Hex(e);if(r==="x509pub")return ye.getPublicKeyFromCertHex(e);if(e.indexOf("-END CERTIFICATE-",0)!=-1||e.indexOf("-END X509 CERTIFICATE-",0)!=-1||e.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return ye.getPublicKeyFromCertPEM(e);if(e.indexOf("-END PUBLIC KEY-")!=-1){var j=or(e,"PUBLIC KEY");return d._getKeyFromPublicPKCS8Hex(j)}if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var k=h(e,"RSA PRIVATE KEY");return d.getKey(k,null,"pkcs5prv")}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var I=h(e,"DSA PRIVATE KEY"),R=a(I,0,[1],"02"),A=a(I,0,[2],"02"),f=a(I,0,[3],"02"),g=a(I,0,[4],"02"),E=a(I,0,[5],"02"),l=new u;return l.setPrivate(new U(R,16),new U(A,16),new U(f,16),new U(g,16),new U(E,16)),l}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var k=h(e,"EC PRIVATE KEY");return d.getKey(k,null,"pkcs5prv")}if(e.indexOf("-END PRIVATE KEY-")!=-1)return d.getKeyFromPlainPrivatePKCS8PEM(e);if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var x=d.getDecryptedKeyHex(e,t),S=new ve;return S.readPKCS5PrvKeyHex(x),S}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var I=d.getDecryptedKeyHex(e,t),l=a(I,0,[1],"04"),P=a(I,0,[2,0],"06"),O=a(I,0,[3,0],"03").substr(2),B="";if(_.crypto.OID.oidhex2name[P]!==void 0)B=_.crypto.OID.oidhex2name[P];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+P);var y=new c({curve:B});return y.setPublicKeyHex(O),y.setPrivateKeyHex(l),y.isPublic=!1,y}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var I=d.getDecryptedKeyHex(e,t),R=a(I,0,[1],"02"),A=a(I,0,[2],"02"),f=a(I,0,[3],"02"),g=a(I,0,[4],"02"),E=a(I,0,[5],"02"),l=new u;return l.setPrivate(new U(R,16),new U(A,16),new U(f,16),new U(g,16),new U(E,16)),l}if(e.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return d.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")};at.generateKeypair=function(e,t){if(e=="RSA"){var r=t,n=new ve;n.generate(r,"10001"),n.isPrivate=!0,n.isPublic=!0;var i=new ve,s=n.n.toString(16),a=n.e.toString(16);i.setPublic(s,a),i.isPrivate=!1,i.isPublic=!0;var o={};return o.prvKeyObj=n,o.pubKeyObj=i,o}else if(e=="EC"){var c=t,u=new _.crypto.ECDSA({curve:c}),b=u.generateKeyPairHex(),n=new _.crypto.ECDSA({curve:c});n.setPublicKeyHex(b.ecpubhex),n.setPrivateKeyHex(b.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var i=new _.crypto.ECDSA({curve:c});i.setPublicKeyHex(b.ecpubhex),i.isPrivate=!1,i.isPublic=!0;var o={};return o.prvKeyObj=n,o.pubKeyObj=i,o}else throw new Error("unknown algorithm: "+e)};at.getPEM=function(e,t,r,n,i,s){var a=_,o=a.asn1,c=o.DERObjectIdentifier,u=o.DERInteger,b=o.ASN1Util.newObject,h=o.x509,d=h.SubjectPublicKeyInfo,l=a.crypto,y=l.DSA,p=l.ECDSA,m=ve;function w(S){var P=b({seq:[{int:0},{int:{bigint:S.n}},{int:S.e},{int:{bigint:S.d}},{int:{bigint:S.p}},{int:{bigint:S.q}},{int:{bigint:S.dmp1}},{int:{bigint:S.dmq1}},{int:{bigint:S.coeff}}]});return P}function C(S){var P=b({seq:[{int:1},{octstr:{hex:S.prvKeyHex}},{tag:["a0",!0,{oid:{name:S.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+S.pubKeyHex}}]}]});return P}function T(S){var P=b({seq:[{int:0},{int:{bigint:S.p}},{int:{bigint:S.q}},{int:{bigint:S.g}},{int:{bigint:S.y}},{int:{bigint:S.x}}]});return P}if((m!==void 0&&e instanceof m||y!==void 0&&e instanceof y||p!==void 0&&e instanceof p)&&e.isPublic==!0&&(t===void 0||t=="PKCS8PUB")){var q=new d(e),F=q.tohex();return Fn(F,"PUBLIC KEY")}if(t=="PKCS1PRV"&&m!==void 0&&e instanceof m&&(r===void 0||r==null)&&e.isPrivate==!0){var q=w(e),F=q.tohex();return Fn(F,"RSA PRIVATE KEY")}if(t=="PKCS1PRV"&&p!==void 0&&e instanceof p&&(r===void 0||r==null)&&e.isPrivate==!0){var j=new c({name:e.curveName}),k=j.tohex(),I=C(e),R=I.tohex(),A="";return A+=Fn(k,"EC PARAMETERS"),A+=Fn(R,"EC PRIVATE KEY"),A}if(t=="PKCS1PRV"&&y!==void 0&&e instanceof y&&(r===void 0||r==null)&&e.isPrivate==!0){var q=T(e),F=q.tohex();return Fn(F,"DSA PRIVATE KEY")}if(t=="PKCS5PRV"&&m!==void 0&&e instanceof m&&r!==void 0&&r!=null&&e.isPrivate==!0){var q=w(e),F=q.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",F,r,n,s)}if(t=="PKCS5PRV"&&p!==void 0&&e instanceof p&&r!==void 0&&r!=null&&e.isPrivate==!0){var q=C(e),F=q.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",F,r,n,s)}if(t=="PKCS5PRV"&&y!==void 0&&e instanceof y&&r!==void 0&&r!=null&&e.isPrivate==!0){var q=T(e),F=q.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",F,r,n,s)}var f=function(S,P){if(typeof P=="string")return at.getEncryptedPKCS8PEM(S,P);if(typeof P=="object"&&Nt(P,"passcode")!=null){var O=JSON.parse(JSON.stringify(P)),B=O.passcode;return delete O.passcode,at.getEncryptedPKCS8PEM(S,B,O)}};if(t=="PKCS8PRV"&&m!=null&&e instanceof m&&e.isPrivate==!0){var g=w(e),E=g.tohex(),q=b({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:E}}]}),F=q.tohex();return r===void 0||r==null?Fn(F,"PRIVATE KEY"):f(F,r)}if(t=="PKCS8PRV"&&p!==void 0&&e instanceof p&&e.isPrivate==!0){var x={seq:[{int:1},{octstr:{hex:e.prvKeyHex}}]};typeof e.pubKeyHex=="string"&&x.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]});var g=new b(x),E=g.tohex(),q=b({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:E}}]}),F=q.tohex();return r===void 0||r==null?Fn(F,"PRIVATE KEY"):f(F,r)}if(t=="PKCS8PRV"&&y!==void 0&&e instanceof y&&e.isPrivate==!0){var g=new u({bigint:e.x}),E=g.tohex(),q=b({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:E}}]}),F=q.tohex();return r===void 0||r==null?Fn(F,"PRIVATE KEY"):f(F,r)}throw new Error("unsupported object nor format")};at.getKeyFromCSRPEM=function(e){var t=or(e,"CERTIFICATE REQUEST"),r=at.getKeyFromCSRHex(t);return r};at.getKeyFromCSRHex=function(e){var t=at.parseCSRHex(e),r=at.getKey(t.p8pubkeyhex,null,"pkcs8pub");return r};at.parseCSRHex=function(e){var t=X,r=t.getChildIdx,n=t.getTLV,i={},s=e;if(s.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var a=r(s,0);if(a.length<1)throw new Error("malformed CSR(code:002)");if(s.substr(a[0],2)!="30")throw new Error("malformed CSR(code:003)");var o=r(s,a[0]);if(o.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=n(s,o[2]),i};at.getKeyID=function(e){var t=at,r=X;typeof e=="string"&&e.indexOf("BEGIN ")!=-1&&(e=t.getKey(e));var n=or(t.getPEM(e)),i=r.getIdxbyList(n,0,[1]),s=r.getV(n,i).substring(2);return _.crypto.Util.hashHex(s,"sha1")};at.getJWK=function(e,t,r,n,i){var s,a={},o,c=_.crypto.Util.hashHex;if(typeof e=="string")s=at.getKey(e),e.indexOf("CERTIFICATE")!=-1&&(o=or(e));else if(typeof e=="object")e instanceof ye?(s=e.getPublicKey(),o=e.hex):s=e;else throw new Error("unsupported keyinfo type");if(s instanceof ve&&s.isPrivate)a.kty="RSA",a.n=Hr(s.n.toString(16)),a.e=Hr(s.e.toString(16)),a.d=Hr(s.d.toString(16)),a.p=Hr(s.p.toString(16)),a.q=Hr(s.q.toString(16)),a.dp=Hr(s.dmp1.toString(16)),a.dq=Hr(s.dmq1.toString(16)),a.qi=Hr(s.coeff.toString(16));else if(s instanceof ve&&s.isPublic)a.kty="RSA",a.n=Hr(s.n.toString(16)),a.e=Hr(s.e.toString(16));else if(s instanceof _.crypto.ECDSA&&s.isPrivate){var u=s.getShortNISTPCurveName();if(u!=="P-256"&&u!=="P-384"&&u!=="P-521")throw new Error("unsupported curve name for JWT: "+u);var b=s.getPublicKeyXYHex();a.kty="EC",a.crv=u,a.x=Hr(b.x),a.y=Hr(b.y),a.d=Hr(s.prvKeyHex)}else if(s instanceof _.crypto.ECDSA&&s.isPublic){var u=s.getShortNISTPCurveName();if(u!=="P-256"&&u!=="P-384"&&u!=="P-521")throw new Error("unsupported curve name for JWT: "+u);var b=s.getPublicKeyXYHex();a.kty="EC",a.crv=u,a.x=Hr(b.x),a.y=Hr(b.y)}if(a.kty==null)throw new Error("unsupported keyinfo");return!s.isPrivate&&t!=!0&&(a.kid=_.jws.JWS.getJWKthumbprint(a)),o!=null&&r!=!0&&(a.x5c=[Pa(o)]),o!=null&&n!=!0&&(a.x5t=Iu(Pa(c(o,"sha1")))),o!=null&&i!=!0&&(a["x5t#S256"]=Iu(Pa(c(o,"sha256")))),a};at.getJWKFromKey=function(e){return at.getJWK(e,!0,!0,!0,!0)};ve.getPosArrayOfChildrenFromHex=function(e){return X.getChildIdx(e,0)};ve.getHexValueArrayOfChildrenFromHex=function(e){var t=X,r=t.getV,d=ve.getPosArrayOfChildrenFromHex(e),n=r(e,d[0]),i=r(e,d[1]),s=r(e,d[2]),a=r(e,d[3]),o=r(e,d[4]),c=r(e,d[5]),u=r(e,d[6]),b=r(e,d[7]),h=r(e,d[8]),d=new Array;return d.push(n,i,s,a,o,c,u,b,h),d};ve.prototype.readPrivateKeyFromPEMString=function(e){var t=or(e),r=ve.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])};ve.prototype.readPKCS5PrvKeyHex=function(e){var t=ve.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])};ve.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,s,a,o,c,u=X,b=u.getVbyListEx;if(u.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");try{t=b(e,0,[2,0,1],"02"),r=b(e,0,[2,0,2],"02"),n=b(e,0,[2,0,3],"02"),i=b(e,0,[2,0,4],"02"),s=b(e,0,[2,0,5],"02"),a=b(e,0,[2,0,6],"02"),o=b(e,0,[2,0,7],"02"),c=b(e,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,i,s,a,o,c)};ve.prototype.readPKCS5PubKeyHex=function(e){var t=X,r=t.getV;if(t.isASN1HEX(e)===!1)throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(n.length!==2||e.substr(n[0],2)!=="02"||e.substr(n[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var i=r(e,n[0]),s=r(e,n[1]);this.setPublic(i,s)};ve.prototype.readPKCS8PubKeyHex=function(e){var t=X;if(t.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");if(t.getTLVbyListEx(e,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)};ve.prototype.readCertPubKeyHex=function(e,t){var r,n;r=new ye,r.readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var Ane=new RegExp("[^0-9a-f]","gi");function g_(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r=r+"0";return r+e}ve.prototype.sign=function(e,t){var r=function(i){return _.crypto.Util.hashString(i,t)},n=r(e);return this.signWithMessageHash(n,t)};ve.prototype.signWithMessageHash=function(e,t){var r=_.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),n=qn(r,16),i=this.doPrivate(n),s=i.toString(16);return g_(s,this.n.bitLength())};function v_(e,t,r){for(var n="",i=0;n.length<t;)n+=Hn(r(Ui(e+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])))),i+=1;return n}ve.prototype.signPSS=function(e,t,r){var n=function(s){return _.crypto.Util.hashHex(s,t)},i=n(Ui(e));return r===void 0&&(r=-1),this.signWithMessageHashPSS(i,t,r)};ve.prototype.signWithMessageHashPSS=function(e,t,r){var n=Hn(e),i=n.length,s=this.n.bitLength()-1,a=Math.ceil(s/8),o,c=function(m){return _.crypto.Util.hashHex(m,t)};if(r===-1||r===void 0)r=i;else if(r===-2)r=a-i-2;else if(r<-2)throw new Error("invalid salt length");if(a<i+r+2)throw new Error("data too long");var u="";r>0&&(u=new Array(r),new Ao().nextBytes(u),u=String.fromCharCode.apply(String,u));var b=Hn(c(Ui("\0\0\0\0\0\0\0\0"+n+u))),h=[];for(o=0;o<a-r-i-2;o+=1)h[o]=0;var d=String.fromCharCode.apply(String,h)+""+u,l=v_(b,d.length,c),y=[];for(o=0;o<d.length;o+=1)y[o]=d.charCodeAt(o)^l.charCodeAt(o);var p=65280>>8*a-s&255;for(y[0]&=~p,o=0;o<i;o++)y.push(b.charCodeAt(o));return y.push(188),g_(this.doPrivate(new U(y)).toString(16),this.n.bitLength())};function y_(e){for(var t in _.crypto.Util.DIGESTINFOHEAD){var r=_.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r){var i=[t,e.substring(n)];return i}}return[]}ve.prototype.verify=function(e,t){if(t=t.toLowerCase(),t.match(/^[0-9a-f]+$/)==null)return!1;var r=qn(t,16),n=this.n.bitLength();if(r.bitLength()>n)return!1;var i=this.doPublic(r),s=i.toString(16);if(s.length+3!=n/4)return!1;var a=s.replace(/^1f+00/,""),o=y_(a);if(o.length==0)return!1;var c=o[0],u=o[1],b=function(d){return _.crypto.Util.hashString(d,c)},h=b(e);return u==h};ve.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=qn(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),i=n.toString(16).replace(/^1f+00/,""),s=y_(i);if(s.length==0)return!1;var a=s[0],o=s[1];return o==e};ve.prototype.verifyPSS=function(e,t,r,n){var i=function(a){return _.crypto.Util.hashHex(a,r)},s=i(Ui(e));return n===void 0&&(n=-1),this.verifyWithMessageHashPSS(s,t,r,n)};ve.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var i=new U(t,16),s=function(C){return _.crypto.Util.hashHex(C,r)},a=Hn(e),o=a.length,c=this.n.bitLength()-1,u=Math.ceil(c/8),b;if(n===-1||n===void 0)n=o;else if(n===-2)n=u-o-2;else if(n<-2)throw new Error("invalid salt length");if(u<o+n+2)throw new Error("data too long");var h=this.doPublic(i).toByteArray();for(b=0;b<h.length;b+=1)h[b]&=255;for(;h.length<u;)h.unshift(0);if(h[u-1]!==188)throw new Error("encoded message does not end in 0xbc");h=String.fromCharCode.apply(String,h);var d=h.substr(0,u-o-1),l=h.substr(d.length,o),y=65280>>8*u-c&255;if((d.charCodeAt(0)&y)!==0)throw new Error("bits beyond keysize not zero");var p=v_(l,d.length,s),m=[];for(b=0;b<d.length;b+=1)m[b]=d.charCodeAt(b)^p.charCodeAt(b);m[0]&=~y;var w=u-o-n-2;for(b=0;b<w;b+=1)if(m[b]!==0)throw new Error("leftmost octets not zero");if(m[w]!==1)throw new Error("0x01 marker not found");return l===Hn(s(Ui("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,m.slice(-n)))))};ve.SALT_LEN_HLEN=-1;ve.SALT_LEN_MAX=-2;ve.SALT_LEN_RECOVER=-2;function ye(e){var t=X,r=t.getChildIdx,n=t.getV,i=t.dump,s=t.parse,a=t.getTLV,o=t.getVbyList,c=t.getVbyListEx,u=t.getTLVbyList,b=t.getTLVbyListEx,h=t.getIdxbyList,d=t.getIdxbyListEx,l=t.getVidx,y=t.getInt,p=t.oidname,m=t.hextooidstr,w=ye,C=or,T,q=Error;try{T=_.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var I=u(this.hex,0,[0,0]);if(I.substr(0,2)=="a0"){var R=u(I,0,[0]),A=y(R,0);if(A<0||2<A)throw new Error("malformed version field");return this.version=A+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return c(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var I=b(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(I)},this.getAlgorithmIdentifierName=function(I){for(var R in T)if(I===T[R])return R;return p(c(I,0,[0],"06"))},this.getIssuer=function(I,R){return this.getX500Name(this.getIssuerHex(),I,R)},this.getIssuerHex=function(){return u(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var I=this.getIssuer();return I.str},this.getSubject=function(I,R){return this.getX500Name(this.getSubjectHex(),I,R)},this.getSubjectHex=function(){return u(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var I=this.getSubject();return I.str},this.getNotBefore=function(){var I=o(this.hex,0,[0,4+this.foffset,0]);return I=I.replace(/(..)/g,"%$1"),I=decodeURIComponent(I),I},this.getNotAfter=function(){var I=o(this.hex,0,[0,4+this.foffset,1]);return I=I.replace(/(..)/g,"%$1"),I=decodeURIComponent(I),I},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return u(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var I=this.getSPKI();return I==null?null:o(I,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return h(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var I=this.getPublicKeyIdx();return h(this.hex,I,[1,0],"30")},this.getPublicKey=function(){return at.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var I=u(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(I)},this.getSignatureValueHex=function(){return o(this.hex,0,[2],"03",!0)},this.verifySignature=function(I){var R=this.getSignatureAlgorithmField(),A=this.getSignatureValueHex(),f=u(this.hex,0,[0],"30"),g=new _.crypto.Signature({alg:R});return g.init(I),g.updateHex(f),g.verify(A)},this.parseExt=function(I){var R,A,f;if(I===void 0){if(f=this.hex,this.version!==3)return-1;R=h(f,0,[0,7,0],"30"),A=r(f,R)}else{f=or(I);var g=h(f,0,[0,3,0,0],"06");if(n(f,g)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}R=h(f,0,[0,3,0,1,0],"30"),A=r(f,R),this.hex=f}this.aExtInfo=new Array;for(var E=0;E<A.length;E++){var x={};x.critical=!1;var S=r(f,A[E]),P=0;S.length===3&&(x.critical=!0,P=1),x.oid=t.hextooidstr(o(f,A[E],[0],"06"));var O=h(f,A[E],[1+P]);x.vidx=l(f,O),this.aExtInfo.push(x)}},this.getExtInfo=function(I){var R=this.aExtInfo,A=I;if(I.match(/^[0-9.]+$/)||(A=_.asn1.x509.OID.name2oid(I)),A!==""){for(var f=0;f<R.length;f++)if(R[f].oid===A)return R[f]}},this.getCriticalExtV=function(I,R,A){if(R!=null)return[R,A];var f=this.getExtInfo(I);return f==null?[null,null]:[a(this.hex,f.vidx),f.critical]},this.getExtBasicConstraints=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("basicConstraints");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"basicConstraints"};if(R&&(f.critical=!0),I==="3000")return f;if(I==="30030101ff")return f.cA=!0,f;if(I.substr(0,12)==="30060101ff02"){var g=n(I,10),E=parseInt(g,16);return f.cA=!0,f.pathLen=E,f}throw new Error("hExtV parse error: "+I)},this.getExtNameConstraints=function(I,R){var A=this.getCriticalExtV("nameConstraints",I,R);if(I=A[0],R=A[1],I!=null){var f={extname:"nameConstraints"};R&&(f.critical=!0);for(var g=r(I,0),E=0;E<g.length;E++){for(var x=[],S=r(I,g[E]),P=0;P<S.length;P++){var O=a(I,S[P]),B=this.getGeneralSubtree(O);x.push(B)}var v=I.substr(g[E],2);v=="a0"?f.permit=x:v=="a1"&&(f.exclude=x)}return f}},this.getGeneralSubtree=function(I){var R=r(I,0),A=R.length;if(A<1||2<A)throw new Error("wrong num elements");for(var f=this.getGeneralName(a(I,R[0])),g=1;g<A;g++){var E=I.substr(R[g],2),x=n(I,R[g]),S=parseInt(x,16);E=="80"&&(f.min=S),E=="81"&&(f.max=S)}return f},this.getExtKeyUsage=function(I,R){var A=this.getCriticalExtV("keyUsage",I,R);if(I=A[0],R=A[1],I!=null){var f={extname:"keyUsage"};return R&&(f.critical=!0),f.names=this.getExtKeyUsageString(I).split(","),f}},this.getExtKeyUsageBin=function(I){if(I===void 0){var R=this.getExtInfo("keyUsage");if(R===void 0)return"";I=a(this.hex,R.vidx)}if(I.length!=8&&I.length!=10)throw new Error("malformed key usage value: "+I);var A="000000000000000"+parseInt(I.substr(6),16).toString(2);return I.length==8&&(A=A.slice(-8)),I.length==10&&(A=A.slice(-16)),A=A.replace(/0+$/,""),A==""&&(A="0"),A},this.getExtKeyUsageString=function(I){for(var R=this.getExtKeyUsageBin(I),A=new Array,f=0;f<R.length;f++)R.substr(f,1)=="1"&&A.push(ye.KEYUSAGE_NAME[f]);return A.join(",")},this.getExtSubjectKeyIdentifier=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("subjectKeyIdentifier");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"subjectKeyIdentifier"};R&&(f.critical=!0);var g=n(I,0);return f.kid={hex:g},f},this.getExtAuthorityKeyIdentifier=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("authorityKeyIdentifier");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"authorityKeyIdentifier"};R&&(f.critical=!0);for(var g=r(I,0),E=0;E<g.length;E++){var x=I.substr(g[E],2);if(x==="80"&&(f.kid={hex:n(I,g[E])}),x==="a1"){var S=a(I,g[E]),P=this.getGeneralNames(S);f.issuer=P[0].dn}x==="82"&&(f.sn={hex:n(I,g[E])})}return f},this.getExtExtKeyUsage=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("extKeyUsage");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"extKeyUsage",array:[]};R&&(f.critical=!0);for(var g=r(I,0),E=0;E<g.length;E++)f.array.push(p(n(I,g[E])));return f},this.getExtExtKeyUsageName=function(){var I=this.getExtInfo("extKeyUsage");if(I===void 0)return I;var R=new Array,A=a(this.hex,I.vidx);if(A==="")return R;for(var f=r(A,0),g=0;g<f.length;g++)R.push(p(n(A,f[g])));return R},this.getExtSubjectAltName=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("subjectAltName");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"subjectAltName",array:[]};return R&&(f.critical=!0),f.array=this.getGeneralNames(I),f},this.getExtIssuerAltName=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("issuerAltName");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"issuerAltName",array:[]};return R&&(f.critical=!0),f.array=this.getGeneralNames(I),f},this.getGeneralNames=function(I){for(var R=r(I,0),A=[],f=0;f<R.length;f++){var g=this.getGeneralName(a(I,R[f]));g!==void 0&&A.push(g)}return A},this.getGeneralName=function(I){var R=I.substr(0,2),A=n(I,0),f=Hn(A);if(R=="81")return{rfc822:f};if(R=="82")return{dns:f};if(R=="86")return{uri:f};if(R=="87")return{ip:q1(A)};if(R=="a4")return{dn:this.getX500Name(A)};if(R=="a0")return{other:this.getOtherName(I)}},this.getExtSubjectAltName2=function(){var I,R,A,f=this.getExtInfo("subjectAltName");if(f===void 0)return f;for(var g=new Array,E=a(this.hex,f.vidx),x=r(E,0),S=0;S<x.length;S++)A=E.substr(x[S],2),I=n(E,x[S]),A==="81"&&(R=It(I),g.push(["MAIL",R])),A==="82"&&(R=It(I),g.push(["DNS",R])),A==="84"&&(R=ye.hex2dn(I,0),g.push(["DN",R])),A==="86"&&(R=It(I),g.push(["URI",R])),A==="87"&&(R=q1(I),g.push(["IP",R]));return g},this.getExtCRLDistributionPoints=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("cRLDistributionPoints");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"cRLDistributionPoints",array:[]};R&&(f.critical=!0);for(var g=r(I,0),E=0;E<g.length;E++){var x=a(I,g[E]);f.array.push(this.getDistributionPoint(x))}return f},this.getDistributionPoint=function(I){for(var R={},A=r(I,0),f=0;f<A.length;f++){var g=I.substr(A[f],2),E=a(I,A[f]);g=="a0"&&(R.dpname=this.getDistributionPointName(E))}return R},this.getDistributionPointName=function(I){for(var R={},A=r(I,0),f=0;f<A.length;f++){var g=I.substr(A[f],2),E=a(I,A[f]);g=="a0"&&(R.full=this.getGeneralNames(E))}return R},this.getExtCRLDistributionPointsURI=function(){var I=this.getExtCRLDistributionPoints();if(I==null)return I;for(var R=I.array,A=[],f=0;f<R.length;f++)try{R[f].dpname.full[0].uri!=null&&A.push(R[f].dpname.full[0].uri)}catch{}return A},this.getExtAIAInfo=function(){var I=this.getExtInfo("authorityInfoAccess");if(I===void 0)return I;for(var R={ocsp:[],caissuer:[]},A=r(this.hex,I.vidx),f=0;f<A.length;f++){var g=o(this.hex,A[f],[0],"06"),E=o(this.hex,A[f],[1],"86");g==="2b06010505073001"&&R.ocsp.push(It(E)),g==="2b06010505073002"&&R.caissuer.push(It(E))}return R},this.getExtAuthorityInfoAccess=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("authorityInfoAccess");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"authorityInfoAccess",array:[]};R&&(f.critical=!0);for(var g=r(I,0),E=0;E<g.length;E++){var x=c(I,g[E],[0],"06"),S=o(I,g[E],[1],"86"),P=It(S);if(x=="2b06010505073001")f.array.push({ocsp:P});else if(x=="2b06010505073002")f.array.push({caissuer:P});else throw new Error("unknown method: "+x)}return f},this.getExtCertificatePolicies=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("certificatePolicies");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"certificatePolicies",array:[]};R&&(f.critical=!0);for(var g=r(I,0),E=0;E<g.length;E++){var x=a(I,g[E]),S=this.getPolicyInformation(x);f.array.push(S)}return f},this.getPolicyInformation=function(I){var R={},A=o(I,0,[0],"06");R.policyoid=p(A);var f=d(I,0,[1],"30");if(f!=-1){R.array=[];for(var g=r(I,f),E=0;E<g.length;E++){var x=a(I,g[E]),S=this.getPolicyQualifierInfo(x);R.array.push(S)}}return R},this.getOtherName=function(I){var R={},A=r(I,0),f=o(I,A[0],[],"06"),g=o(I,A[1],[]);return R.oid=p(f),R.value=s(g),R},this.getPolicyQualifierInfo=function(I){var R={},A=o(I,0,[0],"06");if(A==="2b06010505070201"){var f=c(I,0,[1],"16");R.cps=Hn(f)}else if(A==="2b06010505070202"){var g=u(I,0,[1],"30");R.unotice=this.getUserNotice(g)}return R},this.getUserNotice=function(I){var R=null,A={};try{R=t.parse(I);var f=this._asn1ToUnotice(R);return f}catch{return}},this._asn1ToUnotice=function(I){try{for(var R={},A=Nt(I,"seq"),f=0;f<A.length;f++){var g=this._asn1ToNoticeRef(A[f]);g!=null&&(R.noticeref=g);var E=this.asn1ToDisplayText(A[f]);E!=null&&(R.exptext=E)}return Object.keys(R).length>0?R:void 0}catch{return}},this._asn1ToNoticeRef=function(I){try{for(var R={},A=Nt(I,"seq"),f=0;f<A.length;f++){var g=this._asn1ToNoticeNum(A[f]);g!=null&&(R.noticenum=g);var E=this.asn1ToDisplayText(A[f]);E!=null&&(R.org=E)}return Object.keys(R).length>0?R:void 0}catch{return}},this._asn1ToNoticeNum=function(I){try{for(var R=Nt(I,"seq"),A=[],f=0;f<R.length;f++){var g=R[f];A.push(parseInt(Nt(g,"int.hex"),16))}return A}catch{return}},this.getDisplayText=function(I){var R={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},A={};return A.type=R[I.substr(0,2)],A.str=Hn(n(I,0)),A},this.asn1ToDisplayText=function(I){if(I.utf8str!=null)return{type:"utf8",str:I.utf8str.str};if(I.ia5str!=null)return{type:"ia5",str:I.ia5str.str};if(I.visstr!=null)return{type:"vis",str:I.visstr.str};if(I.bmpstr!=null)return{type:"bmp",str:I.bmpstr.str};if(I.prnstr!=null)return{type:"prn",str:I.prnstr.str}},this.getExtPolicyMappings=function(I,R){var A=this.getCriticalExtV("policyMappings",I,R);if(I=A[0],R=A[1],I!=null){var f={extname:"policyMappings"};R&&(f.critical=!0);try{for(var g=s(I),E=g.seq,x=[],S=0;S<E.length;S++){var P=E[S].seq;x.push([P[0].oid,P[1].oid])}f.array=x}catch{throw new q("malformed policyMappings")}return f}},this.getExtPolicyConstraints=function(I,R){var A=this.getCriticalExtV("policyConstraints",I,R);if(I=A[0],R=A[1],I!=null){var f={extname:"policyConstraints"};R&&(f.critical=!0);var g=s(I);try{for(var E=g.seq,x=0;x<E.length;x++){var S=E[x].tag;S.explicit==!1&&(S.tag=="80"&&(f.reqexp=parseInt(S.hex,16)),S.tag=="81"&&(f.inhibit=parseInt(S.hex,16)))}}catch{return new q("malformed policyConstraints value")}return f}},this.getExtInhibitAnyPolicy=function(I,R){var A=this.getCriticalExtV("inhibitAnyPolicy",I,R);if(I=A[0],R=A[1],I!=null){var f={extname:"inhibitAnyPolicy"};R&&(f.critical=!0);var g=y(I,0);return g==-1?new q("wrong value"):(f.skip=g,f)}},this.getExtCRLNumber=function(I,R){var A={extname:"cRLNumber"};if(R&&(A.critical=!0),I.substr(0,2)=="02")return A.num={hex:n(I,0)},A;throw new q("hExtV parse error: "+I)},this.getExtCRLReason=function(I,R){var A={extname:"cRLReason"};if(R&&(A.critical=!0),I.substr(0,2)=="0a")return A.code=parseInt(n(I,0),16),A;throw new Error("hExtV parse error: "+I)},this.getExtOcspNonce=function(I,R){var A={extname:"ocspNonce"};R&&(A.critical=!0);var f=n(I,0);return A.hex=f,A},this.getExtOcspNoCheck=function(I,R){var A={extname:"ocspNoCheck"};return R&&(A.critical=!0),A},this.getExtAdobeTimeStamp=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("adobeTimeStamp");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"adobeTimeStamp"};R&&(f.critical=!0);var g=r(I,0);if(g.length>1){var E=a(I,g[1]),x=this.getGeneralName(E);x.uri!=null&&(f.uri=x.uri)}if(g.length>2){var S=a(I,g[2]);S=="0101ff"&&(f.reqauth=!0),S=="010100"&&(f.reqauth=!1)}return f},this.getExtSubjectDirectoryAttributes=function(I,R){if(I===void 0&&R===void 0){var A=this.getExtInfo("subjectDirectoryAttributes");if(A===void 0)return;I=a(this.hex,A.vidx),R=A.critical}var f={extname:"subjectDirectoryAttributes"};R&&(f.critical=!0);try{for(var g=s(I),E=[],x=0;x<g.seq.length;x++){var S=g.seq[x],P=Nt(S,"seq.0.oid"),O=Nt(S,"seq.1.set");if(P==null||O==null)throw"error";E.push({attr:P,array:O})}return f.array=E,f}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var F=function(I){var R={};try{var A=I.seq[0].oid,f=_.asn1.x509.OID.name2oid(A);R.type=_.asn1.x509.OID.oid2atype(f);var g=I.seq[1];if(g.utf8str!=null)R.ds="utf8",R.value=g.utf8str.str;else if(g.numstr!=null)R.ds="num",R.value=g.numstr.str;else if(g.telstr!=null)R.ds="tel",R.value=g.telstr.str;else if(g.prnstr!=null)R.ds="prn",R.value=g.prnstr.str;else if(g.ia5str!=null)R.ds="ia5",R.value=g.ia5str.str;else if(g.visstr!=null)R.ds="vis",R.value=g.visstr.str;else if(g.bmpstr!=null)R.ds="bmp",R.value=g.bmpstr.str;else throw"error";return R}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},j=function(I){try{return I.set.map(function(R){return F(R)})}catch(R){throw new Error("improper ASN.1 parsed RDN: "+R)}},k=function(I){try{return I.seq.map(function(R){return j(R)})}catch(R){throw new Error("improper ASN.1 parsed X500Name: "+R)}};this.getX500NameRule=function(I){for(var R=!0,A=!0,f=!1,g="",E="",x=null,S=[],P=0;P<I.length;P++)for(var O=I[P],B=0;B<O.length;B++)S.push(O[B]);for(var P=0;P<S.length;P++){var v=S[P],M=v.ds,V=v.value,z=v.type;if(g+=":"+M,M!="prn"&&M!="utf8"&&M!="ia5")return"mixed";if(M=="ia5"){if(z!="CN")return"mixed";if(_.lang.String.isMail(V))continue;return"mixed"}if(z=="C"){if(M=="prn")continue;return"mixed"}if(E+=":"+M,x==null)x=M;else if(x!==M)return"mixed"}return x??"prn"},this.getAttrTypeAndValue=function(I){var R=s(I);return F(R)},this.getRDN=function(I){var R=s(I);return j(R)},this.getX500NameArray=function(I){var R=s(I);return k(R)},this.getX500Name=function(I,R,A){var f=this.getX500NameArray(I),g=this.dnarraytostr(f),E={str:g};return E.array=f,A==!0&&(E.hex=I),R==!0&&(E.canon=this.c14nRDNArray(f)),E},this.readCertPEM=function(I){this.readCertHex(C(I))},this.readCertHex=function(I){this.hex=I,this.getVersion();try{h(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(I){var R={};return I==null&&(I={}),R.version=this.getVersion(),R.serial={hex:this.getSerialNumberHex()},R.sigalg=this.getSignatureAlgorithmField(),R.issuer=this.getIssuer(I.dncanon,I.dnhex),R.notbefore=this.getNotBefore(),R.notafter=this.getNotAfter(),R.subject=this.getSubject(I.dncanon,I.dnhex),R.sbjpubkey=Fn(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(R.ext=this.getExtParamArray()),R.sighex=this.getSignatureValueHex(),I.tbshex==!0&&(R.tbshex=u(this.hex,0,[0])),I.nodnarray==!0&&(delete R.issuer.array,delete R.subject.array),R},this.getExtParamArray=function(I){if(I==null){var R=d(this.hex,0,[0,"[3]"]);R!=-1&&(I=b(this.hex,0,[0,"[3]",0],"30"))}for(var A=[],f=r(I,0),g=0;g<f.length;g++){var E=a(I,f[g]),x=this.getExtParam(E);x!=null&&A.push(x)}return A},this.getExtParam=function(I){var R={},A=r(I,0),f=A.length;if(f!=2&&f!=3)throw new Error("wrong number elements in Extension: "+f+" "+I);var g=m(o(I,0,[0],"06")),E=!1;f==3&&u(I,0,[1])=="0101ff"&&(E=!0);var x=u(I,0,[f-1,0]),S=void 0;if(g=="2.5.29.14"?S=this.getExtSubjectKeyIdentifier(x,E):g=="2.5.29.15"?S=this.getExtKeyUsage(x,E):g=="2.5.29.17"?S=this.getExtSubjectAltName(x,E):g=="2.5.29.18"?S=this.getExtIssuerAltName(x,E):g=="2.5.29.19"?S=this.getExtBasicConstraints(x,E):g=="2.5.29.30"?S=this.getExtNameConstraints(x,E):g=="2.5.29.31"?S=this.getExtCRLDistributionPoints(x,E):g=="2.5.29.32"?S=this.getExtCertificatePolicies(x,E):g=="2.5.29.33"?S=this.getExtPolicyMappings(x,E):g=="2.5.29.35"?S=this.getExtAuthorityKeyIdentifier(x,E):g=="2.5.29.36"?S=this.getExtPolicyConstraints(x,E):g=="2.5.29.37"?S=this.getExtExtKeyUsage(x,E):g=="2.5.29.54"?S=this.getExtInhibitAnyPolicy(x,E):g=="1.3.6.1.5.5.7.1.1"?S=this.getExtAuthorityInfoAccess(x,E):g=="2.5.29.20"?S=this.getExtCRLNumber(x,E):g=="2.5.29.21"?S=this.getExtCRLReason(x,E):g=="2.5.29.9"?S=this.getExtSubjectDirectoryAttributes(x,E):g=="1.3.6.1.5.5.7.48.1.2"?S=this.getExtOcspNonce(x,E):g=="1.3.6.1.5.5.7.48.1.5"?S=this.getExtOcspNoCheck(x,E):g=="1.2.840.113583.1.1.9.1"?S=this.getExtAdobeTimeStamp(x,E):ye.EXT_PARSER[g]!=null&&(S=ye.EXT_PARSER[g](g,E,x)),S!=null)return S;var P={extname:g,extn:x};try{P.extn=s(x)}catch{}return E&&(P.critical=!0),P},this.findExt=function(I,R){for(var A=0;A<I.length;A++)if(I[A].extname==R)return I[A];return null},this.updateExtCDPFullURI=function(I,R){var A=this.findExt(I,"cRLDistributionPoints");if(A!=null&&A.array!=null){for(var f=A.array,g=0;g<f.length;g++)if(f[g].dpname!=null&&f[g].dpname.full!=null)for(var E=f[g].dpname.full,x=0;x<E.length;x++){var S=E[g];S.uri!=null&&(S.uri=R)}}},this.updateExtAIAOCSP=function(I,R){var A=this.findExt(I,"authorityInfoAccess");if(A!=null&&A.array!=null)for(var f=A.array,g=0;g<f.length;g++)f[g].ocsp!=null&&(f[g].ocsp=R)},this.updateExtAIACAIssuer=function(I,R){var A=this.findExt(I,"authorityInfoAccess");if(A!=null&&A.array!=null)for(var f=A.array,g=0;g<f.length;g++)f[g].caissuer!=null&&(f[g].caissuer=R)},this.dnarraytostr=function(I){function R(f){return f.map(function(g){return A(g).replace(/\+/,"\\+")}).join("+")}function A(f){return f.type+"="+f.value}return"/"+I.map(function(f){return R(f).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(I){var R;if(I.str!=null&&I.array==null){var A=new _.asn1.x509.X500Name({str:I.str}),f=A.tohex();R=this.getX500NameArray(f)}else R=I.array;I.canon==null&&(I.canon=this.c14nRDNArray(R))},this.c14nRDNArray=function(I){for(var R=[],A=0;A<I.length;A++){for(var f=I[A],g=[],E=0;E<f.length;E++){var x=f[E],S=x.value;S=S.replace(/^\s*/,""),S=S.replace(/\s*$/,""),S=S.replace(/\s+/g," "),S=S.toLowerCase(),g.push(x.type.toLowerCase()+"="+S)}R.push(g.join("+"))}return"/"+R.join("/")},this.getInfo=function(){var I=function(te){for(var _e="",ce="    ",J=`
`,De=te.array,fe=0;fe<De.length;fe++){var ie=De[fe];if(ie.dn!=null&&(_e+=ce+"dn: "+ie.dn.str+J),ie.ip!=null&&(_e+=ce+"ip: "+ie.ip+J),ie.rfc822!=null&&(_e+=ce+"rfc822: "+ie.rfc822+J),ie.dns!=null&&(_e+=ce+"dns: "+ie.dns+J),ie.uri!=null&&(_e+=ce+"uri: "+ie.uri+J),ie.other!=null){var qt=ie.other.oid,Ae=JSON.stringify(ie.other.value).replace(/\"/g,"");_e+=ce+"other: "+qt+"="+Ae+J}}return _e=_e.replace(/\n$/,""),_e},R=function(te){for(var _e="",ce=te.array,J=0;J<ce.length;J++){var De=ce[J];if(_e+="    policy oid: "+De.policyoid+`
`,De.array!==void 0)for(var fe=0;fe<De.array.length;fe++){var ie=De.array[fe];ie.cps!==void 0&&(_e+="    cps: "+ie.cps+`
`)}}return _e},A=function(te){for(var _e="",ce=te.array,J=0;J<ce.length;J++){var De=ce[J];try{De.dpname.full[0].uri!==void 0&&(_e+="    "+De.dpname.full[0].uri+`
`)}catch{}try{De.dname.full[0].dn.hex!==void 0&&(_e+="    "+ye.hex2dn(De.dpname.full[0].dn.hex)+`
`)}catch{}}return _e},f=function(te){for(var _e="",ce=te.array,J=0;J<ce.length;J++){var De=ce[J];De.caissuer!==void 0&&(_e+="    caissuer: "+De.caissuer+`
`),De.ocsp!==void 0&&(_e+="    ocsp: "+De.ocsp+`
`)}return _e},g=ye,E,x,S;if(E=`Basic Fields
`,E+="  serial number: "+this.getSerialNumberHex()+`
`,E+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,E+="  issuer: "+this.getIssuerString()+`
`,E+="  notBefore: "+this.getNotBefore()+`
`,E+="  notAfter: "+this.getNotAfter()+`
`,E+="  subject: "+this.getSubjectString()+`
`,E+=`  subject public key info: 
`,x=this.getPublicKey(),E+="    key algorithm: "+x.type+`
`,x.type==="RSA"&&(E+="    n="+uv(x.n.toString(16)).substr(0,16)+`...
`,E+="    e="+uv(x.e.toString(16))+`
`),S=this.aExtInfo,S!=null){E+=`X509v3 Extensions:
`;for(var P=0;P<S.length;P++){var O=S[P],B=_.asn1.x509.OID.oid2name(O.oid);B===""&&(B=O.oid);var v="";if(O.critical===!0&&(v="CRITICAL"),E+="  "+B+" "+v+`:
`,B==="basicConstraints"){var M=this.getExtBasicConstraints();M.cA===void 0?E+=`    {}
`:(E+="    cA=true",M.pathLen!==void 0&&(E+=", pathLen="+M.pathLen),E+=`
`)}else if(B=="policyMappings"){var V=this.getExtPolicyMappings().array,z=V.map(function(te){var _e=te;return _e[0]+":"+_e[1]}).join(", ");E+="    "+z+`
`}else if(B=="policyConstraints"){var $=this.getExtPolicyConstraints();E+="    ",$.reqexp!=null&&(E+=" reqexp="+$.reqexp),$.inhibit!=null&&(E+=" inhibit="+$.inhibit),E+=`
`}else if(B=="inhibitAnyPolicy"){var $=this.getExtInhibitAnyPolicy();E+="    skip="+$.skip+`
`}else if(B=="keyUsage")E+="    "+this.getExtKeyUsageString()+`
`;else if(B=="subjectKeyIdentifier")E+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(B=="authorityKeyIdentifier"){var G=this.getExtAuthorityKeyIdentifier();G.kid!==void 0&&(E+="    kid="+G.kid.hex+`
`)}else if(B=="extKeyUsage"){var Q=this.getExtExtKeyUsage().array;E+="    "+Q.join(", ")+`
`}else if(B=="subjectAltName"){var re=I(this.getExtSubjectAltName());E+=re+`
`}else if(B=="cRLDistributionPoints"){var me=this.getExtCRLDistributionPoints();E+=A(me)}else if(B=="authorityInfoAccess"){var ne=this.getExtAuthorityInfoAccess();E+=f(ne)}else B=="certificatePolicies"&&(E+=R(this.getExtCertificatePolicies()))}}return E+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,E+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,E},typeof e=="string"&&(e.indexOf("-----BEGIN")!=-1?this.readCertPEM(e):_.lang.String.isHex(e)&&this.readCertHex(e))}ye.EXT_PARSER={};ye.registExtParser=function(e,t){ye.EXT_PARSER[e]=t};ye.hex2dn=function(e,t){t===void 0&&(t=0);var r=new ye,n=X.getTLV(e,t),i=r.getX500Name(e);return i.str};ye.hex2rdn=function(e,t){if(t===void 0&&(t=0),e.substr(t,2)!=="31")throw new Error("malformed RDN");for(var r=new Array,n=X.getChildIdx(e,t),i=0;i<n.length;i++)r.push(ye.hex2attrTypeValue(e,n[i]));return r=r.map(function(s){return s.replace("+","\\+")}),r.join("+")};ye.hex2attrTypeValue=function(e,t){var r=X,n=r.getV;if(t===void 0&&(t=0),e.substr(t,2)!=="30")throw new Error("malformed attribute type and value");var i=r.getChildIdx(e,t);i.length!==2||e.substr(i[0],2);var s=n(e,i[0]),a=_.asn1.ASN1Util.oidHexToInt(s),o=_.asn1.x509.OID.oid2atype(a),c=n(e,i[1]),u=Hn(c);return o+"="+u};ye.getPublicKeyFromCertHex=function(e){var t=new ye;return t.readCertHex(e),t.getPublicKey()};ye.getPublicKeyFromCertPEM=function(e){var t=new ye;return t.readCertPEM(e),t.getPublicKey()};ye.getPublicKeyInfoPropOfCertPEM=function(e){var t=X,r=t.getVbyList,n={},i,s,a;return n.algparam=null,i=new ye,i.readCertPEM(e),s=i.getPublicKeyHex(),n.keyhex=r(s,0,[1],"03").substr(2),n.algoid=r(s,0,[0,0],"06"),n.algoid==="2a8648ce3d0201"&&(n.algparam=r(s,0,[0,1],"06")),n};ye.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var zL=function(e){var t=_,r=t.lang.String.isHex,n=X,i=n.getV,s=n.getTLV,a=n.getVbyList,o=n.getTLVbyList,c=n.getTLVbyListEx,u=n.getIdxbyList,b=n.getIdxbyListEx,h=n.getChildIdx,d=new ye;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var l=u(this.hex,0,[0,0]),y=this.hex.substr(l,2);if(y=="02")this.posSigAlg=1;else if(y=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+y);var p=u(this.hex,0,[0,this.posSigAlg+3]),m=this.hex.substr(p,2);if(m=="17"||m=="18"){var w,C;w=u(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,w!=-1&&(C=this.hex.substr(w,2),C=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(m=="30")this.posRevCert=this.posSigAlg+3;else if(m=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+m)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(a(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var l=o(this.hex,0,[0,this.posSigAlg],"30");return d.getAlgorithmIdentifierName(l)},this.getIssuer=function(){return d.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return o(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var l=a(this.hex,0,[0,this.posSigAlg+2]);return result=Hn(l)},this.getNextUpdate=function(){var l=u(this.hex,0,[0,this.posSigAlg+3]),y=this.hex.substr(l,2);return y!="17"&&y!="18"?null:Hn(i(this.hex,l))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var l=[],y=u(this.hex,0,[0,this.posRevCert]),p=h(this.hex,y),m=0;m<p.length;m++){var w=s(this.hex,p[m]);l.push(this.getRevCert(w))}return l},this.getRevCert=function(l){var y={},p=h(l,0);return y.sn={hex:a(l,0,[0],"02")},y.date=Hn(a(l,0,[1])),p.length==3&&(y.ext=d.getExtParamArray(o(l,0,[2]))),y},this.findRevCert=function(l){var y=new ye(l),p=y.getSerialNumberHex();return this.findRevCertBySN(p)},this.findRevCertBySN=function(l){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var y=this.parsed.revcert,p=0;p<y.length;p++)if(l==y[p].sn.hex)return y[p];return null},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(l){var y=this.getSignatureAlgorithmField(),p=this.getSignatureValueHex(),m=o(this.hex,0,[0],"30"),w=new _.crypto.Signature({alg:y});return w.init(l),w.updateHex(m),w.verify(p)},this.getParam=function(l){var y={},p=this.getVersion();p!=null&&(y.version=p),y.sigalg=this.getSignatureAlgorithmField(),y.issuer=this.getIssuer(),y.thisupdate=this.getThisUpdate();var m=this.getNextUpdate();m!=null&&(y.nextupdate=m);var w=this.getRevCertArray();w!=null&&(y.revcert=w);var C=b(this.hex,0,[0,"[0]"]);if(C!=-1){var T=c(this.hex,0,[0,"[0]",0]);y.ext=d.getExtParamArray(T)}return y.sighex=this.getSignatureValueHex(),this.parsed=y,typeof l=="object"&&(l.tbshex==!0&&(y.tbshex=o(this.hex,0,[0])),l.nodnarray==!0&&delete y.issuer.array),y},typeof e=="string"&&(r(e)?this.hex=e:e.match(/-----BEGIN X509 CRL/)&&(this.hex=or(e)),this._setPos())};(typeof _>"u"||!_)&&(_={});(typeof _.jws>"u"||!_.jws)&&(_.jws={});_.jws.JWS=function(){var e=_,t=e.jws.JWS,r=t.isSafeJSONString;this.parseJWS=function(n,i){if(!(this.parsedJWS!==void 0&&(i||this.parsedJWS.sigvalH!==void 0))){var s=n.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(s==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var a=s[1],o=s[2],c=s[3],u=a+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=a,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=c,this.parsedJWS.si=u,!i){var b=tr(c),h=qn(b,16);this.parsedJWS.sigvalH=b,this.parsedJWS.sigvalBI=h}var d=bs(a),l=bs(o);if(this.parsedJWS.headS=d,this.parsedJWS.payloadS=l,!r(d,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+d}}};_.jws.JWS.sign=function(e,t,r,n,i){var s=_,a=s.jws,o=a.JWS,c=o.readSafeJSONString,u=o.isSafeJSONString,b=s.crypto,h=b.ECDSA,d=b.Mac,l=b.Signature,y=JSON,p,m,w;if(typeof t!="string"&&typeof t!="object")throw"spHeader must be JSON string or object: "+t;if(typeof t=="object"&&(m=t,p=y.stringify(m)),typeof t=="string"){if(p=t,!u(p))throw"JWS Head is not safe JSON string: "+p;m=c(p)}if(w=r,typeof r=="object"&&(w=y.stringify(r)),(e==""||e==null)&&m.alg!==void 0&&(e=m.alg),e!=""&&e!=null&&m.alg===void 0&&(m.alg=e,p=y.stringify(m)),e!==m.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+m.alg;var C=null;if(o.jwsalg2sigalg[e]===void 0)throw"unsupported alg name: "+e;C=o.jwsalg2sigalg[e];var T=x0(p),q=x0(w),F=T+"."+q,j="";if(C.substr(0,4)=="Hmac"){if(n===void 0)throw"mac key shall be specified for HS* alg";var k=new d({alg:C,prov:"cryptojs",pass:n});k.updateString(F),j=k.doFinal()}else if(C.indexOf("withECDSA")!=-1){var I=new l({alg:C});I.init(n,i),I.updateString(F);var R=I.sign();j=_.crypto.ECDSA.asn1SigToConcatSig(R)}else if(C!="none"){var I=new l({alg:C});I.init(n,i),I.updateString(F),j=I.sign()}var A=Hr(j);return F+"."+A};_.jws.JWS.verify=function(e,t,r){var n=_,i=n.jws,s=i.JWS,a=s.readSafeJSONString,o=n.crypto,c=o.ECDSA,u=o.Mac,b=o.Signature,h;if(typeof ve!==void 0&&(h=ve),!mv(e))return!1;var d=e.split(".");if(d.length!==3)return!1;var l=d[0],y=d[1],p=l+"."+y,m=tr(d[2]),w=a(bs(d[0])),C=null,T=null;if(w.alg===void 0)throw"algorithm not specified in header";if(C=w.alg,T=C.substr(0,2),r!=null&&Object.prototype.toString.call(r)==="[object Array]"&&r.length>0){var q=":"+r.join(":")+":";if(q.indexOf(":"+C+":")==-1)throw"algorithm '"+C+"' not accepted in the list"}if(C!="none"&&t===null)throw"key shall be specified to verify.";if(typeof t=="string"&&t.indexOf("-----BEGIN ")!=-1&&(t=at.getKey(t)),(T=="RS"||T=="PS")&&!(t instanceof h))throw"key shall be a RSAKey obj for RS* and PS* algs";if(T=="ES"&&!(t instanceof c))throw"key shall be a ECDSA obj for ES* algs";C=="none";var F=null;if(s.jwsalg2sigalg[w.alg]===void 0)throw"unsupported alg name: "+C;if(F=s.jwsalg2sigalg[C],F=="none")throw"not supported";if(F.substr(0,4)=="Hmac"){var j=null;if(t===void 0)throw"hexadecimal key shall be specified for HMAC";var k=new u({alg:F,pass:t});return k.updateString(p),j=k.doFinal(),m==j}else if(F.indexOf("withECDSA")!=-1){var I=null;try{I=c.concatSigToASN1Sig(m)}catch{return!1}var R=new b({alg:F});return R.init(t),R.updateString(p),R.verify(I)}else{var R=new b({alg:F});return R.init(t),R.updateString(p),R.verify(m)}};_.jws.JWS.parse=function(e){var t=e.split("."),r={},n,i,s;if(t.length!=2&&t.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return n=t[0],i=t[1],t.length==3&&(s=t[2]),r.headerObj=_.jws.JWS.readSafeJSONString(bs(n)),r.payloadObj=_.jws.JWS.readSafeJSONString(bs(i)),r.headerPP=JSON.stringify(r.headerObj,null,"  "),r.payloadObj==null?r.payloadPP=bs(i):r.payloadPP=JSON.stringify(r.payloadObj,null,"  "),s!==void 0&&(r.sigHex=tr(s)),r};_.jws.JWS.verifyJWT=function(e,t,r){var n=_,i=n.jws,s=i.JWS,a=s.readSafeJSONString,o=s.inArray,c=s.includedArray;if(!mv(e))return!1;var u=e.split(".");if(u.length!=3)return!1;var b=u[0],h=u[1],d=b+"."+h,l=tr(u[2]),y=a(bs(b)),p=a(bs(h));if(y.alg===void 0)return!1;if(r.alg===void 0)throw"acceptField.alg shall be specified";if(!o(y.alg,r.alg)||p.iss!==void 0&&typeof r.iss=="object"&&!o(p.iss,r.iss)||p.sub!==void 0&&typeof r.sub=="object"&&!o(p.sub,r.sub))return!1;if(p.aud!==void 0&&typeof r.aud=="object"){if(typeof p.aud=="string"){if(!o(p.aud,r.aud))return!1}else if(typeof p.aud=="object"&&!c(p.aud,r.aud))return!1}var m=i.IntDate.getNow();return r.verifyAt!==void 0&&typeof r.verifyAt=="number"&&(m=r.verifyAt),(r.gracePeriod===void 0||typeof r.gracePeriod!="number")&&(r.gracePeriod=0),!(p.exp!==void 0&&typeof p.exp=="number"&&p.exp+r.gracePeriod<m||p.nbf!==void 0&&typeof p.nbf=="number"&&m<p.nbf-r.gracePeriod||p.iat!==void 0&&typeof p.iat=="number"&&m<p.iat-r.gracePeriod||p.jti!==void 0&&r.jti!==void 0&&p.jti!==r.jti||!s.verify(e,t,r.alg))};_.jws.JWS.includedArray=function(e,t){var r=_.jws.JWS.inArray;if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0};_.jws.JWS.inArray=function(e,t){if(t===null||typeof t!="object"||typeof t.length!="number")return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1};_.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};_.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return n=i_(e),typeof n!="object"||n.constructor===Array?0:(t&&(t[r]=n),1)}catch{return 0}};_.jws.JWS.readSafeJSONString=function(e){var t=null;try{return t=i_(e),typeof t!="object"||t.constructor===Array?null:t}catch{return null}};_.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(t==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]};_.jws.JWS.getJWKthumbprint=function(e){if(e.kty!=="RSA"&&e.kty!=="EC"&&e.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var t="{";if(e.kty==="RSA"){if(typeof e.n!="string"||typeof e.e!="string")throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if(e.kty==="EC"){if(typeof e.crv!="string"||typeof e.x!="string"||typeof e.y!="string")throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if(e.kty==="oct"){if(typeof e.k!="string")throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=Ui(t),n=_.crypto.Util.hashHex(r,"sha256"),i=Hr(n);return i};_.jws.IntDate={};_.jws.IntDate.get=function(e){var t=_.jws.IntDate,r=t.getNow,n=t.getZulu;if(e=="now")return r();if(e=="now + 1hour")return r()+60*60;if(e=="now + 1day")return r()+60*60*24;if(e=="now + 1month")return r()+60*60*24*30;if(e=="now + 1year")return r()+60*60*24*365;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e};_.jws.IntDate.getZulu=function(e){return c_(e)};_.jws.IntDate.getNow=function(){var e=~~(new Date/1e3);return e};_.jws.IntDate.intDate2UTCString=function(e){var t=new Date(e*1e3);return t.toUTCString()};_.jws.IntDate.intDate2Zulu=function(e){var t=new Date(e*1e3),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),i=("00"+t.getUTCDate()).slice(-2),s=("00"+t.getUTCHours()).slice(-2),a=("00"+t.getUTCMinutes()).slice(-2),o=("00"+t.getUTCSeconds()).slice(-2);return r+n+i+s+a+o+"Z"};(typeof _>"u"||!_)&&(_={});(typeof _.jws>"u"||!_.jws)&&(_.jws={});_.jws.JWSJS=function(){var e=_,t=e.jws,r=t.JWS,n=r.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(i){this.init();var s=i.split(".");if(s.length!=3)throw"malformed input JWS";this.aHeader.push(s[0]),this.sPayload=s[1],this.aSignature.push(s[2])},this.addSignature=function(i,s,a,o){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var c=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var u=_.jws.JWS.sign(i,s,this.sPayload,a,o),b=u.split("."),h=b[0],d=b[2];this.aHeader.push(b[0]),this.aSignature.push(b[2])}catch(l){throw this.aHeader.length>c&&this.aHeader.pop(),this.aSignature.length>c&&this.aSignature.pop(),"addSignature failed: "+l}},this.verifyAll=function(i){if(this.aHeader.length!==i.length||this.aSignature.length!==i.length)return!1;for(var s=0;s<i.length;s++){var a=i[s];if(a.length!==2)return!1;var o=this.verifyNth(s,a[0],a[1]);if(o===!1)return!1}return!0},this.verifyNth=function(i,s,a){if(this.aHeader.length<=i||this.aSignature.length<=i)return!1;var o=this.aHeader[i],c=this.aSignature[i],u=o+"."+this.sPayload+"."+c,b=!1;try{b=r.verify(u,s,a)}catch{return!1}return b},this.readJWSJS=function(i){if(typeof i=="string"){var s=n(i);if(s==null)throw"argument is not safe JSON object string";this.aHeader=s.headers,this.sPayload=s.payload,this.aSignature=s.signatures}else try{if(i.headers.length>0)this.aHeader=i.headers;else throw"malformed header";if(typeof i.payload=="string")this.sPayload=i.payload;else throw"malformed signatures";if(i.signatures.length>0)this.aSignature=i.signatures;else throw"malformed signatures"}catch(a){throw"malformed JWS-JS JSON object: "+a}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}};Z.SecureRandom=Ao;Z.rng_seed_time=pv;Z.BigInteger=U;Z.RSAKey=ve;Z.ECDSA=_.crypto.ECDSA;Z.DSA=_.crypto.DSA;Z.Signature=_.crypto.Signature;Z.MessageDigest=_.crypto.MessageDigest;Z.Mac=_.crypto.Mac;Z.Cipher=_.crypto.Cipher;Z.KEYUTIL=at;Z.ASN1HEX=X;Z.X509=ye;Z.X509CRL=zL;Z.CryptoJS=ee;Z.b64tohex=Bu;Z.b64toBA=Qw;Z.ECFieldElementFp=jr;Z.ECPointFp=mt;Z.ECCurveFp=Ca;Z.stoBA=s_;Z.BAtos=a_;Z.BAtohex=K1;Z.stohex=fi;Z.stob64=AL;Z.stob64u=PL;Z.b64utos=CL;Z.b64tob64u=Iu;Z.b64utob64=A0;Z.hex2b64=Pa;Z.hextob64u=Hr;Z.b64utohex=tr;Z.utf8tob64u=x0;Z.b64utoutf8=bs;Z.utf8tob64=IL;Z.b64toutf8=BL;Z.utf8tohex=V1;Z.hextoutf8=It;Z.hextorstr=Hn;Z.rstrtohex=Ui;Z.hextob64=bv;Z.hextob64nl=OL;Z.b64nltohex=o_;Z.hextopem=Fn;Z.pemtohex=or;Z.hextoArrayBuffer=RL;Z.ArrayBuffertohex=FL;Z.zulutomsec=gv;Z.msectozulu=qL;Z.zulutosec=c_;Z.zulutodate=HL;Z.datetozulu=jL;Z.uricmptohex=z1;Z.hextouricmp=$1;Z.ipv6tohex=cv;Z.hextoipv6=fv;Z.hextoip=q1;Z.iptohex=vv;Z.ucs2hextoutf8=yv;Z.encodeURIComponentAll=G1;Z.newline_toUnix=kL;Z.newline_toDos=LL;Z.hextoposhex=uv;Z.intarystrtohex=KL;Z.strdiffidx=VL;Z.oidtohex=d_;Z.hextooid=W1;Z.strpad=H1;Z.bitstrtoint=h_;Z.inttobitstr=p_;Z.bitstrtobinstr=b_;Z.binstrtobitstr=UL;Z.isBase64URLDot=mv;Z.namearraytobinstr=j1;Z.extendClass=W;Z.foldnl=U1;Z.b64topem=DL;Z.pemtob64=NL;Z.timeogen=f_;Z.aryval=Nt;Z.inttohex=l_;Z.twoscompl=P0;Z.KJUR=_;Z.crypto=_.crypto;Z.asn1=_.asn1;Z.jws=_.jws;Z.lang=_.lang;Z.VERSION=$H;Z.VERSION_FULL=GH});var __=K(nn=>{D();N();var $L=nn&&nn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),GL=nn&&nn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),WL=nn&&nn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&$L(t,e,r);return GL(t,e),t};Object.defineProperty(nn,"__esModule",{value:!0});nn.GenRSAKeyPair=nn.decodeRsaPublicKey=nn.decodeRsaPrivateKey=nn.RSADecode=nn.RSAEncode=void 0;var Ia=WL(wv()),qs=Ps();function XL(e,t){try{let r=w_(t),n=Ia.KJUR.crypto.Cipher.encrypt(e,r,"RSAOAEP256");return Ia.hextob64(n)}catch(r){throw new qs.MPCError(qs.RSAEncodeError,r)}}nn.RSAEncode=XL;function YL(e,t){try{let r=m_(t),n=Ia.b64tohex(e);return Ia.KJUR.crypto.Cipher.decrypt(n,r,"RSAOAEP256")}catch(r){throw new qs.MPCError(qs.RSADecodeError,r)}}nn.RSADecode=YL;function m_(e){try{let t=`-----BEGIN RSA PRIVATE KEY-----
`+e+"-----END RSA PRIVATE KEY-----";return Ia.KEYUTIL.getKey(t,"PKCS1PRV")}catch(t){throw new qs.MPCError(qs.DecodeRSAPrivateKeyError,t)}}nn.decodeRsaPrivateKey=m_;function w_(e){try{let t=`-----BEGIN PUBLIC KEY-----
`+e+"-----END PUBLIC KEY-----";return Ia.KEYUTIL.getKey(t)}catch(t){throw new qs.MPCError(qs.DecodeRsaPublicKeyError,t)}}nn.decodeRsaPublicKey=w_;function ZL(){try{let e=Ia.KEYUTIL.generateKeypair("RSA",1024),t=Ia.KEYUTIL.getPEM(e.prvKeyObj,"PKCS1PRV"),r=Ia.KEYUTIL.getPEM(e.pubKeyObj),n=t.split(`\r
`),i=r.split(`\r
`),s="",a="";for(let o=0;o<n.length;o++){let c=n[o];c==="-----BEGIN RSA PRIVATE KEY-----"||c==="-----END RSA PRIVATE KEY-----"||(s+=c)}for(let o=0;o<i.length;o++){let c=i[o];c==="-----BEGIN PUBLIC KEY-----"||c==="-----END PUBLIC KEY-----"||(a+=c)}return[s,a]}catch(e){throw new qs.MPCError(qs.GenRSAKeyPairError,e)}}nn.GenRSAKeyPair=ZL});var x_=K(zi=>{D();N();var JL=zi&&zi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),QL=zi&&zi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),eK=zi&&zi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&JL(t,e,r);return QL(t,e),t};Object.defineProperty(zi,"__esModule",{value:!0});zi.AESDecrypt=zi.AESEncrypt=void 0;var Ba=eK(w2()),S_=R1(),X1=Ps();function tK(e,t){try{let r=(0,S_.md5)(t),n=Ba.enc.Utf8.parse(r);return Ba.AES.encrypt(e,n,{iv:n,mode:Ba.mode.CBC,padding:Ba.pad.Pkcs7}).toString()}catch(r){throw new X1.MPCError(X1.AESEncryptError,r)}}zi.AESEncrypt=tK;function rK(e,t){try{let r=(0,S_.md5)(t),n=Ba.enc.Utf8.parse(r);return Ba.AES.decrypt(e,n,{iv:n,mode:Ba.mode.CBC,padding:Ba.pad.Pkcs7}).toString(Ba.enc.Utf8)}catch(r){throw new X1.MPCError(X1.AESDecryptError,r)}}zi.AESDecrypt=rK});var A_=K(J1=>{D();N();Object.defineProperty(J1,"__esModule",{value:!0});J1.bip32Derive=void 0;var E_=ar(),nK=S1(),iK=Gg(),Y1=ps(),Z1=Ps();async function sK(e,t,r,n,i){try{if(r.Curve===Y1.CurveName.Secp256k1){let[s,a]=await aK(e,t,r.toEcdsaPoint(),n,i);return Promise.resolve([s,Y1.ECPoint.fromEcdsaPoint(a)])}else if(r.Curve===Y1.CurveName.Ed25519){let[s,a]=await oK(e,t,r.toEd25519Point(),n);return Promise.resolve([s,Y1.ECPoint.fromEd25519Point(a)])}return Promise.reject(new Z1.MPCError(Z1.Bip32DeriveError,`bip32Derive un_supported curve type: [${r.Curve}]`))}catch(s){return Promise.reject(new Z1.MPCError(Z1.Bip32DeriveError,s))}}J1.bip32Derive=sK;async function aK(e,t,r,n,i){let s=new nK.TssKey(new E_.BN(t.toString()),r,H.Buffer.from(n,"hex"));return s=await s.NewChildKey(e[0]),s=await s.NewChildKey(e[1]),s=await s.NewChildKey(e[2]),i!=null&&(s=await s.NewChildKey(i)),[BigInt(s.shareI.toString(10)),s.publicKey]}async function oK(e,t,r,n){let i=new iK.TssKey(new E_.BN(t.toString()),r,H.Buffer.from(n,"hex"));return i=await i.NewChildKey(e[0]),i=await i.NewChildKey(e[1]),i=await i.NewChildKey(e[2]),[BigInt(i.shareI.toString(10)),i.publicKey]}});var _v=K(wi=>{D();N();var cK=wi&&wi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Yc=wi&&wi.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&cK(t,e,r)};Object.defineProperty(wi,"__esModule",{value:!0});Yc(Vw(),wi);Yc(zw(),wi);Yc(Gw(),wi);Yc(__(),wi);Yc(x_(),wi);Yc(A_(),wi);Yc(R1(),wi)});var P_=K(ep=>{D();N();Object.defineProperty(ep,"__esModule",{value:!0});ep.PedersenParameters=void 0;var Q1=(P1(),ws(A1)),C0=class{constructor(t,r,n){this.S=t,this.T=r,this.Ntilde=n}static async NewPedersenParameters(){let t=24080463838836201080652082632305534732002063580868256837038210994857729586600268211801279564303369693950429682190326566093932573855509453567393841648357081821880053752774170718047382946252536000678870735515855163646754581081435553356222873770351932852227834667536288582125296651398663163648979543718769199804146918220464587326136530135286945735587984838293187128267423286364628812794385921668573124571396250799658461906690728456458650228465312865048432010152190862532689545798727242877158647292465531176377500682726348426989332482863616802427143787375284653058516335361011466118712811309500705785525375482092098963097n,r=3969445706491109142504463761757113181243720789927116177071520922075525103482617922906331624855888956328960525194513254320803314863178743526851561817509828829014160418629634938441455784583112125465764928720574665390156185396679649272387565016698159745106440263736311759353449267253427424326566011948150894938620330116124058453568512487633908317746279061077639294887980762568955530152514368105906737713994609570534667642479638349602421006214098814038802561220441092513322886567020060969058638935878546693061106757943434742074861416747299644165447889875592530645696214475164899537461943948958136027895218376240993342673n,n=13469185658727475035931073279550075030057497136872025477242105309462997417546940639217444818113817898323930497326722071401088281046063589760494766301417922508037554444807983479412495341757134204363059411424555694916349689713120515929919936432986593339122531838276046180495264783565315603443986101974283074727281432196871144636171331980926684638343639398221779004000968880059122234209774426712142116396474765406158933809440842904102096045102577802122569204376459489609991759029760310331107566518614976666732556835318392772320945696543239652277734046054967196610265022261270041776733838263923439736476965782219187765549n;return new C0(r,n,t)}Commit(t,r){let n=(0,Q1.modPow)(this.S,t,this.Ntilde),i=(0,Q1.modPow)(this.T,r,this.Ntilde);return n*i%this.Ntilde}Open(t,r,n){let i=(0,Q1.modPow)(this.S,r,this.Ntilde),s=(0,Q1.modPow)(this.T,n,this.Ntilde);return i*s%this.Ntilde===t}};ep.PedersenParameters=C0});var B_=K(tp=>{D();N();Object.defineProperty(tp,"__esModule",{value:!0});tp.ecdsaSign=void 0;var Ou=ps(),C_=ci(),I_=ar(),fK=P_(),I0=new Map;async function uK(e){let t={},r=new Map,n=await fK.PedersenParameters.NewPedersenParameters();for(let i of e.Messages){let s=(0,Ou.GetMapKeyTssSign)(e.MpcId,i),a=e.EcdsaMessageMap.get(s);if(e.Step===Ou.SignStep.Step1){let o=e.EcdsaShare,c=new Ou.P2(new I_.BN(o.X2.toString()),new I_.BN(o.E_x1.toString()),o.PaiPubKey,o.PublicKey.toEcdsaPoint(),i,n),[u,b]=await Promise.all(c.step1(a.CmtC));r.set(s,{Proof:u,R2:Ou.ECPoint.fromEcdsaPoint(b),E_x1:o.E_x1}),I0.set(s,c)}else if(e.Step===Ou.SignStep.Step2){let o=I0.get(s),[c,u]=o.step2(a.Proof,a.Witness);r.set(s,{E_k2_h_rx:BigInt(c.toString()),AffGProof:u})}else if(e.Step==Ou.SignStep.Step3){let o=I0.get(s),c=new C_.secp256k1.Signature(a.Signature.r,a.Signature.s);if(!C_.secp256k1.verify(c,i,o.publicKey))throw new Error("ecdsa sign verify fail");r.set(s,{Signature:a.Signature}),I0.delete(s)}else throw I0.delete(s),new Error(`un supported step: ${e.Step}`)}return t.EcdsaMessageMap=r,t}tp.ecdsaSign=uK});var T_=K(rp=>{D();N();Object.defineProperty(rp,"__esModule",{value:!0});rp.ed25519Sign=void 0;var Po=ps(),M_=ci(),B0=new Map;async function dK(e){let t={},r=new Map;for(let n of e.Messages){let i=(0,Po.GetMapKeyTssSign)(e.MpcId,n),s=e.Ed25519MessageMap.get(i);if(e.Step===Po.SignStep.Step1){let a=e.Ed25519Share,o=a.PublicKey,c=new Po.Ed25519Sign(e.DeviceNumber,a.Threshold,a.PartList,a.ShareI,o.toEd25519Point(),n),u=await c.signStep1();r.set(i,{OutputDataMap:u}),B0.set(i,c)}else if(e.Step===Po.SignStep.Step2){let o=await B0.get(i).signStep2(s.TssInput);r.set(i,{OutputDataMap:o})}else if(e.Step===Po.SignStep.Step3){let a=B0.get(i),[o,c]=await a.signStep3(s.TssInput),b=(s.Signature.s+o+M_.ed25519.CURVE.n)%M_.ed25519.CURVE.n,[h,d]=await(0,Po.Ed25519Verify)(new Po.Signature(c,b),n,Po.ECPoint.fromEd25519Point(a.publicKey));if(!d)throw new Error("ed25519 sign verify fail");r.set(i,{Signature:h}),a={},B0.delete(i)}else throw B0.delete(i),new Error(`un supported step: ${e.Step}`)}return t.Ed25519MessageMap=r,t}rp.ed25519Sign=dK});var D_=K(np=>{D();N();Object.defineProperty(np,"__esModule",{value:!0});np.Dispatch=void 0;var Sv=_v(),O_=_u(),lK=B_(),hK=T_(),pK=[Sv.DeviceNumber.P2_No,Sv.DeviceNumber.P3_No];async function bK(e){if(!pK.includes(e.DeviceNumber))throw new Error(`wrong part number: ${e.DeviceNumber}`);if(e.FuncType!==Sv.FuncType.TssSign)throw new Error(`un supported operate: ${e.FuncType}`);switch(e.CurveName){case O_.CurveName.Secp256k1:return await(0,lK.ecdsaSign)(e);case O_.CurveName.Ed25519:return(0,hK.ed25519Sign)(e);default:throw new Error(`un supported curve: ${e.CurveName}`)}}np.Dispatch=bK});var R_=K(Co=>{D();N();var gK=Co&&Co.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),N_=Co&&Co.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&gK(t,e,r)};Object.defineProperty(Co,"__esModule",{value:!0});N_(D_(),Co);N_(_v(),Co)});var ps=K(ui=>{D();N();var vK=ui&&ui.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ip=ui&&ui.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&vK(t,e,r)};Object.defineProperty(ui,"__esModule",{value:!0});ui.JSONBigNative=ui.JsonParseBigInt=void 0;ip(Lw(),ui);ip(_u(),ui);ip(R_(),ui);ip(Ps(),ui);function yK(e,t){return/\d{16,}/.test(e)&&(e=e.replace(/"(\\?[\s\S])*?"|([+\-\d.eE]{16,})/g,function(r,n,i){return i&&/^\d{16,}$/.test(i)?'"'+r+'"':r})),JSON.parse(e,t)}ui.JsonParseBigInt=yK;var mK=ZA()({useNativeBigInt:!0});ui.JSONBigNative=mK});var xv=K(Du=>{D();N();Object.defineProperty(Du,"__esModule",{value:!0});Du.EcdsaPData=Du.ShareData=void 0;var F_=ar(),sp=ps(),M0=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n}static parseShareData(t){let r=(0,sp.JsonParseBigInt)(t),n=BigInt(r.ShareI.toString()),i=r.ChainCode.toString(),s=new sp.ECPoint(r.PublicKey.Curve,BigInt(r.PublicKey.X.toString()),BigInt(r.PublicKey.Y.toString()));return new M0(n,s,i)}};Du.ShareData=M0;var T0=class{constructor(t,r,n){this.e_x1=t,this.paiPubKey=r,this.x2=n}static parseEcdsaPShare(t){let r=(0,sp.JsonParseBigInt)(t),n=BigInt(r.E_x1.toString()),i=BigInt(r.X2),s=new F_.BN(r.PaiPubKey.N.toString());return new T0(n,new sp.PailPubKey(new F_.BN(s.toString())),i)}};Du.EcdsaPData=T0});var Ev=K(Hs=>{D();N();Object.defineProperty(Hs,"__esModule",{value:!0});Hs.saveContext=Hs.loadContext=Hs.saveAesKey=Hs.loadAesKey=void 0;var q_=new Map,H_=new Map;function wK(e){let t=q_.get(e);if(t===void 0)throw new Error("aesKey miss, please shakeHand first");return t}Hs.loadAesKey=wK;function _K(e,t){q_.set(e,t)}Hs.saveAesKey=_K;function SK(e){let t=H_.get(e);if(t===void 0)throw new Error("sign context miss, please setup first");return t}Hs.loadContext=SK;function xK(e,t){H_.set(e,t)}Hs.saveContext=xK});var j_=K(ap=>{D();N();Object.defineProperty(ap,"__esModule",{value:!0});ap.SignerInterface=void 0;var Av=class{};ap.SignerInterface=Av});var L_=K(k_=>{D();N();Object.defineProperty(k_,"__esModule",{value:!0})});var V_=K(K_=>{D();N();Object.defineProperty(K_,"__esModule",{value:!0})});var z_=K(U_=>{D();N();Object.defineProperty(U_,"__esModule",{value:!0})});var $_=K(gs=>{D();N();var EK=gs&&gs.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Pv=gs&&gs.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&EK(t,e,r)};Object.defineProperty(gs,"__esModule",{value:!0});gs.EntryPointType=void 0;gs.EntryPointType={EXTERNAL:"EXTERNAL",L1_HANDLER:"L1_HANDLER",CONSTRUCTOR:"CONSTRUCTOR"};Pv(L_(),gs);Pv(V_(),gs);Pv(z_(),gs)});var G_=K(mn=>{D();N();var AK=mn&&mn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),PK=mn&&mn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&AK(t,e,r)};Object.defineProperty(mn,"__esModule",{value:!0});mn.BlockTag=mn.BlockStatus=mn.TransactionExecutionStatus=mn.TransactionFinalityStatus=mn.TransactionType=void 0;mn.TransactionType={DECLARE:"DECLARE",DEPLOY:"DEPLOY",DEPLOY_ACCOUNT:"DEPLOY_ACCOUNT",INVOKE:"INVOKE_FUNCTION"};mn.TransactionFinalityStatus={NOT_RECEIVED:"NOT_RECEIVED",RECEIVED:"RECEIVED",ACCEPTED_ON_L2:"ACCEPTED_ON_L2",ACCEPTED_ON_L1:"ACCEPTED_ON_L1"};mn.TransactionExecutionStatus={REJECTED:"REJECTED",REVERTED:"REVERTED",SUCCEEDED:"SUCCEEDED"};mn.BlockStatus={PENDING:"PENDING",ACCEPTED_ON_L1:"ACCEPTED_ON_L1",ACCEPTED_ON_L2:"ACCEPTED_ON_L2",REJECTED:"REJECTED"};mn.BlockTag={PENDING:"pending",LATEST:"latest"};PK($_(),mn)});var X_=K(W_=>{D();N();Object.defineProperty(W_,"__esModule",{value:!0})});var Z_=K(Y_=>{D();N();Object.defineProperty(Y_,"__esModule",{value:!0})});var Q_=K(J_=>{D();N();Object.defineProperty(J_,"__esModule",{value:!0})});var tS=K(eS=>{D();N();Object.defineProperty(eS,"__esModule",{value:!0})});var nS=K(rS=>{D();N();Object.defineProperty(rS,"__esModule",{value:!0})});var sS=K(iS=>{D();N();Object.defineProperty(iS,"__esModule",{value:!0})});var oS=K(aS=>{D();N();Object.defineProperty(aS,"__esModule",{value:!0})});var cS=K(Y=>{D();N();Object.defineProperty(Y,"__esModule",{value:!0});Y.ETransactionVersion3=Y.ETransactionVersion2=Y.ETransactionVersion=Y.EDAMode=Y.EDataAvailabilityMode=Y.EBlockTag=Y.ETransactionExecutionStatus=Y.ETransactionFinalityStatus=Y.ETransactionStatus=Y.ESimulationFlag=Y.ETransactionType=Y.CALL_TYPE=Y.L1_DA_MODE=Y.PRICE_UNIT_FRI=Y.PRICE_UNIT_WEI=Y.STATE_MUTABILITY_EXTERNAL=Y.STATE_MUTABILITY_VIEW=Y.ABI_TYPE_ENUM=Y.ABI_TYPE_L1_HANDLER=Y.ABI_TYPE_CONSTRUCTOR=Y.ABI_TYPE_FUNCTION=Y.EVENT_ABI_TYPE=Y.STRUCT_ABI_TYPE=Y.TXN_TYPE_L1_HANDLER=Y.TXN_TYPE_INVOKE=Y.TXN_TYPE_DEPLOY_ACCOUNT=Y.TXN_TYPE_DEPLOY=Y.TXN_TYPE_DECLARE=Y.STATUS_RECEIVED=Y.STATUS_REJECTED=Y.STATUS_PENDING=Y.STATUS_REVERTED=Y.STATUS_SUCCEEDED=Y.STATUS_ACCEPTED_ON_L1=Y.STATUS_ACCEPTED_ON_L2=void 0;Y.STATUS_ACCEPTED_ON_L2="ACCEPTED_ON_L2";Y.STATUS_ACCEPTED_ON_L1="ACCEPTED_ON_L1";Y.STATUS_SUCCEEDED="SUCCEEDED";Y.STATUS_REVERTED="REVERTED";Y.STATUS_PENDING="PENDING";Y.STATUS_REJECTED="REJECTED";Y.STATUS_RECEIVED="RECEIVED";Y.TXN_TYPE_DECLARE="DECLARE";Y.TXN_TYPE_DEPLOY="DEPLOY";Y.TXN_TYPE_DEPLOY_ACCOUNT="DEPLOY_ACCOUNT";Y.TXN_TYPE_INVOKE="INVOKE";Y.TXN_TYPE_L1_HANDLER="L1_HANDLER";Y.STRUCT_ABI_TYPE="struct";Y.EVENT_ABI_TYPE="event";Y.ABI_TYPE_FUNCTION="function";Y.ABI_TYPE_CONSTRUCTOR="constructor";Y.ABI_TYPE_L1_HANDLER="l1_handler";Y.ABI_TYPE_ENUM="enum";Y.STATE_MUTABILITY_VIEW="view";Y.STATE_MUTABILITY_EXTERNAL="external";Y.PRICE_UNIT_WEI="WEI";Y.PRICE_UNIT_FRI="FRI";Y.L1_DA_MODE={BLOB:"BLOB",CALLDATA:"CALLDATA"};Y.CALL_TYPE={DELEGATE:"DELEGATE",LIBRARY_CALL:"LIBRARY_CALL",CALL:"CALL"};Y.ETransactionType={DECLARE:Y.TXN_TYPE_DECLARE,DEPLOY:Y.TXN_TYPE_DEPLOY,DEPLOY_ACCOUNT:Y.TXN_TYPE_DEPLOY_ACCOUNT,INVOKE:Y.TXN_TYPE_INVOKE,L1_HANDLER:Y.TXN_TYPE_L1_HANDLER};Y.ESimulationFlag={SKIP_VALIDATE:"SKIP_VALIDATE",SKIP_FEE_CHARGE:"SKIP_FEE_CHARGE"};Y.ETransactionStatus={RECEIVED:Y.STATUS_RECEIVED,REJECTED:Y.STATUS_REJECTED,ACCEPTED_ON_L2:Y.STATUS_ACCEPTED_ON_L2,ACCEPTED_ON_L1:Y.STATUS_ACCEPTED_ON_L1};Y.ETransactionFinalityStatus={ACCEPTED_ON_L2:Y.STATUS_ACCEPTED_ON_L2,ACCEPTED_ON_L1:Y.STATUS_ACCEPTED_ON_L1};Y.ETransactionExecutionStatus={SUCCEEDED:Y.STATUS_SUCCEEDED,REVERTED:Y.STATUS_REVERTED};Y.EBlockTag={LATEST:"latest",PENDING:"pending"};Y.EDataAvailabilityMode={L1:"L1",L2:"L2"};Y.EDAMode={L1:0,L2:1};Y.ETransactionVersion={V0:"0x0",V1:"0x1",V2:"0x2",V3:"0x3",F0:"0x100000000000000000000000000000000",F1:"0x100000000000000000000000000000001",F2:"0x100000000000000000000000000000002",F3:"0x100000000000000000000000000000003"};Y.ETransactionVersion2={V0:Y.ETransactionVersion.V0,V1:Y.ETransactionVersion.V1,V2:Y.ETransactionVersion.V2,F0:Y.ETransactionVersion.F0,F1:Y.ETransactionVersion.F1,F2:Y.ETransactionVersion.F2};Y.ETransactionVersion3={V3:Y.ETransactionVersion.V3,F3:Y.ETransactionVersion.F3}});var uS=K(fS=>{D();N();Object.defineProperty(fS,"__esModule",{value:!0})});var lS=K(dS=>{D();N();Object.defineProperty(dS,"__esModule",{value:!0})});var Cv=K(kr=>{D();N();var hS=kr&&kr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),CK=kr&&kr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Zc=kr&&kr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&hS(t,e,r)},IK=kr&&kr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&hS(t,e,r);return CK(t,e),t};Object.defineProperty(kr,"__esModule",{value:!0});kr.CONTRACT=void 0;Zc(Q_(),kr);kr.CONTRACT=IK(tS());Zc(nS(),kr);Zc(sS(),kr);Zc(oS(),kr);Zc(cS(),kr);Zc(uS(),kr);Zc(lS(),kr)});var pS=K(op=>{D();N();Object.defineProperty(op,"__esModule",{value:!0});op.Permission=void 0;op.Permission={ACCOUNTS:"accounts"}});var bS=K(cp=>{D();N();Object.defineProperty(cp,"__esModule",{value:!0});cp.TypedDataRevision=void 0;cp.TypedDataRevision={ACTIVE:"1",LEGACY:"0"}});var vS=K(gS=>{D();N();Object.defineProperty(gS,"__esModule",{value:!0})});var mS=K(yS=>{D();N();Object.defineProperty(yS,"__esModule",{value:!0})});var _S=K(wS=>{D();N();Object.defineProperty(wS,"__esModule",{value:!0})});var xS=K(SS=>{D();N();Object.defineProperty(SS,"__esModule",{value:!0})});var AS=K(ES=>{D();N();Object.defineProperty(ES,"__esModule",{value:!0})});var Iv=K(_i=>{D();N();var BK=_i&&_i.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Jc=_i&&_i.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&BK(t,e,r)};Object.defineProperty(_i,"__esModule",{value:!0});Jc(pS(),_i);Jc(bS(),_i);Jc(vS(),_i);Jc(mS(),_i);Jc(_S(),_i);Jc(xS(),_i);Jc(AS(),_i)});var CS=K(PS=>{D();N();Object.defineProperty(PS,"__esModule",{value:!0})});var BS=K(IS=>{D();N();Object.defineProperty(IS,"__esModule",{value:!0})});var TS=K(MS=>{D();N();Object.defineProperty(MS,"__esModule",{value:!0})});var DS=K(OS=>{D();N();Object.defineProperty(OS,"__esModule",{value:!0})});var NS=K(js=>{D();N();var MK=js&&js.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),fp=js&&js.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&MK(t,e,r)};Object.defineProperty(js,"__esModule",{value:!0});fp(CS(),js);fp(BS(),js);fp(TS(),js);fp(DS(),js)});var up=K(sn=>{D();N();var RS=sn&&sn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),TK=sn&&sn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),FS=sn&&sn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&RS(t,e,r)},Bv=sn&&sn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&RS(t,e,r);return TK(t,e),t};Object.defineProperty(sn,"__esModule",{value:!0});sn.PAYMASTER_API=sn.WALLET_API=sn.API=void 0;FS(Cv(),sn);sn.API=Bv(Cv());FS(Iv(),sn);sn.WALLET_API=Bv(Iv());sn.PAYMASTER_API=Bv(NS())});var ef=K(Rt=>{D();N();var OK=Rt&&Rt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),DK=Rt&&Rt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),qS=Rt&&Rt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&OK(t,e,r);return DK(t,e),t};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.ETransactionExecutionStatus=Rt.ETransactionStatus=Rt.isRPC08_ResourceBounds=Rt.isRPC08_FeeEstimate=Rt.EDAMode=Rt.EDataAvailabilityMode=Rt.ETransactionVersion3=Rt.ETransactionVersion2=Rt.ETransactionVersion=Rt.RPCSPEC08=void 0;var Qc=qS(up());Rt.RPCSPEC08=qS(up());Rt.ETransactionVersion=Qc.ETransactionVersion;Rt.ETransactionVersion2=Qc.ETransactionVersion2;Rt.ETransactionVersion3=Qc.ETransactionVersion3;Rt.EDataAvailabilityMode=Qc.EDataAvailabilityMode;Rt.EDAMode=Qc.EDAMode;function NK(e){return"l1_data_gas_consumed"in e}Rt.isRPC08_FeeEstimate=NK;function RK(e){return"l1_data_gas"in e}Rt.isRPC08_ResourceBounds=RK;Rt.ETransactionStatus=Qc.ETransactionStatus;Rt.ETransactionExecutionStatus=Qc.ETransactionExecutionStatus});var HS=K(Ma=>{D();N();var FK=Ma&&Ma.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Mv=Ma&&Ma.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&FK(t,e,r)};Object.defineProperty(Ma,"__esModule",{value:!0});Mv(X_(),Ma);Mv(Z_(),Ma);Mv(ef(),Ma)});var kS=K(jS=>{D();N();Object.defineProperty(jS,"__esModule",{value:!0})});var KS=K(LS=>{D();N();Object.defineProperty(LS,"__esModule",{value:!0})});var VS=K($i=>{D();N();Object.defineProperty($i,"__esModule",{value:!0});$i.NON_ZERO_PREFIX=$i.ETH_ADDRESS=$i.Literal=$i.Uint=$i.ValidateType=void 0;$i.ValidateType={DEPLOY:"DEPLOY",CALL:"CALL",INVOKE:"INVOKE"};$i.Uint={u8:"core::integer::u8",u16:"core::integer::u16",u32:"core::integer::u32",u64:"core::integer::u64",u128:"core::integer::u128",u256:"core::integer::u256",u512:"core::integer::u512"};$i.Literal={ClassHash:"core::starknet::class_hash::ClassHash",ContractAddress:"core::starknet::contract_address::ContractAddress",Secp256k1Point:"core::starknet::secp256k1::Secp256k1Point",U96:"core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>"};$i.ETH_ADDRESS="core::starknet::eth_address::EthAddress";$i.NON_ZERO_PREFIX="core::zeroable::NonZero::"});var zS=K(US=>{D();N();Object.defineProperty(US,"__esModule",{value:!0})});var GS=K($S=>{D();N();Object.defineProperty($S,"__esModule",{value:!0})});var WS=K(Io=>{D();N();Object.defineProperty(Io,"__esModule",{value:!0});Io.OutsideExecutionVersion=Io.OutsideExecutionTypesV2=Io.OutsideExecutionTypesV1=void 0;Io.OutsideExecutionTypesV1={StarkNetDomain:[{name:"name",type:"felt"},{name:"version",type:"felt"},{name:"chainId",type:"felt"}],OutsideExecution:[{name:"caller",type:"felt"},{name:"nonce",type:"felt"},{name:"execute_after",type:"felt"},{name:"execute_before",type:"felt"},{name:"calls_len",type:"felt"},{name:"calls",type:"OutsideCall*"}],OutsideCall:[{name:"to",type:"felt"},{name:"selector",type:"felt"},{name:"calldata_len",type:"felt"},{name:"calldata",type:"felt*"}]};Io.OutsideExecutionTypesV2={StarknetDomain:[{name:"name",type:"shortstring"},{name:"version",type:"shortstring"},{name:"chainId",type:"shortstring"},{name:"revision",type:"shortstring"}],OutsideExecution:[{name:"Caller",type:"ContractAddress"},{name:"Nonce",type:"felt"},{name:"Execute After",type:"u128"},{name:"Execute Before",type:"u128"},{name:"Calls",type:"Call*"}],Call:[{name:"To",type:"ContractAddress"},{name:"Selector",type:"selector"},{name:"Calldata",type:"felt*"}]};Io.OutsideExecutionVersion={UNSUPPORTED:"0",V1:"1",V2:"2"}});var YS=K(XS=>{D();N();Object.defineProperty(XS,"__esModule",{value:!0})});var JS=K(ZS=>{D();N();Object.defineProperty(ZS,"__esModule",{value:!0})});var QS=K(dp=>{D();N();Object.defineProperty(dp,"__esModule",{value:!0});dp.TypedDataRevision=void 0;var qK=up();Object.defineProperty(dp,"TypedDataRevision",{enumerable:!0,get:function(){return qK.TypedDataRevision}})});var tx=K(ex=>{D();N();Object.defineProperty(ex,"__esModule",{value:!0})});var lp=K(Si=>{D();N();var rx=Si&&Si.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),HK=Si&&Si.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jK=Si&&Si.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&rx(t,e,r);return HK(t,e),t},kK=Si&&Si.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&rx(t,e,r)};Object.defineProperty(Si,"__esModule",{value:!0});Si.JRPC=void 0;Si.JRPC=jK(tx());kK(ef(),Si)});var ks=K(cr=>{D();N();var nx=cr&&cr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),LK=cr&&cr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),vs=cr&&cr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&nx(t,e,r)},KK=cr&&cr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&nx(t,e,r);return LK(t,e),t};Object.defineProperty(cr,"__esModule",{value:!0});cr.RPC=void 0;vs(G_(),cr);vs(HS(),cr);vs(kS(),cr);vs(KS(),cr);vs(VS(),cr);vs(zS(),cr);vs(GS(),cr);vs(WS(),cr);vs(YS(),cr);vs(JS(),cr);vs(QS(),cr);cr.RPC=KK(lp())});var tf=K(Tv=>{D();N();Object.defineProperty(Tv,"__esModule",{value:!0});function VK(e,t){if(!e)throw new Error(t||"Assertion failure")}Tv.default=VK});var jn=K(Bt=>{D();N();Object.defineProperty(Bt,"__esModule",{value:!0});Bt.concatenateArrayBuffer=Bt.pascalToSnake=Bt.sanitizeHex=Bt.sanitizeBytes=Bt.calcByteLength=Bt.padLeft=Bt.addHexPrefix=Bt.removeHexPrefix=Bt.buf2hex=Bt.btoaUniversal=Bt.atobUniversal=Bt.utf8ToArray=Bt.arrayBufferToString=Bt.IS_BROWSER=void 0;var ix=ar();Bt.IS_BROWSER=typeof window<"u";var Ov="0";function UK(e){return new Uint8Array(e).reduce((t,r)=>t+String.fromCharCode(r),"")}Bt.arrayBufferToString=UK;function zK(e){return new TextEncoder().encode(e)}Bt.utf8ToArray=zK;function $K(e){return ix.base.fromBase64(e)}Bt.atobUniversal=$K;function GK(e){return ix.base.toBase64(new Uint8Array(e))}Bt.btoaUniversal=GK;function WK(e){return e.reduce((t,r)=>t+r.toString(16).padStart(2,"0"),"")}Bt.buf2hex=WK;function Dv(e){return e.replace(/^0x/i,"")}Bt.removeHexPrefix=Dv;function sx(e){return`0x${Dv(e)}`}Bt.addHexPrefix=sx;function XK(e,t,r,n=Ov){let i=t-e.length,s=e;if(i>0){let a=n.repeat(i);s=r?a+e:e+a}return s}function ax(e,t,r=Ov){return XK(e,t,!0,r)}Bt.padLeft=ax;function ox(e,t=8){let{length:r}=e,n=r%t;return n?(r-n)/t*t+t:r}Bt.calcByteLength=ox;function cx(e,t=8,r=Ov){return ax(e,ox(e,t),r)}Bt.sanitizeBytes=cx;function YK(e){let t=Dv(e),r=cx(t,2);return r&&sx(r)}Bt.sanitizeHex=YK;var ZK=e=>/[a-z]/.test(e)?e.split(/(?=[A-Z])/).join("_").toUpperCase():e;Bt.pascalToSnake=ZK;function JK(e){let t=e.reduce((i,s)=>i+s.byteLength,0),r=new Uint8Array(t),n=0;return e.forEach(i=>{r.set(i,n),n+=i.byteLength}),r}Bt.concatenateArrayBuffer=JK});var kn=K(pe=>{D();N();Object.defineProperty(pe,"__esModule",{value:!0});pe.SYSTEM_MESSAGES=pe.RPC_DEFAULT_NODES=pe.DEFAULT_GLOBAL_CONFIG=pe.SupportedRpcVersion=pe.TransactionHashPrefix=pe.StarknetChainId=pe.NetworkName=pe.BaseUrl=pe.HARDENING_4BYTES=pe.HARDENING_BYTE=pe.SNIP9_V2_INTERFACE_ID=pe.SNIP9_V1_INTERFACE_ID=pe.OutsideExecutionCallerAny=pe.UDC=pe.RANGE_U128=pe.RANGE_I128=pe.RANGE_FELT=pe.ADDR_BOUND=pe.MAX_STORAGE_ITEM_SIZE=pe.PRIME=pe.API_VERSION=pe.MASK_31=pe.MASK_250=pe.ZERO=pe.TRANSACTION_VERSION=pe.TEXT_TO_FELT_MAX_LEN=pe.IS_BROWSER=void 0;var QK=ks(),eV=lp(),tV=jn();Object.defineProperty(pe,"IS_BROWSER",{enumerable:!0,get:function(){return tV.IS_BROWSER}});pe.TEXT_TO_FELT_MAX_LEN=31;pe.TRANSACTION_VERSION=eV.RPCSPEC08.ETransactionVersion;pe.ZERO=0n;pe.MASK_250=2n**250n-1n;pe.MASK_31=2n**31n-1n;pe.API_VERSION=pe.ZERO;pe.PRIME=2n**251n+17n*2n**192n+1n;pe.MAX_STORAGE_ITEM_SIZE=256n;pe.ADDR_BOUND=2n**251n-pe.MAX_STORAGE_ITEM_SIZE;var Nv=(e,t)=>({min:e,max:t});pe.RANGE_FELT=Nv(pe.ZERO,pe.PRIME-1n);pe.RANGE_I128=Nv(-(2n**127n),2n**127n-1n);pe.RANGE_U128=Nv(pe.ZERO,2n**128n-1n);pe.UDC={ADDRESS:"0x041a78e741e5af2fec34b695679bc6891742439f7afb8484ecd7766661ad02bf",ENTRYPOINT:"deployContract"};pe.OutsideExecutionCallerAny="0x414e595f43414c4c4552";pe.SNIP9_V1_INTERFACE_ID="0x68cfd18b92d1907b8ba3cc324900277f5a3622099431ea85dd8089255e4181";pe.SNIP9_V2_INTERFACE_ID="0x1d1144bb2138366ff28d8e9ab57456b1d332ac42196230c3a602003c89872";pe.HARDENING_BYTE=128;pe.HARDENING_4BYTES=2147483648n;var rV={SN_MAIN:"https://alpha-mainnet.starknet.io",SN_SEPOLIA:"https://alpha-sepolia.starknet.io"};pe.BaseUrl=rV;var nV={SN_MAIN:"SN_MAIN",SN_SEPOLIA:"SN_SEPOLIA"};pe.NetworkName=nV;var iV={SN_MAIN:"0x534e5f4d41494e",SN_SEPOLIA:"0x534e5f5345504f4c4941"};pe.StarknetChainId=iV;var sV={DECLARE:"0x6465636c617265",DEPLOY:"0x6465706c6f79",DEPLOY_ACCOUNT:"0x6465706c6f795f6163636f756e74",INVOKE:"0x696e766f6b65",L1_HANDLER:"0x6c315f68616e646c6572"};pe.TransactionHashPrefix=sV;var aV={"0.7.1":"0.7.1","0.8.1":"0.8.1",v0_7_1:"0.7.1",v0_8_1:"0.8.1"};pe.SupportedRpcVersion=aV;pe.DEFAULT_GLOBAL_CONFIG={legacyMode:!1,rpcVersion:"0.8.1",transactionVersion:QK.ETransactionVersion.V3,feeMarginPercentage:{bounds:{l1_gas:{max_amount:50,max_price_per_unit:50},l1_data_gas:{max_amount:50,max_price_per_unit:50},l2_gas:{max_amount:50,max_price_per_unit:50}},maxFee:50},fetch:void 0,websocket:void 0};pe.RPC_DEFAULT_NODES={SN_MAIN:["https://starknet-mainnet.public.blastapi.io/rpc/","https://free-rpc.nethermind.io/mainnet-juno/"],SN_SEPOLIA:["https://starknet-sepolia.public.blastapi.io/rpc/","https://free-rpc.nethermind.io/sepolia-juno/"]};pe.SYSTEM_MESSAGES={legacyTxWarningMessage:`You are using a deprecated transaction version (V0,V1,V2)!
Update to the latest V3 transactions!`,legacyTxRPC08Message:"RPC 0.8 do not support legacy transactions",SWOldV3:"RPC 0.7 V3 tx (improper resource bounds) not supported in RPC 0.8",channelVersionMismatch:"Channel specification version is not compatible with the connected node Specification Version",unsupportedSpecVersion:"The connected node specification version is not supported by this library"}});var Ir=K(di=>{D();N();Object.defineProperty(di,"__esModule",{value:!0});di.isObject=di.isString=di.isBigInt=di.isBoolean=di.isNumber=di.isUndefined=void 0;var oV=e=>typeof e>"u"||e===void 0;di.isUndefined=oV;function cV(e){return typeof e=="number"}di.isNumber=cV;function fV(e){return typeof e=="boolean"}di.isBoolean=fV;function uV(e){return typeof e=="bigint"}di.isBigInt=uV;function dV(e){return typeof e=="string"}di.isString=dV;function lV(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}di.isObject=lV});var yr=K(Pe=>{D();N();var hV=Pe&&Pe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.isBigNumberish=Pe.stringToSha256ToArrayBuff4=Pe.addPercent=Pe.hexToBytes=Pe.toCairoBool=Pe.getHexStringArray=Pe.getHexString=Pe.getDecimalString=Pe.isStringWholeNumber=Pe.bigNumberishArrayToHexadecimalStringArray=Pe.bigNumberishArrayToDecimalStringArray=Pe.assertInRange=Pe.cleanHex=Pe.hexToDecimalString=Pe.toHex64=Pe.toStorageKey=Pe.toHexString=Pe.toHex=Pe.tryToBigInt=Pe.toBigInt=Pe.isHex=void 0;var fx=ar(),pV=kn(),bV=hV(tf()),rf=jn(),Rv=Ir();function O0(e){return/^0x[0-9a-f]*$/i.test(e)}Pe.isHex=O0;function D0(e){return BigInt(e)}Pe.toBigInt=D0;function gV(e){return e?BigInt(e):void 0}Pe.tryToBigInt=gV;function hp(e){return(0,rf.addHexPrefix)(D0(e).toString(16))}Pe.toHex=hp;Pe.toHexString=hp;function vV(e){return(0,rf.addHexPrefix)(D0(e).toString(16).padStart(64,"0"))}Pe.toStorageKey=vV;function yV(e){let t=(0,rf.addHexPrefix)(D0(e).toString(16).padStart(64,"0"));if(t.length!==66)throw TypeError("number is too big for hex 0x(64) representation");return t}Pe.toHex64=yV;function ux(e){return BigInt((0,rf.addHexPrefix)(e)).toString(10)}Pe.hexToDecimalString=ux;function mV(e){return e.toLowerCase().replace(/^(0x)0+/,"$1")}Pe.cleanHex=mV;function wV(e,t,r,n=""){let i=n===""?"invalid length":`invalid ${n} length`,s=BigInt(e),a=BigInt(t),o=BigInt(r);(0,bV.default)(s>=a&&s<=o,`Message not signable, ${i}.`)}Pe.assertInRange=wV;function _V(e){return e.map(t=>D0(t).toString(10))}Pe.bigNumberishArrayToDecimalStringArray=_V;function SV(e){return e.map(t=>hp(t))}Pe.bigNumberishArrayToHexadecimalStringArray=SV;function pp(e){return/^\d+$/.test(e)}Pe.isStringWholeNumber=pp;function xV(e){if(O0(e))return ux(e);if(pp(e))return e;throw new Error(`${e} needs to be a hex-string or whole-number-string`)}Pe.getDecimalString=xV;function dx(e){if(O0(e))return e;if(pp(e))return(0,Pe.toHexString)(e);throw new Error(`${e} needs to be a hex-string or whole-number-string`)}Pe.getHexString=dx;function EV(e){return e.map(dx)}Pe.getHexStringArray=EV;function AV(e){return(+e).toString()}Pe.toCairoBool=AV;function lx(e){if(!O0(e))throw new Error(`${e} needs to be a hex-string`);let t=(0,rf.removeHexPrefix)(e);return t.length%2!==0&&(t=`0${t}`),fx.base.fromHex(t)}Pe.hexToBytes=lx;function PV(e,t){let r=BigInt(e);return r+r*BigInt(t)/100n}Pe.addPercent=PV;function CV(e){let r=(n=>Number(n&pV.MASK_31))(BigInt((0,rf.addHexPrefix)((0,rf.buf2hex)(fx.base.sha256(e)))));return lx(hp(r))}Pe.stringToSha256ToArrayBuff4=CV;function IV(e){return(0,Rv.isNumber)(e)||(0,Rv.isBigInt)(e)||(0,Rv.isString)(e)&&(O0(e)||pp(e))}Pe.isBigNumberish=IV});var gp=K(li=>{D();N();Object.defineProperty(li,"__esModule",{value:!0});li.getL2MessageHash=li.solidityUint256PackedKeccak256=li.getSelector=li.getSelectorFromName=li.starknetKeccak=li.keccakBn=void 0;var bp=ar(),BV=kn(),Bo=jn(),Ta=yr(),hx=Ir();function MV(e){let t=(0,Bo.removeHexPrefix)((0,Ta.toHex)(BigInt(e))),r=t.length%2===0?t:`0${t}`;return(0,Bo.addHexPrefix)(bp.base.keccak((0,Ta.hexToBytes)((0,Bo.addHexPrefix)(r))).toString("hex"))}li.keccakBn=MV;function TV(e){return(0,Bo.addHexPrefix)(bp.base.keccak((0,Bo.utf8ToArray)(e)).toString("hex"))}function px(e){return BigInt(TV(e))&BV.MASK_250}li.starknetKeccak=px;function bx(e){return(0,Ta.toHex)(px(e))}li.getSelectorFromName=bx;function OV(e){return(0,hx.isNumber)(e)||(0,hx.isBigInt)(e)?(0,Ta.toHex)(e):(0,Ta.isHex)(e)?e:(0,Ta.isStringWholeNumber)(e)?(0,Ta.toHex)(e):bx(e)}li.getSelector=OV;function gx(e){let t=(0,Bo.addHexPrefix)(e.reduce((r,n)=>r+(0,Bo.removeHexPrefix)((0,Ta.toHex)(n)).padStart(64,"0"),""));return(0,Bo.addHexPrefix)(bp.base.toHex(bp.base.keccak_256((0,Ta.hexToBytes)(t))))}li.solidityUint256PackedKeccak256=gx;function DV(e,t,r,n,i){return gx([e,t,i,r,n.length,...n])}li.getL2MessageHash=DV});var xi=K(Br=>{D();N();Object.defineProperty(Br,"__esModule",{value:!0});Br.decodeShortString=Br.encodeShortString=Br.splitLongString=Br.isLongText=Br.isShortText=Br.isText=Br.isDecimalString=Br.isShortString=Br.isASCII=void 0;var vx=kn(),yx=jn(),Fv=yr(),NV=Ir();function qv(e){return/^[\x00-\x7F]*$/.test(e)}Br.isASCII=qv;function vp(e){return e.length<=vx.TEXT_TO_FELT_MAX_LEN}Br.isShortString=vp;function mx(e){return/^[0-9]*$/i.test(e)}Br.isDecimalString=mx;function Hv(e){return(0,NV.isString)(e)&&!(0,Fv.isHex)(e)&&!(0,Fv.isStringWholeNumber)(e)}Br.isText=Hv;var RV=e=>Hv(e)&&vp(e);Br.isShortText=RV;var FV=e=>Hv(e)&&!vp(e);Br.isLongText=FV;function qV(e){let t=RegExp(`[^]{1,${vx.TEXT_TO_FELT_MAX_LEN}}`,"g");return e.match(t)||[]}Br.splitLongString=qV;function HV(e){if(!qv(e))throw new Error(`${e} is not an ASCII string`);if(!vp(e))throw new Error(`${e} is too long`);return(0,yx.addHexPrefix)(e.replace(/./g,t=>t.charCodeAt(0).toString(16)))}Br.encodeShortString=HV;function wx(e){if(!qv(e))throw new Error(`${e} is not an ASCII string`);if((0,Fv.isHex)(e))return(0,yx.removeHexPrefix)(e).replace(/.{2}/g,t=>String.fromCharCode(parseInt(t,16)));if(mx(e))return wx("0X".concat(BigInt(e).toString(16)));throw new Error(`${e} is not Hex or decimal`)}Br.decodeShortString=wx});var Ru=K(Nu=>{D();N();Object.defineProperty(Nu,"__esModule",{value:!0});Nu.byteArrayFromString=Nu.stringFromByteArray=void 0;var _x=yr(),yp=xi();function jV(e){let t=BigInt(e.pending_word)===0n?"":(0,yp.decodeShortString)((0,_x.toHex)(e.pending_word));return e.data.reduce((r,n)=>{let i=BigInt(n)===0n?"":(0,yp.decodeShortString)((0,_x.toHex)(n));return r+i},"")+t}Nu.stringFromByteArray=jV;function kV(e){let t=(0,yp.splitLongString)(e),r=t[t.length-1],n=t.map(yp.encodeShortString),[i,s]=r===void 0||r.length===31?["0x00",0]:[n.pop(),r.length];return{data:n.length===0?[]:n,pending_word:i,pending_word_len:s}}Nu.byteArrayFromString=kV});var wp=K(mp=>{D();N();Object.defineProperty(mp,"__esModule",{value:!0});mp.CairoFelt=void 0;var Sx=yr(),jv=xi(),kv=Ir();function LV(e){if((0,kv.isBigInt)(e)||Number.isInteger(e))return e.toString();if((0,kv.isString)(e)){if((0,Sx.isHex)(e))return BigInt(e).toString();if((0,jv.isText)(e)){if(!(0,jv.isShortString)(e))throw new Error(`${e} is a long string > 31 chars. Please split it into an array of short strings.`);return BigInt((0,jv.encodeShortString)(e)).toString()}if((0,Sx.isStringWholeNumber)(e))return e}if((0,kv.isBoolean)(e))return`${+e}`;throw new Error(`${e} can't be computed by felt()`)}mp.CairoFelt=LV});var Mo=K(rr=>{D();N();Object.defineProperty(rr,"__esModule",{value:!0});rr.CairoUint256=rr.UINT_256_HIGH_MIN=rr.UINT_256_LOW_MIN=rr.UINT_256_HIGH_MAX=rr.UINT_256_LOW_MAX=rr.UINT_256_MIN=rr.UINT_256_MAX=rr.UINT_128_MAX=void 0;var xx=jn(),Ex=wp();rr.UINT_128_MAX=(1n<<128n)-1n;rr.UINT_256_MAX=(1n<<256n)-1n;rr.UINT_256_MIN=0n;rr.UINT_256_LOW_MAX=340282366920938463463374607431768211455n;rr.UINT_256_HIGH_MAX=340282366920938463463374607431768211455n;rr.UINT_256_LOW_MIN=0n;rr.UINT_256_HIGH_MIN=0n;var Ls=class{constructor(...t){if(typeof t[0]=="object"&&t.length===1&&"low"in t[0]&&"high"in t[0]){let r=Ls.validateProps(t[0].low,t[0].high);this.low=r.low,this.high=r.high}else if(t.length===1){let r=Ls.validate(t[0]);this.low=r&rr.UINT_128_MAX,this.high=r>>128n}else if(t.length===2){let r=Ls.validateProps(t[0],t[1]);this.low=r.low,this.high=r.high}else throw Error("Incorrect constructor parameters")}static validate(t){let r=BigInt(t);if(r<rr.UINT_256_MIN)throw Error("bigNumberish is smaller than UINT_256_MIN");if(r>rr.UINT_256_MAX)throw new Error("bigNumberish is bigger than UINT_256_MAX");return r}static validateProps(t,r){let n=BigInt(t),i=BigInt(r);if(n<rr.UINT_256_LOW_MIN||n>rr.UINT_256_LOW_MAX)throw new Error("low is out of range UINT_256_LOW_MIN - UINT_256_LOW_MAX");if(i<rr.UINT_256_HIGH_MIN||i>rr.UINT_256_HIGH_MAX)throw new Error("high is out of range UINT_256_HIGH_MIN - UINT_256_HIGH_MAX");return{low:n,high:i}}static is(t){try{Ls.validate(t)}catch{return!1}return!0}static isAbiType(t){return t===Ls.abiSelector}toBigInt(){return(this.high<<128n)+this.low}toUint256HexString(){return{low:(0,xx.addHexPrefix)(this.low.toString(16)),high:(0,xx.addHexPrefix)(this.high.toString(16))}}toUint256DecimalString(){return{low:this.low.toString(10),high:this.high.toString(10)}}toApiRequest(){return[(0,Ex.CairoFelt)(this.low),(0,Ex.CairoFelt)(this.high)]}};rr.CairoUint256=Ls;Ls.abiSelector="core::integer::u256"});var Fu=K(Ei=>{D();N();Object.defineProperty(Ei,"__esModule",{value:!0});Ei.CairoUint512=Ei.UINT_128_MIN=Ei.UINT_512_MIN=Ei.UINT_512_MAX=void 0;var _p=jn(),Sp=wp(),xp=Mo();Ei.UINT_512_MAX=(1n<<512n)-1n;Ei.UINT_512_MIN=0n;Ei.UINT_128_MIN=0n;var Ks=class{constructor(...t){if(typeof t[0]=="object"&&t.length===1&&"limb0"in t[0]&&"limb1"in t[0]&&"limb2"in t[0]&&"limb3"in t[0]){let r=Ks.validateProps(t[0].limb0,t[0].limb1,t[0].limb2,t[0].limb3);this.limb0=r.limb0,this.limb1=r.limb1,this.limb2=r.limb2,this.limb3=r.limb3}else if(t.length===1){let r=Ks.validate(t[0]);this.limb0=r&xp.UINT_128_MAX,this.limb1=(r&xp.UINT_128_MAX<<128n)>>128n,this.limb2=(r&xp.UINT_128_MAX<<256n)>>256n,this.limb3=r>>384n}else if(t.length===4){let r=Ks.validateProps(t[0],t[1],t[2],t[3]);this.limb0=r.limb0,this.limb1=r.limb1,this.limb2=r.limb2,this.limb3=r.limb3}else throw Error("Incorrect Uint512 constructor parameters")}static validate(t){let r=BigInt(t);if(r<Ei.UINT_512_MIN)throw Error("bigNumberish is smaller than UINT_512_MIN.");if(r>Ei.UINT_512_MAX)throw Error("bigNumberish is bigger than UINT_512_MAX.");return r}static validateProps(t,r,n,i){let s=BigInt(t),a=BigInt(r),o=BigInt(n),c=BigInt(i);return[s,a,o,c].forEach((u,b)=>{if(u<Ei.UINT_128_MIN||u>xp.UINT_128_MAX)throw Error(`limb${b} is not in the range of a u128 number`)}),{limb0:s,limb1:a,limb2:o,limb3:c}}static is(t){try{Ks.validate(t)}catch{return!1}return!0}static isAbiType(t){return t===Ks.abiSelector}toBigInt(){return(this.limb3<<384n)+(this.limb2<<256n)+(this.limb1<<128n)+this.limb0}toUint512HexString(){return{limb0:(0,_p.addHexPrefix)(this.limb0.toString(16)),limb1:(0,_p.addHexPrefix)(this.limb1.toString(16)),limb2:(0,_p.addHexPrefix)(this.limb2.toString(16)),limb3:(0,_p.addHexPrefix)(this.limb3.toString(16))}}toUint512DecimalString(){return{limb0:this.limb0.toString(10),limb1:this.limb1.toString(10),limb2:this.limb2.toString(10),limb3:this.limb3.toString(10)}}toApiRequest(){return[(0,Sp.CairoFelt)(this.limb0),(0,Sp.CairoFelt)(this.limb1),(0,Sp.CairoFelt)(this.limb2),(0,Sp.CairoFelt)(this.limb3)]}};Ei.CairoUint512=Ks;Ks.abiSelector="core::integer::u512"});var ys=K(be=>{D();N();Object.defineProperty(be,"__esModule",{value:!0});be.felt=be.tuple=be.uint512=be.uint256=be.getAbiContractVersion=be.isTypeNonZero=be.isCairo1Abi=be.getArrayType=be.isCairo1Type=be.isTypeSecp256k1Point=be.isTypeU96=be.isTypeByteArray=be.isTypeBytes31=be.isTypeEthAddress=be.isTypeContractAddress=be.isTypeBool=be.isTypeLiteral=be.isTypeUint256=be.isTypeUint=be.isTypeResult=be.isTypeOption=be.isTypeEnum=be.isTypeStruct=be.isTypeNamedTuple=be.isTypeTuple=be.isTypeArray=be.isTypeFelt=be.isLen=void 0;var qu=ks(),KV=wp(),Ax=Mo(),VV=Fu(),UV=e=>/_len$/.test(e);be.isLen=UV;var zV=e=>e==="felt"||e==="core::felt252";be.isTypeFelt=zV;var $V=e=>/\*/.test(e)||e.startsWith("core::array::Array::")||e.startsWith("core::array::Span::");be.isTypeArray=$V;var GV=e=>/^\(.*\)$/i.test(e);be.isTypeTuple=GV;var WV=e=>/\(.*\)/i.test(e)&&e.includes(":");be.isTypeNamedTuple=WV;var XV=(e,t)=>e in t;be.isTypeStruct=XV;var YV=(e,t)=>e in t;be.isTypeEnum=YV;var ZV=e=>e.startsWith("core::option::Option::");be.isTypeOption=ZV;var JV=e=>e.startsWith("core::result::Result::");be.isTypeResult=JV;var QV=e=>Object.values(qu.Uint).includes(e);be.isTypeUint=QV;var eU=e=>Ax.CairoUint256.isAbiType(e);be.isTypeUint256=eU;var tU=e=>Object.values(qu.Literal).includes(e);be.isTypeLiteral=tU;var rU=e=>e==="core::bool";be.isTypeBool=rU;var nU=e=>e===qu.Literal.ContractAddress;be.isTypeContractAddress=nU;var iU=e=>e===qu.ETH_ADDRESS;be.isTypeEthAddress=iU;var sU=e=>e==="core::bytes_31::bytes31";be.isTypeBytes31=sU;var aU=e=>e==="core::byte_array::ByteArray";be.isTypeByteArray=aU;var oU=e=>e==="core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>";be.isTypeU96=oU;var cU=e=>e===qu.Literal.Secp256k1Point;be.isTypeSecp256k1Point=cU;var fU=e=>e.includes("::");be.isCairo1Type=fU;var uU=e=>(0,be.isCairo1Type)(e)?e.substring(e.indexOf("<")+1,e.lastIndexOf(">")):e.replace("*","");be.getArrayType=uU;function dU(e){let{cairo:t}=Px(e);if(t===void 0)throw Error("Unable to determine Cairo version");return t==="1"}be.isCairo1Abi=dU;function lU(e){return e.startsWith(qu.NON_ZERO_PREFIX)}be.isTypeNonZero=lU;function Px(e){if(e.find(n=>n.type==="interface"))return{cairo:"1",compiler:"2"};let t=e.find(n=>(n.type==="function"||n.type==="constructor")&&(n.inputs.length||n.outputs.length));if(!t)return{cairo:void 0,compiler:void 0};let r=t.inputs.length?t.inputs:t.outputs;return(0,be.isCairo1Type)(r[0].type)?{cairo:"1",compiler:"1"}:{cairo:"0",compiler:"0"}}be.getAbiContractVersion=Px;var hU=e=>new Ax.CairoUint256(e).toUint256DecimalString();be.uint256=hU;var pU=e=>new VV.CairoUint512(e).toUint512DecimalString();be.uint512=pU;var bU=(...e)=>({...e});be.tuple=bU;function gU(e){return(0,KV.CairoFelt)(e)}be.felt=gU});var Cx=K(Ap=>{D();N();Object.defineProperty(Ap,"__esModule",{value:!0});Ap.CairoCustomEnum=void 0;var Ep=Ir(),Lv=class{constructor(t){let r=Object.values(t);if(r.length===0)throw new Error("This Enum must have at least 1 variant");if(r.filter(i=>!(0,Ep.isUndefined)(i)).length!==1)throw new Error("This Enum must have exactly one active variant");this.variant=t}unwrap(){return Object.values(this.variant).find(r=>!(0,Ep.isUndefined)(r))}activeVariant(){let r=Object.entries(this.variant).find(n=>!(0,Ep.isUndefined)(n[1]));return(0,Ep.isUndefined)(r)?"":r[0]}};Ap.CairoCustomEnum=Lv});var Bx=K(To=>{D();N();Object.defineProperty(To,"__esModule",{value:!0});To.CairoOption=To.CairoOptionVariant=void 0;var Ix=Ir();To.CairoOptionVariant={Some:0,None:1};var Kv=class{constructor(t,r){if(!(t in Object.values(To.CairoOptionVariant)))throw new Error("Wrong variant! It should be CairoOptionVariant.Some or .None.");if(t===To.CairoOptionVariant.Some){if((0,Ix.isUndefined)(r))throw new Error('The creation of a Cairo Option with "Some" variant needs a content as input.');this.Some=r,this.None=void 0}else this.Some=void 0,this.None=!0}unwrap(){return this.None?void 0:this.Some}isSome(){return!(0,Ix.isUndefined)(this.Some)}isNone(){return this.None===!0}};To.CairoOption=Kv});var Mx=K(Oo=>{D();N();Object.defineProperty(Oo,"__esModule",{value:!0});Oo.CairoResult=Oo.CairoResultVariant=void 0;var Pp=Ir();Oo.CairoResultVariant={Ok:0,Err:1};var Vv=class{constructor(t,r){if(!(t in Object.values(Oo.CairoResultVariant)))throw new Error("Wrong variant! It should be CairoResultVariant.Ok or .Err.");t===Oo.CairoResultVariant.Ok?(this.Ok=r,this.Err=void 0):(this.Ok=void 0,this.Err=r)}unwrap(){if(!(0,Pp.isUndefined)(this.Ok))return this.Ok;if(!(0,Pp.isUndefined)(this.Err))return this.Err;throw new Error("Both Result.Ok and .Err are undefined. Not authorized.")}isOk(){return!(0,Pp.isUndefined)(this.Ok)}isErr(){return!(0,Pp.isUndefined)(this.Err)}};Oo.CairoResult=Vv});var N0=K(Oa=>{D();N();var vU=Oa&&Oa.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Uv=Oa&&Oa.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&vU(t,e,r)};Object.defineProperty(Oa,"__esModule",{value:!0});Uv(Cx(),Oa);Uv(Bx(),Oa);Uv(Mx(),Oa)});var Ox=K($v=>{D();N();Object.defineProperty($v,"__esModule",{value:!0});var Tx=Ir(),yU=xi(),zv={isBN:(e,t,r)=>{if(!(0,Tx.isBigInt)(e[r]))throw new Error(`Data and formatter mismatch on ${r}:${t[r]}, expected response data ${r}:${e[r]} to be BN instead it is ${typeof e[r]}`)},unknown:(e,t,r)=>{throw new Error(`Unhandled formatter type on ${r}:${t[r]} for data ${r}:${e[r]}`)}};function Cp(e,t,r){return Object.entries(e).reduce((n,[i,s])=>{let a=r??t[i];if(!(i in t)&&!r)return n[i]=s,n;if(a==="string"){if(Array.isArray(e[i])){let o=Cp(e[i],e[i].map(c=>a));return n[i]=Object.values(o).join(""),n}return zv.isBN(e,t,i),n[i]=(0,yU.decodeShortString)(s),n}if(a==="number")return zv.isBN(e,t,i),n[i]=Number(s),n;if(typeof a=="function")return n[i]=a(s),n;if(Array.isArray(a)){let o=Cp(e[i],a,a[0]);return n[i]=Object.values(o),n}return(0,Tx.isObject)(a)?(n[i]=Cp(e[i],a),n):(zv.unknown(e,t,i),n)},{})}$v.default=Cp});var Dx=K(Ip=>{D();N();Object.defineProperty(Ip,"__esModule",{value:!0});Ip.AbiParser1=void 0;var mU=ys(),Gv=class{constructor(t){this.abi=t}methodInputsLength(t){return t.inputs.reduce((r,n)=>(0,mU.isLen)(n.name)?r:r+1,0)}getMethod(t){return this.abi.find(r=>r.name===t)}getLegacyFormat(){return this.abi}};Ip.AbiParser1=Gv});var Nx=K(Bp=>{D();N();Object.defineProperty(Bp,"__esModule",{value:!0});Bp.AbiParser2=void 0;var Wv=class{constructor(t){this.abi=t}methodInputsLength(t){return t.inputs.length}getMethod(t){return this.abi.find(n=>n.type==="interface")?.items?.find(n=>n.name===t)}getLegacyFormat(){return this.abi.flatMap(t=>t.type==="interface"?t.items:t)}};Bp.AbiParser2=Wv});var Fx=K(Do=>{D();N();Object.defineProperty(Do,"__esModule",{value:!0});Do.isNoConstructorValid=Do.getAbiVersion=Do.createAbiParser=void 0;var wU=ys(),_U=Dx(),SU=Nx();function xU(e){let t=Rx(e);if(t===0||t===1)return new _U.AbiParser1(e);if(t===2)return new SU.AbiParser2(e);throw Error(`Unsupported ABI version ${t}`)}Do.createAbiParser=xU;function Rx(e){return e.find(t=>t.type==="interface")?2:(0,wU.isCairo1Abi)(e)?1:0}Do.getAbiVersion=Rx;function EU(e,t,r){return e==="constructor"&&!r&&!t.length}Do.isNoConstructorValid=EU});var Mp=K(Xv=>{D();N();Object.defineProperty(Xv,"__esModule",{value:!0});var Hx=ys();function AU(e){let t=e.substring(0,e.indexOf(":")),r=e.substring(t.length+1);return{name:t,type:r}}function PU(e){if(!e.includes("("))return{subTuple:[],result:e};let t=[],r="",n=0;for(;n<e.length;){if(e[n]==="("){let i=1,s=n;for(n++;i;)e[n]===")"&&i--,e[n]==="("&&i++,n++;t.push(e.substring(s,n)),r+=" ",n--}else r+=e[n];n++}return{subTuple:t,result:r}}function CU(e){let t=e.replace(/\s/g,"").slice(1,-1),{subTuple:r,result:n}=PU(t),i=n.split(",").map(s=>r.length?s.replace(" ",r.shift()):s);return(0,Hx.isTypeNamedTuple)(e)&&(i=i.reduce((s,a)=>s.concat(AU(a)),[])),i}function qx(e,t,r){for(let n=0,i=0;n<e.length;n++)if(e[n]===t)i++;else if(e[n]===r&&--i===0)return n;return Number.POSITIVE_INFINITY}function IU(e){let t=e.slice(1,-1),r=[],n=0,i;for(;n<t.length;){switch(!0){case t[n]==="(":{i=n+qx(t.slice(n),"(",")")+1;break}case(t.startsWith("core::result::Result::<",n)||t.startsWith("core::array::Array::<",n)||t.startsWith("core::option::Option::<",n)):{i=n+qx(t.slice(n),"<",">")+1;break}default:{let s=t.indexOf(",",n);i=s!==-1?s:Number.POSITIVE_INFINITY}}r.push(t.slice(n,i)),n=i+2}return r}function BU(e){return(0,Hx.isCairo1Type)(e)?IU(e):CU(e)}Xv.default=BU});var R0=K(Hu=>{D();N();var MU=Hu&&Hu.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hu,"__esModule",{value:!0});Hu.CairoFixedArray=void 0;var jx=MU(tf()),Ai=class{constructor(t,r){(0,jx.default)(Ai.isTypeFixedArray(r),`The type ${r} is not a Cairo fixed array. Needs [type; length].`);try{Ai.getFixedArrayType(r)}catch{throw new Error(`The type ${r} do not includes any content type. Needs [type; length].`)}try{Ai.getFixedArraySize(r)}catch{throw new Error(`The type ${r} type do not includes any length. Needs [type; length].`)}(0,jx.default)(Ai.getFixedArraySize(r)===t.length,`The ABI type ${r} is expecting ${Ai.getFixedArraySize(r)} items. ${t.length} items provided.`),this.content=t,this.arrayType=r}static getFixedArraySize(t){let r=t.match(/(?<=; )\d+(?=\])/);if(r===null)throw new Error(`ABI type ${t} do not includes a valid number after ';' character.`);return Number(r[0])}getFixedArraySize(){return Ai.getFixedArraySize(this.arrayType)}getFixedArrayType(){return Ai.getFixedArrayType(this.arrayType)}static compile(t){return t.reduce((r,n,i)=>(r[i]=n,r),{})}compile(){return Ai.compile(this.content)}static isTypeFixedArray(t){return/^\[.*;\s.*\]$/.test(t)&&/(?<=\[).+(?=;)/.test(t)&&/(?<=; )\d+(?=\])/.test(t)}};Hu.CairoFixedArray=Ai;Ai.getFixedArrayType=e=>{let t=e.match(/(?<=\[).+(?=;)/);if(t===null)throw new Error(`ABI type ${e} do not includes a valid type of data.`);return t[0]}});var Lx=K(F0=>{D();N();var TU=F0&&F0.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(F0,"__esModule",{value:!0});var OU=Mo(),DU=Fu(),Ln=ys(),Da=N0(),NU=TU(Mp()),kx=Ir(),Yv=R0();function RU(e){return Error(`Your object includes the property : ${e}, containing an Uint256 object without the 'low' and 'high' keys.`)}function FU(e){return Error(`Your object includes the property : ${e}, containing an Uint512 object without the 'limb0' to 'limb3' keys.`)}function qU(e,t,r,n){let i=(h,d)=>{if(Yv.CairoFixedArray.isTypeFixedArray(d))return o(h,d);if((0,Ln.isTypeArray)(d))return a(h,d);if((0,Ln.isTypeEnum)(d,n)){let l=n[d];return u(h,l)}if((0,Ln.isTypeTuple)(d))return c(h,d);if((0,Ln.isTypeEthAddress)(d)||(0,Ln.isTypeNonZero)(d)||(0,Ln.isTypeByteArray)(d)||(0,Ln.isTypeU96)(d)||(0,Ln.isTypeSecp256k1Point)(d))return h;if(OU.CairoUint256.isAbiType(d)){let l=h;if(typeof l!="object")return l;if(!("low"in l&&"high"in l))throw RU(d);return{low:l.low,high:l.high}}if(DU.CairoUint512.isAbiType(d)){let l=h;if(typeof l!="object")return l;if(!["limb0","limb1","limb2","limb3"].every(y=>y in l))throw FU(d);return{limb0:l.limb0,limb1:l.limb1,limb2:l.limb2,limb3:l.limb3}}if((0,Ln.isTypeStruct)(d,r)){let l=r[d].members;return s(h,l)}return h},s=(h,d)=>d.reduce((y,p)=>{let m=w=>Object.defineProperty(y,p.name,{enumerable:!0,value:w??h[p.name]});if(h[p.name]==="undefined"&&((0,Ln.isCairo1Type)(p.type)||!(0,Ln.isLen)(p.name)))throw Error(`Your object needs a property with key : ${p.name} .`);return m(i(h[p.name],p.type)),y},{});function a(h,d){let l=(0,Ln.getArrayType)(d);return(0,kx.isString)(h)?h:h.map(y=>i(y,l))}function o(h,d){let l=Yv.CairoFixedArray.getFixedArrayType(d),y=Yv.CairoFixedArray.getFixedArraySize(d);if(Array.isArray(h)){if(y!==h.length)throw new Error(`ABI type ${d}: array provided do not includes  ${y} items. ${h.length} items provided.`);return h.map(p=>i(p,l))}if(y!==Object.keys(h).length)throw new Error(`ABI type ${d}: object provided do not includes  ${y} properties. ${Object.keys(h).length} items provided.`);return i(h,l)}function c(h,d){return(0,NU.default)(d).reduce((p,m,w)=>{let C=Object.keys(h),T=F=>Object.defineProperty(p,w.toString(),{enumerable:!0,value:F??h[C[w]]}),q=m?.type?m.type:m;return T(i(h[C[w]],q)),p},{})}let u=(h,d)=>{if((0,Ln.isTypeResult)(d.name)){let m=h,w=d.name.substring(d.name.indexOf("<")+1,d.name.lastIndexOf(",")),C=d.name.substring(d.name.indexOf(",")+1,d.name.lastIndexOf(">"));return m.isOk()?new Da.CairoResult(Da.CairoResultVariant.Ok,i(h.unwrap(),w)):new Da.CairoResult(Da.CairoResultVariant.Err,i(h.unwrap(),C))}if((0,Ln.isTypeOption)(d.name)){let m=h,w=d.name.substring(d.name.indexOf("<")+1,d.name.lastIndexOf(">"));return m.isSome()?new Da.CairoOption(Da.CairoOptionVariant.Some,i(m.unwrap(),w)):new Da.CairoOption(Da.CairoOptionVariant.None,{})}let l=h,p=Object.entries(l.variant).map(m=>{if((0,kx.isUndefined)(m[1]))return m;let w=d.type.substring(d.type.lastIndexOf("<")+1,d.type.lastIndexOf(">"));return w==="()"?m:[m[0],i(l.unwrap(),w)]});return new Da.CairoCustomEnum(Object.fromEntries(p))};return t.reduce((h,d)=>{let l=y=>Object.defineProperty(h,d.name,{enumerable:!0,value:y});return(0,Ln.isLen)(d.name)&&!(0,Ln.isCairo1Type)(d.type)||l(i(e[d.name],d.type)),h},{})}F0.default=qU});var Qv=K(Ku=>{D();N();var Kx=Ku&&Ku.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ku,"__esModule",{value:!0});Ku.parseCalldataField=void 0;var HU=Kx(tf()),ju=R0(),nf=Mo(),ku=Fu(),Zv=jn(),jU=yr(),Jv=xi(),q0=Ir(),kU=Ru(),Kt=ys(),Vs=N0(),LU=Kx(Mp());function Lu(e,t){switch(!0){case nf.CairoUint256.isAbiType(e):return new nf.CairoUint256(t).toApiRequest();case ku.CairoUint512.isAbiType(e):return new ku.CairoUint512(t).toApiRequest();case(0,Kt.isTypeBytes31)(e):return(0,Jv.encodeShortString)(t.toString());case(0,Kt.isTypeSecp256k1Point)(e):{let r=(0,Zv.removeHexPrefix)((0,jU.toHex)(t)).padStart(128,"0"),n=(0,Kt.uint256)((0,Zv.addHexPrefix)(r.slice(-64))),i=(0,Kt.uint256)((0,Zv.addHexPrefix)(r.slice(0,-64)));return[(0,Kt.felt)(i.low),(0,Kt.felt)(i.high),(0,Kt.felt)(n.low),(0,Kt.felt)(n.high)]}default:return(0,Kt.felt)(t)}}function KU(e,t){let r=(0,LU.default)(t),n=Object.values(e);if(n.length!==r.length)throw Error(`ParseTuple: provided and expected abi tuple size do not match.
      provided: ${n}
      expected: ${r}`);return r.map((i,s)=>({element:n[s],type:i.type??i}))}function VU(e){let t=(0,kU.byteArrayFromString)(e);return[t.data.length.toString(),...t.data.map(r=>r.toString()),t.pending_word.toString(),t.pending_word_len.toString()]}function Gi(e,t,r,n){if(e===void 0)throw Error(`Missing parameter for type ${t}`);if(ju.CairoFixedArray.isTypeFixedArray(t)){let i=ju.CairoFixedArray.getFixedArrayType(t),s=[];if(Array.isArray(e))s=new ju.CairoFixedArray(e,t).content;else if(typeof e=="object")s=Object.values(e),(0,HU.default)(s.length===ju.CairoFixedArray.getFixedArraySize(t),`ABI type ${t}: object provided do not includes  ${ju.CairoFixedArray.getFixedArraySize(t)} items. ${s.length} items provided.`);else throw new Error(`ABI type ${t}: not an Array representing a cairo.fixedArray() provided.`);return s.reduce((a,o)=>a.concat(Gi(o,i,r,n)),[])}if(Array.isArray(e)){let i=[];i.push((0,Kt.felt)(e.length));let s=(0,Kt.getArrayType)(t);return e.reduce((a,o)=>a.concat(Gi(o,s,r,n)),i)}if(r[t]&&r[t].members.length){if(nf.CairoUint256.isAbiType(t))return new nf.CairoUint256(e).toApiRequest();if(ku.CairoUint512.isAbiType(t))return new ku.CairoUint512(e).toApiRequest();if((0,Kt.isTypeEthAddress)(t))return Lu(t,e);if((0,Kt.isTypeByteArray)(t))return VU(e);let{members:i}=r[t],s=e;return i.reduce((a,o)=>a.concat(Gi(s[o.name],o.type,r,n)),[])}if((0,Kt.isTypeTuple)(t))return KU(e,t).reduce((s,a)=>{let o=Gi(a.element,a.type,r,n);return s.concat(o)},[]);if(nf.CairoUint256.isAbiType(t))return new nf.CairoUint256(e).toApiRequest();if(ku.CairoUint512.isAbiType(t))return new ku.CairoUint512(e).toApiRequest();if((0,Kt.isTypeEnum)(t,n)){let{variants:i}=n[t];if((0,Kt.isTypeOption)(t)){let h=e;if(h.isSome()){let d=i.find(p=>p.name==="Some");if((0,q0.isUndefined)(d))throw Error("Error in abi : Option has no 'Some' variant.");let l=d.type;if(l==="()")return Vs.CairoOptionVariant.Some.toString();let y=Gi(h.unwrap(),l,r,n);return Array.isArray(y)?[Vs.CairoOptionVariant.Some.toString(),...y]:[Vs.CairoOptionVariant.Some.toString(),y]}return Vs.CairoOptionVariant.None.toString()}if((0,Kt.isTypeResult)(t)){let h=e;if(h.isOk()){let p=i.find(C=>C.name==="Ok");if((0,q0.isUndefined)(p))throw Error("Error in abi : Result has no 'Ok' variant.");let m=p.type;if(m==="()")return Vs.CairoResultVariant.Ok.toString();let w=Gi(h.unwrap(),m,r,n);return Array.isArray(w)?[Vs.CairoResultVariant.Ok.toString(),...w]:[Vs.CairoResultVariant.Ok.toString(),w]}let d=i.find(p=>p.name==="Err");if((0,q0.isUndefined)(d))throw Error("Error in abi : Result has no 'Err' variant.");let l=d.type;if(l==="()")return Vs.CairoResultVariant.Err.toString();let y=Gi(h.unwrap(),l,r,n);return Array.isArray(y)?[Vs.CairoResultVariant.Err.toString(),...y]:[Vs.CairoResultVariant.Err.toString(),y]}let s=e,a=s.activeVariant(),o=i.find(h=>h.name===a);if((0,q0.isUndefined)(o))throw Error(`Not find in abi : Enum has no '${a}' variant.`);let c=o.type,u=i.findIndex(h=>h.name===a);if(c==="()")return u.toString();let b=Gi(s.unwrap(),c,r,n);return Array.isArray(b)?[u.toString(),...b]:[u.toString(),b]}if((0,Kt.isTypeNonZero)(t))return Lu((0,Kt.getArrayType)(t),e);if(typeof e=="object")throw Error(`Parameter ${e} do not align with abi parameter ${t}`);return Lu(t,e)}function UU(e,t,r,n){let{name:i,type:s}=t,{value:a}=e.next();switch(!0){case ju.CairoFixedArray.isTypeFixedArray(s):if(!Array.isArray(a)&&typeof a!="object")throw Error(`ABI expected parameter ${i} to be an array or an object, got ${a}`);return Gi(a,t.type,r,n);case(0,Kt.isTypeArray)(s):if(!Array.isArray(a)&&!(0,Jv.isText)(a))throw Error(`ABI expected parameter ${i} to be array or long string, got ${a}`);return(0,q0.isString)(a)&&(a=(0,Jv.splitLongString)(a)),Gi(a,t.type,r,n);case(0,Kt.isTypeNonZero)(s):return Lu((0,Kt.getArrayType)(s),a);case(0,Kt.isTypeEthAddress)(s):return Lu(s,a);case((0,Kt.isTypeStruct)(s,r)||(0,Kt.isTypeTuple)(s)||nf.CairoUint256.isAbiType(s)):return Gi(a,s,r,n);case(0,Kt.isTypeEnum)(s,n):return Gi(a,s,r,n);default:return Lu(s,a)}}Ku.parseCalldataField=UU});var Ux=K(k0=>{D();N();var zU=k0&&k0.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(k0,"__esModule",{value:!0});var Tp=R0(),Op=Mo(),Dp=Fu(),H0=jn(),Vx=yr(),$U=xi(),GU=Ru(),Lr=ys(),j0=N0(),WU=zU(Mp());function ey(e,t){let r;switch(!0){case(0,Lr.isTypeBool)(e):return r=t.next().value,Boolean(BigInt(r));case Op.CairoUint256.isAbiType(e):let n=t.next().value,i=t.next().value;return new Op.CairoUint256(n,i).toBigInt();case Dp.CairoUint512.isAbiType(e):let s=t.next().value,a=t.next().value,o=t.next().value,c=t.next().value;return new Dp.CairoUint512(s,a,o,c).toBigInt();case(0,Lr.isTypeEthAddress)(e):return r=t.next().value,BigInt(r);case(0,Lr.isTypeBytes31)(e):return r=t.next().value,(0,$U.decodeShortString)(r);case(0,Lr.isTypeSecp256k1Point)(e):let u=(0,H0.removeHexPrefix)(t.next().value).padStart(32,"0"),b=(0,H0.removeHexPrefix)(t.next().value).padStart(32,"0"),h=(0,H0.removeHexPrefix)(t.next().value).padStart(32,"0"),d=(0,H0.removeHexPrefix)(t.next().value).padStart(32,"0");return BigInt((0,H0.addHexPrefix)(b+u+d+h));default:return r=t.next().value,BigInt(r)}}function Pi(e,t,r,n){if(t.type==="()")return{};if(Op.CairoUint256.isAbiType(t.type)){let i=e.next().value,s=e.next().value;return new Op.CairoUint256(i,s).toBigInt()}if(Dp.CairoUint512.isAbiType(t.type)){let i=e.next().value,s=e.next().value,a=e.next().value,o=e.next().value;return new Dp.CairoUint512(i,s,a,o).toBigInt()}if((0,Lr.isTypeByteArray)(t.type)){let i=[],s=BigInt(e.next().value);for(;i.length<s;)i.push((0,Vx.toHex)(e.next().value));let a=(0,Vx.toHex)(e.next().value),o=BigInt(e.next().value),c={data:i,pending_word:a,pending_word_len:o};return(0,GU.stringFromByteArray)(c)}if(Tp.CairoFixedArray.isTypeFixedArray(t.type)){let i=[],s={name:"",type:Tp.CairoFixedArray.getFixedArrayType(t.type)},a=Tp.CairoFixedArray.getFixedArraySize(t.type);for(;i.length<a;)i.push(Pi(e,s,r,n));return i}if((0,Lr.isTypeArray)(t.type)){let i=[],s={name:"",type:(0,Lr.getArrayType)(t.type)},a=BigInt(e.next().value);for(;i.length<a;)i.push(Pi(e,s,r,n));return i}if((0,Lr.isTypeNonZero)(t.type)){let i={name:"",type:(0,Lr.getArrayType)(t.type)};return Pi(e,i,r,n)}if(r&&t.type in r&&r[t.type])return(0,Lr.isTypeEthAddress)(t.type)?ey(t.type,e):r[t.type].members.reduce((i,s)=>(i[s.name]=Pi(e,s,r,n),i),{});if(n&&t.type in n&&n[t.type]){let i=Number(e.next().value),s=n[t.type].variants.reduce((o,c,u)=>u===i?(o[c.name]=Pi(e,{name:"",type:c.type},r,n),o):(o[c.name]=void 0,o),{});if(t.type.startsWith("core::option::Option")){let o=i===j0.CairoOptionVariant.Some?s.Some:void 0;return new j0.CairoOption(i,o)}if(t.type.startsWith("core::result::Result")){let o;return i===j0.CairoResultVariant.Ok?o=s.Ok:o=s.Err,new j0.CairoResult(i,o)}return new j0.CairoCustomEnum(s)}if((0,Lr.isTypeTuple)(t.type))return(0,WU.default)(t.type).reduce((s,a,o)=>{let c=a?.name?a.name:o,u=a?.type?a.type:a,b={name:c,type:u};return s[c]=Pi(e,b,r,n),s},{});if((0,Lr.isTypeArray)(t.type)){let i=[],s={name:"",type:(0,Lr.getArrayType)(t.type)},a=BigInt(e.next().value);for(;i.length<a;)i.push(Pi(e,s,r,n));return i}return ey(t.type,e)}function XU(e,t,r,n,i){let{name:s,type:a}=t,o;switch(!0){case(0,Lr.isLen)(s):return o=e.next().value,BigInt(o);case(r&&a in r||(0,Lr.isTypeTuple)(a)):return Pi(e,t,r,n);case(n&&(0,Lr.isTypeEnum)(a,n)):return Pi(e,t,r,n);case Tp.CairoFixedArray.isTypeFixedArray(a):return Pi(e,t,r,n);case(0,Lr.isTypeArray)(a):if((0,Lr.isCairo1Type)(a))return Pi(e,t,r,n);let c=[];if(i&&i[`${s}_len`]){let u=i[`${s}_len`];for(;c.length<u;)c.push(Pi(e,{name:s,type:t.type.replace("*","")},r,n))}return c;case(0,Lr.isTypeNonZero)(a):return Pi(e,t,r,n);default:return ey(a,e)}}k0.default=XU});var Jx=K(L0=>{D();N();var YU=L0&&L0.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(L0,"__esModule",{value:!0});var Kn=ks(),Mt=YU(tf()),zx=R0(),$x=Mo(),ty=Fu(),ry=yr(),ZU=xi(),wn=Ir(),At=ys(),ny=(e,t)=>{if((0,Mt.default)((0,wn.isString)(e)||(0,wn.isNumber)(e)||(0,wn.isBigInt)(e),`Validate: arg ${t.name} should be a felt typed as (String, Number or BigInt)`),(0,wn.isString)(e)&&!(0,ry.isHex)(e))return;let r=BigInt(e.toString(10));(0,Mt.default)(r>=0n&&r<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`)},JU=(e,t)=>{(0,Mt.default)((0,wn.isString)(e),`Validate: arg ${t.name} should be a string.`),(0,Mt.default)(e.length<32,`Validate: arg ${t.name} cairo typed ${t.type} should be a string of less than 32 characters.`)},QU=(e,t)=>{(0,Mt.default)((0,wn.isString)(e),`Validate: arg ${t.name} should be a string.`)},Np=(e,t)=>{(0,wn.isNumber)(e)&&(0,Mt.default)(e<=Number.MAX_SAFE_INTEGER,"Validation: Parameter is too large to be typed as Number use (BigInt or String)"),(0,Mt.default)((0,wn.isString)(e)||(0,wn.isNumber)(e)||(0,wn.isBigInt)(e)||(0,wn.isObject)(e)&&"low"in e&&"high"in e||(0,wn.isObject)(e)&&["limb0","limb1","limb2","limb3"].every(n=>n in e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (String, Number or BigInt), but is ${typeof e} ${e}.`);let r;switch(t.type){case Kn.Uint.u256:r=new $x.CairoUint256(e).toBigInt();break;case Kn.Uint.u512:r=new ty.CairoUint512(e).toBigInt();break;default:r=(0,ry.toBigInt)(e)}switch(t.type){case Kn.Uint.u8:(0,Mt.default)(r>=0n&&r<=255n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0 - 255]`);break;case Kn.Uint.u16:(0,Mt.default)(r>=0n&&r<=65535n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 65535]`);break;case Kn.Uint.u32:(0,Mt.default)(r>=0n&&r<=4294967295n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 4294967295]`);break;case Kn.Uint.u64:(0,Mt.default)(r>=0n&&r<=2n**64n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^64-1]`);break;case Kn.Uint.u128:(0,Mt.default)(r>=0n&&r<=2n**128n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^128-1]`);break;case Kn.Uint.u256:(0,Mt.default)(r>=0n&&r<=2n**256n-1n,`Validate: arg ${t.name} is ${t.type} should be in range 0 - 2^256-1`);break;case Kn.Uint.u512:(0,Mt.default)(ty.CairoUint512.is(r),`Validate: arg ${t.name} is ${t.type} should be in range 0 - 2^512-1`);break;case Kn.Literal.ClassHash:(0,Mt.default)(r>=0n&&r<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`);break;case Kn.Literal.ContractAddress:(0,Mt.default)(r>=0n&&r<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`);break;case Kn.Literal.Secp256k1Point:{(0,Mt.default)(r>=0n&&r<=2n**512n-1n,`Validate: arg ${t.name} must be ${t.type} : a 512 bits number.`);break}case Kn.Literal.U96:{(0,Mt.default)(r>=0n&&r<=2n**96n-1n,`Validate: arg ${t.name} must be ${t.type} : a 96 bits number.`);break}default:break}},Gx=(e,t)=>{(0,Mt.default)((0,wn.isBoolean)(e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (Boolean)`)},Wx=(e,t,r)=>{if(t.type===Kn.Uint.u256||t.type===Kn.Uint.u512){Np(e,t);return}if((0,At.isTypeEthAddress)(t.type)){(0,Mt.default)(!(0,wn.isObject)(e),`EthAddress type is waiting a BigNumberish. Got "${e}"`);let n=BigInt(e.toString(10));(0,Mt.default)(n>=0n&&n<=2n**160n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^160-1]`);return}(0,Mt.default)((0,wn.isObject)(e),`Validate: arg ${t.name} is cairo type struct (${t.type}), and should be defined as a js object (not array)`),r[t.type].members.forEach(({name:n})=>{(0,Mt.default)(Object.keys(e).includes(n),`Validate: arg ${t.name} should have a property ${n}`)})},Xx=(e,t)=>{(0,Mt.default)((0,wn.isObject)(e),`Validate: arg ${t.name} is cairo type Enum (${t.type}), and should be defined as a js object (not array)`);let r=Object.getOwnPropertyNames(Object.getPrototypeOf(e)),n=[...Object.getOwnPropertyNames(e),...r];if(!((0,At.isTypeOption)(t.type)&&n.includes("isSome")&&n.includes("isNone"))&&!((0,At.isTypeResult)(t.type)&&n.includes("isOk")&&n.includes("isErr"))&&!(n.includes("variant")&&n.includes("activeVariant")))throw new Error(`Validate Enum: argument ${t.name}, type ${t.type}, value received "${e}", is not an Enum.`)},Yx=(e,t)=>{(0,Mt.default)((0,wn.isObject)(e),`Validate: arg ${t.name} should be a tuple (defined as object)`)},Zx=(e,t,r,n)=>{let i=(0,At.isTypeArray)(t.type),s=i?(0,At.getArrayType)(t.type):zx.CairoFixedArray.getFixedArrayType(t.type);if(i&&(0,At.isTypeFelt)(s)&&(0,ZU.isLongText)(e))return;let a=[];if(i)(0,Mt.default)(Array.isArray(e),`Validate: arg ${t.name} should be an Array`),a=e;else switch(!0){case Array.isArray(e):a=e;break;case typeof e=="object":a=Object.values(e);break;default:throw new Error(`Validate: arg ${t.name} should be an Array or an object.`)}switch(!0){case(0,At.isTypeFelt)(s):a.forEach(o=>ny(o,t));break;case(0,At.isTypeTuple)(s):a.forEach(o=>Yx(o,{name:t.name,type:s}));break;case(0,At.isTypeArray)(s):a.forEach(o=>Zx(o,{name:"",type:s},r,n));break;case(0,At.isTypeStruct)(s,r):a.forEach(o=>Wx(o,{name:t.name,type:s},r));break;case(0,At.isTypeEnum)(s,n):a.forEach(o=>Xx(o,{name:t.name,type:s}));break;case((0,At.isTypeUint)(s)||(0,At.isTypeLiteral)(s)):a.forEach(o=>Np(o,{name:"",type:s}));break;case(0,At.isTypeBool)(s):a.forEach(o=>Gx(o,t));break;default:throw new Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value ${a}`)}},ez=(e,t)=>{let r=(0,At.getArrayType)(t.type);switch((0,Mt.default)((0,At.isTypeUint)(r)&&r!==ty.CairoUint512.abiSelector||(0,At.isTypeFelt)(r),`Validate: ${t.name} type is not authorized for NonZero type.`),!0){case(0,At.isTypeFelt)(r):ny(e,t),(0,Mt.default)(BigInt(e.toString(10))>0,"Validate: value 0 is not authorized in NonZero felt252 type.");break;case(0,At.isTypeUint)(r):switch(Np(e,{name:"",type:r}),r){case Kn.Uint.u256:(0,Mt.default)(new $x.CairoUint256(e).toBigInt()>0,"Validate: value 0 is not authorized in NonZero uint256 type.");break;default:(0,Mt.default)((0,ry.toBigInt)(e)>0,"Validate: value 0 is not authorized in NonZero uint type.")}break;default:throw new Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value "${e}"`)}};function tz(e,t,r,n){e.inputs.reduce((i,s)=>{let a=t[i];switch(!0){case(0,At.isLen)(s.name):return i;case(0,At.isTypeFelt)(s.type):ny(a,s);break;case(0,At.isTypeBytes31)(s.type):JU(a,s);break;case((0,At.isTypeUint)(s.type)||(0,At.isTypeLiteral)(s.type)):Np(a,s);break;case(0,At.isTypeBool)(s.type):Gx(a,s);break;case(0,At.isTypeByteArray)(s.type):QU(a,s);break;case((0,At.isTypeArray)(s.type)||zx.CairoFixedArray.isTypeFixedArray(s.type)):Zx(a,s,r,n);break;case(0,At.isTypeStruct)(s.type,r):Wx(a,s,r);break;case(0,At.isTypeEnum)(s.type,n):Xx(a,s);break;case(0,At.isTypeTuple)(s.type):Yx(a,s);break;case(0,At.isTypeNonZero)(s.type):ez(a,s);break;default:throw new Error(`Validate Unhandled: argument ${s.name}, type ${s.type}, value ${a}`)}return i+1},0)}L0.default=tz});var sf=K(an=>{D();N();var rz=an&&an.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),nz=an&&an.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),tE=an&&an.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&rz(t,e,r);return nz(t,e),t},K0=an&&an.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(an,"__esModule",{value:!0});an.CallData=an.parseCalldataField=an.byteArray=an.cairo=void 0;var Rp=ks(),iz=K0(tf()),sz=yr(),az=Ir(),oz=gp(),cz=xi(),fz=Ru(),Vu=ys(),Fp=N0(),uz=K0(Ox()),iy=Fx(),dz=K0(Lx()),lz=Qv(),Qx=K0(Ux()),eE=K0(Jx());an.cairo=tE(ys());an.byteArray=tE(Ru());var hz=Qv();Object.defineProperty(an,"parseCalldataField",{enumerable:!0,get:function(){return hz.parseCalldataField}});var No=class{constructor(t){this.structs=No.getAbiStruct(t),this.enums=No.getAbiEnum(t),this.parser=(0,iy.createAbiParser)(t),this.abi=this.parser.getLegacyFormat()}validate(t,r,n=[]){if(t!==Rp.ValidateType.DEPLOY){let a=this.abi.filter(o=>{if(o.type!=="function")return!1;let c=o.stateMutability==="view"||o.state_mutability==="view";return t===Rp.ValidateType.INVOKE?!c:c}).map(o=>o.name);(0,iz.default)(a.includes(r),`${t===Rp.ValidateType.INVOKE?"invocable":"viewable"} method not found in abi`)}let i=this.abi.find(a=>t===Rp.ValidateType.DEPLOY?a.name===r&&a.type==="constructor":a.name===r&&a.type==="function");if((0,iy.isNoConstructorValid)(r,n,i))return;let s=this.parser.methodInputsLength(i);if(n.length!==s)throw Error(`Invalid number of arguments, expected ${s} arguments, but got ${n.length}`);(0,eE.default)(i,n,this.structs,this.enums)}compile(t,r){let n=this.abi.find(o=>o.name===t);if((0,iy.isNoConstructorValid)(t,r,n))return[];let i;if(Array.isArray(r))i=r;else{let o=(0,dz.default)(r,n.inputs,this.structs,this.enums);i=Object.values(o),(0,eE.default)(n,i,this.structs,this.enums)}let s=i[Symbol.iterator](),a=n.inputs.reduce((o,c)=>(0,Vu.isLen)(c.name)&&!(0,Vu.isCairo1Type)(c.type)?o:o.concat((0,lz.parseCalldataField)(s,c,this.structs,this.enums)),[]);return Object.defineProperty(a,"__compiled__",{enumerable:!1,writable:!1,value:!0}),a}static compile(t){let r=i=>{let s=(o,c=".")=>{let u=Array.isArray(o)?[o.length.toString(),...o]:o;return Object.entries(u).flatMap(([b,h])=>{let d=h;b==="entrypoint"?d=(0,oz.getSelectorFromName)(d):(0,cz.isLongText)(d)&&(d=(0,fz.byteArrayFromString)(d));let l=Array.isArray(u)&&b==="0"?"$$len":b;if((0,az.isBigInt)(d))return[[`${c}${l}`,(0,Vu.felt)(d)]];if(Object(d)===d){let y=Object.getOwnPropertyNames(Object.getPrototypeOf(d)),p=[...Object.getOwnPropertyNames(d),...y];if(p.includes("isSome")&&p.includes("isNone")){let m=d,w=m.isSome()?Fp.CairoOptionVariant.Some:Fp.CairoOptionVariant.None;return m.isSome()?s({0:w,1:m.unwrap()},`${c}${l}.`):[[`${c}${l}`,(0,Vu.felt)(w)]]}if(p.includes("isOk")&&p.includes("isErr")){let m=d,w=m.isOk()?Fp.CairoResultVariant.Ok:Fp.CairoResultVariant.Err;return s({0:w,1:m.unwrap()},`${c}${l}.`)}if(p.includes("variant")&&p.includes("activeVariant")){let m=d,w=m.activeVariant(),T=Object.keys(m.variant).findIndex(q=>q===w);return typeof m.unwrap()=="object"&&Object.keys(m.unwrap()).length===0?[[`${c}${l}`,(0,Vu.felt)(T)]]:s({0:T,1:m.unwrap()},`${c}${l}.`)}return s(d,`${c}${l}.`)}return[[`${c}${l}`,(0,Vu.felt)(d)]]})};return Object.fromEntries(s(i))},n;if(Array.isArray(t)){let i={...t},s=r(i);n=Object.values(s)}else{let i=r(t);n=Object.values(i)}return Object.defineProperty(n,"__compiled__",{enumerable:!1,writable:!1,value:!0}),n}parse(t,r){let{outputs:n}=this.abi.find(a=>a.name===t),i=r.flat()[Symbol.iterator](),s=n.flat().reduce((a,o,c)=>{let u=o.name??c;return a[u]=(0,Qx.default)(i,o,this.structs,this.enums,a),a[u]&&a[`${u}_len`]&&delete a[`${u}_len`],a},{});return Object.keys(s).length===1&&0 in s?s[0]:s}format(t,r,n){let i=this.parse(t,r);return(0,uz.default)(i,n)}static getAbiStruct(t){return t.filter(r=>r.type==="struct").reduce((r,n)=>({...r,[n.name]:n}),{})}static getAbiEnum(t){let r=t.filter(n=>n.type==="enum").reduce((n,i)=>({...n,[i.name]:i}),{});return delete r["core::bool"],r}static toCalldata(t=[]){return No.compile(t)}static toHex(t=[]){return No.compile(t).map(n=>(0,sz.toHex)(n))}decodeParameters(t,r){let n=Array.isArray(t)?t:[t],i=r.flat()[Symbol.iterator](),s=n.map(a=>(0,Qx.default)(i,{name:"",type:a},this.structs,this.enums));return s.length===1?s[0]:s}};an.CallData=No});var Us=K(qp=>{D();N();Object.defineProperty(qp,"__esModule",{value:!0});qp.starkCurve=void 0;var pz=da();qp.starkCurve=pz.signUtil.schnorr.stark});var ay=K(hi=>{D();N();Object.defineProperty(hi,"__esModule",{value:!0});hi.calculateL2MessageTxHash=hi.calculateTransactionHash=hi.calculateDeployAccountTransactionHash=hi.calculateDeclareTransactionHash=hi.calculateTransactionHashCommon=hi.computeHashOnElements=void 0;var Hp=kn(),bz=Us(),rE=yr(),gz=gp();function sy(e){return[...e,e.length].reduce((t,r)=>bz.starkCurve.pedersen((0,rE.toBigInt)(t),(0,rE.toBigInt)(r)),0).toString()}hi.computeHashOnElements=sy;function V0(e,t,r,n,i,s,a,o=[]){let c=sy(i),u=[e,t,r,n,c,s,a,...o];return sy(u)}hi.calculateTransactionHashCommon=V0;function vz(e,t,r,n,i,s,a){return V0(Hp.TransactionHashPrefix.DECLARE,r,t,0,[e],n,i,[s,...a?[a]:[]])}hi.calculateDeclareTransactionHash=vz;function yz(e,t,r,n,i,s,a,o){let c=[t,n,...r];return V0(Hp.TransactionHashPrefix.DEPLOY_ACCOUNT,i,e,0,c,s,a,[o])}hi.calculateDeployAccountTransactionHash=yz;function mz(e,t,r,n,i,s){return V0(Hp.TransactionHashPrefix.INVOKE,t,e,0,r,n,i,[s])}hi.calculateTransactionHash=mz;function wz(e,t,r,n,i,s){let a=[e,...n];return V0(Hp.TransactionHashPrefix.L1_HANDLER,0,t,(0,gz.getSelector)(r),a,0,i,[s])}hi.calculateL2MessageTxHash=wz});var oE=K(mr=>{D();N();Object.defineProperty(mr,"__esModule",{value:!0});mr.calculateInvokeTransactionHash=mr.calculateDeclareTransactionHash=mr.calculateDeployAccountTransactionHash=mr.calculateTransactionHashCommon=mr.hashFeeFieldV3B3=mr.hashFeeField=mr.encodeDataResourceBoundsL1=mr.encodeResourceBoundsL2=mr.encodeResourceBoundsL1=mr.hashDAMode=void 0;var _z=da(),Fo=_z.signUtil.schnorr.stark.poseidonHashMany,oy=kn(),Sz=yr(),cy=xi(),xz=ef(),Ro=e=>e.map(t=>BigInt(t)),Ez=32n,Az=64n,jp=128n,fy=Az+jp,Pz=BigInt((0,cy.encodeShortString)("L1_GAS")),Cz=BigInt((0,cy.encodeShortString)("L2_GAS")),Iz=BigInt((0,cy.encodeShortString)("L1_DATA"));function nE(e,t){return(BigInt(e)<<Ez)+BigInt(t)}mr.hashDAMode=nE;function uy(e){return(Pz<<fy)+(BigInt(e.l1_gas.max_amount)<<jp)+BigInt(e.l1_gas.max_price_per_unit)}mr.encodeResourceBoundsL1=uy;function dy(e){return(Cz<<fy)+(BigInt(e.l2_gas.max_amount)<<jp)+BigInt(e.l2_gas.max_price_per_unit)}mr.encodeResourceBoundsL2=dy;function iE(e){return(Iz<<fy)+(BigInt(e.l1_data_gas.max_amount)<<jp)+BigInt(e.l1_data_gas.max_price_per_unit)}mr.encodeDataResourceBoundsL1=iE;function sE(e,t){let r=uy(t),n=dy(t);return Fo([BigInt(e),r,n])}mr.hashFeeField=sE;function aE(e,t){let r=uy(t),n=dy(t),i=iE(t);return Fo([BigInt(e),r,n,i])}mr.hashFeeFieldV3B3=aE;function kp(e,t,r,n,i,s,a,o,c,u,b=[]){let h=(0,xz.isRPC08_ResourceBounds)(u)?aE(s,u):sE(s,u),d=nE(o,c),l=Ro([e,t,r,h,Fo(Ro(a)),n,i,d,...Ro(b)]);return(0,Sz.toHex)(Fo(l))}mr.calculateTransactionHashCommon=kp;function Bz(e,t,r,n,i,s,a,o,c,u,b,h){return kp(oy.TransactionHashPrefix.DEPLOY_ACCOUNT,i,e,s,a,b,h,o,c,u,[Fo(Ro(r)),t,n])}mr.calculateDeployAccountTransactionHash=Bz;function Mz(e,t,r,n,i,s,a,o,c,u,b,h){return kp(oy.TransactionHashPrefix.DECLARE,n,r,i,s,b,Ro(h),o,c,u,[Fo(Ro(a)),e,t])}mr.calculateDeclareTransactionHash=Mz;function Tz(e,t,r,n,i,s,a,o,c,u,b){return kp(oy.TransactionHashPrefix.INVOKE,t,e,n,i,u,b,a,o,c,[Fo(Ro(s)),Fo(Ro(r))])}mr.calculateInvokeTransactionHash=Tz});var cE=K(zs=>{D();N();Object.defineProperty(zs,"__esModule",{value:!0});zs.calculateDeployAccountTransactionHash=zs.calculateDeclareTransactionHash=zs.calculateInvokeTransactionHash=zs.calculateL2MessageTxHash=void 0;var Uu=lp(),ly=ay(),hy=oE(),Oz=ay();Object.defineProperty(zs,"calculateL2MessageTxHash",{enumerable:!0,get:function(){return Oz.calculateL2MessageTxHash}});function Dz(e){return[Uu.ETransactionVersion.V3,Uu.ETransactionVersion.F3].includes(e.version)}function Nz(e){return Dz(e)?(0,hy.calculateInvokeTransactionHash)(e.senderAddress,e.version,e.compiledCalldata,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):(0,ly.calculateTransactionHash)(e.senderAddress,e.version,e.compiledCalldata,e.maxFee,e.chainId,e.nonce)}zs.calculateInvokeTransactionHash=Nz;function Rz(e){return[Uu.ETransactionVersion.V3,Uu.ETransactionVersion.F3].includes(e.version)}function Fz(e){return Rz(e)?(0,hy.calculateDeclareTransactionHash)(e.classHash,e.compiledClassHash,e.senderAddress,e.version,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):(0,ly.calculateDeclareTransactionHash)(e.classHash,e.senderAddress,e.version,e.maxFee,e.chainId,e.nonce,e.compiledClassHash)}zs.calculateDeclareTransactionHash=Fz;function qz(e){return[Uu.ETransactionVersion.V3,Uu.ETransactionVersion.F3].includes(e.version)}function Hz(e){return qz(e)?(0,hy.calculateDeployAccountTransactionHash)(e.contractAddress,e.classHash,e.compiledConstructorCalldata,e.salt,e.version,e.chainId,e.nonce,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):(0,ly.calculateDeployAccountTransactionHash)(e.contractAddress,e.classHash,e.constructorCalldata,e.salt,e.version,e.maxFee,e.chainId,e.nonce)}zs.calculateDeployAccountTransactionHash=Hz});var U0=K(_n=>{D();N();Object.defineProperty(_n,"__esModule",{value:!0});_n.extractSignificantDigits=_n.toSafeNumberOrThrow=_n.getUnsafeNumberReason=_n.UnsafeNumberReason=_n.isSafeNumber=_n.isNumber=_n.isInteger=void 0;function by(e){return jz.test(e)}_n.isInteger=by;var jz=/^-?[0-9]+$/;function kz(e){return Lz.test(e)}_n.isNumber=kz;var Lz=/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/;function fE(e,t){let r=parseFloat(e),n=String(r),i=py(e),s=py(n);return!!(i===s||t?.approx===!0&&!by(e)&&s.length>=14&&i.startsWith(s.substring(0,14)))}_n.isSafeNumber=fE;var zu;(function(e){e.underflow="underflow",e.overflow="overflow",e.truncate_integer="truncate_integer",e.truncate_float="truncate_float"})(zu=_n.UnsafeNumberReason||(_n.UnsafeNumberReason={}));function uE(e){if(fE(e,{approx:!1}))return;if(by(e))return zu.truncate_integer;let t=parseFloat(e);return isFinite(t)?t===0?zu.underflow:zu.truncate_float:zu.overflow}_n.getUnsafeNumberReason=uE;function Kz(e,t){let r=parseFloat(e),n=uE(e);if(t?.approx===!0?n&&n!==zu.truncate_float:n){let i=n.replace(/_\w+$/,"");throw new Error(`Cannot safely convert to number: the value '${e}' would ${i} and become ${r}`)}return r}_n.toSafeNumberOrThrow=Kz;function py(e){return e.replace(Vz,"").replace(zz,"").replace($z,"").replace(Uz,"")}_n.extractSignificantDigits=py;var Vz=/[eE][+-]?\d+$/,Uz=/^-?(0*)?/,zz=/\./,$z=/0+$/});var Kp=K(qo=>{D();N();Object.defineProperty(qo,"__esModule",{value:!0});qo.toLosslessNumber=qo.isLosslessNumber=qo.LosslessNumber=void 0;var z0=U0(),Lp=class{constructor(t){if(this.isLosslessNumber=!0,!(0,z0.isNumber)(t))throw new Error('Invalid number (value: "'+t+'")');this.value=t}valueOf(){let t=(0,z0.getUnsafeNumberReason)(this.value);if(t===void 0||t===z0.UnsafeNumberReason.truncate_float)return parseFloat(this.value);if((0,z0.isInteger)(this.value))return BigInt(this.value);throw new Error(`Cannot safely convert to number: the value '${this.value}' would ${t} and become ${parseFloat(this.value)}`)}toString(){return this.value}};qo.LosslessNumber=Lp;function Gz(e){return e&&typeof e=="object"&&e.isLosslessNumber===!0||!1}qo.isLosslessNumber=Gz;function Wz(e){if((0,z0.extractSignificantDigits)(e+"").length>15)throw new Error(`Invalid number: contains more than 15 digits and is most likely truncated and unsafe by itself (value: ${e})`);if(isNaN(e))throw new Error("Invalid number: NaN");if(!isFinite(e))throw new Error("Invalid number: "+e);return new Lp(String(e))}qo.toLosslessNumber=Wz});var gy=K($u=>{D();N();Object.defineProperty($u,"__esModule",{value:!0});$u.parseNumberAndBigInt=$u.parseLosslessNumber=void 0;var Xz=Kp(),Yz=U0();function Zz(e){return new Xz.LosslessNumber(e)}$u.parseLosslessNumber=Zz;function Jz(e){return(0,Yz.isInteger)(e)?BigInt(e):parseFloat(e)}$u.parseNumberAndBigInt=Jz});var dE=K(Vp=>{D();N();Object.defineProperty(Vp,"__esModule",{value:!0});Vp.revive=void 0;var Qz=Kp();function e$(e,t){return vy({"":e},"",e,t)}Vp.revive=e$;function vy(e,t,r,n){return Array.isArray(r)?n.call(e,t,r$(r,n)):r&&typeof r=="object"&&!(0,Qz.isLosslessNumber)(r)?n.call(e,t,t$(r,n)):n.call(e,t,r)}function t$(e,t){return Object.keys(e).forEach(r=>{let n=vy(e,r,e[r],t);n!==void 0?e[r]=n:delete e[r]}),e}function r$(e,t){for(let r=0;r<e.length;r++)e[r]=vy(e,r+"",e[r],t);return e}});var vE=K(Vt=>{D();N();Object.defineProperty(Vt,"__esModule",{value:!0});Vt.codeLowercaseF=Vt.codeUppercaseF=Vt.codeLowercaseE=Vt.codeUppercaseE=Vt.codeLowercaseA=Vt.codeUppercaseA=Vt.isDeepEqual=Vt.isValidStringCharacter=Vt.parse=void 0;var n$=gy(),i$=dE();function s$(e,t,r=n$.parseLosslessNumber){let n=0,i=o();return y(i),m(),t?(0,i$.revive)(i,t):i;function s(){if(e.charCodeAt(n)===u$){n++,u();let x={},S=!0;for(;n<e.length&&e.charCodeAt(n)!==hE;){S?S=!1:(d(),u());let P=n,O=b();if(O===void 0)throw new SyntaxError(`Quoted object key expected ${E()}`);u(),l();let B=o();B===void 0&&R(),Object.prototype.hasOwnProperty.call(x,O)&&!$p(B,x[O])&&q(O,P+1),x[O]=B}return e.charCodeAt(n)!==hE&&F(),n++,x}}function a(){if(e.charCodeAt(n)===d$){n++,u();let x=[],S=!0;for(;n<e.length&&e.charCodeAt(n)!==pE;){S?S=!1:d();let P=o();p(P),x.push(P)}return e.charCodeAt(n)!==pE&&j(),n++,x}}function o(){u();let x=b()??h()??s()??a()??c("true",!0)??c("false",!1)??c("null",null);return u(),x}function c(x,S){if(e.slice(n,n+x.length)===x)return n+=x.length,S}function u(){for(;a$(e.charCodeAt(n));)n++}function b(){if(e.charCodeAt(n)===yy){n++;let x="";for(;n<e.length&&e.charCodeAt(n)!==yy;){if(e.charCodeAt(n)===f$){let S=e[n+1],P=c$[S];P!==void 0?(x+=P,n++):S==="u"?Up(e.charCodeAt(n+2))&&Up(e.charCodeAt(n+3))&&Up(e.charCodeAt(n+4))&&Up(e.charCodeAt(n+5))?(x+=String.fromCharCode(parseInt(e.slice(n+2,n+6),16)),n+=5):A(n):I(n)}else gE(e.charCodeAt(n))?x+=e[n]:k(e[n]);n++}return C(),n++,x}}function h(){let x=n;if(e.charCodeAt(n)===bE&&(n++,w(x)),e.charCodeAt(n)===my)n++;else if(o$(e.charCodeAt(n)))for(n++;zp(e.charCodeAt(n));)n++;if(e.charCodeAt(n)===m$)for(n++,w(x);zp(e.charCodeAt(n));)n++;if(e.charCodeAt(n)===Vt.codeLowercaseE||e.charCodeAt(n)===Vt.codeUppercaseE)for(n++,(e.charCodeAt(n)===bE||e.charCodeAt(n)===g$)&&n++,w(x);zp(e.charCodeAt(n));)n++;if(n>x)return r(e.slice(x,n))}function d(){if(e.charCodeAt(n)!==y$)throw new SyntaxError(`Comma ',' expected after value ${E()}`);n++}function l(){if(e.charCodeAt(n)!==w$)throw new SyntaxError(`Colon ':' expected after property name ${E()}`);n++}function y(x){if(x===void 0)throw new SyntaxError(`JSON value expected ${E()}`)}function p(x){if(x===void 0)throw new SyntaxError(`Array item expected ${E()}`)}function m(){if(n<e.length)throw new SyntaxError(`Expected end of input ${E()}`)}function w(x){if(!zp(e.charCodeAt(n))){let S=e.slice(x,n);throw new SyntaxError(`Invalid number '${S}', expecting a digit ${E()}`)}}function C(){if(e.charCodeAt(n)!==yy)throw new SyntaxError(`End of string '"' expected ${E()}`)}function T(){throw new SyntaxError(`Quoted object key expected ${E()}`)}function q(x,S){throw new SyntaxError(`Duplicate key '${x}' encountered at position ${S}`)}function F(){throw new SyntaxError(`Quoted object key or end of object '}' expected ${E()}`)}function j(){throw new SyntaxError(`Array item or end of array ']' expected ${E()}`)}function k(x){throw new SyntaxError(`Invalid character '${x}' ${f()}`)}function I(x){let S=e.slice(x,x+2);throw new SyntaxError(`Invalid escape character '${S}' ${f()}`)}function R(){throw new SyntaxError(`Object value expected after ':' ${f()}`)}function A(x){let S=x+2;for(;/\w/.test(e[S]);)S++;let P=e.slice(x,S);throw new SyntaxError(`Invalid unicode character '${P}' ${f()}`)}function f(){return`at position ${n}`}function g(){return n<e.length?`but got '${e[n]}'`:"but reached end of input"}function E(){return g()+" "+f()}}Vt.parse=s$;function a$(e){return e===l$||e===h$||e===p$||e===b$}function Up(e){return e>=my&&e<=wy||e>=Vt.codeUppercaseA&&e<=Vt.codeUppercaseF||e>=Vt.codeLowercaseA&&e<=Vt.codeLowercaseF}function zp(e){return e>=my&&e<=wy}function o$(e){return e>=v$&&e<=wy}function gE(e){return e>=32&&e<=1114111}Vt.isValidStringCharacter=gE;function $p(e,t){return e===t?!0:Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every((r,n)=>$p(r,t[n])):lE(e)&&lE(t)?[...new Set([...Object.keys(e),...Object.keys(t)])].every(n=>$p(e[n],t[n])):!1}Vt.isDeepEqual=$p;function lE(e){return typeof e=="object"&&e!==null}var c$={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},f$=92,u$=123,hE=125,d$=91,pE=93,l$=32,h$=10,p$=9,b$=13,yy=34,g$=43,bE=45,my=48,v$=49,wy=57,y$=44,m$=46,w$=58;Vt.codeUppercaseA=65;Vt.codeLowercaseA=97;Vt.codeUppercaseE=69;Vt.codeLowercaseE=101;Vt.codeUppercaseF=70;Vt.codeLowercaseF=102});var mE=K(Gp=>{D();N();Object.defineProperty(Gp,"__esModule",{value:!0});Gp.stringify=void 0;var _$=U0();function yE(e,t,r,n){let i=S$(r),s=typeof t=="function"?t.call({"":e},"",e):e;return a(s,"");function a(b,h){if(Array.isArray(n)){let d=n.find(l=>l.test(b));if(d){let l=d.stringify(b);if(typeof l!="string"||!(0,_$.isNumber)(l))throw new Error(`Invalid JSON number: output of a number stringifier must be a string containing a JSON number (output: ${l})`);return l}}if(typeof b=="boolean"||typeof b=="number"||typeof b=="string"||b===null||b instanceof Date||b instanceof Boolean||b instanceof Number||b instanceof String)return JSON.stringify(b);if(b&&b.isLosslessNumber||typeof b=="bigint")return b.toString();if(Array.isArray(b))return o(b,h);if(b&&typeof b=="object")return c(b,h)}function o(b,h){if(b.length===0)return"[]";let d=i?h+i:void 0,l=i?`[
`:"[";for(let y=0;y<b.length;y++){let p=typeof t=="function"?t.call(b,String(y),b[y]):b[y];i&&(l+=d),typeof p<"u"&&typeof p!="function"?l+=a(p,d):l+="null",y<b.length-1&&(l+=i?`,
`:",")}return l+=i?`
`+h+"]":"]",l}function c(b,h){if(typeof b.toJSON=="function")return yE(b.toJSON(),t,r,void 0);let d=Array.isArray(t)?t.map(String):Object.keys(b);if(d.length===0)return"{}";let l=i?h+i:void 0,y=!0,p=i?`{
`:"{";return d.forEach(m=>{let w=typeof t=="function"?t.call(b,m,b[m]):b[m];if(u(m,w)){y?y=!1:p+=i?`,
`:",";let C=JSON.stringify(m);p+=i?l+C+": ":C+":",p+=a(w,l)}}),p+=i?`
`+h+"}":"}",p}function u(b,h){return typeof h<"u"&&typeof h!="function"&&typeof h!="symbol"}}Gp.stringify=yE;function S$(e){if(typeof e=="number")return" ".repeat(e);if(typeof e=="string"&&e!=="")return e}});var _E=K(wE=>{D();N();Object.defineProperty(wE,"__esModule",{value:!0})});var xE=K(vt=>{D();N();var x$=vt&&vt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),E$=vt&&vt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&x$(t,e,r)};Object.defineProperty(vt,"__esModule",{value:!0});vt.getUnsafeNumberReason=vt.toSafeNumberOrThrow=vt.isSafeNumber=vt.isNumber=vt.isInteger=vt.UnsafeNumberReason=vt.parseNumberAndBigInt=vt.parseLosslessNumber=vt.toLosslessNumber=vt.isLosslessNumber=vt.LosslessNumber=vt.stringify=vt.parse=void 0;var A$=vE();Object.defineProperty(vt,"parse",{enumerable:!0,get:function(){return A$.parse}});var P$=mE();Object.defineProperty(vt,"stringify",{enumerable:!0,get:function(){return P$.stringify}});var _y=Kp();Object.defineProperty(vt,"LosslessNumber",{enumerable:!0,get:function(){return _y.LosslessNumber}});Object.defineProperty(vt,"isLosslessNumber",{enumerable:!0,get:function(){return _y.isLosslessNumber}});Object.defineProperty(vt,"toLosslessNumber",{enumerable:!0,get:function(){return _y.toLosslessNumber}});var SE=gy();Object.defineProperty(vt,"parseLosslessNumber",{enumerable:!0,get:function(){return SE.parseLosslessNumber}});Object.defineProperty(vt,"parseNumberAndBigInt",{enumerable:!0,get:function(){return SE.parseNumberAndBigInt}});var Gu=U0();Object.defineProperty(vt,"UnsafeNumberReason",{enumerable:!0,get:function(){return Gu.UnsafeNumberReason}});Object.defineProperty(vt,"isInteger",{enumerable:!0,get:function(){return Gu.isInteger}});Object.defineProperty(vt,"isNumber",{enumerable:!0,get:function(){return Gu.isNumber}});Object.defineProperty(vt,"isSafeNumber",{enumerable:!0,get:function(){return Gu.isSafeNumber}});Object.defineProperty(vt,"toSafeNumberOrThrow",{enumerable:!0,get:function(){return Gu.toSafeNumberOrThrow}});Object.defineProperty(vt,"getUnsafeNumberReason",{enumerable:!0,get:function(){return Gu.getUnsafeNumberReason}});E$(_E(),vt)});var af=K(pi=>{D();N();var C$=pi&&pi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),I$=pi&&pi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),B$=pi&&pi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&C$(t,e,r);return I$(t,e),t};Object.defineProperty(pi,"__esModule",{value:!0});pi.stringify=pi.parseAlwaysAsBig=pi.parse=void 0;var $0=B$(xE()),M$=e=>{if(!$0.isInteger(e))return parseFloat(e);let t=parseInt(e,10);return Number.isSafeInteger(t)?t:BigInt(e)},T$=e=>$0.parse(String(e),void 0,M$);pi.parse=T$;var O$=e=>$0.parse(String(e),void 0,$0.parseNumberAndBigInt);pi.parseAlwaysAsBig=O$;var D$=(e,t,r,n)=>$0.stringify(e,t,r,n);pi.stringify=D$});var ME=K(Ft=>{D();N();Object.defineProperty(Ft,"__esModule",{value:!0});Ft.computeContractClassHash=Ft.computeSierraContractClassHash=Ft.computeCompiledClassHash=Ft.hashByteCodeSegments=Ft.computeLegacyContractClassHash=Ft.computeHintedClassHash=Ft.formatSpaces=Ft.calculateContractAddressFromHash=Ft.computePoseidonHashOnElements=Ft.computePedersenHashOnElements=Ft.computeHashOnElements=Ft.computePoseidonHash=Ft.computePedersenHash=void 0;var N$=da(),Gs=N$.signUtil.schnorr.stark.poseidonHashMany,EE=kn(),R$=sf(),F$=ys(),G0=Us(),Wp=jn(),Xp=af(),Wu=yr(),Yp=xi(),AE=Ir();function q$(e,t){return G0.starkCurve.pedersen(BigInt(e),BigInt(t))}Ft.computePedersenHash=q$;function H$(e,t){return(0,Wu.toHex)(G0.starkCurve.poseidonHash(BigInt(e),BigInt(t)))}Ft.computePoseidonHash=H$;function $s(e){return[...e,e.length].reduce((t,r)=>G0.starkCurve.pedersen(BigInt(t),BigInt(r)),0).toString()}Ft.computeHashOnElements=$s;Ft.computePedersenHashOnElements=$s;function j$(e){return(0,Wu.toHex)(Gs(e.map(t=>BigInt(t))))}Ft.computePoseidonHashOnElements=j$;function k$(e,t,r,n){let i=R$.CallData.compile(r),s=$s(i),a=(0,F$.felt)("0x535441524b4e45545f434f4e54524143545f41444452455353"),o=$s([a,n,e,t,s]);return(0,Wu.toHex)(BigInt(o)%EE.ADDR_BOUND)}Ft.calculateContractAddressFromHash=k$;function L$(e,t){return e==="attributes"||e==="accessible_scopes"?Array.isArray(t)&&t.length===0?void 0:t:e==="debug_info"?null:t===null?void 0:t}function Ey(e){let t=!1,r=[];for(let n of e)n==='"'&&!(r.length>0&&r.slice(-1)[0]==="\\")&&(t=!t),t?r.push(n):r.push(n===":"?": ":n===","?", ":n);return r.join("")}Ft.formatSpaces=Ey;function PE(e){let{abi:t,program:r}=e,n={abi:t,program:r},i=Ey((0,Xp.stringify)(n,L$));return(0,Wp.addHexPrefix)(G0.starkCurve.keccak((0,Wp.utf8ToArray)(i)).toString(16))}Ft.computeHintedClassHash=PE;function CE(e){let t=(0,AE.isString)(e)?(0,Xp.parse)(e):e,r=(0,Wu.toHex)(EE.API_VERSION),n=$s(t.entry_points_by_type.EXTERNAL.flatMap(u=>[u.selector,u.offset])),i=$s(t.entry_points_by_type.L1_HANDLER.flatMap(u=>[u.selector,u.offset])),s=$s(t.entry_points_by_type.CONSTRUCTOR.flatMap(u=>[u.selector,u.offset])),a=$s(t.program.builtins.map(u=>(0,Yp.encodeShortString)(u))),o=PE(t),c=$s(t.program.data);return $s([r,n,i,s,a,o,c])}Ft.computeLegacyContractClassHash=CE;function K$(e){return Gs(e.flatMap(t=>BigInt((0,Yp.encodeShortString)(t))))}function Sy(e){let t=e.flatMap(r=>[BigInt(r.selector),BigInt(r.offset),K$(r.builtins)]);return Gs(t)}function IE(e){let t=e.bytecode.map(s=>BigInt(s)),r=e.bytecode_segment_lengths??[],n=0,i=r.flatMap(s=>{let a=t.slice(n,n+=s);return[BigInt(s),Gs(a)]});return 1n+Gs(i)}Ft.hashByteCodeSegments=IE;function V$(e){let t="COMPILED_CLASS_V1",r=BigInt((0,Yp.encodeShortString)(t)),n=Sy(e.entry_points_by_type.EXTERNAL),i=Sy(e.entry_points_by_type.L1_HANDLER),s=Sy(e.entry_points_by_type.CONSTRUCTOR),a=e.bytecode_segment_lengths?IE(e):Gs(e.bytecode.map(o=>BigInt(o)));return(0,Wu.toHex)(Gs([r,n,i,s,a]))}Ft.computeCompiledClassHash=V$;function xy(e){let t=e.flatMap(r=>[BigInt(r.selector),BigInt(r.function_idx)]);return Gs(t)}function U$(e){let t=Ey((0,Xp.stringify)(e.abi,null));return BigInt((0,Wp.addHexPrefix)(G0.starkCurve.keccak((0,Wp.utf8ToArray)(t)).toString(16)))}function BE(e){let t="CONTRACT_CLASS_V0.1.0",r=BigInt((0,Yp.encodeShortString)(t)),n=xy(e.entry_points_by_type.EXTERNAL),i=xy(e.entry_points_by_type.L1_HANDLER),s=xy(e.entry_points_by_type.CONSTRUCTOR),a=U$(e),o=Gs(e.sierra_program.map(c=>BigInt(c)));return(0,Wu.toHex)(Gs([r,n,i,s,a,o]))}Ft.computeSierraContractClassHash=BE;function z$(e){let t=(0,AE.isString)(e)?(0,Xp.parse)(e):e;return"sierra_program"in t?BE(t):CE(t)}Ft.computeContractClassHash=z$});var Wi=K(Na=>{D();N();var $$=Na&&Na.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ay=Na&&Na.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&$$(t,e,r)};Object.defineProperty(Na,"__esModule",{value:!0});Ay(gp(),Na);Ay(cE(),Na);Ay(ME(),Na)});var Jp=K(Zp=>{D();N();Object.defineProperty(Zp,"__esModule",{value:!0});Zp.config=void 0;var G$=kn(),Ho=class{constructor(){this.initialize()}initialize(){this.config={...G$.DEFAULT_GLOBAL_CONFIG}}static getInstance(){return Ho.instance||(Ho.instance=new Ho),Ho.instance}get(t,r){return this.config[t]??r}set(t,r){this.config[t]=r}update(t){this.config={...this.config,...t}}getAll(){return{...this.config}}reset(){this.initialize()}delete(t){delete this.config[t]}hasKey(t){return t in this.config}};Zp.config=Ho.getInstance()});var TE=K(Qp=>{D();N();Object.defineProperty(Qp,"__esModule",{value:!0});Qp.estimateFeeToBounds=void 0;var Xi=yr();function W$(e,t){return{l2_gas:{max_amount:(0,Xi.toHex)((0,Xi.addPercent)(e.l2_gas_consumed,t.l2_gas.max_amount)),max_price_per_unit:(0,Xi.toHex)((0,Xi.addPercent)(e.l2_gas_price,t.l2_gas.max_price_per_unit))},l1_gas:{max_amount:(0,Xi.toHex)((0,Xi.addPercent)(e.l1_gas_consumed,t.l1_gas.max_amount)),max_price_per_unit:(0,Xi.toHex)((0,Xi.addPercent)(e.l1_gas_price,t.l1_gas.max_price_per_unit))},l1_data_gas:{max_amount:(0,Xi.toHex)((0,Xi.addPercent)(e.l1_data_gas_consumed,t.l1_data_gas.max_amount)),max_price_per_unit:(0,Xi.toHex)((0,Xi.addPercent)(e.l1_data_gas_price,t.l1_data_gas.max_price_per_unit))}}}Qp.estimateFeeToBounds=W$});var jo=K(wt=>{D();N();Object.defineProperty(wt,"__esModule",{value:!0});wt.getFullPublicKey=wt.reduceV2=wt.v3Details=wt.toFeeVersion=wt.toTransactionVersion=wt.intDAM=wt.ZEROFee=wt.estimateFeeToBounds=wt.estimatedFeeToMaxFee=wt.signatureToHexArray=wt.signatureToDecimalArray=wt.formatSignature=wt.randomAddress=wt.decompressProgram=wt.compressProgram=void 0;var Py=da(),OE=JA(),DE=Jp(),e2=kn(),Mr=ef(),W0=jn(),NE=af(),Ws=yr(),RE=Ir(),X$=TE();function Y$(e){let t=(0,RE.isString)(e)?e:(0,NE.stringify)(e),r=(0,OE.gzip)(t);return(0,W0.btoaUniversal)(r)}wt.compressProgram=Y$;function Z$(e){if(Array.isArray(e))return e;let t=(0,W0.arrayBufferToString)((0,OE.ungzip)((0,W0.atobUniversal)(e)));return(0,NE.parse)(t)}wt.decompressProgram=Z$;function J$(){let e=Py.signUtil.schnorr.stark.utils.randomPrivateKey();return Py.signUtil.schnorr.stark.getStarkKey(e)}wt.randomAddress=J$;function Cy(e){if(!e)throw Error("formatSignature: provided signature is undefined");if(Array.isArray(e))return e.map(t=>(0,Ws.toHex)(t));try{let{r:t,s:r}=e;return[(0,Ws.toHex)(t),(0,Ws.toHex)(r)]}catch{throw new Error("Signature need to be weierstrass.SignatureType or an array for custom")}}wt.formatSignature=Cy;function Q$(e){return(0,Ws.bigNumberishArrayToDecimalStringArray)(Cy(e))}wt.signatureToDecimalArray=Q$;function eG(e){return(0,Ws.bigNumberishArrayToHexadecimalStringArray)(Cy(e))}wt.signatureToHexArray=eG;function tG(e,t=DE.config.get("feeMarginPercentage").maxFee){return(0,Ws.addPercent)(e,t)}wt.estimatedFeeToMaxFee=tG;function Iy(e,t=DE.config.get("feeMarginPercentage").bounds,r){return(0,RE.isBigInt)(e)?{l2_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_data_gas:{max_amount:"0x0",max_price_per_unit:"0x0"}}:(0,X$.estimateFeeToBounds)(e,t)}wt.estimateFeeToBounds=Iy;function rG(e){return{l1_gas_consumed:0n,l1_gas_price:0n,l1_data_gas_consumed:0n,l1_data_gas_price:0n,l2_gas_consumed:0n,l2_gas_price:0n,overall_fee:e2.ZERO,unit:"FRI",suggestedMaxFee:e2.ZERO,resourceBounds:Iy(e2.ZERO,void 0,e)}}wt.ZEROFee=rG;function nG(e){if(e===Mr.EDataAvailabilityMode.L1)return Mr.EDAMode.L1;if(e===Mr.EDataAvailabilityMode.L2)return Mr.EDAMode.L2;throw Error("EDAM conversion")}wt.intDAM=nG;function iG(e,t){let r=t?(0,Ws.toHex)(t):void 0,n=(0,Ws.toHex)(e);if(t&&!Object.values(Mr.ETransactionVersion).includes(r))throw Error(`providedVersion ${t} is not ETransactionVersion`);if(!Object.values(Mr.ETransactionVersion).includes(n))throw Error(`defaultVersion ${e} is not ETransactionVersion`);return t?r:n}wt.toTransactionVersion=iG;function sG(e){if(!e)return;let t=(0,Ws.toHex)(e);if(t===Mr.ETransactionVersion.V0)return Mr.ETransactionVersion.F0;if(t===Mr.ETransactionVersion.V1)return Mr.ETransactionVersion.F1;if(t===Mr.ETransactionVersion.V2)return Mr.ETransactionVersion.F2;if(t===Mr.ETransactionVersion.V3)return Mr.ETransactionVersion.F3;throw Error(`toFeeVersion: ${t} is not supported`)}wt.toFeeVersion=sG;function aG(e,t){return{tip:e.tip||0,paymasterData:e.paymasterData||[],accountDeploymentData:e.accountDeploymentData||[],nonceDataAvailabilityMode:e.nonceDataAvailabilityMode||Mr.EDataAvailabilityMode.L1,feeDataAvailabilityMode:e.feeDataAvailabilityMode||Mr.EDataAvailabilityMode.L1,resourceBounds:e.resourceBounds??Iy(e2.ZERO,void 0,t)}}wt.v3Details=aG;function oG(e){return e===Mr.ETransactionVersion.F2?Mr.ETransactionVersion.F1:e===Mr.ETransactionVersion.V2?Mr.ETransactionVersion.V1:e}wt.reduceV2=oG;function cG(e){let t=(0,Ws.toHex)(e);return(0,W0.addHexPrefix)((0,W0.buf2hex)(Py.signUtil.schnorr.stark.getPublicKey(t,!1)))}wt.getFullPublicKey=cG});var t2=K(Sn=>{D();N();Object.defineProperty(Sn,"__esModule",{value:!0});Sn.getVersionsByType=Sn.buildUDCCall=Sn.getExecuteCalldata=Sn.fromCallsToExecuteCalldata_cairo1=Sn.fromCallsToExecuteCalldata=Sn.transformCallsToMulticallArrays=void 0;var By=kn(),Xu=ef(),Yu=sf(),fG=Us(),FE=Wi(),My=yr(),uG=jo(),dG=e=>{let t=[],r=[];return e.forEach(n=>{let i=Yu.CallData.compile(n.calldata||[]);t.push({to:(0,My.toBigInt)(n.contractAddress).toString(10),selector:(0,My.toBigInt)((0,FE.getSelectorFromName)(n.entrypoint)).toString(10),data_offset:r.length.toString(),data_len:i.length.toString()}),r.push(...i)}),{callArray:t,calldata:Yu.CallData.compile({calldata:r})}};Sn.transformCallsToMulticallArrays=dG;var lG=e=>{let{callArray:t,calldata:r}=(0,Sn.transformCallsToMulticallArrays)(e);return[...Yu.CallData.compile({callArray:t}),...r]};Sn.fromCallsToExecuteCalldata=lG;var hG=e=>{let t=e.map(r=>({contractAddress:r.contractAddress,entrypoint:r.entrypoint,calldata:Array.isArray(r.calldata)&&"__compiled__"in r.calldata?r.calldata:Yu.CallData.compile(r.calldata)}));return Yu.CallData.compile({orderCalls:t})};Sn.fromCallsToExecuteCalldata_cairo1=hG;var pG=(e,t="0")=>t==="1"?(0,Sn.fromCallsToExecuteCalldata_cairo1)(e):(0,Sn.fromCallsToExecuteCalldata)(e);Sn.getExecuteCalldata=pG;function bG(e,t){let r=[].concat(e).map(n=>{let{classHash:i,salt:s,unique:a=!0,constructorCalldata:o=[]}=n,c=Yu.CallData.compile(o),u=s??(0,uG.randomAddress)();return{call:{contractAddress:By.UDC.ADDRESS,entrypoint:By.UDC.ENTRYPOINT,calldata:[i,u,(0,My.toCairoBool)(a),c.length,...c]},address:(0,FE.calculateContractAddressFromHash)(a?fG.starkCurve.pedersen(t,u):u,i,c,a?By.UDC.ADDRESS:0)}});return{calls:r.map(n=>n.call),addresses:r.map(n=>n.address)}}Sn.buildUDCCall=bG;function gG(e){return e==="fee"?{v1:Xu.ETransactionVersion.F1,v2:Xu.ETransactionVersion.F2,v3:Xu.ETransactionVersion.F3}:{v1:Xu.ETransactionVersion.V1,v2:Xu.ETransactionVersion.V2,v3:Xu.ETransactionVersion.V3}}Sn.getVersionsByType=gG});var Oy=K(Zu=>{D();N();Object.defineProperty(Zu,"__esModule",{value:!0});Zu.proofMerklePath=Zu.MerkleTree=void 0;var Ty=Wi(),ko=class{constructor(t,r=Ty.computePedersenHash){this.branches=[],this.hashMethod=r,this.leaves=t,this.root=this.build(t)}build(t){if(t.length===1)return t[0];t.length!==this.leaves.length&&this.branches.push(t);let r=[];for(let n=0;n<t.length;n+=2)n+1===t.length?r.push(ko.hash(t[n],"0x0",this.hashMethod)):r.push(ko.hash(t[n],t[n+1],this.hashMethod));return this.build(r)}static hash(t,r,n=Ty.computePedersenHash){let[i,s]=[BigInt(t),BigInt(r)].sort((a,o)=>a>=o?1:-1);return n(i,s)}getProof(t,r=this.leaves,n=[]){let i=r.indexOf(t);if(i===-1)throw new Error("leaf not found");if(r.length===1)return n;let s=i%2===0,a=(s?r[i+1]:r[i-1])??"0x0",o=[...n,a],c=this.leaves.length===r.length?-1:this.branches.findIndex(b=>b.length===r.length),u=this.branches[c+1]??[this.root];return this.getProof(ko.hash(s?t:a,s?a:t,this.hashMethod),u,o)}};Zu.MerkleTree=ko;function qE(e,t,r,n=Ty.computePedersenHash){if(r.length===0)return e===t;let[i,...s]=r;return qE(e,ko.hash(t,i,n),s,n)}Zu.proofMerklePath=qE});var n2=K(Ut=>{D();N();var vG=Ut&&Ut.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.verifyMessage=Ut.getMessageHash=Ut.getStructHash=Ut.encodeData=Ut.encodeValue=Ut.getTypeHash=Ut.encodeType=Ut.getDependencies=Ut.isMerkleTreeType=Ut.prepareSelector=Ut.validateTypedData=void 0;var X0=kn(),zt=ks(),jE=vG(tf()),yG=Ru(),HE=Us(),Ju=Wi(),mG=Oy(),of=yr(),kE=xi(),LE=Ir(),wG={u256:JSON.parse('[{ "name": "low", "type": "u128" }, { "name": "high", "type": "u128" }]'),TokenAmount:JSON.parse('[{ "name": "token_address", "type": "ContractAddress" }, { "name": "amount", "type": "u256" }]'),NftId:JSON.parse('[{ "name": "collection_address", "type": "ContractAddress" }, { "name": "token_id", "type": "u256" }]')},Ci={[zt.TypedDataRevision.ACTIVE]:{domain:"StarknetDomain",hashMethod:Ju.computePoseidonHashOnElements,hashMerkleMethod:Ju.computePoseidonHash,escapeTypeString:e=>`"${e}"`,presetTypes:wG},[zt.TypedDataRevision.LEGACY]:{domain:"StarkNetDomain",hashMethod:Ju.computePedersenHashOnElements,hashMerkleMethod:Ju.computePedersenHash,escapeTypeString:e=>e,presetTypes:{}}};function r2(e,t,{min:r,max:n}){let i=BigInt(e);(0,jE.default)(i>=r&&i<=n,`${i} (${t}) is out of bounds [${r}, ${n}]`)}function KE({types:e,domain:t}){if(Ci[zt.TypedDataRevision.ACTIVE].domain in e&&t.revision===zt.TypedDataRevision.ACTIVE)return zt.TypedDataRevision.ACTIVE;if(Ci[zt.TypedDataRevision.LEGACY].domain in e&&(t.revision??zt.TypedDataRevision.LEGACY)===zt.TypedDataRevision.LEGACY)return zt.TypedDataRevision.LEGACY}function Xs(e){try{return(0,of.toHex)(e)}catch{if((0,LE.isString)(e))return(0,of.toHex)((0,kE.encodeShortString)(e));throw new Error(`Invalid BigNumberish: ${e}`)}}function Dy(e){let t=e;return Boolean(t.message&&t.primaryType&&t.types&&KE(t))}Ut.validateTypedData=Dy;function VE(e){return(0,of.isHex)(e)?e:(0,Ju.getSelectorFromName)(e)}Ut.prepareSelector=VE;function UE(e){return e.type==="merkletree"}Ut.isMerkleTreeType=UE;function Ny(e,t,r=[],n="",i=zt.TypedDataRevision.LEGACY){let s=[t];return t[t.length-1]==="*"?s=[t.slice(0,-1)]:i===zt.TypedDataRevision.ACTIVE&&(t==="enum"?s=[n]:t.match(/^\(.*\)$/)&&(s=t.slice(1,-1).split(",").map(a=>a[a.length-1]==="*"?a.slice(0,-1):a))),s.filter(a=>!r.includes(a)&&e[a]).reduce((a,o)=>[...a,...[o,...e[o].reduce((c,u)=>[...c,...Ny(e,u.type,c,u.contains,i).filter(b=>!c.includes(b))],[])].filter(c=>!a.includes(c))],[])}Ut.getDependencies=Ny;function _G(e,t){if(t.parent&&t.key){let n=e[t.parent].find(s=>s.name===t.key);if(!UE(n))throw new Error(`${t.key} is not a merkle tree`);if(n.contains.endsWith("*"))throw new Error(`Merkle tree contain property must not be an array but was given ${t.key}`);return n.contains}return"raw"}function zE(e,t,r=zt.TypedDataRevision.LEGACY){let n=r===zt.TypedDataRevision.ACTIVE?{...e,...Ci[r].presetTypes}:e,[i,...s]=Ny(n,t,void 0,void 0,r),a=i?[i,...s.sort()]:[],o=Ci[r].escapeTypeString;return a.map(c=>{let u=n[c].map(b=>{let h=b.type==="enum"&&r===zt.TypedDataRevision.ACTIVE?b.contains:b.type,d=h.match(/^\(.*\)$/)?`(${h.slice(1,-1).split(",").map(l=>l&&o(l)).join(",")})`:o(h);return`${o(b.name)}:${d}`});return`${o(c)}(${u})`}).join("")}Ut.encodeType=zE;function $E(e,t,r=zt.TypedDataRevision.LEGACY){return(0,Ju.getSelectorFromName)(zE(e,t,r))}Ut.getTypeHash=$E;function Y0(e,t,r,n={},i=zt.TypedDataRevision.LEGACY){if(e[t])return[t,Z0(e,t,r,i)];if(Ci[i].presetTypes[t])return[t,Z0(Ci[i].presetTypes,t,r,i)];if(t.endsWith("*")){let s=r.map(a=>Y0(e,t.slice(0,-1),a,void 0,i)[1]);return[t,Ci[i].hashMethod(s)]}switch(t){case"enum":{if(i===zt.TypedDataRevision.ACTIVE){let[s,a]=Object.entries(r)[0],o=e[n.parent].find(d=>d.name===n.key),c=e[o.contains],u=c.find(d=>d.name===s),b=c.indexOf(u),h=u.type.slice(1,-1).split(",").map((d,l)=>{if(!d)return d;let y=a[l];return Y0(e,d,y,void 0,i)[1]});return[t,Ci[i].hashMethod([b,...h])]}return[t,Xs(r)]}case"merkletree":{let s=_G(e,n),a=r.map(c=>Y0(e,s,c,void 0,i)[1]),{root:o}=new mG.MerkleTree(a,Ci[i].hashMerkleMethod);return["felt",o]}case"selector":return["felt",VE(r)];case"string":{if(i===zt.TypedDataRevision.ACTIVE){let s=(0,yG.byteArrayFromString)(r),a=[s.data.length,...s.data,s.pending_word,s.pending_word_len];return[t,Ci[i].hashMethod(a)]}return[t,Xs(r)]}case"i128":{if(i===zt.TypedDataRevision.ACTIVE){let s=BigInt(r);return r2(s,t,X0.RANGE_I128),[t,Xs(s<0n?X0.PRIME+s:s)]}return[t,Xs(r)]}case"timestamp":case"u128":return i===zt.TypedDataRevision.ACTIVE&&r2(r,t,X0.RANGE_U128),[t,Xs(r)];case"felt":case"shortstring":return i===zt.TypedDataRevision.ACTIVE&&r2(Xs(r),t,X0.RANGE_FELT),[t,Xs(r)];case"ClassHash":case"ContractAddress":return i===zt.TypedDataRevision.ACTIVE&&r2(r,t,X0.RANGE_FELT),[t,Xs(r)];case"bool":return i===zt.TypedDataRevision.ACTIVE&&(0,jE.default)((0,LE.isBoolean)(r),`Type mismatch for ${t} ${r}`),[t,Xs(r)];default:{if(i===zt.TypedDataRevision.ACTIVE)throw new Error(`Unsupported type: ${t}`);return[t,Xs(r)]}}}Ut.encodeValue=Y0;function GE(e,t,r,n=zt.TypedDataRevision.LEGACY){let i=e[t]??Ci[n].presetTypes[t],[s,a]=i.reduce(([o,c],u)=>{if(r[u.name]===void 0||r[u.name]===null&&u.type!=="enum")throw new Error(`Cannot encode data: missing data for '${u.name}'`);let b=r[u.name],h={parent:t,key:u.name},[d,l]=Y0(e,u.type,b,h,n);return[[...o,d],[...c,l]]},[["felt"],[$E(e,t,n)]]);return[s,a]}Ut.encodeData=GE;function Z0(e,t,r,n=zt.TypedDataRevision.LEGACY){return Ci[n].hashMethod(GE(e,t,r,n)[1])}Ut.getStructHash=Z0;function WE(e,t){if(!Dy(e))throw new Error("Typed data does not match JSON schema");let r=KE(e),{domain:n,hashMethod:i}=Ci[r],s=[(0,kE.encodeShortString)("StarkNet Message"),Z0(e.types,n,e.domain,r),t,Z0(e.types,e.primaryType,e.message,r)];return i(s)}Ut.getMessageHash=WE;function SG(e,t,r,n){let i=Dy(e);if(!(0,of.isBigNumberish)(e)&&!i)throw new Error("message has a wrong format.");if(i&&n===void 0)throw new Error("When providing a TypedData in message parameter, the accountAddress parameter has to be provided.");if(i&&!(0,of.isBigNumberish)(n))throw new Error("accountAddress shall be a BigNumberish");let s=i?WE(e,n):(0,of.toHex)(e),a=Array.isArray(t)?new HE.starkCurve.Signature(BigInt(t[0]),BigInt(t[1])):t,o=(0,of.toHex)(r);return HE.starkCurve.verify(a,s,o)}Ut.verifyMessage=SG});var XE=K(i2=>{D();N();Object.defineProperty(i2,"__esModule",{value:!0});i2.Signer=void 0;var Qu=ks(),xG=sf(),Ry=Us(),EG=jn(),ed=Wi(),AG=yr(),td=jo(),PG=t2(),CG=n2(),Fy=class{constructor(t=Ry.starkCurve.utils.randomPrivateKey()){this.pk=t instanceof Uint8Array?(0,EG.buf2hex)(t):(0,AG.toHex)(t)}async getPubKey(){return Ry.starkCurve.getStarkKey(this.pk)}async signMessage(t,r){let n=(0,CG.getMessageHash)(t,r);return(await this.signRaw(n)).signature}async signTransaction(t,r){let n=(0,PG.getExecuteCalldata)(t,r.cairoVersion),i;if(Object.values(Qu.ETransactionVersion2).includes(r.version)){let s=r;i=(0,ed.calculateInvokeTransactionHash)({...s,senderAddress:s.walletAddress,compiledCalldata:n,version:s.version})}else if(Object.values(Qu.ETransactionVersion3).includes(r.version)){let s=r;i=(0,ed.calculateInvokeTransactionHash)({...s,senderAddress:s.walletAddress,compiledCalldata:n,version:s.version,nonceDataAvailabilityMode:(0,td.intDAM)(s.nonceDataAvailabilityMode),feeDataAvailabilityMode:(0,td.intDAM)(s.feeDataAvailabilityMode)})}else throw Error("unsupported signTransaction version");return this.signRaw(i)}async signDeployAccountTransaction(t){let r=xG.CallData.compile(t.constructorCalldata),n;if(Object.values(Qu.ETransactionVersion2).includes(t.version)){let i=t;n=(0,ed.calculateDeployAccountTransactionHash)({...i,salt:i.addressSalt,constructorCalldata:r,version:i.version})}else if(Object.values(Qu.ETransactionVersion3).includes(t.version)){let i=t;n=(0,ed.calculateDeployAccountTransactionHash)({...i,salt:i.addressSalt,compiledConstructorCalldata:r,version:i.version,nonceDataAvailabilityMode:(0,td.intDAM)(i.nonceDataAvailabilityMode),feeDataAvailabilityMode:(0,td.intDAM)(i.feeDataAvailabilityMode)})}else throw Error("unsupported signDeployAccountTransaction version");return this.signRaw(n)}async signDeclareTransaction(t){let r;if(Object.values(Qu.ETransactionVersion2).includes(t.version)){let n=t;r=(0,ed.calculateDeclareTransactionHash)({...n,version:n.version})}else if(Object.values(Qu.ETransactionVersion3).includes(t.version)){let n=t;r=(0,ed.calculateDeclareTransactionHash)({...n,version:n.version,nonceDataAvailabilityMode:(0,td.intDAM)(n.nonceDataAvailabilityMode),feeDataAvailabilityMode:(0,td.intDAM)(n.feeDataAvailabilityMode)})}else throw Error("unsupported signDeclareTransaction version");return this.signRaw(r)}async signRaw(t){return{signature:Ry.starkCurve.sign(t,this.pk),hash:t}}};i2.Signer=Fy});var qy=K(Lo=>{D();N();var IG=Lo&&Lo.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),YE=Lo&&Lo.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&IG(t,e,r)};Object.defineProperty(Lo,"__esModule",{value:!0});YE(j_(),Lo);YE(XE(),Lo)});var jy=K(Ko=>{D();N();Object.defineProperty(Ko,"__esModule",{value:!0});Ko.contractClassResponseToLegacyCompiledContract=Ko.extractContractHashes=Ko.isSierra=void 0;var ZE=Wi(),BG=af(),MG=jo(),TG=Ir();function Hy(e){return"sierra_program"in((0,TG.isString)(e)?(0,BG.parse)(e):e)}Ko.isSierra=Hy;function OG(e){let t={...e};if(Hy(e.contract)&&(!e.compiledClassHash&&e.casm&&(t.compiledClassHash=(0,ZE.computeCompiledClassHash)(e.casm)),!t.compiledClassHash))throw new Error("Extract compiledClassHash failed, provide (CairoAssembly).casm file or compiledClassHash");if(t.classHash=e.classHash??(0,ZE.computeContractClassHash)(e.contract),!t.classHash)throw new Error("Extract classHash failed, provide (CompiledContract).json file or classHash");return t}Ko.extractContractHashes=OG;function DG(e){if(Hy(e))throw Error("ContractClassResponse need to be LegacyContractClass (cairo0 response class)");let t=e;return{...t,program:(0,MG.decompressProgram)(t.program)}}Ko.contractClassResponseToLegacyCompiledContract=DG});var sA=K(xn=>{D();N();Object.defineProperty(xn,"__esModule",{value:!0});xn.Block=xn.validBlockTags=xn.getDefaultNodes=xn.getDefaultNodeUrl=xn.parseContract=xn.createSierraContractClass=xn.wait=void 0;var NG=Jp(),eA=kn(),tA=ks(),RG=jy(),JE=Wi(),ky=af(),QE=yr(),FG=xi(),rA=jo(),J0=Ir();function qG(e){return new Promise(t=>{setTimeout(t,e)})}xn.wait=qG;function nA(e){let t={...e};return delete t.sierra_program_debug_info,t.abi=(0,JE.formatSpaces)((0,ky.stringify)(e.abi)),t.sierra_program=(0,JE.formatSpaces)((0,ky.stringify)(e.sierra_program)),t.sierra_program=(0,rA.compressProgram)(t.sierra_program),t}xn.createSierraContractClass=nA;function HG(e){let t=(0,J0.isString)(e)?(0,ky.parse)(e):e;return(0,RG.isSierra)(e)?nA(t):{...t,..."program"in t&&{program:(0,rA.compressProgram)(t.program)}}}xn.parseContract=HG;var jG=(e,t=!1,r)=>{let i=iA(r??NG.config.get("rpcVersion"))[e??eA.NetworkName.SN_SEPOLIA],s=Math.floor(Math.random()*i.length);return i[s]};xn.getDefaultNodeUrl=jG;function iA(e){let t=n=>`v${n.replace(/^v/,"").replace(/\./g,"_")}`,r={...eA.RPC_DEFAULT_NODES};return Object.keys(r).forEach(function(n,i){r[n]=r[n].map(s=>`${s}${t(e)}`)}),r}xn.getDefaultNodes=iA;xn.validBlockTags=Object.values(tA.BlockTag);var Ly=class{setIdentifier(t){if((0,J0.isString)(t))if((0,FG.isDecimalString)(t))this.number=parseInt(t,10);else if((0,QE.isHex)(t))this.hash=t;else if(xn.validBlockTags.includes(t))this.tag=t;else throw TypeError(`Block identifier unmanaged: ${t}`);else(0,J0.isBigInt)(t)?this.hash=(0,QE.toHex)(t):(0,J0.isNumber)(t)?this.number=t:this.tag=tA.BlockTag.PENDING;if((0,J0.isNumber)(this.number)&&this.number<0)throw TypeError(`Block number (${this.number}) can't be negative`)}constructor(t){this.hash=null,this.number=null,this.tag=null,this.valueOf=()=>this.number,this.toString=()=>this.hash,this.setIdentifier(t)}get queryIdentifier(){return this.number!==null?`blockNumber=${this.number}`:this.hash!==null?`blockHash=${this.hash}`:`blockNumber=${this.tag}`}get identifier(){return this.number!==null?{block_number:this.number}:this.hash!==null?{block_hash:this.hash}:this.tag}set identifier(t){this.setIdentifier(t)}};xn.Block=Ly});var uA=K(a2=>{D();N();Object.defineProperty(a2,"__esModule",{value:!0});a2.Account=void 0;var kG=Jp(),Ys=kn(),Q0=ef(),LG=qy(),Ky=ks(),s2=sf(),aA=jy(),oA=Wi(),rd=yr(),KG=sA(),Yi=jo(),cA=t2(),fA=Ir(),VG=n2(),Vy=(e,t=!0)=>{let{tip:r,paymasterData:n,accountDeploymentData:i,nonceDataAvailabilityMode:s,feeDataAvailabilityMode:a,resourceBounds:o}=(0,Yi.v3Details)(e,Ys.SupportedRpcVersion.v0_8_1),c={resource_bounds:{L1_GAS:o.l1_gas,L1_DATA_GAS:o.l1_data_gas,L2_GAS:o.l2_gas},tip:(0,rd.toHex)(r),paymaster_data:n,nonce_data_availability_mode:a=="L1"?0:1,fee_data_availability_mode:s=="L1"?0:1};return t&&(c.account_deployment_data=i),c},Uy=class{constructor(t,r,n,i=kG.config.get("transactionVersion")){this.address=t.toLowerCase(),this.signer=(0,fA.isString)(r)||r instanceof Uint8Array?new LG.Signer(r):r,n&&(this.cairoVersion=n.toString()),this.transactionVersion=i}async getCairoVersion(){return this.cairoVersion}async execute(t,r={}){let n=Array.isArray(t)?t:[t];if(r.nonce===void 0||r.chainId===void 0)throw new Error("missing transaction parameter");let i=Q0.ETransactionVersion.V3,s={...(0,Yi.v3Details)(r,Ys.SupportedRpcVersion.v0_8_1),walletAddress:this.address,nonce:r.nonce,chainId:r.chainId,cairoVersion:await this.getCairoVersion(),version:i},a=await this.signer.signTransaction(n,s),o=(0,cA.getExecuteCalldata)(n,await this.getCairoVersion());return{txId:a.hash,signature:{type:Ky.TransactionType.INVOKE,sender_address:this.address,calldata:(0,Yi.signatureToHexArray)(s2.CallData.compile(o)),signature:(0,Yi.signatureToHexArray)(a.signature),nonce:(0,rd.toHex)(r.nonce),...Vy(r),version:i}}}async declare(t,r={}){let n=(0,aA.extractContractHashes)(t),{version:i}=r;if(r.nonce===void 0||r.chainId===void 0)throw new Error("missing transaction parameter");let s=Q0.ETransactionVersion.V3,a={...(0,Yi.v3Details)(r,Ys.SupportedRpcVersion.v0_8_1),nonce:r.nonce,version:s,chainId:r.chainId,walletAddress:this.address,cairoVersion:void 0},{compiledClassHash:o,contract:c,signature:u}=await this.buildDeclarePayload(n,a);return{type:Ky.TransactionType.DECLARE,sender_address:this.address,compiled_class_hash:o,contract_class:c,nonce:(0,rd.toHex)(r.nonce),signature:(0,Yi.signatureToDecimalArray)(u),...Vy(r),version:s}}async deploy(t,r={}){let{calls:n}=(0,cA.buildUDCCall)(t,this.address);return await this.execute(n,r)}async deployAccount({classHash:t,constructorCalldata:r=[],addressSalt:n=0,contractAddress:i},s={}){let a=Q0.ETransactionVersion.V3,o=Ys.ZERO;if(s.chainId===void 0)throw new Error("missing transaction parameter");let c=s2.CallData.compile(r),u=i??(0,oA.calculateContractAddressFromHash)(n,t,c,0),b=await this.signer.signDeployAccountTransaction({...(0,Yi.v3Details)(s,Ys.SupportedRpcVersion.v0_8_1),classHash:t,constructorCalldata:c,contractAddress:u,addressSalt:n,chainId:s.chainId,version:a,nonce:o});return{txId:b.hash,signature:{type:Ky.TransactionType.DEPLOY_ACCOUNT,version:a,signature:(0,Yi.signatureToHexArray)(b.signature),nonce:(0,rd.toHex)(o),contract_address_salt:n,constructor_calldata:(0,Yi.signatureToHexArray)(c),class_hash:(0,rd.toHex)(t),...Vy(s,!1)}}}async signMessage(t){return this.signer.signMessage(t,this.address)}async hashMessage(t){return(0,VG.getMessageHash)(t,this.address)}async buildDeclarePayload(t,r){let{classHash:n,contract:i,compiledClassHash:s}=(0,aA.extractContractHashes)(t),a=(0,KG.parseContract)(i);if((0,fA.isUndefined)(s)&&(r.version===Q0.ETransactionVersion3.F3||r.version===Q0.ETransactionVersion3.V3))throw Error("V3 Transaction work with Cairo1 Contracts and require compiledClassHash");let o=r.skipValidate?[]:await this.signer.signDeclareTransaction({...r,...(0,Yi.v3Details)(r,Ys.SupportedRpcVersion.v0_8_1),classHash:n,compiledClassHash:s,senderAddress:r.walletAddress});return{senderAddress:r.walletAddress,signature:o,contract:a,compiledClassHash:s}}async buildAccountDeployPayload({classHash:t,addressSalt:r=0,constructorCalldata:n=[],contractAddress:i},s){let a=s2.CallData.compile(n),o=i??(0,oA.calculateContractAddressFromHash)(r,t,a,0),c=s.skipValidate?[]:await this.signer.signDeployAccountTransaction({...s,...(0,Yi.v3Details)(s,Ys.SupportedRpcVersion.v0_8_1),classHash:t,contractAddress:o,addressSalt:r,constructorCalldata:a});return{...(0,Yi.v3Details)(s,Ys.SupportedRpcVersion.v0_8_1),classHash:t,addressSalt:r,constructorCalldata:a,signature:c}}buildUDCContractPayload(t){return[].concat(t).map(n=>{let{classHash:i,salt:s="0",unique:a=!0,constructorCalldata:o=[]}=n,c=s2.CallData.compile(o);return{contractAddress:Ys.UDC.ADDRESS,entrypoint:Ys.UDC.ENTRYPOINT,calldata:[i,s,(0,rd.toCairoBool)(a),c.length,...c]}})}};a2.Account=Uy});var dA=K(o2=>{D();N();Object.defineProperty(o2,"__esModule",{value:!0});o2.AccountInterface=void 0;var zy=class{};o2.AccountInterface=zy});var c2=K(Vo=>{D();N();var UG=Vo&&Vo.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),lA=Vo&&Vo.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&UG(t,e,r)};Object.defineProperty(Vo,"__esModule",{value:!0});lA(uA(),Vo);lA(dA(),Vo)});var hA=K(Uo=>{D();N();Object.defineProperty(Uo,"__esModule",{value:!0});Uo.bnToUint256=Uo.isUint256=Uo.uint256ToBN=void 0;var $y=Mo();function zG(e){return new $y.CairoUint256(e).toBigInt()}Uo.uint256ToBN=zG;function $G(e){return $y.CairoUint256.is(e)}Uo.isUint256=$G;function GG(e){return new $y.CairoUint256(e).toUint256HexString()}Uo.bnToUint256=GG});var Gy=K(Zs=>{D();N();Object.defineProperty(Zs,"__esModule",{value:!0});Zs.validateChecksumAddress=Zs.getChecksumAddress=Zs.validateAndParseAddress=Zs.addAddressPadding=void 0;var WG=ar(),pA=kn(),nd=jn(),XG=Wi(),bA=yr(),YG=Ir();function gA(e){let t=(0,bA.toHex)((0,YG.isString)(e)?(0,nd.addHexPrefix)(e):e),r=(0,nd.removeHexPrefix)(t).padStart(64,"0");return(0,nd.addHexPrefix)(r)}Zs.addAddressPadding=gA;function vA(e){let t=gA(e);if(!t.match(/^(0x)?[0-9a-fA-F]{64}$/))throw new Error("Invalid Address Format");return(0,bA.assertInRange)(t,pA.ZERO,pA.ADDR_BOUND-1n,"Starknet Address"),t}Zs.validateAndParseAddress=vA;function yA(e){let t=(0,nd.removeHexPrefix)(vA(e)).toLowerCase().split(""),r=(0,nd.removeHexPrefix)((0,XG.keccakBn)(e)),n=WG.base.fromHex(r.padStart(64,"0"));for(let i=0;i<t.length;i+=2)n[i>>1]>>4>=8&&(t[i]=t[i].toUpperCase()),(n[i>>1]&15)>=8&&(t[i+1]=t[i+1].toUpperCase());return(0,nd.addHexPrefix)(t.join(""))}Zs.getChecksumAddress=yA;function ZG(e){return yA(e)===e}Zs.validateChecksumAddress=ZG});var mA=K(Zi=>{D();N();Object.defineProperty(Zi,"__esModule",{value:!0});Zi.accountClassHash=Zi.ProxyAccountClassHash=Zi.ETHBridge=Zi.STRK=Zi.ETH=void 0;Zi.ETH="0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7";Zi.STRK="0x04718f5a0Fc34cC1AF16A1cdee98fFB20C31f5cD61D6Ab07201858f4287c938D";Zi.ETHBridge="0x073314940630fd6dcda0d772d4c972c4e0a9946bef9dabf4ef84eda8ef542b82";Zi.ProxyAccountClassHash="0x3530cc4759d78042f1b543bf797f5f3d647cde0388c33734cf91b7f7b9314a9";Zi.accountClassHash="0x309c042d3729173c7f2f91a34f04d8c509c1b292d334679ef1aabf8da0899cc"});var Yy=K(on=>{D();N();var JG=on&&on.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),QG=on&&on.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Xy=on&&on.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&JG(t,e,r);return QG(t,e),t};Object.defineProperty(on,"__esModule",{value:!0});on.CreateMultiContractCall=on.CreateContractCall=on.CreateTransferTx=on.CreateSignedDeployAccountTx=on.CalculateContractAddressFromHash=void 0;var d2=c2(),eW=Xy(Us()),Wy=Xy(Wi()),l2=Xy(af()),f2=sf(),h2=jn(),tW=Gy(),u2=mA();function wA(e){let t={implementation:u2.accountClassHash,selector:Wy.getSelectorFromName("initialize"),calldata:f2.CallData.compile({signer:e,guardian:"0"})},r=Wy.calculateContractAddressFromHash(e,u2.ProxyAccountClassHash,f2.CallData.compile(t),0);return(0,tW.addAddressPadding)(r)}on.CalculateContractAddressFromHash=wA;async function rW(e,t,r){let n=eW.starkCurve.getStarkKey(r),i=wA(n),s=new d2.Account(i,(0,h2.addHexPrefix)(r)),a={implementation:u2.accountClassHash,selector:Wy.getSelectorFromName("initialize"),calldata:f2.CallData.compile({signer:n,guardian:"0"})},o=f2.CallData.compile(a),c=await s.deployAccount({addressSalt:n,classHash:u2.ProxyAccountClassHash,constructorCalldata:o,contractAddress:i},{chainId:t,resourceBounds:e});return{txId:c.txId,signature:l2.stringify(c.signature)}}on.CreateSignedDeployAccountTx=rW;async function nW(e,t,r,n,i,s,a,o){let u=await new d2.Account(t,(0,h2.addHexPrefix)(o)).execute({contractAddress:e,entrypoint:"transfer",calldata:[r,n,0]},{chainId:a,nonce:i,resourceBounds:s});return{txId:u.txId,signature:l2.stringify(u.signature)}}on.CreateTransferTx=nW;async function iW(e,t,r,n,i,s,a,o){let c=new d2.Account(t,(0,h2.addHexPrefix)(o));n||(n=[]);let u=await c.execute({contractAddress:e,entrypoint:r,calldata:n},{chainId:a,nonce:i,resourceBounds:s});return{txId:u.txId,signature:l2.stringify(u.signature)}}on.CreateContractCall=iW;async function sW(e,t,r,n,i,s){let a=new d2.Account(e,(0,h2.addHexPrefix)(s)),o=t.map(u=>({contractAddress:u.contract_address?u.contract_address:u.contractAddress,entrypoint:u.entry_point?u.entry_point:u.entrypoint,calldata:u.calldata})),c=await a.execute(o,{chainId:i,nonce:r,resourceBounds:n});return{txId:c.txId,signature:l2.stringify(c.signature)}}on.CreateMultiContractCall=sW});var SA=K(bi=>{D();N();var aW=bi&&bi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),oW=bi&&bi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cW=bi&&bi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&aW(t,e,r);return oW(t,e),t};Object.defineProperty(bi,"__esModule",{value:!0});bi.verifyMessage=bi.signMessage=bi.signMessageWithTypeData=void 0;var _A=cW(Us()),fW=c2(),uW=jn(),dW=Yy(),Zy=da();async function lW(e,t){let r=Zy.signUtil.schnorr.stark.getPublicKey(t),n=_A.starkCurve.getStarkKey(t),i=(0,dW.CalculateContractAddressFromHash)(n),s=new fW.Account(i,(0,uW.addHexPrefix)(t)),a=await s.signMessage(e),o=await s.hashMessage(e);return{signature:a,hash:o,publicKey:r}}bi.signMessageWithTypeData=lW;async function hW(e,t){let r=Zy.signUtil.schnorr.stark.getPublicKey(t);return{signature:_A.starkCurve.sign(e,t),hash:e,publicKey:r}}bi.signMessage=hW;function pW(e,t,r){return Zy.signUtil.schnorr.stark.verify(e,t,r)}bi.verifyMessage=pW});var AA=K(gi=>{D();N();var bW=gi&&gi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),gW=gi&&gi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),vW=gi&&gi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&bW(t,e,r);return gW(t,e),t};Object.defineProperty(gi,"__esModule",{value:!0});gi.modPrivateKey=gi.testSign=gi.GetRandomPrivateKey=void 0;var xA=da(),Jy=ar(),Qy=vW(Us());async function yW(){for(;;){let e=Jy.base.randomBytes(32);if(mW(e)&&EA(e.toString("hex")))return`0x${xA.signUtil.schnorr.bytesToHex(e)}`}}gi.GetRandomPrivateKey=yW;function EA(e){let t="7465dd6b1bbffdb05442eb17f5ca38ad1aa78a6f56bf4415bdee219114a47a1",r=Qy.starkCurve.sign(t,e),n=xA.signUtil.schnorr.stark.getPublicKey(e);return Qy.starkCurve.verify(r,t,n)}gi.testSign=EA;function mW(e){let t=new Jy.BN(Array.from(e)),r=new Jy.BN(Qy.starkCurve.CURVE.n.toString());return t.cmp(r)<0&&!t.isZero()}var wW=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583");function _W(e){let t;return!e.startsWith("0x")&&!e.startsWith("0X")?t=`0x${e}`:t=e,"0x"+(BigInt(t.toLowerCase())%wW).toString(16)}gi.modPrivateKey=_W});var BA=K(sd=>{D();N();Object.defineProperty(sd,"__esModule",{value:!0});sd.StarknetWallet=sd.resourceBoundsFromRPC=void 0;var nr=ar(),id=da(),wr=tm(),PA=yr(),SW=jo(),xW=kn();function IA(e){let t=r=>"0x"+BigInt(r).toString(16);return{l1_gas:{max_amount:t(e.l1_gas_consumed),max_price_per_unit:t(e.l1_gas_price)},l1_data_gas:{max_amount:t(e.l1_data_gas_consumed),max_price_per_unit:t(e.l1_data_gas_price)},l2_gas:{max_amount:t(e.l2_gas_consumed),max_price_per_unit:t(e.l2_gas_price)}}}sd.resourceBoundsFromRPC=IA;function EW(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||!t.match(/^[0-9A-Fa-f]*$/))}function CA(e){if(!EW(e))return!1;let t=nr.base.fromHex(e.toLowerCase());return!(t.length<25||t.length>33||t.every(r=>r===0))}var em=class extends nr.BaseWallet{getRandomPrivateKey(){return(0,wr.GetRandomPrivateKey)()}async getDerivedPath(t){return`m/44'/9004'/0'/0/${t.index}`}async getDerivedPrivateKey(t){return id.bip39.mnemonicToSeedV2(t.mnemonic).then(r=>{let n=id.bip32.fromSeedV2(r,"m/44'/60'/0'/0/0");if(!n.privateKey)return Promise.reject(nr.GenPrivateKeyError);let i=H.Buffer.from(n.privateKey),s=id.bip32.fromSeedV2(i,t.hdPath);if(s.privateKey){let a=nr.base.toHex(s.privateKey),o=wr.ec.starkCurve.grindKey(a);return Promise.resolve(`0x${o}`)}else return Promise.reject(nr.GenPrivateKeyError)}).catch(r=>Promise.reject(nr.GenPrivateKeyError))}async getDerivedPrivateKeyOld(t){return id.bip39.mnemonicToSeed(t.mnemonic).then(r=>{let n=id.bip32.fromSeed(r).derivePath("m/44'/60'/0'/0/0");if(!n.privateKey)return Promise.reject(nr.GenPrivateKeyError);let i=H.Buffer.from(n.privateKey),s=id.bip32.fromSeed(i).derivePath(t.hdPath);if(s.privateKey){let a=nr.base.toHex(s.privateKey),o=wr.ec.starkCurve.grindKey(a);return Promise.resolve(`0x${o}`)}else return Promise.reject(nr.GenPrivateKeyError)}).catch(r=>Promise.reject(nr.GenPrivateKeyError+":"+r))}async getNewAddress(t){if(!CA(t.privateKey))throw new Error("invalid key");try{let r=(0,wr.modPrivateKey)(t.privateKey),n=wr.ec.starkCurve.getStarkKey(r),s={address:(0,wr.CalculateContractAddressFromHash)(n),publicKey:n};return Promise.resolve(s)}catch{return Promise.reject(nr.NewAddressError)}}async validPrivateKey(t){let n={isValid:CA(t.privateKey),privateKey:t.privateKey};return Promise.resolve(n)}async signTransaction(t){try{if(!t.privateKey)return Promise.reject(nr.InvalidPrivateKeyError);let r=t.data;if(r.nonce===void 0)return Promise.reject(nr.SignTxError);let n=r.nonce,i=r.chainId||wr.constants.StarknetChainId.SN_MAIN,s=(0,SW.estimateFeeToBounds)(xW.ZERO);r.resourceBounds&&(s=IA(r.resourceBounds));let a=(0,wr.modPrivateKey)(t.privateKey);if(r.type=="transfer"&&r.transferData!==void 0){let o=r.transferData.contractAddress,c=r.transferData.from,u=r.transferData.to,b=r.transferData.amount;if(!(await this.validAddress({address:u})).isValid)return Promise.reject(nr.ValidAddressError);let d=await(0,wr.CreateTransferTx)(o,c,u,b,n,s,i,a);return Promise.resolve(d)}else if(r.type=="deploy_account"){let o=await(0,wr.CreateSignedDeployAccountTx)(s,i,a);return Promise.resolve(o)}else if(r.type=="contract_call"&&r.contractCallData!==void 0){let o=r.contractCallData.contractAddress,c=r.contractCallData.from,u=r.contractCallData.functionName,b=r.contractCallData.callData,h=await(0,wr.CreateContractCall)(o,c,u,b,n,s,i,a);return Promise.resolve(h)}else if(r.type=="multi_contract_call"&&r.multiContractCallData!==void 0){let o=r.multiContractCallData.from,c=r.multiContractCallData.calls,u=(0,wr.CreateMultiContractCall)(o,c,n,s,i,a);return Promise.resolve(u)}return Promise.reject(nr.SignTxError)}catch{return Promise.reject(nr.SignTxError)}}async validAddress(t){let r;try{(0,wr.validateAndParseAddress)(t.address),r=t.address.startsWith("0x")&&t.address.length>50}catch{r=!1}let n={isValid:r,address:t.address};return Promise.resolve(n)}async signMessage(t){try{let r=(0,wr.modPrivateKey)(t.privateKey);if(typeof t.data.message=="string"){let n=t.data.message;if(n.startsWith("0x")){let i=await(0,wr.signMessage)(n,r),s=i.signature,a={signature:{r:s.r,s:s.s,recovery:s.recovery},hash:i.hash,publicKey:i.publicKey};return Promise.resolve(a)}}else{let n=t.data.message,i=await(0,wr.signMessageWithTypeData)(n,r),s=i.signature,a={signature:{r:s.r,s:s.s,recovery:s.recovery},hash:i.hash,publicKey:i.publicKey};return Promise.resolve(a)}}catch{return Promise.reject(nr.SignTxError)}}async signCommonMsg(t){let r;if(t.message.text)r=t.message.text;else{let h=await this.getNewAddress({privateKey:t.privateKey});h.publicKey.startsWith("0x")&&(h.publicKey=h.publicKey.substring(2)),r=(0,nr.buildCommonSignMsg)(h.publicKey,t.message.walletId)}let n=nr.base.magicHash(r),i=n.slice(0,16),s=n.slice(16),a=(0,wr.computeHashOnElements)([(0,PA.hexToDecimalString)(nr.base.toHex(i)),(0,PA.hexToDecimalString)(nr.base.toHex(s))]);a.startsWith("0x")&&(a=a.substring(2));let o=(0,wr.modPrivateKey)(t.privateKey),c=wr.ec.starkCurve.sign(a,o),u=wr.ec.starkCurve.ProjectivePoint.fromHex(nr.base.toHex(wr.ec.starkCurve.getPublicKey(o))),b={publicKey:u.x.toString(16),publicKeyY:u.y.toString(16),signedDataR:c.r.toString(16),signedDataS:c.s.toString(16)};return Promise.resolve(nr.base.toHex(nr.base.toUtf8((0,nr.jsonStringifyUniform)(b))))}verifyMessage(t){try{let r=t.data.signature,n=t.data.hash,i=t.data.publicKey;return Promise.resolve((0,wr.verifyMessage)(r,n,i))}catch(r){return Promise.reject(r)}}};sd.StarknetWallet=em});var tm=K(Oe=>{D();N();var MA=Oe&&Oe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),AW=Oe&&Oe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Js=Oe&&Oe.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&MA(t,e,r)},Ji=Oe&&Oe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&MA(t,e,r);return AW(t,e),t};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.typedData=Oe.shortString=Oe.uint256=Oe.merkle=Oe.ec=Oe.stark=Oe.transaction=Oe.num=Oe.json=Oe.hash=Oe.encode=Oe.constants=void 0;Js(qy(),Oe);Js(ks(),Oe);Js(Wi(),Oe);Js(c2(),Oe);Oe.constants=Ji(kn());Oe.encode=Ji(jn());Oe.hash=Ji(Wi());Oe.json=Ji(af());Oe.num=Ji(yr());Oe.transaction=Ji(t2());Oe.stark=Ji(jo());Oe.ec=Ji(Us());Oe.merkle=Ji(Oy());Oe.uint256=Ji(hA());Oe.shortString=Ji(xi());Oe.typedData=Ji(n2());Js(Gy(),Oe);Js(sf(),Oe);Js(SA(),Oe);Js(AA(),Oe);Js(Yy(),Oe);Js(BA(),Oe)});var im=K(sr=>{D();N();Object.defineProperty(sr,"__esModule",{value:!0});sr.extractShare=sr.ed25519Step3=sr.ed25519Step2=sr.ed25519Step1=sr.ed25519SetUp=sr.mpcEcdsaStep3=sr.ecdsaStep3=sr.ecdsaStep2=sr.ecdsaStep1=sr.ecdsaSetUp=sr.shakeHands=void 0;var ms=ar(),rm=xv(),p2=ih(),he=ps(),cn=Ev(),PW=tm(),CW="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC93PS4MnSbE5pLbXFrgSjphDjG9tqnWfwxgWbaMUhvtMVvSgFhO7JVbrY2AtflD8p3bXpFMIiGOLEp6W73No77rMigEJzbfRKy/vD8YMcdvW8KaoU5b4I7kloC7ItWW+keFWvoBO7OeqlPaMEBb/gXNWlqPvT2Gz5gDfqGJz5HRQIDAQAB";function IW(e){try{let t=ms.base.toHex(ms.base.randomBytes(16));return(0,cn.saveAesKey)(e,t),(0,he.RSAEncode)(t,CW)}catch(t){throw new he.MPCError(ms.MPCShakeHandsError,t)}}sr.shakeHands=IW;async function BW(e,t,r,n,i,s,a){try{let o;a!=null&&a.length>0?o={hash:a,raw:""}:o=await(0,p2.getMPCRawTransaction)(i,n);let c=e,u=i,b=s,[h,,d]=nm(t,"",r),l=[];Array.isArray(o.hash)?o.hash.forEach(C=>l.push(C)):l.push(o.hash);let y={version:he.MpcVersion.Version_v1,messages:l,path:s},p=he.JSONBigNative.stringify(y),m=(0,cn.loadAesKey)(e),w=(0,he.AESEncrypt)(p,m);return(0,cn.saveContext)(e,{messages:l,pShareData:d,path:b,shareData:h,currentMpcId:c,mpcRawData:o,currency:u}),Promise.resolve(w)}catch(o){return Promise.reject(new he.MPCError(ms.EcdsaSetupError,o))}}sr.ecdsaSetUp=BW;async function MW(e,t){let r=(0,cn.loadContext)(e),n=(0,cn.loadAesKey)(e),i=r.path,s=r.shareData,a=r.pShareData,o=r.currentMpcId,c=r.messages;try{let u=(0,he.AESDecrypt)(t,n),b=new Map(Object.entries(he.JSONBigNative.parse(u))),[h,d]=await(0,he.bip32Derive)(i,a.x2,s.publicKey,s.chaincode),l=d,y={MpcId:o,DeviceNumber:he.DeviceNumber.P2_No,CurveName:he.CurveName.Secp256k1,FuncType:he.FuncType.TssSign,Step:he.SignStep.Step1,Messages:c,EcdsaShare:{PublicKey:d,X2:h,E_x1:a.e_x1,PaiPubKey:a.paiPubKey},EcdsaMessageMap:b},p=await(0,he.Dispatch)(y),m=he.JSONBigNative.stringify(Object.fromEntries(p.EcdsaMessageMap)),w=(0,he.AESEncrypt)(m,n);return r.childPublicKey=l,r.p2Input=y,Promise.resolve(w)}catch(u){return Promise.reject(new he.MPCError(ms.EcdsaStep1Error,u))}}sr.ecdsaStep1=MW;async function TW(e,t){let r=(0,cn.loadContext)(e),n=(0,cn.loadAesKey)(e),i=r.p2Input;try{let s=(0,he.AESDecrypt)(t,n),a=new Map(Object.entries(he.JSONBigNative.parse(s)));i.Step=he.SignStep.Step2,i.EcdsaMessageMap=a;let o=await(0,he.Dispatch)(i),c=he.JSONBigNative.stringify(Object.fromEntries(o.EcdsaMessageMap)),u=(0,he.AESEncrypt)(c,n);return Promise.resolve(u)}catch(s){return Promise.reject(new he.MPCError(ms.EcdsaStep2Error,s))}}sr.ecdsaStep2=TW;async function OW(e,t){let r=(0,cn.loadContext)(e),n=r.messages,i=r.currentMpcId,s=r.mpcRawData,a=r.childPublicKey,o=r.currency;try{let c=await TA(e,t),u=[],b=[];for(let y of n){let p=(0,he.GetMapKeyTssSign)(i,y),m=c.EcdsaMessageMap.get(p).Signature;u.push("0x"+m.r.toString(16).padStart(64,"0")+m.s.toString(16).padStart(64,"0")),b.push(m.r.toString(16).padStart(64,"0")+m.s.toString(16).padStart(64,"0"))}let h=Array.isArray(s.hash)?u:u[0],d={raw:s.raw,sigs:h,publicKey:a.toHex()};if(s?.raw===""&&s?.hash!=null&&s?.hash.length>0){let y={signatures:b};return Promise.resolve(PW.json.stringify(y))}let l=await(0,p2.getMPCTransaction)(o,d);return Promise.resolve(l.toString())}catch(c){return Promise.reject(new he.MPCError(ms.EcdsaStep3Error,c))}}sr.ecdsaStep3=OW;async function TA(e,t){let r=(0,cn.loadContext)(e),n=(0,cn.loadAesKey)(e),i=r.p2Input,s=(0,he.AESDecrypt)(t,n),a=new Map(Object.entries(he.JSONBigNative.parse(s)));i.Step=he.SignStep.Step3,i.EcdsaMessageMap=a;let o=await(0,he.Dispatch)(i);return Promise.resolve(o)}sr.mpcEcdsaStep3=TA;async function DW(e,t,r,n,i){try{let s=await(0,p2.getMPCRawTransaction)(n,r),a=e,o=n,c=i,[,u]=nm("",t,""),b=[];Array.isArray(s.hash)?s.hash.forEach(p=>b.push(p)):b.push(s.hash);let h={version:he.MpcVersion.Version_v1,messages:b,path:i,ed25519Share:{threshold:2,partList:[he.DeviceNumber.P1_No,he.DeviceNumber.P2_No]}},d=he.JSONBigNative.stringify(h),l=(0,cn.loadAesKey)(e),y=(0,he.AESEncrypt)(d,l);return(0,cn.saveContext)(e,{currency:o,currentMpcId:a,messages:b,mpcRawData:s,path:c,shareData:u}),Promise.resolve(y)}catch(s){return Promise.reject(new he.MPCError(ms.Ed25519SetupError,s))}}sr.ed25519SetUp=DW;async function NW(e,t){let r=(0,cn.loadContext)(e),n=(0,cn.loadAesKey)(e),i=r.path,s=r.currentMpcId,a=r.messages,o=r.shareData;try{let c=(0,he.AESDecrypt)(t,n),u=(0,he.cvtObjToEd25519Map)((0,he.JsonParseBigInt)(c)),[b,h]=await(0,he.bip32Derive)(i,o.shareI,o.publicKey,o.chaincode),d=h,l={MpcId:s,DeviceNumber:he.DeviceNumber.P2_No,CurveName:he.CurveName.Ed25519,FuncType:he.FuncType.TssSign,Step:he.SignStep.Step1,Messages:a,Ed25519Share:{PublicKey:h,Threshold:2,PartList:[he.DeviceNumber.P1_No,he.DeviceNumber.P2_No],ShareI:b},Ed25519MessageMap:u},y=await(0,he.Dispatch)(l),p=(0,he.bigintStringify)((0,he.cvtEd25519MapToObj)(y.Ed25519MessageMap)),m=(0,he.AESEncrypt)(p,n);return r.childPublicKey=d,r.p2Input=l,r.ed25519P1Step1=u,Promise.resolve(m)}catch(c){return Promise.reject(new he.MPCError(ms.Ed25519Step1Error,c))}}sr.ed25519Step1=NW;async function RW(e,t){let r=(0,cn.loadContext)(e),n=(0,cn.loadAesKey)(e),i=r.p2Input,s=r.ed25519P1Step1;try{let a=(0,he.AESDecrypt)(t,n),o=(0,he.cvtObjToEd25519Map)((0,he.JsonParseBigInt)(a));i.Step=he.SignStep.Step2,i.Ed25519MessageMap=s;let c=await(0,he.Dispatch)(i),u=(0,he.bigintStringify)((0,he.cvtEd25519MapToObj)(c.Ed25519MessageMap)),b=(0,he.AESEncrypt)(u,n);return r.ed25519P1Step2=o,Promise.resolve(b)}catch(a){return Promise.reject(new he.MPCError(ms.Ed25519Step2Error,a))}}sr.ed25519Step2=RW;async function FW(e,t){let r=(0,cn.loadContext)(e),n=(0,cn.loadAesKey)(e),i=r.p2Input,s=r.messages,a=r.currentMpcId,o=r.mpcRawData,c=r.childPublicKey,u=r.ed25519P1Step2,b=r.currency;try{let h=(0,he.AESDecrypt)(t,n),d=(0,he.cvtObjToEd25519Map)((0,he.JsonParseBigInt)(h));i.Step=he.SignStep.Step3,i.Ed25519MessageMap=u;for(let[C,T]of d)i.Ed25519MessageMap.get(C).Signature=d.get(C).Signature;let l=await(0,he.Dispatch)(i),y=[];for(let C of s){let T=(0,he.GetMapKeyTssSign)(a,C),q=l.Ed25519MessageMap.get(T).Signature;y.push("0x"+q.r.toString(16).padStart(64,"0")+q.s.toString(16).padStart(64,"0"))}let p=Array.isArray(o.hash)?y:y[0],m={raw:o.raw,sigs:p,publicKey:c.toHex()},w=await(0,p2.getMPCTransaction)(b,m);return Promise.resolve(w.toString())}catch(h){return Promise.reject(new he.MPCError(ms.Ed25519Step3Error,h))}}sr.ed25519Step3=FW;function nm(e,t,r){let n,i,s;return e!==""&&(n=rm.ShareData.parseShareData(e)),t!==""&&(i=rm.ShareData.parseShareData(t)),r!==""&&(s=rm.EcdsaPData.parseEcdsaPShare(r)),[n,i,s]}sr.extractShare=nm});var NA=K(od=>{D();N();Object.defineProperty(od,"__esModule",{value:!0});od.signMsgStep3=od.signMsgSetup=void 0;var sm=ar(),OA=ih(),am=Ev(),DA=im(),ad=ps();async function qW(e,t,r,n,i,s){try{let a=await(0,OA.getMPCRawMessage)(i,n),c=[sm.base.stripHexPrefix(a.hash)],[u,,b]=(0,DA.extractShare)(t,"",r),h={version:ad.MpcVersion.Version_v1,messages:c,path:s},d=ad.JSONBigNative.stringify(h),l=(0,am.loadAesKey)(e),y=(0,ad.AESEncrypt)(d,l);return(0,am.saveContext)(e,{trxParam:n.data,messages:c,pShareData:b,path:s,shareData:u,currentMpcId:e,mpcRawData:a,currency:i}),Promise.resolve(y)}catch(a){return Promise.reject(new ad.MPCError(sm.SignMsgSetupError,a))}}od.signMsgSetup=qW;async function HW(e,t){let r=(0,am.loadContext)(e),n=r.messages,i=r.trxParam,s=r.currentMpcId,a=r.mpcRawData,o=r.childPublicKey,c=r.currency;try{let u=await(0,DA.mpcEcdsaStep3)(e,t),b=[];for(let l of n){let y=(0,ad.GetMapKeyTssSign)(s,l),p=u.EcdsaMessageMap.get(y).Signature;b.push("0x"+p.r.toString(16).padStart(64,"0")+p.s.toString(16).padStart(64,"0"))}let h={hash:a.hash,sigs:b[0],publicKey:o.toHex(),type:i.type,message:i.message},d=await(0,OA.getMPCSignedMessage)(c,h);return Promise.resolve(d.toString())}catch(u){return Promise.reject(new ad.MPCError(sm.SignMsgStep3Error,u))}}od.signMsgStep3=HW});var RA=K(Qi=>{D();N();Object.defineProperty(Qi,"__esModule",{value:!0});Qi.mpcSignMsg=Qi.mpcSignEd25519=Qi.mpcSignEcdsa=Qi.mpcShakeHands=Qi.getMPCAddress=void 0;var om=ps(),fn=FA(),Qs=ar();async function jW(e,t,r,n){if(!Qs.CoinCurveMap.has(r))return Promise.reject(Qs.UnsupportedCoinError);let i,s=Qs.CoinCurveMap.get(r);if(s===om.CurveName.Secp256k1)[i,,]=(0,fn.extractShare)(t,"","");else if(s===om.CurveName.Ed25519)[,i]=(0,fn.extractShare)("",t,"");else return Promise.reject(Qs.UnsupportedCoinError);let[a,o]=await(0,om.bip32Derive)(e,0n,i.publicKey,i.chaincode),c={publicKey:o.toHex(),hrp:n},u=await(0,fn.getAddressByPublicKey)(r,c);if(Qs.MultiAddressCoins.includes(r)){for(let b of u){let h={address:b.address,hrp:n};if(!await(0,fn.validAddress)(r,h))return Promise.reject(Qs.ValidAddressError)}return{childPublicKey:o.toHex(),multiAddress:u}}else{let b={address:u,hrp:n};return await(0,fn.validAddress)(r,b)?{childPublicKey:o.toHex(),address:u}:Promise.reject(Qs.ValidAddressError)}}Qi.getMPCAddress=jW;function kW(e){return(0,fn.shakeHands)(e)}Qi.mpcShakeHands=kW;async function LW(e){switch(e.step){case 0:return await(0,fn.ecdsaSetUp)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path,e.signHashList);case 1:return await(0,fn.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,fn.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,fn.ecdsaStep3)(e.mpcId,e.serverData);default:return Promise.reject(Qs.MPCStepError)}}Qi.mpcSignEcdsa=LW;async function KW(e){switch(e.step){case 0:return await(0,fn.ed25519SetUp)(e.mpcId,e.share,e.txParams,e.currency,e.path);case 1:return await(0,fn.ed25519Step1)(e.mpcId,e.serverData);case 2:return await(0,fn.ed25519Step2)(e.mpcId,e.serverData);case 3:return await(0,fn.ed25519Step3)(e.mpcId,e.serverData);default:return Promise.reject(Qs.MPCStepError)}}Qi.mpcSignEd25519=KW;async function VW(e){switch(e.step){case 0:return await(0,fn.signMsgSetup)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path);case 1:return await(0,fn.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,fn.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,fn.signMsgStep3)(e.mpcId,e.serverData);default:return Promise.reject(Qs.MPCStepError)}}Qi.mpcSignMsg=VW});var cm=K(ea=>{D();N();Object.defineProperty(ea,"__esModule",{value:!0});ea.isHexPrefixed=ea.stripHexPrefix=ea.fromHex=ea.toHex=void 0;function UW(e,t=!1){let r=H.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}ea.toHex=UW;function zW(e){return e.startsWith("0x")&&(e=e.substring(2)),H.Buffer.from(e,"hex")}ea.fromHex=zW;function $W(e){return e.startsWith("0x")?e.substring(2):e}ea.stripHexPrefix=$W;function GW(e){return e.startsWith("0x")}ea.isHexPrefixed=GW});var fm=K(cd=>{D();N();Object.defineProperty(cd,"__esModule",{value:!0});cd.fromBase64=cd.toBase64=void 0;var qA=lc();function WW(e){let t=H.Buffer.from(e);return qA.base64.encode(Uint8Array.from(t))}cd.toBase64=WW;function XW(e){return qA.base64.decode(e)}cd.fromBase64=XW});var HA=K(es=>{D();N();var YW=es&&es.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ZW=es&&es.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),JW=es&&es.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&YW(t,e,r);return ZW(t,e),t};Object.defineProperty(es,"__esModule",{value:!0});es.decrypt=es.encrypt=void 0;var Ra=JW(w2());function QW(e,t){let r=Ra.enc.Utf8.parse(t);return Ra.AES.encrypt(e,r,{iv:r,mode:Ra.mode.CBC,padding:Ra.pad.Pkcs7}).toString()}es.encrypt=QW;function eX(e,t){let r=Ra.enc.Utf8.parse(t);return Ra.AES.decrypt(e,r,{iv:r,mode:Ra.mode.CBC,padding:Ra.pad.Pkcs7}).toString(Ra.enc.Utf8)}es.decrypt=eX});var kA=K($t=>{D();N();var tX=$t&&$t.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),rX=$t&&$t.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),nX=$t&&$t.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&tX(t,e,r);return rX(t,e),t};Object.defineProperty($t,"__esModule",{value:!0});$t.wrapPEM=$t.unwrapPEM=$t.covertPublicKeyFromPkcs8ToPkcs1=$t.covertPublicKeyFromPkcs8ToPkix=$t.genKeyPair=$t.decodeAny=$t.encodeAny=$t.decode=$t.encode=void 0;var pt=nX(wv()),iX=pt.BigInteger,b2=cm(),sX=fm();function um(e,t){let r=pt.KJUR.crypto.Cipher.encrypt(e,t,"RSA");return(0,b2.fromHex)(r)}$t.encode=um;function dm(e,t){return pt.KJUR.crypto.Cipher.decrypt(e,t,"RSA")}$t.decode=dm;function aX(e,t){let r=uX(t),n=Math.floor((r.n.bitLength()+7)/8),i=e.length,s=0,a=n-11,o=[];for(;;){if(s+a>=i){let u=um(e.slice(s),r);o.push(u);break}let c=um(e.slice(s,s+a),r);o.push(c),s+=a}return pt.hextob64((0,b2.toHex)(H.Buffer.concat(o)))}$t.encodeAny=aX;function oX(e,t){let r=pt.RSAKey.getHexValueArrayOfChildrenFromHex(pt.b64tohex(t)),n=new pt.RSAKey;n.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8]);let i=Math.floor((n.n.bitLength()+7)/8),s=(0,sX.fromBase64)(e),a=s.length,o=0,c=[];for(;;){if(o+i>=a){let b=dm((0,b2.toHex)(s.slice(o)),n);c.push(b);break}let u=dm((0,b2.toHex)(s.slice(o,o+i)),n);c.push(u),o+=i}return c.join("")}$t.decodeAny=oX;function cX(e){let t=pt.KEYUTIL.generateKeypair("RSA",e),r=pt.KEYUTIL.getPEM(t.prvKeyObj,"PKCS1PRV"),n=pt.KEYUTIL.getPEM(t.pubKeyObj),i=jA(lm(n,!0));return{privateKey:lm(r,!1),publicKey:i}}$t.genKeyPair=cX;function fX(e){let t=pt.KEYUTIL.getKey(hm(e,!0)),r=new pt.KJUR.asn1.DERSequence({array:[new pt.KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new pt.KJUR.asn1.DERNull]}),n=new pt.KJUR.asn1.DERSequence({array:[new pt.KJUR.asn1.DERInteger({bigint:t.n}),new pt.KJUR.asn1.DERInteger({int:t.e})]}),i=new pt.KJUR.asn1.DERBitString({hex:"00"+n.getEncodedHex()}),s=new pt.KJUR.asn1.DERSequence({array:[r,i]});return pt.hextob64(s.getEncodedHex())}$t.covertPublicKeyFromPkcs8ToPkix=fX;function jA(e){let t=pt.KEYUTIL.getKey(hm(e,!0)),r=new pt.KJUR.asn1.DERSequence({array:[new pt.KJUR.asn1.DERInteger({bigint:t.n}),new pt.KJUR.asn1.DERInteger({int:t.e})]});return pt.hextob64(r.getEncodedHex())}$t.covertPublicKeyFromPkcs8ToPkcs1=jA;function uX(e){let t=pt.b64tohex(e);if(!pt.ASN1HEX.isASN1HEX(t))throw new Error("keyHex is not ASN.1 hex string");let r=pt.ASN1HEX.getChildIdx(t,0),n=new pt.RSAKey,i=pt.ASN1HEX.getV(t,r[0]);n.n=new iX(i,16);let s=pt.ASN1HEX.getV(t,r[1]);return n.e=parseInt(s,16),n.isPublic=!0,n.isPrivate=!1,n}function lm(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return pt.hextob64(pt.pemtohex(e,r))}$t.unwrapPEM=lm;function hm(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return pt.hextopem(pt.b64tohex(e),r)}$t.wrapPEM=hm});var pm=K(Vn=>{D();N();var LA=Vn&&Vn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),dX=Vn&&Vn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),KA=Vn&&Vn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&LA(t,e,r)},VA=Vn&&Vn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&LA(t,e,r);return dX(t,e),t};Object.defineProperty(Vn,"__esModule",{value:!0});Vn.rsa=Vn.aes=void 0;KA(cm(),Vn);KA(fm(),Vn);Vn.aes=VA(HA());Vn.rsa=VA(kA())});var $A=K(ts=>{D();N();Object.defineProperty(ts,"__esModule",{value:!0});ts.RSADecodeQRCodeInfo=ts.RSAEncodeQRCodeInfo=ts.GenRSAKeyForQRCode=ts.AesDecodeQRCodeInfo=ts.AesEncodeQRCodeInfo=void 0;var bm=ar(),fd=pm(),UA=bm.base.md5.encode("1677594506944"),lX=2048;function hX(e,t){if(e.length===0)throw new Error("message is empty");if(t.length===0)throw new Error("accountId is empty");let r=zA(t);return fd.aes.encrypt(e,r)}ts.AesEncodeQRCodeInfo=hX;function pX(e,t){if(e.length===0)throw new Error("secret is empty");if(t.length===0)throw new Error("accountId is empty");let r=zA(t);return fd.aes.decrypt(e,r)}ts.AesDecodeQRCodeInfo=pX;async function bX(){return Promise.resolve(fd.rsa.genKeyPair(lX))}ts.GenRSAKeyForQRCode=bX;async function gX(e,t){return Promise.resolve(fd.rsa.encodeAny(e,t))}ts.RSAEncodeQRCodeInfo=gX;async function vX(e,t){return Promise.resolve(fd.rsa.decodeAny(e,t))}ts.RSADecodeQRCodeInfo=vX;function zA(e){let t=fd.aes.encrypt(e,bm.base.md5.encode(UA));return bm.base.md5.encode(UA+t)}});var GA=K(g2=>{D();N();Object.defineProperty(g2,"__esModule",{value:!0});g2.getCoinHexKeyStringFromShareString=void 0;var gm=ps();async function yX(e,t){let r=(0,gm.JsonParseBigInt)(e),n=BigInt(r.ecdsaShare2.ShareI.toString()),i=n.toString(16);if(t&&t.length==3){let s=r.ecdsaShare2.ChainCode.toString(),a=new gm.ECPoint(r.ecdsaShare2.PublicKey.Curve,BigInt(r.ecdsaShare2.PublicKey.X.toString()),BigInt(r.ecdsaShare2.PublicKey.Y.toString())),[o,c]=await(0,gm.bip32Derive)([t[0],t[1],t[2]],n,a,s);i=o.toString(16)}return i.length%2==1&&(i="0"+i),i}g2.getCoinHexKeyStringFromShareString=yX});var WA=K(rs=>{D();N();var mX=rs&&rs.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ud=rs&&rs.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&mX(t,e,r)};Object.defineProperty(rs,"__esModule",{value:!0});ud(im(),rs);ud(NA(),rs);ud(RA(),rs);ud($A(),rs);ud(xv(),rs);ud(GA(),rs)});var XA=K(v2=>{D();N();Object.defineProperty(v2,"__esModule",{value:!0});v2.getMidKey=void 0;var vm=ps(),wX=ar();function _X(e){return e.startsWith("0x")&&(e=e.substring(2)),H.Buffer.from(e,"hex")}async function SX(e,t){let r=(0,vm.JsonParseBigInt)(e),n=r.ecdsaShare2.PublicKey,i=r.ecdsaShare2.ChainCode,s=new vm.ECPoint(n.Curve,BigInt(n.X.toString()),BigInt(n.Y.toString())),[a,o]=await(0,vm.bip32Derive)([0,t.valueOf(),0],0n,s,i,0),c=o.toHex(),u=_X(c);return wX.base.sha256(u)}v2.getMidKey=SX});var FA=K(Un=>{D();N();var YA=Un&&Un.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),xX=Un&&Un.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),y2=Un&&Un.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&YA(t,e,r)},EX=Un&&Un.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&YA(t,e,r);return xX(t,e),t};Object.defineProperty(Un,"__esModule",{value:!0});Un.base=void 0;y2(ih(),Un);y2(WA(),Un);y2(ar(),Un);y2(XA(),Un);Un.base=EX(pm())});export default FA();
//# sourceMappingURL=dist-G5APTVB4.js.map
