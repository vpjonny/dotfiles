import{a as fw,b as Dc,c as Da,d as dw}from"./chunk-LDXOKT52.js";import{a as Bd,d as aw,l as cw,m as X0,n as uw,p as he}from"./chunk-UGRF6UE3.js";import{a as sw,b as ow}from"./chunk-4GQL426X.js";import{G as ew,H as tw,I as rw,L as W0,M as nw,N as z0,O as iw,a as Od,d as Ka}from"./chunk-HONEWRHX.js";import{c as H,o as w,p,q as S}from"./chunk-LHDKEQAM.js";var bn=H(ss=>{w();S();Object.defineProperty(ss,"__esModule",{value:!0});ss.testnet=ss.regtest=ss.bitcoin=void 0;ss.bitcoin={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128};ss.regtest={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239};ss.testnet={messagePrefix:`Bitcoin Signed Message:
`,bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}});var Md=H(os=>{w();S();Object.defineProperty(os,"__esModule",{value:!0});os.encode=os.decode=os.check=void 0;function lw(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;let t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return!1;let r=e[5+t];return!(r===0||6+t+r!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||r>1&&e[t+6]===0&&!(e[t+7]&128))}os.check=lw;function hw(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");let t=e[3];if(t===0)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(e[4+t]!==2)throw new Error("Expected DER integer (2)");let r=e[5+t];if(r===0)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(t>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[t+6]&128)throw new Error("S value is negative");if(r>1&&e[t+6]===0&&!(e[t+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}os.decode=hw;function pw(e,t){let r=e.length,n=t.length;if(r===0)throw new Error("R length is zero");if(n===0)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(n>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(t[0]&128)throw new Error("S value is negative");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(n>1&&t[0]===0&&!(t[1]&128))throw new Error("S value excessively padded");let i=p.Buffer.allocUnsafe(6+r+n);return i[0]=48,i[1]=i.length-2,i[2]=2,i[3]=e.length,e.copy(i,4),i[4+r]=2,i[5+r]=t.length,t.copy(i,6+r),i}os.encode=pw});var Zs=H(Bo=>{w();S();Object.defineProperty(Bo,"__esModule",{value:!0});Bo.REVERSE_OPS=Bo.OPS=void 0;var Cd={OP_FALSE:0,OP_0:0,OP_DATA_1:1,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};Bo.OPS=Cd;var Y0={};Bo.REVERSE_OPS=Y0;for(let e of Object.keys(Cd)){let t=Cd[e];Y0[t]=e}});var Z0=H(cs=>{w();S();Object.defineProperty(cs,"__esModule",{value:!0});cs.decode=cs.encode=cs.encodingLength=void 0;var as=Zs();function $0(e){return e<as.OPS.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}cs.encodingLength=$0;function bw(e,t,r){let n=$0(t);return n===1?e.writeUInt8(t,r):n===2?(e.writeUInt8(as.OPS.OP_PUSHDATA1,r),e.writeUInt8(t,r+1)):n===3?(e.writeUInt8(as.OPS.OP_PUSHDATA2,r),e.writeUInt16LE(t,r+1)):(e.writeUInt8(as.OPS.OP_PUSHDATA4,r),e.writeUInt32LE(t,r+1)),n}cs.encode=bw;function gw(e,t){let r=e.readUInt8(t),n,i;if(r<as.OPS.OP_PUSHDATA1)n=r,i=1;else if(r===as.OPS.OP_PUSHDATA1){if(t+2>e.length)return null;n=e.readUInt8(t+1),i=2}else if(r===as.OPS.OP_PUSHDATA2){if(t+3>e.length)return null;n=e.readUInt16LE(t+1),i=3}else{if(t+5>e.length)return null;if(r!==as.OPS.OP_PUSHDATA4)throw new Error("Unexpected opcode");n=e.readUInt32LE(t+1),i=5}return{opcode:r,number:n,size:i}}cs.decode=gw});var J0=H(Mo=>{w();S();Object.defineProperty(Mo,"__esModule",{value:!0});Mo.encode=Mo.decode=void 0;function yw(e,t,r){t=t||4,r=r===void 0?!0:r;let n=e.length;if(n===0)return 0;if(n>t)throw new TypeError("Script number overflow");if(r&&(e[n-1]&127)===0&&(n<=1||(e[n-2]&128)===0))throw new Error("Non-minimally encoded script number");if(n===5){let s=e.readUInt32LE(0),o=e.readUInt8(4);return o&128?-((o&-129)*4294967296+s):o*4294967296+s}let i=0;for(let s=0;s<n;++s)i|=e[s]<<8*s;return e[n-1]&128?-(i&~(128<<8*(n-1))):i}Mo.decode=yw;function mw(e){return e>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0}function _w(e){let t=Math.abs(e),r=mw(t),n=p.Buffer.allocUnsafe(r),i=e<0;for(let s=0;s<r;++s)n.writeUInt8(t&255,s),t>>=8;return n[r-1]&128?n.writeUInt8(i?128:0,r-1):i&&(n[r-1]|=128),n}Mo.encode=_w});var Br=H(Z=>{w();S();Object.defineProperty(Z,"__esModule",{value:!0});Z.oneOf=Z.Null=Z.BufferN=Z.Function=Z.UInt32=Z.UInt8=Z.tuple=Z.maybe=Z.Hex=Z.Buffer=Z.String=Z.Boolean=Z.Array=Z.Number=Z.Hash256bit=Z.Hash160bit=Z.Buffer256bit=Z.isTaptree=Z.isTapleaf=Z.TAPLEAF_VERSION_MASK=Z.Satoshi=Z.Signer=Z.BIP32Path=Z.UInt31=Z.isPoint=Z.typeforce=void 0;var jc=Ka(),it=he();Object.defineProperty(Z,"typeforce",{enumerable:!0,get:function(){return it.typeforce}});var Q0=jc.Buffer.alloc(32,0),ep=jc.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");function vw(e){if(!jc.Buffer.isBuffer(e)||e.length<33)return!1;let t=e[0],r=e.slice(1,33);if(r.compare(Q0)===0||r.compare(ep)>=0)return!1;if((t===2||t===3)&&e.length===33)return!0;let n=e.slice(33);return n.compare(Q0)===0||n.compare(ep)>=0?!1:t===4&&e.length===65}Z.isPoint=vw;var ww=Math.pow(2,31)-1;function Sw(e){return it.typeforce.UInt32(e)&&e<=ww}Z.UInt31=Sw;function tp(e){return it.typeforce.String(e)&&!!e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}Z.BIP32Path=tp;tp.toJSON=()=>"BIP32 derivation path";function xw(e){return(it.typeforce.Buffer(e.publicKey)||typeof e.getPublicKey=="function")&&typeof e.sign=="function"}Z.Signer=xw;var Pw=21*1e14;function Tw(e){return it.typeforce.UInt53(e)&&e<=Pw}Z.Satoshi=Tw;Z.TAPLEAF_VERSION_MASK=254;function rp(e){return!e||!("output"in e)||!jc.Buffer.isBuffer(e.output)?!1:e.version!==void 0?(e.version&Z.TAPLEAF_VERSION_MASK)===e.version:!0}Z.isTapleaf=rp;function np(e){return(0,Z.Array)(e)?e.length!==2?!1:e.every(t=>np(t)):rp(e)}Z.isTaptree=np;Z.Buffer256bit=it.typeforce.BufferN(32);Z.Hash160bit=it.typeforce.BufferN(20);Z.Hash256bit=it.typeforce.BufferN(32);Z.Number=it.typeforce.Number;Z.Array=it.typeforce.Array;Z.Boolean=it.typeforce.Boolean;Z.String=it.typeforce.String;Z.Buffer=it.typeforce.Buffer;Z.Hex=it.typeforce.Hex;Z.maybe=it.typeforce.maybe;Z.tuple=it.typeforce.tuple;Z.UInt8=it.typeforce.UInt8;Z.UInt32=it.typeforce.UInt32;Z.Function=it.typeforce.Function;Z.BufferN=it.typeforce.BufferN;Z.Null=it.typeforce.Null;Z.oneOf=it.typeforce.oneOf});var up=H(_n=>{w();S();var Ew=_n&&_n.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Aw=_n&&_n.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ap=_n&&_n.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Ew(t,e,r);return Aw(t,e),t};Object.defineProperty(_n,"__esModule",{value:!0});_n.encode=_n.decode=void 0;var cp=ap(Md()),kd=ap(Br()),{typeforce:Iw}=kd,ip=p.Buffer.alloc(1,0);function sp(e){let t=0;for(;e[t]===0;)++t;return t===e.length?ip:(e=e.slice(t),e[0]&128?p.Buffer.concat([ip,e],1+e.length):e)}function op(e){e[0]===0&&(e=e.slice(1));let t=p.Buffer.alloc(32,0),r=Math.max(0,32-e.length);return e.copy(t,r),t}function Ow(e){let t=e.readUInt8(e.length-1),r=t&-193;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);let n=cp.decode(e.slice(0,-1)),i=op(n.r),s=op(n.s);return{signature:p.Buffer.concat([i,s],64),hashType:t}}_n.decode=Ow;function Bw(e,t){Iw({signature:kd.BufferN(64),hashType:kd.UInt8},{signature:e,hashType:t});let r=t&-193;if(r<=0||r>=4)throw new Error("Invalid hashType "+t);let n=p.Buffer.allocUnsafe(1);n.writeUInt8(t,0);let i=sp(e.slice(0,32)),s=sp(e.slice(32,64));return p.Buffer.concat([cp.encode(i,s),n])}_n.encode=Bw});var Gt=H(Pe=>{w();S();var Mw=Pe&&Pe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Cw=Pe&&Pe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Fa=Pe&&Pe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Mw(t,e,r);return Cw(t,e),t};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.signature=Pe.number=Pe.isCanonicalScriptSignature=Pe.isDefinedHashType=Pe.isCanonicalPubKey=Pe.toStack=Pe.fromASM=Pe.toASM=Pe.decompile=Pe.compile=Pe.isPushOnly=Pe.OPS=void 0;var kw=Fa(Md()),Yr=Zs();Object.defineProperty(Pe,"OPS",{enumerable:!0,get:function(){return Yr.OPS}});var Hd=Fa(Z0()),fp=Fa(J0()),Hw=Fa(up()),ai=Fa(Br()),{typeforce:ja}=ai,dp=Yr.OPS.OP_RESERVED;function Nw(e){return ai.Number(e)&&(e===Yr.OPS.OP_0||e>=Yr.OPS.OP_1&&e<=Yr.OPS.OP_16||e===Yr.OPS.OP_1NEGATE)}function Rw(e){return ai.Buffer(e)||Nw(e)}function lp(e){return ai.Array(e)&&e.every(Rw)}Pe.isPushOnly=lp;function Fc(e){if(e.length===0)return Yr.OPS.OP_0;if(e.length===1){if(e[0]>=1&&e[0]<=16)return dp+e[0];if(e[0]===129)return Yr.OPS.OP_1NEGATE}}function hp(e){return p.Buffer.isBuffer(e)}function Uw(e){return ai.Array(e)}function Gc(e){return p.Buffer.isBuffer(e)}function pp(e){if(hp(e))return e;ja(ai.Array,e);let t=e.reduce((i,s)=>Gc(s)?s.length===1&&Fc(s)!==void 0?i+1:i+Hd.encodingLength(s.length)+s.length:i+1,0),r=p.Buffer.allocUnsafe(t),n=0;if(e.forEach(i=>{if(Gc(i)){let s=Fc(i);if(s!==void 0){r.writeUInt8(s,n),n+=1;return}n+=Hd.encode(r,i.length,n),i.copy(r,n),n+=i.length}else r.writeUInt8(i,n),n+=1}),n!==r.length)throw new Error("Could not decode chunks");return r}Pe.compile=pp;function Nd(e){if(Uw(e))return e;ja(ai.Buffer,e);let t=[],r=0;for(;r<e.length;){let n=e[r];if(n>Yr.OPS.OP_0&&n<=Yr.OPS.OP_PUSHDATA4){let i=Hd.decode(e,r);if(i===null||(r+=i.size,r+i.number>e.length))return null;let s=e.slice(r,r+i.number);r+=i.number;let o=Fc(s);o!==void 0?t.push(o):t.push(s)}else t.push(n),r+=1}return t}Pe.decompile=Nd;function qw(e){return hp(e)&&(e=Nd(e)),e.map(t=>{if(Gc(t)){let r=Fc(t);if(r===void 0)return t.toString("hex");t=r}return Yr.REVERSE_OPS[t]}).join(" ")}Pe.toASM=qw;function Lw(e){return ja(ai.String,e),pp(e.split(" ").map(t=>Yr.OPS[t]!==void 0?Yr.OPS[t]:(ja(ai.Hex,t),p.Buffer.from(t,"hex"))))}Pe.fromASM=Lw;function Kw(e){return e=Nd(e),ja(lp,e),e.map(t=>Gc(t)?t:t===Yr.OPS.OP_0?p.Buffer.allocUnsafe(0):fp.encode(t-dp))}Pe.toStack=Kw;function Dw(e){return ai.isPoint(e)}Pe.isCanonicalPubKey=Dw;function bp(e){let t=e;return t&128&&(t=t&-129),t&64&&(t=t&-65),t>0&&t<4}Pe.isDefinedHashType=bp;function jw(e){return!p.Buffer.isBuffer(e)||!bp(e[e.length-1])?!1:kw.check(e.slice(0,-1))}Pe.isCanonicalScriptSignature=jw;Pe.number=fp;Pe.signature=Hw});var qi=H(Co=>{w();S();Object.defineProperty(Co,"__esModule",{value:!0});Co.value=Co.prop=void 0;function Fw(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){let n=r.call(this);return this[t]=n,n},set(n){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:n,writable:!0})}})}Co.prop=Fw;function Gw(e){let t;return()=>(t!==void 0||(t=e()),t)}Co.value=Gw});var _p=H(ci=>{w();S();var Vw=ci&&ci.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ww=ci&&ci.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),mp=ci&&ci.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Vw(t,e,r);return Ww(t,e),t};Object.defineProperty(ci,"__esModule",{value:!0});ci.p2data=void 0;var zw=bn(),Vc=mp(Gt()),Li=Br(),gp=mp(qi()),yp=Vc.OPS;function Xw(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Yw(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Li.typeforce)({network:Li.typeforce.maybe(Li.typeforce.Object),output:Li.typeforce.maybe(Li.typeforce.Buffer),data:Li.typeforce.maybe(Li.typeforce.arrayOf(Li.typeforce.Buffer))},e);let n={name:"embed",network:e.network||zw.bitcoin};if(gp.prop(n,"output",()=>{if(!!e.data)return Vc.compile([yp.OP_RETURN].concat(e.data))}),gp.prop(n,"data",()=>{if(!!e.output)return Vc.decompile(e.output).slice(1)}),t.validate&&e.output){let i=Vc.decompile(e.output);if(i[0]!==yp.OP_RETURN)throw new TypeError("Output is invalid");if(!i.slice(1).every(Li.typeforce.Buffer))throw new TypeError("Output is invalid");if(e.data&&!Xw(e.data,n.data))throw new TypeError("Data mismatch")}return Object.assign(n,e)}ci.p2data=Yw});var Sp=H(ui=>{w();S();var $w=ui&&ui.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Zw=ui&&ui.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),wp=ui&&ui.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&$w(t,e,r);return Zw(t,e),t};Object.defineProperty(ui,"__esModule",{value:!0});ui.p2ms=void 0;var Jw=bn(),ko=wp(Gt()),Qt=Br(),us=wp(qi()),Ho=ko.OPS,Wc=Ho.OP_RESERVED;function vp(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Qw(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&e.m!==void 0)&&!e.signatures)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{});function r(c){return ko.isCanonicalScriptSignature(c)||(t.allowIncomplete&&c===Ho.OP_0)!==void 0}(0,Qt.typeforce)({network:Qt.typeforce.maybe(Qt.typeforce.Object),m:Qt.typeforce.maybe(Qt.typeforce.Number),n:Qt.typeforce.maybe(Qt.typeforce.Number),output:Qt.typeforce.maybe(Qt.typeforce.Buffer),pubkeys:Qt.typeforce.maybe(Qt.typeforce.arrayOf(Qt.isPoint)),signatures:Qt.typeforce.maybe(Qt.typeforce.arrayOf(r)),input:Qt.typeforce.maybe(Qt.typeforce.Buffer)},e);let i={network:e.network||Jw.bitcoin},s=[],o=!1;function a(c){o||(o=!0,s=ko.decompile(c),i.m=s[0]-Wc,i.n=s[s.length-2]-Wc,i.pubkeys=s.slice(1,-2))}if(us.prop(i,"output",()=>{if(!!e.m&&!!i.n&&!!e.pubkeys)return ko.compile([].concat(Wc+e.m,e.pubkeys,Wc+i.n,Ho.OP_CHECKMULTISIG))}),us.prop(i,"m",()=>{if(!!i.output)return a(i.output),i.m}),us.prop(i,"n",()=>{if(!!i.pubkeys)return i.pubkeys.length}),us.prop(i,"pubkeys",()=>{if(!!e.output)return a(e.output),i.pubkeys}),us.prop(i,"signatures",()=>{if(!!e.input)return ko.decompile(e.input).slice(1)}),us.prop(i,"input",()=>{if(!!e.signatures)return ko.compile([Ho.OP_0].concat(e.signatures))}),us.prop(i,"witness",()=>{if(!!i.input)return[]}),us.prop(i,"name",()=>{if(!(!i.m||!i.n))return`p2ms(${i.m} of ${i.n})`}),t.validate){if(e.output){if(a(e.output),!Qt.typeforce.Number(s[0]))throw new TypeError("Output is invalid");if(!Qt.typeforce.Number(s[s.length-2]))throw new TypeError("Output is invalid");if(s[s.length-1]!==Ho.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(i.m<=0||i.n>16||i.m>i.n||i.n!==s.length-3)throw new TypeError("Output is invalid");if(!i.pubkeys.every(c=>(0,Qt.isPoint)(c)))throw new TypeError("Output is invalid");if(e.m!==void 0&&e.m!==i.m)throw new TypeError("m mismatch");if(e.n!==void 0&&e.n!==i.n)throw new TypeError("n mismatch");if(e.pubkeys&&!vp(e.pubkeys,i.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(e.n!==void 0&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(i.n=e.pubkeys.length,i.n<i.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<i.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>i.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==Ho.OP_0)throw new TypeError("Input is invalid");if(i.signatures.length===0||!i.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!vp(e.signatures,i.signatures))throw new TypeError("Signature mismatch");if(e.m!==void 0&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(i,e)}ui.p2ms=Qw});var Tp=H(fi=>{w();S();var e3=fi&&fi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),t3=fi&&fi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Pp=fi&&fi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&e3(t,e,r);return t3(t,e),t};Object.defineProperty(fi,"__esModule",{value:!0});fi.p2pk=void 0;var r3=bn(),Ro=Pp(Gt()),$n=Br(),No=Pp(qi()),xp=Ro.OPS;function n3(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,$n.typeforce)({network:$n.typeforce.maybe($n.typeforce.Object),output:$n.typeforce.maybe($n.typeforce.Buffer),pubkey:$n.typeforce.maybe($n.isPoint),signature:$n.typeforce.maybe(Ro.isCanonicalScriptSignature),input:$n.typeforce.maybe($n.typeforce.Buffer)},e);let r=No.value(()=>Ro.decompile(e.input)),i={name:"p2pk",network:e.network||r3.bitcoin};if(No.prop(i,"output",()=>{if(!!e.pubkey)return Ro.compile([e.pubkey,xp.OP_CHECKSIG])}),No.prop(i,"pubkey",()=>{if(!!e.output)return e.output.slice(1,-1)}),No.prop(i,"signature",()=>{if(!!e.input)return r()[0]}),No.prop(i,"input",()=>{if(!!e.signature)return Ro.compile([e.signature])}),No.prop(i,"witness",()=>{if(!!i.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==xp.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!(0,$n.isPoint)(i.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(i.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(i.input))throw new TypeError("Signature mismatch");if(e.input){if(r().length!==1)throw new TypeError("Input is invalid");if(!Ro.isCanonicalScriptSignature(i.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(i,e)}fi.p2pk=n3});var wr=H(vn=>{w();S();Object.defineProperty(vn,"__esModule",{value:!0});vn.taggedHash=vn.hash256=vn.hash160=vn.sha256=vn.ripemd160=void 0;var Ep=he();function Ap(e){return p.Buffer.from(Ep.base.ripemd160(e))}vn.ripemd160=Ap;function Uo(e){return p.Buffer.from(Ep.base.sha256(e))}vn.sha256=Uo;function i3(e){return Ap(Uo(e))}vn.hash160=i3;function s3(e){return Uo(Uo(e))}vn.hash256=s3;var o3=["BIP0340/challenge","BIP0340/aux","BIP0340/nonce","TapLeaf","TapBranch","TapSighash","TapTweak","KeyAgg list","KeyAgg coefficient"],a3=Object.fromEntries(o3.map(e=>{let t=Uo(p.Buffer.from(e));return[e,p.Buffer.concat([t,t])]}));function c3(e,t){return Uo(p.Buffer.concat([a3[e],t]))}vn.taggedHash=c3});var Op=H(di=>{w();S();var u3=di&&di.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),f3=di&&di.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ud=di&&di.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&u3(t,e,r);return f3(t,e),t};Object.defineProperty(di,"__esModule",{value:!0});di.p2pkh=void 0;var Rd=Ud(wr()),d3=bn(),qo=Ud(Gt()),Dr=Br(),Ki=Ud(qi()),fs=qo.OPS,Ip=he();function l3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,Dr.typeforce)({network:Dr.typeforce.maybe(Dr.typeforce.Object),address:Dr.typeforce.maybe(Dr.typeforce.String),hash:Dr.typeforce.maybe(Dr.typeforce.BufferN(20)),output:Dr.typeforce.maybe(Dr.typeforce.BufferN(25)),pubkey:Dr.typeforce.maybe(Dr.isPoint),signature:Dr.typeforce.maybe(qo.isCanonicalScriptSignature),input:Dr.typeforce.maybe(Dr.typeforce.Buffer)},e);let r=Ki.value(()=>{let o=Ip.base.fromBase58Check(e.address),a=o.readUInt8(0),c=o.slice(1);return{version:a,hash:c}}),n=Ki.value(()=>qo.decompile(e.input)),i=e.network||d3.bitcoin,s={name:"p2pkh",network:i};if(Ki.prop(s,"address",()=>{if(!s.hash)return;let o=p.Buffer.allocUnsafe(21);return o.writeUInt8(i.pubKeyHash,0),s.hash.copy(o,1),Ip.base.toBase58Check(o)}),Ki.prop(s,"hash",()=>{if(e.output)return e.output.slice(3,23);if(e.address)return r().hash;if(e.pubkey||s.pubkey)return Rd.hash160(e.pubkey||s.pubkey)}),Ki.prop(s,"output",()=>{if(!!s.hash)return qo.compile([fs.OP_DUP,fs.OP_HASH160,s.hash,fs.OP_EQUALVERIFY,fs.OP_CHECKSIG])}),Ki.prop(s,"pubkey",()=>{if(!!e.input)return n()[1]}),Ki.prop(s,"signature",()=>{if(!!e.input)return n()[0]}),Ki.prop(s,"input",()=>{if(!!e.pubkey&&!!e.signature)return qo.compile([e.signature,e.pubkey])}),Ki.prop(s,"witness",()=>{if(!!s.input)return[]}),t.validate){let o=p.Buffer.from([]);if(e.address){if(r().version!==i.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(r().hash.length!==20)throw new TypeError("Invalid address");o=r().hash}if(e.hash){if(o.length>0&&!o.equals(e.hash))throw new TypeError("Hash mismatch");o=e.hash}if(e.output){if(e.output.length!==25||e.output[0]!==fs.OP_DUP||e.output[1]!==fs.OP_HASH160||e.output[2]!==20||e.output[23]!==fs.OP_EQUALVERIFY||e.output[24]!==fs.OP_CHECKSIG)throw new TypeError("Output is invalid");let a=e.output.slice(3,23);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.pubkey){let a=Rd.hash160(e.pubkey);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.input){let a=n();if(a.length!==2)throw new TypeError("Input is invalid");if(!qo.isCanonicalScriptSignature(a[0]))throw new TypeError("Input has invalid signature");if(!(0,Dr.isPoint)(a[1]))throw new TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(a[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(a[1]))throw new TypeError("Pubkey mismatch");let c=Rd.hash160(a[1]);if(o.length>0&&!o.equals(c))throw new TypeError("Hash mismatch")}}return Object.assign(s,e)}di.p2pkh=l3});var Cp=H(hi=>{w();S();var h3=hi&&hi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),p3=hi&&hi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),qd=hi&&hi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&h3(t,e,r);return p3(t,e),t};Object.defineProperty(hi,"__esModule",{value:!0});hi.p2sh=void 0;var Bp=qd(wr()),b3=bn(),Di=qd(Gt()),$e=Br(),li=qd(qi()),Mp=he(),zc=Di.OPS;function g3(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function y3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,$e.typeforce)({network:$e.typeforce.maybe($e.typeforce.Object),address:$e.typeforce.maybe($e.typeforce.String),hash:$e.typeforce.maybe($e.typeforce.BufferN(20)),output:$e.typeforce.maybe($e.typeforce.BufferN(23)),redeem:$e.typeforce.maybe({network:$e.typeforce.maybe($e.typeforce.Object),output:$e.typeforce.maybe($e.typeforce.Buffer),input:$e.typeforce.maybe($e.typeforce.Buffer),witness:$e.typeforce.maybe($e.typeforce.arrayOf($e.typeforce.Buffer))}),input:$e.typeforce.maybe($e.typeforce.Buffer),witness:$e.typeforce.maybe($e.typeforce.arrayOf($e.typeforce.Buffer))},e);let r=e.network;r||(r=e.redeem&&e.redeem.network||b3.bitcoin);let n={network:r},i=li.value(()=>{let a=Mp.base.fromBase58Check(e.address),c=a.readUInt8(0),u=a.slice(1);return{version:c,hash:u}}),s=li.value(()=>Di.decompile(e.input)),o=li.value(()=>{let a=s();return{network:r,output:a[a.length-1],input:Di.compile(a.slice(0,-1)),witness:e.witness||[]}});if(li.prop(n,"address",()=>{if(!n.hash)return;let a=p.Buffer.allocUnsafe(21);return a.writeUInt8(n.network.scriptHash,0),n.hash.copy(a,1),Mp.base.toBase58Check(a)}),li.prop(n,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return i().hash;if(n.redeem&&n.redeem.output)return Bp.hash160(n.redeem.output)}),li.prop(n,"output",()=>{if(!!n.hash)return Di.compile([zc.OP_HASH160,n.hash,zc.OP_EQUAL])}),li.prop(n,"redeem",()=>{if(!!e.input)return o()}),li.prop(n,"input",()=>{if(!(!e.redeem||!e.redeem.input||!e.redeem.output))return Di.compile([].concat(Di.decompile(e.redeem.input),e.redeem.output))}),li.prop(n,"witness",()=>{if(n.redeem&&n.redeem.witness)return n.redeem.witness;if(n.input)return[]}),li.prop(n,"name",()=>{let a=["p2sh"];return n.redeem!==void 0&&n.redeem.name!==void 0&&a.push(n.redeem.name),a.join("-")}),t.validate){let a=p.Buffer.from([]);if(e.address){if(i().version!==r.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(i().hash.length!==20)throw new TypeError("Invalid address");a=i().hash}if(e.hash){if(a.length>0&&!a.equals(e.hash))throw new TypeError("Hash mismatch");a=e.hash}if(e.output){if(e.output.length!==23||e.output[0]!==zc.OP_HASH160||e.output[1]!==20||e.output[22]!==zc.OP_EQUAL)throw new TypeError("Output is invalid");let u=e.output.slice(2,22);if(a.length>0&&!a.equals(u))throw new TypeError("Hash mismatch");a=u}let c=u=>{if(u.output){let d=Di.decompile(u.output);if(!d||d.length<1)throw new TypeError("Redeem.output too short");let f=Bp.hash160(u.output);if(a.length>0&&!a.equals(f))throw new TypeError("Hash mismatch");a=f}if(u.input){let d=u.input.length>0,f=u.witness&&u.witness.length>0;if(!d&&!f)throw new TypeError("Empty input");if(d&&f)throw new TypeError("Input and witness provided");if(d){let b=Di.decompile(u.input);if(!Di.isPushOnly(b))throw new TypeError("Non push-only scriptSig")}}};if(e.input){let u=s();if(!u||u.length<1)throw new TypeError("Input too short");if(!p.Buffer.isBuffer(o().output))throw new TypeError("Input is invalid");c(o())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw new TypeError("Network mismatch");if(e.input){let u=o();if(e.redeem.output&&!e.redeem.output.equals(u.output))throw new TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(u.input))throw new TypeError("Redeem.input mismatch")}c(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!g3(e.redeem.witness,e.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(n,e)}hi.p2sh=y3});var Hp=H(pi=>{w();S();var m3=pi&&pi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),_3=pi&&pi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Kd=pi&&pi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&m3(t,e,r);return _3(t,e),t};Object.defineProperty(pi,"__esModule",{value:!0});pi.p2wpkh=void 0;var Ld=Kd(wr()),v3=bn(),Yc=Kd(Gt()),er=Br(),ds=Kd(qi()),Xc=he(),kp=Yc.OPS,w3=p.Buffer.alloc(0);function S3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,er.typeforce)({address:er.typeforce.maybe(er.typeforce.String),hash:er.typeforce.maybe(er.typeforce.BufferN(20)),input:er.typeforce.maybe(er.typeforce.BufferN(0)),network:er.typeforce.maybe(er.typeforce.Object),output:er.typeforce.maybe(er.typeforce.BufferN(22)),pubkey:er.typeforce.maybe(er.isPoint),signature:er.typeforce.maybe(Yc.isCanonicalScriptSignature),witness:er.typeforce.maybe(er.typeforce.arrayOf(er.typeforce.Buffer))},e);let r=ds.value(()=>{let s=Xc.base.bech32.decode(e.address),o=s.words.shift(),a=Xc.base.bech32.fromWords(s.words);return{version:o,prefix:s.prefix,data:p.Buffer.from(a)}}),n=e.network||v3.bitcoin,i={name:"p2wpkh",network:n};if(ds.prop(i,"address",()=>{if(!i.hash)return;let s=Xc.base.bech32.toWords(i.hash);return s.unshift(0),Xc.base.bech32.encode(n.bech32,s)}),ds.prop(i,"hash",()=>{if(e.output)return e.output.slice(2,22);if(e.address)return r().data;if(e.pubkey||i.pubkey)return Ld.hash160(e.pubkey||i.pubkey)}),ds.prop(i,"output",()=>{if(!!i.hash)return Yc.compile([kp.OP_0,i.hash])}),ds.prop(i,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(!!e.witness)return e.witness[1]}),ds.prop(i,"signature",()=>{if(!!e.witness)return e.witness[0]}),ds.prop(i,"input",()=>{if(!!i.witness)return w3}),ds.prop(i,"witness",()=>{if(!!e.pubkey&&!!e.signature)return[e.signature,e.pubkey]}),t.validate){let s=p.Buffer.from([]);if(e.address){if(n&&n.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==20)throw new TypeError("Invalid address data");s=r().data}if(e.hash){if(s.length>0&&!s.equals(e.hash))throw new TypeError("Hash mismatch");s=e.hash}if(e.output){if(e.output.length!==22||e.output[0]!==kp.OP_0||e.output[1]!==20)throw new TypeError("Output is invalid");if(s.length>0&&!s.equals(e.output.slice(2)))throw new TypeError("Hash mismatch");s=e.output.slice(2)}if(e.pubkey){let o=Ld.hash160(e.pubkey);if(s.length>0&&!s.equals(o))throw new TypeError("Hash mismatch");if(s=o,!(0,er.isPoint)(e.pubkey)||e.pubkey.length!==33)throw new TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(e.witness.length!==2)throw new TypeError("Witness is invalid");if(!Yc.isCanonicalScriptSignature(e.witness[0]))throw new TypeError("Witness has invalid signature");if(!(0,er.isPoint)(e.witness[1])||e.witness[1].length!==33)throw new TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw new TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw new TypeError("Pubkey mismatch");let o=Ld.hash160(e.witness[1]);if(s.length>0&&!s.equals(o))throw new TypeError("Hash mismatch")}}return Object.assign(i,e)}pi.p2wpkh=S3});var Up=H(bi=>{w();S();var x3=bi&&bi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),P3=bi&&bi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jd=bi&&bi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&x3(t,e,r);return P3(t,e),t};Object.defineProperty(bi,"__esModule",{value:!0});bi.p2wsh=void 0;var Np=jd(wr()),T3=bn(),ls=jd(Gt()),je=Br(),ji=jd(qi()),$c=he(),Rp=ls.OPS,Dd=p.Buffer.alloc(0);function E3(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}function Zc(e){return!!(p.Buffer.isBuffer(e)&&e.length===65&&e[0]===4&&(0,je.isPoint)(e))}function A3(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,je.typeforce)({network:je.typeforce.maybe(je.typeforce.Object),address:je.typeforce.maybe(je.typeforce.String),hash:je.typeforce.maybe(je.typeforce.BufferN(32)),output:je.typeforce.maybe(je.typeforce.BufferN(34)),redeem:je.typeforce.maybe({input:je.typeforce.maybe(je.typeforce.Buffer),network:je.typeforce.maybe(je.typeforce.Object),output:je.typeforce.maybe(je.typeforce.Buffer),witness:je.typeforce.maybe(je.typeforce.arrayOf(je.typeforce.Buffer))}),input:je.typeforce.maybe(je.typeforce.BufferN(0)),witness:je.typeforce.maybe(je.typeforce.arrayOf(je.typeforce.Buffer))},e);let r=ji.value(()=>{let o=$c.base.bech32.decode(e.address),a=o.words.shift(),c=$c.base.bech32.fromWords(o.words);return{version:a,prefix:o.prefix,data:p.Buffer.from(c)}}),n=ji.value(()=>ls.decompile(e.redeem.input)),i=e.network;i||(i=e.redeem&&e.redeem.network||T3.bitcoin);let s={network:i};if(ji.prop(s,"address",()=>{if(!s.hash)return;let o=$c.base.bech32.toWords(s.hash);return o.unshift(0),$c.base.bech32.encode(i.bech32,o)}),ji.prop(s,"hash",()=>{if(e.output)return e.output.slice(2);if(e.address)return r().data;if(s.redeem&&s.redeem.output)return Np.sha256(s.redeem.output)}),ji.prop(s,"output",()=>{if(!!s.hash)return ls.compile([Rp.OP_0,s.hash])}),ji.prop(s,"redeem",()=>{if(!!e.witness)return{output:e.witness[e.witness.length-1],input:Dd,witness:e.witness.slice(0,-1)}}),ji.prop(s,"input",()=>{if(!!s.witness)return Dd}),ji.prop(s,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){let o=ls.toStack(n());return s.redeem=Object.assign({witness:o},e.redeem),s.redeem.input=Dd,[].concat(o,e.redeem.output)}if(!!e.redeem&&!!e.redeem.output&&!!e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),ji.prop(s,"name",()=>{let o=["p2wsh"];return s.redeem!==void 0&&s.redeem.name!==void 0&&o.push(s.redeem.name),o.join("-")}),t.validate){let o=p.Buffer.from([]);if(e.address){if(r().prefix!==i.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==0)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");o=r().data}if(e.hash){if(o.length>0&&!o.equals(e.hash))throw new TypeError("Hash mismatch");o=e.hash}if(e.output){if(e.output.length!==34||e.output[0]!==Rp.OP_0||e.output[1]!==32)throw new TypeError("Output is invalid");let a=e.output.slice(2);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.redeem){if(e.redeem.network&&e.redeem.network!==i)throw new TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(e.redeem.output){if(ls.decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");let a=Np.sha256(e.redeem.output);if(o.length>0&&!o.equals(a))throw new TypeError("Hash mismatch");o=a}if(e.redeem.input&&!ls.isPushOnly(n()))throw new TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!E3(e.witness,e.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&n().some(Zc)||e.redeem.output&&(ls.decompile(e.redeem.output)||[]).some(Zc))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){let a=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(a))throw new TypeError("Witness and redeem.output mismatch");if(e.witness.some(Zc)||(ls.decompile(a)||[]).some(Zc))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(s,e)}bi.p2wsh=A3});var Kp=H((Fd,Lp)=>{w();S();var Jc=Ka(),gi=Jc.Buffer;function qp(e,t){for(var r in e)t[r]=e[r]}gi.from&&gi.alloc&&gi.allocUnsafe&&gi.allocUnsafeSlow?Lp.exports=Jc:(qp(Jc,Fd),Fd.Buffer=Js);function Js(e,t,r){return gi(e,t,r)}Js.prototype=Object.create(gi.prototype);qp(gi,Js);Js.from=function(e,t,r){if(typeof e=="number")throw new TypeError("Argument must not be a number");return gi(e,t,r)};Js.alloc=function(e,t,r){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=gi(e);return t!==void 0?typeof r=="string"?n.fill(t,r):n.fill(t):n.fill(0),n};Js.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return gi(e)};Js.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Jc.SlowBuffer(e)}});var Wd=H((KB,jp)=>{w();S();var Gd=Kp().Buffer,I3=9007199254740991;function Vd(e){if(e<0||e>I3||e%1!==0)throw new RangeError("value out of range")}function Ga(e,t,r){if(Vd(e),t||(t=Gd.allocUnsafe(Dp(e))),!Gd.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),Ga.bytes=1):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),Ga.bytes=3):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),Ga.bytes=5):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),Ga.bytes=9),t}function Va(e,t){if(!Gd.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);var r=e.readUInt8(t);if(r<253)return Va.bytes=1,r;if(r===253)return Va.bytes=3,e.readUInt16LE(t+1);if(r===254)return Va.bytes=5,e.readUInt32LE(t+1);Va.bytes=9;var n=e.readUInt32LE(t+1),i=e.readUInt32LE(t+5),s=i*4294967296+n;return Vd(s),s}function Dp(e){return Vd(e),e<253?1:e<=65535?3:e<=4294967295?5:9}jp.exports={encode:Ga,decode:Va,encodingLength:Dp}});var hs=H(st=>{w();S();var O3=st&&st.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),B3=st&&st.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Fp=st&&st.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&O3(t,e,r);return B3(t,e),t};Object.defineProperty(st,"__esModule",{value:!0});st.BufferReader=st.BufferWriter=st.cloneBuffer=st.reverseBuffer=st.writeUInt64LE=st.readUInt64LE=st.varuint=void 0;var Qs=Fp(Br()),{typeforce:Gp}=Qs,Wa=Fp(Wd());st.varuint=Wa;function Vp(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function Wp(e,t){let r=e.readUInt32LE(t),n=e.readUInt32LE(t+4);return n*=4294967296,Vp(n+r,9007199254740991),n+r}st.readUInt64LE=Wp;function zp(e,t,r){return Vp(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}st.writeUInt64LE=zp;function M3(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}st.reverseBuffer=M3;function C3(e){let t=p.Buffer.allocUnsafe(e.length);return e.copy(t),t}st.cloneBuffer=C3;var za=class{static withCapacity(t){return new za(p.Buffer.alloc(t))}constructor(t,r=0){this.buffer=t,this.offset=r,Gp(Qs.tuple(Qs.Buffer,Qs.UInt32),[t,r])}writeUInt8(t){this.offset=this.buffer.writeUInt8(t,this.offset)}writeInt32(t){this.offset=this.buffer.writeInt32LE(t,this.offset)}writeUInt32(t){this.offset=this.buffer.writeUInt32LE(t,this.offset)}writeUInt64(t){this.offset=zp(this.buffer,t,this.offset)}writeVarInt(t){Wa.encode(t,this.buffer,this.offset),this.offset+=Wa.encode.bytes}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw new Error("Cannot write slice out of bounds");this.offset+=t.copy(this.buffer,this.offset)}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(r=>this.writeVarSlice(r))}end(){if(this.buffer.length===this.offset)return this.buffer;throw new Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}};st.BufferWriter=za;var zd=class{constructor(t,r=0){this.buffer=t,this.offset=r,Gp(Qs.tuple(Qs.Buffer,Qs.UInt32),[t,r])}readUInt8(){let t=this.buffer.readUInt8(this.offset);return this.offset++,t}readInt32(){let t=this.buffer.readInt32LE(this.offset);return this.offset+=4,t}readUInt32(){let t=this.buffer.readUInt32LE(this.offset);return this.offset+=4,t}readUInt64(){let t=Wp(this.buffer,this.offset);return this.offset+=8,t}readVarInt(){let t=Wa.decode(this.buffer,this.offset);return this.offset+=Wa.decode.bytes,t}readSlice(t){if(this.buffer.length<this.offset+t)throw new Error("Cannot read slice out of bounds");let r=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,r}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){let t=this.readVarInt(),r=[];for(let n=0;n<t;n++)r.push(this.readVarSlice());return r}};st.BufferReader=zd});var Xp=H(ps=>{w();S();Object.defineProperty(ps,"__esModule",{value:!0});ps.base58=ps.fromBase58=ps.toBase58=void 0;var Xd=Bd();Object.defineProperty(ps,"base58",{enumerable:!0,get:function(){return Xd.base58}});function k3(e){let t=p.Buffer.from(e);return Xd.base58.encode(Uint8Array.from(t))}ps.toBase58=k3;function H3(e){return Xd.base58.decode(e)}ps.fromBase58=H3});var Yp=H(Lo=>{w();S();Object.defineProperty(Lo,"__esModule",{value:!0});Lo.validateHexString=Lo.isHexString=void 0;function N3(e,t){return e.match(/^0x[0-9A-Fa-f]*$/)?!(t&&e.length!==2+2*t):!1}Lo.isHexString=N3;function R3(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||t.length%2!==0||!t.match(/^[0-9A-Fa-f]*$/))}Lo.validateHexString=R3});var $p=H(yi=>{w();S();Object.defineProperty(yi,"__esModule",{value:!0});yi.isHexPrefixed=yi.stripHexPrefix=yi.fromHex=yi.toHex=void 0;var U3=Yp();function q3(e,t=!1){let r=p.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}yi.toHex=q3;function L3(e){if((e.startsWith("0x")||e.startsWith("0X"))&&(e=e.substring(2)),e.length%2!=0&&(e="0"+e),!(0,U3.validateHexString)(e))throw new Error("invalid hex string");return p.Buffer.from(e,"hex")}yi.fromHex=L3;function K3(e){return e.startsWith("0x")?e.substring(2):e}yi.stripHexPrefix=K3;function D3(e){return e.startsWith("0x")}yi.isHexPrefixed=D3});var Fi=H(eo=>{w();S();Object.defineProperty(eo,"__esModule",{value:!0});eo.anumber=Yd;eo.abytes=Zp;eo.ahash=F3;eo.aexists=G3;eo.aoutput=V3;function Yd(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function j3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Zp(e,...t){if(!j3(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function F3(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Yd(e.outputLen),Yd(e.blockLen)}function G3(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function V3(e,t){Zp(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}});var Jp=H(Qc=>{w();S();Object.defineProperty(Qc,"__esModule",{value:!0});Qc.crypto=void 0;Qc.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Sr=H(Ae=>{w();S();Object.defineProperty(Ae,"__esModule",{value:!0});Ae.Hash=Ae.nextTick=Ae.byteSwapIfBE=Ae.isLE=void 0;Ae.isBytes=W3;Ae.u8=z3;Ae.u32=X3;Ae.createView=Y3;Ae.rotr=$3;Ae.rotl=Z3;Ae.byteSwap=Jd;Ae.byteSwap32=J3;Ae.bytesToHex=eS;Ae.hexToBytes=tS;Ae.asyncLoop=nS;Ae.utf8ToBytes=tb;Ae.toBytes=eu;Ae.concatBytes=iS;Ae.checkOpts=sS;Ae.wrapConstructor=oS;Ae.wrapConstructorWithOpts=aS;Ae.wrapXOFConstructorWithOpts=cS;Ae.randomBytes=uS;var Ko=Jp(),Zd=Fi();function W3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function z3(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function X3(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Y3(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function $3(e,t){return e<<32-t|e>>>t}function Z3(e,t){return e<<t|e>>>32-t>>>0}Ae.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function Jd(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}Ae.byteSwapIfBE=Ae.isLE?e=>e:e=>Jd(e);function J3(e){for(let t=0;t<e.length;t++)e[t]=Jd(e[t])}var eb=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Q3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function eS(e){if((0,Zd.abytes)(e),eb)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Q3[e[r]];return t}var Gi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Qp(e){if(e>=Gi._0&&e<=Gi._9)return e-Gi._0;if(e>=Gi.A&&e<=Gi.F)return e-(Gi.A-10);if(e>=Gi.a&&e<=Gi.f)return e-(Gi.a-10)}function tS(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(eb)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){let o=Qp(e.charCodeAt(s)),a=Qp(e.charCodeAt(s+1));if(o===void 0||a===void 0){let c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}var rS=async()=>{};Ae.nextTick=rS;async function nS(e,t,r){let n=Date.now();for(let i=0;i<e;i++){r(i);let s=Date.now()-n;s>=0&&s<t||(await(0,Ae.nextTick)(),n+=s)}}function tb(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function eu(e){return typeof e=="string"&&(e=tb(e)),(0,Zd.abytes)(e),e}function iS(...e){let t=0;for(let n=0;n<e.length;n++){let i=e[n];(0,Zd.abytes)(i),t+=i.length}let r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var $d=class{clone(){return this._cloneInto()}};Ae.Hash=$d;function sS(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function oS(e){let t=n=>e().update(eu(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function aS(e){let t=(n,i)=>e(i).update(eu(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function cS(e){let t=(n,i)=>e(i).update(eu(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}function uS(e=32){if(Ko.crypto&&typeof Ko.crypto.getRandomValues=="function")return Ko.crypto.getRandomValues(new Uint8Array(e));if(Ko.crypto&&typeof Ko.crypto.randomBytes=="function")return Uint8Array.from(Ko.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var tu=H(to=>{w();S();Object.defineProperty(to,"__esModule",{value:!0});to.HashMD=void 0;to.setBigUint64=rb;to.Chi=fS;to.Maj=dS;var Qd=Fi(),Xa=Sr();function rb(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+u,a,n)}function fS(e,t,r){return e&t^~e&r}function dS(e,t,r){return e&t^e&r^t&r}var el=class extends Xa.Hash{constructor(t,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(t),this.view=(0,Xa.createView)(this.buffer)}update(t){(0,Qd.aexists)(this);let{view:r,buffer:n,blockLen:i}=this;t=(0,Xa.toBytes)(t);let s=t.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=(0,Xa.createView)(t);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,Qd.aexists)(this),(0,Qd.aoutput)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;rb(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=(0,Xa.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)a.setUint32(4*f,d[f],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};to.HashMD=el});var Do=H(ys=>{w();S();Object.defineProperty(ys,"__esModule",{value:!0});ys.sha224=ys.sha256=ys.SHA256=void 0;var tl=tu(),wn=Sr(),lS=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),bs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),gs=new Uint32Array(64),Ya=class extends tl.HashMD{constructor(t=32){super(64,t,8,!1),this.A=bs[0]|0,this.B=bs[1]|0,this.C=bs[2]|0,this.D=bs[3]|0,this.E=bs[4]|0,this.F=bs[5]|0,this.G=bs[6]|0,this.H=bs[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,r){for(let f=0;f<16;f++,r+=4)gs[f]=t.getUint32(r,!1);for(let f=16;f<64;f++){let b=gs[f-15],m=gs[f-2],y=(0,wn.rotr)(b,7)^(0,wn.rotr)(b,18)^b>>>3,_=(0,wn.rotr)(m,17)^(0,wn.rotr)(m,19)^m>>>10;gs[f]=_+gs[f-7]+y+gs[f-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:d}=this;for(let f=0;f<64;f++){let b=(0,wn.rotr)(a,6)^(0,wn.rotr)(a,11)^(0,wn.rotr)(a,25),m=d+b+(0,tl.Chi)(a,c,u)+lS[f]+gs[f]|0,_=((0,wn.rotr)(n,2)^(0,wn.rotr)(n,13)^(0,wn.rotr)(n,22))+(0,tl.Maj)(n,i,s)|0;d=u,u=c,c=a,a=o+m|0,o=s,s=i,i=n,n=m+_|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(n,i,s,o,a,c,u,d)}roundClean(){gs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};ys.SHA256=Ya;var rl=class extends Ya{constructor(){super(28),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868}};ys.sha256=(0,wn.wrapConstructor)(()=>new Ya);ys.sha224=(0,wn.wrapConstructor)(()=>new rl)});var jo=H(re=>{w();S();Object.defineProperty(re,"__esModule",{value:!0});re.add5L=re.add5H=re.add4H=re.add4L=re.add3H=re.add3L=re.rotlBL=re.rotlBH=re.rotlSL=re.rotlSH=re.rotr32L=re.rotr32H=re.rotrBL=re.rotrBH=re.rotrSL=re.rotrSH=re.shrSL=re.shrSH=re.toBig=void 0;re.fromBig=il;re.split=nb;re.add=yb;var ru=BigInt(2**32-1),nl=BigInt(32);function il(e,t=!1){return t?{h:Number(e&ru),l:Number(e>>nl&ru)}:{h:Number(e>>nl&ru)|0,l:Number(e&ru)|0}}function nb(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:o}=il(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]}var ib=(e,t)=>BigInt(e>>>0)<<nl|BigInt(t>>>0);re.toBig=ib;var sb=(e,t,r)=>e>>>r;re.shrSH=sb;var ob=(e,t,r)=>e<<32-r|t>>>r;re.shrSL=ob;var ab=(e,t,r)=>e>>>r|t<<32-r;re.rotrSH=ab;var cb=(e,t,r)=>e<<32-r|t>>>r;re.rotrSL=cb;var ub=(e,t,r)=>e<<64-r|t>>>r-32;re.rotrBH=ub;var fb=(e,t,r)=>e>>>r-32|t<<64-r;re.rotrBL=fb;var db=(e,t)=>t;re.rotr32H=db;var lb=(e,t)=>e;re.rotr32L=lb;var hb=(e,t,r)=>e<<r|t>>>32-r;re.rotlSH=hb;var pb=(e,t,r)=>t<<r|e>>>32-r;re.rotlSL=pb;var bb=(e,t,r)=>t<<r-32|e>>>64-r;re.rotlBH=bb;var gb=(e,t,r)=>e<<r-32|t>>>64-r;re.rotlBL=gb;function yb(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var mb=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);re.add3L=mb;var _b=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;re.add3H=_b;var vb=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);re.add4L=vb;var wb=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;re.add4H=wb;var Sb=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);re.add5L=Sb;var xb=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;re.add5H=xb;var hS={fromBig:il,split:nb,toBig:ib,shrSH:sb,shrSL:ob,rotrSH:ab,rotrSL:cb,rotrBH:ub,rotrBL:fb,rotr32H:db,rotr32L:lb,rotlSH:hb,rotlSL:pb,rotlBH:bb,rotlBL:gb,add:yb,add3L:mb,add3H:_b,add4L:vb,add4H:wb,add5H:xb,add5L:Sb};re.default=hS});var $a=H(or=>{w();S();Object.defineProperty(or,"__esModule",{value:!0});or.sha384=or.sha512_256=or.sha512_224=or.sha512=or.SHA384=or.SHA512_256=or.SHA512_224=or.SHA512=void 0;var pS=tu(),fe=jo(),ou=Sr(),[bS,gS]=(()=>fe.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),ms=new Uint32Array(80),_s=new Uint32Array(80),ro=class extends pS.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:d,Fh:f,Fl:b,Gh:m,Gl:y,Hh:_,Hl:E}=this;return[t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E]}set(t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=b|0,this.Gh=m|0,this.Gl=y|0,this.Hh=_|0,this.Hl=E|0}process(t,r){for(let C=0;C<16;C++,r+=4)ms[C]=t.getUint32(r),_s[C]=t.getUint32(r+=4);for(let C=16;C<80;C++){let U=ms[C-15]|0,R=_s[C-15]|0,q=fe.default.rotrSH(U,R,1)^fe.default.rotrSH(U,R,8)^fe.default.shrSH(U,R,7),L=fe.default.rotrSL(U,R,1)^fe.default.rotrSL(U,R,8)^fe.default.shrSL(U,R,7),K=ms[C-2]|0,W=_s[C-2]|0,O=fe.default.rotrSH(K,W,19)^fe.default.rotrBH(K,W,61)^fe.default.shrSH(K,W,6),l=fe.default.rotrSL(K,W,19)^fe.default.rotrBL(K,W,61)^fe.default.shrSL(K,W,6),g=fe.default.add4L(L,l,_s[C-7],_s[C-16]),v=fe.default.add4H(g,q,O,ms[C-7],ms[C-16]);ms[C]=v|0,_s[C]=g|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:d,Eh:f,El:b,Fh:m,Fl:y,Gh:_,Gl:E,Hh:I,Hl:k}=this;for(let C=0;C<80;C++){let U=fe.default.rotrSH(f,b,14)^fe.default.rotrSH(f,b,18)^fe.default.rotrBH(f,b,41),R=fe.default.rotrSL(f,b,14)^fe.default.rotrSL(f,b,18)^fe.default.rotrBL(f,b,41),q=f&m^~f&_,L=b&y^~b&E,K=fe.default.add5L(k,R,L,gS[C],_s[C]),W=fe.default.add5H(K,I,U,q,bS[C],ms[C]),O=K|0,l=fe.default.rotrSH(n,i,28)^fe.default.rotrBH(n,i,34)^fe.default.rotrBH(n,i,39),g=fe.default.rotrSL(n,i,28)^fe.default.rotrBL(n,i,34)^fe.default.rotrBL(n,i,39),v=n&s^n&a^s&a,P=i&o^i&c^o&c;I=_|0,k=E|0,_=m|0,E=y|0,m=f|0,y=b|0,{h:f,l:b}=fe.default.add(u|0,d|0,W|0,O|0),u=a|0,d=c|0,a=s|0,c=o|0,s=n|0,o=i|0;let x=fe.default.add3L(O,g,P);n=fe.default.add3H(x,W,l,v),i=x|0}({h:n,l:i}=fe.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=fe.default.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=fe.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:d}=fe.default.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l:b}=fe.default.add(this.Eh|0,this.El|0,f|0,b|0),{h:m,l:y}=fe.default.add(this.Fh|0,this.Fl|0,m|0,y|0),{h:_,l:E}=fe.default.add(this.Gh|0,this.Gl|0,_|0,E|0),{h:I,l:k}=fe.default.add(this.Hh|0,this.Hl|0,I|0,k|0),this.set(n,i,s,o,a,c,u,d,f,b,m,y,_,E,I,k)}roundClean(){ms.fill(0),_s.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};or.SHA512=ro;var nu=class extends ro{constructor(){super(28),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735}};or.SHA512_224=nu;var iu=class extends ro{constructor(){super(32),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414}};or.SHA512_256=iu;var su=class extends ro{constructor(){super(48),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868}};or.SHA384=su;or.sha512=(0,ou.wrapConstructor)(()=>new ro);or.sha512_224=(0,ou.wrapConstructor)(()=>new nu);or.sha512_256=(0,ou.wrapConstructor)(()=>new iu);or.sha384=(0,ou.wrapConstructor)(()=>new su)});var al=H(Fo=>{w();S();Object.defineProperty(Fo,"__esModule",{value:!0});Fo.ripemd160=Fo.RIPEMD160=void 0;var yS=tu(),Za=Sr(),mS=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Tb=new Uint8Array(new Array(16).fill(0).map((e,t)=>t)),_S=Tb.map(e=>(9*e+5)%16),sl=[Tb],ol=[_S];for(let e=0;e<4;e++)for(let t of[sl,ol])t.push(t[e].map(r=>mS[r]));var Eb=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),vS=sl.map((e,t)=>e.map(r=>Eb[t][r])),wS=ol.map((e,t)=>e.map(r=>Eb[t][r])),SS=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),xS=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function Pb(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}var au=new Uint32Array(16),cu=class extends yS.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:r,h2:n,h3:i,h4:s}=this;return[t,r,n,i,s]}set(t,r,n,i,s){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(t,r){for(let m=0;m<16;m++,r+=4)au[m]=t.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,o=s,a=this.h2|0,c=a,u=this.h3|0,d=u,f=this.h4|0,b=f;for(let m=0;m<5;m++){let y=4-m,_=SS[m],E=xS[m],I=sl[m],k=ol[m],C=vS[m],U=wS[m];for(let R=0;R<16;R++){let q=(0,Za.rotl)(n+Pb(m,s,a,u)+au[I[R]]+_,C[R])+f|0;n=f,f=u,u=(0,Za.rotl)(a,10)|0,a=s,s=q}for(let R=0;R<16;R++){let q=(0,Za.rotl)(i+Pb(y,o,c,d)+au[k[R]]+E,U[R])+b|0;i=b,b=d,d=(0,Za.rotl)(c,10)|0,c=o,o=q}}this.set(this.h1+a+d|0,this.h2+u+b|0,this.h3+f+i|0,this.h4+n+o|0,this.h0+s+c|0)}roundClean(){au.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};Fo.RIPEMD160=cu;Fo.ripemd160=(0,Za.wrapConstructor)(()=>new cu)});var uu=H(Fe=>{w();S();Object.defineProperty(Fe,"__esModule",{value:!0});Fe.shake256=Fe.shake128=Fe.keccak_512=Fe.keccak_384=Fe.keccak_256=Fe.keccak_224=Fe.sha3_512=Fe.sha3_384=Fe.sha3_256=Fe.sha3_224=Fe.Keccak=void 0;Fe.keccakP=Cb;var Go=Fi(),Qa=jo(),Vi=Sr(),Ob=[],Bb=[],Mb=[],PS=BigInt(0),Ja=BigInt(1),TS=BigInt(2),ES=BigInt(7),AS=BigInt(256),IS=BigInt(113);for(let e=0,t=Ja,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Ob.push(2*(5*n+r)),Bb.push((e+1)*(e+2)/2%64);let i=PS;for(let s=0;s<7;s++)t=(t<<Ja^(t>>ES)*IS)%AS,t&TS&&(i^=Ja<<(Ja<<BigInt(s))-Ja);Mb.push(i)}var[OS,BS]=(0,Qa.split)(Mb,!0),Ab=(e,t,r)=>r>32?(0,Qa.rotlBH)(e,t,r):(0,Qa.rotlSH)(e,t,r),Ib=(e,t,r)=>r>32?(0,Qa.rotlBL)(e,t,r):(0,Qa.rotlSL)(e,t,r);function Cb(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let o=0;o<10;o++)r[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,c=(o+2)%10,u=r[c],d=r[c+1],f=Ab(u,d,1)^r[a],b=Ib(u,d,1)^r[a+1];for(let m=0;m<50;m+=10)e[o+m]^=f,e[o+m+1]^=b}let i=e[2],s=e[3];for(let o=0;o<24;o++){let a=Bb[o],c=Ab(i,s,a),u=Ib(i,s,a),d=Ob[o];i=e[d],s=e[d+1],e[d]=c,e[d+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=OS[n],e[1]^=BS[n]}r.fill(0)}var no=class extends Vi.Hash{constructor(t,r,n,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,(0,Go.anumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,Vi.u32)(this.state)}keccak(){Vi.isLE||(0,Vi.byteSwap32)(this.state32),Cb(this.state32,this.rounds),Vi.isLE||(0,Vi.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,Go.aexists)(this);let{blockLen:r,state:n}=this;t=(0,Vi.toBytes)(t);let i=t.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){(0,Go.aexists)(this,!1),(0,Go.abytes)(t),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=n&&this.keccak();let o=Math.min(n-this.posOut,s-i);t.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,Go.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,Go.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new no(r,n,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=n,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}};Fe.Keccak=no;var vs=(e,t,r)=>(0,Vi.wrapConstructor)(()=>new no(t,e,r));Fe.sha3_224=vs(6,144,224/8);Fe.sha3_256=vs(6,136,256/8);Fe.sha3_384=vs(6,104,384/8);Fe.sha3_512=vs(6,72,512/8);Fe.keccak_224=vs(1,144,224/8);Fe.keccak_256=vs(1,136,256/8);Fe.keccak_384=vs(1,104,384/8);Fe.keccak_512=vs(1,72,512/8);var kb=(e,t,r)=>(0,Vi.wrapXOFConstructorWithOpts)((n={})=>new no(t,e,n.dkLen===void 0?r:n.dkLen,!0));Fe.shake128=kb(31,168,128/8);Fe.shake256=kb(31,136,256/8)});var fu=H(Wo=>{w();S();Object.defineProperty(Wo,"__esModule",{value:!0});Wo.BLAKE=Wo.SIGMA=void 0;var Vo=Fi(),xr=Sr();Wo.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var cl=class extends xr.Hash{constructor(t,r,n={},i,s,o){if(super(),this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,Vo.anumber)(t),(0,Vo.anumber)(r),(0,Vo.anumber)(i),r<0||r>i)throw new Error("outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error("key length must be undefined or 1.."+i);if(n.salt!==void 0&&n.salt.length!==s)throw new Error("salt must be undefined or "+s);if(n.personalization!==void 0&&n.personalization.length!==o)throw new Error("personalization must be undefined or "+o);this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=(0,xr.u32)(this.buffer)}update(t){(0,Vo.aexists)(this);let{blockLen:r,buffer:n,buffer32:i}=this;t=(0,xr.toBytes)(t);let s=t.length,o=t.byteOffset,a=t.buffer;for(let c=0;c<s;){this.pos===r&&(xr.isLE||(0,xr.byteSwap32)(i),this.compress(i,0,!1),xr.isLE||(0,xr.byteSwap32)(i),this.pos=0);let u=Math.min(r-this.pos,s-c),d=o+c;if(u===r&&!(d%4)&&c+u<s){let f=new Uint32Array(a,d,Math.floor((s-c)/4));xr.isLE||(0,xr.byteSwap32)(f);for(let b=0;c+r<s;b+=i.length,c+=r)this.length+=r,this.compress(f,b,!1);xr.isLE||(0,xr.byteSwap32)(f);continue}n.set(t.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(t){(0,Vo.aexists)(this),(0,Vo.aoutput)(t,this);let{pos:r,buffer32:n}=this;this.finished=!0,this.buffer.subarray(r).fill(0),xr.isLE||(0,xr.byteSwap32)(n),this.compress(n,0,!0),xr.isLE||(0,xr.byteSwap32)(n);let i=(0,xr.u32)(t);this.get().forEach((s,o)=>i[o]=(0,xr.byteSwapIfBE)(s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=n,t.finished=i,t.destroyed=s,t.outputLen=o,t.buffer.set(r),t.pos=a,t}};Wo.BLAKE=cl});var ul=H(zo=>{w();S();Object.defineProperty(zo,"__esModule",{value:!0});zo.blake2b=zo.BLAKE2b=void 0;var Hb=fu(),jr=jo(),$r=Sr(),tr=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),V=new Uint32Array(32);function ws(e,t,r,n,i,s){let o=i[s],a=i[s+1],c=V[2*e],u=V[2*e+1],d=V[2*t],f=V[2*t+1],b=V[2*r],m=V[2*r+1],y=V[2*n],_=V[2*n+1],E=jr.default.add3L(c,d,o);u=jr.default.add3H(E,u,f,a),c=E|0,{Dh:_,Dl:y}={Dh:_^u,Dl:y^c},{Dh:_,Dl:y}={Dh:jr.default.rotr32H(_,y),Dl:jr.default.rotr32L(_,y)},{h:m,l:b}=jr.default.add(m,b,_,y),{Bh:f,Bl:d}={Bh:f^m,Bl:d^b},{Bh:f,Bl:d}={Bh:jr.default.rotrSH(f,d,24),Bl:jr.default.rotrSL(f,d,24)},V[2*e]=c,V[2*e+1]=u,V[2*t]=d,V[2*t+1]=f,V[2*r]=b,V[2*r+1]=m,V[2*n]=y,V[2*n+1]=_}function Ss(e,t,r,n,i,s){let o=i[s],a=i[s+1],c=V[2*e],u=V[2*e+1],d=V[2*t],f=V[2*t+1],b=V[2*r],m=V[2*r+1],y=V[2*n],_=V[2*n+1],E=jr.default.add3L(c,d,o);u=jr.default.add3H(E,u,f,a),c=E|0,{Dh:_,Dl:y}={Dh:_^u,Dl:y^c},{Dh:_,Dl:y}={Dh:jr.default.rotrSH(_,y,16),Dl:jr.default.rotrSL(_,y,16)},{h:m,l:b}=jr.default.add(m,b,_,y),{Bh:f,Bl:d}={Bh:f^m,Bl:d^b},{Bh:f,Bl:d}={Bh:jr.default.rotrBH(f,d,63),Bl:jr.default.rotrBL(f,d,63)},V[2*e]=c,V[2*e+1]=u,V[2*t]=d,V[2*t+1]=f,V[2*r]=b,V[2*r+1]=m,V[2*n]=y,V[2*n+1]=_}var du=class extends Hb.BLAKE{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=tr[0]|0,this.v0h=tr[1]|0,this.v1l=tr[2]|0,this.v1h=tr[3]|0,this.v2l=tr[4]|0,this.v2h=tr[5]|0,this.v3l=tr[6]|0,this.v3h=tr[7]|0,this.v4l=tr[8]|0,this.v4h=tr[9]|0,this.v5l=tr[10]|0,this.v5h=tr[11]|0,this.v6l=tr[12]|0,this.v6h=tr[13]|0,this.v7l=tr[14]|0,this.v7h=tr[15]|0;let r=t.key?t.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,$r.u32)((0,$r.toBytes)(t.salt));this.v4l^=(0,$r.byteSwapIfBE)(n[0]),this.v4h^=(0,$r.byteSwapIfBE)(n[1]),this.v5l^=(0,$r.byteSwapIfBE)(n[2]),this.v5h^=(0,$r.byteSwapIfBE)(n[3])}if(t.personalization){let n=(0,$r.u32)((0,$r.toBytes)(t.personalization));this.v6l^=(0,$r.byteSwapIfBE)(n[0]),this.v6h^=(0,$r.byteSwapIfBE)(n[1]),this.v7l^=(0,$r.byteSwapIfBE)(n[2]),this.v7h^=(0,$r.byteSwapIfBE)(n[3])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,$r.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:a,v3h:c,v4l:u,v4h:d,v5l:f,v5h:b,v6l:m,v6h:y,v7l:_,v7h:E}=this;return[t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E]}set(t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=u|0,this.v4h=d|0,this.v5l=f|0,this.v5h=b|0,this.v6l=m|0,this.v6h=y|0,this.v7l=_|0,this.v7h=E|0}compress(t,r,n){this.get().forEach((c,u)=>V[u]=c),V.set(tr,16);let{h:i,l:s}=jr.default.fromBig(BigInt(this.length));V[24]=tr[8]^s,V[25]=tr[9]^i,n&&(V[28]=~V[28],V[29]=~V[29]);let o=0,a=Hb.SIGMA;for(let c=0;c<12;c++)ws(0,4,8,12,t,r+2*a[o++]),Ss(0,4,8,12,t,r+2*a[o++]),ws(1,5,9,13,t,r+2*a[o++]),Ss(1,5,9,13,t,r+2*a[o++]),ws(2,6,10,14,t,r+2*a[o++]),Ss(2,6,10,14,t,r+2*a[o++]),ws(3,7,11,15,t,r+2*a[o++]),Ss(3,7,11,15,t,r+2*a[o++]),ws(0,5,10,15,t,r+2*a[o++]),Ss(0,5,10,15,t,r+2*a[o++]),ws(1,6,11,12,t,r+2*a[o++]),Ss(1,6,11,12,t,r+2*a[o++]),ws(2,7,8,13,t,r+2*a[o++]),Ss(2,7,8,13,t,r+2*a[o++]),ws(3,4,9,14,t,r+2*a[o++]),Ss(3,4,9,14,t,r+2*a[o++]);this.v0l^=V[0]^V[16],this.v0h^=V[1]^V[17],this.v1l^=V[2]^V[18],this.v1h^=V[3]^V[19],this.v2l^=V[4]^V[20],this.v2h^=V[5]^V[21],this.v3l^=V[6]^V[22],this.v3h^=V[7]^V[23],this.v4l^=V[8]^V[24],this.v4h^=V[9]^V[25],this.v5l^=V[10]^V[26],this.v5h^=V[11]^V[27],this.v6l^=V[12]^V[28],this.v6h^=V[13]^V[29],this.v7l^=V[14]^V[30],this.v7h^=V[15]^V[31],V.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};zo.BLAKE2b=du;zo.blake2b=(0,$r.wrapConstructorWithOpts)(e=>new du(e))});var hu=H(Ge=>{w();S();Object.defineProperty(Ge,"__esModule",{value:!0});Ge.sha3_512=Ge.sha3_256=Ge.ripemd160=Ge.sha512=Ge.sha256=Ge.magicHash=Ge.blake2=Ge.keccak256=Ge.keccak=Ge.hash160=Ge.doubleSha256=void 0;var lu=Do();Object.defineProperty(Ge,"sha256",{enumerable:!0,get:function(){return lu.sha256}});var MS=$a();Object.defineProperty(Ge,"sha512",{enumerable:!0,get:function(){return MS.sha512}});var Rb=al();Object.defineProperty(Ge,"ripemd160",{enumerable:!0,get:function(){return Rb.ripemd160}});var Xo=uu();Object.defineProperty(Ge,"sha3_256",{enumerable:!0,get:function(){return Xo.sha3_256}});Object.defineProperty(Ge,"sha3_512",{enumerable:!0,get:function(){return Xo.sha3_512}});var CS=ul();function Ub(e){let t=(0,lu.sha256)(e);return(0,lu.sha256)(t)}Ge.doubleSha256=Ub;function kS(e){let t=(0,lu.sha256)(e);return(0,Rb.ripemd160)(t)}Ge.hash160=kS;var HS=function(e,t=256){let r=p.Buffer.from(e);switch(t){case 224:return p.Buffer.from((0,Xo.keccak_224)(r));case 256:return p.Buffer.from((0,Xo.keccak_256)(r));case 384:return p.Buffer.from((0,Xo.keccak_384)(r));case 512:return p.Buffer.from((0,Xo.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${t}`)}};Ge.keccak=HS;var NS=function(e){return(0,Ge.keccak)(e)};Ge.keccak256=NS;function RS(e,t,r){let n=Math.ceil(t/8);return(0,CS.blake2b)(e,{dkLen:n,key:r})}Ge.blake2=RS;function Nb(e){let t;return e<253?(t=p.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=p.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=p.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=p.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}var US=p.Buffer.from(`Bitcoin Signed Message:
`);function qS(e,t){let r=t?p.Buffer.from(t,"utf8"):US,n=Nb(r.length),i=p.Buffer.from(e),s=Nb(i.length),o=p.Buffer.concat([n,r,s,i]);return Ub(o)}Ge.magicHash=qS});var tc=H(io=>{w();S();Object.defineProperty(io,"__esModule",{value:!0});io.hmac=io.HMAC=void 0;var pu=Fi(),qb=Sr(),ec=class extends qb.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,pu.ahash)(t);let n=(0,qb.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,pu.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,pu.aexists)(this),(0,pu.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};io.HMAC=ec;var LS=(e,t,r)=>new ec(e,t).update(r).digest();io.hmac=LS;io.hmac.create=(e,t)=>new ec(e,t)});var Db=H(Yo=>{w();S();Object.defineProperty(Yo,"__esModule",{value:!0});Yo.hmacSHA512=Yo.hmacSHA256=void 0;var Lb=tc(),Kb=hu();function KS(e,t){return p.Buffer.from((0,Lb.hmac)(Kb.sha256,e,t))}Yo.hmacSHA256=KS;function DS(e,t){return p.Buffer.from((0,Lb.hmac)(Kb.sha512,e,t))}Yo.hmacSHA512=DS});var fl=H(Me=>{w();S();Object.defineProperty(Me,"__esModule",{value:!0});Me.blake2s=Me.BLAKE2s=Me.B2S_IV=void 0;Me.G1s=Wi;Me.G2s=zi;Me.compress=Fb;var jb=fu(),jS=jo(),Zr=Sr();Me.B2S_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function Wi(e,t,r,n,i){return e=e+t+i|0,n=(0,Zr.rotr)(n^e,16),r=r+n|0,t=(0,Zr.rotr)(t^r,12),{a:e,b:t,c:r,d:n}}function zi(e,t,r,n,i){return e=e+t+i|0,n=(0,Zr.rotr)(n^e,8),r=r+n|0,t=(0,Zr.rotr)(t^r,7),{a:e,b:t,c:r,d:n}}function Fb(e,t,r,n,i,s,o,a,c,u,d,f,b,m,y,_,E,I,k,C){let U=0;for(let R=0;R<n;R++)({a:i,b:c,c:b,d:E}=Wi(i,c,b,E,r[t+e[U++]])),{a:i,b:c,c:b,d:E}=zi(i,c,b,E,r[t+e[U++]]),{a:s,b:u,c:m,d:I}=Wi(s,u,m,I,r[t+e[U++]]),{a:s,b:u,c:m,d:I}=zi(s,u,m,I,r[t+e[U++]]),{a:o,b:d,c:y,d:k}=Wi(o,d,y,k,r[t+e[U++]]),{a:o,b:d,c:y,d:k}=zi(o,d,y,k,r[t+e[U++]]),{a,b:f,c:_,d:C}=Wi(a,f,_,C,r[t+e[U++]]),{a,b:f,c:_,d:C}=zi(a,f,_,C,r[t+e[U++]]),{a:i,b:u,c:y,d:C}=Wi(i,u,y,C,r[t+e[U++]]),{a:i,b:u,c:y,d:C}=zi(i,u,y,C,r[t+e[U++]]),{a:s,b:d,c:_,d:E}=Wi(s,d,_,E,r[t+e[U++]]),{a:s,b:d,c:_,d:E}=zi(s,d,_,E,r[t+e[U++]]),{a:o,b:f,c:b,d:I}=Wi(o,f,b,I,r[t+e[U++]]),{a:o,b:f,c:b,d:I}=zi(o,f,b,I,r[t+e[U++]]),{a,b:c,c:m,d:k}=Wi(a,c,m,k,r[t+e[U++]]),{a,b:c,c:m,d:k}=zi(a,c,m,k,r[t+e[U++]]);return{v0:i,v1:s,v2:o,v3:a,v4:c,v5:u,v6:d,v7:f,v8:b,v9:m,v10:y,v11:_,v12:E,v13:I,v14:k,v15:C}}var bu=class extends jb.BLAKE{constructor(t={}){super(64,t.dkLen===void 0?32:t.dkLen,t,32,8,8),this.v0=Me.B2S_IV[0]|0,this.v1=Me.B2S_IV[1]|0,this.v2=Me.B2S_IV[2]|0,this.v3=Me.B2S_IV[3]|0,this.v4=Me.B2S_IV[4]|0,this.v5=Me.B2S_IV[5]|0,this.v6=Me.B2S_IV[6]|0,this.v7=Me.B2S_IV[7]|0;let r=t.key?t.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,Zr.u32)((0,Zr.toBytes)(t.salt));this.v4^=(0,Zr.byteSwapIfBE)(n[0]),this.v5^=(0,Zr.byteSwapIfBE)(n[1])}if(t.personalization){let n=(0,Zr.u32)((0,Zr.toBytes)(t.personalization));this.v6^=(0,Zr.byteSwapIfBE)(n[0]),this.v7^=(0,Zr.byteSwapIfBE)(n[1])}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,Zr.toBytes)(t.key)),this.update(n)}}get(){let{v0:t,v1:r,v2:n,v3:i,v4:s,v5:o,v6:a,v7:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=o|0,this.v6=a|0,this.v7=c|0}compress(t,r,n){let{h:i,l:s}=(0,jS.fromBig)(BigInt(this.length)),{v0:o,v1:a,v2:c,v3:u,v4:d,v5:f,v6:b,v7:m,v8:y,v9:_,v10:E,v11:I,v12:k,v13:C,v14:U,v15:R}=Fb(jb.SIGMA,r,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,Me.B2S_IV[0],Me.B2S_IV[1],Me.B2S_IV[2],Me.B2S_IV[3],s^Me.B2S_IV[4],i^Me.B2S_IV[5],n?~Me.B2S_IV[6]:Me.B2S_IV[6],Me.B2S_IV[7]);this.v0^=o^y,this.v1^=a^_,this.v2^=c^E,this.v3^=u^I,this.v4^=d^k,this.v5^=f^C,this.v6^=b^U,this.v7^=m^R}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};Me.BLAKE2s=bu;Me.blake2s=(0,Zr.wrapConstructorWithOpts)(e=>new bu(e))});var mu=H(yu=>{w();S();Object.defineProperty(yu,"__esModule",{value:!0});yu.pbkdf2=GS;yu.pbkdf2Async=VS;var gu=Fi(),FS=tc(),$o=Sr();function Gb(e,t,r,n){(0,gu.ahash)(e);let i=(0,$o.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:o,asyncTick:a}=i;if((0,gu.anumber)(s),(0,gu.anumber)(o),(0,gu.anumber)(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let c=(0,$o.toBytes)(t),u=(0,$o.toBytes)(r),d=new Uint8Array(o),f=FS.hmac.create(e,c),b=f._cloneInto().update(u);return{c:s,dkLen:o,asyncTick:a,DK:d,PRF:f,PRFSalt:b}}function Vb(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}function GS(e,t,r,n){let{c:i,dkLen:s,DK:o,PRF:a,PRFSalt:c}=Gb(e,t,r,n),u,d=new Uint8Array(4),f=(0,$o.createView)(d),b=new Uint8Array(a.outputLen);for(let m=1,y=0;y<s;m++,y+=a.outputLen){let _=o.subarray(y,y+a.outputLen);f.setInt32(0,m,!1),(u=c._cloneInto(u)).update(d).digestInto(b),_.set(b.subarray(0,_.length));for(let E=1;E<i;E++){a._cloneInto(u).update(b).digestInto(b);for(let I=0;I<_.length;I++)_[I]^=b[I]}}return Vb(a,c,o,u,b)}async function VS(e,t,r,n){let{c:i,dkLen:s,asyncTick:o,DK:a,PRF:c,PRFSalt:u}=Gb(e,t,r,n),d,f=new Uint8Array(4),b=(0,$o.createView)(f),m=new Uint8Array(c.outputLen);for(let y=1,_=0;_<s;y++,_+=c.outputLen){let E=a.subarray(_,_+c.outputLen);b.setInt32(0,y,!1),(d=u._cloneInto(d)).update(f).digestInto(m),E.set(m.subarray(0,E.length)),await(0,$o.asyncLoop)(i-1,o,()=>{c._cloneInto(d).update(m).digestInto(m);for(let I=0;I<E.length;I++)E[I]^=m[I]})}return Vb(c,u,a,d,m)}});var Zb=H(_u=>{w();S();Object.defineProperty(_u,"__esModule",{value:!0});_u.scrypt=WS;_u.scryptAsync=zS;var Zo=Fi(),zb=mu(),Xb=Do(),te=Sr();function Wb(e,t,r,n,i,s){let o=e[t++]^r[n++],a=e[t++]^r[n++],c=e[t++]^r[n++],u=e[t++]^r[n++],d=e[t++]^r[n++],f=e[t++]^r[n++],b=e[t++]^r[n++],m=e[t++]^r[n++],y=e[t++]^r[n++],_=e[t++]^r[n++],E=e[t++]^r[n++],I=e[t++]^r[n++],k=e[t++]^r[n++],C=e[t++]^r[n++],U=e[t++]^r[n++],R=e[t++]^r[n++],q=o,L=a,K=c,W=u,O=d,l=f,g=b,v=m,P=y,x=_,B=E,M=I,T=k,h=C,A=U,j=R;for(let D=0;D<8;D+=2)O^=(0,te.rotl)(q+T|0,7),P^=(0,te.rotl)(O+q|0,9),T^=(0,te.rotl)(P+O|0,13),q^=(0,te.rotl)(T+P|0,18),x^=(0,te.rotl)(l+L|0,7),h^=(0,te.rotl)(x+l|0,9),L^=(0,te.rotl)(h+x|0,13),l^=(0,te.rotl)(L+h|0,18),A^=(0,te.rotl)(B+g|0,7),K^=(0,te.rotl)(A+B|0,9),g^=(0,te.rotl)(K+A|0,13),B^=(0,te.rotl)(g+K|0,18),W^=(0,te.rotl)(j+M|0,7),v^=(0,te.rotl)(W+j|0,9),M^=(0,te.rotl)(v+W|0,13),j^=(0,te.rotl)(M+v|0,18),L^=(0,te.rotl)(q+W|0,7),K^=(0,te.rotl)(L+q|0,9),W^=(0,te.rotl)(K+L|0,13),q^=(0,te.rotl)(W+K|0,18),g^=(0,te.rotl)(l+O|0,7),v^=(0,te.rotl)(g+l|0,9),O^=(0,te.rotl)(v+g|0,13),l^=(0,te.rotl)(O+v|0,18),M^=(0,te.rotl)(B+x|0,7),P^=(0,te.rotl)(M+B|0,9),x^=(0,te.rotl)(P+M|0,13),B^=(0,te.rotl)(x+P|0,18),T^=(0,te.rotl)(j+A|0,7),h^=(0,te.rotl)(T+j|0,9),A^=(0,te.rotl)(h+T|0,13),j^=(0,te.rotl)(A+h|0,18);i[s++]=o+q|0,i[s++]=a+L|0,i[s++]=c+K|0,i[s++]=u+W|0,i[s++]=d+O|0,i[s++]=f+l|0,i[s++]=b+g|0,i[s++]=m+v|0,i[s++]=y+P|0,i[s++]=_+x|0,i[s++]=E+B|0,i[s++]=I+M|0,i[s++]=k+T|0,i[s++]=C+h|0,i[s++]=U+A|0,i[s++]=R+j|0}function Jo(e,t,r,n,i){let s=n+0,o=n+16*i;for(let a=0;a<16;a++)r[o+a]=e[t+(2*i-1)*16+a];for(let a=0;a<i;a++,s+=16,t+=16)Wb(r,o,e,t,r,s),a>0&&(o+=16),Wb(r,s,e,t+=16,r,o)}function Yb(e,t,r){let n=(0,te.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:o,dkLen:a,asyncTick:c,maxmem:u,onProgress:d}=n;if((0,Zo.anumber)(i),(0,Zo.anumber)(s),(0,Zo.anumber)(o),(0,Zo.anumber)(a),(0,Zo.anumber)(c),(0,Zo.anumber)(u),d!==void 0&&typeof d!="function")throw new Error("progressCb should be function");let f=128*s,b=f/4;if(i<=1||(i&i-1)!==0||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(o<0||o>(2**32-1)*32/f)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(f*(i+o)>u)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+u);let y=(0,zb.pbkdf2)(Xb.sha256,e,t,{c:1,dkLen:f*o}),_=(0,te.u32)(y),E=(0,te.u32)(new Uint8Array(f*i)),I=(0,te.u32)(new Uint8Array(f)),k=()=>{};if(d){let C=2*i*o,U=Math.max(Math.floor(C/1e4),1),R=0;k=()=>{R++,d&&(!(R%U)||R===C)&&d(R/C)}}return{N:i,r:s,p:o,dkLen:a,blockSize32:b,V:E,B32:_,B:y,tmp:I,blockMixCb:k,asyncTick:c}}function $b(e,t,r,n,i){let s=(0,zb.pbkdf2)(Xb.sha256,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),i.fill(0),s}function WS(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:u,B:d,tmp:f,blockMixCb:b}=Yb(e,t,r);te.isLE||(0,te.byteSwap32)(u);for(let m=0;m<s;m++){let y=a*m;for(let _=0;_<a;_++)c[_]=u[y+_];for(let _=0,E=0;_<n-1;_++)Jo(c,E,c,E+=a,i),b();Jo(c,(n-1)*a,u,y,i),b();for(let _=0;_<n;_++){let E=u[y+a-16]%n;for(let I=0;I<a;I++)f[I]=u[y+I]^c[E*a+I];Jo(f,0,u,y,i),b()}}return te.isLE||(0,te.byteSwap32)(u),$b(e,o,d,c,f)}async function zS(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:u,B:d,tmp:f,blockMixCb:b,asyncTick:m}=Yb(e,t,r);te.isLE||(0,te.byteSwap32)(u);for(let y=0;y<s;y++){let _=a*y;for(let I=0;I<a;I++)c[I]=u[_+I];let E=0;await(0,te.asyncLoop)(n-1,m,()=>{Jo(c,E,c,E+=a,i),b()}),Jo(c,(n-1)*a,u,_,i),b(),await(0,te.asyncLoop)(n,m,()=>{let I=u[_+a-16]%n;for(let k=0;k<a;k++)f[k]=u[_+k]^c[I*a+k];Jo(f,0,u,_,i),b()})}return te.isLE||(0,te.byteSwap32)(u),$b(e,o,d,c,f)}});var eg=H(ea=>{w();S();Object.defineProperty(ea,"__esModule",{value:!0});ea.blake3=ea.BLAKE3=void 0;var rc=Fi(),XS=fu(),Jb=jo(),Zn=fl(),ar=Sr(),mi={CHUNK_START:1<<0,CHUNK_END:1<<1,PARENT:1<<2,ROOT:1<<3,KEYED_HASH:1<<4,DERIVE_KEY_CONTEXT:1<<5,DERIVE_KEY_MATERIAL:1<<6},Qb=(()=>{let e=Array.from({length:16},(n,i)=>i),t=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=e;n<7;n++,i=t(i))r.push(...i);return Uint8Array.from(r)})(),Qo=class extends XS.BLAKE{constructor(t={},r=0){let n=t.dkLen===void 0?32:t.dkLen;if(super(64,n,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,(0,rc.anumber)(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){let i=(0,ar.toBytes)(t.key).slice();if(i.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,ar.u32)(i),ar.isLE||(0,ar.byteSwap32)(this.IV),this.flags=r|mi.KEYED_HASH}else if(t.context!==void 0){let i=new Qo({dkLen:32},mi.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=(0,ar.u32)(i),ar.isLE||(0,ar.byteSwap32)(this.IV),this.flags=r|mi.DERIVE_KEY_MATERIAL}else this.IV=Zn.B2S_IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,ar.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,r,n,i=0){let{state:s,pos:o}=this,{h:a,l:c}=(0,Jb.fromBig)(BigInt(t),!0),{v0:u,v1:d,v2:f,v3:b,v4:m,v5:y,v6:_,v7:E,v8:I,v9:k,v10:C,v11:U,v12:R,v13:q,v14:L,v15:K}=(0,Zn.compress)(Qb,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],Zn.B2S_IV[0],Zn.B2S_IV[1],Zn.B2S_IV[2],Zn.B2S_IV[3],a,c,o,r);s[0]=u^I,s[1]=d^k,s[2]=f^C,s[3]=b^U,s[4]=m^R,s[5]=y^q,s[6]=_^L,s[7]=E^K}compress(t,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=mi.CHUNK_START),(this.chunkPos===15||n)&&(i|=mi.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,t,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let o,a=this.chunksDone+1;(n||!(a&1))&&(o=this.stack.pop());a>>=1)this.buffer32.set(o,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|mi.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:r,flags:n,state:i,chunkPos:s,posOut:o,chunkOut:a,stack:c,chunksDone:u}=this;return t.state.set(i.slice()),t.stack=c.map(d=>Uint32Array.from(d)),t.IV.set(r),t.flags=n,t.chunkPos=s,t.chunksDone=u,t.posOut=o,t.chunkOut=a,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){let{state:t,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:o,l:a}=(0,Jb.fromBig)(BigInt(this.chunkOut++));ar.isLE||(0,ar.byteSwap32)(i);let{v0:c,v1:u,v2:d,v3:f,v4:b,v5:m,v6:y,v7:_,v8:E,v9:I,v10:k,v11:C,v12:U,v13:R,v14:q,v15:L}=(0,Zn.compress)(Qb,0,i,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],Zn.B2S_IV[0],Zn.B2S_IV[1],Zn.B2S_IV[2],Zn.B2S_IV[3],a,o,r,n);s[0]=c^E,s[1]=u^I,s[2]=d^k,s[3]=f^C,s[4]=b^U,s[5]=m^R,s[6]=y^q,s[7]=_^L,s[8]=t[0]^E,s[9]=t[1]^I,s[10]=t[2]^k,s[11]=t[3]^C,s[12]=t[4]^U,s[13]=t[5]^R,s[14]=t[6]^q,s[15]=t[7]^L,ar.isLE||((0,ar.byteSwap32)(i),(0,ar.byteSwap32)(s)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|mi.ROOT;this.stack.length?(t|=mi.PARENT,ar.isLE||(0,ar.byteSwap32)(this.buffer32),this.compress(this.buffer32,0,!0),ar.isLE||(0,ar.byteSwap32)(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:mi.CHUNK_START)|mi.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){(0,rc.aexists)(this,!1),(0,rc.abytes)(t),this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.b2CompressOut();let o=Math.min(r-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return(0,rc.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,rc.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};ea.BLAKE3=Qo;ea.blake3=(0,ar.wrapXOFConstructorWithOpts)(e=>new Qo(e))});var nc=H(Ie=>{w();S();var tg=Ie&&Ie.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),YS=Ie&&Ie.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Fr=Ie&&Ie.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&tg(t,e,r)},$S=Ie&&Ie.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&tg(t,e,r);return YS(t,e),t};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.randomBytes=Ie.concatBytes=Ie.reverseBuffer=void 0;Fr(Xp(),Ie);Fr($p(),Ie);Fr(hu(),Ie);Fr(Db(),Ie);Fr(Bd(),Ie);Fr(Do(),Ie);Fr(tc(),Ie);Fr(al(),Ie);Fr($a(),Ie);Fr(uu(),Ie);Fr(ul(),Ie);Fr(fl(),Ie);Fr(mu(),Ie);Fr(Zb(),Ie);Fr(eg(),Ie);var ZS=$S(Sr()),JS=rw();function QS(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Ie.reverseBuffer=QS;function e6(e,t){return ZS.concatBytes(Uint8Array.from(e),Uint8Array.from(t))}Ie.concatBytes=e6;function t6(e){return JS(e)}Ie.randomBytes=t6});var Jr=H((rg,dl)=>{w();S();(function(e,t){"use strict";function r(O,l){if(!O)throw new Error(l||"Assertion failed")}function n(O,l){O.super_=l;var g=function(){};g.prototype=l.prototype,O.prototype=new g,O.prototype.constructor=O}function i(O,l,g){if(i.isBN(O))return O;this.negative=0,this.words=null,this.length=0,this.red=null,O!==null&&((l==="le"||l==="be")&&(g=l,l=10),this._init(O||0,l||10,g||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=Ka().Buffer}catch{}i.isBN=function(l){return l instanceof i?!0:l!==null&&typeof l=="object"&&l.constructor.wordSize===i.wordSize&&Array.isArray(l.words)},i.max=function(l,g){return l.cmp(g)>0?l:g},i.min=function(l,g){return l.cmp(g)<0?l:g},i.prototype._init=function(l,g,v){if(typeof l=="number")return this._initNumber(l,g,v);if(typeof l=="object")return this._initArray(l,g,v);g==="hex"&&(g=16),r(g===(g|0)&&g>=2&&g<=36),l=l.toString().replace(/\s+/g,"");var P=0;l[0]==="-"&&(P++,this.negative=1),P<l.length&&(g===16?this._parseHex(l,P,v):(this._parseBase(l,g,P),v==="le"&&this._initArray(this.toArray(),g,v)))},i.prototype._initNumber=function(l,g,v){l<0&&(this.negative=1,l=-l),l<67108864?(this.words=[l&67108863],this.length=1):l<4503599627370496?(this.words=[l&67108863,l/67108864&67108863],this.length=2):(r(l<9007199254740992),this.words=[l&67108863,l/67108864&67108863,1],this.length=3),v==="le"&&this._initArray(this.toArray(),g,v)},i.prototype._initArray=function(l,g,v){if(r(typeof l.length=="number"),l.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(l.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var x,B,M=0;if(v==="be")for(P=l.length-1,x=0;P>=0;P-=3)B=l[P]|l[P-1]<<8|l[P-2]<<16,this.words[x]|=B<<M&67108863,this.words[x+1]=B>>>26-M&67108863,M+=24,M>=26&&(M-=26,x++);else if(v==="le")for(P=0,x=0;P<l.length;P+=3)B=l[P]|l[P+1]<<8|l[P+2]<<16,this.words[x]|=B<<M&67108863,this.words[x+1]=B>>>26-M&67108863,M+=24,M>=26&&(M-=26,x++);return this.strip()};function o(O,l){var g=O.charCodeAt(l);return g>=65&&g<=70?g-55:g>=97&&g<=102?g-87:g-48&15}function a(O,l,g){var v=o(O,g);return g-1>=l&&(v|=o(O,g-1)<<4),v}i.prototype._parseHex=function(l,g,v){this.length=Math.ceil((l.length-g)/6),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var x=0,B=0,M;if(v==="be")for(P=l.length-1;P>=g;P-=2)M=a(l,g,P)<<x,this.words[B]|=M&67108863,x>=18?(x-=18,B+=1,this.words[B]|=M>>>26):x+=8;else{var T=l.length-g;for(P=T%2===0?g+1:g;P<l.length;P+=2)M=a(l,g,P)<<x,this.words[B]|=M&67108863,x>=18?(x-=18,B+=1,this.words[B]|=M>>>26):x+=8}this.strip()};function c(O,l,g,v){for(var P=0,x=Math.min(O.length,g),B=l;B<x;B++){var M=O.charCodeAt(B)-48;P*=v,M>=49?P+=M-49+10:M>=17?P+=M-17+10:P+=M}return P}i.prototype._parseBase=function(l,g,v){this.words=[0],this.length=1;for(var P=0,x=1;x<=67108863;x*=g)P++;P--,x=x/g|0;for(var B=l.length-v,M=B%P,T=Math.min(B,B-M)+v,h=0,A=v;A<T;A+=P)h=c(l,A,A+P,g),this.imuln(x),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(M!==0){var j=1;for(h=c(l,A,l.length,g),A=0;A<M;A++)j*=g;this.imuln(j),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this.strip()},i.prototype.copy=function(l){l.words=new Array(this.length);for(var g=0;g<this.length;g++)l.words[g]=this.words[g];l.length=this.length,l.negative=this.negative,l.red=this.red},i.prototype.clone=function(){var l=new i(null);return this.copy(l),l},i.prototype._expand=function(l){for(;this.length<l;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(l,g){l=l||10,g=g|0||1;var v;if(l===16||l==="hex"){v="";for(var P=0,x=0,B=0;B<this.length;B++){var M=this.words[B],T=((M<<P|x)&16777215).toString(16);x=M>>>24-P&16777215,x!==0||B!==this.length-1?v=u[6-T.length]+T+v:v=T+v,P+=2,P>=26&&(P-=26,B--)}for(x!==0&&(v=x.toString(16)+v);v.length%g!==0;)v="0"+v;return this.negative!==0&&(v="-"+v),v}if(l===(l|0)&&l>=2&&l<=36){var h=d[l],A=f[l];v="";var j=this.clone();for(j.negative=0;!j.isZero();){var D=j.modn(A).toString(l);j=j.idivn(A),j.isZero()?v=D+v:v=u[h-D.length]+D+v}for(this.isZero()&&(v="0"+v);v.length%g!==0;)v="0"+v;return this.negative!==0&&(v="-"+v),v}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var l=this.words[0];return this.length===2?l+=this.words[1]*67108864:this.length===3&&this.words[2]===1?l+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-l:l},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(l,g){return r(typeof s<"u"),this.toArrayLike(s,l,g)},i.prototype.toArray=function(l,g){return this.toArrayLike(Array,l,g)},i.prototype.toArrayLike=function(l,g,v){var P=this.byteLength(),x=v||Math.max(1,P);r(P<=x,"byte array longer than desired length"),r(x>0,"Requested array length <= 0"),this.strip();var B=g==="le",M=new l(x),T,h,A=this.clone();if(B){for(h=0;!A.isZero();h++)T=A.andln(255),A.iushrn(8),M[h]=T;for(;h<x;h++)M[h]=0}else{for(h=0;h<x-P;h++)M[h]=0;for(h=0;!A.isZero();h++)T=A.andln(255),A.iushrn(8),M[x-h-1]=T}return M},Math.clz32?i.prototype._countBits=function(l){return 32-Math.clz32(l)}:i.prototype._countBits=function(l){var g=l,v=0;return g>=4096&&(v+=13,g>>>=13),g>=64&&(v+=7,g>>>=7),g>=8&&(v+=4,g>>>=4),g>=2&&(v+=2,g>>>=2),v+g},i.prototype._zeroBits=function(l){if(l===0)return 26;var g=l,v=0;return(g&8191)===0&&(v+=13,g>>>=13),(g&127)===0&&(v+=7,g>>>=7),(g&15)===0&&(v+=4,g>>>=4),(g&3)===0&&(v+=2,g>>>=2),(g&1)===0&&v++,v},i.prototype.bitLength=function(){var l=this.words[this.length-1],g=this._countBits(l);return(this.length-1)*26+g};function b(O){for(var l=new Array(O.bitLength()),g=0;g<l.length;g++){var v=g/26|0,P=g%26;l[g]=(O.words[v]&1<<P)>>>P}return l}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var l=0,g=0;g<this.length;g++){var v=this._zeroBits(this.words[g]);if(l+=v,v!==26)break}return l},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(l){return this.negative!==0?this.abs().inotn(l).iaddn(1):this.clone()},i.prototype.fromTwos=function(l){return this.testn(l-1)?this.notn(l).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(l){for(;this.length<l.length;)this.words[this.length++]=0;for(var g=0;g<l.length;g++)this.words[g]=this.words[g]|l.words[g];return this.strip()},i.prototype.ior=function(l){return r((this.negative|l.negative)===0),this.iuor(l)},i.prototype.or=function(l){return this.length>l.length?this.clone().ior(l):l.clone().ior(this)},i.prototype.uor=function(l){return this.length>l.length?this.clone().iuor(l):l.clone().iuor(this)},i.prototype.iuand=function(l){var g;this.length>l.length?g=l:g=this;for(var v=0;v<g.length;v++)this.words[v]=this.words[v]&l.words[v];return this.length=g.length,this.strip()},i.prototype.iand=function(l){return r((this.negative|l.negative)===0),this.iuand(l)},i.prototype.and=function(l){return this.length>l.length?this.clone().iand(l):l.clone().iand(this)},i.prototype.uand=function(l){return this.length>l.length?this.clone().iuand(l):l.clone().iuand(this)},i.prototype.iuxor=function(l){var g,v;this.length>l.length?(g=this,v=l):(g=l,v=this);for(var P=0;P<v.length;P++)this.words[P]=g.words[P]^v.words[P];if(this!==g)for(;P<g.length;P++)this.words[P]=g.words[P];return this.length=g.length,this.strip()},i.prototype.ixor=function(l){return r((this.negative|l.negative)===0),this.iuxor(l)},i.prototype.xor=function(l){return this.length>l.length?this.clone().ixor(l):l.clone().ixor(this)},i.prototype.uxor=function(l){return this.length>l.length?this.clone().iuxor(l):l.clone().iuxor(this)},i.prototype.inotn=function(l){r(typeof l=="number"&&l>=0);var g=Math.ceil(l/26)|0,v=l%26;this._expand(g),v>0&&g--;for(var P=0;P<g;P++)this.words[P]=~this.words[P]&67108863;return v>0&&(this.words[P]=~this.words[P]&67108863>>26-v),this.strip()},i.prototype.notn=function(l){return this.clone().inotn(l)},i.prototype.setn=function(l,g){r(typeof l=="number"&&l>=0);var v=l/26|0,P=l%26;return this._expand(v+1),g?this.words[v]=this.words[v]|1<<P:this.words[v]=this.words[v]&~(1<<P),this.strip()},i.prototype.iadd=function(l){var g;if(this.negative!==0&&l.negative===0)return this.negative=0,g=this.isub(l),this.negative^=1,this._normSign();if(this.negative===0&&l.negative!==0)return l.negative=0,g=this.isub(l),l.negative=1,g._normSign();var v,P;this.length>l.length?(v=this,P=l):(v=l,P=this);for(var x=0,B=0;B<P.length;B++)g=(v.words[B]|0)+(P.words[B]|0)+x,this.words[B]=g&67108863,x=g>>>26;for(;x!==0&&B<v.length;B++)g=(v.words[B]|0)+x,this.words[B]=g&67108863,x=g>>>26;if(this.length=v.length,x!==0)this.words[this.length]=x,this.length++;else if(v!==this)for(;B<v.length;B++)this.words[B]=v.words[B];return this},i.prototype.add=function(l){var g;return l.negative!==0&&this.negative===0?(l.negative=0,g=this.sub(l),l.negative^=1,g):l.negative===0&&this.negative!==0?(this.negative=0,g=l.sub(this),this.negative=1,g):this.length>l.length?this.clone().iadd(l):l.clone().iadd(this)},i.prototype.isub=function(l){if(l.negative!==0){l.negative=0;var g=this.iadd(l);return l.negative=1,g._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(l),this.negative=1,this._normSign();var v=this.cmp(l);if(v===0)return this.negative=0,this.length=1,this.words[0]=0,this;var P,x;v>0?(P=this,x=l):(P=l,x=this);for(var B=0,M=0;M<x.length;M++)g=(P.words[M]|0)-(x.words[M]|0)+B,B=g>>26,this.words[M]=g&67108863;for(;B!==0&&M<P.length;M++)g=(P.words[M]|0)+B,B=g>>26,this.words[M]=g&67108863;if(B===0&&M<P.length&&P!==this)for(;M<P.length;M++)this.words[M]=P.words[M];return this.length=Math.max(this.length,M),P!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(l){return this.clone().isub(l)};function m(O,l,g){g.negative=l.negative^O.negative;var v=O.length+l.length|0;g.length=v,v=v-1|0;var P=O.words[0]|0,x=l.words[0]|0,B=P*x,M=B&67108863,T=B/67108864|0;g.words[0]=M;for(var h=1;h<v;h++){for(var A=T>>>26,j=T&67108863,D=Math.min(h,l.length-1),G=Math.max(0,h-O.length+1);G<=D;G++){var J=h-G|0;P=O.words[J]|0,x=l.words[G]|0,B=P*x+j,A+=B/67108864|0,j=B&67108863}g.words[h]=j|0,T=A|0}return T!==0?g.words[h]=T|0:g.length--,g.strip()}var y=function(l,g,v){var P=l.words,x=g.words,B=v.words,M=0,T,h,A,j=P[0]|0,D=j&8191,G=j>>>13,J=P[1]|0,ue=J&8191,Se=J>>>13,vr=P[2]|0,Oe=vr&8191,xe=vr>>>13,Ri=P[3]|0,tt=Ri&8191,Ee=Ri>>>13,Ui=P[4]|0,De=Ui&8191,rt=Ui>>>13,La=P[5]|0,pt=La&8191,bt=La>>>13,C0=P[6]|0,gt=C0&8191,yt=C0>>>13,k0=P[7]|0,mt=k0&8191,_t=k0>>>13,H0=P[8]|0,vt=H0&8191,wt=H0>>>13,N0=P[9]|0,St=N0&8191,xt=N0>>>13,R0=x[0]|0,Pt=R0&8191,Tt=R0>>>13,U0=x[1]|0,Et=U0&8191,At=U0>>>13,q0=x[2]|0,It=q0&8191,Ot=q0>>>13,L0=x[3]|0,Bt=L0&8191,Mt=L0>>>13,K0=x[4]|0,Ct=K0&8191,kt=K0>>>13,D0=x[5]|0,Ht=D0&8191,Nt=D0>>>13,j0=x[6]|0,Rt=j0&8191,Ut=j0>>>13,F0=x[7]|0,qt=F0&8191,Lt=F0>>>13,G0=x[8]|0,Kt=G0&8191,Dt=G0>>>13,V0=x[9]|0,jt=V0&8191,Ft=V0>>>13;v.negative=l.negative^g.negative,v.length=19,T=Math.imul(D,Pt),h=Math.imul(D,Tt),h=h+Math.imul(G,Pt)|0,A=Math.imul(G,Tt);var fd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(fd>>>26)|0,fd&=67108863,T=Math.imul(ue,Pt),h=Math.imul(ue,Tt),h=h+Math.imul(Se,Pt)|0,A=Math.imul(Se,Tt),T=T+Math.imul(D,Et)|0,h=h+Math.imul(D,At)|0,h=h+Math.imul(G,Et)|0,A=A+Math.imul(G,At)|0;var dd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(dd>>>26)|0,dd&=67108863,T=Math.imul(Oe,Pt),h=Math.imul(Oe,Tt),h=h+Math.imul(xe,Pt)|0,A=Math.imul(xe,Tt),T=T+Math.imul(ue,Et)|0,h=h+Math.imul(ue,At)|0,h=h+Math.imul(Se,Et)|0,A=A+Math.imul(Se,At)|0,T=T+Math.imul(D,It)|0,h=h+Math.imul(D,Ot)|0,h=h+Math.imul(G,It)|0,A=A+Math.imul(G,Ot)|0;var ld=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(ld>>>26)|0,ld&=67108863,T=Math.imul(tt,Pt),h=Math.imul(tt,Tt),h=h+Math.imul(Ee,Pt)|0,A=Math.imul(Ee,Tt),T=T+Math.imul(Oe,Et)|0,h=h+Math.imul(Oe,At)|0,h=h+Math.imul(xe,Et)|0,A=A+Math.imul(xe,At)|0,T=T+Math.imul(ue,It)|0,h=h+Math.imul(ue,Ot)|0,h=h+Math.imul(Se,It)|0,A=A+Math.imul(Se,Ot)|0,T=T+Math.imul(D,Bt)|0,h=h+Math.imul(D,Mt)|0,h=h+Math.imul(G,Bt)|0,A=A+Math.imul(G,Mt)|0;var hd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(hd>>>26)|0,hd&=67108863,T=Math.imul(De,Pt),h=Math.imul(De,Tt),h=h+Math.imul(rt,Pt)|0,A=Math.imul(rt,Tt),T=T+Math.imul(tt,Et)|0,h=h+Math.imul(tt,At)|0,h=h+Math.imul(Ee,Et)|0,A=A+Math.imul(Ee,At)|0,T=T+Math.imul(Oe,It)|0,h=h+Math.imul(Oe,Ot)|0,h=h+Math.imul(xe,It)|0,A=A+Math.imul(xe,Ot)|0,T=T+Math.imul(ue,Bt)|0,h=h+Math.imul(ue,Mt)|0,h=h+Math.imul(Se,Bt)|0,A=A+Math.imul(Se,Mt)|0,T=T+Math.imul(D,Ct)|0,h=h+Math.imul(D,kt)|0,h=h+Math.imul(G,Ct)|0,A=A+Math.imul(G,kt)|0;var pd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(pd>>>26)|0,pd&=67108863,T=Math.imul(pt,Pt),h=Math.imul(pt,Tt),h=h+Math.imul(bt,Pt)|0,A=Math.imul(bt,Tt),T=T+Math.imul(De,Et)|0,h=h+Math.imul(De,At)|0,h=h+Math.imul(rt,Et)|0,A=A+Math.imul(rt,At)|0,T=T+Math.imul(tt,It)|0,h=h+Math.imul(tt,Ot)|0,h=h+Math.imul(Ee,It)|0,A=A+Math.imul(Ee,Ot)|0,T=T+Math.imul(Oe,Bt)|0,h=h+Math.imul(Oe,Mt)|0,h=h+Math.imul(xe,Bt)|0,A=A+Math.imul(xe,Mt)|0,T=T+Math.imul(ue,Ct)|0,h=h+Math.imul(ue,kt)|0,h=h+Math.imul(Se,Ct)|0,A=A+Math.imul(Se,kt)|0,T=T+Math.imul(D,Ht)|0,h=h+Math.imul(D,Nt)|0,h=h+Math.imul(G,Ht)|0,A=A+Math.imul(G,Nt)|0;var bd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(bd>>>26)|0,bd&=67108863,T=Math.imul(gt,Pt),h=Math.imul(gt,Tt),h=h+Math.imul(yt,Pt)|0,A=Math.imul(yt,Tt),T=T+Math.imul(pt,Et)|0,h=h+Math.imul(pt,At)|0,h=h+Math.imul(bt,Et)|0,A=A+Math.imul(bt,At)|0,T=T+Math.imul(De,It)|0,h=h+Math.imul(De,Ot)|0,h=h+Math.imul(rt,It)|0,A=A+Math.imul(rt,Ot)|0,T=T+Math.imul(tt,Bt)|0,h=h+Math.imul(tt,Mt)|0,h=h+Math.imul(Ee,Bt)|0,A=A+Math.imul(Ee,Mt)|0,T=T+Math.imul(Oe,Ct)|0,h=h+Math.imul(Oe,kt)|0,h=h+Math.imul(xe,Ct)|0,A=A+Math.imul(xe,kt)|0,T=T+Math.imul(ue,Ht)|0,h=h+Math.imul(ue,Nt)|0,h=h+Math.imul(Se,Ht)|0,A=A+Math.imul(Se,Nt)|0,T=T+Math.imul(D,Rt)|0,h=h+Math.imul(D,Ut)|0,h=h+Math.imul(G,Rt)|0,A=A+Math.imul(G,Ut)|0;var gd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(gd>>>26)|0,gd&=67108863,T=Math.imul(mt,Pt),h=Math.imul(mt,Tt),h=h+Math.imul(_t,Pt)|0,A=Math.imul(_t,Tt),T=T+Math.imul(gt,Et)|0,h=h+Math.imul(gt,At)|0,h=h+Math.imul(yt,Et)|0,A=A+Math.imul(yt,At)|0,T=T+Math.imul(pt,It)|0,h=h+Math.imul(pt,Ot)|0,h=h+Math.imul(bt,It)|0,A=A+Math.imul(bt,Ot)|0,T=T+Math.imul(De,Bt)|0,h=h+Math.imul(De,Mt)|0,h=h+Math.imul(rt,Bt)|0,A=A+Math.imul(rt,Mt)|0,T=T+Math.imul(tt,Ct)|0,h=h+Math.imul(tt,kt)|0,h=h+Math.imul(Ee,Ct)|0,A=A+Math.imul(Ee,kt)|0,T=T+Math.imul(Oe,Ht)|0,h=h+Math.imul(Oe,Nt)|0,h=h+Math.imul(xe,Ht)|0,A=A+Math.imul(xe,Nt)|0,T=T+Math.imul(ue,Rt)|0,h=h+Math.imul(ue,Ut)|0,h=h+Math.imul(Se,Rt)|0,A=A+Math.imul(Se,Ut)|0,T=T+Math.imul(D,qt)|0,h=h+Math.imul(D,Lt)|0,h=h+Math.imul(G,qt)|0,A=A+Math.imul(G,Lt)|0;var yd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(yd>>>26)|0,yd&=67108863,T=Math.imul(vt,Pt),h=Math.imul(vt,Tt),h=h+Math.imul(wt,Pt)|0,A=Math.imul(wt,Tt),T=T+Math.imul(mt,Et)|0,h=h+Math.imul(mt,At)|0,h=h+Math.imul(_t,Et)|0,A=A+Math.imul(_t,At)|0,T=T+Math.imul(gt,It)|0,h=h+Math.imul(gt,Ot)|0,h=h+Math.imul(yt,It)|0,A=A+Math.imul(yt,Ot)|0,T=T+Math.imul(pt,Bt)|0,h=h+Math.imul(pt,Mt)|0,h=h+Math.imul(bt,Bt)|0,A=A+Math.imul(bt,Mt)|0,T=T+Math.imul(De,Ct)|0,h=h+Math.imul(De,kt)|0,h=h+Math.imul(rt,Ct)|0,A=A+Math.imul(rt,kt)|0,T=T+Math.imul(tt,Ht)|0,h=h+Math.imul(tt,Nt)|0,h=h+Math.imul(Ee,Ht)|0,A=A+Math.imul(Ee,Nt)|0,T=T+Math.imul(Oe,Rt)|0,h=h+Math.imul(Oe,Ut)|0,h=h+Math.imul(xe,Rt)|0,A=A+Math.imul(xe,Ut)|0,T=T+Math.imul(ue,qt)|0,h=h+Math.imul(ue,Lt)|0,h=h+Math.imul(Se,qt)|0,A=A+Math.imul(Se,Lt)|0,T=T+Math.imul(D,Kt)|0,h=h+Math.imul(D,Dt)|0,h=h+Math.imul(G,Kt)|0,A=A+Math.imul(G,Dt)|0;var md=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(md>>>26)|0,md&=67108863,T=Math.imul(St,Pt),h=Math.imul(St,Tt),h=h+Math.imul(xt,Pt)|0,A=Math.imul(xt,Tt),T=T+Math.imul(vt,Et)|0,h=h+Math.imul(vt,At)|0,h=h+Math.imul(wt,Et)|0,A=A+Math.imul(wt,At)|0,T=T+Math.imul(mt,It)|0,h=h+Math.imul(mt,Ot)|0,h=h+Math.imul(_t,It)|0,A=A+Math.imul(_t,Ot)|0,T=T+Math.imul(gt,Bt)|0,h=h+Math.imul(gt,Mt)|0,h=h+Math.imul(yt,Bt)|0,A=A+Math.imul(yt,Mt)|0,T=T+Math.imul(pt,Ct)|0,h=h+Math.imul(pt,kt)|0,h=h+Math.imul(bt,Ct)|0,A=A+Math.imul(bt,kt)|0,T=T+Math.imul(De,Ht)|0,h=h+Math.imul(De,Nt)|0,h=h+Math.imul(rt,Ht)|0,A=A+Math.imul(rt,Nt)|0,T=T+Math.imul(tt,Rt)|0,h=h+Math.imul(tt,Ut)|0,h=h+Math.imul(Ee,Rt)|0,A=A+Math.imul(Ee,Ut)|0,T=T+Math.imul(Oe,qt)|0,h=h+Math.imul(Oe,Lt)|0,h=h+Math.imul(xe,qt)|0,A=A+Math.imul(xe,Lt)|0,T=T+Math.imul(ue,Kt)|0,h=h+Math.imul(ue,Dt)|0,h=h+Math.imul(Se,Kt)|0,A=A+Math.imul(Se,Dt)|0,T=T+Math.imul(D,jt)|0,h=h+Math.imul(D,Ft)|0,h=h+Math.imul(G,jt)|0,A=A+Math.imul(G,Ft)|0;var _d=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(_d>>>26)|0,_d&=67108863,T=Math.imul(St,Et),h=Math.imul(St,At),h=h+Math.imul(xt,Et)|0,A=Math.imul(xt,At),T=T+Math.imul(vt,It)|0,h=h+Math.imul(vt,Ot)|0,h=h+Math.imul(wt,It)|0,A=A+Math.imul(wt,Ot)|0,T=T+Math.imul(mt,Bt)|0,h=h+Math.imul(mt,Mt)|0,h=h+Math.imul(_t,Bt)|0,A=A+Math.imul(_t,Mt)|0,T=T+Math.imul(gt,Ct)|0,h=h+Math.imul(gt,kt)|0,h=h+Math.imul(yt,Ct)|0,A=A+Math.imul(yt,kt)|0,T=T+Math.imul(pt,Ht)|0,h=h+Math.imul(pt,Nt)|0,h=h+Math.imul(bt,Ht)|0,A=A+Math.imul(bt,Nt)|0,T=T+Math.imul(De,Rt)|0,h=h+Math.imul(De,Ut)|0,h=h+Math.imul(rt,Rt)|0,A=A+Math.imul(rt,Ut)|0,T=T+Math.imul(tt,qt)|0,h=h+Math.imul(tt,Lt)|0,h=h+Math.imul(Ee,qt)|0,A=A+Math.imul(Ee,Lt)|0,T=T+Math.imul(Oe,Kt)|0,h=h+Math.imul(Oe,Dt)|0,h=h+Math.imul(xe,Kt)|0,A=A+Math.imul(xe,Dt)|0,T=T+Math.imul(ue,jt)|0,h=h+Math.imul(ue,Ft)|0,h=h+Math.imul(Se,jt)|0,A=A+Math.imul(Se,Ft)|0;var vd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(vd>>>26)|0,vd&=67108863,T=Math.imul(St,It),h=Math.imul(St,Ot),h=h+Math.imul(xt,It)|0,A=Math.imul(xt,Ot),T=T+Math.imul(vt,Bt)|0,h=h+Math.imul(vt,Mt)|0,h=h+Math.imul(wt,Bt)|0,A=A+Math.imul(wt,Mt)|0,T=T+Math.imul(mt,Ct)|0,h=h+Math.imul(mt,kt)|0,h=h+Math.imul(_t,Ct)|0,A=A+Math.imul(_t,kt)|0,T=T+Math.imul(gt,Ht)|0,h=h+Math.imul(gt,Nt)|0,h=h+Math.imul(yt,Ht)|0,A=A+Math.imul(yt,Nt)|0,T=T+Math.imul(pt,Rt)|0,h=h+Math.imul(pt,Ut)|0,h=h+Math.imul(bt,Rt)|0,A=A+Math.imul(bt,Ut)|0,T=T+Math.imul(De,qt)|0,h=h+Math.imul(De,Lt)|0,h=h+Math.imul(rt,qt)|0,A=A+Math.imul(rt,Lt)|0,T=T+Math.imul(tt,Kt)|0,h=h+Math.imul(tt,Dt)|0,h=h+Math.imul(Ee,Kt)|0,A=A+Math.imul(Ee,Dt)|0,T=T+Math.imul(Oe,jt)|0,h=h+Math.imul(Oe,Ft)|0,h=h+Math.imul(xe,jt)|0,A=A+Math.imul(xe,Ft)|0;var wd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(wd>>>26)|0,wd&=67108863,T=Math.imul(St,Bt),h=Math.imul(St,Mt),h=h+Math.imul(xt,Bt)|0,A=Math.imul(xt,Mt),T=T+Math.imul(vt,Ct)|0,h=h+Math.imul(vt,kt)|0,h=h+Math.imul(wt,Ct)|0,A=A+Math.imul(wt,kt)|0,T=T+Math.imul(mt,Ht)|0,h=h+Math.imul(mt,Nt)|0,h=h+Math.imul(_t,Ht)|0,A=A+Math.imul(_t,Nt)|0,T=T+Math.imul(gt,Rt)|0,h=h+Math.imul(gt,Ut)|0,h=h+Math.imul(yt,Rt)|0,A=A+Math.imul(yt,Ut)|0,T=T+Math.imul(pt,qt)|0,h=h+Math.imul(pt,Lt)|0,h=h+Math.imul(bt,qt)|0,A=A+Math.imul(bt,Lt)|0,T=T+Math.imul(De,Kt)|0,h=h+Math.imul(De,Dt)|0,h=h+Math.imul(rt,Kt)|0,A=A+Math.imul(rt,Dt)|0,T=T+Math.imul(tt,jt)|0,h=h+Math.imul(tt,Ft)|0,h=h+Math.imul(Ee,jt)|0,A=A+Math.imul(Ee,Ft)|0;var Sd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Sd>>>26)|0,Sd&=67108863,T=Math.imul(St,Ct),h=Math.imul(St,kt),h=h+Math.imul(xt,Ct)|0,A=Math.imul(xt,kt),T=T+Math.imul(vt,Ht)|0,h=h+Math.imul(vt,Nt)|0,h=h+Math.imul(wt,Ht)|0,A=A+Math.imul(wt,Nt)|0,T=T+Math.imul(mt,Rt)|0,h=h+Math.imul(mt,Ut)|0,h=h+Math.imul(_t,Rt)|0,A=A+Math.imul(_t,Ut)|0,T=T+Math.imul(gt,qt)|0,h=h+Math.imul(gt,Lt)|0,h=h+Math.imul(yt,qt)|0,A=A+Math.imul(yt,Lt)|0,T=T+Math.imul(pt,Kt)|0,h=h+Math.imul(pt,Dt)|0,h=h+Math.imul(bt,Kt)|0,A=A+Math.imul(bt,Dt)|0,T=T+Math.imul(De,jt)|0,h=h+Math.imul(De,Ft)|0,h=h+Math.imul(rt,jt)|0,A=A+Math.imul(rt,Ft)|0;var xd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(xd>>>26)|0,xd&=67108863,T=Math.imul(St,Ht),h=Math.imul(St,Nt),h=h+Math.imul(xt,Ht)|0,A=Math.imul(xt,Nt),T=T+Math.imul(vt,Rt)|0,h=h+Math.imul(vt,Ut)|0,h=h+Math.imul(wt,Rt)|0,A=A+Math.imul(wt,Ut)|0,T=T+Math.imul(mt,qt)|0,h=h+Math.imul(mt,Lt)|0,h=h+Math.imul(_t,qt)|0,A=A+Math.imul(_t,Lt)|0,T=T+Math.imul(gt,Kt)|0,h=h+Math.imul(gt,Dt)|0,h=h+Math.imul(yt,Kt)|0,A=A+Math.imul(yt,Dt)|0,T=T+Math.imul(pt,jt)|0,h=h+Math.imul(pt,Ft)|0,h=h+Math.imul(bt,jt)|0,A=A+Math.imul(bt,Ft)|0;var Pd=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Pd>>>26)|0,Pd&=67108863,T=Math.imul(St,Rt),h=Math.imul(St,Ut),h=h+Math.imul(xt,Rt)|0,A=Math.imul(xt,Ut),T=T+Math.imul(vt,qt)|0,h=h+Math.imul(vt,Lt)|0,h=h+Math.imul(wt,qt)|0,A=A+Math.imul(wt,Lt)|0,T=T+Math.imul(mt,Kt)|0,h=h+Math.imul(mt,Dt)|0,h=h+Math.imul(_t,Kt)|0,A=A+Math.imul(_t,Dt)|0,T=T+Math.imul(gt,jt)|0,h=h+Math.imul(gt,Ft)|0,h=h+Math.imul(yt,jt)|0,A=A+Math.imul(yt,Ft)|0;var Td=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Td>>>26)|0,Td&=67108863,T=Math.imul(St,qt),h=Math.imul(St,Lt),h=h+Math.imul(xt,qt)|0,A=Math.imul(xt,Lt),T=T+Math.imul(vt,Kt)|0,h=h+Math.imul(vt,Dt)|0,h=h+Math.imul(wt,Kt)|0,A=A+Math.imul(wt,Dt)|0,T=T+Math.imul(mt,jt)|0,h=h+Math.imul(mt,Ft)|0,h=h+Math.imul(_t,jt)|0,A=A+Math.imul(_t,Ft)|0;var Ed=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Ed>>>26)|0,Ed&=67108863,T=Math.imul(St,Kt),h=Math.imul(St,Dt),h=h+Math.imul(xt,Kt)|0,A=Math.imul(xt,Dt),T=T+Math.imul(vt,jt)|0,h=h+Math.imul(vt,Ft)|0,h=h+Math.imul(wt,jt)|0,A=A+Math.imul(wt,Ft)|0;var Ad=(M+T|0)+((h&8191)<<13)|0;M=(A+(h>>>13)|0)+(Ad>>>26)|0,Ad&=67108863,T=Math.imul(St,jt),h=Math.imul(St,Ft),h=h+Math.imul(xt,jt)|0,A=Math.imul(xt,Ft);var Id=(M+T|0)+((h&8191)<<13)|0;return M=(A+(h>>>13)|0)+(Id>>>26)|0,Id&=67108863,B[0]=fd,B[1]=dd,B[2]=ld,B[3]=hd,B[4]=pd,B[5]=bd,B[6]=gd,B[7]=yd,B[8]=md,B[9]=_d,B[10]=vd,B[11]=wd,B[12]=Sd,B[13]=xd,B[14]=Pd,B[15]=Td,B[16]=Ed,B[17]=Ad,B[18]=Id,M!==0&&(B[19]=M,v.length++),v};Math.imul||(y=m);function _(O,l,g){g.negative=l.negative^O.negative,g.length=O.length+l.length;for(var v=0,P=0,x=0;x<g.length-1;x++){var B=P;P=0;for(var M=v&67108863,T=Math.min(x,l.length-1),h=Math.max(0,x-O.length+1);h<=T;h++){var A=x-h,j=O.words[A]|0,D=l.words[h]|0,G=j*D,J=G&67108863;B=B+(G/67108864|0)|0,J=J+M|0,M=J&67108863,B=B+(J>>>26)|0,P+=B>>>26,B&=67108863}g.words[x]=M,v=B,B=P}return v!==0?g.words[x]=v:g.length--,g.strip()}function E(O,l,g){var v=new I;return v.mulp(O,l,g)}i.prototype.mulTo=function(l,g){var v,P=this.length+l.length;return this.length===10&&l.length===10?v=y(this,l,g):P<63?v=m(this,l,g):P<1024?v=_(this,l,g):v=E(this,l,g),v};function I(O,l){this.x=O,this.y=l}I.prototype.makeRBT=function(l){for(var g=new Array(l),v=i.prototype._countBits(l)-1,P=0;P<l;P++)g[P]=this.revBin(P,v,l);return g},I.prototype.revBin=function(l,g,v){if(l===0||l===v-1)return l;for(var P=0,x=0;x<g;x++)P|=(l&1)<<g-x-1,l>>=1;return P},I.prototype.permute=function(l,g,v,P,x,B){for(var M=0;M<B;M++)P[M]=g[l[M]],x[M]=v[l[M]]},I.prototype.transform=function(l,g,v,P,x,B){this.permute(B,l,g,v,P,x);for(var M=1;M<x;M<<=1)for(var T=M<<1,h=Math.cos(2*Math.PI/T),A=Math.sin(2*Math.PI/T),j=0;j<x;j+=T)for(var D=h,G=A,J=0;J<M;J++){var ue=v[j+J],Se=P[j+J],vr=v[j+J+M],Oe=P[j+J+M],xe=D*vr-G*Oe;Oe=D*Oe+G*vr,vr=xe,v[j+J]=ue+vr,P[j+J]=Se+Oe,v[j+J+M]=ue-vr,P[j+J+M]=Se-Oe,J!==T&&(xe=h*D-A*G,G=h*G+A*D,D=xe)}},I.prototype.guessLen13b=function(l,g){var v=Math.max(g,l)|1,P=v&1,x=0;for(v=v/2|0;v;v=v>>>1)x++;return 1<<x+1+P},I.prototype.conjugate=function(l,g,v){if(!(v<=1))for(var P=0;P<v/2;P++){var x=l[P];l[P]=l[v-P-1],l[v-P-1]=x,x=g[P],g[P]=-g[v-P-1],g[v-P-1]=-x}},I.prototype.normalize13b=function(l,g){for(var v=0,P=0;P<g/2;P++){var x=Math.round(l[2*P+1]/g)*8192+Math.round(l[2*P]/g)+v;l[P]=x&67108863,x<67108864?v=0:v=x/67108864|0}return l},I.prototype.convert13b=function(l,g,v,P){for(var x=0,B=0;B<g;B++)x=x+(l[B]|0),v[2*B]=x&8191,x=x>>>13,v[2*B+1]=x&8191,x=x>>>13;for(B=2*g;B<P;++B)v[B]=0;r(x===0),r((x&-8192)===0)},I.prototype.stub=function(l){for(var g=new Array(l),v=0;v<l;v++)g[v]=0;return g},I.prototype.mulp=function(l,g,v){var P=2*this.guessLen13b(l.length,g.length),x=this.makeRBT(P),B=this.stub(P),M=new Array(P),T=new Array(P),h=new Array(P),A=new Array(P),j=new Array(P),D=new Array(P),G=v.words;G.length=P,this.convert13b(l.words,l.length,M,P),this.convert13b(g.words,g.length,A,P),this.transform(M,B,T,h,P,x),this.transform(A,B,j,D,P,x);for(var J=0;J<P;J++){var ue=T[J]*j[J]-h[J]*D[J];h[J]=T[J]*D[J]+h[J]*j[J],T[J]=ue}return this.conjugate(T,h,P),this.transform(T,h,G,B,P,x),this.conjugate(G,B,P),this.normalize13b(G,P),v.negative=l.negative^g.negative,v.length=l.length+g.length,v.strip()},i.prototype.mul=function(l){var g=new i(null);return g.words=new Array(this.length+l.length),this.mulTo(l,g)},i.prototype.mulf=function(l){var g=new i(null);return g.words=new Array(this.length+l.length),E(this,l,g)},i.prototype.imul=function(l){return this.clone().mulTo(l,this)},i.prototype.imuln=function(l){r(typeof l=="number"),r(l<67108864);for(var g=0,v=0;v<this.length;v++){var P=(this.words[v]|0)*l,x=(P&67108863)+(g&67108863);g>>=26,g+=P/67108864|0,g+=x>>>26,this.words[v]=x&67108863}return g!==0&&(this.words[v]=g,this.length++),this},i.prototype.muln=function(l){return this.clone().imuln(l)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(l){var g=b(l);if(g.length===0)return new i(1);for(var v=this,P=0;P<g.length&&g[P]===0;P++,v=v.sqr());if(++P<g.length)for(var x=v.sqr();P<g.length;P++,x=x.sqr())g[P]!==0&&(v=v.mul(x));return v},i.prototype.iushln=function(l){r(typeof l=="number"&&l>=0);var g=l%26,v=(l-g)/26,P=67108863>>>26-g<<26-g,x;if(g!==0){var B=0;for(x=0;x<this.length;x++){var M=this.words[x]&P,T=(this.words[x]|0)-M<<g;this.words[x]=T|B,B=M>>>26-g}B&&(this.words[x]=B,this.length++)}if(v!==0){for(x=this.length-1;x>=0;x--)this.words[x+v]=this.words[x];for(x=0;x<v;x++)this.words[x]=0;this.length+=v}return this.strip()},i.prototype.ishln=function(l){return r(this.negative===0),this.iushln(l)},i.prototype.iushrn=function(l,g,v){r(typeof l=="number"&&l>=0);var P;g?P=(g-g%26)/26:P=0;var x=l%26,B=Math.min((l-x)/26,this.length),M=67108863^67108863>>>x<<x,T=v;if(P-=B,P=Math.max(0,P),T){for(var h=0;h<B;h++)T.words[h]=this.words[h];T.length=B}if(B!==0)if(this.length>B)for(this.length-=B,h=0;h<this.length;h++)this.words[h]=this.words[h+B];else this.words[0]=0,this.length=1;var A=0;for(h=this.length-1;h>=0&&(A!==0||h>=P);h--){var j=this.words[h]|0;this.words[h]=A<<26-x|j>>>x,A=j&M}return T&&A!==0&&(T.words[T.length++]=A),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(l,g,v){return r(this.negative===0),this.iushrn(l,g,v)},i.prototype.shln=function(l){return this.clone().ishln(l)},i.prototype.ushln=function(l){return this.clone().iushln(l)},i.prototype.shrn=function(l){return this.clone().ishrn(l)},i.prototype.ushrn=function(l){return this.clone().iushrn(l)},i.prototype.testn=function(l){r(typeof l=="number"&&l>=0);var g=l%26,v=(l-g)/26,P=1<<g;if(this.length<=v)return!1;var x=this.words[v];return!!(x&P)},i.prototype.imaskn=function(l){r(typeof l=="number"&&l>=0);var g=l%26,v=(l-g)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=v)return this;if(g!==0&&v++,this.length=Math.min(v,this.length),g!==0){var P=67108863^67108863>>>g<<g;this.words[this.length-1]&=P}return this.strip()},i.prototype.maskn=function(l){return this.clone().imaskn(l)},i.prototype.iaddn=function(l){return r(typeof l=="number"),r(l<67108864),l<0?this.isubn(-l):this.negative!==0?this.length===1&&(this.words[0]|0)<l?(this.words[0]=l-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(l),this.negative=1,this):this._iaddn(l)},i.prototype._iaddn=function(l){this.words[0]+=l;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},i.prototype.isubn=function(l){if(r(typeof l=="number"),r(l<67108864),l<0)return this.iaddn(-l);if(this.negative!==0)return this.negative=0,this.iaddn(l),this.negative=1,this;if(this.words[0]-=l,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this.strip()},i.prototype.addn=function(l){return this.clone().iaddn(l)},i.prototype.subn=function(l){return this.clone().isubn(l)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(l,g,v){var P=l.length+v,x;this._expand(P);var B,M=0;for(x=0;x<l.length;x++){B=(this.words[x+v]|0)+M;var T=(l.words[x]|0)*g;B-=T&67108863,M=(B>>26)-(T/67108864|0),this.words[x+v]=B&67108863}for(;x<this.length-v;x++)B=(this.words[x+v]|0)+M,M=B>>26,this.words[x+v]=B&67108863;if(M===0)return this.strip();for(r(M===-1),M=0,x=0;x<this.length;x++)B=-(this.words[x]|0)+M,M=B>>26,this.words[x]=B&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(l,g){var v=this.length-l.length,P=this.clone(),x=l,B=x.words[x.length-1]|0,M=this._countBits(B);v=26-M,v!==0&&(x=x.ushln(v),P.iushln(v),B=x.words[x.length-1]|0);var T=P.length-x.length,h;if(g!=="mod"){h=new i(null),h.length=T+1,h.words=new Array(h.length);for(var A=0;A<h.length;A++)h.words[A]=0}var j=P.clone()._ishlnsubmul(x,1,T);j.negative===0&&(P=j,h&&(h.words[T]=1));for(var D=T-1;D>=0;D--){var G=(P.words[x.length+D]|0)*67108864+(P.words[x.length+D-1]|0);for(G=Math.min(G/B|0,67108863),P._ishlnsubmul(x,G,D);P.negative!==0;)G--,P.negative=0,P._ishlnsubmul(x,1,D),P.isZero()||(P.negative^=1);h&&(h.words[D]=G)}return h&&h.strip(),P.strip(),g!=="div"&&v!==0&&P.iushrn(v),{div:h||null,mod:P}},i.prototype.divmod=function(l,g,v){if(r(!l.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var P,x,B;return this.negative!==0&&l.negative===0?(B=this.neg().divmod(l,g),g!=="mod"&&(P=B.div.neg()),g!=="div"&&(x=B.mod.neg(),v&&x.negative!==0&&x.iadd(l)),{div:P,mod:x}):this.negative===0&&l.negative!==0?(B=this.divmod(l.neg(),g),g!=="mod"&&(P=B.div.neg()),{div:P,mod:B.mod}):(this.negative&l.negative)!==0?(B=this.neg().divmod(l.neg(),g),g!=="div"&&(x=B.mod.neg(),v&&x.negative!==0&&x.isub(l)),{div:B.div,mod:x}):l.length>this.length||this.cmp(l)<0?{div:new i(0),mod:this}:l.length===1?g==="div"?{div:this.divn(l.words[0]),mod:null}:g==="mod"?{div:null,mod:new i(this.modn(l.words[0]))}:{div:this.divn(l.words[0]),mod:new i(this.modn(l.words[0]))}:this._wordDiv(l,g)},i.prototype.div=function(l){return this.divmod(l,"div",!1).div},i.prototype.mod=function(l){return this.divmod(l,"mod",!1).mod},i.prototype.umod=function(l){return this.divmod(l,"mod",!0).mod},i.prototype.divRound=function(l){var g=this.divmod(l);if(g.mod.isZero())return g.div;var v=g.div.negative!==0?g.mod.isub(l):g.mod,P=l.ushrn(1),x=l.andln(1),B=v.cmp(P);return B<0||x===1&&B===0?g.div:g.div.negative!==0?g.div.isubn(1):g.div.iaddn(1)},i.prototype.modn=function(l){r(l<=67108863);for(var g=(1<<26)%l,v=0,P=this.length-1;P>=0;P--)v=(g*v+(this.words[P]|0))%l;return v},i.prototype.idivn=function(l){r(l<=67108863);for(var g=0,v=this.length-1;v>=0;v--){var P=(this.words[v]|0)+g*67108864;this.words[v]=P/l|0,g=P%l}return this.strip()},i.prototype.divn=function(l){return this.clone().idivn(l)},i.prototype.egcd=function(l){r(l.negative===0),r(!l.isZero());var g=this,v=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var P=new i(1),x=new i(0),B=new i(0),M=new i(1),T=0;g.isEven()&&v.isEven();)g.iushrn(1),v.iushrn(1),++T;for(var h=v.clone(),A=g.clone();!g.isZero();){for(var j=0,D=1;(g.words[0]&D)===0&&j<26;++j,D<<=1);if(j>0)for(g.iushrn(j);j-- >0;)(P.isOdd()||x.isOdd())&&(P.iadd(h),x.isub(A)),P.iushrn(1),x.iushrn(1);for(var G=0,J=1;(v.words[0]&J)===0&&G<26;++G,J<<=1);if(G>0)for(v.iushrn(G);G-- >0;)(B.isOdd()||M.isOdd())&&(B.iadd(h),M.isub(A)),B.iushrn(1),M.iushrn(1);g.cmp(v)>=0?(g.isub(v),P.isub(B),x.isub(M)):(v.isub(g),B.isub(P),M.isub(x))}return{a:B,b:M,gcd:v.iushln(T)}},i.prototype._invmp=function(l){r(l.negative===0),r(!l.isZero());var g=this,v=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var P=new i(1),x=new i(0),B=v.clone();g.cmpn(1)>0&&v.cmpn(1)>0;){for(var M=0,T=1;(g.words[0]&T)===0&&M<26;++M,T<<=1);if(M>0)for(g.iushrn(M);M-- >0;)P.isOdd()&&P.iadd(B),P.iushrn(1);for(var h=0,A=1;(v.words[0]&A)===0&&h<26;++h,A<<=1);if(h>0)for(v.iushrn(h);h-- >0;)x.isOdd()&&x.iadd(B),x.iushrn(1);g.cmp(v)>=0?(g.isub(v),P.isub(x)):(v.isub(g),x.isub(P))}var j;return g.cmpn(1)===0?j=P:j=x,j.cmpn(0)<0&&j.iadd(l),j},i.prototype.gcd=function(l){if(this.isZero())return l.abs();if(l.isZero())return this.abs();var g=this.clone(),v=l.clone();g.negative=0,v.negative=0;for(var P=0;g.isEven()&&v.isEven();P++)g.iushrn(1),v.iushrn(1);do{for(;g.isEven();)g.iushrn(1);for(;v.isEven();)v.iushrn(1);var x=g.cmp(v);if(x<0){var B=g;g=v,v=B}else if(x===0||v.cmpn(1)===0)break;g.isub(v)}while(!0);return v.iushln(P)},i.prototype.invm=function(l){return this.egcd(l).a.umod(l)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(l){return this.words[0]&l},i.prototype.bincn=function(l){r(typeof l=="number");var g=l%26,v=(l-g)/26,P=1<<g;if(this.length<=v)return this._expand(v+1),this.words[v]|=P,this;for(var x=P,B=v;x!==0&&B<this.length;B++){var M=this.words[B]|0;M+=x,x=M>>>26,M&=67108863,this.words[B]=M}return x!==0&&(this.words[B]=x,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(l){var g=l<0;if(this.negative!==0&&!g)return-1;if(this.negative===0&&g)return 1;this.strip();var v;if(this.length>1)v=1;else{g&&(l=-l),r(l<=67108863,"Number is too big");var P=this.words[0]|0;v=P===l?0:P<l?-1:1}return this.negative!==0?-v|0:v},i.prototype.cmp=function(l){if(this.negative!==0&&l.negative===0)return-1;if(this.negative===0&&l.negative!==0)return 1;var g=this.ucmp(l);return this.negative!==0?-g|0:g},i.prototype.ucmp=function(l){if(this.length>l.length)return 1;if(this.length<l.length)return-1;for(var g=0,v=this.length-1;v>=0;v--){var P=this.words[v]|0,x=l.words[v]|0;if(P!==x){P<x?g=-1:P>x&&(g=1);break}}return g},i.prototype.gtn=function(l){return this.cmpn(l)===1},i.prototype.gt=function(l){return this.cmp(l)===1},i.prototype.gten=function(l){return this.cmpn(l)>=0},i.prototype.gte=function(l){return this.cmp(l)>=0},i.prototype.ltn=function(l){return this.cmpn(l)===-1},i.prototype.lt=function(l){return this.cmp(l)===-1},i.prototype.lten=function(l){return this.cmpn(l)<=0},i.prototype.lte=function(l){return this.cmp(l)<=0},i.prototype.eqn=function(l){return this.cmpn(l)===0},i.prototype.eq=function(l){return this.cmp(l)===0},i.red=function(l){return new K(l)},i.prototype.toRed=function(l){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),l.convertTo(this)._forceRed(l)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(l){return this.red=l,this},i.prototype.forceRed=function(l){return r(!this.red,"Already a number in reduction context"),this._forceRed(l)},i.prototype.redAdd=function(l){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,l)},i.prototype.redIAdd=function(l){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,l)},i.prototype.redSub=function(l){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,l)},i.prototype.redISub=function(l){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,l)},i.prototype.redShl=function(l){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,l)},i.prototype.redMul=function(l){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.mul(this,l)},i.prototype.redIMul=function(l){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.imul(this,l)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(l){return r(this.red&&!l.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,l)};var k={k256:null,p224:null,p192:null,p25519:null};function C(O,l){this.name=O,this.p=new i(l,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}C.prototype._tmp=function(){var l=new i(null);return l.words=new Array(Math.ceil(this.n/13)),l},C.prototype.ireduce=function(l){var g=l,v;do this.split(g,this.tmp),g=this.imulK(g),g=g.iadd(this.tmp),v=g.bitLength();while(v>this.n);var P=v<this.n?-1:g.ucmp(this.p);return P===0?(g.words[0]=0,g.length=1):P>0?g.isub(this.p):g.strip!==void 0?g.strip():g._strip(),g},C.prototype.split=function(l,g){l.iushrn(this.n,0,g)},C.prototype.imulK=function(l){return l.imul(this.k)};function U(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(U,C),U.prototype.split=function(l,g){for(var v=4194303,P=Math.min(l.length,9),x=0;x<P;x++)g.words[x]=l.words[x];if(g.length=P,l.length<=9){l.words[0]=0,l.length=1;return}var B=l.words[9];for(g.words[g.length++]=B&v,x=10;x<l.length;x++){var M=l.words[x]|0;l.words[x-10]=(M&v)<<4|B>>>22,B=M}B>>>=22,l.words[x-10]=B,B===0&&l.length>10?l.length-=10:l.length-=9},U.prototype.imulK=function(l){l.words[l.length]=0,l.words[l.length+1]=0,l.length+=2;for(var g=0,v=0;v<l.length;v++){var P=l.words[v]|0;g+=P*977,l.words[v]=g&67108863,g=P*64+(g/67108864|0)}return l.words[l.length-1]===0&&(l.length--,l.words[l.length-1]===0&&l.length--),l};function R(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(R,C);function q(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(q,C);function L(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(L,C),L.prototype.imulK=function(l){for(var g=0,v=0;v<l.length;v++){var P=(l.words[v]|0)*19+g,x=P&67108863;P>>>=26,l.words[v]=x,g=P}return g!==0&&(l.words[l.length++]=g),l},i._prime=function(l){if(k[l])return k[l];var g;if(l==="k256")g=new U;else if(l==="p224")g=new R;else if(l==="p192")g=new q;else if(l==="p25519")g=new L;else throw new Error("Unknown prime "+l);return k[l]=g,g};function K(O){if(typeof O=="string"){var l=i._prime(O);this.m=l.p,this.prime=l}else r(O.gtn(1),"modulus must be greater than 1"),this.m=O,this.prime=null}K.prototype._verify1=function(l){r(l.negative===0,"red works only with positives"),r(l.red,"red works only with red numbers")},K.prototype._verify2=function(l,g){r((l.negative|g.negative)===0,"red works only with positives"),r(l.red&&l.red===g.red,"red works only with red numbers")},K.prototype.imod=function(l){return this.prime?this.prime.ireduce(l)._forceRed(this):l.umod(this.m)._forceRed(this)},K.prototype.neg=function(l){return l.isZero()?l.clone():this.m.sub(l)._forceRed(this)},K.prototype.add=function(l,g){this._verify2(l,g);var v=l.add(g);return v.cmp(this.m)>=0&&v.isub(this.m),v._forceRed(this)},K.prototype.iadd=function(l,g){this._verify2(l,g);var v=l.iadd(g);return v.cmp(this.m)>=0&&v.isub(this.m),v},K.prototype.sub=function(l,g){this._verify2(l,g);var v=l.sub(g);return v.cmpn(0)<0&&v.iadd(this.m),v._forceRed(this)},K.prototype.isub=function(l,g){this._verify2(l,g);var v=l.isub(g);return v.cmpn(0)<0&&v.iadd(this.m),v},K.prototype.shl=function(l,g){return this._verify1(l),this.imod(l.ushln(g))},K.prototype.imul=function(l,g){return this._verify2(l,g),this.imod(l.imul(g))},K.prototype.mul=function(l,g){return this._verify2(l,g),this.imod(l.mul(g))},K.prototype.isqr=function(l){return this.imul(l,l.clone())},K.prototype.sqr=function(l){return this.mul(l,l)},K.prototype.sqrt=function(l){if(l.isZero())return l.clone();var g=this.m.andln(3);if(r(g%2===1),g===3){var v=this.m.add(new i(1)).iushrn(2);return this.pow(l,v)}for(var P=this.m.subn(1),x=0;!P.isZero()&&P.andln(1)===0;)x++,P.iushrn(1);r(!P.isZero());var B=new i(1).toRed(this),M=B.redNeg(),T=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new i(2*h*h).toRed(this);this.pow(h,T).cmp(M)!==0;)h.redIAdd(M);for(var A=this.pow(h,P),j=this.pow(l,P.addn(1).iushrn(1)),D=this.pow(l,P),G=x;D.cmp(B)!==0;){for(var J=D,ue=0;J.cmp(B)!==0;ue++)J=J.redSqr();r(ue<G);var Se=this.pow(A,new i(1).iushln(G-ue-1));j=j.redMul(Se),A=Se.redSqr(),D=D.redMul(A),G=ue}return j},K.prototype.invm=function(l){var g=l._invmp(this.m);return g.negative!==0?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},K.prototype.pow=function(l,g){if(g.isZero())return new i(1).toRed(this);if(g.cmpn(1)===0)return l.clone();var v=4,P=new Array(1<<v);P[0]=new i(1).toRed(this),P[1]=l;for(var x=2;x<P.length;x++)P[x]=this.mul(P[x-1],l);var B=P[0],M=0,T=0,h=g.bitLength()%26;for(h===0&&(h=26),x=g.length-1;x>=0;x--){for(var A=g.words[x],j=h-1;j>=0;j--){var D=A>>j&1;if(B!==P[0]&&(B=this.sqr(B)),D===0&&M===0){T=0;continue}M<<=1,M|=D,T++,!(T!==v&&(x!==0||j!==0))&&(B=this.mul(B,P[M]),T=0,M=0)}h=26}return B},K.prototype.convertTo=function(l){var g=l.umod(this.m);return g===l?g.clone():g},K.prototype.convertFrom=function(l){var g=l.clone();return g.red=null,g},i.mont=function(l){return new W(l)};function W(O){K.call(this,O),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(W,K),W.prototype.convertTo=function(l){return this.imod(l.ushln(this.shift))},W.prototype.convertFrom=function(l){var g=this.imod(l.mul(this.rinv));return g.red=null,g},W.prototype.imul=function(l,g){if(l.isZero()||g.isZero())return l.words[0]=0,l.length=1,l;var v=l.imul(g),P=v.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=v.isub(P).iushrn(this.shift),B=x;return x.cmp(this.m)>=0?B=x.isub(this.m):x.cmpn(0)<0&&(B=x.iadd(this.m)),B._forceRed(this)},W.prototype.mul=function(l,g){if(l.isZero()||g.isZero())return new i(0)._forceRed(this);var v=l.mul(g),P=v.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=v.isub(P).iushrn(this.shift),B=x;return x.cmp(this.m)>=0?B=x.isub(this.m):x.cmpn(0)<0&&(B=x.iadd(this.m)),B._forceRed(this)},W.prototype.invm=function(l){var g=this.imod(l._invmp(this.m).mul(this.r2));return g._forceRed(this)}})(typeof dl>"u"||dl,rg)});var gn=H(ng=>{w();S();var Jn=ng,r6=Jr(),n6=ew(),vu=tw();Jn.assert=n6;Jn.toArray=vu.toArray;Jn.zero2=vu.zero2;Jn.toHex=vu.toHex;Jn.encode=vu.encode;function i6(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),o=0;o<n.length;o++){var a,c=s.andln(i-1);s.isOdd()?(c>(i>>1)-1?a=(i>>1)-c:a=c,s.isubn(a)):a=0,n[o]=a,s.iushrn(1)}return n}Jn.getNAF=i6;function s6(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n=0,i=0,s;e.cmpn(-n)>0||t.cmpn(-i)>0;){var o=e.andln(3)+n&3,a=t.andln(3)+i&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)===0?c=0:(s=e.andln(7)+n&7,(s===3||s===5)&&a===2?c=-o:c=o),r[0].push(c);var u;(a&1)===0?u=0:(s=t.andln(7)+i&7,(s===3||s===5)&&o===2?u=-a:u=a),r[1].push(u),2*n===c+1&&(n=1-n),2*i===u+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return r}Jn.getJSF=s6;function o6(e,t,r){var n="_"+t;e.prototype[t]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}Jn.cachedProperty=o6;function a6(e){return typeof e=="string"?Jn.toArray(e,"hex"):e}Jn.parseBytes=a6;function c6(e){return new r6(e,"hex","le")}Jn.intFromLE=c6});var sc=H((uC,ig)=>{w();S();var ic=gn(),so=Jr(),wu=ic.getNAF,u6=ic.getJSF,Su=ic.assert;function xs(e,t){this.type=e,this.p=new so(t.p,16),this.red=t.prime?so.red(t.prime):so.mont(this.p),this.zero=new so(0).toRed(this.red),this.one=new so(1).toRed(this.red),this.two=new so(2).toRed(this.red),this.n=t.n&&new so(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}ig.exports=xs;xs.prototype.point=function(){throw new Error("Not implemented")};xs.prototype.validate=function(){throw new Error("Not implemented")};xs.prototype._fixedNafMul=function(t,r){Su(t.precomputed);var n=t._getDoubles(),i=wu(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<i.length;a+=n.step){c=0;for(var u=a+n.step-1;u>=a;u--)c=(c<<1)+i[u];o.push(c)}for(var d=this.jpoint(null,null,null),f=this.jpoint(null,null,null),b=s;b>0;b--){for(a=0;a<o.length;a++)c=o[a],c===b?f=f.mixedAdd(n.points[a]):c===-b&&(f=f.mixedAdd(n.points[a].neg()));d=d.add(f)}return d.toP()};xs.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=wu(r,n,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var d=o[c];Su(d!==0),t.type==="affine"?d>0?a=a.mixedAdd(s[d-1>>1]):a=a.mixedAdd(s[-d-1>>1].neg()):d>0?a=a.add(s[d-1>>1]):a=a.add(s[-d-1>>1].neg())}return t.type==="affine"?a.toP():a};xs.prototype._wnafMulAdd=function(t,r,n,i,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,d,f,b;for(d=0;d<i;d++){b=r[d];var m=b._getNAFPoints(t);o[d]=m.wnd,a[d]=m.points}for(d=i-1;d>=1;d-=2){var y=d-1,_=d;if(o[y]!==1||o[_]!==1){c[y]=wu(n[y],o[y],this._bitLength),c[_]=wu(n[_],o[_],this._bitLength),u=Math.max(c[y].length,u),u=Math.max(c[_].length,u);continue}var E=[r[y],null,null,r[_]];r[y].y.cmp(r[_].y)===0?(E[1]=r[y].add(r[_]),E[2]=r[y].toJ().mixedAdd(r[_].neg())):r[y].y.cmp(r[_].y.redNeg())===0?(E[1]=r[y].toJ().mixedAdd(r[_]),E[2]=r[y].add(r[_].neg())):(E[1]=r[y].toJ().mixedAdd(r[_]),E[2]=r[y].toJ().mixedAdd(r[_].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],k=u6(n[y],n[_]);for(u=Math.max(k[0].length,u),c[y]=new Array(u),c[_]=new Array(u),f=0;f<u;f++){var C=k[0][f]|0,U=k[1][f]|0;c[y][f]=I[(C+1)*3+(U+1)],c[_][f]=0,a[y]=E}}var R=this.jpoint(null,null,null),q=this._wnafT4;for(d=u;d>=0;d--){for(var L=0;d>=0;){var K=!0;for(f=0;f<i;f++)q[f]=c[f][d]|0,q[f]!==0&&(K=!1);if(!K)break;L++,d--}if(d>=0&&L++,R=R.dblp(L),d<0)break;for(f=0;f<i;f++){var W=q[f];W!==0&&(W>0?b=a[f][W-1>>1]:W<0&&(b=a[f][-W-1>>1].neg()),b.type==="affine"?R=R.mixedAdd(b):R=R.add(b))}}for(d=0;d<i;d++)a[d]=null;return s?R:R.toP()};function Sn(e,t){this.curve=e,this.type=t,this.precomputed=null}xs.BasePoint=Sn;Sn.prototype.eq=function(){throw new Error("Not implemented")};Sn.prototype.validate=function(){return this.curve.validate(this)};xs.prototype.decodePoint=function(t,r){t=ic.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*n){t[0]===6?Su(t[t.length-1]%2===0):t[0]===7&&Su(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};Sn.prototype.encodeCompressed=function(t){return this.encode(t,!0)};Sn.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};Sn.prototype.encode=function(t,r){return ic.encode(this._encode(r),t)};Sn.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};Sn.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};Sn.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=t){for(var o=0;o<t;o++)i=i.dbl();n.push(i)}return{step:t,points:n}};Sn.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:t,points:r}};Sn.prototype._getBeta=function(){return null};Sn.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r}});var og=H((lC,sg)=>{w();S();var f6=gn(),ot=Jr(),ll=Od(),ta=sc(),d6=f6.assert;function xn(e){ta.call(this,"short",e),this.a=new ot(e.a,16).toRed(this.red),this.b=new ot(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}ll(xn,ta);sg.exports=xn;xn.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new ot(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new ot(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],d6(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return t.basis?o=t.basis.map(function(a){return{a:new ot(a.a,16),b:new ot(a.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}};xn.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:ot.mont(t),n=new ot(2).toRed(r).redInvm(),i=n.redNeg(),s=new ot(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]};xn.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),s=new ot(1),o=new ot(0),a=new ot(0),c=new ot(1),u,d,f,b,m,y,_,E=0,I,k;n.cmpn(0)!==0;){var C=i.div(n);I=i.sub(C.mul(n)),k=a.sub(C.mul(s));var U=c.sub(C.mul(o));if(!f&&I.cmp(r)<0)u=_.neg(),d=s,f=I.neg(),b=k;else if(f&&++E===2)break;_=I,i=n,n=I,a=s,s=k,c=o,o=U}m=I.neg(),y=k;var R=f.sqr().add(b.sqr()),q=m.sqr().add(y.sqr());return q.cmp(R)>=0&&(m=u,y=d),f.negative&&(f=f.neg(),b=b.neg()),m.negative&&(m=m.neg(),y=y.neg()),[{a:f,b},{a:m,b:y}]};xn.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(t).divRound(this.n),o=n.b.neg().mul(t).divRound(this.n),a=s.mul(n.a),c=o.mul(i.a),u=s.mul(n.b),d=o.mul(i.b),f=t.sub(a).sub(c),b=u.add(d).neg();return{k1:f,k2:b}};xn.prototype.pointFromX=function(t,r){t=new ot(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(t,i)};xn.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};xn.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<t.length;o++){var a=this._endoSplit(r[o]),c=t[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),i[o*2]=c,i[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var d=this._wnafMulAdd(1,i,s,o*2,n),f=0;f<o*2;f++)i[f]=null,s[f]=null;return d};function cr(e,t,r,n){ta.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new ot(t,16),this.y=new ot(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}ll(cr,ta.BasePoint);xn.prototype.point=function(t,r,n){return new cr(this,t,r,n)};xn.prototype.pointFromJSON=function(t,r){return cr.fromJSON(this,t,r)};cr.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};cr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};cr.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function s(a){return t.point(a[0],a[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};cr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};cr.prototype.isInfinity=function(){return this.inf};cr.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};cr.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};cr.prototype.getX=function(){return this.x.fromRed()};cr.prototype.getY=function(){return this.y.fromRed()};cr.prototype.mul=function(t){return t=new ot(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};cr.prototype.mulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};cr.prototype.jmulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};cr.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};cr.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};cr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function Pr(e,t,r,n){ta.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new ot(0)):(this.x=new ot(t,16),this.y=new ot(r,16),this.z=new ot(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}ll(Pr,ta.BasePoint);xn.prototype.jpoint=function(t,r,n){return new Pr(this,t,r,n)};Pr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};Pr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Pr.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(n),o=this.y.redMul(r.redMul(t.z)),a=t.y.redMul(n.redMul(this.z)),c=i.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var d=c.redSqr(),f=d.redMul(c),b=i.redMul(d),m=u.redSqr().redIAdd(f).redISub(b).redISub(b),y=u.redMul(b.redISub(m)).redISub(o.redMul(f)),_=this.z.redMul(t.z).redMul(c);return this.curve.jpoint(m,y,_)};Pr.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),s=this.y,o=t.y.redMul(r).redMul(this.z),a=n.redSub(i),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),d=u.redMul(a),f=n.redMul(u),b=c.redSqr().redIAdd(d).redISub(f).redISub(f),m=c.redMul(f.redISub(b)).redISub(s.redMul(d)),y=this.z.redMul(a);return this.curve.jpoint(b,m,y)};Pr.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),d=a.redAdd(a);for(r=0;r<t;r++){var f=o.redSqr(),b=d.redSqr(),m=b.redSqr(),y=f.redAdd(f).redIAdd(f).redIAdd(i.redMul(u)),_=o.redMul(b),E=y.redSqr().redISub(_.redAdd(_)),I=_.redISub(E),k=y.redMul(I);k=k.redIAdd(k).redISub(m);var C=d.redMul(c);r+1<t&&(u=u.redMul(m)),o=E,c=C,d=k}return this.curve.jpoint(o,d.redMul(s),c)};Pr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Pr.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i),u=c.redSqr().redISub(a).redISub(a),d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),t=u,r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var f=this.x.redSqr(),b=this.y.redSqr(),m=b.redSqr(),y=this.x.redAdd(b).redSqr().redISub(f).redISub(m);y=y.redIAdd(y);var _=f.redAdd(f).redIAdd(f),E=_.redSqr(),I=m.redIAdd(m);I=I.redIAdd(I),I=I.redIAdd(I),t=E.redISub(y).redISub(y),r=_.redMul(y.redISub(t)).redISub(I),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};Pr.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);t=u;var d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var f=this.z.redSqr(),b=this.y.redSqr(),m=this.x.redMul(b),y=this.x.redSub(f).redMul(this.x.redAdd(f));y=y.redAdd(y).redIAdd(y);var _=m.redIAdd(m);_=_.redIAdd(_);var E=_.redAdd(_);t=y.redSqr().redISub(E),n=this.y.redAdd(this.z).redSqr().redISub(b).redISub(f);var I=b.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I),r=y.redMul(_.redISub(t)).redISub(I)}return this.curve.jpoint(t,r,n)};Pr.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),a=n.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(t.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var d=u.redMul(a),f=c.redSqr().redISub(d.redAdd(d)),b=d.redISub(f),m=a.redSqr();m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var y=c.redMul(b).redISub(m),_=n.redAdd(n).redMul(i);return this.curve.jpoint(f,y,_)};Pr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=t.redAdd(t).redIAdd(t),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(t).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var d=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),f=r.redMul(d);f=f.redIAdd(f),f=f.redIAdd(f);var b=this.x.redMul(c).redISub(f);b=b.redIAdd(b),b=b.redIAdd(b);var m=this.y.redMul(d.redMul(u.redISub(d)).redISub(a.redMul(c)));m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var y=this.z.redAdd(a).redSqr().redISub(n).redISub(c);return this.curve.jpoint(b,m,y)};Pr.prototype.mul=function(t,r){return t=new ot(t,r),this.curve._wnafMul(this,t)};Pr.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(i)).cmpn(0)===0};Pr.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};Pr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Pr.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var ug=H((bC,cg)=>{w();S();var ra=Jr(),ag=Od(),xu=sc(),l6=gn();function na(e){xu.call(this,"mont",e),this.a=new ra(e.a,16).toRed(this.red),this.b=new ra(e.b,16).toRed(this.red),this.i4=new ra(4).toRed(this.red).redInvm(),this.two=new ra(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}ag(na,xu);cg.exports=na;na.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function ur(e,t,r){xu.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new ra(t,16),this.z=new ra(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}ag(ur,xu.BasePoint);na.prototype.decodePoint=function(t,r){return this.point(l6.toArray(t,r),1)};na.prototype.point=function(t,r){return new ur(this,t,r)};na.prototype.pointFromJSON=function(t){return ur.fromJSON(this,t)};ur.prototype.precompute=function(){};ur.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};ur.fromJSON=function(t,r){return new ur(t,r[0],r[1]||t.one)};ur.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ur.prototype.isInfinity=function(){return this.z.cmpn(0)===0};ur.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),a=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};ur.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};ur.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=t.x.redAdd(t.z),o=t.x.redSub(t.z),a=o.redMul(n),c=s.redMul(i),u=r.z.redMul(a.redAdd(c).redSqr()),d=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,d)};ur.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};ur.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};ur.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};ur.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};ur.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};ur.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var lg=H((mC,dg)=>{w();S();var h6=gn(),Xi=Jr(),fg=Od(),Pu=sc(),p6=h6.assert;function _i(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,Pu.call(this,"edwards",e),this.a=new Xi(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Xi(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Xi(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),p6(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}fg(_i,Pu);dg.exports=_i;_i.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};_i.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};_i.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};_i.prototype.pointFromX=function(t,r){t=new Xi(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(t,a)};_i.prototype.pointFromY=function(t,r){t=new Xi(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,t)};_i.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function He(e,t,r,n,i){Pu.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Xi(t,16),this.y=new Xi(r,16),this.z=n?new Xi(n,16):this.curve.one,this.t=i&&new Xi(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}fg(He,Pu.BasePoint);_i.prototype.pointFromJSON=function(t){return He.fromJSON(this,t)};_i.prototype.point=function(t,r,n,i){return new He(this,t,r,n,i)};He.fromJSON=function(t,r){return new He(t,r[0],r[1],r[2])};He.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};He.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};He.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),o=i.redAdd(r),a=o.redSub(n),c=i.redSub(r),u=s.redMul(a),d=o.redMul(c),f=s.redMul(c),b=a.redMul(o);return this.curve.point(u,d,b,f)};He.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(r);var d=a.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(d.redSub(this.curve.two)),s=d.redMul(a.redSub(n)),o=d.redSqr().redSub(d).redSub(d)):(c=this.z.redSqr(),u=d.redSub(c).redISub(c),i=t.redSub(r).redISub(n).redMul(u),s=d.redMul(a.redSub(n)),o=d.redMul(u))}else a=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),i=this.curve._mulC(t.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(n)),o=a.redMul(u);return this.curve.point(i,s,o)};He.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};He.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),o=n.redSub(r),a=s.redSub(i),c=s.redAdd(i),u=n.redAdd(r),d=o.redMul(a),f=c.redMul(u),b=o.redMul(u),m=a.redMul(c);return this.curve.point(d,f,m,b)};He.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),s=this.y.redMul(t.y),o=this.curve.d.redMul(i).redMul(s),a=n.redSub(o),c=n.redAdd(o),u=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),d=r.redMul(a).redMul(u),f,b;return this.curve.twisted?(f=r.redMul(c).redMul(s.redSub(this.curve._mulA(i))),b=a.redMul(c)):(f=r.redMul(c).redMul(s.redSub(i)),b=this.curve._mulC(a).redMul(c)),this.curve.point(d,f,b)};He.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};He.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};He.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};He.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};He.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};He.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};He.prototype.getX=function(){return this.normalize(),this.x.fromRed()};He.prototype.getY=function(){return this.normalize(),this.y.fromRed()};He.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};He.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};He.prototype.toP=He.prototype.normalize;He.prototype.mixedAdd=He.prototype.add});var hl=H(hg=>{w();S();var Tu=hg;Tu.base=sc();Tu.short=og();Tu.mont=ug();Tu.edwards=lg()});var bg=H((PC,pg)=>{w();S();pg.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Eu=H(mg=>{w();S();var bl=mg,Ps=W0(),pl=hl(),b6=gn(),gg=b6.assert;function yg(e){e.type==="short"?this.curve=new pl.short(e):e.type==="edwards"?this.curve=new pl.edwards(e):this.curve=new pl.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,gg(this.g.validate(),"Invalid curve"),gg(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}bl.PresetCurve=yg;function Ts(e,t){Object.defineProperty(bl,e,{configurable:!0,enumerable:!0,get:function(){var r=new yg(t);return Object.defineProperty(bl,e,{configurable:!0,enumerable:!0,value:r}),r}})}Ts("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ps.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Ts("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ps.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Ts("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ps.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Ts("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ps.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Ts("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ps.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Ts("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ps.sha256,gRed:!1,g:["9"]});Ts("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ps.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var gl;try{gl=bg()}catch{gl=void 0}Ts("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ps.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",gl]})});var vg=H((BC,_g)=>{w();S();var g6=Jr(),y6=gn(),yl=y6.assert;function Mr(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}_g.exports=Mr;Mr.fromPublic=function(t,r,n){return r instanceof Mr?r:new Mr(t,{pub:r,pubEnc:n})};Mr.fromPrivate=function(t,r,n){return r instanceof Mr?r:new Mr(t,{priv:r,privEnc:n})};Mr.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Mr.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};Mr.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};Mr.prototype._importPrivate=function(t,r){this.priv=new g6(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};Mr.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?yl(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&yl(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};Mr.prototype.derive=function(t){return t.validate()||yl(t.validate(),"public point not validated"),t.mul(this.priv).getX()};Mr.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};Mr.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};Mr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var xg=H((kC,Sg)=>{w();S();var Au=Jr(),vl=gn(),m6=vl.assert;function oc(e,t,r){if(t instanceof oc)return t;this._importDER(t,r)||(m6(t.r&&t.s,"Signature without r or s"),this.r=new Au(t.r,16),this.s=new Au(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam,this.curve=e,this.byteLength=this.curve.n.byteLength())}Sg.exports=oc;function _6(){this.place=0}function ml(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,o=t.place;s<n;s++,o++)i<<=8,i|=e[o],i>>>=0;return i<=127?!1:(t.place=o,i)}function wg(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}oc.prototype._importDER=function(t,r){t=vl.toArray(t,r);var n=new _6;if(t[n.place++]!==48)return!1;var i=ml(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var s=ml(t,n);if(s===!1)return!1;var o=t.slice(n.place,s+n.place);if(n.place+=s,t[n.place++]!==2)return!1;var a=ml(t,n);if(a===!1||t.length!==a+n.place)return!1;var c=t.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Au(o),this.s=new Au(c),this.recoveryParam=null,!0};function _l(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}oc.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=wg(r),n=wg(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];_l(i,r.length),i=i.concat(r),i.push(2),_l(i,n.length);var s=i.concat(n),o=[48];return _l(o,s.length),o=o.concat(s),vl.encode(o,t)};oc.prototype.toBytes=function(){let t=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return t.concat(r)}});var Eg=H((RC,Tg)=>{w();S();var Yi=Jr(),Pg=nw(),v6=gn(),wl=Eu(),w6=iw(),oo=v6.assert,Sl=vg(),Iu=xg();function Pn(e){if(!(this instanceof Pn))return new Pn(e);typeof e=="string"&&(oo(Object.prototype.hasOwnProperty.call(wl,e),"Unknown curve "+e),e=wl[e]),e instanceof wl.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}Tg.exports=Pn;Pn.prototype.keyPair=function(t){return new Sl(this,t)};Pn.prototype.keyFromPrivate=function(t,r){return Sl.fromPrivate(this,t,r)};Pn.prototype.keyFromPublic=function(t,r){return Sl.fromPublic(this,t,r)};Pn.prototype.genKeyPair=function(t){t||(t={});for(var r=new Pg({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||w6(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Yi(2));;){var s=new Yi(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Pn.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};Pn.prototype.sign=function(t,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof t!="string"&&typeof t!="number"&&!Yi.isBN(t)){oo(typeof t=="object"&&t&&typeof t.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),oo(t.length>>>0===t.length);for(var s=0;s<t.length;s++)oo((t[s]&255)===t[s])}r=this.keyFromPrivate(r,n),t=this._truncateToN(new Yi(t,16)),oo(!t.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=r.getPrivate().toArray("be",o),c=t.toArray("be",o);oo(new Yi(c).eq(t),"Can not sign message");for(var u=new Pg({hash:this.hash,entropy:a,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),d=this.n.sub(new Yi(1)),f=0;;f++){var b=i.k?i.k(f):new Yi(u.generate(this.n.byteLength()));if(b=this._truncateToN(b,!0),!(b.cmpn(1)<=0||b.cmp(d)>=0)){var m=this.g.mul(b);if(!m.isInfinity()){var y=m.getX(),_=y.umod(this.n);if(_.cmpn(0)!==0){var E=b.invm(this.n).mul(_.mul(r.getPrivate()).iadd(t));if(E=E.umod(this.n),E.cmpn(0)!==0){var I=(m.getY().isOdd()?1:0)|(y.cmp(_)!==0?2:0);return i.canonical&&E.cmp(this.nh)>0&&(E=this.n.sub(E),I^=1),new Iu(this.curve,{r:_,s:E,recoveryParam:I})}}}}}};Pn.prototype.verify=function(t,r,n,i){t=this._truncateToN(new Yi(t,16)),n=this.keyFromPublic(n,i),r=new Iu(this.curve,r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(t).umod(this.n),u=a.mul(s).umod(this.n),d;return this.curve._maxwellTrick?(d=this.g.jmulAdd(c,n.getPublic(),u),d.isInfinity()?!1:d.eqXToP(s)):(d=this.g.mulAdd(c,n.getPublic(),u),d.isInfinity()?!1:d.getX().umod(this.n).cmp(s)===0)};Pn.prototype.recoverPubKey=function(e,t,r,n){oo((3&r)===r,"The recovery param is more than two bits"),t=new Iu(this.curve,t,n);var i=this.n,s=new Yi(e),o=t.r,a=t.s,c=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var d=t.r.invm(i),f=i.sub(s).mul(d).umod(i),b=a.mul(d).umod(i);return this.g.mulAdd(f,o,b)};Pn.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new Iu(this.curve,t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var Bg=H((LC,Og)=>{w();S();var ac=gn(),Ig=ac.assert,Ag=ac.parseBytes,ia=ac.cachedProperty;function fr(e,t){this.eddsa=e,this._secret=Ag(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=Ag(t.pub)}fr.fromPublic=function(t,r){return r instanceof fr?r:new fr(t,{pub:r})};fr.fromSecret=function(t,r){return r instanceof fr?r:new fr(t,{secret:r})};fr.prototype.secret=function(){return this._secret};ia(fr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});ia(fr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});ia(fr,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});ia(fr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});ia(fr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});ia(fr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});fr.prototype.sign=function(t){return Ig(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};fr.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};fr.prototype.getSecret=function(t){return Ig(this._secret,"KeyPair is public only"),ac.encode(this.secret(),t)};fr.prototype.getPublic=function(t){return ac.encode(this.pubBytes(),t)};Og.exports=fr});var Cg=H((jC,Mg)=>{w();S();var S6=Jr(),Ou=gn(),x6=Ou.assert,Bu=Ou.cachedProperty,P6=Ou.parseBytes;function ao(e,t){this.eddsa=e,typeof t!="object"&&(t=P6(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),x6(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof S6&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Bu(ao,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Bu(ao,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Bu(ao,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Bu(ao,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});ao.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};ao.prototype.toHex=function(){return Ou.encode(this.toBytes(),"hex").toUpperCase()};Mg.exports=ao});var Ug=H((VC,Rg)=>{w();S();var T6=W0(),E6=Eu(),sa=gn(),A6=sa.assert,Hg=sa.parseBytes,Ng=Bg(),kg=Cg();function Qr(e){if(A6(e==="ed25519","only tested with ed25519 so far"),!(this instanceof Qr))return new Qr(e);e=E6[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=T6.sha512}Rg.exports=Qr;Qr.prototype.sign=function(t,r){t=Hg(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),s=this.g.mul(i),o=this.encodePoint(s),a=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),c=i.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Qr.prototype.verify=function(t,r,n){t=Hg(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),t),o=this.g.mul(r.S()),a=r.R().add(i.pub().mul(s));return a.eq(o)};Qr.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return sa.intFromLE(t.digest()).umod(this.curve.n)};Qr.prototype.keyFromPublic=function(t){return Ng.fromPublic(this,t)};Qr.prototype.keyFromSecret=function(t){return Ng.fromSecret(this,t)};Qr.prototype.makeSignature=function(t){return t instanceof kg?t:new kg(this,t)};Qr.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};Qr.prototype.decodePoint=function(t){t=sa.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&-129),i=(t[r]&128)!==0,s=sa.intFromLE(n);return this.curve.pointFromY(s,i)};Qr.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};Qr.prototype.decodeInt=function(t){return sa.intFromLE(t)};Qr.prototype.isPoint=function(t){return t instanceof this.pointClass}});var oa=H(Tn=>{w();S();Object.defineProperty(Tn,"__esModule",{value:!0});Tn.utils=Tn.curves=Tn.curve=Tn.eddsa=Tn.ec=void 0;var I6=hl();Tn.curve=I6;var O6=Eu();Tn.curves=O6;var B6=Eg();Tn.ec=B6;var M6=Ug();Tn.eddsa=M6;var C6=gn();Tn.utils=C6});var Kg=H((qg,Lg)=>{w();S();Object.defineProperty(qg,"__esModule",{value:!0});var k6=oa(),vi=new k6.ec("secp256k1"),ge=vi.curve,Ne=Jr();function H6(e,t){let r=new Ne(t);if(r.cmp(ge.p)>=0)return null;r=r.toRed(ge.red);let n=r.redSqr().redIMul(r).redIAdd(ge.b).redSqrt();e===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(ge.b)).isZero()?vi.keyPair({pub:{x:r,y:n}}):null}function N6(e,t,r){let n=new Ne(t),i=new Ne(r);if(n.cmp(ge.p)>=0||i.cmp(ge.p)>=0||(n=n.toRed(ge.red),i=i.toRed(ge.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(ge.b)).isZero()?vi.keyPair({pub:{x:n,y:i}}):null}function Es(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:H6(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:N6(t,e.subarray(1,33),e.subarray(33,65));default:return null}}Lg.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new Ne(e);return t.cmp(ge.n)<0&&!t.isZero()},privateKeyNegate(e){let t=new Ne(e);return p.Buffer.from(ge.n.sub(t).umod(ge.n).toArray("be",32))},privateKeyTweakAdd(e,t){let r=new Ne(t);return r.cmp(ge.n)>=0||(r.iadd(new Ne(e)),r.cmp(ge.n)>=0&&r.isub(ge.n),r.isZero())?null:p.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(e,t){let r=new Ne(t);return r.cmp(ge.n)>=0||r.isZero()?1:(r.imul(new Ne(e)),r.cmp(ge.n)>=0&&(r=r.umod(ge.n)),p.Buffer.from(r.toArray("be",32)))},publicKeyVerify(e){let t=Es(e);return t==null?null:t.validate().result},publicKeyCreate(e,t){let r=new Ne(e);if(r.cmp(ge.n)>=0||r.isZero())return null;let n=vi.keyFromPrivate(e,null).getPublic();return p.Buffer.from(n.encode(null,t))},publicKeyConvert(e,t){let n=Es(e).getPublic();return p.Buffer.from(n.encode(null,t))},publicKeyNegate(e,t){let r=Es(e);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),p.Buffer.from(n.encode(null,t))},publicKeyCombine(e,t){let r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=Es(e[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:p.Buffer.from(n.encode(null,t))},publicKeyTweakAdd(e,t,r){let n=Es(e);if(n===null||new Ne(t).cmp(ge.n)>=0)return null;let s=n.getPublic().add(ge.g.mul(t));return s.isInfinity()?null:p.Buffer.from(s.encode(null,r))},publicKeyTweakMul(e,t,r){let n=Es(e);if(n===null)return null;let i=new Ne(t);if(i.cmp(ge.n)>=0||i.isZero())return null;let s=n.getPublic().mul(t);return p.Buffer.from(s.encode(null,r))},signatureNormalize(e){let t=new Ne(e.subarray(0,32)),r=new Ne(e.subarray(32,64));return t.cmp(ge.n)>=0||r.cmp(ge.n)>=0?null:(r.cmp(vi.nh)===1&&e.set(ge.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new Ne(r).cmp(ge.n)>=0||new Ne(n).cmp(ge.n)>=0)return 1;let{output:i}=e,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=i.subarray(6+33,6+33+33);c[0]=0,c.set(n,1);let u=33,d=0;for(;u>1&&c[d]===0&&!(c[d+1]&128);--u,++d);return c=c.subarray(d),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(e.outputlen=6+o+u,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+o]=2,i[5+o]=c.length,i.set(c,6+o),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let i=t.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new Ne(i);o.cmp(ge.n)>=0&&(o=new Ne(0));let a=new Ne(t.subarray(6+r));return a.cmp(ge.n)>=0&&(a=new Ne(0)),e.set(o.toArrayLike(Uint8Array,"be",32),0),e.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t){let r=new Ne(t);return r.cmp(ge.n)>=0||r.isZero()?null:vi.sign(e,t,{canonical:!0}).toBytes()},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},i=new Ne(n.r),s=new Ne(n.s);if(i.cmp(ge.n)>=0||s.cmp(ge.n)>=0)return 1;if(s.cmp(vi.nh)===1||i.isZero()||s.isZero())return 3;let o=Es(r);if(o===null)return 2;let a=o.getPublic();return vi.verify(t,n,a)},ecdsaRecover(e,t,r,n){let i={r:e.slice(0,32),s:e.slice(32,64)},s=new Ne(i.r),o=new Ne(i.s);if(s.cmp(ge.n)>=0||o.cmp(ge.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=vi.recoverPubKey(r,i,t,null)}catch{return 2}return p.Buffer.from(a.encode(null,n))},ecdh(e,t,r,n,i,s,o){let a=Es(t);if(a===null)return 1;let c=new Ne(r);if(c.cmp(ge.n)>=0||c.isZero())return 2;let u=a.getPublic().mul(c);if(i===void 0){let d=u.encode(null,!0),f=vi.hash().update(d).digest();for(let b=0;b<32;++b)e[b]=f[b]}else{s||(s=new Uint8Array(32));let d=u.getX().toArray("be",32);for(let y=0;y<32;++y)s[y]=d[y];o||(o=new Uint8Array(32));let f=u.getY().toArray("be",32);for(let y=0;y<32;++y)o[y]=f[y];let b=i(s,o,n);if(!(b instanceof Uint8Array&&b.length===e.length))return 2;e.set(b)}return 0}}});var Vg=H(dr=>{w();S();var R6=dr&&dr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),U6=dr&&dr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),q6=dr&&dr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&R6(t,e,r);return U6(t,e),t};Object.defineProperty(dr,"__esModule",{value:!0});dr.fromSeed=dr.fromPublicKey=dr.fromPrivateKey=dr.fromBase58=dr.tinySecp256k1Interface=void 0;var xl=q6(nc()),L6=Bd(),K6=hu(),jg=(0,L6.base58check)(K6.sha256),Fg=Kg(),Tr=sw(),D6=ow();function j6(e){return{isPoint:t=>e.publicKeyVerify(t),isPrivate:t=>e.privateKeyVerify(t),pointAddScalar:(t,r,n)=>e.publicKeyTweakAdd(t,r,n),pointFromScalar:(t,r)=>e.publicKeyCreate(t,r),privateAdd:(t,r)=>e.privateKeyTweakAdd(new Uint8Array(t),r),sign:(t,r)=>e.ecdsaSign(t,r),verify:(t,r,n)=>e.ecdsaVerify(n,t,r)}}function F6(e){return{isPoint:t=>e.publicKeyVerify(t),pointCompress:(t,r)=>Uint8Array.from(e.publicKeyConvert(t,r??!0)),isPrivate:t=>e.privateKeyVerify(t),pointFromScalar:(t,r)=>{let n=e.publicKeyCreate(t,r??!0);return n==null?null:Uint8Array.from(n)},sign:(t,r,n)=>Uint8Array.from(e.ecdsaSign(t,r)),verify:(t,r,n,i)=>e.ecdsaVerify(n,t,r)}}var As=j6(Fg);dr.tinySecp256k1Interface=F6(Fg);var Pl=Tr.BufferN(32),G6=Tr.compile({wif:Tr.UInt8,bip32:{public:Tr.UInt32,private:Tr.UInt32}}),ku={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},Dg=2147483648,V6=Math.pow(2,31)-1;function W6(e){return Tr.String(e)&&e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function z6(e){return Tr.UInt32(e)&&e<=V6}var Mu=class{constructor(t,r,n,i,s=0,o=0,a=0){this.__D=t,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=o,this.__PARENT_FINGERPRINT=a,Tr(G6,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=p.Buffer.from(As.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return p.Buffer.from(xl.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return Cu(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=p.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),jg.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return D6.encode(this.network.wif,this.privateKey,!0)}derive(t){Tr(Tr.UInt32,t);let r=t>=Dg,n=p.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(t,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(t,33);let i=xl.hmacSHA512(this.chainCode,n),s=i.slice(0,32),o=i.slice(32);if(!As.isPrivate(s))return this.derive(t+1);let a;if(this.isNeutered()){let c=As.pointAddScalar(this.publicKey,s,!0);if(c===null)return this.derive(t+1);a=Cu(c,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{let c=As.privateAdd(this.privateKey,s);if(c==null)return this.derive(t+1);a=Tl(c,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return a}deriveHardened(t){return Tr(z6,t),this.derive(t+Dg)}derivePath(t){Tr(W6,t);let r=t.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(t){if(!this.privateKey)throw new Error("Missing private key");return As.sign(t,this.privateKey)}verify(t,r){return As.verify(t,this.publicKey,r)}};function X6(e,t){let r=p.Buffer.from(jg.decode(e));if(r.length!==78)throw new TypeError("Invalid buffer length");t=t||ku;let n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let o=r.readUInt32BE(9);if(i===0&&o!==0)throw new TypeError("Invalid index");let a=r.slice(13,45),c;if(n===t.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let u=r.slice(46,78);c=Tl(u,a,t,i,o,s)}else{let u=r.slice(45,78);c=Cu(u,a,t,i,o,s)}return c}dr.fromBase58=X6;function Gg(e,t,r){return Tl(e,t,r)}dr.fromPrivateKey=Gg;function Tl(e,t,r,n,i,s){if(Tr({privateKey:Pl,chainCode:Pl},{privateKey:e,chainCode:t}),r=r||ku,!As.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new Mu(e,void 0,t,r,n,i,s)}function Y6(e,t,r){return Cu(e,t,r)}dr.fromPublicKey=Y6;function Cu(e,t,r,n,i,s){if(Tr({publicKey:Tr.BufferN(33),chainCode:Pl},{publicKey:e,chainCode:t}),r=r||ku,!As.isPoint(e))throw new TypeError("Point is not on the curve");return new Mu(void 0,e,t,r,n,i,s)}function $6(e,t){if(Tr(Tr.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||ku;let r=xl.hmacSHA512(p.Buffer.from("Bitcoin seed","utf8"),e),n=r.slice(0,32),i=r.slice(32);return Gg(n,i,t)}dr.fromSeed=$6});var Wg=H(Hu=>{w();S();Object.defineProperty(Hu,"__esModule",{value:!0});Hu.fromSeedV2=void 0;var Z6=aw();function J6(e,t){return Z6.HDKey.fromMasterSeed(new Uint8Array([...e])).derive(t)}Hu.fromSeedV2=J6});var zg=H(en=>{w();S();Object.defineProperty(en,"__esModule",{value:!0});en.fromSeedV2=en.fromPrivateKey=en.fromPublicKey=en.fromBase58=en.fromSeed=en.tinySecp256k1Interface=void 0;var cc=Vg();Object.defineProperty(en,"tinySecp256k1Interface",{enumerable:!0,get:function(){return cc.tinySecp256k1Interface}});Object.defineProperty(en,"fromSeed",{enumerable:!0,get:function(){return cc.fromSeed}});Object.defineProperty(en,"fromBase58",{enumerable:!0,get:function(){return cc.fromBase58}});Object.defineProperty(en,"fromPublicKey",{enumerable:!0,get:function(){return cc.fromPublicKey}});Object.defineProperty(en,"fromPrivateKey",{enumerable:!0,get:function(){return cc.fromPrivateKey}});var Q6=Wg();Object.defineProperty(en,"fromSeedV2",{enumerable:!0,get:function(){return Q6.fromSeedV2}})});var Xg=H((ck,e4)=>{e4.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var Al=H(co=>{w();S();Object.defineProperty(co,"__esModule",{value:!0});co._default=co.wordlists=void 0;var El={};co.wordlists=El;var Nu;co._default=Nu;try{co._default=Nu=Xg(),El.english=Nu,El.EN=Nu}catch{}});var Il=H(at=>{w();S();Object.defineProperty(at,"__esModule",{value:!0});at.wordlists=at.getDefaultWordlist=at.setDefaultWordlist=at.validateMnemonic=at.generateMnemonic=at.entropyToMnemonic=at.mnemonicToEntropy=at.mnemonicToSeedV2=at.mnemonicToSeed=at.mnemonicToSeedSync=void 0;var $g=nc(),Zg=mu(),Ru=Al(),Jg=$a(),t4=cw(),aa=Ru._default,Yg="Invalid mnemonic",uo="Invalid entropy",r4="Invalid mnemonic checksum",Qg=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function n4(e,t,r,n,i){let s=(0,Zg.pbkdf2)(Jg.sha512,e,t,{c:r,dkLen:n});return Promise.resolve(p.Buffer.from(s))}function uc(e){return(e||"").normalize("NFKD")}function ey(e,t,r){for(;e.length<r;)e=t+e;return e}function ty(e){return parseInt(e,2)}function ry(e){return e.map(t=>ey(t.toString(2),"0",8)).join("")}function ny(e){let r=e.length*8/32,n=(0,$g.sha256)(e);return ry(Array.from(n)).slice(0,r)}function iy(e){return"mnemonic"+(e||"")}function i4(e,t){let r=p.Buffer.from(uc(e),"utf8"),n=p.Buffer.from(iy(uc(t)),"utf8"),i=(0,Zg.pbkdf2)(Jg.sha512,r,n,{c:2048,dkLen:64});return p.Buffer.from(i)}at.mnemonicToSeedSync=i4;function s4(e,t){return Promise.resolve().then(()=>{let r=p.Buffer.from(uc(e),"utf8"),n=p.Buffer.from(iy(uc(t)),"utf8");return n4(r,n,2048,64,"sha512")})}at.mnemonicToSeed=s4;async function o4(e,t){let r=e.split(" ").map(s=>aa.indexOf(s)),n=new Uint8Array(new Uint16Array(r).buffer),i=await(0,t4.mnemonicToSeed)(n,t);return p.Buffer.from(i)}at.mnemonicToSeedV2=o4;function sy(e,t){if(t=t||aa,!t)throw new Error(Qg);let r=uc(e).split(" ");if(r.length%3!==0)throw new Error(Yg);let n=r.map(d=>{let f=t.indexOf(d);if(f===-1)throw new Error(Yg);return ey(f.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),o=n.slice(i),a=s.match(/(.{1,8})/g).map(ty);if(a.length<16)throw new Error(uo);if(a.length>32)throw new Error(uo);if(a.length%4!==0)throw new Error(uo);let c=p.Buffer.from(a);if(ny(c)!==o)throw new Error(r4);return c.toString("hex")}at.mnemonicToEntropy=sy;function oy(e,t){if(p.Buffer.isBuffer(e)||(e=p.Buffer.from(e,"hex")),t=t||aa,!t)throw new Error(Qg);if(e.length<16)throw new TypeError(uo);if(e.length>32)throw new TypeError(uo);if(e.length%4!==0)throw new TypeError(uo);let r=ry(Array.from(e)),n=ny(e),o=(r+n).match(/(.{1,11})/g).map(a=>{let c=ty(a);return t[c]});return t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?o.join("\u3000"):o.join(" ")}at.entropyToMnemonic=oy;function a4(e,t,r){if(e=e||128,e%32!==0)throw new TypeError(uo);return t=t||$g.randomBytes,oy(t(e/8),r)}at.generateMnemonic=a4;function c4(e,t){try{sy(e,t)}catch{return!1}return!0}at.validateMnemonic=c4;function u4(e){let t=Ru.wordlists[e];if(t)aa=t;else throw new Error('Could not find wordlist for language "'+e+'"')}at.setDefaultWordlist=u4;function f4(){if(!aa)throw new Error("No Default Wordlist set");return Object.keys(Ru.wordlists).filter(e=>e==="JA"||e==="EN"?!1:Ru.wordlists[e].every((t,r)=>t===aa[r]))[0]}at.getDefaultWordlist=f4;var d4=Al();Object.defineProperty(at,"wordlists",{enumerable:!0,get:function(){return d4.wordlists}})});var ly=H(me=>{w();S();var l4=me&&me.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),h4=me&&me.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p4=me&&me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&l4(t,e,r);return h4(t,e),t},b4=me&&me.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(me,"__esModule",{value:!0});me.loadUncompressedPublicKey=me.loadCompressedPublicKey=me.publicKeyConvert=me.publicKeyCreate=me.publicKeyVerify=me.privateKeyVerify=me.loadPublicKey=me.recover=me.verifyWithNoRecovery=me.verify=me.getV=me.sign=void 0;var g4=p4(oa()),rr=new g4.ec("secp256k1"),ay=nc(),ca=b4(Jr());function y4(e,t,r=!0){let n=rr.sign(Array.from(e),p.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}me.sign=y4;function m4(e,t,r,n,i=!0){let s=fc(n);if(s==null)throw new Error("pubkey error");let o=rr.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return rr.getKeyRecoveryParam(e,{r:t,s:r},o,i)}me.getV=m4;function _4(e,t,r,n){let i=cy(t,r,e,!0);if(i==null)return!1;let s=uy(n,!0);return s==null?!1:i.equals(s)}me.verify=_4;function v4(e,t,r){let n=fc(r);if(n==null)throw new Error("pubkey error");let i=rr.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,ay.toHex)(t.slice(0,32)),s:(0,ay.toHex)(t.slice(32,64))};return i.verify(e,s)}me.verifyWithNoRecovery=v4;function cy(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new ca.default(i.r),o=new ca.default(i.s);if(s.cmp(rr.curve.n)>=0||o.cmp(rr.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=rr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return p.Buffer.from(a.encode(null,n))}me.recover=cy;function fc(e){let t=p.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:fy(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:dy(r,t.subarray(1,33),t.subarray(33,65));default:return null}}me.loadPublicKey=fc;function w4(e){let t=new ca.default(Array.from(e));return t.cmp(rr.curve.n)<0&&!t.isZero()}me.privateKeyVerify=w4;function S4(e){return fc(e)!==null}me.publicKeyVerify=S4;function x4(e,t){let r=rr.keyFromPrivate(Array.from(e),"bytes").getPublic();return p.Buffer.from(r.encode(null,t))}me.publicKeyCreate=x4;function uy(e,t){let r=fc(e);if(r==null)return null;let n=rr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return p.Buffer.from(n.encode(null,t))}me.publicKeyConvert=uy;function fy(e,t){let r=new ca.default(Array.from(t));if(r.cmp(rr.curve.p)>=0)return null;let n=r.toRed(rr.curve.red),i=n.redSqr().redIMul(n).redIAdd(rr.curve.b).redSqrt();e===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(rr.curve.b)).isZero()?{x:n,y:i}:null}me.loadCompressedPublicKey=fy;function dy(e,t,r){let n=new ca.default(Array.from(t)),i=new ca.default(Array.from(r));if(n.cmp(rr.curve.p)>=0||i.cmp(rr.curve.p)>=0)return null;let s=n.toRed(rr.curve.red),o=i.toRed(rr.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(rr.curve.b)).isZero()?{x:s,y:o}:null}me.loadUncompressedPublicKey=dy});var wy=H(ye=>{w();S();var P4=ye&&ye.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),T4=ye&&ye.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),hy=ye&&ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&P4(t,e,r);return T4(t,e),t},E4=ye&&ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ye,"__esModule",{value:!0});ye.ed25519_getDerivedPrivateKey=ye.isValidPath=ye.ed25519_getRandomPrivateKey=ye.ed25519SignTest=ye.fromSecret=ye.fromSeed=ye.privateKeyVerify=ye.publicKeyVerify=ye.publicKeyCreate=ye.verify=ye.sign=ye.ed25519MulBase=void 0;var py=hy(oa()),Qn=nc(),A4=E4(Jr()),I4=Il(),Ol=hy(X0()),O4=$a();Ol.utils.sha512Sync=(...e)=>(0,O4.sha512)(Ol.utils.concatBytes(...e));var Is=new py.eddsa("ed25519"),by=Is.curve;function B4(e){let t=Is.curve.g;return Is.encodePoint(t.mul(py.utils.intFromLE(e)))}ye.ed25519MulBase=B4;function gy(e,t){let r=t;r.length==64&&(r=r.slice(0,32));let n=Ol.sync.sign(e,r);return Uint8Array.from(n)}ye.sign=gy;function yy(e,t,r){return Is.keyFromPublic(Array.from(r)).verify(Array.from(e),Array.from(t))}ye.verify=yy;function Uu(e){let t=e;t.length==64&&(t=t.slice(0,32));let n=Is.keyFromSecret(Array.from(t)).getPublic();if(e.length==64&&!M4(e.slice(32,64),n))throw new Error("invalid public key");return Uint8Array.from(n)}ye.publicKeyCreate=Uu;function M4(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function C4(e){let t=Is.decodePoint(Array.from(e));return by.validate(t)}ye.publicKeyVerify=C4;function my(e){let t=new A4.default(Array.from(e));return t.cmp(by.n)<0&&!t.isZero()}ye.privateKeyVerify=my;function k4(e){let t=Is.keyFromSecret(Array.from(e)),r=Uint8Array.from(t.getPublic());return{publicKey:r,secretKey:(0,Qn.concatBytes)(e,r)}}ye.fromSeed=k4;function H4(e){let t=e.slice(0,32),r=Is.keyFromSecret(Array.from(t));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(t)}}ye.fromSecret=H4;function _y(e){let t=(0,Qn.sha256)("ed25519-test"),r=Uu(e),n=gy(t,e);return yy(t,n,r)}ye.ed25519SignTest=_y;function N4(e,t){for(;;){let r=(0,Qn.randomBytes)(32);if(my(r)&&_y(r)){let n=Uu(r),i=e?(0,Qn.concatBytes)(r,n):r;return t==="base58"?(0,Qn.toBase58)(i):(0,Qn.toHex)(i)}}}ye.ed25519_getRandomPrivateKey=N4;var R4=new RegExp("^m(\\/[0-9]+')+$"),vy=e=>e.replace("'",""),U4=2147483648;function q4(e){let t=(0,Qn.hmacSHA512)("ed25519 seed",e),r=t.slice(0,32),n=t.slice(32);return{key:r,chainCode:n}}function L4({key:e,chainCode:t},r){let n=p.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=p.Buffer.concat([p.Buffer.alloc(1,0),e,n]),s=(0,Qn.hmacSHA512)(t,i),o=s.slice(0,32),a=s.slice(32);return{key:o,chainCode:a}}var K4=e=>R4.test(e)?!e.split("/").slice(1).map(vy).some(isNaN):!1;ye.isValidPath=K4;function D4(e,t,r=U4){if(!(0,ye.isValidPath)(e))throw new Error("Invalid derivation path");let{key:n,chainCode:i}=q4(t);return e.split("/").slice(1).map(vy).map(o=>parseInt(o,10)).reduce((o,a)=>L4(o,a+r),{key:n,chainCode:i})}async function j4(e,t,r,n){let i=await(0,I4.mnemonicToSeedV2)(e),s=D4(t,i).key,o=Uu(s),a=r?(0,Qn.concatBytes)(s,o):s;return n==="base58"?Promise.resolve((0,Qn.toBase58)(a)):Promise.resolve((0,Qn.toHex)(a))}ye.ed25519_getDerivedPrivateKey=j4});var Ty=H(Be=>{w();S();var F4=Be&&Be.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),G4=Be&&Be.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),V4=Be&&Be.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&F4(t,e,r);return G4(t,e),t},W4=Be&&Be.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Be,"__esModule",{value:!0});Be.loadUncompressedPublicKey=Be.loadCompressedPublicKey=Be.publicKeyConvert=Be.publicKeyCreate=Be.publicKeyVerify=Be.privateKeyVerify=Be.loadPublicKey=Be.recover=Be.verify=Be.sign=void 0;var z4=V4(oa()),Gr=new z4.ec("p256"),ua=W4(Jr());function X4(e,t,r=!0){let n=Gr.sign(Array.from(e),p.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}Be.sign=X4;function Y4(e,t,r,n){let i=Sy(t,r,e,!1);return i==null?!1:i.equals(n)}Be.verify=Y4;function Sy(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new ua.default(i.r),o=new ua.default(i.s);if(s.cmp(Gr.curve.n)>=0||o.cmp(Gr.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=Gr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return p.Buffer.from(a.encode(null,n))}Be.recover=Sy;function Bl(e){let t=p.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:xy(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:Py(r,t.subarray(1,33),t.subarray(33,65));default:return null}}Be.loadPublicKey=Bl;function $4(e){let t=new ua.default(Array.from(e));return t.cmp(Gr.curve.n)<0&&!t.isZero()}Be.privateKeyVerify=$4;function Z4(e){return Bl(e)!==null}Be.publicKeyVerify=Z4;function J4(e,t){let r=Gr.keyFromPrivate(Array.from(e),"bytes").getPublic();return p.Buffer.from(r.encode(null,t))}Be.publicKeyCreate=J4;function Q4(e,t){let r=Bl(e);if(r==null)return null;let n=Gr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return p.Buffer.from(n.encode(null,t))}Be.publicKeyConvert=Q4;function xy(e,t){let r=new ua.default(Array.from(t));if(r.cmp(Gr.curve.p)>=0)return null;let n=r.toRed(Gr.curve.red),i=n.redSqr().redIMul(n).redIAdd(Gr.curve.b).redSqrt();return e===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}Be.loadCompressedPublicKey=xy;function Py(e,t,r){let n=new ua.default(Array.from(t)),i=new ua.default(Array.from(r));if(n.cmp(Gr.curve.p)>=0||i.cmp(Gr.curve.p)>=0)return null;let s=n.toRed(Gr.curve.red),o=i.toRed(Gr.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(Gr.curve.b)).isZero()?{x:s,y:o}:null}Be.loadUncompressedPublicKey=Py});var $i=H(ae=>{w();S();Object.defineProperty(ae,"__esModule",{value:!0});ae.validateObject=ae.createHmacDrbg=ae.bitMask=ae.bitSet=ae.bitGet=ae.bitLen=ae.utf8ToBytes=ae.equalBytes=ae.concatBytes=ae.ensureBytes=ae.numberToVarBytesBE=ae.numberToBytesLE=ae.numberToBytesBE=ae.bytesToNumberLE=ae.bytesToNumberBE=ae.hexToBytes=ae.hexToNumber=ae.numberToHexUnpadded=ae.bytesToHex=void 0;var Ay=BigInt(0),qu=BigInt(1),e8=BigInt(2),Lu=e=>e instanceof Uint8Array,t8=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Cl(e){if(!Lu(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=t8[e[r]];return t}ae.bytesToHex=Cl;function Iy(e){let t=e.toString(16);return t.length&1?`0${t}`:t}ae.numberToHexUnpadded=Iy;function kl(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}ae.hexToNumber=kl;function Ku(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");t[r]=s}return t}ae.hexToBytes=Ku;function r8(e){return kl(Cl(e))}ae.bytesToNumberBE=r8;function n8(e){if(!Lu(e))throw new Error("Uint8Array expected");return kl(Cl(Uint8Array.from(e).reverse()))}ae.bytesToNumberLE=n8;var i8=(e,t)=>Ku(e.toString(16).padStart(t*2,"0"));ae.numberToBytesBE=i8;var s8=(e,t)=>(0,ae.numberToBytesBE)(e,t).reverse();ae.numberToBytesLE=s8;var o8=e=>Ku(Iy(e));ae.numberToVarBytesBE=o8;function a8(e,t,r){let n;if(typeof t=="string")try{n=Ku(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Lu(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}ae.ensureBytes=a8;function Oy(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Lu(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}ae.concatBytes=Oy;function c8(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}ae.equalBytes=c8;function u8(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}ae.utf8ToBytes=u8;function f8(e){let t;for(t=0;e>Ay;e>>=qu,t+=1);return t}ae.bitLen=f8;var d8=(e,t)=>e>>BigInt(t)&qu;ae.bitGet=d8;var l8=(e,t,r)=>e|(r?qu:Ay)<<BigInt(t);ae.bitSet=l8;var h8=e=>(e8<<BigInt(e-1))-qu;ae.bitMask=h8;var Ml=e=>new Uint8Array(e),Ey=e=>Uint8Array.from(e);function p8(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Ml(e),i=Ml(e),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...f)=>r(i,n,...f),c=(f=Ml())=>{i=a(Ey([0]),f),n=a(),f.length!==0&&(i=a(Ey([1]),f),n=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,b=[];for(;f<t;){n=a();let m=n.slice();b.push(m),f+=n.length}return Oy(...b)};return(f,b)=>{o(),c(f);let m;for(;!(m=b(u()));)c();return o(),m}}ae.createHmacDrbg=p8;var b8={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function g8(e,t,r={}){let n=(i,s,o)=>{let a=b8[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=e[i];if(!(o&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}ae.validateObject=g8});var fo=H(be=>{w();S();Object.defineProperty(be,"__esModule",{value:!0});be.hashToPrivateScalar=be.FpSqrtEven=be.FpSqrtOdd=be.Field=be.nLength=be.FpIsSquare=be.FpDiv=be.FpInvertBatch=be.FpPow=be.validateField=be.isNegativeLE=be.FpSqrt=be.tonelliShanks=be.invert=be.pow2=be.pow=be.mod=void 0;var Zi=$i(),nr=BigInt(0),Ve=BigInt(1),Os=BigInt(2),y8=BigInt(3),Hl=BigInt(4),By=BigInt(5),My=BigInt(8),m8=BigInt(9),_8=BigInt(16);function En(e,t){let r=e%t;return r>=nr?r:t+r}be.mod=En;function Cy(e,t,r){if(r<=nr||t<nr)throw new Error("Expected power/modulo > 0");if(r===Ve)return nr;let n=Ve;for(;t>nr;)t&Ve&&(n=n*e%r),e=e*e%r,t>>=Ve;return n}be.pow=Cy;function v8(e,t,r){let n=e;for(;t-- >nr;)n*=n,n%=r;return n}be.pow2=v8;function Du(e,t){if(e===nr||t<=nr)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=En(e,t),n=t,i=nr,s=Ve,o=Ve,a=nr;for(;r!==nr;){let u=n/r,d=n%r,f=i-o*u,b=s-a*u;n=r,r=d,i=o,s=a,o=f,a=b}if(n!==Ve)throw new Error("invert: does not exist");return En(i,t)}be.invert=Du;function ky(e){let t=(e-Ve)/Os,r,n,i;for(r=e-Ve,n=0;r%Os===nr;r/=Os,n++);for(i=Os;i<e&&Cy(i,t,e)!==e-Ve;i++);if(n===1){let o=(e+Ve)/Hl;return function(c,u){let d=c.pow(u,o);if(!c.eql(c.sqr(d),u))throw new Error("Cannot find square root");return d}}let s=(r+Ve)/Os;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,d=a.pow(a.mul(a.ONE,i),r),f=a.pow(c,s),b=a.pow(c,r);for(;!a.eql(b,a.ONE);){if(a.eql(b,a.ZERO))return a.ZERO;let m=1;for(let _=a.sqr(b);m<u&&!a.eql(_,a.ONE);m++)_=a.sqr(_);let y=a.pow(d,Ve<<BigInt(u-m-1));d=a.sqr(y),f=a.mul(f,y),b=a.mul(b,d),u=m}return f}}be.tonelliShanks=ky;function Hy(e){if(e%Hl===y8){let t=(e+Ve)/Hl;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%My===By){let t=(e-By)/My;return function(n,i){let s=n.mul(i,Os),o=n.pow(s,t),a=n.mul(i,o),c=n.mul(n.mul(a,Os),o),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%_8,ky(e)}be.FpSqrt=Hy;var w8=(e,t)=>(En(e,t)&Ve)===Ve;be.isNegativeLE=w8;var S8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function x8(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=S8.reduce((n,i)=>(n[i]="function",n),t);return(0,Zi.validateObject)(e,r)}be.validateField=x8;function Ny(e,t,r){if(r<nr)throw new Error("Expected power > 0");if(r===nr)return e.ONE;if(r===Ve)return t;let n=e.ONE,i=t;for(;r>nr;)r&Ve&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Ve;return n}be.FpPow=Ny;function Ry(e,t){let r=new Array(t.length),n=t.reduce((s,o,a)=>e.is0(o)?s:(r[a]=s,e.mul(s,o)),e.ONE),i=e.inv(n);return t.reduceRight((s,o,a)=>e.is0(o)?s:(r[a]=e.mul(s,r[a]),e.mul(s,o)),i),r}be.FpInvertBatch=Ry;function P8(e,t,r){return e.mul(t,typeof r=="bigint"?Du(r,e.ORDER):e.inv(r))}be.FpDiv=P8;function T8(e){let t=(e.ORDER-Ve)/Os;return r=>{let n=e.pow(r,t);return e.eql(n,e.ZERO)||e.eql(n,e.ONE)}}be.FpIsSquare=T8;function Nl(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}be.nLength=Nl;function E8(e,t,r=!1,n={}){if(e<=nr)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=Nl(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Hy(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:(0,Zi.bitMask)(i),ZERO:nr,ONE:Ve,create:c=>En(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return nr<=c&&c<e},is0:c=>c===nr,isOdd:c=>(c&Ve)===Ve,neg:c=>En(-c,e),eql:(c,u)=>c===u,sqr:c=>En(c*c,e),add:(c,u)=>En(c+u,e),sub:(c,u)=>En(c-u,e),mul:(c,u)=>En(c*u,e),pow:(c,u)=>Ny(a,c,u),div:(c,u)=>En(c*Du(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Du(c,e),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>Ry(a,c),cmov:(c,u,d)=>d?u:c,toBytes:c=>r?(0,Zi.numberToBytesLE)(c,s):(0,Zi.numberToBytesBE)(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?(0,Zi.bytesToNumberLE)(c):(0,Zi.bytesToNumberBE)(c)}});return Object.freeze(a)}be.Field=E8;function A8(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}be.FpSqrtOdd=A8;function I8(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}be.FpSqrtEven=I8;function O8(e,t,r=!1){e=(0,Zi.ensureBytes)("privateHash",e);let n=e.length,i=Nl(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,Zi.bytesToNumberLE)(e):(0,Zi.bytesToNumberBE)(e);return En(s,t-Ve)+Ve}be.hashToPrivateScalar=O8});var qy=H(fa=>{w();S();Object.defineProperty(fa,"__esModule",{value:!0});fa.validateBasic=fa.wNAF=void 0;var Uy=fo(),B8=$i(),M8=BigInt(0),Rl=BigInt(1);function C8(e,t){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(t/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=e.ZERO,a=i;for(;s>M8;)s&Rl&&(o=o.add(a)),a=a.double(),s>>=Rl;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),c=[],u=i,d=u;for(let f=0;f<o;f++){d=u,c.push(d);for(let b=1;b<a;b++)d=d.add(u),c.push(d);u=d.double()}return c},wNAF(i,s,o){let{windows:a,windowSize:c}=n(i),u=e.ZERO,d=e.BASE,f=BigInt(2**i-1),b=2**i,m=BigInt(i);for(let y=0;y<a;y++){let _=y*c,E=Number(o&f);o>>=m,E>c&&(E-=b,o+=Rl);let I=_,k=_+Math.abs(E)-1,C=y%2!==0,U=E<0;E===0?d=d.add(r(C,s[I])):u=u.add(r(U,s[k]))}return{p:u,f:d}},wNAFCached(i,s,o,a){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,a(u))),this.wNAF(c,u,o)}}}fa.wNAF=C8;function k8(e){return(0,Uy.validateField)(e.Fp),(0,B8.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Uy.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}fa.validateBasic=k8});var Fu=H(We=>{w();S();var H8=We&&We.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),N8=We&&We.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ky=We&&We.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&H8(t,e,r);return N8(t,e),t};Object.defineProperty(We,"__esModule",{value:!0});We.mapToCurveSimpleSWU=We.SWUFpSqrtRatio=We.weierstrass=We.weierstrassPoints=We.DER=void 0;var dc=Ky(fo()),Vt=Ky($i()),wi=$i(),Ul=qy();function R8(e){let t=(0,Ul.validateBasic)(e);Vt.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:U8,hexToBytes:q8}=Vt;We.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=We.DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:U8(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=We.DER,r=typeof e=="string"?q8(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=We.DER._parseInt(r.subarray(2)),{d:o,l:a}=We.DER._parseInt(s);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let d=u.toString(16);return d.length&1?`0${d}`:d},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,o=i.length/2,a=r(s),c=r(o);return`30${r(o+s+4)}02${c}${i}02${a}${n}`}};var ei=BigInt(0),ct=BigInt(1),Bs=BigInt(2),ju=BigInt(3),Ly=BigInt(4);function Dy(e){let t=R8(e),{Fp:r}=t,n=t.toBytes||((y,_,E)=>{let I=_.toAffine();return Vt.concatBytes(Uint8Array.from([4]),r.toBytes(I.x),r.toBytes(I.y))}),i=t.fromBytes||(y=>{let _=y.subarray(1),E=r.fromBytes(_.subarray(0,r.BYTES)),I=r.fromBytes(_.subarray(r.BYTES,2*r.BYTES));return{x:E,y:I}});function s(y){let{a:_,b:E}=t,I=r.sqr(y),k=r.mul(I,y);return r.add(r.add(k,r.mul(y,_)),E)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(y){return typeof y=="bigint"&&ei<y&&y<t.n}function a(y){if(!o(y))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(y){let{allowedPrivateKeyLengths:_,nByteLength:E,wrapPrivateKey:I,n:k}=t;if(_&&typeof y!="bigint"){if(y instanceof Uint8Array&&(y=Vt.bytesToHex(y)),typeof y!="string"||!_.includes(y.length))throw new Error("Invalid key");y=y.padStart(E*2,"0")}let C;try{C=typeof y=="bigint"?y:Vt.bytesToNumberBE((0,wi.ensureBytes)("private key",y,E))}catch{throw new Error(`private key must be ${E} bytes, hex or bigint, not ${typeof y}`)}return I&&(C=dc.mod(C,k)),a(C),C}let u=new Map;function d(y){if(!(y instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(_,E,I){if(this.px=_,this.py=E,this.pz=I,_==null||!r.isValid(_))throw new Error("x required");if(E==null||!r.isValid(E))throw new Error("y required");if(I==null||!r.isValid(I))throw new Error("z required")}static fromAffine(_){let{x:E,y:I}=_||{};if(!_||!r.isValid(E)||!r.isValid(I))throw new Error("invalid affine point");if(_ instanceof f)throw new Error("projective point not allowed");let k=C=>r.eql(C,r.ZERO);return k(E)&&k(I)?f.ZERO:new f(E,I,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){let E=r.invertBatch(_.map(I=>I.pz));return _.map((I,k)=>I.toAffine(E[k])).map(f.fromAffine)}static fromHex(_){let E=f.fromAffine(i((0,wi.ensureBytes)("pointHex",_)));return E.assertValidity(),E}static fromPrivateKey(_){return f.BASE.multiply(c(_))}_setWindowSize(_){this._WINDOW_SIZE=_,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:_,y:E}=this.toAffine();if(!r.isValid(_)||!r.isValid(E))throw new Error("bad point: x or y not FE");let I=r.sqr(E),k=s(_);if(!r.eql(I,k))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:_}=this.toAffine();if(r.isOdd)return!r.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){d(_);let{px:E,py:I,pz:k}=this,{px:C,py:U,pz:R}=_,q=r.eql(r.mul(E,R),r.mul(C,k)),L=r.eql(r.mul(I,R),r.mul(U,k));return q&&L}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){let{a:_,b:E}=t,I=r.mul(E,ju),{px:k,py:C,pz:U}=this,R=r.ZERO,q=r.ZERO,L=r.ZERO,K=r.mul(k,k),W=r.mul(C,C),O=r.mul(U,U),l=r.mul(k,C);return l=r.add(l,l),L=r.mul(k,U),L=r.add(L,L),R=r.mul(_,L),q=r.mul(I,O),q=r.add(R,q),R=r.sub(W,q),q=r.add(W,q),q=r.mul(R,q),R=r.mul(l,R),L=r.mul(I,L),O=r.mul(_,O),l=r.sub(K,O),l=r.mul(_,l),l=r.add(l,L),L=r.add(K,K),K=r.add(L,K),K=r.add(K,O),K=r.mul(K,l),q=r.add(q,K),O=r.mul(C,U),O=r.add(O,O),K=r.mul(O,l),R=r.sub(R,K),L=r.mul(O,W),L=r.add(L,L),L=r.add(L,L),new f(R,q,L)}add(_){d(_);let{px:E,py:I,pz:k}=this,{px:C,py:U,pz:R}=_,q=r.ZERO,L=r.ZERO,K=r.ZERO,W=t.a,O=r.mul(t.b,ju),l=r.mul(E,C),g=r.mul(I,U),v=r.mul(k,R),P=r.add(E,I),x=r.add(C,U);P=r.mul(P,x),x=r.add(l,g),P=r.sub(P,x),x=r.add(E,k);let B=r.add(C,R);return x=r.mul(x,B),B=r.add(l,v),x=r.sub(x,B),B=r.add(I,k),q=r.add(U,R),B=r.mul(B,q),q=r.add(g,v),B=r.sub(B,q),K=r.mul(W,x),q=r.mul(O,v),K=r.add(q,K),q=r.sub(g,K),K=r.add(g,K),L=r.mul(q,K),g=r.add(l,l),g=r.add(g,l),v=r.mul(W,v),x=r.mul(O,x),g=r.add(g,v),v=r.sub(l,v),v=r.mul(W,v),x=r.add(x,v),l=r.mul(g,x),L=r.add(L,l),l=r.mul(B,x),q=r.mul(P,q),q=r.sub(q,l),l=r.mul(P,g),K=r.mul(B,K),K=r.add(K,l),new f(q,L,K)}subtract(_){return this.add(_.negate())}is0(){return this.equals(f.ZERO)}wNAF(_){return m.wNAFCached(this,u,_,E=>{let I=r.invertBatch(E.map(k=>k.pz));return E.map((k,C)=>k.toAffine(I[C])).map(f.fromAffine)})}multiplyUnsafe(_){let E=f.ZERO;if(_===ei)return E;if(a(_),_===ct)return this;let{endo:I}=t;if(!I)return m.unsafeLadder(this,_);let{k1neg:k,k1:C,k2neg:U,k2:R}=I.splitScalar(_),q=E,L=E,K=this;for(;C>ei||R>ei;)C&ct&&(q=q.add(K)),R&ct&&(L=L.add(K)),K=K.double(),C>>=ct,R>>=ct;return k&&(q=q.negate()),U&&(L=L.negate()),L=new f(r.mul(L.px,I.beta),L.py,L.pz),q.add(L)}multiply(_){a(_);let E=_,I,k,{endo:C}=t;if(C){let{k1neg:U,k1:R,k2neg:q,k2:L}=C.splitScalar(E),{p:K,f:W}=this.wNAF(R),{p:O,f:l}=this.wNAF(L);K=m.constTimeNegate(U,K),O=m.constTimeNegate(q,O),O=new f(r.mul(O.px,C.beta),O.py,O.pz),I=K.add(O),k=W.add(l)}else{let{p:U,f:R}=this.wNAF(E);I=U,k=R}return f.normalizeZ([I,k])[0]}multiplyAndAddUnsafe(_,E,I){let k=f.BASE,C=(R,q)=>q===ei||q===ct||!R.equals(k)?R.multiplyUnsafe(q):R.multiply(q),U=C(this,E).add(C(_,I));return U.is0()?void 0:U}toAffine(_){let{px:E,py:I,pz:k}=this,C=this.is0();_==null&&(_=C?r.ONE:r.inv(k));let U=r.mul(E,_),R=r.mul(I,_),q=r.mul(k,_);if(C)return{x:r.ZERO,y:r.ZERO};if(!r.eql(q,r.ONE))throw new Error("invZ was invalid");return{x:U,y:R}}isTorsionFree(){let{h:_,isTorsionFree:E}=t;if(_===ct)return!0;if(E)return E(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:_,clearCofactor:E}=t;return _===ct?this:E?E(f,this):this.multiplyUnsafe(t.h)}toRawBytes(_=!0){return this.assertValidity(),n(f,this,_)}toHex(_=!0){return Vt.bytesToHex(this.toRawBytes(_))}}f.BASE=new f(t.Gx,t.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);let b=t.nBitLength,m=(0,Ul.wNAF)(f,t.endo?Math.ceil(b/2):b);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}We.weierstrassPoints=Dy;function L8(e){let t=(0,Ul.validateBasic)(e);return Vt.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function K8(e){let t=L8(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function o(x){return ei<x&&x<r.ORDER}function a(x){return dc.mod(x,n)}function c(x){return dc.invert(x,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:b}=Dy({...t,toBytes(x,B,M){let T=B.toAffine(),h=r.toBytes(T.x),A=Vt.concatBytes;return M?A(Uint8Array.from([B.hasEvenY()?2:3]),h):A(Uint8Array.from([4]),h,r.toBytes(T.y))},fromBytes(x){let B=x.length,M=x[0],T=x.subarray(1);if(B===i&&(M===2||M===3)){let h=Vt.bytesToNumberBE(T);if(!o(h))throw new Error("Point is not on curve");let A=f(h),j=r.sqrt(A),D=(j&ct)===ct;return(M&1)===1!==D&&(j=r.neg(j)),{x:h,y:j}}else if(B===s&&M===4){let h=r.fromBytes(T.subarray(0,r.BYTES)),A=r.fromBytes(T.subarray(r.BYTES,2*r.BYTES));return{x:h,y:A}}else throw new Error(`Point of length ${B} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),m=x=>Vt.bytesToHex(Vt.numberToBytesBE(x,t.nByteLength));function y(x){let B=n>>ct;return x>B}function _(x){return y(x)?a(-x):x}let E=(x,B,M)=>Vt.bytesToNumberBE(x.slice(B,M));class I{constructor(B,M,T){this.r=B,this.s=M,this.recovery=T,this.assertValidity()}static fromCompact(B){let M=t.nByteLength;return B=(0,wi.ensureBytes)("compactSignature",B,M*2),new I(E(B,0,M),E(B,M,2*M))}static fromDER(B){let{r:M,s:T}=We.DER.toSig((0,wi.ensureBytes)("DER",B));return new I(M,T)}assertValidity(){if(!b(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!b(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(B){return new I(this.r,this.s,B)}recoverPublicKey(B){let{r:M,s:T,recovery:h}=this,A=L((0,wi.ensureBytes)("msgHash",B));if(h==null||![0,1,2,3].includes(h))throw new Error("recovery id invalid");let j=h===2||h===3?M+t.n:M;if(j>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let D=(h&1)===0?"02":"03",G=u.fromHex(D+m(j)),J=c(j),ue=a(-A*J),Se=a(T*J),vr=u.BASE.multiplyAndAddUnsafe(G,ue,Se);if(!vr)throw new Error("point at infinify");return vr.assertValidity(),vr}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Vt.hexToBytes(this.toDERHex())}toDERHex(){return We.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Vt.hexToBytes(this.toCompactHex())}toCompactHex(){return m(this.r)+m(this.s)}}let k={isValidPrivateKey(x){try{return d(x),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{let x=t.randomBytes(r.BYTES+8),B=dc.hashToPrivateScalar(x,n);return Vt.numberToBytesBE(B,t.nByteLength)},precompute(x=8,B=u.BASE){return B._setWindowSize(x),B.multiply(BigInt(3)),B}};function C(x,B=!0){return u.fromPrivateKey(x).toRawBytes(B)}function U(x){let B=x instanceof Uint8Array,M=typeof x=="string",T=(B||M)&&x.length;return B?T===i||T===s:M?T===2*i||T===2*s:x instanceof u}function R(x,B,M=!0){if(U(x))throw new Error("first arg must be private key");if(!U(B))throw new Error("second arg must be public key");return u.fromHex(B).multiply(d(x)).toRawBytes(M)}let q=t.bits2int||function(x){let B=Vt.bytesToNumberBE(x),M=x.length*8-t.nBitLength;return M>0?B>>BigInt(M):B},L=t.bits2int_modN||function(x){return a(q(x))},K=Vt.bitMask(t.nBitLength);function W(x){if(typeof x!="bigint")throw new Error("bigint expected");if(!(ei<=x&&x<K))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Vt.numberToBytesBE(x,t.nByteLength)}function O(x,B,M=l){if(["recovered","canonical"].some(xe=>xe in M))throw new Error("sign() legacy options not supported");let{hash:T,randomBytes:h}=t,{lowS:A,prehash:j,extraEntropy:D}=M;A==null&&(A=!0),x=(0,wi.ensureBytes)("msgHash",x),j&&(x=(0,wi.ensureBytes)("prehashed msgHash",T(x)));let G=L(x),J=d(B),ue=[W(J),W(G)];if(D!=null){let xe=D===!0?h(r.BYTES):D;ue.push((0,wi.ensureBytes)("extraEntropy",xe,r.BYTES))}let Se=Vt.concatBytes(...ue),vr=G;function Oe(xe){let Ri=q(xe);if(!b(Ri))return;let tt=c(Ri),Ee=u.BASE.multiply(Ri).toAffine(),Ui=a(Ee.x);if(Ui===ei)return;let De=a(tt*a(vr+Ui*J));if(De===ei)return;let rt=(Ee.x===Ui?0:2)|Number(Ee.y&ct),La=De;return A&&y(De)&&(La=_(De),rt^=1),new I(Ui,La,rt)}return{seed:Se,k2sig:Oe}}let l={lowS:t.lowS,prehash:!1},g={lowS:t.lowS,prehash:!1};function v(x,B,M=l){let{seed:T,k2sig:h}=O(x,B,M),A=t;return Vt.createHmacDrbg(A.hash.outputLen,A.nByteLength,A.hmac)(T,h)}u.BASE._setWindowSize(8);function P(x,B,M,T=g){let h=x;if(B=(0,wi.ensureBytes)("msgHash",B),M=(0,wi.ensureBytes)("publicKey",M),"strict"in T)throw new Error("options.strict was renamed to lowS");let{lowS:A,prehash:j}=T,D,G;try{if(typeof h=="string"||h instanceof Uint8Array)try{D=I.fromDER(h)}catch(Ee){if(!(Ee instanceof We.DER.Err))throw Ee;D=I.fromCompact(h)}else if(typeof h=="object"&&typeof h.r=="bigint"&&typeof h.s=="bigint"){let{r:Ee,s:Ui}=h;D=new I(Ee,Ui)}else throw new Error("PARSE");G=u.fromHex(M)}catch(Ee){if(Ee.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(A&&D.hasHighS())return!1;j&&(B=t.hash(B));let{r:J,s:ue}=D,Se=L(B),vr=c(ue),Oe=a(Se*vr),xe=a(J*vr),Ri=u.BASE.multiplyAndAddUnsafe(G,Oe,xe)?.toAffine();return Ri?a(Ri.x)===J:!1}return{CURVE:t,getPublicKey:C,getSharedSecret:R,sign:v,verify:P,ProjectivePoint:u,Signature:I,utils:k}}We.weierstrass=K8;function jy(e,t){let r=e.ORDER,n=ei;for(let y=r-ct;y%Bs===ei;y/=Bs)n+=ct;let i=n,s=Bs<<i-ct-ct,o=s*Bs,a=(r-ct)/o,c=(a-ct)/Bs,u=o-ct,d=s,f=e.pow(t,a),b=e.pow(t,(a+ct)/Bs),m=(y,_)=>{let E=f,I=e.pow(_,u),k=e.sqr(I);k=e.mul(k,_);let C=e.mul(y,k);C=e.pow(C,c),C=e.mul(C,I),I=e.mul(C,_),k=e.mul(C,y);let U=e.mul(k,I);C=e.pow(U,d);let R=e.eql(C,e.ONE);I=e.mul(k,b),C=e.mul(U,E),k=e.cmov(I,k,R),U=e.cmov(C,U,R);for(let q=i;q>ct;q--){let L=q-Bs;L=Bs<<L-ct;let K=e.pow(U,L),W=e.eql(K,e.ONE);I=e.mul(k,E),E=e.mul(E,E),K=e.mul(U,E),k=e.cmov(I,k,W),U=e.cmov(K,U,W)}return{isValid:R,value:k}};if(e.ORDER%Ly===ju){let y=(e.ORDER-ju)/Ly,_=e.sqrt(e.neg(t));m=(E,I)=>{let k=e.sqr(I),C=e.mul(E,I);k=e.mul(k,C);let U=e.pow(k,y);U=e.mul(U,C);let R=e.mul(U,_),q=e.mul(e.sqr(U),I),L=e.eql(q,E),K=e.cmov(R,U,L);return{isValid:L,value:K}}}return m}We.SWUFpSqrtRatio=jy;function D8(e,t){if(dc.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=jy(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,a,c,u,d,f;i=e.sqr(n),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),u=e.sqr(a),c=e.mul(u,t.A),s=e.add(s,c),s=e.mul(s,o),u=e.mul(u,a),c=e.mul(u,t.B),s=e.add(s,c),d=e.mul(i,o);let{isValid:b,value:m}=r(s,u);f=e.mul(i,n),f=e.mul(f,m),d=e.cmov(d,o,b),f=e.cmov(f,m,b);let y=e.isOdd(n)===e.isOdd(f);return f=e.cmov(e.neg(f),f,y),d=e.div(d,a),{x:d,y:f}}}We.mapToCurveSimpleSWU=D8});var zy=H(ut=>{w();S();Object.defineProperty(ut,"__esModule",{value:!0});ut.createHasher=ut.isogenyMap=ut.hash_to_field=ut.expand_message_xof=ut.expand_message_xmd=ut.isNum=ut.isBytes=ut.strxor=ut.i2osp=ut.validateDST=void 0;var j8=fo(),ti=$i();function Fy(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,ti.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}ut.validateDST=Fy;var F8=ti.bytesToNumberBE;function Ji(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}ut.i2osp=Ji;function Gy(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}ut.strxor=Gy;function da(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected")}ut.isBytes=da;function Gu(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}ut.isNum=Gu;function Vy(e,t,r,n){da(e),da(t),Gu(r),t.length>255&&(t=n((0,ti.concatBytes)((0,ti.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(o>255)throw new Error("Invalid xmd length");let a=(0,ti.concatBytes)(t,Ji(t.length,1)),c=Ji(0,s),u=Ji(r,2),d=new Array(o),f=n((0,ti.concatBytes)(c,e,u,Ji(0,1),a));d[0]=n((0,ti.concatBytes)(f,Ji(1,1),a));for(let m=1;m<=o;m++){let y=[Gy(f,d[m-1]),Ji(m+1,1),a];d[m]=n((0,ti.concatBytes)(...y))}return(0,ti.concatBytes)(...d).slice(0,r)}ut.expand_message_xmd=Vy;function Wy(e,t,r,n,i){if(da(e),da(t),Gu(r),t.length>255){let s=Math.ceil(2*n/8);t=i.create({dkLen:s}).update((0,ti.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(Ji(r,2)).update(t).update(Ji(t.length,1)).digest()}ut.expand_message_xof=Wy;function ql(e,t,r){(0,ti.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:o,expand:a,DST:c}=r;da(e),Gu(t);let u=Fy(c),d=n.toString(2).length,f=Math.ceil((d+i)/8),b=t*s*f,m;if(a==="xmd")m=Vy(e,u,b,o);else if(a==="xof")m=Wy(e,u,b,i,o);else if(a==="_internal_pass")m=e;else throw new Error('expand must be "xmd" or "xof"');let y=new Array(t);for(let _=0;_<t;_++){let E=new Array(s);for(let I=0;I<s;I++){let k=f*(I+_*s),C=m.subarray(k,k+f);E[I]=(0,j8.mod)(F8(C),n)}y[_]=E}return y}ut.hash_to_field=ql;function G8(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,o,a,c]=r.map(u=>u.reduce((d,f)=>e.add(e.mul(d,n),f)));return n=e.div(s,o),i=e.mul(i,e.div(a,c)),{x:n,y:i}}}ut.isogenyMap=G8;function V8(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=ql(n,2,{...r,DST:r.DST,...i}),o=e.fromAffine(t(s[0])),a=e.fromAffine(t(s[1])),c=o.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,i){let s=ql(n,1,{...r,DST:r.encodeDST,...i}),o=e.fromAffine(t(s[0])).clearCofactor();return o.assertValidity(),o}}}ut.createHasher=V8});var Ll=H(la=>{w();S();Object.defineProperty(la,"__esModule",{value:!0});la.createCurve=la.getHash=void 0;var W8=tc(),Xy=Sr(),z8=Fu();function Yy(e){return{hash:e,hmac:(t,...r)=>(0,W8.hmac)(e,t,(0,Xy.concatBytes)(...r)),randomBytes:Xy.randomBytes}}la.getHash=Yy;function X8(e,t){let r=n=>(0,z8.weierstrass)({...e,...Yy(n)});return Object.freeze({...r(t),create:r})}la.createCurve=X8});var s1=H(Wt=>{w();S();var Y8=Wt&&Wt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),$8=Wt&&Wt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Z8=Wt&&Wt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Y8(t,e,r);return $8(t,e),t},Kl;Object.defineProperty(Wt,"__esModule",{value:!0});Wt.encodeToCurve=Wt.hashToCurve=Wt.schnorr=Wt.secp256k1=void 0;var Vu=Do(),J8=Sr(),lr=fo(),Q8=Fu(),Cr=$i(),Jy=Z8(zy()),e5=Ll(),Yu=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Wu=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Qy=BigInt(1),zu=BigInt(2),$y=(e,t)=>(e+t/zu)/t;function e1(e){let t=Yu,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,d=u*u*e%t,f=(0,lr.pow2)(d,r,t)*d%t,b=(0,lr.pow2)(f,r,t)*d%t,m=(0,lr.pow2)(b,zu,t)*u%t,y=(0,lr.pow2)(m,i,t)*m%t,_=(0,lr.pow2)(y,s,t)*y%t,E=(0,lr.pow2)(_,a,t)*_%t,I=(0,lr.pow2)(E,c,t)*E%t,k=(0,lr.pow2)(I,a,t)*_%t,C=(0,lr.pow2)(k,r,t)*d%t,U=(0,lr.pow2)(C,o,t)*y%t,R=(0,lr.pow2)(U,n,t)*u%t,q=(0,lr.pow2)(R,zu,t);if(!Ms.eql(Ms.sqr(q),e))throw new Error("Cannot find square root");return q}var Ms=(0,lr.Field)(Yu,void 0,void 0,{sqrt:e1});Wt.secp256k1=(0,e5.createCurve)({a:BigInt(0),b:BigInt(7),Fp:Ms,n:Wu,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=Wu,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Qy*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=$y(s*e,t),c=$y(-n*e,t),u=(0,lr.mod)(e-a*r-c*i,t),d=(0,lr.mod)(-a*n-c*s,t),f=u>o,b=d>o;if(f&&(u=t-u),b&&(d=t-d),u>o||d>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:u,k2neg:b,k2:d}}}},Vu.sha256);var $u=BigInt(0),t1=e=>typeof e=="bigint"&&$u<e&&e<Yu,t5=e=>typeof e=="bigint"&&$u<e&&e<Wu,Zy={};function Xu(e,...t){let r=Zy[e];if(r===void 0){let n=(0,Vu.sha256)(Uint8Array.from(e,i=>i.charCodeAt(0)));r=(0,Cr.concatBytes)(n,n),Zy[e]=r}return(0,Vu.sha256)((0,Cr.concatBytes)(r,...t))}var Gl=e=>e.toRawBytes(!0).slice(1),jl=e=>(0,Cr.numberToBytesBE)(e,32),Dl=e=>(0,lr.mod)(e,Yu),lc=e=>(0,lr.mod)(e,Wu),Vl=Wt.secp256k1.ProjectivePoint,r5=(e,t,r)=>Vl.BASE.multiplyAndAddUnsafe(e,t,r);function Fl(e){let t=Wt.secp256k1.utils.normPrivateKeyToScalar(e),r=Vl.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:lc(-t),bytes:Gl(r)}}function r1(e){if(!t1(e))throw new Error("bad x: need 0 < x < p");let t=Dl(e*e),r=Dl(t*e+BigInt(7)),n=e1(r);n%zu!==$u&&(n=Dl(-n));let i=new Vl(e,n,Qy);return i.assertValidity(),i}function n1(...e){return lc((0,Cr.bytesToNumberBE)(Xu("BIP0340/challenge",...e)))}function n5(e){return Fl(e).bytes}function i5(e,t,r=(0,J8.randomBytes)(32)){let n=(0,Cr.ensureBytes)("message",e),{bytes:i,scalar:s}=Fl(t),o=(0,Cr.ensureBytes)("auxRand",r,32),a=jl(s^(0,Cr.bytesToNumberBE)(Xu("BIP0340/aux",o))),c=Xu("BIP0340/nonce",a,i,n),u=lc((0,Cr.bytesToNumberBE)(c));if(u===$u)throw new Error("sign failed: k is zero");let{bytes:d,scalar:f}=Fl(u),b=n1(d,i,n),m=new Uint8Array(64);if(m.set(d,0),m.set(jl(lc(f+b*s)),32),!i1(m,n,i))throw new Error("sign: Invalid signature produced");return m}function i1(e,t,r){let n=(0,Cr.ensureBytes)("signature",e,64),i=(0,Cr.ensureBytes)("message",t),s=(0,Cr.ensureBytes)("publicKey",r,32);try{let o=r1((0,Cr.bytesToNumberBE)(s)),a=(0,Cr.bytesToNumberBE)(n.subarray(0,32));if(!t1(a))return!1;let c=(0,Cr.bytesToNumberBE)(n.subarray(32,64));if(!t5(c))return!1;let u=n1(jl(a),Gl(o),i),d=r5(o,c,lc(-u));return!(!d||!d.hasEvenY()||d.toAffine().x!==a)}catch{return!1}}Wt.schnorr={getPublicKey:n5,sign:i5,verify:i1,utils:{randomPrivateKey:Wt.secp256k1.utils.randomPrivateKey,lift_x:r1,pointToBytes:Gl,numberToBytesBE:Cr.numberToBytesBE,bytesToNumberBE:Cr.bytesToNumberBE,taggedHash:Xu,mod:lr.mod}};var s5=Jy.isogenyMap(Ms,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),o5=(0,Q8.mapToCurveSimpleSWU)(Ms,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Ms.create(BigInt("-11"))});Kl=Jy.createHasher(Wt.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=o5(Ms.create(e[0]));return s5(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Ms.ORDER,m:1,k:128,expand:"xmd",hash:Vu.sha256}),Wt.hashToCurve=Kl.hashToCurve,Wt.encodeToCurve=Kl.encodeToCurve});var c1=H(Cs=>{w();S();Object.defineProperty(Cs,"__esModule",{value:!0});Cs.poseidon=Cs.splitConstants=Cs.validateOpts=void 0;var o1=fo();function a1(e){let{Fp:t}=e;(0,o1.validateField)(t);for(let c of["t","roundsFull","roundsPartial"])if(typeof e[c]!="number"||!Number.isSafeInteger(e[c]))throw new Error(`Poseidon: invalid param ${c}=${e[c]} (${typeof e[c]})`);if(e.reversePartialPowIdx!==void 0&&typeof e.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${e.reversePartialPowIdx}`);let r=e.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=c=>(0,o1.FpPow)(t,c,n);if(r===3?i=c=>t.mul(t.sqrN(c),c):r===5&&(i=c=>t.mul(t.sqrN(t.sqrN(c)),c)),e.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${e.roundsFull}`);let s=e.roundsFull+e.roundsPartial;if(!Array.isArray(e.roundConstants)||e.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let o=e.roundConstants.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon wrong round constants: ${c}`);return c.map(u=>{if(typeof u!="bigint"||!t.isValid(u))throw new Error(`Poseidon wrong round constant=${u}`);return t.create(u)})});if(!Array.isArray(e.mds)||e.mds.length!==e.t)throw new Error("Poseidon: wrong MDS matrix");let a=e.mds.map(c=>{if(!Array.isArray(c)||c.length!==e.t)throw new Error(`Poseidon MDS matrix row: ${c}`);return c.map(u=>{if(typeof u!="bigint")throw new Error(`Poseidon MDS matrix value=${u}`);return t.create(u)})});return Object.freeze({...e,rounds:s,sboxFn:i,roundConstants:o,mds:a})}Cs.validateOpts=a1;function a5(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<e.length;i++)n.push(e[i]),n.length===t&&(r.push(n),n=[]);return r}Cs.splitConstants=a5;function c5(e){let{t,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=a1(e),o=Math.floor(e.roundsFull/2),a=s?t-1:0,c=(d,f,b)=>(d=d.map((m,y)=>r.add(m,e.roundConstants[b][y])),f?d=d.map(m=>i(m)):d[a]=i(d[a]),d=e.mds.map(m=>m.reduce((y,_,E)=>r.add(y,r.mulN(_,d[E])),r.ZERO)),d),u=function(f){if(!Array.isArray(f)||f.length!==t)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${t})`);f=f.map(m=>{if(typeof m!="bigint")throw new Error(`Poseidon: wrong value=${m} (${typeof m})`);return r.create(m)});let b=0;for(let m=0;m<o;m++)f=c(f,!0,b++);for(let m=0;m<e.roundsPartial;m++)f=c(f,!1,b++);for(let m=0;m<o;m++)f=c(f,!0,b++);if(b!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${b}, total=${n}`);return f};return u.roundConstants=e.roundConstants,u}Cs.poseidon=c5});var w1=H(z=>{w();S();var u5=z&&z.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),f5=z&&z.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d5=z&&z.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&u5(t,e,r);return f5(t,e),t};Object.defineProperty(z,"__esModule",{value:!0});z.poseidonHashMany=z.poseidonHashSingle=z.poseidonHashFunc=z.poseidonHash=z.poseidonSmall=z.poseidonCreate=z.poseidonBasic=z._poseidonMDS=z.Fp251=z.Fp253=z.keccak=z.computeHashOnElements=z.hashChain=z.pedersen=z.getAccountPath=z.ethSigToPrivate=z.getStarkKey=z.grindKey=z.utils=z.Signature=z.ProjectivePoint=z.CURVE=z.verify=z.sign=z.getSharedSecret=z.getPublicKey=z._starkCurve=void 0;var l5=uu(),Xl=Do(),h5=Sr(),ho=fo(),p5=c1(),b5=Fu(),kr=d5($i()),g5=Ll(),Ju=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),d1=252;function u1(e){for(;e[0]===0;)e=e.subarray(1);let t=e.length*8-d1,r=kr.bytesToNumberBE(e);return t>0?r>>BigInt(t):r}function l1(e){return typeof e=="string"&&(e=$l(e),e.length&1&&(e="0"+e)),kr.hexToBytes(e)}var po=(0,b5.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,ho.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:Ju,nBitLength:d1,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,g5.getHash)(Xl.sha256),bits2int:u1,bits2int_modN:e=>{let t=kr.bytesToNumberBE(e).toString(16);return t.length===63&&(e=l1(t+"0")),(0,ho.mod)(u1(e),Ju)}});z._starkCurve=po;function lo(e){return kr.ensureBytes("",typeof e=="string"?l1(e):e)}function Yl(e){return kr.bytesToHex(lo(e)).padStart(64,"0")}function h1(e,t=!1){return po.getPublicKey(Yl(e),t)}z.getPublicKey=h1;function y5(e,t){return po.getSharedSecret(Yl(e),t)}z.getSharedSecret=y5;function m5(e,t,r){return po.sign(lo(e),Yl(t),r)}z.sign=m5;function _5(e,t,r){let n=e instanceof p1?e:lo(e);return po.verify(n,lo(t),lo(r))}z.verify=_5;var{CURVE:v5,ProjectivePoint:ha,Signature:p1,utils:w5}=po;z.CURVE=v5;z.ProjectivePoint=ha;z.Signature=p1;z.utils=w5;function b1(e){return`0x${kr.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function $l(e){return e.replace(/^0x/i,"")}function S5(e){return`0x${e.toString(16)}`}function g1(e){let t=lo(e),r=2n**256n,n=r-(0,ho.mod)(r,Ju);for(let i=0;;i++){let s=Wl(kr.concatBytes(t,kr.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,ho.mod)(s,Ju).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}z.grindKey=g1;function x5(e){return b1(h1(e,!0))}z.getStarkKey=x5;function P5(e){if(e=$l(e),e.length!==130)throw new Error("Wrong ethereum signature");return g1(e.substring(0,64))}z.ethSigToPrivate=P5;var T5=2n**31n-1n,Zu=e=>Number(e&T5);function E5(e,t,r,n){let i=Zu(Wl(e)),s=Zu(Wl(t)),o=kr.hexToNumber($l(r));return`m/2645'/${i}'/${s}'/${Zu(o)}'/${Zu(o>>31n)}'/${n}`}z.getAccountPath=E5;var hc=[new ha(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new ha(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new ha(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new ha(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new ha(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function y1(e,t){let r=[],n=e;for(let i=0;i<248;i++)r.push(n),n=n.double();n=t;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var A5=y1(hc[1],hc[2]),I5=y1(hc[3],hc[4]);function m1(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=kr.bytesToNumberBE(lo(e));if(!(0n<=t&&t<po.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function f1(e,t,r){let n=m1(t);for(let i=0;i<252;i++){let s=r[i];if(s.equals(e))throw new Error("Same point");(n&1n)!==0n&&(e=e.add(s)),n>>=1n}return e}function Zl(e,t){let r=hc[0];return r=f1(r,e,A5),r=f1(r,t,I5),b1(r.toRawBytes(!0))}z.pedersen=Zl;function O5(e,t=Zl){if(!Array.isArray(e)||e.length<1)throw new Error("data should be array of at least 1 element");return e.length===1?S5(m1(e[0])):Array.from(e).reverse().reduce((r,n)=>t(n,r))}z.hashChain=O5;var B5=(e,t=Zl)=>[0,...e,e.length].reduce((r,n)=>t(r,n));z.computeHashOnElements=B5;var M5=kr.bitMask(250),C5=e=>kr.bytesToNumberBE((0,l5.keccak_256)(e))&M5;z.keccak=C5;var Wl=e=>kr.bytesToNumberBE((0,Xl.sha256)(e));z.Fp253=(0,ho.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));z.Fp251=(0,ho.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function zl(e,t,r){let n=e.fromBytes((0,Xl.sha256)((0,h5.utf8ToBytes)(`${t}${r}`)));return e.create(n)}function _1(e,t,r,n=0){let i=[],s=[];for(let o=0;o<r;o++)i.push(zl(e,`${t}x`,n*r+o)),s.push(zl(e,`${t}y`,n*r+o));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(o=>s.map(a=>e.inv(e.sub(o,a))))}z._poseidonMDS=_1;var k5=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function Jl(e,t){if((0,ho.validateField)(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);let r=e.rate+e.capacity,n=e.roundsFull+e.roundsPartial,i=[];for(let o=0;o<n;o++){let a=[];for(let c=0;c<r;c++)a.push(zl(e.Fp,"Hades",r*o+c));i.push(a)}let s=(0,p5.poseidon)({...e,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:i});return s.m=r,s.rate=e.rate,s.capacity=e.capacity,s}z.poseidonBasic=Jl;function H5(e,t=0){let r=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return Jl(e,_1(e.Fp,"HadesMDS",r,t))}z.poseidonCreate=H5;z.poseidonSmall=Jl({Fp:z.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},k5);function v1(e,t,r=z.poseidonSmall){return r([e,t,2n])[0]}z.poseidonHash=v1;function N5(e,t,r=z.poseidonSmall){return kr.numberToVarBytesBE(v1(kr.bytesToNumberBE(e),kr.bytesToNumberBE(t),r))}z.poseidonHashFunc=N5;function R5(e,t=z.poseidonSmall){return t([e,0n,1n])[0]}z.poseidonHashSingle=R5;function U5(e,t=z.poseidonSmall){let{m:r,rate:n}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");let i=Array.from(e);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let o=0;o<i.length;o+=n){for(let a=0;a<n;a++)s[a]+=i[o+a];s=t(s)}return s[0]}z.poseidonHashMany=U5});var P1=H(Hr=>{w();S();var q5=Hr&&Hr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),L5=Hr&&Hr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),S1=Hr&&Hr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&q5(t,e,r);return L5(t,e),t};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.bytesToHex=Hr.hexToBytes=Hr.stark=Hr.secp256k1=void 0;Hr.secp256k1=S1(s1());Hr.stark=S1(w1());var x1=$i();Object.defineProperty(Hr,"hexToBytes",{enumerable:!0,get:function(){return x1.hexToBytes}});Object.defineProperty(Hr,"bytesToHex",{enumerable:!0,get:function(){return x1.bytesToHex}})});var T1=H(Nr=>{w();S();var K5=Nr&&Nr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),D5=Nr&&Nr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Qu=Nr&&Nr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&K5(t,e,r);return D5(t,e),t};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.schnorr=Nr.p256=Nr.ed25519=Nr.secp256k1=void 0;Nr.secp256k1=Qu(ly());Nr.ed25519=Qu(wy());Nr.p256=Qu(Ty());Nr.schnorr=Qu(P1())});var ri=H(zt=>{w();S();var j5=zt&&zt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),F5=zt&&zt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),pa=zt&&zt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&j5(t,e,r);return F5(t,e),t};Object.defineProperty(zt,"__esModule",{value:!0});zt.secp256k1=zt.ed25519=zt.signUtil=zt.elliptic=zt.bip39=zt.bip32=void 0;zt.bip32=pa(zg());zt.bip39=pa(Il());zt.elliptic=pa(oa());zt.signUtil=pa(T1());zt.ed25519=pa(X0());zt.secp256k1=pa(uw())});var th=H(Si=>{w();S();Object.defineProperty(Si,"__esModule",{value:!0});Si.encode=Si.decode=Si.encodeRaw=Si.decodeRaw=void 0;var Ql=he();function E1(e,t){if(t!==void 0&&e[0]!==t)throw new Error("Invalid network version");if(e.length===33)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(e.length!==34)throw new Error("Invalid WIF length");if(e[33]!==1)throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}Si.decodeRaw=E1;function eh(e,t,r){let n=p.Buffer.alloc(r?34:33);return n.writeUInt8(e,0),t.copy(n,1),r&&(n[33]=1),n}Si.encodeRaw=eh;function G5(e,t){return E1(Ql.base.fromBase58Check(e),t)}Si.decode=G5;function V5(e,t,r){return typeof e=="number"?Ql.base.toBase58Check(eh(e,t,r)):Ql.base.toBase58Check(eh(e.version,e.privateKey,e.compressed))}Si.encode=V5});var ba=H(tn=>{w();S();var W5=tn&&tn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),z5=tn&&tn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),X5=tn&&tn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&W5(t,e,r);return z5(t,e),t};Object.defineProperty(tn,"__esModule",{value:!0});tn.countAdjustedVsize=tn.convertScriptSigAsm=tn.countScriptSigops=void 0;var Y5=Zs(),$5=rn(),A1=he(),Z5=X5(nn());function pc(e,t=!1,r=!1){if(!e?.length)return 0;let n=0;if(n+=e.match(/OP_CHECKSIG/g)?.length||0,t)n+=20*(e.match(/OP_CHECKMULTISIG/g)?.length||0);else{let i=e.matchAll(/(?:OP_(?:PUSHNUM_)?(\d+))? OP_CHECKMULTISIG/g);for(let s of i){let o=parseInt(s[1]);Number.isInteger(o)?n+=o:n+=20}}return r?n:n*4}tn.countScriptSigops=pc;function bc(e){if(e?.length==0)return"";let t=[],r=0;for(;r<e.length;){let n=e[r];if(n>=1&&n<=78){r++;let i;n===76?(i=e.readUInt8(r),t.push("OP_PUSHDATA1"),r+=1):n===77?(i=e.readUInt16LE(r),t.push("OP_PUSHDATA2"),r+=2):n===78?(i=e.readUInt32LE(r),t.push("OP_PUSHDATA4"),r+=4):(i=n,t.push("OP_PUSHBYTES_"+i));let s=e.slice(r,r+i);if(s.length!==i)break;t.push(s.toString("hex")),r+=s.length}else{if(n===0)t.push("OP_0");else if(n===79)t.push("OP_PUSHNUM_NEG1");else if(n===177)t.push("OP_CLTV");else if(n===178)t.push("OP_CSV");else if(n===186)t.push("OP_CHECKSIGADD");else{let i=Y5.REVERSE_OPS[n];i&&n<253?/^OP_(\d+)$/.test(i)?t.push(i.replace(/^OP_(\d+)$/,"OP_PUSHNUM_$1")):t.push(i):t.push("OP_RETURN_"+n)}r+=1}}return t.join(" ")}tn.convertScriptSigAsm=bc;function J5(e,t,r){if(e==null)return 0;r==null&&(r=Z5.networks.bitcoin);let n=0;(t!=null||null)&&t.length==e.ins.length&&e.ins.forEach((s,o)=>{if(s.script!=null&&(n+=pc(bc(s.script),!0)),t.length<=o||t[o]==null||null||t[o]=="")return;let a=(0,$5.getAddressType)(t[o],r);switch(!0){case(a==="segwit_nested"&&s.witness?.length===2&&s.script&&A1.base.toHex(s.script).startsWith("160014")):case a==="segwit_native":n+=1;break;case(a==="segwit_nested"&&s.witness?.length&&s.script&&A1.base.toHex(s.script).startsWith("220020")):case a==="segwit_native":s.witness?.length&&(n+=pc(bc(s.witness[s.witness.length-1]),!1,!0));break;case a==="segwit_nested":s.script&&(n+=pc(bc(s.script)));break}});for(let s of e.outs)s&&(n+=pc(bc(s.script),!0));let i=e.virtualSize();return i>n*5?i:n*5}tn.countAdjustedVsize=J5});var rn=H(ne=>{w();S();var Q5=ne&&ne.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ex=ne&&ne.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),yc=ne&&ne.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Q5(t,e,r);return ex(t,e),t};Object.defineProperty(ne,"__esModule",{value:!0});ne.fakeSign=ne.estimateBchFee=ne.estimateBtcFee=ne.ValidSignedTransaction=ne.getMPCTransaction=ne.calculateBchTxSize=ne.calculateTxSize=ne.signBch=ne.getAddressType=ne.signBtc=ne.TxBuild=ne.private2Wif=ne.wif2Public=ne.sign=ne.private2public=ne.privateKeyFromWIF=ne.Array=void 0;var pe=yc(nn()),O1=nn(),gc=ri(),X=he(),B1=yc(th()),I1=ga(),M1=yc(wr()),C1=yc(xi()),Qi=yc(Gt()),ks=Zs(),tx=ba(),k1=gc.signUtil.schnorr.secp256k1.schnorr;ne.Array=X.typeforce.Array;function rh(e,t){let r=B1.decode(e),n=r.version;if((0,ne.Array)(t)){if(t=t.filter(i=>n===i.wif).pop(),!t)throw new Error("Unknown network version")}else if(t=t||pe.networks.bitcoin,n!==t.wif)throw new Error("Invalid network version");return X.base.toHex(r.privateKey)}ne.privateKeyFromWIF=rh;function nh(e){return gc.signUtil.secp256k1.publicKeyCreate(X.base.fromHex(e),!0)}ne.private2public=nh;function ef(e,t){let{signature:r}=gc.signUtil.secp256k1.sign(e,X.base.fromHex(t));return p.Buffer.from(r)}ne.sign=ef;function rx(e,t){let r=rh(e,t);return nh(r)}ne.wif2Public=rx;function mc(e,t){return t=t||pe.networks.bitcoin,B1.encode(t.wif,e,!0)}ne.private2Wif=mc;var bo=class{constructor(t,r,n,i,s){this.tx=new pe.Transaction,this.network=pe.networks.bitcoin,t?this.tx.version=t:this.tx.version=2,r&&(this.network=r),this.inputs=[],this.outputs=[],this.bitcoinCash=n||!1,this.hardware=i||!1,this.fakeKey=s||!1}addInput(t,r,n,i,s,o,a,c){this.inputs.push({txId:t,index:r,privateKey:n,address:i,script:s,value:o,publicKey:a,sequence:c})}addOutput(t,r,n){this.outputs.push({address:t,value:r,omniScript:n})}build(t){let r=[];for(let n of this.inputs){let i=X.base.reverseBuffer(p.Buffer.from(n.txId,"hex"));this.tx.addInput(i,n.index,n.sequence),n.privateKey?r.push(rh(n.privateKey,this.network)):r.push("")}for(let n of this.outputs)if(n.omniScript)this.tx.addOutput(X.base.fromHex(n.omniScript),0);else{let i=pe.address.toOutputScript(n.address,this.network);this.tx.addOutput(i,n.value)}if(this.hardware)return this.tx.toHex();for(let n=0;n<r.length;n++){let i=r[n],s;i?s=nh(i):this.hardware||(s=X.base.fromHex(this.inputs[n].publicKey));let o,a=pe.Transaction.SIGHASH_ALL;if(this.bitcoinCash){let c=pe.payments.p2pkh({pubkey:s}).output;a=pe.Transaction.SIGHASH_ALL|pe.Transaction.SIGHASH_BITCOINCASHBIP143;let u=this.inputs[n].value||0;o=this.tx.hashForCashSignature(n,c,u,a);let d;t?(t.push(X.base.toHex(o)),d=p.Buffer.alloc(64,0)):d=ef(o,i);let f=pe.payments.p2pkh({output:c,pubkey:s,signature:pe.script.signature.encode(d,a)});f.input&&(this.tx.ins[n].script=f.input)}else{let c=H1(this.inputs[n].address,this.network);if(this.fakeKey){let{witness:u,script:d}=N1(c);u!==void 0&&(this.tx.ins[n].witness=u),d!==void 0&&(this.tx.ins[n].script=d);continue}if(c==="legacy"){let u=pe.payments.p2pkh({pubkey:s}).output;o=this.tx.hashForSignature(n,u,a);let d;t?(t.push(X.base.toHex(o)),d=p.Buffer.alloc(64,0)):d=ef(o,i);let f=pe.payments.p2pkh({output:u,pubkey:s,signature:pe.script.signature.encode(d,a)});f.input&&(this.tx.ins[n].script=f.input)}else if(c==="segwit_taproot"){let u=this.inputs.map(b=>pe.address.toOutputScript(b.address,this.network)),d=this.inputs.map(b=>b.value);o=this.tx.hashForWitnessV1(n,u,d,pe.Transaction.SIGHASH_DEFAULT);let f;if(t)t.push(X.base.toHex(o)),f=p.Buffer.alloc(64,0);else{let b=C1.taprootTweakPrivKey(X.base.fromHex(i));f=p.Buffer.from(k1.sign(o,b,X.base.randomBytes(32)))}this.tx.ins[n].witness=[p.Buffer.from(f)]}else{let u=M1.hash160(s),d=p.Buffer.of(25,118,169,20,...u,136,172),f=this.inputs[n].value||0;o=this.tx.hashForWitness(n,d,f,a);let b;t?(t.push(X.base.toHex(o)),b=p.Buffer.alloc(64,0)):b=ef(o,i),this.tx.ins[n].witness=[],this.tx.ins[n].witness.push(pe.script.signature.encode(b,a)),this.tx.ins[n].witness.push(s);let m=p.Buffer.of(22,0,20,...u);c!=="segwit_native"&&(this.tx.ins[n].script=m)}}}return this.tx.toHex()}virtualSize(){return(0,tx.countAdjustedVsize)(this.tx,this.inputs.map(t=>t.address),this.network||pe.networks.bitcoin)}};ne.TxBuild=bo;function nx(e,t,r,n,i,s){let o=e.inputs,a=e.outputs,c=e.address,u=e.feePerB||10,d=e.dustSize||546;if(r=r||pe.networks.bitcoin,e.memo&&(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):p.Buffer.from(X.base.toUtf8(e.memo))).length>80)throw new Error("data after op_return is  too long");let f=t;if(f||(f=mc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),r)),s){let{inputAmount:I,outputAmount:k,virtualSize:C}=tf(o,a,c,f,r,d,!1,e.memo,e.memoPos);return(I-k-Math.ceil(C*u)).toString()}let{inputAmount:b,outputAmount:m,virtualSize:y}=tf(o,a,c,f,r,d,!1,e.memo,e.memoPos),_=b-m-Math.ceil(y*u),E=new bo(2,r,!1,i);for(let I=0;I<o.length;I++){let k=o[I],C=k.privateKey||t,U=k.address||c;E.addInput(k.txId,k.vOut,C,U,k.reedScript,k.amount,k.publicKey,k.sequence)}e.memo&&e.memoPos==0&&E.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):p.Buffer.from(X.base.toUtf8(e.memo))))));for(let I=0;I<a.length;I++){let k=a[I];E.addOutput(k.address,k.amount,k.omniScript),e.memo&&e.memoPos&&E.outputs.length==e.memoPos&&E.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):p.Buffer.from(X.base.toUtf8(e.memo))))))}return _>d&&(E.addOutput(c,_),e.memo&&e.memoPos&&E.outputs.length==e.memoPos&&E.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):p.Buffer.from(X.base.toUtf8(e.memo))))))),e.memo&&(e.memoPos==null||e.memoPos<0||e.memoPos>E.outputs.length)&&E.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(e.memo)?X.base.fromHex(e.memo):p.Buffer.from(X.base.toUtf8(e.memo)))))),E.build(n)}ne.signBtc=nx;function H1(e,t){let r,n;try{r=(0,I1.fromBase58Check)(e)}catch{}if(r){if(r.version===t.pubKeyHash)return"legacy";if(r.version===t.scriptHash)return"segwit_nested"}else{try{n=(0,I1.fromBech32)(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0)return"segwit_native";if(n.version===1)return"segwit_taproot"}}return"legacy"}ne.getAddressType=H1;function ix(e,t,r,n,i){let s=e.inputs,o=e.outputs,a=e.address,c=e.feePerB||10,u=e.dustSize||546;r=r||pe.networks.bitcoin;let d=t;d||(d=mc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),r));let{inputAmount:f,outputAmount:b,virtualSize:m}=ih(s,o,a,d,r,u),y=f-b-m*c,_=new bo(2,r,!0,i);for(let E=0;E<s.length;E++){let I=s[E];_.addInput(I.txId,I.vOut,t,a,void 0,I.amount,I.publicKey,I.sequence)}for(let E=0;E<o.length;E++){let I=o[E];_.addOutput(I.address,I.amount)}return y>u&&_.addOutput(a,y),_.build(n)}ne.signBch=ix;function tf(e,t,r,n,i,s,o,a,c){let u=new bo(2,i,!1,o,!0),d=0;for(let y=0;y<e.length;y++){let _=e[y],E=_.privateKey||n,I=_.address||r;u.addInput(_.txId,_.vOut,E,I,_.reedScript,_.amount,_.publicKey,_.sequence),d=d+(_.amount||0)}a&&c==0&&u.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):p.Buffer.from(X.base.toUtf8(a))))));let f=0;for(let y=0;y<t.length;y++){let _=t[y];u.addOutput(_.address,_.amount,_.omniScript),f=f+_.amount,a&&c&&u.outputs.length==c&&u.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):p.Buffer.from(X.base.toUtf8(a))))))}d-f>s&&(u.addOutput(r,d-f),a&&c&&u.outputs.length==c&&u.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):p.Buffer.from(X.base.toUtf8(a))))))),a&&(c==null||c<0||c>u.outputs.length)&&u.addOutput("",0,X.base.toHex(Qi.compile([ks.OPS.OP_RETURN].concat(X.base.isHexString(a)?X.base.fromHex(a):p.Buffer.from(X.base.toUtf8(a))))));let b=u.build(),m=u.virtualSize();return{inputAmount:d,outputAmount:f,virtualSize:m,txHex:b}}ne.calculateTxSize=tf;function ih(e,t,r,n,i,s,o){let a=new bo(2,i,!0,o),c=0;for(let b=0;b<e.length;b++){let m=e[b];a.addInput(m.txId,m.vOut,n,r,void 0,m.amount,m.publicKey,m.sequence),c=c+(m.amount||0)}let u=0;for(let b=0;b<t.length;b++){let m=t[b];a.addOutput(m.address,m.amount),u=u+m.amount}c-u>s&&a.addOutput(r,c-u);let d=a.build(),f=a.tx.virtualSize();return{inputAmount:c,outputAmount:u,virtualSize:f,txHex:d}}ne.calculateBchTxSize=ih;function sx(e,t,r){let n=O1.Transaction.fromBuffer(X.base.fromHex(e),!1);for(let i=0;i<n.ins.length;i++){let s=n.ins[i],o=X.base.fromHex(t[i]),a=pe.Transaction.SIGHASH_ALL;if(r){a=pe.Transaction.SIGHASH_ALL|pe.Transaction.SIGHASH_BITCOINCASHBIP143;let c=pe.payments.p2pkh({input:s.script}),u=pe.payments.p2pkh({pubkey:c.pubkey,signature:pe.script.signature.encode(o,a)});u.input&&(s.script=u.input)}else{let c;if(s.witness.length===2)c="segwit_native";else if(s.witness.length===1)c="segwit_taproot";else if(s.witness.length===0)c="legacy";else throw Error("unknown witness length");if(c==="legacy"){let u=pe.payments.p2pkh({input:s.script}),d=pe.payments.p2pkh({pubkey:u.pubkey,signature:pe.script.signature.encode(o,a)});d.input&&(s.script=d.input)}else c==="segwit_taproot"?s.witness=[o]:s.witness[0]=pe.script.signature.encode(o,a)}}return n.toHex()}ne.getMPCTransaction=sx;function ox(e,t,r){let n=O1.Transaction.fromBuffer(X.base.fromHex(e),!1);if(!t)return n;for(let i=0;i<n.ins.length;i++){let s=n.ins[i],o=t[i],a;if(s.witness.length===2)a="segwit_native";else if(s.witness.length===1)a="segwit_taproot";else if(s.witness.length===0)a="legacy";else throw Error("unknown witness length");if(a==="legacy"){let c=Qi.decompile(s.script),u=c[0],d=c[1],f=pe.script.signature.decode(u),b=pe.address.toOutputScript(o.address,r),m=n.hashForSignature(i,b,f.hashType);if(!gc.signUtil.secp256k1.verifyWithNoRecovery(m,f.signature,d))throw Error("signature error")}else if(a==="segwit_native"){let c=s.witness[0],u=s.witness[1],d=pe.script.signature.decode(c),f=p.Buffer.of(25,118,169,20,...M1.hash160(u),136,172),b=n.hashForWitness(i,f,o.value,d.hashType);if(!gc.signUtil.secp256k1.verifyWithNoRecovery(b,d.signature,u))throw Error("signature error")}else{let c=s.witness[0],u=t.map(m=>pe.address.toOutputScript(m.address,r)),d=t.map(m=>m.value),f=n.hashForWitnessV1(i,u,d,pe.Transaction.SIGHASH_DEFAULT),b=C1.taprootTweakPubkey(X.base.fromHex(o.publicKey).slice(1))[0];if(!k1.verify(X.base.toHex(c),X.base.toHex(f),X.base.toHex(b)))throw Error("signature error")}}for(let i of n.ins)i.hash=X.base.reverseBuffer(i.hash);return n}ne.ValidSignedTransaction=ox;function ax(e,t){let r=e.inputs,n=e.outputs,i=e.feePerB||10,s=e.dustSize||546;t=t||pe.networks.bitcoin;let o=mc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),t),{virtualSize:a}=tf(r,n,e.address,o,t,s,!1,e.memo);return Math.ceil(a*i)}ne.estimateBtcFee=ax;function cx(e,t){let r=e.inputs,n=e.outputs,i=e.feePerB||10,s=e.dustSize||546;t=t||pe.networks.bitcoin;let o=mc(X.base.fromHex("853fd8960ff34838208d662ecd3b9f8cf413e13e0f74f95e554f8089f5058db0"),t),{virtualSize:a}=ih(r,n,e.address,o,t,s);return a*i}ne.estimateBchFee=cx;function N1(e){let t,r;return e==="segwit_taproot"?t=[p.Buffer.alloc(64)]:e==="legacy"?r=p.Buffer.alloc(107):(t=[p.Buffer.alloc(72),p.Buffer.alloc(33)],e==="segwit_nested"&&(r=p.Buffer.alloc(23))),{witness:t,script:r}}ne.fakeSign=N1});var xi=H(Hs=>{w();S();Object.defineProperty(Hs,"__esModule",{value:!0});Hs.taprootSignSighash=Hs.taprootTweakPubkey=Hs.taprootTweakPrivKey=void 0;var ux=ri(),R1=he(),fx=rn(),oh=ux.signUtil.schnorr.secp256k1,rf=oh.schnorr,U1=oh.secp256k1.ProjectivePoint,sh=oh.secp256k1.CURVE.n;function q1(e,t){let r=rf.utils,n=r.taggedHash("TapTweak",e,t),i=r.bytesToNumberBE(n);if(i>=sh)throw new Error("tweak higher than curve order");return i}function L1(e,t=new Uint8Array){let r=rf.utils,n=r.bytesToNumberBE(e),i=U1.fromPrivateKey(n),s=i.hasEvenY()?n:r.mod(-n,sh),o=r.pointToBytes(i),a=q1(o,t);return r.numberToBytesBE(r.mod(s+a,sh),32)}Hs.taprootTweakPrivKey=L1;function dx(e,t){t||(t=new Uint8Array);let r=rf.utils,n=q1(e,t),s=r.lift_x(r.bytesToNumberBE(e)).add(U1.fromPrivateKey(n)),o=s.hasEvenY()?0:1;return[r.pointToBytes(s),o]}Hs.taprootTweakPubkey=dx;function lx(e,t,r){let n=L1(R1.base.fromHex((0,fx.privateKeyFromWIF)(e)));return t.map(s=>{let o=p.Buffer.from(rf.sign(s,n,r));return R1.base.toHex(o)})}Hs.taprootSignSighash=lx});var nf=H(ze=>{w();S();var hx=ze&&ze.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),px=ze&&ze.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),bx=ze&&ze.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&hx(t,e,r);return px(t,e),t};Object.defineProperty(ze,"__esModule",{value:!0});ze.tweakKey=ze.tapTweakHash=ze.tapleafHash=ze.findScriptPath=ze.toHashTree=ze.rootHashFromPath=ze.MAX_TAPTREE_DEPTH=ze.LEAF_VERSION_TAPSCRIPT=void 0;var Ns=Ka(),fh=bx(wr()),K1=hs(),gx=Br(),yx=xi();ze.LEAF_VERSION_TAPSCRIPT=192;ze.MAX_TAPTREE_DEPTH=128;var mx=e=>"left"in e&&"right"in e;function _x(e,t){if(e.length<33)throw new TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);let r=(e.length-33)/32,n=t;for(let i=0;i<r;i++){let s=e.slice(33+32*i,65+32*i);n.compare(s)<0?n=uh(n,s):n=uh(s,n)}return n}ze.rootHashFromPath=_x;function ah(e){if((0,gx.isTapleaf)(e))return{hash:D1(e)};let t=[ah(e[0]),ah(e[1])];t.sort((i,s)=>i.hash.compare(s.hash));let[r,n]=t;return{hash:uh(r.hash,n.hash),left:r,right:n}}ze.toHashTree=ah;function ch(e,t){if(mx(e)){let r=ch(e.left,t);if(r!==void 0)return[...r,e.right.hash];let n=ch(e.right,t);if(n!==void 0)return[...n,e.left.hash]}else if(e.hash.equals(t))return[]}ze.findScriptPath=ch;function D1(e){let t=e.version||ze.LEAF_VERSION_TAPSCRIPT;return fh.taggedHash("TapLeaf",Ns.Buffer.concat([Ns.Buffer.from([t]),Sx(e.output)]))}ze.tapleafHash=D1;function vx(e,t){return fh.taggedHash("TapTweak",Ns.Buffer.concat(t?[e,t]:[e]))}ze.tapTweakHash=vx;function wx(e,t){if(!Ns.Buffer.isBuffer(e)||e.length!==32||t&&t.length!==32)return null;let r=(0,yx.taprootTweakPubkey)(e,t);return{parity:r[1],x:Ns.Buffer.from(r[0])}}ze.tweakKey=wx;function uh(e,t){return fh.taggedHash("TapBranch",Ns.Buffer.concat([e,t]))}function Sx(e){let t=K1.varuint.encodingLength(e.length),r=Ns.Buffer.allocUnsafe(t);return K1.varuint.encode(e.length,r),Ns.Buffer.concat([r,e])}});var V1=H(Pi=>{w();S();var xx=Pi&&Pi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Px=Pi&&Pi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),G1=Pi&&Pi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&xx(t,e,r);return Px(t,e),t};Object.defineProperty(Pi,"__esModule",{value:!0});Pi.p2tr=void 0;var sf=Ka(),Tx=bn(),dh=G1(Gt()),ve=Br(),sn=nf(),An=G1(qi()),of=he(),j1=dh.OPS,F1=1,Ex=80;function Ax(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),(0,ve.typeforce)({address:ve.typeforce.maybe(ve.typeforce.String),input:ve.typeforce.maybe(ve.typeforce.BufferN(0)),network:ve.typeforce.maybe(ve.typeforce.Object),output:ve.typeforce.maybe(ve.typeforce.BufferN(34)),internalPubkey:ve.typeforce.maybe(ve.typeforce.BufferN(32)),hash:ve.typeforce.maybe(ve.typeforce.BufferN(32)),pubkey:ve.typeforce.maybe(ve.typeforce.BufferN(32)),witness:ve.typeforce.maybe(ve.typeforce.arrayOf(ve.typeforce.Buffer)),scriptTree:ve.typeforce.maybe(ve.isTaptree),redeem:ve.typeforce.maybe({output:ve.typeforce.maybe(ve.typeforce.Buffer),redeemVersion:ve.typeforce.maybe(ve.typeforce.Number),witness:ve.typeforce.maybe(ve.typeforce.arrayOf(ve.typeforce.Buffer))}),redeemVersion:ve.typeforce.maybe(ve.typeforce.Number)},e);let r=An.value(()=>{let a=of.base.bech32m.decode(e.address),c=a.words.shift(),u=of.base.bech32m.fromWords(a.words);return{version:c,prefix:a.prefix,data:sf.Buffer.from(u)}}),n=An.value(()=>{if(!(!e.witness||!e.witness.length))return e.witness.length>=2&&e.witness[e.witness.length-1][0]===Ex?e.witness.slice(0,-1):e.witness.slice()}),i=An.value(()=>{if(e.scriptTree)return(0,sn.toHashTree)(e.scriptTree);if(e.hash)return{hash:e.hash}}),s=e.network||Tx.bitcoin,o={name:"p2tr",network:s};if(An.prop(o,"address",()=>{if(!o.pubkey)return;let a=of.base.bech32m.toWords(o.pubkey);return a.unshift(F1),of.base.bech32m.encode(s.bech32,a)}),An.prop(o,"hash",()=>{let a=i();if(a)return a.hash;let c=n();if(c&&c.length>1){let u=c[c.length-1],d=u[0]&ve.TAPLEAF_VERSION_MASK,f=c[c.length-2],b=(0,sn.tapleafHash)({output:f,version:d});return(0,sn.rootHashFromPath)(u,b)}return null}),An.prop(o,"output",()=>{if(!!o.pubkey)return dh.compile([j1.OP_1,o.pubkey])}),An.prop(o,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&e.redeem.redeemVersion!==void 0&&e.redeem.redeemVersion!==null?e.redeem.redeemVersion:sn.LEAF_VERSION_TAPSCRIPT),An.prop(o,"redeem",()=>{let a=n();if(!(!a||a.length<2))return{output:a[a.length-2],witness:a.slice(0,-2),redeemVersion:a[a.length-1][0]&ve.TAPLEAF_VERSION_MASK}}),An.prop(o,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return r().data;if(o.internalPubkey){let a=(0,sn.tweakKey)(o.internalPubkey,o.hash);if(a)return a.x}}),An.prop(o,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;let a=n();if(a&&a.length>1)return a[a.length-1].slice(1,33)}),An.prop(o,"signature",()=>{if(e.signature)return e.signature;let a=n();if(!(!a||a.length!==1))return a[0]}),An.prop(o,"witness",()=>{if(e.witness)return e.witness;let a=i();if(a&&e.redeem&&e.redeem.output&&e.internalPubkey){let c=(0,sn.tapleafHash)({output:e.redeem.output,version:o.redeemVersion}),u=(0,sn.findScriptPath)(a,c);if(!u)return;let d=(0,sn.tweakKey)(e.internalPubkey,a.hash);if(!d)return;let f=sf.Buffer.concat([sf.Buffer.from([o.redeemVersion|d.parity]),e.internalPubkey].concat(u));return[e.redeem.output,f]}if(e.signature)return[e.signature]}),t.validate){let a=sf.Buffer.from([]);if(e.address){if(s&&s.bech32!==r().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(r().version!==F1)throw new TypeError("Invalid address version");if(r().data.length!==32)throw new TypeError("Invalid address data");a=r().data}if(e.pubkey){if(a.length>0&&!a.equals(e.pubkey))throw new TypeError("Pubkey mismatch");a=e.pubkey}if(e.output){if(e.output.length!==34||e.output[0]!==j1.OP_1||e.output[1]!==32)throw new TypeError("Output is invalid");if(a.length>0&&!a.equals(e.output.slice(2)))throw new TypeError("Pubkey mismatch");a=e.output.slice(2)}if(e.internalPubkey){let d=(0,sn.tweakKey)(e.internalPubkey,o.hash);if(a.length>0&&!a.equals(d.x))throw new TypeError("Pubkey mismatch");a=d.x}if(a&&a.length&&a.length!==32)throw new TypeError("Invalid pubkey for p2tr");let c=i();if(e.hash&&c&&!e.hash.equals(c.hash))throw new TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&c){let d=(0,sn.tapleafHash)({output:e.redeem.output,version:o.redeemVersion});if(!(0,sn.findScriptPath)(c,d))throw new TypeError("Redeem script not in tree")}let u=n();if(e.redeem&&o.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==o.redeem.redeemVersion)throw new TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(dh.decompile(e.redeem.output).length===0)throw new TypeError("Redeem.output is invalid");if(o.redeem.output&&!e.redeem.output.equals(o.redeem.output))throw new TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&o.redeem.witness&&!Ix(e.redeem.witness,o.redeem.witness))throw new TypeError("Redeem.witness and witness mismatch")}if(u&&u.length)if(u.length===1){if(e.signature&&!e.signature.equals(u[0]))throw new TypeError("Signature mismatch")}else{let d=u[u.length-1];if(d.length<33)throw new TypeError(`The control-block length is too small. Got ${d.length}, expected min 33.`);if((d.length-33)%32!==0)throw new TypeError(`The control-block length of ${d.length} is incorrect!`);let f=(d.length-33)/32;if(f>128)throw new TypeError(`The script path is too long. Got ${f}, expected max 128.`);let b=d.slice(1,33);if(e.internalPubkey&&!e.internalPubkey.equals(b))throw new TypeError("Internal pubkey mismatch");if(b.length!==32)throw new TypeError("Invalid internalPubkey for p2tr witness");let m=d[0]&ve.TAPLEAF_VERSION_MASK,y=u[u.length-2],_=(0,sn.tapleafHash)({output:y,version:m}),E=(0,sn.rootHashFromPath)(d,_),I=(0,sn.tweakKey)(b,E);if(!I)throw new TypeError("Invalid outputKey for p2tr witness");if(a.length&&!a.equals(I.x))throw new TypeError("Pubkey mismatch for p2tr witness");if(I.parity!==(d[0]&1))throw new Error("Incorrect parity")}}return Object.assign(o,e)}Pi.p2tr=Ax;function Ix(e,t){return e.length!==t.length?!1:e.every((r,n)=>r.equals(t[n]))}});var Rs=H(hr=>{w();S();Object.defineProperty(hr,"__esModule",{value:!0});hr.p2tr=hr.p2wsh=hr.p2wpkh=hr.p2sh=hr.p2pkh=hr.p2pk=hr.p2ms=hr.embed=void 0;var Ox=_p();Object.defineProperty(hr,"embed",{enumerable:!0,get:function(){return Ox.p2data}});var Bx=Sp();Object.defineProperty(hr,"p2ms",{enumerable:!0,get:function(){return Bx.p2ms}});var Mx=Tp();Object.defineProperty(hr,"p2pk",{enumerable:!0,get:function(){return Mx.p2pk}});var Cx=Op();Object.defineProperty(hr,"p2pkh",{enumerable:!0,get:function(){return Cx.p2pkh}});var kx=Cp();Object.defineProperty(hr,"p2sh",{enumerable:!0,get:function(){return kx.p2sh}});var Hx=Hp();Object.defineProperty(hr,"p2wpkh",{enumerable:!0,get:function(){return Hx.p2wpkh}});var Nx=Up();Object.defineProperty(hr,"p2wsh",{enumerable:!0,get:function(){return Nx.p2wsh}});var Rx=V1();Object.defineProperty(hr,"p2tr",{enumerable:!0,get:function(){return Rx.p2tr}})});var ga=H(Xt=>{w();S();var Ux=Xt&&Xt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qx=Xt&&Xt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cf=Xt&&Xt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Ux(t,e,r);return qx(t,e),t};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.toOutputScript=Xt.fromOutputScript=Xt.toBech32=Xt.toBase58Check=Xt.fromBech32=Xt.fromBase58Check=void 0;var W1=cf(bn()),Ti=cf(Rs()),z1=cf(Gt()),af=cf(Br()),Us=he(),{typeforce:Lx}=af,X1=40,Y1=2,$1=16,Z1=2,J1=80,Q1="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.";function Kx(e,t){let r=e.slice(2);if(r.length<Y1||r.length>X1)throw new TypeError("Invalid program length for segwit address");let n=e[0]-J1;if(n<Z1||n>$1)throw new TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw new TypeError("Invalid script for segwit address");return console.warn(Q1),rm(r,n,t.bech32)}function em(e){let t=Us.base.fromBase58Check(e);if(t.length<21)throw new TypeError(e+" is too short");if(t.length>21)throw new TypeError(e+" is too long");let r=t.readUInt8(0),n=t.slice(1);return{version:r,hash:n}}Xt.fromBase58Check=em;function tm(e){let t,r;try{t=Us.base.bech32.decode(e)}catch{}if(t){if(r=t.words[0],r!==0)throw new TypeError(e+" uses wrong encoding")}else if(t=Us.base.bech32m.decode(e),r=t.words[0],r===0)throw new TypeError(e+" uses wrong encoding");let n=Us.base.bech32.fromWords(t.words.slice(1));return{version:r,prefix:t.prefix,data:p.Buffer.from(n)}}Xt.fromBech32=tm;function Dx(e,t){Lx(af.tuple(af.Hash160bit,af.UInt8),arguments);let r=p.Buffer.allocUnsafe(21);return r.writeUInt8(t,0),e.copy(r,1),Us.base.toBase58Check(r)}Xt.toBase58Check=Dx;function rm(e,t,r){let n=Us.base.bech32.toWords(e);return n.unshift(t),t===0?Us.base.bech32.encode(r,n):Us.base.bech32m.encode(r,n)}Xt.toBech32=rm;function jx(e,t){t=t||W1.bitcoin;try{return Ti.p2pkh({output:e,network:t}).address}catch{}try{return Ti.p2sh({output:e,network:t}).address}catch{}try{return Ti.p2wpkh({output:e,network:t}).address}catch{}try{return Ti.p2wsh({output:e,network:t}).address}catch{}try{return Ti.p2tr({output:e,network:t}).address}catch{}try{return Kx(e,t)}catch{}throw new Error(z1.toASM(e)+" has no matching Address")}Xt.fromOutputScript=jx;function Fx(e,t){t=t||W1.bitcoin;let r,n;try{r=em(e)}catch{}if(r){if(r.version===t.pubKeyHash)return Ti.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return Ti.p2sh({hash:r.hash}).output}else{try{n=tm(e)}catch{}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(n.version===0){if(n.data.length===20)return Ti.p2wpkh({hash:n.data}).output;if(n.data.length===32)return Ti.p2wsh({hash:n.data}).output}else if(n.version===1){if(n.data.length===32)return Ti.p2tr({pubkey:n.data}).output}else if(n.version>=Z1&&n.version<=$1&&n.data.length>=Y1&&n.data.length<=X1)return console.warn(Q1),z1.compile([n.version+J1,n.data])}}throw new Error(e+" has no matching Script")}Xt.toOutputScript=Fx});var Ls=H(an=>{w();S();var Gx=an&&an.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Vx=an&&an.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),lh=an&&an.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Gx(t,e,r);return Vx(t,e),t};Object.defineProperty(an,"__esModule",{value:!0});an.Transaction=an.vectorSize=an.varSliceSize=void 0;var Xe=hs(),Yt=lh(wr()),nm=lh(Gt()),Wx=Gt(),de=lh(Br()),{typeforce:ni}=de;function on(e){let t=e.length;return Xe.varuint.encodingLength(t)+t}an.varSliceSize=on;function om(e){let t=e.length;return Xe.varuint.encodingLength(t)+e.reduce((r,n)=>r+on(n),0)}an.vectorSize=om;var qs=p.Buffer.allocUnsafe(0),im=[],ya=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),sm=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),zx=p.Buffer.from("ffffffffffffffff","hex"),Xx={script:qs,valueBuffer:zx};function Yx(e){return e.value!==void 0}var Q=class{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(t,r){let n=new Xe.BufferReader(t),i=new Q;i.version=n.readInt32();let s=n.readUInt8(),o=n.readUInt8(),a=!1;s===Q.ADVANCED_TRANSACTION_MARKER&&o===Q.ADVANCED_TRANSACTION_FLAG?a=!0:n.offset-=2;let c=n.readVarInt();for(let d=0;d<c;++d)i.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:im});let u=n.readVarInt();for(let d=0;d<u;++d)i.outs.push({value:n.readUInt64(),script:n.readVarSlice()});if(a){for(let d=0;d<c;++d)i.ins[d].witness=n.readVector();if(!i.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(i.locktime=n.readUInt32(),r)return i;if(n.offset!==t.length)throw new Error("Transaction has unexpected data");return i}static fromHex(t){return Q.fromBuffer(p.Buffer.from(t,"hex"),!1)}static isCoinbaseHash(t){ni(de.Hash256bit,t);for(let r=0;r<32;++r)if(t[r]!==0)return!1;return!0}isCoinbase(){return this.ins.length===1&&Q.isCoinbaseHash(this.ins[0].hash)}addInput(t,r,n,i){return ni(de.tuple(de.Hash256bit,de.UInt32,de.maybe(de.UInt32),de.maybe(de.Buffer)),arguments),de.Null(n)&&(n=Q.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:r,script:i||qs,sequence:n,witness:im})-1}addOutput(t,r){return ni(de.tuple(de.Buffer,de.Satoshi),arguments),this.outs.push({script:t,value:r})-1}hasWitnesses(){return this.ins.some(t=>t.witness.length!==0)}weight(){let t=this.byteLength(!1),r=this.byteLength(!0);return t*3+r}virtualSize(){return Math.ceil(this.weight()/4)}dogeByteLength(){let t=26+this.ins.reduce((r,n)=>{let i=40+on(n.script);return r+32+4+i},0)+this.outs.reduce((r,n)=>r+9+n.script.length,0);return Math.ceil(t)}byteLength(t=!0){let r=t&&this.hasWitnesses();return(r?10:8)+Xe.varuint.encodingLength(this.ins.length)+Xe.varuint.encodingLength(this.outs.length)+this.ins.reduce((n,i)=>n+40+on(i.script),0)+this.outs.reduce((n,i)=>n+8+on(i.script),0)+(r?this.ins.reduce((n,i)=>n+om(i.witness),0):0)}clone(){let t=new Q;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(r=>({hash:r.hash,index:r.index,script:r.script,sequence:r.sequence,witness:r.witness})),t.outs=this.outs.map(r=>({script:r.script,value:r.value})),t}hashForSignature(t,r,n){if(ni(de.tuple(de.UInt32,de.Buffer,de.Number),arguments),t>=this.ins.length)return sm;let i=nm.compile(nm.decompile(r).filter(a=>a!==Wx.OPS.OP_CODESEPARATOR)),s=this.clone();if((n&31)===Q.SIGHASH_NONE)s.outs=[],s.ins.forEach((a,c)=>{c!==t&&(a.sequence=0)});else if((n&31)===Q.SIGHASH_SINGLE){if(t>=this.outs.length)return sm;s.outs.length=t+1;for(let a=0;a<t;a++)s.outs[a]=Xx;s.ins.forEach((a,c)=>{c!==t&&(a.sequence=0)})}n&Q.SIGHASH_ANYONECANPAY?(s.ins=[s.ins[t]],s.ins[0].script=i):(s.ins.forEach(a=>{a.script=qs}),s.ins[t].script=i);let o=p.Buffer.allocUnsafe(s.byteLength(!1)+4);return o.writeInt32LE(n,o.length-4),s.__toBuffer(o,0,!1),Yt.hash256(o)}hashForCashSignature(t,r,n,i){if(i&Q.SIGHASH_BITCOINCASHBIP143){if(de.Null(n))throw new Error("Bitcoin Cash sighash requires value of input to be signed.");return this.hashForWitnessV0(t,r,n,i)}else return this.hashForSignature(t,r,i)}hashForWitnessV1(t,r,n,i,s,o){if(ni(de.tuple(de.UInt32,ni.arrayOf(de.Buffer),ni.arrayOf(de.Satoshi),de.UInt32),arguments),n.length!==this.ins.length||r.length!==this.ins.length)throw new Error("Must supply prevout script and value for all inputs");let a=i===Q.SIGHASH_DEFAULT?Q.SIGHASH_ALL:i&Q.SIGHASH_OUTPUT_MASK,u=(i&Q.SIGHASH_INPUT_MASK)===Q.SIGHASH_ANYONECANPAY,d=a===Q.SIGHASH_NONE,f=a===Q.SIGHASH_SINGLE,b=qs,m=qs,y=qs,_=qs,E=qs;if(!u){let U=Xe.BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(R=>{U.writeSlice(R.hash),U.writeUInt32(R.index)}),b=Yt.sha256(U.end()),U=Xe.BufferWriter.withCapacity(8*this.ins.length),n.forEach(R=>U.writeUInt64(R)),m=Yt.sha256(U.end()),U=Xe.BufferWriter.withCapacity(r.map(on).reduce((R,q)=>R+q)),r.forEach(R=>U.writeVarSlice(R)),y=Yt.sha256(U.end()),U=Xe.BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(R=>U.writeUInt32(R.sequence)),_=Yt.sha256(U.end())}if(d||f){if(f&&t<this.outs.length){let U=this.outs[t],R=Xe.BufferWriter.withCapacity(8+on(U.script));R.writeUInt64(U.value),R.writeVarSlice(U.script),E=Yt.sha256(R.end())}}else{let U=this.outs.map(q=>8+on(q.script)).reduce((q,L)=>q+L),R=Xe.BufferWriter.withCapacity(U);this.outs.forEach(q=>{R.writeUInt64(q.value),R.writeVarSlice(q.script)}),E=Yt.sha256(R.end())}let I=(s?2:0)+(o?1:0),k=174-(u?49:0)-(d?32:0)+(o?32:0)+(s?37:0),C=Xe.BufferWriter.withCapacity(k);if(C.writeUInt8(i),C.writeInt32(this.version),C.writeUInt32(this.locktime),C.writeSlice(b),C.writeSlice(m),C.writeSlice(y),C.writeSlice(_),d||f||C.writeSlice(E),C.writeUInt8(I),u){let U=this.ins[t];C.writeSlice(U.hash),C.writeUInt32(U.index),C.writeUInt64(n[t]),C.writeVarSlice(r[t]),C.writeUInt32(U.sequence)}else C.writeUInt32(t);if(o){let U=Xe.BufferWriter.withCapacity(on(o));U.writeVarSlice(o),C.writeSlice(Yt.sha256(U.end()))}return f&&C.writeSlice(E),s&&(C.writeSlice(s),C.writeUInt8(0),C.writeUInt32(4294967295)),Yt.taggedHash("TapSighash",p.Buffer.concat([p.Buffer.of(0),C.end()]))}hashForWitnessV0(t,r,n,i){ni(de.tuple(de.UInt32,de.Buffer,de.Satoshi,de.UInt32),arguments);let s=p.Buffer.from([]),o,a=ya,c=ya,u=ya;if(i&Q.SIGHASH_ANYONECANPAY||(s=p.Buffer.allocUnsafe(36*this.ins.length),o=new Xe.BufferWriter(s,0),this.ins.forEach(f=>{o.writeSlice(f.hash),o.writeUInt32(f.index)}),c=Yt.hash256(s)),!(i&Q.SIGHASH_ANYONECANPAY)&&(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE&&(s=p.Buffer.allocUnsafe(4*this.ins.length),o=new Xe.BufferWriter(s,0),this.ins.forEach(f=>{o.writeUInt32(f.sequence)}),u=Yt.hash256(s)),(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE){let f=this.outs.reduce((b,m)=>b+8+on(m.script),0);s=p.Buffer.allocUnsafe(f),o=new Xe.BufferWriter(s,0),this.outs.forEach(b=>{o.writeUInt64(b.value),o.writeVarSlice(b.script)}),a=Yt.hash256(s)}else if((i&31)===Q.SIGHASH_SINGLE&&t<this.outs.length){let f=this.outs[t];s=p.Buffer.allocUnsafe(8+on(f.script)),o=new Xe.BufferWriter(s,0),o.writeUInt64(f.value),o.writeVarSlice(f.script),a=Yt.hash256(s)}s=p.Buffer.allocUnsafe(156+on(r)),o=new Xe.BufferWriter(s,0);let d=this.ins[t];return o.writeInt32(this.version),o.writeSlice(c),o.writeSlice(u),o.writeSlice(d.hash),o.writeUInt32(d.index),o.writeVarSlice(r),o.writeUInt64(n),o.writeUInt32(d.sequence),o.writeSlice(a),o.writeUInt32(this.locktime),o.writeUInt32(i),Yt.hash256(s)}getHash(t){return t&&this.isCoinbase()?p.Buffer.alloc(32,0):Yt.hash256(this.__toBuffer(void 0,void 0,t))}getId(){return(0,Xe.reverseBuffer)(this.getHash(!1)).toString("hex")}toBuffer(t,r){return this.__toBuffer(t,r,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(t,r){ni(de.tuple(de.Number,de.Buffer),arguments),this.ins[t].script=r}setWitness(t,r){ni(de.tuple(de.Number,[de.Buffer]),arguments),this.ins[t].witness=r}__toBuffer(t,r,n=!1){t||(t=p.Buffer.allocUnsafe(this.byteLength(n)));let i=new Xe.BufferWriter(t,r||0);i.writeInt32(this.version);let s=n&&this.hasWitnesses();return s&&(i.writeUInt8(Q.ADVANCED_TRANSACTION_MARKER),i.writeUInt8(Q.ADVANCED_TRANSACTION_FLAG)),i.writeVarInt(this.ins.length),this.ins.forEach(o=>{i.writeSlice(o.hash),i.writeUInt32(o.index),i.writeVarSlice(o.script),i.writeUInt32(o.sequence)}),i.writeVarInt(this.outs.length),this.outs.forEach(o=>{Yx(o)?i.writeUInt64(o.value):i.writeSlice(o.valueBuffer),i.writeVarSlice(o.script)}),s&&this.ins.forEach(o=>{i.writeVector(o.witness)}),i.writeUInt32(this.locktime),r!==void 0?t.slice(r,i.offset):t}hashForWitness(t,r,n,i){ni(de.tuple(de.UInt32,de.Buffer,de.Satoshi,de.UInt32),arguments);let s=p.Buffer.from([]),o,a=ya,c=ya,u=ya;if(i&Q.SIGHASH_ANYONECANPAY||(s=p.Buffer.allocUnsafe(36*this.ins.length),o=new Xe.BufferWriter(s,0),this.ins.forEach(f=>{o.writeSlice(f.hash),o.writeUInt32(f.index)}),c=Yt.hash256(s)),!(i&Q.SIGHASH_ANYONECANPAY)&&(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE&&(s=p.Buffer.allocUnsafe(4*this.ins.length),o=new Xe.BufferWriter(s,0),this.ins.forEach(f=>{o.writeUInt32(f.sequence)}),u=Yt.hash256(s)),(i&31)!==Q.SIGHASH_SINGLE&&(i&31)!==Q.SIGHASH_NONE){let f=this.outs.reduce((b,m)=>b+8+on(m.script),0);s=p.Buffer.allocUnsafe(f),o=new Xe.BufferWriter(s,0),this.outs.forEach(b=>{o.writeUInt64(b.value),o.writeVarSlice(b.script)}),a=Yt.hash256(s)}else if((i&31)===Q.SIGHASH_SINGLE&&t<this.outs.length){let f=this.outs[t];s=p.Buffer.allocUnsafe(8+on(f.script)),o=new Xe.BufferWriter(s,0),o.writeUInt64(f.value),o.writeVarSlice(f.script),a=Yt.hash256(s)}s=p.Buffer.allocUnsafe(156+r.length),o=new Xe.BufferWriter(s,0);let d=this.ins[t];return o.writeInt32(this.version),o.writeSlice(c),o.writeSlice(u),o.writeSlice(d.hash),o.writeUInt32(d.index),o.writeSlice(r),o.writeUInt64(n),o.writeUInt32(d.sequence),o.writeSlice(a),o.writeUInt32(this.locktime),o.writeUInt32(i),Yt.hash256(s)}};an.Transaction=Q;Q.DEFAULT_SEQUENCE=4294967295;Q.SIGHASH_DEFAULT=0;Q.SIGHASH_ALL=1;Q.SIGHASH_NONE=2;Q.SIGHASH_SINGLE=3;Q.SIGHASH_ANYONECANPAY=128;Q.SIGHASH_OUTPUT_MASK=3;Q.SIGHASH_INPUT_MASK=128;Q.SIGHASH_BITCOINCASHBIP143=64;Q.ADVANCED_TRANSACTION_MARKER=0;Q.ADVANCED_TRANSACTION_FLAG=1});var pr=H(Er=>{w();S();Object.defineProperty(Er,"__esModule",{value:!0});Er.OUTPUT_TYPE_NAMES=Er.OutputTypes=Er.INPUT_TYPE_NAMES=Er.InputTypes=Er.GLOBAL_TYPE_NAMES=Er.GlobalTypes=void 0;var $x;(function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"})($x=Er.GlobalTypes||(Er.GlobalTypes={}));Er.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"];var Zx;(function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"})(Zx=Er.InputTypes||(Er.InputTypes={}));Er.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"];var Jx;(function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"})(Jx=Er.OutputTypes||(Er.OutputTypes={}));Er.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"]});var cm=H(In=>{w();S();Object.defineProperty(In,"__esModule",{value:!0});In.canAddToArray=In.check=In.expected=In.encode=In.decode=void 0;var am=pr(),Qx=e=>[...Array(e).keys()];function eP(e){if(e.key[0]!==am.GlobalTypes.GLOBAL_XPUB)throw new Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"));if(e.key.length!==79||![2,3].includes(e.key[46]))throw new Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"));if(e.value.length/4%1!==0)throw new Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");let t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(let n of Qx(e.value.length/4-1)){let i=e.value.readUInt32LE(n*4+4),s=!!(i&2147483648),o=i&2147483647;r.path+="/"+o.toString(10)+(s?"'":"")}return r}In.decode=eP;function tP(e){let t=p.Buffer.from([am.GlobalTypes.GLOBAL_XPUB]),r=p.Buffer.concat([t,e.extendedPubkey]),n=e.path.split("/"),i=p.Buffer.allocUnsafe(n.length*4);e.masterFingerprint.copy(i,0);let s=4;return n.slice(1).forEach(o=>{let a=o.slice(-1)==="'",c=2147483647&parseInt(a?o.slice(0,-1):o,10);a&&(c+=2147483648),i.writeUInt32LE(c,s),s+=4}),{key:r,value:i}}In.encode=tP;In.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }";function rP(e){let t=e.extendedPubkey,r=e.masterFingerprint,n=e.path;return p.Buffer.isBuffer(t)&&t.length===78&&[2,3].indexOf(t[45])>-1&&p.Buffer.isBuffer(r)&&r.length===4&&typeof n=="string"&&!!n.match(/^m(\/\d+'?)*$/)}In.check=rP;function nP(e,t,r){let n=t.extendedPubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.extendedPubkey.equals(t.extendedPubkey)).length===0)}In.canAddToArray=nP});var um=H(uf=>{w();S();Object.defineProperty(uf,"__esModule",{value:!0});uf.encode=void 0;var iP=pr();function sP(e){return{key:p.Buffer.from([iP.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}uf.encode=sP});var dm=H(On=>{w();S();Object.defineProperty(On,"__esModule",{value:!0});On.canAdd=On.check=On.expected=On.encode=On.decode=void 0;var fm=pr();function oP(e){if(e.key[0]!==fm.InputTypes.FINAL_SCRIPTSIG)throw new Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"));return e.value}On.decode=oP;function aP(e){return{key:p.Buffer.from([fm.InputTypes.FINAL_SCRIPTSIG]),value:e}}On.encode=aP;On.expected="Buffer";function cP(e){return p.Buffer.isBuffer(e)}On.check=cP;function uP(e,t){return!!e&&!!t&&e.finalScriptSig===void 0}On.canAdd=uP});var hm=H(Bn=>{w();S();Object.defineProperty(Bn,"__esModule",{value:!0});Bn.canAdd=Bn.check=Bn.expected=Bn.encode=Bn.decode=void 0;var lm=pr();function fP(e){if(e.key[0]!==lm.InputTypes.FINAL_SCRIPTWITNESS)throw new Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"));return e.value}Bn.decode=fP;function dP(e){return{key:p.Buffer.from([lm.InputTypes.FINAL_SCRIPTWITNESS]),value:e}}Bn.encode=dP;Bn.expected="Buffer";function lP(e){return p.Buffer.isBuffer(e)}Bn.check=lP;function hP(e,t){return!!e&&!!t&&e.finalScriptWitness===void 0}Bn.canAdd=hP});var bm=H(Mn=>{w();S();Object.defineProperty(Mn,"__esModule",{value:!0});Mn.canAdd=Mn.check=Mn.expected=Mn.encode=Mn.decode=void 0;var pm=pr();function pP(e){if(e.key[0]!==pm.InputTypes.NON_WITNESS_UTXO)throw new Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"));return e.value}Mn.decode=pP;function bP(e){return{key:p.Buffer.from([pm.InputTypes.NON_WITNESS_UTXO]),value:e}}Mn.encode=bP;Mn.expected="Buffer";function gP(e){return p.Buffer.isBuffer(e)}Mn.check=gP;function yP(e,t){return!!e&&!!t&&e.nonWitnessUtxo===void 0}Mn.canAdd=yP});var ym=H(Cn=>{w();S();Object.defineProperty(Cn,"__esModule",{value:!0});Cn.canAddToArray=Cn.check=Cn.expected=Cn.encode=Cn.decode=void 0;var gm=pr();function mP(e){if(e.key[0]!==gm.InputTypes.PARTIAL_SIG)throw new Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"));if(!(e.key.length===34||e.key.length===66)||![2,3,4].includes(e.key[1]))throw new Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"));return{pubkey:e.key.slice(1),signature:e.value}}Cn.decode=mP;function _P(e){let t=p.Buffer.from([gm.InputTypes.PARTIAL_SIG]);return{key:p.Buffer.concat([t,e.pubkey]),value:e.signature}}Cn.encode=_P;Cn.expected="{ pubkey: Buffer; signature: Buffer; }";function vP(e){return p.Buffer.isBuffer(e.pubkey)&&p.Buffer.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&wP(e.signature)}Cn.check=vP;function wP(e){if(!p.Buffer.isBuffer(e)||e.length<9||e[0]!==48||e.length!==e[1]+3||e[2]!==2)return!1;let t=e[3];if(t>33||t<1||e[3+t+1]!==2)return!1;let r=e[3+t+2];return!(r>33||r<1||e.length!==3+t+2+r+2)}function SP(e,t,r){let n=t.pubkey.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)).length===0)}Cn.canAddToArray=SP});var _m=H(kn=>{w();S();Object.defineProperty(kn,"__esModule",{value:!0});kn.canAdd=kn.check=kn.expected=kn.encode=kn.decode=void 0;var mm=pr();function xP(e){if(e.key[0]!==mm.InputTypes.POR_COMMITMENT)throw new Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"));return e.value.toString("utf8")}kn.decode=xP;function PP(e){return{key:p.Buffer.from([mm.InputTypes.POR_COMMITMENT]),value:p.Buffer.from(e,"utf8")}}kn.encode=PP;kn.expected="string";function TP(e){return typeof e=="string"}kn.check=TP;function EP(e,t){return!!e&&!!t&&e.porCommitment===void 0}kn.canAdd=EP});var wm=H(Hn=>{w();S();Object.defineProperty(Hn,"__esModule",{value:!0});Hn.canAdd=Hn.check=Hn.expected=Hn.encode=Hn.decode=void 0;var vm=pr();function AP(e){if(e.key[0]!==vm.InputTypes.SIGHASH_TYPE)throw new Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"));return e.value.readUInt32LE(0)}Hn.decode=AP;function IP(e){let t=p.Buffer.from([vm.InputTypes.SIGHASH_TYPE]),r=p.Buffer.allocUnsafe(4);return r.writeUInt32LE(e,0),{key:t,value:r}}Hn.encode=IP;Hn.expected="number";function OP(e){return typeof e=="number"}Hn.check=OP;function BP(e,t){return!!e&&!!t&&e.sighashType===void 0}Hn.canAdd=BP});var Pm=H(Nn=>{w();S();Object.defineProperty(Nn,"__esModule",{value:!0});Nn.canAdd=Nn.check=Nn.expected=Nn.encode=Nn.decode=void 0;var Sm=pr();function MP(e){if(e.key[0]!==Sm.InputTypes.TAP_KEY_SIG||e.key.length!==1)throw new Error("Decode Error: could not decode tapKeySig with key 0x"+e.key.toString("hex"));if(!xm(e.value))throw new Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}Nn.decode=MP;function CP(e){return{key:p.Buffer.from([Sm.InputTypes.TAP_KEY_SIG]),value:e}}Nn.encode=CP;Nn.expected="Buffer";function xm(e){return p.Buffer.isBuffer(e)&&(e.length===64||e.length===65)}Nn.check=xm;function kP(e,t){return!!e&&!!t&&e.tapKeySig===void 0}Nn.canAdd=kP});var Em=H(Rn=>{w();S();Object.defineProperty(Rn,"__esModule",{value:!0});Rn.canAddToArray=Rn.check=Rn.expected=Rn.encode=Rn.decode=void 0;var Tm=pr();function HP(e){if(e.key[0]!==Tm.InputTypes.TAP_LEAF_SCRIPT)throw new Error("Decode Error: could not decode tapLeafScript with key 0x"+e.key.toString("hex"));if((e.key.length-2)%32!==0)throw new Error("Decode Error: tapLeafScript has invalid control block in key 0x"+e.key.toString("hex"));let t=e.value[e.value.length-1];if((e.key[1]&254)!==t)throw new Error("Decode Error: tapLeafScript bad leaf version in key 0x"+e.key.toString("hex"));let r=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:r,leafVersion:t}}Rn.decode=HP;function NP(e){let t=p.Buffer.from([Tm.InputTypes.TAP_LEAF_SCRIPT]),r=p.Buffer.from([e.leafVersion]);return{key:p.Buffer.concat([t,e.controlBlock]),value:p.Buffer.concat([e.script,r])}}Rn.encode=NP;Rn.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }";function RP(e){return p.Buffer.isBuffer(e.controlBlock)&&(e.controlBlock.length-1)%32===0&&(e.controlBlock[0]&254)===e.leafVersion&&p.Buffer.isBuffer(e.script)}Rn.check=RP;function UP(e,t,r){let n=t.controlBlock.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.controlBlock.equals(t.controlBlock)).length===0)}Rn.canAddToArray=UP});var Om=H(Un=>{w();S();Object.defineProperty(Un,"__esModule",{value:!0});Un.canAdd=Un.check=Un.expected=Un.encode=Un.decode=void 0;var Am=pr();function qP(e){if(e.key[0]!==Am.InputTypes.TAP_MERKLE_ROOT||e.key.length!==1)throw new Error("Decode Error: could not decode tapMerkleRoot with key 0x"+e.key.toString("hex"));if(!Im(e.value))throw new Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}Un.decode=qP;function LP(e){return{key:p.Buffer.from([Am.InputTypes.TAP_MERKLE_ROOT]),value:e}}Un.encode=LP;Un.expected="Buffer";function Im(e){return p.Buffer.isBuffer(e)&&e.length===32}Un.check=Im;function KP(e,t){return!!e&&!!t&&e.tapMerkleRoot===void 0}Un.canAdd=KP});var Mm=H(qn=>{w();S();Object.defineProperty(qn,"__esModule",{value:!0});qn.canAddToArray=qn.check=qn.expected=qn.encode=qn.decode=void 0;var Bm=pr();function DP(e){if(e.key[0]!==Bm.InputTypes.TAP_SCRIPT_SIG)throw new Error("Decode Error: could not decode tapScriptSig with key 0x"+e.key.toString("hex"));if(e.key.length!==65)throw new Error("Decode Error: tapScriptSig has invalid key 0x"+e.key.toString("hex"));if(e.value.length!==64&&e.value.length!==65)throw new Error("Decode Error: tapScriptSig has invalid signature in key 0x"+e.key.toString("hex"));let t=e.key.slice(1,33),r=e.key.slice(33);return{pubkey:t,leafHash:r,signature:e.value}}qn.decode=DP;function jP(e){let t=p.Buffer.from([Bm.InputTypes.TAP_SCRIPT_SIG]);return{key:p.Buffer.concat([t,e.pubkey,e.leafHash]),value:e.signature}}qn.encode=jP;qn.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }";function FP(e){return p.Buffer.isBuffer(e.pubkey)&&p.Buffer.isBuffer(e.leafHash)&&p.Buffer.isBuffer(e.signature)&&e.pubkey.length===32&&e.leafHash.length===32&&(e.signature.length===64||e.signature.length===65)}qn.check=FP;function GP(e,t,r){let n=t.pubkey.toString("hex")+t.leafHash.toString("hex");return r.has(n)?!1:(r.add(n),e.filter(i=>i.pubkey.equals(t.pubkey)&&i.leafHash.equals(t.leafHash)).length===0)}qn.canAddToArray=GP});var Ds=H(Ks=>{w();S();Object.defineProperty(Ks,"__esModule",{value:!0});Ks.encodingLength=Ks.decode=Ks.encode=void 0;var VP=9007199254740991;function hh(e){if(e<0||e>VP||e%1!==0)throw new RangeError("value out of range")}function _c(e,t,r){if(hh(e),t||(t=p.Buffer.allocUnsafe(Cm(e))),!p.Buffer.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),Object.assign(_c,{bytes:1})):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),Object.assign(_c,{bytes:3})):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),Object.assign(_c,{bytes:5})):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),Object.assign(_c,{bytes:9})),t}Ks.encode=_c;function vc(e,t){if(!p.Buffer.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");t||(t=0);let r=e.readUInt8(t);if(r<253)return Object.assign(vc,{bytes:1}),r;if(r===253)return Object.assign(vc,{bytes:3}),e.readUInt16LE(t+1);if(r===254)return Object.assign(vc,{bytes:5}),e.readUInt32LE(t+1);{Object.assign(vc,{bytes:9});let n=e.readUInt32LE(t+1),s=e.readUInt32LE(t+5)*4294967296+n;return hh(s),s}}Ks.decode=vc;function Cm(e){return hh(e),e<253?1:e<=65535?3:e<=4294967295?5:9}Ks.encodingLength=Cm});var df=H($t=>{w();S();var WP=$t&&$t.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zP=$t&&$t.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),XP=$t&&$t.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&WP(t,e,r);return zP(t,e),t};Object.defineProperty($t,"__esModule",{value:!0});$t.writeUInt64LE=$t.readUInt64LE=$t.keyValToBuffer=$t.keyValsToBuffer=$t.reverseBuffer=$t.range=void 0;var ff=XP(Ds()),YP=e=>[...Array(e).keys()];$t.range=YP;function $P(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}$t.reverseBuffer=$P;function ZP(e){let t=e.map(km);return t.push(p.Buffer.from([0])),p.Buffer.concat(t)}$t.keyValsToBuffer=ZP;function km(e){let t=e.key.length,r=e.value.length,n=ff.encodingLength(t),i=ff.encodingLength(r),s=p.Buffer.allocUnsafe(n+t+i+r);return ff.encode(t,s,0),e.key.copy(s,n),ff.encode(r,s,n+t),e.value.copy(s,n+t+i),s}$t.keyValToBuffer=km;function Hm(e,t){if(typeof e!="number")throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function JP(e,t){let r=e.readUInt32LE(t),n=e.readUInt32LE(t+4);return n*=4294967296,Hm(n+r,9007199254740991),n+r}$t.readUInt64LE=JP;function QP(e,t,r){return Hm(t,9007199254740991),e.writeInt32LE(t&-1,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}$t.writeUInt64LE=QP});var Um=H(br=>{w();S();var eT=br&&br.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),tT=br&&br.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),rT=br&&br.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&eT(t,e,r);return tT(t,e),t};Object.defineProperty(br,"__esModule",{value:!0});br.canAdd=br.check=br.expected=br.encode=br.decode=void 0;var Nm=pr(),Rm=df(),lf=rT(Ds());function nT(e){if(e.key[0]!==Nm.InputTypes.WITNESS_UTXO)throw new Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"));let t=(0,Rm.readUInt64LE)(e.value,0),r=8,n=lf.decode(e.value,r);r+=lf.encodingLength(n);let i=e.value.slice(r);if(i.length!==n)throw new Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:i,value:t}}br.decode=nT;function iT(e){let{script:t,value:r}=e,n=lf.encodingLength(t.length),i=p.Buffer.allocUnsafe(8+n+t.length);return(0,Rm.writeUInt64LE)(i,r,0),lf.encode(t.length,i,8),t.copy(i,8+n),{key:p.Buffer.from([Nm.InputTypes.WITNESS_UTXO]),value:i}}br.encode=iT;br.expected="{ script: Buffer; value: number; }";function sT(e){return p.Buffer.isBuffer(e.script)&&typeof e.value=="number"}br.check=sT;function oT(e,t){return!!e&&!!t&&e.witnessUtxo===void 0}br.canAdd=oT});var Lm=H(gr=>{w();S();var aT=gr&&gr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),cT=gr&&gr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),uT=gr&&gr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&aT(t,e,r);return cT(t,e),t};Object.defineProperty(gr,"__esModule",{value:!0});gr.canAdd=gr.check=gr.expected=gr.encode=gr.decode=void 0;var qm=pr(),ph=uT(Ds());function fT(e){if(e.key[0]!==qm.OutputTypes.TAP_TREE||e.key.length!==1)throw new Error("Decode Error: could not decode tapTree with key 0x"+e.key.toString("hex"));let t=0,r=[];for(;t<e.value.length;){let n=e.value[t++],i=e.value[t++],s=ph.decode(e.value,t);t+=ph.encodingLength(s),r.push({depth:n,leafVersion:i,script:e.value.slice(t,t+s)}),t+=s}return{leaves:r}}gr.decode=fT;function dT(e){let t=p.Buffer.from([qm.OutputTypes.TAP_TREE]),r=[].concat(...e.leaves.map(n=>[p.Buffer.of(n.depth,n.leafVersion),ph.encode(n.script.length),n.script]));return{key:t,value:p.Buffer.concat(r)}}gr.encode=dT;gr.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }";function lT(e){return Array.isArray(e.leaves)&&e.leaves.every(t=>t.depth>=0&&t.depth<=128&&(t.leafVersion&254)===t.leafVersion&&p.Buffer.isBuffer(t.script))}gr.check=lT;function hT(e,t){return!!e&&!!t&&e.tapTree===void 0}gr.canAdd=hT});var bh=H(hf=>{w();S();Object.defineProperty(hf,"__esModule",{value:!0});hf.makeConverter=void 0;var pT=e=>[...Array(e).keys()],bT=e=>e.length===33&&[2,3].includes(e[0])||e.length===65&&e[0]===4;function gT(e,t=bT){function r(a){if(a.key[0]!==e)throw new Error("Decode Error: could not decode bip32Derivation with key 0x"+a.key.toString("hex"));let c=a.key.slice(1);if(!t(c))throw new Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+a.key.toString("hex"));if(a.value.length/4%1!==0)throw new Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");let u={masterFingerprint:a.value.slice(0,4),pubkey:c,path:"m"};for(let d of pT(a.value.length/4-1)){let f=a.value.readUInt32LE(d*4+4),b=!!(f&2147483648),m=f&2147483647;u.path+="/"+m.toString(10)+(b?"'":"")}return u}function n(a){let c=p.Buffer.from([e]),u=p.Buffer.concat([c,a.pubkey]),d=a.path.split("/"),f=p.Buffer.allocUnsafe(d.length*4);a.masterFingerprint.copy(f,0);let b=4;return d.slice(1).forEach(m=>{let y=m.slice(-1)==="'",_=2147483647&parseInt(y?m.slice(0,-1):m,10);y&&(_+=2147483648),f.writeUInt32LE(_,b),b+=4}),{key:u,value:f}}let i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }";function s(a){return p.Buffer.isBuffer(a.pubkey)&&p.Buffer.isBuffer(a.masterFingerprint)&&typeof a.path=="string"&&t(a.pubkey)&&a.masterFingerprint.length===4}function o(a,c,u){let d=c.pubkey.toString("hex");return u.has(d)?!1:(u.add(d),a.filter(f=>f.pubkey.equals(c.pubkey)).length===0)}return{decode:r,encode:n,check:s,expected:i,canAddToArray:o}}hf.makeConverter=gT});var Km=H(pf=>{w();S();Object.defineProperty(pf,"__esModule",{value:!0});pf.makeChecker=void 0;function yT(e){return t;function t(r){let n;if(e.includes(r.key[0])&&(n=r.key.slice(1),!(n.length===33||n.length===65)||![2,3,4].includes(n[0])))throw new Error("Format Error: invalid pubkey in key 0x"+r.key.toString("hex"));return n}}pf.makeChecker=yT});var Dm=H(bf=>{w();S();Object.defineProperty(bf,"__esModule",{value:!0});bf.makeConverter=void 0;function mT(e){function t(o){if(o.key[0]!==e)throw new Error("Decode Error: could not decode redeemScript with key 0x"+o.key.toString("hex"));return o.value}function r(o){return{key:p.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return p.Buffer.isBuffer(o)}function s(o,a){return!!o&&!!a&&o.redeemScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}bf.makeConverter=mT});var Fm=H(Ei=>{w();S();var _T=Ei&&Ei.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),vT=Ei&&Ei.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jm=Ei&&Ei.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&_T(t,e,r);return vT(t,e),t};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.makeConverter=void 0;var gf=jm(Ds()),wT=jm(bh()),ST=e=>e.length===32;function xT(e){let t=wT.makeConverter(e,ST);function r(o){let a=gf.decode(o.value),c=gf.encodingLength(a),u=t.decode({key:o.key,value:o.value.slice(c+a*32)}),d=new Array(a);for(let f=0,b=c;f<a;f++,b+=32)d[f]=o.value.slice(b,b+32);return{...u,leafHashes:d}}function n(o){let a=t.encode(o),c=gf.encodingLength(o.leafHashes.length),u=p.Buffer.allocUnsafe(c);gf.encode(o.leafHashes.length,u);let d=p.Buffer.concat([u,...o.leafHashes,a.value]);return{...a,value:d}}let i="{ masterFingerprint: Buffer; pubkey: Buffer; path: string; leafHashes: Buffer[]; }";function s(o){return Array.isArray(o.leafHashes)&&o.leafHashes.every(a=>p.Buffer.isBuffer(a)&&a.length===32)&&t.check(o)}return{decode:r,encode:n,check:s,expected:i,canAddToArray:t.canAddToArray}}Ei.makeConverter=xT});var Gm=H(yf=>{w();S();Object.defineProperty(yf,"__esModule",{value:!0});yf.makeConverter=void 0;function PT(e){function t(o){if(o.key[0]!==e||o.key.length!==1)throw new Error("Decode Error: could not decode tapInternalKey with key 0x"+o.key.toString("hex"));if(o.value.length!==32)throw new Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return o.value}function r(o){return{key:p.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return p.Buffer.isBuffer(o)&&o.length===32}function s(o,a){return!!o&&!!a&&o.tapInternalKey===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}yf.makeConverter=PT});var Vm=H(mf=>{w();S();Object.defineProperty(mf,"__esModule",{value:!0});mf.makeConverter=void 0;function TT(e){function t(o){if(o.key[0]!==e)throw new Error("Decode Error: could not decode witnessScript with key 0x"+o.key.toString("hex"));return o.value}function r(o){return{key:p.Buffer.from([e]),value:o}}let n="Buffer";function i(o){return p.Buffer.isBuffer(o)}function s(o,a){return!!o&&!!a&&o.witnessScript===void 0}return{decode:t,encode:r,check:i,expected:n,canAdd:s}}mf.makeConverter=TT});var _f=H(cn=>{w();S();var ET=cn&&cn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),AT=cn&&cn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Zt=cn&&cn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&ET(t,e,r);return AT(t,e),t};Object.defineProperty(cn,"__esModule",{value:!0});cn.outputs=cn.inputs=cn.globals=void 0;var yn=pr(),IT=Zt(cm()),OT=Zt(um()),BT=Zt(dm()),MT=Zt(hm()),CT=Zt(bm()),kT=Zt(ym()),HT=Zt(_m()),NT=Zt(wm()),RT=Zt(Pm()),UT=Zt(Em()),qT=Zt(Om()),LT=Zt(Mm()),KT=Zt(Um()),DT=Zt(Lm()),Wm=Zt(bh()),gh=Zt(Km()),zm=Zt(Dm()),Xm=Zt(Fm()),Ym=Zt(Gm()),$m=Zt(Vm()),jT={unsignedTx:OT,globalXpub:IT,checkPubkey:gh.makeChecker([])};cn.globals=jT;var FT={nonWitnessUtxo:CT,partialSig:kT,sighashType:NT,finalScriptSig:BT,finalScriptWitness:MT,porCommitment:HT,witnessUtxo:KT,bip32Derivation:Wm.makeConverter(yn.InputTypes.BIP32_DERIVATION),redeemScript:zm.makeConverter(yn.InputTypes.REDEEM_SCRIPT),witnessScript:$m.makeConverter(yn.InputTypes.WITNESS_SCRIPT),checkPubkey:gh.makeChecker([yn.InputTypes.PARTIAL_SIG,yn.InputTypes.BIP32_DERIVATION]),tapKeySig:RT,tapScriptSig:LT,tapLeafScript:UT,tapBip32Derivation:Xm.makeConverter(yn.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:Ym.makeConverter(yn.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:qT};cn.inputs=FT;var GT={bip32Derivation:Wm.makeConverter(yn.OutputTypes.BIP32_DERIVATION),redeemScript:zm.makeConverter(yn.OutputTypes.REDEEM_SCRIPT),witnessScript:$m.makeConverter(yn.OutputTypes.WITNESS_SCRIPT),checkPubkey:gh.makeChecker([yn.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:Xm.makeConverter(yn.OutputTypes.TAP_BIP32_DERIVATION),tapTree:DT,tapInternalKey:Ym.makeConverter(yn.OutputTypes.TAP_INTERNAL_KEY)};cn.outputs=GT});var e2=H(un=>{w();S();var VT=un&&un.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),WT=un&&un.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Jm=un&&un.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&VT(t,e,r);return WT(t,e),t};Object.defineProperty(un,"__esModule",{value:!0});un.psbtFromKeyVals=un.checkKeyBuffer=un.psbtFromBuffer=void 0;var Ye=Jm(_f()),vf=df(),Zm=Jm(Ds()),ce=pr();function zT(e,t){let r=0;function n(){let E=Zm.decode(e,r);r+=Zm.encodingLength(E);let I=e.slice(r,r+E);return r+=E,I}function i(){let E=e.readUInt32BE(r);return r+=4,E}function s(){let E=e.readUInt8(r);return r+=1,E}function o(){let E=n(),I=n();return{key:E,value:I}}function a(){if(r>=e.length)throw new Error("Format Error: Unexpected End of PSBT");let E=e.readUInt8(r)===0;return E&&r++,E}if(i()!==1886610036)throw new Error("Format Error: Invalid Magic Number");if(s()!==255)throw new Error("Format Error: Magic Number must be followed by 0xff separator");let c=[],u={};for(;!a();){let E=o(),I=E.key.toString("hex");if(u[I])throw new Error("Format Error: Keys must be unique for global keymap: key "+I);u[I]=1,c.push(E)}let d=c.filter(E=>E.key[0]===ce.GlobalTypes.UNSIGNED_TX);if(d.length!==1)throw new Error("Format Error: Only one UNSIGNED_TX allowed");let f=t(d[0].value),{inputCount:b,outputCount:m}=f.getInputOutputCounts(),y=[],_=[];for(let E of(0,vf.range)(b)){let I={},k=[];for(;!a();){let C=o(),U=C.key.toString("hex");if(I[U])throw new Error("Format Error: Keys must be unique for each input: input index "+E+" key "+U);I[U]=1,k.push(C)}y.push(k)}for(let E of(0,vf.range)(m)){let I={},k=[];for(;!a();){let C=o(),U=C.key.toString("hex");if(I[U])throw new Error("Format Error: Keys must be unique for each output: output index "+E+" key "+U);I[U]=1,k.push(C)}_.push(k)}return Qm(f,{globalMapKeyVals:c,inputKeyVals:y,outputKeyVals:_})}un.psbtFromBuffer=zT;function Ar(e,t,r){if(!t.equals(p.Buffer.from([r])))throw new Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}un.checkKeyBuffer=Ar;function Qm(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:n}){let i={unsignedTx:e},s=0;for(let d of t)switch(d.key[0]){case ce.GlobalTypes.UNSIGNED_TX:if(Ar("global",d.key,ce.GlobalTypes.UNSIGNED_TX),s>0)throw new Error("Format Error: GlobalMap has multiple UNSIGNED_TX");s++;break;case ce.GlobalTypes.GLOBAL_XPUB:i.globalXpub===void 0&&(i.globalXpub=[]),i.globalXpub.push(Ye.globals.globalXpub.decode(d));break;default:i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(d)}let o=r.length,a=n.length,c=[],u=[];for(let d of(0,vf.range)(o)){let f={};for(let b of r[d])switch(Ye.inputs.checkPubkey(b),b.key[0]){case ce.InputTypes.NON_WITNESS_UTXO:if(Ar("input",b.key,ce.InputTypes.NON_WITNESS_UTXO),f.nonWitnessUtxo!==void 0)throw new Error("Format Error: Input has multiple NON_WITNESS_UTXO");f.nonWitnessUtxo=Ye.inputs.nonWitnessUtxo.decode(b);break;case ce.InputTypes.WITNESS_UTXO:if(Ar("input",b.key,ce.InputTypes.WITNESS_UTXO),f.witnessUtxo!==void 0)throw new Error("Format Error: Input has multiple WITNESS_UTXO");f.witnessUtxo=Ye.inputs.witnessUtxo.decode(b);break;case ce.InputTypes.PARTIAL_SIG:f.partialSig===void 0&&(f.partialSig=[]),f.partialSig.push(Ye.inputs.partialSig.decode(b));break;case ce.InputTypes.SIGHASH_TYPE:if(Ar("input",b.key,ce.InputTypes.SIGHASH_TYPE),f.sighashType!==void 0)throw new Error("Format Error: Input has multiple SIGHASH_TYPE");f.sighashType=Ye.inputs.sighashType.decode(b);break;case ce.InputTypes.REDEEM_SCRIPT:if(Ar("input",b.key,ce.InputTypes.REDEEM_SCRIPT),f.redeemScript!==void 0)throw new Error("Format Error: Input has multiple REDEEM_SCRIPT");f.redeemScript=Ye.inputs.redeemScript.decode(b);break;case ce.InputTypes.WITNESS_SCRIPT:if(Ar("input",b.key,ce.InputTypes.WITNESS_SCRIPT),f.witnessScript!==void 0)throw new Error("Format Error: Input has multiple WITNESS_SCRIPT");f.witnessScript=Ye.inputs.witnessScript.decode(b);break;case ce.InputTypes.BIP32_DERIVATION:f.bip32Derivation===void 0&&(f.bip32Derivation=[]),f.bip32Derivation.push(Ye.inputs.bip32Derivation.decode(b));break;case ce.InputTypes.FINAL_SCRIPTSIG:Ar("input",b.key,ce.InputTypes.FINAL_SCRIPTSIG),f.finalScriptSig=Ye.inputs.finalScriptSig.decode(b);break;case ce.InputTypes.FINAL_SCRIPTWITNESS:Ar("input",b.key,ce.InputTypes.FINAL_SCRIPTWITNESS),f.finalScriptWitness=Ye.inputs.finalScriptWitness.decode(b);break;case ce.InputTypes.POR_COMMITMENT:Ar("input",b.key,ce.InputTypes.POR_COMMITMENT),f.porCommitment=Ye.inputs.porCommitment.decode(b);break;case ce.InputTypes.TAP_KEY_SIG:Ar("input",b.key,ce.InputTypes.TAP_KEY_SIG),f.tapKeySig=Ye.inputs.tapKeySig.decode(b);break;case ce.InputTypes.TAP_SCRIPT_SIG:f.tapScriptSig===void 0&&(f.tapScriptSig=[]),f.tapScriptSig.push(Ye.inputs.tapScriptSig.decode(b));break;case ce.InputTypes.TAP_LEAF_SCRIPT:f.tapLeafScript===void 0&&(f.tapLeafScript=[]),f.tapLeafScript.push(Ye.inputs.tapLeafScript.decode(b));break;case ce.InputTypes.TAP_BIP32_DERIVATION:f.tapBip32Derivation===void 0&&(f.tapBip32Derivation=[]),f.tapBip32Derivation.push(Ye.inputs.tapBip32Derivation.decode(b));break;case ce.InputTypes.TAP_INTERNAL_KEY:Ar("input",b.key,ce.InputTypes.TAP_INTERNAL_KEY),f.tapInternalKey=Ye.inputs.tapInternalKey.decode(b);break;case ce.InputTypes.TAP_MERKLE_ROOT:Ar("input",b.key,ce.InputTypes.TAP_MERKLE_ROOT),f.tapMerkleRoot=Ye.inputs.tapMerkleRoot.decode(b);break;default:f.unknownKeyVals||(f.unknownKeyVals=[]),f.unknownKeyVals.push(b)}c.push(f)}for(let d of(0,vf.range)(a)){let f={};for(let b of n[d])switch(Ye.outputs.checkPubkey(b),b.key[0]){case ce.OutputTypes.REDEEM_SCRIPT:if(Ar("output",b.key,ce.OutputTypes.REDEEM_SCRIPT),f.redeemScript!==void 0)throw new Error("Format Error: Output has multiple REDEEM_SCRIPT");f.redeemScript=Ye.outputs.redeemScript.decode(b);break;case ce.OutputTypes.WITNESS_SCRIPT:if(Ar("output",b.key,ce.OutputTypes.WITNESS_SCRIPT),f.witnessScript!==void 0)throw new Error("Format Error: Output has multiple WITNESS_SCRIPT");f.witnessScript=Ye.outputs.witnessScript.decode(b);break;case ce.OutputTypes.BIP32_DERIVATION:f.bip32Derivation===void 0&&(f.bip32Derivation=[]),f.bip32Derivation.push(Ye.outputs.bip32Derivation.decode(b));break;case ce.OutputTypes.TAP_INTERNAL_KEY:Ar("output",b.key,ce.OutputTypes.TAP_INTERNAL_KEY),f.tapInternalKey=Ye.outputs.tapInternalKey.decode(b);break;case ce.OutputTypes.TAP_TREE:Ar("output",b.key,ce.OutputTypes.TAP_TREE),f.tapTree=Ye.outputs.tapTree.decode(b);break;case ce.OutputTypes.TAP_BIP32_DERIVATION:f.tapBip32Derivation===void 0&&(f.tapBip32Derivation=[]),f.tapBip32Derivation.push(Ye.outputs.tapBip32Derivation.decode(b));break;default:f.unknownKeyVals||(f.unknownKeyVals=[]),f.unknownKeyVals.push(b)}u.push(f)}return{globalMap:i,inputs:c,outputs:u}}un.psbtFromKeyVals=Qm});var n2=H(Ln=>{w();S();var XT=Ln&&Ln.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),YT=Ln&&Ln.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$T=Ln&&Ln.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&XT(t,e,r);return YT(t,e),t};Object.defineProperty(Ln,"__esModule",{value:!0});Ln.psbtToKeyVals=Ln.psbtToBuffer=void 0;var yh=$T(_f()),t2=df();function ZT({globalMap:e,inputs:t,outputs:r}){let{globalKeyVals:n,inputKeyVals:i,outputKeyVals:s}=r2({globalMap:e,inputs:t,outputs:r}),o=(0,t2.keyValsToBuffer)(n),a=f=>f.length===0?[p.Buffer.from([0])]:f.map(t2.keyValsToBuffer),c=a(i),u=a(s),d=p.Buffer.allocUnsafe(5);return d.writeUIntBE(482972169471,0,5),p.Buffer.concat([d,o].concat(c,u))}Ln.psbtToBuffer=ZT;var JT=(e,t)=>e.key.compare(t.key);function mh(e,t){let r=new Set,n=Object.entries(e).reduce((s,[o,a])=>{if(o==="unknownKeyVals")return s;let c=t[o];if(c===void 0)return s;let u=(Array.isArray(a)?a:[a]).map(c.encode);return u.map(f=>f.key.toString("hex")).forEach(f=>{if(r.has(f))throw new Error("Serialize Error: Duplicate key: "+f);r.add(f)}),s.concat(u)},[]),i=e.unknownKeyVals?e.unknownKeyVals.filter(s=>!r.has(s.key.toString("hex"))):[];return n.concat(i).sort(JT)}function r2({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:mh(e,yh.globals),inputKeyVals:t.map(n=>mh(n,yh.inputs)),outputKeyVals:r.map(n=>mh(n,yh.outputs))}}Ln.psbtToKeyVals=r2});var _h=H(js=>{w();S();var QT=js&&js.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),i2=js&&js.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&QT(t,e,r)};Object.defineProperty(js,"__esModule",{value:!0});i2(e2(),js);i2(n2(),js)});var o2=H(wf=>{w();S();Object.defineProperty(wf,"__esModule",{value:!0});wf.combine=void 0;var vh=_h();function e7(e){let t=e[0],r=(0,vh.psbtToKeyVals)(t),n=e.slice(1);if(n.length===0)throw new Error("Combine: Nothing to combine");let i=s2(t);if(i===void 0)throw new Error("Combine: Self missing transaction");let s=ma(r.globalKeyVals),o=r.inputKeyVals.map(ma),a=r.outputKeyVals.map(ma);for(let c of n){let u=s2(c);if(u===void 0||!u.toBuffer().equals(i.toBuffer()))throw new Error("Combine: One of the Psbts does not have the same transaction.");let d=(0,vh.psbtToKeyVals)(c);ma(d.globalKeyVals).forEach(wh(s,r.globalKeyVals,d.globalKeyVals)),d.inputKeyVals.map(ma).forEach((y,_)=>y.forEach(wh(o[_],r.inputKeyVals[_],d.inputKeyVals[_]))),d.outputKeyVals.map(ma).forEach((y,_)=>y.forEach(wh(a[_],r.outputKeyVals[_],d.outputKeyVals[_])))}return(0,vh.psbtFromKeyVals)(i,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}wf.combine=e7;function wh(e,t,r){return n=>{if(e.has(n))return;let i=r.filter(s=>s.key.toString("hex")===n)[0];t.push(i),e.add(n)}}function s2(e){return e.globalMap.unsignedTx}function ma(e){let t=new Set;return e.forEach(r=>{let n=r.key.toString("hex");if(t.has(n))throw new Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}});var xh=H(_e=>{w();S();var t7=_e&&_e.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),r7=_e&&_e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n7=_e&&_e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&t7(t,e,r);return r7(t,e),t};Object.defineProperty(_e,"__esModule",{value:!0});_e.defaultLocktimeSetter=_e.defaultVersionSetter=_e.addOutputAttributes=_e.addInputAttributes=_e.updateOutput=_e.updateInput=_e.updateGlobal=_e.inputCheckUncleanFinalized=_e.getEnumLength=_e.checkHasKey=_e.checkForOutput=_e.checkForInput=void 0;var i7=n7(_f());function c2(e,t){let r=e[t];if(r===void 0)throw new Error(`No input #${t}`);return r}_e.checkForInput=c2;function u2(e,t){let r=e[t];if(r===void 0)throw new Error(`No output #${t}`);return r}_e.checkForOutput=u2;function s7(e,t,r){if(e.key[0]<r)throw new Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&t.filter(n=>n.key.equals(e.key)).length!==0)throw new Error(`Duplicate Key: ${e.key.toString("hex")}`)}_e.checkHasKey=s7;function o7(e){let t=0;return Object.keys(e).forEach(r=>{Number(isNaN(Number(r)))&&t++}),t}_e.getEnumLength=o7;function a7(e,t){let r=!1;if(t.nonWitnessUtxo||t.witnessUtxo){let n=!!t.redeemScript,i=!!t.witnessScript,s=!n||!!t.finalScriptSig,o=!i||!!t.finalScriptWitness,a=!!t.finalScriptSig||!!t.finalScriptWitness;r=s&&o&&a}if(r===!1)throw new Error(`Input #${e} has too much or too little data to clean`)}_e.inputCheckUncleanFinalized=a7;function a2(e,t,r,n){throw new Error(`Data for ${e} key ${t} is incorrect: Expected ${r} and got ${JSON.stringify(n)}`)}function Sh(e){return(t,r)=>{for(let n of Object.keys(t)){let i=t[n],{canAdd:s,canAddToArray:o,check:a,expected:c}=i7[e+"s"][n]||{},u=!!o;if(a)if(u){if(!Array.isArray(i)||r[n]&&!Array.isArray(r[n]))throw new Error(`Key type ${n} must be an array`);i.every(a)||a2(e,n,c,i);let d=r[n]||[],f=new Set;if(!i.every(b=>o(d,b,f)))throw new Error("Can not add duplicate data to array");r[n]=d.concat(i)}else{if(a(i)||a2(e,n,c,i),!s(r,i))throw new Error(`Can not add duplicate data to ${e}`);r[n]=i}}}}_e.updateGlobal=Sh("global");_e.updateInput=Sh("input");_e.updateOutput=Sh("output");function c7(e,t){let r=e.length-1,n=c2(e,r);(0,_e.updateInput)(t,n)}_e.addInputAttributes=c7;function u7(e,t){let r=e.length-1,n=u2(e,r);(0,_e.updateOutput)(t,n)}_e.addOutputAttributes=u7;function f7(e,t){if(!p.Buffer.isBuffer(t)||t.length<4)throw new Error("Set Version: Invalid Transaction");return t.writeUInt32LE(e,0),t}_e.defaultVersionSetter=f7;function d7(e,t){if(!p.Buffer.isBuffer(t)||t.length<4)throw new Error("Set Locktime: Invalid Transaction");return t.writeUInt32LE(e,t.length-4),t}_e.defaultLocktimeSetter=d7});var d2=H(Sf=>{w();S();Object.defineProperty(Sf,"__esModule",{value:!0});Sf.Psbt=void 0;var l7=o2(),f2=_h(),Ph=pr(),Ir=xh(),Th=class{static fromBase64(t,r){let n=p.Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r){let n=p.Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r){let n=(0,f2.psbtFromBuffer)(t,r),i=new this(n.globalMap.unsignedTx);return Object.assign(i,n),i}constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}toBase64(){return this.toBuffer().toString("base64")}toHex(){return this.toBuffer().toString("hex")}toBuffer(){return(0,f2.psbtToBuffer)(this)}updateGlobal(t){return(0,Ir.updateGlobal)(t,this.globalMap),this}updateInput(t,r){let n=(0,Ir.checkForInput)(this.inputs,t);return(0,Ir.updateInput)(r,n),this}updateOutput(t,r){let n=(0,Ir.checkForOutput)(this.outputs,t);return(0,Ir.updateOutput)(r,n),this}addUnknownKeyValToGlobal(t){return(0,Ir.checkHasKey)(t,this.globalMap.unknownKeyVals,(0,Ir.getEnumLength)(Ph.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,r){let n=(0,Ir.checkForInput)(this.inputs,t);return(0,Ir.checkHasKey)(r,n.unknownKeyVals,(0,Ir.getEnumLength)(Ph.InputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addUnknownKeyValToOutput(t,r){let n=(0,Ir.checkForOutput)(this.outputs,t);return(0,Ir.checkHasKey)(r,n.unknownKeyVals,(0,Ir.getEnumLength)(Ph.OutputTypes)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(r),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});let r=t.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),(0,Ir.addInputAttributes)(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});let r=t.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(r))throw new Error("unknownKeyVals must be an Array");return r.forEach(i=>this.addUnknownKeyValToInput(n,i)),(0,Ir.addOutputAttributes)(this.outputs,t),this}clearFinalizedInput(t){let r=(0,Ir.checkForInput)(this.inputs,t);(0,Ir.inputCheckUncleanFinalized)(t,r);for(let n of Object.keys(r))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete r[n];return this}combine(...t){let r=(0,l7.combine)([this].concat(t));return Object.assign(this,r),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}};Sf.Psbt=Th});var mo=H(Te=>{w();S();var h7=Te&&Te.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),p7=Te&&Te.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Eh=Te&&Te.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&h7(t,e,r);return p7(t,e),t};Object.defineProperty(Te,"__esModule",{value:!0});Te.signatureBlocksAction=Te.checkInputForSig=Te.pubkeyInScript=Te.pubkeyPositionInScript=Te.witnessStackToScriptWitness=Te.isP2TR=Te.isP2SHScript=Te.isP2WSHScript=Te.isP2WPKH=Te.isP2PKH=Te.isP2PK=Te.isP2MS=void 0;var l2=Eh(Ds()),wc=Eh(Gt()),xf=Ls(),b7=wr(),go=Eh(Rs());function yo(e){return t=>{try{return e({output:t}),!0}catch{return!1}}}Te.isP2MS=yo(go.p2ms);Te.isP2PK=yo(go.p2pk);Te.isP2PKH=yo(go.p2pkh);Te.isP2WPKH=yo(go.p2wpkh);Te.isP2WSHScript=yo(go.p2wsh);Te.isP2SHScript=yo(go.p2sh);Te.isP2TR=yo(go.p2tr);function g7(e){let t=p.Buffer.allocUnsafe(0);function r(o){t=p.Buffer.concat([t,p.Buffer.from(o)])}function n(o){let a=t.length,c=l2.encodingLength(o);t=p.Buffer.concat([t,p.Buffer.allocUnsafe(c)]),l2.encode(o,t,a)}function i(o){n(o.length),r(o)}function s(o){n(o.length),o.forEach(i)}return s(e),t}Te.witnessStackToScriptWitness=g7;function h2(e,t){let r=(0,b7.hash160)(e),n=e.slice(1,33),i=wc.decompile(t);if(i===null)throw new Error("Unknown script error");return i.findIndex(s=>typeof s=="number"?!1:s.equals(e)||s.equals(r)||s.equals(n))}Te.pubkeyPositionInScript=h2;function y7(e,t){return h2(e,t)!==-1}Te.pubkeyInScript=y7;function m7(e,t){return _7(e).some(n=>p2(n,wc.signature.decode,t))}Te.checkInputForSig=m7;function p2(e,t,r){let{hashType:n}=t(e),i=[];switch(n&xf.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput"),n&31){case xf.Transaction.SIGHASH_ALL:break;case xf.Transaction.SIGHASH_SINGLE:case xf.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence");break}return i.indexOf(r)===-1}Te.signatureBlocksAction=p2;function _7(e){let t=[];if((e.partialSig||[]).length===0){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=v7(e)}else t=e.partialSig;return t.map(r=>r.signature)}function v7(e){let t=e.finalScriptSig?wc.decompile(e.finalScriptSig)||[]:[],r=e.finalScriptWitness?wc.decompile(e.finalScriptWitness)||[]:[];return t.concat(r).filter(n=>p.Buffer.isBuffer(n)&&wc.isCanonicalScriptSignature(n)).map(n=>({signature:n}))}});var Mh=H(Ze=>{w();S();Object.defineProperty(Ze,"__esModule",{value:!0});Ze.checkTaprootInputForSigs=Ze.tapTreeFromList=Ze.tapTreeToList=Ze.tweakInternalPubKey=Ze.checkTaprootOutputFields=Ze.checkTaprootInputFields=Ze.isTaprootOutput=Ze.isTaprootInput=Ze.serializeTaprootSignature=Ze.tapScriptFinalizer=Ze.toXOnly=void 0;var Bh=Br(),w7=Ls(),Ef=mo(),Fs=nf(),S7=Rs(),x7=mo(),P7=e=>e.length===32?e:e.slice(1,33);Ze.toXOnly=P7;function T7(e,t,r){let n=F7(t,e,r);try{let s=D7(t,n).concat(n.script).concat(n.controlBlock);return{finalScriptWitness:(0,Ef.witnessStackToScriptWitness)(s)}}catch(i){throw new Error(`Can not finalize taproot input #${e}: ${i}`)}}Ze.tapScriptFinalizer=T7;function E7(e,t){let r=t?p.Buffer.from([t]):p.Buffer.from([]);return p.Buffer.concat([e,r])}Ze.serializeTaprootSignature=E7;function Pf(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&(0,Ef.isP2TR)(e.witnessUtxo.script))}Ze.isTaprootInput=Pf;function Tf(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t&&(0,Ef.isP2TR)(t))}Ze.isTaprootOutput=Tf;function A7(e,t,r){q7(e,t,r),K7(e,t,r)}Ze.checkTaprootInputFields=A7;function I7(e,t,r){L7(e,t,r),O7(e,t)}Ze.checkTaprootOutputFields=I7;function O7(e,t){if(!t.tapTree&&!t.tapInternalKey)return;let r=t.tapInternalKey||e.tapInternalKey,n=t.tapTree||e.tapTree;if(r){let{script:i}=e,s=B7(r,n);if(i&&!i.equals(s))throw new Error("Error adding output. Script or address missmatch.")}}function B7(e,t){let r=t&&b2(t.leaves),{output:n}=(0,S7.p2tr)({internalPubkey:e,scriptTree:r});return n}function M7(e,t){let r=t.tapInternalKey,n=r&&(0,Fs.tweakKey)(r,t.tapMerkleRoot);if(!n)throw new Error(`Cannot tweak tap internal key for input #${e}. Public key: ${r&&r.toString("hex")}`);return n.x}Ze.tweakInternalPubKey=M7;function C7(e){if(!(0,Bh.isTaptree)(e))throw new Error("Cannot convert taptree to tapleaf list. Expecting a tapree structure.");return Ih(e)}Ze.tapTreeToList=C7;function b2(e=[]){return e.length===1&&e[0].depth===0?{output:e[0].script,version:e[0].leafVersion}:U7(e)}Ze.tapTreeFromList=b2;function k7(e,t){return N7(e).some(n=>(0,x7.signatureBlocksAction)(n,H7,t))}Ze.checkTaprootInputForSigs=k7;function H7(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||w7.Transaction.SIGHASH_DEFAULT}}function N7(e){let t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(r=>r.signature)),!t.length){let r=R7(e.finalScriptWitness);r&&t.push(r)}return t}function R7(e){if(!e)return;let t=e.slice(2);if(t.length===64||t.length===65)return t}function Ih(e,t=[],r=0){if(r>Fs.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");return e?(0,Bh.isTapleaf)(e)?(t.push({depth:r,leafVersion:e.version||Fs.LEAF_VERSION_TAPSCRIPT,script:e.output}),t):(e[0]&&Ih(e[0],t,r+1),e[1]&&Ih(e[1],t,r+1),t):[]}function U7(e){let t;for(let r of e)if(t=Oh(r,t),!t)throw new Error("No room left to insert tapleaf in tree");return t}function Oh(e,t,r=0){if(r>Fs.MAX_TAPTREE_DEPTH)throw new Error("Max taptree depth exceeded.");if(e.depth===r)return t?void 0:{output:e.script,version:e.leafVersion};if((0,Bh.isTapleaf)(t))return;let n=Oh(e,t&&t[0],r+1);if(n)return[n,t&&t[1]];let i=Oh(e,t&&t[1],r+1);if(i)return[t&&t[0],i]}function q7(e,t,r){let n=Pf(e)&&_a(t),i=_a(e)&&Pf(t),s=e===t&&Pf(t)&&_a(t);if(n||i||s)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function L7(e,t,r){let n=Tf(e)&&_a(t),i=_a(e)&&Tf(t),s=e===t&&Tf(t)&&_a(t);if(n||i||s)throw new Error(`Invalid arguments for Psbt.${r}. Cannot use both taproot and non-taproot fields.`)}function K7(e,t,r){if(t.tapMerkleRoot){let n=(t.tapLeafScript||[]).every(s=>Ah(s,t.tapMerkleRoot)),i=(e.tapLeafScript||[]).every(s=>Ah(s,t.tapMerkleRoot));if(!n||!i)throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(i=>Ah(i,e.tapMerkleRoot)))throw new Error(`Invalid arguments for Psbt.${r}. Tapleaf not part of taptree.`)}function Ah(e,t){if(!t)return!0;let r=(0,Fs.tapleafHash)({output:e.script,version:e.leafVersion});return(0,Fs.rootHashFromPath)(e.controlBlock,r).equals(t)}function D7(e,t){let r=(0,Fs.tapleafHash)({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(n=>n.leafHash.equals(r)).map(n=>j7(t.script,n)).sort((n,i)=>i.positionInScript-n.positionInScript).map(n=>n.signature)}function j7(e,t){return Object.assign({positionInScript:(0,Ef.pubkeyPositionInScript)(t.pubkey,e)},t)}function F7(e,t,r){if(!e.tapScriptSig||!e.tapScriptSig.length)throw new Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);let n=(e.tapLeafScript||[]).sort((i,s)=>i.controlBlock.length-s.controlBlock.length).find(i=>G7(i,e.tapScriptSig,r));if(!n)throw new Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return n}function G7(e,t,r){let n=(0,Fs.tapleafHash)({output:e.script,version:e.leafVersion});return(!r||r.equals(n))&&t.find(s=>s.leafHash.equals(n))!==void 0}function _a(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}});var Cf=H(Dn=>{w();S();var V7=Dn&&Dn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),W7=Dn&&Dn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Rh=Dn&&Dn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&V7(t,e,r);return W7(t,e),t};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.getHashAndSighashType=Dn.Psbt=void 0;var g2=d2(),y2=Rh(Ds()),Vr=xh(),m2=ga(),va=hs(),z7=bn(),Kn=Rh(Rs()),X7=nf(),es=Rh(Gt()),ft=Ls(),Re=Mh(),yr=mo(),T2=ri(),Ch=he(),Y7=Gt(),$7=xi(),Z7=T2.signUtil.schnorr.secp256k1.schnorr,J7={network:z7.bitcoin,maximumFeeRate:5e3},wa=class{static fromBase64(t,r={}){let n=p.Buffer.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r={}){let n=p.Buffer.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(t,r={}){let n=g2.Psbt.fromBuffer(t,Q7),i=new wa(r,n);return i9(i.__CACHE.__TX,i.__CACHE),i}constructor(t={},r=new g2.Psbt(new If)){this.data=r,this.opts=Object.assign({},J7,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},this.data.inputs.length===0&&this.setVersion(2);let n=(i,s,o,a)=>Object.defineProperty(i,s,{enumerable:o,writable:a});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:(0,va.cloneBuffer)(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let r;try{r=(0,m2.fromOutputScript)(t.script,this.opts.network)}catch{}return{script:(0,va.cloneBuffer)(t.script),value:t.value,address:r}})}combine(...t){return this.data.combine(...t.map(r=>r.data)),this}clone(){let t=wa.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){Af(t),this.opts.maximumFeeRate=t}setVersion(t){Af(t),Sc(this.data.inputs,"setVersion");let r=this.__CACHE;return r.__TX.version=t,r.__EXTRACTED_TX=void 0,this}setLocktime(t){Af(t),Sc(this.data.inputs,"setLocktime");let r=this.__CACHE;return r.__TX.locktime=t,r.__EXTRACTED_TX=void 0,this}setInputSequence(t,r){Af(r),Sc(this.data.inputs,"setInputSequence");let n=this.__CACHE;if(n.__TX.ins.length<=t)throw new Error("Input index too high");return n.__TX.ins[t].sequence=r,n.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(r=>this.addInput(r)),this}addInput(t){if(arguments.length>1||!t||t.hash===void 0||t.index===void 0)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");(0,Re.checkTaprootInputFields)(t,t,"addInput"),Sc(this.data.inputs,"addInput"),t.witnessScript&&Of(t.witnessScript);let r=this.__CACHE;this.data.addInput(t);let n=r.__TX.ins[r.__TX.ins.length-1];I2(r,n);let i=this.data.inputs.length-1,s=this.data.inputs[i];return s.nonWitnessUtxo&&Nh(this.__CACHE,s,i),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(r=>this.addOutput(r)),this}addOutput(t){if(arguments.length>1||!t||t.value===void 0||t.address===void 0&&t.script===void 0)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");Sc(this.data.inputs,"addOutput");let{address:r}=t;if(typeof r=="string"){let{network:i}=this.opts,s=(0,m2.toOutputScript)(r,i);t=Object.assign(t,{script:s})}(0,Re.checkTaprootOutputFields)(t,t,"addOutput");let n=this.__CACHE;return this.data.addOutput(t),n.__FEE=void 0,n.__FEE_RATE=void 0,n.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(E2))throw new Error("Not finalized");let r=this.__CACHE;if(t||t9(this,r,this.opts),r.__EXTRACTED_TX)return r.__EXTRACTED_TX;let n=r.__TX.clone();return k2(this.data.inputs,n,r,!0),n}getFeeRate(){return x2("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return x2("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return(0,Vr.checkForInput)(this.data.inputs,0),xc(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,r){let n=(0,Vr.checkForInput)(this.data.inputs,t);return(0,Re.isTaprootInput)(n)?this._finalizeTaprootInput(t,n,void 0,r):this._finalizeInput(t,n,r)}finalizeTaprootInput(t,r,n=Re.tapScriptFinalizer){let i=(0,Vr.checkForInput)(this.data.inputs,t);if((0,Re.isTaprootInput)(i))return this._finalizeTaprootInput(t,i,r,n);throw new Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,r,n=s9){let{script:i,isP2SH:s,isP2WSH:o,isSegwit:a}=u9(t,r,this.__CACHE);if(!i)throw new Error(`No script found for input #${t}`);r9(r);let{finalScriptSig:c,finalScriptWitness:u}=n(t,r,i,a,s,o);if(c&&this.data.updateInput(t,{finalScriptSig:c}),u&&this.data.updateInput(t,{finalScriptWitness:u}),!c&&!u)throw new Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,r,n,i=Re.tapScriptFinalizer){if(!r.witnessUtxo)throw new Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(r.tapKeySig){let s=Kn.p2tr({output:r.witnessUtxo.script,signature:r.tapKeySig}),o=(0,yr.witnessStackToScriptWitness)(s.witness);this.data.updateInput(t,{finalScriptWitness:o})}else{let{finalScriptWitness:s}=i(t,r,n);this.data.updateInput(t,{finalScriptWitness:s})}return this.data.clearFinalizedInput(t),this}getInputType(t){let r=(0,Vr.checkForInput)(this.data.inputs,t),n=H2(t,r,this.__CACHE),i=Mf(n,t,"input",r.redeemScript||p9(r.finalScriptSig),r.witnessScript||b9(r.finalScriptWitness)),s=i.type==="raw"?"":i.type+"-",o=U2(i.meaningfulScript);return s+o}inputHasPubkey(t,r){let n=(0,Vr.checkForInput)(this.data.inputs,t);return l9(r,n,t,this.__CACHE)}inputHasHDKey(t,r){let n=(0,Vr.checkForInput)(this.data.inputs,t),i=v2(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}outputHasPubkey(t,r){let n=(0,Vr.checkForOutput)(this.data.outputs,t);return h9(r,n,t,this.__CACHE)}outputHasHDKey(t,r){let n=(0,Vr.checkForOutput)(this.data.outputs,t),i=v2(r);return!!n.bip32Derivation&&n.bip32Derivation.some(i)}validateSignaturesOfAllInputs(t){return(0,Vr.checkForInput)(this.data.inputs,0),xc(this.data.inputs.length).map(n=>this.validateSignaturesOfInput(n,t)).reduce((n,i)=>i===!0&&n,!0)}validateSignaturesOfInput(t,r,n){let i=this.data.inputs[t];return(0,Re.isTaprootInput)(i)?this.validateSignaturesOfTaprootInput(t,r,n):this._validateSignaturesOfInput(t,r,n)}_validateSignaturesOfInput(t,r,n){let i=this.data.inputs[t],s=(i||{}).partialSig;if(!i||!s||s.length<1)throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");let o=n?s.filter(f=>f.pubkey.equals(n)):s;if(o.length<1)throw new Error("No signatures for this pubkey");let a=[],c,u,d;for(let f of o){let b=es.signature.decode(f.signature),{hash:m,script:y}=d!==b.hashType?B2(t,Object.assign({},i,{sighashType:b.hashType}),this.__CACHE,!0):{hash:c,script:u};d=b.hashType,c=m,u=y,A2(f.pubkey,y,"verify"),a.push(r(f.pubkey,m,b.signature))}return a.every(f=>f===!0)}validateSignaturesOfTaprootInput(t,r,n){let i=this.data.inputs[t],s=(i||{}).tapKeySig,o=(i||{}).tapScriptSig;if(!i&&!s&&!(o&&!o.length))throw new Error("No signatures to validate");if(typeof r!="function")throw new Error("Need validator function to validate signatures");n=n&&(0,Re.toXOnly)(n);let a=n?Hh(t,i,this.data.inputs,n,this.__CACHE):a9(t,i,this.data.inputs,this.__CACHE);if(!a.length)throw new Error("No signatures for this pubkey");let c=a.find(u=>!!u.leafHash);if(s&&c&&!r(c.pubkey,c.hash,s))return!1;if(o)for(let u of o){let d=a.find(f=>u.pubkey.equals(f.pubkey));if(d&&!r(u.pubkey,d.hash,u.signature))return!1}return!0}signAllInputsHD(t,r=[ft.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");let n=[];for(let i of xc(this.data.inputs.length))try{this.signInputHD(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(t,r=[ft.Transaction.SIGHASH_ALL]){return new Promise((n,i)=>{if(!t||!t.publicKey||!t.fingerprint)return i(new Error("Need HDSigner to sign input"));let s=[],o=[];for(let a of xc(this.data.inputs.length))o.push(this.signInputHDAsync(a,t,r).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(a=>a===!1))return i(new Error("No inputs were signed"));n()})})}signInputHD(t,r,n=[ft.Transaction.SIGHASH_ALL]){if(!r||!r.publicKey||!r.fingerprint)throw new Error("Need HDSigner to sign input");return P2(t,this.data.inputs,r).forEach(s=>this.signInput(t,s,n)),this}signInputHDAsync(t,r,n=[ft.Transaction.SIGHASH_ALL]){return new Promise((i,s)=>{if(!r||!r.publicKey||!r.fingerprint)return s(new Error("Need HDSigner to sign input"));let a=P2(t,this.data.inputs,r).map(c=>this.signInputAsync(t,c,n));return Promise.all(a).then(()=>{i()}).catch(s)})}signAllInputs(t,r){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");let n=[];for(let i of xc(this.data.inputs.length))try{this.signInput(i,t,r),n.push(!0)}catch{n.push(!1)}if(n.every(i=>i===!1))throw new Error("No inputs were signed");return this}signAllInputsAsync(t,r){return new Promise((n,i)=>{if(!t||!t.publicKey)return i(new Error("Need Signer to sign input"));let s=[],o=[];for(let[a]of this.data.inputs.entries())o.push(this.signInputAsync(a,t,r).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(a=>a===!1))return i(new Error("No inputs were signed"));n()})})}signInput(t,r,n,i){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Vr.checkForInput)(this.data.inputs,t);return(0,Re.isTaprootInput)(s)?this._signTaprootInput(t,s,r,i,n):this._signInput(t,r,n)}signTaprootInput(t,r,n,i){if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Vr.checkForInput)(this.data.inputs,t);if((0,Re.isTaprootInput)(s))return this._signTaprootInput(t,s,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)}getHashAndSighashType(t,r,n=[ft.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=Pc(this.data.inputs,t,r,this.__CACHE,n);return{hash:i,sighashType:s}}_signInput(t,r,n=[ft.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=Pc(this.data.inputs,t,r.publicKey,this.__CACHE,n),o=[{pubkey:r.publicKey,signature:es.signature.encode(r.sign(i),s)}];return this.data.updateInput(t,{partialSig:o}),this}_signTaprootInput(t,r,n,i,s=[ft.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,r,n,i,s),a=o.filter(u=>!u.leafHash).map(u=>(0,Re.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType))[0],c=o.filter(u=>!!u.leafHash).map(u=>({pubkey:(0,Re.toXOnly)(n.publicKey),signature:(0,Re.serializeTaprootSignature)(n.signSchnorr(u.hash),r.sighashType),leafHash:u.leafHash}));return a&&this.data.updateInput(t,{tapKeySig:a}),c.length&&this.data.updateInput(t,{tapScriptSig:c}),this}signInputAsync(t,r,n){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let i=(0,Vr.checkForInput)(this.data.inputs,t);return(0,Re.isTaprootInput)(i)?this._signTaprootInputAsync(t,i,r,void 0,n):this._signInputAsync(t,r,n)})}signTaprootInputAsync(t,r,n,i){return Promise.resolve().then(()=>{if(!r||!r.publicKey)throw new Error("Need Signer to sign input");let s=(0,Vr.checkForInput)(this.data.inputs,t);if((0,Re.isTaprootInput)(s))return this._signTaprootInputAsync(t,s,r,n,i);throw new Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,r,n=[ft.Transaction.SIGHASH_ALL]){let{hash:i,sighashType:s}=Pc(this.data.inputs,t,r.publicKey,this.__CACHE,n);return Promise.resolve(r.sign(i)).then(o=>{let a=[{pubkey:r.publicKey,signature:es.signature.encode(o,s)}];this.data.updateInput(t,{partialSig:a})})}async _signTaprootInputAsync(t,r,n,i,s=[ft.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,r,n,i,s),a=[],c=o.filter(d=>!d.leafHash)[0];if(c){let d=Promise.resolve(n.signSchnorr(c.hash)).then(f=>({tapKeySig:(0,Re.serializeTaprootSignature)(f,r.sighashType)}));a.push(d)}let u=o.filter(d=>!!d.leafHash);if(u.length){let d=u.map(f=>Promise.resolve(n.signSchnorr(f.hash)).then(b=>({tapScriptSig:[{pubkey:(0,Re.toXOnly)(n.publicKey),signature:(0,Re.serializeTaprootSignature)(b,r.sighashType),leafHash:f.leafHash}]})));a.push(...d)}return Promise.all(a).then(d=>{d.forEach(f=>this.data.updateInput(t,f))})}checkTaprootHashesForSig(t,r,n,i,s){if(typeof n.signSchnorr!="function")throw new Error(`Need Schnorr Signer to sign taproot input #${t}.`);let o=Hh(t,r,this.data.inputs,n.publicKey,this.__CACHE,i,s);if(!o||!o.length)throw new Error(`Can not sign for input #${t} with the key ${n.publicKey.toString("hex")}`);return o}toBuffer(){return kh(this.__CACHE),this.data.toBuffer()}toHex(){return kh(this.__CACHE),this.data.toHex()}toBase64(){return kh(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,r){return r.witnessScript&&Of(r.witnessScript),(0,Re.checkTaprootInputFields)(this.data.inputs[t],r,"updateInput"),this.data.updateInput(t,r),r.nonWitnessUtxo&&Nh(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,r){let n=this.data.outputs[t];return(0,Re.checkTaprootOutputFields)(n,r,"updateOutput"),this.data.updateOutput(t,r),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,r){return this.data.addUnknownKeyValToInput(t,r),this}addUnknownKeyValToOutput(t,r){return this.data.addUnknownKeyValToOutput(t,r),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}verify(t,r){let n=[ft.Transaction.SIGHASH_SINGLE|ft.Transaction.SIGHASH_ANYONECANPAY,ft.Transaction.SIGHASH_ALL,ft.Transaction.SIGHASH_DEFAULT];for(let i=0;i<this.inputCount;i++)if((0,Re.isTaprootInput)(this.data.inputs[i])){let s=p.Buffer.from((0,$7.taprootTweakPubkey)(t.slice(1))[0]),a=new va.BufferReader(r).readVector(),c={publicKey:s,sign(f){return p.Buffer.alloc(64)},signSchnorr(f){return p.Buffer.alloc(64)}},d=this.checkTaprootHashesForSig(i,this.data.inputs[i],c,void 0,n).filter(f=>!f.leafHash)[0].hash;if(!Z7.verify(Ch.base.toHex(a[0]),Ch.base.toHex(d),Ch.base.toHex(s)))return!1}else{let{hash:s}=Pc(this.data.inputs,i,t,this.__CACHE,n),a=new va.BufferReader(r).readVector(),c=Y7.signature.decode(a[0]).signature,u=a[1];if(!t.equals(u))throw Error("pubKey error");if(!T2.signUtil.secp256k1.verifyWithNoRecovery(s,c,t))return!1}return!0}};Dn.Psbt=wa;var Q7=e=>new If(e),If=class{constructor(t=p.Buffer.from([2,0,0,0,0,0,0,0,0,0])){this.tx=ft.Transaction.fromBuffer(t),n9(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(t.hash===void 0||t.index===void 0||!p.Buffer.isBuffer(t.hash)&&typeof t.hash!="string"||typeof t.index!="number")throw new Error("Error adding input.");let r=typeof t.hash=="string"?(0,va.reverseBuffer)(p.Buffer.from(t.hash,"hex")):t.hash;this.tx.addInput(r,t.index,t.sequence)}addOutput(t){if(t.script===void 0||t.value===void 0||!p.Buffer.isBuffer(t.script)||typeof t.value!="number")throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}};function e9(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return _2(1,e.partialSig);case"multisig":let n=Kn.p2ms({output:t});return _2(n.m,e.partialSig,n.pubkeys);default:return!1}}function kh(e){if(e.__UNSAFE_SIGN_NONSEGWIT!==!1)throw new Error("Not BIP174 compliant, can not export")}function _2(e,t,r){if(!t)return!1;let n;if(r?n=r.map(i=>{let s=g9(i);return t.find(o=>o.pubkey.equals(s))}).filter(i=>!!i):n=t,n.length>e)throw new Error("Too many signatures");return n.length===e}function E2(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function v2(e){return t=>!(!t.masterFingerprint.equals(e.fingerprint)||!e.derivePath(t.path).publicKey.equals(t.pubkey))}function Af(e){if(typeof e!="number"||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function t9(e,t,r){let n=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize(),s=n*i;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(s/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}function Sc(e,t){e.forEach(r=>{if((0,Re.isTaprootInput)(r)?(0,Re.checkTaprootInputForSigs)(r,t):(0,yr.checkInputForSig)(r,t))throw new Error("Can not modify transaction, signatures exist.")})}function r9(e){if(!e.sighashType||!e.partialSig)return;let{partialSig:t,sighashType:r}=e;t.forEach(n=>{let{hashType:i}=es.signature.decode(n.signature);if(r!==i)throw new Error("Signature sighash does not match input sighash type")})}function A2(e,t,r){if(!(0,yr.pubkeyInScript)(e,t))throw new Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}function n9(e){if(!e.ins.every(r=>r.script&&r.script.length===0&&r.witness&&r.witness.length===0))throw new Error("Format Error: Transaction ScriptSigs are not empty")}function i9(e,t){e.ins.forEach(r=>{I2(t,r)})}function I2(e,t){let r=(0,va.reverseBuffer)(p.Buffer.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[r])throw new Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function O2(e,t){return(r,n,i,s)=>{let o=e({redeem:{output:i}}).output;if(!n.equals(o))throw new Error(`${t} for ${s} #${r} doesn't match the scriptPubKey in the prevout`)}}var w2=O2(Kn.p2sh,"Redeem script"),S2=O2(Kn.p2wsh,"Witness script");function x2(e,t,r,n){if(!r.every(E2))throw new Error(`PSBT must be finalized to calculate ${t}`);if(e==="__FEE_RATE"&&n.__FEE_RATE)return n.__FEE_RATE;if(e==="__FEE"&&n.__FEE)return n.__FEE;let i,s=!0;if(n.__EXTRACTED_TX?(i=n.__EXTRACTED_TX,s=!1):i=n.__TX.clone(),k2(r,i,n,s),e==="__FEE_RATE")return n.__FEE_RATE;if(e==="__FEE")return n.__FEE}function s9(e,t,r,n,i,s){let o=U2(r);if(!e9(t,r,o))throw new Error(`Can not finalize input #${e}`);return o9(r,o,t.partialSig,n,i,s)}function o9(e,t,r,n,i,s){let o,a,c=c9(e,t,r),u=s?Kn.p2wsh({redeem:c}):null,d=i?Kn.p2sh({redeem:u||c}):null;return n?(u?a=(0,yr.witnessStackToScriptWitness)(u.witness):a=(0,yr.witnessStackToScriptWitness)(c.witness),d&&(o=d.input)):d?o=d.input:o=c.input,{finalScriptSig:o,finalScriptWitness:a}}function Pc(e,t,r,n,i){let s=(0,Vr.checkForInput)(e,t),{hash:o,sighashType:a,script:c}=B2(t,s,n,!1,i);return A2(r,c,"sign"),{hash:o,sighashType:a}}Dn.getHashAndSighashType=Pc;function B2(e,t,r,n,i){let s=r.__TX,o=t.sighashType||ft.Transaction.SIGHASH_ALL;M2(o,i);let a,c;if(t.nonWitnessUtxo){let f=Bf(r,t,e),b=s.ins[e].hash,m=f.getHash();if(!b.equals(m))throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);let y=s.ins[e].index;c=f.outs[y]}else if(t.witnessUtxo)c=t.witnessUtxo;else throw new Error("Need a Utxo input item for signing");let{meaningfulScript:u,type:d}=Mf(c.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(d)>=0)a=s.hashForWitnessV0(e,u,c.value,o);else if((0,yr.isP2WPKH)(u)){let f=Kn.p2pkh({hash:u.slice(2)}).output;a=s.hashForWitnessV0(e,f,c.value,o)}else{if(t.nonWitnessUtxo===void 0&&r.__UNSAFE_SIGN_NONSEGWIT===!1)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: ${u.toString("hex")}`);!n&&r.__UNSAFE_SIGN_NONSEGWIT!==!1&&console.warn(`Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecesor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.
*********************
PROCEED WITH CAUTION!
*********************`),a=s.hashForSignature(e,u,o)}return{script:u,sighashType:o,hash:a}}function a9(e,t,r,n){let i=[];if(t.tapInternalKey){let o=(0,Re.tweakInternalPubKey)(e,t);i.push(o)}if(t.tapScriptSig){let o=t.tapScriptSig.map(a=>a.pubkey);i.push(...o)}return i.map(o=>Hh(e,t,r,o,n)).flat()}function Hh(e,t,r,n,i,s,o){let a=i.__TX,c=t.sighashType||ft.Transaction.SIGHASH_DEFAULT;M2(c,o);let u=r.map((y,_)=>N2(_,y,i)),d=u.map(y=>y.script),f=u.map(y=>y.value),b=[];if(t.tapInternalKey&&!s){let y=(0,Re.tweakInternalPubKey)(e,t);if((0,Re.toXOnly)(n).equals(y)){let _=a.hashForWitnessV1(e,d,f,c);b.push({pubkey:n,hash:_})}}let m=(t.tapLeafScript||[]).map(y=>{let _=(0,X7.tapleafHash)({output:y.script,version:y.leafVersion});return Object.assign({hash:_},y)}).filter(y=>!s||s.equals(y.hash)).map(y=>{let _=a.hashForWitnessV1(e,d,f,ft.Transaction.SIGHASH_DEFAULT,y.hash);return{pubkey:n,hash:_,leafHash:y.hash}});return b.concat(m)}function M2(e,t){if(t&&t.indexOf(e)<0){let r=d9(e);throw new Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${r}`)}}function c9(e,t,r){let n;switch(t){case"multisig":let i=f9(e,r);n=Kn.p2ms({output:e,signatures:i});break;case"pubkey":n=Kn.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=Kn.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=Kn.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break}return n}function u9(e,t,r){let n=r.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){let s=Bf(r,t,e),o=n.ins[e].index;i.script=s.outs[o].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);return(t.witnessScript||(0,yr.isP2WPKH)(i.script))&&(i.isSegwit=!0),i}function P2(e,t,r){let n=(0,Vr.checkForInput)(t,e);if(!n.bip32Derivation||n.bip32Derivation.length===0)throw new Error("Need bip32Derivation to sign with HD");let i=n.bip32Derivation.map(o=>{if(o.masterFingerprint.equals(r.fingerprint))return o}).filter(o=>!!o);if(i.length===0)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(o=>{let a=r.derivePath(o.path);if(!o.pubkey.equals(a.publicKey))throw new Error("pubkey did not match bip32Derivation");return a})}function f9(e,t){return Kn.p2ms({output:e}).pubkeys.map(n=>(t.filter(i=>i.pubkey.equals(n))[0]||{}).signature).filter(n=>!!n)}function C2(e){let t=0;function r(o){return t+=o,e.slice(t-o,t)}function n(){let o=y2.decode(e,t);return t+=y2.decode.bytes,o}function i(){return r(n())}function s(){let o=n(),a=[];for(let c=0;c<o;c++)a.push(i());return a}return s()}function d9(e){let t=e&ft.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(e&31){case ft.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case ft.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case ft.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE";break}return t}function Nh(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;let n=ft.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;let i=e,s=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){let o=i.__NON_WITNESS_UTXO_BUF_CACHE[s],a=i.__NON_WITNESS_UTXO_TX_CACHE[s];if(o!==void 0)return o;{let c=a.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[s]=c,c}},set(o){i.__NON_WITNESS_UTXO_BUF_CACHE[s]=o}})}function k2(e,t,r,n){let i=0;e.forEach((c,u)=>{if(n&&c.finalScriptSig&&(t.ins[u].script=c.finalScriptSig),n&&c.finalScriptWitness&&(t.ins[u].witness=C2(c.finalScriptWitness)),c.witnessUtxo)i+=c.witnessUtxo.value;else if(c.nonWitnessUtxo){let d=Bf(r,c,u),f=t.ins[u].index,b=d.outs[f];i+=b.value}});let s=t.outs.reduce((c,u)=>c+u.value,0),o=i-s;if(o<0)throw new Error("Outputs are spending more than Inputs");let a=t.virtualSize();r.__FEE=o,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(o/a)}function Bf(e,t,r){let n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||Nh(e,t,r),n[r]}function H2(e,t,r){let{script:n}=N2(e,t,r);return n}function N2(e,t,r){if(t.witnessUtxo!==void 0)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(t.nonWitnessUtxo!==void 0){let i=Bf(r,t,e).outs[r.__TX.ins[e].index];return{script:i.script,value:i.value}}else throw new Error("Can't find pubkey in input without Utxo data")}function l9(e,t,r,n){let i=H2(r,t,n),{meaningfulScript:s}=Mf(i,r,"input",t.redeemScript,t.witnessScript);return(0,yr.pubkeyInScript)(e,s)}function h9(e,t,r,n){let i=n.__TX.outs[r].script,{meaningfulScript:s}=Mf(i,r,"output",t.redeemScript,t.witnessScript);return(0,yr.pubkeyInScript)(e,s)}function p9(e){if(!e)return;let t=es.decompile(e);if(!t)return;let r=t[t.length-1];if(!(!p.Buffer.isBuffer(r)||R2(r)||y9(r)||!es.decompile(r)))return r}function b9(e){if(!e)return;let t=C2(e),r=t[t.length-1];if(!(R2(r)||!es.decompile(r)))return r}function g9(e){if(e.length===65){let t=e[64]&1,r=e.slice(0,33);return r[0]=2|t,r}return e.slice()}function R2(e){return e.length===33&&es.isCanonicalPubKey(e)}function y9(e){return es.isCanonicalScriptSignature(e)}function Mf(e,t,r,n,i){let s=(0,yr.isP2SHScript)(e),o=s&&n&&(0,yr.isP2WSHScript)(n),a=(0,yr.isP2WSHScript)(e);if(s&&n===void 0)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((a||o)&&i===void 0)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let c;return o?(c=i,w2(t,e,n,r),S2(t,n,i,r),Of(c)):a?(c=i,S2(t,e,i,r),Of(c)):s?(c=n,w2(t,e,n,r)):c=e,{meaningfulScript:c,type:o?"p2sh-p2wsh":s?"p2sh":a?"p2wsh":"raw"}}function Of(e){if((0,yr.isP2WPKH)(e)||(0,yr.isP2SHScript)(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function U2(e){return(0,yr.isP2WPKH)(e)?"witnesspubkeyhash":(0,yr.isP2PKH)(e)?"pubkeyhash":(0,yr.isP2MS)(e)?"multisig":(0,yr.isP2PK)(e)?"pubkey":"nonstandard"}function xc(e){return[...Array(e).keys()]}});var jh=H(ee=>{w();S();var m9=ee&&ee.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),_9=ee&&ee.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),K2=ee&&ee.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&m9(t,e,r);return _9(t,e),t};Object.defineProperty(ee,"__esModule",{value:!0});ee.generateMPCSignedPSBT=ee.generateMPCUnsignedPSBT=ee.generateMPCSignedBuyingTx=ee.generateMPCUnsignedBuyingPSBT=ee.generateMPCSignedListingPSBT=ee.generateMPCUnsignedListingPSBT=ee.generateSignedBuyingTx=ee.mergeSignedBuyingPsbt=ee.generateUnsignedBuyingPsbt=ee.generateSignedListingPsbt=ee.generateUnsignedListingPsbt=ee.extractPsbtTransaction=ee.psbtSignImpl=ee.signPsbtWithKeyPathAndScriptPathImpl=ee.signPsbtWithKeyPathAndScriptPath=ee.signPsbtWithKeyPathAndScriptPathBatch=ee.psbtDecode=ee.psbtSign=ee.classicToPsbt=ee.buildPsbt=void 0;var fn=Cf(),v9=ri(),ie=he(),ht=rn(),oe=nn(),Gs=K2(xi()),ii=Mh(),w9=ga(),S9=hs(),q2=mo(),Uh=K2(Gt()),x9=wr(),P9=z0(),Tc=v9.signUtil.schnorr.secp256k1.schnorr,Ec=5e3;function qh(e,t,r){return D2(e,t,r).toHex()}ee.buildPsbt=qh;function D2(e,t,r){let n=new fn.Psbt({network:t,maximumFeeRate:r||Ec});return e.inputs.forEach(i=>{let s=(0,w9.toOutputScript)(i.address,t),o={hash:i.txId,index:i.vOut,witnessUtxo:{script:s,value:i.amount}},a=(0,ht.getAddressType)(i.address,t||oe.networks.bitcoin);i.bip32Derivation&&(a==="segwit_taproot"?o.tapBip32Derivation=i.bip32Derivation.map(c=>{let u=ie.base.fromHex(c.pubkey);return u.length!=32&&(u=u.slice(1)),{masterFingerprint:ie.base.fromHex(c.masterFingerprint),pubkey:u,path:c.path,leafHashes:c.leafHashes.map(d=>p.Buffer.from(d,"hex"))}}):o.bip32Derivation=i.bip32Derivation.map(c=>({masterFingerprint:ie.base.fromHex(c.masterFingerprint),pubkey:ie.base.fromHex(c.pubkey),path:c.path}))),a==="legacy"?o.nonWitnessUtxo=ie.base.fromHex(i.nonWitnessUtxo):a==="segwit_taproot"?i.publicKey&&(o.tapInternalKey=(0,ii.toXOnly)(ie.base.fromHex(i.publicKey))):a==="segwit_nested"&&(o.redeemScript=oe.payments.p2wpkh({pubkey:p.Buffer.from(i.publicKey,"hex"),network:t}).output),i.sighashType&&(o.sighashType=i.sighashType),n.addInput(o)}),e.outputs.forEach(i=>{if(i.omniScript)n.addOutput({script:ie.base.fromHex(i.omniScript),value:0});else{let s={address:i.address,value:i.amount};i.bip32Derivation&&(s.bip32Derivation=i.bip32Derivation.map(o=>({masterFingerprint:ie.base.fromHex(o.masterFingerprint),pubkey:ie.base.fromHex(o.pubkey),path:o.path}))),n.addOutput(s)}}),n}ee.classicToPsbt=D2;function Lh(e,t,r,n){let i=fn.Psbt.fromBase64(e,{network:r,maximumFeeRate:n||Ec});return G2(i,t,r),i.toBase64()}ee.psbtSign=Lh;function T9(e,t,r){try{let n=fn.Psbt.fromHex(e,{network:t,maximumFeeRate:r||Ec});return n.txInputs?n.txInputs.filter(i=>!i.hash.equals(p.Buffer.alloc(32))).map(i=>({txId:ie.base.toHex(ie.base.reverseBuffer(i.hash)),vOut:i.index})):[]}catch{let i=fn.Psbt.fromBase64(e,{network:t,maximumFeeRate:r||Ec});return i.txInputs?i.txInputs.filter(s=>!s.hash.equals(p.Buffer.alloc(32))).map(s=>({txId:ie.base.toHex(ie.base.reverseBuffer(s.hash)),vOut:s.index})):[]}}ee.psbtDecode=T9;function E9(e,t,r,n){if(e==null||e.length==0)return[];let i=[],s=n==null?0:n.length,o=0;for(o=0;o<e.length;o++){let a={};o<s&&n&&(a=n[o]);let c=j2(e[o],t,r,{autoFinalized:a.autoFinalized,toSignInputs:a.toSignInputs});i.push(c)}return i}ee.signPsbtWithKeyPathAndScriptPathBatch=E9;function j2(e,t,r,n={}){let i=Dh(e,r);return F2(i,t,r,n.autoFinalized,n.toSignInputs),i.toHex()}ee.signPsbtWithKeyPathAndScriptPath=j2;function F2(e,t,r,n,i){r=r||oe.networks.bitcoin;let s=(0,ht.privateKeyFromWIF)(t,r),o=new Map;i?.forEach(f=>{o.set(f.index,f)});let a={psbtIndex:0,needTweak:!0,tweakHash:p.Buffer.alloc(0),toSignInputsMap:o,publicKey:p.Buffer.alloc(0),sign(f){return(0,ht.sign)(f,s)},signSchnorr(f){let b=Gs.taprootTweakPrivKey(ie.base.fromHex(s));return this.toSignInputsMap?.has(this.psbtIndex)&&this.toSignInputsMap.get(this.psbtIndex)?.disableTweakSigner?p.Buffer.from(Tc.sign(f,s,ie.base.randomBytes(32))):this.needTweak?(this.needTweak&&this.tweakHash.length>0&&(b=Gs.taprootTweakPrivKey(ie.base.fromHex(s),this.tweakHash)),p.Buffer.from(Tc.sign(f,b,ie.base.randomBytes(32)))):p.Buffer.from(Tc.sign(f,s,ie.base.randomBytes(32)))}},c=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT],u=()=>({psbtIndex:0,needTweak:!0,tweakHash:p.Buffer.alloc(0),toSignInputsMap:o,publicKey:p.Buffer.alloc(0),getPrivateKey(){let f=ie.base.fromHex(s);return this.needTweak&&(f=p.Buffer.from(Gs.taprootTweakPrivKey(f,this.tweakHash))),f},sign(f){return(0,ht.sign)(f,this.getPrivateKey().toString("hex"))},signSchnorr(f){return p.Buffer.from(Tc.sign(f,this.getPrivateKey(),ie.base.randomBytes(32)))}}),d=()=>[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT];for(let f=0;f<e.inputCount;f++)if(!(o?.size>0&&!o?.has(f)))if(o?.get(f)?.useTweakSigner!==void 0){let b=e.data.inputs[f],m,y=u(),_=d();y.psbtIndex=f,y.publicKey=(0,ht.wif2Public)(t,r);let E=o.get(f);E.sighashTypes!==void 0&&(_=E.sighashTypes),y.needTweak=E.useTweakSigner,y.needTweak&&(y.publicKey=p.Buffer.from(Gs.taprootTweakPubkey((0,ii.toXOnly)((0,ht.wif2Public)(t,r)),y.tweakHash)[0])),(0,ii.isTaprootInput)(b)&&(!b.tapInternalKey&&!b.tapLeafScript&&(b.tapInternalKey=(0,ii.toXOnly)((0,ht.wif2Public)(t,r))),E.tapLeafHashToSign!==void 0&&(m=p.Buffer.from(E.tapLeafHashToSign,"hex")));try{if(e.signInput(f,y,_,m),n!=null&&!n)continue;e.finalizeInput(f)}catch(I){throw I}}else{a.psbtIndex=f;let b=e.data.inputs[f];(0,ii.isTaprootInput)(b)?(b.tapInternalKey||(b.tapInternalKey=(0,ii.toXOnly)((0,ht.wif2Public)(t,r))),a.needTweak=!0,a.publicKey=p.Buffer.from(Gs.taprootTweakPubkey((0,ii.toXOnly)((0,ht.wif2Public)(t,r)))[0]),o?.has(f)&&o?.get(f)?.disableTweakSigner&&(a.publicKey=(0,ht.wif2Public)(t,r),a.needTweak=!1),b.tapLeafScript&&b.tapLeafScript?.length>0&&!b.tapMerkleRoot?b.tapLeafScript.forEach(m=>{m.controlBlock&&m.script&&(a.publicKey=(0,ht.wif2Public)(t,r),a.needTweak=!1)}):b.tapMerkleRoot&&(a.needTweak=!0,a.tweakHash=b.tapMerkleRoot,a.publicKey=p.Buffer.from(Gs.taprootTweakPubkey((0,ii.toXOnly)((0,ht.wif2Public)(t,r)),b.tapMerkleRoot)[0]))):(a.needTweak=!1,a.tweakHash=p.Buffer.alloc(0),a.publicKey=(0,ht.wif2Public)(t,r));try{if(o?.has(f)){let m=o?.get(f)?.sighashTypes;m!=null&&(c=m)}if(e.signInput(f,a,c),n!=null&&!n)continue;e.finalizeInput(f)}catch(m){if(o?.size>0&&o?.has(f))throw m}}}ee.signPsbtWithKeyPathAndScriptPathImpl=F2;function G2(e,t,r){r=r||oe.networks.bitcoin;let n=(0,ht.privateKeyFromWIF)(t,r),i={publicKey:p.Buffer.alloc(0),sign(o){return(0,ht.sign)(o,n)},signSchnorr(o){let a=Gs.taprootTweakPrivKey(ie.base.fromHex(n));return p.Buffer.from(Tc.sign(o,a,ie.base.randomBytes(32)))}},s=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT];for(let o=0;o<e.inputCount;o++){if((0,ii.isTaprootInput)(e.data.inputs[o])){let a=e.data.inputs[o];a.tapInternalKey||(a.tapInternalKey=(0,ii.toXOnly)((0,ht.wif2Public)(t,r))),i.publicKey=p.Buffer.from(Gs.taprootTweakPubkey((0,ii.toXOnly)((0,ht.wif2Public)(t,r)))[0])}else i.publicKey=(0,ht.wif2Public)(t,r);try{e.signInput(o,i,s)}catch{}}}ee.psbtSignImpl=G2;function Kh(e,t,r){let n=fn.Psbt.fromHex(e,{network:t,maximumFeeRate:r||Ec}),i;try{i=n.finalizeAllInputs().extractTransaction()}catch(s){i=n.extractTransaction(),console.log(s)}return i.toHex()}ee.extractPsbtTransaction=Kh;function V2(e,t,r){let n=oe.address.toOutputScript(e.nftAddress,t);if(((0,q2.isP2SHScript)(n)||(0,q2.isP2TR)(n))&&!r)throw new Error("Missing publicKey");let i={inputs:[],outputs:[]},s="bc1pcyj5mt2q4t4py8jnur8vpxvxxchke4pzy7tdr9yvj3u3kdfgrj6sw3rzmr";t===oe.networks.testnet&&(s="tb1pcyj5mt2q4t4py8jnur8vpxvxxchke4pzy7tdr9yvj3u3kdfgrj6see4dpv"),i.inputs.push({txId:"0".repeat(64),vOut:0,amount:0,address:s},{txId:"0".repeat(64),vOut:1,amount:0,address:s}),i.outputs.push({address:s,amount:0},{address:s,amount:0}),i.inputs.push({txId:e.nftUtxo.txHash,vOut:e.nftUtxo.vout,address:e.nftAddress,amount:e.nftUtxo.coinAmount,publicKey:r,nonWitnessUtxo:e.nftUtxo.rawTransation,sighashType:oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY}),i.outputs.push({address:e.receiveBtcAddress,amount:e.price});let o=qh(i,t);return ie.base.toBase64(ie.base.fromHex(o))}ee.generateUnsignedListingPsbt=V2;function A9(e,t,r){let n=ie.base.toHex((0,ht.wif2Public)(t,r));return Lh(V2(e,r,n),t,r)}ee.generateSignedListingPsbt=A9;var Vs=2,I9=600,O9=546;function W2(e,t,r){let n={inputs:[],outputs:[],address:e.paymentAndChangeAddress,feePerB:e.feeRate};e.dummyUtxos.forEach(o=>{n.inputs.push({txId:o.txHash,vOut:o.vout,address:e.paymentAndChangeAddress,amount:o.coinAmount,publicKey:r,nonWitnessUtxo:o.rawTransation})}),n.outputs.push({address:e.paymentAndChangeAddress,amount:e.dummyUtxos.reduce((o,a)=>o+a.coinAmount,0)});let i=[];e.sellerPsbts.forEach(o=>{let a=fn.Psbt.fromBase64(o,{network:t}),c=a.data.globalMap.unsignedTx.tx.ins[Vs];i.push(a.data.globalMap.unsignedTx.tx.outs[Vs]);let u=a.data.inputs[Vs].witnessUtxo;u||(u=oe.Transaction.fromBuffer(a.data.inputs[Vs].nonWitnessUtxo).outs[c.index]),n.inputs.push({txId:ie.base.toHex((0,S9.reverseBuffer)(c.hash)),vOut:c.index,address:oe.address.fromOutputScript(u.script,t),amount:u.value,sighashType:oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY}),n.outputs.push({address:e.receiveNftAddress,amount:u.value})}),i.forEach(o=>{n.outputs.push({address:oe.address.fromOutputScript(o.script,t),amount:o.value})}),e.paymentUtxos.forEach(o=>{n.inputs.push({txId:o.txHash,vOut:o.vout,address:e.paymentAndChangeAddress,amount:o.coinAmount,publicKey:r,nonWitnessUtxo:o.rawTransation})}),e.dummyUtxos.forEach(()=>{n.outputs.push({address:e.paymentAndChangeAddress,amount:I9})});let s=parseInt((0,ht.signBtc)(n,"",t,void 0,!1,!0));return s>=O9&&n.outputs.push({address:e.paymentAndChangeAddress,amount:s}),ie.base.toBase64(ie.base.fromHex(qh(n,t)))}ee.generateUnsignedBuyingPsbt=W2;function z2(e,t){let r=fn.Psbt.fromBase64(e),n=t.length+1;return t.forEach((i,s)=>{let o=fn.Psbt.fromBase64(i);r.data.globalMap.unsignedTx.tx.ins[n+s]=o.data.globalMap.unsignedTx.tx.ins[Vs],r.data.inputs[n+s]=o.data.inputs[Vs]}),r}ee.mergeSignedBuyingPsbt=z2;function B9(e,t,r){let n=ie.base.toHex((0,ht.wif2Public)(t,r)),i=Lh(W2(e,r,n),t,r);return Kh(z2(i,e.sellerPsbts).toHex(),r)}ee.generateSignedBuyingTx=B9;function M9(e,t,r){let n=fn.Psbt.fromBase64(e,{network:r}),i=ie.base.fromHex(t),s=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY],o=[];for(let a=0;a<n.inputCount;a++){if(a!=Vs)continue;let{hash:c}=n.getHashAndSighashType(a,i,s);o.push(ie.base.toHex(c))}return{psbtBase64:e,signHashList:o}}ee.generateMPCUnsignedListingPSBT=M9;function C9(e,t,r,n){let i=fn.Psbt.fromBase64(e,{network:n}),o=[{pubkey:ie.base.fromHex(t),signature:Uh.signature.encode(ie.base.fromHex(r),oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY)}];return i.data.updateInput(Vs,{partialSig:o}),i.toBase64()}ee.generateMPCSignedListingPSBT=C9;function k9(e,t,r,n=1){let i=fn.Psbt.fromBase64(e,{network:r}),s=ie.base.fromHex(t),o=[oe.Transaction.SIGHASH_ALL],a=[],c=n+1;for(let u=0;u<i.inputCount;u++){if(u>=c&&u<c+n)continue;let{hash:d}=i.getHashAndSighashType(u,s,o);a.push(ie.base.toHex(d))}return{psbtBase64:e,signHashList:a}}ee.generateMPCUnsignedBuyingPSBT=k9;function H9(e,t,r,n,i=1){let s=fn.Psbt.fromBase64(e,{network:n}),o=ie.base.fromHex(t),a=i+1;for(let c=0;c<s.inputCount;c++){if(c>=a&&c<a+i)continue;let u=[{pubkey:o,signature:Uh.signature.encode(ie.base.fromHex(r[c]),oe.Transaction.SIGHASH_ALL)}];s.data.updateInput(c,{partialSig:u})}return Kh(s.toHex(),n)}ee.generateMPCSignedBuyingTx=H9;function X2(e,t,r){let n=Dh(e,r),i=ie.base.fromHex(t),s=[oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_SINGLE|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL|oe.Transaction.SIGHASH_ANYONECANPAY,oe.Transaction.SIGHASH_ALL,oe.Transaction.SIGHASH_DEFAULT],o=[];for(let c=0;c<n.inputCount;c++)try{let{hash:u}=n.getHashAndSighashType(c,i,s);o.push(ie.base.toHex(u))}catch{let d=L2();o.push(d)}let a=new Map;return o.forEach((c,u)=>{let d=a.get(c);d=d??0,d!=null&&d>=1&&(o[u]=L2()),a.set(c,d+1)}),{psbtStr:e,signHashList:o}}ee.generateMPCUnsignedPSBT=X2;function L2(){let e=(0,x9.sha256)((0,P9.randomBytes)(32));return"ffffffff"+ie.base.toHex(e.slice(0,28))}function N9(e,t,r,n){let i=Dh(e,n),s=ie.base.fromHex(t),o=oe.Transaction.SIGHASH_ALL,c=X2(e,t,n).signHashList;for(let u=0;u<i.inputCount;u++){if(c[u].slice(0,8)=="ffffffff")continue;i.data.inputs[u].sighashType!=null&&(o=i.data.inputs[u].sighashType);let d=[{pubkey:s,signature:Uh.signature.encode(ie.base.fromHex(r[u]),o)}];try{i.data.updateInput(u,{partialSig:d})}catch{}}return i.toHex()}ee.generateMPCSignedPSBT=N9;function Dh(e,t){let r;return ie.base.isHexString("0x"+e)?r=fn.Psbt.fromHex(e,{network:t}):r=fn.Psbt.fromBase64(e,{network:t}),r}});var t_=H(xa=>{w();S();Object.defineProperty(xa,"__esModule",{value:!0});xa.verifySimple=xa.signSimple=void 0;var Sa=he(),$2=ga(),Z2=Ls(),J2=Cf(),Y2=Wd(),R9=jh(),U9=rn(),Q2=mo();function e_(e){let t="BIP0322-signed-message",r=Sa.base.sha256(p.Buffer.from(t)),n=Sa.base.sha256(p.Buffer.concat([r,r,p.Buffer.from(e)]));return Sa.base.toHex(n)}async function q9(e,t,r,n){let i=(0,$2.toOutputScript)(t,n),s=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),o=4294967295,a=0,c=p.Buffer.concat([p.Buffer.from("0020","hex"),p.Buffer.from(e_(e),"hex")]),u=new Z2.Transaction;u.version=0,u.addInput(s,o,a,c),u.addOutput(i,0);let d=new J2.Psbt({network:n});d.setVersion(0),d.addInput({hash:u.getHash(),index:0,sequence:0,witnessUtxo:{script:i,value:0}}),(0,Q2.isP2TR)(i)&&d.updateInput(0,{tapInternalKey:(0,U9.wif2Public)(r,n).slice(1)}),d.addOutput({script:p.Buffer.from("6a","hex"),value:0}),(0,R9.psbtSignImpl)(d,r,n),d.finalizeAllInputs();let f=d.extractTransaction();function b(_){return p.Buffer.concat([(0,Y2.encode)(_.byteLength),_])}let m=(0,Y2.encode)(f.ins[0].witness.length),y=p.Buffer.concat([m,...f.ins[0].witness.map(_=>b(_))]);return Sa.base.toBase64(y)}xa.signSimple=q9;function L9(e,t,r,n,i){let s=(0,$2.toOutputScript)(t,i),o=p.Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),a=4294967295,c=0,u=p.Buffer.concat([p.Buffer.from("0020","hex"),p.Buffer.from(e_(e),"hex")]),d=new Z2.Transaction;d.version=0,d.addInput(o,a,c,u),d.addOutput(s,0);let f=new J2.Psbt;f.setVersion(0),f.addInput({hash:d.getHash(),index:0,sequence:0,witnessUtxo:{script:s,value:0}});let b=Sa.base.fromHex(n);return(0,Q2.isP2TR)(s)&&f.updateInput(0,{tapInternalKey:b.slice(1)}),f.addOutput({script:p.Buffer.from("6a","hex"),value:0}),f.verify(b,p.Buffer.from(Sa.base.fromBase64(r)))}xa.verifySimple=L9});var nn=H(Ue=>{w();S();var K9=Ue&&Ue.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),D9=Ue&&Ue.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),_o=Ue&&Ue.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&K9(t,e,r);return D9(t,e),t};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.BufferWriter=Ue.Transaction=Ue.psbt=Ue.bip0322=Ue.script=Ue.payments=Ue.networks=Ue.crypto=Ue.address=void 0;var j9=_o(ga());Ue.address=j9;var F9=_o(wr());Ue.crypto=F9;var G9=_o(bn());Ue.networks=G9;var V9=_o(Rs());Ue.payments=V9;var W9=_o(Gt());Ue.script=W9;var z9=_o(t_());Ue.bip0322=z9;var X9=_o(Cf());Ue.psbt=X9;var Y9=Ls();Object.defineProperty(Ue,"Transaction",{enumerable:!0,get:function(){return Y9.Transaction}});var $9=hs();Object.defineProperty(Ue,"BufferWriter",{enumerable:!0,get:function(){return $9.BufferWriter}})});var Hf=H(kf=>{w();S();Object.defineProperty(kf,"__esModule",{value:!0});kf.validate=void 0;function Z9(e,t){if(!e)throw new Error(t)}kf.validate=Z9});var i_=H(Pa=>{w();S();Object.defineProperty(Pa,"__esModule",{value:!0});Pa.decode=Pa.encode=void 0;var n_=Hf(),J9="qpzry9x8gf2tvdw0s3jn54khce6mua7l",r_={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};function Q9(e){for(var t="",r=0;r<e.length;++r){var n=e[r];(0,n_.validate)(0<=n&&n<32,"Invalid value: "+n+"."),t+=J9[n]}return t}Pa.encode=Q9;function eE(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r){var n=e[r];(0,n_.validate)(n in r_,"Invalid value: "+n+"."),t[r]=r_[n]}return t}Pa.decode=eE});var o_=H(Nf=>{w();S();Object.defineProperty(Nf,"__esModule",{value:!0});Nf.convert=void 0;var s_=Hf();function tE(e,t,r,n){for(var i=n?Math.floor(e.length*t/r):Math.ceil(e.length*t/r),s=(1<<r)-1,o=new Uint8Array(i),a=0,c=0,u=0,d=0;d<e.length;++d){var f=e[d];for((0,s_.validate)(0<=f&&f>>t===0,"Invalid value: "+f+"."),c=c<<t|f,u+=t;u>=r;)u-=r,o[a]=c>>u&s,++a}return n?(0,s_.validate)(u<t&&(c<<r-u&s)===0,"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):u>0&&(o[a]=c<<r-u&s,++a),o}Nf.convert=tE});var l_=H(jn=>{w();S();var rE=jn&&jn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),nE=jn&&jn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a_=jn&&jn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&rE(t,e,r);return nE(t,e),t};Object.defineProperty(jn,"__esModule",{value:!0});jn.decode=jn.encode=void 0;var c_=a_(i_()),iE=fw(),u_=a_(o_()),Fh=Hf();function sE(e,t,r){let n=vo(f_(e),new Uint8Array(1)),i=cE(t)+fE(r),s=lE(vo(new Uint8Array([i]),r)),o=vo(vo(n,s),new Uint8Array(8)),a=vo(s,aE(d_(o)));return e+":"+c_.encode(a)}jn.encode=sE;function oE(e){let t=e.toLowerCase().split(":");(0,Fh.validate)(t.length===2,"Missing prefix: "+e+".");let r=t[0],n=c_.decode(t[1]);(0,Fh.validate)(pE(r,n),"Invalid checksum: "+e+".");let i=hE(n.subarray(0,-8)),s=i[0],o=i.subarray(1);(0,Fh.validate)(dE(s)===o.length*8,"Invalid hash size: "+e+".");let a=uE(s);return{prefix:r,type:a,hash:o}}jn.decode=oE;function f_(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0)&31;return t}function aE(e){for(var t=new Uint8Array(8),r=0;r<8;++r)t[7-r]=e.and(31).toJSNumber(),e=e.shiftRight(5);return t}function cE(e){switch(e){case"P2PKH":return 0;case"P2SH":return 8;default:throw new Error("Invalid type: "+e+".")}}function uE(e){switch(e&120){case 0:return"P2PKH";case 8:return"P2SH";default:throw new Error("Invalid address type in version byte: "+e+".")}}function fE(e){switch(e.length*8){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new Error("Invalid hash size: "+e.length+".")}}function dE(e){switch(e&7){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512}}function lE(e){return u_.convert(e,8,5,!1)}function hE(e){return u_.convert(e,5,8,!0)}function vo(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function d_(e){for(var t=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336],r=iE(1),n=0;n<e.length;++n){var i=e[n],s=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(i);for(var o=0;o<t.length;++o)s.shiftRight(o).and(1).equals(1)&&(r=r.xor(t[o]))}return r.xor(1)}function pE(e,t){var r=vo(f_(e),new Uint8Array(1)),n=vo(r,t);return d_(n).equals(0)}});var g_=H(Jt=>{w();S();var bE=Jt&&Jt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),gE=Jt&&Jt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p_=Jt&&Jt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&bE(t,e,r);return gE(t,e),t};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.convert2LegacyAddress=Jt.isCashAddress=Jt.ValidateBitcashP2PkHAddress=Jt.GetBitcashP2PkHAddressByPublicKey=Jt.GetBitcashAddressByPublicKey=Jt.GetBitcashAddressByHash=void 0;var b_=wr(),Rf=p_(l_()),h_=p_(Rs());function Gh(e,t,r){return Rf.encode(e,t,r)}Jt.GetBitcashAddressByHash=Gh;function yE(e,t,r){let n=(0,b_.hash160)(p.Buffer.from(r));return Gh(e,t,n)}Jt.GetBitcashAddressByPublicKey=yE;function mE(e){let t=(0,b_.hash160)(p.Buffer.from(e));return Gh("bitcoincash","P2PKH",t)}Jt.GetBitcashP2PkHAddressByPublicKey=mE;function _E(e){try{e.indexOf(":")===-1&&(e="bitcoincash:"+e);let{prefix:t,type:r,hash:n}=Rf.decode(e);return r==="P2PKH"&&n.length===20}catch{return!1}}Jt.ValidateBitcashP2PkHAddress=_E;function vE(e){try{return e.startsWith("bitcoincash:")||(e="bitcoincash:"+e,Rf.decode(e)),!0}catch{return!1}}Jt.isCashAddress=vE;function wE(e,t){e.indexOf(":")===-1&&(e="bitcoincash:"+e);let{type:r,hash:n}=Rf.decode(e);if(r=="P2PKH")return h_.p2pkh({hash:p.Buffer.from(n),network:t}).address;if(r=="P2SH")return h_.p2sh({hash:p.Buffer.from(n),network:t}).address;throw new Error("convert2LegacyAddress error")}Jt.convert2LegacyAddress=wE});var m_=H(y_=>{w();S();Object.defineProperty(y_,"__esModule",{value:!0})});var x_=H(Fn=>{w();S();var SE=Fn&&Fn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),xE=Fn&&Fn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Vh=Fn&&Fn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&SE(t,e,r);return xE(t,e),t};Object.defineProperty(Fn,"__esModule",{value:!0});Fn.srcInscribe=Fn.SrcInscriptionTool=void 0;var Rr=Vh(nn()),PE=ri(),Ta=he(),TE=Vh(xi()),EE=Vh(wr()),Ac=rn(),AE=nn(),__=ba(),IE=PE.signUtil.schnorr.secp256k1.schnorr,OE=2,v_=31,BE=4294967293,ME=7800,CE=7800,JR=4e6/10,Ea=class{constructor(){this.network=Rr.networks.bitcoin,this.revealTxs=[],this.commitTx=new Rr.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newSrcInscriptionTool(t,r){let n=new Ea;n.network=t;let i=r.revealOutValue||ME,s=r.minChangeValue||CE;return n.buildCommitTx(t,r.inscriptionData,i,r.commitTxPrevOutputList,r.changeAddress,r.commitFeeRate,s)||n.signCommitTx(r.commitTxPrevOutputList),n}buildCommitTx(t,r,n,i,s,o,a){let c=p.Buffer.from(r.contentType),u=p.Buffer.from(r.body);for(;u[u.length-1]==0;)u=u.slice(0,u.length-1);let d=2+c.length+u.length,f=d%62==0?d:d+62-d%62,b=AE.BufferWriter.withCapacity(f);b.writeSlice(p.Buffer.from([(c.length+u.length)/256,(c.length+u.length)%256])),b.writeSlice(c),b.writeSlice(u),f>d&&b.writeSlice(p.Buffer.alloc(f-d));let m=b.end(),y=Ta.base.fromHex(RE(i[0].txId,m.toString("hex"))),_=0,E=0,I=new Rr.Transaction;for(I.version=OE,E+=n,I.addOutput(Rr.address.toOutputScript(r.revealAddr,t),n);y.length;){let L=y.slice(0,Math.min(v_,y.length)),K=L.toString("hex");K.length<62&&(K=K+"0".repeat(62-K.length)),y=y.slice(L.length);let O=y.slice(0,Math.min(v_,y.length)).toString("hex");O.length<62&&(O=O+"0".repeat(62-O.length)),y=y.slice(L.length);let l=["03"+K+"00","02"+O+"00","020202020202020202020202020202020202020202020202020202020202020202"].map(v=>p.Buffer.from(v,"hex")),g=Rr.payments.p2ms({m:1,pubkeys:l});I.addOutput(g.output,n),E+=n}i.forEach(L=>{let K=Ta.base.reverseBuffer(Ta.base.fromHex(L.txId));I.addInput(K,L.vOut,BE),this.commitTxPrevOutputFetcher.push(L.amount),_+=L.amount});let k=Rr.address.toOutputScript(s,t);I.addOutput(k,0);let C=I.clone();w_(C,i,this.network);let U=(0,__.countAdjustedVsize)(C,i.map(L=>L.address),t),R=Math.floor(U*o),q=_-E-R;if(q>=a)I.outs[I.outs.length-1].value=q;else{I.outs=I.outs.slice(0,I.outs.length-1),C.outs=C.outs.slice(0,C.outs.length-1);let L=(0,__.countAdjustedVsize)(C,i.map(W=>W.address),t),K=Math.floor(L*o);if(_-E-K<0)return this.mustCommitTxFee=R,this.mustRevealTxFees.push(E),!0}return this.commitTx=I,!1}signCommitTx(t){w_(this.commitTx,t,this.network)}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};Fn.SrcInscriptionTool=Ea;function w_(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Ac.getAddressType)(t[i].address,r),o=Ta.base.fromHex((0,Ac.privateKeyFromWIF)(t[i].privateKey,r)),a=Ta.base.toHex(o),c=(0,Ac.private2public)(a);if(s==="segwit_taproot"){let u=t.map(y=>Rr.address.toOutputScript(y.address,r)),d=t.map(y=>y.amount),f=e.hashForWitnessV1(i,u,d,Rr.Transaction.SIGHASH_DEFAULT),b=TE.taprootTweakPrivKey(o),m=p.Buffer.from(IE.sign(f,b,Ta.base.randomBytes(32)));n.witness=[p.Buffer.from(m)]}else if(s==="legacy"){let u=Rr.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,Rr.Transaction.SIGHASH_ALL),f=(0,Ac.sign)(d,a),b=Rr.payments.p2pkh({signature:Rr.script.signature.encode(f,Rr.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=EE.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,Rr.Transaction.SIGHASH_ALL),m=(0,Ac.sign)(b,a);n.witness=[Rr.script.signature.encode(m,Rr.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function kE(e,t){let r=Ea.newSrcInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}Fn.srcInscribe=kE;function HE(e,t){for(var r=[],n=0,i,s="",o=0;o<256;o++)r[o]=o;for(o=0;o<256;o++)n=(n+r[o]+e.charCodeAt(o%e.length))%256,i=r[o],r[o]=r[n],r[n]=i;o=0,n=0;for(var a=0;a<t.length;a++)o=(o+1)%256,n=(n+r[o])%256,i=r[o],r[o]=r[n],r[n]=i,s+=String.fromCharCode(t.charCodeAt(a)^r[(r[o]+r[n])%256]);return s}function S_(e){for(var t=[],r,n=0;n<e.length-1;n+=2){var i=parseInt(e.substr(n,2),16);t.push(i)}return r=String.fromCharCode.apply(String,t),r}function NE(e){var t,r,n="",i;for(e+="",t=0,r=e.length;t<r;t++)i=e.charCodeAt(t).toString(16),n+=i.length<2?"0"+i:i;return n}function RE(e,t){return NE(HE(S_(e),S_(t)))}});var M_=H(Ur=>{w();S();var UE=Ur&&Ur.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qE=Ur&&Ur.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Xh=Ur&&Ur.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&UE(t,e,r);return qE(t,e),t};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.inscribeForMPCSigned=Ur.inscribeForMPCUnsigned=Ur.inscribe=Ur.InscriptionTool=void 0;var se=Xh(nn()),LE=ri(),mn=he(),KE=Xh(xi()),T_=Xh(wr()),E_=Ls(),Ws=rn(),Wh=mo(),Uf=ba(),Yh=LE.signUtil.schnorr.secp256k1.schnorr,qf=2,Lf=4294967293,A_=546,I_=546,P_=4e6/10,Aa=class{constructor(){this.network=se.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new se.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newInscriptionTool(t,r){let n=new Aa;n.network=t;let i=r.revealOutValue||A_,s=r.minChangeValue||I_,o=r.commitTxPrevOutputList[0].privateKey;r.inscriptionDataList.forEach(u=>{n.inscriptionTxCtxDataList.push(O_(t,u,o))});let a=n.buildEmptyRevealTx(t,i,r.revealFeeRate);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,a,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTx(t,r,n){let i=0,s=[],o=[],a=[];return this.inscriptionTxCtxDataList.forEach((c,u)=>{let d=new se.Transaction;d.version=qf,d.addInput(p.Buffer.alloc(32),u,Lf),d.addOutput(c.revealPkScript,r);let f=p.Buffer.alloc(64),b=p.Buffer.alloc(33),m=[];m.push(f),m.push(c.inscriptionScript),m.push(b);let y=Math.floor((d.byteLength()+Math.floor(((0,E_.vectorSize)(m)+2+3)/4))*n),_=r+y;c.revealTxPrevOutput={pkScript:c.commitTxAddressPkScript,value:_},i+=_,s.push(d),o.push(y),a.push(c.commitTxAddress)}),this.revealTxs=s,this.mustRevealTxFees=o,this.commitAddrs=a,i}buildCommitTx(t,r,n,i,s,o){let a=0,c=new se.Transaction;c.version=qf,r.forEach(y=>{let _=mn.base.reverseBuffer(mn.base.fromHex(y.txId));c.addInput(_,y.vOut,Lf),this.commitTxPrevOutputFetcher.push(y.amount),a+=y.amount}),this.inscriptionTxCtxDataList.forEach(y=>{c.addOutput(y.revealTxPrevOutput.pkScript,y.revealTxPrevOutput.value)});let u=se.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();zh(d,r.map(y=>({...y,privateKey:""})),this.network);let f=(0,Uf.countAdjustedVsize)(d,r.map(y=>y.address),t),b=Math.floor(f*s),m=a-i-b;if(m>=o)c.outs[c.outs.length-1].value=m;else{c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let y=(0,Uf.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(y*s);if(a-i-_<0)return this.mustCommitTxFee=b,!0}return this.commitTx=c,!1}signCommitTx(t){zh(this.commitTx,t,this.network)}completeRevealTx(){this.revealTxs.forEach((t,r)=>{t.ins[0].hash=this.commitTx.getHash();let n=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.pkScript],i=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value];this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value);let s=t.hashForWitnessV1(0,n,i,se.Transaction.SIGHASH_DEFAULT,this.inscriptionTxCtxDataList[r].hash),o=p.Buffer.from(Yh.sign(s,this.inscriptionTxCtxDataList[r].privateKey,mn.base.randomBytes(32)));t.ins[0].witness=[p.Buffer.from(o),...this.inscriptionTxCtxDataList[r].witness];let a=t.weight();if(a>P_)throw new Error(`reveal(index ${r}) transaction weight greater than ${P_} (MAX_STANDARD_TX_WEIGHT): ${a}`)})}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};Ur.InscriptionTool=Aa;function zh(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Ws.getAddressType)(t[i].address,r);if(t[i].privateKey==""){let{witness:u,script:d}=(0,Ws.fakeSign)(s);u!==void 0&&(n.witness=u),d!==void 0&&(n.script=d);return}let o=mn.base.fromHex((0,Ws.privateKeyFromWIF)(t[i].privateKey,r)),a=mn.base.toHex(o),c=(0,Ws.private2public)(a);if(s==="segwit_taproot"){let u=t.map(y=>se.address.toOutputScript(y.address,r)),d=t.map(y=>y.amount),f=e.hashForWitnessV1(i,u,d,se.Transaction.SIGHASH_DEFAULT),b=KE.taprootTweakPrivKey(o),m=p.Buffer.from(Yh.sign(f,b,mn.base.randomBytes(32)));n.witness=[p.Buffer.from(m)]}else if(s==="legacy"){let u=se.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,se.Transaction.SIGHASH_ALL),f=(0,Ws.sign)(d,a),b=se.payments.p2pkh({signature:se.script.signature.encode(f,se.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=T_.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,se.Transaction.SIGHASH_ALL),m=(0,Ws.sign)(b,a);n.witness=[se.script.signature.encode(m,se.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function O_(e,t,r){let n=mn.base.fromHex((0,Ws.privateKeyFromWIF)(r,e)),i=(0,Ws.wif2Public)(r,e).slice(1),s=se.script.OPS,o=[];o.push(i),o.push(s.OP_CHECKSIG),o.push(s.OP_FALSE),o.push(s.OP_IF),o.push(p.Buffer.from("ord")),o.push(s.OP_DATA_1),o.push(s.OP_DATA_1),o.push(p.Buffer.from(t.contentType)),o.push(s.OP_0);let a=520,c=p.Buffer.from(t.body),u=c.length;for(let I=0;I<u;I+=a){let k=I+a;k>u&&(k=u),o.push(c.slice(I,k))}o.push(s.OP_ENDIF);let d=se.script.compile(o),f={output:d},b={output:d,redeemVersion:192},{output:m,witness:y,hash:_,address:E}=se.payments.p2tr({internalPubkey:i,scriptTree:f,redeem:b,network:e});return{privateKey:n,inscriptionScript:d,commitTxAddress:E,commitTxAddressPkScript:m,witness:y,hash:_,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:se.address.toOutputScript(t.revealAddr,e)}}function DE(e,t){let r=Aa.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}Ur.inscribe=DE;function B_(e,t,r,n){let i=e.commitTxPrevOutputList[0].privateKey,s=[];e.inscriptionDataList.forEach(R=>{s.push(O_(t,R,i))});let o=0,a=e.revealOutValue||A_,c=[];s.forEach((R,q)=>{let L=new se.Transaction;L.version=qf,L.addInput(p.Buffer.alloc(32),q,Lf),L.addOutput(R.revealPkScript,a),c.push(L);let K=p.Buffer.alloc(64),W=p.Buffer.alloc(33),O=[];O.push(K),O.push(R.inscriptionScript),O.push(W);let l=Math.floor((L.byteLength()+Math.floor(((0,E_.vectorSize)(O)+2+3)/4))*e.revealFeeRate),g=a+l;R.revealTxPrevOutput={pkScript:R.commitTxAddressPkScript,value:g},o+=g});let u=0,d=new se.Transaction;d.version=qf,e.commitTxPrevOutputList.forEach(R=>{d.addInput(mn.base.reverseBuffer(mn.base.fromHex(R.txId)),R.vOut,Lf),u+=R.amount});let f=[];s.forEach(R=>{d.addOutput(R.revealTxPrevOutput.pkScript,R.revealTxPrevOutput.value),f.push(R.commitTxAddress)});let b=se.address.toOutputScript(e.changeAddress,t);d.addOutput(b,0);let m=d.clone();zh(m,e.commitTxPrevOutputList,t);let y=(0,Uf.countAdjustedVsize)(m,e.commitTxPrevOutputList.map(R=>R.address),t),_=Math.floor(y*e.commitFeeRate),E=u-o-_;if(E>=(e.minChangeValue||I_))d.outs[d.outs.length-1].value=E;else{d.outs=d.outs.slice(0,d.outs.length-1),m.outs=m.outs.slice(0,m.outs.length-1);let R=(0,Uf.countAdjustedVsize)(m,e.commitTxPrevOutputList.map(L=>L.address),t),q=Math.floor(R*e.commitFeeRate);if(u-o-q<0)throw new Error("insufficient balance")}let I=FE(d,e.commitTxPrevOutputList,t),k=d.getHash();n&&(k=n),c.forEach((R,q)=>{R.ins[0].hash=k;let L=[s[q].revealTxPrevOutput.pkScript],K=[s[q].revealTxPrevOutput.value],W=R.hashForWitnessV1(0,L,K,se.Transaction.SIGHASH_DEFAULT,s[q].hash),O=p.Buffer.from(Yh.sign(W,s[q].privateKey,mn.base.randomBytes(32)));R.ins[0].witness=[O,...s[q].witness]});let C=0;d.ins.forEach((R,q)=>{C+=e.commitTxPrevOutputList[q].amount}),d.outs.forEach(R=>{C-=R.value});let U=[];return c.forEach((R,q)=>{let L=0;L+=s[q].revealTxPrevOutput.value,L-=R.outs[0].value,U.push(L)}),{signHashList:I,commitTx:d.toHex(),revealTxs:c.map(R=>R.toHex()),commitTxFee:C,revealTxFees:U,commitAddrs:f}}Ur.inscribeForMPCUnsigned=B_;function jE(e,t){let r=e.commitTx,n=e.signatureList,i=se.Transaction.fromHex(r),s=i.getHash();i.ins.forEach((c,u)=>{let d=mn.base.fromHex(n[u]);!c.witness||c.witness.length==0?c.script=se.payments.p2pkh({pubkey:se.payments.p2pkh({input:c.script}).pubkey,signature:se.script.signature.encode(d,se.Transaction.SIGHASH_ALL)}).input:c.witness[0]=se.script.signature.encode(d,se.Transaction.SIGHASH_ALL)});let o=i.getHash(),a=B_(e,t,s,o);return{signHashList:null,commitTx:i.toHex(),revealTxs:a.revealTxs,commitTxFee:a.commitTxFee,revealTxFees:a.revealTxFees,commitAddrs:a.commitAddrs}}Ur.inscribeForMPCSigned=jE;function FE(e,t,r){let n=[];return e.ins.forEach((i,s)=>{let o=mn.base.fromHex(t[s].publicKey),a=se.address.toOutputScript(t[s].address,r),c=p.Buffer.alloc(64,0),u;if((0,Wh.isP2TR)(a)){let d=t.map(b=>se.address.toOutputScript(b.address,r)),f=t.map(b=>b.amount);u=e.hashForWitnessV1(s,d,f,se.Transaction.SIGHASH_DEFAULT),i.witness=[c]}else if((0,Wh.isP2PKH)(a)){let d=se.address.toOutputScript(t[s].address,r);u=e.hashForSignature(s,d,se.Transaction.SIGHASH_ALL),i.script=se.payments.p2pkh({pubkey:o,signature:se.script.signature.encode(c,se.Transaction.SIGHASH_ALL)}).input}else{let d=T_.hash160(o),f=p.Buffer.of(25,118,169,20,...d,136,172);u=e.hashForWitness(s,f,t[s].amount,se.Transaction.SIGHASH_ALL),i.witness=se.payments.p2wpkh({pubkey:o,signature:se.script.signature.encode(c,se.Transaction.SIGHASH_ALL)}).witness;let b=p.Buffer.of(22,0,20,...d);(0,Wh.isP2SHScript)(a)&&(i.script=b)}n.push(mn.base.toHex(u))}),n}});var N_=H(dn=>{w();S();var GE=dn&&dn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),VE=dn&&dn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$h=dn&&dn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&GE(t,e,r);return VE(t,e),t};Object.defineProperty(dn,"__esModule",{value:!0});dn.inscribeRefundFee=dn.createInscriptionTxCtxData=dn.InscriptionRefundFeeTool=void 0;var mr=$h(nn()),WE=ri(),Ia=he(),zE=$h(xi()),XE=$h(wr()),wo=rn(),C_=ba(),YE=WE.signUtil.schnorr.secp256k1.schnorr,$E=2,ZE=4294967293,JE=546,sU=4e6/10,Oa=class{constructor(){this.network=mr.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.refundFeeTx=new mr.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustTxFee=0,this.dustChange=0,this.commitAddrs=[],this.merkleRoot=new Uint8Array}static newInscriptionRefundFeeTool(t,r){let n=new Oa;n.network=t;let i=r.minChangeValue||JE;if(r.inputs&&r.inputs.length>600)throw new Error("invalid amount of inputs");let s=100;r.maxAmountOfInput&&(s=r.maxAmountOfInput),s>r.inputs.length&&(s=r.inputs.length);let o=r.inputs[0].privateKey;if(r.inscriptionRefundFeeDataList.forEach(c=>{n.inscriptionTxCtxDataList.push(H_(t,c,o))}),r.middleAddress&&r.middleAddress!=n.inscriptionTxCtxDataList[0].commitTxAddress)throw new Error("invalid middle address");return n.commitAddrs=[n.inscriptionTxCtxDataList[0].commitTxAddress],n.merkleRoot=n.inscriptionTxCtxDataList[0].hash,n.buildrRefundFeeTx(t,r.inputs.slice(0,s),r.changeAddress,0,r.feeRate,i)||n.signRefundFeeTx(r.inputs.slice(0,s)),n}buildrRefundFeeTx(t,r,n,i,s,o){let a=0,c=new mr.Transaction;c.version=$E,r.forEach(y=>{let _=Ia.base.reverseBuffer(Ia.base.fromHex(y.txId));c.addInput(_,y.vOut,ZE),this.commitTxPrevOutputFetcher.push(y.amount),a+=y.amount});let u=mr.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();k_(d,r,this.network);let f=(0,C_.countAdjustedVsize)(d,r.map(y=>y.address),t),b=Math.floor(f*s),m=a-i-b;if(m>=o)c.outs[c.outs.length-1].value=m;else{if(c.outs.length<=1)return this.dustChange=m,!0;c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let y=(0,C_.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(y*s);if(a-i-_<0)return this.mustTxFee=b,!0}return this.refundFeeTx=c,!1}signRefundFeeTx(t){k_(this.refundFeeTx,t,this.network,this.merkleRoot)}calculateFee(){let t=0;return this.refundFeeTx.ins.forEach((r,n)=>{t+=this.commitTxPrevOutputFetcher[n]}),this.refundFeeTx.outs.forEach(r=>{t-=r.value}),{refundFeeTxFee:t}}};dn.InscriptionRefundFeeTool=Oa;function k_(e,t,r,n=new Uint8Array){e.ins.forEach((i,s)=>{let o=(0,wo.getAddressType)(t[s].address,r),a=Ia.base.fromHex((0,wo.privateKeyFromWIF)(t[s].privateKey,r)),c=Ia.base.toHex(a),u=(0,wo.private2public)(c);if(o==="segwit_taproot"){let d=t.map(_=>mr.address.toOutputScript(_.address,r)),f=t.map(_=>_.amount),b=e.hashForWitnessV1(s,d,f,mr.Transaction.SIGHASH_DEFAULT),m=zE.taprootTweakPrivKey(a,n),y=p.Buffer.from(YE.sign(b,m,Ia.base.randomBytes(32)));i.witness=[p.Buffer.from(y)]}else if(o==="legacy"){let d=mr.address.toOutputScript(t[s].address,r),f=e.hashForSignature(s,d,mr.Transaction.SIGHASH_ALL),b=(0,wo.sign)(f,c),m=mr.payments.p2pkh({signature:mr.script.signature.encode(b,mr.Transaction.SIGHASH_ALL),pubkey:u});i.script=m.input}else{let d=XE.hash160(u),f=p.Buffer.of(25,118,169,20,...d,136,172),b=t[s].amount,m=e.hashForWitness(s,f,b,mr.Transaction.SIGHASH_ALL),y=(0,wo.sign)(m,c);i.witness=[mr.script.signature.encode(y,mr.Transaction.SIGHASH_ALL),u];let _=p.Buffer.of(22,0,20,...d);o==="segwit_nested"&&(i.script=_)}})}function H_(e,t,r){let n=Ia.base.fromHex((0,wo.privateKeyFromWIF)(r,e)),i=(0,wo.wif2Public)(r,e).slice(1),s=mr.script.OPS,o=[];o.push(i),o.push(s.OP_CHECKSIG),o.push(s.OP_FALSE),o.push(s.OP_IF),o.push(p.Buffer.from("ord")),o.push(s.OP_DATA_1),o.push(s.OP_DATA_1),o.push(p.Buffer.from(t.contentType)),o.push(s.OP_0);let a=520,c=p.Buffer.from(t.body),u=c.length;for(let I=0;I<u;I+=a){let k=I+a;k>u&&(k=u),o.push(c.slice(I,k))}o.push(s.OP_ENDIF);let d=mr.script.compile(o),f={output:d},b={output:d,redeemVersion:192},{output:m,witness:y,hash:_,address:E}=mr.payments.p2tr({internalPubkey:i,scriptTree:f,redeem:b,network:e});return{privateKey:n,inscriptionScript:d,commitTxAddress:E,commitTxAddressPkScript:m,witness:y,hash:_,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:mr.address.toOutputScript(t.revealAddr,e)}}dn.createInscriptionTxCtxData=H_;function QE(e,t){let r=Oa.newInscriptionRefundFeeTool(e,t);return r.mustTxFee>0||r.dustChange!=0?{refundFeeTx:"",mustTxFee:r.mustTxFee,dustChange:r.dustChange}:{refundFeeTx:r.refundFeeTx.toHex(),...r.calculateFee(),middleAddresses:r.commitAddrs}}dn.inscribeRefundFee=QE});var D_=H(dt=>{w();S();var eA=dt&&dt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),tA=dt&&dt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Qh=dt&&dt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&eA(t,e,r);return tA(t,e),t};Object.defineProperty(dt,"__esModule",{value:!0});dt.dogInscribe=dt.DogInscriptionTool=dt.DogScript=dt.bufferToChunk=dt.bufferToBuffer=dt.CHANGE_OUTPUT_MAX_SIZE=void 0;var qe=Qh(nn()),Ai=he(),rA=Qh(wr()),Gn=rn(),K_=nn(),Wr=Zs(),nA=Qh(Rs()),zs=hs();dt.CHANGE_OUTPUT_MAX_SIZE=20+4+34+4;var R_=2,Zh=4294967293,iA=1e5,sA=1e5,oA=240,U_=1500;function q_(e){return{buf:e<=16?void 0:e<128?p.Buffer.from([e]):p.Buffer.from([e%256,e/256]),len:e<=16?0:e<128?1:2,opcodenum:e==0?0:e<=16?80+e:e<128?1:2}}function Ic(e){let t=Ba(e),r=zs.varuint.encodingLength(t.opcodenum);var n=t.opcodenum;t.buf&&((n===Wr.OPS.OP_PUSHDATA1||n===Wr.OPS.OP_PUSHDATA2||n===Wr.OPS.OP_PUSHDATA4)&&(r+=zs.varuint.encodingLength(t.len)),r+=t.buf.length);let i=K_.BufferWriter.withCapacity(r);return i.writeUInt8(t.opcodenum),t.buf&&(n<Wr.OPS.OP_PUSHDATA1?i.writeSlice(t.buf):n===Wr.OPS.OP_PUSHDATA1?(i.writeUInt8(t.len),i.writeSlice(t.buf)):n===Wr.OPS.OP_PUSHDATA2?(i.writeUInt64(t.len),i.writeSlice(t.buf)):n===Wr.OPS.OP_PUSHDATA4&&(i.writeUInt32(t.len),i.writeSlice(t.buf))),i.end()}dt.bufferToBuffer=Ic;function Ba(e){return{buf:e.length?e:void 0,len:e.length,opcodenum:e.length<=75?e.length:e.length<=255?76:77}}dt.bufferToChunk=Ba;function Jh(e){return{opcodenum:e}}var Ma=class{constructor(){this.chunks=[]}total(){return this.chunks.length==0?0:this.chunks.map(r=>{let n=zs.varuint.encodingLength(r.opcodenum);var i=r.opcodenum;return r.buf&&(i<Wr.OPS.OP_PUSHDATA1||(i===Wr.OPS.OP_PUSHDATA1||i===Wr.OPS.OP_PUSHDATA2||i===Wr.OPS.OP_PUSHDATA4)&&(n+=zs.varuint.encodingLength(r.len)),n+=r.buf.length),n}).reduce((r,n)=>r+n)}toBuffer(){let t=this.total(),r=K_.BufferWriter.withCapacity(t);for(var n=0;n<this.chunks.length;n++){var i=this.chunks[n],s=i.opcodenum;r.writeUInt8(i.opcodenum),i.buf&&(s<Wr.OPS.OP_PUSHDATA1?r.writeSlice(i.buf):s===Wr.OPS.OP_PUSHDATA1?(r.writeUInt8(i.len),r.writeSlice(i.buf)):s===Wr.OPS.OP_PUSHDATA2?(r.writeUInt64(i.len),r.writeSlice(i.buf)):s===Wr.OPS.OP_PUSHDATA4&&(r.writeUInt32(i.len),r.writeSlice(i.buf)))}return r.end()}};dt.DogScript=Ma;var Ca=class{constructor(){this.network=qe.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new qe.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[],this.fromAddr="",this.revealAddr=""}static newDogInscriptionTool(t,r){let n=new Ca;n.network=t;let i=r.revealOutValue||iA,s=r.minChangeValue||sA,o=r.commitTxPrevOutputList[0].privateKey;n.inscriptionTxCtxDataList=aA(t,r.inscriptionData,o),n.revealAddr=r.inscriptionData.revealAddr;let a=Ai.base.toHex(Ai.base.fromHex((0,Gn.privateKeyFromWIF)(o,t))),c=(0,Gn.private2public)(a);n.fromAddr=qe.payments.p2pkh({pubkey:c,network:t}).address;let u=n.buildEmptyRevealTxs(t,i,r.revealFeeRate);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,u,i,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTxs(t,r,n){let i=0,s=[],o=[],a=[],c=0;for(let u=this.inscriptionTxCtxDataList.length-1;u>-1;u--){let d=this.inscriptionTxCtxDataList[u],f=new qe.Transaction;f.version=R_,f.addInput(p.Buffer.alloc(32),0,Zh),f.addInput(p.Buffer.alloc(32),1,Zh),f.addOutput(u!=this.inscriptionTxCtxDataList.length-1?d.commitTxAddressPkScript:d.revealPkScript,r);let b=p.Buffer.alloc(72),m=p.Buffer.concat([d.inscriptionScript,Ic(b),Ic(d.redeemScript)]);f.ins[0].script=m,u!=this.inscriptionTxCtxDataList.length-1&&f.addOutput(qe.address.toOutputScript(this.fromAddr,t),c),f.ins[1].script=p.Buffer.alloc(106);let y=Math.floor((f.dogeByteLength()+dt.CHANGE_OUTPUT_MAX_SIZE)*n);c+=y;let _=y;d.revealTxPrevOutput={pkScript:d.commitTxAddressPkScript,value:_},i+=_,s.push(f),o.push(y),a.push(d.commitTxAddress)}for(let u=0,d=s.length-1;u<d;u++,d--)[s[u],s[d]]=[s[d],s[u]],[o[u],o[d]]=[o[d],o[u]],[a[u],a[d]]=[a[d],a[u]];return this.revealTxs=s,this.mustRevealTxFees=o,this.commitAddrs=a,i+=r,i}buildCommitTx(t,r,n,i,s,o,a){let c=0,u=new qe.Transaction;u.version=R_,r.forEach(y=>{let _=Ai.base.reverseBuffer(Ai.base.fromHex(y.txId));u.addInput(_,y.vOut,Zh),this.commitTxPrevOutputFetcher.push(y.amount),c+=y.amount}),u.addOutput(this.inscriptionTxCtxDataList[0].revealTxPrevOutput.pkScript,s),u.addOutput(qe.address.toOutputScript(this.fromAddr,t),i);let d=qe.address.toOutputScript(n,t);u.addOutput(d,0);let f=u.clone();L_(f,r,this.network);let b=Math.floor((f.dogeByteLength()+dt.CHANGE_OUTPUT_MAX_SIZE)*o),m=c-i-b;if(m>=a)u.outs[u.outs.length-1].value=m;else{u.outs=u.outs.slice(0,u.outs.length-1),f.outs=f.outs.slice(0,f.outs.length-1);let y=Math.floor(f.dogeByteLength()*o);if(c-i-y<0)return this.mustCommitTxFee=b,!0}return this.commitTx=u,!1}signCommitTx(t){L_(this.commitTx,t,this.network)}completeRevealTx(){for(let t=0;t<this.revealTxs.length;t++){let r=this.revealTxs[t];r.ins[0].hash=t==0?this.commitTx.getHash():this.revealTxs[t-1].getHash(),r.ins[1].hash=t==0?this.commitTx.getHash():this.revealTxs[t-1].getHash(),this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[t].revealTxPrevOutput.value);let n=this.inscriptionTxCtxDataList[t].redeemScript,i=r.hashForSignature(0,n,qe.Transaction.SIGHASH_ALL),s=Ai.base.toHex(this.inscriptionTxCtxDataList[t].privateKey),o=(0,Gn.sign)(i,s),a=qe.script.signature.encode(o,qe.Transaction.SIGHASH_ALL);r.ins[0].script=p.Buffer.concat([this.inscriptionTxCtxDataList[t].inscriptionScript,Ic(a),Ic(this.inscriptionTxCtxDataList[t].redeemScript)]);let c=qe.address.toOutputScript(this.fromAddr,this.network),u=r.hashForSignature(1,c,qe.Transaction.SIGHASH_ALL),d=(0,Gn.sign)(u,s),f=qe.payments.p2pkh({signature:qe.script.signature.encode(d,qe.Transaction.SIGHASH_ALL),pubkey:(0,Gn.private2public)(s)});r.ins[1].script=f.input}}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s=this.revealTxPrevOutputFetcher[i],r.push(s)}),{commitTxFee:t,revealTxFees:r}}};dt.DogInscriptionTool=Ca;function L_(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Gn.getAddressType)(t[i].address,r),o=Ai.base.fromHex((0,Gn.privateKeyFromWIF)(t[i].privateKey,r)),a=Ai.base.toHex(o),c=(0,Gn.private2public)(a);if(s==="legacy"){let u=qe.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,qe.Transaction.SIGHASH_ALL),f=(0,Gn.sign)(d,a),b=qe.payments.p2pkh({signature:qe.script.signature.encode(f,qe.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=rA.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,qe.Transaction.SIGHASH_ALL),m=(0,Gn.sign)(b,a);n.witness=[qe.script.signature.encode(m,qe.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function aA(e,t,r){let n=Ai.base.fromHex((0,Gn.privateKeyFromWIF)(r,e)),i=(0,Gn.wif2Public)(r,e),s=qe.script.OPS,o;typeof t.body=="string"?o=p.Buffer.from(t.body):o=t.body;let a=[];for(;o.length;){let d=o.slice(0,Math.min(oA,o.length));o=o.slice(d.length),a.push(d)}let c=new Ma;c.chunks.push(Ba(p.Buffer.from("ord"))),c.chunks.push(q_(a.length)),c.chunks.push(Ba(p.Buffer.from(t.contentType))),a.forEach((d,f)=>{c.chunks.push(q_(a.length-f-1)),c.chunks.push(Ba(d))});let u=[];for(;c.chunks.length;){let d=new Ma;for(u.length==0&&d.chunks.push(c.chunks.shift());d.total()<=U_&&c.chunks.length;)d.chunks.push(c.chunks.shift()),d.chunks.push(c.chunks.shift());d.total()>U_&&(c.chunks.unshift(d.chunks.pop()),c.chunks.unshift(d.chunks.pop()));let f=new Ma;f.chunks.push(Ba(i)),f.chunks.push(Jh(s.OP_CHECKSIGVERIFY)),d.chunks.forEach(()=>{f.chunks.push(Jh(s.OP_DROP))}),f.chunks.push(Jh(s.OP_TRUE));let b=Ai.base.ripemd160(Ai.base.sha256(f.toBuffer())),{output:m,address:y}=nA.p2sh({hash:p.Buffer.from(b),network:e}),_={privateKey:n,inscriptionScript:d.toBuffer(),redeemScript:f.toBuffer(),commitTxAddress:y,commitTxAddressPkScript:m,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:1e5},revealPkScript:qe.address.toOutputScript(t.revealAddr,e)};u.push(_)}return u}function cA(e,t){let r=Ca.newDogInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}dt.dogInscribe=cA});var V_=H(ln=>{w();S();Object.defineProperty(ln,"__esModule",{value:!0});ln.verifyWithAddress=ln.getMPCSignedMessage=ln.verify=ln.sign=ln.toCompact=ln.magicHash=void 0;var Df=ri(),ir=he(),uA=rn(),fA=p.Buffer.from(`Bitcoin Signed Message:
`);function j_(e){let t;return e<253?(t=p.Buffer.alloc(1),t.writeUInt8(e,0)):e<65536?(t=p.Buffer.alloc(1+2),t.writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967296?(t=p.Buffer.alloc(1+4),t.writeUInt8(254,0),t.writeUInt32LE(e,1)):(t=p.Buffer.alloc(1+8),t.writeUInt8(255,0),t.writeInt32LE(e&-1,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t}function jf(e,t){let r=t?p.Buffer.from(t,"utf8"):fA,n=j_(r.length),i=p.Buffer.from(e),s=j_(i.length),o=p.Buffer.concat([n,r,s,i]);return ir.base.doubleSha256(o)}ln.magicHash=jf;function t0(e,t,r){if(!(e===0||e===1||e===2||e===3))throw new Error("i must be equal to 0, 1, 2, or 3");let n=e+27+4;return r||(n=n-4),p.Buffer.concat([Uint8Array.of(n),Uint8Array.from(t)])}ln.toCompact=t0;function dA(e,t,r,n){let i=jf(t,n);if(!e)return ir.base.toHex(i);let s=ir.base.fromHex((0,uA.privateKeyFromWIF)(e,r)),{signature:o,recovery:a}=Df.signUtil.secp256k1.sign(p.Buffer.from(i),s);return ir.base.toBase64(t0(a,o,!0))}ln.sign=dA;function lA(e,t,r,n){let i=jf(t,n),s=ir.base.fromBase64(r),o=s[0]-27-4,a=s.slice(1);return Df.signUtil.secp256k1.verify(p.Buffer.from(i),a,o,ir.base.fromHex(e))}ln.verify=lA;function hA(e,t,r){let n=ir.base.fromHex(t),i=n.slice(0,32),s=n.slice(32,64),o=Df.signUtil.secp256k1.getV(ir.base.fromHex(e),ir.base.toHex(i),ir.base.toHex(s),ir.base.fromHex(r));return ir.base.toBase64(t0(o,n,!0))}ln.getMPCSignedMessage=hA;function pA(e,t,r,n){let i=jf(t,n),s=ir.base.fromBase64(r),o=s[0]-27,a=s.slice(1),c=o&3,u=o&8?o&4?e0.P2WPKH:e0.P2SH_P2WPKH:null,d=!!(o&12),f=Df.signUtil.secp256k1.recover(a,c,p.Buffer.from(i),d);if(f==null)return!1;let b=p.Buffer.from(ir.base.hash160(f)),m,y;if(u)u===e0.P2SH_P2WPKH?(m=G_(b),y=ir.base.fromBase58Check(e).slice(1)):(m=b,y=F_(e));else try{return y=F_(e),Kf(b,y)}catch{let E=G_(b),I=ir.base.fromBase58Check(e).slice(1);return Kf(b,I)||Kf(E,I)}return Kf(m,y)}ln.verifyWithAddress=pA;var e0={P2WPKH:"p2wpkh",P2SH_P2WPKH:"p2sh(p2wpkh)"};function F_(e){let t=ir.base.bech32.decode(e),r=ir.base.bech32.fromWords(t.words.slice(1));return p.Buffer.from(r)}function G_(e){let t=p.Buffer.concat([p.Buffer.from("0014","hex"),e]);return p.Buffer.from(ir.base.hash160(t))}function Kf(e,t){if(!p.Buffer.isBuffer(e)||!p.Buffer.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return!0;if(typeof e.equals=="function")return e.equals(t);if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}});var si=H(lt=>{w();S();var bA=lt&&lt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),gA=lt&&lt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),yA=lt&&lt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&bA(t,e,r);return gA(t,e),t};Object.defineProperty(lt,"__esModule",{value:!0});lt.convert2UtxoTx=lt.number2Hex=lt.TBtcWallet=lt.BtcWallet=lt.BITCOIN_MESSAGE_BIP0322_SIMPLE=lt.BITCOIN_MESSAGE_ECDSA=void 0;var $=he(),W_=ri(),Ff=he(),F=yA(hn()),ke=hn();lt.BITCOIN_MESSAGE_ECDSA=0;lt.BITCOIN_MESSAGE_BIP0322_SIMPLE=1;var Gf=class extends $.BaseWallet{network(){return F.networks.bitcoin}async getDerivedPath(t){return t.segwitType?t.segwitType==$.segwitType.SEGWIT_NESTED?`m/84'/0'/0'/0/${t.index}`:t.segwitType==$.segwitType.SEGWIT_NESTED_49?`m/49'/0'/0'/0/${t.index}`:t.segwitType==$.segwitType.SEGWIT_NATIVE?`m/84'/0'/0'/0/${t.index}`:t.segwitType==$.segwitType.SEGWIT_TAPROOT?`m/86'/0'/0'/0/${t.index}`:Promise.reject($.DerivePathError):`m/44'/0'/0'/0/${t.index}`}async validPrivateKey(t){let r;try{let{version:i}=F.wif.decode(t.privateKey);r=i===this.network().wif}catch{r=!1}let n={isValid:r,privateKey:t.privateKey};return Promise.resolve(n)}async getNewAddress(t){try{let r=this.network(),n=t.privateKey,i=t.addressType||"Legacy",s=F.wif2Public(n,r),o;i==="Legacy"?o=F.payments.p2pkh({pubkey:s,network:r}).address:i==="segwit_native"?o=F.payments.p2wpkh({pubkey:s,network:r}).address:i==="segwit_nested"?o=F.payments.p2sh({redeem:F.payments.p2wpkh({pubkey:s,network:r})}).address:i==="segwit_taproot"&&(o=F.payments.p2tr({internalPubkey:s.slice(1),network:r}).address);let a={address:o||"",publicKey:Ff.base.toHex(i==="segwit_taproot"?s.slice(1):s),compressedPublicKey:Ff.base.toHex(s)};return Promise.resolve(a)}catch{return Promise.reject($.NewAddressError)}}async validAddress(t){let r=!1,n=this.network();try{F.address.toOutputScript(t.address,n)&&(r=!0)}catch{}t.addressType&&(r=t.addressType===F.getAddressType(t.address,n));let i={isValid:r,address:t.address};return Promise.resolve(i)}async signTransaction(t){let r=t.data.type||0;if(r===F.BtcXrcTypes.INSCRIBE)try{return Promise.resolve(F.inscribe(this.network(),t.data))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT)try{return Promise.resolve(F.psbtSign(t.data.psbt,t.privateKey,this.network()))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_DECODE)try{return Promise.resolve(F.psbtDecode(t.data.psbt,this.network()))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_UNSIGNED_LIST)try{return Promise.resolve(F.generateMPCUnsignedListingPSBT(t.data.psbt,t.data.publicKey,this.network()))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_SIGNED_LIST)try{return Promise.resolve(F.generateMPCSignedListingPSBT(t.data.psbt,t.data.publicKey,t.data.signature,this.network()))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_UNSIGNED_BUY)try{return Promise.resolve(F.generateMPCUnsignedBuyingPSBT(t.data.psbt,t.data.publicKey,this.network(),t.data.batchSize))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_SIGNED_BUY)try{return Promise.resolve(F.generateMPCSignedBuyingTx(t.data.psbt,t.data.publicKey,t.data.signatureList,this.network(),t.data.batchSize))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_UNSIGNED)try{return Promise.resolve(F.generateMPCUnsignedPSBT(t.data.psbt,t.data.publicKey,this.network()))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_MPC_SIGNED)try{return Promise.resolve(F.generateMPCSignedPSBT(t.data.psbt,t.data.publicKey,t.data.signatureList,this.network()))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_KEY_SCRIPT_PATH)try{return Promise.resolve(F.signPsbtWithKeyPathAndScriptPath(t.data.psbt,t.privateKey,this.network(),{autoFinalized:t.data.autoFinalized,toSignInputs:t.data.toSignInputs}))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.PSBT_KEY_SCRIPT_PATH_BATCH)try{return Promise.resolve(F.signPsbtWithKeyPathAndScriptPathBatch(t.data.psbtHexs,t.privateKey,this.network(),t.data.options))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.SRC20)try{return Promise.resolve(F.srcInscribe(this.network(),t.data))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.RUNE)try{let n=new ke.RuneWallet;return this.network()===ke.networks.testnet&&(n=new ke.RuneTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.RUNEMAIN)try{let n=new ke.RuneMainWallet;return this.network()===ke.networks.testnet&&(n=new ke.RuneMainTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.ARC20)try{let n=new ke.AtomicalWallet;return this.network()===ke.networks.testnet&&(n=new ke.AtomicalTestWallet),Promise.resolve(n.signTransaction(t))}catch{return Promise.reject($.SignTxError)}else if(r===F.BtcXrcTypes.CAT20){let n=new ke.CatWallet;try{return Promise.resolve(n.signTransaction(t))}catch{return Promise.reject($.SignTxError)}}else if(r===F.BtcXrcTypes.PSBT_RUNEMAIN)try{let n=new ke.RuneMainWallet;return this.network()===ke.networks.testnet&&(n=new ke.RuneMainTestWallet),Promise.resolve(n.buildPsbt(t))}catch{return Promise.reject($.SignTxError)}else{let n=null;try{let i=t.privateKey,s=Oc(t.data);return n=F.signBtc(s,i,this.network()),Promise.resolve(n)}catch{return Promise.reject($.SignTxError)}}}getRandomPrivateKey(){try{let t=this.network();for(;;){let r=Ff.base.randomBytes(32);if((0,$.secp256k1SignTest)(r)){let n=F.private2Wif(r,t);return Promise.resolve(n)}}}catch{return Promise.reject($.GenPrivateKeyError)}}getDerivedPrivateKey(t){let r=this.network();return W_.bip39.mnemonicToSeedV2(t.mnemonic).then(n=>{let i=W_.bip32.fromSeedV2(n,t.hdPath);if(!i.privateKey)return Promise.reject($.GenPrivateKeyError);let s=F.private2Wif(p.Buffer.from(i.privateKey),r);return Promise.resolve(s)}).catch(n=>Promise.reject($.GenPrivateKeyError))}getAddressByPublicKey(t){try{let r=this.network(),n=Ff.base.fromHex(t.publicKey);if(t.addressType){if(t.addressType==="Legacy")return Promise.resolve(F.payments.p2pkh({pubkey:n,network:r}).address);if(t.addressType==="segwit_nested")return Promise.resolve(F.payments.p2sh({redeem:F.payments.p2wpkh({pubkey:n,network:r})}).address);if(t.addressType==="segwit_native")return Promise.resolve(F.payments.p2wpkh({pubkey:n,network:r}).address);if(t.addressType==="segwit_taproot")return Promise.resolve(F.payments.p2tr({internalPubkey:n.slice(1),network:r}).address)}else{let i=[];return i.push({addressType:"Legacy",address:F.payments.p2pkh({pubkey:n,network:r}).address}),i.push({addressType:"segwit_nested",address:F.payments.p2sh({redeem:F.payments.p2wpkh({pubkey:n,network:r})}).address}),i.push({addressType:"segwit_native",address:F.payments.p2wpkh({pubkey:n,network:r}).address}),Promise.resolve(i)}}catch{}return Promise.reject($.NewAddressError)}getMPCRawTransaction(t){try{let r=Oc(t.data),n=[],s={raw:F.signBtc(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject($.GetMpcRawTransactionError)}}getMPCTransaction(t){try{let r=F.getMPCTransaction(t.raw,t.sigs,!1);return Promise.resolve(r)}catch{return Promise.reject($.GetMpcTransactionError)}}async getMPCRawMessage(t){try{let r=await this.signMessage0(t);return Promise.resolve({hash:r})}catch{return Promise.reject($.GetMpcRawTransactionError)}}async getMPCSignedMessage(t){try{return Promise.resolve(F.message.getMPCSignedMessage(t.hash,t.sigs,t.publicKey))}catch{return Promise.reject($.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=t.data.type||0,n=Oc(t.data);if(r===2){let i=F.signBtc(n,"",this.network(),void 0,!0,!0),s=n.dustSize||546;if(parseInt(i)>=s){let a={address:n.address,amount:parseInt(i),bip32Derivation:n.bip32Derivation};n.outputs.push(a)}let o=F.buildPsbt(n,this.network());return Promise.resolve(o)}else{let i=F.signBtc(n,"",this.network(),void 0,!0);return Promise.resolve(i)}}catch{return Promise.reject($.GetHardwareRawTransactionError)}}async calcTxHash(t){try{return Promise.resolve(F.Transaction.fromHex(t.data).getId())}catch{return Promise.reject($.CalcTxHashError)}}async signMessage(t){if(!t.privateKey)return Promise.reject(`${$.InvalidPrivateKeyError}: cannot be empty`);let{isValid:r}=await this.validPrivateKey({privateKey:t.privateKey});return r?this.signMessage0(t):Promise.reject(`${$.InvalidPrivateKeyError}: not valid private key`)}signMessage0(t){try{let r=t.data,n;return r.type===lt.BITCOIN_MESSAGE_ECDSA?n=F.message.sign(t.privateKey,r.message,this.network()):n=F.bip0322.signSimple(r.message,r.address,t.privateKey,this.network()),Promise.resolve(n)}catch{return Promise.reject($.SignMsgError)}}async signCommonMsg(t){let r=await this.getNewAddress({privateKey:t.privateKey,addressType:t.addressType}),n=r.compressedPublicKey?r.compressedPublicKey:r.publicKey;n.startsWith("0x")&&(n=n.substring(2));let i=(0,ke.privateKeyFromWIF)(t.privateKey,this.network());return super.signCommonMsg({privateKey:t.privateKey,privateKeyHex:i,publicKey:n,addressType:t.addressType,message:t.message,signType:$.SignType.Secp256k1})}async verifyMessage(t){try{let r=t.data;if(r.type===lt.BITCOIN_MESSAGE_ECDSA){let n=F.message.verify(r.publicKey,r.message,t.signature);return Promise.resolve(n)}else{let n=F.bip0322.verifySimple(r.message,r.address,t.signature,r.publicKey,this.network());return Promise.resolve(n)}}catch{return Promise.reject($.SignMsgError)}}static async extractPsbtTransaction(t){try{return Promise.resolve(F.extractPsbtTransaction(t))}catch{return Promise.reject($.SignMsgError)}}async validSignedTransaction(t){try{t.data&&t.data.forEach(n=>n.value=n.amount);let r=F.ValidSignedTransaction(t.tx,t.data,this.network());return Promise.resolve((0,$.jsonStringifyUniform)(r))}catch{return Promise.reject($.validSignedTransactionError)}}async estimateFee(t){try{let r=t.data.type||0;if(r===F.BtcXrcTypes.INSCRIBE)return Promise.reject($.EstimateFeeError);if(r===F.BtcXrcTypes.PSBT)return Promise.reject($.EstimateFeeError);if(r===F.BtcXrcTypes.RUNE)try{let n=new ke.RuneWallet;return this.network()===ke.networks.testnet&&(n=new ke.RuneTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject($.EstimateFeeError)}else if(r===F.BtcXrcTypes.RUNEMAIN)try{let n=new ke.RuneMainWallet;return this.network()===ke.networks.testnet&&(n=new ke.RuneMainTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject($.EstimateFeeError)}else if(r===F.BtcXrcTypes.ARC20)try{let n=new ke.AtomicalWallet;return this.network()===ke.networks.testnet&&(n=new ke.AtomicalTestWallet),Promise.resolve(n.estimateFee(t))}catch{return Promise.reject($.EstimateFeeError)}else if(r===F.BtcXrcTypes.CAT20)try{let n=new ke.CatWallet;return Promise.resolve(n.estimateFee(t))}catch{return Promise.reject($.EstimateFeeError)}else{let n=Oc(t.data),i=F.estimateBtcFee(n,this.network());return Promise.resolve(i)}}catch{return Promise.reject($.EstimateFeeError)}}static async oneKeyBuildBtcTx(t){try{return Promise.resolve(F.oneKeyBuildBtcTx(t))}catch{return Promise.reject($.SignTxError)}}async buildPsbt(t){if((t.data.type||0)===F.BtcXrcTypes.RUNEMAIN)try{let n=new ke.RuneMainWallet;return this.network()===ke.networks.testnet&&(n=new ke.RuneMainTestWallet),Promise.resolve(n.buildPsbt(t))}catch{return Promise.reject($.SignTxError)}else{let n=null;return Promise.resolve(n)}}};lt.BtcWallet=Gf;var r0=class extends Gf{network(){return F.networks.testnet}};lt.TBtcWallet=r0;function mA(e,t){let r=e.toString(16),n=t-r.length;if(n>0)for(let i=0;i<n;i++)r="0"+r;return r}lt.number2Hex=mA;function Oc(e){let t=(0,$.cloneObject)(e);return t.inputs.forEach(r=>{r.amount=(0,$.convert2Number)(r.amount)}),t.outputs.forEach(r=>{r.amount=(0,$.convert2Number)(r.amount)}),t.omni&&(t.omni.amount=(0,$.convert2Number)(t.omni.amount)),e.dustSize&&(t.dustSize=(0,$.convert2Number)(e.dustSize)),t}lt.convert2UtxoTx=Oc});var X_=H(Ii=>{w();S();var _A=Ii&&Ii.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),vA=Ii&&Ii.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),wA=Ii&&Ii.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&_A(t,e,r);return vA(t,e),t};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.BchWallet=void 0;var ka=he(),z_=he(),Bc=si(),Le=wA(hn()),n0=class extends Bc.BtcWallet{network(){return{...super.network(),bech32:""}}async getDerivedPath(t){return`m/44'/145'/0'/0/${t.index}`}async getNewAddress(t){try{let r=this.network(),n=t.privateKey,i=Le.wif2Public(n,r),a={address:Le.GetBitcashP2PkHAddressByPublicKey(i).replace("bitcoincash:","")||"",publicKey:z_.base.toHex(i)};return Promise.resolve(a)}catch{return Promise.reject(ka.NewAddressError)}}async validAddress(t){let r=!1;try{let i=this.network();Le.address.toOutputScript(t.address,i)&&(r=!0)}catch{}r||(r=Le.ValidateBitcashP2PkHAddress(t.address));let n={isValid:r,address:t.address};return Promise.resolve(n)}async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Bc.convert2UtxoTx)(t.data);return i.outputs.forEach(s=>{Le.isCashAddress(s.address)&&(s.address=Le.convert2LegacyAddress(s.address,this.network()))}),Le.isCashAddress(i.address)&&(i.address=Le.convert2LegacyAddress(i.address,this.network())),r=Le.signBch(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(ka.SignTxError)}}async estimateFee(t){try{let r=(0,Bc.convert2UtxoTx)(t.data);r.outputs.forEach(i=>{Le.isCashAddress(i.address)&&(i.address=Le.convert2LegacyAddress(i.address,this.network()))}),Le.isCashAddress(r.address)&&(r.address=Le.convert2LegacyAddress(r.address,this.network()));let n=Le.estimateBchFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(ka.EstimateFeeError)}}getMPCRawTransaction(t){try{let r=(0,Bc.convert2UtxoTx)(t.data);r.outputs.forEach(o=>{Le.isCashAddress(o.address)&&(o.address=Le.convert2LegacyAddress(o.address,this.network()))}),Le.isCashAddress(r.address)&&(r.address=Le.convert2LegacyAddress(r.address,this.network()));let n=[],s={raw:Le.signBch(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(ka.GetMpcRawTransactionError)}}getAddressByPublicKey(t){let r=z_.base.fromHex(t.publicKey),n=Le.GetBitcashP2PkHAddressByPublicKey(r);return Promise.resolve(n.replace("bitcoincash:",""))}getMPCTransaction(t){try{let r=Le.getMPCTransaction(t.raw,t.sigs,!0);return Promise.resolve(r)}catch{return Promise.reject(ka.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=(0,Bc.convert2UtxoTx)(t.data);r.outputs.forEach(i=>{Le.isCashAddress(i.address)&&(i.address=Le.convert2LegacyAddress(i.address,this.network()))}),Le.isCashAddress(r.address)&&(r.address=Le.convert2LegacyAddress(r.address,this.network()));let n=Le.signBch(r,"",this.network(),void 0,!0);return Promise.resolve(n)}catch{return Promise.reject(ka.GetHardwareRawTransactionError)}}};Ii.BchWallet=n0});var Y_=H(Oi=>{w();S();var SA=Oi&&Oi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),xA=Oi&&Oi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),PA=Oi&&Oi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&SA(t,e,r);return xA(t,e),t};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.BsvWallet=void 0;var Mc=he(),Cc=si(),kc=PA(hn()),i0=class extends Cc.BtcWallet{network(){return{...super.network(),bech32:""}}async getDerivedPath(t){return`m/44'/236'/0'/0/${t.index}`}async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Cc.convert2UtxoTx)(t.data);return r=kc.signBch(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(Mc.SignTxError)}}async estimateFee(t){try{let r=(0,Cc.convert2UtxoTx)(t.data),n=kc.estimateBchFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(Mc.EstimateFeeError)}}getMPCRawTransaction(t){try{let r=(0,Cc.convert2UtxoTx)(t.data),n=[],s={raw:kc.signBch(r,"",this.network(),n),hash:n};return Promise.resolve(s)}catch{return Promise.reject(Mc.GetMpcRawTransactionError)}}getMPCTransaction(t){try{let r=kc.getMPCTransaction(t.raw,t.sigs,!0);return Promise.resolve(r)}catch{return Promise.reject(Mc.GetMpcTransactionError)}}getHardWareRawTransaction(t){try{let r=(0,Cc.convert2UtxoTx)(t.data),n=kc.signBch(r,"",this.network(),void 0,!0);return Promise.resolve(n)}catch{return Promise.reject(Mc.GetHardwareRawTransactionError)}}};Oi.BsvWallet=i0});var $_=H(qr=>{w();S();var TA=qr&&qr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),EA=qr&&qr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),AA=qr&&qr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&TA(t,e,r);return EA(t,e),t};Object.defineProperty(qr,"__esModule",{value:!0});qr.DogeWallet=qr.dogeCoin=void 0;var Vf=AA(hn()),Wf=he(),IA=si();qr.dogeCoin={messagePrefix:`Dogecoin Signed Message:
`,bech32:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158};var s0=class extends IA.BtcWallet{network(){return qr.dogeCoin}async getDerivedPath(t){return`m/44'/3'/0'/0/${t.index}`}async signTransaction(t){let r=t.data.type||0;if(r===1)try{return Promise.resolve(Vf.dogInscribe(qr.dogeCoin,t.data))}catch{return Promise.reject(Wf.SignTxError)}else if(r===2)try{return Promise.resolve(Vf.psbtSign(t.data.psbt,t.privateKey,this.network(),t.data.maximumFeeRate?t.data.maximumFeeRate:1e5))}catch{return Promise.reject(Wf.SignTxError)}else return super.signTransaction(t)}signMessage0(t){try{let r=t.data,n=Vf.message.sign(t.privateKey,r.message,this.network(),qr.dogeCoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Wf.SignMsgError)}}async verifyMessage(t){try{let r=t.data,n=Vf.message.verify(r.publicKey,r.message,t.signature,qr.dogeCoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Wf.SignMsgError)}}};qr.DogeWallet=s0});var J_=H(zr=>{w();S();var OA=zr&&zr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),BA=zr&&zr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),MA=zr&&zr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&OA(t,e,r);return BA(t,e),t};Object.defineProperty(zr,"__esModule",{value:!0});zr.LtcWallet=zr.litecoin=void 0;var Ha=he(),CA=si(),Z_=MA(hn());zr.litecoin={messagePrefix:`Litecoin Signed Message:
`,bech32:"ltc",bip32:{public:27108450,private:27106558},pubKeyHash:48,scriptHash:50,wif:176};var o0=class extends CA.BtcWallet{network(){return zr.litecoin}async getDerivedPath(t){return t.segwitType?t.segwitType==Ha.segwitType.SEGWIT_NESTED?`m/84'/2'/0'/0/${t.index}`:t.segwitType==Ha.segwitType.SEGWIT_NESTED_49?`m/49'/2'/0'/0/${t.index}`:t.segwitType==Ha.segwitType.SEGWIT_NATIVE?`m/84'/2'/0'/0/${t.index}`:Promise.reject(Ha.DerivePathError):`m/44'/2'/0'/0/${t.index}`}signMessage0(t){try{let r=t.data,n=Z_.message.sign(t.privateKey,r.message,this.network(),zr.litecoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Ha.SignMsgError)}}async verifyMessage(t){try{let r=t.data,n=Z_.message.verify(r.publicKey,r.message,t.signature,zr.litecoin.messagePrefix);return Promise.resolve(n)}catch{return Promise.reject(Ha.SignMsgError)}}};zr.LtcWallet=o0});var Q_=H(Vn=>{w();S();var kA=Vn&&Vn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),HA=Vn&&Vn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),NA=Vn&&Vn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&kA(t,e,r);return HA(t,e),t};Object.defineProperty(Vn,"__esModule",{value:!0});Vn.UsdtTestWallet=Vn.UsdtWallet=void 0;var Na=he(),Bi=si(),Ra=NA(hn()),zf=class extends Bi.BtcWallet{async signTransaction(t){let r=null;try{let n=t.privateKey,i=(0,Bi.convert2UtxoTx)(t.data);if(!i.omni)return Promise.reject(Na.SignTxError);let s=(0,Bi.number2Hex)(i.omni.coinType||31,8),o=(0,Bi.number2Hex)(i.omni.amount,16),c={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+s+o};return i.outputs.push(c),r=Ra.signBtc(i,n,this.network()),Promise.resolve(r)}catch{return Promise.reject(Na.SignTxError)}}async estimateFee(t){try{let r=(0,Bi.convert2UtxoTx)(t.data);if(!r.omni)return Promise.reject(Na.EstimateFeeError);let n=(0,Bi.number2Hex)(r.omni.coinType||31,8),i=(0,Bi.number2Hex)(r.omni.amount,16),o={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+n+i};r.outputs.push(o);let a=Ra.estimateBtcFee(r,this.network());return Promise.resolve(a)}catch{return Promise.reject(Na.EstimateFeeError)}}getHardWareRawTransaction(t){try{let r=t.data.type||0,n=(0,Bi.convert2UtxoTx)(t.data);if(!n.omni)return Promise.reject(Na.SignTxError);let i=(0,Bi.number2Hex)(n.omni.coinType||31,8),s=(0,Bi.number2Hex)(n.omni.amount,16),a={address:"",amount:0,omniScript:"6a146f6d6e6900000000"+i+s};n.outputs.push(a);let c;if(r===2){let u=Ra.signBtc(n,"",this.network(),void 0,!0,!0),d={address:n.address,amount:parseInt(u),bip32Derivation:n.bip32Derivation};n.outputs.push(d),c=Ra.buildPsbt(n,this.network())}else c=Ra.signBtc(n,"",this.network(),void 0,!0);return Promise.resolve(c)}catch{return Promise.reject(Na.GetHardwareRawTransactionError)}}};Vn.UsdtWallet=zf;var a0=class extends zf{network(){return Ra.networks.testnet}};Vn.UsdtTestWallet=a0});var u0=H(Je=>{w();S();var RA=Je&&Je.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),UA=Je&&Je.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),qA=Je&&Je.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&RA(t,e,r);return UA(t,e),t};Object.defineProperty(Je,"__esModule",{value:!0});Je.buildRuneMainMintOp=Je.buildRuneMainMintData=Je.buildRuneData=Je.encodeToVecV2=Je.toVarIntV2=Je.fromVarInt=Je.encodeToVec=Je.toVarInt=void 0;var c0=qA(Gt()),Hc=Zs(),ev=Yf(),LA=he(),tv=BigInt(0),kU=BigInt(2),HU=BigInt(4),NU=BigInt(6),RU=BigInt(8),UU=BigInt(10),qU=BigInt(12),LU=BigInt(14),KU=BigInt(16),DU=BigInt(118),Xf=BigInt(20),rv=BigInt(22),jU=BigInt(126),FU=BigInt(1),GU=BigInt(3),VU=BigInt(5),WU=BigInt(127);function KA(e){let t=[];return Ua(e,t),new Uint8Array(t)}Je.toVarInt=KA;function Ua(e,t){let r=18,n=new Array(19).fill(0);for(n[r]=Number(e&BigInt(127));e>BigInt(127);)e=e/BigInt(128)-BigInt(1),r--,n[r]=Number(e&BigInt(255))|128;t.push(...n.slice(r))}Je.encodeToVec=Ua;function DA(e){let t=[];return sr(e,t),new Uint8Array(t)}Je.toVarIntV2=DA;function sr(e,t){for(;e>>7n>0n;)t.push(Number(e&0x7fn|0x80n)),e>>=7n;return t.push(Number(e&0x7fn)),t}Je.encodeToVecV2=sr;function jA(e){let t=BigInt(0),r=0;for(;;){let n=BigInt(e[r]);if(n<BigInt(128))return[t+n,r+1];if(t+=n-BigInt(127),t=t*BigInt(128),r++,r>=e.length)throw new Error("Varint decoding error: buffer overflow")}}Je.fromVarInt=jA;function FA(e,t){let r=[];for(let s of t)typeof s.amount=="string"&&(s.amount=BigInt(s.amount));if(t.length>0){Ua(tv,r),t.sort((o,a)=>o.id-a.id);let s=0;for(let o of t)Ua(BigInt(o.id-s),r),Ua(BigInt(o.amount),r),Ua(BigInt(o.output),r),s=o.id}let n;return e?n="R":n="RUNE_TEST",c0.compile([Hc.OPS.OP_RETURN,p.Buffer.from(n),p.Buffer.from(r)])}Je.buildRuneData=FA;function GA(e,t,r,n,i,s){let o=[];for(let c of t)typeof c.amount=="string"&&(c.amount=BigInt(c.amount));if(i!=null&&i&&t[0].block!=null&&(sr(Xf,o),sr(BigInt(t[0].block),o),sr(Xf,o),sr(BigInt(t[0].id),o)),r&&(sr(rv,o),sr(BigInt(n),o)),t.length>0){sr(tv,o),t.sort((d,f)=>d.block===f.block?d.id<f.id?-1:d.id>f.id?1:0:d.block-f.block);let c=0,u=0;for(let d of t)sr(BigInt(d.block-u),o),sr(BigInt(d.id-c),o),sr(BigInt(d.amount),o),sr(BigInt(d.output),o),c=d.id,u=d.block}if(o.length>80)throw new Error(JSON.stringify({errCode:ev.ErrCodeOpreturnExceeds,date:{payloadLenth:o.length}}));return c0.compile([Hc.OPS.OP_RETURN,Hc.OPS.OP_13,p.Buffer.from(o)])}Je.buildRuneMainMintData=GA;function VA(e,t,r,n){let i=[],s=parseInt(e.split(":")[0]),o=parseInt(e.split(":")[1]);if(n!=null&&n&&o!=null&&(sr(Xf,i),sr(BigInt(s),i),sr(Xf,i),sr(BigInt(o),i)),t&&(sr(rv,i),sr(BigInt(r),i)),i.length>80)throw new Error(JSON.stringify({errCode:ev.ErrCodeOpreturnExceeds,date:{payloadLenth:i.length}}));let a=c0.compile([Hc.OPS.OP_RETURN,Hc.OPS.OP_13,p.Buffer.from(i)]);return{address:"",amount:0,omniScript:LA.base.toHex(a)}}Je.buildRuneMainMintOp=VA});var sv=H(Wn=>{w();S();var WA=Wn&&Wn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zA=Wn&&Wn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),XA=Wn&&Wn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&WA(t,e,r);return zA(t,e),t};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.RuneTestWallet=Wn.RuneWallet=void 0;var f0=he(),YA=si(),iv=XA(hn()),nv=hn(),$A=u0(),ZA=he(),$f=class extends YA.BtcWallet{convert2RuneTx(t){let r=(0,f0.cloneObject)(t);for(let f of r.inputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(m.amount=BigInt(m.amount))}for(let f of r.outputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(m.amount=BigInt(m.amount))}let n=r.inputs,i=new Map;for(let f of n){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b){let y=m.id,_=BigInt(m.amount);if(y==null||_==null)continue;let E=i.get(y);E==null?i.set(y,_):i.set(y,BigInt(E)+BigInt(_))}}let s=r.outputs,o=new Map;for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(b.amount);if(m==null||y==null)continue;let _=o.get(m);_==null?o.set(m,y):o.set(m,BigInt(_)+BigInt(y))}}let a=!1;for(let f of i.keys()){let b=i.get(f),m=o.get(f);(b!=null&&m!=null&&b>m||b!=null&&m==null)&&(a=!0),a=!0}let c=0,u=[];if(a){let f={address:r.address,amount:546};u.push(f),c++}let d=[];for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(b.amount);if(m==null||y==null)continue;let _={id:parseInt("0x"+m),amount:BigInt(y),output:c};d.push(_)}f.data=null,u.push(f),c++}return{inputs:r.inputs,outputs:u,address:r.address,feePerB:r.feePerB,runeData:{edicts:d,etching:r.runeData.etching,burn:r.runeData.burn}}}async signTransaction(t){let r=this.network(),n=null;try{let i=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let s=this.convert2RuneTx(t.data),o=this.getOpReturnOutput(r,s.runeData);return s.outputs.push(o),n=(0,nv.signBtc)(s,i,r),Promise.resolve(n)}catch{return Promise.reject(f0.SignTxError)}}getOpReturnOutput(t,r){let n=!1;nv.networks.bitcoin===t&&(n=!0),r.edicts==null&&(r.edicts=[]);let i=(0,$A.buildRuneData)(n,r.edicts);return{address:"",amount:0,omniScript:ZA.base.toHex(i)}}async estimateFee(t){try{if(!t.data.runeData)return Promise.reject("missing runeData");let r=this.convert2RuneTx(t.data),n=this.getOpReturnOutput(this.network(),r.runeData);r.outputs.push(n);let i=iv.estimateBtcFee(r,this.network());return Promise.resolve(i)}catch{return Promise.reject(f0.EstimateFeeError)}}};Wn.RuneWallet=$f;var d0=class extends $f{network(){return iv.networks.testnet}};Wn.RuneTestWallet=d0});var uv=H(Ke=>{w();S();Object.defineProperty(Ke,"__esModule",{value:!0});Ke.isUpper=Ke.commitment=Ke.Tag=Ke.Flag=Ke.removeSpacers=Ke.getSpacersVal=Ke.applySpacers=Ke.decodeLEB128=Ke.encodeLEB128=Ke.base26Decode=Ke.base26Encode=void 0;var JA=he();function ov(e){let t=0n;for(let r=0;r<e.length;r++){let n=BigInt(e.charCodeAt(r)-"A".charCodeAt(0)),i=BigInt(e.length)-1n-BigInt(r);if(i==0n)t+=n;else{let s=26n**i;t+=s*(n+1n)}}return t}Ke.base26Encode=ov;function QA(e){if(e===340282366920938463463374607431768211455n)return"BCGDENLQRQWDSLRUGSNLBTMFIJAV";e+=1n;let t=[];for(;e>0;){let r=(e-1n)%26n;t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Number(r))),e=(e-1n)/26n}return t.reverse(),t.join("")}Ke.base26Decode=QA;function eI(e){let t=[],r=!0;for(;r;){let n=Number(e&BigInt(127));e>>=BigInt(7),e===BigInt(0)?r=!1:n|=128,t.push(n)}return t}Ke.encodeLEB128=eI;function tI(e){let t=BigInt(0);for(let r=0;r<e.length;r++){let n=BigInt(e[r]);if(r>18)throw new Error("Overlong");let i=n&BigInt(127);if(r==18&&(i&BigInt(124))!=BigInt(0))throw new Error("Overflow");if(t|=i<<BigInt(7)*BigInt(r),(n&BigInt(128))==BigInt(0))return{n:t,len:r+1}}throw new Error("Unterminated")}Ke.decodeLEB128=tI;function rI(e,t){let r="";for(let n=0;n<e.length;n++)r+=e.charAt(n),t>0&&((t&1)===1&&(r+="\u2022"),t>>=1);return r}Ke.applySpacers=rI;function nI(e){let t=0,r=0;for(let n=0;n<e.length;n++){let i=e.charAt(n);(i==="\u2022"||i==".")&&(t+=1<<n-1-r,r++)}return t}Ke.getSpacersVal=nI;function av(e){return e.replace(/[.]+/g,"")}Ke.removeSpacers=av;var iI;(function(e){e[e.Etching=0]="Etching",e[e.Terms=1]="Terms",e[e.Turbo=2]="Turbo",e[e.Cenotaph=127]="Cenotaph"})(iI=Ke.Flag||(Ke.Flag={}));var sI;(function(e){e[e.Body=0]="Body",e[e.Flags=2]="Flags",e[e.Rune=4]="Rune",e[e.Premine=6]="Premine",e[e.Cap=8]="Cap",e[e.Amount=10]="Amount",e[e.HeightStart=12]="HeightStart",e[e.HeightEnd=14]="HeightEnd",e[e.OffsetStart=16]="OffsetStart",e[e.OffsetEnd=18]="OffsetEnd",e[e.Mint=20]="Mint",e[e.Pointer=22]="Pointer",e[e.Cenotaph=126]="Cenotaph",e[e.Divisibility=1]="Divisibility",e[e.Spacers=3]="Spacers",e[e.Symbol=5]="Symbol",e[e.Nop=127]="Nop"})(sI=Ke.Tag||(Ke.Tag={}));function oI(e){let t;if(typeof e.value=="string"){let n=av(e.value);if(!cv(n))throw new Error("invalid rune");t=ov(n)}else t=e.value;let r=t.toString(16);return r.length%2===1&&(r="0"+r),JA.base.fromHex(r).reverse()}Ke.commitment=oI;function cv(e){return/^[A-Z]+$/.test(e)}Ke.isUpper=cv});var mv=H(we=>{w();S();var aI=we&&we.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),cI=we&&we.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Zf=we&&we.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&aI(t,e,r);return cI(t,e),t};Object.defineProperty(we,"__esModule",{value:!0});we.buildRuneMainDeployData=we.inscribe=we.runesMainInscribe=we.checkEtching=we.MAX_SPACERS=we.uint64Max=we.uint128Max=we.RunesMainInscriptionTool=void 0;var et=Zf(nn()),uI=ri(),Xs=he(),fI=Zf(xi()),dI=Zf(wr()),lI=Ls(),Mi=rn(),hI=Zf(Gt()),fv=ba(),Qe=uv(),bv=uI.signUtil.schnorr.secp256k1.schnorr,dv=2,lv=4294967293,pI=546,bI=546,hv=4e6/10,So=class{constructor(){this.network=et.networks.bitcoin,this.inscriptionTxCtxDataList=[],this.revealTxs=[],this.commitTx=new et.Transaction,this.commitTxPrevOutputFetcher=[],this.revealTxPrevOutputFetcher=[],this.mustCommitTxFee=0,this.mustRevealTxFees=[],this.commitAddrs=[]}static newInscriptionTool(t,r){let n=new So;n.network=t;let i=r.revealOutValue||pI,s=r.minChangeValue||bI,o=r.runeData.useDefaultOutput||!1,a=r.runeData.defaultOutput||0,c=r.commitTxPrevOutputList[0].privateKey;if(!r.runeData.etching||!r.runeData.revealAddr)throw new Error("etching is null");if(!gv(r.runeData.etching))throw new Error("invalid etching parameter");let u=r.runeData.etching,d=(0,Qe.commitment)(u.rune),f=yv(u,o,a);r.runeData.etching.contentType&&r.runeData.etching.body?n.inscriptionTxCtxDataList.push(_I(t,{contentType:r.runeData.etching.contentType,body:r.runeData.etching.body,revealAddr:r.runeData.revealAddr},c,d)):n.inscriptionTxCtxDataList.push(mI(t,c,r.runeData.revealAddr,d));let b=n.buildEmptyRevealTx(t,i,r.revealFeeRate,f);return n.buildCommitTx(t,r.commitTxPrevOutputList,r.changeAddress,b,r.commitFeeRate,s)||(n.signCommitTx(r.commitTxPrevOutputList),n.completeRevealTx()),n}buildEmptyRevealTx(t,r,n,i){let s=0,o=[],a=[],c=[];return this.inscriptionTxCtxDataList.forEach((u,d)=>{let f=new et.Transaction;f.version=dv,f.addInput(p.Buffer.alloc(32),d,lv),i&&f.addOutput(i,0),f.addOutput(u.revealPkScript,r);let b=p.Buffer.alloc(64),m=p.Buffer.alloc(33),y=[];y.push(b),y.push(u.inscriptionScript),y.push(m);let _=Math.floor((f.byteLength()+Math.floor(((0,lI.vectorSize)(y)+2+3)/4))*n),E=r+_;u.revealTxPrevOutput={pkScript:u.commitTxAddressPkScript,value:E},s+=E,o.push(f),a.push(_),c.push(u.commitTxAddress)}),this.revealTxs=o,this.mustRevealTxFees=a,this.commitAddrs=c,s}buildCommitTx(t,r,n,i,s,o){let a=0,c=new et.Transaction;c.version=dv,r.forEach(y=>{let _=Xs.base.reverseBuffer(Xs.base.fromHex(y.txId));c.addInput(_,y.vOut,lv),this.commitTxPrevOutputFetcher.push(y.amount),a+=y.amount}),this.inscriptionTxCtxDataList.forEach(y=>{c.addOutput(y.revealTxPrevOutput.pkScript,y.revealTxPrevOutput.value)});let u=et.address.toOutputScript(n,t);c.addOutput(u,0);let d=c.clone();pv(d,r.map(y=>({...y,privateKey:""})),this.network);let f=(0,fv.countAdjustedVsize)(d,r.map(y=>y.address),t),b=Math.floor(f*s),m=a-i-b;if(m>=o)c.outs[c.outs.length-1].value=m;else{c.outs=c.outs.slice(0,c.outs.length-1),d.outs=d.outs.slice(0,d.outs.length-1);let y=(0,fv.countAdjustedVsize)(d,r.map(E=>E.address),t),_=Math.floor(y*s);if(a-i-_<0)return this.mustCommitTxFee=b,!0}return this.commitTx=c,!1}signCommitTx(t){pv(this.commitTx,t,this.network)}completeRevealTx(){this.revealTxs.forEach((t,r)=>{t.ins[0].hash=this.commitTx.getHash();let n=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.pkScript],i=[this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value];this.revealTxPrevOutputFetcher.push(this.inscriptionTxCtxDataList[r].revealTxPrevOutput.value);let s=t.hashForWitnessV1(0,n,i,et.Transaction.SIGHASH_DEFAULT,this.inscriptionTxCtxDataList[r].hash),o=p.Buffer.from(bv.sign(s,this.inscriptionTxCtxDataList[r].privateKey,Xs.base.randomBytes(32)));t.ins[0].witness=[p.Buffer.from(o),...this.inscriptionTxCtxDataList[r].witness];let a=t.weight();if(a>hv)throw new Error(`reveal(index ${r}) transaction weight greater than ${hv} (MAX_STANDARD_TX_WEIGHT): ${a}`)})}calculateFee(){let t=0;this.commitTx.ins.forEach((n,i)=>{t+=this.commitTxPrevOutputFetcher[i]}),this.commitTx.outs.forEach(n=>{t-=n.value});let r=[];return this.revealTxs.forEach((n,i)=>{let s=0;s+=this.revealTxPrevOutputFetcher[i],s-=n.outs[0].value,r.push(s)}),{commitTxFee:t,revealTxFees:r}}};we.RunesMainInscriptionTool=So;we.uint128Max=(BigInt(1)<<BigInt(128))-BigInt(1);we.uint64Max=(BigInt(1)<<BigInt(64))-BigInt(1);var gI=38;we.MAX_SPACERS=134217727;function gv(e){let t=e.premine?BigInt(e.premine):BigInt(0);if(t>we.uint128Max||t<0)return!1;if(e.terms){let r=e.terms.amount?BigInt(e.terms.amount):BigInt(0),n=e.terms.cap?BigInt(e.terms.cap):BigInt(0);if(r<0||r>we.uint128Max||n<0||n>we.uint128Max||r*n>we.uint128Max||t+r*n>we.uint128Max||e.terms.height&&(e.terms.height.start&&(e.terms.height.start<0||e.terms.height.start>we.uint64Max)||e.terms.height.end&&(e.terms.height.end<0||e.terms.height.end>we.uint64Max)))return!1}return!(e.divisibility&&(e.divisibility<0||e.divisibility>gI)||typeof e.rune.value=="string"&&((0,Qe.getSpacersVal)(e.rune.value)>we.MAX_SPACERS||(0,Qe.base26Encode)((0,Qe.removeSpacers)(e.rune.value))>we.uint128Max))}we.checkEtching=gv;function yI(e,t){let r=So.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}we.runesMainInscribe=yI;function pv(e,t,r){e.ins.forEach((n,i)=>{let s=(0,Mi.getAddressType)(t[i].address,r);if(t[i].privateKey==""){let{witness:u,script:d}=(0,Mi.fakeSign)(s);u!==void 0&&(n.witness=u),d!==void 0&&(n.script=d);return}let o=Xs.base.fromHex((0,Mi.privateKeyFromWIF)(t[i].privateKey,r)),a=Xs.base.toHex(o),c=(0,Mi.private2public)(a);if(s==="segwit_taproot"){let u=t.map(y=>et.address.toOutputScript(y.address,r)),d=t.map(y=>y.amount),f=e.hashForWitnessV1(i,u,d,et.Transaction.SIGHASH_DEFAULT),b=fI.taprootTweakPrivKey(o),m=p.Buffer.from(bv.sign(f,b,Xs.base.randomBytes(32)));n.witness=[p.Buffer.from(m)]}else if(s==="legacy"){let u=et.address.toOutputScript(t[i].address,r),d=e.hashForSignature(i,u,et.Transaction.SIGHASH_ALL),f=(0,Mi.sign)(d,a),b=et.payments.p2pkh({signature:et.script.signature.encode(f,et.Transaction.SIGHASH_ALL),pubkey:c});n.script=b.input}else{let u=dI.hash160(c),d=p.Buffer.of(25,118,169,20,...u,136,172),f=t[i].amount,b=e.hashForWitness(i,d,f,et.Transaction.SIGHASH_ALL),m=(0,Mi.sign)(b,a);n.witness=[et.script.signature.encode(m,et.Transaction.SIGHASH_ALL),c];let y=p.Buffer.of(22,0,20,...u);s==="segwit_nested"&&(n.script=y)}})}function mI(e,t,r,n){let i=Xs.base.fromHex((0,Mi.privateKeyFromWIF)(t,e)),s=(0,Mi.wif2Public)(t,e).slice(1),o=[];o.push(s);let a=et.script.OPS;o.push(a.OP_CHECKSIG),o.push(a.OP_FALSE),o.push(a.OP_IF),o.push(n),o.push(a.OP_ENDIF);let c=et.script.compile(o),u={output:c},d={output:c,redeemVersion:192},{output:f,witness:b,hash:m,address:y}=et.payments.p2tr({internalPubkey:s,scriptTree:u,redeem:d,network:e});return{privateKey:i,inscriptionScript:c,commitTxAddress:y,commitTxAddressPkScript:f,witness:b,hash:m,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:et.address.toOutputScript(r,e)}}function _I(e,t,r,n){let i=Xs.base.fromHex((0,Mi.privateKeyFromWIF)(r,e)),s=(0,Mi.wif2Public)(r,e).slice(1),o=et.script.OPS,a=[];a.push(s),a.push(o.OP_CHECKSIG),n&&n.length>0&&(a.push(n),a.push(o.OP_DROP)),a.push(o.OP_FALSE),a.push(o.OP_IF),a.push(p.Buffer.from("ord")),a.push(o.OP_DATA_1),a.push(o.OP_DATA_1),a.push(p.Buffer.from(t.contentType)),a.push(o.OP_0);let c=520,u=p.Buffer.from(t.body),d=u.length;for(let k=0;k<d;k+=c){let C=k+c;C>d&&(C=d),a.push(u.slice(k,C))}a.push(o.OP_ENDIF);let f=et.script.compile(a),b={output:f},m={output:f,redeemVersion:192},{output:y,witness:_,hash:E,address:I}=et.payments.p2tr({internalPubkey:s,scriptTree:b,redeem:m,network:e});return{privateKey:i,inscriptionScript:f,commitTxAddress:I,commitTxAddressPkScript:y,witness:_,hash:E,revealTxPrevOutput:{pkScript:p.Buffer.alloc(0),value:0},revealPkScript:et.address.toOutputScript(t.revealAddr,e)}}function vI(e,t){let r=So.newInscriptionTool(e,t);return r.mustCommitTxFee>0?{commitTx:"",revealTxs:[],commitTxFee:r.mustCommitTxFee,revealTxFees:r.mustRevealTxFees,commitAddrs:r.commitAddrs}:{commitTx:r.commitTx.toHex(),revealTxs:r.revealTxs.map(n=>n.toHex()),...r.calculateFee(),commitAddrs:r.commitAddrs}}we.inscribe=vI;function yv(e,t,r){let n=SI(e,t,r),i=wI(n),s=p.Buffer.from("6a5d","hex"),o;if(i.length<76)o=p.Buffer.alloc(1),o.writeUint8(i.length);else if(i.length<256)o=p.Buffer.alloc(2),o.writeUint8(76),o.writeUint8(i.length,1);else if(i.length<65536)o=p.Buffer.alloc(3),o.writeUint8(77),o.writeUint16LE(i.length,1);else if(i.length<4294967296)o=p.Buffer.alloc(5),o.writeUint8(78),o.writeUint32LE(i.length,1);else throw new Error("runestone too big!");return hI.compile(p.Buffer.concat([s,o,i]))}we.buildRuneMainDeployData=yv;function wI(e){let t=[];for(let[r,n]of e)for(let i of n){let s=p.Buffer.alloc(1);s.writeUInt8(r),t.push(s),t.push(p.Buffer.from((0,Qe.encodeLEB128)(i)))}return p.Buffer.concat(t)}function SI(e,t,r){let n=new Map,i=1;if(e.terms){let o=1<<Qe.Flag.Terms;i|=o}if(e.turbo){let o=1<<Qe.Flag.Turbo;i|=o}n.set(Qe.Tag.Flags,[BigInt(i)]);let s;if(typeof e.rune.value=="string"?s=(0,Qe.base26Encode)((0,Qe.removeSpacers)(e.rune.value)):s=e.rune.value,n.set(Qe.Tag.Rune,[BigInt(s)]),e.divisibility&&n.set(Qe.Tag.Divisibility,[BigInt(e.divisibility)]),e.spacers)n.set(Qe.Tag.Spacers,[BigInt(e.spacers)]);else{let o;typeof e.rune.value=="bigint"?o=0:o=(0,Qe.getSpacersVal)(e.rune.value),o!==0&&n.set(Qe.Tag.Spacers,[BigInt(o)])}if(e.symbol&&n.set(Qe.Tag.Symbol,[BigInt(e.symbol.charCodeAt(0))]),e.premine&&n.set(Qe.Tag.Premine,[BigInt(e.premine)]),e.terms){if(e.terms.amount&&n.set(Qe.Tag.Amount,[BigInt(e.terms.amount)]),e.terms.cap&&n.set(Qe.Tag.Cap,[BigInt(e.terms.cap)]),e.terms.height){let o=e.terms.height.start;o&&n.set(Qe.Tag.HeightStart,[BigInt(o)]);let a=e.terms.height.end;a&&n.set(Qe.Tag.HeightEnd,[BigInt(a)])}if(e.terms.offset){let o=e.terms.offset.start;o&&n.set(Qe.Tag.OffsetStart,[BigInt(o)]);let a=e.terms.offset.end;a&&n.set(Qe.Tag.OffsetEnd,[BigInt(a)])}}return t&&r&&n.set(Qe.Tag.Pointer,[BigInt(r)]),n}});var _v=H(nt=>{w();S();var xI=nt&&nt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),PI=nt&&nt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),TI=nt&&nt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&xI(t,e,r);return PI(t,e),t};Object.defineProperty(nt,"__esModule",{value:!0});nt.RuneMainTestWallet=nt.RuneMainWallet=nt.ErrCodeMultipleRuneId=nt.ErrCodeRuneIdNotStandard=nt.ErrCodeOpreturnExceeds=nt.ErrCodeLessRunesMainAmt=void 0;var xo=he(),EI=si(),Po=TI(hn()),zn=hn(),l0=u0(),AI=he(),II=mv();nt.ErrCodeLessRunesMainAmt=2010300;nt.ErrCodeOpreturnExceeds=2010301;nt.ErrCodeRuneIdNotStandard=2010302;nt.ErrCodeMultipleRuneId=2010303;var Jf=class extends EI.BtcWallet{convert2RuneTx(t){let r=(0,xo.cloneObject)(t);r.runeData.useDefaultOutput==!0&&r.runeData.defaultOutput==null&&(r.runeData.defaultOutput=0),r.runeData.mint==!0&&r.runeData.mintNum==null&&(r.runeData.mintNUm=1);for(let f of r.inputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(r.runeData.mint?m.amount=BigInt(1):m.amount=BigInt(m.amount))}for(let f of r.outputs){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b)typeof m.amount=="string"&&(r.runeData.mint?m.amount=BigInt(1):m.amount=BigInt(m.amount))}let n=r.inputs,i=new Map;for(let f of n){let b=f.data;if(b!=null&&b instanceof Array)for(let m of b){let y=m.id,_=BigInt(1);if(r.runeData.mint||(_=BigInt(m.amount)),y==null||_==null)continue;if(y.split(":").length<=1)throw new Error(JSON.stringify({errCode:nt.ErrCodeRuneIdNotStandard,date:{runeId:y}}));let E=i.get(y);E==null?i.set(y,_):i.set(y,BigInt(E)+BigInt(_))}}if(i.size>1)throw new Error(JSON.stringify({errCode:nt.ErrCodeMultipleRuneId,date:{runeInputMapSize:i.size}}));let s=r.outputs,o=new Map;for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(1);if(r.runeData.mint||(y=BigInt(b.amount)),m==null||y==null)continue;let _=o.get(m);_==null?o.set(m,y):o.set(m,BigInt(_)+BigInt(y))}}let a=!1;for(let f of i.keys()){let b=i.get(f),m=o.get(f);(b!=null&&m!=null&&b>m||b!=null&&m==null)&&r.runeData.useDefaultOutput==!1&&(a=!0)}let c=0,u=[];if(a){let f={address:r.address,amount:546};u.push(f),c++}let d=[];for(let f of s){let b=f.data;if(b!=null){let m=b.id,y=BigInt(1);if(r.runeData.mint||(y=BigInt(b.amount)),m==null||y==null)continue;let _={block:parseInt(m.split(":")[0]),id:parseInt(m.split(":")[1]),amount:BigInt(y),output:c};d.push(_)}f.data=null,u.push(f),c++}if(r.runeData.useDefaultOutput==!0&&r.runeData.defaultOutput>u.length-1)throw new Error(JSON.stringify({errCode:nt.ErrCodeLessRunesMainAmt,date:{defaultOutput:r.runeData.defaultOutput,ouputLenth:u.length}}));return{inputs:r.inputs,outputs:u,address:r.address,feePerB:r.feePerB,runeData:{edicts:d,etching:r.runeData.etching,burn:r.runeData.burn,defaultOutput:r.runeData.defaultOutput,mint:r.runeData.mint,mintNum:r.runeData.mintNum}}}getMockMinRuneTx(t,r){let n=(0,xo.cloneObject)(t),i=[],s={block:parseInt(r.id.split(":")[0]),id:parseInt(r.id.split(":")[1]),amount:BigInt(1),output:0};return i.push(s),{inputs:[{txId:n.inputs[0].txId,vOut:0,amount:600,data:[r]}],outputs:[{address:n.address,amount:546,data:r}],address:n.address,feePerB:n.feePerB,runeData:{edicts:i,etching:n.runeData.etching,burn:n.runeData.burn,defaultOutput:n.runeData.defaultOutput,mint:n.runeData.mint,mintNum:n.runeData.mintNum}}}getMinRuneTx(t,r,n,i){let s=(0,xo.cloneObject)(t);return{inputs:[n],outputs:[i],address:s.address,feePerB:s.feePerB,RuneData:s.runeData}}async signTransaction(t){try{let r=this.network(),n=null;if(t.data.runeData.etching)return(0,II.runesMainInscribe)(r,t.data);if(t.data.runeData.mintNum==null||t.data.runeData.mintNum<=1){let i=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let s=this.convert2RuneTx(t.data),o=this.getRuneMainOpReturnOutput(r,s.runeData);return s.outputs.push(o),n=(0,zn.signBtc)(s,i,r),Promise.resolve(n)}else if(t.data.runeData.mint&&!t.data.runeData.serialMint){let i=[],s=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let o={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum},a=this.getMockMinRuneTx(t.data,o),c=this.getRuneMainOpReturnOutput(r,a.runeData);a.outputs.push(c),n=(0,zn.signBtc)(a,s,r);let u=Po.estimateBtcFee(a,this.network())+546,d=this.convert2RuneTx(t.data),f=d.outputs.length;for(let y=0;y<o.mintNum-1;y++)d.outputs.push({address:t.data.address,amount:u});let b=this.getRuneMainOpReturnOutput(r,d.runeData);d.outputs.push(b),n=(0,zn.signBtc)(d,s,r);let m=zn.Transaction.fromHex(n).getId();i.push(n);for(let y=0;y<o.mintNum-1;y++){let _={txId:m,vOut:f,address:t.data.address,amount:u,data:[o]},E={address:t.data.address,amount:546};f+=1;let I=this.getMinRuneTx(t.data,o,_,E);I.outputs.push(b);let k=(0,zn.signBtc)(I,s,r);i.push(k)}return Promise.resolve(i)}else{let i=[],s=t.privateKey;if(!t.data.runeData)return Promise.reject("missing runeData");let o={id:t.data.outputs[0].data.id,amount:1,mintNum:t.data.runeData.mintNum},a=this.getMockMinRuneTx(t.data,o),c=(0,l0.buildRuneMainMintOp)(o.id,!1,0,!0);a.outputs.push(c);let u=Po.estimateBtcFee(a,this.network()),d=(o.mintNum-1)*u+546,f=this.convert2RuneTxSerialMint(t.data,d);f.outputs.push(c),n=(0,zn.signBtc)(f,s,r);let b=zn.Transaction.fromHex(n).getId();i.push(n);for(let m=1;m<o.mintNum;m++){let y={txId:b,vOut:0,address:t.data.address,amount:d};d=d-u;let _={address:t.data.address,amount:d},E=this.getMinRuneTx(t.data,o,y,_);E.outputs.push(c);let I=(0,zn.signBtc)(E,s,r);b=zn.Transaction.fromHex(I).getId(),i.push(I)}return Promise.resolve(i)}}catch{return Promise.reject(xo.SignTxError)}}getRuneMainOpReturnOutput(t,r){let n=!1;zn.networks.bitcoin===t&&(n=!0),r.useDefaultOutput==null&&(r.useDefaultOutput=!1),r.defaultOutput==null&&(r.defaultOutput=0),r.mint==null&&(r.mint=!1),r.mintNum==null&&(r.mintNum=0);let i=(0,l0.buildRuneMainMintData)(n,r.edicts,r.useDefaultOutput,r.defaultOutput,r.mint,r.mintNum);return{address:"",amount:0,omniScript:AI.base.toHex(i)}}async estimateFee(t){try{let r=this.network();if(!t.data.runeData)return Promise.reject("missing runeData");let n=this.convert2RuneTx(t.data),i=this.getRuneMainOpReturnOutput(this.network(),n.runeData);n.outputs.push(i);let s={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum};for(let a=0;a<s.mintNum-1;a++)n.outputs.push({address:t.data.address,amount:8e3});let o=Po.estimateBtcFee(n,this.network());if(t.data.runeData.mintNum==null||t.data.runeData.mintNum<=1)return Promise.resolve(o);if(t.data.runeData.mint&&!t.data.runeData.serialMint){let a=[];a.push(o);let c={id:t.data.outputs[0].data.id,amount:t.data.outputs[0].data.amount,mintNum:t.data.runeData.mintNum},u=this.getMockMinRuneTx(t.data,c),d=this.getRuneMainOpReturnOutput(this.network(),u.runeData);u.outputs.push(d);let f=Po.estimateBtcFee(u,this.network());for(let b=0;b<t.data.runeData.mintNum-1;b++)a.push(f);return Promise.resolve(a)}else if(t.data.runeData.mint&&t.data.runeData.serialMint){let a=[];if(!t.data.runeData)return Promise.reject("missing runeData");let c={id:t.data.outputs[0].data.id,amount:1,mintNum:t.data.runeData.mintNum},u=this.getMockMinRuneTx(t.data,c),d=(0,l0.buildRuneMainMintOp)(c.id,!1,0,!0);u.outputs.push(d);let f=Po.estimateBtcFee(u,this.network()),b=(c.mintNum-1)*f+546,m=this.convert2RuneTxSerialMint(t.data,b);m.outputs.push(d);let y=Po.estimateBtcFee(m,r);a.push(y);for(let _=1;_<c.mintNum;_++)a.push(f);return Promise.resolve(a)}}catch{return Promise.reject(xo.EstimateFeeError)}}convert2RuneTxSerialMint(t,r){let n=(0,xo.cloneObject)(t),i=[{address:n.address,amount:r}];return{inputs:n.inputs,outputs:i,address:n.address,feePerB:n.feePerB,runeData:{edicts:n.runeData.edicts,etching:n.runeData.etching,burn:n.runeData.burn,defaultOutput:n.runeData.defaultOutput,mint:n.runeData.mint,mintNum:n.runeData.mintNum}}}convert2RuneTxPsbt(t){let r=(0,xo.cloneObject)(t);return{inputs:r.inputs,outputs:r.outputs,address:r.address,feePerB:r.feePerB,runeData:{edicts:r.runeData.edicts,etching:r.runeData.etching,burn:r.runeData.burn,defaultOutput:r.runeData.defaultOutput,mint:r.runeData.mint,mintNum:r.runeData.mintNum}}}async buildPsbt(t){let r=this.network(),n=null;try{if(!t.data.runeData)return Promise.reject("missing runeData");let i=this.convert2RuneTxPsbt(t.data),s=this.getRuneMainOpReturnOutput(r,i.runeData);i.outputs.push(s);let o="KwdkfXMV2wxDVDMPPuFZsio3NeCskAUd4N2U4PriTgpj2MqAGmmc";i.dustSize==null&&(i.dustSize=546);let{inputAmount:a,outputAmount:c,virtualSize:u}=(0,zn.calculateTxSize)(i.inputs,i.outputs,i.address,o,r,i.dustSize),d=a-c-Math.ceil(u*i.feePerB);d>i.dustSize&&i.outputs.push({address:i.address,amount:d});let b=[(0,zn.buildPsbt)(i,r),d];return Promise.resolve(b)}catch(i){return Promise.reject(i)}}};nt.RuneMainWallet=Jf;var h0=class extends Jf{network(){return Po.networks.testnet}};nt.RuneMainTestWallet=h0});var wv=H(le=>{w();S();var OI=le&&le.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),BI=le&&le.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),MI=le&&le.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&OI(t,e,r);return BI(t,e),t};Object.defineProperty(le,"__esModule",{value:!0});le.AtomicalTestWallet=le.AtomicalWallet=le.ErrCodeInvalidInputAsset=le.ErrCodeAtomicalNotFullyAllocated=le.ErrCodeSemiColorOuput=le.ErrCodeMul=le.ErrCodeUnknownAsset=le.ErrCodeCommon=le.ErrCodeVoutDust=le.ErrCodeAtomicalChangeFail=le.ErrCodeLessAtomicalAmt=void 0;var p0=he(),CI=si(),vv=MI(hn()),kI=hn();le.ErrCodeLessAtomicalAmt=2011400;le.ErrCodeAtomicalChangeFail=2011401;le.ErrCodeVoutDust=2011402;le.ErrCodeCommon=2011403;le.ErrCodeUnknownAsset=2011404;le.ErrCodeMul=2011420;le.ErrCodeSemiColorOuput=2011405;le.ErrCodeAtomicalNotFullyAllocated=2011406;le.ErrCodeInvalidInputAsset=2011407;var Qf=class extends CI.BtcWallet{convert2AtomicalTx(t){let r=(0,p0.cloneObject)(t),n=new Map,i=new Map,s=new Map,o=[],a=r.feePerB||10,c=r.dustSize||546,u=r.inputs;for(let b of u){let m=b.data;if(m!=null&&m instanceof Array)for(let y of m){let _=y.atomicalId,E=y.type,I=Number(y.amount);if(_==null||I==null||E==null||E!="FT"&&E!="NFT")continue;if(I>b.amount)throw new Error(JSON.stringify({errCode:le.ErrCodeInvalidInputAsset}));i.get(_)==null&&i.set(_,E);let k=n.get(_);k==null?n.set(_,I):n.set(_,k+I)}if(Object.keys(n).length>1)throw new Error(JSON.stringify({errCode:le.ErrCodeMul}))}let d=r.outputs,f=0;for(let b of d){let m=b.data;if(m!=null&&m instanceof Array)for(let y of m){let _=y.atomicalId,E=Number(y.amount),I=y.type;if(I=="FT"&&E!=b.amount&&E>c)throw new Error(JSON.stringify({errCode:le.ErrCodeSemiColorOuput}));if(_==null||E==null||I==null||I!="FT"&&I!="NFT")continue;if(I=="FT"&&E!=b.amount&&(f+=1,f==2))throw new Error(JSON.stringify({errCode:le.ErrCodeSemiColorOuput}));if(i.get(_)!=I)throw new Error(JSON.stringify({errCode:le.ErrCodeUnknownAsset}));let k=s.get(_);if(k==null)s.set(_,E);else if(s.set(_,k+E),I=="NFT")throw new Error(JSON.stringify({errCode:le.ErrCodeMul}))}if(Object.keys(s).length>1)throw new Error(JSON.stringify({errCode:le.ErrCodeMul}));o.push({amount:b.amount,address:b.address})}for(let b of n.keys()){let m=n.get(b),y=s.get(b);if(m!=y)throw new Error(JSON.stringify({errCode:le.ErrCodeAtomicalNotFullyAllocated,date:{atomicalId:b,inputAmount:m,sendAmount:y}}))}for(let[b,m]of o.entries())if(m.amount<c)throw new Error(JSON.stringify({errCode:le.ErrCodeVoutDust,vOut:b}));return{inputs:r.inputs,outputs:o,address:r.address,feePerB:a}}async signTransaction(t){let r=this.network(),n=null;try{let i=t.privateKey,s=this.convert2AtomicalTx(t.data);return n=(0,kI.signBtc)(s,i,r),Promise.resolve(n)}catch{return Promise.reject(p0.SignTxError)}}async estimateFee(t){try{let r=this.convert2AtomicalTx(t.data),n=vv.estimateBtcFee(r,this.network());return Promise.resolve(n)}catch{return Promise.reject(p0.EstimateFeeError)}}};le.AtomicalWallet=Qf;var b0=class extends Qf{network(){return vv.networks.testnet}};le.AtomicalTestWallet=b0});var Sv=H(ed=>{w();S();Object.defineProperty(ed,"__esModule",{value:!0});ed.MAX_TOTAL_SUPPLY=void 0;var HI=2147483647n;ed.MAX_TOTAL_SUPPLY=HI});var g0=H(Lr=>{w();S();Object.defineProperty(Lr,"__esModule",{value:!0});Lr.MinterType=Lr.CHANGE_MIN_POSTAGE=Lr.Postage=Lr.SupportedNetwork=Lr.CatAddressType=void 0;var NI;(function(e){e.P2WPKH="p2wpkh",e.P2TR="p2tr"})(NI=Lr.CatAddressType||(Lr.CatAddressType={}));var RI;(function(e){e.btcSignet="btc-signet",e.fractalMainnet="fractal-mainnet",e.fractalTestnet="fractal-testnet"})(RI=Lr.SupportedNetwork||(Lr.SupportedNetwork={}));var UI;(function(e){e[e.METADATA_POSTAGE=546]="METADATA_POSTAGE",e[e.GUARD_POSTAGE=332]="GUARD_POSTAGE",e[e.MINTER_POSTAGE=331]="MINTER_POSTAGE",e[e.TOKEN_POSTAGE=330]="TOKEN_POSTAGE"})(UI=Lr.Postage||(Lr.Postage={}));Lr.CHANGE_MIN_POSTAGE=546;var qI;(function(e){e.OPEN_MINTER_V1="21cbd2e538f2b6cc40ee180e174f1e25",e.OPEN_MINTER_V2="a6c2e92d74a23c07bb6220b676c6cb9b",e.UNKOWN_MINTER="unkown_minter"})(qI=Lr.MinterType||(Lr.MinterType={}))});var Pv=H(xv=>{w();S();Object.defineProperty(xv,"__esModule",{value:!0})});var Ev=H(td=>{w();S();Object.defineProperty(td,"__esModule",{value:!0});td.isOpenMinter=void 0;var Tv=g0();function LI(e){return Tv.MinterType.OPEN_MINTER_V1===e||Tv.MinterType.OPEN_MINTER_V2===e}td.isOpenMinter=LI});var Av=H(rd=>{w();S();Object.defineProperty(rd,"__esModule",{value:!0});rd.btc=void 0;var KI=Da();Object.defineProperty(rd,"btc",{enumerable:!0,get:function(){return KI.btc}})});var Ov=H(Iv=>{w();S();Object.defineProperty(Iv,"__esModule",{value:!0})});var Ci=H(Xn=>{w();S();var DI=Xn&&Xn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qa=Xn&&Xn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&DI(t,e,r)};Object.defineProperty(Xn,"__esModule",{value:!0});qa(Sv(),Xn);qa(g0(),Xn);qa(Pv(),Xn);qa(Ev(),Xn);qa(Av(),Xn);qa(Ov(),Xn)});var Nc=H(Y=>{w();S();Object.defineProperty(Y,"__esModule",{value:!0});Y.getFee=Y.getDummySignature=Y.getDummyEcKey=Y.verifyContract=Y.toTokenAddress=Y.resetTx=Y.scaleByDecimals=Y.toP2tr=Y.p2tr2Address=Y.toBitcoinNetwork=Y.toStateScript=Y.callToBufferList=Y.getDummyUTXO=Y.dummyUTXO=Y.getDummySigner=Y.outpoint2ByteString=Y.outpoint2TxOutpoint=Y.toTxOutpoint=Y.getTokenContractP2TR=Y.getTokenContract=Y.getGuardsP2TR=Y.GuardType=Y.script2P2TR=Y.contract2P2TR=Y.strToByteString=Y.byteStringToBuffer=Y.toXOnly=void 0;var y0=Da(),_r=Ci(),Eo=Dc(),To=dw(),_0=z0(),jI=v0(),FI=rn(),nd="0250929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0";function GI(e){return e.subarray(1,33)}Y.toXOnly=GI;var VI=function(e){let t=[];for(let r of e)t.push(p.Buffer.from(r,"hex"));return t};Y.byteStringToBuffer=VI;function WI(e){return(0,Eo.toByteString)(p.Buffer.from(e,"utf-8").toString("hex"))}Y.strToByteString=WI;function Bv(e){let t=e.lockingScript.toBuffer();return{...Mv(t),script:t.toString("hex"),contract:e}}Y.contract2P2TR=Bv;function Mv(e){let t=To.Tap.encodeScript(e),[r,n]=To.Tap.getPubKey(nd,{target:t});return{p2tr:new _r.btc.Script(`OP_1 32 0x${r}}`).toHex(),tapScript:t,cblock:n}}Y.script2P2TR=Mv;var m0;(function(e){e[e.Transfer=0]="Transfer",e[e.Burn=1]="Burn"})(m0=Y.GuardType||(Y.GuardType={}));function Cv(e=m0.Transfer){let t=new y0.BurnGuard,r=new y0.TransferGuard,n=To.Tap.encodeScript(t.lockingScript.toBuffer()),i=To.Tap.encodeScript(r.lockingScript.toBuffer()),s=[n,i],[o]=To.Tap.getPubKey(nd,{tree:s}),[,a]=To.Tap.getPubKey(nd,{target:n,tree:s}),[,c]=To.Tap.getPubKey(nd,{target:i,tree:s}),u=new _r.btc.Script(`OP_1 32 0x${o}}`).toHex();return e===m0.Transfer?{p2tr:u,tapScript:i,cblock:c,script:r.lockingScript.toBuffer().toString("hex"),contract:r}:{p2tr:u,tapScript:n,cblock:a,script:t.lockingScript.toBuffer().toString("hex"),contract:t}}Y.getGuardsP2TR=Cv;function kv(e,t){return new y0.CAT20(e,(0,Eo.toByteString)(t))}Y.getTokenContract=kv;function zI(e){let{p2tr:t}=Cv();return Bv(kv(e,t))}Y.getTokenContractP2TR=zI;function Hv(e,t){let r=p.Buffer.alloc(4,0);return r.writeUInt32LE(t),{txhash:p.Buffer.from(e,"hex").reverse().toString("hex"),outputIndex:r.toString("hex")}}Y.toTxOutpoint=Hv;function Nv(e){let[t,r]=e.split("_");return Hv(t,parseInt(r))}Y.outpoint2TxOutpoint=Nv;var XI=function(e){let t=Nv(e);return t.txhash+t.outputIndex};Y.outpoint2ByteString=XI;function YI(e){return Eo.TestWallet.random(new Eo.DummyProvider)}Y.getDummySigner=YI;Y.dummyUTXO={txId:(0,_0.randomBytes)(32).toString("hex"),outputIndex:0,script:"",satoshis:1e4};function $I(e=1e4,t=!1){return t?Object.assign({},Y.dummyUTXO,{satoshis:e,txId:(0,_0.randomBytes)(32).toString("hex")}):Object.assign({},Y.dummyUTXO,{satoshis:e})}Y.getDummyUTXO=$I;var ZI=function(e){return e.tx.inputs[e.atInputIndex].script.chunks.map(r=>{if(!r.buf)if(r.opcodenum>=81&&r.opcodenum<=96){let n=(0,Eo.int2ByteString)(BigInt(r.opcodenum-80));return p.Buffer.from(n,"hex")}else return p.Buffer.from((0,Eo.toByteString)(""));return r.buf})};Y.callToBufferList=ZI;var JI=function(e){return new _r.btc.Script(`6a1863617401${e.hashRoot}`)};Y.toStateScript=JI;function Rv(e){return e==="btc-signet"?_r.btc.Networks.testnet:_r.btc.Networks.mainnet}Y.toBitcoinNetwork=Rv;function QI(e,t){let r=typeof e=="string"?_r.btc.Script.fromHex(e):e;return _r.btc.Address.fromScript(r,Rv(t)).toString()}Y.p2tr2Address=QI;function eO(e){if((typeof e=="string"?_r.btc.Address.fromString(e):e).type!=="taproot")throw new Error(`address ${e} is not taproot`);return _r.btc.Script.fromAddress(e).toHex()}Y.toP2tr=eO;function tO(e,t){return e*BigInt(Math.pow(10,t))}Y.scaleByDecimals=tO;function rO(e){for(let t=0;t<e.inputs.length;t++){let r=e.inputs[t];r.hasWitnesses()&&r.setWitnesses([])}e.nLockTime=0}Y.resetTx=rO;function nO(e){if(typeof e=="string"&&(e=_r.btc.Address.fromString(e)),e.type===_r.btc.Address.PayToTaproot)return(0,Eo.hash160)(e.hashBuffer.toString("hex"));if(e.type===_r.btc.Address.PayToWitnessPublicKeyHash)return e.hashBuffer.toString("hex");throw new Error(`Unsupported address type: ${e.type}`)}Y.toTokenAddress=nO;function iO(e,t,r,n){let i=new _r.btc.Script.Interpreter,s=_r.btc.Script.Interpreter.SCRIPT_VERIFY_WITNESS|_r.btc.Script.Interpreter.SCRIPT_VERIFY_TAPROOT;return i.verify(new _r.btc.Script(""),new _r.btc.Script(e.script),t,r,s,n,e.satoshis)?!0:i.errstr}Y.verifyContract=iO;function sO(){let e=(0,_0.randomBytes)(32),t=(0,FI.private2Wif)(e);return new jI.EcKeyService({privateKey:t})}Y.getDummyEcKey=sO;function oO(){return _r.btc.crypto.Signature.fromString("E907831F80848D1069A5371B402410364BDF1C5F8307B0084C55F1CE2DCA821525F66A4A85EA8B71E482A74F382D2CE5EBEEE8FDB2172F477DF4900D310536C0").toString("hex")}Y.getDummySignature=oO;function aO(e){return e.inputs.reduce((t,r)=>t+r.output.satoshis,0)-e.outputs.reduce((t,r)=>t+r.satoshis,0)}Y.getFee=aO});var v0=H(id=>{w();S();Object.defineProperty(id,"__esModule",{value:!0});id.EcKeyService=void 0;var Ao=Ci(),ts=Ci(),Uv=Dc(),cO=Nc(),w0=class{constructor(t){if(this.addressType=t.addressType||ts.CatAddressType.P2TR,!t.privateKey&&!t.publicKey)throw new Error("Either privateKey or publicKey must be provided");this.privateKey=t.privateKey?Ao.btc.PrivateKey.fromWIF(t.privateKey):void 0,this.publicKey=t.privateKey?this.privateKey.toPublicKey():Ao.btc.PublicKey.fromString(t.publicKey)}hasPrivateKey(){return this.privateKey!==void 0}getWif(){return this.getPrivateKey().toWIF()}getPrivateKey(){return this.privateKey}getAddressType(){return this.addressType||ts.CatAddressType.P2TR}getP2TRAddress(){return this.getPublicKey().toAddress(null,Ao.btc.Address.PayToTaproot)}getAddress(){return this.getP2TRAddress()}getXOnlyPublicKey(){let t=this.getTokenPublicKey();return(0,cO.toXOnly)(t.toBuffer()).toString("hex")}getTweakedPrivateKey(){let{tweakedPrivKey:t}=this.getPrivateKey().createTapTweak();return Ao.btc.PrivateKey.fromBuffer(t)}getPublicKey(){return this.publicKey}getTokenPublicKey(){if(this.getAddressType()===ts.CatAddressType.P2TR){let{tweakedPubKey:r}=this.publicKey.createTapTweak();return Ao.btc.PublicKey.fromBuffer(r)}return this.publicKey}getPubKeyPrefix(){let t=this.getAddressType();return t===ts.CatAddressType.P2TR?"":t===ts.CatAddressType.P2WPKH?this.getTokenPublicKey().toString().slice(0,2):""}getTokenAddress(){let t=this.getAddressType();if(t===ts.CatAddressType.P2TR){let r=this.getXOnlyPublicKey();return(0,Uv.hash160)(r)}else if(t===ts.CatAddressType.P2WPKH){let r=this.getTokenPublicKey();return(0,Uv.hash160)(r.toString())}else throw new Error(`Unsupported address type: ${t}`)}getTaprootPrivateKey(){return this.getTweakedPrivateKey()}getTokenPrivateKey(){let t=this.getAddressType();if(t===ts.CatAddressType.P2TR)return this.getTaprootPrivateKey();if(t===ts.CatAddressType.P2WPKH)return this.getPrivateKey();throw new Error(`Unsupported address type: ${t}`)}signTx(t){if(!this.hasPrivateKey())throw new Error("No private key provided");let r=this.getPrivateKey(),n=Ao.btc.crypto.Hash.sha256ripemd160(r.publicKey.toBuffer());for(let i=0;i<t.inputs.length;i++){let s=t.inputs[i];if(s.output.script.isWitnessPublicKeyHashOut()){let o=s.getSignatures(t,r,i,void 0,n,void 0,void 0);if(o.length===0)throw new Error("Could not sign input");t.applySignature(o[0])}else if(s.output.script.isTaproot()&&!s.hasWitnesses()){let o=s.getSignatures(t,r,i,Ao.btc.crypto.Signature.SIGHASH_ALL,n,void 0,void 0);if(o.length===0)throw new Error("Could not sign input");t.applySignature(o[0])}}}};id.EcKeyService=w0});var qv=H(ki=>{w();S();Object.defineProperty(ki,"__esModule",{value:!0});ki.scaleConfig=ki.tokenUtxoParse=ki.feeUtxoParse=ki.tokenInfoParse=void 0;var uO=Ci(),fO=Da(),Io=Nc();function dO(e,t){let r=JSON.parse(e),n=JSON.parse(JSON.stringify(r.info));if(n.max&&(n.max=BigInt(n.max),n.premine=BigInt(n.premine),n.limit=BigInt(n.limit)),r.info=n,!r.tokenAddr){let i=(0,Io.toP2tr)(r.minterAddr);r.tokenAddr=(0,Io.p2tr2Address)((0,Io.getTokenContractP2TR)(i).p2tr,t)}return r}ki.tokenInfoParse=dO;function lO(e,t){return t.map(r=>{let n=uO.btc.Script.fromAddress(e.getAddress()).toHex();return{txId:r.txId,outputIndex:r.vOut,script:n,satoshis:r.amount}})}ki.feeUtxoParse=lO;function hO(e){let t=JSON.parse(e);return Array.isArray(t)||(t=[t]),t.map(r=>{let n=fO.ProtocolState.fromStateHashList(r.txoStateHashes);typeof r.utxo.satoshis=="string"&&(r.utxo.satoshis=parseInt(r.utxo.satoshis));let i=r.state.address;try{i=(0,Io.toTokenAddress)(r.state.address)}catch{}return{utxo:r.utxo,state:{protocolState:n,data:{ownerAddr:i,amount:BigInt(r.state.amount)}}}})}ki.tokenUtxoParse=hO;function pO(e){let t=Object.assign({},e);return t.max=(0,Io.scaleByDecimals)(e.max,e.decimals),t.premine=(0,Io.scaleByDecimals)(e.premine,e.decimals),t.limit=(0,Io.scaleByDecimals)(e.limit,e.decimals),t}ki.scaleConfig=pO});var Dv=H(sd=>{w();S();Object.defineProperty(sd,"__esModule",{value:!0});sd.validatePrevTx=void 0;var Lv=Ci(),Kv=Nc();function bO(e,t,r,n){let i=0,s=new Lv.btc.Transaction(t);if(!s.inputs.find((u,d)=>{let f=u.getWitnesses();if(Array.isArray(f)&&f.length>2){let b=f[f.length-2],{p2tr:m}=(0,Kv.script2P2TR)(b),y=(0,Kv.p2tr2Address)(m,n);if(y===e.tokenAddr||y===e.minterAddr)return i=d,!0}}))return null;let a=s.inputs[i].prevTxId.toString("hex"),c=new Lv.btc.Transaction(r);return c.id!=a?null:{prevTx:s,prevPrevTx:c,prevTokenInputIndex:i}}sd.validatePrevTx=bO});var jv=H(od=>{w();S();Object.defineProperty(od,"__esModule",{value:!0});od.pickLargeFeeUtxo=void 0;function gO(e){let t=e[0];for(let r of e)r.satoshis>t.satoshis&&(t=r);return t}od.pickLargeFeeUtxo=gO});var Uc=H(oi=>{w();S();var yO=oi&&oi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Rc=oi&&oi.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&yO(t,e,r)};Object.defineProperty(oi,"__esModule",{value:!0});Rc(v0(),oi);Rc(qv(),oi);Rc(Dv(),oi);Rc(Nc(),oi);Rc(jv(),oi)});var S0=H($s=>{w();S();Object.defineProperty($s,"__esModule",{value:!0});$s.unlockGuard=$s.unlockToken=$s.createGuardContract=void 0;var mO=Uc(),Oo=Ci(),Yn=Uc(),Ys=Da(),qc=Dc();function _O(e,t,r,n,i,s){let{p2tr:o,tapScript:a}=(0,Yn.getGuardsP2TR)(),c=Ys.ProtocolState.getEmptyState(),u=Ys.GuardProto.createEmptyState();u.tokenScript=i;for(let b=0;b<n.length;b++)u.inputTokenAmountArray[b]=n[b].state.data.amount;c.updateDataList(0,Ys.GuardProto.toByteString(u));let d=new Oo.btc.Transaction().from(t).addOutput(new Oo.btc.Transaction.Output({satoshis:0,script:(0,Yn.toStateScript)(c)})).addOutput(new Oo.btc.Transaction.Output({satoshis:Oo.Postage.GUARD_POSTAGE,script:o})).feePerByte(r).change(s);if(d.getChangeOutput()===null)throw new Error("Insufficient satoshis balance!");d.outputs[2].satoshis-=1,e.hasPrivateKey()&&e.signTx(d);let f={utxo:{txId:d.id,outputIndex:1,script:d.outputs[1].script.toHex(),satoshis:d.outputs[1].satoshis},state:{protocolState:c,data:u}};return{commitTx:d,contact:f,guardTapScript:a}}$s.createGuardContract=_O;async function vO(e,t,r,n,i,s,o,a,c,u,d,f,b,m){let{cblock:y,contract:_}=(0,Yn.getTokenContractP2TR)(c),{shPreimage:E,prevoutsCtx:I,spentScripts:k,sighash:C}=u,U={isUserSpend:!1,userPubKeyPrefix:(0,qc.toByteString)(""),userPubKey:(0,qc.PubKey)(e.getXOnlyPublicKey()),userSig:(0,mO.getDummySignature)(),contractInputIndex:BigInt(m||0)};if(!b){let l;e.hasPrivateKey()?l=Oo.btc.crypto.Schnorr.sign(e.getTokenPrivateKey(),C.hash):l=Oo.btc.crypto.Signature.fromString(f);let g=e.getXOnlyPublicKey();U={isUserSpend:!0,userPubKeyPrefix:e.getPubKeyPrefix(),userPubKey:(0,qc.PubKey)(g),userSig:l.toString("hex"),contractInputIndex:0n}}let R=(0,Ys.getBackTraceInfo)(n,s,i),{state:{protocolState:q,data:L}}=t;await _.connect((0,Yn.getDummySigner)());let K={statesHashRoot:q.hashRoot,txoStateHashes:q.stateHashList},W=await _.methods.unlock(U,L,K,o,R,E,I,k,{fromUTXO:(0,Yn.getDummyUTXO)(),verify:!1,exec:!1}),O=[...(0,Yn.callToBufferList)(W),_.lockingScript.toBuffer(),p.Buffer.from(y,"hex")];if(a.inputs[r].witnesses=O,d){let l=(0,Yn.verifyContract)(t.utxo,a,r,O);if(typeof l=="string")throw new Error(`unlocking token contract at input ${r} failed! ${l}`);return!0}return!0}$s.unlockToken=vO;async function wO(e,t,r,n,i,s,o,a,c,u){let{shPreimage:d,prevoutsCtx:f,spentScripts:b}=c,m=(0,Ys.emptyTokenArray)(),y=(0,Ys.emptyTokenAmountArray)(),_=(0,qc.fill)(!1,Ys.MAX_TOKEN_OUTPUT);m[0]=s.ownerAddr,y[0]=s.amount,_[0]=!0,o&&(m[1]=o.ownerAddr,y[1]=o.amount,_[1]=!0);let E=o===null?1:2,{cblock:I,contract:k}=(0,Yn.getGuardsP2TR)();await k.connect((0,Yn.getDummySigner)());let C=(0,Ys.emptyTokenArray)();a!=null&&(C[E]=a.satoshis,m[E]=a.script,_[E]=!1);let U=await k.methods.transfer(n.stateHashList,m,y,_,C,(0,qc.int2ByteString)(BigInt(Oo.Postage.TOKEN_POSTAGE),8n),e.state.data,t.tx,d,f,b,{fromUTXO:(0,Yn.getDummyUTXO)(),verify:!1,exec:!1}),R=[...(0,Yn.callToBufferList)(U),k.lockingScript.toBuffer(),p.Buffer.from(I,"hex")];if(i.inputs[r].witnesses=R,u){let q=(0,Yn.verifyContract)(e.utxo,i,r,R);if(typeof q=="string")throw new Error(`unlocking guard contract failed! ${q}`);return!0}return!0}$s.unlockGuard=wO});var x0=H(ad=>{w();S();Object.defineProperty(ad,"__esModule",{value:!0});ad.mergeFee=void 0;var SO=Ci();function xO(e,t,r){let n=e.getAddress(),i=new SO.btc.Transaction().from(t).feePerByte(r).change(n);if(i.getChangeOutput()===null)throw new Error("Insufficient satoshis balance!");let s=i.outputs[0];s.satoshis-=1,e.hasPrivateKey()&&e.signTx(i);let o={address:n,txId:i.id,outputIndex:0,script:s.script,satoshis:s.satoshis};return{mergeTx:i,feeUtxo:o}}ad.mergeFee=xO});var Gv=H(Hi=>{w();S();Object.defineProperty(Hi,"__esModule",{value:!0});Hi.calcVsizeTransfer=Hi.transfer=Hi.estimateFee=void 0;var Xr=Ci(),P0=Dc(),Or=Uc(),rs=Da(),Lc=S0(),PO=x0();async function TO(e){return e.data.estimateFee=!0,await Fv(e)}Hi.estimateFee=TO;async function Fv(e){let t=e.data,r=t.estimateFee?(0,Or.getDummyEcKey)():new Or.EcKeyService({privateKey:e.privateKey}),n=(0,Or.tokenInfoParse)(t.tokenMetadata,Xr.SupportedNetwork.fractalMainnet),i=(0,Or.toP2tr)(n.minterAddr),{p2tr:s,tapScript:o}=(0,Or.getTokenContractP2TR)(i),a=t.verifyScript||!1,c,u;try{c=Xr.btc.Address.fromString(t.toAddress)}catch{throw new Error(`Invalid receiver address: ${t.toAddress}`)}if(c.type!=="taproot")throw new Error(`Invalid address type: ${c.type}`);try{u=BigInt(t.tokenAmount)}catch{throw new Error(`Invalid token amount:  ${t.tokenAmount}`)}if(u<=0n)throw new Error("Invalid token amount");let d=(0,Or.feeUtxoParse)(r,e.data.feeInputs),f=d[0],b;d.length>1&&({feeUtxo:f,mergeTx:b}=(0,PO.mergeFee)(r,d,t.feeRate));let m=(0,Or.tokenUtxoParse)(t.tokens),y=(0,Lc.createGuardContract)(r,f,t.feeRate,m,s,t.changeAddress);if(y===null)return null;let{commitTx:_,contact:E,guardTapScript:I}=y,k=rs.ProtocolState.getEmptyState(),C=rs.CAT20Proto.create(u,(0,Or.toTokenAddress)(c));k.updateDataList(0,rs.CAT20Proto.toByteString(C));let R=m.reduce((D,G)=>D+G.state.data.amount,0n)-u,q=null;if(R>0n){let D=r.getTokenAddress();q=rs.CAT20Proto.create(R,D),k.updateDataList(1,rs.CAT20Proto.toByteString(q))}let L={txId:_.id,outputIndex:2,script:_.outputs[2].script.toHex(),satoshis:_.outputs[2].satoshis},K=[...m.map(D=>D.utxo),E.utxo,L];if(K.length>rs.MAX_INPUT)throw new Error("Too many inputs, max 4 token inputs");let W=new Xr.btc.Transaction().from(K).addOutput(new Xr.btc.Transaction.Output({satoshis:0,script:(0,Or.toStateScript)(k)})).addOutput(new Xr.btc.Transaction.Output({satoshis:Xr.Postage.TOKEN_POSTAGE,script:s})).feePerByte(t.feeRate);q&&W.addOutput(new Xr.btc.Transaction.Output({satoshis:Xr.Postage.TOKEN_POSTAGE,script:s}));let O=Xr.btc.Script.fromAddress(t.changeAddress);W.addOutput(new Xr.btc.Transaction.Output({satoshis:0,script:O}));let l=[];if(t.tokenPrevTxs.length!==m.length)throw new Error("Invalid tokenPrevTxs length");for(let D=0;D<m.length;D++){let G=t.tokenPrevTxs[D].prevTx,J=t.tokenPrevTxs[D].prevPrevTx,ue=(0,Or.validatePrevTx)(n,G,J,Xr.SupportedNetwork.fractalMainnet);if(ue===null)throw new Error("prevTx does not match prevPrevTx");l.push(ue)}let g=(0,rs.getTxHeaderCheck)(_,E.utxo.outputIndex),v=m.length,P={outputIndex:(0,Or.toTxOutpoint)(E.utxo.txId,E.utxo.outputIndex).outputIndex,inputIndexVal:BigInt(v),tx:g.tx,guardState:E.state.data},{vsize:x}=await(0,Hi.calcVsizeTransfer)(m,E,W,P,l,o,I,k,C,q,O,i),B=q===null?2:3,M=W.inputAmount-x*t.feeRate-Xr.Postage.TOKEN_POSTAGE-(q===null?0:Xr.Postage.TOKEN_POSTAGE),T=x*t.feeRate;if(M<=Xr.CHANGE_MIN_POSTAGE){M=0,W.removeOutput(B);let{vsize:D,fee:G}=await(0,Hi.calcVsizeTransfer)(m,E,W,P,l,o,I,k,C,q,O,i);x=D,T=G}else W.outputs[B].satoshis=M;if(t.estimateFee)return b?{mergeTx:(0,Or.getFee)(b),commitTx:(0,Or.getFee)(_),revealTx:T}:{commitTx:(0,Or.getFee)(_),revealTx:T};let h=null;M>BigInt(0)&&(h={script:(0,P0.toByteString)(O.toHex()),satoshis:(0,P0.int2ByteString)(BigInt(M),BigInt(8))});let A=(0,rs.getTxCtxMulti)(W,m.map((D,G)=>G).concat([m.length]),[...new Array(m.length).fill(p.Buffer.from(o,"hex")),p.Buffer.from(I,"hex")]);for(let D=0;D<m.length;D++)if(!await(0,Lc.unlockToken)(r,m[D],D,l[D].prevTx,l[D].prevTokenInputIndex,l[D].prevPrevTx,P,W,i,A[D],a))return null;return await(0,Lc.unlockGuard)(E,P,v,k,W,C,q,h,A[v],a)?(r.signTx(W),b?{mergeTx:b.uncheckedSerialize(),commitTx:_.uncheckedSerialize(),revealTx:W.uncheckedSerialize()}:{commitTx:_.uncheckedSerialize(),revealTx:W.uncheckedSerialize()}):null}Hi.transfer=Fv;var EO=async(e,t,r,n,i,s,o,a,c,u,d,f)=>{let b=(0,Or.getDummyEcKey)(),m=Xr.btc.Script.fromAddress(b.getAddress()),y=r.inputs.length-1,_=r.inputs[y].output.script;r.inputs[y].output.setScript(m);let E=(0,rs.getTxCtxMulti)(r,e.map((R,q)=>q).concat([e.length]),[...new Array(e.length).fill(p.Buffer.from(s,"hex")),p.Buffer.from(o,"hex")]),I=e.length,k={script:d.toHex(),satoshis:(0,P0.int2ByteString)(0n,8n)};for(let R=0;R<e.length;R++)await(0,Lc.unlockToken)(b,e[R],R,i[R].prevTx,i[R].prevTokenInputIndex,i[R].prevPrevTx,n,r,f,E[R],!1);await(0,Lc.unlockGuard)(t,n,I,a,r,c,u,k,E[I],!1),b.signTx(r);let C=r.vsize,U=(0,Or.getFee)(r);return(0,Or.resetTx)(r),r.inputs[y].output.setScript(_),{vsize:C,fee:U}};Hi.calcVsizeTransfer=EO});var Vv=H(ns=>{w();S();var AO=ns&&ns.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),T0=ns&&ns.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&AO(t,e,r)};Object.defineProperty(ns,"__esModule",{value:!0});T0(S0(),ns);T0(x0(),ns);T0(Gv(),ns)});var A0=H(is=>{w();S();var IO=is&&is.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),E0=is&&is.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&IO(t,e,r)};Object.defineProperty(is,"__esModule",{value:!0});E0(Ci(),is);E0(Vv(),is);E0(Uc(),is)});var Xv=H(cd=>{w();S();Object.defineProperty(cd,"__esModule",{value:!0});cd.CatWallet=void 0;var Wv=he(),OO=si(),zv=A0(),I0=class extends OO.BtcWallet{async signTransaction(t){try{let r=await(0,zv.transfer)(t);return Promise.resolve(r)}catch{return Promise.reject(Wv.SignTxError)}}async estimateFee(t){try{t.data.estimateFee=!0;let r=await(0,zv.transfer)(t);return Promise.resolve(r)}catch{return Promise.reject(Wv.EstimateFeeError)}}};cd.CatWallet=I0});var Yf=H(Kr=>{w();S();var BO=Kr&&Kr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ni=Kr&&Kr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&BO(t,e,r)};Object.defineProperty(Kr,"__esModule",{value:!0});Ni(si(),Kr);Ni(X_(),Kr);Ni(Y_(),Kr);Ni($_(),Kr);Ni(J_(),Kr);Ni(Q_(),Kr);Ni(sv(),Kr);Ni(_v(),Kr);Ni(wv(),Kr);Ni(Xv(),Kr)});var $v=H(ud=>{w();S();Object.defineProperty(ud,"__esModule",{value:!0});ud.oneKeyBuildBtcTx=void 0;var MO=nn(),CO=hs(),O0=he(),B0=Yf(),M0=rn(),kO=bn(),HO={legacy:"SPENDADDRESS",segwit_native:"SPENDWITNESS",segwit_nested:"SPENDP2SHWITNESS",segwit_taproot:"SPENDTAPROOT"},NO={legacy:"PAYTOADDRESS",segwit_native:"PAYTOWITNESS",segwit_nested:"PAYTOP2SHWITNESS",segwit_taproot:"PAYTOTAPROOT"};function RO(e,t=kO.bitcoin){let r=(0,B0.convert2UtxoTx)(e);if(r.omni){let c=(0,B0.number2Hex)(r.omni.coinType||31,8),u=(0,B0.number2Hex)(r.omni.amount,16),d="6f6d6e6900000000"+c+u;r.outputs.push({address:"",amount:0,omniScript:d})}let n=parseInt((0,M0.signBtc)(r,"",t,void 0,!0,!0)),i=e.dustSize||546;n>=i&&r.outputs.push({address:r.address,amount:n,derivationPath:r.derivationPath,isChange:!0});let s=[],o=[];r.inputs.forEach(c=>{let u=Yv(c.derivationPath);s.push({address_n:u,prev_hash:c.txId,prev_index:c.vOut,amount:c.amount.toString(),script_type:HO[(0,M0.getAddressType)(c.address,t)]}),o.push(UO(c.nonWitnessUtxo,c.txId))});let a=[];return r.outputs.forEach(c=>{c.isChange?a.push({address_n:Yv(c.derivationPath),amount:c.amount.toString(),script_type:NO[(0,M0.getAddressType)(c.address,t)]}):c.omniScript?a.push({amount:"0",op_return_data:c.omniScript,script_type:"PAYTOOPRETURN"}):a.push({address:c.address,amount:c.amount.toString(),script_type:"PAYTOADDRESS"})}),{inputs:s,outputs:a,refTxs:o,coin:"btc"}}ud.oneKeyBuildBtcTx=RO;function UO(e,t){let r=MO.Transaction.fromHex(e),n=[];r.ins.forEach(s=>{n.push({prev_hash:O0.base.toHex((0,CO.reverseBuffer)(s.hash)),prev_index:s.index,script_sig:O0.base.toHex(s.script),sequence:s.sequence})});let i=[];return r.outs.forEach(s=>{i.push({amount:s.value,script_pubkey:O0.base.toHex(s.script)})}),{hash:t,inputs:n,bin_outputs:i,lock_time:r.locktime,version:r.version}}function Yv(e){let t=e.split("/");t[0]==="m"&&(t=t.slice(1));let r=[];return t.forEach(n=>{let i;n.slice(-1)==="'"?i=qO(parseInt(n.slice(0,-1),10)):i=parseInt(n,10),r.push(i)}),r}function qO(e){return 2147483648+e}});var Zv=H(Kc=>{w();S();Object.defineProperty(Kc,"__esModule",{value:!0});Kc.BtcXrcTypes=void 0;var LO;(function(e){e[e.INSCRIBE=1]="INSCRIBE",e[e.PSBT=2]="PSBT",e[e.PSBT_MPC_UNSIGNED_LIST=21]="PSBT_MPC_UNSIGNED_LIST",e[e.PSBT_MPC_SIGNED_LIST=22]="PSBT_MPC_SIGNED_LIST",e[e.PSBT_MPC_UNSIGNED_BUY=23]="PSBT_MPC_UNSIGNED_BUY",e[e.PSBT_MPC_SIGNED_BUY=24]="PSBT_MPC_SIGNED_BUY",e[e.PSBT_MPC_UNSIGNED=25]="PSBT_MPC_UNSIGNED",e[e.PSBT_MPC_SIGNED=26]="PSBT_MPC_SIGNED",e[e.PSBT_RUNEMAIN=27]="PSBT_RUNEMAIN",e[e.PSBT_KEY_SCRIPT_PATH=3]="PSBT_KEY_SCRIPT_PATH",e[e.PSBT_KEY_SCRIPT_PATH_BATCH=4]="PSBT_KEY_SCRIPT_PATH_BATCH",e[e.SRC20=101]="SRC20",e[e.RUNE=102]="RUNE",e[e.RUNEMAIN=103]="RUNEMAIN",e[e.PSBT_DECODE=104]="PSBT_DECODE",e[e.ARC20=114]="ARC20",e[e.CAT20=115]="CAT20"})(LO=Kc.BtcXrcTypes||(Kc.BtcXrcTypes={}))});var hn=H(Ce=>{w();S();var Jv=Ce&&Ce.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),KO=Ce&&Ce.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),pn=Ce&&Ce.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Jv(t,e,r)},Qv=Ce&&Ce.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Jv(t,e,r);return KO(t,e),t};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.message=Ce.wif=void 0;pn(nn(),Ce);pn(g_(),Ce);pn(rn(),Ce);pn(m_(),Ce);Ce.wif=Qv(th());pn(x_(),Ce);pn(M_(),Ce);pn(N_(),Ce);pn(D_(),Ce);pn(jh(),Ce);Ce.message=Qv(V_());pn(Yf(),Ce);pn($v(),Ce);pn(Zv(),Ce);pn(A0(),Ce);pn(xi(),Ce)});export{hn as a};
//# sourceMappingURL=chunk-PM4JABHA.js.map
