"use strict";(globalThis.webpackChunk_coral_xyz_app_extension=globalThis.webpackChunk_coral_xyz_app_extension||[]).push([[6096],{146096:(e,t,n)=>{n.r(t),n.d(t,{SecureUI:()=>qi});var r=n(274292),a=n(613754),o=n(94542),i=n(374540),s=n(400752),c=n(202784),l=n(912195),u=n(152010),d=n(190776),m=n(202784);function g({children:e}){const t=(0,s.Dv)(d.F);return m.createElement(u.$U,{client:t},e)}var p=n(916885),E=n(59727),f=n(40661),b=n(786685),h=n(202784);function y({delay:e=0,backgroundColor:t="transparent"}){const[n,r]=(0,c.useState)(e<=0);return(0,c.useEffect)((()=>{e>0&&setTimeout((()=>{r(!0)}),e)}),[e]),h.createElement(E.Kq,{position:"absolute",height:"100%",width:"100%",justifyContent:"center",alignItems:"center",backgroundColor:t},n?h.createElement(b.a,null):null)}var $=n(693517),A=n(202784);const v=1e3;function T({currentRequest:e,presentation:t,children:n}){const r=(0,s.Dv)(l.vK),[,a]=(0,c.useState)(0),o=!1===r?0:r+v-Date.now(),i=e&&!e.suspended&&(!1===r||o>0);(0,c.useEffect)((()=>{o>0&&setTimeout((()=>a(Date.now())),o)}),[r]),(0,c.useEffect)((()=>{const t=t=>{if((0,p.n)(t)&&("Escape"===t.key||"Escape"===t.code||27===t.keyCode)){if(e?.suspended||e?.responded)return;e?.error(new Error("Approval Denied: Popup Closed."))}};return window.addEventListener?.("keydown",t),()=>{window.removeEventListener("keydown",t)}}),[e]);const u=window.location?.href?.includes("windowId=")?k:C,d="onboarding"===t?x:t?.includes("modal")?C:"fullscreen"===t?k:u;return A.createElement(d,{currentRequest:e,modal:!t?.includes("relative")},A.createElement(c.Suspense,{fallback:A.createElement(y,null)},i?n:A.createElement(y,{delay:500})))}function x({children:e,currentRequest:t}){const n=(0,s.Dv)(l.vK);return t?n?null:A.createElement(E.Kq,{backgroundColor:"$baseBackgroundL0",pointerEvents:"box-only",position:"absolute",height:"100%",width:"100%",top:0,left:0,zIndex:1e5},e):null}function k({children:e,currentRequest:t}){return A.createElement(E.Kq,{position:"absolute",height:600,width:"100%",zIndex:1e5},A.createElement($.F,{inactive:Boolean(t?.responded),id:t?.id??"loading"},e))}function C({currentRequest:e,modal:t,children:n}){const r=(0,s.Dv)(l.vK),[a,o]=(0,c.useState)({}),i=!!e&&!a[e.id];return(0,c.useEffect)((()=>{let t=!1;return e?.addAfterResponseHandler((async()=>{setTimeout((()=>{t||o((t=>t[e.id]?t:{...t,[e.id]:!0}))}),100)})),()=>{t=!0}}),[e]),A.createElement(f.yo,{open:i,modal:t,snapPoints:[95],dismissOnOverlayPress:!1,dismissOnSnapToBottom:!1,position:0,zIndex:101e3,animationConfig:{type:"spring",damping:25,stiffness:275}},A.createElement(f.yo.Overlay,{bc:"$baseBackgroundL1",opacity:.4,onPress:()=>{e?.suspended||e?.responded||e?.error(new Error("Approval Denied: Popup Closed."))}}),A.createElement(f.yo.Frame,{bc:"$baseBackgroundL0"},A.createElement($.F,{inactive:!1!==r,id:e?.id??"loading"},n)))}var I=n(495320),w=n(44171),S=n(457246),_=n(817967),D=n(66046),R=n(337288),q=n(382740),P=n(187254),L=n(894733),F=n(565058),B=n(987809);const M=(0,B.xu)((({tx:e,publicKey:t,blockchainId:n})=>(0,F.cn)((async t=>{try{const r=await t((0,D.nW)(n));return await r.simTransaction({tx:e})}catch(t){return{error:t.message||"Simulation failed",preparedTx:e,estimatedGasCost:BigInt("100000"),gasBudget:BigInt("150000")}}}))),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId));var K=n(371541),z=n(220026),N=n(707876),O=n(261354),j=n(997246),U=n(667135),W=n(202784);function H({isOpen:e,onOpenChange:t,title:n,description:r,cancelText:a="Cancel",confirmText:o="Confirm",onCancel:i,onConfirm:s,width:c}){return W.createElement(O.aR,{open:e,onOpenChange:t},W.createElement(O.aR.Portal,{zIndex:11e4},W.createElement(O.aR.Overlay,{key:"overlay",opacity:.9,enterStyle:{opacity:0},exitStyle:{opacity:0},onPress:()=>t(!1),animation:"100ms"}),W.createElement(R.FA,{f:1,jc:"center",ai:"center",px:"$4",py:"$4"},W.createElement(O.aR.Content,{key:"content",bg:"$baseBackgroundL1",width:c,enterStyle:{x:0,y:0,opacity:0,scale:.95},exitStyle:{x:0,y:0,opacity:0,scale:.95},animation:["quick",{opacity:{overshootClamping:!0}}]},W.createElement(R.FA,{mb:8},W.createElement(R.FA,{gap:16,mb:16,mt:8,mx:8},W.createElement(q.q,{fontWeight:600},n),"string"==typeof r?W.createElement(q.q,{lh:24,color:"$baseTextMedEmphasis",fontWeight:500},r):r),W.createElement(U.p,{horizontal:Boolean(i&&a)},i&&a&&W.createElement(O.aR.Cancel,{asChild:!0},W.createElement(j.x,{variant:"tertiary",size:40,label:a,onPress:i})),W.createElement(O.aR.Action,{asChild:!0},W.createElement(j.x,{variant:i&&a?"primary":"tertiary",label:o,onPress:()=>{s?.()},size:40}))))))))}var V=n(967264),G=n(531518),Z=n(883739),Q=n(20994);function J(e,t,n,r,a=!1){if(!a)return{approved:!1,available:!0,approvedUntil:0};const{approved:o,approvedUntil:i}=(0,Q.is)(t.preferences.autoApprovalOrigins,e.address,n,"tx"),s=t.publicKeys?.platforms[n]?.publicKeys[r],c=[_.ZO.SOFTWARE,_.ZO.HARDWARE].includes(s?.publicKeyringInfo?.keyringType),l=t.preferences.autoApprovalOrigins?.[e.address]?.[n]?.txAddress;return{approved:o&&c&&l===r,available:c,approvedUntil:i}}var X=n(679551),Y=n(541214),ee=n(344848),te=n(711728),ne=n(555150),re=n(93133),ae=n(299105),oe=n(534042),ie=n(623749),se=n(239263),ce=n(293247),le=n(221694),ue=n(33229),de=n(562460),me=n(102071),ge=n(680588),pe=n(527159),Ee=n(695188),fe=n(195388),be=n(464840),he=n(733095),ye=n(202784);function $e({displayOrigin:e,actionType:t,initialExpanded:n=!0}){const[r,a]=(0,c.useState)(n);return ye.createElement(R.FA,{backgroundColor:"$yellowBackgroundTransparent",borderRadius:"$3",padding:"$4",gap:"$3"},ye.createElement(R.sL,{alignItems:"center",gap:"$2",cursor:"pointer",onPress:()=>a(!r)},ye.createElement(oe.u,{size:20,color:"$yellowText"}),ye.createElement(q.q,{fontSize:"$md",fontWeight:"$bold",color:"$yellowText",flex:1},P.ag._({id:"v2FoTM"})),r?ye.createElement(be.K,{size:16,color:"$yellowText"}):ye.createElement(he._,{size:16,color:"$yellowText"})),r&&ye.createElement(R.FA,{gap:"$2"},ye.createElement(q.q,{fontSize:"$xs",color:"$yellowText"},P.ag._({id:"wPmmJD",values:{displayOrigin:e,actionType:t}})),ye.createElement(R.FA,{gap:"$1",paddingLeft:"$2"},ye.createElement(q.q,{fontSize:"$xs",color:"$yellowText"},P.ag._({id:"BtNmZS"})),ye.createElement(q.q,{fontSize:"$xs",color:"$yellowText"},P.ag._({id:"ta7CKP"})),ye.createElement(q.q,{fontSize:"$xs",color:"$yellowText"},P.ag._({id:"PbyTcB"}))),ye.createElement(q.q,{fontSize:"$xs",fontWeight:"$medium",color:"$yellowText",marginTop:"$1"},P.ag._({id:"08f1LN",values:{displayOrigin:e}}))))}var Ae=n(202784);function ve({origin:e,blockchainId:t,actionType:n,publicKey:r}){const a=(0,s.Dv)(I.D5),o=(0,Y.rT)(),i=(0,s.Dv)(I.s7),u=(0,s.Dv)(D.lm),d=(0,s.Dv)(l.GN),m=(0,s.Dv)(X.O),g="web"===ue.default.OS,[p,E]=(0,c.useState)(!1),[f,b]=(0,c.useState)(!1),h=(0,c.useRef)(null),{dismissedKey:y,approvalKey:$}={"transaction signing":{dismissedKey:"dismissedTx",approvalKey:"tx"},"message signing":{dismissedKey:"dismissedMessage",approvalKey:"message"}}[n],A=()=>{const n={...a.preferences.autoApprovalOrigins||{}};return n[e.address]||(n[e.address]={}),n[e.address][t]||(n[e.address][t]={}),n},v=a.preferences.autoApprovalOrigins?.[e.address]?.[t]?.[y]??!1;if(!m||p||v)return null;const T=r||o.publicKey;let x=!1,k=!0;if("transaction signing"===n){const n=J(e,a,t,T,m);k=n.available,x=n.approved}else if("message signing"===n){const n=(0,me.g)({origin:e,user:a,blockchainId:t,isSigningAutoApprovalFeatureSupported:m,publicKey:T});x=n.approved}if(!k)return null;const C=e.address.replace(/^https?:\/\/(?:www\.)?/,""),w=u[t],S=a.publicKeys?.platforms[t]?.publicKeys?.[T],_=S?.name||P.ag._({id:"sb9Y58"}),L={"transaction signing":P.ag._({id:"PTxClp"}),"message signing":P.ag._({id:"/3WDic"})}[n];return Ae.createElement(R.FA,{gap:"$2"},x&&Ae.createElement($e,{displayOrigin:C,actionType:n,initialExpanded:!0}),Ae.createElement(R.FA,{backgroundColor:x?"$yellowBackgroundTransparent":"$baseBackgroundL1",borderRadius:"$3",padding:"$2",gap:"$2",borderWidth:x?1:0,borderColor:x?"$yellowBorder":"transparent",position:"relative"},!x&&Ae.createElement(R.sL,{position:"absolute",top:g?4:0,right:g?4:0,zIndex:10,cursor:"pointer"},Ae.createElement(V.P,{onPress:()=>{E(!0);const n=A(),r=n[e.address][t]||{};n[e.address][t]={...r,[y]:!0,[$]:0},i.updateUserPreferences({uuid:a.user.uuid,preferences:{autoApprovalOrigins:n}}).catch((()=>{E(!1)}))},style:{width:24,height:24,justifyContent:"center",alignItems:"center"}},Ae.createElement(Ee.X,{size:14,color:"$baseTextMedEmphasis"}))),Ae.createElement(R.sL,{width:"100%",alignItems:"center",gap:"$3",padding:"$1"},Ae.createElement(R.FA,{flex:0,justifyContent:"center",alignItems:"center",minWidth:24},Ae.createElement(fe.i,{size:20,color:x?"$yellowText":"$accentBlue"})),Ae.createElement(R.FA,{flex:1,gap:"$2",minWidth:0},Ae.createElement(q.q,{fontSize:"$sm",fontWeight:"$bold",color:x?"$yellowText":"$baseTextHighEmphasis"},L),Ae.createElement(q.q,{fontSize:"$xs",color:x?"$yellowText":"$baseTextMedEmphasis"},x?"transaction signing"===n?P.ag._({id:"Yj5fgG"}):P.ag._({id:"ySeQ0x"}):"transaction signing"===n?P.ag._({id:"0WFQ+m"}):P.ag._({id:"ioT9rh"}))),Ae.createElement(R.FA,{flex:0,justifyContent:"center",alignItems:"center",flexShrink:0},Ae.createElement(ge.y,{value:x,onValueChange:async()=>{b(!0);try{const o=(0,Q.yM)(!x),s=!x,c=A(),l={...c[e.address]?.[t]||{}};"transaction signing"===n?(l.tx=o,s&&T?l.txAddress=T:s||delete l.txAddress):"message signing"===n&&(l.message=o,s&&T?l.messageAddress=T:s||delete l.messageAddress),c[e.address][t]=l,h.current=o,d&&(r=d)&&r.addAfterResponseHandler((async n=>{if(null===h.current)return;const r=n.error||!n.response?.confirmed,o=n.error?.message?.toLowerCase().includes("cancel")||n.error?.message?.toLowerCase().includes("user rejected")||n.error?.message?.toLowerCase().includes("user cancelled");if(r||o)try{const n=await i.getUser();if(n.error||!n.response){const n={...a.preferences.autoApprovalOrigins||{}};n[e.address]||(n[e.address]={}),n[e.address][t]||(n[e.address][t]={});const r=n[e.address][t]||{};n[e.address][t]={...r,[$]:0},await i.updateUserPreferences({uuid:a.user.uuid,preferences:{autoApprovalOrigins:n}})}else{const r=n.response;if("needs-onboarding"!==r.keyringStoreState&&"publicKeys"in r&&"user"in r&&"preferences"in r){const n={...r.preferences.autoApprovalOrigins||{}};n[e.address]||(n[e.address]={}),n[e.address][t]||(n[e.address][t]={});const a={...n[e.address][t]||{},[$]:0};n[e.address][t]=a,await i.updateUserPreferences({uuid:r.user.uuid,preferences:{autoApprovalOrigins:n}})}}h.current=null}catch(e){h.current=null}else h.current=null})),await i.updateUserPreferences({uuid:a.user.uuid,preferences:{autoApprovalOrigins:c}})}catch(e){h.current=null}finally{b(!1)}var r},warning:x,size:g?"small":"default",loading:f}))),("transaction signing"===n||"message signing"===n)&&T&&Ae.createElement(R.FA,{backgroundColor:"$baseBackgroundL1",borderRadius:"$3",padding:"$2",gap:"$2"},Ae.createElement(R.sL,{alignItems:"center",gap:"$2",justifyContent:"space-between"},Ae.createElement(R.sL,{alignItems:"center",gap:"$2",flex:1},Ae.createElement(pe._,{id:t,size:24}),Ae.createElement(R.FA,{flex:1,gap:"$2"},Ae.createElement(q.q,{fontSize:"$sm",fontWeight:"$semibold",color:"$baseTextHighEmphasis"},_),Ae.createElement(q.q,{fontSize:"$xs",color:"$baseTextMedEmphasis",opacity:.8},(0,K.R1)(T,4)))),Ae.createElement(R.FA,{backgroundColor:"$baseBackgroundL1",borderRadius:"$2",paddingHorizontal:"$2",paddingVertical:"$2"},Ae.createElement(q.q,{fontSize:"$xs",fontWeight:"$medium",color:"$baseTextMedEmphasis"},w?.name||t))))))}async function Te(e){await navigator.clipboard.writeText(e)}const xe="https://explorer.solana.com/tx/inspector";var ke=n(204709),Ce=n(997797),Ie=n(654184),we=n(202784);function Se({warning:e}){return we.createElement(R.FA,{backgroundColor:"CRITICAL"===e.severity?"$redBackgroundTransparent":"INFO"===e.severity?"$accentBlueBackground":"$yellowBackgroundTransparent",borderRadius:"$DEPRECATED_4",padding:"$DEPRECATED_4",space:"$DEPRECATED_4"},we.createElement(E.Kq,{alignItems:"center"},"CRITICAL"===e.severity?we.createElement(Ie.e,{size:32,color:"$redIcon"}):"INFO"===e.severity?we.createElement(ie.k,{size:32,color:"$accentBlue"}):we.createElement(oe.u,{size:32,color:"$yellowIcon"})),we.createElement(q.q,{textAlign:"center",color:"CRITICAL"===e.severity?"$redText":"INFO"===e.severity?"$accentBlue":"$yellowText"},e.message))}var _e=n(202784);const De=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((n,r)=>e.slice(r*t,r*t+t)));function Re(){return _e.createElement(R.FA,{backgroundColor:"$baseBackgroundL1",borderColor:"$baseBorderMed",borderWidth:1,padding:"$4",borderRadius:"$3"},_e.createElement(R.sL,{alignItems:"center",gap:"$4"},_e.createElement(oe.u,{size:"$5",height:"$8",width:"$8",color:"$yellowIcon"}),_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis",f:1},P.ag._({id:"jUmV5s"}))))}function qe({evaluation:e}){const t=e.approvals??[],[n,r]=(0,c.useState)(null);return 0===t.length?_e.createElement(R.FA,{backgroundColor:"$baseBackgroundL1",borderColor:"$baseBorderMed",borderWidth:1,padding:"$4",borderRadius:"$3"},_e.createElement(R.sL,{alignItems:"center",gap:"$4"},_e.createElement(ie.k,{size:"$5",height:"$8",width:"$8",color:"$baseIcon"}),_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis",f:1},P.ag._({id:"V3y8cb"})))):_e.createElement(R.FA,{gap:"$4"},_e.createElement(q.q,{color:"$baseTextHighEmphasis"},P.ag._({id:"4ySKnS"})),t.map(((e,t)=>_e.createElement(R.FA,{key:`${e.spenderAddress}-${t}`,gap:"$3",backgroundColor:"$baseBackgroundL1",padding:"$3",borderRadius:"$3"},_e.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",gap:"$3"},_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis",flexShrink:0},P.ag._({id:"Z7ZXbT"})),_e.createElement(R.sL,{alignItems:"center",gap:"$2",flex:1,justifyContent:"flex-end"},e.tokenLogoUrl?_e.createElement(te.E,{borderRadius:"$6",source:{width:20,height:20,uri:e.tokenLogoUrl}}):null,_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextHighEmphasis",numberOfLines:1,ellipsizeMode:"middle",flexShrink:1},e.amount," ",e.tokenSymbol))),_e.createElement(ne.Z,{borderColor:"$baseDivider"}),_e.createElement(R.sL,{alignItems:"center",justifyContent:"space-between"},_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"wwdak+"})),_e.createElement(V.P,{onPress:()=>{return Te(t=e.spenderAddress),r(t),void setTimeout((()=>{r(null)}),2e3);var t}},_e.createElement(R.sL,{alignItems:"center",gap:"$2"},_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextHighEmphasis"},(0,K.R1)(e.spenderAddress,4)),n===e.spenderAddress?_e.createElement(se.J,{size:14,color:"$greenIcon"}):_e.createElement(ce.C,{size:14,color:"$baseIcon"}))))))),_e.createElement(R.sL,{backgroundColor:"$baseBackgroundL1",borderColor:"$baseBorderMed",borderWidth:1,padding:"$3",borderRadius:"$3",alignItems:"center",gap:"$3"},_e.createElement(oe.u,{size:16,color:"$yellowIcon"}),_e.createElement(q.q,{fontSize:"$xs",color:"$baseTextMedEmphasis",f:1},P.ag._({id:"gyPLvb"}))))}function Pe(){return _e.createElement(R.FA,{backgroundColor:"$baseBackgroundL1",borderColor:"$baseBorderMed",borderWidth:1,padding:"$4",borderRadius:"$3"},_e.createElement(R.sL,{alignItems:"center",gap:"$4"},_e.createElement(oe.u,{size:"$5",height:"$8",width:"$8",color:"$yellowIcon"}),_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis",f:1},P.ag._({id:"gyPLvb"}))))}function Le({signerPublicKey:e,relevantAddresses:t=[],origin:n,onApprove:r,onDeny:a,evaluation:o,isApproveLoading:i,isEvaluationLoading:l,append:u=[],prepend:d=[],customWarnings:m=[],programApprovalInfo:g,blockchainId:p,contractIds:E,serializedTx:f,isStandardTransaction:b,operationLabel:h}){const y=(0,s.Dv)(I.D5),[$,A]=(0,c.useState)(!1),[v,T]=(0,c.useState)(!1);if("BLOCK"===o?.action&&!$)return _e.createElement(ke.P,{warning:o.warnings.find((e=>"CRITICAL"===e.severity)),onDeny:a,onIgnore:()=>A(!0)});const x={};let k,C;t.push(e),t=t.map((e=>e.toLowerCase()));const S=Object.entries(o?.expectedStateChanges??{}).some((([t,n])=>t.toLowerCase()===e.toLowerCase()&&Array.isArray(n)&&n.some((e=>e.asset?.isNonFungible)))),{signerDiff:_,relevantDiffs:D,walletDiffs:L}=Object.entries(o?.expectedStateChanges??{}).filter((([e])=>"simulation_unavailable"!==e)).filter((([e,t])=>Array.isArray(t))).sort((([e,t],[n,r])=>t.length>r.length?-1:t.length<r.length?1:e>n?-1:e<n?1:0)).reduce(((n,[r,a])=>{const o=r.toLowerCase()===e.toLowerCase(),i=_e.createElement(R.FA,{key:r,gap:"$3",backgroundColor:"$baseBackgroundL1",padding:"$3",borderRadius:"$3"},_e.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",gap:"$2"},_e.createElement(R.sL,{flex:1,overflow:"hidden"},_e.createElement(N.xK,{publicKey:r}))),_e.createElement(ne.Z,{borderColor:"$baseDivider"}),_e.createElement(R.FA,{gap:"$2"},a.filter((e=>!e.humanReadableDiff.includes("Transfer control"))).sort(((e,t)=>{const n=e.humanReadableDiff.startsWith("Send"),r=t.humanReadableDiff.startsWith("Send"),a=e.humanReadableDiff.startsWith("Receive"),o=t.humanReadableDiff.startsWith("Receive");return n&&!r?-1:!n&&r||a&&!o?1:!a&&o?-1:0})).map((e=>(o&&e.asset?.name&&(x[e.asset.name]={...e.asset,suggestedColor:e.suggestedColor,humanReadableDiff:e.humanReadableDiff}),_e.createElement(R.sL,{key:e.humanReadableDiff,alignItems:"center",gap:"$2",flex:1},_e.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",gap:"$2",flex:1},l?_e.createElement(R.sL,{gap:"$10",justifyContent:"space-between"},_e.createElement(G.m,{height:20,width:60})):function(e){const t=["Sending","Send","Sent"],n=["Receiving","Received","Receive"],r=[...t,...n].find((t=>e.humanReadableDiff.startsWith(t))),a=r?e.humanReadableDiff.replace(`${r} `,""):e.humanReadableDiff,o="Receiving"===r?"Receive":"Sending"===r?"Send":r,i="DEBIT"===e.suggestedColor||r&&t.includes(r)?"$redText":"CREDIT"===e.suggestedColor||r&&n.includes(r)?"$greenText":"INFO"===e.suggestedColor?"$baseTextMedEmphasis":"$baseTextHighEmphasis";return[...o?[_e.createElement(q.q,{key:"action",fontSize:"$sm",color:"$baseTextMedEmphasis"},o)]:[],_e.createElement(q.q,{key:"asset",fontSize:"$sm",color:i},a)]}(e)),l?_e.createElement(G.m,{height:20,width:100}):e.asset&&e.asset.imageUrl?_e.createElement(R.sL,{flexShrink:0,key:e.humanReadableDiff},_e.createElement(te.E,{borderRadius:e.asset.isNonFungible?"$1":"$6",source:{width:22,height:22,uri:e.asset.imageUrl}})):null))))));return t.includes(r.toLocaleLowerCase())?o?{...n,signerDiff:[...n.signerDiff,i]}:{...n,relevantDiffs:[...n.relevantDiffs,i]}:{...n,walletDiffs:[...n.walletDiffs,i]}}),{signerDiff:[],relevantDiffs:[],walletDiffs:[]});let F=Object.values(x).filter((e=>Boolean(e&&(!S||e.isNonFungible)&&e.imageUrl))).sort(((e,t)=>{const n="CREDIT"===e.suggestedColor,r="CREDIT"===t.suggestedColor;return n&&!r?1:!n&&r?-1:0}));const B=(0,Z.qZ)(y.publicKeys.activePlatform)?.gasCurrencySymbol;if(B&&F.length>=2){const e=F.findIndex((e=>e.name===B&&"DEBIT"===e.suggestedColor));if(-1!==e)if(2===F.length)F.some(((t,n)=>n!==e&&"DEBIT"===t.suggestedColor))&&(F=F.filter(((t,n)=>n!==e)));else if(3===F.length){const t=F.some(((t,n)=>n!==e&&"DEBIT"===t.suggestedColor)),n=F.some(((t,n)=>n!==e&&"CREDIT"===t.suggestedColor));t&&n&&(F=F.filter(((t,n)=>n!==e)))}}const M=Math.min(3,F.length),K=F.length>0?De(F,M):[];K.length>0&&(K[K.length-1]=[...K[K.length-1],null,null],K[K.length-1].length=M),k=F.length>0?_e.createElement(R.FA,{gap:"$4"},K.map(((e,t)=>_e.createElement(R.sL,{key:e[0]?.name??t,justifyContent:"center",alignItems:"center",flexWrap:"nowrap",width:"100%"},e.map(((t,n)=>{const r=n<e.length-1&&t&&e[n+1];return _e.createElement(R.sL,{key:t?.name??n,alignItems:"center",justifyContent:"center",flex:1},_e.createElement(R.FA,{justifyContent:"center",alignItems:"center",width:"100%"},t?_e.createElement(_e.Fragment,null,_e.createElement(re.b,{size:60,borderRadius:"$6",circular:!t.isNonFungible,overflow:"hidden",alignItems:"center",justifyContent:"center",alignContent:"stretch"},_e.createElement(te.E,{source:{width:60,height:60,uri:t.imageUrl}})),_e.createElement(q.q,{paddingTop:"$3",fontSize:"$sm",color:"$baseTextMedEmphasis",textAlign:"center"},t.name)):null),r&&_e.createElement(R.sL,{position:"absolute",right:-12,zIndex:1},_e.createElement(le.o,{size:24,color:"$baseIcon"})))})))))):null;const O=void 0!==o?.expectedStateChanges?.simulation_unavailable;C=_.length+L.length+D.length>0?_e.createElement(R.FA,{gap:"$4"},_e.createElement(R.sL,{alignItems:"center",gap:"$2"},_e.createElement(q.q,{color:"$baseTextHighEmphasis"},P.ag._({id:"MTSkeL"})),g||b||p&&E&&E.length>0?_e.createElement(V.P,{onPress:()=>T(!0)},_e.createElement(ie.k,{size:16,color:"$baseIcon"})):null),_e.createElement(R.FA,{gap:"$2"},_,D,y.preferences.developerMode?L:null)):o?O?_e.createElement(Pe,null):o.isApproval?_e.createElement(qe,{evaluation:o}):_e.createElement(Re,null):null;const U=n.address,W=U.startsWith("http")&&!U.includes("localhost")?`https://www.google.com/s2/favicons?domain=${U}&sz=50`:w.rI;return _e.createElement(Ce.Q,{title:P.ag._({id:"XI+xA3"}),onApprove:r,rightButton:_e.createElement(j.x,{label:P.ag._({id:"Z7ZXbT"}),disabled:i,loading:i,onPress:r,variant:"primary",testID:i?void 0:z.R$}),onDeny:a},_e.createElement(R.FA,{gap:"$4"},m.length>0||(o?.warnings.length??0)>0||(o?.errors.length??0)>0?_e.createElement(R.FA,{gap:"$3"},[...o?.warnings??[],...m].map(((e,t)=>_e.createElement(Se,{key:"string"==typeof e.message?e.message:`warning-${t}`,warning:e}))),o?.errors.map((e=>_e.createElement(Se,{key:e,warning:{severity:"CRITICAL",message:e}})))):null,k,d,C,u,_e.createElement(R.FA,{gap:"$3"},_e.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"Wcv9QD"})),_e.createElement(R.sL,{alignItems:"center",justifyContent:"flex-start",gap:"$3",backgroundColor:"$baseBackgroundL1",padding:"$2",borderRadius:"$3"},_e.createElement(re.b,{ml:"$3",size:24,overflow:"hidden",alignItems:"center",justifyContent:"center",alignContent:"stretch"},_e.createElement(te.E,{source:{width:24,height:24,uri:W}})),_e.createElement(R.FA,{gap:"$1",flex:1,overflow:"hidden"},_e.createElement(q.q,{fontWeight:"$bold",fontSize:"$md",numberOfLines:1,ellipsizeMode:"tail"},new URL(U).host),_e.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$xs",numberOfLines:1,ellipsizeMode:"tail"},n.name))),_e.createElement(Be,{origin:n}))),v&&p?_e.createElement(Fe,{isOpen:v,onOpenChange:T,blockchainId:p,contractIds:g?.programIds??E??[],approvalInfo:g?{approvalCount:g.approvalCount,lastApprovedAt:g.lastApprovedAt}:void 0,serializedTx:f,isStandardTransaction:b,operationLabel:h}):null)}function Fe({isOpen:e,onOpenChange:t,blockchainId:n,contractIds:r,approvalInfo:a,serializedTx:o,isStandardTransaction:i,operationLabel:s}){const{explorerAddressUrl:c}=(0,ee.U)(n),l=function(e,t){return(0,_.KA)(e)===_.$O.SOLANA?P.ag._({id:"8MIU1T"}):P.ag._({id:"ks5OGD"})}(n),u=!!a,d=o?function(e,t){return e===_.Ek.SOLANA_MAINNET?`${xe}?message=${encodeURIComponent(t)}`:e===_.Ek.SOLANA_DEVNET?`${xe}?message=${encodeURIComponent(t)}&cluster=devnet`:null}(n,o):null,m=_e.createElement(ae.Zl,{style:{backgroundColor:"$baseBackgroundL0",minWidth:"80%"}},i?_e.createElement(ae.Uq,{label:P.ag._({id:"22QLw7"}),value:P.ag._({id:"IjvCsG"})}):_e.createElement(ae.Uq,{label:P.ag._({id:"VRJRNC"}),value:a?.approvalCount??0}),s?_e.createElement(ae.Uq,{label:P.ag._({id:"FZg3wM"}),value:s}):null,r.map((e=>_e.createElement(ae.Uq,{key:e,label:l,value:_e.createElement(ae.Zp,{content:(0,K.R1)(e,4)}),onPress:()=>(e=>{const t=c(e);de.Z.openURL(t)})(e)}))),d?_e.createElement(ae.Uq,{label:P.ag._({id:"Ofth7/"}),value:_e.createElement(ae.Zp,{content:P.ag._({id:"jpctdh"})}),onPress:()=>{d&&de.Z.openURL(d)}}):null),g=i?P.ag._({id:"LAQzEH"}):u?P.ag._({id:"ZVdFvN"}):P.ag._({id:"EFGA/f"});return _e.createElement(H,{isOpen:e,onOpenChange:t,title:g,description:m,confirmText:P.ag._({id:"76gPWk"}),onConfirm:()=>t(!1),width:"web"===ue.default.OS?"90vw":void 0})}function Be({origin:e}){const t=(0,Y.rT)(),n=(0,s.Dv)(X.O),r=(0,s.Dv)(I.D5),{available:a}=J(e,r,t.blockchainId,t.publicKey,n);return a&&n?_e.createElement(ve,{origin:e,blockchainId:t.blockchainId,actionType:"transaction signing",publicKey:t.publicKey}):null}var Me=n(202784);function Ke({currentRequest:e}){const t=(0,s.Dv)((0,D.I5)(e.request.blockchainId)),n=(0,c.useMemo)((()=>({tx:e.request.tx,blockchainId:e.request.blockchainId,publicKey:e.request.publicKey})),[e.request.tx,e.request.blockchainId,e.request.publicKey]),r=(0,s.Dv)(M(n)),a=r?.preparedTx&&!r?.error?r.preparedTx:e.request.tx;return Me.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},Me.createElement(Le,{origin:e.event.origin,relevantAddresses:e.event.uiOptions.relevantAccounts,signerPublicKey:e.request.publicKey,isApproveLoading:!1,onDeny:()=>e.error(new Error("Approval Denied")),onApprove:()=>{try{const t=e.event.origin.address,n=t?new URL(t).hostname:"",r="aave.com"===n||n.endsWith(".aave.com"),a=e.request.blockchainId===_.Ek.APTOS_MAINNET;r&&a&&fetch(w._8,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:e.request.publicKey})}).catch((()=>{}))}catch{}e.respond({confirmed:!0,preparedTx:a})},append:[Me.createElement(R.FA,{key:"AptosDetails",space:"$DEPRECATED_4"},Me.createElement(q.q,{fontWeight:"$bold",color:"$baseTextHighEmphasis"},P.ag._({id:"5HVoyc"})),Me.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},Me.createElement(R.FA,{space:"$DEPRECATED_1"},Me.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"OR475H"}))),Me.createElement(q.q,{fontSize:"$sm"},t.caip2Reference)),r?.estimatedGasCost&&Me.createElement(Me.Fragment,null,Me.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},Me.createElement(R.FA,{space:"$DEPRECATED_1"},Me.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"v2qUc2"}))),Me.createElement(q.q,{fontSize:"$sm"},(0,S.Ou)(r.estimatedGasCost,t.gasCurrencyDecimals,!1)," ",t.gasCurrencySymbol)),r.gasBudget&&Me.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},Me.createElement(R.FA,{space:"$DEPRECATED_1"},Me.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"NZHZoK"}))),Me.createElement(q.q,{fontSize:"$sm"},(0,S.Ou)(r.gasBudget,t.gasCurrencyDecimals,!1)," ",t.gasCurrencySymbol))),r?.error&&Me.createElement(R.sL,{alignItems:"center",justifyContent:"space-between"},Me.createElement(q.q,{fontSize:"$sm",color:"$redText"},P.ag._({id:"YBt9vE"}),": ",r.error)))]}))}var ze=n(202784);function Ne({origin:e,onIgnore:t,onDeny:n}){return ze.createElement(ke.P,{warning:{severity:"INFO",message:"You are trying to sign with a view-only wallet! Backpack won't be able to sign due to the missing private key. Import this wallet with its private key to enable signing."},onIgnore:t,onDeny:n})}var Oe=n(202784);function je({currentRequest:e}){const t=e.request.blockchainId,n=(0,s.Dv)(I.D5),r=n.publicKeys.platforms[t]?.publicKeys[e.request.publicKey],[a,o]=(0,c.useState)(!1);return a||"view-only"!==r?.type?Oe.createElement(Ke,{currentRequest:e}):Oe.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>o(!0)})}var Ue=n(625944);function We(e){let t;return t=e&&e.length>20?e.substring(0,20).trim()+"...":e||"Website",t}function He(e){return P.ag._({id:"vz6697",values:{appName:e}})}var Ve=n(202784);function Ge({origin:e,publicKey:t,blockchainId:n}){return Ve.createElement(R.sL,{justifyContent:"space-around",space:"$DEPRECATED_2"},Ve.createElement(E.Kq,{width:"50%"},Ve.createElement(Ze,{origin:e})),Ve.createElement(E.Kq,{width:"50%"},Ve.createElement(Qe,{publicKey:t,blockchainId:n})))}function Ze({origin:e}){const t=Xe(e.address),n=e.address.replace(/\/$/,"").replace(/^https:\/\/(www\.)?/i,"");return Ve.createElement(R.FA,null,Ve.createElement(Je,{icon:Ve.createElement(te.E,{style:{height:80,width:80},source:{height:80,width:80,uri:t}}),title:We(e.name),subtitle:n}),e.isUnverified&&Ve.createElement(R.FA,null,Ve.createElement(Ue.LZ,null),Ve.createElement(Se,{key:He(e.name),warning:{severity:"WARNING",message:He(e.name)}})))}function Qe({publicKey:e,blockchainId:t}){const n=(0,s.Dv)(I.D5),r=n.publicKeys.platforms[t]?.publicKeys[e],a=(0,K.R1)(e);return Ve.createElement(Je,{icon:Ve.createElement(N.u5,{size:80,uuid:n.user.uuid}),title:r?.name??n.user.username,subtitle:a})}function Je({icon:e,title:t,subtitle:n}){return Ve.createElement(R.FA,{ai:"center",space:"$DEPRECATED_2",paddingHorizontal:"$2"},Ve.createElement(E.Kq,{width:80,height:80,borderRadius:"$circular",overflow:"hidden",backgroundColor:"$baseBackgroundL1"},e),Ve.createElement(q.q,{flexShrink:1,fontSize:"$md",ta:"center",color:"$baseTextHighEmphasis",maxWidth:"100%",paddingHorizontal:"$2"},t),Ve.createElement(q.q,{fontSize:"$xs",ta:"center",color:"$baseTextMedEmphasis",maxWidth:"100%",paddingHorizontal:"$2"},n))}function Xe(e){return e.startsWith("http")&&!e.includes("localhost")?`https://www.google.com/s2/favicons?domain=${e}&sz=180`:w.rI}var Ye=n(348834).Buffer,et=n(202784);function tt(e){const t=(0,s.Dv)(X.O),n=new Uint8Array([255]),r=Uint8Array.from("solana offchain",(e=>e.charCodeAt(0))),a=Ye.from(new Uint8Array([...n,...r])).toString("binary");let o=e.message;if(e.message.startsWith(a)){const t=Ye.from(e.message,"binary"),n=t.subarray(17,49);let r;r=t.length>85&&n.every((e=>0===e))?t.subarray(85):t.subarray(20),o=r.toString("utf8")}else o=Ye.from(e.message,"binary").toString("utf8");return et.createElement(Ce.Q,{title:e.title,onApprove:()=>e.currentRequest.respond({confirmed:!0}),onDeny:()=>e.currentRequest.error(new Error("Approval Denied"))},et.createElement(R.FA,{gap:24},et.createElement(Ge,{origin:e.currentRequest.event.origin,publicKey:e.publicKey,blockchainId:e.blockchainId}),e.prepend,et.createElement(R.FA,{gap:8},et.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"LNoxLJ"})),et.createElement(E.G7,{bg:"$baseBackgroundL1",borderWidth:2,borderColor:"$baseBorderMed",br:8,padding:16},et.createElement(q.q,{whiteSpace:"pre-wrap"},o))),t&&et.createElement(ve,{origin:e.currentRequest.event.origin,blockchainId:e.blockchainId,actionType:"message signing",publicKey:e.publicKey})))}var nt=n(202784);function rt({currentRequest:e}){const t=e.request.message,n=(0,s.Dv)(I.D5),r=(0,s.Dv)((0,D.I5)(e.request.blockchainId)).name,a=n.publicKeys.platforms[e.request.blockchainId]?.publicKeys[e.request.address],[o,i]=(0,c.useState)(!1);return o||"view-only"!==a?.type?nt.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},nt.createElement(tt,{publicKey:e.request.address,currentRequest:e,title:P.ag._({id:"d/fih0",values:{networkName:r}}),message:t,blockchainId:e.request.blockchainId})):nt.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>i(!0)})}var at=n(770522),ot=n(202784);const it=({originIcon:e,originAddress:t,event:n})=>ot.createElement(ot.Fragment,null,ot.createElement(R.sL,{justifyContent:"space-evenly",alignItems:"flex-start",flexWrap:"nowrap"},ot.createElement(R.FA,{justifyContent:"center",alignItems:"center",flexBasis:"100%"},ot.createElement(re.b,{size:60,borderRadius:"$DEPRECATED_6",circular:!0,overflow:"hidden",alignItems:"center",justifyContent:"center",alignContent:"stretch"},ot.createElement(te.E,{source:{width:60,height:60,uri:"https://assets.coingecko.com/coins/images/1/large/bitcoin.png"}})),ot.createElement(q.q,{paddingTop:"$DEPRECATED_3",fontSize:"$sm",color:"$baseTextMedEmphasis",textAlign:"center"},"BTC"))),ot.createElement(R.FA,{justifyContent:"center",gap:"$DEPRECATED_4"},ot.createElement(R.FA,{gap:"$DEPRECATED_4"},ot.createElement(q.q,{fontWeight:"$semiBold",color:"$baseTextHighEmphasis"},P.ag._({id:"Wcv9QD"})),ot.createElement(R.sL,{alignItems:"center",justifyContent:"flex-start",gap:"$DEPRECATED_3"},ot.createElement(re.b,{size:24,overflow:"hidden",alignItems:"center",justifyContent:"center",alignContent:"stretch"},ot.createElement(te.E,{source:{width:24,height:24,uri:e}})),ot.createElement(R.FA,{space:"$DEPRECATED_1"},ot.createElement(q.q,{fontWeight:"$bold",fontSize:"$md"},new URL(t).host),ot.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$xs"},n.origin.name))))));var st=n(202784);const ct=({transactionDetails:e})=>{const[t,n]=(0,c.useState)(!0);return st.createElement(R.FA,{gap:"$DEPRECATED_3"},st.createElement(q.q,{fontWeight:"$semiBold",color:"$baseTextHighEmphasis"},P.ag._({id:"FBjQ7Q"})),st.createElement(R.FA,{gap:"$DEPRECATED_2",borderRadius:"$DEPRECATED_4",alignItems:"unset",paddingRight:"$DEPRECATED_2",paddingLeft:"$DEPRECATED_2",paddingBottom:"$DEPRECATED_2",justifyContent:"space-between",backgroundColor:"$baseBackgroundL1",borderColor:"$baseBorderMed",borderWidth:1},st.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",paddingTop:"$DEPRECATED_2",paddingLeft:"$DEPRECATED_2",paddingRight:"$DEPRECATED_2",backgroundColor:"$baseBackgroundL1",onPress:()=>n(!t),hoverStyle:{cursor:"pointer"}},st.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"xHsq4r"})),t?st.createElement(he._,{color:"$baseIcon"}):st.createElement(be.K,{color:"$baseIcon"})),!t&&st.createElement(N.ey,{transactionDetails:e})))};var lt=n(202784);function ut({currentRequest:e}){const t=(0,c.useCallback)((()=>{e.respond()}),[e]),n=(0,c.useCallback)((()=>{e.error(new Error("Approval Denied"))}),[e]);return lt.createElement(Ce.Q,{title:P.ag._({id:"XI+xA3"}),onApprove:t,rightButton:lt.createElement(j.x,{label:P.ag._({id:"Z7ZXbT"}),onPress:t,variant:"primary"}),onDeny:n},lt.createElement(dt,{currentRequest:e,onDeny:n}))}function dt({currentRequest:e,onDeny:t}){const{request:n,event:r}=e,a=n.psbt,o=(0,s.Dv)((0,at.uV)({txHex:a,blockchainId:n.blockchainId,isPsbtFormat:!0})),i=r.origin.address,l=i.startsWith("http")&&!i.includes("localhost")?`https://www.google.com/s2/favicons?domain=${i}&sz=50`:w.rI,u=(0,s.Dv)(I.D5),d=u.publicKeys.platforms[n.blockchainId]?.publicKeys[e.request.address],[m,g]=(0,c.useState)(!1),p=o?.inputs??[],E=o?.outputs??[],f=o?.transactionSummaries??[],b=o?.formattedFee??"";return m||"view-only"!==d?.type?lt.createElement(R.FA,{gap:"$DEPRECATED_4"},lt.createElement(it,{originIcon:l,originAddress:i,event:r}),p.length+E.length>0&&lt.createElement(R.FA,{gap:"$DEPRECATED_3"},lt.createElement(ct,{transactionDetails:o}),lt.createElement(N.ir,{summaries:f,formattedFee:b}))):lt.createElement(Ne,{origin:r.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>g(!0)})}var mt=n(817022),gt=n.n(mt),pt=n(348834).Buffer,Et=n(202784);function ft({currentRequest:e}){const t=pt.from((0,mt.decode)(e.request.message58??"")).toString("utf-8"),n=(0,s.Dv)(I.D5),r=(0,s.Dv)((0,D.I5)(e.request.blockchainId)).name,a=n.publicKeys.platforms[_.$O.ETHEREUM]?.publicKeys[e.request.publicKey],[o,i]=(0,c.useState)(!1);return o||"view-only"!==a?.type?Et.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},Et.createElement(tt,{publicKey:e.request.publicKey,currentRequest:e,title:P.ag._({id:"aqrlWY",values:{networkName:r}}),message:t,blockchainId:e.request.blockchainId})):Et.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>i(!0)})}var bt=n(971186),ht=n(959523),yt=n(887388),$t=n(812626),At=n(533767);const vt=(0,B.O4)(At.y4.APPROVED_TRANSACTION_PROGRAMS,[],(0,B.FL)((function(){return{getItem:async e=>await $t.f.get(e)||JSON.stringify([]),removeItem:async e=>$t.f.remove(e),setItem:async(e,t)=>$t.f.set(e,t)}}))),Tt=(0,F.cn)(null,(async(e,t,{programsHash:n,programIds:r})=>{const a=await Promise.resolve(e(vt)),o=a.find((e=>e.programsHash===n)),i={programsHash:n,programIds:r,approvalCount:(o?.approvalCount??0)+1,lastApprovedAt:Date.now()},s=a.filter((e=>e.programsHash!==n));t(vt,[i,...s].slice(0,200))}));function xt({programIds:e,displayProgramIds:t,blockchainId:n,currentRequest:r,lowercaseHash:a=!1,shouldTrack:o}){const i=(0,s.Dv)(vt),l=(0,s.b9)(Tt),u=(0,c.useMemo)((()=>o?function(e,t=!1){return function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return(t>>>0).toString(16).padStart(8,"0")}((t?[...e].map((e=>e.toLowerCase())).sort():[...e].sort()).join(","))}(e,a):null),[e,a,o]),d=(0,c.useMemo)((()=>{if(!o||!u)return;const e=i.find((e=>e.programsHash===u));return e?{approvalCount:e.approvalCount,lastApprovedAt:e.lastApprovedAt,programIds:t,blockchainId:n}:void 0}),[o,u,i,t,n]);return(0,c.useEffect)((()=>{if(!o||!u)return;const t=async t=>{!t.error&&t.response?.confirmed&&l({programsHash:u,programIds:e})};return r.addAfterResponseHandler(t),()=>{r.removeAfterResponseHandler(t)}}),[r,u,e,l,o]),{programApprovalInfo:d}}(0,F.cn)((e=>async t=>(await Promise.resolve(e(vt))).find((e=>e.programsHash===t))));const kt={"0xa9059cbb":{type:"erc20_transfer",label:"Transfer"},"0x095ea7b3":{type:"erc20_approve",label:"Approve"},"0x23b872dd":{type:"erc20_transfer_from",label:"Transfer From"}};function Ct(e){if(!e.to)return{isStandard:!1,operationType:"contract_call",operationLabel:"Contract Deployment"};if(!(t=e.data)||"0x"===t||""===t)return{isStandard:!0,operationType:"native_transfer",operationLabel:"Transfer"};var t;const n=function(e){return!e||e.length<10?null:e.slice(0,10).toLowerCase()}(e.data);if(n&&kt[n]){const{type:t,label:r}=kt[n];return{isStandard:!1,operationType:t,operationLabel:r,tokenContract:e.to.toLowerCase()}}return{isStandard:!1,operationType:"contract_call",operationLabel:"Contract Call"}}function It(e){return e.length>0}var wt=n(374196);const St=(0,B.xu)((e=>(0,F.cn)((async()=>wt.Y.from(e.tx)))),((e,t)=>e.tx===t.tx)),_t=(0,B.xu)((e=>(0,F.cn)((async t=>(await t((0,D.WK)(e.blockchainId))).getProvider().getFeeData()))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId)),Dt=(0,F.cn)("Normal"),Rt=(0,B.xu)((e=>(0,F.cn)(null)),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId)),qt=(0,B.xu)((e=>(0,F.cn)((async t=>{const n={Normal:125,Fast:150,Degen:200,Custom:100}[t(Dt)],[r,a,o]=await Promise.all([t(_t(e)),t((0,D.WK)(e.blockchainId)),t(St(e))]),i=BigInt(r.gasPrice??0)*BigInt(n)/BigInt(100),s=await a.getPriorityFee();var c,l;return{gasLimit:o.gasLimit.toString(),maxFeePerGas:(c=i,l=s,c>l?c:l).toString(),maxPriorityFeePerGas:s.toString(),nonce:o.nonce}}))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId)),Pt=(0,B.xu)((e=>(0,F.cn)((async t=>{if("Custom"===t(Dt)){const n=t(Rt(e));if(n)return n}return await t(qt(e))}))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId));var Lt=n(639714),Ft=n(747401),Bt=n(634706),Mt=n(192247),Kt=n(540175),zt=n(202784);function Nt(e){return zt.createElement(E.Kq,{overflow:"hidden",borderWidth:2,borderColor:"$baseBorderLight",borderRadius:"$container",backgroundColor:"$baseBackgroundL1",separator:zt.createElement(ne.Z,{borderColor:"$baseDivider"})},e.items.filter((e=>Boolean(e))).map((e=>zt.createElement(Mt.HC,{backgroundColor:"$baseBackgroundL1",key:"string"==typeof e.label?e.label:e.key,onPress:e.onPress,cursor:e.onPress?"pointer":"",alignItems:"center",padding:"$DEPRECATED_0",paddingLeft:"$DEPRECATED_4"},e.label?zt.createElement(R.sL,{paddingRight:"$DEPRECATED_4",justifyContent:"flex-start",alignItems:"center",space:"$DEPRECATED_2"},"string"==typeof e.label?zt.createElement(q.q,{paddingVertical:"$DEPRECATED_3",fontSize:"$sm"},e.label):e.label,e.toolTip?zt.createElement(Kt.u,{restMs:0,delay:0,offset:0},zt.createElement(Kt.u.Trigger,null,zt.createElement(ie.k,{size:"$xs"})),zt.createElement(Kt.u.Content,{padding:"$DEPRECATED_2",borderRadius:"$DEPRECATED_2",backgroundColor:"$invertedBaseBackgroundL0"},"string"==typeof e.toolTip?zt.createElement(q.q,{fontSize:"$sm",color:"$invertedBaseTextHighEmphasis"},e.toolTip):e.toolTip)):null):null,zt.createElement(R.sL,{paddingRight:"$DEPRECATED_3",flex:1,justifyContent:"flex-end",alignItems:"center"},"string"==typeof e.value?zt.createElement(q.q,{paddingVertical:"$DEPRECATED_3",fontSize:"$sm",flex:1,textAlign:"right",color:e.valueColor??"$baseTextHighEmphasis"},e.value):e.value),e.valueAfter?zt.createElement(R.sL,{space:"$DEPRECATED_2",marginLeft:"$DEPRECATED_-2",paddingRight:"$DEPRECATED_3",alignItems:"center"},"string"==typeof e.valueAfter?zt.createElement(q.q,{paddingVertical:"$DEPRECATED_3",fontSize:"$sm",flex:1,textAlign:"right",color:e.valueAfterColor??"$baseTextMedEmphasis"},e.valueAfter):e.valueAfter):null))))}var Ot=n(202784);const jt=["Normal","Fast","Degen","Custom"];function Ut({isOpen:e,setIsOpen:t,isAdvancedMode:n,tx:r,blockchainId:a}){return Ot.createElement(f.yo,{open:e,onOpenChange:t,snapPoints:[60],zIndex:1e5,animation:"quick",dismissOnSnapToBottom:!0},Ot.createElement(f.yo.Overlay,{backgroundColor:"rgba(0,0,0,0.3)"}),Ot.createElement(f.yo.Frame,{position:"relative",borderColor:"$baseBorderMed",borderWidth:"$DEPRECATED_1"},Ot.createElement(Lt.A,{style:{display:"flex",flex:1,flexDirection:"column"}},Ot.createElement(Wt,{isAdvancedMode:n,tx:r,blockchainId:a}))))}function Wt({blockchainId:e,isAdvancedMode:t,tx:n}){const[r,a]=(0,s.KO)(Dt),o=(0,s.b9)(Rt({tx:n,blockchainId:e})),i=(0,s.Dv)(Pt({tx:n,blockchainId:e})),c="Custom"===r,l=t?jt:jt.filter((e=>"Custom"!==e)),u=e=>t=>{try{const n=["maxFeePerGas","maxPriorityFeePerGas"].includes(e)?(0,yt.vz)(t,"gwei").toString():t;o({...i,[e]:n})}catch(e){console.error(e)}};return Ot.createElement(E.Kq,{padding:"$DEPRECATED_4",space:"$DEPRECATED_4"},Ot.createElement(R.sL,{space:"$DEPRECATED_2"},l.map((e=>Ot.createElement(Ft.zx,{key:e,backgroundColor:"$buttonSecondaryBackground",size:"$sm",flexBasis:0,flexGrow:1,height:"$DEPRECATED_3",hoverStyle:{cursor:"pointer"},onPress:()=>(e=>{a(e)})(e)},Ot.createElement(q.q,{color:e===r?"$accentBlue":"$buttonSecondaryText",fontSize:"$sm"},e))))),Ot.createElement(Nt,{items:[{label:P.ag._({id:"qYuscr"}),value:Ot.createElement(Ht,{onChange:u("maxPriorityFeePerGas"),value:parseInt((0,yt.bM)((0,yt.vz)(i.maxPriorityFeePerGas,"wei"),"gwei").toString()),isEditing:c})},{label:P.ag._({id:"3qe4O9"}),value:Ot.createElement(Ht,{onChange:u("maxFeePerGas"),value:parseInt((0,yt.bM)((0,yt.vz)(i.maxFeePerGas,"wei"),"gwei")),isEditing:c})},{label:P.ag._({id:"3kbpgO"}),value:Ot.createElement(Ht,{onChange:u("gasLimit"),value:i.gasLimit,isEditing:c})},{label:P.ag._({id:"kdW3qS"}),value:Ot.createElement(Ht,{onChange:u("nonce"),value:i.nonce,isEditing:c})}]}))}function Ht({onChange:e,value:t,isEditing:n}){return n?Ot.createElement(Bt.YP,{backgroundColor:"$baseBackgroundL0",borderColor:"$borderColor",borderRadius:8,borderWidth:2,fontSize:"$sm",height:30,px:12,py:0,width:100,ta:"right",value:String(t),onChangeText:e}):Ot.createElement(q.q,{fontSize:"$sm"},t)}var Vt=n(280109);function Gt(e,t=0,n){const[r,a]=(0,c.useState)({isFetched:!1,data:null});var o,i,s;return o=async(r,o)=>{let i=null,s=0;a({isFetched:!1,data:null});const c=()=>e().then((e=>{r()&&a({data:e,isFetched:!0})})).catch((e=>{r()&&a({data:null,error:e,isFetched:!0})})).finally((()=>{r()&&t>0&&(!n||s<n)&&(s++,i=setTimeout(c,t))}));c(),o((async()=>{clearTimeout(i)}))},i=e=>{console.error(e)},s=[e,t,n],(0,c.useEffect)((()=>{let e=!0;const t=()=>e,n=[];return o(t,(e=>{n.push(e)})).catch((e=>i(e))),()=>{e=!1,Promise.allSettled(n.map((e=>e())))}}),s),r}function Zt(e){if(e)try{return new URL(e).origin}catch(e){return}}const Qt=(e,t,n,r,a,o)=>{const i=Zt(r)||"",s=Gt((0,c.useCallback)((async()=>{if(!e)return{skipped:!0};try{const r=new AbortController,o=r.signal;setTimeout((()=>{r.abort()}),9e3);const s={chain:t,data:n.map((e=>({from:e.from??a,to:e.to,data:e.data,value:e.value.toString()})))[0],account_address:a,options:["validation","simulation"],metadata:{domain:i}},c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},l=`${e}`,u=await(0,Vt.R)(l,{...c,signal:o},fetch);if(u.ok)return{evaluation:await u.json()};{const e=await u.json();return{error:new Error(`Blockaid API returned non-200 response: ${u.status}: ${JSON.stringify(e)}`)}}}catch(e){return e.message.toLowerCase().includes("aborted")?{error:new Error("Request timeout reached")}:{error:e}}}),[JSON.stringify({transactions:n,origin:i,userAccount:a})]),1e4,5),l=(0,c.useMemo)((()=>{const e=s.data?.evaluation;return{isLoading:!s.isFetched,error:s.data?.error||s.error,evaluation:e,normalizedEvaluation:e?Jt(e):void 0,skipped:s.data?.skipped}}),[s]),u=l.error;return(0,c.useEffect)((()=>{u&&o(u)}),[o,u]),l};function Jt(e){try{const{validation:t,simulation:n}=e;if(!t||!n)return{action:"NONE",warnings:[],errors:[P.ag._({id:"7ZIkfZ"})]};const r=[];"Error"===t.result_type&&r.push(t.error),"error"in n&&r.push(n.error);const a={Benign:"NONE",Warning:"WARN",Malicious:"BLOCK",Error:"WARN"},o={Benign:"INFO",Warning:"WARNING",Malicious:"CRITICAL",Error:"WARNING"},i="Benign"===t.result_type?void 0:{severity:o[t.result_type],message:t.description??""},s="assets_diffs"in n?n.assets_diffs??{}:{},c="transaction_actions"in n&&Array.isArray(n.transaction_actions)&&n.transaction_actions.includes("approval"),l=[];return"exposures"in n&&n.exposures&&Object.values(n.exposures).forEach((e=>{e.forEach((e=>{if("spenders"in e&&e.spenders){const t=e.asset,n="name"in t?t.name??"":"",r="symbol"in t?t.symbol??"":"",a="logo_url"in t?t.logo_url:void 0;Object.entries(e.spenders).forEach((([e,t])=>{const o=t.exposure?.[0],i=o?.value??o?.raw_value??"";l.push({tokenName:n,tokenSymbol:r,tokenLogoUrl:a,amount:i,spenderAddress:e})}))}}))})),{action:a[t.result_type],warnings:[...i?[i]:[]],errors:r,isApproval:c,approvals:l.length>0?l:void 0,expectedStateChanges:Object.fromEntries(Object.entries(s).map((([e,t])=>[e,t.map((e=>{const t=t=>n=>{const r=`${n.summary??""}`,a="logo_url"in e.asset&&e.asset.logo_url?{isNonFungible:"ERC721"===e.asset.type||"ERC1155"===e.asset.type,imageUrl:e.asset.logo_url,name:e.asset.name??e.asset.symbol??""}:void 0;return{humanReadableDiff:r,suggestedColor:"in"===t?"CREDIT":"DEBIT",asset:a}};return[...e.in.map(t("in")),...e.out.map(t("out"))]})).flat()])))}}catch(e){return void console.error(e,"Unexpected Blockaid Schema")}}var Xt=n(202784);function Yt({currentRequest:e}){const t=(0,s.Dv)(I.D5),n=(0,s.Dv)((0,D.I5)(e.request.blockchainId)),r=(0,s.Dv)(d.F),a=(0,Y.gI)(e.request.blockchainId),[o,i]=(0,c.useState)(!1),l=(0,s.Dv)(St({tx:e.request.txHex})),m=Qt(n.txSimulationUrl,n.caip2Reference,[l],e.event.origin.address,e.request.publicKey,(e=>{i(!0),console.error(e)})),g=(0,s.Dv)(Dt),p=(0,ht.G)(Pt({tx:e.request.txHex,blockchainId:e.request.blockchainId})),E="hasData"===p.state?p.data:void 0,f="loading"===p.state,b="hasError"===p.state?p.error:null,[h,$]=(0,c.useState)(!1),[A,v]=(0,c.useState)(!0),T=(0,c.useMemo)((()=>Ct(l)),[l]),x=T.isStandard,k=(0,c.useMemo)((()=>function(e){if(function(e){return Ct(e).isStandard}(e))return[];const t=[];return e.to&&t.push(e.to.toLowerCase()),t}(l)),[l]),{programApprovalInfo:C}=xt({programIds:k,displayProgramIds:k,blockchainId:e.request.blockchainId,currentRequest:e,lowercaseHash:!0,shouldTrack:It(k)}),w=E?BigInt(l.gasLimit??0)*BigInt(E.maxFeePerGas)+BigInt(l.gasLimit??0)*BigInt(E.maxPriorityFeePerGas):0,S=()=>e.error(new Error("Approval Denied")),_=(o||m.error||!m.normalizedEvaluation||b)&&!m.skipped&&A;return Xt.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},m.isLoading?Xt.createElement(y,null):_?Xt.createElement(ke.P,{title:P.ag._({id:"/bIfDH"}),warning:{severity:"WARNING",message:P.ag._({id:"RPttCT"})},onIgnore:()=>v(!1),onDeny:S}):Xt.createElement(Le,{origin:e.event.origin,relevantAddresses:e.event.uiOptions.relevantAccounts,signerPublicKey:e.request.publicKey,isApproveLoading:!E||f,onDeny:S,onApprove:async()=>{E&&(e.respond({...E,confirmed:!0}),await(0,bt.D)(2),await r.query({query:u.v6,fetchPolicy:"network-only",context:u.cE,variables:{address:e.request.publicKey,caip2:a}}))},evaluation:m.normalizedEvaluation,programApprovalInfo:C,blockchainId:e.request.blockchainId,contractIds:k,isStandardTransaction:x,operationLabel:T.operationLabel,append:[Xt.createElement(R.FA,{key:"Speed",space:"$DEPRECATED_4"},Xt.createElement(q.q,{fontWeight:"$bold",color:"$baseTextHighEmphasis"},P.ag._({id:"5HVoyc"})),Xt.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},Xt.createElement(R.FA,{space:"$DEPRECATED_1"},Xt.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"l9wI00"}))),Xt.createElement(R.sL,{borderRadius:"$DEPRECATED_4",space:"$DEPRECATED_2",alignItems:"center",justifyContent:"center",paddingLeft:"$DEPRECATED_3",paddingRight:"$DEPRECATED_2",paddingVertical:"$DEPRECATED_2",backgroundColor:"$baseBackgroundL1",onPress:()=>{$(!0)},hoverStyle:{cursor:"pointer"}},Xt.createElement(q.q,{fontSize:"$sm"},g),Xt.createElement(he._,{size:"$sm"}))),Xt.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},Xt.createElement(R.FA,{space:"$DEPRECATED_1"},Xt.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"HD9fD0"}))),Xt.createElement(q.q,{fontSize:"$sm"},`${(0,yt.bM)(w,18)} ${n.gasCurrencySymbol}`)))]}),Xt.createElement(Ut,{isOpen:h,setIsOpen:$,isAdvancedMode:!!t.preferences.developerMode,blockchainId:e.request.blockchainId,tx:e.request.txHex}))}var en=n(202784);function tn({currentRequest:e}){const t=(0,s.Dv)(I.D5),n=t.publicKeys.platforms[e.request.blockchainId]?.publicKeys[e.request.publicKey],[r,a]=(0,c.useState)(!1);return r||"view-only"!==n?.type?en.createElement(Yt,{currentRequest:e}):en.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>a(!0)})}var nn=n(202784);function rn({currentRequest:e}){const t=(0,s.Dv)(I.D5),n=(0,s.Dv)((0,D.I5)(e.request.blockchainId)).name,r=t.publicKeys.platforms[_.$O.ETHEREUM]?.publicKeys[e.request.publicKey],[a,o]=(0,c.useState)(!1);if(!a&&"view-only"===r?.type)return nn.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>o(!0)});const i=JSON.parse(e.request.typedDataPayload),l=`Message:\n${JSON.stringify(i.message,null,"  ")}\n\nDomain:\n${JSON.stringify(i.domain,null,"  ")}\n`;return nn.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},nn.createElement(tt,{publicKey:e.request.publicKey,currentRequest:e,title:P.ag._({id:"aqrlWY",values:{networkName:n}}),message:l,blockchainId:e.request.blockchainId}))}var an=n(348834).Buffer,on=n(202784);function sn({currentRequest:e}){const t=an.from(e.request.message??"","base64").toString("utf-8"),n=(0,s.Dv)(I.D5),r=(0,s.Dv)((0,D.I5)(e.request.blockchainId)).name,a=n.publicKeys.platforms[e.request.blockchainId]?.publicKeys[e.request.publicKey],[o,i]=(0,c.useState)(!1);return o||"view-only"!==a?.type?on.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},on.createElement(tt,{publicKey:e.request.publicKey,currentRequest:e,title:P.ag._({id:"aqrlWY",values:{networkName:r}}),message:t,blockchainId:e.request.blockchainId})):on.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>i(!0)})}const cn="https://coin-images.coingecko.com/coins/images/26375/large/sui_asset.jpeg?1696525453",ln=9e3,un=1e4,dn=5;function mn(e){try{const{simulation:t,validation:n}=e;if(!n||!t)return{action:"NONE",errors:[P.ag._({id:"7ZIkfZ"})],warnings:[]};const r={action:"NONE",errors:[],expectedStateChanges:{},warnings:[]};if("Error"===t.status)r.errors.push(t.error);else{const e=t.assets_diffs??{};r.expectedStateChanges=Object.fromEntries(Object.entries(e).map((([e,t])=>{const n=t.flatMap((e=>{const t=t=>n=>({humanReadableDiff:`${n?.summary??""}`,suggestedColor:"in"===t?"CREDIT":"DEBIT",asset:"NATIVE"===e.asset.type?{imageUrl:cn,isNonFungible:!1,name:e.asset.symbol}:"fungible"===e.asset.type?{imageUrl:e.asset.logo_url??w.rI,isNonFungible:!1,name:e.asset.symbol}:{imageUrl:e.asset.url??w.Z8,isNonFungible:!0,name:e.asset.name}}),n=[];return e.in&&n.push(t("in")(e.in)),e.out&&n.push(t("out")(e.out)),n})).flat();return[e,n]})))}if("Error"===n.status)r.errors.push(n.error),r.action="WARN";else{const e={Benign:"NONE",Warning:"WARN",Malicious:"BLOCK",Error:"BLOCK"};r.action=e[n.result_type];const t={Benign:"INFO",Warning:"WARNING",Malicious:"CRITICAL",Error:"CRITICAL"};"Benign"!==n.result_type&&r.warnings.push({severity:t[n.result_type],message:n.description??""})}return r}catch(e){return void console.error(e,"Unexpected Blockaid Schema")}}const gn=(0,B.xu)((({tx:e,publicKey:t,blockchainId:n})=>(0,F.cn)((async r=>{try{const a=await r((0,D.lW)(n));return await a.simTransaction({tx:e,senderAddress:t})}catch(t){return console.error("SUI simulation failed:",t),{error:t.message||"Simulation failed",preparedTx:e,estimatedGasCost:BigInt("2500000"),gasBudget:BigInt("20000000")}}}))),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId));var pn=n(202784);function En({currentRequest:e}){const t=(0,s.Dv)((0,D.I5)(e.request.blockchainId)),n=(0,s.Dv)(d.F),r=(0,Y.gI)(e.request.blockchainId),a=(0,c.useMemo)((()=>({tx:e.request.tx,publicKey:e.request.publicKey,blockchainId:e.request.blockchainId})),[e.request.tx,e.request.publicKey,e.request.blockchainId]),o=(0,s.Dv)(gn(a)),i=o?.preparedTx&&!o?.error?o.preparedTx:e.request.tx,l=function(e,t,n,r,a,o){const i=Zt(r)||"",s=Gt((0,c.useCallback)((async()=>{if(!e)return{};try{const r=new AbortController,o=r.signal;setTimeout((()=>{r.abort()}),ln);const s={account_address:a??"",chain:t,metadata:{type:"wallet",url:i},options:["simulation","validation"],transaction:n},c=await(0,Vt.R)(e,{signal:o,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},fetch);if(c.ok)return{evaluation:await c.json()};{const e=await c.json();return{error:new Error(`Blockaid API returned non-200 response: ${c.status}: ${JSON.stringify(e)}`)}}}catch(e){return e.message.toLowerCase().includes("aborted")?{error:new Error("Request timeout reached")}:{error:e}}}),[e,t,n,i,a]),un,dn),l=(0,c.useMemo)((()=>{const e=s.data?.evaluation;return{isLoading:!s.isFetched,error:s.data?.error||s.error,normalizedEvaluation:e?mn(e):void 0}}),[s]);return(0,c.useEffect)((()=>{const e=l.error;e&&o(e)}),[o,l.error]),l}(t.txSimulationUrl,t.caip2Reference,i,e.event.origin.address,e.request.publicKey,(e=>{console.error(e)}));return pn.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},l.isLoading?pn.createElement(y,null):pn.createElement(Le,{origin:e.event.origin,relevantAddresses:e.event.uiOptions.relevantAccounts,signerPublicKey:e.request.publicKey,isApproveLoading:l.isLoading,onDeny:()=>e.error(new Error("Approval Denied")),onApprove:async()=>{e.respond({confirmed:!0,preparedTx:i}),await(0,bt.D)(2),await n.query({query:u.v6,fetchPolicy:"network-only",context:u.cE,variables:{address:e.request.publicKey,caip2:r}})},evaluation:l.normalizedEvaluation,append:[pn.createElement(R.FA,{key:"Speed",space:"$DEPRECATED_4"},pn.createElement(q.q,{fontWeight:"$bold",color:"$baseTextHighEmphasis"},P.ag._({id:"5HVoyc"})),pn.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},pn.createElement(R.FA,{space:"$DEPRECATED_1"},pn.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"oAu/uq"}))),pn.createElement(q.q,{fontSize:"$sm"},o?.estimatedGasCost?`${(0,S.Ou)(o.estimatedGasCost,t.gasCurrencyDecimals)} ${t.gasCurrencySymbol}`:P.ag._({id:"Ef7StM"}))),pn.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},pn.createElement(R.FA,{space:"$DEPRECATED_1"},pn.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"NZHZoK"}))),pn.createElement(q.q,{fontSize:"$sm"},o?.gasBudget?`${(0,S.Ou)(o.gasBudget,t.gasCurrencyDecimals)} ${t.gasCurrencySymbol}`:P.ag._({id:"Ef7StM"}))),pn.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},pn.createElement(R.FA,{space:"$DEPRECATED_1"},pn.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"OR475H"}))),pn.createElement(q.q,{fontSize:"$sm"},t.caip2Reference)))]}))}var fn=n(202784);function bn({currentRequest:e}){const t=e.request.blockchainId,n=(0,s.Dv)(I.D5),r=n.publicKeys.platforms[t]?.publicKeys[e.request.publicKey],[a,o]=(0,c.useState)(!1);return a||"view-only"!==r?.type?fn.createElement(En,{currentRequest:e}):fn.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>o(!0)})}var hn=n(312397),yn=n(202784);function $n({size:e=32}){const t=e/32,r=11*t,a=16*t;return yn.createElement(hn.C,{size:e,bg:"black",ai:"center",jc:"center"},yn.createElement("img",{src:n(630765),alt:"Backpack",style:{width:r,height:a}}))}function An({size:e=32}){const t=e/32,r=11*t,a=16*t;return yn.createElement("img",{src:n(630765),alt:"Backpack",style:{width:r,height:a}})}var vn=n(159469),Tn=n(202784);function xn({currentRequest:e}){const[t,n]=(0,c.useState)("");return Tn.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},Tn.createElement(Ce.Q,{title:P.ag._({id:"p2TRE9"}),rightButton:"Submit",leftButton:"Cancel",onDeny:()=>e.error(new Error("Approval Denied")),onApprove:()=>{e.respond({emailToken:"",authenticatorToken:t})},rightButtonDisabled:""===t,style:{height:"100%",flex:1}},Tn.createElement(R.FA,{gap:"$4"},Tn.createElement(R.FA,{flex:1,gap:"$4",justifyContent:"center",alignItems:"center"},Tn.createElement(R.FA,{ai:"center",jc:"center"},Tn.createElement($n,{size:100}))),Tn.createElement(R.FA,{gap:"$4"},Tn.createElement(R.FA,{gap:"$2"},Tn.createElement(q.q,{fontWeight:"$bold"},P.ag._({id:"vYuKA0"})),Tn.createElement(vn.t,{value:t,onChangeText:n}),e.request.error?Tn.createElement(q.q,{fontSize:"$xs",color:"$redText"},e.request.error):null)))))}var kn=n(2716),Cn=n(242033),In=n(326951),wn=n(622845),Sn=n(25825),_n=n(202784);function Dn({currentRequest:e}){const t=(0,In.F)(),n=e.request,r=(0,s.Dv)(Cn.R2),a=n.finality,o=n.txs,[i,l]=(0,c.useState)(P.ag._({id:"KBGMfP"})),[u,d]=(0,c.useState)(n.signOnlyApi??!1),[m,g]=(0,c.useState)([]),[p,E]=(0,c.useState)(!0),f=(0,s.Dv)(kn.gI),[b,h]=(0,c.useState)(null),[y,$]=(0,c.useState)(""),[A,v]=(0,c.useState)(!1),T=(0,s.Dv)((0,D.Pg)(e.request.blockchainId)),[x,k]=(0,c.useState)("confirming"),C=(0,c.useCallback)((()=>{v(!0)}),[]);return(0,c.useEffect)((()=>{(async()=>{if(!u)try{const t=[];for(let e=0;e<o.length;e++){const n=o[e];if(o.length>1){const t=e+1,n=o.length;l(P.ag._({id:"s80tqU",values:{txIndex:t,txLength:n}}))}try{t.push(await T.wallet.sendAndConfirmTransaction(n,a))}catch(t){if(!(f.developerMode&&Array.isArray(n)&&t.message.includes("Bundle failed.")&&n.length>=4))return h(t?.message),k("error"),void E(!1);h("Bundle failed. Attempting to submit txs individually (dev mode)."),o.splice(e+1,0,...n)}}if(g(t),E(!1),k("done"),l(t.length>1?P.ag._({id:"xRxKR3"}):P.ag._({id:"am4Ozo"})),n.autoClose&&!b){const n=[...t];setTimeout((()=>{e.respond({confirmed:n})}),500)}}catch(e){E(!1),h(e?.message),k("error")}})()}),[u]),u?_n.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},_n.createElement(Ce.Q,{title:P.ag._({id:"ylJqq+"}),rightButton:P.ag._({id:"JlFcis"}),leftButton:P.ag._({id:"dEgA5A"}),style:{height:"100%",flex:1},onDeny:()=>e.error(new Error("sendTransaction not supported")),onApprove:()=>d(!1)},_n.createElement(R.FA,{flex:1,gap:"$4"},_n.createElement(R.FA,{gap:"$4",borderRadius:"$4",backgroundColor:"$baseBackgroundL2",padding:"$4",justifyContent:"center",alignItems:"center",flex:1},_n.createElement(hn.C,{width:60,height:60,backgroundColor:"$baseBackgroundL1",justifyContent:"center",alignItems:"center"},_n.createElement(ie.k,{size:32,color:"$baseIcon"})),_n.createElement(q.q,{fontSize:"$lg",textAlign:"center",color:"$baseTextHighEmphasis"},P.ag._({id:"KSEhsz"}),_n.createElement("br",null),P.ag._({id:"tlQcew"})),_n.createElement(q.q,{fontSize:"$sm",textAlign:"center",color:"$baseTextMedEmphasis"},P.ag._({id:"tFplh6"}))),_n.createElement(R.FA,{gap:"$2",borderRadius:"$4",backgroundColor:"$yellowBackgroundTransparent",padding:"$4"},_n.createElement(q.q,{fontSize:"$xs",lineHeight:"$xs",textAlign:"center",color:"$yellowText"},P.ag._({id:"jakhlf"}),_n.createElement(q.q,{fontSize:"$xs",fontWeight:"$bold",color:"$yellowText"},"",P.ag._({id:"JlFcis"}),""),P.ag._({id:"NP1fy8"}),_n.createElement(q.q,{fontSize:"$xs",fontStyle:"italic",color:"$yellowText"},"",P.ag._({id:"LylsL3"}),""),P.ag._({id:"mhuLC9"}),_n.createElement(q.q,{fontSize:"$xs",fontStyle:"italic",color:"$yellowText"},"",P.ag._({id:"Des+zi"}),""),P.ag._({id:"iafjV0"}))),_n.createElement(R.FA,{gap:"$2",borderRadius:"$4",backgroundColor:"$baseBackgroundL2",padding:"$4"},_n.createElement(q.q,{fontSize:"$xs",lineHeight:"$xs",textAlign:"left",color:"$baseTextMedEmphasis"},P.ag._({id:"SpTRS8"})))))):_n.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},_n.createElement(Ce.Q,{rightButton:null,leftButton:p?"Cancel":"Done",onDeny:()=>p?e.error(new Error("Cancelled by user")):"error"===x?e.error(new Error(b??"Transaction failed")):e.respond({confirmed:m}),style:{height:"100%",flex:1}},_n.createElement(R.FA,{flex:1,padding:"$4",gap:"$4",justifyContent:"space-between"},_n.createElement(R.FA,{justifyContent:"space-around",flex:1},_n.createElement(R.FA,{justifyContent:"center",alignItems:"center"},["creating","sending","confirming"].includes(x)?_n.createElement(hn.C,{width:100,height:100,justifyContent:"center",alignItems:"center",borderColor:"$accentBlue",borderWidth:2},_n.createElement(Sn.Z,{size:"large",color:t.accentBlue.get()})):null,"done"===x?_n.createElement(wn.SW,null):null,"error"===x?_n.createElement(wn.Jc,null):null),_n.createElement(R.FA,{gap:"$4"},b?_n.createElement(q.q,{color:"$redText",textAlign:"center"},b):null,"error"!==x?_n.createElement(q.q,{textAlign:"center"},i):null,"error"!==x||A||r.info.type!==_.B$.BP_SAFE?null:_n.createElement(R.FA,{gap:"$2"},_n.createElement(q.q,{fontSize:"$xs",color:"$baseTextMedEmphasis"},P.ag._({id:"jTym1G"})),_n.createElement(vn.t,{multiline:!0,numberOfLines:2,value:y,onValueChange:e=>{$(e)},onSubmitEditing:()=>{C()}}),_n.createElement(j.x,{label:P.ag._({id:"FsGPqI"}),onPress:()=>{C()}})),A?_n.createElement(q.q,{textAlign:"center"},P.ag._({id:"c2sYw2"})):null)))))}var Rn=n(627158),qn=n(730633);const Pn=new Rn.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),Ln=new Rn.PublicKey("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb"),Fn=new Rn.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),Bn=new Set([Rn.SystemProgram.programId.toBase58(),Rn.ComputeBudgetProgram.programId.toBase58(),Pn.toBase58(),Ln.toBase58(),Fn.toBase58(),qn.I.toBase58()]);function Mn(e){return e.filter((e=>!Bn.has(e))).length>0}function Kn(e){return e.filter((e=>!Bn.has(e)))}var zn=n(564861),Nn=n(579187),On=n(861326),jn=n(219681),Un=n(348578),Wn=n(358542);const Hn={address:"6sakMYJnFJnXzkdiG5Le6MEr7M5xAbBEP4AJabFRHf7r",metadata:{name:"safe_alt_lookup",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},instructions:[{name:"close_lookup_table",discriminator:[126,212,90,115,184,193,181,218],accounts:[{name:"user",writable:!0,signer:!0},{name:"multisig"},{name:"alt_lookup",writable:!0,pda:{seeds:[{kind:"const",value:[98,97,99,107,112,97,99,107,95,97,108,116,95,108,111,111,107,117,112]},{kind:"account",path:"multisig"},{kind:"account",path:"user"}]}},{name:"closable_alt",writable:!0,pda:{seeds:[{kind:"account",path:"user"},{kind:"account",path:"alt_lookup.slots [slot_index as usize]",account:"AltLookup"}],program:{kind:"account",path:"lookup_table_program"}}},{name:"lookup_table_program",address:"AddressLookupTab1e1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"slot_index",type:"u8"}]},{name:"create_lookup_table",discriminator:[74,26,45,214,23,155,143,153],accounts:[{name:"user",writable:!0,signer:!0},{name:"multisig"},{name:"alt_lookup",writable:!0,pda:{seeds:[{kind:"const",value:[98,97,99,107,112,97,99,107,95,97,108,116,95,108,111,111,107,117,112]},{kind:"account",path:"multisig"},{kind:"account",path:"user"}]}},{name:"new_alt",writable:!0,pda:{seeds:[{kind:"account",path:"user"},{kind:"arg",path:"slot"}],program:{kind:"account",path:"lookup_table_program"}}},{name:"current_alt",writable:!0,pda:{seeds:[{kind:"account",path:"user"},{kind:"account",path:"alt_lookup"}],program:{kind:"account",path:"lookup_table_program"}}},{name:"closable_alt",writable:!0,pda:{seeds:[{kind:"account",path:"user"},{kind:"account",path:"alt_lookup"}],program:{kind:"account",path:"lookup_table_program"}}},{name:"lookup_table_program",address:"AddressLookupTab1e1111111111111111111111111"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"slot",type:"u64"}]},{name:"destroy_alt_lookup",discriminator:[98,25,23,144,211,173,76,90],accounts:[{name:"user",writable:!0,signer:!0},{name:"multisig"},{name:"alt_lookup",writable:!0,pda:{seeds:[{kind:"const",value:[98,97,99,107,112,97,99,107,95,97,108,116,95,108,111,111,107,117,112]},{kind:"account",path:"multisig"},{kind:"account",path:"user"}]}}],args:[{name:"force",type:"bool"}]}],accounts:[{name:"AltLookup",discriminator:[108,187,86,121,217,220,64,47]}],errors:[{code:6e3,name:"SlotNotEmpty",msg:"Expected slot to be empty"},{code:6001,name:"BorrowError",msg:"Failed to borrow lookup table data"},{code:6002,name:"DeserializeError",msg:"Failed to deserialize lookup table data"}],types:[{name:"AltLookup",type:{kind:"struct",fields:[{name:"current_slot_index",type:"u8"},{name:"slots",type:{array:["u64",10]}}]}}]};var Vn=n(348834).Buffer;async function Gn(e,t,n,r){const a=new zn.Program(Hn,{connection:n}),[o]=Rn.PublicKey.findProgramAddressSync([Vn.from("backpack_alt_lookup"),t.toBuffer(),e.toBuffer()],a.programId),[i,s]=await Promise.all([a.account.altLookup.fetchNullable(o),r.getSlot()]);let c=0,l=0;if(i){const e=(i.currentSlotIndex+2)%i.slots.length;c=i.slots[i.currentSlotIndex].toNumber(),l=i.slots[e].toNumber()}const[,u]=await Rn.AddressLookupTableProgram.createLookupTable({authority:e,payer:e,recentSlot:c}),[d,m,g]=await Promise.all([r.getAddressLookupTable((0,Wn.IY)(u)),Rn.AddressLookupTableProgram.createLookupTable({authority:e,payer:e,recentSlot:l}),Rn.AddressLookupTableProgram.createLookupTable({authority:e,payer:e,recentSlot:s})]);return{currentSlot:c,currentAltPublicKey:u,currentAltAccount:d.value?new Rn.AddressLookupTableAccount({key:u,state:Rn.AddressLookupTableAccount.deserialize(d.value.data)}):null,closableSlot:l,closableAltPublicKey:m[1],nextSlot:s,nextAltPublicKey:g[1],altLookupPublicKey:o,altLookupAccount:i,altLookupProgram:a}}const Zn=Un.MI.Multisig,Qn=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=await t((0,D.Pg)(_.Ek.SOLANA_MAINNET)),r=(0,On.u)(e.multisigPda),a=(0,On.u)(e.backpackSigner),[o,i,s,c,l,u]=await Promise.all([Gn((0,On.u)(e.publicKey),(0,On.u)(e.multisigPda),n.connection,n.solanaRpc),Zn.fromAccountAddress(n.connection,r),n.solanaRpc.getBalance((0,Wn.IY)(a)),n.solanaRpc.getMinimumBalanceForRentExemption(920),n.solanaRpc.getMinimumBalanceForRentExemption(0),fetch(jn.xc)]),d=(await u.json())[0];return{altLookups:o,multisigAccount:i,backpackSignerBalance:s,dataRentExemption:c,noDataRentExemption:l,costPerByte:c/920,jitoTipInSol:Math.max(d?.landed_tips_99th_percentile??0,(d?.landed_tips_95th_percentile??0)+(d?.landed_tips_50th_percentile??0),5e-5)}}))),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.multisigPda===t.multisigPda&&e.backpackSigner===t.backpackSigner));var Jn=n(280023),Xn=n(859083);const Yn=(0,B.xu)((({tx:e,blockchainId:t})=>(0,F.cn)((async n=>{try{const r=await n((0,D.Pg)(t)),a=Rn.VersionedTransaction.deserialize((0,mt.decode)(e)),o=a.message,i=[],s=o.addressTableLookups;if(s.length>0)for(const e of s){const t=await r.solanaRpc.getAddressLookupTable((0,Wn.IY)(e.accountKey));if(t.value){const n=new Rn.AddressLookupTableAccount({key:e.accountKey,state:Rn.AddressLookupTableAccount.deserialize(t.value.data)});i.push(n)}}const c=a.message.getAccountKeys({addressLookupTableAccounts:i}),l=c.staticAccountKeys.map((e=>e.toBase58())),u=c.accountKeysFromLookups?.writable.map((e=>e.toBase58()))??[],d=c.accountKeysFromLookups?.readonly.map((e=>e.toBase58()))??[],m=o.header.numRequiredSignatures,g=l.length-m,p=o.header.numReadonlySignedAccounts,E=o.header.numRequiredSignatures-p,f=o.header.numReadonlyUnsignedAccounts,b=g-f;return{signedWritable:l.slice(0,E),signedReadonly:l.slice(E,E+p),writable:l.slice(m,m+b).concat(u),readonly:l.slice(-f).concat(d),addressLookupTableAccounts:i}}catch{return{signedWritable:[],signedReadonly:[],writable:[],readonly:[],addressLookupTableAccounts:[]}}}))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId)),er=14e5,tr=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=Rn.VersionedTransaction.deserialize(gt().decode(e.tx));let r;try{r=await t(Yn(e))}catch(e){return console.error("Failed to fetch transaction accounts:",e),null}const a=await t((0,D.Pg)(e.blockchainId)),{isSimulateSolanaTransactionsEnabled:o}=await t(Xn.v);try{const e=Rn.TransactionMessage.decompile(n.message,r.addressLookupTableAccounts?{addressLookupTableAccounts:r.addressLookupTableAccounts}:void 0),t=2e5*e.instructions.length,i=await async function(e,t,n,r){const a=new Promise((a=>{(async()=>{if(e){const e=setTimeout((()=>(console.error("Simulation timeout"),a(null))),5e3);try{const o=function(e,t){const n=[...t.instructions];n.some((e=>e.programId.equals(Rn.ComputeBudgetProgram.programId)&&2===e.data[0]))||n.unshift(Rn.ComputeBudgetProgram.setComputeUnitLimit({units:er})),n.some((e=>e.programId.equals(Rn.ComputeBudgetProgram.programId)&&3===e.data[0]))||n.unshift(Rn.ComputeBudgetProgram.setComputeUnitPrice({microLamports:1}));const r=new Rn.TransactionMessage({...t,instructions:n}),a=new Rn.VersionedTransaction(r.compileToV0Message());return a.signatures=e.signatures,a}(n,r),i=(0,Jn.Tl)(o),s=await t.rpc.simulateTransaction(i,{encoding:"base64",commitment:t.commitment,replaceRecentBlockhash:!0}).send(),c=s.value.unitsConsumed?Number(s.value.unitsConsumed):void 0;if(clearTimeout(e),!c)throw new Error("No units consumed");return a(Math.min(Math.ceil(1.2*c),er))}catch(e){console.error(`Unable to simulate Solana transaction. Falling back to defaults. (${e.message})`)}}a(null)})()}));return await a}(o,a.solanaRpc,n,e);return{transaction:n,message:e,addressLookupTableAccounts:r.addressLookupTableAccounts??[],calculatedComputeUnitLimit:i||t,defaultComputeUnitLimit:t,defaultComputeUnitPrice:BigInt(0)}}catch(e){return null}}))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId)),nr=(0,B.xu)((e=>(0,F.cn)((async t=>(await t((0,D.Pg)(e.blockchainId))).solanaRpc.getBalance((0,Wn.IY)((0,On.u)(e.publicKey))).then((e=>e>0))))),((e,t)=>e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId)),rr=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=await t((0,D.I5)(e.blockchainId));try{return await async function(e,t,n){try{const r=`${t}:${n}`,a=(0,u.im)(u.dF,{caip2:{namespace:t,reference:n},transaction:e}),o=await(0,u.HL)(a),i=new AbortController,s=setTimeout((()=>i.abort()),3e3),c=await fetch(`${w.Fv}/v3/graphql`,{method:"POST",headers:{Accept:"application/json","apollographql-client-name":"backpack-secure-ui","Content-Type":"application/json","x-backpack-cache-key-prefix":r,"x-blockchain-caip2":r,...o},body:JSON.stringify(a),signal:i.signal});clearTimeout(s);const l=await c.json();return l.data?.priorityFeeEstimate??0}catch{return 0}}(e.tx,n.caip2Namespace,n.caip2Reference)}catch(e){return console.error("Failed to get priority fee",e.message),0}}))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId)),ar=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=await t(tr(e));if(!n)return{computeUnitLimit:0,priorityFee:BigInt(0)};const{message:r,calculatedComputeUnitLimit:a,defaultComputeUnitPrice:o}=n,i={computeUnitLimit:a,priorityFee:o};try{const n=r.instructions;let a=0;try{a=await t(rr(e))}catch{a=0}const o=BigInt(a);o>i.priorityFee&&(i.priorityFee=o),n.forEach((e=>{if(e.programId.equals(Rn.ComputeBudgetProgram.programId)){try{const t=Rn.ComputeBudgetInstruction.decodeSetComputeUnitLimit(e);i.computeUnitLimit=t.units}catch{}try{const t=Rn.ComputeBudgetInstruction.decodeSetComputeUnitPrice(e),n=BigInt(t.microLamports);n>i.priorityFee&&(i.priorityFee=BigInt(n))}catch{}}}))}catch(e){console.error("failed to calculate transaction priority fee",e.message)}return i}))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId)),or=(0,B.xu)((e=>(0,F.cn)((async t=>(await Promise.all(e.txs.map((async(n,r)=>t(ir({...e,tx:n,constructedTxOverride:e.constructedOverridesForEachTx?.[r],metadata:{numberOfTransactions:e.txs.length,transactionNumber:r+1}})))))).flat()))),((e,t)=>e.txs.join(",")===t.txs.join(",")&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation&&JSON.stringify(e.constructedOverridesForEachTx)===JSON.stringify(t.constructedOverridesForEachTx))),ir=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=e.metadata??{numberOfTransactions:1,transactionNumber:1};let r=e.constructedTxOverride;const a=e.originAddress===w.UB;if(e.bypassMutation&&!r&&a)try{const n=Rn.VersionedTransaction.deserialize((0,mt.decode)(e.tx)).message,a="instructions"in n?n.instructions:n.compiledInstructions;if(a?.length<=3){let n=0;try{n=await t(rr({tx:e.tx,blockchainId:e.blockchainId}))}catch(e){n=5e4}r={disableFeeConfig:!1,disableDowngradeAccounts:!0,isMaxAmount:e.isMaxAmount||!1,jitoBundle:!1,priorityFee:n.toString(),jitoTipAmount:0,computeUnitLimit:"",downgradedWritableAccounts:[]}}}catch(e){}if(e.isMaxAmount&&r&&(r={...r,isMaxAmount:!0}),!r)return{tx:e.tx,signers:[e.publicKey],metadata:{...n,hasJitoTip:!1,isJitoBundle:!1}};const o=await t(tr(e));if(!o||!o.transaction)return{tx:e.tx,signers:[e.publicKey],metadata:{...n,hasJitoTip:!1,isJitoBundle:!1}};const{transaction:i,message:s,addressLookupTableAccounts:c,defaultComputeUnitLimit:l}=o;try{const t=function(e,t,n,r,a,o){if(!o||o.disableFeeConfig&&o.disableDowngradeAccounts)return e;const i=""!==o.priorityFee&&"0"!==o.priorityFee,s=parseFloat(o.jitoTipAmount?.toString()||"0"),c=s>0;if(!i&&!c&&!o.isMaxAmount)return e;try{const i=t.message.version,l=new Rn.TransactionMessage(n);if(o.jitoBundle&&(l.instructions=l.instructions.filter((e=>{if(e.programId.equals(Rn.ComputeBudgetProgram.programId))try{return!(3===e.data[0])}catch(e){return!0}return!0}))),!o.disableFeeConfig){l.instructions=l.instructions.filter((e=>{if(!e.programId.equals(Rn.ComputeBudgetProgram.programId))return!0;try{const t=e.data;return!(2===t[0]||3===t[0])}catch(e){return!0}}));let e,t=a;if(o.computeUnitLimit&&""!==o.computeUnitLimit){const e=parseInt(o.computeUnitLimit,10);!isNaN(e)&&e>0&&(t=e)}try{if(o.priorityFee&&""!==o.priorityFee){const t=parseFloat(o.priorityFee),n=Math.floor(t).toString();e=BigInt(n)}else e=BigInt(0)}catch(t){e=BigInt(0)}o.isMaxAmount&&(l.instructions=l.instructions.map((n=>{if(n.programId.equals(Rn.SystemProgram.programId))try{const r=Rn.SystemInstruction.decodeTransfer(n);if(!r)return n;const{lamports:a,fromPubkey:i,toPubkey:s}=r,c=(()=>{const n=Number(e)*t,r=Math.round(n/1e6);return BigInt(r+5e3)})()+(o.jitoTipAmount?BigInt(Math.round(o.jitoTipAmount*Nn.j)):BigInt(0));if(a<=c)return console.warn("Transaction amount too small to adjust for fees"),n;const l=a-c;return Rn.SystemProgram.transfer({fromPubkey:i,toPubkey:s,lamports:l})}catch(e){console.error("Error processing transfer instruction:",e)}return n}))),e>BigInt(0)&&(o.jitoBundle||l.instructions.unshift(Rn.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e}))),t>0&&l.instructions.unshift(Rn.ComputeBudgetProgram.setComputeUnitLimit({units:t}))}const u=new Set(jn._L);let d=0,m=null,g=-1;for(let e=0;e<l.instructions.length;e++){const t=l.instructions[e];if(t.programId.equals(Rn.SystemProgram.programId))try{const n=Rn.SystemInstruction.decodeTransfer(t);if(u.has(n.toPubkey.toBase58())){const t=Number(n.lamports);t>d&&(d=t,g=e,m=n.toPubkey.toBase58())}}catch(e){}}const p=c?Math.floor(s*Nn.j):0;if(p>d&&g>=0&&g<l.instructions.length){const e=l.instructions[g],t=Rn.SystemInstruction.decodeTransfer(e);t&&(l.instructions[g]=Rn.SystemProgram.transfer({fromPubkey:t.fromPubkey,toPubkey:t.toPubkey,lamports:p}))}else if(p>d&&g<0){l.instructions=l.instructions.filter((e=>{if(e.programId.equals(Rn.SystemProgram.programId))try{const t=Rn.SystemInstruction.decodeTransfer(e);if(u.has(t.toPubkey.toBase58()))return!1}catch(e){}return!0}));const e=(0,On.u)(m||(0,jn.kR)()),t=l.payerKey;t&&p>0&&l.instructions.push(Rn.SystemProgram.transfer({fromPubkey:t,toPubkey:e,lamports:p}))}else if(c&&0===d){const e=(0,On.u)((0,jn.kR)()),t=l.payerKey;t&&p>0&&l.instructions.push(Rn.SystemProgram.transfer({fromPubkey:t,toPubkey:e,lamports:p}))}let E;if("legacy"===i){const t=Rn.Transaction.from((0,mt.decode)(e));t.instructions=l.instructions,E=t.serialize({requireAllSignatures:!1,verifySignatures:!1})}else{const e=l.compileToV0Message(r);E=new Rn.VersionedTransaction(e).serialize()}return E.byteLength>1232?(console.warn("Transaction too large after fee modifications, reverting to original"),e):(0,mt.encode)(E)}catch(t){return console.error("Error modifying transaction:",t),e}}(e.tx,i,s,c,l,r);return{tx:t,signers:[e.publicKey],metadata:{...n,hasJitoTip:(r.jitoTipAmount??0)>0,isJitoBundle:r.jitoBundle??!1}}}catch(t){const a={tx:e.tx,signers:[e.publicKey],metadata:n};return a.metadata.hasJitoTip=(r?.jitoTipAmount??0)>0,a.metadata.isJitoBundle=r?.jitoBundle??!1,a}}))),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation&&e.isMaxAmount===t.isMaxAmount&&e.bypassMutation===t.bypassMutation&&e.originAddress===t.originAddress&&JSON.stringify(e.metadata)===JSON.stringify(t.metadata)&&JSON.stringify(e.constructedTxOverride)===JSON.stringify(t.constructedTxOverride)));var sr=n(348834).Buffer;const{accountsForTransactionExecute:cr,transactionMessageToMultisigTransactionMessageBytes:lr}=Un.utils,{createVaultTransactionExecuteInstruction:ur}=Un.generated,{transactionMessageBeet:dr}=Un.types,mr=.003*Nn.j,gr=(0,B.xu)((e=>(0,F.cn)((async t=>await Promise.all(e.txs.map((async(n,r)=>t(pr({...e,tx:n,metadata:{numberOfTransactions:e.txs.length,transactionNumber:r+1}})))))))),((e,t)=>e.txs.join(",")===t.txs.join(",")&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation&&e.isMaxAmount===t.isMaxAmount)),pr=(0,B.xu)((e=>(0,F.cn)((async t=>{try{const n=e.metadata??{numberOfTransactions:1,transactionNumber:1},r=await t((0,Cn.xC)({blockchainId:e.blockchainId,publicKey:e.publicKey})),a=r.info.publicKeyringInfo;if(a?.keyringType!==_.ZO.BP_SAFE)return null;const o=a.exchangeSignerPublicKey,i=(0,On.u)(o),s=(0,On.u)(a.multisigInfo.signerPublicKey),{altLookups:c,multisigAccount:l,backpackSignerBalance:u,dataRentExemption:d,noDataRentExemption:m,jitoTipInSol:g,costPerByte:p}=await t(Qn({tx:e.tx,publicKey:o,multisigPda:a.multisigInfo.multisigPda,backpackSigner:o})),E=await t((0,D.Pg)(e.blockchainId)),f=await t(tr(e)),b=await t(ir(e)),h=f?.addressLookupTableAccounts,y=Rn.VersionedTransaction.deserialize(gt().decode(b.tx)),$=Rn.TransactionMessage.decompile(y.message,h?{addressLookupTableAccounts:h}:void 0),A=(0,On.u)(a.multisigInfo.multisigPda),v=(0,On.u)(r.publicKey),T=a.multisigInfo.multisigIndex,x=await E.getBlockhash(),k=BigInt(Number(l.transactionIndex)+n.transactionNumber),[C]=Un.sL({multisigPda:A,transactionIndex:k,programId:Un.Rn}),[I]=Un.h9({multisigPda:A,index:k,programId:Un.Rn}),w=b.signers[0],S=b.signers.length;if(1!==S)throw new Error(`Transaction requires ${S} signers, but expected 1.`);if(w!==r.publicKey)throw new Error(`Transaction's required signer (${w}) is not the expected signer (${r.publicKey}).`);const R=[],q={};for(let e=0;y.message.isAccountSigner(e);e++){const t=y.message.staticAccountKeys[e].toBase58();if(t!==r.publicKey){const[e,n]=Un.EE({transactionPda:I,ephemeralSignerIndex:R.length,programId:Un.Rn});R.push(n),q[t]=e}}let P,L,F=0,B=!1;const M=($.instructions??[]).filter((e=>{if(e.programId.equals(Rn.ComputeBudgetProgram.programId)){try{const t=Rn.ComputeBudgetInstruction.decodeSetComputeUnitLimit(e);P=t.units}catch{}try{const t=Rn.ComputeBudgetInstruction.decodeSetComputeUnitPrice(e);L=BigInt(t.microLamports)}catch(e){}return!1}if(e.programId.equals(Rn.SystemProgram.programId))try{const t=Rn.SystemInstruction.decodeTransfer(e);if(jn._L.includes(t.toPubkey.toBase58()))return F=Number(t.lamports),!1}catch(e){}return!0})).map((e=>(e.keys=e.keys.filter((t=>{const n=t.pubkey.toBase58();(e.programId.equals(Rn.VoteProgram.programId)||e.programId.equals(Rn.StakeProgram.programId))&&(B=!0),q[n]&&(t.pubkey=q[n],console.log("REPLACING KEY",n,t.pubkey.toBase58()));const r=n.toLowerCase();return!r.startsWith("jitodontfront")&&!r.startsWith("jitonobundle")||(console.log("REMOVING KEY",t.pubkey.toBase58()),!1)})),e))),K=new Rn.TransactionMessage({payerKey:s,recentBlockhash:x,instructions:M}),z=new Rn.VersionedTransaction(K.compileToV0Message(h??[])),N=new Rn.TransactionMessage({payerKey:i,recentBlockhash:x,instructions:M}),O=N.compileToV0Message(h??[]),j=new Rn.VersionedTransaction(O),U=sr.from(O.serialize()).toString("base64"),W=(await E.solanaRpc.getFeeForMessage(U)).value??.001*Nn.j,H=Math.max(Math.floor(g*Nn.j),F),V=[],G=[],Z=[],Q=[],J=[],X=[];let Y=!1,ee=!1,te=!1;const ne=new Rn.AddressLookupTableAccount({key:c.currentAltPublicKey,state:{deactivationSlot:BigInt(0),lastExtendedSlot:0,lastExtendedSlotStartIndex:0,addresses:c.currentAltAccount?.state.addresses??[]}});let re=c.currentAltPublicKey,ae=ne;const oe=[...j.message.staticAccountKeys.slice(j.message.header.numRequiredSignatures)],ie=oe.filter((e=>!c.currentAltAccount?.state.addresses.find((t=>t.toBase58()===e.toBase58()))));let se=0;if(ie.length>=10){const e=[...c.currentAltAccount?.state.addresses??[],...ie];!c.currentAltAccount||e.length>255?(V.push(await c.altLookupProgram.methods.createLookupTable(new zn.BN(c.nextSlot)).accounts({user:i,multisig:(0,On.u)(a.multisigInfo.multisigPda),newAlt:c.nextAltPublicKey,currentAlt:c.currentAltPublicKey,closableAlt:c.closableAltPublicKey,altLookup:c.altLookupPublicKey}).instruction()),re=c.nextAltPublicKey,G.push(Rn.AddressLookupTableProgram.extendLookupTable({lookupTable:re,authority:i,payer:i,addresses:oe})),G.push(Rn.SystemProgram.transfer({fromPubkey:i,toPubkey:(0,On.u)((0,jn.kR)()),lamports:H})),se=oe.length,ee=!0,te=!0,ae=new Rn.AddressLookupTableAccount({key:re,state:{deactivationSlot:BigInt(0),lastExtendedSlot:0,lastExtendedSlotStartIndex:0,addresses:oe}})):ie.length>0&&(V.push(Rn.AddressLookupTableProgram.extendLookupTable({lookupTable:re,authority:i,payer:i,addresses:ie})),ee=!0,se=ie.length,ae=new Rn.AddressLookupTableAccount({key:re,state:{deactivationSlot:BigInt(0),lastExtendedSlot:0,lastExtendedSlotStartIndex:0,addresses:e}})),ee&&!te&&V.unshift(Rn.ComputeBudgetProgram.setComputeUnitPrice({microLamports:BigInt(Math.max(1e5,Number(L)||0))}))}const ce=[...h??[],ae];Z.push(await Un.NE.vaultTransactionCreate({multisigPda:A,transactionIndex:k,creator:i,vaultIndex:T,ephemeralSigners:R.length,transactionMessage:N,addressLookupTableAccounts:ce})),Q.push(await Un.NE.proposalCreate({multisigPda:A,transactionIndex:k,creator:s})),Q.push(await Un.NE.proposalApprove({multisigPda:A,transactionIndex:k,member:s})),Q.push(await Un.NE.proposalApprove({multisigPda:A,transactionIndex:k,member:i}));const le=lr({message:N,addressLookupTableAccounts:ce,vaultPda:v}),[ue]=dr.deserialize(sr.from(le)),{accountMetas:de,lookupTableAccounts:me}=await cr({connection:E.connection,message:ue,ephemeralSignerBumps:R,vaultPda:v,transactionPda:I,addressLookupTableAccounts:ce});P??=2e5*M.length,P+=4e5,J.push(Rn.ComputeBudgetProgram.setComputeUnitLimit({units:Math.min(P,14e5)})),B&&J.push(Rn.ComputeBudgetProgram.setComputeUnitPrice({microLamports:BigInt(Math.max(1e4,Number(L)||0))})),J.push(await ur({multisig:A,member:i,proposal:C,transaction:I,anchorRemainingAccounts:de})),B?(l.rentCollector&&J.push(await Un.NE.vaultTransactionAccountsClose({multisigPda:A,rentCollector:(0,On.u)(l.rentCollector),transactionIndex:k,programId:Un.Rn})),J.push(Rn.SystemProgram.transfer({fromPubkey:i,toPubkey:(0,On.u)((0,jn.kR)()),lamports:H})),Q.push(Rn.SystemProgram.transfer({fromPubkey:s,toPubkey:(0,On.u)((0,jn.kR)()),lamports:H}))):(l.rentCollector&&X.push(await Un.NE.vaultTransactionAccountsClose({multisigPda:A,rentCollector:(0,On.u)(l.rentCollector),transactionIndex:k,programId:Un.Rn})),X.push(Rn.SystemProgram.transfer({fromPubkey:i,toPubkey:(0,On.u)((0,jn.kR)()),lamports:H})));const ge=mr+d+W+H-(u??0)-m;let pe=p*(le.length+32*se+56)+mr-(u??0)-m;te&&(pe+=H,c.altLookupAccount||(pe+=169*p,pe+=mr/2)),pe>0&&(V.push(Rn.SystemProgram.transfer({fromPubkey:s,toPubkey:i,lamports:Math.floor(pe)})),Y=!0),ge>0&&Q.push(Rn.SystemProgram.transfer({fromPubkey:s,toPubkey:i,lamports:Math.floor(ge)}));const Ee=new Rn.TransactionMessage({payerKey:Y?s:i,recentBlockhash:x,instructions:V}).compileToV0Message(),fe=new Rn.VersionedTransaction(Ee),be=fe.serialize(),he=new Rn.TransactionMessage({payerKey:i,recentBlockhash:x,instructions:G}).compileToV0Message(),ye=new Rn.VersionedTransaction(he),$e=ye.serialize(),Ae=new Rn.TransactionMessage({payerKey:i,recentBlockhash:x,instructions:Z}).compileToV0Message(),ve=new Rn.VersionedTransaction(Ae),Te=ve.serialize(),xe=new Rn.TransactionMessage({payerKey:s,recentBlockhash:x,instructions:Q}).compileToV0Message(),ke=new Rn.VersionedTransaction(xe),Ce=ke.serialize(),Ie=new Rn.TransactionMessage({payerKey:i,recentBlockhash:x,instructions:J}).compileToV0Message([...me??[],ae]),we=new Rn.VersionedTransaction(Ie),Se=we.serialize(),_e=new Rn.TransactionMessage({payerKey:i,recentBlockhash:x,instructions:X}).compileToV0Message(),De=new Rn.VersionedTransaction(_e),Re=De.serialize();if(console.log("BACKPACK SAFE TX SUMMARY",{gasManagement:{GAS_BUFFER:mr/Nn.j,dataRentExemption:d/Nn.j,backpackSignerBalance:u/Nn.j,targetSignerBalance:(mr+d)/Nn.j,sanitizedTxFee:W/Nn.j,jitoTip:H/Nn.j,setupTopUpAmount:pe/Nn.j,approvalTopUpAmount:ge/Nn.j,setupIncludesGasTransfer:Y,setupIncludesAltInstruction:ee,setupIncludesAltRotation:te},originalTx:{originalTx:y,staticAccounts:y.message.staticAccountKeys.map((e=>e.toBase58())),size:y.serialize().length},sanitizedTx:{sanitizedTx:j,staticAccounts:j.message.staticAccountKeys.map((e=>e.toBase58())),requiredLookupTableAddresses:oe.map((e=>e.toBase58())),size:j.serialize().length},setupTx:{tx:fe,staticAccounts:fe.message.staticAccountKeys.map((e=>e.toBase58())),serializedSetupTx:gt().encode(be),serializedSetupMessage:gt().encode(Ee.serialize()),size:be.length},setupTx2:{tx:ye,staticAccounts:ye.message.staticAccountKeys.map((e=>e.toBase58())),serializedSetupTx:gt().encode($e),serializedSetupMessage:gt().encode(he.serialize()),size:$e.length},creationTx:{tx:ve,staticAccounts:ve.message.staticAccountKeys.map((e=>e.toBase58())),serializedCreationTx:gt().encode(Te),serializedCreationMessage:gt().encode(Ae.serialize()),size:Te.length},approveTx:{tx:ke,staticAccounts:ke.message.staticAccountKeys.map((e=>e.toBase58())),serializedApproveTx:gt().encode(Ce),serializedApproveMessage:gt().encode(xe.serialize()),size:Ce.length},executeTx:{tx:we,staticAccounts:we.message.staticAccountKeys.map((e=>e.toBase58())),accountMetas:de.map((e=>e.pubkey.toBase58())),lookupTableAccounts:me.map((e=>e.key.toBase58())),serializedExecuteTx:gt().encode(Se),serializedExecuteMessage:gt().encode(Ie.serialize()),size:Se.length},cleanupTx:{tx:De,staticAccounts:De.message.staticAccountKeys.map((e=>e.toBase58())),serializedCleanupTx:gt().encode(Re),serializedCleanupMessage:gt().encode(_e.serialize()),size:Re.length}}),be.length>1232)return{error:"Setup Transaction too large for multisig execution ("+be.length+" > 1232)"};if($e.length>1232)return{error:"Setup Transaction 2 too large for multisig execution ("+$e.length+" > 1232)"};if(Te.length>1232)return{error:"Create Transaction too large for multisig execution ("+Te.length+" > 1232)"};if(Ce.length>1232)return{error:"Approve Transaction too large for multisig execution ("+Ce.length+" > 1232)"};if(Se.length>1232)return{error:"Execute Transaction too large for multisig execution ("+Se.length+" > 1232)"};if(Re.length>1232)return{error:"Cleanup Transaction too large for multisig execution ("+Re.length+" > 1232)"};{const e=Y||ee?[{tx:gt().encode(be),signers:[...ee?[o]:[],...Y?[a.multisigInfo.signerPublicKey]:[]],metadata:n},...te?[{tx:gt().encode($e),signers:[o],metadata:n}]:[]]:[],t=B,r=ee&&!B,i={simulationTx:gt().encode(z.serialize()),txs:[...r?te?[e]:e:[],[...r?[]:e,{tx:gt().encode(Te),signers:[o],metadata:n},{tx:gt().encode(Ce),signers:[a.multisigInfo.signerPublicKey,o],metadata:n},...t?[]:[{tx:gt().encode(Se),signers:[o],metadata:{...n,isExecuteTx:!0}},{tx:gt().encode(Re),signers:[o],metadata:n}]],...t?[{tx:gt().encode(Se),signers:[o],metadata:{...n,isExecuteTx:!0,hasJitoTip:!0}}]:[]]};return console.log("BACKPACK SAFE TX RESULT",i),i}}catch(e){if("function"==typeof e?.then)throw e;return console.error(e),{error:e?.message??"Unknown error"}}}))),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation&&e.isMaxAmount===t.isMaxAmount)),Er=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=(await t(I.D5)).preferences.lockedCollections??[];return n.length<=0?[]:(await Promise.all(n.map((t=>async function(e,t){const n=(0,u.im)(u.q4,{address:e,caip2:{namespace:"solana"},collection:t}),r=await(0,u.HL)(n),a=await fetch(`${w.Fv}/v3/graphql`,{method:"POST",headers:{Accept:"application/json","apollographql-client-name":"backpack-secure-ui","Content-Type":"application/json","x-backpack-cache-key-prefix":_.Ek.SOLANA_MAINNET,"x-blockchain-caip2":_.Ek.SOLANA_MAINNET,...r},body:JSON.stringify(n)}),o=await a.json();return o.data?.wallet?.nfts?.edges?.map((e=>e.node))??[]}(e,t))))).flat()})))),fr=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=await t(Er(e.publicKey));if(n.length<=0)return[];const r=(await Promise.all(e.txs.map((async n=>await t(Yn({tx:n,blockchainId:e.blockchainId})))))).reduce(((e,t)=>{const n=[...t.writable,...t.signedWritable];return e.push(...n),e}),[]);return n.filter((e=>r.includes(e.token)))}))),((e,t)=>e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&JSON.stringify([...e.txs].sort())===JSON.stringify([...t.txs].sort())));function br(e,t){return"hasData"===e.state?e.data:t}function hr(e,t,n){const r=t||{overrides:[{keywords:["insufficient funds","insufficient balance","account does not have enough"],message:P.ag._({id:"1xyRYF"}),priority:1},{keywords:["has insufficient funds for rent"],message:P.ag._({id:"AxhazI"}),priority:10},{keywords:["unknown error","unexpected error"],message:P.ag._({id:"fHO0lm"}),priority:1},{keywords:["The transaction was reverted"],message:P.ag._({id:"Ds5n1f"}),priority:1},{keywords:["revert","transaction was reverted"],message:P.ag._({id:"LCyM83"}),priority:10,minTransactions:2}],defaultMessage:P.ag._({id:"vWdjQp"})};if(!e||"string"!=typeof e)return r.defaultMessage||P.ag._({id:"vWdjQp"});const a=e.toLowerCase(),o=[...r.overrides].sort(((e,t)=>(t.priority||0)-(e.priority||0)));for(const e of o)if(e.keywords.some((t=>a.includes(t.toLowerCase())&&(!e.minTransactions||!!n&&n>=e.minTransactions))))return e.message;return e}function yr(e,t,n){const r=hr(e,void 0,n),a=hr(t);return a?`${r}\n\n${a}`:r}const $r=(e,t,n,r,a,o,i)=>{const s=Zt(r)||"",l=t===_.Ek.ECLIPSE_MAINNET_BETA.split(":")[1],u=t===_.Ek.SONICGAME_MAINNET.split(":")[1],d=Gt((0,c.useCallback)((async()=>{if(i)return{evaluation:{encoding:"base58",status:"ERROR",error:P.ag._({id:"Meb8p+"}),error_details:{type:"TransactionError",message:P.ag._({id:"aW2+fn"}),transaction_index:0,instruction_index:0,program_account:"",number:0,code:""},request_id:"custom_rpc_error"}};if(!e)return{skipped:!0};try{const r=new AbortController,o=r.signal;setTimeout((()=>{r.abort()}),9e3);const i={transactions:n,chain:u?"sonic_mainnet":t,account_address:a,metadata:{url:s}},c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},l=`${e}`,d=await(0,Vt.R)(l,{...c,signal:o},fetch);if(d.ok){const e=await d.json();let t=e;return"Malicious"===e?.result?.validation?.result_type&&"transfer_farming"===e?.result?.validation?.reason&&(t={...e,result:{...e.result,validation:{...e.result.validation,result_type:"Warning"}}}),{evaluation:t}}{const e=await d.json();return{error:new Error(`Blockaid API returned non-200 response: ${d.status}: ${JSON.stringify(e)}`)}}}catch(e){return e.message.toLowerCase().includes("aborted")?{error:new Error("Request timeout reached")}:{error:e}}}),[JSON.stringify({transactions:n,origin:s,userAccount:a})]),1e4,5),m=(0,c.useMemo)((()=>{const e=d.data?.evaluation;return{isLoading:!d.isFetched,error:d.data?.error||d.error,normalizedEvaluation:e?Tr(e,l?"ETH":"SOL",l?"https://assets.coingecko.com/asset_platforms/images/279/large/ethereum.png":"https://assets.coingecko.com/coins/images/4128/large/solana.png",n.length):void 0,skipped:d.data?.skipped}}),[l,d,n.length]),g=m.error;return(0,c.useEffect)((()=>{g&&o(g)}),[o,g]),m};function Ar(e,t){return!!(t&&t>1&&e&&(e.toLowerCase().includes("revert")||e.toLowerCase().includes("transaction was reverted")))}function vr(e,t,n,r){const a=r||{};return a.simulation_unavailable=[{humanReadableDiff:"Transaction simulation unreliable",suggestedColor:"INFO",asset:{isNonFungible:!1,imageUrl:"",name:""}}],{action:"WARN",warnings:[...n?[n]:[],{severity:"WARNING",message:yr(e.error||"",e.error_details?.message,t)}],errors:[],expectedStateChanges:a}}function Tr(e,t,n,r){try{const a=e.result;if(!a)return Ar(e.error,r)?vr(e,r):{action:"NONE",warnings:[],errors:[...e.error?[yr(e.error,e.error_details?.message)]:[]]};const o={Benign:"NONE",Warning:"WARN",Malicious:"BLOCK",Error:"BLOCK"},i={Benign:"INFO",Warning:"WARNING",Malicious:"CRITICAL",Error:"CRITICAL"},s={"":"",unknown_profiter:P.ag._({id:"V+qlTZ"}),unfair_trade:P.ag._({id:"oXf4BZ"}),transfer_farming:P.ag._({id:"hhOpVt"}),writable_accounts_farming:P.ag._({id:"FNtEuY"}),native_ownership_change:P.ag._({id:"kDadrg"}),spl_token_ownership_change:P.ag._({id:"4DJCRM"}),exposure_farming:P.ag._({id:"11VDsG"}),known_attacker:P.ag._({id:"9ZlhvI"}),invalid_signature:P.ag._({id:"wtkd/H"}),honeypot:P.ag._({id:"X63YnF"}),other:P.ag._({id:"XzRn0g"})},c=P.ag._({id:"uiVAFB"})+"\n",l=P.ag._({id:"QMUu/P"}),u="Benign"===a.validation.result_type||"Error"===a.validation.result_type?void 0:"Warning"===a.validation.result_type?{severity:i[a.validation.result_type],message:s[a.validation.reason]||P.ag._({id:"+yVdN2"})}:"Malicious"===a.validation.result_type?{severity:i[a.validation.result_type],message:s[a.validation.reason]?c+s[a.validation.reason]:c+l}:{severity:i[a.validation.result_type],message:s[a.validation.reason]||P.ag._({id:"+yVdN2"})},d={};return a.simulation&&xr(a.simulation,d,t,n),Ar(e.error,r)?vr(e,r,u,d):{action:o[a.validation.result_type],warnings:[...u?[u]:[]],errors:[...e.error?[yr(e.error,e.error_details?.message)]:[]],expectedStateChanges:d}}catch(e){return void console.error(e,"Unexpected Blockaid Schema")}}const xr=(e,t,n,r)=>{const a={assets_diff:kr,assets_ownership_diff:kr,delegations:Cr};for(const o in a){const i=a[o],s=e[o];if(s)for(const e in s){const a=s[e];if(!Array.isArray(a))continue;const o=i(a,n,r);t[e]?t[e].push(...o):t[e]=o}}},kr=(e,t,n)=>e.map((e=>{const r=e.in??e.out,a=e.asset.type!==t&&"name"in e.asset?"TOKEN"===e.asset.type?e.asset.symbol:e.asset.name:t;return{humanReadableDiff:`${e.in?"Receive":"Send"} ${r?.value} ${a}`,suggestedColor:e.in?"CREDIT":"DEBIT",asset:{isNonFungible:["CNFT","NFT"].includes(e.asset.type??""),imageUrl:a===t?n:e.asset.logo,name:a}}})),Cr=(e,t,n)=>e.map((e=>{const{delegation:r,asset:a}=e,o=a.type!==t&&"name"in a?"TOKEN"===a.type?a.symbol:a.name:t;return{humanReadableDiff:`Delegate ${r.value} ${o}`,suggestedColor:"INFO",asset:{isNonFungible:["CNFT","NFT"].includes(a.type??""),imageUrl:o===t?n:a.logo,name:o}}}));var Ir=n(202784);function wr({currentRequest:e}){const t=(0,s.Dv)(I.D5),n=(0,s.Dv)((0,D.I5)(e.request.blockchainId)),r=(0,Z.qZ)(e.request.blockchainId),a=!(!r?.rpcUrl||!n.rpcUrl||n.rpcUrl===r.rpcUrl),[o,i]=(0,c.useState)(!1),l=(0,ht.G)(or(e.request)),u=(0,ht.G)(gr(e.request)),d=(0,ht.G)(fr(e.request)),m=br(d,[]),g=br(l,[]),p=br(u,[]),E=$r(n.txSimulationUrl,n.caip2Reference,e.request.txs,e.event.origin.address,e.request.publicKey,(e=>{i(!0),console.error(e)}),a),[f,b]=(0,c.useState)(!1),[h,$]=(0,c.useState)(!0),A=(0,c.useMemo)((()=>{const t=new Set;for(const n of e.request.txs)try{const e=Rn.VersionedTransaction.deserialize(gt().decode(n)),r=e.message.staticAccountKeys,a=e.message.compiledInstructions;for(const e of a){const n=r[e.programIdIndex];n&&t.add(n.toBase58())}}catch(e){console.error("Failed to parse transaction for program IDs:",e)}return Array.from(t)}),[e.request.txs]),v=(0,c.useMemo)((()=>Kn(A)),[A]),T=A.length>0&&0===v.length,{programApprovalInfo:x}=xt({programIds:A,displayProgramIds:v,blockchainId:e.request.blockchainId,currentRequest:e,shouldTrack:A.length>0&&Mn(A)}),k=()=>e.error(new Error("Approval Denied")),C=t.publicKeys.platforms[_.$O.SOLANA]?.publicKeys[e.request.publicKey];if(!f&&"view-only"===C?.type)return Ir.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>b(!0)});if("hasData"===d.state&&m.length>0){const e=m[0],t=e.collection.name,n=e.name;return Ir.createElement(ke.P,{warning:{severity:"CRITICAL",message:P.ag._({id:"EstOml",values:{collectionName:t,nftName:n}})},onDeny:k})}const w=[];if("hasError"===d.state&&w.push({message:P.ag._({id:"8h5Wn4"}),severity:"WARNING"}),e.event.origin.isUnverified){const t=e.event.origin.name;w.push({message:He(t),severity:"WARNING"})}const S=(o||E.error||!E.normalizedEvaluation)&&!E.skipped&&h;return Ir.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},E.isLoading||"loading"===d.state?Ir.createElement(y,null):S?Ir.createElement(ke.P,{title:P.ag._({id:"/bIfDH"}),warning:{severity:"WARNING",message:P.ag._({id:"fq39pT"})},onIgnore:()=>$(!1),onDeny:k}):Ir.createElement(Le,{origin:e.event.origin,relevantAddresses:e.event.uiOptions.relevantAccounts,signerPublicKey:e.request.publicKey,onDeny:k,onApprove:()=>{if(!g)return void console.error("unable to fetch or parse transaction data");const t=e.request.txs.reduce(((e,t,n)=>(p&&p[n]?.txs?e.push(...p[n].txs):!Array.isArray(g[n])&&g[n]?.metadata?.isJitoBundle?e.push([g[n]]):e.push(g[n]),e)),[]);e.respond({confirmed:!0,txs:t})},evaluation:E.normalizedEvaluation,customWarnings:w,programApprovalInfo:x,blockchainId:e.request.blockchainId,contractIds:T?A:v,serializedTx:e.request.txs[0],isStandardTransaction:T}))}var Sr=n(348834).Buffer,_r=n(202784);function Dr({currentRequest:e}){const t=Sr.from((0,mt.decode)(e.uiOptions.message??"")).toString(),n=(0,s.Dv)(I.D5),[r,a]=(0,c.useState)(!1),o=n.publicKeys.platforms[_.$O.SOLANA]?.publicKeys[e.uiOptions.publicKey];if(!r&&"view-only"===o?.type)return _r.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>a(!0)});const i=function(e,t){const{expectedURL:n,issuedAtThreshold:r}=t,a=[],o=Date.now(),i=new URL(n);if(e.domain!==i.host&&a.push("Domain does not match requesting domain"),e.uri&&new URL(e.uri).origin!==i.origin&&a.push("Uri origin does not match requesting domain"),e.issuedAt){const t=new Date(e.issuedAt).getTime();Math.abs(t-o)>r&&(t<o?a.push("Sign-in request issued too far in the past"):a.push("Sign-in request issued too far in the future"))}if(e.expirationTime){const t=new Date(e.expirationTime).getTime();t<=o&&a.push("Sign-in request is expired"),e.issuedAt&&t<new Date(e.issuedAt).getTime()&&a.push("Sign-in request expires before it's issued"),e.notBefore&&new Date(e.notBefore).getTime()>t&&a.push("Sign-in request expires before it's valid")}return a}(e.request.input??{},{expectedAddress:e.uiOptions.publicKey,expectedURL:e.event.origin.address,issuedAtThreshold:6e5});return _r.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},_r.createElement(tt,{currentRequest:e,title:P.ag._({id:"9ugv4c"}),publicKey:e.uiOptions.publicKey,message:t,blockchainId:e.request.blockchainId,prepend:i.length>0?_r.createElement(Se,{warning:{severity:"CRITICAL",message:_r.createElement(R.FA,{space:"$DEPRECATED_4"},_r.createElement(q.q,{color:"$redText"},"This sign-in request is invalid. This either means the site is unsafe, or its developer made an error when sending the request:"),_r.createElement(R.FA,{space:"$DEPRECATED_2"},i.map((e=>_r.createElement(q.q,{color:"$redText",key:e},e)))))}}):null}))}var Rr=n(348834).Buffer,qr=n(202784);function Pr({currentRequest:e}){const t=Rr.from((0,mt.decode)(e.request.message??"")),n=t.toString("binary"),r=(0,s.Dv)(I.D5),a=(0,s.Dv)((0,D.I5)(e.request.blockchainId)).name,[o,i]=(0,c.useState)(!1);(0,c.useEffect)((()=>{(function(e){if(!function(e){try{return new TextDecoder("utf8",{fatal:!0}).decode(e),!0}catch{return!1}}(e)&&!function(e){const t=Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("");return/^[0-9a-fA-F]+$/.test(t)}(e))return!1;try{if(Rn.Transaction.from(e).instructions.length>0)return!1}catch{}try{if(Rn.VersionedTransaction.deserialize(e).message.compiledInstructions.length>0)return!1}catch{}return!0})(t)||e.error(new Error("Transactions cannot be signed using signMessage"))}),[t]);const l=r.publicKeys.platforms[_.$O.SOLANA]?.publicKeys[e.request.publicKey];return o||"view-only"!==l?.type?qr.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},qr.createElement(tt,{publicKey:e.request.publicKey,currentRequest:e,title:P.ag._({id:"aqrlWY",values:{networkName:a}}),message:n,blockchainId:e.request.blockchainId})):qr.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>i(!0)})}var Lr=n(127942);const Fr=(0,F.cn)(!1);function Br(e,t){const[n,r]=(0,c.useState)(t),[a,o]=(0,c.useState)(!0),i=(0,ht.G)(e),s=i.state,l="hasData"===i.state?i.data:void 0;return(0,c.useEffect)((()=>{"hasData"===s&&void 0!==l&&((0,S.Xy)(l,n)||(r(l),o(!1))),"hasError"===s&&(o(!1),console.error(i.error))}),[s,l,n,a]),[n,i.state,a]}var Mr=n(632419),Kr=n(512788);const zr=(0,F.cn)(void 0),Nr=(0,F.cn)(void 0),Or={totalFee:5e-6,feePercentile:50,successRate:95,priorityFee:.001,computeUnitPrice:5e5,computeUnitLimit:2e5,jitoBundle:!1,jitoTip:.001},jr=(0,F.cn)(Or),Ur=(0,F.cn)((e=>{const t=e((0,B.n7)(I.D5)),n=e(jr);return"hasData"===t.state?t.data.preferences?.solanaCustomTransactionSettings??n:n}),((e,t,n)=>{t(jr,n)})),Wr=(0,B.xu)((e=>{const t=(0,F.cn)((async t=>{const n=await t(d.F),r=await n.query({query:u._r,variables:{transaction:e}}),{transactionFeeSettings:a}=r.data;return{isNetworkCongested:a.isNetworkCongested,tiers:{fast:(0,u.dQ)(a.tiers.fast),turbo:(0,u.dQ)(a.tiers.turbo)}}}));return(0,F.cn)((async e=>{const n=await e(t);if(!n)return null;const r=e(Ur);return{...n,tiers:{...n.tiers,custom:r}}}))})),Hr=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=await t(tr(e));if(!n)return!1;const{transaction:r}=n,a=r.signatures.length>0&&r.signatures.some((e=>!e.every((e=>0===e))));return!0!==e.disableTxMutation&&!a}))),((e,t)=>e.tx===t.tx&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation)),Vr=((0,B.xu)((e=>(0,F.cn)((async t=>(await Promise.allSettled(e.txs.map((async n=>await t(Vr({tx:n,publicKey:e.publicKey,blockchainId:e.blockchainId,disableTxMutation:e.disableTxMutation})))))).map(((e,t)=>"fulfilled"===e.status?e.value:(console.warn(`Failed to get overrides for tx ${t}:`,e.reason),{disableFeeConfig:!1,disableDowngradeAccounts:!0,isMaxAmount:!1,jitoBundle:!1,priorityFee:"50000",jitoTipAmount:0,computeUnitLimit:"",downgradedWritableAccounts:[]})))))),((e,t)=>e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation&&JSON.stringify(e.txs)===JSON.stringify(t.txs))),(0,B.xu)((e=>{const t=(0,F.cn)(null);return(0,F.cn)((async n=>n(t)||await n(Gr(e))),((e,n,r)=>{n(t,r)}))}),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation))),Gr=(0,B.xu)((e=>(0,F.cn)((async t=>{const n=await t(Hr(e)),r=await t(ar(e));return{computeUnitLimit:r?.computeUnitLimit?.toString()??"",priorityFee:r?.priorityFee?.toString()??"",downgradedWritableAccounts:[],disableFeeConfig:!n,disableDowngradeAccounts:!0,isMaxAmount:e.isMaxAmount??!1,jitoTipAmount:0}}))),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.disableTxMutation===t.disableTxMutation&&e.isMaxAmount===t.isMaxAmount)),Zr="https://assets.coingecko.com/coins/images/4128/large/solana.png",Qr=BigInt(0);function Jr(e,t,n=!0){const r=e.decimals??t?.decimals??(e.mint===Lr.VU?9:0),a=t?.symbol??(e.mint===Lr.VU?"SOL":"Unknown"),o=n?w.rI:"",i=t?.logo??(e.mint===Lr.VU?Zr:o),s=e.diff>Qr,c=e.diff>Qr?e.diff:-e.diff;return{humanReadableDiff:`${s?"Receive":"Send"} ${(0,S.Ou)(c.toString(),r,!0,!1)} ${a}`,suggestedColor:s?"CREDIT":"DEBIT",asset:{isNonFungible:!1,imageUrl:i,name:a}}}const Xr=(0,B.xu)((e=>{const t=(0,F.cn)((async t=>{const n=e=>({isLoading:!1,error:e instanceof Error?e:new Error(String(e))});try{let r;try{r=Rn.VersionedTransaction.deserialize(gt().decode(e.tx))}catch{return n(new Error("Failed to parse transaction"))}const a=await t((0,D.Pg)(e.blockchainId)),o=r.message.staticAccountKeys.map((e=>e.toBase58())),i=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Simulation timeout"))),5e3)})),s=a.wallet.simulate({publicKey:(0,On.u)(e.publicKey),tx:r});let c;try{c=await Promise.race([s,i])}catch(e){return n(e)}if(c.err)return{isLoading:!1,error:new Error(`Simulation failed: ${JSON.stringify(c.err)}`)};const l=[];if(c.preBalances&&c.postBalances){const e=Math.min(o.length,c.preBalances.length,c.postBalances.length);for(let t=0;t<e;t++){const e=o[t],n=BigInt(c.preBalances[t]??0),r=BigInt(c.postBalances[t]??0)-n;r!==Qr&&l.push({mint:Lr.VU,owner:e,diff:r,decimals:9})}}const u=c.preTokenBalances??[],d=c.postTokenBalances??[],m=new Map;for(const e of u)m.set(`${e.owner}:${e.mint}`,e);const g=new Map;for(const e of d)g.set(`${e.owner}:${e.mint}`,e);const p=new Set([...m.keys(),...g.keys()]);for(const e of p){const t=m.get(e),n=g.get(e),r=n??t;if(!r)continue;const a=BigInt(t?.uiTokenAmount.amount??"0"),o=BigInt(n?.uiTokenAmount.amount??"0")-a;o!==Qr&&l.push({mint:r.mint,owner:r.owner,diff:o,decimals:r.uiTokenAmount.decimals})}const E={};for(const e of l){const t=Jr(e);E[e.owner]||(E[e.owner]=[]),E[e.owner].push(t)}return{isLoading:!1,error:null,normalizedEvaluation:{action:"NONE",warnings:[],errors:[],expectedStateChanges:E},balanceDiffs:l}}catch(e){return console.error("[RpcSim] RPC simulation failed:",e),n(e)}}));return t.debugLabel=`solanaTxRpcSimulationAtom(${e.publicKey.slice(0,8)}...)`,t}),((e,t)=>e.tx===t.tx&&e.publicKey===t.publicKey&&e.blockchainId===t.blockchainId&&e.rescanTrigger===t.rescanTrigger)),Yr=(0,B.xu)((e=>{const t=(0,F.cn)((async t=>{if(0===e.addresses.length)return{isLoading:!1,data:null};const n=await t(d.F);try{return{isLoading:!1,data:(await n.query({query:u.q7,variables:{addresses:e.addresses,caip2:e.caip2}})).data}}catch(e){return console.error("Failed to fetch token list entries:",e),{isLoading:!1,data:null}}}));return t.debugLabel=`tokenListEntriesAtom(${e.addresses.length} addresses)`,t}),((e,t)=>e.addresses.join(",")===t.addresses.join(",")&&e.caip2.namespace===t.caip2.namespace&&e.caip2.reference===t.caip2.reference));var ea=n(795092),ta=n(853111),na=n(924432);const ra={fiatValue:"$0.00",loading:!1,solPrice:null};function aa(e,t){const n=(0,Y.gI)(e),r=!e||!n||"number"!=typeof t,{data:a,loading:o}=(0,na.aM)(u.lB,{skip:r,variables:{address:Lr.VU,caip2:n||""}});if(r)return ra;const i=a?.tokenMarketPrice??null;return{fiatValue:i?K.eO.formatToUSD({amount:t*i}):"$0.00",loading:o,solPrice:i}}function oa(e,t,n){const r=e.jitoTip??0;if(n)return r;const a=function(e,t){if(t){const t=parseFloat(e.computeUnitLimit?.toString()||"0"),n=parseFloat(e.computeUnitPrice?.toString()||"0");return isNaN(t)||isNaN(n)?0:t*(n/1e6)/Nn.j}return e.priorityFee??0}(e,t);return a+r}var ia=n(202784);function sa({blockchainId:e,onDone:t,isEditing:n}){return ia.createElement(g,null,ia.createElement(la,{blockchainId:e,onDone:t,isEditing:n}))}const ca=e=>{const t=e.replace(/[^0-9.]/g,""),n=t.split(".");return n.length>1?`${n[0]}.${n.slice(1).join("")}`:t};function la({blockchainId:e,onDone:t,isEditing:n}){const r=(0,ht.G)(I.D5),a=(0,s.Dv)(I.s7),[o,i]=(0,s.KO)(Ur),[l,u]=(0,s.KO)(Fr),d="hasData"===r.state&&r.data.preferences.developerMode,[m,g]=(0,c.useState)(o),[p,E]=(0,c.useState)(o.priorityFee?.toString()??""),[f,b]=(0,c.useState)(o.jitoTip?.toString()??""),[h,y]=(0,c.useState)(o.computeUnitPrice?.toString()??""),[$,A]=(0,c.useState)(o.computeUnitLimit?.toString()??"");(0,c.useEffect)((()=>{E(o.priorityFee?.toString()??""),b(o.jitoTip?.toString()??""),y(o.computeUnitPrice?.toString()??""),A(o.computeUnitLimit?.toString()??""),u(o.jitoBundle),g(o)}),[o,u]);const v=(0,c.useRef)(o);(0,c.useEffect)((()=>{v.current=o}),[o]);const[T,x]=(0,c.useState)(null),k=(0,ta.Nr)(T,700),C=(0,c.useCallback)(((e,t)=>{const n=ca(t);"priorityFee"===e?E(n):"jitoTip"===e&&b(n);const r="priorityFee"===e||"computeUnitLimit"===e||"computeUnitPrice"===e||"jitoTip"===e?parseFloat(n)||0:n,a={...v.current,[e]:r};v.current=a,g(a),x({key:e,value:n})}),[]);(0,c.useEffect)((()=>{if(!n&&k){const{key:e,value:t}=k,n="priorityFee"===e||"computeUnitLimit"===e||"computeUnitPrice"===e||"jitoTip"===e?parseFloat(t)||0:t,r={...v.current,[e]:n};i(r)}}),[k,n,i]);const w=(0,c.useCallback)((()=>{"hasData"===r.state&&(i(v.current),a.updateUserPreferences({uuid:r.data.user.uuid,preferences:{...r.data.preferences,solanaCustomTransactionSettings:v.current}}),t?.())}),[a,r,i,t]),S=(0,c.useCallback)((()=>{if("hasData"!==r.state)return;const e=r.data.preferences.solanaCustomTransactionSettings??Or;i(e),E(e.priorityFee?.toString()??""),b(e.jitoTip?.toString()??""),u(e.jitoBundle??!1),v.current=e,t?.()}),[r,i,u,t]),_=(0,c.useCallback)((e=>{u(e);const t={...v.current,jitoBundle:e};v.current=t,g(t),n||i(t)}),[u,i,n]),D=(0,c.useMemo)((()=>oa(n?m:o,d,l)),[n,l,d,o,m]),{fiatValue:L,loading:F}=aa(e,D),B=(0,c.useCallback)(((e,t)=>{const n=t.replace(/[^0-9]/g,"");"computeUnitPrice"===e?y(n):A(n),C(e,n)}),[C]);return n?ia.createElement(R.FA,{height:"100%"},ia.createElement(R.FA,{paddingHorizontal:"$4",gap:"$4"},ia.createElement(R.sL,{alignItems:"center",paddingTop:"$4"},ia.createElement(R.sL,{justifyContent:"center"},ia.createElement(q.q,{fontSize:"$lg",color:"$baseTextHighEmphasis"},P.ag._({id:"0XRiZv"})))),ia.createElement(R.FA,{gap:"$4"},ia.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",minHeight:"$6"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},P.ag._({id:"T138M0"})),ia.createElement(ge.y,{size:"default",value:l,onValueChange:_})),d&&ia.createElement(ia.Fragment,null,ia.createElement(R.sL,{justifyContent:"space-between",alignItems:"center",minHeight:"$6"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$base"},P.ag._({id:"57tXFr"})),ia.createElement(vn.t,{minWidth:"$12",disabled:l,color:l?"$baseTextMedEmphasis":"$baseTextHighEmphasis",keyboardType:"numeric",value:h,onValueChange:e=>B("computeUnitPrice",e),placeholder:"0",textAlign:"right",height:"$6",padding:"$1",autoFocus:!l,wrapperProps:{maxWidth:"$13",borderColor:"$baseBackgroundL1",backgroundColor:"$baseBackgroundL1"}})),ia.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",minHeight:"$6"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},P.ag._({id:"GEQ14R"})),ia.createElement(vn.t,{disabled:l,color:l?"$baseTextMedEmphasis":"$baseTextHighEmphasis",keyboardType:"numeric",value:$,onValueChange:e=>B("computeUnitLimit",e),placeholder:"0",textAlign:"right",height:"$6",autoFocus:!l&&d,wrapperProps:{maxWidth:"$12",borderColor:"$baseBackgroundL1",backgroundColor:"$baseBackgroundL1"}}))),!d&&ia.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",minHeight:"$6"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},P.ag._({id:"6t9BXr"})),ia.createElement(R.sL,{gap:"$1",alignItems:"center"},ia.createElement(vn.t,{minWidth:"$12",disabled:l,color:l?"$baseTextMedEmphasis":"$baseTextHighEmphasis",keyboardType:"decimal-pad",value:p,onValueChange:e=>{const t=ca(e);E(t),C("priorityFee",t)},placeholder:"0",textAlign:"right",height:"$6",padding:"$1",autoFocus:!l&&!d,wrapperProps:{maxWidth:"$13",borderColor:"$baseBackgroundL1",backgroundColor:"$baseBackgroundL1"}}),ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},"SOL"))),ia.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",minHeight:"$6"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},P.ag._({id:"c6iNJx"})),ia.createElement(R.sL,{gap:"$1",alignItems:"center"},ia.createElement(vn.t,{minWidth:"$12",keyboardType:"decimal-pad",value:f,onValueChange:e=>{const t=ca(e);b(t),C("jitoTip",t)},placeholder:"0",textAlign:"right",height:"$6",padding:"$1",wrapperProps:{maxWidth:"$13",borderColor:"$baseBackgroundL1",backgroundColor:"$baseBackgroundL1"}}),ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},"SOL"))),ia.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",minHeight:"$6"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},P.ag._({id:"DQnB41"})),ia.createElement(R.sL,{alignItems:"center",gap:"$1"},ia.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:n?"$base":"$sm"},`${parseFloat(D.toFixed(9)).toString()} SOL`),F?ia.createElement(G.m,{width:40,height:16}):ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:n?"$base":"$sm"},"(",L,")"))))),ia.createElement(R.FA,{paddingHorizontal:"$4",paddingVertical:"$4"},ia.createElement(ea.N,{leftButton:ia.createElement(j.x,{label:P.ag._({id:"iH8pgl"}),variant:"secondary",onPress:S}),rightButton:ia.createElement(j.x,{label:P.ag._({id:"tfDRzk"}),variant:"primary",onPress:w})}))):ia.createElement(R.FA,null,ia.createElement(R.FA,{paddingHorizontal:"$4",gap:"$4"},ia.createElement(R.sL,{alignItems:"center",paddingTop:"$4"},ia.createElement(R.sL,{justifyContent:"center"},ia.createElement(q.q,{fontSize:"$lg",color:"$baseTextHighEmphasis"},P.ag._({id:"0XRiZv"})))),ia.createElement(ua,{settings:o,isDeveloperMode:d,totalFee:D,totalFeeInFiat:L,fiatValueLoading:F})),t&&ia.createElement(R.FA,{paddingHorizontal:"$2",paddingVertical:"$4"},ia.createElement(ea.N,{leftButton:ia.createElement(j.x,{label:P.ag._({id:"iH8pgl"}),variant:"secondary",onPress:S}),rightButton:ia.createElement(j.x,{label:P.ag._({id:"tfDRzk"}),variant:"primary",onPress:w})})))}function ua({settings:e,isDeveloperMode:t,totalFee:n,totalFeeInFiat:r,fiatValueLoading:a}){return ia.createElement(R.FA,null,ia.createElement(R.FA,{paddingHorizontal:"$2",gap:"$2"},ia.createElement(R.sL,{paddingHorizontal:"$2",paddingTop:"$4",alignItems:"center",justifyContent:"space-between"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"T138M0"})),ia.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},e.jitoBundle?P.ag._({id:"RxzN1M"}):P.ag._({id:"E/QGRL"}))),ia.createElement(R.FA,null,t&&ia.createElement(ia.Fragment,null,ia.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$2",justifyContent:"space-between",alignItems:"center"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"57tXFr"})),ia.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},e.computeUnitPrice?.toString()??"0")),ia.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$2",alignItems:"center",justifyContent:"space-between"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"GEQ14R"})),ia.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},e.computeUnitLimit?.toString()??"0"))),!t&&ia.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$2",alignItems:"center",justifyContent:"space-between"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"6t9BXr"})),ia.createElement(R.sL,{gap:"$1",alignItems:"center"},ia.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},e.priorityFee?.toString()??"0"),ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},"SOL"))),ia.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$2",alignItems:"center",justifyContent:"space-between"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"c6iNJx"})),ia.createElement(R.sL,{gap:"$1",alignItems:"center"},ia.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},e.jitoTip?.toString()??"0"),ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},"SOL"))),ia.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$2",alignItems:"center",justifyContent:"space-between"},ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"DQnB41"})),ia.createElement(R.sL,{alignItems:"center",gap:"$1"},ia.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},`${parseFloat(n.toFixed(9)).toString()} SOL`),a?ia.createElement(G.m,{width:40,height:16}):ia.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},"(",r,")"))))))}var da=n(202784);function ma(){return da.createElement(R.FA,{gap:"$3"},da.createElement(R.sL,{gap:"$2",alignItems:"center"},da.createElement(G.m,{height:16,width:120})),da.createElement(ae.Zl,null,da.createElement(R.sL,{gap:"$4",alignItems:"center",justifyContent:"space-between",padding:"$3"},da.createElement(R.sL,{gap:"$2",flex:1},Array.from({length:4},((e,t)=>da.createElement(G.m,{key:t,height:22,width:48,br:12})))),da.createElement(G.m,{height:20,width:20}))))}function ga({serializedTx:e,currentRequest:t,onEditingChange:n}){return da.createElement(g,null,da.createElement(pa,{serializedTx:e,currentRequest:t,onEditingChange:n}))}function pa({serializedTx:e,currentRequest:t,onEditingChange:n}){const r=(0,s.b9)(Vr(t.request)),a=(0,ht.G)(I.D5),o=(0,s.Dv)(I.s7),i=(0,s.Dv)(Ur),l=(0,ht.G)(Wr(e)),u="hasData"===l.state?l.data:null;(0,c.useEffect)((()=>{"hasError"===l.state&&console.error("Failed to load transaction fee tiers:",l)}),[l.state]);const[d,m]=(0,c.useState)(null);(0,c.useEffect)((()=>{u&&m(u)}),[u]);const g=u||d,[p,E]=(0,s.KO)(zr),[f,b]=(0,s.KO)(Nr),[h,y]=(0,c.useState)(p&&"auto"!==p),[$,A]=(0,c.useState)(!1),v=(0,c.useRef)(!1),T=(0,c.useRef)({}),x="hasData"===a.state&&a.data.preferences.developerMode,[k]=(0,s.KO)(Fr),C=(0,c.useMemo)((()=>oa(i,x,k)),[i,x,k]),{fiatValue:S,loading:_}=aa(t.request.blockchainId,C),D=(0,c.useMemo)((()=>{if(!g||!p||"auto"===p||!g.tiers)return 0;const e=g.tiers[p];return Number(e?.totalFee??0)}),[g,p]),{fiatValue:L}=aa(t.request.blockchainId,D),[F,B]=(0,c.useState)(null),M=(0,ta.Nr)(F,100),K=(0,c.useCallback)((e=>{const n={priorityFee:e.priorityFee??"",downgradedWritableAccounts:e.downgradedWritableAccounts??[],disableFeeConfig:e.disableFeeConfig??!1,disableDowngradeAccounts:e.disableDowngradeAccounts??!0,isMaxAmount:t.uiOptions.isMaxAmount??!1,jitoTipAmount:e.jitoTipAmount??0,computeUnitLimit:e.computeUnitLimit??"",jitoBundle:e.jitoBundle??k};return e.jitoTipAmount&&e.jitoTipAmount>0&&(n.jitoTipAmount=e.jitoTipAmount),n.jitoBundle?(delete n.computeUnitLimit,delete n.priorityFee):(e.computeUnitLimit&&""!==e.computeUnitLimit&&(n.computeUnitLimit=parseFloat(e.computeUnitLimit).toString()),e.priorityFee&&""!==e.priorityFee&&(n.priorityFee=parseFloat(e.priorityFee).toString())),n}),[t,k]);(0,c.useEffect)((()=>{if(M){const e=K(M);r(e)}}),[M,r,K,t]),(0,c.useEffect)((()=>{p&&"auto"!==p&&!v.current&&y(!0),v.current=!1}),[p]),(0,c.useEffect)((()=>{if("hasData"===a.state){if("https://backpack.app"!==t.event.origin.address)return void(p||(E("auto"),r(K({priorityFee:"",disableFeeConfig:!1}))));if(!p){const e=a.data.preferences.solanaSelectedFeeTier;E(e),e||r(K({priorityFee:"",disableFeeConfig:!1}))}}}),[a,E,r,K,t.event.origin.address,p,f]),(0,c.useEffect)((()=>{const e=t.event.origin.address,n=e===w.UB;f!==e&&(b(e),n||(T.current={tier:"auto"},E("auto"),r(K({priorityFee:"",disableFeeConfig:!1}))))}),[t.event.origin.address,f,b,E,r,K]),(0,c.useEffect)((()=>{p&&(console.debug("[TransactionFeeSettingTiers] Updating session tier",{origin:f,previousTier:T.current.tier,newTier:p}),T.current.tier=p)}),[p,f]);const z=(0,c.useRef)({customSettings:i,selectedTier:p,isDeveloperMode:x}),N=(0,c.useCallback)((e=>{B(e)}),[]),O=(0,c.useCallback)((()=>{B(null)}),[]),U=(0,c.useRef)(i);(0,c.useEffect)((()=>{"custom"===p&&i&&U.current!==i&&(z.current={customSettings:i,selectedTier:p,isDeveloperMode:x},N(Ea(i,x,k)),U.current=i)}),[p,i,x,k,N]);const W=(0,c.useCallback)((()=>{v.current=!0,y((e=>!e))}),[]),G=(0,c.useCallback)((()=>{if("hasData"===a.state&&(E("custom"),T.current.tier="custom",i)){const e=Ea(i,x,k),t=K(e);r(t)}}),[E,o,a,i,x,k,K,r]),Z=(0,c.useCallback)((e=>{if("hasData"===a.state&&p!==e&&(E(e),T.current.tier=e,g?.tiers?.[e])){O();const t=g.tiers[e],n={priorityFee:"",disableFeeConfig:!1,disableDowngradeAccounts:!0,jitoTipAmount:0,jitoBundle:!1,computeUnitLimit:""};t?.priorityFee&&(n.priorityFee=t.priorityFee.toString()),t?.jitoTip&&t.jitoTip>0&&(n.jitoTipAmount=t.jitoTip/Nn.j);const a=K(n);r(a)}}),[p,E,r,g,K,O,o,a]),Q=(0,c.useCallback)((()=>{n?.(!0)}),[n]),J=(0,c.useCallback)((()=>{"hasData"===a.state&&"auto"!==p&&(E("auto"),T.current.tier="auto",O(),r(K({priorityFee:"",disableFeeConfig:!1,jitoTipAmount:0,jitoBundle:!1})))}),[p,O,K,E,r,o,a]);(0,c.useEffect)((()=>{"hasData"===a.state&&p&&t.addAfterResponseHandler((async e=>{!e.error&&e.response?.confirmed&&await(async()=>{try{await o.updateUserPreferences({uuid:a.data.user.uuid,preferences:{...a.data.preferences,solanaSelectedFeeTier:p}})}catch(e){console.error("Failed to update user preferences:",e)}})()}))}),[t,a,p,o]);const X=g?.tiers,Y={auto:P.ag._({id:"R9Khdg"}),fast:P.ag._({id:"KziH2K"}),turbo:P.ag._({id:"IcXtQ0"}),custom:P.ag._({id:"8Tg/JR"})},ee=da.createElement(R.FA,null,da.createElement(R.FA,{gap:"$2"},da.createElement(R.sL,null,da.createElement(q.q,{color:"$baseTextMedEmphasis",mr:"$2"},""),da.createElement(q.q,{lh:24,color:"$baseTextMedEmphasis",flex:1},P.ag._({id:"taJu9Z"}))),da.createElement(R.sL,null,da.createElement(q.q,{color:"$baseTextMedEmphasis",mr:"$2"},""),da.createElement(q.q,{lh:24,color:"$baseTextMedEmphasis",flex:1},P.ag._({id:"3djHgH"}))),da.createElement(R.sL,null,da.createElement(q.q,{color:"$baseTextMedEmphasis",mr:"$2"},""),da.createElement(q.q,{lh:24,color:"$baseTextMedEmphasis",flex:1},P.ag._({id:"gmjQIO"}))))),te=["auto",...X?Object.keys(X).filter((e=>"custom"!==e&&"auto"!==e&&e in Y)):[]];return"loading"!==l.state||g?da.createElement(da.Fragment,null,da.createElement(R.FA,{gap:"$3"},da.createElement(R.sL,{gap:"$2",alignItems:"center"},da.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"DuGLBH"})),da.createElement(V.P,{onPress:()=>A(!0)},da.createElement(ie.k,{size:16,color:"$baseTextMedEmphasis"}))),da.createElement(ae.Zl,null,da.createElement(R.sL,{gap:"$4",alignItems:"center",justifyContent:"space-between",padding:"$3"},da.createElement(R.sL,{gap:"$2",flex:1},te.map((e=>da.createElement(R.FA,{key:e,padding:12,margin:-12,cursor:"pointer",onPress:"auto"===e?J:()=>Z(e)},da.createElement(R.FA,{backgroundColor:p===e?"$buttonPrimaryBackground":"$buttonSecondaryBackground",borderRadius:"$3",paddingHorizontal:"$2",paddingVertical:3,justifyContent:"center",alignItems:"center"},da.createElement(q.q,{color:p===e?"$buttonPrimaryText":"$buttonSecondaryText",fontSize:12,fontWeight:"600"},Y[e]))))),da.createElement(R.FA,{padding:12,margin:-12,cursor:"pointer",onPress:G},da.createElement(R.FA,{backgroundColor:"custom"===p?"$buttonPrimaryBackground":"$buttonSecondaryBackground",borderRadius:"$3",paddingHorizontal:"$2",paddingVertical:3,justifyContent:"center",alignItems:"center"},da.createElement(q.q,{color:"custom"===p?"$buttonPrimaryText":"$buttonSecondaryText",fontSize:12,fontWeight:"600"},Y.custom)))),da.createElement(V.P,{onPress:W},h?da.createElement(be.K,{size:20,color:"$baseTextMedEmphasis"}):da.createElement(he._,{size:20,color:"$baseTextMedEmphasis"}))),h&&da.createElement(da.Fragment,null,"custom"===p?da.createElement(da.Fragment,null,da.createElement(ua,{settings:i,isDeveloperMode:x,totalFee:C,totalFeeInFiat:S,fiatValueLoading:_}),da.createElement(R.sL,{justifyContent:"center"},da.createElement(j.x,{label:P.ag._({id:"ePK91l"}),variant:"tertiary",onPress:Q}))):"auto"===p?da.createElement(R.FA,{padding:"$4"},da.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis",textAlign:"center"},P.ag._({id:"YUsmVz"}))):p&&X?da.createElement(da.Fragment,null,X[p]&&da.createElement(R.FA,{padding:"$2"},da.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$1",gap:"$4",justifyContent:"space-between"},da.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"1hKEom"})),da.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},"fast"===p?P.ag._({id:"zS9Vro"}):P.ag._({id:"YvXr99"}))),X[p]?.jitoTip>0&&da.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$1",gap:"$4",justifyContent:"space-between"},da.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"IcsPLp"})),da.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},`${(X[p]?.jitoTip/1e9).toFixed(9).replace(/\.?0+$/,"")} SOL`)),da.createElement(R.sL,{paddingHorizontal:"$2",paddingVertical:"$1",gap:"$4",justifyContent:"space-between"},da.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},P.ag._({id:"DQnB41"})),da.createElement(R.sL,{gap:"$1",alignItems:"center"},da.createElement(q.q,{color:"$baseTextHighEmphasis",fontSize:"$sm"},`${Number(X[p]?.totalFee).toFixed(9).replace(/\.?0+$/,"")} SOL`),da.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm"},"(",L,")"))))):null))),$&&da.createElement(H,{isOpen:$,onOpenChange:A,title:P.ag._({id:"alTMYX"}),description:ee,confirmText:P.ag._({id:"76gPWk"}),onConfirm:()=>A(!1)})):da.createElement(ma,null)}function Ea(e,t,n){const r={disableFeeConfig:!1,disableDowngradeAccounts:!0,jitoTipAmount:0,jitoBundle:n,computeUnitLimit:""};return n?(delete r.computeUnitLimit,delete r.priorityFee):t?(e.computeUnitPrice&&(r.priorityFee=e.computeUnitPrice.toString()),e.computeUnitLimit&&(r.computeUnitLimit=e.computeUnitLimit.toString())):e.priorityFee&&(r.priorityFee=e.priorityFee.toString()),e.jitoTip&&e.jitoTip>0&&(r.jitoTipAmount=parseFloat(e.jitoTip.toString())),r}var fa=n(168756),ba=n(202784);function ha({gasSymbol:e,overrides:t,setOverrides:n}){const r=(0,s.Dv)(I.D5),[a,o]=(0,c.useState)(!1),i=(0,c.useMemo)((()=>{const e=parseFloat(t.computeUnitLimit),n=parseFloat(t.priorityFee);return t.disableFeeConfig?0:e*n/Nn.j/1e6}),[t]);return r.preferences.developerMode?ba.createElement(R.FA,{key:"fees",gap:"$DEPRECATED_2"},ba.createElement(fa.Z,{onPress:()=>o((e=>!e)),accessibilityLabel:"Touchable"},ba.createElement(R.sL,{f:1,ai:"center",jc:"space-between",cursor:"pointer"},ba.createElement(q.q,{fontWeight:"$bold",color:"$baseTextHighEmphasis"},P.ag._({id:"Kg8w08"})),ba.createElement(R.sL,{cursor:"pointer",pointerEvents:"box-only"},ba.createElement(he._,{color:"$baseTextMedEmphasis",fontSize:"$sm",transform:a?[{rotateZ:"180deg"}]:void 0})))),a?ba.createElement(R.FA,{gap:"$DEPRECATED_2"},ba.createElement(R.sL,{f:1,ai:"center",jc:"space-between"},ba.createElement(R.FA,{gap:"$DEPRECATED_1"},ba.createElement(q.q,{color:"$baseTextMedEmphasis",fontWeight:"$bold",fontSize:"$xs"},P.ag._({id:"31Uanf"}))),ba.createElement(ge.y,{size:"small",value:!t.disableFeeConfig,onValueChange:()=>{n((e=>({...e,disableFeeConfig:!e.disableFeeConfig})))},disabled:!1})),t.disableFeeConfig?null:ba.createElement(R.FA,{gap:"$DEPRECATED_2",key:"disableFeeConfig"},ba.createElement(R.sL,{f:1,ai:"center",jc:"space-between"},ba.createElement(R.FA,{gap:"$DEPRECATED_1"},ba.createElement(q.q,{color:"$baseTextMedEmphasis",fontWeight:"$bold",fontSize:"$xs"},P.ag._({id:"57tXFr"}))),ba.createElement(Bt.YP,{borderRadius:8,fontSize:"$sm",height:30,px:12,py:0,width:100,placeholder:"Micro Lamports",overflow:"hidden",value:t.priorityFee,onChangeText:e=>{/^\d*$/.test(e)&&n((t=>({...t,priorityFee:e})))}})),ba.createElement(R.sL,{f:1,ai:"center",jc:"space-between"},ba.createElement(R.FA,{gap:"$DEPRECATED_1"},ba.createElement(q.q,{color:"$baseTextMedEmphasis",fontWeight:"$bold",fontSize:"$xs"},P.ag._({id:"GEQ14R"}))),ba.createElement(Bt.YP,{borderRadius:8,fontSize:"$sm",height:30,px:12,py:0,width:100,placeholder:"Units",value:t.computeUnitLimit,onChangeText:e=>{/^\d*$/.test(e)&&n((t=>({...t,computeUnitLimit:e})))}})))):null,ba.createElement(R.sL,{f:1,ai:"center",jc:"space-between"},ba.createElement(R.FA,{gap:"$DEPRECATED_1"},ba.createElement(q.q,{color:"$baseTextMedEmphasis",fontWeight:"$bold",fontSize:"$xs"},P.ag._({id:"qYuscr"}))),ba.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$xs"},isNaN(i)?"-":i.toFixed(9)," ",e))):null}var ya=n(202784);const $a=["jup.ag","squads.so"];function Aa({currentRequest:e}){const t=(0,c.useMemo)((()=>`transaction-${e.request.publicKey}-${e.request.tx}`),[e.request.publicKey,e.request.tx]),n=(0,Mr.y)(),r=(0,Y.Os)(e.request.blockchainId,e.request.publicKey),a=(0,s.Dv)(d.F),o=(0,Y.gI)(e.request.blockchainId),i=(0,s.Dv)(I.D5).preferences.developerMode,l=(0,s.Dv)(zr),m=(0,ht.G)(Wr(e.request.tx)),g="hasData"===m.state?m.data:null;(0,c.useEffect)((()=>{"hasError"===m.state&&console.error("Failed to load transaction fee tiers:",m)}),[m.state]);const p=(0,s.Dv)(Ur),E=(0,s.Dv)(Fr),f=$a.some((t=>new URL(e.event.origin.address).hostname.endsWith(t))),b="auto"===l||void 0===l||f,h=(0,c.useRef)(null),$=(0,c.useRef)(null),A=(0,c.useCallback)((()=>{const t={disableFeeConfig:!1,disableDowngradeAccounts:!0,isMaxAmount:e.uiOptions.isMaxAmount??!1,jitoBundle:E,priorityFee:"0",jitoTipAmount:0,computeUnitLimit:"",downgradedWritableAccounts:[]};if("custom"===l&&p)return{...t,priorityFee:p.computeUnitPrice?String(p.computeUnitPrice):"0",computeUnitLimit:p.computeUnitLimit?String(p.computeUnitLimit):"",jitoTipAmount:p.jitoTip||0,jitoBundle:p.jitoBundle??E};if(l&&"auto"!==l&&g?.tiers?.[l]){const e=g.tiers[l];if(e){const n={...t,priorityFee:e.priorityFee?e.priorityFee.toString():"0",jitoTipAmount:(e.jitoTip||0)/Nn.j,jitoBundle:!1};return n.jitoBundle&&(n.priorityFee="0"),n}}return t}),[l,p,g,E,e.uiOptions.isMaxAmount]),v=(0,c.useMemo)((()=>b?void 0:A()),[b,A]),T=(0,c.useRef)(void 0),x=(0,c.useRef)(0),k=JSON.stringify({selectedFeeTier:l,tierData:g?.tiers,customSettings:p,jitoBundleEnabled:E,globalIsDeveloperMode:i}),C=(0,c.useRef)("");C.current!==k&&(C.current=k,x.current++),T.current=v;const[w]=Br(Vr(e.request),void 0),[S]=Br(Hr(e.request),!1);let q=e.request.publicKey;r.info.type===_.B$.BP_SAFE&&r.info.publicKeyringInfo?.keyringType===_.ZO.BP_SAFE&&(q=r.info.publicKeyringInfo.multisigInfo.signerPublicKey);const L=(0,c.useMemo)((()=>({...e.request,isMaxAmount:e.uiOptions.isMaxAmount,bypassMutation:b,constructedTxOverride:T.current,selectedFeeTier:l,tierData:g,customSettings:p,isDeveloperMode:i,jitoBundleEnabled:E,originAddress:e.event.origin.address})),[e.request,e.uiOptions.isMaxAmount,b,x.current,i,E,e.event.origin.address]),[F]=Br(pr(L),null),[B]=Br(tr(e.request),null),M=(0,c.useMemo)((()=>B?.message?function(e){const t=new Set;for(const n of e.instructions)t.add(n.programId.toBase58());return Array.from(t)}(B.message):[]),[B?.message]),K=(0,c.useMemo)((()=>Kn(M)),[M]),z=M.length>0&&0===K.length,{programApprovalInfo:N}=xt({programIds:M,displayProgramIds:K,blockchainId:e.request.blockchainId,currentRequest:e,shouldTrack:Mn(M)}),[O,j]=Br(ir(L),{tx:e.request.tx,signers:[e.request.publicKey],metadata:{numberOfTransactions:1,transactionNumber:1}}),[U,W]=(0,c.useState)(!1),H=(0,s.Dv)((0,D.I5)(e.request.blockchainId)),V=(0,Z.qZ)(e.request.blockchainId),G=!(!V?.rpcUrl||!H.rpcUrl||H.rpcUrl===V.rpcUrl),[Q,J]=(0,c.useState)(!0),[X,ee]=(0,c.useState)(!1),te=(0,s.b9)(Vr(e.request)),ne=(0,c.useCallback)((e=>{if("function"==typeof e){if(!w)return;te(e(w))}else te(e)}),[te,w]),[re,ae]=(0,c.useState)(!1),oe=n.isTxFeeSettingsEnabled&&S,[ie]=Br(nr({publicKey:q,blockchainId:e.request.blockchainId}),!0),[se,ce]=Br(fr({txs:[e.request.tx],blockchainId:e.request.blockchainId,publicKey:e.request.publicKey}),[]),le=(0,c.useMemo)((()=>{const e=JSON.stringify({selectedFeeTier:l,jitoTipAmount:w?.jitoTipAmount,priorityFee:w?.priorityFee,jitoBundle:w?.jitoBundle}),t=C.current!==e;return t&&(C.current=e),t}),[l,w?.jitoTipAmount,w?.priorityFee,w?.jitoBundle]),ue=F?.simulationTx??O.tx,de=$r(H.txSimulationUrl,H.caip2Reference,[ue],e.event.origin.address,e.request.publicKey,(e=>{W(!0),console.error(e)}),G),[me,ge]=Br(Xr({tx:ue,blockchainId:e.request.blockchainId,publicKey:e.request.publicKey,rescanTrigger:x.current}),{isLoading:!0,error:null}),pe=(0,c.useMemo)((()=>{try{return a.readQuery({query:u.v6,variables:{address:e.request.publicKey,caip2:o}})}catch{return null}}),[a,e.request.publicKey,o.namespace,o.reference]),Ee=(0,c.useMemo)((()=>{const e={},t=pe?.wallet?.balances?.tokens?.edges??[];for(const n of t){const t=n?.node;if(!t)continue;const r=(0,u.Yb)(t),a=(0,u.Kx)(r.tokenListEntry);r.token&&a&&(e[r.token]={decimals:a.decimals??0,symbol:a.symbol??"Unknown",logo:a.logo??""})}return e}),[pe]),{apolloCacheMetadata:fe,missingMints:be}=(0,c.useMemo)((()=>{const e=me?.balanceDiffs??[],t={},n=[],r=`${o.namespace}:${o.reference}`;for(const o of e){if(o.mint===Lr.VU||Ee[o.mint])continue;const e=btoa(`${r}_token_list_entry#${o.mint}`),i=a.readFragment({id:`TokenListEntry:${e}`,fragment:u.Ve});i?.address?t[i.address]={decimals:i.decimals??0,symbol:i.symbol??"Unknown",logo:i.logo??""}:n.push(o.mint)}return{apolloCacheMetadata:t,missingMints:[...new Set(n)]}}),[me?.balanceDiffs,Ee,a,o.namespace,o.reference]),he=(0,ht.G)(Yr({addresses:be,caip2:{namespace:o.namespace||"",reference:o.reference||""}})),ye="hasData"===he.state?he.data:null,$e="loading"===he.state,Ae=(0,c.useMemo)((()=>{const e={...Ee,...fe},t=ye?.data?.tokenList??[];for(const n of t)n?.address&&(e[n.address]={decimals:n.decimals??0,symbol:n.symbol??"Unknown",logo:n.logo??""});return e}),[Ee,fe,ye]),ve=(0,c.useRef)(ue),Te=ve.current!==ue,xe=(0,c.useRef)(null);(0,c.useEffect)((()=>{ve.current=ue}),[ue]),(0,c.useEffect)((()=>{"hasData"===ge&&me&&!me.isLoading&&(xe.current=ue)}),[ge,me,ue]),(0,c.useEffect)((()=>{de.normalizedEvaluation&&(h.current=de.normalizedEvaluation,$.current=ue)}),[de.normalizedEvaluation,ue]);const Ce=(0,c.useMemo)((()=>{const e=me?.balanceDiffs;if(!e||0===e.length)return;const t={};for(const n of e){const e=Jr(n,Ae[n.mint]);t[n.owner]||(t[n.owner]=[]),t[n.owner].push(e)}return t}),[me?.balanceDiffs,Ae]),Ie=(0,c.useMemo)((()=>{const e=me&&!me.isLoading&&(me?.error||"hasError"===ge),t=Ce&&Object.keys(Ce).length>0,n=de.normalizedEvaluation,r=n?.expectedStateChanges;let a;t?a=Ce:e&&r&&(a=r);let o=[],i=[],s="NONE";if(n?(o=n.warnings,i=n.errors,s=n.action):!h.current||!le&&Te||(o=h.current.warnings,i=h.current.errors,s=h.current.action),a||n||"loading"!==ge)return{action:s,warnings:o,errors:i,expectedStateChanges:a}}),[me,ge,Ce,de.normalizedEvaluation,le,Te]),we=(0,c.useMemo)((()=>{const e=me&&!me.isLoading;return!(null===xe.current||xe.current===ue)||(e?!!(be.length>0&&$e):!Ie)}),[me,de.isLoading,Ie,le,Te,be.length,$e,ue]),Se=[!Array.isArray(O)&&O?.metadata?.isJitoBundle?[O]:O],_e=F?.txs??Se,De=()=>e.error(new Error(P.ag._({id:"xs2mxQ"}))),Re=(0,c.useMemo)((()=>oe&&O?.tx&&(e.request.blockchainId===_.Ek.SOLANA_MAINNET||e.request.blockchainId===_.Ek.SOLANA_DEVNET)?re?ya.createElement(R.FA,{gap:"$3"},ya.createElement(sa,{blockchainId:e.request.blockchainId,isEditing:!0,onDone:()=>ae(!1)})):ya.createElement(ga,{key:"TransactionFeeSettingTiers",serializedTx:O.tx,currentRequest:e,onEditingChange:ae}):null),[oe,O?.tx,re,e,ae]),qe=(0,c.useMemo)((()=>!oe&&w?ya.createElement(ha,{key:"TransactionSettings",gasSymbol:H.gasCurrencySymbol,overrides:w,setOverrides:ne}):null),[oe,w,H,ne]),Pe=me?.error||"hasError"===ge,Fe=U||de.error,Be=!O?.tx||"loading"===j,Me="loading"!==j&&O?.tx&&"loading"!==ge&&!(me?.isLoading??1)&&!Te&&!(be.length>0&&$e)&&!(oe&&"loading"===m.state),Ke=!X&&!Me;(0,c.useEffect)((()=>{Me&&!X&&ee(!0)}),[Me,X]);const ze=Pe&&Fe&&!de.skipped&&Q;if("hasData"===ce&&se.length>0){const e=se[0],t=e?.name,n=e?.token,r=e?.collection?.name;return ya.createElement(ke.P,{warning:{severity:"CRITICAL",message:P.ag._({id:"9M5jHN",values:{collectionName:r,nftName:t,nftToken:n}})},onDeny:De})}if(F?.error)return ya.createElement(ke.P,{warning:{severity:"CRITICAL",message:F.error},onDeny:De});if(ze)return ya.createElement(ke.P,{title:P.ag._({id:"/bIfDH"}),warning:{severity:"WARNING",message:P.ag._({id:"RPttCT"})},onIgnore:()=>J(!1),onDeny:De});const Ne=[];if("hasError"===ce&&Ne.push({message:P.ag._({id:"8h5Wn4"}),severity:"WARNING"}),e.event.origin.isUnverified){const t=e.event.origin.name;Ne.push({message:He(t),severity:"WARNING"})}if(!0!==ie){const e=H.gasCurrencySymbol;Ne.push({message:P.ag._({id:"3fkXED",values:{symbol:e}}),severity:"CRITICAL"})}if(!H.txSimulationUrl){const e=H.name;Ne.push({message:P.ag._({id:"po+OwH",values:{networkName:e}}),severity:"INFO"})}if(B?.message.instructions.find((e=>e.programId.equals(Rn.SystemProgram.programId)&&4===e.data[0]))&&Ne.push({message:P.ag._({id:"XPu0Ct"}),severity:"CRITICAL"}),re)return Re;const Oe=[],je=[];return r.info.type===_.B$.BP_SAFE&&r.info.publicKeyringInfo?.keyringType===_.ZO.BP_SAFE&&je.push(ya.createElement(va,{key:"gas-wallet-balance",publicKey:r.info.publicKeyringInfo.multisigInfo.signerPublicKey,blockchainId:e.request.blockchainId})),Re?Oe.push(Re):qe&&Oe.push(qe),ya.createElement(ya.Fragment,null,Ke?ya.createElement(y,null):ya.createElement(Le,{key:t,origin:e.event.origin,relevantAddresses:e.event.uiOptions.relevantAccounts,signerPublicKey:e.request.publicKey,isApproveLoading:Be,isEvaluationLoading:we,onDeny:De,onApprove:async()=>{O?(e.respond({txs:_e,confirmed:!0}),await(0,bt.D)(2),await a.query({query:u.v6,fetchPolicy:"network-only",context:u.cE,variables:{address:e.request.publicKey,caip2:o}})):console.error("unable to fetch or parse transaction data")},evaluation:Ie,customWarnings:Ne,append:Oe,prepend:je,programApprovalInfo:N,blockchainId:e.request.blockchainId,contractIds:z?[]:K,serializedTx:ue,isStandardTransaction:z}))}function va({publicKey:e,blockchainId:t}){const[n,r]=(0,c.useState)(null),a=(0,s.Dv)((0,D.Pg)(t));return(0,c.useEffect)((()=>{a.connection.getBalance((0,On.u)(e)).then((e=>{r(e)}))}),[e,a]),ya.createElement(R.FA,{gap:"$3"},ya.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"Avd/dt"})),ya.createElement(R.sL,null,ya.createElement(N.xK,{publicKey:e}),ya.createElement(R.FA,null,null!==n?ya.createElement(q.q,{fontSize:"$sm",color:n<15e6?"$yellowText":n<1e7?"$redText":"$baseTextHighEmphasis"},(n/Nn.j).toFixed(4)," SOL"):ya.createElement(Kr.O,{height:12,width:40,radius:"$2"}))))}var Ta=n(202784);function xa({currentRequest:e}){const t=e.request.blockchainId,n=(0,s.Dv)(I.D5),r=n.publicKeys.platforms[t]?.publicKeys[e.request.publicKey],[a,o]=(0,c.useState)(!1);return a||"view-only"!==r?.type?Ta.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},Ta.createElement(Aa,{currentRequest:e})):Ta.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>o(!0)})}var ka=n(348834).Buffer,Ca=n(202784);function Ia({currentRequest:e}){const t=(0,s.Dv)(I.D5),n=(0,s.Dv)((0,D.I5)(e.request.blockchainId)).name,r=t.publicKeys.platforms[e.request.blockchainId]?.publicKeys[e.request.publicKey],[a,o]=(0,c.useState)(!1),i=(l=e.request.message,l?/^0x[0-9a-fA-F]+$/.test(l)&&(l.length-2)%2==0?ka.from(l.slice(2),"hex"):ka.from(l,"utf8"):ka.alloc(0)).toString("binary");var l;return a||"view-only"!==r?.type?Ca.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},Ca.createElement(tt,{publicKey:e.request.publicKey,currentRequest:e,title:P.ag._({id:"aqrlWY",values:{networkName:n}}),message:i,blockchainId:e.request.blockchainId})):Ca.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>o(!0)})}const wa=(0,B.xu)((({blockchainId:e,publicKey:t,tx:n})=>(0,F.cn)((async r=>{try{const a=await r((0,D.yv)(e));return await a.simulateTransaction(n,t)}catch(e){return{error:e.message||"Simulation failed"}}}))),((e,t)=>e.blockchainId===t.blockchainId&&e.publicKey===t.publicKey&&e.tx===t.tx)),Sa=9e3,_a=1e4,Da=5;function Ra(e){try{const{simulation:t,validation:n}=e;if(!t||!n)return{action:"NONE",errors:[P.ag._({id:"7ZIkfZ"})],warnings:[]};const r=[];"Error"===n.result_type&&r.push(n.error),"Error"===t.status&&r.push(t.error);const a={Benign:"NONE",Warning:"WARN",Malicious:"BLOCK",Error:"BLOCK"},o={Benign:"INFO",Warning:"WARNING",Malicious:"CRITICAL",Error:"CRITICAL"},i="Benign"===n.result_type?void 0:{severity:o[n.result_type],message:n.description??""},s="assets_diffs"in t?t.assets_diffs??{}:{};return{action:a[n.result_type],errors:r,expectedStateChanges:Object.fromEntries(Object.entries(s).map((([e,t])=>[e,t.map((e=>{const t=t=>n=>{const r=`${n.summary??""}`;return{asset:"logo_url"in e.asset&&e.asset.logo_url?{imageUrl:e.asset.logo_url,isNonFungible:!1,name:e.asset.name??e.asset.symbol??""}:void 0,humanReadableDiff:r,suggestedColor:"in"===t?"CREDIT":"DEBIT"}};return[...e.in.map(t("in")),...e.out.map(t("out"))]})).flat()]))),warnings:[...i?[i]:[]]}}catch(e){return void console.error(e,"Unexpected Blockaid response")}}var qa=n(202784);function Pa({currentRequest:e}){const t=(0,s.Dv)((0,D.I5)(e.request.blockchainId)),[n,r]=(0,c.useState)(!1),[a,o]=(0,c.useState)(!0),i=(0,c.useMemo)((()=>({blockchainId:e.request.blockchainId,publicKey:e.request.publicKey,tx:e.request.tx})),[e.request.blockchainId,e.request.publicKey,e.request.tx]),l=(0,s.Dv)(wa(i)),u=(0,c.useCallback)((e=>{r(!0),console.error(e)}),[]),d=function(e,t,n,r,a){const o=Gt((0,c.useCallback)((async()=>{if(!e||!t.blockaid)return{skipped:!0};try{const a=new AbortController,o=a.signal;setTimeout((()=>{a.abort()}),Sa);const i={account_address:r,block:"latest",chain:"tron",data:t.blockaid,options:["simulation","validation"],metadata:{domain:n,non_dapp:!n}},s=await(0,Vt.R)(e,{signal:o,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)},fetch);if(s.ok)return{evaluation:await s.json(),skipped:!1};{const e=await s.json();return{error:new Error(`Blockaid API returned non-200 response: ${s.status}: ${JSON.stringify(e)}`)}}}catch(e){return e.message.toLowerCase().includes("aborted")?{error:new Error("Request timeout reached")}:{error:e}}}),[e,n,t,r]),_a,Da),i=(0,c.useMemo)((()=>{const e=o.data?.evaluation;return{isLoading:!o.isFetched,error:o.data?.error||o.error,evaluation:e,normalizedEvaluation:e?Ra(e):void 0,skipped:o.data?.skipped}}),[o]),s=i.error;return(0,c.useEffect)((()=>{s&&a(s)}),[a,s]),i}(t.txSimulationUrl,l,e.event.origin.address,e.request.publicKey,u),m=()=>e.error(new Error("Approval Denied")),g=(n||d.error||!d.normalizedEvaluation)&&!d.skipped&&a;return qa.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},d.isLoading?qa.createElement(y,null):g?qa.createElement(ke.P,{title:P.ag._({id:"/bIfDH"}),warning:{severity:"WARNING",message:P.ag._({id:"RPttCT"})},onIgnore:()=>o(!1),onDeny:m}):qa.createElement(Le,{origin:e.event.origin,relevantAddresses:e.event.uiOptions.relevantAccounts,signerPublicKey:e.request.publicKey,isApproveLoading:!1,evaluation:d.normalizedEvaluation,onDeny:m,onApprove:()=>{e.respond({confirmed:!0})},append:[qa.createElement(R.FA,{key:"TronDetails",space:"$DEPRECATED_3"},qa.createElement(q.q,{fontWeight:"$bold",color:"$baseTextHighEmphasis"},P.ag._({id:"5HVoyc"})),void 0!==l.bandwidth&&qa.createElement(qa.Fragment,null,qa.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},qa.createElement(R.FA,{space:"$DEPRECATED_1"},qa.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"Uit9W3"}))),qa.createElement(q.q,{fontSize:"$sm"},l.bandwidth))),void 0!==l.bandwidthShortfall&&qa.createElement(qa.Fragment,null,qa.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},qa.createElement(R.FA,{space:"$DEPRECATED_1"},qa.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"UGjwpM"}))),qa.createElement(q.q,{fontSize:"$sm"},l.bandwidthShortfall))),void 0!==l?.energyEstimate&&qa.createElement(qa.Fragment,null,qa.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},qa.createElement(R.FA,{space:"$DEPRECATED_1"},qa.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"TXWhHX"}))),qa.createElement(q.q,{fontSize:"$sm"},l.energyEstimate))),void 0!==l?.feeEstimate&&qa.createElement(qa.Fragment,null,qa.createElement(R.sL,{alignItems:"center",justifyContent:"space-between",space:"$DEPRECATED_3"},qa.createElement(R.FA,{space:"$DEPRECATED_1"},qa.createElement(q.q,{fontWeight:"$bold",fontSize:"$sm"},P.ag._({id:"nh9q9c"}))),qa.createElement(q.q,{fontSize:"$sm"},l.feeEstimate," ",t.gasCurrencySymbol))))]}))}var La=n(202784);function Fa({currentRequest:e}){const t=e.request.blockchainId,n=(0,s.Dv)(I.D5),r=n.publicKeys.platforms[t]?.publicKeys[e.request.publicKey],[a,o]=(0,c.useState)(!1);return a||"view-only"!==r?.type?La.createElement(Pa,{currentRequest:e}):La.createElement(Ne,{origin:e.event.origin.address,onDeny:()=>e.error(new Error("Approval Denied")),onIgnore:()=>o(!0)})}var Ba=n(636134),Ma=n(972160);const Ka=(0,B.xu)((e=>(0,F.cn)({isLoading:!0})),((e,t)=>e.siteUrl===t.siteUrl&&e.blockchainId===t.blockchainId)),za=(0,B.xu)((e=>{const t=(0,F.cn)((async t=>{const n=await t((0,D.I5)(e.blockchainId));if(!n?.txSimulationUrl)return{isLoading:!1};try{return{isLoading:!1,evaluation:await(async(e,t)=>{const n=await(0,Vt.R)(`${t}/scan-site`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({siteUrl:e})},fetch);if(!n.ok)throw new Error(P.ag._({id:"RQwvz7"}));return n.json()})(e.siteUrl,n.txSimulationUrl)}}catch(e){return{isLoading:!1,error:e instanceof Error?e:new Error(P.ag._({id:"ccNUXB"}))}}}));return(0,Ma.j)(Ka(e),((n,r)=>{n(t).then((t=>{r(Ka(e),t)}))}))}),((e,t)=>e.siteUrl===t.siteUrl&&e.blockchainId===t.blockchainId));function Na(e){const[t,n]=(0,c.useState)(!1),r=new URL(e).hostname.replace(/^www\./,"");return(0,c.useEffect)((()=>{const e=(0,u.im)(u.WW,{origin:r});(0,u.HL)(e).then((t=>fetch(`${w.Fv}/v3/graphql`,{method:"POST",headers:{Accept:"application/json","apollographql-client-name":"backpack-secure-ui","Content-Type":"application/json",...t},body:JSON.stringify(e)}))).then((e=>e.json())).then((e=>n(e.data.blocked)))}),[r]),t}var Oa=n(448288),ja=n(725582),Ua=n(457373),Wa=n(139341),Ha=n(202784);function Va({blockchainId:e,networkName:t,onClose:n,isUnknownNetwork:r=!1,currentRequest:a}){const o=!r,i=r?P.ag._({id:"QHV/fA"}):t?P.ag._({id:"TZ7IGU",values:{networkName:t}}):P.ag._({id:"4lVUV4"}),s=r?P.ag._({id:"InoNK2",values:{blockchainId:e}}):P.ag._({id:"o8W332"}),c=r?wn.UO:()=>Ha.createElement(pe._,{id:e,size:36});return Ha.createElement(Ce.Q,{onDeny:n,onApprove:o?async()=>{if(!a.suspended&&!a.responded)if("extension-app"!==(0,ja.d)())a.suspend({reason:Ua.Dg.NO_WALLET,blockchainId:e,networkName:t});else{const n=new URLSearchParams({createWalletForNetwork:e,suspendedEventId:String(a.id)});if("sidePanel"===document.querySelector("html")?.dataset.mode||window.innerWidth>=400){const r=`sidePanel.html?${n.toString()}`;return window.location.replace(chrome.runtime.getURL(r)),void a.suspend({reason:Ua.Dg.NO_WALLET,blockchainId:e,networkName:t})}const r=`popout.html?${n.toString()}`;(0,Oa.l)(r).then((()=>{a.suspend({reason:Ua.Dg.NO_WALLET,blockchainId:e,networkName:t})})).catch((()=>{a.error(new Error("Failed to open wallet creation window"))}))}}:void 0,leftButton:P.ag._({id:"yz7wBu"}),rightButton:o?P.ag._({id:"XyAmgg"}):null,buttonDirection:"row"},Ha.createElement(Wa.B,{icon:c,title:i,body:s}))}var Ga=n(202784);function Za({children:e}){return Ga.createElement(q.q,{fontSize:"$lg",fontWeight:"$bold",textAlign:"center"},e)}var Qa=n(120584),Ja=n(202784);function Xa({activeWallet:e,setOpen:t,copyable:n}){return Ja.createElement(Qa.E4,null,Ja.createElement(Qa.E4.Item,null,Ja.createElement(Ft.zx,{borderRadius:"$DEPRECATED_4",backgroundColor:"$baseBackgroundL1",borderColor:"$baseBorderMed",justifyContent:"center",alignItems:"center",height:"auto",paddingVertical:"$DEPRECATED_2",space:"$DEPRECATED_2",paddingLeft:"$DEPRECATED_3",paddingRight:"$DEPRECATED_2",display:"flex",onPress:()=>t((e=>!e)),outlineWidth:0,focusStyle:{opacity:.8,outlineWidth:0},pressStyle:{opacity:.8,outlineWidth:0},hoverStyle:{opacity:.8,outlineWidth:0}},Ja.createElement(pe._,{id:e.blockchainId,size:16}),Ja.createElement(q.q,{fontSize:"$sm"},e.info.name),Ja.createElement(he._,{size:"$DEPRECATED_1",color:"$baseIcon"}))),n?Ja.createElement(Qa.E4.Item,null,Ja.createElement(Ft.zx,{borderRadius:"$DEPRECATED_4",backgroundColor:"$baseBackgroundL1",borderColor:"$baseBorderMed",justifyContent:"center",alignItems:"center",height:"auto",paddingVertical:"$DEPRECATED_2",space:"$DEPRECATED_2",paddingLeft:"$DEPRECATED_2",paddingRight:"$DEPRECATED_3",display:"flex",onPress:()=>{},icon:Ja.createElement(ce.C,{size:"$DEPRECATED_1",color:"$baseIcon"})})):null)}function Ya({open:e,setOpen:t,activeWallet:n}){const r=(0,s.Dv)(I.D5),a=(0,s.Dv)(I.s7),o=Object.entries(r.publicKeys.platforms[n.blockchainId]?.publicKeys??{}),i=(0,In.F)();return Ja.createElement(f.yo,{open:e,onOpenChange:t,snapPoints:[50],zIndex:91e4,animation:"quick",modal:!1,disableDrag:!0},Ja.createElement(f.yo.Overlay,{backgroundColor:i.baseBackgroundL1.val,opacity:.4,zIndex:11e4}),Ja.createElement(f.yo.Frame,{position:"relative",borderColor:"$borderColor",borderWidth:"$DEPRECATED_1",borderBottomWidth:0,borderTopWidth:0,zIndex:11e4,backgroundColor:i.baseBackgroundL0.val},Ja.createElement(R.FA,{height:"100%"},Ja.createElement(Lt.A,null,Ja.createElement(R.FA,{space:"$DEPRECATED_2",paddingTop:"$DEPRECATED_4"},o.map((([e,o])=>{const i=e===n.publicKey;return Ja.createElement(R.sL,{padding:"$DEPRECATED_4",marginHorizontal:"$DEPRECATED_2",borderRadius:"$DEPRECATED_11",key:e,space:"$DEPRECATED_4",justifyContent:"center",backgroundColor:i?"$invertedBaseBackgroundL0":void 0,hoverStyle:{backgroundColor:i?void 0:"$baseBackgroundL0"},pressStyle:{backgroundColor:i?void 0:"$baseBackgroundL1"},cursor:i?void 0:"pointer",onPress:async()=>{i||await a.setActiveWallet({uuid:r.user.uuid,blockchain:n.blockchain,blockchainId:n.blockchainId,publicKey:e}),t(!1)}},Ja.createElement(pe._,{id:n.blockchainId,size:16}),Ja.createElement(R.FA,{flex:1,justifyContent:"center"},Ja.createElement(q.q,{color:i?"$invertedBaseTextHighEmphasis":"$baseTextHighEmphasis"},o.name)),Ja.createElement(R.FA,{justifyContent:"center"},Ja.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},(0,K.R1)(e,5))))})))))))}function eo({blockchain:e,blockchainId:t,copyable:n,children:r,...a}){const o=(0,s.Dv)((0,Cn.t_)(t)),[i,l]=(0,c.useState)(!1);return o?Ja.createElement(R.FA,{flex:1,...a},Ja.createElement(R.sL,{justifyContent:"center",alignContent:"center"},Ja.createElement(Xa,{setOpen:l,copyable:n,activeWallet:o})),r,Ja.createElement(Ya,{setOpen:l,open:i,activeWallet:o})):r}var to=n(202784);function no({currentRequest:e}){const t=e.request.origin.address,n=e.request.blockchainId,r=(0,c.useMemo)((()=>({siteUrl:t,blockchainId:n})),[t,n]),a=(0,s.Dv)(za(r)),o=e.request.blockchain,i=(0,s.Dv)((0,Cn.t_)(n)),l=Na(e.event.origin.address),[m,g]=(0,c.useState)(!1),p=(0,Y.gI)(n),f=(0,s.Dv)(d.F),b=(0,s.Dv)(Ba.n8);if(!i)return to.createElement(Va,{blockchainId:n,onClose:()=>e.error(new Error("No Wallet Found.")),currentRequest:e});const h=()=>e.error(new Error("Approval Denied"));if(a.isLoading)return to.createElement(y,null);if(!m&&(l||!a.error&&a.evaluation?.isMalicious))return to.createElement(E.Kq,{height:"100%",width:"100%",backgroundColor:"$baseBackgroundL0"},to.createElement(ke.P,{onDeny:h,onIgnore:()=>g(!0),title:P.ag._({id:"4Q7iYO"}),warning:{severity:"CRITICAL",message:P.ag._({id:"Df1d1P"})}}));const $=We(e.request.origin.name);return to.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},to.createElement(eo,{blockchain:o,blockchainId:n,paddingTop:"$DEPRECATED_4"},to.createElement(Ce.Q,{paddingTop:"$DEPRECATED_4",onApprove:()=>{e.respond({confirmed:!0,publicKey:i.publicKey});const n="ios"===ue.default.OS?u.hx.Ios:"android"===ue.default.OS?u.hx.Android:u.hx.Web;f.mutate({mutation:u.ur,variables:{input:{url:t,caip2:p,installationId:b,platform:n}}}).catch((e=>{console.error("Failed to insert wallet connection row:",e)}))},onDeny:h},!a.isLoading&&a.error?to.createElement(Se,{warning:{severity:"WARNING",message:P.ag._({id:"ycR0No",values:{siteUrl:t}})}}):null,to.createElement(E.Kq,{gap:"$DEPRECATED_8"},to.createElement(Za,null,P.ag._({id:"tjThYv",values:{origin:$}})),to.createElement(Ze,{origin:e.request.origin}),to.createElement(E.Kq,{margin:"$DEPRECATED_4",space:"$DEPRECATED_4"},to.createElement(q.q,{fontWeight:"$semiBold"},P.ag._({id:"Sh2Kzn"})),to.createElement(E.Kq,{ml:"$DEPRECATED_2",space:"$DEPRECATED_2"},"xnft"!==e.request.origin.context?to.createElement(R.sL,{space:"$DEPRECATED_2"},to.createElement(se.J,{color:"$greenIcon"}),to.createElement(q.q,null,P.ag._({id:"Elokvg"}))):null,to.createElement(R.sL,{space:"$DEPRECATED_2"},to.createElement(se.J,{color:"$greenIcon"}),to.createElement(q.q,null,P.ag._({id:"DZYVBl"})))))))))}var ro=n(35893),ao=n(785766),oo=n(447994),io=n(22405),so=n(566310),co=n(79713),lo=n(706307),uo=n(406013),mo=n(631649),go=n(202784);function po({textToCopy:e,withAgreement:t=!1,onCopy:n,variant:r="secondary",copyText:a=P.ag._({id:"he3ygx"}),...o}){const[i,s]=(0,c.useState)("idle"),[l,u]=(0,c.useState)(!1),d=(0,c.useRef)(null),m=(0,c.useRef)("");(0,c.useEffect)((()=>()=>{if(d.current&&clearTimeout(d.current),m.current){const e=setTimeout((()=>{Te("").catch(console.error)}),3e4);d.current=e}}),[]);const g="primary"===r?mo.KM:mo.kq,p=!!t&&!l,E="web"===ue.default.OS?.5:.7,f={size:"$md",style:{marginLeft:8},opacity:p||"copied"===i?E:1,color:"primary"===r?"$buttonPrimaryText":"$buttonSecondaryText"},b={idle:{label:a,onPress:async()=>{if(!t||l){s("copying");try{const t=e();m.current=t,await Te(t),s("copied"),n&&n(),d.current&&clearTimeout(d.current),d.current=setTimeout((()=>{Te(""),m.current="",u(!1),s("idle")}),3e4);const r=setTimeout((()=>{s("idle")}),1e3);d.current=r}catch(e){s("idle")}}},icon:go.createElement(ce.C,f),disabled:p},copying:{label:a,icon:go.createElement(ce.C,f),disabled:p},copied:{label:P.ag._({id:"PiH3UR"}),icon:go.createElement(se.J,f),disabled:p}};return go.createElement(R.FA,{alignItems:"stretch",width:"100%",gap:"$4"},t&&go.createElement(ro.O,{value:l,onPress:()=>u((e=>!e)),label:P.ag._({id:"pvR9SU"})}),go.createElement(g,{...b[i],...o,size:"web"===ue.default.OS?void 0:"large"}))}function Eo(e){if(e&&e.uiOptions){for(const t of Object.keys(e.uiOptions)){const n=e.uiOptions[t];"string"==typeof n?e.uiOptions[t]="".padEnd(n.length,"0"):"object"==typeof n&&null!==n&&Eo({uiOptions:n})}for(const t of Object.keys(e.uiOptions))delete e.uiOptions[t]}}var fo=n(202784);const bo=(0,F.cn)(["explanation"]);function ho(e){const{currentRequest:t,getWarnings:n}=e,[[r,a],o]=(0,s.KO)(bo),{mnemonic:i}=t.uiOptions,l=Boolean(i),u=()=>{Eo(t),t.error(new Error("User closed the drawer"))};return(0,c.useEffect)((()=>()=>{l&&(Eo(t),o(["explanation"]))}),[l,o,t]),fo.createElement(R.FA,{f:1},l&&"explanation"!==r?"view"===r?fo.createElement($o,{handleClose:u,handleContinue:()=>o(["quiz"]),mnemonic:i,highlightNumber:a}):fo.createElement(vo,{handleGoBack:()=>{Eo(t),t.error(new Error("User closed the drawer"))},handleClose:u,handleComplete:()=>{Eo(t),t.respond({confirm:!0,password:!1,_sensitive_:!0})},handleWrongAnswer:e=>{o(["view",e])},mnemonic:i}):fo.createElement(yo,{handleClose:u,handleContinue:async e=>{e&&"string"==typeof e&&t.respond({confirm:!1,password:e,_sensitive_:!0}),o(["view"])},askForPassword:!i,getWarnings:n}))}function yo({askForPassword:e,handleClose:t,handleContinue:n,getWarnings:r}){const[a,o]=(0,c.useState)(""),[i,s]=(0,c.useState)(!1),l=()=>{n(a)},u=i&&(!e||a.length>0),d=P.ag._({id:"ZpImWw"}),m=r(d);return fo.createElement(Ce.Q,{title:d,rightButton:fo.createElement(j.x,{label:P.ag._({id:"TT2Wpx"}),onPress:e?l:n,disabled:!u}),leftButton:null,onClose:t,footer:fo.createElement(R.FA,{gap:"$4"},e?fo.createElement(oo.l0,{onSubmit:l,width:"100%",mb:"$1"},fo.createElement(so.a,{onChangeText:o,onSubmitEditing:l})):null,fo.createElement(ro.O,{value:i,onPress:s,label:P.ag._({id:"QHr63q"})}))},fo.createElement(ao.u,{title:P.ag._({id:"/5m0MA"}),icon:({size:e})=>fo.createElement(co.m,{color:"$yellowText",size:e}),subtitle:P.ag._({id:"k9yaek"})}),fo.createElement(R.FA,{gap:"$4"},m.map((({key:e,warning:t})=>fo.createElement(R.FA,{key:e},fo.createElement(R.sL,{borderRadius:"$medium",borderWidth:"$DEPRECATED_1",borderColor:"transparent",backgroundColor:"$baseBackgroundL1",alignItems:"center",justifyContent:"flex-start",cursor:"pointer",gap:"$DEPRECATED_3",paddingHorizontal:"$4",paddingVertical:"$2"},fo.createElement(R.FA,{f:1},fo.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm",lineHeight:20},t))))))))}function $o({mnemonic:e,handleClose:t,handleContinue:n,highlightNumber:r}){return fo.createElement(Ce.Q,{title:P.ag._({id:"HU/AUK"}),rightButton:P.ag._({id:"7VpPHA"}),leftButton:null,onClose:t,onApprove:n},fo.createElement(R.FA,{gap:"$3"},fo.createElement(q.q,{color:"$baseTextMedEmphasis",fontSize:"$sm",textAlign:"center"},P.ag._({id:"H2LTWT"})),fo.createElement(Ao,{mnemonic:e,highlightNumber:r})))}function Ao({mnemonic:e,highlightNumber:t}){const[n,r]=(0,c.useState)(!t);return(0,c.useLayoutEffect)((()=>{t&&setTimeout((()=>{r(!0)}),1e3)}),[t]),fo.createElement(R.FA,{bg:"$baseBackgroundL1",br:"$4"},fo.createElement(R.sL,{flexWrap:"wrap",justifyContent:"space-between",paddingVertical:"$1",borderBottomWidth:1,borderColor:"$baseBackgroundL3"},fo.createElement(io.M,null,e.split(" ").map(((e,r)=>fo.createElement(E.G7,{key:r,width:"50%",alignItems:"center",paddingHorizontal:"$4",paddingVertical:"$1",animation:"tooltip",opacity:r+1===t||n?1:.25,borderRadius:"$3",enterStyle:{opacity:n?1:0}},fo.createElement(E.G7,{jc:"center",pb:"$1",pt:"$1",width:"100%"},fo.createElement(R.sL,null,fo.createElement(q.q,{color:"$baseTextMedEmphasis",w:"$6"},r+1),fo.createElement(q.q,{f:1},e)))))))),fo.createElement(po,{textToCopy:()=>e}))}function vo({handleGoBack:e,handleClose:t,handleComplete:n,handleWrongAnswer:r,mnemonic:a}){const{correctAnswerCount:o,currentWord:i,handleAnswer:s,status:l,totalQuestions:u}=function({mnemonic:e,totalQuestions:t,handleSuccess:n,handleFailure:r}){const[a,o]=(0,c.useState)(0),[i,s]=(0,c.useState)("in_progress"),[l,u]=(0,c.useState)(null),[d,m]=(0,c.useState)([]),g=(0,c.useMemo)((()=>e.split(" ")),[e]),p=g.length,E=(0,c.useCallback)((()=>{let e=Array.from({length:p},((e,t)=>t)).filter((e=>!d.includes(e))),t=d;0===e.length&&(t=[],e=Array.from({length:p},((e,t)=>t)));const n=e[Math.floor((0,uo.n)()*e.length)];u(n),m([...t,n])}),[p,d]);(0,c.useEffect)((()=>{null===l&&E()}),[l,E]);const f=(0,c.useCallback)((e=>{if(null!==l&&"in_progress"===i)if(e===l+1){const e=a+1;o(e),e===t?(s("completed"),u(null),m([]),n()):u(null)}else s("failed"),u(null),m([]),r(l+1)}),[l,a,t,n,r,i]);return{currentWord:(0,c.useMemo)((()=>null===l?"":g[l]||""),[l,g]),correctAnswerCount:a,totalQuestions:t,status:i,handleAnswer:f}}({handleFailure:r,handleSuccess:n,mnemonic:a,totalQuestions:3});return fo.createElement(Ce.Q,{title:P.ag._({id:"GybcXy"}),leftButton:null,rightButton:null,onClose:e},fo.createElement(R.FA,{width:"100%",mb:120},fo.createElement(R.FA,{width:"100%",gap:"$4",f:1,position:"absolute"},fo.createElement(io.M,null,fo.createElement(E.G7,{ai:"center",animation:"tooltip",backgroundColor:"completed"===l?"$greenText":"failed"===l?"$redText":"$baseBackgroundL1",borderRadius:"$3",enterStyle:{opacity:0},exitStyle:{backgroundColor:"$greenText",opacity:0},key:i,padding:"$4",width:"100%",position:"absolute"},fo.createElement(q.q,{fontSize:"$2xl"},i))),fo.createElement(E.G7,{mt:80},fo.createElement(xo,{total:u,current:o})))),fo.createElement(To,{onPressNumber:s}))}function To({onPressNumber:e}){const t="$1";return fo.createElement(R.sL,{flexWrap:"wrap",justifyContent:"space-between",width:"100%"},Array.from({length:12},((n,r)=>fo.createElement(E.G7,{key:r,width:"33.333333333333336%",alignItems:"center"},fo.createElement(E.G7,{jc:"center",pb:t,pl:r%3==0?void 0:t,pr:r%3==2?void 0:t,pt:t,width:"100%"},fo.createElement(lo.Z,{onPress:()=>e(r+1),accessibilityLabel:"Touchable"},fo.createElement(E.G7,{ai:"center",bg:"$baseBackgroundL1",borderRadius:"$2",p:"$2",hoverStyle:{backgroundColor:"$backgroundHover"}},fo.createElement(q.q,{fontSize:"$2xl"},r+1))))))))}function xo({current:e,total:t}){return fo.createElement(R.sL,{jc:"center",ai:"center",gap:"$4"},Array.from({length:t}).map(((t,n)=>fo.createElement(R.FA,{bg:e>=n?"$accentBlue":"$baseIcon",br:4,height:8,key:n,opacity:e<=n?1:.4,width:8}))))}var ko=n(202784);function Co({currentRequest:e}){return ko.createElement(ho,{currentRequest:e,getWarnings:()=>[{key:"write",warning:P.ag._({id:"nWCktq"})},{key:"digital",warning:P.ag._({id:"8yts9Z"})}]})}var Io=n(362950),wo=n(202784);function So({currentRequest:e}){switch(e.request.action){case"CREATE":return wo.createElement(Do,{currentRequest:e});case"UPDATE":return wo.createElement(qo,{currentRequest:e});case"DELETE":return wo.createElement(Po,{currentRequest:e})}}const _o=async(e,t,n,r,a,o)=>{try{const o={hasError:!1},i=(0,On.u)(n),s=await Un.MI.Multisig.fromAccountAddress(e.connection,i);let c;for(let e=0;e<=100;e++){const[n]=(0,Un.lP)({multisigPda:i,index:e});if(n.toBase58()===t){c=e;break}}void 0===c?(o.hasError=!0,o.vaultPda=P.ag._({id:"uJDEbF"})):o.multisigIndex=c;let l=!1,u=!1;return s.members.forEach((e=>{e.key.toBase58()===r&&(l=!0),e.key.toBase58()===a&&(u=!0)})),u||(o.exchangeSignerPublicKey=P.ag._({id:"Z+opGE",values:{exchangeSignerPublicKey:a}}),o.hasError=!0),l||(o.userSignerPublicKey=P.ag._({id:"6CF0+7",values:{userSignerPublicKey:r}}),o.hasError=!0),o}catch{return{hasError:!0,multisigPda:P.ag._({id:"6WEt1L"})}}};function Do({currentRequest:e}){const t=(0,s.Dv)((0,D.Pg)(_.Ek.SOLANA_MAINNET)),[n,r]=(0,c.useState)(null);return(0,c.useEffect)((()=>{(async()=>{const n=await _o(t,e.request.vaultPda,e.request.multisigPda,e.request.userSignerPublicKey,e.request.exchangeSignerPublicKey,e.request.exchangeSignerJWT);r(n)})()}),[]),wo.createElement(Ce.Q,{leftButton:P.ag._({id:"cFCKYZ"}),onDeny:()=>e.error(new Error("Approval Denied")),onApprove:()=>e.respond({multisigIndex:n?.multisigIndex,confirmed:!0}),rightButtonDisabled:n?.hasError,rightButton:P.ag._({id:"Z7ZXbT"})},wo.createElement(R.FA,{gap:"$4",flex:1,justifyContent:"space-between"},wo.createElement(Ro,{title:P.ag._({id:"YW3kGo"})}),n?wo.createElement(Lo,{result:n,currentRequest:e}):null))}function Ro({title:e}){return wo.createElement(R.FA,{flex:1,gap:"$7",justifyContent:"center",alignItems:"center"},wo.createElement(R.FA,{ai:"center",jc:"center"},wo.createElement(R.sL,{ai:"center",jc:"center",gap:"$3"},wo.createElement(hn.C,{size:40,bg:"$baseBackgroundL2",ai:"center",jc:"center"},wo.createElement(R.FA,{overflow:"hidden",width:18,height:18},wo.createElement(R.FA,{position:"absolute",top:-6,left:-6},wo.createElement(Io.j,{size:30,strokeWidth:1.5,fill:"none",color:"$baseTextMedEmphasis",strokeLinecap:"round",strokeLinejoin:"round"})))),wo.createElement(le.o,{color:"$baseTextMedEmphasis",size:24}),wo.createElement(An,{size:70}))),wo.createElement(R.FA,null,wo.createElement(q.q,{textAlign:"center",fontSize:"$lg",fontWeight:"$bold",lineHeight:"$lg"},e)))}function qo({currentRequest:e}){const t=(0,s.Dv)((0,D.Pg)(_.Ek.SOLANA_MAINNET)),[n,r]=(0,c.useState)(null),a=(0,s.Dv)(I.D5),o=e.request.vaultPda,i=e.request.blockchainId,l=a.publicKeys.platforms[i]?.publicKeys[o];return(0,c.useEffect)((()=>{(async()=>{if(!l||l.publicKeyringInfo?.keyringType!==_.ZO.BP_SAFE)return e.error(new Error(""));const n=l.publicKeyringInfo.multisigInfo,a=l.publicKeyringInfo.exchangeSignerPublicKey,o=await _o(t,e.request.vaultPda,l?.publicKeyringInfo.multisigInfo.multisigPda,e.request.userSignerPublicKey??n.signerPublicKey,e.request.exchangeSignerPublicKey??a,e.request.exchangeSignerJWT);r(o)})()}),[]),wo.createElement(Ce.Q,{leftButton:P.ag._({id:"cFCKYZ"}),onDeny:()=>e.error(new Error("Approval Denied")),onApprove:()=>e.respond({confirmed:!0}),rightButtonDisabled:n?.hasError,rightButton:P.ag._({id:"Z7ZXbT"})},wo.createElement(R.FA,{gap:"$4",flex:1,justifyContent:"space-between"},wo.createElement(Ro,{title:P.ag._({id:"yOoHrh"})}),n?wo.createElement(Lo,{result:n,currentRequest:e}):null))}function Po({currentRequest:e}){const t=(0,s.Dv)(I.D5),n=e.request.vaultPda,r=e.request.blockchainId,a=t.publicKeys.platforms[r]?.publicKeys[n];return wo.createElement(Ce.Q,{leftButton:P.ag._({id:"cFCKYZ"}),onDeny:()=>e.error(new Error("Approval Denied")),onApprove:()=>e.respond({confirmed:!0}),rightButton:P.ag._({id:"Z7ZXbT"})},wo.createElement(R.FA,{gap:"$4",flex:1,justifyContent:"space-between"},wo.createElement(Ro,{title:P.ag._({id:"7LYtFa"})}),wo.createElement(R.FA,{gap:"$4",padding:"$4",backgroundColor:"$baseBackgroundL1",borderRadius:"$4"},wo.createElement(R.FA,{gap:"$2"},wo.createElement(R.sL,{justifyContent:"space-between"},wo.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"6YtxFj"})),wo.createElement(q.q,{fontSize:"$sm"},a?.name))),wo.createElement(R.FA,{gap:"$2"},wo.createElement(R.sL,{justifyContent:"space-between"},wo.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"Du6bPw"})),wo.createElement(q.q,{fontSize:"$sm"},(0,K.R1)(e.request.vaultPda)))))))}function Lo({name:e,currentRequest:t}){return wo.createElement(R.FA,{gap:"$4",padding:"$4",backgroundColor:"$baseBackgroundL1",borderRadius:"$4"},t.request.name||e?wo.createElement(R.FA,{gap:"$2"},wo.createElement(R.sL,{justifyContent:"space-between"},wo.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"6YtxFj"})),wo.createElement(q.q,{fontSize:"$sm"},t.request.name??e))):null,wo.createElement(R.FA,{gap:"$2"},wo.createElement(R.sL,{justifyContent:"space-between"},wo.createElement(q.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},P.ag._({id:"Du6bPw"})),wo.createElement(q.q,{fontSize:"$sm"},(0,K.R1)(t.request.vaultPda)))))}var Fo=n(202784);function Bo({onSubmit:e}){const[t,n]=(0,c.useState)(""),[r,a]=(0,c.useState)(!1),[o,i]=(0,c.useState)(!1),s=async()=>{if(""!==t){i(!0);try{await e(t)}catch(e){a(!0),i(!1)}}},l=P.ag._({id:"aqcBbG"}),u=P.ag._({id:"3WmV84"}),d=[P.ag._({id:"rptFL4"}),P.ag._({id:"yndL5I"}),P.ag._({id:"mzU1Rg"})];return Fo.createElement(Ce.Q,{title:l,rightButton:Fo.createElement(R.FA,{gap:"$3"},Fo.createElement(oo.l0,{onSubmit:s},Fo.createElement(so.a,{onChangeText:e=>{n(e),r&&a(!1)},onSubmitEditing:s,hasError:r,testID:z.nN})),Fo.createElement(j.x,{color:"red",disabled:""===t,label:P.ag._({id:"f0PWZ5"}),onPress:s,loading:o,testID:""===t?void 0:z.qT})),leftButton:null},Fo.createElement(R.FA,{gap:"$3"},Fo.createElement(R.FA,null,Fo.createElement(q.q,{color:"$baseTextMedEmphasis",textAlign:"center"},u)),d.map((e=>Fo.createElement(R.FA,{key:e},Fo.createElement(R.sL,{borderRadius:"$medium",borderWidth:"$1",borderColor:"transparent",backgroundColor:"$baseBackgroundL1",alignItems:"center",justifyContent:"flex-start",gap:"$5",padding:"$3",paddingLeft:"$5"},Fo.createElement(R.FA,{width:"$2",justifyContent:"center",alignItems:"center",alignSelf:"center"},Fo.createElement(oe.u,{color:"$redIcon",size:"$1xl"})),Fo.createElement(R.FA,{f:1},Fo.createElement(q.q,{fontSize:"$base",fontWeight:"$medium"},e))))))))}var Mo=n(954243),Ko=n(421282),zo=n(726499);function No(e,t,n){const r=(0,c.useRef)(zo.Z.currentState);(0,c.useEffect)((()=>{const a=zo.Z.addEventListener("change",(a=>{"android"===ue.default.OS&&"active"===e&&"background"===t?"active"===r.current&&"background"===a&&n():r.current===e&&a===t&&n(),r.current=a}));return()=>{a.remove()}}),[e,n,t])}function Oo({currentRequest:e,onClose:t}){const[n,r]=(0,c.useState)(!1),[a,o]=(0,c.useState)(!0),i=()=>{Eo(e),r(!0)};return(0,c.useEffect)((()=>()=>{i()}),[]),No("active","inactive",(()=>{o(!1),i()})),No("inactive","background",(()=>{t?t():e.respond()})),No("active","background",(()=>{"android"===ue.default.OS&&(o(!1),i(),t?t():e.respond())})),{isErased:n,isVisible:a,eraseSensitiveData:i}}var jo=n(202784);function Uo({currentRequest:e}){const{isErased:t,isVisible:n}=Oo({currentRequest:e});if(!n)return null;const r=t?null:e.uiOptions.backup||null;return jo.createElement(Ce.Q,{leftButton:jo.createElement(j.x,{variant:"android"===ue.default.OS?"primary":"secondary",label:"Close",onPress:()=>e.respond({password:!1,_sensitive_:!0})}),buttonDirection:"column",rightButton:null},jo.createElement(R.FA,{height:"100%",justifyContent:"space-between",space:"$DEPRECATED_6"},jo.createElement(R.FA,{space:"$DEPRECATED_2"},jo.createElement(R.sL,{justifyContent:"center",alignItems:"center"},jo.createElement(Ko.b,{size:"$5xl"})),jo.createElement(q.q,{textAlign:"center",fontSize:"$2xl"},P.ag._({id:"nHvh44"})),jo.createElement(q.q,{textAlign:"center"},P.ag._({id:"VLmGKA"})),jo.createElement(q.q,{textAlign:"center"},P.ag._({id:"E/GqRo"})),jo.createElement(q.q,{textAlign:"center",fontWeight:"$bold"},P.ag._({id:"r4cvuA"}))),jo.createElement(R.FA,{gap:"$DEPRECATED_2"},jo.createElement(R.FA,null,jo.createElement(q.q,{fontSize:"$lg",fontWeight:"$bold"},P.ag._({id:"rXv9hW"}))),jo.createElement(R.FA,{flex:1},jo.createElement(Mo.K,{borderColor:"$baseBorderMed",borderWidth:2,bg:"$baseBackgroundL1",flex:1,value:r?.mnemonics||"",disabled:!0})),jo.createElement(po,{textToCopy:()=>r?.mnemonics||"",variant:"primary"})),jo.createElement(R.FA,{gap:"$DEPRECATED_2"},jo.createElement(R.FA,null,jo.createElement(q.q,{fontSize:"$lg",fontWeight:"$bold"},P.ag._({id:"nYV5rf"}))),jo.createElement(R.FA,{flex:1},jo.createElement(Mo.K,{borderColor:"$baseBorderMed",borderWidth:2,bg:"$baseBackgroundL1",flex:1,value:r?.safeToShare||"",disabled:!0})),jo.createElement(po,{textToCopy:()=>r?.safeToShare||"",variant:"primary"})),jo.createElement(R.FA,{gap:"$DEPRECATED_2"},jo.createElement(R.FA,null,jo.createElement(q.q,{fontSize:"$lg",fontWeight:"$bold"},P.ag._({id:"onotM7"}))),jo.createElement(R.FA,{flex:1},jo.createElement(Mo.K,{borderColor:"$baseBorderMed",borderWidth:2,bg:"$baseBackgroundL1",flex:1,value:r?.keyring||"",disabled:!0})),jo.createElement(po,{textToCopy:()=>r?.keyring||"",variant:"primary"}))))}var Wo=n(202784);function Ho({currentRequest:e}){const t=(0,s.Dv)(I.s7);return e.uiOptions.backup?Wo.createElement(Uo,{currentRequest:e}):Wo.createElement(Bo,{secretNameKey:"BACKUP",onSubmit:async n=>{if(!n)throw new Error("Password required");const r=await t.checkPassword({password:n});if(r.response?.valid)return e.respond({password:n,_sensitive_:!0}),!0;throw new Error("Wrong password")}})}var Vo=n(886526),Go=n(858440);const Zo=(e,t)=>Array(Math.ceil(e.length/t)).fill(null).map(((e,n)=>n*t)).map((n=>e.slice(n,n+t)));var Qo=n(202784);function Jo({currentRequest:e,onClose:t}){const{isErased:n,isVisible:r}=Oo({currentRequest:e,onClose:t});if(!r)return null;const a=n?"":e.uiOptions.mnemonic||"",o=a.split(" ").length;return Qo.createElement(Ce.Q,{title:P.ag._({id:"ZpImWw"}),rightButton:Qo.createElement(U.p,null,Qo.createElement(po,{variant:"primary",withAgreement:!0,textToCopy:()=>a})),leftButton:null,onClose:t},Qo.createElement(ao.u,{icon:({size:e,color:t})=>Qo.createElement(Ko.b,{size:e,color:t}),title:P.ag._({id:"nXbgxO"}),subtitle:P.ag._({id:"aiULG9",values:{wordCount:o}})}),Qo.createElement(Xo,{mnemonic:a}))}function Xo({mnemonic:e}){const{width:t}=(0,Go.Z)(),n=t<("web"===ue.default.OS?375:400)?2:3,r=Zo(e.split(" "),n);return Qo.createElement(R.FA,{flex:1,gap:"$DEPRECATED_2",justifyContent:"flex-start",pointerEvents:"none"},r.map(((e,t)=>Qo.createElement(R.sL,{justifyContent:"space-between",overflow:"hidden",key:"chunk"+t,gap:"$DEPRECATED_2"},e.map(((e,r)=>Qo.createElement(R.FA,{key:r+t,flex:1,position:"relative",height:"$DEPRECATED_4"},Qo.createElement(R.FA,{zIndex:2,top:0,left:0,position:"absolute",width:"$DEPRECATED_3",height:"100%",alignItems:"center",justifyContent:"center"},Qo.createElement(q.q,{fontSize:"$xs",color:"$baseTextMedEmphasis"},t*n+r+1)),Qo.createElement(Vo.II,{zIndex:1,height:"$DEPRECATED_4",autoComplete:"off",autoCorrect:!1,importantForAutofill:"no",inputMode:"none",selectTextOnFocus:!0,borderRadius:"$DEPRECATED_3",paddingLeft:"$DEPRECATED_6",fontWeight:"$bold",fontSize:"$sm",backgroundColor:"$baseBackgroundL1",value:e}))))))))}var Yo=n(202784);function ei({currentRequest:e}){const t=(0,s.Dv)(I.s7);return e.uiOptions.mnemonic?Yo.createElement(Jo,{currentRequest:e,onClose:()=>{e.respond({password:!1,_sensitive_:!0})}}):Yo.createElement(Bo,{secretNameKey:"SECRET_RECOVERY_PHRASE",onSubmit:async n=>{if(!n)throw new Error("Password required");const r=await t.checkPassword({password:n});if(r.response?.valid)return e.respond({password:n,_sensitive_:!0}),!0;throw new Error("Wrong password")}})}var ti=n(676132),ni=n(202784);function ri({currentRequest:e}){const{isErased:t,isVisible:n}=Oo({currentRequest:e});if(!n)return null;const r=t?"":e.uiOptions.privateKey||"";return ni.createElement(Ce.Q,{title:P.ag._({id:"yik0Qu"}),rightButton:ni.createElement(R.FA,{gap:"$DEPRECATED_3"},ni.createElement(po,{variant:"primary",withAgreement:!0,textToCopy:()=>r})),leftButton:null,onClose:()=>e.respond({password:!1,_sensitive_:!0})},ni.createElement(ao.u,{icon:({size:e,color:t})=>ni.createElement(ti.s,{size:e,color:t}),title:P.ag._({id:"630UA4"}),subtitle:P.ag._({id:"l/CEBZ"})}),ni.createElement(R.FA,null,ni.createElement(Mo.K,{borderColor:"$baseBorderMed",borderWidth:2,bg:"$baseBackgroundL1",flex:1,value:r,disabled:!0})))}var ai=n(202784);function oi({currentRequest:e}){const t=(0,s.Dv)(I.s7);return e.uiOptions.privateKey?ai.createElement(ri,{currentRequest:e}):ai.createElement(Bo,{secretNameKey:"PRIVATE_KEY",onSubmit:async n=>{if(!n)throw new Error("Password required");const r=await t.checkPassword({password:n});if(r.response?.valid)return e.respond({password:n,_sensitive_:!0}),!0;throw new Error("Wrong password")}})}var ii=n(493425),si=n(849011),ci=n(201462);async function li(e,t,n){if(!e||!t)return{accountData:null,displayName:"",description:void 0};const r=t.find((t=>t.uuid===e));if(!r)return{accountData:null,displayName:"",description:void 0};const a=function(e,t){const n=t.filter((t=>t.userId===e.uuid));return{id:e.uuid,name:e.username,walletCount:n.length,themeColor:e.themeColor||"#F88484"}}(r,n);var o,i;return{accountData:a,displayName:(o=a.name).replace(/^[\p{Emoji}\p{Emoji_Presentation}\p{Emoji_Modifier_Base}\p{Emoji_Modifier}\p{Emoji_Component}]+/u,"").trim()||o||"",description:(i=a.walletCount)>0?`${i} ${1===i?"wallet":"wallets"}`:void 0}}const ui=(0,B.xu)((e=>{const t=(0,F.cn)({accountData:null,isDeleting:!1,displayName:"",description:void 0});return(0,F.cn)((async n=>{const r=n(t);if(r.isDeleting)return{...r,displayName:r.displayName||r.accountData?.name||""};const a=n((0,B.n7)(I.ao)),o="hasData"===a.state?a.data:null,i=o?.some((t=>t.uuid===e))??!1;if(r.accountData&&!i)return{...r,displayName:r.displayName||r.accountData.name||""};const s=await n(I.DU),c=await li(e,o,s);return!c.accountData&&r.accountData?r:{...r,...c}}),(async(n,r,a)=>{if("startDeletion"===a.type){const a=n(t),o=n((0,B.n7)(I.ao)),i="hasData"===o.state?o.data:null,s=await n(I.DU),c=await li(e,i,s),l=c.accountData||a.accountData,u=c.displayName||a.displayName||l?.name||"",d=c.description||a.description;r(t,{accountData:l,isDeleting:!0,displayName:u,description:d})}else"reset"===a.type&&r(t,{accountData:null,isDeleting:!1,displayName:"",description:void 0})}))}));var di=n(202784);function mi({currentRequest:e}){const t=(0,In.F)(),n=e.request.uuid,r=(0,s.Dv)((0,B.n7)(ui(n))),a="hasData"===r.state?r.data:{accountData:null,isDeleting:!1,displayName:"",description:void 0},[,o]=(0,s.KO)(ui(n)),i=(0,s.Dv)((0,B.n7)(I.ao)),l=1===("hasData"===i.state?i.data:[]).length;(0,c.useEffect)((()=>()=>{o({type:"reset"})}),[o]);const{accountData:u,isDeleting:d,displayName:m,description:g}=a,p=(0,c.useMemo)((()=>u?m&&m.trim()?m:u.name||"Account":""),[u,m]),f=(0,c.useCallback)((({size:e})=>di.createElement(si.S,{name:u?.name||"",size:32,themeColor:u?.themeColor||"#F88484",solid:!0})),[u?.name,u?.themeColor]),b=(0,c.useMemo)((()=>{if(!g||!g.trim())return;const e=g.match(/^(\d+)\s+(?:wallet|wallets)$/);if(e){const t=parseInt(e[1],10);return`${t} ${1===t?P.ag._({id:"6XyieG"}):P.ag._({id:"BAGfQO"})}`}return g}),[g]),h=()=>{d||e.error(new Error("Approval Denied"))};return u?di.createElement(Ce.Q,{onDeny:h,leftButtonDisabled:d,rightButton:di.createElement(j.x,{variant:"secondary",color:"red",label:d?P.ag._({id:"EF2EU9"}):l?P.ag._({id:"haIPQC"}):P.ag._({id:"t/YqKh"}),onPress:async()=>{await o({type:"startDeletion"}),e.respond({confirmed:!0})},loading:d,disabled:d})},di.createElement(E.Kq,{gap:"$DEPRECATED_4"},di.createElement(ao.u,{renderIcon:e=>di.createElement(hn.C,{size:80,bg:"$redBackgroundTransparent"},di.createElement(Ie.e,{size:40,color:t.redIcon.val})),title:l?P.ag._({id:"nJpHmO"}):P.ag._({id:"pth1mf"}),subtitle:l?P.ag._({id:"GgQc+x"}):P.ag._({id:"xhsPRh"}),iconType:"error"}),u&&p?di.createElement(E.G7,{pointerEvents:"none"},di.createElement(ii.L,{label:p,description:b,leftIcon:f,isSelected:!0,selectionEnabled:!0,iconSize:32,padding:12,borderWidth:0,radius:12,backgroundColor:t.baseBackgroundL1.get(),selectedBackgroundColor:t.baseBackgroundL1.get(),onPress:()=>{}})):null)):di.createElement(Ce.Q,{onDeny:h},di.createElement(E.Kq,null,di.createElement(ci.h,{ta:"center"},P.ag._({id:"EHNORh"}))))}var gi=n(202784);function pi({currentRequest:e}){return gi.createElement(Ce.Q,null,P.ag._({id:"9MBtqG"}))}var Ei=n(65457),fi=n(202784);function bi({currentRequest:e}){const t=(0,In.F)(),n=(0,s.Dv)((0,B.n7)(I.ao)),r=(0,s.Dv)(I.DU),a="hasData"===n.state?n.data:[],o=(0,c.useMemo)((()=>a&&0!==a.length?a.map((e=>{const t=r.filter((t=>t.userId===e.uuid)),n=e.themeColor||"#F88484",a=e.username||"Account",o=a.replace(/^[\p{Emoji}\p{Emoji_Presentation}\p{Emoji_Modifier_Base}\p{Emoji_Modifier}\p{Emoji_Component}]+/u,"").trim()||a||"Account",i=t.length>0?`${t.length} ${1===t.length?P.ag._({id:"6XyieG"}):P.ag._({id:"BAGfQO"})}`:void 0;return{id:e.uuid,name:a,displayName:o,themeColor:n,walletCount:t.length,description:i}})):[]),[a,r]);return fi.createElement(Ce.Q,{onDeny:()=>e.error(new Error("Approval Denied")),rightButton:fi.createElement(j.x,{variant:"secondary",color:"red",label:P.ag._({id:"haIPQC"}),onPress:async()=>{await $t.f.remove(At.y4.SECURE_USER),await $t.f.remove(At.y4.INSTALLATION_ID),e.respond({confirmed:!0})}})},fi.createElement(E.Kq,{gap:"$DEPRECATED_4"},fi.createElement(ao.u,{renderIcon:e=>fi.createElement(hn.C,{size:80,bg:"$redBackgroundTransparent"},fi.createElement(Ie.e,{size:40,color:t.redIcon.val})),title:P.ag._({id:"nJpHmO"}),subtitle:P.ag._({id:"GgQc+x"})}),o.length>0&&fi.createElement(Ei.p,{maxHeight:300,showsVerticalScrollIndicator:!0,style:{flexGrow:0}},fi.createElement(E.Kq,{gap:"$2"},o.map((e=>fi.createElement(E.G7,{key:e.id,pointerEvents:"none"},fi.createElement(ii.L,{label:e.displayName,description:e.description,leftIcon:({size:t})=>fi.createElement(si.S,{name:e.name,size:32,themeColor:e.themeColor,solid:!0}),isSelected:!0,selectionEnabled:!0,iconSize:32,padding:12,borderWidth:0,radius:12,backgroundColor:t.baseBackgroundL1.get(),selectedBackgroundColor:t.baseBackgroundL1.get(),onPress:()=>{}}))))))))}var hi=n(602267),yi=n(962568),$i=n(202784);function Ai({currentRequest:e}){const t=(0,s.Dv)(I.D5),n=e.request.blockchainId,r=(0,s.Dv)(D.lm),a=r[n],o=r[t.publicKeys.activePlatform];return a?$i.createElement(vi,{currentRequest:e,blockchainId:n,currentNetworkConfig:o,targetNetworkConfig:a}):$i.createElement(Va,{blockchainId:n,onClose:()=>e.error(new Error("Unknown Network")),isUnknownNetwork:!0,currentRequest:e})}function vi({currentRequest:e,blockchainId:t,targetNetworkConfig:n,currentNetworkConfig:r}){const[a]=Br((0,I.rk)(t),void 0),o=n.blockchain,i=n.name,l=(0,Y.rT)(),u=(0,s.Dv)((0,Cn.t_)(t)),d=Na(e.event.origin.address),m=Xe(e.event.origin.address),g=(0,s.Dv)(I.D5),p=(0,c.useRef)(e.respond);if((0,c.useEffect)((()=>{p.current=e.respond}),[e.respond]),(0,c.useEffect)((()=>{if(!e.responded&&g.publicKeys.activePlatform===t){const e=g.publicKeys.platforms[t]?.activePublicKey;e&&p.current({blockchainId:t,publicKey:e})}}),[g.publicKeys.activePlatform,t,e,e.responded,g.publicKeys.platforms]),!u&&a&&0===a.length)return $i.createElement(Va,{blockchainId:t,networkName:i,onClose:()=>e.error(new Error("No Wallet Found.")),currentRequest:e});const f=()=>e.error(new Error("Approval Denied"));if(d)return $i.createElement(Ce.Q,{onDeny:()=>e.error(new Error("No Wallet Found.")),leftButton:P.ag._({id:"yz7wBu"})},$i.createElement(ke.P,{onDeny:f,title:P.ag._({id:"4Q7iYO"}),warning:{severity:"CRITICAL",message:P.ag._({id:"Df1d1P"})}}));const b=We(e.event.origin.name),h=n.name,y=u?.info.name??"",$=u?(0,K.R1)(u.publicKey):"";return $i.createElement(L.$,{onReset:()=>e.error(new Error("Login Failed"))},$i.createElement(eo,{blockchain:o,blockchainId:t,paddingTop:"$DEPRECATED_4"},$i.createElement(Ce.Q,{paddingTop:"$DEPRECATED_4",rightButton:$i.createElement(j.x,{label:P.ag._({id:"Z7ZXbT"}),disabled:!u,onPress:()=>{u&&e.respond({blockchainId:u.blockchainId,publicKey:u.publicKey})},variant:"primary"}),onDeny:f},$i.createElement(R.FA,{gap:"$DEPRECATED_7"},$i.createElement(R.sL,{alignItems:"center",gap:"$DEPRECATED_4",paddingHorizontal:"$4"},$i.createElement(te.E,{style:{height:40,width:40},source:{height:40,width:40,uri:m}}),$i.createElement(q.q,{fontSize:"$lg",fontWeight:"$bold",textAlign:"left",flex:1,flexShrink:1},P.ag._({id:"eqeGff",values:{origin:b,targetNetworkName:h}}))),$i.createElement(R.sL,{gap:"$DEPRECATED_4",justifyContent:"center",alignItems:"center",paddingHorizontal:"$4",width:"100%"},$i.createElement(R.FA,{flex:1,alignItems:"center"},$i.createElement(Je,{icon:$i.createElement(te.E,{style:{height:80,width:80},source:{height:80,width:80,uri:r.logo}}),title:r.name,subtitle:(0,K.R1)(l.publicKey)})),$i.createElement(yi.L,{paddingBottom:"$DEPRECATED_8"}),$i.createElement(R.FA,{flex:1,alignItems:"center"},$i.createElement(Je,{icon:$i.createElement(te.E,{style:{height:80,width:80},source:{height:80,width:80,uri:n.logo}}),title:n.name,subtitle:(0,K.R1)(u?.publicKey??"")}))),u?$i.createElement(R.FA,{gap:"$DEPRECATED_4"},$i.createElement(E.Kq,{margin:"$DEPRECATED_4",space:"$DEPRECATED_4"},$i.createElement(q.q,{fontWeight:"$semiBold"},P.ag._({id:"Sh2Kzn"})),$i.createElement(E.Kq,{ml:"$DEPRECATED_2",space:"$DEPRECATED_2"},$i.createElement(R.sL,{space:"$DEPRECATED_2"},$i.createElement(se.J,{color:"$greenIcon"}),$i.createElement(q.q,null,P.ag._({id:"rirmYd",values:{targetNetworkName:h}}))),$i.createElement(R.sL,{space:"$DEPRECATED_2"},$i.createElement(se.J,{color:"$greenIcon"}),$i.createElement(q.q,null,P.ag._({id:"fWq7bi",values:{newWalletName:y,formattedPubkey:$}})))))):$i.createElement(R.FA,{space:"$DEPRECATED_2"},$i.createElement(E.Kq,{marginVertical:"$DEPRECATED_4",marginHorizontal:"$DEPRECATED_2",space:"$DEPRECATED_2"},$i.createElement(q.q,{fontWeight:"$semiBold"},P.ag._({id:"NZ9mE2",values:{targetNetworkName:h}})),$i.createElement(q.q,{color:"$baseTextMedEmphasis"},P.ag._({id:"R1HsTV",values:{targetNetworkName:h}}))),$i.createElement(R.FA,{space:"$DEPRECATED_3",marginHorizontal:"$DEPRECATED_2"},a?.map((t=>$i.createElement(Ti,{key:t.init.publicKeyInfo.publicKey,currentRequest:e,compatibleInit:t})))))))))}function Ti({currentRequest:e,compatibleInit:t}){const[n,r]=(0,c.useState)(!1),a=(0,s.Dv)(I.D5),o=(0,s.Dv)((0,D.I5)(t.init.sourceBlockchainId)),i=(0,s.Dv)(I.s7),l=o.name;return $i.createElement(R.sL,{key:t.init.publicKeyInfo.publicKey,backgroundColor:"$baseBackgroundL1",borderRadius:12,cursor:"pointer",gap:16,hoverStyle:{opacity:.8},onPress:()=>(async t=>{r(!0),(0,hi.W)(i.initWallet({uuid:a.user.uuid,blockchainWalletInits:[t]})).then((({wallets:n})=>{e.respond({blockchainId:t.blockchainId,publicKey:t.publicKeyInfo.publicKey})}))})(t.init),paddingHorizontal:18,paddingVertical:16},$i.createElement(R.FA,{position:"relative",justifyContent:"center"},$i.createElement(hn.C,{overflow:"hidden",width:30,height:30},n?$i.createElement(Sn.Z,{size:"small"}):$i.createElement(pe._,{id:o.blockchainId,size:30}))),$i.createElement(R.FA,{justifyContent:"center",flex:1,gap:6},$i.createElement(q.q,{fontSize:"$md"},t.init.name),$i.createElement(q.q,{fontSize:"$xs",color:"$baseTextMedEmphasis"},P.ag._({id:"e5mERi",values:{networkName:l}}))),$i.createElement(R.FA,{justifyContent:"center"},$i.createElement(q.q,{fontSize:"$md",color:"$baseTextMedEmphasis"},(0,K.R1)(t.init.publicKeyInfo.publicKey))))}var xi=n(202784);function ki({currentRequest:e}){return xi.createElement(Ce.Q,{leftButton:null,onApprove:()=>e.respond(),rightButton:P.ag._({id:"DPfwMq"})},xi.createElement(R.FA,{gap:"$4",flex:1,justifyContent:"space-between"},xi.createElement(R.FA,{flex:1,gap:"$4",justifyContent:"center",alignItems:"center"},xi.createElement(R.FA,{justifyContent:"center",alignItems:"center"},"ERROR"===e.request.type?xi.createElement(wn.Jc,null):null,"SUCCESS"===e.request.type?xi.createElement(wn.SW,null):null),xi.createElement(R.FA,null,xi.createElement(q.q,{textAlign:"center",fontSize:"$xl",fontWeight:"$bold",lineHeight:"$xl"},e.request.status)))))}var Ci=n(202784);function Ii({currentRequest:e}){return Ci.createElement(L.$,{force:e.uiOptions.force,withMotion:!1,onReset:()=>e.error(new Error("Login Failed")),onSuccess:()=>e.respond({unlocked:!0})})}var wi=n(202784);function Si({children:e}){return wi.createElement(wi.Fragment,null,e)}var _i=n(202784);const Di=(0,c.lazy)((()=>Promise.all([n.e(5393),n.e(8534),n.e(2816),n.e(6706),n.e(3231),n.e(8596),n.e(2210),n.e(4614)]).then(n.bind(n,714614)).then((e=>({default:e.HardwarePreviewPublicKeysRequest}))))),Ri=(0,c.lazy)((()=>Promise.all([n.e(5393),n.e(2816),n.e(6706),n.e(3231),n.e(8596),n.e(2210),n.e(3334)]).then(n.bind(n,173334)).then((e=>({default:e.HardwareSignRequest})))));function qi({timing:e=0,presentation:t,jotaiStore:n}){return(0,r.o)({context:"app-extension"}),_i.createElement(a.w,{store:n},_i.createElement(c.Suspense,{fallback:null},_i.createElement(o.r,{config:i.v,defaultTheme:"dark"},_i.createElement(Si,null,_i.createElement(g,null,_i.createElement(Pi,{presentation:t}))))))}function Pi({presentation:e}){const t=(0,s.Dv)(l.GN);return _i.createElement(T,{presentation:e,currentRequest:t},t?(()=>{switch(t.name){case"SECURE_USER_APPROVE_ORIGIN":return _i.createElement(no,{currentRequest:t});case"SECURE_USER_RESET_BACKPACK":return _i.createElement(bi,{currentRequest:t});case"SECURE_USER_UNLOCK_KEYRING":return _i.createElement(Ii,{currentRequest:t});case"SECURE_USER_CONFIRM_MNEMONIC":return _i.createElement(Co,{currentRequest:t});case"SECURE_USER_EXPORT_MNEMONIC":return _i.createElement(ei,{currentRequest:t});case"SECURE_USER_EXPORT_PRIVATE_KEY":return _i.createElement(oi,{currentRequest:t});case"SECURE_USER_REMOVE":return _i.createElement(mi,{currentRequest:t});case"SECURE_USER_EXPORT_BACKUP":return _i.createElement(Ho,{currentRequest:t});case"SECURE_USER_SET_ACTIVE_NETWORK":return _i.createElement(Ai,{currentRequest:t});case"SECURE_USER_REPORT":return _i.createElement(pi,{currentRequest:t});case"SECURE_USER_EXCHANGE_SAFE_API":return _i.createElement(So,{currentRequest:t});case"HARDWARE_SVM_SIGN_TX":case"HARDWARE_SVM_SIGN_MESSAGE":case"HARDWARE_EVM_SIGN_TX":case"HARDWARE_EVM_SIGN_MESSAGE":case"HARDWARE_EVM_SIGN_TYPED_DATA":case"HARDWARE_SUIVM_SIGN_TRANSACTION":case"HARDWARE_SUIVM_SIGN_MESSAGE":case"HARDWARE_APTOSVM_SIGN_TRANSACTION":case"HARDWARE_TRONVM_SIGN_MESSAGE":case"HARDWARE_TRONVM_SIGN_TRANSACTION":return _i.createElement(Ri,{currentRequest:t});case"SECURE_UI_EXCHANGE_2FA_REQUEST":return _i.createElement(xn,{currentRequest:t});case"SECURE_UI_STATUS_CONFIRMATION":return _i.createElement(ki,{currentRequest:t});case"SECURE_SVM_SEND_AND_CONFIRM_TRANSACTIONS":return _i.createElement(Dn,{currentRequest:t});case"SECURE_USER_PREVIEW_WALLETS":return _i.createElement(Di,{currentRequest:t});case"SECURE_SVM_SIGN_MESSAGE":case"SECURE_SVM_EXECUTE_SOLANA_ACTION_SIGN_MESSAGE":return _i.createElement(Pr,{currentRequest:t});case"SECURE_SVM_SIGN_IN":return _i.createElement(Dr,{currentRequest:t});case"SECURE_SVM_SIGN_TX":case"SECURE_SVM_EXECUTE_SOLANA_ACTION_SIGN_TX":return _i.createElement(xa,{currentRequest:t});case"SECURE_SVM_SIGN_ALL_TX":return _i.createElement(wr,{currentRequest:t});case"SECURE_EVM_SIGN_TX":return _i.createElement(tn,{currentRequest:t});case"SECURE_EVM_SIGN_MESSAGE":return _i.createElement(ft,{currentRequest:t});case"SECURE_EVM_SIGN_TYPED_DATA":return _i.createElement(rn,{currentRequest:t});case"SECURE_BVM_SIGN_TX":return _i.createElement(ut,{currentRequest:t});case"SECURE_BVM_SIGN_MESSAGE":return _i.createElement(rt,{currentRequest:t});case"SECURE_SUIVM_SIGN_PERSONAL_MESSAGE":return _i.createElement(sn,{currentRequest:t});case"SECURE_SUIVM_SIGN_TRANSACTION":return _i.createElement(bn,{currentRequest:t});case"SECURE_APTOSVM_SIGN_TRANSACTION":return _i.createElement(je,{currentRequest:t});case"SECURE_TRONVM_SIGN_MESSAGE":return _i.createElement(Ia,{currentRequest:t});case"SECURE_TRONVM_SIGN_TRANSACTION":return _i.createElement(Fa,{currentRequest:t});default:return null}})():null)}},204709:(e,t,n)=>{n.d(t,{P:()=>g});var r=n(997246),a=n(337288),o=n(59727),i=n(382740),s=n(187254),c=n(654184),l=n(534042),u=n(997797),d=n(220026),m=n(202784);function g({onIgnore:e,onDeny:t,title:n,warning:g,cancelButton:p=s.ag._({id:"yz7wBu"}),ignoreButton:E=s.ag._({id:"fwY3Tk"})}){return m.createElement(a.FA,{backgroundColor:"CRITICAL"===g.severity?"$redBackgroundTransparent":"INFO"===g.severity?"$accentBlueBackground":"$baseBackgroundL0",f:1},m.createElement(u.Q,{title:n||"Transaction blocked!",onApprove:t,rightButton:p,onDeny:e,leftButton:e&&"string"==typeof E?m.createElement(r.x,{testID:d.sT,onPress:e,label:E,variant:"secondary"}):"string"!=typeof E?E:null,buttonDirection:"column"},m.createElement(a.FA,{f:1,justifyContent:"center",alignContent:"center"},m.createElement(a.FA,{gap:"$6"},m.createElement(o.Kq,{alignItems:"center"},"CRITICAL"===g.severity?m.createElement(c.e,{size:64,color:"$redIcon"}):"INFO"===g.severity?m.createElement(c.e,{size:64,color:"$accentBlue"}):m.createElement(l.u,{size:64,color:"$yellowIcon"})),m.createElement(i.q,{key:g.message.toString(),fontSize:"$md",textAlign:"center",fontWeight:"$medium",lineHeight:"$md",color:"CRITICAL"===g.severity?"$redText":"INFO"===g.severity?"$accentBlue":"$yellowText"},g.message)))))}},997797:(e,t,n)=>{n.d(t,{Q:()=>p});var r=n(220026),a=n(997246),o=n(967264),i=n(337288),s=n(59727),c=n(382740),l=n(639714),u=n(187254),d=n(695188),m=n(33229),g=n(202784);function p({onDeny:e,onApprove:t,leftButton:n,rightButton:p,rightButtonDisabled:E,leftButtonDisabled:f,title:b,children:h,buttonDirection:y="row",footer:$,onClose:A,...v}){return n=void 0===n?u.ag._({id:"cFCKYZ"}):n,p=void 0===p?u.ag._({id:"Z7ZXbT"}):p,g.createElement(i.FA,{flex:1,...v},void 0!==b?g.createElement(s.Kq,{padding:"$DEPRECATED_4",paddingBottom:"$DEPRECATED_2"},g.createElement(i.sL,{alignItems:"center",justifyContent:"center",position:"relative"},g.createElement(i.FA,{flex:1,alignItems:"center"},"string"==typeof b?g.createElement(c.q,{fontWeight:"$semiBold",textAlign:"center",color:"$baseTextHighEmphasis",fontSize:"$lg"},b):b),A&&g.createElement(s.Kq,{position:"absolute",right:0,top:"50%",transform:[{translateY:-24}],width:48,height:48,alignItems:"center",justifyContent:"center"},g.createElement(o.P,{onPress:()=>{A?A():e&&e()}},g.createElement(d.X,{size:28,color:"$baseTextMedEmphasis"}))))):null,g.createElement(s.Kq,{flex:1},g.createElement(l.A,{autoHeight:!1},g.createElement(s.Kq,{paddingHorizontal:"$DEPRECATED_4",paddingVertical:"$DEPRECATED_4",gap:"$DEPRECATED_4",f:m.default.select({native:1,web:void 0}),minHeight:m.default.select({native:void 0,web:"100%"})},h??null))),$?g.createElement(s.Kq,{borderTopWidth:1,borderColor:"$borderColor",padding:"$DEPRECATED_4"},$):null,y.startsWith("column")?g.createElement(i.FA,{padding:"$DEPRECATED_4",paddingTop:"$DEPRECATED_2",space:"$DEPRECATED_4",flexDirection:y},n?g.createElement(s.Kq,{pointerEvents:"auto"},"string"==typeof n&&e?g.createElement(a.x,{label:n,onPress:e,testID:r.Qx,disabled:f,variant:"secondary"}):n):null,p?g.createElement(s.Kq,{pointerEvents:"auto"},"string"==typeof p&&t?g.createElement(a.x,{label:p,onPress:t,testID:E?void 0:r.R$,disabled:E,variant:"primary"}):p):null):g.createElement(i.sL,{padding:"$DEPRECATED_4",paddingTop:"$DEPRECATED_2",space:"$DEPRECATED_4",flexDirection:y},n?g.createElement(s.Kq,{flex:1,flexShrink:1,flexBasis:0,pointerEvents:"auto"},"string"==typeof n&&e?g.createElement(a.x,{label:n,testID:r.Qx,onPress:e,disabled:f,variant:"secondary"}):n):null,p?g.createElement(s.Kq,{flex:1,flexShrink:1,flexBasis:0,pointerEvents:"auto"},"string"==typeof p&&t?g.createElement(a.x,{label:p,testID:E?void 0:r.R$,onPress:t,disabled:E,variant:"primary"}):p):null))}},630765:(e,t,n)=>{e.exports=n.p+"assets/backpack-logo.png"}}]);