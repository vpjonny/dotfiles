"use strict";(globalThis.webpackChunk_coral_xyz_app_extension=globalThis.webpackChunk_coral_xyz_app_extension||[]).push([[9299],{235489:(e,t,n)=>{n.d(t,{nm:()=>ps,IM:()=>ls,cI:()=>cs,Xj:()=>ds,yI:()=>ys});var r=n(496279),a=n(215473),i=n(912844),s=n(627158),o=n(348834),u=n(883669),p=n(888),c=n(228786),l=n(226410),d=n(996346),y=n(991965);!function(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let n=0;n<e.length;n++){const r=e.charAt(n),a=r.charCodeAt(0);if(255!==t[a])throw new TypeError(r+" is ambiguous");t[a]=n}const n=e.length,r=e.charAt(0),a=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function s(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;let i=0,s=0,o=0;for(;e[i]===r;)0;const u=(e.length-i)*a+1>>>0,p=new Uint8Array(u);for(;i<e.length;){const r=e.charCodeAt(i);if(r>255)return;let a=t[r];if(255===a)return;let s=0;for(let e=u-1;(0!==a||s<o)&&-1!==e;s++)n*p[e]>>>0,p[e]=a%256>>>0,a/256>>>0;if(0!==a)throw new Error("Non-zero carry");s}let c=u-o;for(;c!==u&&0===p[c];)0;const l=new Uint8Array(s+(u-c));let d=s;for(;c!==u;)l[d++]=p[c++];return l}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");var m=n(611028),f=n(232193),b=n(67121),h=n(32532);function g(e){let t=BigInt(e);const n=[];let r=0;if(0n===t)return[0];for(;t>0;)n[r]=Number(0x7fn&t),t>>=7n,t>0n&&(n[r]|=128),r+=1;return n}class T{constructor(e){this.bytePosition=0,this.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength)}shift(e){return this.bytePosition+=e,this}read8(){const e=this.dataView.getUint8(this.bytePosition);return this.shift(1),e}read16(){const e=this.dataView.getUint16(this.bytePosition,!0);return this.shift(2),e}read32(){const e=this.dataView.getUint32(this.bytePosition,!0);return this.shift(4),e}read64(){const e=this.read32(),t=this.read32().toString(16)+e.toString(16).padStart(8,"0");return BigInt("0x"+t).toString(10)}read128(){const e=BigInt(this.read64()),t=BigInt(this.read64()).toString(16)+e.toString(16).padStart(16,"0");return BigInt("0x"+t).toString(10)}read256(){const e=BigInt(this.read128()),t=BigInt(this.read128()).toString(16)+e.toString(16).padStart(32,"0");return BigInt("0x"+t).toString(10)}readBytes(e){const t=this.bytePosition+this.dataView.byteOffset,n=new Uint8Array(this.dataView.buffer,t,e);return this.shift(e),n}readULEB(){const e=this.bytePosition+this.dataView.byteOffset,t=new Uint8Array(this.dataView.buffer,e),{value:n,length:r}=function(e){let t=0n,n=0n,r=0;for(;;){if(r>=e.length)throw new Error("ULEB decode error: buffer overflow");const a=e[r];if(r+=1,t+=BigInt(127&a)<<n,0==(128&a))break;n+=7n}if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("ULEB decode error: value exceeds MAX_SAFE_INTEGER");return{value:Number(t),length:r}}(t);return this.shift(r),n}readVec(e){const t=this.readULEB(),n=[];for(let r=0;r<t;r++)n.push(e(this,r,t));return n}}function w(e,t=["<",">"]){const[n,r]=t,a=[];let i="",s=0;for(let t=0;t<e.length;t++){const o=e[t];o===n&&s++,o===r&&s--,0!==s||","!==o?i+=o:(a.push(i.trim()),i="")}return a.push(i.trim()),a}class I{constructor({initialSize:e=1024,maxSize:t=1/0,allocateSize:n=1024}={}){this.bytePosition=0,this.size=e,this.maxSize=t,this.allocateSize=n,this.dataView=new DataView(new ArrayBuffer(e))}ensureSizeOrGrow(e){const t=this.bytePosition+e;if(t>this.size){const e=Math.min(this.maxSize,Math.max(this.size+t,this.size+this.allocateSize));if(t>e)throw new Error(`Attempting to serialize to BCS, but buffer does not have enough size. Allocated size: ${this.size}, Max size: ${this.maxSize}, Required size: ${t}`);this.size=e;const n=new ArrayBuffer(this.size);new Uint8Array(n).set(new Uint8Array(this.dataView.buffer)),this.dataView=new DataView(n)}}shift(e){return this.bytePosition+=e,this}write8(e){return this.ensureSizeOrGrow(1),this.dataView.setUint8(this.bytePosition,Number(e)),this.shift(1)}writeBytes(e){this.ensureSizeOrGrow(e.length);for(let t=0;t<e.length;t++)this.dataView.setUint8(this.bytePosition+t,e[t]);return this.shift(e.length)}write16(e){return this.ensureSizeOrGrow(2),this.dataView.setUint16(this.bytePosition,Number(e),!0),this.shift(2)}write32(e){return this.ensureSizeOrGrow(4),this.dataView.setUint32(this.bytePosition,Number(e),!0),this.shift(4)}write64(e){return C(BigInt(e),8).forEach((e=>this.write8(e))),this}write128(e){return C(BigInt(e),16).forEach((e=>this.write8(e))),this}write256(e){return C(BigInt(e),32).forEach((e=>this.write8(e))),this}writeULEB(e){return g(e).forEach((e=>this.write8(e))),this}writeVec(e,t){return this.writeULEB(e.length),Array.from(e).forEach(((n,r)=>t(this,n,r,e.length))),this}*[Symbol.iterator](){for(let e=0;e<this.bytePosition;e++)yield this.dataView.getUint8(e);return this.toBytes()}toBytes(){return new Uint8Array(this.dataView.buffer.slice(0,this.bytePosition))}toString(e){return function(e,t){switch(t){case"base58":return(0,h.z)(e);case"base64":return(0,f.s)(e);case"hex":return(0,b.N)(e);default:throw new Error("Unsupported encoding, supported values are: base64, hex")}}(this.toBytes(),e)}}function C(e,t){const n=new Uint8Array(t);let r=0;for(;e>0;)n[r]=Number(e%BigInt(256)),e/=BigInt(256),r+=1;return n}var A,S,k,M,v=e=>{throw TypeError(e)},_=(e,t,n)=>t.has(e)||v("Cannot "+n),O=(e,t,n)=>(_(e,t,"read from private field"),n?n.call(e):t.get(e)),P=(e,t,n)=>t.has(e)?v("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),E=(e,t,n,r)=>(_(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);A=new WeakMap,S=new WeakMap;let R=class e{constructor(e){P(this,A),P(this,S),this.name=e.name,this.read=e.read,this.serializedSize=e.serializedSize??(()=>null),E(this,A,e.write),E(this,S,e.serialize??((e,t)=>{const n=new I({initialSize:this.serializedSize(e)??void 0,...t});return O(this,A).call(this,e,n),n.toBytes()})),this.validate=e.validate??(()=>{})}write(e,t){this.validate(e),O(this,A).call(this,e,t)}serialize(e,t){return this.validate(e),new B(this,O(this,S).call(this,e,t))}parse(e){const t=new T(e);return this.read(t)}fromHex(e){return this.parse((0,b.H)(e))}fromBase58(e){return this.parse((0,h.L)(e))}fromBase64(e){return this.parse((0,f.G)(e))}transform({name:t,input:n,output:r,validate:a}){return new e({name:t??this.name,read:e=>r?r(this.read(e)):this.read(e),write:(e,t)=>O(this,A).call(this,n?n(e):e,t),serializedSize:e=>this.serializedSize(n?n(e):e),serialize:(e,t)=>O(this,S).call(this,n?n(e):e,t),validate:e=>{a?.(e),this.validate(n?n(e):e)}})}};const D=Symbol.for("@mysten/serialized-bcs");function j(e){return!!e&&"object"==typeof e&&!0===e[D]}class B{constructor(e,t){P(this,k),P(this,M),E(this,k,e),E(this,M,t)}get[D](){return!0}toBytes(){return O(this,M)}toHex(){return(0,b.N)(O(this,M))}toBase64(){return(0,f.s)(O(this,M))}toBase58(){return(0,h.z)(O(this,M))}parse(){return O(this,k).parse(O(this,M))}}function F({size:e,...t}){return new R({...t,serializedSize:()=>e})}function x({readMethod:e,writeMethod:t,...n}){return F({...n,read:t=>t[e](),write:(e,n)=>n[t](e),validate:e=>{if(e<0||e>n.maxValue)throw new TypeError(`Invalid ${n.name} value: ${e}. Expected value in range 0-${n.maxValue}`);n.validate?.(e)}})}function N({readMethod:e,writeMethod:t,...n}){return F({...n,read:t=>t[e](),write:(e,n)=>n[t](BigInt(e)),validate:e=>{const t=BigInt(e);if(t<0||t>n.maxValue)throw new TypeError(`Invalid ${n.name} value: ${t}. Expected value in range 0-${n.maxValue}`);n.validate?.(t)}})}k=new WeakMap,M=new WeakMap;class U extends R{constructor({name:e,fields:t,...n}){const r=Object.entries(t);super({name:e,serializedSize:e=>{let t=0;for(const[n,a]of r){const r=a.serializedSize(e[n]);if(null==r)return null;t+=r}return t},read:e=>{const t={};for(const[n,a]of r)t[n]=a.read(e);return t},write:(e,t)=>{for(const[n,a]of r)a.write(e[n],t)},...n,validate:e=>{if(n?.validate?.(e),"object"!=typeof e||null==e)throw new TypeError("Expected object, found "+typeof e)}})}}class W extends R{constructor({fields:e,...t}){const n=Object.entries(e);super({read:e=>{const r=e.readULEB(),a=n[r];if(!a)throw new TypeError(`Unknown value ${r} for enum ${t.name}`);const[i,s]=a;return{[i]:s?.read(e)??!0,$kind:i}},write:(t,r)=>{const[a,i]=Object.entries(t).filter((([t])=>Object.hasOwn(e,t)))[0];for(let e=0;e<n.length;e++){const[t,s]=n[e];if(t===a)return r.writeULEB(e),void s?.write(i,r)}},...t,validate:n=>{if(t?.validate?.(n),"object"!=typeof n||null==n)throw new TypeError("Expected object, found "+typeof n);const r=Object.keys(n).filter((t=>void 0!==n[t]&&Object.hasOwn(e,t)));if(1!==r.length)throw new TypeError(`Expected object with one key, but found ${r.length} for type ${t.name}}`);const[a]=r;if(!Object.hasOwn(e,a))throw new TypeError(`Invalid enum variant ${a}`)}})}}class $ extends R{constructor({fields:e,name:t,...n}){super({name:t??`(${e.map((e=>e.name)).join(", ")})`,serializedSize:t=>{let n=0;for(let r=0;r<e.length;r++){const a=e[r].serializedSize(t[r]);if(null==a)return null;n+=a}return n},read:t=>{const n=[];for(const r of e)n.push(r.read(t));return n},write:(t,n)=>{for(let r=0;r<e.length;r++)e[r].write(t[r],n)},...n,validate:t=>{if(n?.validate?.(t),!Array.isArray(t))throw new TypeError("Expected array, found "+typeof t);if(t.length!==e.length)throw new TypeError(`Expected array of length ${e.length}, found ${t.length}`)}})}}var K=n(882374);const V=/^(?!.*(^(?!@)|[-.@])($|[-.@]))(?:[a-z0-9-]{0,63}(?:\.[a-z0-9-]{0,63})*)?@[a-z0-9-]{0,63}$/i,G=/^(?!.*(^|[-.])($|[-.]))(?:[a-z0-9-]{0,63}\.)+sui$/i,L=/^([a-z0-9]+(?:-[a-z0-9]+)*)$/,z=/^\d+$/,H=e=>{const t=e.split("/");if(t.length<2||t.length>3)return!1;const[n,r,a]=t;return!(void 0!==a&&!z.test(a))&&!!function(e){return!(e.length>235)&&(e.includes("@")?V.test(e):G.test(e))}(n)&&L.test(r)&&r.length<64},q=e=>{const t=e.split(/::|<|>|,/);for(const e of t)if(e.includes("/")&&!H(e))return!1;return!0},Y=32;function Q(e){return function(e){return/^(0x|0X)?[a-fA-F0-9]+$/.test(e)&&e.length%2==0}(e)&&function(e){return/^(0x|0X)/.test(e)?(e.length-2)/2:e.length/2}(e)===Y}function J(e){const[t,n]=e.split("::"),r=H(t),a=e.slice(t.length+n.length+4),i=a.includes("<")?a.slice(0,a.indexOf("<")):a,s=a.includes("<")?w(a.slice(a.indexOf("<")+1,a.lastIndexOf(">"))).map((e=>function(e){return e.includes("::")?J(e):e}(e.trim()))):[];return{address:r?t:X(t),module:n,name:i,typeParams:s}}function Z(e){const{address:t,module:n,name:r,typeParams:a}="string"==typeof e?J(e):e;return`${t}::${n}::${r}${a?.length>0?`<${a.map((e=>"string"==typeof e?e:Z(e))).join(",")}>`:""}`}function X(e,t=!1){let n=e.toLowerCase();return!t&&n.startsWith("0x")&&(n=n.slice(2)),`0x${n.padStart(2*Y,"0")}`}function ee(e,t=!1){return X(e,t)}function te(e){const t=Object.entries(e).map((([e,t])=>(0,K.object)({[e]:t})));return(0,K.pipe)((0,K.union)(t),(0,K.transform)((e=>({...e,$kind:Object.keys(e)[0]}))))}const ne=(0,K.pipe)((0,K.string)(),(0,K.transform)((e=>X(e))),(0,K.check)(Q)),re=ne,ae=(0,K.string)(),ie=(0,K.pipe)((0,K.union)([(0,K.string)(),(0,K.pipe)((0,K.number)(),(0,K.integer)())]),(0,K.check)((e=>{try{return BigInt(e),BigInt(e)>=0&&BigInt(e)<=18446744073709551615n}catch{return!1}}),"Invalid u64")),se=(0,K.object)({objectId:ne,version:ie,digest:(0,K.string)()}),oe=(0,K.pipe)((0,K.union)([(0,K.object)({GasCoin:(0,K.literal)(!0)}),(0,K.object)({Input:(0,K.pipe)((0,K.number)(),(0,K.integer)()),type:(0,K.optional)((0,K.literal)("pure"))}),(0,K.object)({Input:(0,K.pipe)((0,K.number)(),(0,K.integer)()),type:(0,K.optional)((0,K.literal)("object"))}),(0,K.object)({Result:(0,K.pipe)((0,K.number)(),(0,K.integer)())}),(0,K.object)({NestedResult:(0,K.tuple)([(0,K.pipe)((0,K.number)(),(0,K.integer)()),(0,K.pipe)((0,K.number)(),(0,K.integer)())])})]),(0,K.transform)((e=>({...e,$kind:Object.keys(e)[0]})))),ue=(0,K.object)({budget:(0,K.nullable)(ie),price:(0,K.nullable)(ie),owner:(0,K.nullable)(ne),payment:(0,K.nullable)((0,K.array)(se))}),pe=((0,K.object)({address:(0,K.string)(),module:(0,K.string)(),name:(0,K.string)(),typeParams:(0,K.array)((0,K.string)())}),(0,K.union)([(0,K.literal)("address"),(0,K.literal)("bool"),(0,K.literal)("u8"),(0,K.literal)("u16"),(0,K.literal)("u32"),(0,K.literal)("u64"),(0,K.literal)("u128"),(0,K.literal)("u256"),(0,K.object)({vector:(0,K.lazy)((()=>pe))}),(0,K.object)({datatype:(0,K.object)({package:(0,K.string)(),module:(0,K.string)(),type:(0,K.string)(),typeParameters:(0,K.array)((0,K.lazy)((()=>pe)))})}),(0,K.object)({typeParameter:(0,K.pipe)((0,K.number)(),(0,K.integer)())})])),ce=(0,K.object)({ref:(0,K.nullable)((0,K.union)([(0,K.literal)("&"),(0,K.literal)("&mut")])),body:pe}),le=(0,K.object)({package:re,module:(0,K.string)(),function:(0,K.string)(),typeArguments:(0,K.array)((0,K.string)()),arguments:(0,K.array)(oe),_argumentTypes:(0,K.optional)((0,K.nullable)((0,K.array)(ce)))}),de=(0,K.object)({name:(0,K.string)(),inputs:(0,K.record)((0,K.string)(),(0,K.union)([oe,(0,K.array)(oe)])),data:(0,K.record)((0,K.string)(),(0,K.unknown)())}),ye=te({MoveCall:le,TransferObjects:(0,K.object)({objects:(0,K.array)(oe),address:oe}),SplitCoins:(0,K.object)({coin:oe,amounts:(0,K.array)(oe)}),MergeCoins:(0,K.object)({destination:oe,sources:(0,K.array)(oe)}),Publish:(0,K.object)({modules:(0,K.array)(ae),dependencies:(0,K.array)(re)}),MakeMoveVec:(0,K.object)({type:(0,K.nullable)((0,K.string)()),elements:(0,K.array)(oe)}),Upgrade:(0,K.object)({modules:(0,K.array)(ae),dependencies:(0,K.array)(re),package:re,ticket:oe}),$Intent:de}),me=te({ImmOrOwnedObject:se,SharedObject:(0,K.object)({objectId:re,initialSharedVersion:ie,mutable:(0,K.boolean)()}),Receiving:se}),fe=te({Object:me,Pure:(0,K.object)({bytes:ae}),UnresolvedPure:(0,K.object)({value:(0,K.unknown)()}),UnresolvedObject:(0,K.object)({objectId:re,version:(0,K.optional)((0,K.nullable)(ie)),digest:(0,K.optional)((0,K.nullable)((0,K.string)())),initialSharedVersion:(0,K.optional)((0,K.nullable)(ie)),mutable:(0,K.optional)((0,K.nullable)((0,K.boolean)()))})}),be=te({Object:me,Pure:(0,K.object)({bytes:ae})}),he=te({None:(0,K.literal)(!0),Epoch:ie}),ge=(0,K.object)({version:(0,K.literal)(2),sender:(0,K.nullish)(ne),expiration:(0,K.nullish)(he),gasData:ue,inputs:(0,K.array)(fe),commands:(0,K.array)(ye)}),Te={MoveCall(e){const[t,n="",r=""]="target"in e?e.target.split("::"):[e.package,e.module,e.function];return{$kind:"MoveCall",MoveCall:{package:t,module:n,function:r,typeArguments:e.typeArguments??[],arguments:e.arguments??[]}}},TransferObjects:(e,t)=>({$kind:"TransferObjects",TransferObjects:{objects:e.map((e=>(0,K.parse)(oe,e))),address:(0,K.parse)(oe,t)}}),SplitCoins:(e,t)=>({$kind:"SplitCoins",SplitCoins:{coin:(0,K.parse)(oe,e),amounts:t.map((e=>(0,K.parse)(oe,e)))}}),MergeCoins:(e,t)=>({$kind:"MergeCoins",MergeCoins:{destination:(0,K.parse)(oe,e),sources:t.map((e=>(0,K.parse)(oe,e)))}}),Publish:({modules:e,dependencies:t})=>({$kind:"Publish",Publish:{modules:e.map((e=>"string"==typeof e?e:(0,f.s)(new Uint8Array(e)))),dependencies:t.map((e=>ee(e)))}}),Upgrade:({modules:e,dependencies:t,package:n,ticket:r})=>({$kind:"Upgrade",Upgrade:{modules:e.map((e=>"string"==typeof e?e:(0,f.s)(new Uint8Array(e)))),dependencies:t.map((e=>ee(e))),package:n,ticket:(0,K.parse)(oe,r)}}),MakeMoveVec:({type:e,elements:t})=>({$kind:"MakeMoveVec",MakeMoveVec:{type:e??null,elements:t.map((e=>(0,K.parse)(oe,e)))}}),Intent:({name:e,inputs:t={},data:n={}})=>({$kind:"$Intent",$Intent:{name:e,inputs:Object.fromEntries(Object.entries(t).map((([e,t])=>[e,Array.isArray(t)?t.map((e=>(0,K.parse)(oe,e))):(0,K.parse)(oe,t)]))),data:n}})},we=/^vector<(.+)>$/,Ie=/^([^:]+)::([^:]+)::([^<]+)(<(.+)>)?/;class Ce{static parseFromStr(e,t=!1){if("address"===e)return{address:null};if("bool"===e)return{bool:null};if("u8"===e)return{u8:null};if("u16"===e)return{u16:null};if("u32"===e)return{u32:null};if("u64"===e)return{u64:null};if("u128"===e)return{u128:null};if("u256"===e)return{u256:null};if("signer"===e)return{signer:null};const n=e.match(we);if(n)return{vector:Ce.parseFromStr(n[1],t)};const r=e.match(Ie);if(r)return{struct:{address:t?X(r[1]):r[1],module:r[2],name:r[3],typeParams:void 0===r[5]?[]:Ce.parseStructTypeArgs(r[5],t)}};throw new Error(`Encountered unexpected token when parsing type args for ${e}`)}static parseStructTypeArgs(e,t=!1){return w(e).map((e=>Ce.parseFromStr(e,t)))}static tagToString(e){if("bool"in e)return"bool";if("u8"in e)return"u8";if("u16"in e)return"u16";if("u32"in e)return"u32";if("u64"in e)return"u64";if("u128"in e)return"u128";if("u256"in e)return"u256";if("address"in e)return"address";if("signer"in e)return"signer";if("vector"in e)return`vector<${Ce.tagToString(e.vector)}>`;if("struct"in e){const t=e.struct,n=t.typeParams.map(Ce.tagToString).join(", ");return`${t.address}::${t.module}::${t.name}${n?`<${n}>`:""}`}throw new Error("Invalid TypeTag")}}const Ae=(0,K.object)({digest:(0,K.string)(),objectId:(0,K.string)(),version:(0,K.union)([(0,K.pipe)((0,K.number)(),(0,K.integer)()),(0,K.string)(),(0,K.bigint)()])}),Se=te({ImmOrOwned:Ae,Shared:(0,K.object)({objectId:re,initialSharedVersion:ie,mutable:(0,K.boolean)()}),Receiving:Ae}),ke=te({Object:Se,Pure:(0,K.array)((0,K.pipe)((0,K.number)(),(0,K.integer)()))}),Me=(0,K.union)([(0,K.object)({kind:(0,K.literal)("Input"),index:(0,K.pipe)((0,K.number)(),(0,K.integer)()),value:(0,K.unknown)(),type:(0,K.optional)((0,K.literal)("object"))}),(0,K.object)({kind:(0,K.literal)("Input"),index:(0,K.pipe)((0,K.number)(),(0,K.integer)()),value:(0,K.unknown)(),type:(0,K.literal)("pure")})]),ve=(0,K.union)([(0,K.object)({Epoch:(0,K.pipe)((0,K.number)(),(0,K.integer)())}),(0,K.object)({None:(0,K.nullable)((0,K.literal)(!0))})]),_e=(0,K.pipe)((0,K.union)([(0,K.number)(),(0,K.string)(),(0,K.bigint)()]),(0,K.check)((e=>{if(!["string","number","bigint"].includes(typeof e))return!1;try{return BigInt(e),!0}catch{return!1}}))),Oe=(0,K.union)([(0,K.object)({bool:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({u8:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({u64:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({u128:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({address:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({signer:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({vector:(0,K.lazy)((()=>Oe))}),(0,K.object)({struct:(0,K.lazy)((()=>Pe))}),(0,K.object)({u16:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({u32:(0,K.nullable)((0,K.literal)(!0))}),(0,K.object)({u256:(0,K.nullable)((0,K.literal)(!0))})]),Pe=(0,K.object)({address:(0,K.string)(),module:(0,K.string)(),name:(0,K.string)(),typeParams:(0,K.array)(Oe)}),Ee=(0,K.object)({budget:(0,K.optional)(_e),price:(0,K.optional)(_e),payment:(0,K.optional)((0,K.array)(Ae)),owner:(0,K.optional)((0,K.string)())}),Re=[Me,(0,K.object)({kind:(0,K.literal)("GasCoin")}),(0,K.object)({kind:(0,K.literal)("Result"),index:(0,K.pipe)((0,K.number)(),(0,K.integer)())}),(0,K.object)({kind:(0,K.literal)("NestedResult"),index:(0,K.pipe)((0,K.number)(),(0,K.integer)()),resultIndex:(0,K.pipe)((0,K.number)(),(0,K.integer)())})],De=(0,K.union)([...Re]),je=(0,K.object)({kind:(0,K.literal)("MoveCall"),target:(0,K.pipe)((0,K.string)(),(0,K.check)((e=>3===e.split("::").length))),typeArguments:(0,K.array)((0,K.string)()),arguments:(0,K.array)(De)}),Be=(0,K.object)({kind:(0,K.literal)("TransferObjects"),objects:(0,K.array)(De),address:De}),Fe=(0,K.object)({kind:(0,K.literal)("SplitCoins"),coin:De,amounts:(0,K.array)(De)}),xe=(0,K.object)({kind:(0,K.literal)("MergeCoins"),destination:De,sources:(0,K.array)(De)}),Ne=(0,K.object)({kind:(0,K.literal)("MakeMoveVec"),type:(0,K.union)([(0,K.object)({Some:Oe}),(0,K.object)({None:(0,K.nullable)((0,K.literal)(!0))})]),objects:(0,K.array)(De)}),Ue=[je,Be,Fe,xe,(0,K.object)({kind:(0,K.literal)("Publish"),modules:(0,K.array)((0,K.array)((0,K.pipe)((0,K.number)(),(0,K.integer)()))),dependencies:(0,K.array)((0,K.string)())}),(0,K.object)({kind:(0,K.literal)("Upgrade"),modules:(0,K.array)((0,K.array)((0,K.pipe)((0,K.number)(),(0,K.integer)()))),dependencies:(0,K.array)((0,K.string)()),packageId:(0,K.string)(),ticket:De}),Ne],We=(0,K.union)([...Ue]);function $e(e){const t=e.inputs.map(((e,t)=>{if(e.Object)return{kind:"Input",index:t,value:{Object:e.Object.ImmOrOwnedObject?{ImmOrOwned:e.Object.ImmOrOwnedObject}:e.Object.Receiving?{Receiving:{digest:e.Object.Receiving.digest,version:e.Object.Receiving.version,objectId:e.Object.Receiving.objectId}}:{Shared:{mutable:e.Object.SharedObject.mutable,initialSharedVersion:e.Object.SharedObject.initialSharedVersion,objectId:e.Object.SharedObject.objectId}}},type:"object"};if(e.Pure)return{kind:"Input",index:t,value:{Pure:Array.from((0,f.G)(e.Pure.bytes))},type:"pure"};if(e.UnresolvedPure)return{kind:"Input",type:"pure",index:t,value:e.UnresolvedPure.value};if(e.UnresolvedObject)return{kind:"Input",type:"object",index:t,value:e.UnresolvedObject.objectId};throw new Error("Invalid input")}));return{version:1,sender:e.sender??void 0,expiration:"Epoch"===e.expiration?.$kind?{Epoch:Number(e.expiration.Epoch)}:e.expiration?{None:!0}:null,gasConfig:{owner:e.gasData.owner??void 0,budget:e.gasData.budget??void 0,price:e.gasData.price??void 0,payment:e.gasData.payment??void 0},inputs:t,transactions:e.commands.map((e=>{if(e.MakeMoveVec)return{kind:"MakeMoveVec",type:null===e.MakeMoveVec.type?{None:!0}:{Some:Ce.parseFromStr(e.MakeMoveVec.type)},objects:e.MakeMoveVec.elements.map((e=>Ke(e,t)))};if(e.MergeCoins)return{kind:"MergeCoins",destination:Ke(e.MergeCoins.destination,t),sources:e.MergeCoins.sources.map((e=>Ke(e,t)))};if(e.MoveCall)return{kind:"MoveCall",target:`${e.MoveCall.package}::${e.MoveCall.module}::${e.MoveCall.function}`,typeArguments:e.MoveCall.typeArguments,arguments:e.MoveCall.arguments.map((e=>Ke(e,t)))};if(e.Publish)return{kind:"Publish",modules:e.Publish.modules.map((e=>Array.from((0,f.G)(e)))),dependencies:e.Publish.dependencies};if(e.SplitCoins)return{kind:"SplitCoins",coin:Ke(e.SplitCoins.coin,t),amounts:e.SplitCoins.amounts.map((e=>Ke(e,t)))};if(e.TransferObjects)return{kind:"TransferObjects",objects:e.TransferObjects.objects.map((e=>Ke(e,t))),address:Ke(e.TransferObjects.address,t)};if(e.Upgrade)return{kind:"Upgrade",modules:e.Upgrade.modules.map((e=>Array.from((0,f.G)(e)))),dependencies:e.Upgrade.dependencies,packageId:e.Upgrade.package,ticket:Ke(e.Upgrade.ticket,t)};throw new Error(`Unknown transaction ${Object.keys(e)}`)}))}}function Ke(e,t){if("GasCoin"===e.$kind)return{kind:"GasCoin"};if("Result"===e.$kind)return{kind:"Result",index:e.Result};if("NestedResult"===e.$kind)return{kind:"NestedResult",index:e.NestedResult[0],resultIndex:e.NestedResult[1]};if("Input"===e.$kind)return t[e.Input];throw new Error(`Invalid argument ${Object.keys(e)}`)}function Ve(e){switch(e.kind){case"GasCoin":return{GasCoin:!0};case"Result":return{Result:e.index};case"NestedResult":return{NestedResult:[e.index,e.resultIndex]};case"Input":return{Input:e.index}}}function Ge(e){return(0,K.union)(Object.entries(e).map((([e,t])=>(0,K.object)({[e]:t}))))}(0,K.object)({version:(0,K.literal)(1),sender:(0,K.optional)((0,K.string)()),expiration:(0,K.nullish)(ve),gasConfig:Ee,inputs:(0,K.array)(Me),transactions:(0,K.array)(We)});const Le=Ge({GasCoin:(0,K.literal)(!0),Input:(0,K.pipe)((0,K.number)(),(0,K.integer)()),Result:(0,K.pipe)((0,K.number)(),(0,K.integer)()),NestedResult:(0,K.tuple)([(0,K.pipe)((0,K.number)(),(0,K.integer)()),(0,K.pipe)((0,K.number)(),(0,K.integer)())])}),ze=(0,K.object)({budget:(0,K.nullable)(ie),price:(0,K.nullable)(ie),owner:(0,K.nullable)(ne),payment:(0,K.nullable)((0,K.array)(se))}),He=(0,K.object)({package:re,module:(0,K.string)(),function:(0,K.string)(),typeArguments:(0,K.array)((0,K.string)()),arguments:(0,K.array)(Le)}),qe=(0,K.object)({name:(0,K.string)(),inputs:(0,K.record)((0,K.string)(),(0,K.union)([Le,(0,K.array)(Le)])),data:(0,K.record)((0,K.string)(),(0,K.unknown)())}),Ye=Ge({MoveCall:He,TransferObjects:(0,K.object)({objects:(0,K.array)(Le),address:Le}),SplitCoins:(0,K.object)({coin:Le,amounts:(0,K.array)(Le)}),MergeCoins:(0,K.object)({destination:Le,sources:(0,K.array)(Le)}),Publish:(0,K.object)({modules:(0,K.array)(ae),dependencies:(0,K.array)(re)}),MakeMoveVec:(0,K.object)({type:(0,K.nullable)((0,K.string)()),elements:(0,K.array)(Le)}),Upgrade:(0,K.object)({modules:(0,K.array)(ae),dependencies:(0,K.array)(re),package:re,ticket:Le}),$Intent:qe}),Qe=Ge({ImmOrOwnedObject:se,SharedObject:(0,K.object)({objectId:re,initialSharedVersion:ie,mutable:(0,K.boolean)()}),Receiving:se}),Je=Ge({Object:Qe,Pure:(0,K.object)({bytes:ae}),UnresolvedPure:(0,K.object)({value:(0,K.unknown)()}),UnresolvedObject:(0,K.object)({objectId:re,version:(0,K.optional)((0,K.nullable)(ie)),digest:(0,K.optional)((0,K.nullable)((0,K.string)())),initialSharedVersion:(0,K.optional)((0,K.nullable)(ie)),mutable:(0,K.optional)((0,K.nullable)((0,K.boolean)()))})}),Ze=Ge({None:(0,K.literal)(!0),Epoch:ie}),Xe=(0,K.object)({version:(0,K.literal)(2),sender:(0,K.nullish)(ne),expiration:(0,K.nullish)(Ze),gasData:ze,inputs:(0,K.array)(Je),commands:(0,K.array)(Ye),digest:(0,K.optional)((0,K.nullable)((0,K.string)()))}),et={Pure:function(e){return{$kind:"Pure",Pure:{bytes:e instanceof Uint8Array?(0,f.s)(e):e.toBase64()}}},ObjectRef:({objectId:e,digest:t,version:n})=>({$kind:"Object",Object:{$kind:"ImmOrOwnedObject",ImmOrOwnedObject:{digest:t,version:n,objectId:X(e)}}}),SharedObjectRef:({objectId:e,mutable:t,initialSharedVersion:n})=>({$kind:"Object",Object:{$kind:"SharedObject",SharedObject:{mutable:t,initialSharedVersion:n,objectId:X(e)}}}),ReceivingRef:({objectId:e,digest:t,version:n})=>({$kind:"Object",Object:{$kind:"Receiving",Receiving:{digest:t,version:n,objectId:X(e)}}})},tt={u8:e=>x({readMethod:"read8",writeMethod:"write8",size:1,maxValue:255,...e,name:e?.name??"u8"}),u16:e=>x({readMethod:"read16",writeMethod:"write16",size:2,maxValue:65535,...e,name:e?.name??"u16"}),u32:e=>x({readMethod:"read32",writeMethod:"write32",size:4,maxValue:2**32-1,...e,name:e?.name??"u32"}),u64:e=>N({readMethod:"read64",writeMethod:"write64",size:8,maxValue:2n**64n-1n,...e,name:e?.name??"u64"}),u128:e=>N({readMethod:"read128",writeMethod:"write128",size:16,maxValue:2n**128n-1n,...e,name:e?.name??"u128"}),u256:e=>N({readMethod:"read256",writeMethod:"write256",size:32,maxValue:2n**256n-1n,...e,name:e?.name??"u256"}),bool:e=>F({size:1,read:e=>1===e.read8(),write:(e,t)=>t.write8(e?1:0),...e,name:e?.name??"bool",validate:t=>{if(e?.validate?.(t),"boolean"!=typeof t)throw new TypeError("Expected boolean, found "+typeof t)}}),uleb128:e=>function({serialize:e,...t}){const n=new R({...t,serialize:e,write:(e,t)=>{for(const r of n.serialize(e).toBytes())t.write8(r)}});return n}({read:e=>e.readULEB(),serialize:e=>Uint8Array.from(g(e)),...e,name:e?.name??"uleb128"}),bytes:(e,t)=>F({size:e,read:t=>t.readBytes(e),write:(e,t)=>{t.writeBytes(new Uint8Array(e))},...t,name:t?.name??`bytes[${e}]`,validate:n=>{if(t?.validate?.(n),!n||"object"!=typeof n||!("length"in n))throw new TypeError("Expected array, found "+typeof n);if(n.length!==e)throw new TypeError(`Expected array of length ${e}, found ${n.length}`)}}),byteVector:e=>new R({read:e=>{const t=e.readULEB();return e.readBytes(t)},write:(e,t)=>{const n=new Uint8Array(e);t.writeULEB(n.length),t.writeBytes(n)},...e,name:e?.name??"vector<u8>",serializedSize:e=>{const t="length"in e?e.length:null;return null==t?null:g(t).length+t},validate:t=>{if(e?.validate?.(t),!t||"object"!=typeof t||!("length"in t))throw new TypeError("Expected array, found "+typeof t)}}),string:e=>function({toBytes:e,fromBytes:t,...n}){return new R({...n,read:e=>{const n=e.readULEB(),r=e.readBytes(n);return t(r)},write:(t,n)=>{const r=e(t);n.writeULEB(r.length);for(let e=0;e<r.length;e++)n.write8(r[e])},serialize:t=>{const n=e(t),r=g(n.length),a=new Uint8Array(r.length+n.length);return a.set(r,0),a.set(n,r.length),a},validate:e=>{if("string"!=typeof e)throw new TypeError(`Invalid ${n.name} value: ${e}. Expected string`);n.validate?.(e)}})}({toBytes:e=>(new TextEncoder).encode(e),fromBytes:e=>(new TextDecoder).decode(e),...e,name:e?.name??"string"}),fixedArray:function(e,t,n){return new R({read:n=>{const r=new Array(e);for(let a=0;a<e;a++)r[a]=t.read(n);return r},write:(e,n)=>{for(const r of e)t.write(r,n)},...n,name:n?.name??`${t.name}[${e}]`,validate:t=>{if(n?.validate?.(t),!t||"object"!=typeof t||!("length"in t))throw new TypeError("Expected array, found "+typeof t);if(t.length!==e)throw new TypeError(`Expected array of length ${e}, found ${t.length}`)}})},option:function(e){return tt.enum(`Option<${e.name}>`,{None:null,Some:e}).transform({input:e=>null==e?{None:!0}:{Some:e},output:e=>"Some"===e.$kind?e.Some:null})},vector:function(e,t){return new R({read:t=>{const n=t.readULEB(),r=new Array(n);for(let a=0;a<n;a++)r[a]=e.read(t);return r},write:(t,n)=>{n.writeULEB(t.length);for(const r of t)e.write(r,n)},...t,name:t?.name??`vector<${e.name}>`,validate:e=>{if(t?.validate?.(e),!e||"object"!=typeof e||!("length"in e))throw new TypeError("Expected array, found "+typeof e)}})},tuple:(e,t)=>new $({fields:e,...t}),struct:(e,t,n)=>new U({name:e,fields:t,...n}),enum:(e,t,n)=>new W({name:e,fields:t,...n}),map:function(e,t){return tt.vector(tt.tuple([e,t])).transform({name:`Map<${e.name}, ${t.name}>`,input:e=>[...e.entries()],output:e=>{const t=new Map;for(const[n,r]of e)t.set(n,r);return t}})},lazy:e=>function(e){let t=null;function n(){return t||(t=e()),t}return new R({name:"lazy",read:e=>n().read(e),serializedSize:e=>n().serializedSize(e),write:(e,t)=>n().write(e,t),serialize:(e,t)=>n().serialize(e,t).toBytes()})}(e)},nt=tt.bytes(Y).transform({validate:e=>{const t="string"==typeof e?e:(0,b.N)(e);if(!t||!Q(X(t)))throw new Error(`Invalid Sui address ${t}`)},input:e=>"string"==typeof e?(0,b.H)(X(e)):e,output:e=>X((0,b.N)(e))}),rt=tt.byteVector().transform({name:"ObjectDigest",input:e=>(0,h.L)(e),output:e=>(0,h.z)(new Uint8Array(e)),validate:e=>{if(32!==(0,h.L)(e).length)throw new Error("ObjectDigest must be 32 bytes")}}),at=tt.struct("SuiObjectRef",{objectId:nt,version:tt.u64(),digest:rt}),it=tt.struct("SharedObjectRef",{objectId:nt,initialSharedVersion:tt.u64(),mutable:tt.bool()}),st=tt.enum("ObjectArg",{ImmOrOwnedObject:at,SharedObject:it,Receiving:at}),ot=tt.enum("Owner",{AddressOwner:nt,ObjectOwner:nt,Shared:tt.struct("Shared",{initialSharedVersion:tt.u64()}),Immutable:null,ConsensusAddressOwner:tt.struct("ConsensusAddressOwner",{owner:nt,startVersion:tt.u64()})}),ut=tt.enum("CallArg",{Pure:tt.struct("Pure",{bytes:tt.byteVector().transform({input:e=>"string"==typeof e?(0,f.G)(e):e,output:e=>(0,f.s)(new Uint8Array(e))})}),Object:st}),pt=tt.enum("TypeTag",{bool:null,u8:null,u64:null,u128:null,address:null,signer:null,vector:tt.lazy((()=>pt)),struct:tt.lazy((()=>gt)),u16:null,u32:null,u256:null}),ct=pt.transform({input:e=>"string"==typeof e?Ce.parseFromStr(e,!0):e,output:e=>Ce.tagToString(e)}),lt=tt.enum("Argument",{GasCoin:null,Input:tt.u16(),Result:tt.u16(),NestedResult:tt.tuple([tt.u16(),tt.u16()])}),dt=tt.struct("ProgrammableMoveCall",{package:nt,module:tt.string(),function:tt.string(),typeArguments:tt.vector(ct),arguments:tt.vector(lt)}),yt=tt.enum("Command",{MoveCall:dt,TransferObjects:tt.struct("TransferObjects",{objects:tt.vector(lt),address:lt}),SplitCoins:tt.struct("SplitCoins",{coin:lt,amounts:tt.vector(lt)}),MergeCoins:tt.struct("MergeCoins",{destination:lt,sources:tt.vector(lt)}),Publish:tt.struct("Publish",{modules:tt.vector(tt.byteVector().transform({input:e=>"string"==typeof e?(0,f.G)(e):e,output:e=>(0,f.s)(new Uint8Array(e))})),dependencies:tt.vector(nt)}),MakeMoveVec:tt.struct("MakeMoveVec",{type:(mt=ct,tt.enum("Option",{None:null,Some:mt})).transform({input:e=>null===e?{None:!0}:{Some:e},output:e=>e.Some??null}),elements:tt.vector(lt)}),Upgrade:tt.struct("Upgrade",{modules:tt.vector(tt.byteVector().transform({input:e=>"string"==typeof e?(0,f.G)(e):e,output:e=>(0,f.s)(new Uint8Array(e))})),dependencies:tt.vector(nt),package:nt,ticket:lt})});var mt;const ft=tt.struct("ProgrammableTransaction",{inputs:tt.vector(ut),commands:tt.vector(yt)}),bt=tt.enum("TransactionKind",{ProgrammableTransaction:ft,ChangeEpoch:null,Genesis:null,ConsensusCommitPrologue:null}),ht=tt.enum("TransactionExpiration",{None:null,Epoch:tt.u64({name:"unsafe_u64"}).transform({input:e=>e,output:e=>Number(e)})});const gt=tt.struct("StructTag",{address:nt,module:tt.string(),name:tt.string(),typeParams:tt.vector(pt)}),Tt=tt.struct("GasData",{payment:tt.vector(at),owner:nt,price:tt.u64(),budget:tt.u64()}),wt=tt.struct("TransactionDataV1",{kind:bt,sender:nt,gasData:Tt,expiration:ht}),It=tt.enum("TransactionData",{V1:wt}),Ct=tt.enum("IntentScope",{TransactionData:null,TransactionEffects:null,CheckpointSummary:null,PersonalMessage:null}),At=tt.enum("IntentVersion",{V0:null}),St=tt.enum("AppId",{Sui:null}),kt=tt.struct("Intent",{scope:Ct,version:At,appId:St});function Mt(e){return tt.struct(`IntentMessage<${e.name}>`,{intent:kt,value:e})}const vt=tt.enum("CompressedSignature",{ED25519:tt.bytes(64),Secp256k1:tt.bytes(64),Secp256r1:tt.bytes(64),ZkLogin:tt.byteVector(),Passkey:tt.byteVector()}),_t=tt.enum("PublicKey",{ED25519:tt.bytes(32),Secp256k1:tt.bytes(33),Secp256r1:tt.bytes(33),ZkLogin:tt.byteVector(),Passkey:tt.bytes(33)}),Ot=tt.struct("MultiSigPkMap",{pubKey:_t,weight:tt.u8()}),Pt=tt.struct("MultiSigPublicKey",{pk_map:tt.vector(Ot),threshold:tt.u16()}),Et=tt.struct("MultiSig",{sigs:tt.vector(vt),bitmap:tt.u16(),multisig_pk:Pt}),Rt=tt.byteVector().transform({input:e=>"string"==typeof e?(0,f.G)(e):e,output:e=>(0,f.s)(new Uint8Array(e))}),Dt=tt.struct("SenderSignedTransaction",{intentMessage:Mt(It),txSignatures:tt.vector(Rt)}),jt=tt.vector(Dt,{name:"SenderSignedData"}),Bt=tt.struct("PasskeyAuthenticator",{authenticatorData:tt.byteVector(),clientDataJson:tt.string(),userSignature:tt.byteVector()}),Ft=tt.enum("PackageUpgradeError",{UnableToFetchPackage:tt.struct("UnableToFetchPackage",{packageId:nt}),NotAPackage:tt.struct("NotAPackage",{objectId:nt}),IncompatibleUpgrade:null,DigestDoesNotMatch:tt.struct("DigestDoesNotMatch",{digest:tt.byteVector()}),UnknownUpgradePolicy:tt.struct("UnknownUpgradePolicy",{policy:tt.u8()}),PackageIDDoesNotMatch:tt.struct("PackageIDDoesNotMatch",{packageId:nt,ticketId:nt})}),xt=tt.struct("ModuleId",{address:nt,name:tt.string()}),Nt=tt.struct("MoveLocation",{module:xt,function:tt.u16(),instruction:tt.u16(),functionName:tt.option(tt.string())}),Ut=tt.enum("CommandArgumentError",{TypeMismatch:null,InvalidBCSBytes:null,InvalidUsageOfPureArg:null,InvalidArgumentToPrivateEntryFunction:null,IndexOutOfBounds:tt.struct("IndexOutOfBounds",{idx:tt.u16()}),SecondaryIndexOutOfBounds:tt.struct("SecondaryIndexOutOfBounds",{resultIdx:tt.u16(),secondaryIdx:tt.u16()}),InvalidResultArity:tt.struct("InvalidResultArity",{resultIdx:tt.u16()}),InvalidGasCoinUsage:null,InvalidValueUsage:null,InvalidObjectByValue:null,InvalidObjectByMutRef:null,SharedObjectOperationNotAllowed:null}),Wt=tt.enum("TypeArgumentError",{TypeNotFound:null,ConstraintNotSatisfied:null}),$t=tt.enum("ExecutionFailureStatus",{InsufficientGas:null,InvalidGasObject:null,InvariantViolation:null,FeatureNotYetSupported:null,MoveObjectTooBig:tt.struct("MoveObjectTooBig",{objectSize:tt.u64(),maxObjectSize:tt.u64()}),MovePackageTooBig:tt.struct("MovePackageTooBig",{objectSize:tt.u64(),maxObjectSize:tt.u64()}),CircularObjectOwnership:tt.struct("CircularObjectOwnership",{object:nt}),InsufficientCoinBalance:null,CoinBalanceOverflow:null,PublishErrorNonZeroAddress:null,SuiMoveVerificationError:null,MovePrimitiveRuntimeError:tt.option(Nt),MoveAbort:tt.tuple([Nt,tt.u64()]),VMVerificationOrDeserializationError:null,VMInvariantViolation:null,FunctionNotFound:null,ArityMismatch:null,TypeArityMismatch:null,NonEntryFunctionInvoked:null,CommandArgumentError:tt.struct("CommandArgumentError",{argIdx:tt.u16(),kind:Ut}),TypeArgumentError:tt.struct("TypeArgumentError",{argumentIdx:tt.u16(),kind:Wt}),UnusedValueWithoutDrop:tt.struct("UnusedValueWithoutDrop",{resultIdx:tt.u16(),secondaryIdx:tt.u16()}),InvalidPublicFunctionReturnType:tt.struct("InvalidPublicFunctionReturnType",{idx:tt.u16()}),InvalidTransferObject:null,EffectsTooLarge:tt.struct("EffectsTooLarge",{currentSize:tt.u64(),maxSize:tt.u64()}),PublishUpgradeMissingDependency:null,PublishUpgradeDependencyDowngrade:null,PackageUpgradeError:tt.struct("PackageUpgradeError",{upgradeError:Ft}),WrittenObjectsTooLarge:tt.struct("WrittenObjectsTooLarge",{currentSize:tt.u64(),maxSize:tt.u64()}),CertificateDenied:null,SuiMoveVerificationTimedout:null,SharedObjectOperationNotAllowed:null,InputObjectDeleted:null,ExecutionCancelledDueToSharedObjectCongestion:tt.struct("ExecutionCancelledDueToSharedObjectCongestion",{congestedObjects:tt.vector(nt)}),AddressDeniedForCoin:tt.struct("AddressDeniedForCoin",{address:nt,coinType:tt.string()}),CoinTypeGlobalPause:tt.struct("CoinTypeGlobalPause",{coinType:tt.string()}),ExecutionCancelledDueToRandomnessUnavailable:null}),Kt=tt.enum("ExecutionStatus",{Success:null,Failed:tt.struct("ExecutionFailed",{error:$t,command:tt.option(tt.u64())})}),Vt=tt.struct("GasCostSummary",{computationCost:tt.u64(),storageCost:tt.u64(),storageRebate:tt.u64(),nonRefundableStorageFee:tt.u64()}),Gt=tt.struct("TransactionEffectsV1",{status:Kt,executedEpoch:tt.u64(),gasUsed:Vt,modifiedAtVersions:tt.vector(tt.tuple([nt,tt.u64()])),sharedObjects:tt.vector(at),transactionDigest:rt,created:tt.vector(tt.tuple([at,ot])),mutated:tt.vector(tt.tuple([at,ot])),unwrapped:tt.vector(tt.tuple([at,ot])),deleted:tt.vector(at),unwrappedThenDeleted:tt.vector(at),wrapped:tt.vector(at),gasObject:tt.tuple([at,ot]),eventsDigest:tt.option(rt),dependencies:tt.vector(rt)}),Lt=tt.tuple([tt.u64(),rt]),zt=tt.enum("ObjectIn",{NotExist:null,Exist:tt.tuple([Lt,ot])}),Ht=tt.enum("ObjectOut",{NotExist:null,ObjectWrite:tt.tuple([rt,ot]),PackageWrite:Lt}),qt=tt.enum("IDOperation",{None:null,Created:null,Deleted:null}),Yt=tt.struct("EffectsObjectChange",{inputState:zt,outputState:Ht,idOperation:qt}),Qt=tt.enum("UnchangedSharedKind",{ReadOnlyRoot:Lt,MutateDeleted:tt.u64(),ReadDeleted:tt.u64(),Cancelled:tt.u64(),PerEpochConfig:null}),Jt=tt.struct("TransactionEffectsV2",{status:Kt,executedEpoch:tt.u64(),gasUsed:Vt,transactionDigest:rt,gasObjectIndex:tt.option(tt.u32()),eventsDigest:tt.option(rt),dependencies:tt.vector(rt),lamportVersion:tt.u64(),changedObjects:tt.vector(tt.tuple([nt,Yt])),unchangedSharedObjects:tt.vector(tt.tuple([nt,Qt])),auxDataDigest:tt.option(rt)}),Zt=tt.enum("TransactionEffects",{V1:Gt,V2:Jt}),Xt={...tt,U8:tt.u8(),U16:tt.u16(),U32:tt.u32(),U64:tt.u64(),U128:tt.u128(),U256:tt.u256(),ULEB128:tt.uleb128(),Bool:tt.bool(),String:tt.string(),Address:nt,AppId:St,Argument:lt,CallArg:ut,Command:yt,CompressedSignature:vt,GasData:Tt,Intent:kt,IntentMessage:Mt,IntentScope:Ct,IntentVersion:At,MultiSig:Et,MultiSigPkMap:Ot,MultiSigPublicKey:Pt,ObjectArg:st,ObjectDigest:rt,Owner:ot,PasskeyAuthenticator:Bt,ProgrammableMoveCall:dt,ProgrammableTransaction:ft,PublicKey:_t,SenderSignedData:jt,SenderSignedTransaction:Dt,SharedObjectRef:it,StructTag:gt,SuiObjectRef:at,TransactionData:It,TransactionDataV1:wt,TransactionEffects:Zt,TransactionExpiration:ht,TransactionKind:bt,TypeTag:ct},en=(BigInt(1e9),"0x1"),tn="0x2",nn=ee("0x6"),rn=`${tn}::sui::SUI`,an=(ee("0x5"),ee("0x8"),"object"),sn="ID",on="ascii",un="String",pn="string",cn="String",ln="option",dn="Option";function yn(e){if("string"==typeof e)switch(e){case"address":return Xt.Address;case"bool":return Xt.Bool;case"u8":return Xt.U8;case"u16":return Xt.U16;case"u32":return Xt.U32;case"u64":return Xt.U64;case"u128":return Xt.U128;case"u256":return Xt.U256;default:throw new Error(`Unknown type signature ${e}`)}if("vector"in e){if("u8"===e.vector)return Xt.byteVector().transform({input:e=>"string"==typeof e?(new TextEncoder).encode(e):e,output:e=>e});const t=yn(e.vector);return t?Xt.vector(t):null}if("datatype"in e){const t=X(e.datatype.package);if(t===X(en)){if(e.datatype.module===on&&e.datatype.type===un)return Xt.String;if(e.datatype.module===pn&&e.datatype.type===cn)return Xt.String;if(e.datatype.module===ln&&e.datatype.type===dn){const t=yn(e.datatype.typeParameters[0]);return t?Xt.vector(t):null}}if(t===X(tn)&&e.datatype.module===an&&e.datatype.type===sn)return Xt.Address}return null}function mn(e){if("string"==typeof e)switch(e){case"Address":return"address";case"Bool":return"bool";case"U8":return"u8";case"U16":return"u16";case"U32":return"u32";case"U64":return"u64";case"U128":return"u128";case"U256":return"u256";default:throw new Error(`Unexpected type ${e}`)}if("Vector"in e)return{vector:mn(e.Vector)};if("Struct"in e)return{datatype:{package:e.Struct.address,module:e.Struct.module,type:e.Struct.name,typeParameters:e.Struct.typeArguments.map(mn)}};if("TypeParameter"in e)return{typeParameter:e.TypeParameter};throw new Error(`Unexpected type ${JSON.stringify(e)}`)}var fn=n(199544);const bn=50,hn=1000n,gn=5e10;function Tn(e){return async function(t,n,r){return await async function(e,t){const{inputs:n,commands:r}=e,a=[],i=new Set;r.forEach((t=>{if(t.MoveCall){if(t.MoveCall._argumentTypes)return;if(t.MoveCall.arguments.map((t=>"Input"===t.$kind?e.inputs[t.Input]:null)).some((e=>e?.UnresolvedPure||e?.UnresolvedObject&&"boolean"!=typeof e?.UnresolvedObject.mutable))){const e=`${t.MoveCall.package}::${t.MoveCall.module}::${t.MoveCall.function}`;i.add(e),a.push(t.MoveCall)}}}));const s=new Map;i.size>0&&await Promise.all([...i].map((async e=>{const[n,r,a]=e.split("::"),i=await t.getNormalizedMoveFunction({package:n,module:r,function:a});s.set(e,i.parameters.map((e=>function(e){return"object"==typeof e&&"Reference"in e?{ref:"&",body:mn(e.Reference)}:"object"==typeof e&&"MutableReference"in e?{ref:"&mut",body:mn(e.MutableReference)}:{ref:null,body:mn(e)}}(e))))}))),a.length&&await Promise.all(a.map((async e=>{const t=s.get(`${e.package}::${e.module}::${e.function}`);if(!t)return;const n=t.length>0&&function(e){const t="object"==typeof e.body&&"datatype"in e.body?e.body.datatype:null;return!!t&&X(t.package)===X("0x2")&&"tx_context"===t.module&&"TxContext"===t.type}(t.at(-1))?t.slice(0,t.length-1):t;e._argumentTypes=n}))),r.forEach((e=>{if(!e.MoveCall)return;const t=e.MoveCall,r=`${t.package}::${t.module}::${t.function}`,a=t._argumentTypes;if(a){if(a.length!==e.MoveCall.arguments.length)throw new Error(`Incorrect number of arguments for ${r}`);a.forEach(((e,r)=>{const a=t.arguments[r];if("Input"!==a.$kind)return;const i=n[a.Input];if(!i.UnresolvedPure&&!i.UnresolvedObject)return;const s=i.UnresolvedPure?.value??i.UnresolvedObject?.objectId,o=yn(e.body);if(o)return a.type="pure",void(n[n.indexOf(i)]=et.Pure(o.serialize(s)));if("string"!=typeof s)throw new Error(`Expect the argument to be an object id string, got ${JSON.stringify(s,null,2)}`);a.type="object";const u=i.UnresolvedPure?{$kind:"UnresolvedObject",UnresolvedObject:{objectId:s}}:i;n[a.Input]=u}))}}))}(t,e),await async function(e,t){const n=e.inputs.filter((e=>e.UnresolvedObject&&!(e.UnresolvedObject.version||e.UnresolvedObject?.initialSharedVersion))),r=[...new Set(n.map((e=>ee(e.UnresolvedObject.objectId))))],a=r.length?(0,fn.y)(r,bn):[],i=(await Promise.all(a.map((e=>t.multiGetObjects({ids:e,options:{showOwner:!0}}))))).flat(),s=new Map(r.map(((e,t)=>[e,i[t]]))),o=Array.from(s).filter((([e,t])=>t.error)).map((([e,t])=>JSON.stringify(t.error)));if(o.length)throw new Error(`The following input objects are invalid: ${o.join(", ")}`);const u=i.map((e=>{if(e.error||!e.data)throw new Error(`Failed to fetch object: ${e.error}`);const t=e.data.owner,n=t&&"object"==typeof t?"Shared"in t?t.Shared.initial_shared_version:"ConsensusAddressOwner"in t?t.ConsensusAddressOwner.start_version:null:null;return{objectId:e.data.objectId,digest:e.data.digest,version:e.data.version,initialSharedVersion:n}})),p=new Map(r.map(((e,t)=>[e,u[t]])));for(const[t,n]of e.inputs.entries()){if(!n.UnresolvedObject)continue;let r;const a=X(n.UnresolvedObject.objectId),i=p.get(a);n.UnresolvedObject.initialSharedVersion??i?.initialSharedVersion?r=et.SharedObjectRef({objectId:a,initialSharedVersion:n.UnresolvedObject.initialSharedVersion||i?.initialSharedVersion,mutable:n.UnresolvedObject.mutable||wn(e,t)}):In(e,t)&&(r=et.ReceivingRef({objectId:a,digest:n.UnresolvedObject.digest??i?.digest,version:n.UnresolvedObject.version??i?.version})),e.inputs[e.inputs.indexOf(n)]=r??et.ObjectRef({objectId:a,digest:n.UnresolvedObject.digest??i?.digest,version:n.UnresolvedObject.version??i?.version})}}(t,e),n.onlyTransactionKind||(await async function(e,t){e.gasConfig.price||(e.gasConfig.price=String(await t.getReferenceGasPrice()))}(t,e),await async function(e,t){if(e.gasConfig.budget)return;const n=await t.dryRunTransactionBlock({transactionBlock:e.build({overrides:{gasData:{budget:String(gn),payment:[]}}})});if("success"!==n.effects.status.status)throw new Error(`Dry run failed, could not automatically determine a budget: ${n.effects.status.error}`,{cause:n});const r=hn*BigInt(e.gasConfig.price||1n),a=BigInt(n.effects.gasUsed.computationCost)+r,i=a+BigInt(n.effects.gasUsed.storageCost)-BigInt(n.effects.gasUsed.storageRebate);e.gasConfig.budget=String(i>a?i:a)}(t,e),await async function(e,t){if(!e.gasConfig.payment){const n=(await t.getCoins({owner:e.gasConfig.owner||e.sender,coinType:rn})).data.filter((t=>!e.inputs.find((e=>!!e.Object?.ImmOrOwnedObject&&t.coinObjectId===e.Object.ImmOrOwnedObject.objectId)))).map((e=>({objectId:e.coinObjectId,digest:e.digest,version:e.version})));if(!n.length)throw new Error("No valid gas coins found for the transaction.");e.gasConfig.payment=n.map((e=>(0,K.parse)(se,e)))}}(t,e)),await r()}}function wn(e,t){let n=!1;return e.getInputUses(t,((e,t)=>{if(t.MoveCall&&t.MoveCall._argumentTypes){const r=t.MoveCall.arguments.indexOf(e);n="&"!==t.MoveCall._argumentTypes[r].ref||n}"MakeMoveVec"!==t.$kind&&"MergeCoins"!==t.$kind&&"SplitCoins"!==t.$kind&&"TransferObjects"!==t.$kind||(n=!0)})),n}function In(e,t){let n=!1;return e.getInputUses(t,((e,t)=>{if(t.MoveCall&&t.MoveCall._argumentTypes){const r=t.MoveCall.arguments.indexOf(e);n=function(e){return"object"==typeof e.body&&"datatype"in e.body&&("0x2"===e.body.datatype.package&&"transfer"===e.body.datatype.module&&"Receiving"===e.body.datatype.type)}(t.MoveCall._argumentTypes[r])||n}})),n}function Cn(e,t){return!!e.inputs.some((e=>e.UnresolvedObject||e.UnresolvedPure))||!(t.onlyTransactionKind||e.gasConfig.price&&e.gasConfig.budget&&e.gasConfig.payment)}async function An(e,t,n){if(function(e){for(const t of e.commands)switch(t.$kind){case"SplitCoins":t.SplitCoins.amounts.forEach((t=>{kn(t,Xt.U64,e)}));break;case"TransferObjects":kn(t.TransferObjects.address,Xt.Address,e)}}(e),!Cn(e,t))return await Sn(e),n();const r=function(e){if(!e.client)throw new Error("No sui client passed to Transaction#build, but transaction data was not sufficient to build offline.");return e.client}(t);return(r.core?.resolveTransactionPlugin()??Tn(r))(e,t,(async()=>{await Sn(e),await n()}))}function Sn(e){e.inputs.forEach(((e,t)=>{if("Object"!==e.$kind&&"Pure"!==e.$kind)throw new Error(`Input at index ${t} has not been resolved.  Expected a Pure or Object input, but found ${JSON.stringify(e)}`)}))}function kn(e,t,n){if("Input"!==e.$kind)return;const r=n.inputs[e.Input];"UnresolvedPure"===r.$kind&&(n.inputs[e.Input]=et.Pure(t.serialize(r.UnresolvedPure.value)))}function Mn(e){switch(e){case"u8":return tt.u8();case"u16":return tt.u16();case"u32":return tt.u32();case"u64":return tt.u64();case"u128":return tt.u128();case"u256":return tt.u256();case"bool":return tt.bool();case"string":return tt.string();case"id":case"address":return nt}const t=e.match(/^(vector|option)<(.+)>$/);if(t){const[e,n]=t.slice(1);return"vector"===e?tt.vector(Mn(n)):tt.option(Mn(n))}throw new Error(`Invalid Pure type name: ${e}`)}function vn(e){function t(t,n){if("string"==typeof t)return e(Mn(t).serialize(n));if(t instanceof Uint8Array||j(t))return e(t);throw new Error("tx.pure must be called either a bcs type name, or a serialized bcs value")}return t.u8=t=>e(Xt.U8.serialize(t)),t.u16=t=>e(Xt.U16.serialize(t)),t.u32=t=>e(Xt.U32.serialize(t)),t.u64=t=>e(Xt.U64.serialize(t)),t.u128=t=>e(Xt.U128.serialize(t)),t.u256=t=>e(Xt.U256.serialize(t)),t.bool=t=>e(Xt.Bool.serialize(t)),t.string=t=>e(Xt.String.serialize(t)),t.address=t=>e(Xt.Address.serialize(t)),t.id=t.address,t.vector=(t,n)=>e(Xt.vector(Mn(t)).serialize(n)),t.option=(t,n)=>e(Xt.option(Mn(t)).serialize(n)),t}var _n=n(546275);function On(e){return"string"==typeof e?X(e):e.Object?e.Object.ImmOrOwnedObject?X(e.Object.ImmOrOwnedObject.objectId):e.Object.Receiving?X(e.Object.Receiving.objectId):X(e.Object.SharedObject.objectId):e.UnresolvedObject?X(e.UnresolvedObject.objectId):void 0}function Pn(e,t,n){const r=e=>{switch(e.$kind){case"Input":{const n=t.get(e.Input);if(void 0===n)throw new Error(`Input ${e.Input} not found in input mapping`);return{...e,Input:n}}case"Result":{const t=n.get(e.Result);return void 0!==t?{...e,Result:t}:e}case"NestedResult":{const t=n.get(e.NestedResult[0]);return void 0!==t?{...e,NestedResult:[t,e.NestedResult[1]]}:e}default:return e}};switch(e.$kind){case"MoveCall":e.MoveCall.arguments=e.MoveCall.arguments.map(r);break;case"TransferObjects":e.TransferObjects.objects=e.TransferObjects.objects.map(r),e.TransferObjects.address=r(e.TransferObjects.address);break;case"SplitCoins":e.SplitCoins.coin=r(e.SplitCoins.coin),e.SplitCoins.amounts=e.SplitCoins.amounts.map(r);break;case"MergeCoins":e.MergeCoins.destination=r(e.MergeCoins.destination),e.MergeCoins.sources=e.MergeCoins.sources.map(r);break;case"MakeMoveVec":e.MakeMoveVec.elements=e.MakeMoveVec.elements.map(r);break;case"Upgrade":e.Upgrade.ticket=r(e.Upgrade.ticket);break;case"$Intent":{const t=e.$Intent.inputs;e.$Intent.inputs={};for(const[n,a]of Object.entries(t))e.$Intent.inputs[n]=Array.isArray(a)?a.map(r):r(a);break}}}function En(e){return X(e).replace("0x","")}class Rn{constructor(e){this.version=2,this.sender=e?.sender??null,this.expiration=e?.expiration??null,this.inputs=e?.inputs??[],this.commands=e?.commands??[],this.gasData=e?.gasData??{budget:null,price:null,owner:null,payment:null}}static fromKindBytes(e){const t=Xt.TransactionKind.parse(e).ProgrammableTransaction;if(!t)throw new Error("Unable to deserialize from bytes.");return Rn.restore({version:2,sender:null,expiration:null,gasData:{budget:null,owner:null,payment:null,price:null},inputs:t.inputs,commands:t.commands})}static fromBytes(e){const t=Xt.TransactionData.parse(e),n=t?.V1,r=n.kind.ProgrammableTransaction;if(!n||!r)throw new Error("Unable to deserialize from bytes.");return Rn.restore({version:2,sender:n.sender,expiration:n.expiration,gasData:n.gasData,inputs:r.inputs,commands:r.commands})}static restore(e){return 2===e.version?new Rn((0,K.parse)(ge,e)):new Rn((0,K.parse)(ge,function(e){return(0,K.parse)(ge,{version:2,sender:e.sender??null,expiration:e.expiration?"Epoch"in e.expiration?{Epoch:e.expiration.Epoch}:{None:!0}:null,gasData:{owner:e.gasConfig.owner??null,budget:e.gasConfig.budget?.toString()??null,price:e.gasConfig.price?.toString()??null,payment:e.gasConfig.payment?.map((e=>({digest:e.digest,objectId:e.objectId,version:e.version.toString()})))??null},inputs:e.inputs.map((e=>{if("Input"===e.kind){if((0,K.is)(ke,e.value)){const t=(0,K.parse)(ke,e.value);if(t.Object){if(t.Object.ImmOrOwned)return{Object:{ImmOrOwnedObject:{objectId:t.Object.ImmOrOwned.objectId,version:String(t.Object.ImmOrOwned.version),digest:t.Object.ImmOrOwned.digest}}};if(t.Object.Shared)return{Object:{SharedObject:{mutable:t.Object.Shared.mutable??null,initialSharedVersion:t.Object.Shared.initialSharedVersion,objectId:t.Object.Shared.objectId}}};if(t.Object.Receiving)return{Object:{Receiving:{digest:t.Object.Receiving.digest,version:String(t.Object.Receiving.version),objectId:t.Object.Receiving.objectId}}};throw new Error("Invalid object input")}return{Pure:{bytes:(0,f.s)(new Uint8Array(t.Pure))}}}return"object"===e.type?{UnresolvedObject:{objectId:e.value}}:{UnresolvedPure:{value:e.value}}}throw new Error("Invalid input")})),commands:e.transactions.map((e=>{switch(e.kind){case"MakeMoveVec":return{MakeMoveVec:{type:"Some"in e.type?Ce.tagToString(e.type.Some):null,elements:e.objects.map((e=>Ve(e)))}};case"MergeCoins":return{MergeCoins:{destination:Ve(e.destination),sources:e.sources.map((e=>Ve(e)))}};case"MoveCall":{const[t,n,r]=e.target.split("::");return{MoveCall:{package:t,module:n,function:r,typeArguments:e.typeArguments,arguments:e.arguments.map((e=>Ve(e)))}}}case"Publish":return{Publish:{modules:e.modules.map((e=>(0,f.s)(Uint8Array.from(e)))),dependencies:e.dependencies}};case"SplitCoins":return{SplitCoins:{coin:Ve(e.coin),amounts:e.amounts.map((e=>Ve(e)))}};case"TransferObjects":return{TransferObjects:{objects:e.objects.map((e=>Ve(e))),address:Ve(e.address)}};case"Upgrade":return{Upgrade:{modules:e.modules.map((e=>(0,f.s)(Uint8Array.from(e)))),dependencies:e.dependencies,package:e.packageId,ticket:Ve(e.ticket)}}}throw new Error(`Unknown transaction ${Object.keys(e)}`)}))})}(e)))}static getDigestFromBytes(e){const t=function(e,t){const n=Array.from("TransactionData::").map((e=>e.charCodeAt(0))),r=new Uint8Array(n.length+t.length);return r.set(n),r.set(t,n.length),(0,_n.R)(r,{dkLen:32})}(0,e);return(0,h.z)(t)}get gasConfig(){return this.gasData}set gasConfig(e){this.gasData=e}build({maxSizeBytes:e=1/0,overrides:t,onlyTransactionKind:n}={}){const r=this.inputs,a=this.commands,i={ProgrammableTransaction:{inputs:r,commands:a}};if(n)return Xt.TransactionKind.serialize(i,{maxSize:e}).toBytes();const s=t?.expiration??this.expiration,o=t?.sender??this.sender,u={...this.gasData,...t?.gasConfig,...t?.gasData};if(!o)throw new Error("Missing transaction sender");if(!u.budget)throw new Error("Missing gas budget");if(!u.payment)throw new Error("Missing gas payment");if(!u.price)throw new Error("Missing gas price");const p={sender:En(o),expiration:s||{None:!0},gasData:{payment:u.payment,owner:En(this.gasData.owner??o),price:BigInt(u.price),budget:BigInt(u.budget)},kind:{ProgrammableTransaction:{inputs:r,commands:a}}};return Xt.TransactionData.serialize({V1:p},{maxSize:e}).toBytes()}addInput(e,t){const n=this.inputs.length;return this.inputs.push(t),{Input:n,type:e,$kind:"Input"}}getInputUses(e,t){this.mapArguments(((n,r)=>("Input"===n.$kind&&n.Input===e&&t(n,r),n)))}mapCommandArguments(e,t){const n=this.commands[e];switch(n.$kind){case"MoveCall":n.MoveCall.arguments=n.MoveCall.arguments.map((r=>t(r,n,e)));break;case"TransferObjects":n.TransferObjects.objects=n.TransferObjects.objects.map((r=>t(r,n,e))),n.TransferObjects.address=t(n.TransferObjects.address,n,e);break;case"SplitCoins":n.SplitCoins.coin=t(n.SplitCoins.coin,n,e),n.SplitCoins.amounts=n.SplitCoins.amounts.map((r=>t(r,n,e)));break;case"MergeCoins":n.MergeCoins.destination=t(n.MergeCoins.destination,n,e),n.MergeCoins.sources=n.MergeCoins.sources.map((r=>t(r,n,e)));break;case"MakeMoveVec":n.MakeMoveVec.elements=n.MakeMoveVec.elements.map((r=>t(r,n,e)));break;case"Upgrade":n.Upgrade.ticket=t(n.Upgrade.ticket,n,e);break;case"$Intent":const r=n.$Intent.inputs;n.$Intent.inputs={};for(const[a,i]of Object.entries(r))n.$Intent.inputs[a]=Array.isArray(i)?i.map((r=>t(r,n,e))):t(i,n,e);break;case"Publish":break;default:throw new Error(`Unexpected transaction kind: ${n.$kind}`)}}mapArguments(e){for(const t of this.commands.keys())this.mapCommandArguments(t,e)}replaceCommand(e,t,n=e){if(!Array.isArray(t))return void(this.commands[e]=t);const r=t.length-1;this.commands.splice(e,1,...structuredClone(t)),this.mapArguments(((a,i,s)=>{if(s<e+t.length)return a;if("number"!=typeof n&&("Result"===a.$kind&&a.Result===e||"NestedResult"===a.$kind&&a.NestedResult[0]===e)){if("NestedResult"in a&&0!==a.NestedResult[1])throw new Error(`Cannot replace command ${e} with a specific result type: NestedResult[${e}, ${a.NestedResult[1]}] references a nested element that cannot be mapped to the replacement result`);return(0,K.parse)(oe,structuredClone(n))}switch(a.$kind){case"Result":a.Result===e&&"number"==typeof n&&(a.Result=n),a.Result>e&&(a.Result+=r);break;case"NestedResult":if(a.NestedResult[0]===e&&"number"==typeof n)return{$kind:"NestedResult",NestedResult:[n,a.NestedResult[1]]};a.NestedResult[0]>e&&(a.NestedResult[0]+=r)}return a}))}replaceCommandWithTransaction(e,t,n){if("Result"!==n.$kind&&"NestedResult"!==n.$kind)throw new Error("Result must be of kind Result or NestedResult");this.insertTransaction(e,t),this.replaceCommand(e+t.commands.length,[],"Result"in n?{NestedResult:[n.Result+e,0]}:{NestedResult:[n.NestedResult[0]+e,n.NestedResult[1]]})}insertTransaction(e,t){const n=new Map,r=new Map;for(let e=0;e<t.inputs.length;e++){const r=t.inputs[e],a=On(r);let i=-1;if(void 0!==a&&(i=this.inputs.findIndex((e=>On(e)===a)),-1!==i&&this.inputs[i].Object?.SharedObject&&r.Object?.SharedObject&&(this.inputs[i].Object.SharedObject.mutable=this.inputs[i].Object.SharedObject.mutable||r.Object.SharedObject.mutable)),-1!==i)n.set(e,i);else{const t=this.inputs.length;this.inputs.push(r),n.set(e,t)}}for(let n=0;n<t.commands.length;n++)r.set(n,e+n);const a=[];for(let e=0;e<t.commands.length;e++){const i=structuredClone(t.commands[e]);Pn(i,n,r),a.push(i)}this.commands.splice(e,0,...a);const i=a.length;i>0&&this.mapArguments(((t,n,r)=>{if(r>=e&&r<e+a.length)return t;switch(t.$kind){case"Result":t.Result>=e&&(t.Result+=i);break;case"NestedResult":t.NestedResult[0]>=e&&(t.NestedResult[0]+=i)}return t}))}getDigest(){const e=this.build({onlyTransactionKind:!1});return Rn.getDigestFromBytes(e)}snapshot(){return(0,K.parse)(ge,this)}shallowClone(){return new Rn({version:this.version,sender:this.sender,expiration:this.expiration,gasData:{...this.gasData},inputs:[...this.inputs],commands:[...this.commands]})}applyResolvedData(e){this.sender||(this.sender=e.sender??null),this.expiration||(this.expiration=e.expiration??null),this.gasData.budget||(this.gasData.budget=e.gasData.budget),this.gasData.owner||(this.gasData.owner=e.gasData.owner??null),this.gasData.payment||(this.gasData.payment=e.gasData.payment),this.gasData.price||(this.gasData.price=e.gasData.price);for(let t=0;t<this.inputs.length;t++){const n=this.inputs[t],r=e.inputs[t];switch(n.$kind){case"UnresolvedPure":if("Pure"!==r.$kind)throw new Error(`Expected input at index ${t} to resolve to a Pure argument, but got ${JSON.stringify(r)}`);this.inputs[t]=r;break;case"UnresolvedObject":if("Object"!==r.$kind)throw new Error(`Expected input at index ${t} to resolve to an Object argument, but got ${JSON.stringify(r)}`);if("ImmOrOwnedObject"===r.Object.$kind||"Receiving"===r.Object.$kind){const e=n.UnresolvedObject,a=r.Object.ImmOrOwnedObject??r.Object.Receiving;if(X(e.objectId)!==X(a.objectId)||null!=e.version&&e.version!==a.version||null!=e.digest&&e.digest!==a.digest||null!=e.mutable||null!=e.initialSharedVersion)throw new Error(`Input at index ${t} did not match unresolved object. ${JSON.stringify(e)} is not compatible with ${JSON.stringify(a)}`)}else{if("SharedObject"!==r.Object.$kind)throw new Error(`Input at index ${t} resolved to an unexpected Object kind: ${JSON.stringify(r.Object)}`);{const e=n.UnresolvedObject,a=r.Object.SharedObject;if(X(e.objectId)!==X(a.objectId)||null!=e.initialSharedVersion&&e.initialSharedVersion!==a.initialSharedVersion||null!=e.mutable&&e.mutable!==a.mutable||null!=e.version||null!=e.digest)throw new Error(`Input at index ${t} did not match unresolved object. ${JSON.stringify(e)} is not compatible with ${JSON.stringify(a)}`)}}this.inputs[t]=r}}}}var Dn,jn,Bn=e=>{throw TypeError(e)},Fn=(e,t,n)=>t.has(e)||Bn("Cannot "+n),xn=(e,t,n)=>(Fn(e,t,"read from private field"),n?n.call(e):t.get(e)),Nn=(e,t,n)=>t.has(e)?Bn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Un=(e,t,n,r)=>(Fn(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);Dn=new WeakMap,jn=new WeakMap;let Wn=class e{constructor({prefix:e,cache:t}={}){Nn(this,Dn),Nn(this,jn),Un(this,Dn,e??[]),Un(this,jn,t??new Map)}read(e,t){const n=[xn(this,Dn),...e].join(":");if(xn(this,jn).has(n))return xn(this,jn).get(n);const r=t();return xn(this,jn).set(n,r),"object"==typeof r&&null!==r&&"then"in r?Promise.resolve(r).then((e=>(xn(this,jn).set(n,e),e))).catch((e=>{throw xn(this,jn).delete(n),e})):r}readSync(e,t){const n=[xn(this,Dn),...e].join(":");if(xn(this,jn).has(n))return xn(this,jn).get(n);const r=t();return xn(this,jn).set(n,r),r}clear(e){const t=[...xn(this,Dn),...e??[]].join(":");if(t)for(const e of xn(this,jn).keys())e.startsWith(t)&&xn(this,jn).delete(e);else xn(this,jn).clear()}scope(t){return new e({prefix:[...xn(this,Dn),...Array.isArray(t)?t:[t]],cache:xn(this,jn)})}};var $n,Kn,Vn,Gn,Ln,zn,Hn,qn,Yn,Qn,Jn=n(293228),Zn=e=>{throw TypeError(e)},Xn=(e,t,n)=>t.has(e)||Zn("Cannot "+n),er=(e,t,n)=>(Xn(e,t,"read from private field"),n?n.call(e):t.get(e)),tr=(e,t,n)=>t.has(e)?Zn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),nr=(e,t,n,r)=>(Xn(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),rr=(e,t,n)=>(Xn(e,t,"access private method"),n);const ar="/",ir={"Mvr-Source":"@mysten/sui@1.45.2"};class sr{constructor({cache:e,url:t,pageSize:n=50,overrides:r}){tr(this,Ln),tr(this,$n),tr(this,Kn),tr(this,Vn),tr(this,Gn),nr(this,$n,e),nr(this,Kn,t),nr(this,Vn,n),nr(this,Gn,{packages:r?.packages,types:r?.types}),function(e){if(e?.packages)for(const[t,n]of Object.entries(e.packages)){if(!H(t))throw new Error(`Invalid package name: ${t}`);if(!Q(X(n)))throw new Error(`Invalid package ID: ${n}`)}if(e?.types)for(const[t,n]of Object.entries(e.types)){if(J(t).typeParams.length>0)throw new Error("Type overrides must be first-level only. If you want to supply generic types, just pass each type individually.");if(!Q(J(n).address))throw new Error(`Invalid type: ${n}`)}}(er(this,Gn))}async resolvePackage({package:e}){return pr(e)?{package:await er(this,Ln,zn).load(e)}:{package:e}}async resolveType({type:e}){if(!pr(e))return{type:e};const t=[...or(e)],n=await er(this,Ln,Hn).loadMany(t),r={};for(let e=0;e<t.length;e++){const a=n[e];if(a instanceof Error)throw a;r[t[e]]=a}return{type:ur(e,r)}}async resolve({types:e=[],packages:t=[]}){const n=new Set;for(const t of e??[])or(t,n);const r=[...n],[a,i]=await Promise.all([r.length>0?er(this,Ln,Hn).loadMany(r):[],t.length>0?er(this,Ln,zn).loadMany(t):[]]),s={...er(this,Gn)?.types};for(const[e,t]of r.entries()){const n=a[e];if(n instanceof Error)throw n;s[t]=n}const o={};for(const t of e??[]){const e=ur(t,s);o[t]={type:e}}const u={};for(const[e,n]of(t??[]).entries()){const t=er(this,Gn)?.packages?.[n]??i[e];if(t instanceof Error)throw t;u[n]={package:t}}return{types:o,packages:u}}}function or(e,t=new Set){if("string"==typeof e&&!pr(e))return t;const n=cr(e)?e:J(e);pr(n.address)&&t.add(`${n.address}::${n.module}::${n.name}`);for(const e of n.typeParams)or(e,t);return t}function ur(e,t){const n=cr(e)?e:J(e),r=`${n.address}::${n.module}::${n.name}`,a=t[r];return Z({...n,address:a?a.split("::")[0]:n.address,typeParams:n.typeParams.map((e=>ur(e,t)))})}function pr(e){return e.includes(ar)||e.includes("@")||e.includes(".sui")}function cr(e){return"object"==typeof e&&"address"in e&&"module"in e&&"name"in e&&"typeParams"in e}function lr(e){const t=new Set;for(const n of e)if(pr(n)){if(!q(n))throw new Error(`Invalid type with names: ${n}`);t.add(n)}return t}$n=new WeakMap,Kn=new WeakMap,Vn=new WeakMap,Gn=new WeakMap,Ln=new WeakSet,zn=function(){return er(this,$n).readSync(["#mvrPackageDataLoader",er(this,Kn)??""],(()=>{const e=new Jn.R((async e=>{if(!er(this,Kn))throw new Error(`MVR Api URL is not set for the current client (resolving ${e.join(", ")})`);const t=await rr(this,Ln,qn).call(this,e);return e.map((e=>t[e]??new Error(`Failed to resolve package: ${e}`)))})),t=er(this,Gn)?.packages;if(t)for(const[n,r]of Object.entries(t))e.prime(n,r);return e}))},Hn=function(){return er(this,$n).readSync(["#mvrTypeDataLoader",er(this,Kn)??""],(()=>{const e=new Jn.R((async e=>{if(!er(this,Kn))throw new Error(`MVR Api URL is not set for the current client (resolving ${e.join(", ")})`);const t=await rr(this,Ln,Yn).call(this,e);return e.map((e=>t[e]??new Error(`Failed to resolve type: ${e}`)))})),t=er(this,Gn)?.types;if(t)for(const[n,r]of Object.entries(t))e.prime(n,r);return e}))},qn=async function(e){if(0===e.length)return{};const t=(0,fn.y)(e,er(this,Vn)),n={};return await Promise.all(t.map((async e=>{const t=await rr(this,Ln,Qn).call(this,"/v1/resolution/bulk",{names:e});if(t?.resolution)for(const e of Object.keys(t?.resolution)){const r=t.resolution[e]?.package_id;r&&(n[e]=r)}}))),n},Yn=async function(e){if(0===e.length)return{};const t=(0,fn.y)(e,er(this,Vn)),n={};return await Promise.all(t.map((async e=>{const t=await rr(this,Ln,Qn).call(this,"/v1/struct-definition/bulk",{types:e});if(t?.resolution)for(const e of Object.keys(t?.resolution)){const r=t.resolution[e]?.type_tag;r&&(n[e]=r)}}))),n},Qn=async function(e,t){if(!er(this,Kn))throw new Error("MVR Api URL is not set for the current client");const n=await fetch(`${er(this,Kn)}${e}`,{method:"POST",headers:{"Content-Type":"application/json",...ir},body:JSON.stringify(t)});if(!n.ok){const e=await n.json().catch((()=>({})));throw new Error(`Failed to resolve types: ${e?.message}`)}return n.json()};const dr=new WeakMap;var yr,mr,fr,br,hr,gr,Tr,wr,Ir,Cr,Ar,Sr,kr,Mr,vr,_r,Or,Pr,Er,Rr=e=>{throw TypeError(e)},Dr=(e,t,n)=>t.has(e)||Rr("Cannot "+n),jr=(e,t,n)=>(Dr(e,t,"read from private field"),n?n.call(e):t.get(e)),Br=(e,t,n)=>t.has(e)?Rr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Fr=(e,t,n,r)=>(Dr(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),xr=(e,t,n)=>(Dr(e,t,"access private method"),n);function Nr(e,t=1/0){const n=[],r=t=>n[t]??(n[t]={$kind:"NestedResult",get NestedResult(){return["function"==typeof e?e():e,t]}});return new Proxy({$kind:"Result",get Result(){return"function"==typeof e?e():e}},{set(){throw new Error("The transaction result is a proxy, and does not support setting properties directly")},get(e,n){if(n in e)return Reflect.get(e,n);if(n===Symbol.iterator)return function*(){let e=0;for(;e<t;)yield r(e),e++};if("symbol"==typeof n)return;const a=parseInt(n,10);return Number.isNaN(a)||a<0?void 0:r(a)}})}const Ur=Symbol.for("@mysten/transaction"),Wr={buildPlugins:new Map,serializationPlugins:new Map},$r=Symbol.for("@mysten/transaction/registry");function Kr(){try{const e=globalThis;return e[$r]||(e[$r]=Wr),e[$r]}catch{return Wr}}const Vr=class e{constructor(){Br(this,Cr),Br(this,yr),Br(this,mr),Br(this,fr,new Map),Br(this,br,[]),Br(this,hr,[]),Br(this,gr,new Set),Br(this,Tr,new Set),Br(this,wr,new Map),Br(this,Ir),this.object=function(e){function t(t){return e(t)}return t.system=e=>{const n=e?.mutable;return t(void 0!==n?et.SharedObjectRef({objectId:"0x5",initialSharedVersion:1,mutable:n}):{$kind:"UnresolvedObject",UnresolvedObject:{objectId:"0x5",initialSharedVersion:1}})},t.clock=()=>t(et.SharedObjectRef({objectId:"0x6",initialSharedVersion:1,mutable:!1})),t.random=()=>t({$kind:"UnresolvedObject",UnresolvedObject:{objectId:"0x8",mutable:!1}}),t.denyList=e=>t({$kind:"UnresolvedObject",UnresolvedObject:{objectId:"0x403",mutable:e?.mutable}}),t.option=({type:e,value:t})=>n=>n.moveCall({typeArguments:[e],target:"0x1::option::"+(null===t?"none":"some"),arguments:null===t?[]:[n.object(t)]}),t}((e=>{if("function"==typeof e)return this.object(this.add(e));if("object"==typeof e&&(0,K.is)(oe,e))return e;const t=On(e),n=jr(this,Ir).inputs.find((e=>t===On(e)));return n?.Object?.SharedObject&&"object"==typeof e&&e.Object?.SharedObject&&(n.Object.SharedObject.mutable=n.Object.SharedObject.mutable||e.Object.SharedObject.mutable),n?{$kind:"Input",Input:jr(this,Ir).inputs.indexOf(n),type:"object"}:xr(this,Cr,kr).call(this,"object","string"==typeof e?{$kind:"UnresolvedObject",UnresolvedObject:{objectId:X(e)}}:e)}));const e=Kr();Fr(this,Ir,new Rn),Fr(this,mr,[...e.buildPlugins.values()]),Fr(this,yr,[...e.serializationPlugins.values()])}static fromKind(t){const n=new e;return Fr(n,Ir,Rn.fromKindBytes("string"==typeof t?(0,f.G)(t):t)),Fr(n,br,jr(n,Ir).inputs.slice()),Fr(n,hr,jr(n,Ir).commands.slice()),Fr(n,gr,new Set(jr(n,hr).map(((e,t)=>t)))),n}static from(t){const n=new e;var r;return(r=t)&&"object"==typeof r&&!0===r[Ur]?Fr(n,Ir,Rn.restore(t.getData())):"string"==typeof t&&t.startsWith("{")?Fr(n,Ir,Rn.restore(JSON.parse(t))):Fr(n,Ir,Rn.fromBytes("string"==typeof t?(0,f.G)(t):t)),Fr(n,br,jr(n,Ir).inputs.slice()),Fr(n,hr,jr(n,Ir).commands.slice()),Fr(n,gr,new Set(jr(n,hr).map(((e,t)=>t)))),n}static registerGlobalSerializationPlugin(e,t){Kr().serializationPlugins.set(e,t??e)}static unregisterGlobalSerializationPlugin(e){Kr().serializationPlugins.delete(e)}static registerGlobalBuildPlugin(e,t){Kr().buildPlugins.set(e,t??e)}static unregisterGlobalBuildPlugin(e){Kr().buildPlugins.delete(e)}addSerializationPlugin(e){jr(this,yr).push(e)}addBuildPlugin(e){jr(this,mr).push(e)}addIntentResolver(e,t){if(jr(this,fr).has(e)&&jr(this,fr).get(e)!==t)throw new Error(`Intent resolver for ${e} already exists`);jr(this,fr).set(e,t)}setSender(e){jr(this,Ir).sender=e}setSenderIfNotSet(e){jr(this,Ir).sender||(jr(this,Ir).sender=e)}setExpiration(e){jr(this,Ir).expiration=e?(0,K.parse)(he,e):null}setGasPrice(e){jr(this,Ir).gasConfig.price=String(e)}setGasBudget(e){jr(this,Ir).gasConfig.budget=String(e)}setGasBudgetIfNotSet(e){null==jr(this,Ir).gasData.budget&&(jr(this,Ir).gasConfig.budget=String(e))}setGasOwner(e){jr(this,Ir).gasConfig.owner=e}setGasPayment(e){jr(this,Ir).gasConfig.payment=e.map((e=>(0,K.parse)(se,e)))}get blockData(){return $e(jr(this,Ir).snapshot())}getData(){return jr(this,Ir).snapshot()}get[Ur](){return!0}get pure(){return Object.defineProperty(this,"pure",{enumerable:!1,value:vn((e=>j(e)?xr(this,Cr,kr).call(this,"pure",{$kind:"Pure",Pure:{bytes:e.toBase64()}}):xr(this,Cr,kr).call(this,"pure",(0,K.is)(be,e)?(0,K.parse)(be,e):e instanceof Uint8Array?et.Pure(e):{$kind:"UnresolvedPure",UnresolvedPure:{value:e}})))}),this.pure}get gas(){return{$kind:"GasCoin",GasCoin:!0}}objectRef(...e){return this.object(et.ObjectRef(...e))}receivingRef(...e){return this.object(et.ReceivingRef(...e))}sharedObjectRef(...e){return this.object(et.SharedObjectRef(...e))}add(e){if("function"==typeof e){if(jr(this,wr).has(e))return jr(this,wr).get(e);const t=xr(this,Cr,Ar).call(this),n=e(t);if(!n||"object"!=typeof n||!("then"in n))return Fr(this,gr,jr(t,gr)),jr(this,wr).set(e,n),n;const r=xr(this,Cr,Sr).call(this,{$kind:"$Intent",$Intent:{name:"AsyncTransactionThunk",inputs:{},data:{resultIndex:jr(this,Ir).commands.length,result:null}}});jr(this,Tr).add(Promise.resolve(n).then((e=>{r.$Intent.data.result=e})));const a=Nr((()=>r.$Intent.data.resultIndex));return jr(this,wr).set(e,a),a}return xr(this,Cr,Sr).call(this,e),Nr(jr(this,Ir).commands.length-1)}splitCoins(e,t){const n=Te.SplitCoins("string"==typeof e?this.object(e):xr(this,Cr,vr).call(this,e),t.map((e=>"number"==typeof e||"bigint"==typeof e||"string"==typeof e?this.pure.u64(e):xr(this,Cr,Mr).call(this,e))));return xr(this,Cr,Sr).call(this,n),Nr(jr(this,Ir).commands.length-1,t.length)}mergeCoins(e,t){return this.add(Te.MergeCoins(this.object(e),t.map((e=>this.object(e)))))}publish({modules:e,dependencies:t}){return this.add(Te.Publish({modules:e,dependencies:t}))}upgrade({modules:e,dependencies:t,package:n,ticket:r}){return this.add(Te.Upgrade({modules:e,dependencies:t,package:n,ticket:this.object(r)}))}moveCall({arguments:e,...t}){return this.add(Te.MoveCall({...t,arguments:e?.map((e=>xr(this,Cr,Mr).call(this,e)))}))}transferObjects(e,t){return this.add(Te.TransferObjects(e.map((e=>this.object(e))),"string"==typeof t?this.pure.address(t):xr(this,Cr,Mr).call(this,t)))}makeMoveVec({type:e,elements:t}){return this.add(Te.MakeMoveVec({type:e,elements:t.map((e=>this.object(e)))}))}serialize(){return JSON.stringify($e(jr(this,Ir).snapshot()))}async toJSON(e={}){await this.prepareForSerialization(e);const t=this.isFullyResolved();return JSON.stringify((0,K.parse)(Xe,t?{...jr(this,Ir).snapshot(),digest:jr(this,Ir).getDigest()}:jr(this,Ir).snapshot()),((e,t)=>"bigint"==typeof t?t.toString():t),2)}async sign(e){const{signer:t,...n}=e,r=await this.build(n);return t.signTransaction(r)}isFullyResolved(){return!(!jr(this,Ir).sender||jr(this,Tr).size>0||jr(this,Ir).commands.some((e=>e.$Intent))||Cn(jr(this,Ir),{}))}async build(e={}){return await this.prepareForSerialization(e),await xr(this,Cr,_r).call(this,e),jr(this,Ir).build({onlyTransactionKind:e.onlyTransactionKind})}async getDigest(e={}){return await this.prepareForSerialization(e),await xr(this,Cr,_r).call(this,e),jr(this,Ir).getDigest()}async prepareForSerialization(e){await xr(this,Cr,Pr).call(this),xr(this,Cr,Er).call(this);const t=new Set;for(const e of jr(this,Ir).commands)e.$Intent&&t.add(e.$Intent.name);const n=[...jr(this,yr)];for(const r of t)if(!e.supportedIntents?.includes(r)){if(!jr(this,fr).has(r))throw new Error(`Missing intent resolver for ${r}`);n.push(jr(this,fr).get(r))}n.push((e=>{let t;if(e){const n=e.overrides??{packages:{},types:{}};dr.has(n)||dr.set(n,new Wn),t=new sr({cache:dr.get(n),url:e.url,pageSize:e.pageSize,overrides:n})}return async(e,n,r)=>{const a=function(e){const t=new Set,n=new Set;for(const r of e.commands)switch(r.$kind){case"MakeMoveVec":r.MakeMoveVec.type&&lr([r.MakeMoveVec.type]).forEach((e=>{n.add(e)}));break;case"MoveCall":const e=r.MoveCall,a=e.package.split("::")[0];if(pr(a)){if(!H(a))throw new Error(`Invalid package name: ${a}`);t.add(a)}lr(e.typeArguments??[]).forEach((e=>{n.add(e)}))}return{packages:[...t],types:[...n]}}(e);if(0===a.types.length&&0===a.packages.length)return r();const i=await(t||function(e){if(!e.client)throw new Error("No sui client passed to Transaction#build, but transaction data was not sufficient to build offline.");return e.client}(n).core.mvr).resolve({types:a.types,packages:a.packages});!function(e,t){for(const n of e.commands){if(n.MakeMoveVec?.type){if(!pr(n.MakeMoveVec.type))continue;if(!t.types[n.MakeMoveVec.type])throw new Error(`No resolution found for type: ${n.MakeMoveVec.type}`);n.MakeMoveVec.type=t.types[n.MakeMoveVec.type].type}const e=n.MoveCall;if(!e)continue;const r=e.package.split("::"),a=r[0];if(pr(a)&&!t.packages[a])throw new Error(`No address found for package: ${a}`);pr(a)&&(r[0]=t.packages[a].package,e.package=r.join("::"));const i=e.typeArguments;if(i){for(let e=0;e<i.length;e++)if(pr(i[e])){if(!t.types[i[e]])throw new Error(`No resolution found for type: ${i[e]}`);i[e]=t.types[i[e]].type}e.typeArguments=i}}}(e,i),await r()}})()),await xr(this,Cr,Or).call(this,n,e)}};yr=new WeakMap,mr=new WeakMap,fr=new WeakMap,br=new WeakMap,hr=new WeakMap,gr=new WeakMap,Tr=new WeakMap,wr=new WeakMap,Ir=new WeakMap,Cr=new WeakSet,Ar=function(){const e=new Vr;return Fr(e,Ir,jr(this,Ir)),Fr(e,yr,jr(this,yr)),Fr(e,mr,jr(this,mr)),Fr(e,fr,jr(this,fr)),Fr(e,Tr,jr(this,Tr)),Fr(e,gr,new Set(jr(this,gr))),Fr(e,wr,jr(this,wr)),jr(this,br).push(jr(e,br)),jr(this,hr).push(jr(e,hr)),e},Sr=function(e){const t=jr(this,Ir).commands.length;return jr(this,hr).push(e),jr(this,gr).add(t),jr(this,Ir).commands.push(e),jr(this,Ir).mapCommandArguments(t,(e=>{if("Result"===e.$kind&&!jr(this,gr).has(e.Result))throw new Error(`Result { Result: ${e.Result} } is not available to use in the current transaction`);if("NestedResult"===e.$kind&&!jr(this,gr).has(e.NestedResult[0]))throw new Error(`Result { NestedResult: [${e.NestedResult[0]}, ${e.NestedResult[1]}] } is not available to use in the current transaction`);if("Input"===e.$kind&&e.Input>=jr(this,Ir).inputs.length)throw new Error(`Input { Input: ${e.Input} } references an input that does not exist in the current transaction`);return e})),e},kr=function(e,t){return jr(this,br).push(t),jr(this,Ir).addInput(e,t)},Mr=function(e){return j(e)?this.pure(e):xr(this,Cr,vr).call(this,e)},vr=function(e){if("function"==typeof e){const t=this.add(e);return"function"==typeof t?xr(this,Cr,vr).call(this,t):(0,K.parse)(oe,t)}return(0,K.parse)(oe,e)},_r=async function(e){if(!e.onlyTransactionKind&&!jr(this,Ir).sender)throw new Error("Missing transaction sender");await xr(this,Cr,Or).call(this,[...jr(this,mr),An],e)},Or=async function(e,t){try{const n=r=>{if(r>=e.length)return()=>{};const a=e[r];return async()=>{const e=n(r+1);let i=!1,s=!1;if(await a(jr(this,Ir),t,(async()=>{if(i)throw new Error(`next() was call multiple times in TransactionPlugin ${r}`);i=!0,await e(),s=!0})),!i)throw new Error(`next() was not called in TransactionPlugin ${r}`);if(!s)throw new Error(`next() was not awaited in TransactionPlugin ${r}`)}};await n(0)()}finally{Fr(this,br,jr(this,Ir).inputs.slice()),Fr(this,hr,jr(this,Ir).commands.slice()),Fr(this,gr,new Set(jr(this,hr).map(((e,t)=>t))))}},Pr=async function(){for(;jr(this,Tr).size>0;){const e=Promise.all(jr(this,Tr));jr(this,Tr).clear(),jr(this,Tr).add(e),await e,jr(this,Tr).delete(e)}},Er=function(){const e=jr(this,Ir).commands,t=jr(this,Ir).inputs,n=jr(this,hr).flat(1/0),r=jr(this,br).flat(1/0);if(n.length!==e.length)throw new Error("Unexpected number of commands found in transaction data");if(r.length!==t.length)throw new Error("Unexpected number of inputs found in transaction data");const a=n.filter((e=>"AsyncTransactionThunk"!==e.$Intent?.name));function i(t){const n=e[t];if("AsyncTransactionThunk"===n.$Intent?.name){const e=n.$Intent.data.result;if(null==e)throw new Error("AsyncTransactionThunk has not been resolved");return i(e.Result)}const r=a.indexOf(n);if(-1===r)throw new Error("Unable to find original index for command");return r}jr(this,Ir).commands=a,jr(this,Ir).inputs=r,Fr(this,hr,a),Fr(this,br,r),Fr(this,gr,new Set(a.map(((e,t)=>t)))),jr(this,Ir).mapArguments((e=>{if("Input"===e.$kind){const n=r.indexOf(t[e.Input]);if(-1===n)throw new Error("Input has not been resolved");return{...e,Input:n}}if("Result"===e.$kind){const t=i(e.Result);return{...e,Result:t}}if("NestedResult"===e.$kind){const t=i(e.NestedResult[0]);return{...e,NestedResult:[t,e.NestedResult[1]]}}return e}));for(const[t,n]of e.entries())if("AsyncTransactionThunk"===n.$Intent?.name)try{n.$Intent.data.resultIndex=i(t)}catch{}};let Gr=Vr;var Lr={MAYAN_FORWARDER_CONTRACT:"0x337685fdaB40D39bd02028545a4FfA7D287cC3E2",MAYAN_PROGRAM_ID:"FC4eXxkyrMPTjiYUpp4EAnkmwMbQyZ6NDCh1kfLn6vsf",AUCTION_PROGRAM_ID:"8QJmxZcEzwuYmCPy6XqgN2sHcYCcFq6AEfBMJZZuLo5a",MCTP_PROGRAM_ID:"dkpZqrxHFrhziEMQ931GLtfy11nFkCsfMftH9u6QwBU",SWIFT_PROGRAM_ID:"BLZRi6frs4X4DNLw56V4EXai1b6QVESN1BhHBTYM9VcY",FEE_MANAGER_PROGRAM_ID:"5VtQHnhs2pfVEr68qQsbTRwKh4JV5GTu9mBHgHFxpHeQ",WORMHOLE_PROGRAM_ID:"worm2ZoG2kUd4vFXhvjh93UUH596ayRfgQ2MgjNMTth",CCTP_CORE_PROGRAM_ID:"CCTPmbSD7gX1bxKPAmg77w8oFzNFpaQiQUWD43TKaecd",CCTP_TOKEN_PROGRAM_ID:"CCTPiPYPc6AsJuwueEnWgSgucamXDZwBd53dQ11YiKX3",TOKEN_PROGRAM_ID:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",TOKEN_2022_PROGRAM_ID:"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb",ASSOCIATED_TOKEN_PROGRAM_ID:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",SPL_UTILS_PROGRAM_ID:"B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69",LOOKUP_TABLE:"Ff3yi1meWQQ19VPZMzGg6H8JQQeRudiV7QtVtyzJyoht",SUI_MCTP_STATE:"0xb787fe0f7530b4fd2162fa0cc92f4f6c5a97c54b4c5c55eb04ab29f4b803ac9c",SUI_MCTP_FEE_MANAGER_STATE:"0xa1b4a96ce93d36dd0bbce0adc39533a07d2f32928918c80cd6fe7868320978f2",SUI_CCTP_CORE_PACKAGE_ID:"0x08d87d37ba49e785dde270a83f8e979605b03dc552b5548f26fdf2f49bf7ed1b",SUI_CCTP_CORE_STATE:"0xf68268c3d9b1df3215f2439400c1c4ea08ac4ef4bb7d6f3ca6a2a239e17510af",SUI_CCTP_TOKEN_PACKAGE_ID:"0x2aa6c5d56376c371f88a6cc42e852824994993cb9bab8d3e6450cbe3cb32b94e",SUI_CCTP_TOKEN_STATE:"0x45993eecc0382f37419864992c12faee2238f5cfe22b98ad3bf455baf65c8a2f",SUI_WORMHOLE_PACKAGE_ID:"0x5306f64e312b581766351c07af79c72fcb1cd25147157fdc2f8ad76de9a3fb6a",SUI_WORMHOLE_STATE:"0xaeab97f96cf9877fee2883315d459552b2b921edc16d7ceac6eab944dd88919c",SUI_LOGGER_PACKAGE_ID:"0x05680e9030c147b413a489f7891273acc221d49bd061c433e5771bc170fc37ac",EXPLORER_URL:"https://explorer-api.mayan.finance/v3",PRICE_URL:"https://price-api.mayan.finance/v3",RELAYER_URL:"https://relayer-api.mayan.finance/v3",HC_ARBITRUM_BRIDGE:"0x2df1c51e09aecf9cacb7bc98cb1742757f163df7",HC_ARBITRUM_DEPOSIT_PROCESSOR:"0xdDd77e62C848C3334f1148d4F1457FC59ede4E4B",ARBITRUM_USDC_CONTRACT:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",PAYLOAD_WRITER_PROGRAM_ID:"DwMLtdtJqJQkHzNcrdTBuWHJByJfgpKBnvFvzyKdy3cU",CPI_PROXY_PROGRAM_ID:"6u55Hqo1AsGMuJQ31VgNBfVhnpeszxXC4b6KzFaRU2JM"},zr=u.sha3_256,Hr=e=>/^(0x)?[0-9a-fA-F]+::\w+::\w+$/.test(e);function qr(e,t){if(1===t)return(0,a.U3)(new s.PublicKey(e).toBytes(),32);if(t===Zr.ethereum||t===Zr.bsc||t===Zr.polygon||t===Zr.avalanche||t===Zr.arbitrum||t===Zr.optimism||t===Zr.base||t===Zr.unichain||t===Zr.linea||t===Zr.sonic)return(0,a.U3)(e,32);if(t===Zr.aptos&&Hr(e))return`0x${zr(e)}`;if(t===Zr.sui){let t=e.startsWith("0x")?e.substring(2):e;if(32!==o.Buffer.from(t,"hex").length)throw new Error("Invalid sui address: "+e);return(0,a.U3)(e,32)}throw console.log(`Unsupported chain id: ${t}`,e),new Error("Unsupported token chain")}function Yr(e){return new Uint8Array(o.Buffer.from(e.startsWith("0x")?e.substring(2):e,"hex"))}function Qr(e,t,n=!1,r=new s.PublicKey(Lr.TOKEN_PROGRAM_ID),a=new s.PublicKey(Lr.ASSOCIATED_TOKEN_PROGRAM_ID)){if(!n&&!s.PublicKey.isOnCurve(t.toBuffer()))throw new Error("TokenOwnerOffCurveError");const[i]=s.PublicKey.findProgramAddressSync([t.toBuffer(),r.toBuffer(),e.toBuffer()],a);return i}function Jr(e,t){if(null==e)throw new Error("getAmountOfFractionalAmount: Amount is null or undefined");if("string"!=typeof e&&"number"!=typeof e)throw new Error("getAmountOfFractionalAmount: Amount is not a string or number");if("string"==typeof e&&0===e.length)throw new Error("getAmountOfFractionalAmount: Amount is empty");if(!Number.isFinite(Number(e)))throw new Error("getAmountOfFractionalAmount: Amount is not a number");if("string"!=typeof(n=t)&&"number"!=typeof n||""===n||null===n||isNaN(Number(n))||!Number.isFinite(Number(n)))throw new Error("getAmountOfFractionalAmount: decimals is not a number");var n;const r=Math.min(8,Number(t)),a=Number(e).toFixed(r+1),s=new RegExp(`^-?\\d+(?:\\.\\d{0,${r}})?`),o=a.match(s);if(!o)throw new Error("getAmountOfFractionalAmount: fixedAmount is null");const u=o[0];return(0,i.vz)(u,Number(t))}var Zr={solana:1,ethereum:2,bsc:4,polygon:5,avalanche:6,arbitrum:23,optimism:24,base:30,aptos:22,sui:21,unichain:44,linea:38,hypercore:65e3,sonic:52};function Xr(e){return Zr[e]}var ea={1:2,56:4,137:5,43114:6,42161:23,10:24,8453:30,130:44,59144:38,146:52};function ta(e){return ea[e]}var na=[10,9,3];function ra(){return na.join("_")}function aa(e){return"solana"===e?9:18}var ia=BigInt(2)**BigInt(64)-BigInt(1);function sa(e){if(e<BigInt(0)||e>ia)throw new Error(`Invalid u64: ${e}`);const t=o.Buffer.alloc(8);return t.writeBigUInt64LE(e),t}var oa={value:BigInt(0),deadline:0,v:0,r:`0x${s.SystemProgram.programId.toBuffer().toString("hex")}`,s:`0x${s.SystemProgram.programId.toBuffer().toString("hex")}`};function ua(e,t){return e&&t?"WH"===e.type?t?.solana||null:"MCTP"===e.type||"SWIFT"===e.type?"solana"===e.toChain?t?.solana||null:"sui"===e.toChain?t?.sui||null:t?.evm||null:"FAST_MCTP"===e.type&&"solana"!==e.toChain&&"sui"!==e.toChain?t?.evm||null:"MONO_CHAIN"===e.type?"solana"===e.fromChain?t?.solana||null:"sui"===e.fromChain?t?.sui||null:t?.evm||null:null:null}var pa=1,ca=2,la=1,da=1,ya=2,ma=3;function fa(e,t,n){const r=o.Buffer.alloc(109),a=o.Buffer.from(Yr(t));if(20!==a.length)throw new Error("Invalid destination address length, expected 20 bytes");const i=o.Buffer.from(Yr(n));if(65!==i.length)throw new Error("Invalid USDC permit signature length, expected 65 bytes");return r.writeBigUInt64BE(BigInt(e.redeemRelayerFee64),0),r.set(a,8),r.writeBigUInt64BE(BigInt(e.hyperCoreParams.depositAmountUSDC64),28),r.writeBigUInt64BE(BigInt(e.deadline64),36),r.set(i,44),r}function ba(e){return Object.entries(e).filter((([e,t])=>null!=t&&!Array.isArray(t))).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}async function ha(e){if(e.status.toString().startsWith("5")){let t;try{const n=await e.json();(n?.code||n?.statusCode)&&(n?.message||n?.msg)&&(t={code:n?.code||n?.statusCode,message:n?.message||n?.msg})}catch(e){t=new Error("Internal server error")}throw t}}async function ga(e){const t=ba({...e,sdkVersion:ra()}),n=await r(`${Lr.PRICE_URL}/get-swap/solana?${t}`,{method:"GET",redirect:"follow"});await ha(n);const a=await n.json();if(200!==n.status&&201!==n.status)throw a;return a}async function Ta(e){const t=JSON.stringify({...e,sdkVersion:ra()}),n=`${Lr.PRICE_URL}/get-swap/sui`,a=await r(n,{method:"POST",redirect:"follow",body:t,headers:{"Content-Type":"application/json"}});await ha(a);const i=await a.json();if(200!==a.status&&201!==a.status)throw i;return i}var wa=[{inputs:[{internalType:"address",name:"_tokenBridge",type:"address"},{internalType:"address",name:"_weth",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint16",name:"emitterChainId",type:"uint16"},{indexed:!0,internalType:"bytes32",name:"emitterAddress",type:"bytes32"},{indexed:!0,internalType:"uint64",name:"sequence",type:"uint64"}],name:"Redeemed",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"tokenAddr",type:"bytes32"},{internalType:"uint16",name:"tokenChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"sourceAddr",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint64",name:"sequence",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bool",name:"unwrapRedeem",type:"bool"},{internalType:"bool",name:"unwrapRefund",type:"bool"}],internalType:"struct MayanStructs.Swap",name:"s",type:"tuple"}],name:"encodeSwap",outputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],stateMutability:"pure",type:"function"},{inputs:[],name:"getWeth",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRedeemPayload",outputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"uint64",name:"relayerFee",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanStructs.Redeem",name:"r",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeem",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeemAndUnwrap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"swap",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"sweepEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"sweepToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"}],name:"wrapAndSwapETH",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}],Ia={_format:"hh-sol-artifact-1",contractName:"MayanForwarder",sourceName:"src/MayanForwarder.sol",abi:[{inputs:[{internalType:"address",name:"_guardian",type:"address"},{internalType:"address[]",name:"_swapProtocols",type:"address[]"},{internalType:"address[]",name:"_mayanProtocols",type:"address[]"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"UnsupportedProtocol",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedEth",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"SwapAndForwarded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"tokenIn",type:"address"},{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedEth",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"mayanProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setMayanProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setSwapProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"swapProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],linkReferences:{},deployedLinkReferences:{}},Ca={_format:"hh-sol-artifact-1",contractName:"MayanCircle",sourceName:"src/MayanCircle.sol",abi:[{inputs:[{internalType:"address",name:"_cctpTokenMessenger",type:"address"},{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"CallerAlreadySet",type:"error"},{inputs:[],name:"CallerNotSet",type:"error"},{inputs:[],name:"CctpReceiveFailed",type:"error"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DomainAlreadySet",type:"error"},{inputs:[],name:"DomainNotSet",type:"error"},{inputs:[],name:"EmitterAlreadySet",type:"error"},{inputs:[],name:"EthTransferFailed",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAddress",type:"error"},{inputs:[],name:"InvalidAmountOut",type:"error"},{inputs:[],name:"InvalidCaller",type:"error"},{inputs:[],name:"InvalidDestAddr",type:"error"},{inputs:[],name:"InvalidDomain",type:"error"},{inputs:[],name:"InvalidEmitter",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidMintRecipient",type:"error"},{inputs:[],name:"InvalidNonce",type:"error"},{inputs:[],name:"InvalidOrder",type:"error"},{inputs:[],name:"InvalidPayload",type:"error"},{inputs:[],name:"InvalidProtocolFee",type:"error"},{inputs:[],name:"InvalidRedeemFee",type:"error"},{inputs:[],name:"InvalidReferrerFee",type:"error"},{inputs:[],name:"MintRecipientAlreadySet",type:"error"},{inputs:[],name:"MintRecipientNotSet",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderRefunded",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes",name:"customPayload",type:"bytes"}],name:"bridgeWithFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint256",name:"redeemFee",type:"uint256"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],name:"bridgeWithLockedFee",outputs:[{internalType:"uint64",name:"cctpNonce",type:"uint64"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cctpTokenMessenger",outputs:[{internalType:"contract ITokenMessenger",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint16",name:"",type:"uint16"}],name:"chainIdToEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"params",type:"tuple"}],name:"createOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"",type:"uint32"}],name:"domainToCaller",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint64",name:"",type:"uint64"}],name:"feeStorage",outputs:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"redeemFee",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"driver",type:"bytes32"}],internalType:"struct MayanCircle.FulfillParams",name:"params",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"}],name:"fulfillOrder",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"}],name:"getDomain",outputs:[{internalType:"uint32",name:"domain",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"keyToMintRecipient",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"localDomain",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"burnAmount",type:"uint64"},{internalType:"bytes32",name:"burnToken",type:"bytes32"},{internalType:"bytes32",name:"customPayload",type:"bytes32"}],internalType:"struct MayanCircle.BridgeWithFeeParams",name:"bridgeParams",type:"tuple"}],name:"redeemWithFee",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"redeemWithLockedFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"cctpNonce",type:"uint32"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"refineFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"orderParams",type:"tuple"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"}],internalType:"struct MayanCircle.ExtraParams",name:"extraParams",type:"tuple"}],name:"refund",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"uint32",name:"domain",type:"uint32"}],name:"setDomain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"domain",type:"uint32"},{internalType:"bytes32",name:"caller",type:"bytes32"}],name:"setDomainCaller",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"bytes32",name:"emitter",type:"bytes32"}],name:"setEmitter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"}],name:"setMintRecipient",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"}],name:"unlockFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm1",type:"bytes"},{internalType:"bytes",name:"encodedVm2",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],internalType:"struct MayanCircle.UnlockRefinedFeeMsg",name:"refinedMsg",type:"tuple"}],name:"unlockFeeRefined",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}},Aa=6;function Sa(e){switch(e){case"ethereum":return 0;case"avalanche":return 1;case"optimism":return 2;case"arbitrum":return 3;case"solana":return 5;case"base":return 6;case"polygon":return 7;case"sui":return 8;case"unichain":return 10;case"linea":return 11;case"sonic":return 13;default:throw new Error("unsupported chain for cctp")}}function ka(e,t){const n=new s.PublicKey(Lr.CCTP_CORE_PROGRAM_ID),r=new s.PublicKey(Lr.CCTP_TOKEN_PROGRAM_ID),[a]=s.PublicKey.findProgramAddressSync([o.Buffer.from("message_transmitter")],n),[i]=s.PublicKey.findProgramAddressSync([o.Buffer.from("sender_authority")],r),[u]=s.PublicKey.findProgramAddressSync([o.Buffer.from("local_token"),e.toBytes()],r),[p]=s.PublicKey.findProgramAddressSync([o.Buffer.from("token_messenger")],r),[c]=s.PublicKey.findProgramAddressSync([o.Buffer.from("token_minter")],r),l=Sa(t),[d]=s.PublicKey.findProgramAddressSync([o.Buffer.from("remote_token_messenger"),o.Buffer.from(l.toString())],r),[y]=s.PublicKey.findProgramAddressSync([o.Buffer.from("__event_authority")],n),[m]=s.PublicKey.findProgramAddressSync([o.Buffer.from("__event_authority")],r);return{messageTransmitter:a,senderAuthority:i,remoteTokenMessengerKey:d,tokenMessenger:p,tokenMinter:c,eventAuthToken:m,eventAuthCore:y,localToken:u}}function Ma(e,t,n,r){const a=function(e,t,n,r){const a=ta(Number(n)),i=Xr(e.fromChain),s=Xr(e.toChain);if(i!==a)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${i} !== ${a}`);const u=e.cheaperChain===e.fromChain;if(u&&r)throw new Error("Bridge lock fee cannot have custom payload");const p=qr(t,s),c=Jr(e.redeemRelayerFee,Aa),l=Jr(e.gasDrop,Math.min(aa(e.toChain),8)),d=BigInt(e.effectiveAmountIn64),y=Sa(e.toChain);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");const m=e.mctpMayanContract;if("solana"===e.toChain&&u)throw new Error("Cannot lock fee for transfer to solana");let f=Jr(e.bridgeFee,aa(e.fromChain));return u&&(f=BigInt(0)),{lockFee:u,tokenIn:e.mctpInputContract,amountIn:d,redeemFee:c,gasDrop:l,destAddr:p,destDomain:y,payloadType:r?ca:pa,customPayload:r?`0x${o.Buffer.from(r).toString("hex")}`:"0x",bridgeFee:f,contractAddress:m}}(e,t,n,r),{contractAddress:i,tokenIn:s,amountIn:u,destAddr:p,lockFee:d,redeemFee:y,gasDrop:m,destDomain:f,customPayload:b,payloadType:h,bridgeFee:g}=a,T=new c.CH(i,Ca.abi);let w,I;return w=d?T.interface.encodeFunctionData("bridgeWithLockedFee",[s,u,m,y,f,p]):T.interface.encodeFunctionData("bridgeWithFee",[s,u,y,m,p,f,h,b]),I=(0,l.m9)(g),{to:i,data:w,value:I,_params:a}}function va(e,t,n,r){const a=function(e,t,n,r){const a=ta(Number(r)),i=Xr(e.fromChain),o=Xr(e.toChain);if(i!==a)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${i} !== ${a}`);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");const u=e.mctpMayanContract,c=qr(t,o);let l;l=n?qr(n,o):qr(s.SystemProgram.programId.toString(),Xr("solana"));const d=Jr(e.redeemRelayerFee,Aa),y=Jr(e.gasDrop,Math.min(aa(e.toChain),8));let m=BigInt(e.effectiveAmountIn64);const f=Jr(e.minAmountOut,Math.min(8,e.toToken.decimals)),b=BigInt(e.deadline64),h=e.toToken.contract===p.N?qr(s.SystemProgram.programId.toString(),Xr("solana")):qr("sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{params:{tokenIn:e.mctpInputContract,amountIn:m,gasDrop:y,destAddr:c,destChain:o,tokenOut:h,minAmountOut:f,deadline:b,redeemFee:d,referrerAddr:l,referrerBps:e.referrerBps||0},bridgeFee:Jr(e.bridgeFee,aa(e.fromChain)),contractAddress:u}}(e,t,n,r),{contractAddress:i,params:o,bridgeFee:u}=a;return{to:i,data:new c.CH(i,Ca.abi).interface.encodeFunctionData("createOrder",[o]),value:(0,l.m9)(u),_params:a}}var _a=[{inputs:[{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"_solanaEmitter",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DuplicateOrder",type:"error"},{inputs:[],name:"FeesTooHigh",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidAuctionMode",type:"error"},{inputs:[],name:"InvalidBpsFee",type:"error"},{inputs:[],name:"InvalidContractSignature",type:"error"},{inputs:[],name:"InvalidDestChain",type:"error"},{inputs:[],name:"InvalidEmitterAddress",type:"error"},{inputs:[],name:"InvalidEmitterChain",type:"error"},{inputs:[],name:"InvalidEvmAddr",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidOrderHash",type:"error"},{inputs:[],name:"InvalidOrderStatus",type:"error"},{inputs:[],name:"InvalidSignature",type:"error"},{inputs:[],name:"InvalidSignatureLength",type:"error"},{inputs:[],name:"InvalidSigner",type:"error"},{inputs:[],name:"InvalidSrcChain",type:"error"},{inputs:[],name:"InvalidWormholeFee",type:"error"},{inputs:[],name:"OrderNotExists",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"SmallAmountIn",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"}],name:"OrderCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderRefunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderUnlocked",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"canceler",type:"bytes32"}],name:"cancelOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithEth",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes",name:"signedOrderHash",type:"bytes"}],name:"createOrderWithSig",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithToken",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillSimple",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"orders",outputs:[{internalType:"enum MayanSwift.Status",name:"status",type:"uint8"},{internalType:"uint64",name:"amountIn",type:"uint64"},{internalType:"uint16",name:"destChainId",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseFulfillPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"driver",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"}],internalType:"struct MayanSwift.FulfillMsg",name:"fulfillMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRefundPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"bytes32",name:"canceler",type:"bytes32"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwift.RefundMsg",name:"refundMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseUnlockPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],internalType:"struct MayanSwift.UnlockMsg",name:"unlockMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32[]",name:"orderHashes",type:"bytes32[]"}],name:"postBatch",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"refundOrder",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"solanaEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"unlockMsgs",outputs:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockSingle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}];function Oa(e,t,n,r){if("string"==typeof e)switch(e){case"u8":return[t.readUInt8(n),n+1];case"u16":return[t.readUInt16LE(n),n+2];case"u32":return[t.readUInt32LE(n),n+4];case"u64":return[t.readBigUInt64LE(n),n+8];case"bool":return[0!==t.readUInt8(n),n+1];case"pubkey":{const e=t.subarray(n,n+32);return[new s.PublicKey(e),n+32]}default:throw new Error(`Unknown primitive: ${e}`)}if("array"in e){const[a,i]=e.array,s=[];let o=n;for(let e=0;e<i;e++){const[e,n]=Oa(a,t,o,r);s.push(e),o=n}return[s,o]}if("defined"in e){const a=r.types?.find((t=>t.name===e.defined.name));if(!a)throw new Error(`Type ${e.defined} not found`);if("struct"===a.type.kind){const e={};let i=n;for(const n of a.type.fields){const[a,s]=Oa(n.type,t,i,r);e[n.name]=a,i=s}return[e,i]}{const e=t.readUInt8(n),i=a.type.variants[e];if(!i)throw new Error(`Invalid enum index ${e}`);let s=n+1;const o={variant:i.name};if(i.fields&&i.fields.length){const e=[];for(const n of i.fields){const[a,i]=Oa(n.type,t,s,r);e.push(a),s=i}o.fields=e}return[o,s]}}if("option"in e)return 0===t.readUInt8(n)?[null,n+1]:Oa(e.option,t,n+1,r);if("vec"in e){const a=t.readUInt32LE(n);let i=n+4;const s=[];for(let n=0;n<a;n++){const[n,a]=Oa(e.vec,t,i,r);s.push(n),i=a}return[s,i]}throw new Error(`Unsupported type shape: ${JSON.stringify(e)}`)}var Pa={address:"JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4",metadata:{name:"jupiter",version:"0.1.0",spec:"0.1.0",description:"Jupiter aggregator program"},instructions:[{name:"route",docs:["route_plan Topologically sorted trade DAG"],discriminator:[229,23,203,151,122,227,173,42],accounts:[{name:"token_program"},{name:"user_transfer_authority",signer:!0},{name:"user_source_token_account",writable:!0},{name:"user_destination_token_account",writable:!0},{name:"destination_token_account",writable:!0,optional:!0},{name:"destination_mint"},{name:"platform_fee_account",writable:!0,optional:!0},{name:"event_authority",address:"D8cy77BBepLMngZx6ZukaTff5hCt1HrWyKk3Hnd9oitf"},{name:"program"}],args:[{name:"route_plan",type:{vec:{defined:{name:"RoutePlanStep"}}}},{name:"in_amount",type:"u64"},{name:"quoted_out_amount",type:"u64"},{name:"slippage_bps",type:"u16"},{name:"platform_fee_bps",type:"u8"}],returns:"u64"},{name:"shared_accounts_route",docs:["Route by using program owned token accounts and open orders accounts."],discriminator:[193,32,155,51,65,214,156,129],accounts:[{name:"token_program"},{name:"program_authority"},{name:"user_transfer_authority",signer:!0},{name:"source_token_account",writable:!0},{name:"program_source_token_account",writable:!0},{name:"program_destination_token_account",writable:!0},{name:"destination_token_account",writable:!0},{name:"source_mint"},{name:"destination_mint"},{name:"platform_fee_account",writable:!0,optional:!0},{name:"token_2022_program",optional:!0},{name:"event_authority",address:"D8cy77BBepLMngZx6ZukaTff5hCt1HrWyKk3Hnd9oitf"},{name:"program"}],args:[{name:"id",type:"u8"},{name:"route_plan",type:{vec:{defined:{name:"RoutePlanStep"}}}},{name:"in_amount",type:"u64"},{name:"quoted_out_amount",type:"u64"},{name:"slippage_bps",type:"u16"},{name:"platform_fee_bps",type:"u8"}],returns:"u64"}],types:[{name:"AccountsType",type:{kind:"enum",variants:[{name:"TransferHookA"},{name:"TransferHookB"},{name:"TransferHookReward"},{name:"TransferHookInput"},{name:"TransferHookIntermediate"},{name:"TransferHookOutput"},{name:"SupplementalTickArrays"},{name:"SupplementalTickArraysOne"},{name:"SupplementalTickArraysTwo"}]}},{name:"FeeEvent",type:{kind:"struct",fields:[{name:"account",type:"pubkey"},{name:"mint",type:"pubkey"},{name:"amount",type:"u64"}]}},{name:"RemainingAccountsInfo",type:{kind:"struct",fields:[{name:"slices",type:{vec:{defined:{name:"RemainingAccountsSlice"}}}}]}},{name:"RemainingAccountsSlice",type:{kind:"struct",fields:[{name:"accounts_type",type:{defined:{name:"AccountsType"}}},{name:"length",type:"u8"}]}},{name:"RoutePlanStep",type:{kind:"struct",fields:[{name:"swap",type:{defined:{name:"Swap"}}},{name:"percent",type:"u8"},{name:"input_index",type:"u8"},{name:"output_index",type:"u8"}]}},{name:"Side",type:{kind:"enum",variants:[{name:"Bid"},{name:"Ask"}]}},{name:"Swap",type:{kind:"enum",variants:[{name:"Saber"},{name:"SaberAddDecimalsDeposit"},{name:"SaberAddDecimalsWithdraw"},{name:"TokenSwap"},{name:"Sencha"},{name:"Step"},{name:"Cropper"},{name:"Raydium"},{name:"Crema",fields:[{name:"a_to_b",type:"bool"}]},{name:"Lifinity"},{name:"Mercurial"},{name:"Cykura"},{name:"Serum",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"MarinadeDeposit"},{name:"MarinadeUnstake"},{name:"Aldrin",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"AldrinV2",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"Whirlpool",fields:[{name:"a_to_b",type:"bool"}]},{name:"Invariant",fields:[{name:"x_to_y",type:"bool"}]},{name:"Meteora"},{name:"GooseFX"},{name:"DeltaFi",fields:[{name:"stable",type:"bool"}]},{name:"Balansol"},{name:"MarcoPolo",fields:[{name:"x_to_y",type:"bool"}]},{name:"Dradex",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"LifinityV2"},{name:"RaydiumClmm"},{name:"Openbook",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"Phoenix",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"Symmetry",fields:[{name:"from_token_id",type:"u64"},{name:"to_token_id",type:"u64"}]},{name:"TokenSwapV2"},{name:"HeliumTreasuryManagementRedeemV0"},{name:"StakeDexStakeWrappedSol"},{name:"StakeDexSwapViaStake",fields:[{name:"bridge_stake_seed",type:"u32"}]},{name:"GooseFXV2"},{name:"Perps"},{name:"PerpsAddLiquidity"},{name:"PerpsRemoveLiquidity"},{name:"MeteoraDlmm"},{name:"OpenBookV2",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"RaydiumClmmV2"},{name:"StakeDexPrefundWithdrawStakeAndDepositStake",fields:[{name:"bridge_stake_seed",type:"u32"}]},{name:"Clone",fields:[{name:"pool_index",type:"u8"},{name:"quantity_is_input",type:"bool"},{name:"quantity_is_collateral",type:"bool"}]},{name:"SanctumS",fields:[{name:"src_lst_value_calc_accs",type:"u8"},{name:"dst_lst_value_calc_accs",type:"u8"},{name:"src_lst_index",type:"u32"},{name:"dst_lst_index",type:"u32"}]},{name:"SanctumSAddLiquidity",fields:[{name:"lst_value_calc_accs",type:"u8"},{name:"lst_index",type:"u32"}]},{name:"SanctumSRemoveLiquidity",fields:[{name:"lst_value_calc_accs",type:"u8"},{name:"lst_index",type:"u32"}]},{name:"RaydiumCP"},{name:"WhirlpoolSwapV2",fields:[{name:"a_to_b",type:"bool"},{name:"remaining_accounts_info",type:{option:{defined:{name:"RemainingAccountsInfo"}}}}]},{name:"OneIntro"},{name:"PumpdotfunWrappedBuy"},{name:"PumpdotfunWrappedSell"},{name:"PerpsV2"},{name:"PerpsV2AddLiquidity"},{name:"PerpsV2RemoveLiquidity"},{name:"MoonshotWrappedBuy"},{name:"MoonshotWrappedSell"},{name:"StabbleStableSwap"},{name:"StabbleWeightedSwap"},{name:"Obric",fields:[{name:"x_to_y",type:"bool"}]},{name:"FoxBuyFromEstimatedCost"},{name:"FoxClaimPartial",fields:[{name:"is_y",type:"bool"}]},{name:"SolFi",fields:[{name:"is_quote_to_base",type:"bool"}]},{name:"SolayerDelegateNoInit"},{name:"SolayerUndelegateNoInit"},{name:"TokenMill",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"DaosFunBuy"},{name:"DaosFunSell"},{name:"ZeroFi"},{name:"StakeDexWithdrawWrappedSol"},{name:"VirtualsBuy"},{name:"VirtualsSell"},{name:"Perena",fields:[{name:"in_index",type:"u8"},{name:"out_index",type:"u8"}]},{name:"PumpdotfunAmmBuy"},{name:"PumpdotfunAmmSell"},{name:"Gamma"},{name:"MeteoraDlmmSwapV2",fields:[{name:"remaining_accounts_info",type:{defined:{name:"RemainingAccountsInfo"}}}]},{name:"Woofi"},{name:"MeteoraDammV2"},{name:"MeteoraDynamicBondingCurveSwap"},{name:"StabbleStableSwapV2"},{name:"StabbleWeightedSwapV2"},{name:"RaydiumLaunchlabBuy",fields:[{name:"share_fee_rate",type:"u64"}]},{name:"RaydiumLaunchlabSell",fields:[{name:"share_fee_rate",type:"u64"}]},{name:"BoopdotfunWrappedBuy"},{name:"BoopdotfunWrappedSell"},{name:"Plasma",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"GoonFi",fields:[{name:"is_bid",type:"bool"},{name:"blacklist_bump",type:"u8"}]},{name:"HumidiFi",fields:[{name:"swap_id",type:"u64"},{name:"is_base_to_quote",type:"bool"}]},{name:"MeteoraDynamicBondingCurveSwapWithRemainingAccounts"},{name:"TesseraV",fields:[{name:"side",type:{defined:{name:"Side"}}}]},{name:"RaydiumStable"}]}},{name:"SwapEvent",type:{kind:"struct",fields:[{name:"amm",type:"pubkey"},{name:"input_mint",type:"pubkey"},{name:"input_amount",type:"u64"},{name:"output_mint",type:"pubkey"},{name:"output_amount",type:"u64"}]}},{name:"TokenLedger",type:{kind:"struct",fields:[{name:"token_account",type:"pubkey"},{name:"amount",type:"u64"}]}}]};function Ea(e,t,n,r,a=new s.PublicKey(Lr.TOKEN_PROGRAM_ID),i=new s.PublicKey(Lr.ASSOCIATED_TOKEN_PROGRAM_ID)){const u=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new s.TransactionInstruction({keys:u,programId:i,data:o.Buffer.from([1])})}var Ra=165;async function Da(e,t,n,r,a,i=new s.PublicKey(Lr.TOKEN_PROGRAM_ID)){const u=[],p=await e.getMinimumBalanceForRentExemption(Ra);return u.push(s.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:a.publicKey,lamports:p,space:Ra,programId:i})),u.push(new s.TransactionInstruction({keys:[{pubkey:a.publicKey,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1}],programId:i,data:o.Buffer.from([1])})),u}var ja=(0,d.struct)([(0,d.u8)("instruction"),(0,d.blob)(8,"amount")]),Ba=(0,d.struct)([(0,d.u8)("instruction")]);function Fa(e){const t=[{pubkey:e,isSigner:!1,isWritable:!0}],n=o.Buffer.alloc(Ba.span);return Ba.encode({instruction:17},n),new s.TransactionInstruction({keys:t,programId:new s.PublicKey(Lr.TOKEN_PROGRAM_ID),data:n})}(0,d.struct)([(0,d.u8)("instruction")]);var xa=(0,d.struct)([(0,d.u8)("instruction"),(0,d.blob)(8,"amount")]);function Na(e,t,n,r,a=new s.PublicKey(Lr.TOKEN_PROGRAM_ID)){const i=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],u=o.Buffer.alloc(xa.span);return xa.encode({instruction:3,amount:sa(r)},u),new s.TransactionInstruction({keys:i,programId:a,data:u})}var Ua=new s.PublicKey("So11111111111111111111111111111111111111112");function Wa(e){return new s.TransactionInstruction({programId:new s.PublicKey(e.programId),keys:e.accounts.map((e=>({pubkey:new s.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}))),data:o.Buffer.from(e.data,"base64")})}async function $a(e,t){return(await t.getMultipleAccountsInfo(e.map((e=>new s.PublicKey(e))))).reduce(((t,n,r)=>{const a=e[r];if(n){const e=new s.AddressLookupTableAccount({key:new s.PublicKey(a),state:s.AddressLookupTableAccount.deserialize(n.data)});t.push(e)}return t}),new Array)}function Ka(e,t){return{swapInstruction:Wa(e.swapInstruction),cleanupInstruction:e.cleanupInstruction?Wa(e.cleanupInstruction):null,computeBudgetInstructions:e.computeBudgetInstructions?e.computeBudgetInstructions.map(Wa):[],setupInstructions:e.setupInstructions?e.setupInstructions.map(Wa):[],addressLookupTableAddresses:e.addressLookupTableAddresses}}function Va(e){let t=`global:${e}`;return o.Buffer.from(y.sha256.digest(t)).subarray(0,8)}async function Ga(){let e;try{const t=await async function(){const e=await r(`${Lr.RELAYER_URL}/active-relayers?solanaProgram=${Lr.MAYAN_PROGRAM_ID}`,{method:"GET",redirect:"follow"});await ha(e);const t=await e.json();if(200!==e.status&&201!==e.status)throw t;return t.suggested}();e=new s.PublicKey(t)}catch(t){console.log("Relayer not found, using system program"),e=s.SystemProgram.programId}return e}function La(e,t,n,r,a=!1){e.computeBudgetInstructions.forEach((e=>{if(!e.programId.equals(s.ComputeBudgetProgram.programId))throw new Error("Invalid compute budget instruction:: programId");if(3===Uint8Array.from(e.data)[0]&&e.data.readBigUInt64LE(1)>100000000n)throw new Error("Invalid compute budget instruction:: to high tx fee")})),function(e,t){if(!(e.length<1)){if(e.length>6)throw new Error("Invalid setup instruction:: too many instructions");e.forEach((e=>{if(!(e.programId.equals(new s.PublicKey(Lr.ASSOCIATED_TOKEN_PROGRAM_ID))||e.programId.equals(s.SystemProgram.programId)||e.programId.equals(new s.PublicKey(Lr.TOKEN_PROGRAM_ID))||e.programId.equals(new s.PublicKey(Lr.TOKEN_2022_PROGRAM_ID))))throw new Error("Invalid setup instruction:: programId");if(e.programId.equals(new s.PublicKey(Lr.ASSOCIATED_TOKEN_PROGRAM_ID))){if(1===Uint8Array.from(e.data).length){if(1!==Uint8Array.from(e.data)[0])throw new Error("Invalid setup instruction:: data")}else if(0!==Uint8Array.from(e.data).length)throw new Error("Invalid setup instruction:: data")}else if(e.programId.equals(s.SystemProgram.programId)){if(!t)throw new Error("Invalid setup instruction:: unknown transfer");const n=Qr(Ua,t,!0);if(2!==e.data.readUint32LE())throw new Error("Invalid setup instruction:: invalid system program instruction");if(!e.keys[1].pubkey.equals(n))throw new Error("Invalid setup instruction:: invalid wrap transfer dest")}else if("EQ=="!==e.data.toString("base64"))throw new Error("Invalid setup instruction:: invalid token program instruction")}))}}(e.setupInstructions,n),function(e,t,n=!1){const r=new s.PublicKey("JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4");if(!e.programId.equals(r))throw new Error("Invalid swap instruction:: programId");if(e.data.subarray(0,8).toString("hex")===Va("shared_accounts_route").toString("hex")){if(!e.keys[6].pubkey.equals(t))throw new Error("Invalid swap instruction shared_accounts_route:: dest account")}else{if(e.data.subarray(0,8).toString("hex")!==Va("route").toString("hex"))throw new Error("Invalid swap instruction:: ix id");if(n){if(!e.keys[4].pubkey.equals(r)&&!e.keys[3].pubkey.equals(t))throw new Error("Invalid swap instruction route:: dest account")}else if(!e.keys[4].pubkey.equals(t))throw new Error("Invalid swap instruction route:: dest account")}}(e.swapInstruction,t,a),function(e,t){if(e){if(!e.programId.equals(new s.PublicKey(Lr.TOKEN_PROGRAM_ID))&&!e.programId.equals(new s.PublicKey(Lr.TOKEN_2022_PROGRAM_ID)))throw new Error("Invalid cleanup instruction:: programId");if(1!==Uint8Array.from(e.data).length)throw new Error("Invalid cleanup instruction:: data");if(9!==Uint8Array.from(e.data)[0])throw new Error("Invalid cleanup instruction:: data");if(t&&!e.keys[1].pubkey.equals(t))throw new Error("Invalid cleanup instruction:: dest account")}}(e.cleanupInstruction,r)}function za(e,t,n,r,a,i=new s.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA")){return new s.TransactionInstruction({keys:[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1}],programId:new s.PublicKey("B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69"),data:Va("transfer_all_and_close")})}function Ha(e,t,n,r){const a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s.SystemProgram.programId,isSigner:!1,isWritable:!1}],i=14+n.length,u=o.Buffer.alloc(i);return u.set(Va("create_simple"),0),u.writeUint16LE(r,8),u.writeUint32LE(n.length,10),u.set(n,14),new s.TransactionInstruction({keys:a,programId:new s.PublicKey(Lr.PAYLOAD_WRITER_PROGRAM_ID),data:u})}function qa(e,t,n){const r=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],a=o.Buffer.alloc(10);return a.set(Va("close"),0),a.writeUint16LE(n,8),new s.TransactionInstruction({keys:r,programId:new s.PublicKey(Lr.PAYLOAD_WRITER_PROGRAM_ID),data:a})}function Ya(e){const t=new s.PublicKey(Lr.CPI_PROXY_PROGRAM_ID),n=o.Buffer.alloc(4);n.writeUint32LE(e.data.length,0);const r=o.Buffer.concat([Va("foreign_program_invoker"),n,e.data]),a=[{pubkey:e.programId,isSigner:!1,isWritable:!1},{pubkey:e.programId,isSigner:!1,isWritable:!1}].concat(e.keys.map((e=>({pubkey:e.pubkey,isSigner:e.isSigner,isWritable:e.isWritable}))));return new s.TransactionInstruction({keys:a,programId:t,data:r})}var Qa=(0,d.struct)([(0,d.blob)(8,"instruction")]);function Ja(e,t,n,r,a){const i=new s.PublicKey(Lr.WORMHOLE_PROGRAM_ID),u=new s.PublicKey(Lr.TOKEN_PROGRAM_ID),p=new s.PublicKey(Lr.CCTP_CORE_PROGRAM_ID),c=new s.PublicKey(Lr.CCTP_TOKEN_PROGRAM_ID),l=new s.PublicKey(Lr.MCTP_PROGRAM_ID),d=new s.PublicKey(r),y=new s.PublicKey(n),m=Qr(y,e,!0);let f;f=a&&a>BigInt(0)?Qr(y,d,!1):new s.PublicKey(Lr.MCTP_PROGRAM_ID);const b=ka(y,t),h=function(e){const t=new s.PublicKey(Lr.WORMHOLE_PROGRAM_ID),n=new s.PublicKey(e),[r]=s.PublicKey.findProgramAddressSync([o.Buffer.from("Bridge")],t),[a]=s.PublicKey.findProgramAddressSync([o.Buffer.from("emitter")],n),[i]=s.PublicKey.findProgramAddressSync([o.Buffer.from("Sequence"),a.toBuffer()],t),[u]=s.PublicKey.findProgramAddressSync([o.Buffer.from("fee_collector")],t);return{bridgeConfig:r,sequenceKey:i,feeCollector:u,emitter:a}}(Lr.MCTP_PROGRAM_ID),g=s.Keypair.generate(),T=s.Keypair.generate(),w=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!0},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:b.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:b.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:b.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:b.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:b.localToken,isWritable:!0,isSigner:!1},{pubkey:b.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:b.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:g.publicKey,isWritable:!0,isSigner:!0},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:h.emitter,isWritable:!1,isSigner:!1},{pubkey:h.bridgeConfig,isWritable:!0,isSigner:!1},{pubkey:h.sequenceKey,isWritable:!0,isSigner:!1},{pubkey:h.feeCollector,isWritable:!0,isSigner:!1},{pubkey:T.publicKey,isWritable:!0,isSigner:!0},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],I=o.Buffer.alloc(Qa.span);return Qa.encode({instruction:Va("bridge_with_fee")},I),{instruction:new s.TransactionInstruction({keys:w,data:I,programId:l}),signers:[g,T]}}var Za=(0,d.struct)([(0,d.blob)(8,"instruction")]);function Xa(e,t,n,r,a){const i=[],u=new s.PublicKey(Lr.TOKEN_PROGRAM_ID),p=new s.PublicKey(Lr.ASSOCIATED_TOKEN_PROGRAM_ID),c=new s.PublicKey(Lr.CCTP_CORE_PROGRAM_ID),l=new s.PublicKey(Lr.CCTP_TOKEN_PROGRAM_ID),d=new s.PublicKey(Lr.MCTP_PROGRAM_ID),y=new s.PublicKey(r),m=new s.PublicKey(n),f=Qr(m,e,!0),b=ka(m,t),h=s.Keypair.generate(),[g]=s.PublicKey.findProgramAddressSync([o.Buffer.from("LOCKED_FEE"),m.toBuffer(),h.publicKey.toBytes()],d);let T;T=a&&a>BigInt(0)?Qr(m,y,!1):new s.PublicKey(Lr.MCTP_PROGRAM_ID);const w=Qr(m,g,!0);i.push(Ea(y,w,g,m));const I=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!0},{pubkey:T,isWritable:!0,isSigner:!1},{pubkey:g,isWritable:!0,isSigner:!1},{pubkey:w,isWritable:!0,isSigner:!1},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:b.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:b.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:b.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:b.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:b.localToken,isWritable:!0,isSigner:!1},{pubkey:b.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:b.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:h.publicKey,isWritable:!0,isSigner:!0},{pubkey:l,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],C=o.Buffer.alloc(Za.span);Za.encode({instruction:Va("bridge_locked_fee")},C);const A=new s.TransactionInstruction({keys:I,data:C,programId:d});return i.push(A),{instructions:i,signer:h}}var ei=(0,d.struct)([(0,d.blob)(8,"instruction")]);function ti(e,t,n,r,a){const i=new s.PublicKey(Lr.TOKEN_PROGRAM_ID),u=new s.PublicKey(Lr.CCTP_CORE_PROGRAM_ID),p=new s.PublicKey(Lr.CCTP_TOKEN_PROGRAM_ID),c=new s.PublicKey(Lr.MCTP_PROGRAM_ID),l=new s.PublicKey(r),d=new s.PublicKey(n),y=Qr(d,e,!0),m=ka(d,t),f=s.Keypair.generate(),[b]=s.PublicKey.findProgramAddressSync([o.Buffer.from("ORDER_SOLANA_SOURCE"),e.toBuffer()],c);let h;h=a&&a>BigInt(0)?Qr(d,l,!1):new s.PublicKey(Lr.MCTP_PROGRAM_ID);const g=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!0},{pubkey:h,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!1},{pubkey:b,isWritable:!0,isSigner:!1},{pubkey:m.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:m.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:m.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:m.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:m.localToken,isWritable:!0,isSigner:!1},{pubkey:m.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:m.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:f.publicKey,isWritable:!0,isSigner:!0},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(Lr.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],T=o.Buffer.alloc(ei.span);return ei.encode({instruction:Va("create_order")},T),{instruction:new s.TransactionInstruction({keys:g,data:T,programId:c}),signer:f}}var ni=(0,d.struct)([(0,d.blob)(8,"instruction"),(0,d.blob)(32,"destAddress"),(0,d.blob)(8,"amountInMin"),(0,d.blob)(8,"gasDrop"),(0,d.blob)(8,"feeRedeem"),(0,d.blob)(8,"feeSolana"),(0,d.u16)("destinationChain"),(0,d.blob)(32,"keyRnd"),(0,d.u8)("mode")]);function ri(e){if("WITH_FEE"!==e.mode&&"LOCK_FEE"!==e.mode)throw new Error("Invalid mode: "+e.mode);const t=new s.PublicKey(e.swapperAddress),n=new s.PublicKey(e.mintAddress),r=Qr(n,e.ledger,!0),a=Xr(e.toChain),i=o.Buffer.from(Yr(qr(e.destinationAddress,a))),u=sa(e.amountInMin64),p=sa(Jr(e.gasDrop,Math.min(aa(e.toChain),8))),c=sa(Jr(e.feeRedeem,Aa)),l=sa(e.feeSolana),d=e.referrerAddress?o.Buffer.from(Yr(qr(e.referrerAddress,a))):s.SystemProgram.programId.toBuffer(),y=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:e.customPayload||new s.PublicKey(Lr.MCTP_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(d),isWritable:!1,isSigner:!1}],m=o.Buffer.alloc(ni.span);return ni.encode({instruction:Va("init_bridge_ledger"),destAddress:i,amountInMin:u,gasDrop:p,feeRedeem:c,feeSolana:l,destinationChain:a,keyRnd:e.randomKey.toBuffer(),mode:"WITH_FEE"===e.mode?1:2},m),new s.TransactionInstruction({keys:y,data:m,programId:new s.PublicKey(Lr.MCTP_PROGRAM_ID)})}var ai=(0,d.struct)([(0,d.blob)(8,"instruction"),(0,d.blob)(32,"destAddress"),(0,d.blob)(8,"amountInMin"),(0,d.blob)(8,"gasDrop"),(0,d.blob)(8,"feeRedeem"),(0,d.blob)(8,"feeSolana"),(0,d.u16)("destinationChain"),(0,d.blob)(32,"keyRnd"),(0,d.u8)("mode"),(0,d.blob)(32,"tokenOut"),(0,d.blob)(8,"amountOutMin"),(0,d.blob)(8,"deadline"),(0,d.blob)(32,"refAddress"),(0,d.u8)("feeRateRef")]);function ii(e){const t=new s.PublicKey(e.swapperAddress),n=new s.PublicKey(e.mintAddress),r=Qr(n,e.ledger,!0),a=Xr(e.toChain),i=o.Buffer.from(Yr(qr(e.destinationAddress,a))),u=sa(e.amountInMin64),p=sa(Jr(e.gasDrop,Math.min(aa(e.toChain),8))),c=sa(Jr(e.feeRedeem,Aa)),l=sa(e.feeSolana),d=o.Buffer.from(Yr(qr(e.tokenOut,a))),y=e.referrerAddress?o.Buffer.from(Yr(qr(e.referrerAddress,a))):s.SystemProgram.programId.toBuffer(),m=sa(Jr(e.amountOutMin,Math.min(8,e.tokenOutDecimals))),f=sa(e.deadline),b=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],h=o.Buffer.alloc(ai.span);return ai.encode({instruction:Va("init_order_ledger"),destAddress:i,amountInMin:u,gasDrop:p,feeRedeem:c,feeSolana:l,destinationChain:a,keyRnd:e.randomKey.toBuffer(),mode:3,tokenOut:d,refAddress:y,amountOutMin:m,deadline:f,feeRateRef:e.feeRateRef},h),new s.TransactionInstruction({keys:b,data:h,programId:new s.PublicKey(Lr.MCTP_PROGRAM_ID)})}var si=(0,d.struct)([(0,d.blob)(8,"instruction"),(0,d.blob)(8,"amountInMin"),(0,d.u8)("nativeInput"),(0,d.blob)(8,"feeSubmit"),(0,d.blob)(32,"destAddress"),(0,d.u16)("destinationChain"),(0,d.blob)(32,"tokenOut"),(0,d.blob)(8,"amountOutMin"),(0,d.blob)(8,"gasDrop"),(0,d.blob)(8,"feeCancel"),(0,d.blob)(8,"feeRefund"),(0,d.blob)(8,"deadline"),(0,d.blob)(32,"refAddress"),(0,d.u8)("feeRateRef"),(0,d.u8)("feeRateMayan"),(0,d.u8)("auctionMode"),(0,d.blob)(32,"randomKey")]);async function oi(e,t,n,r,a,i={}){if("SWIFT"!==e.type)throw new Error("Unsupported quote type for Swift: "+e.type);if("solana"===e.toChain)throw new Error("Unsupported destination chain: "+e.toChain);const u=i.allowSwapperOffCurve||!1;let c=[],l=[],d=[];d.push(Lr.LOOKUP_TABLE);let y=[],f=[],b=[];const h=s.Keypair.generate();let g=null;const T=new s.PublicKey(Lr.SWIFT_PROGRAM_ID),w=new s.PublicKey(t),I=s.Keypair.generate();if(!Number(e.deadline64))throw new Error("Swift mode requires a timeout");const C=BigInt(e.deadline64),A=function(e,t,n,r,a){const i=o.Buffer.alloc(239);let u=0;const c=Xr(e.fromChain),l=o.Buffer.from(Yr(qr(t,c)));i.set(l,0),u+=32,i.writeUInt16BE(c,u),u+=2;const d=e.swiftInputContract===p.N?qr(s.SystemProgram.programId.toString(),Xr("solana")):qr(e.swiftInputContract,c),y=o.Buffer.from(Yr(d));i.set(y,u),u+=32;const f=Xr(e.toChain),b=o.Buffer.from(Yr(qr(n,f)));i.set(b,u),u+=32,i.writeUInt16BE(f,u),u+=2;const h=e.toToken.contract===p.N?qr(s.SystemProgram.programId.toString(),Xr("solana")):qr(e.toToken.contract,f),g=o.Buffer.from(Yr(h));i.set(g,u),u+=32,i.writeBigUInt64BE(Jr(e.minAmountOut,Math.min(e.toToken.decimals,8)),u),u+=8,i.writeBigUInt64BE(Jr(e.gasDrop,Math.min(aa(e.toChain),8)),u),u+=8,i.writeBigUInt64BE(BigInt(e.cancelRelayerFee64),u),u+=8,i.writeBigUInt64BE(BigInt(e.refundRelayerFee64),u),u+=8,i.writeBigUInt64BE(BigInt(e.deadline64),u),u+=8;const T=r?o.Buffer.from(Yr(qr(r,f))):s.SystemProgram.programId.toBuffer();i.set(T,u),u+=32,i.writeUInt8(e.referrerBps,u),u+=1;const w=e.protocolBps;i.writeUInt8(w,u),u+=1,i.writeUInt8(e.swiftAuctionMode,u),u+=1;const I=o.Buffer.from(Yr(a));if(i.set(I,u),u+=32,239!==u)throw new Error(`Invalid order data size: ${u}`);const C=m.w(i);return o.Buffer.from(Yr(C))}(e,t,n,r,I.publicKey.toBuffer().toString("hex")),[S]=s.PublicKey.findProgramAddressSync([o.Buffer.from("STATE_SOURCE"),A],T),k=e.swiftInputContract===p.N?Ua:new s.PublicKey(e.swiftInputContract),M=Qr(k,S,!0),v=e.gasless?new s.PublicKey(e.relayer):w,_=Qr(k,v,!1);if(e.fromToken.contract===e.swiftInputContract)e.suggestedPriorityFee>0&&c.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),c.push(Ya(Ea(v,M,S,k))),e.swiftInputContract===p.N?c.push(Ya(s.SystemProgram.transfer({fromPubkey:w,toPubkey:M,lamports:BigInt(e.effectiveAmountIn64)})),Ya(Fa(M))):c.push(Ya(Na(Qr(k,w,u),M,w,BigInt(e.effectiveAmountIn64))));else{const n=await ga({minMiddleAmount:e.minMiddleAmount,middleToken:e.swiftInputContract,userWallet:t,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.gasless?"SWIFT_GASLESS":"SWIFT",orderHash:`0x${A.toString("hex")}`,fillMaxAccounts:i?.separateSwapTx||!1,tpmTokenAccount:i?.separateSwapTx?h.publicKey.toString():null}),r=Ka(n);i?.separateSwapTx&&n.maxAccountsFilled?(La(r,h.publicKey,w),b=await Da(a,v,k,w,h),f.push(...r.computeBudgetInstructions),r.setupInstructions&&f.push(...r.setupInstructions),f.push(r.swapInstruction),r.cleanupInstruction&&f.push(r.cleanupInstruction),y.push(...r.addressLookupTableAddresses),c.push(Ya(Ea(v,M,S,k))),c.push(Ya(za(w,k,h.publicKey,M,v)))):(La(r,M,w),c.push(...r.computeBudgetInstructions),r.setupInstructions&&c.push(...r.setupInstructions.map((e=>Ya(e)))),c.push(Ya(r.swapInstruction)),r.cleanupInstruction&&c.push(Ya(r.cleanupInstruction)),d.push(...r.addressLookupTableAddresses))}c.push(Ya(function(e){const{quote:t}=e,n=t.swiftInputContract===p.N?Ua:new s.PublicKey(t.swiftInputContract),r=Xr(t.toChain);if(r!==t.toToken.wChainId)throw new Error(`Destination chain ID mismatch: ${r} != ${t.toToken.wChainId}`);const a=[{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.relayer,isWritable:!0,isSigner:!0},{pubkey:e.state,isWritable:!0,isSigner:!1},{pubkey:e.stateAccount,isWritable:!0,isSigner:!1},{pubkey:e.relayerAccount,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(Lr.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(Lr.TOKEN_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],i=o.Buffer.alloc(si.span),u=e.referrerAddress?o.Buffer.from(Yr(qr(e.referrerAddress,r))):s.SystemProgram.programId.toBuffer(),c=t.fromToken.contract===t.swiftInputContract?BigInt(t.effectiveAmountIn64):Jr(t.minMiddleAmount,t.swiftInputDecimals);return si.encode({instruction:Va("init_order"),amountInMin:sa(c),nativeInput:t.swiftInputContract===p.N?1:0,feeSubmit:sa(BigInt(t.submitRelayerFee64)),destAddress:o.Buffer.from(Yr(qr(e.destinationAddress,r))),destinationChain:r,tokenOut:o.Buffer.from(Yr(qr(t.toToken.contract,r))),amountOutMin:sa(Jr(t.minAmountOut,Math.min(t.toToken.decimals,8))),gasDrop:sa(Jr(t.gasDrop,Math.min(aa(t.toChain),8))),feeCancel:sa(BigInt(t.cancelRelayerFee64)),feeRefund:sa(BigInt(t.refundRelayerFee64)),deadline:sa(e.deadline),refAddress:u,feeRateRef:t.referrerBps,feeRateMayan:t.protocolBps,auctionMode:t.swiftAuctionMode,randomKey:e.randomKey.toBuffer()},i),new s.TransactionInstruction({keys:a,data:i,programId:new s.PublicKey(Lr.SWIFT_PROGRAM_ID)})}({quote:e,state:S,trader:w,stateAccount:M,randomKey:I.publicKey,relayerAccount:_,relayer:v,destinationAddress:n,deadline:C,referrerAddress:r})));const O=await $a(d.concat(y),a);return l=O.slice(0,d.length),f.length>0&&(g={messageV0:{payerKey:v,instructions:f,addressLookupTableAccounts:O.slice(d.length)},createTmpTokenAccountIxs:b,tmpTokenAccount:h}),{instructions:c,signers:[],lookupTables:l,swapMessageV0Params:g}}async function ui(e,t,n,r,a,i={}){if("MONO_CHAIN"!==e.type)throw new Error("Unsupported quote type for mono chain: "+e.type);if("solana"!==e.fromChain)throw new Error("Unsupported destination chain for mono chain: "+e.fromChain);if("solana"!==e.toChain)throw new Error("Unsupported destination chain for mono chain: "+e.toChain);if(e.fromToken.contract===e.toToken.contract)throw new Error("From token and to token are the same: "+e.fromToken.contract);if(n.startsWith("0x"))throw new Error("Destination address should not be EVM address");try{new s.PublicKey(n)}catch(e){throw new Error("Invalid destination address: "+n)}let u=[],c=[],l=[];const d=new s.PublicKey(t),y=new s.PublicKey(n),m=Qr(e.toToken.contract===p.N?Ua:new s.PublicKey(e.toToken.contract),y,!0,"spl2022"===e.toToken.standard?new s.PublicKey(Lr.TOKEN_2022_PROGRAM_ID):new s.PublicKey(Lr.TOKEN_PROGRAM_ID)),f=Jr(e.expectedAmountOut,e.toToken.decimals),b=Ka(await ga({userWallet:t,destinationWallet:n,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,middleToken:e.toToken.contract,amountIn64:e.effectiveAmountIn64,expectedAmountOut64:String(f),depositMode:"MONO_CHAIN",referrerAddress:r,referrerBps:e.referrerBps}));return La(b,m,d,y,d.equals(y)),function(e,t){const n=function(e){return function(e,t){const n=t.subarray(0,8),r=e.instructions.find((e=>o.Buffer.from(e.discriminator).toString("hex").toLowerCase()===o.Buffer.from(n).toString("hex").toLowerCase()));if(!r)throw new Error(`Instruction ${o.Buffer.from(n).toString("hex")} not in IDL`);const a=r.args||[],i={};let s=8;for(const n of a){const[r,a]=Oa(n.type,t,s,e);i[n.name]=r,s=a}return i}(Pa,o.Buffer.from(e))}(Uint8Array.from(e.data));if(n.in_amount>BigInt(t.effectiveAmountIn64))throw new Error("Invalid swap instruction:: amount in");const r=Jr(t.minAmountOut,t.toToken.decimals);if(n.quoted_out_amount-n.quoted_out_amount*BigInt(n.slippage_bps)/10000n<r)throw new Error("Invalid swap instruction:: quote expired");if(n.platform_fee_bps!==t.referrerBps)throw new Error("Invalid swap instruction:: platform fee")}(b.swapInstruction,e),u.push(...b.computeBudgetInstructions),b.setupInstructions&&u.push(...b.setupInstructions.map((e=>Ya(e)))),u.push(Ya(b.swapInstruction)),b.cleanupInstruction&&u.push(Ya(b.cleanupInstruction)),l.push(...b.addressLookupTableAddresses),l.push(Lr.LOOKUP_TABLE),c=await $a(l,a),{instructions:u,signers:[],lookupTables:c,swapMessageV0Params:null}}var pi=(0,d.struct)([(0,d.u8)("instruction"),(0,d.u8)("stateNonce"),(0,d.blob)(8,"amount"),(0,d.blob)(8,"minAmountOut"),(0,d.blob)(8,"deadline"),(0,d.blob)(8,"feeSwap"),(0,d.blob)(8,"feeReturn"),(0,d.blob)(8,"feeCancel"),(0,d.blob)(8,"gasDrop"),(0,d.u16)("destinationChain"),(0,d.blob)(32,"destinationAddress"),(0,d.u8)("unwrapRedeem"),(0,d.u8)("unwrapRefund"),(0,d.u8)("mayanFeeNonce"),(0,d.u8)("referrerFeeNonce")]);var ci=[{type:"function",name:"batchMaxApprove",inputs:[{name:"approvals",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initiate",inputs:[{name:"recipient",type:"bytes32",internalType:"bytes32"},{name:"overrideAmountIn",type:"uint256",internalType:"uint256"},{name:"targetChain",type:"uint16",internalType:"uint16"},{name:"params",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"payable"},{type:"error",name:"ChainNotSupported",inputs:[{name:"chain",type:"uint16",internalType:"uint16"}]},{type:"error",name:"DeadlineExpired",inputs:[{name:"blocktime",type:"uint256",internalType:"uint256"},{name:"deadline",type:"uint256",internalType:"uint256"}]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"ExceedsMaxGasDropoff",inputs:[{name:"requested",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ExceedsMaxRelayingFee",inputs:[{name:"fee",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InsufficientInputAmount",inputs:[{name:"input",type:"uint256",internalType:"uint256"},{name:"minimum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidAddress",inputs:[{name:"addr",type:"bytes32",internalType:"bytes32"}]},{type:"error",name:"InvalidBoolVal",inputs:[{name:"val",type:"uint8",internalType:"uint8"}]},{type:"error",name:"InvalidOverrideAmount",inputs:[{name:"received",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapType",inputs:[{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapTypeForChain",inputs:[{name:"chain",type:"uint16",internalType:"uint16"},{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"LengthMismatch",inputs:[{name:"encodedLength",type:"uint256",internalType:"uint256"},{name:"expectedLength",type:"uint256",internalType:"uint256"}]},{type:"error",name:"RelayingDisabledForChain",inputs:[]}],li={FAST_MODE_FLAG:1,RELAY_REDEEM_MODE:2,EXACT_IN_FLAG:1,USDC_INPUT_TOKEN_TYPE:0,PRE_APPROVED_ACQUIRE_MODE:0,OUTPUT_USDC_MODE:0,OUTPUT_NATIVE_MODE:1,OUTPUT_OTHER_MODE:2};var di={abi:[{type:"constructor",inputs:[{name:"_cctpTokenMessengerV2",type:"address",internalType:"address"},{name:"_feeManager",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"bridge",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"referrerAddress",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"customPayload",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"cctpTokenMessengerV2",inputs:[],outputs:[{name:"",type:"address",internalType:"contract ITokenMessengerV2"}],stateMutability:"view"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"createOrder",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"orderPayload",type:"tuple",internalType:"struct FastMCTP.OrderPayload",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"amountOutMin",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"domainToCaller",inputs:[{name:"",type:"uint32",internalType:"uint32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"feeManager",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"fulfillOrder",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"},{name:"swapProtocol",type:"address",internalType:"address"},{name:"swapData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"keyToMintRecipient",inputs:[{name:"",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"paused",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"redeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"refund",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"rescueEth",inputs:[{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address payable"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueRedeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setDomainCallers",inputs:[{name:"domain",type:"uint32",internalType:"uint32"},{name:"caller",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeManager",inputs:[{name:"_feeManager",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setMintRecipient",inputs:[{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"tokenIn",type:"address",internalType:"address"},{name:"mintRecipient",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setPause",inputs:[{name:"_pause",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedMsgSenders",inputs:[{name:"sender",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedSwapProtocols",inputs:[{name:"protocol",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"whitelistedMsgSenders",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"whitelistedSwapProtocols",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"event",name:"OrderFulfilled",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OrderRefunded",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AlreadySet",inputs:[]},{type:"error",name:"CallerNotSet",inputs:[]},{type:"error",name:"CctpReceiveFailed",inputs:[]},{type:"error",name:"DeadlineViolation",inputs:[]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"InvalidAmountOut",inputs:[]},{type:"error",name:"InvalidGasDrop",inputs:[]},{type:"error",name:"InvalidMintRecipient",inputs:[]},{type:"error",name:"InvalidPayload",inputs:[]},{type:"error",name:"InvalidPayloadType",inputs:[]},{type:"error",name:"InvalidRedeemFee",inputs:[]},{type:"error",name:"InvalidRefundFee",inputs:[]},{type:"error",name:"MintRecipientNotSet",inputs:[]},{type:"error",name:"Paused",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]},{type:"error",name:"UnauthorizedMsgSender",inputs:[]},{type:"error",name:"UnauthorizedSwapProtocol",inputs:[]}]};function yi(e,t,n,r,a){const i=function(e,t,n,r,a){const i=ta(Number(r)),u=Xr(e.fromChain),p=Xr(e.toChain);if(u!==i)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${u} !== ${i}`);const c=qr(t,p),l=Jr(e.redeemRelayerFee,Aa),d=Jr(e.gasDrop,Math.min(aa(e.toChain),8)),y=BigInt(e.circleMaxFee64),m=BigInt(e.effectiveAmountIn64),f=Sa(e.toChain);let b;if(b=n?qr(n,p):qr(s.SystemProgram.programId.toString(),Xr("solana")),!e.fastMctpMayanContract)throw new Error("FastMctp contract address is missing");const h=e.fastMctpMayanContract;return{tokenIn:e.fastMctpInputContract,amountIn:m,redeemFee:l,gasDrop:d,destAddr:c,destDomain:f,referrerAddr:b,referrerBps:e.referrerBps,payloadType:a?ya:da,customPayload:a?`0x${o.Buffer.from(a).toString("hex")}`:"0x",minFinalityThreshold:Number(e.fastMctpMinFinality),circleMaxFee:y,contractAddress:h}}(e,t,n,r,a),{contractAddress:u,tokenIn:p,amountIn:d,destAddr:y,redeemFee:m,gasDrop:f,circleMaxFee:b,referrerAddr:h,referrerBps:g,destDomain:T,customPayload:w,minFinalityThreshold:I,payloadType:C}=i;let A,S;return A=new c.CH(u,di.abi).interface.encodeFunctionData("bridge",[p,d,m,b,f,y,T,h,g,C,I,w]),S=(0,l.m9)(0),{to:u,data:A,value:S,_params:i}}function mi(e,t,n,r){const a=function(e,t,n,r){const a=ta(Number(r)),i=Xr(e.fromChain),o=Xr(e.toChain);if(i!==a)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${i} !== ${a}`);if(!e.fastMctpMayanContract)throw new Error("MCTP contract address is missing");const u=e.fastMctpMayanContract,c=qr(t,o);let l;l=n?qr(n,o):qr(s.SystemProgram.programId.toString(),Xr("solana"));const d=Jr(e.redeemRelayerFee,Aa),y=BigInt(e.refundRelayerFee64),m=BigInt(e.circleMaxFee64),f=Jr(e.gasDrop,Math.min(aa(e.toChain),8)),b=Sa(e.toChain),h=BigInt(e.effectiveAmountIn64),g=Jr(e.minAmountOut,Math.min(8,e.toToken.decimals)),T=BigInt(e.deadline64),w=e.toToken.contract===p.N?qr(s.SystemProgram.programId.toString(),Xr("solana")):qr("sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{tokenIn:e.fastMctpInputContract,amountIn:h,circleMaxFee:m,destDomain:b,minFinalityThreshold:Number(e.fastMctpMinFinality),orderPayload:{payloadType:ma,destAddr:c,tokenOut:w,amountOutMin:g,gasDrop:f,redeemFee:d,refundFee:y,deadline:T,referrerAddr:l,referrerBps:e.referrerBps||0},contractAddress:u}}(e,t,n,r),{contractAddress:i,orderPayload:o,tokenIn:u,amountIn:d,circleMaxFee:y,destDomain:m,minFinalityThreshold:f}=a;return{to:i,data:new c.CH(i,di.abi).interface.encodeFunctionData("createOrder",[u,d,y,m,f,o]),value:(0,l.m9)(0),_params:a}}var fi={abi:[{type:"constructor",inputs:[{name:"_hcProcessor",type:"address",internalType:"address"},{name:"_usdc",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"deposit",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"trader",type:"address",internalType:"address"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"bridgeAmount",type:"uint256",internalType:"uint256"},{name:"depositPayload",type:"tuple",internalType:"struct HCDepositInitiator.DepositPayload",components:[{name:"relayerFee",type:"uint64",internalType:"uint64"},{name:"permit",type:"tuple",internalType:"struct IHCBridge.DepositWithPermit",components:[{name:"user",type:"address",internalType:"address"},{name:"usd",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"signature",type:"tuple",internalType:"struct IHCBridge.Signature",components:[{name:"r",type:"uint256",internalType:"uint256"},{name:"s",type:"uint256",internalType:"uint256"},{name:"v",type:"uint8",internalType:"uint8"}]}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"fastDeposit",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"trader",type:"address",internalType:"address"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"referrerAddress",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"bridgeAmount",type:"uint256",internalType:"uint256"},{name:"depositPayload",type:"tuple",internalType:"struct HCDepositInitiator.DepositPayload",components:[{name:"relayerFee",type:"uint64",internalType:"uint64"},{name:"permit",type:"tuple",internalType:"struct IHCBridge.DepositWithPermit",components:[{name:"user",type:"address",internalType:"address"},{name:"usd",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"signature",type:"tuple",internalType:"struct IHCBridge.Signature",components:[{name:"r",type:"uint256",internalType:"uint256"},{name:"s",type:"uint256",internalType:"uint256"},{name:"v",type:"uint8",internalType:"uint8"}]}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"fastMCTP",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mayanCircle",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"setFastMCTP",inputs:[{name:"_fastMCTP",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setMayanCircle",inputs:[{name:"_mayanCircle",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"error",name:"AlreadySet",inputs:[]},{type:"error",name:"InsufficientAmount",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]}]};var bi={abi:[{type:"constructor",inputs:[{name:"_forwarderAddress",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"ForwarderAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"MAX_REFERRER_BPS",inputs:[],outputs:[{name:"",type:"uint8",internalType:"uint8"}],stateMutability:"view"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"rescueETH",inputs:[{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"transferEth",inputs:[{name:"to",type:"address",internalType:"address"},{name:"referrerAddr",type:"address",internalType:"address"},{name:"referrerBps",type:"uint8",internalType:"uint8"}],outputs:[],stateMutability:"payable"},{type:"function",name:"transferToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"},{name:"referrerAddr",type:"address",internalType:"address"},{name:"referrerBps",type:"uint8",internalType:"uint8"}],outputs:[],stateMutability:"nonpayable"},{type:"event",name:"EthTransferred",inputs:[{name:"to",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenTransferred",inputs:[{name:"token",type:"address",indexed:!1,internalType:"address"},{name:"to",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"InvalidReferrerBps",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]}]};function hi(e,t,n,r,a,i,u,d,y){const m=ta(Number(i)),f=Xr(e.fromChain);if(f!==m)throw new Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${f} !== ${m}`);const b=ua(e,r);if("hypercore"===e.toChain)return function(e,t,n,r,a,i,u,d={}){if(e.toToken.contract.toLowerCase()!==Lr.ARBITRUM_USDC_CONTRACT.toLowerCase()||"MCTP"!==e.type&&"FAST_MCTP"!==e.type)throw new Error("Unsupported quote type for USDC deposit: "+e.type);if(!d?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(u)throw new Error("HyperCore deposit does not support payload");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");const y=ta(Number(a)),m=Xr(e.fromChain);if(m!==y)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${m} !== ${y}`);const f=i||oa,b=new c.CH(Lr.MAYAN_FORWARDER_CONTRACT,Ia.abi);let h;if(!Number(e.deadline64))throw new Error("HyperCore deposit requires timeout");if("MCTP"===e.type)h=function(e,t,n,r){if(!e.hyperCoreParams.initiateContractAddress)throw new Error("HyperCore initiate contract address is missing");if("MCTP"!==e.type)throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);const a=new c.CH(e.hyperCoreParams.initiateContractAddress,fi.abi),i=o.Buffer.from(Yr(r));if(65!==i.length)throw new Error("Invalid USDC permit signature length");const s="0x"+i.subarray(0,32).toString("hex"),u="0x"+i.subarray(32,64).toString("hex"),p=i[64];let d,y;return d=a.interface.encodeFunctionData("deposit",[e.hyperCoreParams.initiateTokenContract,BigInt(e.hyperCoreParams.bridgeAmountUSDC64),t,Jr(e.hyperCoreParams.failureGasDrop,Math.min(aa("arbitrum"),8)),BigInt(e.hyperCoreParams.bridgeAmountUSDC64),{relayerFee:Jr(e.redeemRelayerFee,Aa),permit:{user:n,usd:BigInt(e.hyperCoreParams.depositAmountUSDC64),deadline:BigInt(e.deadline64),signature:{r:s,s:u,v:p}}}]),y=(0,l.m9)(0),{to:e.hyperCoreParams.initiateContractAddress,data:d,value:y,_params:{amountIn:BigInt(e.hyperCoreParams.bridgeAmountUSDC64),contractAddress:e.hyperCoreParams.initiateContractAddress}}}(e,t,n,d.usdcPermitSignature);else{if("FAST_MCTP"!==e.type)throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);h=function(e,t,n,r,a){const i=Xr("arbitrum");if(!e.hyperCoreParams.initiateContractAddress)throw new Error("HyperCore initiate contract address is missing");if("FAST_MCTP"!==e.type)throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);const u=new c.CH(e.hyperCoreParams.initiateContractAddress,fi.abi),p=o.Buffer.from(Yr(a));if(65!==p.length)throw new Error("Invalid USDC permit signature length");const d="0x"+p.subarray(0,32).toString("hex"),y="0x"+p.subarray(32,64).toString("hex"),m=p[64];let f,b,h;return f=r?qr(r,i):qr(s.SystemProgram.programId.toString(),Xr("solana")),b=u.interface.encodeFunctionData("fastDeposit",[e.hyperCoreParams.initiateTokenContract,BigInt(e.hyperCoreParams.bridgeAmountUSDC64),t,BigInt(e.circleMaxFee64),Jr(e.hyperCoreParams.failureGasDrop,Math.min(aa("arbitrum"),8)),f,e.referrerBps,Number(e.fastMctpMinFinality),BigInt(e.hyperCoreParams.bridgeAmountUSDC64),{relayerFee:Jr(e.redeemRelayerFee,Aa),permit:{user:n,usd:BigInt(e.hyperCoreParams.depositAmountUSDC64),deadline:BigInt(e.deadline64),signature:{r:d,s:y,v:m}}}]),h=(0,l.m9)(0),{to:e.hyperCoreParams.initiateContractAddress,data:b,value:h,_params:{amountIn:BigInt(e.hyperCoreParams.bridgeAmountUSDC64),contractAddress:e.hyperCoreParams.initiateContractAddress}}}(e,t,n,r,d.usdcPermitSignature)}if(e.fromToken.contract.toLowerCase()===e.hyperCoreParams.initiateTokenContract.toLowerCase()){const t="forwardERC20",n=[e.fromToken.contract,BigInt(e.effectiveAmountIn64),f,h._params.contractAddress,h.data];return{data:b.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:a,_forwarder:{method:t,params:n}}}{const{evmSwapRouterAddress:t,evmSwapRouterCalldata:n}=e;if(!e.minMiddleAmount||!t||!n)throw new Error("Fast Mctp swap requires middle amount, router address and calldata");const r=Jr(e.minMiddleAmount,Aa);if(e.fromToken.contract===p.N){const i="swapAndForwardEth",s=[BigInt(e.effectiveAmountIn64),t,n,e.hyperCoreParams.initiateTokenContract,r,h._params.contractAddress,h.data];return{data:b.interface.encodeFunctionData(i,s),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(BigInt(e.effectiveAmountIn64)),chainId:a,_forwarder:{method:i,params:s}}}{const i="swapAndForwardERC20",s=[e.fromToken.contract,BigInt(e.effectiveAmountIn64),f,t,n,e.hyperCoreParams.initiateTokenContract,r,h._params.contractAddress,h.data];return{data:b.interface.encodeFunctionData(i,s),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:a,_forwarder:{method:i,params:s}}}}}(e,t,n,b,i,d,u,y);if("MCTP"===e.type)return function(e,t,n,r,a,i){if("MCTP"!==e.type)throw new Error("Quote type is not MCTP");if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");r=Number(r);const s=a||oa,o=new c.CH(Lr.MAYAN_FORWARDER_CONTRACT,Ia.abi),u=Jr(e.bridgeFee,aa(e.fromChain));let d=(0,l.m9)(u);if(e.fromToken.contract===e.mctpInputContract){if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");const a=va(e,t,n,r),i="forwardERC20",u=[e.fromToken.contract,a._params.params.amountIn,s,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(i,u),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(d),chainId:r,_forwarder:{method:i,params:u}}}{const n=Ma(e,t,r,i),a="forwardERC20",u=[e.fromToken.contract,n._params.amountIn,s,n._params.contractAddress,n.data];return{data:o.interface.encodeFunctionData(a,u),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(d),chainId:r,_forwarder:{method:a,params:u}}}}{const{minMiddleAmount:a,evmSwapRouterAddress:c,evmSwapRouterCalldata:y}=e;if(!a||!c||!y)throw new Error("MCTP swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");const a=va(e,t,n,r),i=Jr(e.minMiddleAmount,Aa);if(e.fromToken.contract===p.N){let t=a._params.params.amountIn;if(t<=u)throw new Error("Amount in is less than bridge fee");u!==BigInt(0)&&(t-=u),d=(0,l.m9)(a._params.params.amountIn);const n="swapAndForwardEth",s=[t,c,y,e.mctpInputContract,i,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(n,s),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(d),chainId:r,_forwarder:{method:n,params:s}}}{const t="swapAndForwardERC20",n=[e.fromToken.contract,a._params.params.amountIn,s,c,y,e.mctpInputContract,i,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(d),chainId:r,_forwarder:{method:t,params:n}}}}{const n=Ma(e,t,r,i),a=Jr(e.minMiddleAmount,Aa);if(e.fromToken.contract===p.N){let t=n._params.amountIn;if(t<=u)throw new Error("Amount in is less than bridge fee");u!==BigInt(0)&&(t-=u),d=(0,l.m9)(n._params.amountIn);const i="swapAndForwardEth",s=[t,c,y,e.mctpInputContract,a,n._params.contractAddress,n.data];return{data:o.interface.encodeFunctionData(i,s),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(d),chainId:r,_forwarder:{method:i,params:s}}}{const t="swapAndForwardERC20",i=[e.fromToken.contract,n._params.amountIn,s,c,y,e.mctpInputContract,a,n._params.contractAddress,n.data];return{data:o.interface.encodeFunctionData(t,i),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(d),chainId:r,_forwarder:{method:t,params:i}}}}}}(e,n,b,i,d,u);if("SWIFT"===e.type)return function(e,t,n,r,a,i){if("SWIFT"!==e.type)throw new Error("Quote type is not SWIFT");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");a=Number(a);const o=i||oa,u=new c.CH(Lr.MAYAN_FORWARDER_CONTRACT,Ia.abi),{tokenIn:d,amountIn:y,order:m,contractAddress:f}=function(e,t,n,r,a){const i=ta(Number(a)),o=Xr(e.fromChain),u=Xr(e.toChain);if(o!==i)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${o} !== ${i}`);if(!e.swiftMayanContract)throw new Error("SWIFT contract address is missing");if(e.toToken.wChainId!==u)throw new Error(`Destination chain ID mismatch: ${u} != ${e.toToken.wChainId}`);const c=e.swiftMayanContract;if(!Number(e.deadline64))throw new Error("Swift order requires timeout");const l=BigInt(e.deadline64),d=e.swiftInputContract,y=BigInt(e.effectiveAmountIn64);let m;m=r?qr(r,u):qr(s.SystemProgram.programId.toString(),1);const f=qr(s.Keypair.generate().publicKey.toString(),1),b=e.toToken.contract===p.N?qr(s.SystemProgram.programId.toString(),1):qr(e.toToken.contract,u),h=Jr(e.minAmountOut,Math.min(8,e.toToken.decimals)),g=Jr(e.gasDrop,Math.min(8,aa(e.toChain))),T=qr(n,u);return{contractAddress:c,tokenIn:d,amountIn:y,order:{trader:qr(t,o),tokenOut:b,minAmountOut:h,gasDrop:g,cancelFee:BigInt(e.cancelRelayerFee64),refundFee:BigInt(e.refundRelayerFee64),deadline:l,destAddr:T,destChainId:u,referrerAddr:m,referrerBps:e.referrerBps||0,auctionMode:e.swiftAuctionMode,random:f}}}(e,t,n,r,a);let b;const h=new c.CH(f,_a);let g,T,w;if(b=e.swiftInputContract===p.N?h.interface.encodeFunctionData("createOrderWithEth",[m]):h.interface.encodeFunctionData("createOrderWithToken",[d,y,m]),e.fromToken.contract===e.swiftInputContract)e.fromToken.contract===p.N?(g="forwardEth",T=[f,b],w=(0,l.m9)(y)):(g="forwardERC20",T=[d,y,o,f,b],w=(0,l.m9)(0));else{const{evmSwapRouterAddress:t,evmSwapRouterCalldata:n}=e;if(!e.minMiddleAmount||!t||!n)throw new Error("Swift swap requires middle amount, router address and calldata");const r=e.fromToken.contract,a=Jr(e.minMiddleAmount,e.swiftInputDecimals);e.fromToken.contract===p.N?(g="swapAndForwardEth",T=[y,t,n,e.swiftInputContract,a,f,b],w=(0,l.m9)(y)):(g="swapAndForwardERC20",T=[r,y,o,t,n,e.swiftInputContract,a,f,b],w=(0,l.m9)(0))}return{data:u.interface.encodeFunctionData(g,T),to:Lr.MAYAN_FORWARDER_CONTRACT,value:w,chainId:a,_forwarder:{method:g,params:T}}}(e,t,n,b,i,d);if("SHUTTLE"===e.type)return function(e,t,n,r){if("SHUTTLE"!==e.type)throw new Error("Quote type is not SHUTTLE");if(!Number.isFinite(Number(n)))throw new Error("Invalid signer chain id");n=Number(n);const a=r||oa,i=new c.CH(Lr.MAYAN_FORWARDER_CONTRACT,Ia.abi),{destAddr:s,destChainId:u,serializedParams:d,contractAddress:y,amountIn:m,bridgeFee:f}=function(e,t,n){const{shuttleParams:r}=e;if(!r)throw new Error("Swap layer params are missing in quote response");const a=ta(Number(n)),i=Xr(e.fromChain),s=Xr(e.toChain);if(i!==a)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${i} !== ${a}`);let u=[];u.push(li.FAST_MODE_FLAG);const c=o.Buffer.alloc(8);c.writeBigUInt64BE(BigInt(r.maxLLFee));const l=c.subarray(2);u.push(...l);const d=o.Buffer.alloc(4);d.writeUInt32BE(r.fastTransferDeadline),u.push(...d),u.push(li.RELAY_REDEEM_MODE);const y=Jr(e.gasDrop,Math.min(6,aa(e.toChain))),m=o.Buffer.alloc(8);m.writeBigUInt64BE(y);const f=m.subarray(4);u.push(...f);const b=o.Buffer.alloc(8);b.writeBigUInt64BE(BigInt(r.maxRelayingFee));const h=b.subarray(2);u.push(...h),u.push(li.EXACT_IN_FLAG),u.push(li.USDC_INPUT_TOKEN_TYPE);const g=BigInt(e.effectiveAmountIn64);if(e.fromToken.contract===e.shuttleInputContract){u.push(...Array(8).fill(0));const e=o.Buffer.alloc(8);e.writeBigUInt64BE(g),u.push(...e)}else u.push(...Array(16).fill(0));if(u.push(li.PRE_APPROVED_ACQUIRE_MODE),r.hasDestSwap){if(e.toToken.contract===p.N)u.push(li.OUTPUT_NATIVE_MODE);else{u.push(li.OUTPUT_OTHER_MODE);const t=o.Buffer.from(qr(e.toToken.contract,s).slice(2),"hex");u.push(...t)}const t=o.Buffer.alloc(4);t.writeUInt32BE(Number(BigInt(e.deadline64))),u.push(...t);const n=Jr(e.minAmountOut,e.toToken.decimals);if("solana"===e.toChain){u.push(...Array(8).fill(0));const e=o.Buffer.alloc(8);e.writeBigUInt64BE(n),u.push(...e)}else{const e=function(e){if(e<0n||e>(1n<<128n)-1n)throw new RangeError("Value must fit in an unsigned 128-bit integer (0 <= value < 2^128)");const t=o.Buffer.alloc(16);for(let n=15;n>=0;n--)t[n]=Number(0xFFn&e),e>>=8n;return t}(n);u.push(...e)}const a=o.Buffer.from(r.path.slice(2),"hex");u.push(...a)}else u.push(li.OUTPUT_USDC_MODE);return{destAddr:qr(t,s),destChainId:s,serializedParams:`0x${o.Buffer.from(u).toString("hex")}`,contractAddress:e.shuttleContract,amountIn:g,bridgeFee:Jr(e.bridgeFee,aa(e.fromChain))}}(e,t,n);let b,h,g,T;if(b=new c.CH(y,ci).interface.encodeFunctionData("initiate",[s,m,u,d]),e.fromToken.contract===e.shuttleInputContract)h="forwardERC20",g=[e.shuttleInputContract,m,a,y,b],T=(0,l.m9)(f);else{const{evmSwapRouterAddress:t,evmSwapRouterCalldata:n}=e;if(!e.minMiddleAmount||!t||!n)throw new Error("Shuttle source chain swap requires middle amount, router address and calldata");const r=e.fromToken.contract,i=Jr(e.minMiddleAmount,e.shuttleInputDecimals);e.fromToken.contract===p.N?(h="swapAndForwardEth",g=[m,t,n,e.shuttleInputContract,i,y,b],T=(0,l.m9)(m)):(h="swapAndForwardERC20",g=[r,m,a,t,n,e.shuttleInputContract,i,y,b],T=(0,l.m9)(f))}return{data:i.interface.encodeFunctionData(h,g),to:Lr.MAYAN_FORWARDER_CONTRACT,value:T,chainId:n,_forwarder:{method:h,params:g}}}(e,n,i,d);if("FAST_MCTP"===e.type)return function(e,t,n,r,a,i){if("FAST_MCTP"!==e.type)throw new Error("Quote type is not FAST_MCTP");if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");r=Number(r);const s=a||oa,o=new c.CH(Lr.MAYAN_FORWARDER_CONTRACT,Ia.abi);if(e.fromToken.contract===e.fastMctpInputContract){if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");const a=mi(e,t,n,r),i="forwardERC20",u=[e.fromToken.contract,a._params.amountIn,s,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(i,u),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:r,_forwarder:{method:i,params:u}}}{const a=yi(e,t,n,r,i),u="forwardERC20",p=[e.fromToken.contract,a._params.amountIn,s,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(u,p),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:r,_forwarder:{method:u,params:p}}}}{const{minMiddleAmount:a,evmSwapRouterAddress:u,evmSwapRouterCalldata:c}=e;if(!a||!u||!c)throw new Error("Fast Mctp swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");const a=mi(e,t,n,r),i=Jr(e.minMiddleAmount,Aa);if(e.fromToken.contract===p.N){const t="swapAndForwardEth",n=[a._params.amountIn,u,c,e.fastMctpInputContract,i,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(a._params.amountIn),chainId:r,_forwarder:{method:t,params:n}}}{const t="swapAndForwardERC20",n=[e.fromToken.contract,a._params.amountIn,s,u,c,e.fastMctpInputContract,i,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:r,_forwarder:{method:t,params:n}}}}{const a=yi(e,t,n,r,i),d=Jr(e.minMiddleAmount,Aa);if(e.fromToken.contract===p.N){const t="swapAndForwardEth",n=[a._params.amountIn,u,c,e.fastMctpInputContract,d,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(a._params.amountIn),chainId:r,_forwarder:{method:t,params:n}}}{const t="swapAndForwardERC20",n=[e.fromToken.contract,a._params.amountIn,s,u,c,e.fastMctpInputContract,d,a._params.contractAddress,a.data];return{data:o.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:r,_forwarder:{method:t,params:n}}}}}}(e,n,b,i,d,u);if("MONO_CHAIN"===e.type)return function(e,t,n,r,a){if("MONO_CHAIN"!==e.type)throw new Error("Quote type is not MONO_CHAIN");if(e.fromChain!==e.toChain)throw new Error("Quote chains are not equal");if(e.fromToken.contract.toLowerCase()===e.toToken.contract.toLowerCase())throw new Error(`From token and to token are the same: ${e.fromToken.contract}`);if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");const i=ta(Number(r)),s=Xr(e.fromChain);if(s!==i)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${s} !== ${i}`);r=Number(r);const o=a||oa,u=new c.CH(Lr.MAYAN_FORWARDER_CONTRACT,Ia.abi),{evmSwapRouterAddress:d,evmSwapRouterCalldata:y}=e;if(!d||!y)throw new Error("Mono chain swap requires router address and calldata");const m=function(e,t,n){const r=Jr(e.expectedAmountOut,e.toToken.decimals),a=new c.CH(e.monoChainMayanContract,bi.abi),i=n&&e.referrerBps||0;let s,o;return s=e.toToken.contract===p.N?a.interface.encodeFunctionData("transferEth",[t,n||p.N,i]):a.interface.encodeFunctionData("transferToken",[e.toToken.contract,r,t,n||p.N,i]),o=e.fromToken.contract===p.N?(0,l.m9)(e.effectiveAmountIn64):(0,l.m9)(0),{to:e.monoChainMayanContract,data:s,value:o,_params:{amountIn:BigInt(e.effectiveAmountIn64),tokenIn:e.fromToken.contract}}}(e,t,n),f=Jr(e.minAmountOut,e.toToken.decimals);if(e.fromToken.contract===p.N){const t="swapAndForwardEth",n=[m._params.amountIn,d,y,e.toToken.contract,f,e.monoChainMayanContract,m.data];return{data:u.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(m._params.amountIn),chainId:r,_forwarder:{method:t,params:n}}}{const t="swapAndForwardERC20",n=[e.fromToken.contract,m._params.amountIn,o,d,y,e.toToken.contract,f,e.monoChainMayanContract,m.data];return{data:u.interface.encodeFunctionData(t,n),to:Lr.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:r,_forwarder:{method:t,params:n}}}}(e,n,b,i,d);if("WH"!=e.type)throw new Error("Unsupported quote type");if(!Number(e.deadline64))throw new Error("WH mode requires a timeout");const{relayerFees:h,recipient:g,tokenOut:T,tokenOutWChainId:w,criteria:I,tokenIn:C,amountIn:A,contractAddress:S,bridgeFee:k}=function(e,t,n,r,a,i){const u=new s.PublicKey(Lr.MAYAN_PROGRAM_ID),[c]=s.PublicKey.findProgramAddressSync([o.Buffer.from("MAIN")],u),l=Qr(new s.PublicKey(e.fromToken.mint),c,!0),d=BigInt(e.effectiveAmountIn64),y=qr(l.toString(),1),m=qr(Lr.AUCTION_PROGRAM_ID,1);let f;f=qr(n||s.SystemProgram.programId.toString(),1);const b=ta(Number(a)),h=Xr(e.fromChain),g=Xr(e.toChain);if(h!==b)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${h} !== ${b}`);const T=e.whMayanContract,w={mayanAddr:y,mayanChainId:1,destAddr:qr(t,g),destChainId:g,auctionAddr:m,referrer:f,refundAddr:qr(r,b)},I=e.toToken.contract===p.N,C={transferDeadline:BigInt(e.deadline64),swapDeadline:BigInt(e.deadline64),amountOutMin:Jr(e.minAmountOut,Math.min(8,e.toToken.decimals)),gasDrop:Jr(e.gasDrop,Math.min(8,aa(e.toChain))),unwrap:I,customPayload:i?`0x${o.Buffer.from(i).toString("hex")}`:"0x"},A={swapFee:Jr(e.swapRelayerFee,Math.min(8,e.fromToken.decimals)),redeemFee:Jr(e.redeemRelayerFee,Math.min(8,e.toToken.decimals)),refundFee:Jr(e.refundRelayerFee,Math.min(8,e.fromToken.decimals))},S=qr(e.toToken.realOriginContractAddress,e.toToken.realOriginChainId),k=Jr(e.bridgeFee,18);return{amountIn:d,tokenIn:e.fromToken.contract,tokenOut:S,tokenOutWChainId:e.toToken.realOriginChainId,criteria:C,recipient:w,relayerFees:A,contractAddress:T,bridgeFee:k}}(e,n,b,a,i,u),M=new c.CH(Lr.MAYAN_FORWARDER_CONTRACT,Ia.abi),v=new c.CH(S,wa);let _,O,P;const E=d||oa;C===p.N?(_="forwardEth",O=[S,v.interface.encodeFunctionData("wrapAndSwapETH",[h,g,T,w,I])],P=(0,l.m9)(A)):(_="forwardERC20",O=[C,A,E,S,v.interface.encodeFunctionData("swap",[h,g,T,w,I,C,A])],P=(0,l.m9)(k));const R=M.interface.encodeFunctionData(_,O);return{to:Lr.MAYAN_FORWARDER_CONTRACT,data:R,value:P,chainId:i,_forwarder:{method:_,params:O}}}async function gi(e,t){let n;try{n=await t.getMoveFunctionArgTypes({package:e.package,module:e.module,function:e.function})}catch(t){throw new Error(`Failed to fetch ${e.package}::${e.module}::${e.function} ArgTypes`)}if(!n)throw new Error(`Failed to fetch package::${e.module}::${e.function} ArgTypes`);if("Pure"!==n[e.argumentIndex]&&"ByImmutableReference"!==n[e.argumentIndex]?.Object)throw new Error(`Argument ${e.argumentIndex} of ${e.module}::${e.function} is not immutable`)}async function Ti(e,t){let n,r=[],a=BigInt(0);for(;;){const i=await t.getCoins({...e,owner:e.walletAddress,cursor:n}),s=i.data.filter((e=>BigInt(e.balance)>BigInt(0)));if(r=[...r,...s],s.forEach((e=>{a+=BigInt(e.balance)})),0===i.data.length||!i.hasNextPage||!i.nextCursor||a>=e.coinAmount)return{coins:r.sort(((e,t)=>Number(BigInt(e.coinObjectId)-BigInt(t.coinObjectId)))),sum:a};n=i.nextCursor}}async function wi(e,t){let n;try{n=await t.getObject({id:e,options:{showContent:!0}})}catch(e){throw new Error(`Failed to fetch Mayan Sui package ID: \n\n ${e}`)}if(n.data?.content?.fields?.latest_package_id)return n.data.content.fields.latest_package_id;throw new Error("latest_package_id not found in Mayan Sui state object")}async function Ii(e,t,n,r,a,i){let s;if(i?.result)s=i.result;else if(i?.objectId)s=a.object(i.objectId);else{const{coins:i,sum:o}=await Ti({walletAddress:t,coinType:n,coinAmount:e},r);if(o<e)throw new Error(`Insufficient funds to create Coin ${n} with amount ${e}`);i.length>1&&a.mergeCoins(i[0].coinObjectId,i.slice(1).map((e=>e.coinObjectId)));const[u]=a.splitCoins(i[0].coinObjectId,[e]);s=u}return s}async function Ci(e,t,n,r,a,i){let s;if(i?.result)s=i.result;else if(i?.objectId)s=e.object(i.objectId);else if(r>BigInt(0)){const{coins:t,sum:i}=await Ti({walletAddress:a,coinType:rn,coinAmount:r},n);if(i<r)throw new Error("Insufficient funds to pay Wormhole message fee");t.length>1&&e.mergeCoins(t[0].coinObjectId,t.slice(1).map((e=>e.coinObjectId)));const[o]=e.splitCoins(t[0].coinObjectId,[r]);s=o}else{const[t]=e.splitCoins(e.gas,[e.pure.u64(0)]);s=t}return e.moveCall({package:Lr.SUI_WORMHOLE_PACKAGE_ID,module:"publish_message",function:"publish_message",arguments:[e.object(Lr.SUI_WORMHOLE_STATE),s,t,e.object(nn)]}),e}async function Ai(e){const{swapperAddress:t,destinationAddress:n,mctpPackageId:r,payload:a,suiClient:i,options:s}=e,o=Xr(e.toChain),u=s?.builtTransaction??new Gr,p=Jr(e.minMiddleAmount,Aa),c=await Ii(p,t,e.mctpInputContract,i,u,s?.inputCoin),l=a?ca:pa,d=qr(n,o),y=Sa(e.toChain),m=Jr(e.gasDrop,Math.min(aa(e.toChain),8)),f=Jr(e.redeemRelayerFee,Aa),b=a?Uint8Array.from(a):Uint8Array.from([]),[h]=u.moveCall({package:r,module:"bridge_with_fee",function:"prepare_bridge_with_fee",typeArguments:[e.mctpInputContract],arguments:[u.pure.u8(l),c,u.pure.u64(p),u.pure.address(d),u.pure.u32(y),u.pure.u64(m),u.pure.u64(f),u.pure.vector("u8",b)]}),[g,T]=u.moveCall({package:r,module:"bridge_with_fee",function:"bridge_with_fee",typeArguments:[e.mctpInputContract],arguments:[u.object(Lr.SUI_MCTP_STATE),u.object(Lr.SUI_CCTP_CORE_STATE),u.object(e.mctpVerifiedInputAddress),h]}),[w,I]=u.moveCall({package:Lr.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${r}::bridge_with_fee::CircleAuth`],arguments:[T,u.object(Lr.SUI_CCTP_TOKEN_STATE),u.object(Lr.SUI_CCTP_CORE_STATE),u.object("0x403"),u.object(e.mctpInputTreasury)]}),[C]=u.moveCall({package:r,module:"bridge_with_fee",function:"publish_bridge_with_fee",arguments:[u.object(Lr.SUI_MCTP_STATE),g,I]});return await Ci(u,C,i,BigInt(e.bridgeFee),t,s?.whFeeCoin),u}async function Si(e,t,n,r,a,o,u){const c=ua(e,r);if("hypercore"===e.toChain){if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(!u?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if("MCTP"!==e.type)throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);if(a)throw new Error("Payload is not supported for HyperCore deposit quotes");return async function(e,t,n,r,a,o){if(e.toToken.contract.toLowerCase()!==Lr.ARBITRUM_USDC_CONTRACT.toLowerCase()||"MCTP"!==e.type)throw new Error("Unsupported quote type for USDC deposit: "+e.type);if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(!o?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if(!Number(e.deadline64))throw new Error("HyperCore deposit requires timeout");const[u]=await Promise.all([wi(Lr.SUI_MCTP_STATE,a)]);let p,c,l;if(Jr(e.minMiddleAmount,Aa),e.fromToken.contract===e.hyperCoreParams.initiateTokenContract)p=o?.builtTransaction??new Gr,c=await Ii(BigInt(e.hyperCoreParams.bridgeAmountUSDC64),t,e.mctpInputContract,a,p,o?.inputCoin);else{const{tx:n,outCoin:a,whFeeCoin:i}=await Ta({amountIn64:e.effectiveAmountIn64,inputCoinType:e.fromToken.contract,middleCoinType:e.hyperCoreParams.initiateTokenContract,userWallet:t,withWhFee:!0,referrerAddress:r,inputCoin:o?.inputCoin,transaction:o?.builtTransaction?await o.builtTransaction.toJSON():void 0});p=Gr.from(n);const[s]=p.splitCoins(a,[BigInt(e.hyperCoreParams.bridgeAmountUSDC64)]);p.transferObjects([a],p.pure.address(t)),c=s,l=i?{result:i}:null}const d=fa(e,n,o.usdcPermitSignature);var y,m;await Ai({swapperAddress:t,destinationAddress:Lr.HC_ARBITRUM_DEPOSIT_PROCESSOR,mctpPackageId:u,toChain:"arbitrum",minMiddleAmount:(y=e.hyperCoreParams.bridgeAmountUSDC64,m=Aa,Number((0,i.bM)(y,m))),bridgeFee:e.bridgeFee,gasDrop:e.hyperCoreParams.failureGasDrop,mctpInputContract:e.mctpInputContract,mctpInputTreasury:e.mctpInputTreasury,mctpVerifiedInputAddress:e.mctpVerifiedInputAddress,redeemRelayerFee:0,payload:d,suiClient:a,options:{inputCoin:{result:c},whFeeCoin:l,builtTransaction:p}});const f=BigInt(e.effectiveAmountIn64),b=Uint8Array.from(d);p.moveCall({package:u,module:"init_order",function:"log_initialize_mctp",typeArguments:[e.fromToken.contract],arguments:[p.pure.u64(f),p.object(e.fromToken.verifiedAddress),p.pure.vector("u8",b)]});try{let t;t=r?qr(r,Xr(e.toChain)):qr(s.SystemProgram.programId.toString(),Xr("solana")),p.moveCall({package:Lr.SUI_LOGGER_PACKAGE_ID,module:"referrer_logger",function:"log_referrer",arguments:[p.pure.address(t),p.pure.u8(e.referrerBps||0)]})}catch(e){console.error("Failed to log referrer",e)}return p}(e,t,n,c,o,u)}if("MCTP"===e.type)return async function(e,t,n,r,a,i,o){const[u,c]=await Promise.all([wi(Lr.SUI_MCTP_STATE,i),e.hasAuction?wi(Lr.SUI_MCTP_FEE_MANAGER_STATE,i):null]),l=Jr(e.minMiddleAmount,Aa);let d,y,m;if(e.fromToken.contract===e.mctpInputContract)d=o?.builtTransaction??new Gr,y=await Ii(l,t,e.mctpInputContract,i,d,o?.inputCoin);else{const{tx:n,outCoin:a,whFeeCoin:i}=await Ta({amountIn64:e.effectiveAmountIn64,inputCoinType:e.fromToken.contract,middleCoinType:e.mctpInputContract,userWallet:t,withWhFee:e.hasAuction||"sui"!==e.cheaperChain,referrerAddress:r,inputCoin:o?.inputCoin,transaction:o?.builtTransaction?await o.builtTransaction.toJSON():void 0});d=Gr.from(n),y=a,m=i?{result:i}:null}e.hasAuction?await async function(e,t,n,r,a,i,o,u){const c=Xr(e.toChain),l=u?.builtTransaction??new Gr,d=Jr(e.minMiddleAmount,Aa),[y]=await Promise.all([Ii(d,t,e.mctpInputContract,o,l,u?.inputCoin),gi({package:i,module:"calculate_mctp_fee",function:"prepare_calc_mctp_fee",argumentIndex:3},o)]),m=e.toToken.contract===p.N?qr(s.SystemProgram.programId.toString(),Xr("solana")):qr(e.toToken.contract,e.toToken.wChainId),f=Jr(e.minAmountOut,Math.min(8,e.toToken.decimals)),b=qr(n,c),h=Sa(e.toChain),g=Jr(e.gasDrop,Math.min(aa(e.toChain),8)),T=Jr(e.redeemRelayerFee,Aa),w=BigInt(e.deadline64);let I;I=r?qr(r,c):qr(s.SystemProgram.programId.toString(),Xr("solana"));const C=[l.object(e.mctpVerifiedInputAddress),l.pure.u8(la),l.pure.address(t),y,l.pure.address(b),l.pure.u16(c),l.pure.address(m),l.pure.u64(f),l.pure.u64(g),l.pure.u64(T),l.pure.u64(w),l.pure.address(I),l.pure.u8(e.referrerBps)],[A]=l.moveCall({package:i,module:"calculate_mctp_fee",function:"prepare_calc_mctp_fee",typeArguments:[e.mctpInputContract],arguments:C}),[S]=l.moveCall({package:i,module:"calculate_mctp_fee",function:"calculate_mctp_fee",arguments:[l.object(Lr.SUI_MCTP_FEE_MANAGER_STATE),A]}),[k]=l.moveCall({package:a,module:"init_order",function:"prepare_initialize_order",typeArguments:[e.mctpInputContract],arguments:[...C.slice(1),l.pure.u32(h),l.pure.u64(d)]}),[M,v]=l.moveCall({package:a,module:"init_order",function:"initialize_order",typeArguments:[e.mctpInputContract],arguments:[l.object(Lr.SUI_MCTP_STATE),l.object(Lr.SUI_CCTP_CORE_STATE),l.object(e.mctpVerifiedInputAddress),k,S]}),[_,O]=l.moveCall({package:Lr.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${a}::init_order::CircleAuth`],arguments:[v,l.object(Lr.SUI_CCTP_TOKEN_STATE),l.object(Lr.SUI_CCTP_CORE_STATE),l.object("0x403"),l.object(e.mctpInputTreasury)]}),[P]=l.moveCall({package:a,module:"init_order",function:"publish_init_order",arguments:[l.object(Lr.SUI_MCTP_STATE),M,O]});return await Ci(l,P,o,BigInt(e.bridgeFee),t,u?.whFeeCoin),l}(e,t,n,r,u,c,i,{inputCoin:{result:y},whFeeCoin:m,builtTransaction:d}):"sui"===e.cheaperChain?await async function(e,t,n,r,a,i){const s=Xr(e.toChain),o=i?.builtTransaction??new Gr,u=Jr(e.minMiddleAmount,Aa),p=await Ii(u,t,e.mctpInputContract,a,o,i?.inputCoin),c=qr(n,s),l=Sa(e.toChain),d=Jr(e.gasDrop,Math.min(aa(e.toChain),8)),y=Jr(e.redeemRelayerFee,Aa),[m]=o.moveCall({package:r,module:"bridge_locked_fee",function:"prepare_bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[p,o.pure.u64(u),o.pure.address(c),o.pure.u32(l),o.pure.u64(d),o.pure.u64(y)]}),[f,b]=o.moveCall({package:r,module:"bridge_locked_fee",function:"bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[o.object(Lr.SUI_MCTP_STATE),o.object(Lr.SUI_CCTP_CORE_STATE),o.object(e.mctpVerifiedInputAddress),m]}),[h,g]=o.moveCall({package:Lr.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${r}::bridge_locked_fee::CircleAuth`],arguments:[b,o.object(Lr.SUI_CCTP_TOKEN_STATE),o.object(Lr.SUI_CCTP_CORE_STATE),o.object("0x403"),o.object(e.mctpInputTreasury)]});return o.moveCall({package:r,module:"bridge_locked_fee",function:"store_bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[o.object(Lr.SUI_MCTP_STATE),o.object(e.mctpVerifiedInputAddress),f,g]}),o}(e,t,n,u,i,{inputCoin:{result:y},whFeeCoin:m,builtTransaction:d}):await async function(e,t,n,r,a,i,s){return Ai({swapperAddress:t,destinationAddress:n,toChain:e.toChain,minMiddleAmount:e.minMiddleAmount,mctpPackageId:r,mctpInputContract:e.mctpInputContract,gasDrop:e.gasDrop,redeemRelayerFee:e.redeemRelayerFee,mctpVerifiedInputAddress:e.mctpVerifiedInputAddress,mctpInputTreasury:e.mctpInputTreasury,bridgeFee:e.bridgeFee,payload:a,suiClient:i,options:s})}(e,t,n,u,a,i,{inputCoin:{result:y},whFeeCoin:m,builtTransaction:d});const f=BigInt(e.effectiveAmountIn64),b=a?Uint8Array.from(a):Uint8Array.from([]);d.moveCall({package:u,module:"init_order",function:"log_initialize_mctp",typeArguments:[e.fromToken.contract],arguments:[d.pure.u64(f),d.object(e.fromToken.verifiedAddress),d.pure.vector("u8",b)]});try{let t;t=r?qr(r,Xr(e.toChain)):qr(s.SystemProgram.programId.toString(),Xr("solana")),d.moveCall({package:Lr.SUI_LOGGER_PACKAGE_ID,module:"referrer_logger",function:"log_referrer",arguments:[d.pure.address(t),d.pure.u8(e.referrerBps||0)]})}catch(e){console.error("Failed to log referrer",e)}return d}(e,t,n,c,a,o,u);throw new Error("Unsupported quote type from Sui chain")}var ki=n(331802),Mi=n(329039),vi=n(674588),_i=n(963096),Oi=n(736978),Pi=n(890819),Ei=n(889672),Ri=n(351384),Di=n(1564),ji=(n(385469),n(525360)),Bi=n(601431),Fi=n(956286),xi=n(834348),Ni=n(404452),Ui=n(458173),Wi=n(530303),$i=n(213839),Ki=n(938694);const Vi={Solana:"solana",Ethereum:"ethereum",Bsc:"bsc",Polygon:"polygon",Avalanche:"avalanche",Arbitrum:"arbitrum",Aptos:"aptos",Base:"base",Optimism:"optimism",Unichain:"unichain",Sui:"sui"},Gi={Solana:"solana",Sepolia:"ethereum",BaseSepolia:"base",Sui:"sui",Monad:"monad"};function Li(e,t){if("Mainnet"===e){if(!Vi[t])throw new Error(`Chain ${t} not supported`);return Vi[t]}if("Testnet"===e){if(!Gi[t])throw new Error(`Chain ${t} not supported`);return Gi[t]}throw new Error(`Unsupported network: ${e}`)}function zi(e){return void 0!==Gi[e]}function Hi(e){return(0,$i.k5)(Number(e))}function qi(e){return"Testnet"===e?Object.keys(Gi):Object.keys(Vi)}var Yi;!function(e){e.INPROGRESS="INPROGRESS",e.COMPLETED="COMPLETED",e.REFUNDED="REFUNDED",e.CANCELED="CANCELED"}(Yi||(Yi={}));const Qi=["transfer","swap","redeem","refund"];var Ji;function Zi(e){const t=Hi(e.sourceChain),n=Hi(e.destChain),r=e.txs.filter((e=>e.goals.includes(Ji.Send)||e.goals.includes(Ji.Register))).map((e=>({chain:t,txid:e.txHash}))),a=e.txs.filter((e=>e.goals.includes(Ji.Settle))).map((e=>({chain:n,txid:e.txHash})));let i=[];e.refundTxHash&&i.push({chain:Hi(e.refundChain),txid:e.refundTxHash});const s={};for(const t of Qi){const n=`${t}SignedVaa`;if(n in e&&null!==e[n]){const r=(0,vi.vB)("Uint8Array",Ki.$v.decode(e[n]));s[t]={id:{emitter:r.emitterAddress,sequence:r.sequence,chain:r.emitterChain},attestation:r}}}let o={},u=!1;if("redeem"in s?(o=s.redeem,u=!0):"transfer"in s&&(o=s.transfer,u=!0),e.clientStatus===Yi.COMPLETED)return{from:t,to:n,originTxs:r,destinationTxs:a,state:Ri.ki.DestinationFinalized,attestation:o};if(e.clientStatus===Yi.REFUNDED||e.clientStatus===Yi.CANCELED)return{from:t,to:n,originTxs:r,refundTxs:i,state:Ri.ki.Refunded,attestation:s.refund};if(e.clientStatus===Yi.INPROGRESS)return u&&a.length>0?{from:t,to:n,originTxs:r,destinationTxs:a,state:Ri.ki.DestinationInitiated,attestation:o}:{from:t,to:n,originTxs:r,state:Ri.ki.SourceInitiated};throw new Error(`Unknown Mayan clientStatus ${e.clientStatus}`)}async function Xi(e,t){const n=`https://${{Mainnet:"",Testnet:"testnet-",Devnet:""}[e]}explorer-api.mayan.finance/v3/swap/trx/${t.txid}`;try{const e=await Wi.Z.get(n);if(e.data.id)return e.data}catch(e){if(!e)return null;if("object"==typeof e){if(Wi.Z.isAxiosError(e)&&404===e.response?.status)return null;if("status"in e&&404===e.status)return null}throw e}return null}!function(e){e.Send="SEND",e.Bridge="BRIDGE",e.Swap="SWAP",e.Register="REGISTER",e.Settle="SETTLE"}(Ji||(Ji={}));var es=n(135629),ts=n(28423),ns=n(652751),rs=n(313929),as=n(719443);const is=[{inputs:[{internalType:"address",name:"_mayanForwarder",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint256",name:"fee",type:"uint256"}],name:"FeeTooLarge",type:"error"},{inputs:[{internalType:"uint256",name:"fee",type:"uint256"}],name:"FeeTransferFailed",type:"error"},{inputs:[{internalType:"uint256",name:"refundAmount",type:"uint256"}],name:"RefundFailed",type:"error"},{inputs:[],name:"VERSION",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"forwarderData",type:"bytes"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"address",name:"payee",type:"address"}],internalType:"struct FeeArgs",name:"feeArgs",type:"tuple"}],name:"forwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"forwarderData",type:"bytes"},{components:[{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"address",name:"payee",type:"address"}],internalType:"struct FeeArgs",name:"feeArgs",type:"tuple"}],name:"forwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"mayanForwarder",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],ss="0x87a26566dbb3bf206634c1792a96ff4989e3f56e";function os(e,t,n){return!(t<=0n||!n||"Mainnet"!==e)}class us extends Mi.ns{MAX_SLIPPAGE=1;static NATIVE_GAS_DROPOFF_SUPPORTED=!1;static IS_AUTOMATIC=!0;protocols=["WH","MCTP","SWIFT","MONO_CHAIN"];isTestnetRequest(e){return"Testnet"===e.fromChain.network||"Testnet"===e.toChain.network}normalizeQuoteForTestnet(e){const{hyperCoreParams:t,...n}=e;return n}getDefaultOptions(){return{gasDrop:0,slippageBps:"auto",optimizeFor:"speed"}}static supportedNetworks(){return["Mainnet","Testnet"]}static supportedChains(e){return qi(e)}static async supportedSourceTokens(e){return[]}static isProtocolSupported(e){return qi(e.network).includes(e.chain)}static async supportedDestinationTokens(e,t,n){return[]}async isAvailable(){return!0}async validate(e,t){try{return t.options=t.options??this.getDefaultOptions(),{valid:!0,params:{...t,normalizedParams:{slippageBps:t.options.slippageBps}}}}catch(e){return{valid:!1,params:t,error:e}}}toMayanAddress(e){return(0,vi.tY)(e.address)?"Sui"===e.chain?"0x2::sui::SUI":"0x0000000000000000000000000000000000000000":(0,vi.QC)(e)}isNewReferralEnabled(e){const t=this.getReferralParameters(e),{isNewSolanaReferralEnabled:n,isNewEvmReferralEnabled:r,isNewSuiReferralEnabled:a}=t,{fromChain:i}=e,s="Solana"===i.chain,o="Sui"===i.chain;return s?!!n:o?!!a:!(s||o||!r)}getFeeInBaseUnits(e,t){const n=this.isNewReferralEnabled(e),{referrerBps:r,referrer:a}=this.getReferralParameters(e);if(!r||!a||!n)return 0n;const i=_i.Qc(t,e.source.decimals),s=BigInt(10*r);if(s>65535n)throw new Error("bps exceeds max u16");const o=_i.SL(i,s);return _i.Dl(o)}getQuoteAmountIn64(e,t){const n=e.source.decimals,r=_i.Qc(t,n),a=this.getFeeInBaseUnits(e,t);if(a<=0n)return r.amount;const i=_i.Dl(r)-a;return _i.dN(i,n).amount}async injectReferralInstructionsForSolana(e,t,n,r,a){const{fromChain:i,source:o}=t,u=this.getReferralParameters(t),{isNewSolanaReferralEnabled:p}=u,c=this.referrerAddress()?.solana,l=this.getFeeInBaseUnits(t,a);if(!c||!l||"Mainnet"!==i.network||!p)return n;const d=[],y=new s.PublicKey(c);if((0,vi.tY)(o.id.address))d.push(s.SystemProgram.transfer({fromPubkey:r,toPubkey:y,lamports:l}));else{const t=new s.PublicKey(o.id.address.toString()),n=await Fi.d.getTokenProgramId(e,t),a=(0,es.MO)(t,y,!0,n),i=(0,es.MO)(t,r,!0,n);await e.getAccountInfo(a)||d.push((0,ts.ji)(r,a,y,t,n)),d.push((0,ns.$B)(i,a,r,l,void 0,n))}return d.push(...n),d}async injectReferralInstructionsForSui(e,t,n,r){const{fromChain:a,source:i}=t,s=this.getReferralParameters(t),{isNewSuiReferralEnabled:o}=s,u=this.referrerAddress()?.sui,p=this.getFeeInBaseUnits(t,r),c=this.getQuoteAmountIn64(t,r);if(!u||!p||"Mainnet"!==a.network||!o)return{};const l=new rs.Y,d=i.id.address;let y;if((0,vi.tY)(d))y=l.gas;else{const t=d.toString(),[r,...a]=await Ni.$.getCoins(e,n,t);if(!r)throw new Error(`No coins of type ${t} found for ${n}.`);y=l.object(r.coinObjectId),a.length>0&&l.mergeCoins(y,a.map((e=>l.object(e.coinObjectId))))}const[m,f]=l.splitCoins(y,[p,c]);return l.transferObjects([m],u),{tx:l,remainingAmountCoin:f}}async fetchQuote(e,t){const{fromChain:n,toChain:r}=e;if(this.isTestnetRequest(e)){if(!zi(n.chain))throw new Error(`Chain ${n.chain} is not supported on testnet. Supported testnet chains: ${qi("Testnet").join(", ")}`);if(!zi(r.chain))throw new Error(`Chain ${r.chain} is not supported on testnet. Supported testnet chains: ${qi("Testnet").join(", ")}`)}const a={amountIn64:this.getQuoteAmountIn64(e,t.amount),fromToken:this.toMayanAddress(e.source.id),toToken:this.toMayanAddress(e.destination.id),fromChain:Li(n.network,n.chain),toChain:Li(r.network,r.chain),...this.getDefaultOptions(),...t.options,slippageBps:"auto"},i=this.getReferralParameters(e);this.isNewReferralEnabled(e)||(a.referrer=i.referrer,a.referrerBps=i.referrerBps);const s={swift:this.protocols.includes("SWIFT"),mctp:this.protocols.includes("MCTP"),monoChain:this.protocols.includes("MONO_CHAIN")},o=new URL(this.isTestnetRequest(e)?(0,ki.hm)({...a,fromChain:Li(n.network,n.chain),toChain:Li(r.network,r.chain)},s):function(e,t={wormhole:!0,swift:!0,mctp:!0,shuttle:!0,gasless:!1,onlyDirect:!1,fastMctp:!0,fullList:!1,payload:void 0,monoChain:!0}){const{gasDrop:n,referrerBps:r}=e;let a=e.slippageBps;"auto"===a||Number.isFinite(a)||(a=100*e.slippage);const i={wormhole:!1!==t.wormhole,swift:!1!==t.swift,mctp:!1!==t.mctp,shuttle:!0===t.shuttle,fastMctp:!1!==t.fastMctp,gasless:!0===t.gasless,onlyDirect:!0===t.onlyDirect,fullList:!0===t.fullList,payload:"string"==typeof t.payload?t.payload:void 0,monoChain:!1!==t.monoChain,solanaProgram:Lr.MAYAN_PROGRAM_ID,forwarderAddress:Lr.MAYAN_FORWARDER_CONTRACT,amountIn:!e.amountIn64&&Number.isFinite(e.amount)?e.amount:void 0,amountIn64:e.amountIn64,fromToken:e.fromToken,fromChain:e.fromChain,toToken:e.toToken,toChain:e.toChain,slippageBps:a,referrer:e.referrer,referrerBps:Number.isFinite(r)?r:void 0,gasDrop:Number.isFinite(n)?n:void 0,sdkVersion:ra()};return`${Lr.PRICE_URL}/quote?`+ba(i)}(a,s));if(!o)throw new Error("Unable to generate fetch quote URL");o.searchParams.has("fullList")||o.searchParams.append("fullList","true");const u=await Wi.Z.get(o.toString());if(200!==u.status)throw new Error("Unable to fetch quote",{cause:u});const p=u.data?.quotes?.filter((e=>this.protocols.includes(e.type)));if(p&&0!==p.length)return 1===p.length||p.sort(((e,n)=>"cost"===t.options.optimizeFor?n.expectedAmountOut===e.expectedAmountOut?e.etaSeconds-n.etaSeconds:n.expectedAmountOut-e.expectedAmountOut:"speed"===t.options.optimizeFor?e.etaSeconds===n.etaSeconds?n.expectedAmountOut-e.expectedAmountOut:e.etaSeconds-n.etaSeconds:0)),p[0]}getMinAmount(e,t){try{return _i.Qc(_i.I0(e,t),t)}catch(e){return null}}async quote(e,t){try{const n=await this.fetchQuote(e,t);if(!n)return{success:!1,error:new Oi.DX(new Error("Couldn't fetch a quote"))};const r={token:{chain:"Solana",address:Pi.D.parseAddress("Solana",Di.UO.get(e.fromChain.network,"Solana"))},amount:_i.Qc(_i.I0(n.clientRelayerFeeSuccess||"0",6),6)},a=1e3*parseInt(n.deadline64,10),i=a?new Date(a):void 0;return{success:!0,params:t,sourceToken:{token:e.source.id,amount:_i.dN(BigInt(n.effectiveAmountIn64),n.fromToken.decimals)},destinationToken:{token:e.destination.id,amount:_i.Qc(_i.I0(n.expectedAmountOut,n.toToken.decimals),n.toToken.decimals)},relayFee:r,destinationNativeGas:_i.Qc(_i.I0(n.gasDrop,n.toToken.decimals),n.toToken.decimals),eta:1e3*n.etaSeconds,details:n,expires:i}}catch(t){if(Wi.Z.isAxiosError(t)){const n=t?.response?.data;if("AMOUNT_TOO_SMALL"===n?.code){const t=n?.data?.minAmountIn,r=this.getMinAmount(t,e.source.decimals);if(r)return{success:!1,error:new Oi.bE(r)}}if(n?.msg)return{success:!1,error:Error(n?.msg,{cause:n})}}return{success:!1,error:t}}}async initiate(e,t,n,r){try{const a=this.referrerAddress(),i=t.address(),u=(0,vi.QC)(r),c=[],l=await e.fromChain.getRpc(),d=this.getFeeInBaseUnits(e,n.params.amount),y=this.isNewReferralEnabled(e);if("Solana"===e.fromChain.chain){const{instructions:r,signers:d,lookupTables:m}=await(this.isTestnetRequest(e)?(0,ki.fy)(this.normalizeQuoteForTestnet(n.details),i,u,null,l,{allowSwapperOffCurve:!0}):async function(e,t,n,r,a,i={}){const u=ua(e,r);if("hypercore"===e.fromChain)throw new Error("HyperCore as source chain is not supported in Solana");if("hypercore"===e.toChain)return async function(e,t,n,r,a,i={}){if(e.toToken.contract.toLowerCase()!==Lr.ARBITRUM_USDC_CONTRACT.toLowerCase()||"MCTP"!==e.type)throw new Error("Unsupported quote type for USDC deposit: "+e.type);if(!i?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(!Number(e.deadline64))throw new Error("HyperCore deposit requires timeout");const u=i.allowSwapperOffCurve||!1;let p=[],c=[],l=[],d=[];d.push(Lr.LOOKUP_TABLE);let y=[],m=[],f=[];const b=s.Keypair.generate();let h=null;const g=new s.PublicKey(t),T=new s.PublicKey(e.hyperCoreParams.initiateTokenContract),w=Math.floor(65e3*Math.random()),[I]=s.PublicKey.findProgramAddressSync([o.Buffer.from("PAYLOAD"),g.toBuffer(),(()=>{const e=o.Buffer.alloc(2);return e.writeUInt16LE(w,0),e})()],new s.PublicKey(Lr.PAYLOAD_WRITER_PROGRAM_ID)),C=fa(e,n,i.usdcPermitSignature),A=s.Keypair.generate(),S=new s.PublicKey(Lr.MCTP_PROGRAM_ID),[k]=s.PublicKey.findProgramAddressSync([o.Buffer.from("LEDGER_BRIDGE"),g.toBytes(),A.publicKey.toBytes()],S),M=Qr(T,k,!0);if(e.fromToken.contract===e.hyperCoreParams.initiateTokenContract){e.suggestedPriorityFee>0&&p.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),p.push(Ya(Ea(g,M,k,T))),p.push(Ya(Na(Qr(T,g,u),M,g,BigInt(e.hyperCoreParams.bridgeAmountUSDC64)))),p.push(Ya(Ha(g,I,C,w))),p.push(Ya(ri({ledger:k,randomKey:A.publicKey,swapperAddress:g.toString(),mintAddress:T.toString(),mode:"WITH_FEE",feeSolana:BigInt(0),amountInMin64:BigInt(e.hyperCoreParams.bridgeAmountUSDC64),customPayload:I,destinationAddress:Lr.HC_ARBITRUM_DEPOSIT_PROCESSOR,referrerAddress:r,feeRedeem:0,gasDrop:e.hyperCoreParams.failureGasDrop,toChain:"arbitrum"})));const{instruction:t,signers:n}=Ja(k,"arbitrum",e.hyperCoreParams.initiateTokenContract,g.toString(),BigInt(0));p.push(Ya(t)),c.push(...n),p.push(Ya(qa(g,I,w)))}else{const t=await ga({minMiddleAmount:e.minMiddleAmount,middleToken:e.hyperCoreParams.initiateTokenContract,userWallet:g.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:"HC_USDC",fillMaxAccounts:i?.separateSwapTx||!1,tpmTokenAccount:b.publicKey.toString()}),n=Ka(t);if(i?.separateSwapTx&&t.maxAccountsFilled)La(n,b.publicKey,g),f=await Da(a,g,T,g,b),m.push(...n.computeBudgetInstructions),n.setupInstructions&&m.push(...n.setupInstructions),m.push(n.swapInstruction),n.cleanupInstruction&&m.push(n.cleanupInstruction),y.push(...n.addressLookupTableAddresses);else{La(n,b.publicKey,g),p.push(...n.computeBudgetInstructions);const e=await Da(a,g,T,g,b);p.push(...e.map((e=>Ya(e)))),c.push(b),n.setupInstructions&&p.push(...n.setupInstructions.map((e=>Ya(e)))),p.push(Ya(n.swapInstruction)),n.cleanupInstruction&&p.push(Ya(n.cleanupInstruction)),d.push(...n.addressLookupTableAddresses)}const o=m.length>0?BigInt(0):BigInt(e.solanaRelayerFee64);let l=BigInt(e.hyperCoreParams.bridgeAmountUSDC64);m.length>0&&(l-=BigInt(e.solanaRelayerFee64)),p.push(Ya(Ea(g,M,k,new s.PublicKey(e.mctpInputContract)))),p.push(Ya(Na(b.publicKey,M,g,l)));const h=Qr(T,g,u),S=await a.getAccountInfo(h);if(S&&S.data||p.push(Ya(Ea(g,h,g,T))),p.push(Ya(za(g,T,b.publicKey,h,g))),p.push(Ya(Ha(g,I,C,w))),p.push(Ya(ri({ledger:k,swapperAddress:g.toString(),mintAddress:T.toString(),randomKey:A.publicKey,mode:"WITH_FEE",feeSolana:o,amountInMin64:l,customPayload:I,destinationAddress:Lr.HC_ARBITRUM_DEPOSIT_PROCESSOR,referrerAddress:r,feeRedeem:0,gasDrop:e.hyperCoreParams.failureGasDrop,toChain:"arbitrum"}))),p.push(Ya(qa(g,I,w))),m.length>0){const{instruction:t,signers:n}=Ja(k,"arbitrum",e.hyperCoreParams.initiateTokenContract,g.toString(),BigInt(0));p.push(Ya(t)),c.push(...n)}}const v=await $a(d.concat(y),a);return l=v.slice(0,d.length),m.length>0&&(h={messageV0:{payerKey:g,instructions:m,addressLookupTableAccounts:v.slice(d.length)},createTmpTokenAccountIxs:f,tmpTokenAccount:b}),{instructions:p,signers:c,lookupTables:l,swapMessageV0Params:h}}(e,t,n,u,a,i);if("MCTP"===e.type)return async function(e,t,n,r,a,i={}){const u=i?.forceSkipCctpInstructions||!1,p=i?.allowSwapperOffCurve||!1;if("solana"===e.toChain)throw new Error("Unsupported destination chain: "+e.toChain);let c=[],l=[],d=[],y=[],m=[],f=[],b=[];const h=s.Keypair.generate();let g=null;c.push(Lr.LOOKUP_TABLE);const T=new s.PublicKey(Lr.MCTP_PROGRAM_ID),w=new s.PublicKey(t),I=s.Keypair.generate(),C=e.deadline64?BigInt(e.deadline64):BigInt(0);if(e.hasAuction&&!Number(e.deadline64))throw new Error("Swap mode requires a timeout");const A=e.hasAuction?"LEDGER_ORDER":"LEDGER_BRIDGE",[S]=s.PublicKey.findProgramAddressSync([o.Buffer.from(A),w.toBytes(),I.publicKey.toBytes()],T),k=Qr(new s.PublicKey(e.mctpInputContract),S,!0),M="solana"===e.cheaperChain?"LOCK_FEE":"WITH_FEE",v="sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract;if(e.fromToken.contract===e.mctpInputContract){const a=u?BigInt(e.solanaRelayerFee64):BigInt(0);if(e.suggestedPriorityFee>0&&l.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),l.push(Ya(Ea(w,k,S,new s.PublicKey(e.mctpInputContract)))),l.push(Ya(Na(Qr(new s.PublicKey(e.mctpInputContract),w,p),k,w,BigInt(e.effectiveAmountIn64)))),e.hasAuction){if(l.push(Ya(ii({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:a,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),tokenOut:v,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:C,feeRateRef:e.referrerBps}))),!u){const{instruction:n,signer:r}=ti(S,e.toChain,e.mctpInputContract,t,a);l.push(Ya(n)),d.push(r)}}else if(l.push(Ya(ri({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:a,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),mode:M,referrerAddress:r}))),!u)if("WITH_FEE"===M){const{instruction:n,signers:r}=Ja(S,e.toChain,e.mctpInputContract,t,a);l.push(Ya(n)),d.push(...r)}else{const{instructions:n,signer:r}=Xa(S,e.toChain,e.mctpInputContract,t,a);l.push(...n.map((e=>Ya(e)))),d.push(r)}}else{const o=await ga({minMiddleAmount:e.minMiddleAmount,middleToken:e.mctpInputContract,userWallet:t,userLedger:S.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.hasAuction?"SWAP":M,fillMaxAccounts:i?.separateSwapTx||!1,tpmTokenAccount:i?.separateSwapTx?h.publicKey.toString():null}),u=Ka(o);i?.separateSwapTx&&o.maxAccountsFilled?(La(u,h.publicKey,w),b=await Da(a,w,new s.PublicKey(e.mctpInputContract),w,h),f.push(...u.computeBudgetInstructions),u.setupInstructions&&f.push(...u.setupInstructions),f.push(u.swapInstruction),u.cleanupInstruction&&f.push(u.cleanupInstruction),m.push(...u.addressLookupTableAddresses),l.push(Ya(Ea(w,k,S,new s.PublicKey(e.mctpInputContract)))),l.push(Ya(za(w,new s.PublicKey(e.mctpInputContract),h.publicKey,k,w)))):(La(u,k,w),l.push(...u.computeBudgetInstructions),u.setupInstructions&&l.push(...u.setupInstructions.map((e=>Ya(e)))),l.push(Ya(u.swapInstruction)),u.cleanupInstruction&&l.push(Ya(u.cleanupInstruction)),c.push(...u.addressLookupTableAddresses));const p=f.length>0?BigInt(0):BigInt(e.solanaRelayerFee64);if(e.hasAuction){if(l.push(Ya(ii({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:p,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:Jr(e.minMiddleAmount,Aa),tokenOut:v,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:C,feeRateRef:e.referrerBps}))),f.length>0){const{instruction:n,signer:r}=ti(S,e.toChain,e.mctpInputContract,t,p);l.push(Ya(n)),d.push(r)}}else if(l.push(Ya(ri({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:p,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:Jr(e.minMiddleAmount,Aa),mode:M,referrerAddress:r}))),f.length>0)if("WITH_FEE"===M){const{instruction:n,signers:r}=Ja(S,e.toChain,e.mctpInputContract,t,p);l.push(Ya(n)),d.push(...r)}else{const{instructions:n,signer:r}=Xa(S,e.toChain,e.mctpInputContract,t,p);l.push(...n.map((e=>Ya(e)))),d.push(r)}}const _=await $a(c.concat(m),a);return y=_.slice(0,c.length),f.length>0&&(g={messageV0:{payerKey:w,instructions:f,addressLookupTableAccounts:_.slice(c.length)},createTmpTokenAccountIxs:b,tmpTokenAccount:h}),{instructions:l,signers:d,lookupTables:y,swapMessageV0Params:g}}(e,t,n,u,a,i);if("SWIFT"===e.type)return oi(e,t,n,u,a,i);if("MONO_CHAIN"===e.type)return ui(e,t,n,u,a,i);let c=[];const l=a??new s.Connection("https://rpc.ankr.com/solana"),d=new s.PublicKey(Lr.MAYAN_PROGRAM_ID),y=new s.PublicKey(Lr.TOKEN_PROGRAM_ID),m=new s.PublicKey(t),f=new s.PublicKey(Lr.AUCTION_PROGRAM_ID);let b;e.suggestedPriorityFee>0&&c.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),b=u?new s.PublicKey(u):s.SystemProgram.programId;const[h,g]=s.PublicKey.findProgramAddressSync([o.Buffer.from("MAYANFEE")],d),[T,w]=s.PublicKey.findProgramAddressSync([o.Buffer.from("REFERRERFEE"),b.toBuffer()],d),I=s.Keypair.generate(),C=s.Keypair.generate(),[A,S]=s.PublicKey.findProgramAddressSync([o.Buffer.from("V2STATE"),o.Buffer.from(I.publicKey.toBytes()),o.Buffer.from(C.publicKey.toBytes())],d),k=new s.PublicKey(e.fromToken.mint),M=new s.PublicKey(e.toToken.mint),v=Qr(k,m),_=Qr(k,A,!0),[[O,P],E,R]=await Promise.all([l.getMultipleAccountsInfo([v,_],"finalized"),l.getMinimumBalanceForRentExemption(420),Ga()]);O&&0!==O.data.length||c.push(Ea(m,v,m,k)),P&&0!==P.data.length||c.push(Ea(m,_,A,k)),e.fromToken.contract===p.N&&(c.push(s.SystemProgram.transfer({fromPubkey:m,toPubkey:v,lamports:BigInt(e.effectiveAmountIn64)})),c.push(Fa(v)));const D=BigInt(e.effectiveAmountIn64),j=s.Keypair.generate();c.push(function(e,t,n,r,a=new s.PublicKey(Lr.TOKEN_PROGRAM_ID)){const i=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],u=o.Buffer.alloc(ja.span);return ja.encode({instruction:4,amount:sa(r)},u),new s.TransactionInstruction({keys:i,programId:a,data:u})}(v,j.publicKey,m,D)),c.push(s.SystemProgram.transfer({fromPubkey:m,toPubkey:j.publicKey,lamports:E}));const B=[{pubkey:j.publicKey,isWritable:!1,isSigner:!0},{pubkey:I.publicKey,isWritable:!1,isSigner:!0},{pubkey:C.publicKey,isWritable:!1,isSigner:!0},{pubkey:A,isWritable:!0,isSigner:!1},{pubkey:v,isWritable:!0,isSigner:!1},{pubkey:m,isWritable:!1,isSigner:!1},{pubkey:_,isWritable:!0,isSigner:!1},{pubkey:k,isWritable:!1,isSigner:!1},{pubkey:M,isWritable:!1,isSigner:!1},{pubkey:f,isWritable:!1,isSigner:!1},{pubkey:b,isWritable:!1,isSigner:!1},{pubkey:h,isWritable:!1,isSigner:!1},{pubkey:T,isWritable:!1,isSigner:!1},{pubkey:j.publicKey,isWritable:!0,isSigner:!0},{pubkey:R,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],F=Xr(e.toChain);if(1===F){const e=await l.getAccountInfo(new s.PublicKey(n));if(e&&e.owner&&e.owner.equals(y))throw new Error("Destination address is not about token account. It should be a owner address")}const x=o.Buffer.from(Yr(qr(n,F))),N=Jr(e.minAmountOut,e.mintDecimals.to),U=Jr(e.swapRelayerFee,e.mintDecimals.from),W=Jr(e.redeemRelayerFee,e.mintDecimals.to),$=Jr(e.refundRelayerFee,e.mintDecimals.from),K=Jr(e.gasDrop,"solana"===e.toChain?9:8),V=e.toToken.contract===p.N,G=e.fromToken.contract===p.N;if(!Number(e.deadline64))throw new Error("Deadline is not valid");const L=BigInt(e.deadline64),z=o.Buffer.alloc(pi.span),H={instruction:101,stateNonce:S,amount:sa(D),minAmountOut:sa(N),deadline:sa(L),feeSwap:sa(U),feeReturn:sa(W),feeCancel:sa($),gasDrop:sa(K),destinationChain:F,destinationAddress:x,unwrapRedeem:V?1:0,unwrapRefund:G?1:0,mayanFeeNonce:g,referrerFeeNonce:w};pi.encode(H,z);const q=new s.TransactionInstruction({keys:B,data:z,programId:d});return c.push(q),{instructions:c,signers:[j,I,C],lookupTables:[],swapMessageV0Params:null}}(n.details,i,u,y?null:a,l,{allowSwapperOffCurve:!0})),f=new s.PublicKey(i),b=s.MessageV0.compile({instructions:await this.injectReferralInstructionsForSolana(l,e,r,f,n.params.amount),payerKey:new s.PublicKey(i),recentBlockhash:"",addressLookupTableAccounts:m}),h=[new xi.D({transaction:new s.VersionedTransaction(b),signers:d},e.fromChain.network,e.fromChain.chain,"Execute Swap")];if((0,vi.Mv)(t)){const n=await t.signAndSend(h);c.push(...n.map((t=>({chain:e.fromChain.chain,txid:t}))))}else if((0,vi.rA)(t)){const n=await t.sign(h),r=await Fi.d.sendWait(e.fromChain.chain,l,n);c.push(...r.map((t=>({chain:e.fromChain.chain,txid:t}))))}}else if("Sui"===e.fromChain.chain){const{tx:r,remainingAmountCoin:s}=await this.injectReferralInstructionsForSui(l,e,i,n.params.amount),o=r?{builtTransaction:r,inputCoin:{result:s}}:void 0,p=await(this.isTestnetRequest(e)?(0,ki.dT)(this.normalizeQuoteForTestnet(n.details),i,u,null,void 0,l):Si(n.details,i,u,y?null:a,void 0,l,o)),d=[new Ui.A(p,e.fromChain.network,e.fromChain.chain,"Execute Swap")];if((0,vi.Mv)(t)){const n=await t.signAndSend(d);c.push(...n.map((t=>({chain:e.fromChain.chain,txid:t}))))}else if((0,vi.rA)(t)){const n=await t.sign(d),r=await Ni.$.sendWait(e.fromChain.chain,l,n);c.push(...r.map((t=>({chain:e.fromChain.chain,txid:t}))))}}else{const r=[],s=Ei.X.get(e.fromChain.network,e.fromChain.chain),o=this.toMayanAddress(e.source.id),p=(0,vi.tY)(e.source.id.address),m=function(e,t,n){return os(e,t,n)?ss:Lr.MAYAN_FORWARDER_CONTRACT}(e.fromChain.network,d,y),f=_i.Dl(_i.Qc(n.params.amount,e.source.decimals));if(!p){const t=ji.W.getTokenImplementation(l,o);if(await t.allowance(i,m)<f){const n=await t.approve.populateTransaction(m,f);r.push(new Bi.z({from:i,chainId:s,...n},e.fromChain.network,e.fromChain.chain,"Approve Allowance"))}}const b=this.isTestnetRequest(e)?(0,ki.PB)(this.normalizeQuoteForTestnet(n.details),i,u,null,i,Number(s),void 0,void 0):hi(n.details,i,u,y?null:a,i,Number(s),void 0,void 0),h=function(e,t,n,r,a,i,s,o,u){if(!t.data||!os(e,r,u))return t;const p=function(){const e=new as.vU(is);return{encodeFunctionData:function(t,n,r,a,i,s){return s?function(t,n,r){return e.encodeFunctionData("forwardEth",[t,{payee:n,fee:r}])}(t,n,r):function(t,n,r,a,i){return e.encodeFunctionData("forwardERC20",[t,n,r,{payee:a,fee:i}])}(t,a,i,n,r)},getMsgValue:function(e,t){return t?e:0n}}}(),c=p.encodeFunctionData(t.data,i,r,s,n,o),l=p.getMsgValue(n,o);return{from:a,to:ss,data:c,value:l,chainId:t.chainId}}(e.fromChain.network,b,f,d,i,a?.evm,o,p,y);if(r.push(new Bi.z(h,e.fromChain.network,e.fromChain.chain,"Execute Swap")),(0,vi.Mv)(t)){const n=await t.signAndSend(r);c.push(...n.map((t=>({chain:e.fromChain.chain,txid:t}))))}else if((0,vi.rA)(t)){const n=await t.sign(r),a=await ji.W.sendWait(e.fromChain.chain,l,n);c.push(...a.map((t=>({chain:e.fromChain.chain,txid:t}))))}}return{from:e.fromChain.chain,to:e.toChain.chain,state:Ri.ki.SourceInitiated,originTxs:c}}catch(e){throw console.error(e),e}}async*track(e,t){if((0,Ri.PN)(e)||(0,Ri.G8)(e)||(0,Ri.c3)(e))return e;let n=t||36e5;for(;n>0;){const t=Date.now();if(!((0,Ri.vk)(e)||(0,Ri.E6)(e)||(0,Ri.AY)(e)))throw new Error("Transfer must have been initiated");{const t=await Xi(this.wh.network,e.originTxs[e.originTxs.length-1]);if(t&&(e=Zi(t),yield{...e,txstatus:t},(0,Ri.PN)(e)||(0,Ri.G8)(e)||(0,Ri.c3)(e)))return e}await new Promise((e=>setTimeout(e,1e3))),n-=Date.now()-t}return e}transferUrl(e){return`https://explorer.mayan.finance/swap/${e}`}referrerAddress(){const{referrers:e}=this.constructor;if(e&&!(Object.keys(e).length<1))return{solana:e.Solana||null,evm:e.Ethereum||null,sui:e.Sui||null}}getReferralParameters(e){const{referrers:t,getReferrerBps:n,isNewEvmReferralEnabled:r,isNewSolanaReferralEnabled:a,isNewSuiReferralEnabled:i}=this.constructor;return t?.Solana&&"function"==typeof n?{referrer:t.Solana,referrerBps:n(e),isNewEvmReferralEnabled:r,isNewSolanaReferralEnabled:a,isNewSuiReferralEnabled:i}:{}}}class ps extends us{static meta={name:"MayanSwap",provider:"Mayan"};protocols=["WH","MCTP","SWIFT","MONO_CHAIN"]}class cs extends us{static meta={name:"MayanSwapSWIFT",provider:"Mayan Swift"};protocols=["SWIFT"]}class ls extends us{static meta={name:"MayanSwapMCTP",provider:"Mayan MCTP"};protocols=["MCTP"]}class ds extends us{static meta={name:"MayanSwapWH",provider:"Mayan"};protocols=["WH"]}function ys(e,t={}){return t?.referrers&&"function"==typeof t?.getReferrerBps&&Object.assign(e,t),e}}}]);