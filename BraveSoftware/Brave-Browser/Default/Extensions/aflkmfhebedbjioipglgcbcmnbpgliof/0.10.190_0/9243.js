"use strict";(globalThis.webpackChunk_coral_xyz_app_extension=globalThis.webpackChunk_coral_xyz_app_extension||[]).push([[9243],{159243:(e,t,a)=>{a.r(t),a.d(t,{MonadStakeNavigator:()=>be,Routes:()=>fe});var n=a(541214),r=a(326951),i=a(187254),o=a(766264),l=a(371894),d=a(202784),c=a(377172),s=a(237462),m=a(337288),u=a(212600),g=a(927751),p=a(598416),h=a(44171),v=a(761321),w=a(512788),E=a(382740),S=a(202784);const k=e=>{e.currentTarget.src=h.rI},f=(0,d.memo)((function({delegation:e,onClick:t,pendingWithdrawal:a,isWithdrawalsLoading:n}){const{validator:i,rewards:o,pendingStake:l,activeStake:u}=e,g=(0,r.F)(),p=(0,v.GS)(),{amount:f,reward:y,rewardPrefix:b,statusText:I,statusColor:x}=(0,d.useMemo)((()=>{const t=(0,s.ml)(e),n=(0,s.Qv)(t,{decimals:2}),r=l>BigInt(0),i=a&&a>BigInt(0);let d=null,c="+";return i?(d=(0,s.Qv)(a,{decimals:2}),c="-"):r?(d=(0,s.Qv)(l,{decimals:2}),c="+"):o&&o>BigInt(0)&&(d=(0,s.Qv)(o,{decimals:2}),c="+"),{amount:n,reward:d,rewardPrefix:c,statusText:i?"Pending Unstake":r?"Pending":"Active",statusColor:r||i?"$yellowText":"$greenIcon"}}),[u,o,l,a]);return S.createElement("div",{style:{width:"100%",height:"100%",display:"flex"},onClick:t},S.createElement(m.sL,{minWidth:44,paddingTop:"12px",paddingBottom:"12px",marginRight:"12px",display:p.sidePanel?"none":"flex"},i?S.createElement(c.e4,{src:i.icon??h.rI,style:{borderRadius:"22px",width:"44px",height:"44px"},onError:k}):S.createElement(w.O,{radius:22,width:44,height:44})),S.createElement("div",{style:{color:g.baseTextHighEmphasis.val,flex:1,paddingTop:"10px",paddingBottom:"10px"}},S.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},S.createElement(E.q,{style:{height:"24px",fontWeight:500,fontSize:"16px",maxWidth:"200px",overflow:"hidden",color:g.baseTextHighEmphasis.val,lineHeight:"24px"},overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},i?.name??`Validator ${e.validatorId}`),S.createElement(E.q,{style:{fontWeight:500,fontSize:"16px",color:g.baseTextHighEmphasis.val,lineHeight:"24px"},overflow:"hidden",whiteSpace:"nowrap"},f)),S.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},n?S.createElement(w.O,{width:60,height:14}):S.createElement(E.q,{color:x,fontSize:"$sm"},I),n?null:y?S.createElement(E.q,{style:{fontWeight:500,fontSize:"14px",color:g.baseTextMedEmphasis.val,lineHeight:"20px"}},b,y):null)))}));var y=a(710224),b=a(202784);function I(e){return b.createElement(y.X,{loading:b.createElement(x,null)},b.createElement(A,e))}function x(){return null}function A(e){const{route:t}=e,{forceRefreshKey:a}=t.params??{forceRefreshKey:"container"};return b.createElement(B,{key:a,...e})}function B({navigation:e}){const{publicKey:t,info:a,blockchainId:r}=(0,n.rT)(),o=(0,s.iv)(r,t),l=(0,s.Gj)(r,t),h=(0,d.useMemo)((()=>l.data?(0,s.Km)(l.data):new Map),[l.data]),v=(0,d.useCallback)((()=>{e.push(fe.NewMonadStakeScreen)}),[e]),w=(0,d.useCallback)((t=>{const a={validatorId:t.validatorId,activeStake:t.activeStake.toString(),rewards:t.rewards.toString(),pendingStake:t.pendingStake.toString(),pendingActivationEpoch:t.pendingActivationEpoch.toString(),validator:t.validator?{id:t.validator.id,authAddress:t.validator.authAddress,stake:t.validator.stake.toString(),commission:t.validator.commission.toString(),name:t.validator.name,icon:t.validator.icon,details:t.validator.details,url:t.validator.url,apy:t.validator.apy}:void 0,can:t.can};e.push(fe.MonadStakeDetailScreen,{delegation:a})}),[e]),E=o.hasLoadedSomeData,S=o.data||[],k=void 0===l.data,y=(0,d.useCallback)((e=>{const{index:t,style:n,data:r}=e;if(r.hasLoadedSomeData&&t===(r.delegations?.length||0)&&"view-only"!==a.type)return b.createElement("div",{style:n},b.createElement(p.H,{onClick:v,label:i.ag._({id:"/UjBwd"})}));if(!r.hasLoadedSomeData)return b.createElement(m.FA,{paddingHorizontal:"$4",style:n},b.createElement(g.dR,null));if(!r.delegations||0===r.delegations.length)return null;const o=r.delegations[t];if(!o)return console.warn("No delegation at index",t),null;const l=r.pendingWithdrawalsByValidator.get(o.validatorId);return b.createElement(m.FA,{key:o.validatorId,hoverStyle:{cursor:"pointer",backgroundColor:"$baseBackgroundL2"},paddingHorizontal:"$4",style:n},b.createElement(f,{delegation:o,pendingWithdrawal:l,isWithdrawalsLoading:r.isWithdrawalsLoading,onClick:()=>{w(o)}}))}),[a.type,v,w]),I=E?S.length+("view-only"!==a.type?1:0):8,x=(0,d.useMemo)((()=>({delegations:S,hasLoadedSomeData:E,pendingWithdrawalsByValidator:h,isWithdrawalsLoading:k})),[S,E,h,k]);return E&&0===S.length?b.createElement(m.FA,{flex:1,width:"100vw",jc:"center",ai:"center",padding:"$4"},b.createElement(c.ub,{icon:e=>b.createElement(u.G,e),title:i.ag._({id:"P6uCVE"}),subtitle:i.ag._({id:"cIAMz/"}),buttonText:"view-only"!==a.type?i.ag._({id:"/UjBwd"}):void 0,onClick:"view-only"!==a.type?v:void 0})):b.createElement(m.FA,{flex:1,width:"100vw"},b.createElement(g.Ci,{itemData:x,renderer:y,itemCount:I}))}var F=a(997246),T=a(531518),$=a(797155),_=a(910528),M=a(590711),C=a(887388),q=a(400752),L=a(117312),P=a(202784);function z(e){return P.createElement(y.X,{loading:P.createElement(W,null)},P.createElement(D,e))}function W(){return P.createElement(m.FA,{mt:12,w:"100%",py:8,px:12,br:16,ai:"center",gap:8},P.createElement(T.m,{height:40,width:40}),P.createElement(m.FA,{ai:"center",gap:4},P.createElement(T.m,{height:20,width:160}),P.createElement(T.m,{height:16,width:120}),P.createElement(T.m,{height:16,width:200})),P.createElement(m.FA,{mt:8,p:8,br:16,ai:"center"},P.createElement(T.m,{height:16,width:100})))}function D({navigation:e}){const{publicKey:t,blockchainId:a}=(0,n.rT)(),[r,o]=(0,d.useState)(""),[l,c]=(0,d.useState)(null),u=(0,q.Dv)($.Z),{availableBalance:g,isLoading:p}=(0,s.wl)(a,t),v=(0,s.YZ)(a),{delegate:w}=(0,s.Bi)(a,t),S=(0,s.tm)(),k=g?_.O$.from(g.toString()):M._Y,f=v.data?.find((e=>e.id===u)),y=f?(0,s.PC)(f.commission):"";return P.createElement(m.FA,{gap:16,p:16},P.createElement(m.FA,{f:1,ai:"center"},P.createElement(L.Sr,{strAmount:r,setStrAmount:o,setAmount:c,decimals:18}),P.createElement(m.FA,{mt:16},k.gt(M._Y)?P.createElement(L.zq,{decimals:18,ticker:"MON",maxAmount:k,setStrAmount:o,setAmount:c}):null),f?P.createElement(P.Fragment,null,P.createElement(m.FA,{gap:8,mt:12,cursor:"pointer",w:"100%",py:8,px:12,br:16,ai:"center",pressStyle:{opacity:.7},onPress:()=>e.push(fe.MonadValidatorSelectorScreen)},P.createElement("img",{src:f.icon??h.rI,style:{width:40,height:40,borderRadius:20}}),P.createElement(m.FA,{ai:"center"},P.createElement(E.q,{fontSize:"$base"},f.name??`Validator ${f.id}`)),y?P.createElement(m.FA,{ai:"center"},P.createElement(E.q,{textAlign:"center",fontSize:"$sm",color:"$baseTextMedEmphasis"},i.ag._({id:"ba8OQU",values:{commissionPercent:y}}))):null),P.createElement(m.FA,{mt:8,cursor:"pointer",p:8,br:16,ai:"center",pressStyle:{opacity:.7},onPress:()=>e.push(fe.MonadValidatorSelectorScreen)},P.createElement(E.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},i.ag._({id:"7LarSD"})))):P.createElement(W,null)),P.createElement(F.x,{onPress:async()=>{try{const t=await w(u,(0,C.dF)(l?.toString()??"0"));if(S.current)return e.push(fe.MonadStakeConfirmationScreen,{signature:t,delay:1500,progressTitle:i.ag._({id:"to+Jrh"}),afterTitle:i.ag._({id:"q6lAbz"})})}catch(e){console.error(e)}},label:i.ag._({id:"JYKRJS"}),disabled:!l||!g||l.lte(M._Y)||k.gt(M._Y)&&l.gt(k)}))}var N=a(156675),R=a(457246),K=a(152010),O=a(893086),V=a(66046),Q=a(344848),U=a(989425),j=a(429538),H=a.n(j),Y=a(202784);function X(e){return Y.createElement(y.X,{loading:Y.createElement(G,null)},Y.createElement(Z,e))}function G(){return null}const Z=({navigation:e,route:{params:{signature:t,delay:a=1e3,afterTitle:r}}})=>{const[o,l]=(0,d.useState)(!1),{publicKey:s,blockchainId:u}=(0,n.rT)(),g=(0,n.gI)(u),p=(0,U.NL)(),h=(0,q.Dv)((0,V.WK)(u)),{explorerTxUrl:v}=(0,Q.U)(u),[w,S]=(0,d.useState)(),k=(0,N.x)();return H()((async n=>{try{await h.confirmTransaction(t),await Promise.allSettled([p.invalidateQueries({queryKey:["monadStaking",u,s]}),p.invalidateQueries({queryKey:["monadStaking",u,"validators"]}),k.query({query:K.v6,fetchPolicy:"network-only",context:K.cE,variables:{address:s,caip2:g}}),k.query({query:K.AN,fetchPolicy:"network-only",context:K.cE,variables:{address:s,caip2:g,filters:{token:"0x0000000000000000000000000000000000000000"}}})]),a>0&&await(0,O._v)(a),n()&&(l(!0),e.setOptions({title:r}))}catch(e){n()&&(console.error(e),S(e.message||"Error"))}}),[t]),Y.createElement(m.FA,{flex:1,padding:16,textAlign:"center"},Y.createElement(m.FA,{flex:1,justifyContent:"center",alignItems:"center"},w?Y.createElement(E.q,{color:"$redText"},"There was an error confirming this transaction: '",w,"'"):o?Y.createElement(Y.Fragment,null,Y.createElement(c.nQ,null),Y.createElement(E.q,{mt:16,textAlign:"center"},i.ag._({id:"w9X5a8"}))):Y.createElement(c.gb,{size:48,iconStyle:{display:"flex",marginLeft:"auto",marginRight:"auto"},thickness:6})),w||o?Y.createElement(F.x,{onPress:()=>e.navigate(fe.ListMonadStakesScreen,{forceRefreshKey:(0,R.lY)()}),label:i.ag._({id:"Yjz2VQ"})}):null,Y.createElement(m.FA,{mt:16},Y.createElement(F.x,{label:i.ag._({id:"LWBqW/"}),variant:"secondary",onPress:()=>{window.open(v(t),"_blank")}})))};var J=a(371541),ee=a(299105),te=a(566025),ae=a(316431),ne=a(623749),re=a(202784);function ie(e){return re.createElement(y.X,{loading:re.createElement(oe,null)},re.createElement(le,e))}function oe(){return null}const le=({navigation:e,route:{params:{delegation:t}}})=>{const{publicKey:a,blockchainId:r,info:o}=(0,n.rT)(),l=t.validatorId,u={...t,activeStake:BigInt(t.activeStake),rewards:BigInt(t.rewards),pendingStake:BigInt(t.pendingStake),pendingActivationEpoch:BigInt(t.pendingActivationEpoch),validator:t.validator?{...t.validator,stake:BigInt(t.validator.stake),commission:BigInt(t.validator.commission)}:void 0},g=(0,s.tm)(),[p,v]=(0,d.useState)(!1),[w,S]=(0,d.useState)(""),[k,f]=(0,d.useState)(null),y=(0,s.rD)(r,a,l),b=(0,s.$y)(r),{undelegate:I,compound:x,claimRewards:A,withdraw:B,findAvailableWithdrawalId:T,waitForTransaction:$}=(0,s.Bi)(r,a),q=u.activeStake*BigInt(5)/BigInt(1e4),P=u.rewards>BigInt(0),z=u.rewards>=q,W=u.activeStake>BigInt(0),D=_.O$.from(u.activeStake.toString()),N=y.filter((e=>!e.isAvailable)),R=N.reduce(((e,t)=>e+t.amount),BigInt(0)),K=y.filter((e=>e.isAvailable)).reduce(((e,t)=>e+t.amount),BigInt(0)),O=R+K,V=u.activeStake+u.pendingStake+u.rewards+O,Q=R>BigInt(0),U=K>BigInt(0),j=N.length>0?N.reduce(((e,t)=>t.withdrawEpoch<e.withdrawEpoch?t:e)):null,H=(()=>{if(!j||!b.data?.epoch||!b.data?.blockNumber)return null;const e=b.data.epoch,t=Number(b.data.blockNumber),a=j.withdrawEpoch+BigInt(1),n=Number(a-e);if(n<=0)return null;const r=t%s.Iw,o=(s.Iw-r)*s.u7+(n-1)*s.Iw*s.u7,l=Math.ceil(o/60),d=Math.floor(l/60),c=l%60;return i.ag._({id:"9aPiQ8",values:{hours:d,minutes:c}})})(),Y=k&&k.gt(M._Y)&&k.lte(D);return re.createElement(m.FA,{flex:1},p?re.createElement(m.FA,{flex:1},re.createElement(m.FA,{flex:1,overflow:"auto",p:16,gap:16},re.createElement(m.FA,{ai:"center"},re.createElement(L.Sr,{strAmount:w,setStrAmount:S,setAmount:f,decimals:18}),re.createElement(m.FA,{mt:16},re.createElement(L.zq,{decimals:18,ticker:"MON",maxAmount:D,setStrAmount:S,setAmount:f})))),re.createElement(m.FA,{p:16,pt:0,width:"100%",flexShrink:0},re.createElement(m.FA,{gap:8,width:"100%"},re.createElement(m.sL,{backgroundColor:"$baseBackgroundL1",borderRadius:12,padding:12,gap:12},re.createElement(m.FA,{paddingTop:2},re.createElement(ae.S,{size:18,color:"$baseIcon"})),re.createElement(E.q,{color:"$baseTextMedEmphasis",fontSize:"$xs",flex:1},i.ag._({id:"OYlpAM"}))),u.rewards>BigInt(0)?re.createElement(m.sL,{backgroundColor:"$baseBackgroundL1",borderRadius:12,padding:12,gap:12},re.createElement(m.FA,{paddingTop:2},re.createElement(ne.k,{size:18,color:"$baseIcon"})),re.createElement(E.q,{color:"$baseTextMedEmphasis",fontSize:"$xs",flex:1},i.ag._({id:"++QJr+"}))):null,re.createElement(F.x,{onPress:()=>v(!1),label:i.ag._({id:"dEgA5A"}),variant:"secondary"}),re.createElement(F.x,{onPress:async()=>{try{const t=k?BigInt(k.toString()):u.activeStake,a=u.rewards>BigInt(0),n=t>=u.activeStake;let r,o;if(a&&(r=await A(l),await $(r)),n)o=u.activeStake;else{const e=t-u.rewards;o=e>BigInt(0)?e:BigInt(0)}if(o>BigInt(0)){const t=await T(l),a=await I(l,(0,C.dF)(o),t);if(g.current)return e.replace(fe.MonadStakeConfirmationScreen,{signature:a,progressTitle:i.ag._({id:"FUzjis"}),afterTitle:i.ag._({id:"a9D+6D"})})}else if(r&&g.current)return e.replace(fe.MonadStakeConfirmationScreen,{signature:r,progressTitle:i.ag._({id:"Xzf15G"}),afterTitle:i.ag._({id:"lsDsk6"})})}catch(e){console.error(e)}},label:u.rewards>BigInt(0)?i.ag._({id:"dRnmXW"}):i.ag._({id:"35jpyv"}),disabled:!Y})))):re.createElement(m.FA,{flex:1,p:16},re.createElement(E.q,{fontSize:"$2xl",fontWeight:"$bold",textAlign:"center"},(0,s.Qv)(V,{decimals:4,appendTicker:!0})),re.createElement(m.FA,{marginVertical:16},re.createElement(ee.Zl,null,re.createElement(ee.Uq,{label:re.createElement(m.sL,{alignItems:"center",gap:8,maxWidth:"calc(100vw - 140px)"},re.createElement(c.e4,{src:u.validator?.icon??h.rI,style:{borderRadius:10,width:20,height:20}}),re.createElement(E.q,null,u.validator?.name??i.ag._({id:"Ve7giI",values:{validatorId:l}}))),valueColor:W?"$greenIcon":"$redText",value:W?i.ag._({id:"F6pfE9"}):i.ag._({id:"NoNwIX"})}),u.validator?.authAddress?re.createElement(de,{title:i.ag._({id:"zKEcQ9"}),address:u.validator.authAddress,blockchainId:r}):null,u.validator?.commission?re.createElement(ee.Uq,{label:i.ag._({id:"pzdP00"}),value:`${(0,s.PC)(u.validator.commission)}%`}):null,re.createElement(ee.Uq,{label:i.ag._({id:"BVbS7G"}),value:(0,s.Qv)(u.activeStake,{decimals:4,appendTicker:!0}),valueColor:W?"$baseTextHighEmphasis":"$baseTextMedEmphasis"}),u.pendingStake!==BigInt(0)?re.createElement(ee.Uq,{label:i.ag._({id:"kON5mj"}),value:(0,s.Qv)(u.pendingStake,{decimals:4,appendTicker:!0}),valueColor:"$yellowText"}):null,Q?re.createElement(ee.Uq,{label:i.ag._({id:"Hg8AIs"}),value:re.createElement(m.sL,{alignItems:"center",gap:8},H?re.createElement(m.sL,{alignItems:"center",gap:4},re.createElement(E.q,{color:"$baseTextMedEmphasis",fontSize:10},`~${H}`),re.createElement(ae.S,{size:10,color:"$baseTextMedEmphasis"})):null,re.createElement(E.q,{color:"$yellowText",fontSize:"$sm"},(0,s.Qv)(R,{decimals:4,appendTicker:!0})))}):null,U?re.createElement(ee.Uq,{label:i.ag._({id:"K0+N/U"}),value:(0,s.Qv)(K,{decimals:4,appendTicker:!0}),valueColor:"$yellowText"}):null,P?re.createElement(ee.Uq,{label:i.ag._({id:"EI9FNk"}),valueColor:"$greenText",value:`+${(0,s.Qv)(u.rewards,{decimals:4,appendTicker:!0})}`}):null)),re.createElement(m.FA,{flex:1}),re.createElement(m.FA,{gap:8,pt:4},"view-only"!==o.type&&U?re.createElement(F.x,{onPress:async()=>{try{const t=y.filter((e=>e.isAvailable));if(0===t.length)return;let a;for(const e of t)a=await B(l,e.withdrawalId);if(g.current&&a)return e.replace(fe.MonadStakeConfirmationScreen,{signature:a,progressTitle:i.ag._({id:"SVLzFm"}),afterTitle:i.ag._({id:"WRBOEH"})})}catch(e){console.error(e)}},label:i.ag._({id:"5k+87s"})}):re.createElement(re.Fragment,null,"view-only"!==o.type&&W?re.createElement(F.x,{onPress:()=>v(!0),label:i.ag._({id:"OFjZGo"}),variant:"secondary"}):null,"view-only"!==o.type&&z&&W?re.createElement(F.x,{onPress:async()=>{try{const t=await x(l);if(g.current)return e.replace(fe.MonadStakeConfirmationScreen,{signature:t,progressTitle:i.ag._({id:"vjRb39"}),afterTitle:i.ag._({id:"kuXLMH"})})}catch(e){console.error(e)}},label:i.ag._({id:"bpJCzP"})}):null,"view-only"!==o.type&&P&&!W?re.createElement(F.x,{onPress:async()=>{try{const t=await A(l);if(g.current)return e.replace(fe.MonadStakeConfirmationScreen,{signature:t,progressTitle:i.ag._({id:"Xzf15G"}),afterTitle:i.ag._({id:"lsDsk6"})})}catch(e){console.error(e)}},label:i.ag._({id:"zXCpR0"})}):null))))},de=({title:e,address:t,blockchainId:a})=>{const{explorerAddressUrl:n}=(0,Q.U)(a);return re.createElement(ee.Uq,{label:e,value:t?(0,J.R1)(t):"",onPress:t?()=>(0,te.Y)(n(t)):void 0})};var ce=a(355195),se=a(634706),me=a(815053),ue=a(892082),ge=a(202784);function pe(e){return ge.createElement(y.X,{loading:ge.createElement(he,null)},ge.createElement(ve,e))}function he(){return null}const ve=({navigation:e})=>{const{blockchainId:t}=(0,n.rT)(),a=(0,q.b9)($.Z),o=(0,r.F)(),[l,c]=(0,d.useState)(""),u=(0,s.YZ)(t),p=(0,ce.U)({minimumFractionDigits:2,maximumFractionDigits:2,notation:"compact",style:"decimal"}),h=(0,d.useMemo)((()=>l.toLowerCase()),[l]),v=(0,d.useMemo)((()=>u?.data?.filter((e=>(e.name?.toLowerCase()??"").includes(h)||e.id===l||e.authAddress.toLowerCase()===h))||[]),[u?.data,h,l]),w=/^\d+$/.test(l)&&l.length>0&&!v.some((e=>e.id===l)),S=(0,d.useCallback)((e=>v[e]?.id??e.toString()),[v]),k=(0,d.useCallback)((t=>{a(t.id),e.pop()}),[a,e]),f=(0,d.useMemo)((()=>({validators:v,onClickRow:k,formatter:p})),[v,k,p]);return ge.createElement(m.FA,{space:"$3"},ge.createElement(m.FA,{paddingHorizontal:"$4",paddingBottom:"$2"},ge.createElement(se.fP,{placeholder:i.ag._({id:"Inyjsh"}),value:l,onChangeText:e=>c(e),iconStart:ge.createElement(me.o,{color:o.baseIcon.val})})),w?ge.createElement(m.FA,{paddingHorizontal:"$4",paddingVertical:"$2"},ge.createElement(m.FA,{backgroundColor:"$baseBackgroundL1",borderRadius:"$medium",padding:"$3",cursor:"pointer",hoverStyle:{backgroundColor:"$baseBackgroundL2"},pressStyle:{opacity:.7},onPress:()=>{w&&(a(l),e.pop())}},ge.createElement(E.q,{fontSize:"$sm",color:"$baseTextMedEmphasis"},i.ag._({id:"sdifYg",values:{searchFilter:l}})),ge.createElement(E.q,{fontSize:"$xs",color:"$baseTextLowEmphasis",mt:"$1"},i.ag._({id:"9tfvum"})))):null,ge.createElement(g.Ci,{itemKey:S,itemCount:v.length,itemData:f,renderer:we}))},we=(0,d.memo)((function({index:e,data:t,style:a}){const n=t.validators[e],r=(0,d.useMemo)((()=>(0,s.PC)(n.commission)),[n.commission]),i=(0,d.useMemo)((()=>Number((0,C.dF)(n.stake.toString()))),[n.stake]);return ge.createElement(m.FA,{key:n.id,hoverStyle:{cursor:"pointer",backgroundColor:"$baseBackgroundL2"},paddingHorizontal:"$4",style:a,onPress:()=>t.onClickRow(n)},ge.createElement(ue.D,{props:{validator:{icon:n.icon||h.rI,name:n.name??`Validator ${n.id}`},state:`${t.formatter.format(i)} MON`,amount:`${r}% Fee`,reward:void 0}}))}));var Ee=a(323486),Se=a(927809),ke=a(202784),fe=function(e){return e.ListMonadStakesScreen="ListMonadStakesScreen",e.NewMonadStakeScreen="NewMonadStakeScreen",e.MonadStakeConfirmationScreen="MonadStakeConfirmationScreen",e.MonadStakeDetailScreen="MonadStakeDetailScreen",e.MonadValidatorSelectorScreen="MonadValidatorSelectorScreen",e}({});const ye=(0,o.fC)();function be({route:e}){const t=(0,r.F)(),{info:a}=(0,n.rT)();return ke.createElement(ye.Navigator,{screenOptions:()=>Ee.FR},ke.createElement(ye.Screen,{name:"ListMonadStakesScreen",component:I,options:({navigation:e})=>({title:i.ag._({id:"7usHdl"}),headerRight:"view-only"!==a.type?()=>ke.createElement(Ee.qy,{onPress:()=>e.push("NewMonadStakeScreen"),backImage:()=>ke.createElement(l.v,{color:t.baseIcon.val})}):void 0,...(0,Ee.kt)(!1,e,"go-back")})}),ke.createElement(ye.Screen,{name:"NewMonadStakeScreen",component:z,options:({navigation:e})=>({title:i.ag._({id:"ai72ZW"}),...(0,Ee.kt)(!1,e)})}),ke.createElement(ye.Screen,{name:"MonadStakeDetailScreen",component:ie,options:({navigation:e})=>({title:i.ag._({id:"4U46F0"}),...(0,Ee.kt)(!1,e,"go-back")})}),ke.createElement(ye.Screen,{name:"MonadValidatorSelectorScreen",component:pe,options:({navigation:e})=>({title:i.ag._({id:"0CheVO"}),...(0,Ee.kt)(!1,e,"go-back")})}),ke.createElement(ye.Screen,{name:"MonadStakeConfirmationScreen",component:X,options:({route:e,navigation:t})=>({title:e.params.progressTitle,...(0,Ee.kt)(!0,t,"pop-root-go-back")})}),(0,Se.n)(ye))}},237462:(e,t,a)=>{a.d(t,{$y:()=>g,BC:()=>k,Bi:()=>y,Gj:()=>E,Iw:()=>m,Km:()=>F,PC:()=>T,Qv:()=>B,YZ:()=>h,iv:()=>w,ml:()=>A,rD:()=>S,tm:()=>b,u7:()=>u,wl:()=>f});var n=a(202784),r=a(817967),i=a(44171),o=a(66046),l=a(343628),d=a(400752),c=a(887388);function s(e){return e===r.Ek.MONAD_TESTNET||e===r.Ek.MONAD_MAINNET}const m=5e4,u=.4,g=e=>{const t=(0,d.Dv)((0,o.WK)(e));return(0,l.a)({queryKey:["monadStaking",e,"epoch"],enabled:s(e),queryFn:async()=>{const[e,a]=await Promise.all([t.Stake.getEpoch(),t.provider.getBlockNumber()]);return{...e,blockNumber:BigInt(a)}}})};async function p(e){try{const t=e===r.Ek.MONAD_TESTNET?"testnet":"mainnet",a=`${i.qv}?network=${t}`,n=await fetch(a);return n.ok?await n.json():(console.error(`Failed to fetch validator metadata from API: ${n.status}`),{})}catch(e){return console.error("Error fetching validator metadata from API:",e),{}}}const h=e=>{const t=(0,d.Dv)((0,o.WK)(e));return(0,l.a)({queryKey:["monadStaking",e,"validators"],enabled:s(e),refetchOnMount:!1,staleTime:3e5,queryFn:async()=>{try{const a=await p(e),n=Object.keys(a).map((e=>e)),r=await t.Stake.getValidatorsBatch({validatorIds:n}),i=[];for(let e=0;e<n.length;e++){const t=n[e],o=r[e];if(o&&(o.stake>BigInt(0)||"0x0000000000000000000000000000000000000000"!==o.authAddress)){const e=a[t];i.push({id:t,authAddress:o.authAddress,stake:o.stake,commission:o.commission,name:e?.name,icon:e?.logo,details:e?.description,url:e?.website,apy:void 0})}}return i.sort(((e,t)=>"97"===e.id?-1:"97"===t.id?1:0)),i}catch(e){throw console.error("Error in useMonadValidatorsQuery:",e),e}}})},v=(e,t)=>{const a=(0,d.Dv)((0,o.WK)(e));return(0,l.a)({queryKey:["monadStaking",e,t,"delegations"],enabled:s(e)&&Boolean(t),queryFn:async()=>{const n=await a.Stake.getDelegations({delegatorAddress:t}),r=await p(e),i=Object.keys(r).map((e=>e)),o=await(a.Stake.getValidatorsWithPotentialWithdrawals?.({delegatorAddress:t,validatorIds:i}))??[],l=Array.from(new Set([...n.map(String),...o.map(String)])).map((e=>BigInt(e)));return await Promise.all(l.map((async e=>{const[n,r]=await Promise.all([a.Stake.getDelegator({validatorId:e.toString(),delegatorAddress:t}),a.Stake.getValidator({validatorId:e.toString()})]),i=n.stake*(r.accRewardPerToken-n.accRewardPerToken)/BigInt(10**18)+n.unclaimedRewards,o=i>BigInt(0);return{validatorId:e.toString(),activeStake:n.stake,rewards:i,pendingStake:n.deltaStake,pendingActivationEpoch:n.deltaEpoch,can:{withdraw:n.stake>BigInt(0),claim:o}}})))}})},w=(e,t)=>{const a=v(e,t),r=h(e),i=(0,n.useMemo)((()=>{if(!a.data||!r.data)return[];const e=new Map(r.data.map((e=>[e.id,e]))),t=a.data.map((t=>{const a=e.get(t.validatorId);return{...t,validator:a}}));return t.sort(((e,t)=>{const a=Number(t.activeStake-e.activeStake);return 0!==a?a:e.validatorId.localeCompare(t.validatorId)})),t}),[a.data,r.data]);return(0,n.useMemo)((()=>({hasLoadedSomeData:a.isFetched&&r.isFetched,data:i,isLoading:a.isLoading||r.isLoading})),[a.isFetched,r.isFetched,i,a.isLoading,r.isLoading])},E=(e,t)=>{const a=(0,d.Dv)((0,o.WK)(e)),n=g(e),r=v(e,t);return(0,l.a)({queryKey:["monadStaking",e,t,"withdrawals"],enabled:s(e)&&Boolean(t)&&Boolean(r.data),queryFn:async()=>{const e=n.data?.epoch??BigInt(0);if(!r.data||0===r.data.length)return[];const i=r.data.map((e=>e.validatorId));return(await a.Stake.getAllWithdrawalsBatched({delegatorAddress:t,validatorIds:i,maxWithdrawalSlots:x})).map((t=>({validatorId:t.validatorId,withdrawalId:t.withdrawalId,amount:t.withdrawalAmount,epoch:t.withdrawEpoch,isWithdrawable:t.withdrawEpoch<e})))}})},S=(e,t,a)=>{const r=(0,d.Dv)((0,o.WK)(e)),i=g(e),[l,c]=(0,n.useState)([]);return(0,n.useEffect)((()=>{let e=!0;return async function(){if(i.data)try{const n=[];for(let e=1;e<=x;e++)try{const o=await r.Stake.getWithdrawalRequest({validatorId:a,delegatorAddress:t,withdrawalId:e});if(o.withdrawalAmount>BigInt(0)){const t=o.withdrawEpoch<i.data.epoch;n.push({withdrawalId:e,amount:o.withdrawalAmount,withdrawEpoch:o.withdrawEpoch,isAvailable:t})}}catch(e){console.error(e)}e&&c(n)}catch(e){console.error(e)}}(),()=>{e=!1}}),[r,a,t,i.data]),l},k=(e,t)=>{const a=v(e,t);return{activeStake:a.data?.reduce(((e,t)=>e+t.activeStake+(t.pendingStake>BigInt(0)?t.pendingStake:BigInt(0))),BigInt(0))??BigInt(0),rewards:a.data?.reduce(((e,t)=>e+t.rewards),BigInt(0))??BigInt(0)}},f=(e,t)=>{const a=(0,d.Dv)((0,o.WK)(e)),{data:r,isLoading:i}=(0,l.a)({queryKey:["balance",t,e],enabled:s(e)&&Boolean(t),queryFn:async()=>await a.provider.getBalance(t)}),{data:m,isLoading:u}=(0,l.a)({queryKey:["monadStaking",e,"gasEstimate"],enabled:s(e),staleTime:3e4,queryFn:async()=>{const e=await a.provider.getFeeData();return BigInt(1e5)*((e.maxFeePerGas??e.gasPrice??BigInt(0))+(e.maxPriorityFeePerGas??BigInt(0)))}}),g=i||u;return(0,n.useMemo)((()=>{if(!r)return{balance:null,availableBalance:null,gasReserve:null,isLoading:g};const e=BigInt(r.toString()),t=(0,c.fi)(I),a=m?m*BigInt(2):t;return{balance:e,availableBalance:e>a?e-a:BigInt(0),gasReserve:a,isLoading:g}}),[r,m,g])},y=(e,t)=>{const a=(0,d.Dv)((0,o.WK)(e));return{delegate:async(e,n)=>await a.Stake.delegate({authority:t,amount:n,validatorId:e}),undelegate:async(e,n,r)=>await a.Stake.undelegate({authority:t,validatorId:e,amount:n,withdrawalId:r}),claimRewards:async e=>await a.Stake.claimRewards({authority:t,validatorId:e}),compound:async e=>await a.Stake.compound({authority:t,validatorId:e}),withdraw:async(e,n)=>await a.Stake.withdraw({authority:t,validatorId:e,withdrawalId:n}),findAvailableWithdrawalId:async e=>{for(let n=1;n<=x;n++)try{if((await a.Stake.getWithdrawalRequest({validatorId:e,delegatorAddress:t,withdrawalId:n})).withdrawalAmount===BigInt(0))return n}catch(e){return n}return 1},waitForTransaction:async e=>{await a.provider.waitForTransaction(e)}}},b=()=>{const e=(0,n.useRef)(!1);return(0,n.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),e},I="0.1",x=10,A=e=>e.activeStake+(e.pendingStake>BigInt(0)?e.pendingStake:BigInt(0)),B=(e,t)=>{if(null==e)return"0";const a=(0,c.dF)(e),n=t?.decimals??4,r=parseFloat(a).toFixed(n);return t?.appendTicker?`${r} MON`:r},F=e=>{const t=new Map;for(const a of e){const e=t.get(a.validatorId)??BigInt(0);t.set(a.validatorId,e+a.amount)}return t},T=(e,t=2)=>(e=>Number(e)/1e16)(e).toFixed(t)}}]);