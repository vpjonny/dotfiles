"use strict";(globalThis.webpackChunk_coral_xyz_app_extension=globalThis.webpackChunk_coral_xyz_app_extension||[]).push([[1233],{331454:function(e,t){var s=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicFieldsApiHelpers=void 0;class i{constructor(e){this.Provider=e,this.fetchCastDynamicFieldsOfTypeWithCursor=e=>s(this,void 0,void 0,(function*(){const{dynamicFields:t,nextCursor:s}=yield this.fetchDynamicFieldsOfTypeWithCursor(e),i=t.map((e=>e.objectId));return{dynamicFieldObjects:yield e.objectsFromObjectIds(i),nextCursor:s}})),this.fetchAllDynamicFieldsOfType=e=>s(this,void 0,void 0,(function*(){var t;let s,n=[];for(;;){const r=yield this.fetchDynamicFieldsOfTypeWithCursor(Object.assign(Object.assign({},e),{cursor:s,limit:null!==(t=e.limitStepSize)&&void 0!==t?t:i.constants.defaultLimitStepSize})),a=r.dynamicFields;if(n=[...n,...a],0===a.length||null===r.nextCursor)return n;s=r.nextCursor}})),this.fetchCastAllDynamicFieldsOfType=e=>s(this,void 0,void 0,(function*(){const t=(yield this.fetchAllDynamicFieldsOfType(e)).map((e=>e.objectId));return yield e.objectsFromObjectIds(t)})),this.fetchDynamicFieldsUntil=e=>s(this,void 0,void 0,(function*(){const{fetchFunc:t,isComplete:s,cursor:n,limitStepSize:r}=e;let a=[],o=null!=n?n:null;for(;;){const e=yield t({cursor:null!=o?o:void 0,limit:null!=r?r:i.constants.defaultLimitStepSize}),n=e.dynamicFieldObjects,d=e.nextCursor;if(a=[...a,...n],0===n.length||null===d)return{dynamicFieldObjects:a,nextCursor:d};if(s(a))return{dynamicFieldObjects:a,nextCursor:d};o=e.nextCursor}})),this.fetchDynamicFieldsOfTypeWithCursor=e=>s(this,void 0,void 0,(function*(){var t;const{parentObjectId:s,dynamicFieldType:n}=e,r=yield this.Provider.provider.getDynamicFields(Object.assign(Object.assign({},e),{limit:null!==(t=e.limit)&&void 0!==t?t:i.constants.defaultLimitStepSize,parentId:s}));return{dynamicFields:void 0===n?r.data:r.data.filter((e=>"string"==typeof n?e.objectType===n:n(e.objectType))),nextCursor:r.nextCursor}})),this.fetchDynamicFieldObject=e=>this.Provider.provider.getDynamicFieldObject(e)}}t.DynamicFieldsApiHelpers=i,i.constants={defaultLimitStepSize:256}},578230:function(e,t,s){var i,n=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EventsApiHelpers=void 0;const a=r(s(128879));class o{constructor(e){this.Provider=e,this.fetchSubscribeToUserEvents=e=>n(this,void 0,void 0,(function*(){const{address:t,onEvent:s}=e;return yield this.Provider.provider.subscribeEvent({filter:{Sender:t},onMessage:s})})),this.fetchCastEventsWithCursor=e=>n(this,void 0,void 0,(function*(){var t;const{query:s,eventFromEventOnChain:i,cursor:n,limit:r}=e,a=yield this.Provider.provider.queryEvents({query:s,cursor:n?Object.assign(Object.assign({},n),{eventSeq:null==n?void 0:n.eventSeq.toString()}):void 0,limit:r});return{events:a.data.map((e=>i(e))),nextCursor:null!==(t=a.nextCursor)&&void 0!==t?t:null}})),this.fetchEventsWithinTime=e=>n(this,void 0,void 0,(function*(){const{fetchEventsFunc:t,timeUnit:s,time:n,limitStepSize:r}=e;let o,d=0,c=[];for(;;){const e=yield t({cursor:o,limit:null!=r?r:i.constants.defaultLimitStepSize}),l=e.events,u=Date.now(),p=l.findIndex((e=>{if(void 0===e.timestamp)return!1;const t=a.default.unix(e.timestamp/1e3);return(0,a.default)(u).diff(t,s,!0)>n}));if(c=[...c,...p<0?l:l.slice(0,p)],0===l.length||null===e.nextCursor||p>=0)return c;if(o=e.nextCursor,d+=1,d>=i.constants.maxLoops)return c}})),this.fetchAllEvents=e=>n(this,void 0,void 0,(function*(){const{fetchEventsFunc:t,limitStepSize:s}=e;let n,r=[];for(;;){const e=yield t({cursor:n,limit:null!=s?s:i.constants.defaultLimitStepSize}),a=e.events;if(r=[...r,...a],0===a.length||null===e.nextCursor)return r;n=e.nextCursor}}))}}t.EventsApiHelpers=o,i=o,o.constants={defaultLimitStepSize:256,maxLoops:20},o.suiEventOfTypeOrUndefined=(e,t)=>e.type.includes("string"==typeof t?t:t())?e:void 0,o.castEventOfTypeOrUndefined=(e,t,s,i)=>{if(i?e.type===("string"==typeof t?t:t()):e.type.includes("string"==typeof t?t:t()))return s(e)},o.findCastEventsOrUndefined=e=>{const{events:t,eventType:s,castFunction:n}=e;return t.filter((e=>void 0!==i.suiEventOfTypeOrUndefined(e,s))).map((e=>n(e)))},o.findCastEventOrUndefined=e=>{const t=i.findCastEventsOrUndefined(e);if(!(t.length<=0))return t[0]},o.findCastEventInTransactionOrUndefined=(e,t,s)=>{var n;return i.findCastEventOrUndefined({events:null!==(n=e.events)&&void 0!==n?n:[],eventType:t,castFunction:s})},o.findCastEventInTransactionsOrUndefined=(e,t,s)=>{if(0!==e.length)return e.map((e=>i.findCastEventInTransactionOrUndefined(e,t,s))).find((e=>void 0!==e))},o.createEventType=(e,t,s,i)=>{const n=`${e}::${t}::${s}`;return i?`${i}<${n}>`:n}},793632:function(e,t){var s=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InspectionsApiHelpers=void 0;class i{constructor(e){this.Provider=e,this.fetchFirstBytesFromTxOutput=e=>s(this,void 0,void 0,(function*(){return(yield this.fetchAllBytesFromTxOutput(e))[0]})),this.fetchAllBytesFromTxOutput=e=>s(this,void 0,void 0,(function*(){const{allBytes:t}=yield this.fetchAllBytesFromTx(e);return t[t.length-1]})),this.fetchAllBytesFromTx=e=>s(this,void 0,void 0,(function*(){var t;const s=null!==(t=e.sender)&&void 0!==t?t:i.constants.devInspectSigner,n=yield this.Provider.provider.devInspectTransactionBlock({sender:s,transactionBlock:e.tx});if("failure"===n.effects.status.status)throw console.error(n.error),Error(n.effects.status.error);if(!n.results)throw Error("dev inspect move call returned no results");const r=n.results.map((e=>{var t,s;return null!==(s=null===(t=e.returnValues)||void 0===t?void 0:t.map((e=>e[0])))&&void 0!==s?s:[]}));return{events:n.events,effects:n.effects,allBytes:r}}))}}t.InspectionsApiHelpers=i,i.constants={devInspectSigner:"0xacb7cb045c3afac61381cdf272cd24ebe115f86361c9f06490482c238765aeb5"}},595878:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectsApiHelpers=void 0;const n=s(243333);class r{constructor(e){this.Provider=e,this.fetchDoesObjectExist=e=>i(this,void 0,void 0,(function*(){return void 0===(yield this.Provider.provider.getObject({id:e})).error})),this.fetchIsObjectOwnedByAddress=e=>i(this,void 0,void 0,(function*(){var t;const{objectId:s,walletAddress:i}=e,n=null===(t=(yield this.fetchObject({objectId:s})).data)||void 0===t?void 0:t.owner;return!(!n||"object"!=typeof n)&&("AddressOwner"in n&&n.AddressOwner===i||"ObjectOwner"in n&&n.ObjectOwner===i)})),this.fetchObjectsOfTypeOwnedByAddress=e=>i(this,void 0,void 0,(function*(){return this.fetchOwnedObjects(Object.assign(Object.assign({},e),{filter:{StructType:n.Helpers.stripLeadingZeroesFromType(e.objectType)}}))})),this.fetchOwnedObjects=e=>i(this,void 0,void 0,(function*(){var t;const{walletAddress:s,withDisplay:i,filter:n}=e;let a,o=[];for(;;){const d=yield this.Provider.provider.getOwnedObjects({owner:s,options:null!==(t=e.options)&&void 0!==t?t:{showContent:!0,showDisplay:i,showOwner:!0,showType:!0},limit:r.constants.maxObjectFetchingLimit,cursor:a,filter:n}),c=d.data;if(o=[...o,...c],0===d.data.length||!d.hasNextPage||!d.nextCursor)return o;a=d.nextCursor}})),this.fetchObject=e=>i(this,void 0,void 0,(function*(){const{objectId:t,withDisplay:s}=e;return yield this.fetchObjectGeneral({objectId:t,options:{showContent:!0,showDisplay:s,showOwner:!0,showType:!0}})})),this.fetchObjectGeneral=e=>i(this,void 0,void 0,(function*(){var t;const{objectId:s,options:i}=e,n=yield this.Provider.provider.getObject({id:s,options:i});if(void 0!==n.error)throw new Error(`an error occured fetching object: ${null===(t=n.error)||void 0===t?void 0:t.code}`);return n})),this.fetchCastObject=e=>i(this,void 0,void 0,(function*(){return e.objectFromSuiObjectResponse(yield this.fetchObject(e))})),this.fetchCastObjectGeneral=e=>i(this,void 0,void 0,(function*(){const{objectId:t,objectFromSuiObjectResponse:s,options:i}=e;return s(yield this.fetchObjectGeneral({objectId:t,options:i}))})),this.fetchObjectBatch=e=>i(this,void 0,void 0,(function*(){const{objectIds:t,options:s}=e;let i=[],n=0;for(;;){const e=n+r.constants.maxObjectFetchingLimit;if(e>=t.length){i.push(t.slice(n,t.length));break}i.push(t.slice(n,e)),n=e}const a=yield Promise.all(i.map((e=>this.Provider.provider.multiGetObjects({ids:e,options:void 0===s?{showContent:!0,showOwner:!0,showType:!0}:s}))));return a.reduce(((e,t)=>[...e,...t]),[])})),this.fetchCastObjectBatch=e=>i(this,void 0,void 0,(function*(){return(yield this.fetchObjectBatch(e)).map((t=>e.objectFromSuiObjectResponse(t)))})),this.fetchCastObjectsOwnedByAddressOfType=e=>i(this,void 0,void 0,(function*(){return(yield this.fetchObjectsOfTypeOwnedByAddress(e)).map((t=>e.objectFromSuiObjectResponse(t)))})),this.fetchObjectBcs=e=>i(this,void 0,void 0,(function*(){var t;const s=yield this.Provider.provider.getObject({id:e,options:{showBcs:!0}});if(void 0!==s.error)throw new Error(`an error occured fetching object: ${null===(t=s.error)||void 0===t?void 0:t.code}`);return s})),this.fetchCastObjectBcs=e=>i(this,void 0,void 0,(function*(){const{objectId:t}=e,s=yield this.Provider.Objects().fetchObjectBcs(t);return n.Casting.castObjectBcs(Object.assign(Object.assign({},e),{suiObjectResponse:s}))})),this.burnObjectTx=e=>i(this,void 0,void 0,(function*(){const{tx:t,object:s}=e;return t.transferObjects([s],"0x0")})),this.publicShareObjectTx=e=>i(this,void 0,void 0,(function*(){const{tx:t,object:s,objectType:i}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget("0x2","transfer","public_share_object"),typeArguments:[i],arguments:[s]})}))}}t.ObjectsApiHelpers=r,r.constants={maxObjectFetchingLimit:50}},480544:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionsApiHelpers=void 0;const n=s(108979),r=s(243333);class a{constructor(e){this.Provider=e,this.fetchTransactionsWithCursor=e=>i(this,void 0,void 0,(function*(){var t;const{query:s,cursor:i,limit:n}=e,r=yield this.Provider.provider.queryTransactionBlocks(Object.assign(Object.assign({},s),{cursor:i,limit:n,options:{showEvents:!0,showBalanceChanges:!0,showEffects:!0,showObjectChanges:!0,showInput:!0}}));return{transactions:r.data,nextCursor:null!==(t=r.nextCursor)&&void 0!==t?t:null}})),this.fetchSetGasBudgetForTx=e=>i(this,void 0,void 0,(function*(){const{tx:t}=e,[s,i]=yield Promise.all([this.Provider.provider.dryRunTransactionBlock({transactionBlock:yield t.build({client:this.Provider.provider})}),this.Provider.provider.getReferenceGasPrice()]),n=s.effects.gasUsed,r=BigInt(n.computationCost)+BigInt(n.storageCost),a=r+r/BigInt(10);return t.setGasBudget(a),t.setGasPrice(i),t})),this.fetchSetGasBudgetAndSerializeTx=e=>i(this,void 0,void 0,(function*(){const{tx:t,isSponsoredTx:s}=e;return s?(yield t).serialize():(yield this.fetchSetGasBudgetForTx({tx:yield t})).serialize()}))}static splitCoinTx(e){const{tx:t,coinType:s,coinId:i,amount:n}=e;return t.moveCall({target:this.createTxTarget("0x2","coin","split"),typeArguments:[s],arguments:["string"==typeof i?t.object(i):i,t.pure.u64(n)]})}}t.TransactionsApiHelpers=a,a.createTxTarget=(e,t,s)=>`${e}::${t}::${s}`,a.createBuildTxFunc=e=>t=>{const s=new n.Transaction;return s.setSender(t.walletAddress),e(Object.assign({tx:s},t)),s},a.serviceCoinDataFromCoinTxArg=e=>{const{coinTxArg:t}=e;if("string"==typeof t)return{Coin:r.Helpers.addLeadingZeroesToType(t)};if(!("$kind"in t)){if("function"==typeof t||"GasCoin"in t)throw new Error("unable to convert gas coin arg to service coin data");return t}if("NestedResult"===t.$kind)return{[t.$kind]:t.NestedResult};if("Result"===t.$kind)return{[t.$kind]:t.Result};if("GasCoin"===t.$kind)throw new Error("unable to convert gas coin arg to service coin data");return{[t.$kind]:t.Input}},a.serviceCoinDataV2FromCoinTxArg=e=>{const{coinTxArg:t}=e;if(!("$kind"in t)){if("Result"in t)return{Result:t.Result};if("NestedResult"in t)return{NestedResult:t.NestedResult};if("GasCoin"in t)return"Gas";if("Input"in t)return{Input:t.Input};throw new Error(`coinTxArg in format ${t} not supported`)}return"NestedResult"===t.$kind?{NestedResult:t.NestedResult}:"Result"===t.$kind?{Result:t.Result}:"GasCoin"===t.$kind?"Gas":{Input:t.Input}},a.coinTxArgFromServiceCoinData=e=>{const{serviceCoinData:t}=e,s=Object.keys(t)[0];if("Coin"===s)throw new Error("serviceCoinData in format { Coin: ObjectId } not supported");const i=s;return"NestedResult"===i?{NestedResult:Object.values(t)[0]}:"Input"===i?{Input:Object.values(t)[0]}:{Result:Object.values(t)[0]}},a.coinTxArgFromServiceCoinDataV2=e=>{const{serviceCoinDataV2:t}=e;if("string"==typeof t)return{GasCoin:!0};const s=Object.keys(t)[0],i=Object.values(t)[0];if("Result"===s&&"number"==typeof i)return{Result:i};if("NestedResult"===s&&"number"!=typeof i)return{NestedResult:i};if("Input"===s&&"number"==typeof i)return{Input:i};throw new Error(`serviceCoinDataV2 format ${JSON.stringify(t)} not supported`)},a.transferTxMetadata=e=>{const{initTx:t,newTx:s}=e,i=t.getData().sender;i&&s.setSender(i);const n=t.getData().expiration;n&&s.setExpiration(n);const r=t.getData().gasData;r.budget&&"string"!=typeof r.budget&&s.setGasBudget(r.budget),r.owner&&s.setGasOwner(r.owner),r.payment&&s.setGasPayment(r.payment),r.price&&"string"!=typeof r.price&&s.setGasPrice(r.price)}},28449:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicGas=void 0;const n=s(601151);class r extends n.Caller{constructor(e){super(e,"dynamic-gas")}getUseDynamicGasForTx(e){return i(this,void 0,void 0,(function*(){const{tx:t,walletAddress:s,gasCoinType:i}=e;return this.fetchApi("",{serializedTx:t.serialize(),walletAddress:s,gasCoinType:i})}))}}t.DynamicGas=r},414169:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},274167:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NftsApi=void 0;const n=s(243333);t.NftsApi=class{constructor(e){if(this.Provider=e,this.fetchOwnedNfts=e=>i(this,void 0,void 0,(function*(){const t=yield this.Provider.Objects().fetchOwnedObjects(Object.assign(Object.assign({},e),{options:{showContent:!0,showOwner:!0,showType:!0,showDisplay:!0}}));return n.Casting.nfts.nftsFromSuiObjects(t)})),this.fetchNfts=e=>i(this,void 0,void 0,(function*(){const t=yield this.Provider.Objects().fetchObjectBatch(Object.assign(Object.assign({},e),{options:{showContent:!0,showOwner:!0,showType:!0,showDisplay:!0}}));return n.Casting.nfts.nftsFromSuiObjects(t)})),this.fetchOwnedKioskOwnerCaps=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e,[s,i]=yield Promise.all([this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:"0x0000000000000000000000000000000000000000000000000000000000000002::kiosk::KioskOwnerCap",objectFromSuiObjectResponse:n.Casting.nfts.kioskOwnerCapFromSuiObject}),this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.personalKioskCap,objectFromSuiObjectResponse:n.Casting.nfts.kioskOwnerCapFromPersonalKioskCapSuiObject})]);return[...s,...i]})),this.fetchNftsInKiosk=e=>i(this,void 0,void 0,(function*(){const{kioskObjectId:t}=e;return this.Provider.DynamicFields().fetchCastAllDynamicFieldsOfType({parentObjectId:t,objectsFromObjectIds:e=>this.fetchNfts({objectIds:e})})})),this.fetchKioskOwnerCaps=e=>i(this,void 0,void 0,(function*(){const{kioskOwnerCapIds:t}=e;return this.Provider.Objects().fetchCastObjectBatch({objectIds:t,objectFromSuiObjectResponse:e=>{var t,s;return(null===(t=e.data)||void 0===t?void 0:t.type)&&n.Helpers.addLeadingZeroesToType(null===(s=e.data)||void 0===s?void 0:s.type)===this.objectTypes.personalKioskCap?n.Casting.nfts.kioskOwnerCapFromPersonalKioskCapSuiObject(e):n.Casting.nfts.kioskOwnerCapFromSuiObject(e)}})})),this.fetchKiosks=e=>i(this,void 0,void 0,(function*(){const{kioskOwnerCaps:t}=e,s=yield Promise.all(t.map((e=>this.fetchNftsInKiosk({kioskObjectId:e.kioskObjectId}))));return t.map(((e,t)=>({objectId:e.kioskObjectId,objectType:"0x0000000000000000000000000000000000000000000000000000000000000002::kiosk::Kiosk",kioskOwnerCapId:e.objectId,nfts:s[t],isPersonal:e.objectType===this.objectTypes.personalKioskCap})))})),this.fetchKiosksFromOwnerCaps=e=>i(this,void 0,void 0,(function*(){const t=yield this.fetchKioskOwnerCaps(e);return this.fetchKiosks({kioskOwnerCaps:t})})),this.fetchOwnedKiosks=e=>i(this,void 0,void 0,(function*(){const t=yield this.fetchOwnedKioskOwnerCaps(e),s=yield Promise.all(t.map((e=>this.fetchNftsInKiosk({kioskObjectId:e.kioskObjectId}))));return t.map(((e,t)=>({objectId:e.kioskObjectId,objectType:"0x0000000000000000000000000000000000000000000000000000000000000002::kiosk::Kiosk",kioskOwnerCapId:e.objectId,nfts:s[t],isPersonal:e.objectType===this.objectTypes.personalKioskCap})))})),!this.Provider.addresses.nfts)throw new Error("not all required addresses have been set in provider");this.addresses=this.Provider.addresses.nfts,this.objectTypes={personalKioskCap:`${this.addresses.packages.mystenTransferPolicy}::personal_kiosk::PersonalKioskCap`}}}},223172:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.NftsApiCasting=void 0;const n=s(308041);class r{}t.NftsApiCasting=r,i=r,r.nftsFromSuiObjects=e=>e.filter((e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.display})).map((e=>i.nftFromSuiObject(e))).filter((e=>Object.keys(e.display.suggested).length>0||Object.keys(e.display.other).length>0)),r.nftFromSuiObject=e=>{const t=i.nftInfoFromSuiObject(e),s=n.Helpers.getObjectDisplay(e);return{info:t,display:i.nftDisplayFromDisplayFields(s)}},r.kioskOwnerCapFromSuiObject=e=>{const t=n.Helpers.getObjectFields(e);return{objectId:n.Helpers.getObjectId(e),objectType:n.Helpers.getObjectType(e),kioskObjectId:n.Helpers.addLeadingZeroesToType(t.for)}},r.kioskOwnerCapFromPersonalKioskCapSuiObject=e=>{const t=n.Helpers.getObjectFields(e);return{objectId:n.Helpers.getObjectId(e),objectType:n.Helpers.getObjectType(e),kioskObjectId:n.Helpers.addLeadingZeroesToType(t.cap.fields.for)}},r.nftInfoFromSuiObject=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectId(e);if(!s||!t)throw new Error("unable to obtain object info from sui object response");return{objectId:s,objectType:t}},r.nftDisplayFromDisplayFields=e=>{const t=e.data;if(null==t||null!==e.error)return{suggested:{},other:{}};const s=[{onChain:"name",offChain:"name"},{onChain:"link",offChain:"link"},{onChain:"image_url",offChain:"imageUrl"},{onChain:"description",offChain:"description"},{onChain:"project_url",offChain:"projectUrl"},{onChain:"creator",offChain:"creator"}];let i={},r=n.Helpers.deepCopy(t);for(const e of s)e.onChain in r&&(i[e.offChain]=r[e.onChain],delete r[e.onChain]);return{suggested:i,other:r}}},10866:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},406798:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},236297:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Prices=void 0;const n=s(601151);class r extends n.Caller{constructor(e){super(e,"price-info")}getCoinPriceInfo(e){return i(this,void 0,void 0,(function*(){const t=yield this.getCoinsToPriceInfo({coins:[e.coin]});return Object.values(t)[0]}))}getCoinsToPriceInfo(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("",e)}))}getCoinPrice(e){return i(this,void 0,void 0,(function*(){return(yield this.getCoinPriceInfo(e)).price}))}getCoinsToPrice(e){return i(this,void 0,void 0,(function*(){const t=yield this.getCoinsToPriceInfo(e);return Object.entries(t).reduce(((e,[t,s])=>Object.assign(Object.assign({},e),{[t]:s.price})),{})}))}}t.Prices=r},927805:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Aftermath=void 0;const n=s(593460),r=s(839659),a=s(826462),o=s(897399),d=s(251234),c=s(799167),l=s(308041),u=s(242885),p=s(601151),h=s(236297),m=s(646074),g=s(654921),v=s(98937),f=s(465417),b=s(28449),y=s(8900),T=s(494678),k=s(500504),x=s(626543),I=s(700587),j=s(503557);class O extends p.Caller{constructor(e,t){super({network:e,accessToken:void 0}),this.network=e,this.Provider=t,this.Pools=()=>new n.Pools(this.config,this.Provider),this.Staking=()=>new c.Staking(this.config,this.Provider),this.LeveragedStaking=()=>new m.LeveragedStaking(this.config),this.SuiFrens=()=>new a.SuiFrens(this.config,this.Provider),this.Faucet=()=>new d.Faucet(this.config,this.Provider),this.Router=()=>new m.Router(this.config),this.NftAmm=()=>new m.NftAmm(this.config,this.Provider),this.ReferralVault=()=>new m.ReferralVault(this.config,this.Provider),this.Perpetuals=()=>new g.Perpetuals(this.config),this.Oracle=()=>new v.Oracle(this.config,this.Provider),this.Farms=()=>new f.Farms(this.config,this.Provider),this.Dca=()=>new k.Dca(this.config),this.Multisig=()=>new x.Multisig(this.config,this.Provider),this.LimitOrders=()=>new I.LimitOrders(this.config),this.UserData=()=>new j.UserData(this.config),this.Sui=()=>new m.Sui(this.config,this.Provider),this.Prices=()=>new h.Prices(this.config),this.Wallet=e=>new r.Wallet(e,this.config,this.Provider),this.Coin=e=>new o.Coin(e,this.config,this.Provider),this.DynamicGas=()=>new b.DynamicGas(this.config),this.Auth=()=>new m.Auth(this.config)}init(e){return i(this,void 0,void 0,(function*(){var t;const s=yield this.getAddresses(),i=null!==(t=null==e?void 0:e.fullnodeUrl)&&void 0!==t?t:"LOCAL"===this.network?"http://127.0.0.1:9000":"DEVNET"===this.network?"https://fullnode.devnet.sui.io:443":"TESTNET"===this.network?"https://fullnode.testnet.sui.io:443":"https://fullnode.mainnet.sui.io:443";this.Provider=new y.AftermathApi(new T.SuiClient({transport:new T.SuiHTTPTransport({url:i})}),s)}))}getAddresses(){return i(this,void 0,void 0,(function*(){return this.fetchApi("addresses")}))}getApiBaseUrl(){return this.apiBaseUrl}}t.Aftermath=O,O.helpers=l.Helpers,O.casting=u.Casting},8900:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AftermathApi=void 0;const i=s(65055),n=s(660498),r=s(532812),a=s(331454),o=s(578230),d=s(793632),c=s(595878),l=s(480544),u=s(615344),p=s(153049),h=s(683040),m=s(666030),g=s(278614),v=s(528216),f=s(929972),b=s(409369),y=s(711460),T=s(107871),k=s(815700),x=s(767745),I=s(274167),j=s(243333),O=s(779604),C=s(512640),w=s(6157);class F{constructor(e,t){this.provider=e,this.addresses=t,this.DynamicFields=()=>new a.DynamicFieldsApiHelpers(this),this.Events=()=>new o.EventsApiHelpers(this),this.Inspections=()=>new d.InspectionsApiHelpers(this),this.Objects=()=>new c.ObjectsApiHelpers(this),this.Transactions=()=>new l.TransactionsApiHelpers(this),this.Wallet=()=>new p.WalletApi(this),this.Nfts=()=>new I.NftsApi(this),this.Coin=()=>new r.CoinApi(this),this.Sui=()=>new u.SuiApi(this),this.Pools=()=>new i.PoolsApi(this),this.Faucet=()=>new n.FaucetApi(this),this.SuiFrens=()=>new m.SuiFrensApi(this),this.Staking=()=>new g.StakingApi(this),this.NftAmm=()=>new v.NftAmmApi(this),this.ReferralVault=()=>new f.ReferralVaultApi(this),this.Perpetuals=()=>new b.PerpetualsApi(this),this.Oracle=()=>new y.OracleApi(this),this.Farms=()=>new T.FarmsApi(this),this.Dca=()=>new k.DcaApi(this),this.Multisig=()=>new O.MultisigApi(this),this.LimitOrders=()=>new w.LimitOrdersApi(this),this.UserData=()=>new C.UserDataApi(this),this.Router=()=>new h.RouterApi(this),this.LeveragedStaking=e=>new x.LeveragedStakingApi(this,e),this.translateMoveErrorMessage=e=>{const{errorMessage:t}=e,s=[this.Pools,this.Staking,this.Perpetuals,this.Farms,this.Router];for(const e of s)try{const s=e().moveErrors,i=j.Helpers.translateMoveErrorMessage({errorMessage:t,moveErrors:s});if(!i)continue;return i}catch(e){}}}}t.AftermathApi=F,F.helpers={dynamicFields:a.DynamicFieldsApiHelpers,events:o.EventsApiHelpers,inspections:d.InspectionsApiHelpers,objects:c.ObjectsApiHelpers,transactions:l.TransactionsApiHelpers,wallet:p.WalletApi,coin:r.CoinApi,sui:u.SuiApi}},911666:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(927805),t),n(s(8900),t)},308310:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},368732:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},417700:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(308310),t),n(s(368732),t),n(s(690370),t),n(s(10866),t),n(s(414169),t),n(s(406798),t)},690370:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},601151:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Caller=void 0;const n=s(108979),r=s(308041);class a{constructor(e={},t=""){this.config=e,this.apiUrlPrefix=t,this.urlForApiCall=e=>{if(void 0===this.apiBaseUrl)throw new Error("no apiBaseUrl: unable to fetch data");return`${"/"===this.apiBaseUrl.slice(-1)?this.apiBaseUrl.slice(0,-1):this.apiBaseUrl}/${this.apiEndpoint}/${this.apiUrlPrefix+(""===e?"":"/")}${e}`},this.setAccessToken=e=>{this.config.accessToken=e},this.apiBaseUrl=void 0===this.config.network?void 0:a.apiBaseUrlForNetwork(this.config.network),this.apiEndpoint="INTERNAL"===this.config.network?"af-fe":"api"}static fetchResponseToType(e,t){return i(this,void 0,void 0,(function*(){if(!e.ok)throw new Error(yield e.text());const s=JSON.stringify(yield e.json());return t?JSON.parse(s):r.Helpers.parseJsonWithBigint(s)}))}static apiBaseUrlForNetwork(e){return"MAINNET"===e?"https://aftermath.finance":"TESTNET"===e?"https://testnet.aftermath.finance":"DEVNET"===e?"https://devnet.aftermath.finance":"LOCAL"===e?"http://localhost:3000":"INTERNAL"===e?"http://":e}fetchApi(e,t,s,n){return i(this,void 0,void 0,(function*(){(null==n?void 0:n.disableBigIntJsonParsing)||(BigInt.prototype.toJSON=function(){return this.toString()+"n"});const i=this.urlForApiCall(e),r=Object.assign({"Content-Type":"application/json"},this.config.accessToken?{Authorization:`Bearer ${this.config.accessToken}`}:{}),o=yield void 0===t?fetch(i,{headers:r,signal:s}):fetch(i,{method:"POST",body:JSON.stringify(t),headers:r,signal:s});return yield a.fetchResponseToType(o,null==n?void 0:n.disableBigIntJsonParsing)}))}fetchApiTransaction(e,t,s,r){return i(this,void 0,void 0,(function*(){return n.Transaction.from(yield this.fetchApi(e,t,s,r))}))}fetchApiEvents(e,t,s,n){return i(this,void 0,void 0,(function*(){return this.fetchApi(e,t,s,n)}))}fetchApiIndexerEvents(e,t,s,n){return i(this,void 0,void 0,(function*(){var i,r;const a=yield this.fetchApi(e,t,s,n);return{events:a,nextCursor:a.length<(null!==(i=t.limit)&&void 0!==i?i:1)?void 0:a.length+(null!==(r=t.cursor)&&void 0!==r?r:0)}}))}}t.Caller=a},242885:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Casting=void 0;const n=s(941882),r=s(394234),a=s(268086),o=s(906023),d=s(974247),c=s(825309),l=s(947168),u=s(845963),p=s(930492),h=s(565033),m=s(583938),g=s(516230),v=s(838609),f=s(223172),b=s(250464);class y{static percentageToBps(e){const t=1e4*e;return BigInt(Math.round(t))}static bpsToPercentage(e){return Number(e)/1e4}static bcsBytesFromSuiObjectResponse(e){var t,s;const i=null===(t=e.data)||void 0===t?void 0:t.bcs;if(i&&"bcsBytes"in i)return i.bcsBytes;throw new Error(`no bcs bytes found on object: ${null===(s=e.data)||void 0===s?void 0:s.objectId}`)}}t.Casting=y,i=y,y.pools=d.PoolsApiCasting,y.suiFrens=r.SuiFrensApiCasting,y.faucet=a.FaucetApiCasting,y.staking=c.StakingApiCasting,y.leveragedStaking=g.LeveragedStakingApiCasting,y.nftAmm=o.NftAmmApiCasting,y.router=l.RouterApiCasting,y.perpetuals=h.PerpetualsApiCasting,y.oracle=b.OracleApiCasting,y.farms=m.FarmsApiCasting,y.nfts=f.NftsApiCasting,y.Fixed=u.FixedUtils,y.IFixed=p.IFixedUtils,y.u64MaxBigInt=BigInt("0xFFFFFFFFFFFFFFFF"),y.numberToFixedBigInt=e=>BigInt(Math.floor(e*i.Fixed.fixedOneN)),y.bigIntToFixedNumber=e=>Number(e)/i.Fixed.fixedOneN,y.scaleNumberByBigInt=(e,t)=>BigInt(Math.floor(e*Number(t))),y.stringFromBytes=e=>String.fromCharCode.apply(null,e),y.bigIntFromBytes=e=>BigInt("0x"+e.reverse().map((e=>e.toString(16).padStart(2,"0"))).join("")),y.addressFromBcsBytes=e=>v.Helpers.addLeadingZeroesToType(n.bcs.Address.parse(new Uint8Array(e))),y.addressFromBytes=e=>v.Helpers.addLeadingZeroesToType("0x"+e.map((e=>{const t=e.toString(16);return 1===t.length?"0"+t:t})).join("")),y.addressFromStringBytes=e=>i.addressFromBytes(i.bytesFromStringBytes(e)),y.bytesFromStringBytes=e=>e.map((e=>Number(e))),y.unwrapDeserializedOption=e=>"Some"in e?e.Some:void 0,y.u8VectorFromString=e=>{const t=(new TextEncoder).encode(e),s=[];for(const e of t.values())s.push(e);return s},y.normalizeSlippageTolerance=e=>e/100,y.castObjectBcs=e=>{const{suiObjectResponse:t,bcsType:s,fromDeserialized:n}=e;return n(s.fromBase64(i.bcsBytesFromSuiObjectResponse(t)))}},845963:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FixedUtils=void 0;class s{}t.FixedUtils=s,s.fixedOneN=1e18,s.fixedOneB=BigInt("1000000000000000000"),s.fixedOneN9=1e9,s.fixedOneB9=BigInt(1e9),s.convertFromInt=e=>Number(e),s.convertToInt=e=>BigInt(Math.floor(e)),s.directCast=e=>Number(e)/s.fixedOneN,s.directUncast=e=>BigInt(Math.floor(e*s.fixedOneN)),s.complement=e=>Math.max(0,1-Math.max(0,e)),s.normalizeAmount=(e,t)=>t*e,s.unnormalizeAmount=(e,t)=>t/e,s.castAndNormalize=(e,t)=>s.directCast(s.normalizeAmount(e,t)),s.uncastAndUnnormalize=(e,t)=>s.unnormalizeAmount(e,s.directUncast(t))},308041:function(e,t,s){var i,n=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Helpers=void 0;const r=s(331454),a=s(578230),o=s(793632),d=s(595878),c=s(480544),l=s(242885),u=s(404151),p=s(801406),h=s(953045),m=s(907867),g=s(306979);class v{static zip(e,t){const s=Math.min(e.length,t.length),i=[];for(let n=0;n<s;n++)i.push([e[n],t[n]]);return i}static removeCircularReferences(e,t=new WeakSet){if(e&&"object"==typeof e){if(t.has(e))return;if(t.add(e),Array.isArray(e))return e.map((e=>this.removeCircularReferences(e,t)));{const s=Object.entries(e).map((([e,s])=>[e,this.removeCircularReferences(s,t)]));return Object.fromEntries(s)}}return e}static isArrayOfStrings(e){return Array.isArray(e)&&e.every((e=>"string"==typeof e))}static getObjectType(e){var t,s;const n=null===(t=e.data)||void 0===t?void 0:t.type;if(n)return i.addLeadingZeroesToType(n);throw new Error("no object type found on "+(null===(s=e.data)||void 0===s?void 0:s.objectId))}static getObjectId(e){var t,s;const n=null===(t=e.data)||void 0===t?void 0:t.objectId;if(n)return i.addLeadingZeroesToType(n);throw new Error("no object id found on "+(null===(s=e.data)||void 0===s?void 0:s.type))}static getObjectFields(e){var t,s;try{return(null===(t=e.data)||void 0===t?void 0:t.content).fields}catch(t){throw new Error("no object fields found on "+(null===(s=e.data)||void 0===s?void 0:s.objectId))}}static getObjectDisplay(e){var t,s;const i=null===(t=e.data)||void 0===t?void 0:t.display;if(i)return i;throw new Error("no object display found on "+(null===(s=e.data)||void 0===s?void 0:s.objectId))}static parseMoveErrorMessage(e){const{errorMessage:t}=e;if(!t.toLowerCase().includes("moveabort"))return;const s=(e=>{const{errorMessage:t}=e,s=t.lastIndexOf(","),i=t.lastIndexOf(")");if(!(s<=0||i<=0||s>=i))try{const e=parseInt(t.slice(s+1,i));if(Number.isNaN(e))return;return e}catch(e){return}})({errorMessage:t}),n=(e=>{const{errorMessage:t}=e,s=t.toLowerCase().indexOf("address:"),n=t.indexOf(", name:");if(!(s<=0||n<=0||s>=n))try{const e=t.slice(s+8,n).trim().replaceAll("0x",""),r=i.addLeadingZeroesToType("0x"+e);if(!this.isValidHex(r))return;return r}catch(e){return}})({errorMessage:t}),r=(e=>{const{errorMessage:t}=e,s=t.toLowerCase().indexOf('identifier("'),i=t.indexOf('")');if(!(s<=0||i<=0||s>=i))try{return t.slice(s+12,i).trim()}catch(e){return}})({errorMessage:t});return void 0!==s&&n&&r?{errorCode:s,packageId:n,module:r}:void 0}static translateMoveErrorMessage(e){const{errorMessage:t,moveErrors:s}=e,i=this.parseMoveErrorMessage({errorMessage:t});if(i&&i.packageId in s&&i.module in s[i.packageId]&&i.errorCode in s[i.packageId][i.module])return Object.assign(Object.assign({},i),{error:s[i.packageId][i.module][i.errorCode]})}}t.Helpers=v,i=v,v.dynamicFields=r.DynamicFieldsApiHelpers,v.events=a.EventsApiHelpers,v.inspections=o.InspectionsApiHelpers,v.objects=d.ObjectsApiHelpers,v.transactions=c.TransactionsApiHelpers,v.stripLeadingZeroesFromType=e=>e.replaceAll(/x0+/g,"x"),v.addLeadingZeroesToType=e=>{let t=e.replace("0x",""),s="";if(t.includes("::")){const e=t.replace("0x","").split("::");s=e.slice(1).reduce(((e,t)=>e+"::"+t),""),t=e[0]}const i=t.length;if(i>64)throw new Error("invalid type length");return"0x"+Array(64-i).fill("0").join("")+t+s},v.splitNonSuiCoinType=e=>{const[t,s]=e.split(":");return t&&s?{chain:t,coinType:s}:{coinType:e,chain:"sui"}},v.isNumber=e=>/^\d*\.?\d*$/g.test(e),v.sum=e=>e.reduce(((e,t)=>e+t),0),v.sumBigInt=e=>e.reduce(((e,t)=>e+t),BigInt(0)),v.closeEnough=(e,t,s)=>Math.abs(e-t)<=s*Math.max(e,t),v.closeEnoughBigInt=(e,t,s)=>i.closeEnough(Number(e),Number(t),s),v.veryCloseInt=(e,t,s)=>Math.abs(Math.floor(e/s)-Math.floor(t/s))<=1,v.blendedOperations={mulNNN:(e,t)=>e*t,mulNNB:(e,t)=>BigInt(Math.floor(e*t)),mulNBN:(e,t)=>e*Number(t),mulNBB:(e,t)=>BigInt(Math.floor(e*Number(t))),mulBBN:(e,t)=>Number(e*t),mulBBB:(e,t)=>e*t},v.maxBigInt=(...e)=>e.reduce(((e,t)=>t>e?t:e)),v.minBigInt=(...e)=>e.reduce(((e,t)=>t<e?t:e)),v.absBigInt=e=>e<BigInt(0)?-e:e,v.capitalizeOnlyFirstLetter=e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),v.parseJsonWithBigint=(e,t=!1)=>JSON.parse(e,((e,s)=>"string"==typeof s&&/^-?\d+n$/.test(s)?BigInt(s.slice(0,-1)):t&&"string"==typeof s&&i.isNumber(s)?BigInt(s):s)),v.deepCopy=e=>{if(null===e)return e;if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e)){const t=[];return e.forEach((e=>{t.push(e)})),t.map((e=>i.deepCopy(e)))}if("object"==typeof e){const t=Object.assign({},e);return Object.keys(t).forEach((e=>{t[e]=i.deepCopy(t[e])})),t}return e},v.indexOfMax=e=>{if(0===e.length)return-1;let t=e[0],s=0;for(let i=1;i<e.length;i++)e[i]>t&&(s=i,t=e[i]);return s},v.uniqueArray=e=>[...new Set(e)],v.sleep=e=>new Promise((t=>setTimeout(t,e))),v.createUid=()=>Date.now().toString(36)+Math.random().toString(36).substring(2),v.bifilter=(e,t)=>{const s=[],i=[];for(let n=0;n<e.length;n++){const r=e[n];t(r,n,e)?s[s.length]=r:i[i.length]=r}return[s,i]},v.bifilterAsync=(e,t)=>n(void 0,void 0,void 0,(function*(){const s=yield Promise.all(e.map(t));return i.bifilter(e,((e,t)=>s[t]))})),v.filterObject=(e,t)=>Object.keys(e).reduce(((s,i)=>{const n=e[i];return t(i,n)?Object.assign(Object.assign({},s),{[i]:n}):s}),{}),v.applySlippageBigInt=(e,t)=>e-BigInt(Math.floor(l.Casting.normalizeSlippageTolerance(t)*Number(e))),v.applySlippage=(e,t)=>e-l.Casting.normalizeSlippageTolerance(t)*e,v.isValidType=e=>{const t=e.trim();return t.startsWith("0x")&&t.length>=9&&t.indexOf("::")>=3&&t.lastIndexOf("::")>=6&&!t.endsWith(":")},v.isValidHex=e=>/^(0x)?[0-9A-F]+$/i.test(e),v.addTxObject=(e,t)=>"string"==typeof t?e.object(t):t,v.isValidSuiAddress=e=>(0,u.isValidSuiAddress)((()=>{if(!e.startsWith("0x")||e.length<3)return"";try{return i.addLeadingZeroesToType(e)}catch(e){return""}})()),v.keypairFromPrivateKey=e=>{const t=(0,p.decodeSuiPrivateKey)(e);switch(t.schema){case"ED25519":return h.Ed25519Keypair.fromSecretKey(t.secretKey);case"Secp256k1":return m.Secp256k1Keypair.fromSecretKey(t.secretKey);case"Secp256r1":return g.Secp256r1Keypair.fromSecretKey(t.secretKey);default:throw new Error(`unsupported schema \`${t.schema}\``)}}},930492:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.IFixedUtils=void 0;const n=s(242885);class r{}t.IFixedUtils=r,i=r,r.ONE=BigInt(1e18),r.GREATEST_BIT=BigInt(1)<<BigInt(255),r.NOT_GREATEST_BIT=(BigInt(1)<<BigInt(255))-BigInt(1),r.numberFromIFixed=e=>{const t=i.abs(e),s=Number(t/i.ONE),n=Number(t%i.ONE)/Number(i.ONE);return i.sign(e)*(s+n)},r.iFixedFromNumber=e=>{const t=BigInt(Math.floor(Math.abs(e)*Number(i.ONE)));return e<0?i.neg(t):t},r.abs=e=>e>=i.GREATEST_BIT?i.neg(e):e,r.sign=e=>e>=i.GREATEST_BIT?-1:e===BigInt(0)?0:1,r.neg=e=>(e^i.NOT_GREATEST_BIT)+BigInt(1)^i.GREATEST_BIT,r.iFixedFromBytes=e=>n.Casting.bigIntFromBytes(e),r.iFixedFromStringBytes=e=>i.iFixedFromBytes(n.Casting.bytesFromStringBytes(e))},243333:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(242885),t),n(s(308041),t)},839659:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Wallet=void 0;const n=s(601151);class r extends n.Caller{constructor(e,t,s){super(t,`wallet/${e}`),this.address=e,this.Provider=s,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Wallet();if(!t)throw new Error("missing AftermathApi Provider");return t}}getBalance(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchCoinBalance(Object.assign(Object.assign({},e),{walletAddress:this.address}))}))}getBalances(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("balances/coins",e)}))}getAllBalances(){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchAllCoinBalances({walletAddress:this.address})}))}getPastTransactions(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchPastTransactions(Object.assign(Object.assign({},e),{walletAddress:this.address}))}))}}t.Wallet=r},153049:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WalletApi=void 0;const n=s(308041);t.WalletApi=class{constructor(e){this.Provider=e,this.fetchCoinBalance=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,coin:s}=e,i=yield this.Provider.provider.getBalance({owner:t,coinType:n.Helpers.stripLeadingZeroesFromType(s)});return BigInt(i.totalBalance)})),this.fetchAllCoinBalances=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e;return(yield this.Provider.provider.getAllBalances({owner:t})).reduce(((e,t)=>Object.assign(Object.assign({},e),{[n.Helpers.addLeadingZeroesToType(t.coinType)]:BigInt(t.totalBalance)})),{})})),this.fetchPastTransactions=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,cursor:s,limit:i}=e;return yield this.Provider.Transactions().fetchTransactionsWithCursor({query:{filter:{FromAddress:t}},cursor:s,limit:i})}))}}},838609:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(911666),t),n(s(646074),t),n(s(617237),t),n(s(243333),t)},837959:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Auth=void 0;const n=s(601151),r=s(243333);class a extends n.Caller{constructor(e){super(e,"auth"),this.refreshTimer=null,this.isCanceled=!1}init(e){return i(this,void 0,void 0,(function*(){this.isCanceled=!1;const t=()=>i(this,void 0,void 0,(function*(){if(this.isCanceled)return;const{accessToken:s,expirationTimestamp:i}=yield this.getAccessToken(e);if(this.setAccessToken(s),this.isCanceled)return;const n=.9*(i-Date.now());this.refreshTimer=setTimeout(t,n)}));return yield t(),()=>{this.isCanceled=!0,this.refreshTimer&&clearTimeout(this.refreshTimer)}}))}adminCreateAuthAccount(e){return i(this,void 0,void 0,(function*(){const{walletAddress:t,signMessageCallback:s,accountName:i,accountWalletAddress:n,rateLimits:o}=e,d=a.createSerializedJson("AccountCreate",{sub:i,wallet_address:r.Helpers.addLeadingZeroesToType(n),rate_limits:o}),c=(new TextEncoder).encode(d),{signature:l}=yield s({message:c});return this.fetchApi("create-account",{signature:l,serializedJson:d,walletAddress:r.Helpers.addLeadingZeroesToType(t)})}))}getAccessToken(e){return i(this,void 0,void 0,(function*(){const{walletAddress:t,signMessageCallback:s}=e,i=a.createSerializedJson("GetAccessToken",{}),n=(new TextEncoder).encode(i),{signature:o}=yield s({message:n});return this.fetchApi("access-token",{signature:o,serializedJson:i,walletAddress:r.Helpers.addLeadingZeroesToType(t)})}))}static createSerializedJson(e,t){const s={date:Math.floor(Date.now()/1e3),nonce:Math.floor(1024*Math.random()*1024),method:e,value:t};return JSON.stringify(s)}}t.Auth=a},898862:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},267080:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(837959),t)},532812:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CoinApi=void 0;const n=s(897399),r=s(308041),a=s(480544);class o{constructor(e){this.Provider=e,this.fetchCoinWithAmountTx=e=>i(this,void 0,void 0,(function*(){const{tx:t,walletAddress:s,coinType:i,coinAmount:n,isSponsoredTx:r}=e;t.setSender(s);const a=yield this.fetchCoinsWithAtLeastAmount(e);return o.coinWithAmountTx({tx:t,coinData:a,coinAmount:n,coinType:i,isSponsoredTx:r})})),this.fetchCoinsWithAmountTx=e=>i(this,void 0,void 0,(function*(){const{tx:t,walletAddress:s,coinTypes:n,coinAmounts:r,isSponsoredTx:a}=e;t.setSender(s);const d=yield Promise.all(n.map(((t,s)=>i(this,void 0,void 0,(function*(){return this.fetchCoinsWithAtLeastAmount(Object.assign(Object.assign({},e),{coinAmount:r[s],coinType:t}))})))));let c=[];for(const[e,s]of d.entries()){const i=o.coinWithAmountTx({tx:t,coinData:s,coinAmount:r[e],coinType:n[e],isSponsoredTx:a});c=[...c,i]}return c})),this.fetchCoinsWithAtLeastAmount=e=>i(this,void 0,void 0,(function*(){let t,s=[];for(;;){const i=yield this.Provider.provider.getCoins(Object.assign(Object.assign({},e),{owner:e.walletAddress,cursor:t})),n=i.data;if(s=[...s,...n],0===i.data.length||!i.hasNextPage||!i.nextCursor){s.sort(((e,t)=>Number(BigInt(t.balance)-BigInt(e.balance))));let t=[],i=BigInt(0);for(const n of s)if(t.push(n),i+=BigInt(n.balance),i>=e.coinAmount)return t;throw new Error("wallet does not have coins of sufficient balance")}t=i.nextCursor}})),this.fetchAllCoins=e=>i(this,void 0,void 0,(function*(){let t,s=[];for(;;){const i=yield this.Provider.provider.getCoins(Object.assign(Object.assign({},e),{owner:e.walletAddress,cursor:t})),n=i.data;if(s=[...s,...n],0===i.data.length||!i.hasNextPage||!i.nextCursor)return s.sort(((e,t)=>Number(BigInt(e.coinObjectId)-BigInt(t.coinObjectId))));t=i.nextCursor}}))}}t.CoinApi=o,o.coinWithAmountTx=e=>{const{tx:t,coinData:s,coinAmount:i,coinType:o,isSponsoredTx:d}=e;if(s.length<=0)throw new Error("wallet does not have coins of sufficient balance");const c=n.Coin.isSuiCoin(s[0].coinType);if(r.Helpers.sumBigInt(s.map((e=>BigInt(e.balance))))<i)throw new Error("wallet does not have coins of sufficient balance");if(!d&&c)return t.setGasPayment(s.map((e=>Object.assign(Object.assign({},e),{objectId:e.coinObjectId})))),t.splitCoins(t.gas,[i]);const l=s.map((e=>e.coinObjectId)),u=l[0];return l.length>1&&(d?t.add({$kind:"MergeCoins",MergeCoins:{destination:t.object(u),sources:[...l.slice(1).map((e=>t.object(e)))]}}):t.mergeCoins(t.object(u),[...l.slice(1).map((e=>t.object(e)))])),d?a.TransactionsApiHelpers.splitCoinTx({tx:t,coinId:u,amount:i,coinType:o}):t.splitCoins(u,[i])}},897399:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;const n=s(601151),r=s(308041),a=s(236297);class o extends n.Caller{constructor(e=void 0,t,s){super(t,"coins"),this.coinType=e,this.Provider=s,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Coin();if(!t)throw new Error("missing AftermathApi Provider");return t},this.coinType=e,this.coinTypePackageName=this.coinType?o.getCoinTypePackageName(this.coinType):"",this.coinTypeSymbol=this.coinType?o.getCoinTypeSymbol(this.coinType):"",this.innerCoinType=this.coinType?o.getInnerCoinType(this.coinType):""}getCoinsToDecimals(e){return i(this,void 0,void 0,(function*(){const{coins:t}=e;return(yield this.getCoinMetadatas(e)).map((e=>e.decimals)).reduce(((e,s,i)=>Object.assign(Object.assign({},e),{[t[i]]:s})),{})}))}getCoinMetadata(e){return i(this,void 0,void 0,(function*(){var t;if(this.metadata)return this.metadata;const s=null!==(t=this.coinType)&&void 0!==t?t:e;if(!s)throw new Error("no valid coin type");const[i]=yield this.getCoinMetadatas({coins:[s]});return this.setCoinMetadata(i),i}))}getCoinMetadatas(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("metadata",e)}))}setCoinMetadata(e){this.metadata=e}getPrice(e){return i(this,void 0,void 0,(function*(){var t;if(void 0!==this.priceInfo)return this.priceInfo;const s=null!==(t=this.coinType)&&void 0!==t?t:e;if(!s)throw new Error("no valid coin type");const i=yield new a.Prices(this.config).getCoinPriceInfo({coin:s});return this.setPriceInfo(i),i}))}setPriceInfo(e){this.priceInfo=e}getVerifiedCoins(){return i(this,void 0,void 0,(function*(){return this.fetchApi("verified")}))}}t.Coin=o,o.constants={suiCoinType:"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",suiCoinDecimals:9,coinObjectType:"0x0000000000000000000000000000000000000000000000000000000000000002::coin::Coin",defaultCoinDecimals:{sui:9,evm:18,svm:9}},o.getCoinTypePackageName=e=>{const t=e.split("::");if(3!==t.length)return"";return t[t.length-2]||""},o.getCoinTypeSymbol=e=>{const t=e.lastIndexOf("::")+2;if(t<=1)return"";const s=e.indexOf(">"),i=s<0?e.length:s;return e.slice(t,i)},o.getInnerCoinType=e=>e.includes("<")?e.split("<")[1].slice(0,-1):"",o.coinTypeFromKeyType=e=>{const t=e.lastIndexOf("<")+1,s=e.indexOf(">",t);return e.slice(t,s)},o.isSuiCoin=e=>r.Helpers.stripLeadingZeroesFromType(e)===r.Helpers.stripLeadingZeroesFromType(o.constants.suiCoinType),o.isCoinObjectType=e=>r.Helpers.stripLeadingZeroesFromType(e).startsWith(r.Helpers.stripLeadingZeroesFromType(o.constants.coinObjectType)),o.coinsAndAmountsOverZero=e=>({coins:Object.keys(e).filter((t=>e[t]>0)),amounts:Object.values(e).filter((e=>e>0))}),o.coinsAndBalancesOverZero=e=>({coins:Object.keys(e).filter((t=>BigInt(e[t])>BigInt(0))),balances:Object.values(e).map(BigInt).filter((e=>e>BigInt(0)))}),o.filterCoinsByType=e=>{var t;const s=e.filter.toLowerCase().trim();return null===(t=e.coinTypes)||void 0===t?void 0:t.filter((e=>{try{return r.Helpers.stripLeadingZeroesFromType(e).toLowerCase().includes(r.Helpers.stripLeadingZeroesFromType(s))||e.toLowerCase().includes(r.Helpers.addLeadingZeroesToType(s))}catch(e){}return r.Helpers.stripLeadingZeroesFromType(e).toLowerCase().includes(s)||e.toLowerCase().includes(s)}))},o.filterCoinsByMetadata=e=>{var t;return null===(t=Object.entries(e.coinMetadatas))||void 0===t?void 0:t.filter((([t,s])=>{const i=e.filter.toLowerCase().trim();return t.startsWith(i)||[s.name,s.symbol].some((e=>e.toLowerCase().includes(i)))})).map((([e])=>e))},o.normalizeBalance=(e,t)=>BigInt(Math.floor(e*Math.pow(10,t))),o.balanceWithDecimals=(e,t)=>Number(e)/Number(Math.pow(10,t)),o.balanceWithDecimalsUsd=(e,t,s)=>o.balanceWithDecimals(e,t)*s,o.coinSymbolForCoinType=e=>{const{coinType:t,coinSymbolToCoinTypes:s}=e;try{const e=r.Helpers.addLeadingZeroesToType(t),i=Object.entries(s).find((([,t])=>t.map(r.Helpers.addLeadingZeroesToType).includes(e)));return null==i?void 0:i[0]}catch(e){return}}},261662:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},302416:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(897399),t)},815700:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcaApi=void 0;const i=s(578230),n=s(243333);class r{constructor(e){this.Provider=e,this.createCloseOrderTx=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.dca,r.constants.moduleNames.dca,"close_order"),typeArguments:[e.allocateCoinType,e.buyCoinType],arguments:["string"==typeof e.orderId?t.object(e.orderId):e.orderId,t.object(this.addresses.objects.config)]})},this.createdOrderEventType=()=>i.EventsApiHelpers.createEventType(this.addresses.packages.events,r.constants.moduleNames.events,r.constants.eventNames.createdOrder),this.createdOrderEventTypeV2=()=>i.EventsApiHelpers.createEventType(this.addresses.packages.eventsV2,r.constants.moduleNames.events,r.constants.eventNames.createdOrderV2),this.closedOrderEventType=()=>i.EventsApiHelpers.createEventType(this.addresses.packages.events,r.constants.moduleNames.events,r.constants.eventNames.closedOrder),this.executedOrderEventType=()=>i.EventsApiHelpers.createEventType(this.addresses.packages.events,r.constants.moduleNames.events,r.constants.eventNames.executedTrade);const t=this.Provider.addresses.dca;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t,this.eventTypes={createdOrder:this.createdOrderEventType(),createdOrderV2:this.createdOrderEventTypeV2(),closedOrder:this.closedOrderEventType(),executedTrade:this.executedOrderEventType()}}}t.DcaApi=r,r.constants={moduleNames:{dca:"order",events:"events",config:"config"},eventNames:{createdOrder:"CreatedOrderEvent",createdOrderV2:"CreatedOrderEventV2",closedOrder:"ClosedOrderEvent",executedTrade:"ExecutedTradeEvent"}}},500504:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Dca=void 0;const n=s(601151);class r extends n.Caller{constructor(e){super(e,"dca")}getAllDcaOrders(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("orders",e)}))}getActiveDcaOrders(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("active",e)}))}getPastDcaOrders(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("past",e)}))}getCreateDcaOrderTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/create-order",e)}))}closeDcaOrder(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("cancel",e)}))}closeDcaOrdersMessageToSign(e){return{action:"CANCEL_DCA_ORDERS",order_object_ids:e.orderIds}}createUserAccountMessageToSign(){return{action:"CREATE_DCA_ACCOUNT"}}getUserPublicKey(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("user/get",e)}))}createUserPublicKey(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("/user/add",e)}))}}t.Dca=r,r.constants={gasAmount:BigInt(5e7)}},107871:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FarmsApi=void 0;const n=s(243333),r=s(578230),a=s(851693),o=s(108979),d=s(646074);class c{constructor(e){this.Provider=e,this.fetchOwnedStakingPoolOwnerCaps=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e,[s,i]=yield Promise.all([this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.stakingPoolOwnerCapV1,objectFromSuiObjectResponse:n.Casting.farms.stakingPoolOwnerCapObjectFromSuiObjectResponseV1}),this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.stakingPoolOwnerCapV2,objectFromSuiObjectResponse:n.Casting.farms.stakingPoolOwnerCapObjectFromSuiObjectResponseV2})]);return[...s,...i]})),this.fetchOwnedStakingPoolOneTimeAdminCaps=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e,[s,i]=yield Promise.all([this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.stakingPoolOneTimeAdminCapV1,objectFromSuiObjectResponse:n.Casting.farms.stakingPoolOneTimeAdminCapObjectFromSuiObjectResponseV1}),this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.stakingPoolOneTimeAdminCapV2,objectFromSuiObjectResponse:n.Casting.farms.stakingPoolOneTimeAdminCapObjectFromSuiObjectResponseV2})]);return[...s,...i]})),this.fetchOwnedPartialStakedPositions=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e,[s,i]=yield Promise.all([this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.stakedPositionV1,objectFromSuiObjectResponse:n.Casting.farms.partialStakedPositionObjectFromSuiObjectResponseV1}),this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.stakedPositionV2,objectFromSuiObjectResponse:n.Casting.farms.partialStakedPositionObjectFromSuiObjectResponseV2})]);return[...s,...i]})),this.stakeTxV1=e=>{const{tx:t,stakeCoinId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"stake"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId),"string"==typeof s?t.object(s):s,t.pure.u64(e.lockDurationMs)]})},this.stakeTxV2=e=>{const{tx:t,stakeCoinId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"stake"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId),"string"==typeof s?t.object(s):s,t.pure.u8("Strict"===e.lockEnforcement?0:1),t.pure.u64(e.lockDurationMs)]})},this.depositPrincipalTxV1=e=>{const{tx:t,stakeCoinId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"deposit_principal"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId),"string"==typeof s?t.object(s):s]})},this.depositPrincipalTxV2=e=>{const{tx:t,stakeCoinId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"deposit_principal"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId),"string"==typeof s?t.object(s):s]})},this.withdrawPrincipalTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"withdraw_principal"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId),t.pure.u64(e.withdrawAmount)]})},this.withdrawPrincipalTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"withdraw_principal"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId),t.pure.u64(e.withdrawAmount)]})},this.destroyStakedPositionTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"destroy"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId)]})},this.destroyStakedPositionTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"destroy"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(this.addresses.objects.version)]})},this.updatePositionTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"update_position"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId)]})},this.updatePositionTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"update_position"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId)]})},this.lockTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"lock"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId),t.pure.u64(e.lockDurationMs)]})},this.lockTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"lock"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId),t.pure.u64(e.lockDurationMs)]})},this.renewLockTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"renew_lock"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId)]})},this.renewLockTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"renew_lock"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId),t.object(this.addresses.objects.version)]})},this.unlockTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"unlock"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId)]})},this.unlockTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"unlock"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId)]})},this.beginHarvestTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"begin_harvest"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakingPoolId)]})},this.beginHarvestTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"begin_harvest_tx"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version)]})},this.harvestRewardsTxV1=e=>{const{tx:t,harvestedRewardsEventMetadataId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"harvest_rewards"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(e.stakedPositionId),t.object(e.stakingPoolId),"string"==typeof s?t.object(s):s,t.object(a.Sui.constants.addresses.suiClockId)]})},this.harvestRewardsTxV2=e=>{const{tx:t,harvestRewardsCap:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"harvest_rewards"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:["string"==typeof s?t.object(s):s,t.object(e.stakedPositionId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId)]})},this.endHarvestTxV1=e=>{const{tx:t,harvestedRewardsEventMetadataId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.stakedPosition,"end_harvest"),typeArguments:[],arguments:["string"==typeof s?t.object(s):s]})},this.endHarvestTxV2=e=>{const{tx:t,harvestRewardsCap:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.stakedPosition,"end_harvest_tx"),typeArguments:[],arguments:["string"==typeof s?t.object(s):s,t.object(this.addresses.objects.version)]})},this.newStakingPoolTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"new"),typeArguments:[e.stakeCoinType],arguments:[t.pure.u64("Strict"===e.lockEnforcement?0:1),t.pure.u64(e.minLockDurationMs),t.pure.u64(e.maxLockDurationMs),t.pure.u64(e.maxLockMultiplier),t.pure.u64(e.minStakeAmount)]})},this.newStakingPoolTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,"new"),typeArguments:[e.stakeCoinType],arguments:[t.object(this.addresses.objects.version),t.pure.vector("u8",e.lockEnforcements.map((e=>"Strict"===e?0:1))),t.pure.u64(e.minLockDurationMs),t.pure.u64(e.maxLockDurationMs),t.pure.u64(e.maxLockMultiplier),t.pure.u64(e.minStakeAmount)]})},this.shareStakingPoolTxV1=e=>{const{tx:t,stakingPoolId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"share_vault"),typeArguments:[e.stakeCoinType],arguments:["string"==typeof s?t.object(s):s]})},this.shareStakingPoolTxV2=e=>{const{tx:t,stakingPoolId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,"share"),typeArguments:[e.stakeCoinType],arguments:["string"==typeof s?t.object(s):s]})},this.transferOwnerCapTxV1=e=>{const{tx:t,ownerCapId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"transfer_owner_cap"),typeArguments:[],arguments:["string"==typeof s?t.object(s):s,t.pure.address(e.recipientAddress)]})},this.grantOneTimeAdminCapTxV1=e=>{const{tx:t,ownerCapId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"grant_one_time_admin_cap"),typeArguments:[e.rewardCoinType],arguments:["string"==typeof s?t.object(s):s,t.pure.address(e.recipientAddress)]})},this.grantOneTimeAdminCapTxV2=e=>{const{tx:t,ownerCapId:s}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,"grant_one_time_admin_cap"),typeArguments:[e.rewardCoinType],arguments:["string"==typeof s?t.object(s):s,t.object(this.addresses.objects.version),t.pure.address(e.recipientAddress)]})},this.initializeStakingPoolRewardTxV1=e=>{const{tx:t,rewardCoinId:s}=e,i=c.isFarmOneTimeAdminCapId(e),r=c.farmCapId(e);return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,i?"initialize_reward_and_consume_admin_cap":"initialize_reward"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(r),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId),"string"==typeof s?t.object(s):s,t.pure.u64(e.emissionScheduleMs),t.pure.u64(e.emissionRate),t.pure.u64(e.emissionDelayTimestampMs)]})},this.initializeStakingPoolRewardTxV2=e=>{const{tx:t,rewardCoinId:s}=e,i=c.isFarmOneTimeAdminCapId(e),r=c.farmCapId(e);return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,i?"initialize_reward_and_consume_admin_cap":"initialize_reward"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(r),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId),"string"==typeof s?t.object(s):s,t.pure.u64(e.emissionScheduleMs),t.pure.u64(e.emissionRate),t.pure.u64(e.emissionDelayTimestampMs)]})},this.topUpStakingPoolRewardTxV1=e=>{const{tx:t,rewardCoinId:s}=e,i=c.isFarmOneTimeAdminCapId(e),r=c.farmCapId(e);return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,i?"add_reward_and_consume_admin_cap":"add_reward"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(r),t.object(e.stakingPoolId),"string"==typeof s?t.object(s):s]})},this.topUpStakingPoolRewardTxV2=e=>{const{tx:t,rewardCoinId:s}=e,i=c.isFarmOneTimeAdminCapId(e),r=c.farmCapId(e);return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,i?"add_reward_and_consume_admin_cap":"add_reward"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(r),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),"string"==typeof s?t.object(s):s]})},this.increaseStakingPoolRewardEmissionsTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"update_emissions_for"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(e.ownerCapId),t.object(e.stakingPoolId),t.object(a.Sui.constants.addresses.suiClockId),t.pure.u64(e.emissionScheduleMs),t.pure.u64(e.emissionRate)]})},this.increaseStakingPoolRewardEmissionsTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,"update_emission_schedule"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(e.ownerCapId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.object(a.Sui.constants.addresses.suiClockId),t.pure.u64(e.emissionScheduleMs),t.pure.u64(e.emissionRate)]})},this.setStakingPoolMinStakeAmountTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"set_min_stake_amount"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.ownerCapId),t.object(e.stakingPoolId),t.pure.u64(e.minStakeAmount)]})},this.setStakingPoolMinStakeAmountTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,"set_min_stake_amount"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.ownerCapId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.pure.u64(e.minStakeAmount)]})},this.removeStakingPoolRewardTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"remove_reward"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(e.ownerCapId),t.object(e.stakingPoolId),t.pure.u64(e.rewardAmount)]})},this.removeStakingPoolRewardTxV2=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaultsV2,c.constants.moduleNames.vaultV2,"remove_reward"),typeArguments:[e.stakeCoinType,e.rewardCoinType],arguments:[t.object(e.ownerCapId),t.object(e.stakingPoolId),t.object(this.addresses.objects.version),t.pure.u64(e.rewardAmount)]})},this.isVaultUnlockedTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"is_vault_unlocked"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakingPoolId)]})},this.remainingRewardsTxV1=e=>{const{tx:t}=e;return t.moveCall({target:n.Helpers.transactions.createTxTarget(this.addresses.packages.vaults,c.constants.moduleNames.vaultV1,"remaining_rewards"),typeArguments:[e.stakeCoinType],arguments:[t.object(e.stakingPoolId)]})},this.fetchBuildStakeTxV1=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);const n=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:e.stakeCoinType,coinAmount:e.stakeAmount,isSponsoredTx:s}),r=this.stakeTxV1(Object.assign(Object.assign({},e),{tx:i,stakeCoinId:n}));return i.transferObjects([r],t),i})),this.fetchBuildStakeTxV2=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);const n=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:e.stakeCoinType,coinAmount:e.stakeAmount,isSponsoredTx:s}),r=this.stakeTxV2(Object.assign(Object.assign({},e),{tx:i,stakeCoinId:n,lockEnforcement:"Strict"}));return i.transferObjects([r],t),i})),this.fetchBuildDepositPrincipalTxV1=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);const n=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:e.stakeCoinType,coinAmount:e.depositAmount,isSponsoredTx:s});return this.depositPrincipalTxV1(Object.assign(Object.assign({},e),{tx:i,stakeCoinId:n})),i})),this.fetchBuildDepositPrincipalTxV2=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);const n=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:e.stakeCoinType,coinAmount:e.depositAmount,isSponsoredTx:s});return this.depositPrincipalTxV2(Object.assign(Object.assign({},e),{tx:i,stakeCoinId:n})),i})),this.buildWithdrawPrincipalTxV1=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);const i=this.withdrawPrincipalTxV1(Object.assign(Object.assign({},e),{tx:s}));return s.transferObjects([i],t),s},this.buildWithdrawPrincipalTxV2=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);const i=this.withdrawPrincipalTxV2(Object.assign(Object.assign({},e),{tx:s}));return s.transferObjects([i],t),s},this.buildUnstakeTxV1=e=>{const{walletAddress:t}=e;let s;e.rewardCoinTypes.length>0?s=this.buildHarvestRewardsTxV1(Object.assign(Object.assign({},e),{stakedPositionIds:[e.stakedPositionId]})):(s=new o.Transaction,s.setSender(t));const i=this.withdrawPrincipalTxV1(Object.assign(Object.assign({},e),{tx:s}));return s.transferObjects([i],t),this.destroyStakedPositionTxV1({tx:s,stakingPoolId:e.stakingPoolId,stakedPositionId:e.stakedPositionId,stakeCoinType:e.stakeCoinType}),s},this.buildUnstakeTxV2=e=>{const{walletAddress:t}=e;let s;e.rewardCoinTypes.length>0?s=this.buildHarvestRewardsTxV2(Object.assign(Object.assign({},e),{stakedPositionIds:[e.stakedPositionId]})):(s=new o.Transaction,s.setSender(t));const i=this.withdrawPrincipalTxV2(Object.assign(Object.assign({},e),{tx:s}));return s.transferObjects([i],t),this.destroyStakedPositionTxV2({tx:s,stakedPositionId:e.stakedPositionId,stakeCoinType:e.stakeCoinType}),s},this.buildUpdatePositionTxV1=n.Helpers.transactions.createBuildTxFunc(this.updatePositionTxV1),this.buildUpdatePositionTx2=n.Helpers.transactions.createBuildTxFunc(this.updatePositionTxV2),this.buildLockTxV1=n.Helpers.transactions.createBuildTxFunc(this.lockTxV1),this.buildLockTxV2=n.Helpers.transactions.createBuildTxFunc(this.lockTxV2),this.buildRenewLockTxV1=n.Helpers.transactions.createBuildTxFunc(this.renewLockTxV1),this.buildRenewLockTxV2=n.Helpers.transactions.createBuildTxFunc(this.renewLockTxV2),this.buildUnlockTxV1=n.Helpers.transactions.createBuildTxFunc(this.unlockTxV1),this.buildUnlockTxV2=n.Helpers.transactions.createBuildTxFunc(this.unlockTxV2),this.buildHarvestRewardsTxV1=e=>{var t;const{walletAddress:s,stakedPositionIds:i}=e,n=null!==(t=e.tx)&&void 0!==t?t:new o.Transaction;n.setSender(s);const r=this.beginHarvestTxV1(Object.assign(Object.assign({},e),{tx:n}));let a={};for(const t of i)for(const s of e.rewardCoinTypes){const i=this.harvestRewardsTxV1(Object.assign(Object.assign({},e),{tx:n,stakedPositionId:t,rewardCoinType:s,harvestedRewardsEventMetadataId:r}));s in a?a[s].push(i):a[s]=[i]}this.endHarvestTxV1({tx:n,harvestedRewardsEventMetadataId:r});for(const[t,i]of Object.entries(a)){const r=i[0];i.length>1&&n.mergeCoins(r,i.slice(1)),e.claimSuiAsAfSui&&d.Coin.isCoinObjectType(t)?this.Provider.Staking().stakeTx({tx:n,suiCoin:r,withTransfer:!0,validatorAddress:this.Provider.Staking().addresses.objects.aftermathValidator}):n.transferObjects([r],s)}return n},this.buildHarvestRewardsTxV2=e=>{var t;const{walletAddress:s,stakedPositionIds:i}=e,n=null!==(t=e.tx)&&void 0!==t?t:new o.Transaction;n.setSender(s);const r=i[0],a=this.beginHarvestTxV2(Object.assign(Object.assign({},e),{tx:n,stakedPositionId:r}));let c={};for(const t of i)for(const s of e.rewardCoinTypes){const i=this.harvestRewardsTxV2(Object.assign(Object.assign({},e),{tx:n,stakedPositionId:t,harvestRewardsCap:a,rewardCoinType:s}));s in c?c[s].push(i):c[s]=[i]}this.endHarvestTxV2({tx:n,harvestRewardsCap:a});for(const[t,i]of Object.entries(c)){const r=i[0];i.length>1&&n.mergeCoins(r,i.slice(1)),e.claimSuiAsAfSui&&d.Coin.isCoinObjectType(t)?this.Provider.Staking().stakeTx({tx:n,suiCoin:r,withTransfer:!0,validatorAddress:this.Provider.Staking().addresses.objects.aftermathValidator}):n.transferObjects([r],s)}return n},this.buildCreateStakingPoolTxV1=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);const[i,n]=this.newStakingPoolTxV1(Object.assign(Object.assign({},e),{tx:s,lockEnforcement:"Strict"}));return this.shareStakingPoolTxV1({tx:s,stakingPoolId:i,stakeCoinType:e.stakeCoinType}),this.transferOwnerCapTxV1({tx:s,ownerCapId:n,recipientAddress:t}),s},this.buildCreateStakingPoolTxV2=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);const[i,n]=this.newStakingPoolTxV2(Object.assign(Object.assign({},e),{tx:s,lockEnforcements:["Strict"]}));return this.shareStakingPoolTxV2({tx:s,stakingPoolId:i,stakeCoinType:e.stakeCoinType}),s.transferObjects([n],t),s},this.fetchBuildInitializeStakingPoolRewardTxV1=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);const n=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:e.rewardCoinType,coinAmount:e.rewardAmount,isSponsoredTx:s});return this.initializeStakingPoolRewardTxV1(Object.assign(Object.assign({},e),{tx:i,rewardCoinId:n})),i})),this.fetchBuildInitializeStakingPoolRewardTxV2=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);const n=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:e.rewardCoinType,coinAmount:e.rewardAmount,isSponsoredTx:s});return this.initializeStakingPoolRewardTxV2(Object.assign(Object.assign({},e),{tx:i,rewardCoinId:n})),i})),this.fetchBuildTopUpStakingPoolRewardsTxV1=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);for(const n of e.rewards){const r=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:n.rewardCoinType,coinAmount:n.rewardAmount,isSponsoredTx:s});this.topUpStakingPoolRewardTxV1(Object.assign(Object.assign(Object.assign({},e),n),{tx:i,rewardCoinId:r}))}return i})),this.fetchBuildTopUpStakingPoolRewardsTxV2=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,isSponsoredTx:s}=e,i=new o.Transaction;i.setSender(t);for(const n of e.rewards){const r=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:i,walletAddress:t,coinType:n.rewardCoinType,coinAmount:n.rewardAmount,isSponsoredTx:s});this.topUpStakingPoolRewardTxV2(Object.assign(Object.assign(Object.assign({},e),n),{tx:i,rewardCoinId:r}))}return i})),this.buildIncreaseStakingPoolRewardsEmissionsTxV1=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);for(const t of e.rewards)this.increaseStakingPoolRewardEmissionsTxV1(Object.assign(Object.assign(Object.assign({},e),t),{tx:s}));return s},this.buildIncreaseStakingPoolRewardsEmissionsTxV2=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);for(const t of e.rewards)this.increaseStakingPoolRewardEmissionsTxV2(Object.assign(Object.assign(Object.assign({},e),t),{tx:s}));return s},this.buildSetStakingPoolMinStakeAmountTxV1=n.Helpers.transactions.createBuildTxFunc(this.setStakingPoolMinStakeAmountTxV1),this.buildSetStakingPoolMinStakeAmountTxV2=n.Helpers.transactions.createBuildTxFunc(this.setStakingPoolMinStakeAmountTxV2),this.buildRemoveStakingPoolRewardTxV1=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);for(const t of e.rewards)this.removeStakingPoolRewardTxV1(Object.assign(Object.assign(Object.assign({},e),t),{tx:s}));return s},this.buildRemoveStakingPoolRewardTxV2=e=>{const{walletAddress:t}=e,s=new o.Transaction;s.setSender(t);for(const t of e.rewards)this.removeStakingPoolRewardTxV2(Object.assign(Object.assign(Object.assign({},e),t),{tx:s}));return s},this.buildGrantOneTimeAdminCapTxV1=n.Helpers.transactions.createBuildTxFunc(this.grantOneTimeAdminCapTxV1),this.buildGrantOneTimeAdminCapTxV2=n.Helpers.transactions.createBuildTxFunc(this.grantOneTimeAdminCapTxV2),this.eventWrapperType=()=>r.EventsApiHelpers.createEventType(this.addresses.packages.eventsV2,c.constants.moduleNames.events,"Event"),this.createdVaultEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.createdVault,1===e?void 0:this.eventWrapperType()),this.initializedRewardEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.initializedReward,1===e?void 0:this.eventWrapperType()),this.addedRewardEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.addedReward,1===e?void 0:this.eventWrapperType()),this.increasedEmissionsEventType=()=>r.EventsApiHelpers.createEventType(this.addresses.packages.vaultsInitial,c.constants.moduleNames.events,c.constants.eventNames.increasedEmissions),this.updatedEmissionsEventType=()=>r.EventsApiHelpers.createEventType(this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.increasedEmissions,this.eventWrapperType()),this.stakedEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.staked,1===e?void 0:this.eventWrapperType()),this.stakedRelaxedEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.stakedRelaxed,1===e?void 0:this.eventWrapperType()),this.lockedEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.locked,1===e?void 0:this.eventWrapperType()),this.unlockedEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.unlocked,1===e?void 0:this.eventWrapperType()),this.depositedPrincipalEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.depositedPrincipal,1===e?void 0:this.eventWrapperType()),this.withdrewPrincipalEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.withdrewPrincipal,1===e?void 0:this.eventWrapperType()),this.harvestedRewardsEventType=e=>r.EventsApiHelpers.createEventType(1===e?this.addresses.packages.vaultsInitial:this.addresses.packages.eventsV2,c.constants.moduleNames.events,c.constants.eventNames.harvestedRewards,1===e?void 0:this.eventWrapperType());const t=this.Provider.addresses.farms;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t,this.objectTypes={stakedPositionV1:`${t.packages.vaultsInitial}::${c.constants.moduleNames.stakedPosition}::StakedPosition`,stakingPoolOwnerCapV1:`${t.packages.vaultsInitial}::${c.constants.moduleNames.vaultV1}::OwnerCap`,stakingPoolOneTimeAdminCapV1:`${t.packages.vaultsInitial}::${c.constants.moduleNames.vaultV1}::OneTimeAdminCap`,stakedPositionV2:`${t.packages.eventsV2}::${c.constants.moduleNames.stakedPosition}::StakedPosition`,stakingPoolOwnerCapV2:`${t.packages.eventsV2}::${c.constants.moduleNames.authority}::AuthorityCap<${t.packages.eventsV2}::${c.constants.moduleNames.authority}::VAULT<${t.packages.eventsV2}::${c.constants.moduleNames.authority}::ADMIN>>`,stakingPoolOneTimeAdminCapV2:`${t.packages.eventsV2}::${c.constants.moduleNames.vaultV2}::OneTime`},this.eventTypes={createdVaultV1:this.createdVaultEventType(1),initializedRewardV1:this.initializedRewardEventType(1),addedRewardV1:this.addedRewardEventType(1),increasedEmissionsV1:this.increasedEmissionsEventType(),stakedV1:this.stakedEventType(1),stakedRelaxedV1:this.stakedRelaxedEventType(1),lockedV1:this.lockedEventType(1),unlockedV1:this.unlockedEventType(1),depositedPrincipalV1:this.depositedPrincipalEventType(1),withdrewPrincipalV1:this.withdrewPrincipalEventType(1),harvestedRewardsV1:this.harvestedRewardsEventType(1),createdVaultV2:this.createdVaultEventType(2),initializedRewardV2:this.initializedRewardEventType(2),addedRewardV2:this.addedRewardEventType(2),updatedEmissionsV2:this.updatedEmissionsEventType(),stakedV2:this.stakedEventType(2),lockedV2:this.lockedEventType(2),unlockedV2:this.unlockedEventType(2),depositedPrincipalV2:this.depositedPrincipalEventType(2),withdrewPrincipalV2:this.withdrewPrincipalEventType(2),harvestedRewardsV2:this.harvestedRewardsEventType(2)},this.moveErrors={[this.addresses.packages.vaults]:{[c.constants.moduleNames.vaultV1]:{0:"Zero",1:"Invalid Afterburner Vault",2:"Invalid Min Max Lock Durations",3:"Emissions Not Initialized",4:"Emissions Not Increasing",5:"Bad Type",6:"Invalid Stake Amount",7:"Invalid Lock Enforcement",8:"Zero Claim",9:"Invalid Lock Multiplier",10:"Invalid Argument",11:"Deprecated",12:"Afterburner Vault Still Active"},[c.constants.moduleNames.stakedPosition]:{0:"Zero",1:"Locked",2:"Invalid Afterburner Vault",3:"Invalid Lock Duration",4:"Harvest Rewards",5:"Invalid Stake Amount",6:"Invalid Withdraw Amount",7:"Invalid Split Amount",8:"Uninitialized Vault Rewards",9:"Not Implemented",10:"Zero Rewards"}},[this.addresses.packages.vaultsV2]:{[c.constants.moduleNames.vaultV2]:{0:"Zero",1:"Invalid Min Max Lock Durations",2:"Invalid Lock Enforcement",3:"Emissions Not Initialized",4:"Invalid Reward Coin Type",5:"Invalid Stake Amount",6:"Zero Claim",7:"Invalid Lock Multiplier"},[c.constants.moduleNames.stakedPosition]:{0:"Locked",1:"Invalid Vault",2:"Invalid Lock Duration",3:"Invalid Stake Amount",4:"Invalid Withdraw Amount",5:"Invalid Split Amount",6:"Vault Is Inactive",7:"Zero Rewards",8:"Invalid Lock Enforcement",9:"Position Has Unclaimed Rewards"}}}}}t.FarmsApi=c,c.constants={moduleNames:{vaultV1:"afterburner_vault",vaultV2:"vault",stakedPosition:"staked_position",vaultRegistry:"vault_registry",events:"events",authority:"authority"},eventNames:{createdVault:"CreatedVaultEvent",initializedReward:"InitializedRewardEvent",addedReward:"AddedRewardEvent",increasedEmissions:"IncreasedEmissionsEvent",updatedEmissions:"UpdatedEmissionsEvent",staked:"StakedEvent",stakedRelaxed:"StakedEventRelaxed",locked:"LockedEvent",unlocked:"UnlockedEvent",joined:"JoinedEvent",split:"SplitEvent",depositedPrincipal:"DepositedPrincipalEvent",withdrewPrincipal:"WithdrewPrincipalEvent",harvestedRewards:"HarvestedRewardsEvent",destroyedStakedPosition:"DestroyedStakedPositionEvent"}},c.isFarmOneTimeAdminCapId=e=>"oneTimeAdminCapId"in e,c.farmCapId=e=>"ownerCapId"in e?e.ownerCapId:e.oneTimeAdminCapId},583938:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FarmsApiCasting=void 0;const i=s(897399),n=s(243333);class r{}t.FarmsApiCasting=r,r.partialStakedPositionObjectFromSuiObjectResponseV1=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e),r=n.Helpers.addLeadingZeroesToType(i.Coin.getInnerCoinType(t));return{objectType:t,objectId:n.Helpers.getObjectId(e),stakeCoinType:r,stakingPoolObjectId:s.afterburner_vault_id,stakedAmount:BigInt(s.balance),stakedAmountWithMultiplier:BigInt(s.multiplier_staked_amount),lockStartTimestamp:Number(s.lock_start_timestamp_ms),lockDurationMs:Number(s.lock_duration_ms),lockMultiplier:BigInt(s.lock_multiplier),lastHarvestRewardsTimestamp:Number(s.last_reward_timestamp_ms),rewardCoins:s.base_rewards_accumulated.map(((e,t)=>({baseRewardsAccumulated:BigInt(e),baseRewardsDebt:BigInt(s.base_rewards_debt[t]),multiplierRewardsAccumulated:BigInt(s.multiplier_rewards_accumulated[t]),multiplierRewardsDebt:BigInt(s.multiplier_rewards_debt[t])}))),version:1}},r.partialStakedPositionObjectFromSuiObjectResponseV2=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e),r=n.Helpers.addLeadingZeroesToType(i.Coin.getInnerCoinType(t));return{objectType:t,objectId:n.Helpers.getObjectId(e),stakeCoinType:r,stakingPoolObjectId:s.vault_id,stakedAmount:BigInt(s.balance),stakedAmountWithMultiplier:BigInt(s.multiplier_staked_amount),lockStartTimestamp:Number(s.lock_start_timestamp_ms),lockDurationMs:Number(s.lock_duration_ms),lockMultiplier:BigInt(s.lock_multiplier),lastHarvestRewardsTimestamp:Number(s.last_reward_timestamp_ms),rewardCoins:s.base_rewards_accumulated.map(((e,t)=>({baseRewardsAccumulated:BigInt(e),baseRewardsDebt:BigInt(s.base_rewards_debt[t]),multiplierRewardsAccumulated:BigInt(s.multiplier_rewards_accumulated[t]),multiplierRewardsDebt:BigInt(s.multiplier_rewards_debt[t])}))),version:2}},r.stakingPoolOwnerCapObjectFromSuiObjectResponseV1=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),stakingPoolId:s.afterburner_vault_id}},r.stakingPoolOwnerCapObjectFromSuiObjectResponseV2=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),stakingPoolId:s.for}},r.stakingPoolOneTimeAdminCapObjectFromSuiObjectResponseV1=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),stakingPoolId:s.afterburner_vault_id}},r.stakingPoolOneTimeAdminCapObjectFromSuiObjectResponseV2=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),stakingPoolId:s.cap.fields.for}},r.addedRewardEventFromOnChainV1=e=>{const t=e.parsedJson;return{vaultId:t.vault_id,rewardType:n.Helpers.addLeadingZeroesToType("0x"+t.reward_type),rewardAmount:BigInt(t.reward_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.addedRewardEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{vaultId:t.vault_id,rewardType:n.Helpers.addLeadingZeroesToType("0x"+t.reward_type),rewardAmount:BigInt(t.reward_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.createdVaultEventFromOnChainV1=e=>{const t=e.parsedJson;return{vaultId:t.vault_id,stakeType:n.Helpers.addLeadingZeroesToType("0x"+t.stake_type),minLockDurationMs:Number(t.min_lock_duration_ms),maxLockDurationMs:Number(t.max_lock_duration_ms),maxLockMultiplier:BigInt(t.max_lock_multiplier),minStakeAmount:BigInt(t.min_stake_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.createdVaultEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{vaultId:t.vault_id,stakeType:n.Helpers.addLeadingZeroesToType("0x"+t.stake_type),minLockDurationMs:Number(t.min_lock_duration_ms),maxLockDurationMs:Number(t.max_lock_duration_ms),maxLockMultiplier:BigInt(t.max_lock_multiplier),minStakeAmount:BigInt(t.min_stake_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.depositedPrincipalEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,amount:BigInt(t.amount),stakeType:n.Helpers.addLeadingZeroesToType("0x"+t.stake_type),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.depositedPrincipalEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,amount:BigInt(t.amount),stakeType:n.Helpers.addLeadingZeroesToType("0x"+t.stake_type),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.destroyedStakedPositionEventFromOnChainV1=e=>({stakedPositionId:e.parsedJson.staked_position_id,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}),r.destroyedStakedPositionEventFromOnChainV2=e=>({stakedPositionId:e.parsedJson.pos0.staked_position_id,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}),r.harvestedRewardsEventFromOnChainV1=e=>{const t=e.parsedJson;return{vaultId:t.afterburner_vault_id,rewardTypes:t.reward_types.map((e=>n.Helpers.addLeadingZeroesToType("0x"+e))),rewardAmounts:t.reward_amounts.map((e=>BigInt(e))),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.harvestedRewardsEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{vaultId:t.afterburner_vault_id,rewardTypes:t.reward_types.map((e=>n.Helpers.addLeadingZeroesToType("0x"+e))),rewardAmounts:t.reward_amounts.map((e=>BigInt(e))),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.increasedEmissionsEventFromOnChainV1=e=>{const t=e.parsedJson;return{vaultId:t.vault_id,rewardType:n.Helpers.addLeadingZeroesToType("0x"+t.reward_type),emissionScheduleMs:Number(t.emission_schedule_ms),emissionRate:BigInt(t.emission_rate),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.updatedEmissionsEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{vaultId:t.vault_id,rewardType:n.Helpers.addLeadingZeroesToType("0x"+t.reward_type),emissionScheduleMs:Number(t.emission_schedule_ms),emissionRate:BigInt(t.emission_rate),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.initializedRewardEventFromOnChainV1=e=>{const t=e.parsedJson;return{vaultId:t.vault_id,rewardType:n.Helpers.addLeadingZeroesToType("0x"+t.reward_type),rewardAmount:BigInt(t.reward_amount),emissionRate:BigInt(t.emission_rate),emissionStartMs:Number(t.emission_start_ms),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.initializedRewardEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{vaultId:t.vault_id,rewardType:n.Helpers.addLeadingZeroesToType("0x"+t.reward_type),rewardAmount:BigInt(t.reward_amount),emissionRate:BigInt(t.emission_rate),emissionStartMs:Number(t.emission_start_ms),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.joinedEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,otherStakedPositionId:t.other_staked_position_id,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.joinedEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{stakedPositionId:t.staked_position_id,otherStakedPositionId:t.other_staked_position_id,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.lockedEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,stakedType:n.Helpers.addLeadingZeroesToType("0x"+t.staked_type),stakedAmount:BigInt(t.staked_amount),lockStartTimestampMs:Number(t.lock_start_timestamp_ms),lockDurationMs:Number(t.lock_duration_ms),lockMultiplier:BigInt(t.lock_multiplier),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.lockedEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,stakedType:n.Helpers.addLeadingZeroesToType("0x"+t.staked_type),stakedAmount:BigInt(t.staked_amount),lockStartTimestampMs:Number(t.lock_start_timestamp_ms),lockDurationMs:Number(t.lock_duration_ms),lockMultiplier:BigInt(t.lock_multiplier),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.splitEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,splitStakedPositionId:t.split_staked_position_id,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.splitEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{stakedPositionId:t.staked_position_id,splitStakedPositionId:t.split_staked_position_id,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.stakedEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,stakedType:n.Helpers.addLeadingZeroesToType("0x"+t.staked_type),stakedAmount:BigInt(t.staked_amount),multipliedStakedAmount:BigInt(t.multiplied_staked_amount),lockStartTimestampMs:Number(t.lock_start_timestamp_ms),lockDurationMs:Number(t.lock_duration_ms),lockMultiplier:BigInt(t.lock_multiplier),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.stakedEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,stakedType:n.Helpers.addLeadingZeroesToType("0x"+t.staked_type),stakedAmount:BigInt(t.staked_amount),multipliedStakedAmount:BigInt(t.multiplier_staked_amount),lockStartTimestampMs:Number(t.lock_start_timestamp_ms),lockDurationMs:Number(t.lock_duration_ms),lockMultiplier:BigInt(t.lock_multiplier),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.stakedRelaxedEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,stakedType:n.Helpers.addLeadingZeroesToType("0x"+t.staked_type),stakedAmount:BigInt(t.staked_amount),lockStartTimestampMs:Number(t.lock_start_timestamp_ms),lockEndTimestampMs:Number(t.lock_end_timestamp_ms),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.unlockedEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,stakedType:n.Helpers.addLeadingZeroesToType("0x"+t.staked_type),stakedAmount:BigInt(t.staked_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.unlockedEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,stakedType:n.Helpers.addLeadingZeroesToType("0x"+t.staked_type),stakedAmount:BigInt(t.staked_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.withdrewPrincipalEventFromOnChainV1=e=>{const t=e.parsedJson;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,amount:BigInt(t.amount),stakeType:n.Helpers.addLeadingZeroesToType("0x"+t.stake_type),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.withdrewPrincipalEventFromOnChainV2=e=>{const t=e.parsedJson.pos0;return{stakedPositionId:t.staked_position_id,vaultId:t.vault_id,amount:BigInt(t.amount),stakeType:n.Helpers.addLeadingZeroesToType("0x"+t.stake_type),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},465417:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Farms=void 0;const n=s(601151),r=s(233559),a=s(568895);class o extends n.Caller{constructor(e,t){super(e,"farms"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Farms();if(!t)throw new Error("missing AftermathApi Provider");return t}}getStakingPool(e){return i(this,void 0,void 0,(function*(){const t=yield this.fetchApi(e.objectId);return new r.FarmsStakingPool(t,this.config,this.Provider)}))}getStakingPools(e){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi("",{farmIds:e.objectIds})).map((e=>new r.FarmsStakingPool(e,this.config,this.Provider)))}))}getAllStakingPools(){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi("",{})).map((e=>new r.FarmsStakingPool(e,this.config,this.Provider)))}))}getOwnedStakedPositions(e){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi("owned-staked-positions",e)).map((e=>new a.FarmsStakedPosition(e,void 0,this.config,this.Provider)))}))}getOwnedStakingPoolOwnerCaps(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchOwnedStakingPoolOwnerCaps(e)}))}getOwnedStakingPoolOneTimeAdminCaps(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchOwnedStakingPoolOneTimeAdminCaps(e)}))}getTVL(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("tvl",null!=e?e:{})}))}getRewardsTVL(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("rewards-tvl",null!=e?e:{})}))}getCreateStakingPoolTransactionV1(e){return i(this,void 0,void 0,(function*(){return this.useProvider().buildCreateStakingPoolTxV1(e)}))}getCreateStakingPoolTransactionV2(e){return i(this,void 0,void 0,(function*(){return this.useProvider().buildCreateStakingPoolTxV2(e)}))}getInteractionEvents(e){return i(this,void 0,void 0,(function*(){return this.fetchApiIndexerEvents("events-by-user",e)}))}}t.Farms=o,o.constants={minRewardsToClaim:BigInt(10),maxLockMultiplier:2}},568895:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FarmsStakedPosition=void 0;const r=s(601151),a=s(233559),o=s(845963),d=s(243333),c=n(s(128879)),l=s(465417);class u extends r.Caller{constructor(e,t=void 0,s,i){super(s,"farms"),this.stakedPosition=e,this.Provider=i,this.version=()=>this.stakedPosition.version,this.isLocked=e=>!this.isUnlocked(e),this.isLockDuration=()=>this.stakedPosition.lockDurationMs>0,this.unlockTimestamp=()=>this.stakedPosition.lockStartTimestamp+this.stakedPosition.lockDurationMs,this.rewardCoinsToClaimableBalance=e=>this.stakedPosition.rewardCoins.reduce(((t,s)=>Object.assign(Object.assign({},t),{[s.coinType]:this.rewardsEarned(Object.assign(Object.assign({},e),{coinType:s.coinType}))})),{}),this.rewardCoinTypes=()=>this.stakedPosition.rewardCoins.map((e=>e.coinType)),this.nonZeroRewardCoinTypes=e=>Object.entries(this.rewardCoinsToClaimableBalance(e)).filter((([,e])=>e>BigInt(0))).map((([e])=>e)),this.rewardCoin=e=>{const t=this.stakedPosition.rewardCoins.find((t=>t.coinType===e.coinType));if(!t)throw new Error("Invalid coin type");return t},this.hasClaimableRewards=e=>{const{stakingPool:t}=e;return d.Helpers.sumBigInt(this.rewardCoinTypes().map((e=>this.rewardsEarned({coinType:e,stakingPool:t}))))>BigInt(0)},this.rewardsEarned=e=>{if(e.stakingPool.rewardCoin(e).actualRewards===BigInt(0))return BigInt(0);const t=this.rewardCoin(e),s=t.multiplierRewardsAccumulated+t.baseRewardsAccumulated;return s<l.Farms.constants.minRewardsToClaim||s>e.stakingPool.rewardCoin(e).actualRewards?BigInt(0):s},this.updatePosition=e=>{const t=new a.FarmsStakingPool(d.Helpers.deepCopy(e.stakingPool.stakingPool),this.config);this.stakedPosition.lockDurationMs<=t.stakingPool.maxLockDurationMs&&this.stakedPosition.lockMultiplier<=t.stakingPool.maxLockMultiplier||(t.stakingPool.stakedAmountWithMultiplier-=this.stakedPosition.stakedAmountWithMultiplier,this.stakedPosition.lockDurationMs=t.stakingPool.maxLockDurationMs,this.stakedPosition.lockMultiplier=t.stakingPool.maxLockMultiplier,this.stakedPosition.stakedAmountWithMultiplier=this.stakedPosition.stakedAmount*(this.stakedPosition.lockMultiplier-o.FixedUtils.fixedOneB)/o.FixedUtils.fixedOneB,this.stakedPosition.rewardCoins=[...this.stakedPosition.rewardCoins.map((e=>{const s=t.rewardCoin({coinType:e.coinType}).rewardsAccumulatedPerShare;return Object.assign(Object.assign({},e),{multiplierRewardsDebt:this.stakedPosition.stakedAmountWithMultiplier*s/o.FixedUtils.fixedOneB})}))],t.stakingPool.stakedAmountWithMultiplier+=this.stakedPosition.stakedAmountWithMultiplier);const s=(0,c.default)().valueOf();t.emitRewards();for(const[e,s]of t.stakingPool.rewardCoins.entries()){e>=this.stakedPosition.rewardCoins.length&&this.stakedPosition.rewardCoins.push({coinType:s.coinType,baseRewardsAccumulated:BigInt(0),baseRewardsDebt:BigInt(0),multiplierRewardsAccumulated:BigInt(0),multiplierRewardsDebt:BigInt(0)});const i=this.stakedPosition.rewardCoins[e],[n,r]=this.calcTotalRewardsFromTimeT0({rewardsAccumulatedPerShare:s.rewardsAccumulatedPerShare,multiplierRewardsDebt:i.multiplierRewardsDebt,emissionEndTimestamp:t.stakingPool.emissionEndTimestamp});this.stakedPosition.rewardCoins[e].baseRewardsAccumulated=n-i.baseRewardsDebt+i.baseRewardsAccumulated,this.stakedPosition.rewardCoins[e].multiplierRewardsAccumulated=r-i.multiplierRewardsDebt+i.multiplierRewardsAccumulated,this.stakedPosition.rewardCoins[e].baseRewardsDebt=n,this.stakedPosition.rewardCoins[e].multiplierRewardsDebt=r}this.stakedPosition.lastHarvestRewardsTimestamp=s},this.isUnlocked=e=>{const{stakingPool:t}=e,s=(0,c.default)().valueOf();return this.unlockTimestamp()<=s||t.stakingPool.emissionEndTimestamp<=s||t.stakingPool.isUnlocked},this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Farms();if(!t)throw new Error("missing AftermathApi Provider");return t},this.stakedPosition=e,this.trueLastHarvestRewardsTimestamp=null!=t?t:e.lastHarvestRewardsTimestamp}getDepositPrincipalTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakedPositionId:this.stakedPosition.objectId,stakeCoinType:this.stakedPosition.stakeCoinType,stakingPoolId:this.stakedPosition.stakingPoolObjectId});return 1===this.version()?this.useProvider().fetchBuildDepositPrincipalTxV1(t):this.useProvider().fetchBuildDepositPrincipalTxV2(t)}))}getUnstakeTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakedPositionId:this.stakedPosition.objectId,stakeCoinType:this.stakedPosition.stakeCoinType,stakingPoolId:this.stakedPosition.stakingPoolObjectId,withdrawAmount:this.stakedPosition.stakedAmount,rewardCoinTypes:this.nonZeroRewardCoinTypes(e)});return 1===this.version()?this.useProvider().buildUnstakeTxV1(t):this.useProvider().buildUnstakeTxV2(t)}))}getLockTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakedPositionId:this.stakedPosition.objectId,stakeCoinType:this.stakedPosition.stakeCoinType,stakingPoolId:this.stakedPosition.stakingPoolObjectId});return 1===this.version()?this.useProvider().buildLockTxV1(t):this.useProvider().buildLockTxV2(t)}))}getRenewLockTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakedPositionId:this.stakedPosition.objectId,stakeCoinType:this.stakedPosition.stakeCoinType,stakingPoolId:this.stakedPosition.stakingPoolObjectId});return 1===this.version()?this.useProvider().buildRenewLockTxV1(t):this.useProvider().buildRenewLockTxV2(t)}))}getUnlockTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakedPositionId:this.stakedPosition.objectId,stakeCoinType:this.stakedPosition.stakeCoinType,stakingPoolId:this.stakedPosition.stakingPoolObjectId});return 1===this.version()?this.useProvider().buildUnlockTxV1(t):this.useProvider().buildUnlockTxV2(t)}))}getHarvestRewardsTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakedPositionIds:[this.stakedPosition.objectId],stakeCoinType:this.stakedPosition.stakeCoinType,stakingPoolId:this.stakedPosition.stakingPoolObjectId,rewardCoinTypes:this.nonZeroRewardCoinTypes(e)});return 1===this.version()?this.useProvider().buildHarvestRewardsTxV1(t):this.useProvider().buildHarvestRewardsTxV2(t)}))}calcTotalRewardsFromTimeT0(e){const{rewardsAccumulatedPerShare:t,multiplierRewardsDebt:s,emissionEndTimestamp:i}=e,n=this.stakedPosition.lastHarvestRewardsTimestamp,r=this.unlockTimestamp(),a=this.stakedPosition.stakedAmount*t/o.FixedUtils.fixedOneB,d=Math.min(r,i);return[a,(()=>n<=d?t*this.stakedPosition.stakedAmountWithMultiplier/o.FixedUtils.fixedOneB:s)()]}}t.FarmsStakedPosition=u},233559:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FarmsStakingPool=void 0;const r=s(601151),a=s(243333),o=n(s(128879)),d=n(s(64989)),c=s(845963),l=s(897399),u=s(465417);class p extends r.Caller{constructor(e,t,s){super(t,"farms"),this.stakingPool=e,this.Provider=s,this.version=()=>this.stakingPool.version,this.rewardCoinTypes=()=>this.stakingPool.rewardCoins.map((e=>e.coinType)),this.nonZeroRewardCoinTypes=()=>this.stakingPool.rewardCoins.filter((e=>e.emissionRate<=e.actualRewards&&e.actualRewards>BigInt(0))).map((e=>e.coinType)),this.rewardCoin=e=>{const t=this.stakingPool.rewardCoins.find((t=>t.coinType===e.coinType));if(!t)throw new Error("Invalid coin type");return t},this.maxLockDurationMs=()=>Math.max(Math.min(this.stakingPool.maxLockDurationMs,this.stakingPool.emissionEndTimestamp-(0,o.default)().valueOf()),0),this.emitRewards=()=>{const e=(0,o.default)().valueOf();if(this.stakingPool.stakedAmount===BigInt(0))return;const t=a.Helpers.deepCopy(this.stakingPool.rewardCoins);for(const[s,i]of t.entries()){if(e<i.lastRewardTimestamp+i.emissionSchedulesMs)continue;const t=this.calcRewardsToEmit({rewardCoin:i});if(t===BigInt(0))continue;this.increaseRewardsAccumulatedPerShare({rewardsToEmit:t,rewardCoinIndex:s});const n=(e-i.lastRewardTimestamp)/i.emissionSchedulesMs;this.stakingPool.rewardCoins[s].lastRewardTimestamp=i.lastRewardTimestamp+n*i.emissionSchedulesMs}},this.calcApr=e=>{const{coinType:t,price:s,decimals:i,tvlUsd:n}=e;if(s<=0||n<=0)return 0;const r=this.rewardCoin({coinType:t}),c=(0,o.default)().valueOf();if(r.emissionRate>r.actualRewards)return 0;if(r.emissionStartTimestamp>c||c>this.stakingPool.emissionEndTimestamp)return 0;const u=r.emissionRate,p=l.Coin.balanceWithDecimals(u,i)*s;o.default.extend(d.default);const h=p*(o.default.duration(1,"year").asMilliseconds()/r.emissionSchedulesMs)/n/a.Casting.bigIntToFixedNumber(this.stakingPool.maxLockMultiplier);return h<0||isNaN(h)?0:h},this.calcTotalApr=e=>{const{coinsToPrice:t,coinsToDecimals:s,tvlUsd:i}=e,n=this.rewardCoinTypes().map((e=>this.calcApr({coinType:e,price:t[e],decimals:s[e],tvlUsd:i})));return a.Helpers.sum(n)},this.calcMultiplier=e=>{const t=e.lockDurationMs>this.stakingPool.maxLockDurationMs?this.stakingPool.maxLockDurationMs:e.lockDurationMs<this.stakingPool.minLockDurationMs?this.stakingPool.minLockDurationMs:e.lockDurationMs,s=this.stakingPool.maxLockDurationMs-this.stakingPool.minLockDurationMs,i=1+(t-this.stakingPool.minLockDurationMs)/(s<=0?1:s)*(a.Casting.bigIntToFixedNumber(this.stakingPool.maxLockMultiplier)-1),n=a.Casting.numberToFixedBigInt(i);return n<c.FixedUtils.fixedOneB?c.FixedUtils.fixedOneB:a.Helpers.minBigInt(n,this.stakingPool.maxLockMultiplier)},this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Farms();if(!t)throw new Error("missing AftermathApi Provider");return t},this.stakingPool=e}getTVL(){return i(this,void 0,void 0,(function*(){return new u.Farms(this.config,this.Provider).getTVL({farmIds:[this.stakingPool.objectId]})}))}getRewardsTVL(){return i(this,void 0,void 0,(function*(){return new u.Farms(this.config,this.Provider).getRewardsTVL({farmIds:[this.stakingPool.objectId]})}))}getStakeTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakeCoinType:this.stakingPool.stakeCoinType,stakingPoolId:this.stakingPool.objectId});return 1===this.version()?this.useProvider().fetchBuildStakeTxV1(t):this.useProvider().fetchBuildStakeTxV2(Object.assign({},t))}))}getHarvestRewardsTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakeCoinType:this.stakingPool.stakeCoinType,stakingPoolId:this.stakingPool.objectId,rewardCoinTypes:this.nonZeroRewardCoinTypes()});return 1===this.version()?this.useProvider().buildHarvestRewardsTxV1(t):this.useProvider().buildHarvestRewardsTxV2(t)}))}getIncreaseRewardsEmissionsTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakeCoinType:this.stakingPool.stakeCoinType,stakingPoolId:this.stakingPool.objectId});return 1===this.version()?this.useProvider().buildIncreaseStakingPoolRewardsEmissionsTxV1(t):this.useProvider().buildIncreaseStakingPoolRewardsEmissionsTxV2(t)}))}getUpdateMinStakeAmountTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakeCoinType:this.stakingPool.stakeCoinType,stakingPoolId:this.stakingPool.objectId});return 1===this.version()?this.useProvider().buildSetStakingPoolMinStakeAmountTxV1(t):this.useProvider().buildSetStakingPoolMinStakeAmountTxV2(t)}))}getGrantOneTimeAdminCapTransaction(e){return 1===this.version()?this.useProvider().buildGrantOneTimeAdminCapTxV1(e):this.useProvider().buildGrantOneTimeAdminCapTxV2(e)}getInitializeRewardTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakeCoinType:this.stakingPool.stakeCoinType,stakingPoolId:this.stakingPool.objectId});return 1===this.version()?this.useProvider().fetchBuildInitializeStakingPoolRewardTxV1(t):this.useProvider().fetchBuildInitializeStakingPoolRewardTxV2(t)}))}getTopUpRewardsTransaction(e){return i(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e),{stakeCoinType:this.stakingPool.stakeCoinType,stakingPoolId:this.stakingPool.objectId});return 1===this.version()?this.useProvider().fetchBuildTopUpStakingPoolRewardsTxV1(t):this.useProvider().fetchBuildTopUpStakingPoolRewardsTxV2(t)}))}getRemoveRewardsTransaction(e){const t=Object.assign(Object.assign({},e),{stakeCoinType:this.stakingPool.stakeCoinType,stakingPoolId:this.stakingPool.objectId});return 1===this.version()?this.useProvider().buildRemoveStakingPoolRewardTxV1(t):this.useProvider().buildRemoveStakingPoolRewardTxV2(t)}increaseRewardsAccumulatedPerShare(e){const{rewardsToEmit:t,rewardCoinIndex:s}=e,i=this.stakingPool.stakedAmountWithMultiplier;if(i===BigInt(0))return;const n=t*BigInt(1e18)/i;n!==BigInt(0)&&(this.stakingPool.rewardCoins[s].rewardsAccumulatedPerShare+=n)}calcRewardsToEmit(e){const{rewardCoin:t}=e,s=(0,o.default)().valueOf(),i=this.calcRewardsEmittedFromTimeTmToTn({timestampTm:t.lastRewardTimestamp,timestampTn:s,rewardCoin:t}),{rewardsRemaining:n}=t;return n<i?n:i}calcRewardsEmittedFromTimeTmToTn(e){const{timestampTm:t,timestampTn:s,rewardCoin:i}=e,n=0===i.emissionSchedulesMs?0:(s-t)/i.emissionSchedulesMs;return BigInt(Math.floor(n))*i.emissionRate}}t.FarmsStakingPool=p},72952:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isFarmsWithdrewPrincipalEvent=t.isFarmsUnlockedEvent=t.isFarmsStakedEvent=t.isFarmsLockedEvent=t.isFarmsHarvestedRewardsEvent=t.isFarmsDepositedPrincipalEvent=void 0,t.isFarmsDepositedPrincipalEvent=e=>e.type.toLowerCase().includes("::depositedprincipalevent"),t.isFarmsHarvestedRewardsEvent=e=>e.type.toLowerCase().includes("::harvestedrewardsevent"),t.isFarmsLockedEvent=e=>e.type.toLowerCase().includes("::lockedevent"),t.isFarmsStakedEvent=e=>e.type.toLowerCase().includes("::stakedevent"),t.isFarmsUnlockedEvent=e=>e.type.toLowerCase().includes("::unlockedevent"),t.isFarmsWithdrewPrincipalEvent=e=>e.type.toLowerCase().includes("::withdrewprincipalevent")},105709:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(465417),t),n(s(233559),t),n(s(568895),t)},660498:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FaucetApi=void 0;const n=s(108979),r=s(268086),a=s(302416),o=s(480544),d=s(578230),c=s(851693);class l{constructor(e){this.Provider=e,this.fetchRequestCustomCoinAmountTx=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,coinType:s,amount:i}=e,r=new n.Transaction;return r.setSender(t),this.requestCoinAmountTx({tx:r,coinType:s,amount:i}),r})),this.fetchBuildMintSuiFrenTx=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,mintFee:s,suiFrenType:i}=e,r=new n.Transaction;r.setSender(t);const o=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:r,walletAddress:t,coinType:a.Coin.constants.suiCoinType,coinAmount:s});return this.mintSuiFrenTx({tx:r,suiPaymentCoinId:o,suiFrenType:i}),r})),this.addCoinTx=e=>{const{tx:t,treasuryCapId:s,treasuryCapType:i}=e;return t.moveCall({target:o.TransactionsApiHelpers.createTxTarget(this.addresses.packages.faucet,l.constants.moduleNames.faucet,"add_coin"),typeArguments:[i],arguments:[t.object(this.addresses.objects.faucet),t.object(s)]})},this.requestCoinAmountTx=e=>{const{tx:t,coinType:s,amount:i}=e;return t.moveCall({target:o.TransactionsApiHelpers.createTxTarget(this.addresses.packages.faucet,l.constants.moduleNames.faucet,"request_coin_amount"),typeArguments:[s],arguments:[t.object(this.addresses.objects.faucet),t.pure.u64(i)]})},this.requestCoinTx=e=>{const{tx:t,coinType:s}=e;return t.moveCall({target:o.TransactionsApiHelpers.createTxTarget(this.addresses.packages.faucet,l.constants.moduleNames.faucet,"request_coin"),typeArguments:[s],arguments:[t.object(this.addresses.objects.faucet)]})},this.mintSuiFrenTx=e=>{const{tx:t,suiPaymentCoinId:s,suiFrenType:i}=e;return t.moveCall({target:o.TransactionsApiHelpers.createTxTarget(this.addresses.packages.suiFrensGenesisWrapper,l.constants.moduleNames.suiFrensGenesisWrapper,"mint_and_keep"),typeArguments:[i],arguments:[t.object(this.addresses.objects.suiFrensMint),t.object(c.Sui.constants.addresses.suiClockId),"string"==typeof s?t.object(s):s]})},this.fetchMintCoinEvents=e=>i(this,void 0,void 0,(function*(){return yield this.Provider.Events().fetchCastEventsWithCursor(Object.assign(Object.assign({},e),{query:{MoveEventType:this.eventTypes.mintCoin},eventFromEventOnChain:r.FaucetApiCasting.faucetMintCoinEventFromOnChain}))})),this.fetchAddCoinEvents=e=>i(this,void 0,void 0,(function*(){return yield this.Provider.Events().fetchCastEventsWithCursor(Object.assign(Object.assign({},e),{query:{MoveEventType:this.eventTypes.addCoin},eventFromEventOnChain:r.FaucetApiCasting.faucetAddCoinEventFromOnChain}))})),this.mintCoinEventType=()=>d.EventsApiHelpers.createEventType(this.addresses.packages.faucet,l.constants.moduleNames.faucet,l.constants.eventNames.mintCoin),this.addCoinEventType=()=>d.EventsApiHelpers.createEventType(this.addresses.packages.faucet,l.constants.moduleNames.faucet,l.constants.eventNames.addCoin);const t=this.Provider.addresses.faucet;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t,this.eventTypes={mintCoin:this.mintCoinEventType(),addCoin:this.addCoinEventType()}}}t.FaucetApi=l,l.constants={moduleNames:{faucet:"faucet",faucetRegistry:"faucet_registry",suiFrensGenesisWrapper:"genesis_wrapper"},eventNames:{mintCoin:"MintedCoin",addCoin:"AddedCoinEvent"}}},268086:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FaucetApiCasting=void 0;class s{}t.FaucetApiCasting=s,s.faucetMintCoinEventFromOnChain=e=>{const t=e.parsedJson;return{minter:t.user,coinMinted:t.type,balanceMinted:BigInt(t.amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},s.faucetAddCoinEventFromOnChain=e=>{const t=e.parsedJson;return{coinSymbol:t.symbol,coinType:t.type,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},251234:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Faucet=void 0;const n=s(601151);class r extends n.Caller{constructor(e,t){super(e,"faucet"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Faucet();if(!t)throw new Error("missing AftermathApi Provider");return t}}getSupportedCoins(){return i(this,void 0,void 0,(function*(){return this.fetchApi("supported-coins")}))}getRequestCoinTransaction(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("request",e)}))}getMintSuiFrenTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildMintSuiFrenTx(e)}))}}t.Faucet=r,r.constants={defaultRequestAmountUsd:10}},120325:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},713071:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(251234),t)},646074:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(670136),t),n(s(708188),t),n(s(450173),t),n(s(174106),t),n(s(740243),t),n(s(713071),t),n(s(113971),t),n(s(955954),t),n(s(105709),t),n(s(654921),t),n(s(267080),t),n(s(851693),t),n(s(302416),t)},767745:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LeveragedStakingApi=void 0;const r=s(243333),a=s(578230),o=s(302416),d=s(851693),c=n(s(128879));class l{constructor(e,t){this.Provider=e,this.ScallopProviders=t,this.fetchLeveragedStakePosition=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e,s=yield this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.leveragedAfSuiPosition,objectFromSuiObjectResponse:r.Casting.leveragedStaking.leveragedAfSuiPositionFromSuiObjectResponse});return s.length<=0?"none":s[0]})),this.fetchSuiMarketPool=()=>i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");const e=yield this.ScallopProviders.Query.getMarketPool("sui");if(!e)throw new Error("sui market pool not found");return e})),this.fetchLeveragedAfSuiState=()=>i(this,void 0,void 0,(function*(){return this.Provider.Objects().fetchCastObject({objectId:this.addresses.leveragedStaking.objects.leveragedAfSuiState,objectFromSuiObjectResponse:r.Casting.leveragedStaking.leveragedAfSuiStateFromSuiObjectResponse})})),this.fetchAfSuiMarketCollateral=()=>i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");const e=yield this.ScallopProviders.Query.getMarketCollateral("afsui");if(!e)throw new Error("sui market pool not found");return e})),this.fetchLeveragedAfSuiPosition=e=>i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");const t=yield this.Provider.Objects().fetchCastObject({objectId:e.leveragedAfSuiPositionId,objectFromSuiObjectResponse:r.Casting.leveragedStaking.leveragedAfSuiPositionFromSuiObjectResponse}),s=yield this.ScallopProviders.Query.queryObligation(e.obligationId.toString()),i=yield this.getMarketData(Object.assign(Object.assign({},e),{poolCoinName:"sui"})),n=(Math.ceil(Number(i.borrowIndex)),Math.ceil((0,c.default)().valueOf()/1e3),Number(i.lastUpdated),Number(i.interestRate.value),Number(i.interestRateScale),Number(s.debts[0].borrowIndex||0),BigInt(0));return Object.assign(Object.assign({},t),{suiDebt:n})})),this.newLeveragedAfSuiPositionTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.leveragedAfSuiPosition,"new_leveraged_afsui_position"),typeArguments:[],arguments:[t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),r.Helpers.addTxObject(t,e.obligationKeyId)]})},this.initiateLeverageStakeTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"initiate_leverage_stake"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),r.Helpers.addTxObject(t,e.afSuiCoinId)]})},this.initiateLeverageUnstakeTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"initiate_leverage_unstake"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),t.pure.u64(e.unstakeAmount)]})},this.initiateChangeLeverageTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"initiate_change_leverage"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState)]})},this.completeActionTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"complete_action"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedActionCapId),r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),r.Helpers.addTxObject(t,e.obligationId),t.object(this.addresses.staking.objects.stakedSuiVault),t.object(this.addresses.staking.objects.safe)]})},this.depositAfSuiCollateralTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"deposit_afsui_collateral"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedActionCapId),r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),t.object(this.addresses.scallop.objects.version),r.Helpers.addTxObject(t,e.obligationId),t.object(this.addresses.scallop.objects.afSuiMarket),r.Helpers.addTxObject(t,e.afSuiCoinId)]})},this.withdrawAfSuiCollateralTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"withdraw_afsui_collateral"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedActionCapId),r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),t.object(this.addresses.scallop.objects.version),r.Helpers.addTxObject(t,e.obligationId),t.object(this.addresses.scallop.objects.afSuiMarket),t.object(this.addresses.scallop.objects.coinDecimalsRegistry),t.pure.u64(e.withdrawAmount),t.object(this.addresses.scallop.objects.xOracle),t.object(d.Sui.constants.addresses.suiClockId)]})},this.borrowSuiTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"borrow_sui"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedActionCapId),r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),t.object(this.addresses.scallop.objects.version),r.Helpers.addTxObject(t,e.obligationId),t.object(this.addresses.scallop.objects.afSuiMarket),t.object(this.addresses.scallop.objects.coinDecimalsRegistry),t.pure.u64(e.borrowAmount),t.object(this.addresses.scallop.objects.xOracle),t.object(d.Sui.constants.addresses.suiClockId)]})},this.repaySuiTx=e=>{const{tx:t}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.leveragedStaking.packages.leveragedAfSui,l.constants.moduleNames.interface,"repay_sui"),typeArguments:[],arguments:[r.Helpers.addTxObject(t,e.leveragedActionCapId),r.Helpers.addTxObject(t,e.leveragedAfSuiPositionId),t.object(this.addresses.leveragedStaking.objects.leveragedAfSuiState),t.object(this.addresses.scallop.objects.version),r.Helpers.addTxObject(t,e.obligationId),t.object(this.addresses.scallop.objects.afSuiMarket),r.Helpers.addTxObject(t,e.suiCoinId),t.object(d.Sui.constants.addresses.suiClockId)]})},this.fetchBuildWithdrawAfSuiCollateralTx=e=>i(this,void 0,void 0,(function*(){const{scallopTx:t}=e;return yield t.updateAssetPricesQuick(["sui","afsui"]),this.withdrawAfSuiCollateralTx(Object.assign(Object.assign({},e),{tx:t.txBlock,leveragedActionCapId:e.leveragedActionCapId,withdrawAmount:e.withdrawAmount}))})),this.fetchBuildOpenLeveragedStakeTx=e=>i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");const t=this.ScallopProviders.Builder.createTxBlock(),s=t.txBlock;s.setSender(e.walletAddress);const[i,n,r]=t.openObligation(),[a]=this.newLeveragedAfSuiPositionTx({tx:s,obligationKeyId:n});return yield this.buildLeveragedStakeTx(Object.assign(Object.assign({},e),{scallopTx:t,leveragedAfSuiPositionId:a,obligationId:i,baseAfSuiCollateral:BigInt(0),totalAfSuiCollateral:BigInt(0),totalSuiDebt:BigInt(0)})),s.transferObjects([a],e.walletAddress),t.returnObligation(i,r),s})),this.fetchBuildLeveragedStakeTx=e=>i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");const t=this.ScallopProviders.Builder.createTxBlock(),s=t.txBlock;return s.setSender(e.walletAddress),yield this.buildLeveragedStakeTx(Object.assign(Object.assign({},e),{scallopTx:t})),s})),this.buildLeveragedStakeTx=e=>i(this,void 0,void 0,(function*(){const{scallopTx:t,referrer:s,walletAddress:i,leveragedAfSuiPositionId:n,obligationId:r,stakeAmount:a,isSponsoredTx:d}=e,c=t.txBlock;let l,u;if(s&&this.Provider.ReferralVault().updateReferrerTx({tx:c,referrer:s}),"sui"===e.stakeCoinType){const e=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:c,walletAddress:i,isSponsoredTx:d,coinType:o.Coin.constants.suiCoinType,coinAmount:a}),t=yield this.swapOrStakeSuiToAfSui({tx:c,suiAmount:a,suiCoinId:e});l=t.minAmountOut,u=t.afSuiCoinId}else l=a,u=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:c,walletAddress:i,isSponsoredTx:d,coinType:this.Provider.Staking().coinTypes.afSui,coinAmount:a});const p=this.initiateLeverageStakeTx({tx:c,leveragedAfSuiPositionId:n,afSuiCoinId:u});this.depositAfSuiCollateralTx(Object.assign(Object.assign({},e),{tx:c,leveragedActionCapId:p,afSuiCoinId:u,obligationId:e.obligationId})),e.leverage>1&&(yield this.fetchBuildIncreaseLeverageTx(Object.assign(Object.assign({},e),{baseAfSuiCollateral:e.baseAfSuiCollateral+l,totalAfSuiCollateral:e.totalAfSuiCollateral+l,totalSuiDebt:e.totalSuiDebt,newLeverage:e.leverage,leveragedActionCapId:p}))),this.completeActionTx({tx:c,leveragedActionCapId:p,leveragedAfSuiPositionId:n,obligationId:r})})),this.fetchBuildLeveragedUnstakeTx=e=>i(this,void 0,void 0,(function*(){throw new Error("TODO")})),this.fetchBuildChangeLeverageTx=e=>i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");const{referrer:t,walletAddress:s,leveragedAfSuiPositionId:i,obligationId:n}=e,r=this.ScallopProviders.Builder.createTxBlock(),a=r.txBlock;a.setSender(s),t&&this.Provider.ReferralVault().updateReferrerTx({tx:a,referrer:t});const o=this.initiateChangeLeverageTx({tx:a,leveragedAfSuiPositionId:i});if(e.newLeverage<e.currentLeverage){const t=yield this.fetchBuildDecreaseLeverageTx(Object.assign(Object.assign({},e),{scallopTx:r,leveragedActionCapId:o}));this.repaySuiTx(Object.assign(Object.assign({},e),{tx:a,leveragedActionCapId:o,suiCoinId:t}))}else yield this.fetchBuildIncreaseLeverageTx(Object.assign(Object.assign({},e),{scallopTx:r,leveragedActionCapId:o}));return this.completeActionTx({tx:a,leveragedActionCapId:o,leveragedAfSuiPositionId:i,obligationId:n}),a})),this.fetchBuildIncreaseLeverageTx=e=>i(this,void 0,void 0,(function*(){throw new Error("TODO")})),this.fetchBuildDecreaseLeverageTx=e=>i(this,void 0,void 0,(function*(){throw new Error("TODO")})),this.swapOrStakeSuiToAfSui=e=>i(this,void 0,void 0,(function*(){throw new Error("TODO")})),this.updateTotalSuiDebt=e=>i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");const t=(yield this.ScallopProviders.Query.getMarketPool("sui")).borrowIndex,s=yield this.ScallopProviders.Query.queryObligation(e.obligationId.toString()),[i,n]=s.debts?[BigInt(s.debts[0].amount),Number(s.debts[0].borrowIndex)]:[BigInt(0),0];return n===t?{totalSuiDebt:i}:{totalSuiDebt:BigInt(Math.floor(Number(i)*t/n))}})),this.leveragedStakedEventType=()=>a.EventsApiHelpers.createEventType(this.addresses.staking.packages.events,l.constants.moduleNames.events,l.constants.eventNames.leveragedStaked),this.leveragedUnstakedEventType=()=>a.EventsApiHelpers.createEventType(this.addresses.staking.packages.events,l.constants.moduleNames.events,l.constants.eventNames.leveragedUnstaked),this.leverageChangedEventType=()=>a.EventsApiHelpers.createEventType(this.addresses.staking.packages.events,l.constants.moduleNames.events,l.constants.eventNames.leverageChanged);const s=this.Provider.addresses.leveragedStaking,n=this.Provider.addresses.staking,u=this.Provider.addresses.pools,p=this.Provider.addresses.scallop;if(!(s&&n&&u&&p))throw new Error("not all required addresses have been set in provider");this.addresses={leveragedStaking:s,staking:n,pools:u,scallop:p},this.eventTypes={leveragedStaked:this.leveragedStakedEventType(),leveragedUnstaked:this.leveragedUnstakedEventType(),leverageChanged:this.leverageChangedEventType()},this.objectTypes={leveragedAfSuiPosition:`${s.packages.leveragedAfSuiInitial}::leveraged_afsui_position::LeveragedAfSuiPosition`}}fetchEventsForUser(e){return i(this,void 0,void 0,(function*(){throw new Error("TODO")}))}fetchPerformanceData(e){return i(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}getMarketData(e){return i(this,void 0,void 0,(function*(){if(!this.ScallopProviders)throw new Error("Scallop providers not set");let{poolCoinName:t}=e;const s=this.ScallopProviders.Query.address.get("core.market"),i=(yield this.ScallopProviders.Query.suiKit.client().getObject({id:s,options:{showContent:!0}})).data;let n,r,a,o;if(i&&i.content&&"fields"in i.content){const e=i.content.fields,d=this.ScallopProviders.Query.utils.parseCoinType(t),c=e.vault.fields.balance_sheets.fields.table.fields.id.id,l=(yield this.ScallopProviders.Query.suiKit.client().getDynamicFieldObject({parentId:c,name:{type:"0x1::type_name::TypeName",value:{name:d.substring(2)}}})).data;l&&l.content&&"fields"in l.content&&(n=l.content.fields.value.fields);const u=e.borrow_dynamics.fields.table.fields.id.id,p=(yield this.ScallopProviders.Query.suiKit.client().getDynamicFieldObject({parentId:u,name:{type:"0x1::type_name::TypeName",value:{name:d.substring(2)}}})).data;p&&p.content&&"fields"in p.content&&(r=p.content.fields.value.fields);const h=e.interest_models.fields.table.fields.id.id,m=(yield this.ScallopProviders.Query.suiKit.client().getDynamicFieldObject({parentId:h,name:{type:"0x1::type_name::TypeName",value:{name:d.substring(2)}}})).data;m&&m.content&&"fields"in m.content&&(a=m.content.fields.value.fields);const g=(yield this.ScallopProviders.Query.suiKit.client().getDynamicFieldObject({parentId:s,name:{type:"0xc38f849e81cfe46d4e4320f508ea7dda42934a329d5a6571bb4c3cb6ea63f5da::market_dynamic_keys::BorrowFeeKey",value:{type:{name:d.substring(2)}}}})).data;g&&g.content&&"fields"in g.content&&(o=g.content.fields.value.fields)}if(!(n&&r&&a&&o))throw Error("Could not load MarketData");return{type:a.type.fields,maxBorrowRate:a.max_borrow_rate.fields,interestRate:r.interest_rate.fields,interestRateScale:r.interest_rate_scale,borrowIndex:r.borrow_index,lastUpdated:r.last_updated,cash:n.cash,debt:n.debt,marketCoinSupply:n.market_coin_supply,reserve:n.revenue,reserveFactor:a.revenue_factor.fields,borrowWeight:a.borrow_weight.fields,borrowFeeRate:o,baseBorrowRatePerSec:a.base_borrow_rate_per_sec.fields,borrowRateOnHighKink:a.borrow_rate_on_high_kink.fields,borrowRateOnMidKink:a.borrow_rate_on_mid_kink.fields,highKink:a.high_kink.fields,midKink:a.mid_kink.fields,minBorrowAmount:a.min_borrow_amount}}))}}t.LeveragedStakingApi=l,l.constants={moduleNames:{leveragedAfSuiPosition:"leveraged_afsui_position",leveragedAfSuiState:"leveraged_afsui_state",interface:"interface",events:"events"},eventNames:{leveragedStaked:"StakedEvent",leveragedUnstaked:"UnstakedEvent",leverageChanged:"ChangedLeverageEvent"}},l.dataTimeframesToDays={"1M":30}},516230:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LeveragedStakingApiCasting=void 0;const i=s(243333);class n{}t.LeveragedStakingApiCasting=n,n.leveragedAfSuiPositionFromSuiObjectResponse=e=>{const t=i.Helpers.getObjectType(e),s=i.Helpers.getObjectFields(e);return{objectType:t,objectId:i.Helpers.getObjectId(e),obligationId:i.Helpers.addLeadingZeroesToType(s.obligation_key.fields.ownership.fields.of),obligationKeyId:i.Helpers.addLeadingZeroesToType(s.obligation_key.fields.id.id),baseAfSuiCollateral:BigInt(s.base_afsui_collateral),afSuiCollateral:BigInt(s.total_afsui_collateral),suiDebt:BigInt(s.total_sui_debt)}},n.leveragedAfSuiStateFromSuiObjectResponse=e=>{const t=i.Helpers.getObjectType(e),s=i.Helpers.getObjectFields(e);return{objectType:t,objectId:i.Helpers.getObjectId(e),totalAfSuiCollateral:BigInt(s.total_afsui_collateral),totalSuiDebt:BigInt(s.total_sui_debt),protocolVersion:BigInt(s.protocol_version)}},n.leveragedStakedEventFromOnChain=e=>{const t=e.parsedJson;return{userAddress:i.Helpers.addLeadingZeroesToType(t.user),leverage:i.Casting.Fixed.directCast(BigInt(t.leverage)),newAfSuiCollateral:BigInt(t.new_afsui_collateral),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},n.leveragedUnstakedEventFromOnChain=e=>{const t=e.parsedJson;return{userAddress:i.Helpers.addLeadingZeroesToType(t.user),afsuiCollateral:BigInt(t.afsui_collateral),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},n.leveragedStakeChangedEventFromOnChain=e=>{const t=e.parsedJson;return{userAddress:i.Helpers.addLeadingZeroesToType(t.user),newLeverage:i.Casting.Fixed.directCast(BigInt(t.new_leverage)),initialLeverage:i.Casting.Fixed.directCast(BigInt(t.initial_leverage)),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},740243:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(994e3),t)},994e3:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LeveragedStaking=void 0;const n=s(601151);class r extends n.Caller{constructor(e){super(e,"leveraged-staking")}getLeveragedStakePosition(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("leveraged-stake-position",e)}))}getLeveragedAfSuiState(){return i(this,void 0,void 0,(function*(){return this.fetchApi("leveraged-afsui-state")}))}getSuiMarketPool(){return i(this,void 0,void 0,(function*(){return this.fetchApi("sui-market-pool")}))}getAfSuiMarketCollateral(){return i(this,void 0,void 0,(function*(){return this.fetchApi("afsui-market-collateral")}))}getEventsForUser(e){return i(this,void 0,void 0,(function*(){return this.fetchApiEvents("events",e)}))}getPerformanceData(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`performance-data/${e.timeframe}/${e.borrowRate}/${e.maxLeverage}`)}))}}t.LeveragedStaking=r,r.calcLeverage=e=>r.calcLeverageNormalized({normalizedTotalSuiDebt:e.totalSuiDebt,normalizedTotalAfSuiCollateral:BigInt(Math.floor(Number(e.totalAfSuiCollateral)/e.afSuiToSuiExchangeRate))}),r.calcTotalSuiDebt=e=>BigInt(Math.floor(Number(e.totalAfSuiCollateral)*e.afSuiToSuiExchangeRate*(1-(e.leverage?1/e.leverage:0)))),r.calcLeverageNormalized=e=>{const t=Number(e.normalizedTotalAfSuiCollateral);return t?1/(1-Number(e.normalizedTotalSuiDebt)/t):1}},806551:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLeveragedStakeChangedLeverageEvent=t.isLeveragedUnstakedEvent=t.isLeveragedStakedEvent=void 0;const i=s(767745);t.isLeveragedStakedEvent=e=>e.type.includes(i.LeveragedStakingApi.constants.eventNames.leveragedStaked),t.isLeveragedUnstakedEvent=e=>e.type.includes(i.LeveragedStakingApi.constants.eventNames.leveragedUnstaked),t.isLeveragedStakeChangedLeverageEvent=e=>e.type.includes(i.LeveragedStakingApi.constants.eventNames.leverageChanged)},6157:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LimitOrdersApi=void 0;const i=s(578230);t.LimitOrdersApi=class{constructor(e){this.Provider=e,this.createdOrderEventType=()=>i.EventsApiHelpers.createEventType(this.addresses.packages.events,"events","CreatedOrderEventV1");const t=this.Provider.addresses.limitOrders;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t,this.eventTypes={createdOrder:this.createdOrderEventType()}}}},700587:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LimitOrders=void 0;const n=s(601151);class r extends n.Caller{constructor(e){super(e,"limit-orders")}getActiveLimitOrders(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("active",e)}))}getPastLimitOrders(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("past",e)}))}getCreateLimitOrderTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/create-order",e)}))}cancelLimitOrder(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("cancel",e)}))}cancelLimitOrdersMessageToSign(e){return{action:"CANCEL_LIMIT_ORDERS",order_object_ids:e.orderIds}}getMinOrderSizeUsd(){return i(this,void 0,void 0,(function*(){return this.fetchApi("min-order-size-usd",{})}))}}t.LimitOrders=r,r.constants={gasAmount:BigInt(5e7)}},779604:(e,t,s)=>{var i=s(348834).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MultisigApi=void 0;const n=s(280469),r=s(953045);t.MultisigApi=class{constructor(e){this.Provider=e;const t=this.Provider.addresses.sharedCustody;if(!t)throw new Error("not all required addresses have been set in provider");this.sharedCustodyAddresses=t}getMultisigForUser(e){const t=i.from(this.sharedCustodyAddresses.publicKey||"","base64"),s=new Uint8Array(t).subarray(1),a=new r.Ed25519PublicKey(s),o=new r.Ed25519PublicKey(e.userPublicKey),d=n.MultiSigPublicKey.fromPublicKeys({threshold:1,publicKeys:[{publicKey:a,weight:1},{publicKey:o,weight:1}]});return{publicKey:d,address:d.toSuiAddress()}}}},626543:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Multisig=void 0;const i=s(601151);class n extends i.Caller{constructor(e,t){super(e,"multisig"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Multisig();if(!t)throw new Error("missing AftermathApi Provider");return t}}getMultisigForUser(e){return this.useProvider().getMultisigForUser(e)}}t.Multisig=n},528216:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NftAmmApi=void 0;const n=s(906023),r=s(243333),a=s(897399),o=s(593460),d=s(108979);class c{constructor(e){this.Provider=e,this.fetchNftsInMarketTable=e=>i(this,void 0,void 0,(function*(){return yield this.Provider.DynamicFields().fetchCastDynamicFieldsOfTypeWithCursor(Object.assign(Object.assign({},e),{parentObjectId:e.marketTableObjectId,objectsFromObjectIds:e=>this.Provider.Nfts().fetchNfts({objectIds:e})}))})),this.fetchMarket=e=>i(this,void 0,void 0,(function*(){return this.Provider.Objects().fetchCastObject(Object.assign(Object.assign({},e),{objectFromSuiObjectResponse:n.NftAmmApiCasting.marketObjectFromSuiObject}))})),this.fetchMarkets=e=>i(this,void 0,void 0,(function*(){return this.Provider.Objects().fetchCastObjectBatch(Object.assign(Object.assign({},e),{objectFromSuiObjectResponse:n.NftAmmApiCasting.marketObjectFromSuiObject}))})),this.fetchBuildBuyTx=e=>i(this,void 0,void 0,(function*(){const t=new d.Transaction;t.setSender(e.walletAddress);const{market:s}=e,i=s.market,n=s.getBuyAssetCoinAmountIn({nftsCount:e.nftObjectIds.length,referral:void 0!==e.referrer}),r=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:t,walletAddress:e.walletAddress,coinType:i.assetCoinType,coinAmount:n});return this.buyTx(Object.assign(Object.assign({tx:t},e),{marketObjectId:i.objectId,genericTypes:c.genericTypesForMarket({market:s}),assetCoin:r,expectedAssetCoinAmountIn:n,withTransfer:!0})),t})),this.fetchBuildSellTx=e=>i(this,void 0,void 0,(function*(){const t=new d.Transaction;t.setSender(e.walletAddress);const{market:s}=e,i=s.market,n=s.getSellAssetCoinAmountOut({nftsCount:e.nftObjectIds.length,referral:void 0!==e.referrer});return this.sellTx(Object.assign(Object.assign({},e),{tx:t,nfts:e.nftObjectIds,marketObjectId:i.objectId,genericTypes:c.genericTypesForMarket({market:s}),expectedAssetCoinAmountOut:n,withTransfer:!0})),t})),this.fetchBuildDepositTx=e=>i(this,void 0,void 0,(function*(){const t=new d.Transaction;t.setSender(e.walletAddress);const{market:s}=e,i=s.market,{lpRatio:n}=s.getDepositLpCoinAmountOut({assetCoinAmountIn:e.assetCoinAmountIn,referral:void 0!==e.referrer}),a=r.Casting.numberToFixedBigInt(n),o=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:t,walletAddress:e.walletAddress,coinType:i.assetCoinType,coinAmount:e.assetCoinAmountIn});return this.depositTx(Object.assign(Object.assign({tx:t},e),{marketObjectId:i.objectId,genericTypes:c.genericTypesForMarket({market:s}),expectedLpRatio:a,assetCoin:o,withTransfer:!0})),t})),this.fetchBuildWithdrawTx=e=>i(this,void 0,void 0,(function*(){const t=new d.Transaction;t.setSender(e.walletAddress);const{market:s}=e,i=s.market,n=s.getWithdrawFractionalizedCoinAmountOut({lpCoinAmount:e.lpCoinAmount,referral:void 0!==e.referrer}),{balances:r}=a.Coin.coinsAndBalancesOverZero({[i.fractionalizedCoinType]:n}),o=r[0],l=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:t,walletAddress:e.walletAddress,coinType:i.lpCoinType,coinAmount:e.lpCoinAmount});return this.addWithdrawCommandToTransaction(Object.assign(Object.assign({tx:t},e),{marketObjectId:i.objectId,genericTypes:c.genericTypesForMarket({market:s}),expectedAssetCoinAmountOut:o,lpCoin:l,withTransfer:!0})),t})),this.buyTx=e=>{const{tx:t,assetCoin:s,genericTypes:i,nftObjectIds:n}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.packages.nftAmm,e.withTransfer?c.constants.moduleNames.interface:c.constants.moduleNames.actions,"buy"),typeArguments:i,arguments:[t.object(e.marketObjectId),t.object(this.addresses.objects.protocolFeeVault),t.object(this.addresses.objects.treasury),t.object(this.addresses.objects.insuranceFund),t.object(this.addresses.objects.referralVault),"string"==typeof s?t.object(s):s,t.makeMoveVec({elements:n.map((e=>t.object(e))),type:"ID"}),t.pure.u64(e.expectedAssetCoinAmountIn.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(e.slippage))]})},this.sellTx=e=>{const{tx:t,genericTypes:s,nfts:i}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.packages.nftAmm,e.withTransfer?c.constants.moduleNames.interface:c.constants.moduleNames.actions,"sell"),typeArguments:s,arguments:[t.object(e.marketObjectId),t.object(this.addresses.objects.protocolFeeVault),t.object(this.addresses.objects.treasury),t.object(this.addresses.objects.insuranceFund),t.object(this.addresses.objects.referralVault),t.makeMoveVec({elements:r.Helpers.isArrayOfStrings(i)?i.map((e=>t.object(e))):i,type:s[3]}),t.pure.u64(e.expectedAssetCoinAmountOut.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(e.slippage))]})},this.depositTx=e=>{const{tx:t,assetCoin:s,genericTypes:i,nfts:n}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.packages.nftAmm,e.withTransfer?c.constants.moduleNames.interface:c.constants.moduleNames.actions,"deposit"),typeArguments:i,arguments:[t.object(e.marketObjectId),t.object(this.addresses.objects.protocolFeeVault),t.object(this.addresses.objects.treasury),t.object(this.addresses.objects.insuranceFund),t.object(this.addresses.objects.referralVault),"string"==typeof s?t.object(s):s,t.makeMoveVec({elements:r.Helpers.isArrayOfStrings(n)?n.map((e=>t.object(e))):n,type:i[3]}),t.pure.u64(e.expectedLpRatio.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(e.slippage))]})},this.addWithdrawCommandToTransaction=e=>{const{tx:t,lpCoin:s,genericTypes:i,nftObjectIds:n}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.packages.nftAmm,e.withTransfer?c.constants.moduleNames.interface:c.constants.moduleNames.actions,"withdraw"),typeArguments:i,arguments:[t.object(e.marketObjectId),t.object(this.addresses.objects.protocolFeeVault),t.object(this.addresses.objects.treasury),t.object(this.addresses.objects.insuranceFund),t.object(this.addresses.objects.referralVault),"string"==typeof s?t.object(s):s,t.makeMoveVec({elements:n.map((e=>t.object(e))),type:"ID"}),t.pure.u64(e.expectedAssetCoinAmountOut.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(e.slippage))]})};const t=this.Provider.addresses.nftAmm;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t}}t.NftAmmApi=c,c.constants={moduleNames:{interface:"interface",actions:"actions",market:"market"}},c.genericTypesForMarket=e=>{const t=e.market.market;return[t.lpCoinType,t.fractionalizedCoinType,t.assetCoinType,t.nftType]}},906023:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NftAmmApiCasting=void 0;const i=s(243333),n=s(302416),r=s(974247);class a{}t.NftAmmApiCasting=a,a.marketObjectFromSuiObject=e=>{const t=i.Helpers.getObjectId(e),s=i.Helpers.getObjectType(e);if(!s)throw new Error("no object type found");const a=i.Helpers.getObjectFields(e),o=r.PoolsApiCasting.poolObjectFromSuiObject(a.pool),d=n.Coin.getInnerCoinType(a.supply.type),c=n.Coin.getInnerCoinType(s).replaceAll(" ","").split(","),l=c[2],u=c[3];return{objectId:t,pool:o,objectType:s,nftsTable:{objectId:a.nfts.fields.id.id,size:BigInt(a.nfts.fields.size)},fractionalizedSupply:BigInt(a.supply.fields.value),fractionalizedCoinAmount:BigInt(a.fractions_amount),fractionalizedCoinType:d,assetCoinType:l,lpCoinType:o.lpCoinType,nftType:u}}},113971:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(484389),t)},484389:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NftAmm=void 0;const n=s(601151),r=s(774746);class a extends n.Caller{constructor(e,t){super(e,"nft-amm"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.NftAmm();if(!t)throw new Error("missing AftermathApi Provider");return t}}getMarket(e){return i(this,void 0,void 0,(function*(){const t=yield this.fetchApi(`markets/${e.objectId}`);return new r.NftAmmMarket(t,this.config)}))}getMarkets(e){return i(this,void 0,void 0,(function*(){return yield Promise.all(e.objectIds.map((e=>this.getMarket({objectId:e}))))}))}getAllMarkets(){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi("markets")).map((e=>new r.NftAmmMarket(e,this.config)))}))}}t.NftAmm=a,a.constants={}},774746:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.NftAmmMarket=void 0;const r=s(601151),a=s(708188);class o extends r.Caller{constructor(e,t,s){super(t,`nft-amm/markets/${e.objectId}`),this.market=e,this.Provider=s,this.getNftSpotPriceInAssetCoin=e=>{const t=this.getAssetCoinToFractionalizeCoinSpotPrice(e);return BigInt(t*Number(this.market.fractionalizedCoinAmount))},this.getFractionalizedCoinToAssetCoinSpotPrice=e=>this.pool.getSpotPrice({coinInType:this.market.fractionalizedCoinType,coinOutType:this.market.assetCoinType,withFees:null==e?void 0:e.withFees}),this.getAssetCoinToFractionalizeCoinSpotPrice=e=>this.pool.getSpotPrice({coinInType:this.market.assetCoinType,coinOutType:this.market.fractionalizedCoinType,withFees:null==e?void 0:e.withFees}),this.getBuyAssetCoinAmountIn=e=>this.pool.getTradeAmountIn({coinOutAmount:BigInt(e.nftsCount)*this.market.fractionalizedCoinAmount,coinInType:this.market.assetCoinType,coinOutType:this.market.fractionalizedCoinType,referral:e.referral}),this.getSellAssetCoinAmountOut=e=>this.pool.getTradeAmountOut({coinInAmount:BigInt(e.nftsCount)*this.market.fractionalizedCoinAmount,coinInType:this.market.fractionalizedCoinType,coinOutType:this.market.assetCoinType,referral:e.referral}),this.getDepositLpCoinAmountOut=e=>this.pool.getDepositLpAmountOut({amountsIn:{[this.market.assetCoinType]:e.assetCoinAmountIn},referral:e.referral}),this.getWithdrawFractionalizedCoinAmountOut=e=>{const t=this.pool.getMultiCoinWithdrawLpRatio({lpCoinAmountIn:e.lpCoinAmount});return this.pool.getWithdrawAmountsOut({lpRatio:t,amountsOutDirection:{[this.market.fractionalizedCoinType]:this.market.fractionalizedCoinAmount},referral:e.referral})[0]},this.getWithdrawNftsCountOut=e=>this.getWithdrawFractionalizedCoinAmountOut(e)/this.market.fractionalizedCoinAmount,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.NftAmm();if(!t)throw new Error("missing AftermathApi Provider");return t},this.market=e,this.pool=new a.Pool(e.pool,t)}getNfts(e){return i(this,void 0,void 0,(function*(){const{cursor:t,limit:s}=e;return this.useProvider().fetchNftsInMarketTable({marketTableObjectId:this.market.objectId,limit:null!=s?s:25,cursor:t})}))}getBuyTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildBuyTx(Object.assign(Object.assign({},e),{market:this}))}))}getSellTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildSellTx(Object.assign(Object.assign({},e),{market:this}))}))}getDepositTransaction(e){return i(this,void 0,void 0,(function*(){const{nftObjectIds:t}=e,s=n(e,["nftObjectIds"]);return this.useProvider().fetchBuildDepositTx(Object.assign(Object.assign({},s),{nfts:t,market:this}))}))}getWithdrawTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildWithdrawTx(Object.assign(Object.assign({},e),{market:this}))}))}}t.NftAmmMarket=o,o.constants={}},635631:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},711460:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OracleApi=void 0;const n=s(108979),r=s(243333),a=s(851693),o=s(578230);class d{constructor(e){this.Provider=e,this.fetchPrice=e=>i(this,void 0,void 0,(function*(){const t=new n.Transaction;this.getPriceTx(Object.assign(Object.assign({},e),{tx:t}));const s=yield this.Provider.Inspections().fetchFirstBytesFromTxOutput({tx:t}),i=r.Casting.bigIntFromBytes(s);return r.Casting.IFixed.numberFromIFixed(i)})),this.getPriceTx=e=>{const{tx:t,priceFeedId:s}=e;return t.moveCall({target:r.Helpers.transactions.createTxTarget(this.addresses.packages.oracleReader,"oracle_reader","get_average_price_for_all_sources"),typeArguments:[],arguments:[t.object(s),t.object(a.Sui.constants.addresses.suiClockId),t.pure.u64(r.Casting.u64MaxBigInt),t.pure.bool(!1),t.pure.bool(!1)]})},this.eventType=e=>o.EventsApiHelpers.createEventType(this.addresses.packages.events,d.constants.moduleNames.events,e);const t=this.Provider.addresses.oracle;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t,this.eventTypes={updatedPriceFeed:this.eventType("UpdatedPriceFeed")}}}t.OracleApi=d,d.constants={moduleNames:{events:"events"}}},250464:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OracleApiCasting=void 0;const i=s(243333),n=s(930492);class r{}t.OracleApiCasting=r,r.updatedPriceFeedEventFromOnChain=e=>{const t=e.parsedJson;return{priceFeedId:i.Helpers.addLeadingZeroesToType(t.price_feed_storage_id),sourceWrapperId:i.Helpers.addLeadingZeroesToType(t.source_wrapper_id),oldPrice:n.IFixedUtils.numberFromIFixed(BigInt(t.old_price)),oldTimestamp:Number(t.old_timestamp),newPrice:n.IFixedUtils.numberFromIFixed(BigInt(t.new_price)),newTimestamp:Number(t.new_timestamp),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},98937:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Oracle=void 0;const n=s(601151);class r extends n.Caller{constructor(e,t){super(e,"oracle"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Oracle();if(!t)throw new Error("missing AftermathApi Provider");return t}}getPrice(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`${e.priceFeedId}/price`)}))}getPrices(e){return i(this,void 0,void 0,(function*(){return Promise.all(e.priceFeedIds.map((e=>this.getPrice({priceFeedId:e}))))}))}}t.Oracle=r},540934:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},409369:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.PerpetualsApi=void 0;const r=s(108979),a=s(243333),o=s(851693),d=s(578230),c=s(480544),l=s(941882);class u{constructor(e){this.Provider=e,this.depositCollateralTx=e=>{const{tx:t,collateralCoinType:s,accountCapId:i}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.perpetuals.packages.perpetuals,u.constants.moduleNames.interface,"deposit_collateral"),typeArguments:[s],arguments:["string"==typeof i?t.object(i):i,"coinBytes"in e?t.pure(e.coinBytes):"string"==typeof e.coinId?t.object(e.coinId):e.coinId]})},this.allocateCollateralTx=e=>{const{tx:t,collateralCoinType:s,accountCapId:i,marketId:n,amount:r}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"allocate_collateral"),typeArguments:[s],arguments:[t.sharedObjectRef({objectId:n,initialSharedVersion:e.marketInitialSharedVersion,mutable:!0}),"string"==typeof i?t.object(i):i,t.pure.u64(r)]})},this.deallocateCollateralTx=e=>{const{tx:t,collateralCoinType:s,accountCapId:i,marketId:n,amount:r}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"deallocate_collateral"),typeArguments:[s],arguments:[t.sharedObjectRef({objectId:n,initialSharedVersion:e.marketInitialSharedVersion,mutable:!0}),t.object(i),t.object(e.basePriceFeedId),t.object(e.collateralPriceFeedId),t.object(o.Sui.constants.addresses.suiClockId),t.pure.u64(r)]})},this.createMarketPositionTx=e=>{const{tx:t,collateralCoinType:s,accountCapId:i,marketId:n}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"create_market_position"),typeArguments:[s],arguments:[t.sharedObjectRef({objectId:n,initialSharedVersion:e.marketInitialSharedVersion,mutable:!0}),"string"==typeof i?t.object(i):i]})},this.shareClearingHouseTx=e=>{const{tx:t,collateralCoinType:s,marketId:i}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"share_clearing_house"),typeArguments:[s],arguments:["string"==typeof i?t.object(i):i]})},this.startSessionTx=e=>{const{tx:t,collateralCoinType:s,accountCapId:i,marketId:n}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"start_session"),typeArguments:[s],arguments:[t.sharedObjectRef({objectId:n,initialSharedVersion:e.marketInitialSharedVersion,mutable:!0}),"string"==typeof i?t.object(i):i,t.object(e.basePriceFeedId),t.object(e.collateralPriceFeedId),t.object(o.Sui.constants.addresses.suiClockId)]})},this.endSessionTx=e=>{const{tx:t,collateralCoinType:s,sessionPotatoId:i}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"end_session"),typeArguments:[s],arguments:["string"==typeof i?t.object(i):i]})},this.placeMarketOrderTx=e=>{const{tx:t,collateralCoinType:s,sessionPotatoId:i,side:n,size:r}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"place_market_order"),typeArguments:[s],arguments:["string"==typeof i?t.object(i):i,t.pure.bool(Boolean(n)),t.pure.u64(r)]})},this.placeLimitOrderTx=e=>{const{tx:t,collateralCoinType:s,sessionPotatoId:i,side:n,size:r,price:o,orderType:d}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"place_limit_order"),typeArguments:[s],arguments:["string"==typeof i?t.object(i):i,t.pure.bool(Boolean(n)),t.pure.u64(r),t.pure.u64(o),t.pure.u64(BigInt(d))]})},this.cancelOrdersTx=e=>{const{tx:t,collateralCoinType:s,accountCapId:i,marketId:n,orderIds:r}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.interface,"cancel_orders"),typeArguments:[s],arguments:[t.sharedObjectRef({objectId:n,initialSharedVersion:e.marketInitialSharedVersion,mutable:!0}),t.object(i),t.pure(l.bcs.vector(l.bcs.u128()).serialize(r))]})},this.reduceOrdersTx=e=>{const{tx:t,packageId:s,collateralCoinType:i,accountCapId:n,marketId:r,orderIds:o,sizesToSubtract:d}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(s,u.constants.moduleNames.interface,"reduce_orders"),typeArguments:[i],arguments:[t.sharedObjectRef({objectId:r,initialSharedVersion:e.marketInitialSharedVersion,mutable:!0}),t.object(n),t.pure(l.bcs.vector(l.bcs.u128()).serialize(o)),t.pure(l.bcs.vector(l.bcs.u64()).serialize(d))]})},this.withdrawCollateralTx=e=>{const{tx:t,collateralCoinType:s,accountCapId:i,amount:n}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.perpetuals.packages.perpetuals,u.constants.moduleNames.interface,"withdraw_collateral"),typeArguments:[s],arguments:["string"==typeof i?t.object(i):i,t.pure.u64(n)]})},this.createAccountTx=e=>{const{tx:t,collateralCoinType:s}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.perpetuals.packages.perpetuals,u.constants.moduleNames.interface,"create_account"),typeArguments:[s],arguments:[t.object(this.addresses.perpetuals.objects.registry)]})},this.placeSLTPOrderTx=e=>{throw new Error("TODO")},this.getPositionTx=e=>{const{tx:t,marketId:s,collateralCoinType:i}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.clearingHouse,"get_position"),typeArguments:[i],arguments:[t.sharedObjectRef({objectId:s,initialSharedVersion:e.marketInitialSharedVersion,mutable:!1}),t.pure.u64(e.accountId)]})},this.getOrderbookTx=e=>{const{tx:t,collateralCoinType:s}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.clearingHouse,"get_orderbook"),typeArguments:[s],arguments:[t.object(e.marketId)]})},this.getBookPriceTx=e=>{const{tx:t,marketId:s,collateralCoinType:i}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.clearingHouse,"get_book_price"),typeArguments:[i],arguments:[t.object(s)]})},this.getBestPriceTx=e=>{const{tx:t,marketId:s,collateralCoinType:i}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.clearingHouse,"get_best_price"),typeArguments:[i],arguments:[t.sharedObjectRef({objectId:s,initialSharedVersion:e.marketInitialSharedVersion,mutable:!1}),t.pure.bool(Boolean(e.side))]})},this.inspectOrdersTx=e=>{const{tx:t,orderbookId:s}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.orderbook,"inspect_orders"),typeArguments:[],arguments:["string"==typeof s?t.object(s):s,t.pure.bool(Boolean(e.side)),t.pure.u64(e.fromPrice),t.pure.u64(e.toPrice)]})},this.getOrderSizeTx=e=>{const{tx:t,orderbookId:s}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(e.packageId,u.constants.moduleNames.orderbook,"get_order_size"),typeArguments:[],arguments:["string"==typeof s?t.object(s):s,t.pure.u128(e.orderId)]})},this.fetchBuildDepositCollateralTx=e=>i(this,void 0,void 0,(function*(){const t=new r.Transaction;t.setSender(e.walletAddress);const{walletAddress:s,collateralCoinType:i,amount:n}=e,a=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:t,walletAddress:s,coinType:i,coinAmount:n});return this.depositCollateralTx(Object.assign({tx:t,coinId:a},e)),t})),this.buildCancelOrderTx=e=>{const{packageId:t,orderId:s,marketId:i,marketInitialSharedVersion:r,collateralChange:a,basePriceFeedId:o,collateralPriceFeedId:d}=e,c=n(e,["packageId","orderId","marketId","marketInitialSharedVersion","collateralChange","basePriceFeedId","collateralPriceFeedId"]);return this.buildCancelOrdersTx(Object.assign(Object.assign({},c),{orderDatas:[{packageId:t,orderId:s,marketId:i,marketInitialSharedVersion:r,collateralChange:a,basePriceFeedId:o,collateralPriceFeedId:d}]}))},this.buildCancelOrdersTx=e=>{const{orderDatas:t,collateralCoinType:s,accountCapId:i}=e;if(t.length<=0)throw new Error("cannot have order datas of length zero");const n=new r.Transaction;n.setSender(e.walletAddress);const o=t.reduce(((e,t)=>t.marketId in e?Object.assign(Object.assign({},e),{[t.marketId]:[...e[t.marketId],t]}):Object.assign(Object.assign({},e),{[t.marketId]:[t]})),{});for(const[e,t]of Object.entries(o)){if(t.length<=0)continue;const r=t[0].marketInitialSharedVersion,o=t[0].packageId;this.cancelOrdersTx({tx:n,collateralCoinType:s,accountCapId:i,marketId:e,marketInitialSharedVersion:r,packageId:o,orderIds:t.map((e=>e.orderId))});const d=a.Helpers.sumBigInt(t.map((e=>e.collateralChange)));d<BigInt(0)?this.deallocateCollateralTx({tx:n,accountCapId:i,collateralCoinType:s,marketId:e,marketInitialSharedVersion:r,packageId:o,amount:a.Helpers.absBigInt(d),basePriceFeedId:t[0].basePriceFeedId,collateralPriceFeedId:t[0].collateralPriceFeedId}):d>BigInt(0)&&this.allocateCollateralTx({tx:n,accountCapId:i,collateralCoinType:s,marketId:e,marketInitialSharedVersion:r,packageId:o,amount:d})}return n},this.buildWithdrawCollateralTx=e=>{const t=new r.Transaction;t.setSender(e.walletAddress);const s=this.withdrawCollateralTx(Object.assign({tx:t},e));return t.transferObjects([s],e.walletAddress),t},this.buildCreateAccountTx=e=>{const t=new r.Transaction;t.setSender(e.walletAddress);const s=this.createAccountTx(Object.assign({tx:t},e));return t.transferObjects([s],e.walletAddress),t},this.fetchBuildPlaceSLTPOrderTx=e=>{throw new Error("TODO")},this.buildTransferCollateralTx=e=>{const{walletAddress:t,collateralCoinType:s,fromAccountCapId:i,toAccountCapId:n,amount:a}=e,o=new r.Transaction;o.setSender(t);const d=this.withdrawCollateralTx({tx:o,collateralCoinType:s,amount:a,accountCapId:i});return this.depositCollateralTx({tx:o,collateralCoinType:s,coinId:d,accountCapId:n}),o},this.buildAllocateCollateralTx=c.TransactionsApiHelpers.createBuildTxFunc(this.allocateCollateralTx),this.buildDeallocateCollateralTx=c.TransactionsApiHelpers.createBuildTxFunc(this.deallocateCollateralTx),this.buildReduceOrdersTx=e=>{const{walletAddress:t,collateralChange:s,accountCapId:i,collateralCoinType:n,marketId:o,marketInitialSharedVersion:d,packageId:c,basePriceFeedId:l,collateralPriceFeedId:u,orderIds:p,sizesToSubtract:h}=e,m=new r.Transaction;return m.setSender(t),this.reduceOrdersTx({tx:m,packageId:c,collateralCoinType:n,accountCapId:i,marketId:o,marketInitialSharedVersion:d,orderIds:p,sizesToSubtract:h}),s<BigInt(0)?this.deallocateCollateralTx({tx:m,accountCapId:i,collateralCoinType:n,marketId:o,marketInitialSharedVersion:d,packageId:c,basePriceFeedId:l,collateralPriceFeedId:u,amount:a.Helpers.absBigInt(s)}):s>BigInt(0)&&this.allocateCollateralTx({tx:m,accountCapId:i,collateralCoinType:n,marketId:o,marketInitialSharedVersion:d,packageId:c,amount:s}),m},this.getAccountCapType=e=>`${this.addresses.perpetuals.packages.events}::${u.constants.moduleNames.account}::Account<${e.collateralCoinType}>`,this.eventType=e=>d.EventsApiHelpers.createEventType(this.addresses.perpetuals.packages.events,u.constants.moduleNames.events,e);const t=this.Provider.addresses.perpetuals,s=this.Provider.addresses.oracle;if(!t||!s)throw new Error("not all required addresses have been set in provider");this.addresses={perpetuals:t,oracle:s},this.eventTypes={withdrewCollateral:this.eventType("WithdrewCollateral"),depositedCollateral:this.eventType("DepositedCollateral"),settledFunding:this.eventType("SettledFunding"),allocatedCollateral:this.eventType("AllocatedCollateral"),deallocatedCollateral:this.eventType("DeallocatedCollateral"),liquidated:this.eventType("LiquidatedPosition"),filledTakerOrderLiquidator:this.eventType("FilledTakerOrderLiquidator"),createdAccount:this.eventType("CreatedAccount"),canceledOrder:this.eventType("CanceledOrder"),postedOrder:this.eventType("PostedOrder"),filledMakerOrder:this.eventType("FilledMakerOrder"),filledTakerOrder:this.eventType("FilledTakerOrder"),reducedOrder:this.eventType("ReducedOrder"),postedOrderReceipt:this.eventType("OrderbookPostReceipt"),updatedPremiumTwap:this.eventType("UpdatedPremiumTwap"),updatedSpreadTwap:this.eventType("UpdatedSpreadTwap"),updatedFunding:this.eventType("UpdatedFunding"),updatedMarketVersion:this.eventType("UpdatedClearingHouseVersion")},this.moveErrors={[this.addresses.perpetuals.packages.perpetuals]:{0:"Deposit Or Withdraw Amount Zero",1:"Invalid Size Or Price",2:"Invalid Insurance Fund Id",3:"Bad Index Price",4:"Invalid Collateral Type",5:"Order Usd Value Too Low",6:"Invalid Number Of Sizes",1e3:"Invalid Market Parameters",1001:"Updating Funding Too Early",1002:"Proposal Already Exists",1003:"Premature Proposal",1004:"Invalid Proposal Delay",1005:"Market Does Not Exist",1006:"Value Out Of Range",1007:"Proposal Does Not Exist",1008:"No Fees Accrued",1009:"Insufficient Insurance Surplus",1010:"No Price Feed For Market",2e3:"Account Not Found",2001:"Position Not Found",2002:"Max Positions Exceeded",2003:"Margin Requirements Violated, Try Lowering Size",2004:"Account Above MMR",2005:"Account Bad Debt",2006:"Insufficient Free Collateral",2007:"Position Not Null",2008:"Max Pending Orders Exceeded",2009:"Account Below IMR",2010:"Account Above Tolerance",3e3:"Key Does Not Exist",3001:"Key Already Exists",3002:"Destroying Not Empty Map",3003:"Invalid User For Order",3004:"Flag Requirements Violated",3005:"Not Enough Liquidity"}}}}t.PerpetualsApi=u,u.constants={moduleNames:{interface:"interface",orderbook:"orderbook",events:"events",clearingHouse:"clearing_house",account:"account"}}},565033:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.PerpetualsApiCasting=void 0;const n=s(358888),r=s(243333),a=s(646074),o=s(845963),d=s(941882);class c{static rawAccountCapFromRaw(e,t,s,i){return{collateralCoinType:t,objectId:r.Helpers.addLeadingZeroesToType(e.id),objectType:e.objectType,objectVersion:s,objectDigest:i,accountId:BigInt(e.accountId),collateral:BigInt(e.collateral.value)}}static marketDataFromIndexerResponse(e,t,s){return{packageId:r.Casting.addressFromStringBytes(e.pkg_id),objectId:r.Casting.addressFromStringBytes(e.object.id.id),initialSharedVersion:Number(e.initial_shared_version),collateralCoinType:t,marketParams:this.marketParamsFromIndexerResponse(e.object.market_params,s),marketState:this.marketStateFromIndexerResponse(e.object.market_state)}}static orderbookFromIndexerResponse(e,t,s){const i={asks:Object.entries(e.asks).reduce(((e,[i,n])=>Object.assign(Object.assign({},e),{[i]:{accountId:BigInt(n.account_id),size:Number(n.size)*a.Perpetuals.lotOrTickSizeToNumber(t),price:a.Perpetuals.orderPriceToPrice({orderPrice:a.Perpetuals.OrderUtils.price(BigInt(i)),lotSize:t,tickSize:s})}})),{}),bids:Object.entries(e.bids).reduce(((e,[i,n])=>Object.assign(Object.assign({},e),{[i]:{accountId:BigInt(n.account_id),size:Number(n.size)*a.Perpetuals.lotOrTickSizeToNumber(t),price:a.Perpetuals.orderPriceToPrice({orderPrice:a.Perpetuals.OrderUtils.price(BigInt(i)),lotSize:t,tickSize:s})}})),{}),asksTotalSize:Number(e.asks_size)*a.Perpetuals.lotOrTickSizeToNumber(t),bidsTotalSize:Number(e.bids_size)*a.Perpetuals.lotOrTickSizeToNumber(t)},n=Object.values(i.bids),r=Object.values(i.asks),o=n.length<=0?void 0:Math.max(...n.map((e=>e.price))),d=r.length<=0?void 0:Math.min(...r.map((e=>e.price))),c=void 0===o||void 0===d?void 0:(o+d)/2;return Object.assign(Object.assign({},i),{bestBidPrice:o,bestAskPrice:d,midPrice:c})}}t.PerpetualsApiCasting=c,i=c,c.positionFromIndexerReponse=e=>{const{position:t,collateralCoinType:s,marketId:i,leverage:a}=e;return{collateralCoinType:s,leverage:a,collateral:r.Casting.IFixed.iFixedFromStringBytes(t.position.collateral),baseAssetAmount:r.Casting.IFixed.iFixedFromStringBytes(t.position.base_asset_amount),quoteAssetNotionalAmount:r.Casting.IFixed.iFixedFromStringBytes(t.position.quote_asset_notional_amount),cumFundingRateLong:r.Casting.IFixed.iFixedFromStringBytes(t.position.cum_funding_rate_long),cumFundingRateShort:r.Casting.IFixed.iFixedFromStringBytes(t.position.cum_funding_rate_short),asksQuantity:r.Casting.IFixed.iFixedFromStringBytes(t.position.asks_quantity),bidsQuantity:r.Casting.IFixed.iFixedFromStringBytes(t.position.bids_quantity),marketId:r.Helpers.addLeadingZeroesToType(i),pendingOrders:[...Object.entries(t.pending_orders.bids).map((([e,t])=>({size:BigInt(t),orderId:BigInt(e),side:n.PerpetualsOrderSide.Bid}))),...Object.entries(t.pending_orders.asks).map((([e,t])=>({size:BigInt(t),orderId:BigInt(e),side:n.PerpetualsOrderSide.Ask})))],makerFee:r.Casting.IFixed.iFixedFromStringBytes(t.position.maker_fee),takerFee:r.Casting.IFixed.iFixedFromStringBytes(t.position.taker_fee)}},c.accountObjectFromIndexerResponse=(e,t)=>({positions:e.map((([e,s,n])=>i.positionFromIndexerReponse({position:s,collateralCoinType:t,leverage:r.Casting.IFixed.numberFromIFixed(r.Casting.IFixed.iFixedFromStringBytes(n))||1,marketId:r.Casting.addressFromStringBytes(e)})))}),c.marketParamsFromIndexerResponse=(e,t)=>({baseAssetSymbol:t,basePriceFeedId:r.Casting.addressFromStringBytes(e.base_pfs_id),collateralPriceFeedId:r.Casting.addressFromStringBytes(e.collateral_pfs_id),marginRatioInitial:r.Casting.IFixed.iFixedFromStringBytes(e.margin_ratio_initial),marginRatioMaintenance:r.Casting.IFixed.iFixedFromStringBytes(e.margin_ratio_maintenance),fundingFrequencyMs:BigInt(e.funding_frequency_ms),fundingPeriodMs:BigInt(e.funding_period_ms),premiumTwapFrequencyMs:BigInt(e.premium_twap_frequency_ms),premiumTwapPeriodMs:BigInt(e.premium_twap_period_ms),spreadTwapFrequencyMs:BigInt(e.spread_twap_frequency_ms),spreadTwapPeriodMs:BigInt(e.spread_twap_period_ms),makerFee:r.Casting.IFixed.iFixedFromStringBytes(e.maker_fee),takerFee:r.Casting.IFixed.iFixedFromStringBytes(e.taker_fee),liquidationFee:r.Casting.IFixed.iFixedFromStringBytes(e.liquidation_fee),forceCancelFee:r.Casting.IFixed.iFixedFromStringBytes(e.force_cancel_fee),insuranceFundFee:r.Casting.IFixed.iFixedFromStringBytes(e.insurance_fund_fee),lotSize:BigInt(e.lot_size),tickSize:BigInt(e.tick_size),liquidationTolerance:BigInt(e.liquidation_tolerance),maxPendingOrders:BigInt(e.max_pending_orders),minOrderUsdValue:r.Casting.IFixed.iFixedFromStringBytes(e.min_order_usd_value),oracleTolerance:BigInt(e.oracle_tolerance)}),c.marketStateFromIndexerResponse=e=>({cumFundingRateLong:r.Casting.IFixed.iFixedFromStringBytes(e.cum_funding_rate_long),cumFundingRateShort:r.Casting.IFixed.iFixedFromStringBytes(e.cum_funding_rate_short),fundingLastUpdateMs:Number(e.funding_last_upd_ms),premiumTwap:r.Casting.IFixed.iFixedFromStringBytes(e.premium_twap),premiumTwapLastUpdateMs:Number(e.premium_twap_last_upd_ms),spreadTwap:r.Casting.IFixed.iFixedFromStringBytes(e.spread_twap),spreadTwapLastUpdateMs:Number(e.spread_twap_last_upd_ms),openInterest:r.Casting.IFixed.iFixedFromStringBytes(e.open_interest),feesAccrued:r.Casting.IFixed.iFixedFromStringBytes(e.fees_accrued)}),c.orderbookPriceFromBytes=e=>{const t=d.bcs.option(d.bcs.u256()).parse(new Uint8Array(e));return o.FixedUtils.directCast(null!=t?BigInt(t):BigInt(0))},c.orderInfoFromRaw=e=>({price:BigInt(e.price),size:BigInt(e.size)}),c.UpdatedMarketVersionEventFromOnChain=e=>{const t=e.parsedJson;return{marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),version:BigInt(t.version),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.withdrewCollateralEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),collateralDelta:BigInt(t.collateral),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.depositedCollateralEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),collateralDelta:BigInt(t.collateral),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.settledFundingEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),collateralDeltaUsd:BigInt(t.collateral_change_usd),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),marketFundingRateLong:BigInt(t.mkt_funding_rate_long),marketFundingRateShort:BigInt(t.mkt_funding_rate_short),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.allocatedCollateralEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),collateralDelta:BigInt(t.collateral),positionCollateralAfter:BigInt(t.position_collateral_after),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.deallocatedCollateralEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),collateralDelta:BigInt(t.collateral),positionCollateralAfter:BigInt(t.position_collateral_after),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.liquidatedEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.liqee_account_id),collateralDeltaUsd:BigInt(t.liqee_collateral_change_usd),liqorAccountId:BigInt(t.liqor_account_id),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),markPrice:BigInt(t.mark_price),size:BigInt(t.size_liquidated),side:t.is_liqee_long?n.PerpetualsOrderSide.Bid:n.PerpetualsOrderSide.Ask,timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.createdAccountEventFromOnChain=e=>{const t=e.parsedJson;return{user:r.Helpers.addLeadingZeroesToType(t.user),accountId:BigInt(t.account_id),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.canceledOrderEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),side:a.Perpetuals.orderIdToSide(BigInt(t.order_id)),size:BigInt(t.size),orderId:BigInt(t.order_id),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.postedOrderEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),side:BigInt(t.posted_base_ask)>BigInt(t.posted_base_bid)?n.PerpetualsOrderSide.Ask:n.PerpetualsOrderSide.Bid,size:BigInt(t.posted_base_ask+t.posted_base_bid),asksQuantity:BigInt(t.pending_asks),bidsQuantity:BigInt(t.pending_bids),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.filledMakerOrderEventFromOnChain=e=>{const t=e.parsedJson;return{baseAssetAmount:BigInt(t.maker_base_amount),accountId:BigInt(t.maker_account_id),collateralDeltaUsd:BigInt(t.collateral_change_usd),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),orderId:BigInt(t.order_id),side:a.Perpetuals.orderIdToSide(BigInt(t.order_id)),size:BigInt(t.maker_size),dropped:BigInt(t.maker_final_size)===BigInt(0),quoteAssetNotionalAmount:BigInt(t.maker_quote_amount),asksQuantity:BigInt(t.maker_pending_asks_quantity),bidsQuantity:BigInt(t.maker_pending_bids_quantity),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.filledTakerOrderEventFromOnChain=e=>{const t=e.parsedJson,s=r.Casting.IFixed.iFixedFromNumber(r.Casting.IFixed.numberFromIFixed(BigInt(t.base_asset_delta_bid))-r.Casting.IFixed.numberFromIFixed(BigInt(t.base_asset_delta_ask)));return{baseAssetDelta:s,accountId:BigInt(t.taker_account_id),collateralDeltaUsd:BigInt(t.collateral_change_usd),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),baseAssetAmount:BigInt(t.taker_base_amount),quoteAssetNotionalAmount:BigInt(t.taker_quote_amount),side:a.Perpetuals.positionSide({baseAssetAmount:s}),quoteAssetDelta:r.Casting.IFixed.iFixedFromNumber(r.Casting.IFixed.numberFromIFixed(BigInt(t.quote_asset_delta_bid))-r.Casting.IFixed.numberFromIFixed(BigInt(t.quote_asset_delta_ask))),liquidatedVolume:BigInt(t.liquidated_volume),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.postedOrderReceiptEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),size:BigInt(t.order_size),orderId:BigInt(t.order_id),side:a.Perpetuals.orderIdToSide(BigInt(t.order_id)),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.reducedOrderEventFromOnChain=e=>{const t=e.parsedJson;return{accountId:BigInt(t.account_id),marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),sizeChange:BigInt(t.size_change),orderId:BigInt(t.order_id),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.updatedPremiumTwapEventFromOnChain=e=>{const t=e.parsedJson;return{marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),indexPrice:BigInt(t.index_price),bookPrice:BigInt(t.book_price),premiumTwap:BigInt(t.premium_twap),premiumTwapLastUpdateMs:Number(t.premium_twap_last_upd_ms),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.updatedSpreadTwapEventFromOnChain=e=>{const t=e.parsedJson;return{marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),bookPrice:BigInt(t.book_price),indexPrice:BigInt(t.index_price),spreadTwap:BigInt(t.spread_twap),spreadTwapLastUpdateMs:Number(t.spread_twap_last_upd_ms),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},c.updatedFundingEventFromOnChain=e=>{const t=e.parsedJson;return{marketId:r.Helpers.addLeadingZeroesToType(t.ch_id),cumFundingRateLong:BigInt(t.cum_funding_rate_long),cumFundingRateShort:BigInt(t.cum_funding_rate_short),fundingLastUpdateMs:Number(t.funding_last_upd_ms),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},654921:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(431046),t),n(s(360424),t),n(s(220891),t)},431046:function(e,t,s){var i,n=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Perpetuals=void 0;const r=s(601151),a=s(617237),o=s(220891),d=s(360424),c=s(930492),l=s(845963),u=s(243333),p=s(623008);class h extends r.Caller{constructor(e){super(e,"perpetuals")}getAllMarkets(e){return n(this,void 0,void 0,(function*(){const{collateralCoinType:t}=e;return(yield this.fetchApi(`${t}/markets`)).map((e=>new o.PerpetualsMarket(e,this.config)))}))}getMarket(e){return n(this,void 0,void 0,(function*(){const t=yield this.fetchApi(`${e.collateralCoinType}/markets/${e.marketId}`);return new o.PerpetualsMarket(t,this.config)}))}getMarkets(e){return n(this,void 0,void 0,(function*(){const{collateralCoinType:t}=e;return Promise.all(e.marketIds.map((e=>this.getMarket({marketId:e,collateralCoinType:t}))))}))}getAccount(e){return n(this,void 0,void 0,(function*(){const{accountCap:t}=e,s=yield this.fetchApi(`${t.collateralCoinType}/accounts/${t.accountId}`);return new d.PerpetualsAccount(s,t,this.config)}))}getUserAccountCaps(e){return n(this,void 0,void 0,(function*(){const{collateralCoinType:t,walletAddress:s}=e;return this.fetchApi(`${t}/accounts`,{walletAddress:s})}))}getMarketHistoricalData(e){const{collateralCoinType:t,marketId:s,fromTimestamp:i,toTimestamp:n,intervalMs:r}=e;return this.fetchApi(`${t}/markets/${s}/historical-data/${i}/${n}/${r}`)}getCreateAccountTx(e){return n(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/create-account",e)}))}static positionSide(e){const t=c.IFixedUtils.numberFromIFixed(e.baseAssetAmount);return Math.sign(t)>=0?a.PerpetualsOrderSide.Bid:a.PerpetualsOrderSide.Ask}static orderPrice(e){const{orderEvent:t}=e;return c.IFixedUtils.numberFromIFixed(t.quoteAssetDelta)/c.IFixedUtils.numberFromIFixed(t.baseAssetDelta)}static lotOrTickSizeToNumber(e){return Number(e)/l.FixedUtils.fixedOneN9}static lotOrTickSizeToBigInt(e){return BigInt(Math.round(e*l.FixedUtils.fixedOneN9))}static calcEntryPrice(e){const{baseAssetAmount:t,quoteAssetNotionalAmount:s}=e,i=u.Casting.IFixed.numberFromIFixed(t);return i?Math.abs(u.Casting.IFixed.numberFromIFixed(s)/i):0}}t.Perpetuals=h,i=h,h.OrderUtils=p.PerpetualsOrderUtils,h.priceToOrderPrice=e=>{const{price:t,lotSize:s,tickSize:n}=e,r=l.FixedUtils.directUncast(t)/l.FixedUtils.fixedOneB9,a=l.FixedUtils.fixedOneB9/("number"==typeof s?i.lotOrTickSizeToBigInt(s):s);return a<=BigInt(0)?BigInt(0):r/("number"==typeof n?i.lotOrTickSizeToBigInt(n):n)/a},h.orderPriceToPrice=e=>{const{orderPrice:t,lotSize:s,tickSize:n}=e,r=l.FixedUtils.fixedOneB9/("number"==typeof s?i.lotOrTickSizeToBigInt(s):s);return l.FixedUtils.directCast(t*("number"==typeof n?i.lotOrTickSizeToBigInt(n):n)*r*l.FixedUtils.fixedOneB9)},h.orderIdToSide=e=>i.OrderUtils.isAsk(e)?a.PerpetualsOrderSide.Ask:a.PerpetualsOrderSide.Bid},360424:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.PerpetualsAccount=void 0;const r=s(601151),a=s(617237),o=s(930492),d=s(243333),c=s(431046),l=s(646074);class u extends r.Caller{constructor(e,t,s){super(s,"perpetuals"),this.account=e,this.accountCap=t,this.calcFreeCollateralForPosition=e=>{var t,s;const i=e.market.marketId,n=null!==(s=null!==(t=e.position)&&void 0!==t?t:this.positionForMarketId({marketId:i}))&&void 0!==s?s:this.emptyPosition({market:e.market}),r=this.calcUnrealizedFundingsForPosition(e),{pnl:a,minInitialMargin:d}=this.calcPnLAndMarginForPosition(e);let c,l=o.IFixedUtils.numberFromIFixed(n.collateral)*e.collateralPrice;return l+=r,c=a<0?l+a:l,c>=d?(c-d)/e.collateralPrice:0},this.calcMarginRatioAndLeverageForPosition=e=>{var t,s;const{market:i,indexPrice:n,collateralPrice:r}=e,a=i.marketId,d=null!==(s=null!==(t=e.position)&&void 0!==t?t:this.positionForMarketId({marketId:a}))&&void 0!==s?s:this.emptyPosition({market:i}),c=this.calcUnrealizedFundingsForPosition({market:i,position:d}),l=o.IFixedUtils.numberFromIFixed(null==d?void 0:d.collateral)*r+c,{pnl:u,netAbsBaseValue:p}=this.calcPnLAndMarginForPosition({market:i,indexPrice:n,position:d}),h=0===p?0:(l+u)/p;return{marginRatio:h,leverage:0===h?0:1/h}},this.calcUnrealizedFundings=e=>{let t=0;return e.markets.forEach((e=>{t+=this.calcUnrealizedFundingsForPosition({market:e})})),t},this.calcUnrealizedFundingsForPosition=e=>{var t,s;const i=e.market.marketId,n=null!==(s=null!==(t=e.position)&&void 0!==t?t:this.positionForMarketId({marketId:i}))&&void 0!==s?s:this.emptyPosition({market:e.market}),r=o.IFixedUtils.numberFromIFixed(n.baseAssetAmount);if(Math.sign(r)<0){const t=o.IFixedUtils.numberFromIFixed(n.cumFundingRateShort);return-r*(o.IFixedUtils.numberFromIFixed(e.market.marketState.cumFundingRateShort)-t)}{const t=o.IFixedUtils.numberFromIFixed(n.cumFundingRateLong);return-r*(o.IFixedUtils.numberFromIFixed(e.market.marketState.cumFundingRateLong)-t)}},this.calcPnLAndMarginForPosition=e=>{var t,s;const i=e.market.marketId,n=null!==(s=null!==(t=e.position)&&void 0!==t?t:this.positionForMarketId({marketId:i}))&&void 0!==s?s:this.emptyPosition({market:e.market}),r=1/n.leverage,a=o.IFixedUtils.numberFromIFixed(e.market.marketParams.marginRatioMaintenance),d=o.IFixedUtils.numberFromIFixed(n.baseAssetAmount),c=o.IFixedUtils.numberFromIFixed(n.quoteAssetNotionalAmount),l=o.IFixedUtils.numberFromIFixed(n.bidsQuantity),u=o.IFixedUtils.numberFromIFixed(n.asksQuantity),p=d*e.indexPrice-c,h=Math.max(Math.abs(d+l),Math.abs(d-u))*e.indexPrice;return{pnl:p,minInitialMargin:h*r,minMaintenanceMargin:h*a,netAbsBaseValue:h}},this.calcLiquidationPriceForPosition=e=>{var t,s;const i=e.market.marketId,n=null!==(s=null!==(t=e.position)&&void 0!==t?t:this.positionForMarketId({marketId:i}))&&void 0!==s?s:this.emptyPosition({market:e.market}),r=this.calcUnrealizedFundingsForPosition(e),a=o.IFixedUtils.numberFromIFixed(null==n?void 0:n.collateral)*e.collateralPrice+r,d=o.IFixedUtils.numberFromIFixed(n.baseAssetAmount),c=o.IFixedUtils.numberFromIFixed(n.quoteAssetNotionalAmount),l=o.IFixedUtils.numberFromIFixed(e.market.marketParams.marginRatioMaintenance),u=a-c,p=d>0?u/((1-l)*-d):u/((1+l)*-d);return p<0?0:p},this.calcFreeMarginUsdForPosition=e=>{var t,s;const i=e.market.marketId,n=null!==(s=null!==(t=e.position)&&void 0!==t?t:this.positionForMarketId({marketId:i}))&&void 0!==s?s:this.emptyPosition({market:e.market}),r=this.calcUnrealizedFundingsForPosition(e),{pnl:a,minInitialMargin:d}=this.calcPnLAndMarginForPosition(e),c=o.IFixedUtils.numberFromIFixed(n.collateral)*e.collateralPrice+r+a;return c>=d?c-d:0},this.calcAccountState=e=>{const t=d.Helpers.zip(e.markets,e.indexPrices);let s=0,i=0,n=0,r=0;return t.forEach((([t,a])=>{var d;const c=t.marketId,l=null!==(d=this.positionForMarketId({marketId:c}))&&void 0!==d?d:this.emptyPosition({market:t}),u=this.calcUnrealizedFundingsForPosition({market:t,position:l}),{pnl:p}=this.calcPnLAndMarginForPosition({market:t,indexPrice:a,position:l});let h=o.IFixedUtils.numberFromIFixed(l.collateral)*e.collateralPrice;i+=p,n+=u,r+=h,s+=h+u+p})),{accountEquity:s,totalPnL:i,totalFunding:n,totalCollateralAllocated:r}},this.closePositionTxInputs=e=>{var t;const{size:s,market:i,walletAddress:n,orderDatas:r,collateralPrice:o}=e,p=i.marketId,h=null!==(t=this.positionForMarketId({marketId:p}))&&void 0!==t?t:this.emptyPosition({market:i}),m=l.Coin.normalizeBalance(d.Helpers.sum(r.filter((e=>e.marketId===i.marketId)).map((t=>i.calcCollateralUsedForOrder(Object.assign(Object.assign({},e),{orderData:t,leverage:h.leverage})).collateral))),this.collateralDecimals()),g=d.Helpers.maxBigInt(BigInt(Math.floor(Number(l.Coin.normalizeBalance(this.calcFreeMarginUsdForPosition(e)*o,this.collateralDecimals())-m)*(1-u.constants.closePositionMarginOfError))),BigInt(0))*BigInt(-1),v=BigInt(Math.round(Math.abs(d.Casting.IFixed.numberFromIFixed(h.baseAssetAmount)/i.lotSize())));return{size:s,marketId:p,walletAddress:n,collateralChange:BigInt(Math.round(Number(g)*(Number(s)/Number(v)))),side:c.Perpetuals.positionSide(h)===a.PerpetualsOrderSide.Bid?a.PerpetualsOrderSide.Ask:a.PerpetualsOrderSide.Bid,hasPosition:void 0!==this.positionForMarketId({marketId:p})}},this.emptyPosition=e=>{const{market:t}=e;return{marketId:t.marketId,collateralCoinType:this.accountCap.collateralCoinType,collateral:BigInt(0),baseAssetAmount:BigInt(0),quoteAssetNotionalAmount:BigInt(0),cumFundingRateLong:t.marketState.cumFundingRateLong,cumFundingRateShort:t.marketState.cumFundingRateShort,asksQuantity:BigInt(0),bidsQuantity:BigInt(0),pendingOrders:[],makerFee:BigInt(1e18),takerFee:BigInt(1e18),leverage:1}}}getDepositCollateralTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/deposit-collateral",Object.assign(Object.assign({},e),{collateralCoinType:this.accountCap.collateralCoinType,accountCapId:this.accountCap.objectId}))}))}getWithdrawCollateralTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/withdraw-collateral",Object.assign(Object.assign({},e),{collateralCoinType:this.accountCap.collateralCoinType,accountCapId:this.accountCap.objectId}))}))}getAllocateCollateralTx(e){return i(this,void 0,void 0,(function*(){const{market:t}=e;return this.fetchApiTransaction("transactions/allocate-collateral",Object.assign(Object.assign({},e),{packageId:t.marketData.packageId,marketInitialSharedVersion:t.marketData.initialSharedVersion,marketId:t.marketId,collateralCoinType:this.accountCap.collateralCoinType,accountCapId:this.accountCap.objectId}))}))}getDeallocateCollateralTx(e){return i(this,void 0,void 0,(function*(){const{market:t}=e;return this.fetchApiTransaction("transactions/deallocate-collateral",Object.assign(Object.assign({},e),{packageId:t.marketData.packageId,marketInitialSharedVersion:t.marketData.initialSharedVersion,marketId:t.marketId,basePriceFeedId:t.marketParams.basePriceFeedId,collateralPriceFeedId:t.marketParams.collateralPriceFeedId,collateralCoinType:this.accountCap.collateralCoinType,accountCapId:this.accountCap.objectId}))}))}getTransferCollateralTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/transfer-collateral",Object.assign(Object.assign({},e),{collateralCoinType:this.accountCap.collateralCoinType,fromAccountCapId:this.accountCap.objectId}))}))}getPlaceMarketOrderTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/market-order",Object.assign(Object.assign({},e),{accountObjectId:this.accountCap.objectId,accountObjectVersion:this.accountCap.objectVersion,accountObjectDigest:this.accountCap.objectDigest,hasPosition:void 0!==this.positionForMarketId(e)}))}))}getPlaceLimitOrderTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/limit-order",Object.assign(Object.assign({},e),{accountObjectId:this.accountCap.objectId,accountObjectVersion:this.accountCap.objectVersion,accountObjectDigest:this.accountCap.objectDigest,hasPosition:void 0!==this.positionForMarketId(e)}))}))}getPlaceSLTPOrder(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/sltp-order",Object.assign(Object.assign({},e),{accountObjectId:this.accountCap.objectId,accountObjectVersion:this.accountCap.objectVersion,accountObjectDigest:this.accountCap.objectDigest}))}))}getCancelOrderTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/cancel-order",Object.assign(Object.assign({},e),{collateralCoinType:this.accountCap.collateralCoinType,accountCapId:this.accountCap.objectId}))}))}getCancelOrdersTx(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/cancel-orders",Object.assign(Object.assign({},e),{collateralCoinType:this.accountCap.collateralCoinType,accountCapId:this.accountCap.objectId}))}))}getReduceOrdersTx(e){return i(this,void 0,void 0,(function*(){const{market:t,orderDatas:s}=e;return this.fetchApiTransaction("transactions/reduce-orders",Object.assign(Object.assign({},e),{orderIds:s.map((e=>e.orderId)),sizesToSubtract:s.map((e=>e.sizeToSubtract)),packageId:t.marketData.packageId,marketInitialSharedVersion:t.marketData.initialSharedVersion,marketId:t.marketId,basePriceFeedId:t.marketParams.basePriceFeedId,collateralPriceFeedId:t.marketParams.collateralPriceFeedId,collateralCoinType:this.accountCap.collateralCoinType,accountCapId:this.accountCap.objectId}))}))}getClosePositionTx(e){return i(this,void 0,void 0,(function*(){return this.getPlaceMarketOrderTx(this.closePositionTxInputs(e))}))}setPositionLeverage(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`${this.accountCap.collateralCoinType}/accounts/${this.accountCap.accountId}/set-position-leverage`,e)}))}getPositionLeverages(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`${this.accountCap.collateralCoinType}/accounts/${this.accountCap.accountId}/position-leverages/${JSON.stringify(e.marketIds)}`)}))}setPositionLeverageMessageToSign(e){return{account_id:Number(this.accountCap.accountId),market_id:e.marketId,leverage:e.leverage}}getOrderPreview(e,t){return i(this,void 0,void 0,(function*(){const s=yield this.fetchApi("preview-order",Object.assign(Object.assign({},e),{accountId:this.accountCap.accountId,collateralCoinType:this.accountCap.collateralCoinType}),t);if("error"in s)return s;const{collateralChange:i}=s,r=n(s,["collateralChange"]);return Object.assign(Object.assign({},r),{collateralChange:l.Coin.normalizeBalance(i,this.collateralDecimals())})}))}getCancelOrdersPreview(e){return i(this,void 0,void 0,(function*(){if(Object.keys(e.marketIdsToData).length<=0)return{collateralChange:BigInt(0),marketIdsToPositionAfterCancelOrders:{}};const t=yield this.fetchApi("preview-cancel-orders",Object.assign(Object.assign({},e),{accountId:this.accountCap.accountId,collateralCoinType:this.accountCap.collateralCoinType}));return"error"in t?t:{marketIdsToPositionAfterCancelOrders:t.marketIdsToPositionAfterCancelOrders,collateralChange:l.Coin.normalizeBalance(t.collateralChange,this.collateralDecimals())}}))}getReduceOrdersPreview(e){return i(this,void 0,void 0,(function*(){if(Object.keys(e.orderDatas).length<=0)throw new Error("no orderDatas provided");const t=yield this.fetchApi("preview-reduce-orders",Object.assign(Object.assign({},e),{orderIds:e.orderDatas.map((e=>e.orderId)),sizesToSubtract:e.orderDatas.map((e=>e.sizeToSubtract)),accountId:this.accountCap.accountId,collateralCoinType:this.accountCap.collateralCoinType}));return"error"in t?t:{positionAfterReduceOrders:t.positionAfterReduceOrders,collateralChange:l.Coin.normalizeBalance(t.collateralChange,this.collateralDecimals())}}))}getOrderDatas(){return i(this,void 0,void 0,(function*(){const e=this.account.positions.reduce(((e,t)=>[...e,...t.pendingOrders.map((e=>({orderId:e.orderId,currentSize:e.size})))]),[]);return e.length<=0?[]:this.fetchApi(`${this.accountCap.collateralCoinType}/accounts/${this.accountCap.accountId}/order-datas`,{orderDatas:e})}))}getCollateralHistory(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`${this.accountCap.collateralCoinType}/accounts/${this.accountCap.accountId}/collateral-history`,e)}))}getOrderHistory(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`${this.accountCap.collateralCoinType}/accounts/${this.accountCap.accountId}/order-history`,e)}))}positionForMarketId(e){try{return this.account.positions.find((t=>t.marketId===e.marketId))}catch(e){return}}collateral(){return d.Casting.IFixed.numberFromIFixed(this.accountCap.collateral)}collateralDecimals(){return this.accountCap.collateralDecimals}collateralBalance(){return l.Coin.normalizeBalance(this.collateral(),this.collateralDecimals())}}t.PerpetualsAccount=u,u.constants={closePositionMarginOfError:.1}},220891:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PerpetualsMarket=void 0;const n=s(838609),r=s(601151),a=s(930492),o=s(431046),d=s(623008);class c extends r.Caller{constructor(e,t){super(t,`perpetuals/${e.collateralCoinType}/markets/${e.objectId}`),this.marketData=e,this.getMaxOrderSizeUsd=e=>i(this,void 0,void 0,(function*(){const{side:t,price:s,account:i,indexPrice:n,leverage:r}=e,a=yield this.fetchApi("max-order-size",{accountId:i.accountCap.accountId,collateral:i.collateralBalance(),side:t,price:s,leverage:r});return Number(a)*this.lotSize()*n})),this.timeUntilNextFundingMs=()=>this.nextFundingTimeMs()-Date.now(),this.nextFundingTimeMs=()=>{const e=Number(this.marketParams.fundingFrequencyMs);return(Math.floor(this.marketState.fundingLastUpdateMs/e)+1)*e},this.estimatedFundingRate=e=>{const{indexPrice:t}=e;return a.IFixedUtils.numberFromIFixed(this.marketState.premiumTwap)/t*(Number(this.marketParams.fundingFrequencyMs)/Number(this.marketParams.fundingPeriodMs))},this.priceToOrderPrice=e=>{const{price:t}=e,s=this.marketParams.lotSize,i=this.marketParams.tickSize;return o.Perpetuals.priceToOrderPrice({price:t,lotSize:s,tickSize:i})},this.orderPriceToPrice=e=>{const{orderPrice:t}=e,s=this.marketParams.lotSize,i=this.marketParams.tickSize;return o.Perpetuals.orderPriceToPrice({orderPrice:t,lotSize:s,tickSize:i})},this.calcCollateralUsedForOrder=e=>{const{leverage:t,orderData:s,indexPrice:i,collateralPrice:n}=e,r=1/t,a=Number(s.initialSize-s.filledSize)*this.lotSize()*i*r;return{collateralUsd:a,collateral:a/n}},this.roundToValidPrice=e=>Math.round(e.price/this.tickSize())*this.tickSize(),this.roundToValidSize=e=>{const t=e.size/this.lotSize();return(e.floor?Math.floor(t):e.ceil?Math.ceil(t):Math.round(t))*this.lotSize()},this.marketId=e.objectId,this.collateralCoinType=e.collateralCoinType,this.marketParams=e.marketParams,this.marketState=e.marketState}getOrderbookPrice(){return this.fetchApi("orderbook-price")}get24hrVolume(){return this.fetchApi("24hr-volume")}getPrice24hrsAgo(){return this.fetchApi("price-24hrs-ago")}getOrderbook(){return this.fetchApi("orderbook")}getTradeHistory(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("trade-history",e)}))}lotSize(){return o.Perpetuals.lotOrTickSizeToNumber(this.marketParams.lotSize)}tickSize(){return o.Perpetuals.lotOrTickSizeToNumber(this.marketParams.tickSize)}maxLeverage(){return 1/n.Casting.IFixed.numberFromIFixed(this.marketParams.marginRatioInitial)}initialMarginRatio(){return n.Casting.IFixed.numberFromIFixed(this.marketParams.marginRatioInitial)}maintenanceMarginRatio(){return n.Casting.IFixed.numberFromIFixed(this.marketParams.marginRatioMaintenance)}orderPrice(e){const{orderId:t}=e,s=d.PerpetualsOrderUtils.price(t);return this.orderPriceToPrice({orderPrice:s})}}t.PerpetualsMarket=c},358888:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.perpetualsRegistry=t.isUpdatedFundingEvent=t.isUpdatedSpreadTwapEvent=t.isUpdatedPremiumTwapEvent=t.isReducedOrderEvent=t.isFilledTakerOrderEvent=t.isFilledMakerOrderEvent=t.isPostedOrderReceiptEvent=t.isPostedOrderEvent=t.isCanceledOrderEvent=t.isLiquidatedEvent=t.isSettledFundingEvent=t.isAllocatedCollateralEvent=t.isDeallocatedCollateralEvent=t.isDepositedCollateralEvent=t.isWithdrewCollateralEvent=t.isUpdatedMarketVersion=t.PerpetualsOrderType=t.PerpetualsOrderSide=void 0;const i=s(941882);var n,r;!function(e){e[e.Ask=1]="Ask",e[e.Bid=0]="Bid"}(n||(t.PerpetualsOrderSide=n={})),function(e){e[e.Standard=0]="Standard",e[e.FillOrKill=1]="FillOrKill",e[e.PostOnly=2]="PostOnly",e[e.ImmediateOrCancel=3]="ImmediateOrCancel"}(r||(t.PerpetualsOrderType=r={}));const a=i.bcs.struct("AdminCapability",{id:i.bcs.Address}),o=i.bcs.struct("Registry",{id:i.bcs.Address,activeCollaterals:i.bcs.vector(i.bcs.string()),nextAccountId:i.bcs.u64()}),d=i.bcs.struct("MarketKey",{marketId:i.bcs.u64()}),c=i.bcs.struct("Balance",{value:i.bcs.u64()}),l=i.bcs.struct("Coin",{id:i.bcs.Address,balance:c}),u=i.bcs.struct("Vault",{id:i.bcs.Address,collateral_balance:c,insurance_fund_balance:c,scalingFactor:i.bcs.u64()}),p=i.bcs.struct("Account",{id:i.bcs.Address,accountId:i.bcs.u64(),collateral:c}),h=i.bcs.struct("Position",{collateral:i.bcs.u256(),baseAssetAmount:i.bcs.u256(),quoteAssetNotionalAmount:i.bcs.u256(),cumFundingRateLong:i.bcs.u256(),cumFundingRateShort:i.bcs.u256(),asksQuantity:i.bcs.u256(),bidsQuantity:i.bcs.u256(),pendingOrders:i.bcs.u64(),makerFee:i.bcs.u256(),takerFee:i.bcs.u256()}),m=i.bcs.struct("PositionKey",{accountId:i.bcs.u64()}),g=i.bcs.struct("OrderInfo",{price:i.bcs.u64(),size:i.bcs.u64()});t.isUpdatedMarketVersion=e=>e.type.toLowerCase().endsWith("::updatedclearinghouseversion"),t.isWithdrewCollateralEvent=e=>e.type.toLowerCase().endsWith("::withdrewcollateral"),t.isDepositedCollateralEvent=e=>e.type.toLowerCase().endsWith("::depositedcollateral"),t.isDeallocatedCollateralEvent=e=>e.type.toLowerCase().endsWith("::deallocatedcollateral"),t.isAllocatedCollateralEvent=e=>e.type.toLowerCase().endsWith("::allocatedcollateral"),t.isSettledFundingEvent=e=>e.type.toLowerCase().endsWith("::settledfunding"),t.isLiquidatedEvent=e=>e.type.toLowerCase().endsWith("::liquidatedposition"),t.isCanceledOrderEvent=e=>e.type.toLowerCase().endsWith("::canceledorder"),t.isPostedOrderEvent=e=>e.type.toLowerCase().endsWith("::postedorder"),t.isPostedOrderReceiptEvent=e=>e.type.toLowerCase().endsWith("::orderbookpostreceipt"),t.isFilledMakerOrderEvent=e=>e.type.toLowerCase().endsWith("::filledmakerorder"),t.isFilledTakerOrderEvent=e=>e.type.toLowerCase().endsWith("::filledtakerorder"),t.isReducedOrderEvent=e=>e.type.toLowerCase().endsWith("::reducedorder"),t.isUpdatedPremiumTwapEvent=e=>e.type.toLowerCase().endsWith("::updatedpremiumtwap"),t.isUpdatedSpreadTwapEvent=e=>e.type.toLowerCase().endsWith("::updatedspreadtwap"),t.isUpdatedFundingEvent=e=>e.type.toLowerCase().endsWith("::updatedfunding"),t.perpetualsRegistry={Account:p,AdminCapability:a,BalanceStruct:c,Coin:l,Field:function(e,t){return i.bcs.struct("Field",{name:e,value:t})},MarketKey:d,OrderInfo:g,Position:h,PositionKey:m,Registry:o,Vault:u}},623008:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(839069),t)},839069:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.PerpetualsOrderUtils=void 0;const n=s(654921),r=s(617237),a=s(162197);class o{}t.PerpetualsOrderUtils=o,i=o,o.orderId=(e,t,s)=>Boolean(s)?i.orderIdAsk(e,t):i.orderIdBid(e,t),o.orderIdAsk=(e,t)=>{let s=new a(e,10),i=new a(t,10);return BigInt(s.shln(64).or(i).toString())},o.orderIdBid=(e,t)=>{let s=new a(e,10),i=new a(t,10),n=new a("ffffffffffffffff",16);return BigInt(s.xor(n).shln(64).or(i).toString())},o.price=e=>n.Perpetuals.orderIdToSide(e)===r.PerpetualsOrderSide.Ask?i.priceAsk(e):i.priceBid(e),o.priceAsk=e=>{let t=new a(e,10);return BigInt(t.shrn(64).toString())},o.priceBid=e=>{let t=new a(e,10),s=new a("ffffffffffffffff",16);return BigInt(t.shrn(64).xor(s).toString())},o.counter=e=>{let t=new a(e,10),s=new a("0000000000000000ffffffffffffffff",16);return BigInt(t.and(s).toString())},o.isAsk=e=>new a(e,10).lt(new a("80000000000000000000000000000000",16))},65055:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PoolsApi=void 0;const n=s(108979),r=s(404151),a=s(242885),o=s(593460),d=s(243333),c=s(302416),l=s(578230),u=s(941882);class p{constructor(e){this.Provider=e,this.fetchOwnedDaoFeePoolOwnerCaps=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e;if(!this.objectTypes.daoFeePoolOwnerCap)throw new Error("dao fee pool addresses have not been set in provider");return this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.daoFeePoolOwnerCap,objectFromSuiObjectResponse:a.Casting.pools.daoFeePoolOwnerCapObjectFromSuiObjectResponse})})),this.tradeTx=e=>{const{tx:t,poolId:s,coinInId:i,coinInType:n,expectedCoinOutAmount:r,coinOutType:a,lpCoinType:c,slippage:l,withTransfer:u}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(u?this.addresses.pools.packages.ammInterface:this.addresses.pools.packages.amm,u?p.constants.moduleNames.interface:p.constants.moduleNames.swap,"swap_exact_in"),typeArguments:[c,n,a],arguments:[t.object(s),t.object(this.addresses.pools.objects.poolRegistry),t.object(this.addresses.pools.objects.protocolFeeVault),t.object(this.addresses.pools.objects.treasury),t.object(this.addresses.pools.objects.insuranceFund),t.object(this.addresses.referralVault.objects.referralVault),"string"==typeof i?t.object(i):i,t.pure.u64(r.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(l))]})},this.multiCoinDepositTx=e=>{const{tx:t,poolId:s,coinIds:i,coinTypes:n,expectedLpRatio:r,lpCoinType:a,slippage:c,withTransfer:l}=e,u=n.length;return t.moveCall({target:d.Helpers.transactions.createTxTarget(l?this.addresses.pools.packages.ammInterface:this.addresses.pools.packages.amm,l?p.constants.moduleNames.interface:p.constants.moduleNames.deposit,`deposit_${u}_coins`),typeArguments:[a,...n],arguments:[t.object(s),t.object(this.addresses.pools.objects.poolRegistry),t.object(this.addresses.pools.objects.protocolFeeVault),t.object(this.addresses.pools.objects.treasury),t.object(this.addresses.pools.objects.insuranceFund),t.object(this.addresses.referralVault.objects.referralVault),...i.map((e=>"string"==typeof e?t.object(e):e)),t.pure.u128(r.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(c))]})},this.multiCoinWithdrawTx=e=>{const{tx:t,poolId:s,lpCoinId:i,expectedAmountsOut:n,coinTypes:r,lpCoinType:a,slippage:c,withTransfer:l}=e,h=r.length;return t.moveCall({target:d.Helpers.transactions.createTxTarget(l?this.addresses.pools.packages.ammInterface:this.addresses.pools.packages.amm,l?p.constants.moduleNames.interface:p.constants.moduleNames.withdraw,`withdraw_${h}_coins`),typeArguments:[a,...r],arguments:[t.object(s),t.object(this.addresses.pools.objects.poolRegistry),t.object(this.addresses.pools.objects.protocolFeeVault),t.object(this.addresses.pools.objects.treasury),t.object(this.addresses.pools.objects.insuranceFund),t.object(this.addresses.referralVault.objects.referralVault),"string"==typeof i?t.object(i):i,t.pure(u.bcs.vector(u.bcs.u64()).serialize(n.map((e=>e.toString())))),t.pure.u64(o.Pools.normalizeInvertSlippage(c))]})},this.allCoinWithdrawTx=e=>{const{tx:t,poolId:s,lpCoinId:i,coinTypes:n,lpCoinType:r,withTransfer:a}=e,o=n.length;return t.moveCall({target:d.Helpers.transactions.createTxTarget(a?this.addresses.pools.packages.ammInterface:this.addresses.pools.packages.amm,a?p.constants.moduleNames.interface:p.constants.moduleNames.withdraw,`all_coin_withdraw_${o}_coins`),typeArguments:[r,...n],arguments:[t.object(s),t.object(this.addresses.pools.objects.poolRegistry),t.object(this.addresses.pools.objects.protocolFeeVault),t.object(this.addresses.pools.objects.treasury),t.object(this.addresses.pools.objects.insuranceFund),t.object(this.addresses.referralVault.objects.referralVault),"string"==typeof i?t.object(i):i]})},this.publishLpCoinTx=e=>{var t;const s=null===(t=this.addresses.pools.other)||void 0===t?void 0:t.createLpCoinPackageCompilations;if(!s)throw new Error("not all required addresses have been set in provider for lp coin publishing (requires package compilations)");const{tx:i,lpCoinDecimals:n}=e,a=JSON.parse(s[n]);return i.publish({modules:a.modules.map((e=>Array.from((0,r.fromB64)(e)))),dependencies:a.dependencies.map((e=>(0,r.normalizeSuiObjectId)(e)))})},this.createPoolTx=e=>{const{tx:t,lpCoinType:s,createPoolCapId:i,coinsInfo:n,lpCoinMetadata:r,lpCoinDescription:o,lpCoinIconUrl:c,withTransfer:l}=e,h=n.length,m=n.map((e=>e.coinType)),g=n.map((e=>e.decimals));return t.moveCall({target:d.Helpers.transactions.createTxTarget(l?this.addresses.pools.packages.ammInterface:this.addresses.pools.packages.amm,l?p.constants.moduleNames.interface:p.constants.moduleNames.poolFactory,`create_pool_${h}_coins`),typeArguments:[s,...m],arguments:["string"==typeof i?t.object(i):i,t.object(this.addresses.pools.objects.poolRegistry),t.pure(u.bcs.vector(u.bcs.u8()).serialize(a.Casting.u8VectorFromString(e.poolName))),t.pure(u.bcs.vector(u.bcs.u8()).serialize(a.Casting.u8VectorFromString(r.name.toString()))),t.pure(u.bcs.vector(u.bcs.u8()).serialize(a.Casting.u8VectorFromString(r.symbol.toString().toUpperCase()))),t.pure(u.bcs.vector(u.bcs.u8()).serialize(a.Casting.u8VectorFromString(o))),t.pure(u.bcs.vector(u.bcs.u8()).serialize(a.Casting.u8VectorFromString(c))),t.pure(u.bcs.vector(u.bcs.u64()).serialize(n.map((e=>e.weight)))),t.pure.u64(e.poolFlatness),t.pure(u.bcs.vector(u.bcs.u64()).serialize(n.map((e=>e.tradeFeeIn)))),t.pure(u.bcs.vector(u.bcs.u64()).serialize(n.map((e=>e.tradeFeeOut)))),t.pure(u.bcs.vector(u.bcs.u64()).serialize(n.map((e=>e.depositFee)))),t.pure(u.bcs.vector(u.bcs.u64()).serialize(n.map((e=>e.withdrawFee)))),...n.map((e=>"string"==typeof e.coinId?t.object(e.coinId):e.coinId)),t.pure(u.bcs.option(u.bcs.vector(u.bcs.u8())).serialize(g.includes(void 0)?void 0:g)),t.pure.bool(e.respectDecimals),t.pure(u.bcs.option(u.bcs.u8()).serialize(e.forceLpDecimals))]})},this.poolObjectIdForLpCoinTypeTx=e=>{const{tx:t,lpCoinType:s}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.pools.packages.amm,p.constants.moduleNames.poolRegistry,"lp_type_to_pool_id"),typeArguments:[s],arguments:[t.object(this.addresses.pools.objects.poolRegistry)]})},this.daoFeePoolNewTx=e=>{const{tx:t,poolId:s}=e;if(!this.addresses.daoFeePools)throw new Error("dao fee pool addresses have not been set in provider");return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.daoFeePools.packages.amm,p.constants.moduleNames.pool,"new"),typeArguments:[e.lpCoinType],arguments:["string"==typeof s?t.object(s):s,t.object(this.addresses.daoFeePools.objects.version),t.pure.u16(Number(e.feeBps)),t.pure.address(e.feeRecipient)]})},this.daoFeePoolUpdateFeeBpsTx=e=>{const{tx:t}=e;if(!this.addresses.daoFeePools)throw new Error("dao fee pool addresses have not been set in provider");return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.daoFeePools.packages.amm,p.constants.moduleNames.pool,"update_fee_bps"),typeArguments:[e.lpCoinType],arguments:[t.object(e.daoFeePoolOwnerCapId),t.object(e.daoFeePoolId),t.object(this.addresses.daoFeePools.objects.version),t.pure.u16(Number(e.newFeeBps))]})},this.daoFeePoolUpdateFeeRecipientTx=e=>{const{tx:t}=e;if(!this.addresses.daoFeePools)throw new Error("dao fee pool addresses have not been set in provider");return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.daoFeePools.packages.amm,p.constants.moduleNames.pool,"update_fee_recipient"),typeArguments:[e.lpCoinType],arguments:[t.object(e.daoFeePoolOwnerCapId),t.object(e.daoFeePoolId),t.object(this.addresses.daoFeePools.objects.version),t.pure.address(e.newFeeRecipient)]})},this.daoFeePoolTradeTx=e=>{const{tx:t,daoFeePoolId:s,coinInId:i,coinInType:n,expectedCoinOutAmount:r,coinOutType:a,lpCoinType:c,slippage:l}=e;if(!this.addresses.daoFeePools)throw new Error("dao fee pool addresses have not been set in provider");return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.daoFeePools.packages.amm,p.constants.moduleNames.swap,"swap_exact_in"),typeArguments:[c,n,a],arguments:[t.object(s),t.object(this.addresses.daoFeePools.objects.version),t.object(this.addresses.pools.objects.poolRegistry),t.object(this.addresses.pools.objects.protocolFeeVault),t.object(this.addresses.pools.objects.treasury),t.object(this.addresses.pools.objects.insuranceFund),t.object(this.addresses.referralVault.objects.referralVault),"string"==typeof i?t.object(i):i,t.pure.u64(r.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(l))]})},this.daoFeePoolMultiCoinDepositTx=e=>{const{tx:t,daoFeePoolId:s,coinIds:i,coinTypes:n,expectedLpRatio:r,lpCoinType:a,slippage:c}=e;if(!this.addresses.daoFeePools)throw new Error("dao fee pool addresses have not been set in provider");const l=n.length;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.daoFeePools.packages.amm,p.constants.moduleNames.deposit,`deposit_${l}_coins`),typeArguments:[a,...n],arguments:[t.object(s),t.object(this.addresses.daoFeePools.objects.version),t.object(this.addresses.pools.objects.poolRegistry),t.object(this.addresses.pools.objects.protocolFeeVault),t.object(this.addresses.pools.objects.treasury),t.object(this.addresses.pools.objects.insuranceFund),t.object(this.addresses.referralVault.objects.referralVault),...i.map((e=>"string"==typeof e?t.object(e):e)),t.pure.u128(r.toString()),t.pure.u64(o.Pools.normalizeInvertSlippage(c))]})},this.daoFeePoolAllCoinWithdrawTx=e=>{const{tx:t,daoFeePoolId:s,lpCoinId:i,coinTypes:n,lpCoinType:r}=e;if(!this.addresses.daoFeePools)throw new Error("dao fee pool addresses have not been set in provider");const a=n.length;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.daoFeePools.packages.amm,p.constants.moduleNames.withdraw,`all_coin_withdraw_${a}_coins`),typeArguments:[r,...n],arguments:[t.object(s),t.object(this.addresses.daoFeePools.objects.version),t.object(this.addresses.pools.objects.poolRegistry),t.object(this.addresses.pools.objects.protocolFeeVault),t.object(this.addresses.pools.objects.treasury),t.object(this.addresses.pools.objects.insuranceFund),t.object(this.addresses.referralVault.objects.referralVault),"string"==typeof i?t.object(i):i]})},this.fetchBuildTradeTx=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,pool:s,coinInAmount:i,coinInType:r,coinOutType:a,slippage:o,referrer:d,isSponsoredTx:c}=e,l=new n.Transaction;l.setSender(t),d&&this.Provider.ReferralVault().updateReferrerTx({tx:l,referrer:d});const u=s.getTradeAmountOut({coinInAmount:i,coinInType:r,coinOutType:a,referral:void 0!==d}),p=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:l,walletAddress:t,coinType:r,coinAmount:i,isSponsoredTx:c});if(s.pool.daoFeePoolObject){const e=this.daoFeePoolTradeTx({tx:l,coinInId:p,daoFeePoolId:s.pool.daoFeePoolObject.objectId,expectedCoinOutAmount:u,lpCoinType:s.pool.lpCoinType,coinInType:r,coinOutType:a,slippage:o});l.transferObjects([e],t)}else this.tradeTx({tx:l,coinInId:p,poolId:s.pool.objectId,expectedCoinOutAmount:u,lpCoinType:s.pool.lpCoinType,coinInType:r,coinOutType:a,slippage:o,withTransfer:!0});return l})),this.fetchAddTradeTx=e=>i(this,void 0,void 0,(function*(){const{tx:t,coinInId:s,coinInAmount:i,coinInType:n,coinOutType:r,slippage:a,pool:o,referrer:d}=e,c=o.getTradeAmountOut({coinInAmount:i,coinInType:n,coinOutType:r,referral:void 0!==d});return this.tradeTx({tx:t,coinInId:s,poolId:o.pool.objectId,expectedCoinOutAmount:c,lpCoinType:o.pool.lpCoinType,coinInType:n,coinOutType:r,slippage:a})})),this.fetchBuildDepositTx=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,pool:s,amountsIn:i,slippage:r,referrer:o,isSponsoredTx:d}=e,l=new n.Transaction;l.setSender(t),o&&this.Provider.ReferralVault().updateReferrerTx({tx:l,referrer:o});const{coins:u,balances:p}=c.Coin.coinsAndBalancesOverZero(i),{lpRatio:h}=s.getDepositLpAmountOut({amountsIn:i,referral:void 0!==o}),m=a.Casting.numberToFixedBigInt(h),g=yield this.Provider.Coin().fetchCoinsWithAmountTx(Object.assign(Object.assign({},e),{tx:l,coinTypes:u,coinAmounts:p,isSponsoredTx:d}));if(s.pool.daoFeePoolObject){const e=this.daoFeePoolMultiCoinDepositTx({tx:l,daoFeePoolId:s.pool.daoFeePoolObject.objectId,lpCoinType:s.pool.lpCoinType,coinIds:g,coinTypes:u,expectedLpRatio:m,slippage:r});l.transferObjects([e],t)}else this.multiCoinDepositTx({tx:l,poolId:s.pool.objectId,lpCoinType:s.pool.lpCoinType,coinIds:g,coinTypes:u,expectedLpRatio:m,slippage:r,withTransfer:!0});return l})),this.fetchBuildWithdrawTx=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,pool:s,amountsOutDirection:i,lpCoinAmount:r,slippage:a,referrer:o}=e,d=new n.Transaction;d.setSender(t),o&&this.Provider.ReferralVault().updateReferrerTx({tx:d,referrer:o});const l=s.getMultiCoinWithdrawLpRatio({lpCoinAmountIn:r}),u=s.getWithdrawAmountsOut({lpRatio:l,amountsOutDirection:i,referral:void 0!==o}),{coins:p,balances:h}=c.Coin.coinsAndBalancesOverZero(u),m=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:d,walletAddress:t,coinType:s.pool.lpCoinType,coinAmount:r});return s.pool.daoFeePoolObject||this.multiCoinWithdrawTx({tx:d,poolId:s.pool.objectId,lpCoinType:s.pool.lpCoinType,expectedAmountsOut:h,coinTypes:p,lpCoinId:m,slippage:a,withTransfer:!0}),d})),this.fetchBuildAllCoinWithdrawTx=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,pool:s,lpCoinAmount:i,referrer:r}=e,a=new n.Transaction;a.setSender(t),r&&this.Provider.ReferralVault().updateReferrerTx({tx:a,referrer:r});const o=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:a,walletAddress:t,coinType:s.pool.lpCoinType,coinAmount:i}),d=Object.keys(s.pool.coins);if(s.pool.daoFeePoolObject){const e=this.daoFeePoolAllCoinWithdrawTx({tx:a,daoFeePoolId:s.pool.daoFeePoolObject.objectId,lpCoinType:s.pool.lpCoinType,coinTypes:d,lpCoinId:o});a.transferObjects(d.map(((t,s)=>e[s])),t)}else this.allCoinWithdrawTx({tx:a,poolId:s.pool.objectId,lpCoinType:s.pool.lpCoinType,coinTypes:d,lpCoinId:o,withTransfer:!0});return a})),this.buildPublishLpCoinTx=e=>{const{lpCoinDecimals:t}=e,s=new n.Transaction;s.setSender(e.walletAddress);const i=this.publishLpCoinTx({tx:s,lpCoinDecimals:t});return s.transferObjects([i],e.walletAddress),s},this.buildDaoFeePoolUpdateFeeBpsTx=d.Helpers.transactions.createBuildTxFunc(this.daoFeePoolUpdateFeeBpsTx),this.buildDaoFeePoolUpdateFeeRecipientTx=d.Helpers.transactions.createBuildTxFunc(this.daoFeePoolUpdateFeeRecipientTx),this.tradeEventType=()=>l.EventsApiHelpers.createEventType(this.addresses.pools.packages.events,p.constants.moduleNames.events,p.constants.eventNames.swap),this.depositEventType=()=>l.EventsApiHelpers.createEventType(this.addresses.pools.packages.events,p.constants.moduleNames.events,p.constants.eventNames.deposit),this.withdrawEventType=()=>l.EventsApiHelpers.createEventType(this.addresses.pools.packages.events,p.constants.moduleNames.events,p.constants.eventNames.withdraw),this.tradeV2EventType=()=>l.EventsApiHelpers.createEventType(this.addresses.pools.packages.eventsV2,p.constants.moduleNames.events,p.constants.eventNames.swapV2),this.depositV2EventType=()=>l.EventsApiHelpers.createEventType(this.addresses.pools.packages.eventsV2,p.constants.moduleNames.events,p.constants.eventNames.depositV2),this.withdrawV2EventType=()=>l.EventsApiHelpers.createEventType(this.addresses.pools.packages.eventsV2,p.constants.moduleNames.events,p.constants.eventNames.withdrawV2);const t=e.addresses.pools,s=e.addresses.referralVault,h=e.addresses.daoFeePools;if(!t||!s)throw new Error("not all required addresses have been set in provider");this.addresses={pools:t,referralVault:s,daoFeePools:h},this.objectTypes={pool:`${t.packages.events}::pool::Pool`,daoFeePool:h?`${h.packages.events}::pool::DaoFeePool`:void 0,daoFeePoolOwnerCap:h?`${h.packages.events}::pool::OwnerCap`:void 0},this.eventTypes={trade:this.tradeEventType(),deposit:this.depositEventType(),withdraw:this.withdrawEventType(),tradeV2:this.tradeV2EventType(),depositV2:this.depositV2EventType(),withdrawV2:this.withdrawV2EventType()},this.moveErrors=Object.assign({[this.addresses.pools.packages.amm]:{[p.constants.moduleNames.pool]:{0:"Flatness Not Normalized",1:"Flatness Not Supported",2:"Weights Not Normalized",3:"Invalid Weight",4:"Invalid Fee",5:"Bad Vector Length",6:"Not Enough Initial Liquidity",7:"Non Zero Total Supply",8:"Bad Type",9:"Bad Decimals",10:"Not Sorted"},[p.constants.moduleNames.poolRegistry]:{60:"Not Sorted",61:"Duplicate Pool",62:"Invalid Upgrade"},[p.constants.moduleNames.deposit]:{20:"Invalid Protocol Version",21:"Invalid Pool Size",22:"Zero Value",23:"Duplicate Types"},[p.constants.moduleNames.poolFactory]:{10:"Invalid Protocol Version",11:"Zero Value"},[p.constants.moduleNames.price]:{10:"Invalid Protocol Version"},[p.constants.moduleNames.swap]:{40:"Invalid Protocol Version",41:"Invalid Pool Size",42:"Zero Value",43:"Bad Vector Length",44:"Insufficient Coin In",45:"Duplicate Types",46:"Internal Error",47:"Not Authorized"},[p.constants.moduleNames.withdraw]:{30:"Invalid Protocol Version",31:"Invalid PoolSize",32:"Zero Value",33:"Bad Vector Length",34:"Duplicate Types"},[p.constants.moduleNames.math]:{51:"Slippage",52:"Invalid Swap Amount In",53:"Invalid Swap Amount Out",54:"Zero Amount In",55:"Zero Amount Out",56:"Zero Lp Out",57:"Zero Lp Ratio"},[p.constants.moduleNames.geometricMeanCalculations]:{},[p.constants.moduleNames.stableCalculations]:{}}},this.addresses.daoFeePools?{[this.addresses.daoFeePools.packages.amm]:{version:{0:"Invalid Version",1:"Version Object Already Created"}}}:{})}}t.PoolsApi=p,p.constants={moduleNames:{interface:"amm_interface",pool:"pool",swap:"swap",deposit:"deposit",withdraw:"withdraw",events:"events",poolRegistry:"pool_registry",routerWrapper:"router",poolFactory:"pool_factory",math:"math",geometricMeanCalculations:"geometric_mean_calculations",stableCalculations:"stable_calculations",price:"price"},eventNames:{swap:"SwapEvent",deposit:"DepositEvent",withdraw:"WithdrawEvent",swapV2:"SwapEventV2",depositV2:"DepositEventV2",withdrawV2:"WithdrawEventV2"},defaultLpCoinIconImageUrl:"https://aftermath.finance/coins/lp/af_lp.svg"}},974247:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PoolsApiCasting=void 0;const i=s(302416),n=s(243333);class r{}t.PoolsApiCasting=r,r.poolObjectFromSuiObject=e=>{const t=n.Helpers.getObjectId(e),s=n.Helpers.getObjectType(e),r=n.Helpers.getObjectFields(e),a=n.Helpers.addLeadingZeroesToType(i.Coin.getInnerCoinType(r.lp_supply.type)),o=r.type_names.reduce(((e,t,s)=>Object.assign(Object.assign({},e),{[n.Helpers.addLeadingZeroesToType("0x"+t)]:Object.assign({weight:BigInt(r.weights[s]),balance:BigInt(r.normalized_balances[s])/BigInt(r.decimal_scalars[s]),tradeFeeIn:BigInt(r.fees_swap_in[s]),tradeFeeOut:BigInt(r.fees_swap_out[s]),depositFee:BigInt(r.fees_deposit[s]),withdrawFee:BigInt(r.fees_withdraw[s]),normalizedBalance:BigInt(r.normalized_balances[s]),decimalsScalar:BigInt(r.decimal_scalars[s])},r.coin_decimals?{decimals:Number(r.coin_decimals[s])}:{})})),{});return{objectType:s,objectId:t,lpCoinType:a,name:r.name,creator:r.creator,lpCoinSupply:BigInt(r.lp_supply.fields.value),illiquidLpCoinSupply:BigInt(r.illiquid_lp_supply),flatness:BigInt(r.flatness),lpCoinDecimals:Number(r.lp_decimals),coins:o}},r.daoFeePoolOwnerCapObjectFromSuiObjectResponse=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),daoFeePoolId:n.Helpers.addLeadingZeroesToType(s.dao_fee_pool_id)}},r.poolObjectIdfromPoolCreateEventOnChain=e=>e.parsedJson.pool_id,r.poolTradeEventFromOnChain=e=>{const t=e.parsedJson;return{poolId:t.pool_id,trader:t.issuer,typesIn:t.types_in.map((e=>n.Helpers.addLeadingZeroesToType("0x"+e))),amountsIn:t.amounts_in.map((e=>BigInt(e))),typesOut:t.types_out.map((e=>n.Helpers.addLeadingZeroesToType("0x"+e))),amountsOut:t.amounts_out.map((e=>BigInt(e))),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.poolDepositEventFromOnChain=e=>{const t=e.parsedJson;return{poolId:t.pool_id,depositor:t.issuer,types:t.types.map((e=>n.Helpers.addLeadingZeroesToType("0x"+e))),deposits:t.deposits.map((e=>BigInt(e))),lpMinted:BigInt(t.lp_coins_minted),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.poolWithdrawEventFromOnChain=e=>{const t=e.parsedJson;return{poolId:t.pool_id,withdrawer:t.issuer,types:t.types.map((e=>n.Helpers.addLeadingZeroesToType("0x"+e))),withdrawn:t.withdrawn.map((e=>BigInt(e))),lpBurned:BigInt(t.lp_coins_burned),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},708188:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(32354),t),n(s(593460),t)},32354:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Pool=void 0;const n=s(895359),r=s(601151),a=s(708188),o=s(243333);class d extends r.Caller{constructor(e,t,s){super(t,`pools/${e.objectId}`),this.pool=e,this.Provider=s,this.getVolume24hrs=()=>i(this,void 0,void 0,(function*(){return this.fetchApi("volume-24hrs")})),this.getSpotPrice=e=>n.CmmmCalculations.calcSpotPriceWithFees(o.Helpers.deepCopy(this.pool),e.coinInType,e.coinOutType,!e.withFees)*Number(this.pool.coins[e.coinOutType].decimalsScalar)/Number(this.pool.coins[e.coinInType].decimalsScalar),this.getTradeAmountOut=e=>{const t=o.Helpers.deepCopy(this.pool),s=t.coins[e.coinInType].balance,i=t.coins[e.coinOutType].balance,r=this.getAmountWithDAOFee({amount:a.Pools.getAmountWithProtocolFees({amount:e.coinInAmount})});if(Number(r)/Number(s)>=a.Pools.constants.bounds.maxTradePercentageOfPoolBalance-d.constants.percentageBoundsMarginOfError)throw new Error("coinInAmountWithFees / coinInPoolBalance >= maxTradePercentageOfPoolBalance");const c=n.CmmmCalculations.calcOutGivenIn(t,e.coinInType,e.coinOutType,r);if(c<=0)throw new Error("coinOutAmount <= 0");if(Number(c)/Number(i)>=a.Pools.constants.bounds.maxTradePercentageOfPoolBalance-d.constants.percentageBoundsMarginOfError)throw new Error("coinOutAmount / coinOutPoolBalance >= maxTradePercentageOfPoolBalance");return c},this.getTradeAmountIn=e=>{const t=o.Helpers.deepCopy(this.pool),s=t.coins[e.coinInType].balance,i=t.coins[e.coinOutType].balance;if(Number(e.coinOutAmount)/Number(i)>=a.Pools.constants.bounds.maxTradePercentageOfPoolBalance-d.constants.percentageBoundsMarginOfError)throw new Error("coinOutAmount / coinOutPoolBalance >= maxTradePercentageOfPoolBalance");const r=n.CmmmCalculations.calcInGivenOut(t,e.coinInType,e.coinOutType,e.coinOutAmount);if(r<=0)throw new Error("coinInAmount <= 0");if(Number(r)/Number(s)>=a.Pools.constants.bounds.maxTradePercentageOfPoolBalance-d.constants.percentageBoundsMarginOfError)throw new Error("coinInAmount / coinInPoolBalance >= maxTradePercentageOfPoolBalance");return this.getAmountWithoutDAOFee({amount:a.Pools.getAmountWithoutProtocolFees({amount:r})})},this.getDepositLpAmountOut=e=>{const t=n.CmmmCalculations.calcDepositFixedAmounts(this.pool,Object.entries(e.amountsIn).reduce(((e,[t,s])=>Object.assign(Object.assign({},e),{[t]:this.getAmountWithDAOFee({amount:s})})),{}));if(t>=o.Casting.Fixed.fixedOneB)throw new Error("lpRatio >= 1");const s=o.Casting.bigIntToFixedNumber(t);return{lpAmountOut:BigInt(Math.floor(Number(this.pool.lpCoinSupply)*(1/s-1))),lpRatio:s}},this.getWithdrawAmountsOut=e=>{const t=n.CmmmCalculations.calcWithdrawFlpAmountsOut(this.pool,e.amountsOutDirection,e.lpRatio);for(const s of Object.keys(t)){if(!(s in e.amountsOutDirection)||e.amountsOutDirection[s]<=BigInt(0))continue;const i=t[s];if(i<=0)throw new Error(`amountsOut[${s}] <= 0`);if(Number(i)/Number(this.pool.coins[s].balance)>=a.Pools.constants.bounds.maxWithdrawPercentageOfPoolBalance)throw new Error("coinOutAmount / coinOutPoolBalance >= maxWithdrawPercentageOfPoolBalance");t[s]=this.getAmountWithDAOFee({amount:i})}return t},this.getWithdrawAmountsOutSimple=e=>{const{lpCoinAmountIn:t,coinTypesOut:s,referral:i}=e,n=this.pool.lpCoinSupply;let r={};s.forEach((e=>{const s=this.pool.coins[o.Helpers.addLeadingZeroesToType(e)].balance,i=Number(s)*(Number(t)/Number(n));r[o.Helpers.addLeadingZeroesToType(e)]=BigInt(Math.floor(i))}));const d=this.getMultiCoinWithdrawLpRatio({lpCoinAmountIn:t}),c=this.getWithdrawAmountsOut({lpRatio:d,amountsOutDirection:r,referral:i});for(const e of Object.keys(c)){if(!s.map((e=>o.Helpers.addLeadingZeroesToType(e))).includes(e))continue;const t=c[e];if(t<=BigInt(0))throw new Error(`amountsOut[${e}] <= 0 `);if(t/this.pool.coins[e].balance>=a.Pools.constants.bounds.maxWithdrawPercentageOfPoolBalance)throw new Error("coinOutAmount / coinOutPoolBalance >= maxWithdrawPercentageOfPoolBalance");c[e]=this.getAmountWithDAOFee({amount:t})}return c},this.getAllCoinWithdrawAmountsOut=e=>{if(e.lpRatio>=1)throw new Error("lpRatio >= 1");return Object.entries(this.pool.coins).reduce(((t,[s,i])=>Object.assign(Object.assign({},t),{[s]:this.getAmountWithDAOFee({amount:BigInt(Math.floor(Number(i.balance)*e.lpRatio))})})),{})},this.getMultiCoinWithdrawLpRatio=e=>Number(this.pool.lpCoinSupply-e.lpCoinAmountIn)/Number(this.pool.lpCoinSupply),this.getAllCoinWithdrawLpRatio=e=>Number(e.lpCoinAmountIn)/Number(this.pool.lpCoinSupply),this.coins=()=>Object.keys(this.pool.coins).sort(((e,t)=>e.localeCompare(t))),this.poolCoins=()=>Object.entries(this.pool.coins).sort(((e,t)=>e[0].localeCompare(t[0]))).map((e=>e[1])),this.poolCoinEntries=()=>Object.entries(this.pool.coins).sort(((e,t)=>e[0].localeCompare(t[0]))),this.daoFeePercentage=()=>this.pool.daoFeePoolObject?o.Casting.bpsToPercentage(this.pool.daoFeePoolObject.feeBps):void 0,this.daoFeeRecipient=()=>{var e;return null===(e=this.pool.daoFeePoolObject)||void 0===e?void 0:e.feeRecipient},this.getAmountWithDAOFee=e=>{const t=this.daoFeePercentage();return t?BigInt(Math.floor(Number(e.amount)*(1-t))):e.amount},this.getAmountWithoutDAOFee=e=>{const t=this.daoFeePercentage();return t?BigInt(Math.floor(Number(e.amount)*(1/(1-t)))):e.amount},this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Pools();if(!t)throw new Error("missing AftermathApi Provider");return t},this.pool=e}getDepositTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildDepositTx(Object.assign(Object.assign({},e),{pool:this}))}))}getWithdrawTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildWithdrawTx(Object.assign(Object.assign({},e),{pool:this}))}))}getAllCoinWithdrawTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildAllCoinWithdrawTx(Object.assign(Object.assign({},e),{pool:this}))}))}getTradeTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildTradeTx(Object.assign(Object.assign({},e),{pool:this}))}))}getUpdateDaoFeeTransaction(e){return i(this,void 0,void 0,(function*(){var t;const s=null===(t=this.pool.daoFeePoolObject)||void 0===t?void 0:t.objectId;if(!s)throw new Error("this pool has no DAO fee");return this.useProvider().buildDaoFeePoolUpdateFeeBpsTx(Object.assign(Object.assign({},e),{daoFeePoolId:s,lpCoinType:this.pool.lpCoinType,newFeeBps:o.Casting.percentageToBps(e.newFeePercentage)}))}))}getUpdateDaoFeeRecipientTransaction(e){return i(this,void 0,void 0,(function*(){var t;const s=null===(t=this.pool.daoFeePoolObject)||void 0===t?void 0:t.objectId;if(!s)throw new Error("this pool has no DAO fee");return this.useProvider().buildDaoFeePoolUpdateFeeRecipientTx(Object.assign(Object.assign({},e),{daoFeePoolId:s,lpCoinType:this.pool.lpCoinType,newFeeRecipient:o.Helpers.addLeadingZeroesToType(e.newFeeRecipient)}))}))}getStats(){return i(this,void 0,void 0,(function*(){const e=yield this.fetchApi("stats");return this.setStats(e),e}))}setStats(e){this.stats=e}getVolumeData(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`volume/${e.timeframe}`)}))}getFeeData(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`fees/${e.timeframe}`)}))}getInteractionEvents(e){return i(this,void 0,void 0,(function*(){return this.fetchApiIndexerEvents("interaction-events-by-user",e)}))}}t.Pool=d,d.constants={percentageBoundsMarginOfError:.001}},593460:function(e,t,s){var i,n=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Pools=void 0;const r=s(32354),a=s(897399),o=s(601151),d=s(308041),c=s(845963);class l extends o.Caller{constructor(e,t){super(e,"pools"),this.Provider=t,this.getPoolObjectIdForLpCoinType=e=>this.getPoolObjectIdsForLpCoinTypes({lpCoinTypes:[e.lpCoinType]}),this.isLpCoinType=e=>n(this,void 0,void 0,(function*(){try{return yield this.getPoolObjectIdForLpCoinType(e),!0}catch(e){return!1}})),this.getTotalVolume24hrs=()=>n(this,void 0,void 0,(function*(){return this.fetchApi("volume-24hrs")})),this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Pools();if(!t)throw new Error("missing AftermathApi Provider");return t}}getPool(e){return n(this,void 0,void 0,(function*(){const t=yield this.fetchApi(e.objectId);return new r.Pool(t,this.config,this.Provider)}))}getPools(e){return n(this,void 0,void 0,(function*(){return(yield this.fetchApi("",{poolIds:e.objectIds})).map((e=>new r.Pool(e,this.config,this.Provider)))}))}getAllPools(){return n(this,void 0,void 0,(function*(){return(yield this.fetchApi("",{})).map((e=>new r.Pool(e,this.config,this.Provider)))}))}getOwnedLpCoins(e){return n(this,void 0,void 0,(function*(){return this.fetchApi("owned-lp-coins",e)}))}getPublishLpCoinTransaction(e){return n(this,void 0,void 0,(function*(){return this.useProvider().buildPublishLpCoinTx(e)}))}getCreatePoolTransaction(e){return n(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/create-pool",e)}))}getPoolObjectIdsForLpCoinTypes(e){return n(this,void 0,void 0,(function*(){return this.fetchApi("pool-object-ids",e)}))}getTVL(e){return n(this,void 0,void 0,(function*(){return this.fetchApi("tvl",null!=e?e:{})}))}getPoolsStats(e){return n(this,void 0,void 0,(function*(){return this.fetchApi("stats",e)}))}getOwnedDaoFeePoolOwnerCaps(e){return n(this,void 0,void 0,(function*(){return this.useProvider().fetchOwnedDaoFeePoolOwnerCaps(e)}))}getInteractionEvents(e){return n(this,void 0,void 0,(function*(){return this.fetchApiIndexerEvents("interaction-events-by-user",e)}))}}t.Pools=l,i=l,l.constants={feePercentages:{totalProtocol:5e-5,treasury:.5,insuranceFund:.3,devWallet:.2},referralPercentages:{discount:.05,rebate:.05},bounds:{maxCoinsInPool:8,maxTradePercentageOfPoolBalance:.3,maxWithdrawPercentageOfPoolBalance:.3,minSwapFee:1e-4,maxSwapFee:.1,minWeight:.01,maxWeight:.99,minDaoFee:0,maxDaoFee:1},defaults:{lpCoinDecimals:9}},l.getAmountWithProtocolFees=e=>{const t=e.withReferral?i.constants.feePercentages.totalProtocol*i.constants.feePercentages.treasury*i.constants.referralPercentages.discount:0;return BigInt(Math.floor(Number(e.amount)*(1-(i.constants.feePercentages.totalProtocol-t))))},l.getAmountWithoutProtocolFees=e=>{const t=e.withReferral?i.constants.feePercentages.totalProtocol*i.constants.feePercentages.treasury*i.constants.referralPercentages.discount:0;return BigInt(Math.floor(Number(e.amount)*(1/(1-(i.constants.feePercentages.totalProtocol-t)))))},l.normalizeInvertSlippage=e=>c.FixedUtils.directUncast(1-e),l.displayLpCoinType=e=>a.Coin.getCoinTypeSymbol(e).toLowerCase().replace("af_lp_","").split("_").map((e=>d.Helpers.capitalizeOnlyFirstLetter(e))).join(" ")+" LP",l.isPossibleLpCoinType=e=>{const{lpCoinType:t}=e;return 3===t.split("::").length&&t.split("::")[1].includes("af_lp")&&t.split("::")[2].includes("AF_LP")}},794871:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},895359:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CmmmCalculations=void 0;const n=s(243333),r=s(845963);class a{}t.CmmmCalculations=a,i=a,a.minWeight=.01,a.maxWeightedTokens=100,a.maxInRatio=.3,a.maxOutRatio=.3,a.minInvariantRatio=.7,a.maxInvariantRatio=3,a.maxNewtonAttempts=255,a.convergenceBound=1e-9,a.tolerance=1e-13,a.validityTolerance=1e-6,a.calcInvariant=e=>{let t,s,n=r.FixedUtils.directCast(e.flatness),a=0,o=0;for(let i of Object.values(e.coins))t=r.FixedUtils.directCast(i.normalizedBalance),s=r.FixedUtils.directCast(i.weight),a+=s*t,o+=s*Math.log(t);return o=Math.exp(o),i.calcInvariantQuadratic(o,a,n)},a.calcInvariantQuadratic=(e,t,s)=>(Math.sqrt(e*(e*(s*s+4*(1-s))+s*t*8))-s*e)/2,a.calcInvariantComponents=(e,t)=>{let s,n,a,o,d=r.FixedUtils.directCast(e.flatness),c=0,l=0,u=0,p=0;for(let[i,d]of Object.entries(e.coins))s=r.FixedUtils.directCast(d.normalizedBalance),n=r.FixedUtils.directCast(d.weight),a=n*Math.log(s),o=n*s,c+=a,l+=o,i!=t&&(u+=a,p+=o);return c=Math.exp(c),u=Math.exp(u),[c,l,u,p,i.calcInvariantQuadratic(c,l,d)]},a.calcSpotPrice=(e,t,s)=>i.calcSpotPriceWithFees(e,t,s,!0),a.calcSpotPriceWithFees=(e,t,s,a)=>{var o,d;let c=r.FixedUtils.directCast(e.flatness),l=i.calcSpotPriceBody(e),u=e.coins[t],p=e.coins[s],h=r.FixedUtils.directCast(u.normalizedBalance),m=r.FixedUtils.directCast(p.normalizedBalance),g=r.FixedUtils.directCast(u.weight),v=r.FixedUtils.directCast(p.weight),f=a?0:r.FixedUtils.directCast(u.tradeFeeIn),b=a?0:r.FixedUtils.directCast(u.tradeFeeOut);return v*h*(l+2*c*m)/((1-(a?0:n.Casting.bpsToPercentage(null!==(d=null===(o=e.daoFeePoolObject)||void 0===o?void 0:o.feeBps)&&void 0!==d?d:BigInt(0))))*(1-f)*(1-b)*g*m*(l+2*c*h))},a.calcSpotPriceBody=e=>{let t,s,n=r.FixedUtils.directCast(e.flatness),a=1-n,o=0,d=0;for(let i of Object.values(e.coins))t=r.FixedUtils.directCast(i.normalizedBalance),s=r.FixedUtils.directCast(i.weight),o+=s*Math.log(t),d+=s*t;o=Math.exp(o);let c=i.calcInvariantQuadratic(o,d,n);return c*c/o+a*o},a.calcOutGivenIn=(e,t,s,n)=>{if(t===s)throw Error("in and out must be different coins");let a=e.coins[t],o=e.coins[s],d=r.FixedUtils.directCast(a.tradeFeeIn),c=r.FixedUtils.directCast(o.tradeFeeOut);if(d>=1||c>=1)return BigInt(0);let l=r.FixedUtils.directCast(e.flatness),u=r.FixedUtils.directCast(a.normalizedBalance),p=r.FixedUtils.directCast(o.normalizedBalance),h=r.FixedUtils.directCast(a.weight),m=r.FixedUtils.directCast(o.weight),[g,,v,f,b]=i.calcInvariantComponents(e,s),y=(1-d)*r.FixedUtils.castAndNormalize(a.decimalsScalar,n),T=u+y,k=v*Math.pow(T/u,h),x=Math.pow(g/k,1/m),I=f+h*y,j=i.getTokenBalanceGivenInvariantAndAllOtherBalances(l,m,b,x,k,I),O=r.FixedUtils.uncastAndUnnormalize(o.decimalsScalar,(p-j)*(1-c));if(!i.checkValid1dSwap(e,t,s,n,O))throw Error("invalid 1d swap");return O},a.calcInGivenOut=(e,t,s,n)=>{if(t===s)throw Error("in and out must be different coins");let a=e.coins[t],o=e.coins[s],d=r.FixedUtils.directCast(a.tradeFeeIn),c=r.FixedUtils.directCast(o.tradeFeeOut);if(d>=1||c>=1){if(n===BigInt(0))return BigInt(0);throw Error("this swap is disabled")}let l=r.FixedUtils.directCast(e.flatness),u=r.FixedUtils.directCast(a.normalizedBalance),p=r.FixedUtils.directCast(o.normalizedBalance),h=r.FixedUtils.directCast(o.weight),m=r.FixedUtils.directCast(a.weight),[g,,v,f,b]=i.calcInvariantComponents(e,t),y=r.FixedUtils.castAndNormalize(a.decimalsScalar,n)/(1-c),T=p-y,k=v*Math.pow(T/p,h),x=Math.pow(g/k,1/m),I=f-h*y,j=i.getTokenBalanceGivenInvariantAndAllOtherBalances(l,m,b,x,k,I),O=r.FixedUtils.uncastAndUnnormalize(o.decimalsScalar,(j-u)/(1-d));if(!i.checkValid1dSwap(e,t,s,O,n))throw Error("invalid 1d swap");return O},a.calcSwapFixedIn=(e,t,s)=>{let a,o,d,c,l,u,p,h,m,g,v,f,b,y,T,k=e.coins,x=i.calcInvariant(e),I=r.FixedUtils.directCast(e.flatness),j=1-I,O=1,C=O,w=Number.POSITIVE_INFINITY,F=1;for(let[e,i]of Object.entries(k))if(c=r.FixedUtils.castAndNormalize(i.decimalsScalar,s[e]||BigInt(0)),u=r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeOut)),c>0){if(0===u)throw Error("this trade is disabled");O=(r.FixedUtils.directCast(i.normalizedBalance)+r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0))*r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeIn)))/c*u,w=Math.min(w,O)}if(0===w)return BigInt(0);for(;F>=w;)F/=2;O=1;for(let w=0;w<i.maxNewtonAttempts;++w){p=0,h=0,m=0,g=0,T=!1;for(let[e,i]of Object.entries(k)){if(a=r.FixedUtils.directCast(i.normalizedBalance),o=r.FixedUtils.directCast(i.weight),d=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),c=r.FixedUtils.castAndNormalize(i.decimalsScalar,s[e]||BigInt(0)),l=r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeIn)),u=r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeOut)),v=l*d,f=O*c/u,f>=a+v+1){T=!0;break}b=a+v-f,y=o*c/u,p+=o*Math.log(b),h+=y/b,m+=o*b,g+=y}if(p=Math.exp(p),v=I*m,f=j*p,b=v+f,y=I*x*h,O=(I*(m+2*O*g)+b+2*h*O*b-(O*y+x*(I+x/p)))/(2*(h*b+I*g)-y),n.Helpers.closeEnough(O,C,i.convergenceBound)){if(!i.checkValidSwap(e,t,1,s,O))throw Error("invalid swap");return r.FixedUtils.directUncast(O)}C=O}throw Error("Newton diverged")},a.calcSwapFixedOut=(e,t,s)=>{let a,o,d,c,l,u,p,h,m,g,v,f,b,y,T=e.coins,k=i.calcInvariant(e),x=r.FixedUtils.directCast(e.flatness),I=1-x,j=1,O=0;for(let[e,t]of Object.entries(T))if(t.tradeFeeOut>=r.FixedUtils.fixedOneB&&(s[e]||BigInt(0))>BigInt(0))throw Error("this trade is disabled");for(let C=0;C<i.maxNewtonAttempts;++C){p=0,h=0,m=0,g=0;for(let[e,i]of Object.entries(T))a=r.FixedUtils.directCast(i.normalizedBalance),o=r.FixedUtils.directCast(i.weight),d=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),c=r.FixedUtils.castAndNormalize(i.decimalsScalar,s[e]||BigInt(0)),l=1-r.FixedUtils.directCast(i.tradeFeeIn),u=1-r.FixedUtils.directCast(i.tradeFeeOut),v=l*d,f=0===c?0:c/u,b=a+j*v-f,y=o*v,p+=o*Math.log(b),h+=y/b,m+=o*b,g+=y;if(p=Math.exp(p),v=2*x*m,f=I*p,b=v+f,y=(b+f)*h+2*x*g-x*k*h,j=(j*y+k*(x+k/p)-b)/y,n.Helpers.closeEnough(j,O,i.convergenceBound)){if(!i.checkValidSwap(e,t,1,s,j))throw Error("invalid swap");return r.FixedUtils.directUncast(j)}O=j}throw Error("Newton diverged")},a.calcDepositFixedAmounts=(e,t)=>{let s,a,o,d=i.calcInvariant(e),c=e.coins,l=r.FixedUtils.directCast(e.flatness),u=1-l,p=0,h=0,m=i.calcDepositFixedAmountsInitialEstimate(e,t),g=m,v={};for(let[e,i]of Object.entries(c))s=r.FixedUtils.directCast(i.normalizedBalance),o=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),v[e]=m*(s+o)>=s?1-r.FixedUtils.directCast(i.tradeFeeIn):1/(1-r.FixedUtils.directCast(i.tradeFeeOut));let f,b,y,T,k,x,I,j=0;for(;j<i.maxNewtonAttempts;){p=0,f=0,h=0,b=0;for(let[e,i]of Object.entries(c))s=r.FixedUtils.directCast(i.normalizedBalance),a=r.FixedUtils.directCast(i.weight),o=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),y=v[e],T=s+o,k=y*m*T+s-y*s,x=a*y*T,p+=a*Math.log(k),f+=x/k,h+=a*k,b+=x;if(p=Math.exp(p),x=l*d*f,I=2*f*(l*h+u*p)+2*l*b,m=(m*I+d*(1+d/p)-(m*x+2*l*h+u*(p+d)))/(I-x),n.Helpers.closeEnough(m,g,i.convergenceBound)){let s=r.FixedUtils.directUncast(m);if(!i.checkValidDeposit(e,t,s))throw Error("invalid deposit");return s}g=m,j+=1}throw Error("Newton diverged")},a.calcDepositFixedAmountsInitialEstimate=(e,t)=>{let s,n,a,o,d,c=i.calcInvariant(e),l=e.coins,u=r.FixedUtils.directCast(e.flatness),p=1-u,h=0,m=0,g=0,v=0;for(let[e,i]of Object.entries(l))s=r.FixedUtils.directCast(i.normalizedBalance),n=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),a=r.FixedUtils.directCast(i.weight),d=s+(1-r.FixedUtils.directCast(i.tradeFeeIn))*n,g+=a*Math.log(d),v+=a*d,o=r.FixedUtils.directCast(i.tradeFeeOut)*s/(s+n),h=Math.max(o,h);g=Math.exp(g);let f,b=2*u*g*v/(g+c)+p*g,y=1;for(let[e,i]of Object.entries(l))if(s=r.FixedUtils.directCast(i.normalizedBalance),a=r.FixedUtils.directCast(i.weight),n=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),o=s/(s+n),!(o<=h)){g=0,v=0;for(let[e,c]of Object.entries(l))s=r.FixedUtils.directCast(c.normalizedBalance),a=r.FixedUtils.directCast(c.weight),n=r.FixedUtils.castAndNormalize(c.decimalsScalar,t[e]||BigInt(0)),d=o*(s+n),d=d>=s?s+(1-r.FixedUtils.directCast(c.tradeFeeIn))*(d-s):s-(s-d)/r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeOut)),g+=a*Math.log(d),v+=a*d;g=Math.exp(g),f=2*u*g*v/(g+c)+p*g,f<=c&&f>=m&&(h=o,m=f),f>=c&&f<=b&&(y=o,b=f)}return o=m===b?h:(h*b+(y-h)*c-y*m)/(b-m),o},a.calcWithdrawFlpAmountsOut=(e,t,s)=>{let a,o,d,c,l,u,p,h,m,g,v,f,b,y,T=i.calcInvariant(e),k=e.coins,x=s,I=1-x,j=T*x,O=r.FixedUtils.directCast(e.flatness),C=1-O,w=0,F=1,[P,A]=i.calcWithdrawFlpAmountsOutInitialEstimate(e,t,s);for(;F>=A;)F/=2;let S={};for(let[e,s]of Object.entries(k))o=r.FixedUtils.directCast(s.normalizedBalance),c=r.FixedUtils.castAndNormalize(s.decimalsScalar,t[e]||BigInt(0)),S[e]=o*I>=P*c?1-r.FixedUtils.directCast(s.tradeFeeIn):1/(1-r.FixedUtils.directCast(s.tradeFeeOut));for(a=0;a<i.maxNewtonAttempts;){u=0,p=0,h=0,m=0,y=!1;for(let[e,s]of Object.entries(k)){if(o=r.FixedUtils.directCast(s.normalizedBalance),d=r.FixedUtils.directCast(s.weight),c=r.FixedUtils.castAndNormalize(s.decimalsScalar,t[e]||BigInt(0)),l=S[e],g=o*(x+I*l),v=l*P*c,v+1>=g){y=!0;break}g-=v,v=d*l*c,u+=d*Math.log(g),p+=v/g,h+=d*g,m+=v}if(y)P=A-F/Math.pow(2,a),a+=1;else{if(u=Math.exp(u),g=u/j,v=2*O*h,f=C*(u*g+2*u+j)+v,b=f*p+2*O*(g+1)*m,P=(P*b+f+g*v-u-j*(2+j/u))/b,n.Helpers.closeEnough(P,w,i.convergenceBound)){let n={};for(let e of Object.keys(k))n[e]=r.FixedUtils.directUncast(P*r.FixedUtils.directCast(t[e]||BigInt(0)));if(!i.checkValidWithdraw(e,n,s))throw Error("invalid withdraw");return n}w=P,a+=1}}throw Error("Newton diverged")},a.calcWithdrawFlpAmountsOutInitialEstimate=(e,t,s)=>{let n,a,o,d,c,l,u,p,h,m,g,v,f,b,y,T,k,x=i.calcInvariant(e),I=e.coins,j=s,O=1-j,C=x*j,w=r.FixedUtils.directCast(e.flatness),F=1-w;u=0,f=0,b=0;for(let e of Object.values(I))h=r.FixedUtils.directCast(e.normalizedBalance),m=r.FixedUtils.directCast(e.weight),v=r.FixedUtils.directCast(e.tradeFeeIn),y=h*(1+j*v-v),f+=m*Math.log(y),b+=m*y;f=Math.exp(f),p=2*w*f*b/(f+C)+F*f,l=0,c=Number.POSITIVE_INFINITY;for(let[e,i]of Object.entries(I))g=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),0!==g&&(o=r.FixedUtils.directCast(i.normalizedBalance)*r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeOut)*s)/g,o<c&&(c=o));a=c;for(let[e,s]of Object.entries(I))if(g=r.FixedUtils.castAndNormalize(s.decimalsScalar,t[e]||BigInt(0)),0!==g){h=r.FixedUtils.directCast(s.normalizedBalance),o=h*O/g,f=0,b=0,n=!0;for(let[e,s]of Object.entries(I)){if(h=r.FixedUtils.directCast(s.normalizedBalance),m=r.FixedUtils.directCast(s.weight),g=r.FixedUtils.castAndNormalize(s.decimalsScalar,t[e]||BigInt(0)),y=o*g,y>=h){n=!1;break}y=h-y,T=j*h,k=y>=T?T+r.FixedUtils.complement(r.FixedUtils.directCast(s.tradeFeeIn))*(y-T):T-(T-y)/r.FixedUtils.complement(r.FixedUtils.directCast(s.tradeFeeOut)),f+=m*Math.log(k),b+=m*k}n&&(f=Math.exp(f),d=2*w*f*b/(f+C)+F*f,d>=C&&d<=p&&(u=o,p=d),d<=C&&d>=l&&(c=o,l=d))}return o=p===l?c:(c*p+u*C-u*l-c*C)/(p-l),[o,a]},a.calcAllCoinDeposit=(e,t)=>{let s,i,a,o=e.coins,d=Number.POSITIVE_INFINITY;for(let[e,n]of Object.entries(o))s=r.FixedUtils.directCast(n.normalizedBalance),i=r.FixedUtils.castAndNormalize(n.decimalsScalar,t[e]||BigInt(0)),a=i/s,a<d&&(d=a);let c={};for(let e of Object.keys(o))c[e]=n.Helpers.blendedOperations.mulNBB(d,t[e]||BigInt(0));return c},a.calcAllCoinWithdraw=(e,t)=>{let s,i,a,o=e.coins,d=0;for(let[e,n]of Object.entries(o))s=r.FixedUtils.directCast(n.normalizedBalance),i=r.FixedUtils.castAndNormalize(n.decimalsScalar,t[e]||BigInt(0)),a=i/s,a>d&&(d=a);let c={};for(let e of Object.keys(o))c[e]=n.Helpers.blendedOperations.mulNBB(d,t[e]||BigInt(0));return c},a.getTokenBalanceGivenInvariantAndAllOtherBalances=(e,t,s,r,a,o)=>{if(isNaN(r))throw new Error("initial estimate is not a number");let d,c,l,u,p=1-e,h=e*t,m=p*t,g=e*o,v=e*s,f=2*h*t,b=2*m*a,y=2*t*g+v,T=s*s/a,k=p*a,x=2*g+t*v,I=2*h*(t+1),j=2*m*a,O=2*h*o,C=h*s,w=r,F=w,P=0;for(;P<i.maxNewtonAttempts;)if(d=Math.pow(w,t),c=w*(d*(f*w+b*d+y)+T),l=w*(d*(k*d+x)),u=I*w+j*d+O,c<l||u<C)w=1/Math.pow(2,P),P+=1;else{if(w=(c-l)/(d*(u-C)),n.Helpers.closeEnough(w,F,i.convergenceBound))return w;F=w,P+=1}throw Error("Newton diverged")},a.checkValidSwap=(e,t,s,a,o)=>{let d,c,l,u,p,h,m,g,v=e.coins,f=r.FixedUtils.directCast(e.flatness),b=0,y=0,T=0,k=0,x=0,I=0;for(let[e,i]of Object.entries(v)){if(d=r.FixedUtils.directCast(i.normalizedBalance),u=r.FixedUtils.directCast(i.weight),p=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0))*s,h=r.FixedUtils.castAndNormalize(i.decimalsScalar,a[e]||BigInt(0))*o,p>0&&h>0)return!1;if(m=p*(1-r.FixedUtils.directCast(i.tradeFeeIn)),g=0===h?0:h/(1-r.FixedUtils.directCast(i.tradeFeeOut)),l=d+p,h>l+1)return!1;if(l-=-h,c=d+m,g>c+1)return!1;c-=-g,b+=u*Math.log(d),y+=u*d,x+=u*Math.log(l),I+=u*l,T+=u*Math.log(c),k+=u*c}b=Math.exp(b),x=Math.exp(x),T=Math.exp(T);let j=i.calcInvariantQuadratic(b,y,f),O=i.calcInvariantQuadratic(x,I,f),C=i.calcInvariantQuadratic(T,k,f);return O*(1+i.tolerance)>=j&&(n.Helpers.veryCloseInt(j,C,r.FixedUtils.fixedOneN)||n.Helpers.closeEnough(j,C,i.validityTolerance))},a.checkValid1dSwap=(e,t,s,a,o)=>{if(t===s)return!1;let d,c,l,u,p,h,m=e.coins,g=m[t],v=m[s],f=r.FixedUtils.directCast(e.flatness),b=r.FixedUtils.castAndNormalize(g.decimalsScalar,a),y=r.FixedUtils.castAndNormalize(v.decimalsScalar,o),T=b*(1-r.FixedUtils.directCast(g.tradeFeeIn)),k=0===y?0:y/(1-r.FixedUtils.directCast(v.tradeFeeOut)),x=0,I=0,j=0,O=0,C=0,w=0;for(let[e,i]of Object.entries(m))if(d=r.FixedUtils.directCast(i.normalizedBalance),u=r.FixedUtils.directCast(i.weight),p=u*Math.log(d),h=u*d,x+=p,I+=h,e===t)c=d+T,l=d+b,j+=u*Math.log(c),O+=u*c,C+=u*Math.log(l),w+=u*l;else if(e===s){if(k>d+1||y>d+1)return!1;c=d-k,l=d-y,j+=u*Math.log(c),O+=u*c,C+=u*Math.log(l),w+=u*l}else j+=p,O+=h,C+=p,w+=h;x=Math.exp(x),C=Math.exp(C),j=Math.exp(j);let F=i.calcInvariantQuadratic(x,I,f),P=i.calcInvariantQuadratic(C,w,f),A=i.calcInvariantQuadratic(j,O,f);return P*(1+i.tolerance)>=F&&(n.Helpers.veryCloseInt(F,A,r.FixedUtils.fixedOneN)||n.Helpers.closeEnough(F,A,i.validityTolerance))},a.checkValidDeposit=(e,t,s)=>{let a=e.coins,o=r.FixedUtils.directCast(s);if(o>1)return!1;let d,c,l,u,p,h,m,g=r.FixedUtils.directCast(e.flatness),v=0,f=0,b=0,y=0,T=0,k=0;for(let[e,s]of Object.entries(a)){if(d=r.FixedUtils.directCast(s.normalizedBalance),c=r.FixedUtils.directCast(s.weight),l=r.FixedUtils.castAndNormalize(s.decimalsScalar,t[e]||BigInt(0)),u=o*(d+l),u>=d)h=u-d,m=h*(1-r.FixedUtils.directCast(s.tradeFeeIn)),p=d+m;else{if(h=d-u,m=0===h?0:h/(1-r.FixedUtils.directCast(s.tradeFeeOut)),m>=d+1)return!1;p=d-m}v+=c*Math.log(d),f+=c*d,T+=c*Math.log(u),k+=c*u,b+=c*Math.log(p),y+=c*p}v=Math.exp(v),T=Math.exp(T),b=Math.exp(b);let x=i.calcInvariantQuadratic(v,f,g),I=i.calcInvariantQuadratic(T,k,g),j=i.calcInvariantQuadratic(b,y,g);return I*(1+i.tolerance)>=x&&(n.Helpers.veryCloseInt(x,j,r.FixedUtils.fixedOneN)||n.Helpers.closeEnough(x,j,i.validityTolerance))},a.checkValidWithdraw=(e,t,s)=>{let a=e.coins;if(s>1)return!1;let o,d,c,l,u,p,h,m,g=r.FixedUtils.directCast(e.flatness),v=0,f=0,b=0,y=0,T=0,k=0;for(let[e,i]of Object.entries(a)){if(o=r.FixedUtils.directCast(i.normalizedBalance),l=s*o,d=r.FixedUtils.directCast(i.weight),c=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),c>l+1)return!1;if(u=o-c,u>=l)h=u-l,m=h*r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeIn)),p=l+m;else{if(h=l-u,m=0===h?0:h/r.FixedUtils.complement(r.FixedUtils.directCast(i.tradeFeeOut)),m>l+1)return!1;p=l-m}v+=d*Math.log(l),f+=d*l,T+=d*Math.log(u),k+=d*u,b+=d*Math.log(p),y+=d*p}v=Math.exp(v),T=Math.exp(T),b=Math.exp(b);let x=i.calcInvariantQuadratic(v,f,g),I=i.calcInvariantQuadratic(T,k,g),j=i.calcInvariantQuadratic(b,y,g);return I*(1+i.tolerance)>=x&&(n.Helpers.veryCloseInt(x,j,r.FixedUtils.fixedOneN)||n.Helpers.closeEnough(x,j,i.validityTolerance))},a.getEstimateOutGivenIn=(e,t,s,r)=>n.Helpers.blendedOperations.mulNBB(i.calcSpotPriceWithFees(e,t,s),r),a.getEstimateInGivenOut=(e,t,s,r)=>n.Helpers.blendedOperations.mulNBB(1/i.calcSpotPriceWithFees(e,t,s),r),a.getEstimateSwapFixedIn=(e,t,s)=>{let n,a,o,d,c=e.coins,l=i.calcSpotPriceBody(e),u=r.FixedUtils.directCast(e.flatness),p=0,h=0;for(let[e,i]of Object.entries(c))n=r.FixedUtils.directCast(i.normalizedBalance),o=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),d=r.FixedUtils.castAndNormalize(i.decimalsScalar,s[e]||BigInt(0)),a=0===o?r.FixedUtils.directCast(i.weight)*(l+2*u*n)/(n*(1-r.FixedUtils.directCast(i.tradeFeeOut))):r.FixedUtils.directCast(i.weight)*(1-r.FixedUtils.directCast(i.tradeFeeIn))*(l+2*u*n)/n,p+=o*a,h+=d*a;return p/h},a.getEstimateSwapFixedOut=(e,t,s)=>{let n,a,o,d,c=e.coins,l=i.calcSpotPriceBody(e),u=r.FixedUtils.directCast(e.flatness),p=0,h=0;for(let[e,i]of Object.entries(c))n=r.FixedUtils.directCast(i.normalizedBalance),o=r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),d=r.FixedUtils.castAndNormalize(i.decimalsScalar,s[e]||BigInt(0)),a=0===o?r.FixedUtils.directCast(i.weight)*(l+2*u*n)/(n*(1-r.FixedUtils.directCast(i.tradeFeeOut))):r.FixedUtils.directCast(i.weight)*(1-r.FixedUtils.directCast(i.tradeFeeIn))*(l+2*u*n)/n,p+=o*a,h+=d*a;return h/p},a.getEstimateDepositFixedAmounts=(e,t)=>{let s,n,a,o,d,c=i.calcDepositFixedAmountsInitialEstimate(e,t),l=e.coins,u=i.calcSpotPriceBody(e),p=r.FixedUtils.directCast(e.flatness),h=0,m=0;for(let[e,i]of Object.entries(l))s=r.FixedUtils.directCast(i.normalizedBalance),n=r.FixedUtils.directCast(i.weight),a=s+r.FixedUtils.castAndNormalize(i.decimalsScalar,t[e]||BigInt(0)),d=a*c,o=d<s?n*(u+2*p*s)/(s*(1-r.FixedUtils.directCast(i.tradeFeeOut))):n*(1-r.FixedUtils.directCast(i.tradeFeeIn))*(u+2*p*s)/s,h+=s*o,m+=a*o;return h/m},a.getEstimateWithdrawFlpAmountsOut=(e,t,s)=>{let n,a,o,d,c,[l,u]=i.calcWithdrawFlpAmountsOutInitialEstimate(e,t,s),p=e.coins,h=i.calcSpotPriceBody(e)*s,m=r.FixedUtils.directCast(e.flatness),g=0,v=0;for(let[e,s]of Object.entries(p))n=r.FixedUtils.directCast(s.normalizedBalance),o=r.FixedUtils.directCast(s.weight),d=n+r.FixedUtils.castAndNormalize(s.decimalsScalar,t[e]||BigInt(0)),a=d*l,c=a<n?o*(h+2*m*n)/(n*(1-r.FixedUtils.directCast(s.tradeFeeOut))):o*(1-r.FixedUtils.directCast(s.tradeFeeIn))*(h+2*m*n)/n,g+=n*c,v+=d*c;return(1-s)*g/v}},929972:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ReferralVaultApi=void 0;const n=s(108979),r=s(941882),a=s(243333);class o{constructor(e){this.Provider=e,this.updateReferrerTx=e=>{try{const{tx:t,referrer:s}=e;if(t.blockData.sender&&a.Helpers.addLeadingZeroesToType(t.blockData.sender)===a.Helpers.addLeadingZeroesToType(s))return;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.packages.referralVault,o.constants.moduleNames.referralVault,"update_referrer_address"),typeArguments:[],arguments:[t.object(this.addresses.objects.referralVault),t.pure.address(s)]})}catch(e){}},this.withdrawRebateTx=e=>{const{tx:t}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.packages.referralVault,o.constants.moduleNames.referralVault,e.withTransfer?"withdraw_and_transfer":"withdraw_rebate"),typeArguments:[e.coinType],arguments:[t.object(this.addresses.objects.referralVault)]})},this.balanceOfRebateTx=e=>{const{tx:t}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.packages.referralVault,o.constants.moduleNames.referralVault,"balance_of"),typeArguments:[e.coinType],arguments:[t.object(this.addresses.objects.referralVault),t.pure.address(e.referrer)]})},this.referrerForTx=e=>{const{tx:t}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.packages.referralVault,o.constants.moduleNames.referralVault,"referrer_for"),typeArguments:[],arguments:[t.object(this.addresses.objects.referralVault),t.pure.address(e.referee)]})},this.hasReffererTx=e=>{const{tx:t}=e;return t.moveCall({target:a.Helpers.transactions.createTxTarget(this.addresses.packages.referralVault,o.constants.moduleNames.referralVault,"has_referrer"),typeArguments:[],arguments:[t.object(this.addresses.objects.referralVault),t.pure.address(e.referee)]})},this.fetchBalanceOfRebate=e=>i(this,void 0,void 0,(function*(){const t=new n.Transaction;this.balanceOfRebateTx(Object.assign(Object.assign({},e),{tx:t}));const s=yield this.Provider.Inspections().fetchFirstBytesFromTxOutput({tx:t});return a.Casting.bigIntFromBytes(s)})),this.fetchReferrer=e=>i(this,void 0,void 0,(function*(){const t=new n.Transaction;this.referrerForTx(Object.assign(Object.assign({},e),{tx:t}));const s=yield this.Provider.Inspections().fetchFirstBytesFromTxOutput({tx:t}),i=r.bcs.option(r.bcs.Address).parse(new Uint8Array(s));return null!=i?i:void 0}));const t=this.Provider.addresses.referralVault;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t}}t.ReferralVaultApi=o,o.constants={moduleNames:{referralVault:"referral_vault"}}},955954:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(730987),t)},730987:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ReferralVault=void 0;const n=s(601151);class r extends n.Caller{constructor(e,t){super(e,"referral-vault"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.ReferralVault();if(!t)throw new Error("missing AftermathApi Provider");return t}}getReferrer(e){return i(this,void 0,void 0,(function*(){return this.fetchApi(`${e.referee}/referrer`)}))}}t.ReferralVault=r,r.constants={}},683040:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RouterApi=void 0;const n=s(578230);class r{constructor(e){if(this.Provider=e,this.routerTradeEventType=()=>n.EventsApiHelpers.createEventType(this.addresses.packages.utils,r.constants.moduleNames.events,r.constants.eventNames.routerTrade),!this.Provider.addresses.router)throw new Error("not all required addresses have been set in provider");this.addresses=this.Provider.addresses.router,this.eventTypes={routerTrade:this.routerTradeEventType()},this.moveErrors={[this.addresses.packages.utils]:{[r.constants.moduleNames.protocolFee]:{1:"Protocol Fee Config Already Created",2:"Bad Epoch",3:"Not Normalized"},[r.constants.moduleNames.router]:{0:"Not Authorized",1:"Invalid Coin In",2:"Invalid Coin Out",4:"Invalid Previous Swap",5:"Invalid Slippage",6:"No Fees Paid"},[r.constants.moduleNames.version]:{0:"Invalid Version"},[r.constants.moduleNames.admin]:{0:"Not Authorized",1:"Already Authorized"}}}}fetchTradeEvents(e){return i(this,void 0,void 0,(function*(){throw new Error("move to indexer")}))}}t.RouterApi=r,r.constants={moduleNames:{router:"router",events:"events",protocolFee:"protocol_fee",version:"version",admin:"admin"},eventNames:{routerTrade:"SwapCompletedEvent"}}},947168:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RouterApiCasting=void 0;class s{}t.RouterApiCasting=s,s.routerTradeEventFromOnChain=e=>{const t=e.parsedJson;return{trader:t.swapper,coinInType:t.type_in,coinInAmount:BigInt(t.amount_in),coinOutType:t.type_out,coinOutAmount:BigInt(t.amount_out),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},450173:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(210658),t)},210658:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;const r=s(601151),a=s(108979);class o extends r.Caller{constructor(e){super(e,"router"),this.getVolume24hrs=()=>i(this,void 0,void 0,(function*(){return this.fetchApi("volume-24hrs")}))}getSupportedCoins(){return i(this,void 0,void 0,(function*(){return this.fetchApi("supported-coins")}))}searchSupportedCoins(e,t){return i(this,void 0,void 0,(function*(){return this.fetchApi(`supported-coins/${e.filter}`,void 0,t)}))}getCompleteTradeRouteGivenAmountIn(e,t){return i(this,void 0,void 0,(function*(){return this.fetchApi("trade-route",e,t)}))}getCompleteTradeRouteGivenAmountOut(e,t){return i(this,void 0,void 0,(function*(){return this.fetchApi("trade-route",e,t)}))}getTransactionForCompleteTradeRoute(e){return i(this,void 0,void 0,(function*(){return this.fetchApiTransaction("transactions/trade",e)}))}addTransactionForCompleteTradeRoute(e){return i(this,void 0,void 0,(function*(){const{tx:t}=e,s=n(e,["tx"]),{tx:i,coinOutId:r}=yield this.fetchApi("transactions/add-trade",Object.assign(Object.assign({},s),{serializedTx:t.serialize()}));return{tx:a.Transaction.from(i),coinOutId:r}}))}getInteractionEvents(e){return i(this,void 0,void 0,(function*(){return this.fetchApiIndexerEvents("events-by-user",e)}))}}t.Router=o,o.constants={maxExternalFeePercentage:.5}},901406:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},278614:function(e,t,s){var i,n=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StakingApi=void 0;const r=s(108979),a=s(8900),o=s(925570),d=s(243333),c=s(578230),l=s(302416),u=s(851693),p=s(646074);class h{constructor(e){if(this.Provider=e,this.stakeTx=e=>{const{tx:t,suiCoin:s,withTransfer:n}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"request_stake"+(n?"_and_keep":"")),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe),t.object(u.Sui.constants.addresses.suiSystemStateId),t.object(this.addresses.objects.referralVault),"string"==typeof s?t.object(s):s,t.pure.address(e.validatorAddress)]})},this.unstakeTx=e=>{const{tx:t,afSuiCoin:s}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"request_unstake"),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe),"string"==typeof s?t.object(s):s]})},this.atomicUnstakeTx=e=>{const{tx:t,afSuiCoin:s,withTransfer:n}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"request_unstake_atomic"+(n?"_and_keep":"")),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe),t.object(this.addresses.objects.referralVault),t.object(this.addresses.objects.treasury),"string"==typeof s?t.object(s):s]})},this.requestStakeStakedSuiVecTx=e=>{const{tx:t,stakedSuiIds:s,withTransfer:n}=e,r=t.makeMoveVec({elements:s.map((e=>t.object(e)))});return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"request_stake_staked_sui_vec"+(n?"_and_keep":"")),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe),t.object(u.Sui.constants.addresses.suiSystemStateId),t.object(this.addresses.objects.referralVault),r,t.pure.address(e.validatorAddress)]})},this.epochWasChangedTx=e=>{const{tx:t}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"epoch_was_changed"),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe),t.object(u.Sui.constants.addresses.suiSystemStateId),t.object(this.addresses.objects.referralVault),t.object(this.addresses.objects.treasury),t.pure.u64(BigInt(1e3))]})},this.afSuiToSuiExchangeRateTx=e=>{const{tx:t}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"afsui_to_sui_exchange_rate"),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe)]})},this.suiToAfSuiExchangeRateTx=e=>{const{tx:t}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"sui_to_afsui_exchange_rate"),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe)]})},this.totalSuiAmountTx=e=>{const{tx:t}=e;return t.moveCall({target:a.AftermathApi.helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"total_sui_amount"),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault)]})},this.afSuiToSuiTx=e=>{const{tx:t}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"afsui_to_sui"),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe),t.pure.u64(e.afSuiAmount)]})},this.suiToAfSuiTx=e=>{const{tx:t}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"sui_to_afsui"),typeArguments:[],arguments:[t.object(this.addresses.objects.stakedSuiVault),t.object(this.addresses.objects.safe),t.pure.u64(e.suiAmount)]})},this.updateValidatorFeeTx=e=>{const{tx:t,validatorOperationCapId:s}=e;return t.moveCall({target:d.Helpers.transactions.createTxTarget(this.addresses.packages.lsd,i.constants.moduleNames.stakedSuiVault,"update_validator_fee"),typeArguments:[],arguments:["string"==typeof s?t.object(s):s,t.object(this.addresses.objects.stakedSuiVault),t.pure.u64(e.newFee)]})},this.fetchBuildStakeTx=e=>n(this,void 0,void 0,(function*(){const{referrer:t,externalFee:s}=e;s&&i.assertValidExternalFee(s);const n=new r.Transaction;n.setSender(e.walletAddress),t&&this.Provider.ReferralVault().updateReferrerTx({tx:n,referrer:t});const a=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:n,walletAddress:e.walletAddress,coinType:l.Coin.constants.suiCoinType,coinAmount:e.suiStakeAmount,isSponsoredTx:e.isSponsoredTx});if(s){const t=BigInt(Math.floor(Number(e.suiStakeAmount)*s.feePercentage)),i=n.splitCoins(a,[t]);n.transferObjects([i],s.recipient)}const o=this.stakeTx(Object.assign(Object.assign({tx:n},e),{suiCoin:a}));return n.transferObjects([o],e.walletAddress),n})),this.fetchBuildUnstakeTx=e=>n(this,void 0,void 0,(function*(){const{referrer:t,externalFee:s}=e;s&&i.assertValidExternalFee(s);const n=new r.Transaction;n.setSender(e.walletAddress),t&&this.Provider.ReferralVault().updateReferrerTx({tx:n,referrer:t});const a=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:n,walletAddress:e.walletAddress,coinType:this.coinTypes.afSui,coinAmount:e.afSuiUnstakeAmount});if(s){const t=BigInt(Math.floor(Number(e.afSuiUnstakeAmount)*s.feePercentage)),i=n.splitCoins(a,[t]);n.transferObjects([i],s.recipient)}if(e.isAtomic){const t=this.atomicUnstakeTx(Object.assign(Object.assign({tx:n},e),{afSuiCoin:a}));n.transferObjects([t],e.walletAddress)}else this.unstakeTx(Object.assign(Object.assign({tx:n},e),{afSuiCoin:a}));return n})),this.fetchBuildStakeStakedSuiTx=e=>n(this,void 0,void 0,(function*(){const{referrer:t}=e,s=new r.Transaction;s.setSender(e.walletAddress),t&&this.Provider.ReferralVault().updateReferrerTx({tx:s,referrer:t});const i=this.requestStakeStakedSuiVecTx(Object.assign({tx:s},e));return s.transferObjects([i],e.walletAddress),s})),this.buildUpdateValidatorFeeTx=e=>n(this,void 0,void 0,(function*(){const t=new r.Transaction;return t.setSender(e.walletAddress),this.updateValidatorFeeTx(Object.assign(Object.assign({},e),{tx:t,newFee:d.Casting.numberToFixedBigInt(e.newFeePercentage)})),t})),this.buildEpochWasChangedTx=d.Helpers.transactions.createBuildTxFunc(this.epochWasChangedTx),this.stakedEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.events,i.constants.moduleNames.events,i.constants.eventNames.staked),this.unstakeRequestedEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.events,i.constants.moduleNames.events,i.constants.eventNames.unstakeRequested),this.unstakedEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.events,i.constants.moduleNames.events,i.constants.eventNames.unstaked),this.epochWasChangedEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.events,i.constants.moduleNames.events,i.constants.eventNames.epochWasChanged),!this.Provider.addresses.staking)throw new Error("not all required addresses have been set in provider");this.addresses=this.Provider.addresses.staking,this.eventTypes={staked:this.stakedEventType(),unstakeRequested:this.unstakeRequestedEventType(),unstaked:this.unstakedEventType(),epochWasChanged:this.epochWasChangedEventType()},this.coinTypes={afSui:`${this.addresses.packages.afsui}::afsui::AFSUI`},this.objectTypes={unverifiedValidatorOperationCap:`${this.addresses.packages.events}::validator::UnverifiedValidatorOperationCap`},this.moveErrors={[this.addresses.packages.lsd]:{[i.constants.moduleNames.stakedSuiVault]:{0:"Version Incompatibility",1:"Wrong Package Version",2:"Deprecated"},[i.constants.moduleNames.sort]:{1:"Different Inputs Length",2:"Dummy Error"},[i.constants.moduleNames.calculations]:{0:"Invalid Percentage"},[i.constants.moduleNames.actions]:{0:"Epoch Change Has Not Been Treated",1:"Epoch Change Has Already Been Treated",2:"Validator Is Not Active",3:"Less Than Minimum Staking Threshold",4:"Insufficient Validator History",5:"Empty Vector",6:"Insufficient Sui Reserves",7:"Insufficient Balance afSUI Coin Provided"},[i.constants.moduleNames.receipt]:{0:"Not Enough Amount In Receipt",1:"Try To Burn Non Zero Receipt"},[i.constants.moduleNames.stakedSuiVaultState]:{1:"Invalid Percentage",2:"Invalid Atomic Unstake Fees Values",3:"Invalid Validator",4:"Validator Is Not Active",5:"Invalid Operation Cap",6:"Invalid Validator Fee"}}}}}t.StakingApi=h,i=h,h.constants={moduleNames:{actions:"actions",events:"events",stakedSuiVault:"staked_sui_vault",stakedSuiVaultState:"staked_sui_vault_state",routerWrapper:"router",sort:"sort",receipt:"receipt",calculations:"calculations"},eventNames:{staked:"StakedEvent",unstaked:"UnstakedEvent",unstakeRequested:"UnstakeRequestedEvent",epochWasChanged:"EpochWasChangedEvent"}},h.updateStakingPositionsFromEvent=e=>{const t=e.stakingPositions,s=e.event;let n=[];const r=t.filter(o.isUnstakePosition),a=(0,o.isUnstakeEvent)(s)?i.updateUnstakePositionsFromEvent({event:s,unstakePositions:r}):r,d=t.filter(o.isStakePosition);return n=[...a,...(0,o.isStakeEvent)(s)?[...d,s]:d],n.sort(((e,t)=>{var s,i;return(null!==(s=t.timestamp)&&void 0!==s?s:0)-(null!==(i=e.timestamp)&&void 0!==i?i:0)}))},h.assertValidExternalFee=e=>{if(e.feePercentage>=p.Staking.constants.bounds.maxExternalFeePercentage)throw new Error(`external fee percentage exceeds max of ${100*p.Staking.constants.bounds.maxExternalFeePercentage}%`);if(e.feePercentage<=0)throw new Error("external fee percentage must be greater than 0")},h.updateUnstakePositionsFromEvent=e=>{const t=e.unstakePositions.findIndex((t=>t.afSuiId===e.event.afSuiId));if(t<0)return e.event.type.includes(i.constants.eventNames.unstakeRequested)?[Object.assign(Object.assign({},e.event),{state:"REQUEST"}),...e.unstakePositions]:[Object.assign(Object.assign({},e.event),{state:"SUI_MINTED"}),...e.unstakePositions];const s=e.unstakePositions[t];let n;if(e.event.type.includes(i.constants.eventNames.unstaked)&&(n=Object.assign(Object.assign({},e.event),{state:"SUI_MINTED",epoch:s.epoch})),e.event.type.includes(i.constants.eventNames.unstakeRequested)&&(n=Object.assign(Object.assign({},e.event),{state:"REQUEST",epoch:s.epoch})),!n)return e.unstakePositions;let r=[...e.unstakePositions];return r[t]=n,r}},825309:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StakingApiCasting=void 0;const i=s(243333),n=s(845963);class r{}t.StakingApiCasting=r,r.validatorOperationCapObjectFromSuiObjectResponse=e=>{const t=i.Helpers.getObjectType(e),s=i.Helpers.getObjectFields(e);return{objectType:t,objectId:i.Helpers.getObjectId(e),authorizerValidatorAddress:i.Helpers.addLeadingZeroesToType(s.authorizer_validator_address)}},r.stakedSuiVaultStateObjectFromSuiObjectResponse=e=>{const t=i.Helpers.getObjectId(e),s=i.Helpers.getObjectType(e),n=i.Helpers.getObjectFields(e);return{objectId:t,objectType:s,atomicUnstakeSuiReservesTargetValue:BigInt(n.protocol_config.fields.atomic_unstake_sui_reserves_target_value),atomicUnstakeSuiReserves:BigInt(n.atomic_unstake_sui_reserves),minAtomicUnstakeFee:BigInt(n.protocol_config.fields.atomic_unstake_protocol_fee.fields.min_fee),maxAtomicUnstakeFee:BigInt(n.protocol_config.fields.atomic_unstake_protocol_fee.fields.max_fee),totalSuiAmount:BigInt(n.total_sui_amount),totalRewardsAmount:BigInt(n.total_rewards_amount),activeEpoch:BigInt(n.active_epoch)}},r.stakedEventFromOnChain=e=>{const t=e.parsedJson;return{suiId:i.Helpers.addLeadingZeroesToType(t.sui_id),stakedSuiId:i.Helpers.addLeadingZeroesToType(t.staked_sui_id),staker:i.Helpers.addLeadingZeroesToType(t.staker),validatorAddress:i.Helpers.addLeadingZeroesToType(t.validator),epoch:BigInt(t.epoch),suiStakeAmount:BigInt(t.sui_amount),validatorFee:n.FixedUtils.directCast(BigInt(t.validator_fee)),isRestaked:t.is_restaked,referrer:t.referrer?t.referrer:void 0,afSuiId:i.Helpers.addLeadingZeroesToType(t.afsui_id),afSuiAmount:BigInt(t.afsui_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.unstakedEventFromOnChain=e=>{const t=e.parsedJson;return{afSuiId:i.Helpers.addLeadingZeroesToType(t.afsui_id),suiId:i.Helpers.addLeadingZeroesToType(t.sui_id),requester:i.Helpers.addLeadingZeroesToType(t.requester),epoch:BigInt(t.epoch),providedAfSuiAmount:BigInt(t.provided_afsui_amount),returnedSuiAmount:BigInt(t.returned_sui_amount),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.unstakeRequestedEventFromOnChain=e=>{const t=e.parsedJson;return{afSuiId:i.Helpers.addLeadingZeroesToType(t.afsui_id),providedAfSuiAmount:BigInt(t.provided_afsui_amount),requester:i.Helpers.addLeadingZeroesToType(t.requester),epoch:BigInt(t.epoch),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},174106:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(799167),t)},799167:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Staking=void 0;const n=s(601151),r=s(243333);class a extends n.Caller{constructor(e,t){super(e,"staking"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Staking();if(!t)throw new Error("missing AftermathApi Provider");return t}}getActiveValidators(){return i(this,void 0,void 0,(function*(){return this.fetchApi("active-validators")}))}getValidatorApys(){return i(this,void 0,void 0,(function*(){return this.fetchApi("validator-apys")}))}getValidatorConfigs(){return i(this,void 0,void 0,(function*(){return this.fetchApi("validator-configs")}))}getStakingPositions(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("staking-positions",e)}))}getDelegatedStakes(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("delegated-stakes",e)}))}getValidatorOperationCaps(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("validator-operation-caps",e)}))}getStakeTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildStakeTx(e)}))}getUnstakeTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildUnstakeTx(e)}))}getStakeStakedSuiTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildStakeStakedSuiTx(e)}))}getUpdateValidatorFeeTransaction(e){return this.useProvider().buildUpdateValidatorFeeTx(e)}getCrankAfSuiTransaction(e){return this.useProvider().buildEpochWasChangedTx(e)}getSuiTvl(){return i(this,void 0,void 0,(function*(){return this.fetchApi("sui-tvl")}))}getAfSuiToSuiExchangeRate(){return i(this,void 0,void 0,(function*(){return this.fetchApi("afsui-exchange-rate")}))}getStakedSuiVaultState(){return i(this,void 0,void 0,(function*(){return this.fetchApi("staked-sui-vault-state")}))}getApy(){return i(this,void 0,void 0,(function*(){return this.fetchApi("apy")}))}getHistoricalApy(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("historical-apy",e)}))}static calcAtomicUnstakeFee(e){const{stakedSuiVaultState:t}=e;if(t.atomicUnstakeSuiReserves>=t.atomicUnstakeSuiReservesTargetValue)return r.Casting.bigIntToFixedNumber(t.minAtomicUnstakeFee);{const e=t.maxAtomicUnstakeFee-t.minAtomicUnstakeFee;return r.Casting.bigIntToFixedNumber(t.maxAtomicUnstakeFee-e*t.atomicUnstakeSuiReserves/t.atomicUnstakeSuiReservesTargetValue)}}}t.Staking=a,a.constants={fees:{protocolUnstake:.05,defaultValidator:0,maxValidator:.05},bounds:{minStake:BigInt("1000000000"),minUnstake:BigInt("1000000000"),maxExternalFeePercentage:.5},defaultValidatorFee:0}},925570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isUnstakePosition=t.isStakePosition=t.isUnstakeEvent=t.isStakeEvent=t.isSuiDelegatedStake=void 0,t.isSuiDelegatedStake=e=>"stakeRequestEpoch"in e&&"stakeActiveEpoch"in e&&"principal"in e&&"stakingPool"in e,t.isStakeEvent=e=>"staker"in e,t.isUnstakeEvent=e=>!(0,t.isStakeEvent)(e),t.isStakePosition=e=>"stakedSuiId"in e,t.isUnstakePosition=e=>!(0,t.isStakePosition)(e)},615344:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SuiApi=void 0;const n=s(243333);t.SuiApi=class{constructor(e){this.Provider=e,this.fetchSystemState=()=>i(this,void 0,void 0,(function*(){const e=yield this.Provider.provider.getLatestSuiSystemState(),t=e.activeValidators.map((e=>Object.assign(Object.assign({},e),{suiAddress:n.Helpers.addLeadingZeroesToType(e.suiAddress)})));return Object.assign(Object.assign({},e),{activeValidators:t})}))}}},851693:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(314812),t)},314812:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Sui=void 0;const n=s(601151);class r extends n.Caller{constructor(e,t){super(e,"sui"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.Sui();if(!t)throw new Error("missing AftermathApi Provider");return t}}getSystemState(){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchSystemState()}))}}t.Sui=r,r.constants={addresses:{zero:"0x0000000000000000000000000000000000000000000000000000000000000000",suiPackageId:"0x0000000000000000000000000000000000000000000000000000000000000002",suiSystemStateId:"0x0000000000000000000000000000000000000000000000000000000000000005",suiClockId:"0x0000000000000000000000000000000000000000000000000000000000000006"}}},666030:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SuiFrensApi=void 0;const n=s(108979),r=s(941882),a=s(897399),o=s(308041),d=s(243333),c=s(578230),l=s(314812),u=s(826462);class p{constructor(e){this.Provider=e,this.fetchMixingLimitsAndLastEpochMixeds=e=>i(this,void 0,void 0,(function*(){const t=new n.Transaction;this.devInspectMixLimitAndLastEpochMixedMulTx(Object.assign(Object.assign({},e),{tx:t}));const[s,i]=yield this.Provider.Inspections().fetchAllBytesFromTxOutput({tx:t}),a=r.bcs.vector(r.bcs.option(r.bcs.u8())).parse(new Uint8Array(s)),o=r.bcs.vector(r.bcs.option(r.bcs.u64())).parse(new Uint8Array(i));return a.map(((e,t)=>({mixLimit:null==e?void 0:BigInt(e),lastEpochMixed:void 0===o[t]?void 0:BigInt(o[t])})))})),this.fetchMixingLimit=e=>i(this,void 0,void 0,(function*(){if(e.suiFrenType===this.objectTypes.bullshark)return;const t=new n.Transaction;this.mixingLimitTx(Object.assign({tx:t},e));const s=yield this.Provider.Inspections().fetchFirstBytesFromTxOutput({tx:t}),i=r.bcs.option(r.bcs.u8()).parse(new Uint8Array(s));return null==i?void 0:BigInt(i)})),this.fetchLastEpochMixed=e=>i(this,void 0,void 0,(function*(){if(e.suiFrenType===this.objectTypes.bullshark)return;const t=new n.Transaction;this.lastEpochMixedTx(Object.assign({tx:t},e));const s=yield this.Provider.Inspections().fetchFirstBytesFromTxOutput({tx:t}),i=r.bcs.option(r.bcs.u64()).parse(new Uint8Array(s));return null==i?void 0:BigInt(i)})),this.fetchStakedSuiFrenMetadataIds=e=>i(this,void 0,void 0,(function*(){const{suiFrenIds:t}=e,s=new n.Transaction;this.devInspectMetadataObjectIdMulTx({tx:s,suiFrenIds:t});const i=yield this.Provider.Inspections().fetchFirstBytesFromTxOutput({tx:s});return r.bcs.vector(r.bcs.Address).parse(new Uint8Array(i))})),this.fetchHarvestSuiFrenFeesEvents=e=>this.Provider.Events().fetchCastEventsWithCursor(Object.assign(Object.assign({},e),{query:{MoveEventType:this.eventTypes.harvestSuiFrenFees},eventFromEventOnChain:d.Casting.suiFrens.harvestSuiFrenFeesEventFromOnChain})),this.fetchMixSuiFrensEvents=e=>this.Provider.Events().fetchCastEventsWithCursor(Object.assign(Object.assign({},e),{query:{MoveEventType:this.eventTypes.mixSuiFrens},eventFromEventOnChain:d.Casting.suiFrens.mixSuiFrensEventFromOnChain})),this.fetchStakeSuiFrenEvents=e=>this.Provider.Events().fetchCastEventsWithCursor(Object.assign(Object.assign({},e),{query:{MoveEventType:this.eventTypes.stakeSuiFren},eventFromEventOnChain:d.Casting.suiFrens.stakeSuiFrenEventFromOnChain})),this.fetchUnstakeSuiFrenEvents=e=>this.Provider.Events().fetchCastEventsWithCursor(Object.assign(Object.assign({},e),{query:{MoveEventType:this.eventTypes.unstakeSuiFren},eventFromEventOnChain:d.Casting.suiFrens.unstakeSuiFrenEventFromOnChain})),this.fetchCapyLabsApp=()=>i(this,void 0,void 0,(function*(){return this.Provider.Objects().fetchCastObject({objectId:this.addresses.objects.capyLabsApp,objectFromSuiObjectResponse:d.Casting.suiFrens.capyLabsAppObjectFromSuiObjectResponse})})),this.fetchSuiFrenVaultStateV1Object=()=>i(this,void 0,void 0,(function*(){return this.Provider.Objects().fetchCastObject({objectId:this.addresses.objects.suiFrensVaultStateV1,objectFromSuiObjectResponse:d.Casting.suiFrens.suiFrenVaultStateV1ObjectFromSuiObjectResponse})})),this.fetchSuiFrens=e=>i(this,void 0,void 0,(function*(){const{suiFrenIds:t}=e,s=yield this.Provider.Objects().fetchCastObjectBatch({objectIds:t,objectFromSuiObjectResponse:d.Casting.suiFrens.partialSuiFrenObjectFromSuiObjectResponse,options:{showDisplay:!0,showType:!0,showContent:!0}});return this.fetchCompletePartialSuiFrenObjects({partialSuiFrens:s,isStaked:!1})})),this.fetchOwnedSuiFrens=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e,[s,i]=yield Promise.all([this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.suiFren,objectFromSuiObjectResponse:d.Casting.suiFrens.partialSuiFrenObjectFromSuiObjectResponse,withDisplay:!0}),this.fetchOwnedPartialSuiFrenBullsharks(e)]);return yield this.fetchCompletePartialSuiFrenObjects({partialSuiFrens:[...s,...i],isStaked:!1})})),this.fetchStakedSuiFrens=e=>i(this,void 0,void 0,(function*(){const{stakedSuiFrenIds:t}=e,s=yield this.Provider.Objects().fetchCastObjectBatch({objectIds:t,objectFromSuiObjectResponse:d.Casting.suiFrens.partialSuiFrenAndStakedSuiFrenMetadataV1ObjectFromSuiObjectResponse,options:{showDisplay:!0,showType:!0,showContent:!0}});return(yield this.fetchCompletePartialSuiFrenObjects({partialSuiFrens:s.map((e=>e.partialSuiFren)),isStaked:!0})).map(((e,t)=>({suiFren:e,metadata:s[t].stakedSuiFrenMetadata})))})),this.fetchStakedSuiFrensDynamicFields=e=>this.Provider.DynamicFields().fetchCastDynamicFieldsOfTypeWithCursor(Object.assign(Object.assign({},e),{parentObjectId:this.addresses.objects.suiFrensVaultStateV1MetadataTable,objectsFromObjectIds:e=>this.fetchStakedSuiFrens({stakedSuiFrenIds:e}),dynamicFieldType:this.objectTypes.stakedSuiFrenMetadataV1})),this.fetchAccessoriesForSuiFren=e=>i(this,void 0,void 0,(function*(){return yield this.Provider.DynamicFields().fetchCastAllDynamicFieldsOfType({parentObjectId:e.suiFrenId,objectsFromObjectIds:e=>this.fetchAccessories({objectIds:e}),dynamicFieldType:this.objectTypes.suiFrenAccessory})})),this.fetchOwnedAccessories=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e;return yield this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.suiFrenAccessory,objectFromSuiObjectResponse:d.Casting.suiFrens.accessoryObjectFromSuiObjectResponse,withDisplay:!0})})),this.fetchAccessories=e=>i(this,void 0,void 0,(function*(){const{objectIds:t}=e;return this.Provider.Objects().fetchCastObjectBatch({objectIds:t,objectFromSuiObjectResponse:d.Casting.suiFrens.accessoryObjectFromSuiObjectResponse,options:{showDisplay:!0,showType:!0,showContent:!0}})})),this.fetchStakedSuiFrensDynamicFieldsWithFilters=e=>i(this,void 0,void 0,(function*(){var t;const{attributes:s}=e,i=null!==(t=e.limit)&&void 0!==t?t:25,n=yield this.Provider.DynamicFields().fetchDynamicFieldsUntil(Object.assign(Object.assign({},e),{fetchFunc:e=>this.fetchStakedSuiFrensDynamicFields(e),isComplete:e=>this.filterSuiFrensWithAttributes({suiFrens:e.map((e=>e.suiFren)),attributes:s}).length>=i})),r=this.filterSuiFrensWithAttributes({suiFrens:n.dynamicFieldObjects.map((e=>e.suiFren)),attributes:s}),a=n.dynamicFieldObjects.filter((e=>r.slice(0,i).some((t=>t.objectId===e.suiFren.objectId))));return{nextCursor:i<r.length?r[i].objectId:n.nextCursor,dynamicFieldObjects:a}})),this.fetchOwnedStakedSuiFrens=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t}=e,s=yield this.Provider.Objects().fetchCastObjectsOwnedByAddressOfType({walletAddress:t,objectType:this.objectTypes.stakedSuiFrenPosition,objectFromSuiObjectResponse:d.Casting.suiFrens.stakedSuiFrenPositionFromSuiObjectResponse}),i=yield this.fetchStakedSuiFrenMetadataIds({suiFrenIds:s.map((e=>e.suiFrenId))});return(yield this.fetchStakedSuiFrens({stakedSuiFrenIds:i})).map(((e,t)=>Object.assign(Object.assign({},e),{position:s[t]})))})),this.devInspectMetadataObjectIdMulTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"dev_inspect_metadata_object_id_mul"),typeArguments:[],arguments:[t.object(this.addresses.objects.suiFrensVault),t.pure(r.bcs.vector(r.bcs.Address).serialize(e.suiFrenIds))]})},this.devInspectMixLimitAndLastEpochMixedMulTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVaultCapyLabsExtension,p.constants.moduleNames.suiFrensVaultCapyLabsExtension.capyLabs,"dev_inspect_mixing_limit_and_last_epoch_mixed_mul"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVaultCapyLabsExtension),t.object(this.addresses.objects.suiFrensVault),t.pure(r.bcs.vector(r.bcs.Address).serialize(e.suiFrenIds))]})},this.mixingLimitTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrens,p.constants.moduleNames.capyLabs.capyLabs,"mixing_limit"),typeArguments:[e.suiFrenType],arguments:[t.object(e.suiFrenId)]})},this.lastEpochMixedTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrens,p.constants.moduleNames.capyLabs.capyLabs,"last_epoch_mixed"),typeArguments:[e.suiFrenType],arguments:[t.object(e.suiFrenId)]})},this.mixAndKeepTx=e=>{const{tx:t,suiPaymentCoinId:s}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVaultCapyLabsExtension,p.constants.moduleNames.suiFrensVaultCapyLabsExtension.capyLabs,"mix_and_keep"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVaultCapyLabsExtension),t.object(this.addresses.objects.capyLabsApp),t.object(this.addresses.objects.suiFrensVault),t.object(e.parentOneId),t.object(e.parentTwoId),"string"==typeof s?t.object(s):s,t.object(l.Sui.constants.addresses.suiClockId)]})},this.mixWithStakedAndKeepTx=e=>{const{tx:t,suiPaymentCoinId:s}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVaultCapyLabsExtension,p.constants.moduleNames.suiFrensVaultCapyLabsExtension.capyLabs,"mix_with_staked_and_keep"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVaultCapyLabsExtension),t.object(this.addresses.objects.capyLabsApp),t.object(this.addresses.objects.suiFrensVault),t.object(e.nonStakedParentId),t.object(e.stakedParentId),"string"==typeof s?t.object(s):s,t.object(l.Sui.constants.addresses.suiClockId)]})},this.mixStakedWithStakedAndKeepTx=e=>{const{tx:t,suiPaymentCoinId:s}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVaultCapyLabsExtension,p.constants.moduleNames.suiFrensVaultCapyLabsExtension.capyLabs,"mix_staked_with_staked_and_keep"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVaultCapyLabsExtension),t.object(this.addresses.objects.capyLabsApp),t.object(this.addresses.objects.suiFrensVault),t.object(e.parentOneId),t.object(e.parentTwoId),"string"==typeof s?t.object(s):s,t.object(l.Sui.constants.addresses.suiClockId)]})},this.stakeAndKeepTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVaultCapyLabsExtension,p.constants.moduleNames.suiFrensVaultCapyLabsExtension.capyLabs,"stake_and_keep"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVaultCapyLabsExtension),t.object(this.addresses.objects.capyLabsApp),t.object(this.addresses.objects.suiFrensVault),t.object(e.suiFrenId),t.pure.bool(e.autoStakeFees),t.pure.u64(e.baseFee),t.pure.u64(e.feeIncrementPerMix),t.pure.u8(Number(e.minRemainingMixesToKeep))]})},this.unstakeAndKeepTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVaultCapyLabsExtension,p.constants.moduleNames.suiFrensVaultCapyLabsExtension.capyLabs,"unstake_and_keep"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVaultCapyLabsExtension),t.object(this.addresses.objects.suiFrensVault),t.object(e.stakedPositionId)]})},this.beginHarvestTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"begin_harvest"),typeArguments:[],arguments:[]})},this.harvestTx=e=>{const{tx:t,harvestFeesEventMetadataId:s}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"harvest"),typeArguments:[],arguments:[t.object(this.addresses.objects.suiFrensVault),t.object(e.stakedPositionId),"string"==typeof s?t.object(s):s]})},this.endHarvestTx=e=>{const{tx:t,harvestFeesEventMetadataId:s}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"end_harvest"),typeArguments:[],arguments:["string"==typeof s?t.object(s):s]})},this.addAccessoryTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"add_accessory"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVault),t.object(e.suiFrenId),t.object(e.accessoryId)]})},this.addAccessoryToOwnedSuiFrenTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"add_accessory_to_owned_suifren"),typeArguments:[e.suiFrenType],arguments:[t.object(e.suiFrenId),t.object(e.accessoryId)]})},this.removeAccessoryAndKeepTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"remove_accessory_and_keep"),typeArguments:[e.suiFrenType],arguments:[t.object(this.addresses.objects.suiFrensVault),t.object(e.stakedPositionId),t.object(e.accessoryType)]})},this.removeAccessoryFromOwnedSuiFrenAndKeepTx=e=>{const{tx:t}=e;return t.moveCall({target:o.Helpers.transactions.createTxTarget(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.vault,"remove_accessory_from_owned_suifren_and_keep"),typeArguments:[e.suiFrenType],arguments:[t.object(e.suiFrenId),t.object(e.accessoryType)]})},this.fetchStakeTx=o.Helpers.transactions.createBuildTxFunc((e=>this.stakeAndKeepTx(Object.assign(Object.assign({},e),{autoStakeFees:!0})))),this.fetchUnstakeTx=o.Helpers.transactions.createBuildTxFunc(this.unstakeAndKeepTx),this.fetchBuildMixTx=e=>i(this,void 0,void 0,(function*(){const{walletAddress:t,suiFrenParentOne:s,suiFrenParentTwo:i,suiFrenType:r,baseFee:o,isSponsoredTx:d}=e,c=new n.Transaction;c.setSender(t);const l=o+u.SuiFrens.calcTotalInternalMixFee({mixFee1:s.mixFee,mixFee2:i.mixFee}),p=yield this.Provider.Coin().fetchCoinWithAmountTx({tx:c,walletAddress:t,coinType:a.Coin.constants.suiCoinType,coinAmount:l,isSponsoredTx:d}),h=void 0!==s.mixFee,m=void 0!==i.mixFee,g=s.objectId,v=i.objectId;if(h&&m)this.mixStakedWithStakedAndKeepTx({tx:c,parentOneId:g,parentTwoId:v,suiPaymentCoinId:p,suiFrenType:r});else if(h||m){const[e,t]=h?[v,g]:[g,v];this.mixWithStakedAndKeepTx({tx:c,nonStakedParentId:e,stakedParentId:t,suiPaymentCoinId:p,suiFrenType:r})}else this.mixAndKeepTx({tx:c,parentOneId:g,parentTwoId:v,suiPaymentCoinId:p,suiFrenType:r});return c})),this.fetchBuildHarvestFeesTx=e=>i(this,void 0,void 0,(function*(){const{stakedPositionIds:t}=e,s=new n.Transaction;s.setSender(e.walletAddress);const i=this.beginHarvestTx({tx:s});let r=[];for(const e of t){const t=this.harvestTx({tx:s,stakedPositionId:e,harvestFeesEventMetadataId:i});r.push(t)}const a=r[0];return r.length>1&&s.mergeCoins(a,r.slice(1)),s.transferObjects([a],e.walletAddress),this.endHarvestTx({tx:s,harvestFeesEventMetadataId:i}),s})),this.fetchBuildAddAccessoryTx=e=>e.isOwned?o.Helpers.transactions.createBuildTxFunc(this.addAccessoryToOwnedSuiFrenTx)(e):o.Helpers.transactions.createBuildTxFunc(this.addAccessoryTx)(e),this.fetchBuildRemoveAccessoryTx=e=>"suiFrenId"in e?o.Helpers.transactions.createBuildTxFunc(this.removeAccessoryFromOwnedSuiFrenAndKeepTx)(e):o.Helpers.transactions.createBuildTxFunc(this.removeAccessoryAndKeepTx)(e),this.fetchSuiFrenStats=()=>i(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([this.fetchSuiFrenVaultStateV1Object(),this.Provider.Events().fetchEventsWithinTime({fetchEventsFunc:this.fetchMixSuiFrensEvents,timeUnit:"hour",time:24})]),s=o.Helpers.sumBigInt(t.map((e=>e.fee)));return{totalMixes:e.totalMixes,currentTotalStaked:e.stakedSuiFrens,mixingVolume24hr:t.length,mixingFees24hr:s}})),this.filterSuiFrensWithAttributes=e=>{const{suiFrens:t,attributes:s}=e;return Object.keys(s).length<=0?t:t.filter((e=>Object.entries(s).every((([t,s])=>Object.entries(e.attributes).some((([e,i])=>t.toLowerCase()===e.toLowerCase()&&s.toLowerCase()===i.toLowerCase()))))))},this.fetchCompletePartialSuiFrenObjects=e=>i(this,void 0,void 0,(function*(){const{partialSuiFrens:t,isStaked:s}=e;if(!s)return Promise.all(t.map((e=>this.fetchNonStakedCompletePartialSuiFrenObject({partialSuiFren:e}))));if(t.length<=0)return[];const[i,n]=o.Helpers.bifilter(t,(e=>e.objectType.includes(this.objectTypes.bullshark))),r=i.map((()=>({mixLimit:void 0,lastEpochMixed:void 0}))),d=yield this.fetchMixingLimitsAndLastEpochMixeds({suiFrenIds:n.map((e=>e.objectId)),suiFrenType:a.Coin.getInnerCoinType(n[0].objectType)});return[...r.map(((e,t)=>Object.assign(Object.assign({},i[t]),e))),...d.map(((e,t)=>Object.assign(Object.assign({},n[t]),e)))]})),this.fetchNonStakedCompletePartialSuiFrenObject=e=>i(this,void 0,void 0,(function*(){const{partialSuiFren:t}=e,s=t.objectId,i=a.Coin.getInnerCoinType(t.objectType),[n,r]=yield Promise.all([this.fetchMixingLimit({suiFrenId:s,suiFrenType:i}),this.fetchLastEpochMixed({suiFrenId:s,suiFrenType:i})]);return Object.assign(Object.assign({},t),{mixLimit:n,lastEpochMixed:r})})),this.fetchOwnedPartialSuiFrenBullsharks=e=>i(this,void 0,void 0,(function*(){const t=yield this.Provider.Nfts().fetchOwnedKioskOwnerCaps(e);return(yield Promise.all(t.map((e=>this.Provider.DynamicFields().fetchCastAllDynamicFieldsOfType({parentObjectId:e.kioskObjectId,objectsFromObjectIds:e=>this.fetchSuiFrens({suiFrenIds:e}),dynamicFieldType:e=>e.includes(this.objectTypes.suiFren)&&e.includes(this.objectTypes.bullshark)}))))).reduce(((e,t)=>[...e,...t]),[])})),this.harvestSuiFrenFeesEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.events,p.constants.eventNames.suiFrensVault.harvestSuiFrenFees),this.mixSuiFrensEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.events,p.constants.eventNames.suiFrensVault.mixSuiFrens),this.stakeSuiFrenEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.events,p.constants.eventNames.suiFrensVault.stakeSuiFren),this.unstakeSuiFrenEventType=()=>c.EventsApiHelpers.createEventType(this.addresses.packages.suiFrensVault,p.constants.moduleNames.suiFrensVault.events,p.constants.eventNames.suiFrensVault.unstakeSuiFren);const t=this.Provider.addresses.suiFrens;if(!t)throw new Error("not all required addresses have been set in provider");this.addresses=t,this.objectTypes={suiFren:`${t.packages.suiFrens}::${p.constants.moduleNames.suiFrens.suiFrens}::SuiFren`,capy:`${t.packages.suiFrens}::capy::Capy`,bullshark:`${t.packages.suiFrensBullshark}::bullshark::Bullshark`,suiFrenAccessory:`${t.packages.accessories}::${p.constants.moduleNames.accessories.accessories}::Accessory`,stakedSuiFrenPosition:`${t.packages.suiFrensVault}::${p.constants.moduleNames.suiFrensVault.stakedPosition}::StakedPosition`,stakedSuiFrenMetadataV1:`${t.packages.suiFrensVault}::${p.constants.moduleNames.suiFrensVault.vaultState}::StakedSuiFrenMetadataV1`},this.eventTypes={harvestSuiFrenFees:this.harvestSuiFrenFeesEventType(),mixSuiFrens:this.mixSuiFrensEventType(),stakeSuiFren:this.stakeSuiFrenEventType(),unstakeSuiFren:this.unstakeSuiFrenEventType()}}}t.SuiFrensApi=p,p.constants={moduleNames:{suiFrens:{suiFrens:"suifrens"},accessories:{accessories:"accessories"},capyLabs:{capyLabs:"capy_labs"},suiFrensVault:{vault:"vault",vaultState:"vault_state",events:"events",stakedPosition:"staked_position"},suiFrensVaultCapyLabsExtension:{capyLabs:"capy_labs"}},eventNames:{suiFrensVault:{mixSuiFrens:"MixedSuiFrenEvent",stakeSuiFren:"StakedSuiFrenEvent",unstakeSuiFren:"UnstakedSuiFrenEvent",harvestSuiFrenFees:"HarvestedFeesEvent"}}}},394234:(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SuiFrensApiCasting=void 0;const n=s(243333);class r{}t.SuiFrensApiCasting=r,i=r,r.capyLabsAppObjectFromSuiObjectResponse=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),mixingLimit:BigInt(s.mixing_limit),coolDownPeriodEpochs:BigInt(s.cool_down_period),mixingPrice:BigInt(s.mixing_price),suiProfits:BigInt(s.profits)}},r.partialSuiFrenObjectFromSuiObjectResponse=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e),i=n.Helpers.getObjectDisplay(e).data;return{objectType:t,objectId:n.Helpers.getObjectId(e),generation:BigInt(s.generation),birthdate:Number(s.birthdate),cohort:BigInt(s.cohort),genes:s.genes.map((e=>BigInt(e))),attributes:{skin:s.attributes[0],main:s.attributes[1],secondary:s.attributes[2],expression:s.attributes[3],ears:s.attributes[4]},birthLocation:s.birth_location,display:{link:i.link,imageUrl:i.image_url,description:i.description,projectUrl:i.project_url}}},r.partialSuiFrenObjectFromStakedSuiFrenMetadataV1ObjectSuiObjectResponse=e=>{const t=n.Helpers.getObjectFields(e),s=n.Helpers.getObjectDisplay(e).data;return{objectType:t.suifren_type,objectId:n.Helpers.addLeadingZeroesToType(t.suifren_id),generation:BigInt(t.generation),birthdate:Number(t.birthdate),cohort:BigInt(t.cohort),genes:t.genes.map((e=>BigInt(e))),attributes:{skin:t.attributes[0],main:t.attributes[1],secondary:t.attributes[2],expression:t.attributes[3],ears:t.attributes[4]},birthLocation:t.birth_location,display:{link:s.link,imageUrl:s.image_url.replace("mainnet","testnet"),description:s.description,projectUrl:s.project_url}}},r.stakedSuiFrenMetadataV1ObjectFromSuiObjectResponse=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),suiFrenId:n.Helpers.addLeadingZeroesToType(s.suifren_id),collectedFees:BigInt(s.collected_fees),autoStakeFees:s.auto_stake_fees,mixFee:BigInt(s.mix_fee),feeIncrementPerMix:BigInt(s.fee_increment_per_mix),minRemainingMixesToKeep:BigInt(s.min_remaining_mixes_to_keep)}},r.partialSuiFrenAndStakedSuiFrenMetadataV1ObjectFromSuiObjectResponse=e=>({stakedSuiFrenMetadata:i.stakedSuiFrenMetadataV1ObjectFromSuiObjectResponse(e),partialSuiFren:i.partialSuiFrenObjectFromStakedSuiFrenMetadataV1ObjectSuiObjectResponse(e)}),r.stakedSuiFrenPositionFromSuiObjectResponse=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),suiFrenId:n.Helpers.addLeadingZeroesToType(s.suifren_id)}},r.suiFrenVaultStateV1ObjectFromSuiObjectResponse=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e);return{objectType:t,objectId:n.Helpers.getObjectId(e),totalMixes:BigInt(s.mixed),stakedSuiFrens:BigInt(s.suifrens_metadata.fields.size)}},r.accessoryObjectFromSuiObjectResponse=e=>{const t=n.Helpers.getObjectType(e),s=n.Helpers.getObjectFields(e),i=n.Helpers.getObjectDisplay(e).data;return{objectType:t,objectId:n.Helpers.getObjectId(e),name:s.name,type:s.type,imageUrl:i.image_url}},r.harvestSuiFrenFeesEventFromOnChain=e=>{const t=e.parsedJson;return{harvester:n.Helpers.addLeadingZeroesToType(t.issuer),fees:BigInt(t.fees),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.mixSuiFrensEventFromOnChain=e=>{const t=e.parsedJson;return{mixer:n.Helpers.addLeadingZeroesToType(t.issuer),parentOneId:n.Helpers.addLeadingZeroesToType(t.parent_one_id),parentTwoId:n.Helpers.addLeadingZeroesToType(t.parent_two_id),childId:n.Helpers.addLeadingZeroesToType(t.suifren_id),fee:BigInt(t.fee),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.stakeSuiFrenEventFromOnChain=e=>{const t=e.parsedJson;return{staker:n.Helpers.addLeadingZeroesToType(t.issuer),suiFrenId:n.Helpers.addLeadingZeroesToType(t.suifren_id),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}},r.unstakeSuiFrenEventFromOnChain=e=>{const t=e.parsedJson;return{unstaker:n.Helpers.addLeadingZeroesToType(t.issuer),suiFrenId:n.Helpers.addLeadingZeroesToType(t.suifren_id),fees:BigInt(t.fees),timestamp:e.timestampMs,txnDigest:e.id.txDigest,type:e.type}}},670136:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(690432),t),n(s(826462),t),n(s(474154),t)},474154:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StakedSuiFren=void 0;const n=s(690432),r=s(601151);class a extends r.Caller{constructor(e,t,s=!1,i){super(t,"sui-frens"),this.info=e,this.isOwned=s,this.Provider=i,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.SuiFrens();if(!t)throw new Error("missing AftermathApi Provider");return t},this.suiFren=new n.SuiFren(e.suiFren,this.config,!0,s)}mixFee(){return this.info.metadata.mixFee}suiFrenId(){return this.suiFren.suiFren.objectId}clone(){return new a(this.info,this.config,this.isOwned,this.Provider)}getAccessories(){return i(this,void 0,void 0,(function*(){return this.suiFren.getAccessories()}))}getUnstakeTransaction(e){return i(this,void 0,void 0,(function*(){if(!this.info.position)throw new Error("no position found on suiFren");return this.useProvider().fetchUnstakeTx(Object.assign(Object.assign({},e),{suiFrenType:this.suiFren.suiFrenType(),stakedPositionId:this.info.position.objectId}))}))}getHarvestFeesTransaction(e){return i(this,void 0,void 0,(function*(){if(!this.info.position)throw new Error("no position found on suiFren");if(!this.isOwned)throw new Error("unable to remove accessory from suiFren that is not owned by caller");return this.useProvider().fetchBuildHarvestFeesTx(Object.assign(Object.assign({},e),{stakedPositionIds:[this.info.position.objectId]}))}))}getAddAccessoryTransaction(e){return i(this,void 0,void 0,(function*(){return this.suiFren.getAddAccessoryTransaction(e)}))}getRemoveAccessoryTransaction(e){return i(this,void 0,void 0,(function*(){if(!this.info.position)throw new Error("no position found on suiFren");if(!this.isOwned)throw new Error("unable to remove accessory from suiFren that is not owned by caller");return this.useProvider().fetchBuildRemoveAccessoryTx(Object.assign(Object.assign({},e),{suiFrenType:this.suiFren.suiFrenType(),stakedPositionId:this.info.position.objectId}))}))}}t.StakedSuiFren=a},690432:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SuiFren=void 0;const r=s(601151),a=n(s(128879)),o=s(646074);class d extends r.Caller{constructor(e,t,s=!1,i=!1,n){super(t,"sui-frens"),this.suiFren=e,this.isStaked=s,this.isOwned=i,this.Provider=n,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.SuiFrens();if(!t)throw new Error("missing AftermathApi Provider");return t}}suiFrenType(){return o.Coin.getInnerCoinType(this.suiFren.objectType)}properties(){return{Skin:this.suiFren.attributes.skin,Ears:this.suiFren.attributes.ears,Expression:this.suiFren.attributes.expression,"Main Color":this.suiFren.attributes.main,"Secondary Color":this.suiFren.attributes.secondary,"Birth Location":this.suiFren.birthLocation,Birthday:(0,a.default)(this.suiFren.birthdate).format("MMMM D, YYYY"),Cohort:this.suiFren.cohort.toString(),Generation:this.suiFren.generation.toString()}}dynamicFields(){return Object.assign(Object.assign({},this.suiFren.mixLimit?{"Mixes Remaining":this.suiFren.mixLimit.toString()}:{}),this.suiFren.lastEpochMixed?{"Last Epoch Mixed":this.suiFren.lastEpochMixed.toString()}:{})}displayNumber(){return this.suiFren.objectId.slice(-5,-1).toUpperCase()}clone(){return new d(this.suiFren,this.config,this.isStaked,this.isOwned)}getAccessories(){return i(this,void 0,void 0,(function*(){return this.fetchApi("accessories",{suiFrenId:this.suiFren.objectId})}))}getStakeTransaction(e){return i(this,void 0,void 0,(function*(){if(this.isStaked)throw new Error("unable to stake already staked suiFren");return this.useProvider().fetchStakeTx(Object.assign(Object.assign({},e),{suiFrenType:this.suiFrenType(),suiFrenId:this.suiFren.objectId}))}))}getAddAccessoryTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildAddAccessoryTx(Object.assign(Object.assign({},e),{isOwned:this.isOwned,suiFrenType:this.suiFrenType(),suiFrenId:this.suiFren.objectId}))}))}getRemoveAccessoryTransaction(e){return i(this,void 0,void 0,(function*(){if(!this.isOwned)throw new Error("unable to remove accessory from suiFren that is not owned by caller");return this.useProvider().fetchBuildRemoveAccessoryTx(Object.assign(Object.assign({},e),{suiFrenType:this.suiFrenType(),suiFrenId:this.suiFren.objectId}))}))}}t.SuiFren=d},826462:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SuiFrens=void 0;const n=s(690432),r=s(474154),a=s(601151),o=s(302416),d=s(243333);class c extends a.Caller{constructor(e,t){super(e,"sui-frens"),this.Provider=t,this.useProvider=()=>{var e;const t=null===(e=this.Provider)||void 0===e?void 0:e.SuiFrens();if(!t)throw new Error("missing AftermathApi Provider");return t}}static calcTotalInternalMixFee(e){const{mixFee1:t,mixFee2:s}=e;return void 0===t&&void 0===s?this.constants.protocolFees.mixOwned:void 0!==t&&void 0!==s?this.calcMixFeeForStakedSuiFren({mixFee:t})+this.calcMixFeeForStakedSuiFren({mixFee:s}):void 0!==t?this.calcMixFeeForStakedSuiFren({mixFee:t}):void 0!==s?this.calcMixFeeForStakedSuiFren({mixFee:s}):(()=>{throw new Error("unreachable")})()}static calcMixFeeForStakedSuiFren(e){const{mixFee:t}=e;return t+d.Helpers.maxBigInt(this.constants.protocolFees.minMixStaked,t/BigInt(Math.floor(100*this.constants.protocolFees.mixStakedPercentage)))}getSuiFren(e){return i(this,void 0,void 0,(function*(){return(yield this.getSuiFrens({suiFrenObjectIds:[e.suiFrenObjectId]}))[0]}))}getSuiFrens(e){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi(`${JSON.stringify(e.suiFrenObjectIds)}`)).map((e=>new n.SuiFren(e,this.config)))}))}getOwnedSuiFrens(e){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi("owned-sui-frens",e)).map((e=>new n.SuiFren(e,this.config,!1,!0)))}))}getOwnedStakedSuiFrens(e){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi("owned-staked-sui-frens",e)).map((e=>new r.StakedSuiFren(e,this.config,!0)))}))}getAllStakedSuiFrens(e){return i(this,void 0,void 0,(function*(){const t=yield this.fetchApi(`filtered-staked-sui-frens/${c.createStakedSuiFrensQueryString(e)}`,e);return{dynamicFieldObjects:t.dynamicFieldObjects.map((e=>new r.StakedSuiFren(e,this.config))),nextCursor:t.nextCursor}}))}getStakedSuiFrens(e){return i(this,void 0,void 0,(function*(){return(yield this.fetchApi(`staked-sui-frens/${JSON.stringify(e.stakedSuiFrenIds)}`)).map((e=>new r.StakedSuiFren(e,this.config)))}))}getCapyLabsApp(){return i(this,void 0,void 0,(function*(){return this.fetchApi("capy-labs-app")}))}getOwnedAccessories(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("owned-accessories",e)}))}getHarvestFeesEvents(e){return i(this,void 0,void 0,(function*(){return this.fetchApiEvents("events/harvest-fees",e)}))}getMixEvents(e){return i(this,void 0,void 0,(function*(){return this.fetchApiEvents("events/mix",e)}))}getStakeEvents(e){return i(this,void 0,void 0,(function*(){return this.fetchApiEvents("events/stake",e)}))}getUnstakeEvents(e){return i(this,void 0,void 0,(function*(){return this.fetchApiEvents("events/unstake",e)}))}getMixTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildMixTx(e)}))}getHarvestFeesTransaction(e){return i(this,void 0,void 0,(function*(){return this.useProvider().fetchBuildHarvestFeesTx(e)}))}getStats(){return i(this,void 0,void 0,(function*(){return this.fetchApi("stats")}))}static suiFren(e){return e instanceof n.SuiFren?e:null==e?void 0:e.suiFren}static suiFrenId(e){var t,s;return(null==e?void 0:e.suiFren)instanceof n.SuiFren?null===(t=null==e?void 0:e.suiFren)||void 0===t?void 0:t.suiFren.objectId:null===(s=null==e?void 0:e.suiFren)||void 0===s?void 0:s.objectId}static mixFee(e){return e instanceof r.StakedSuiFren?null==e?void 0:e.mixFee():void 0}static createStakedSuiFrensQueryString(e){const{attributes:t,sortBy:s}=e,i=s?`?sort=${s}`:"";return 0===Object.keys(t).length?i:(""===i?"?":i)+Object.entries(t).map((([e,t],s)=>`${0===s&&""===i?"":"&"}${e}=${t}`)).reduce(((e,t)=>e+t),"")}}t.SuiFrens=c,c.constants={mixingFeeCoinType:o.Coin.constants.suiCoinType,protocolFees:{mint:BigInt(25e7),mixOwned:BigInt(25e7),minMixStaked:BigInt(25e7),mixStakedPercentage:.1},suifrenFees:{mint:BigInt(8e9)}}},554932:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.SuiFrensSortOption=void 0,function(e){e.PriceLowToHigh="Price (low to high)",e.PriceHighToLow="Price (high to low)"}(s||(t.SuiFrensSortOption=s={}))},512640:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserDataApi=void 0,t.UserDataApi=class{constructor(e){this.Provider=e}}},503557:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function o(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UserData=void 0;const n=s(601151);class r extends n.Caller{constructor(e){super(e,"user-data")}getUserPublicKey(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("public-key",e)}))}createUserPublicKey(e){return i(this,void 0,void 0,(function*(){return this.fetchApi("save-public-key",e)}))}createUserAccountMessageToSign(){return{action:"CREATE_USER_ACCOUNT"}}createSignTermsAndConditionsMessageToSign(){return{action:"SIGN_TERMS_AND_CONDITIONS"}}}t.UserData=r},617237:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,n)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(554932),t),n(s(120325),t),n(s(794871),t),n(s(925570),t),n(s(806551),t),n(s(261662),t),n(s(901406),t),n(s(635631),t),n(s(898862),t),n(s(72952),t),n(s(358888),t),n(s(540934),t),n(s(417700),t)}}]);