(globalThis.webpackChunk_coral_xyz_app_extension=globalThis.webpackChunk_coral_xyz_app_extension||[]).push([[5315],{624482:(e,t,n)=>{"use strict";n.d(t,{NO:()=>Ve});var a=n(674588),r=n(425139),i=n(801384),s=n(1564),o=n(213839),u=n(102177),p=n(897242),m=n(414124);const c={Testnet:"https://executor-testnet.labsapis.com",Mainnet:"https://executor.labsapis.com"},d={Testnet:{Aptos:"0x14a12d1fd6ef371b70c2113155534ec152ec7f779e281b54866c796c9a4a58d3",Avalanche:"0x2cfEC91B50f657Cc86Ec693542527ac3e03bF742",BaseSepolia:"0x4983C6bD3bB7DA9EECe71cfa7AE4C67CAbf362F0",Sepolia:"0x0F78904c750801391EbBf308181e9d6fc892B0f3",Solana:"CXGRA5SCc8jxDbaQPZrmmZNu2JV34DP7gFW4m31uC1zs"},Mainnet:{Aptos:"0x9f5ad7d5c2d067ca4abb6d8d6aba44c15596b71a1def8eb4596089b527bb2eb1",Arbitrum:"0x55Dd4466BFec29527C54A72fd306efb54e5F7027",Avalanche:"0xd331819478b74d8a7B8EA631118B4a4e50F6EbD1",Base:"0x08FEB1838C3d7F8509DA1EBb9a11a94c1f006cb2",Ethereum:"0xeEFb36c4458dA7798742cf038C5c27E07aB9c51E",Optimism:"0xBC6f9d1CBa49DB365728478cefa02F6743617637",Polygon:"0x007995f2AEcfBC745f20a7AE8D3a02c0EbF46264",Unichain:"0xA7aBDb8f2108901c586543BD5e10E4fA263F4A47",Solana:"CXGRA5SCc8jxDbaQPZrmmZNu2JV34DP7gFW4m31uC1zs"}},y={Testnet:{Avalanche:"0x4058F0C3924eDaB19c15597C438968ed49C1a213",BaseSepolia:"0xC400FcC0e92d3406747FBb6f513D3aa8B038fcE9",Sepolia:"0x0F18DD26D0B41fb1eaa9cF34D1Ec6022aA69a8e2"},Mainnet:{Arbitrum:"0x8442d68524217601ed126f6859694E4B0C7c66A1",Avalanche:"0x3952914628650Ca510404872D84DfF10A844C5B5",Base:"0xbd8d42f40a11b37bD1b3770D754f9629F7cd5679",Ethereum:"0x2cCf230467FE7387674BAa657747F0B5485c7fEC",HyperEVM:"0xACD054f83c0b852d02503191e2c26527A7E72B1f",Linea:"0xc48c126468BE919068dE1983F00F65af759a4E87",Optimism:"0xd0a8940b2e743e33b682daec4d52b46713606c9d",Polygon:"0xc8a8e6d760dcbd5d6746e2f66cd2ffa722dd1e59",Unichain:"0xD5D5D640D8b758672Cc7A078734175c4433866d5",Seievm:"0xf4FefFc03EEFB06B009bFB168b60B30edf7abc12",Sonic:"0xc39BF082ec91D9bC385F956D24a8D66C0c26223d",Worldchain:"0x789f2b91f7B35D5B890983328340c4600339B354",Plume:"0x486228859880ec6c05175035bEe2e5383D23B0fE",Ink:"0xD71898Ec48D36eba65eeb104AF87b00C24A8F201",Monad:"0xA4d775410FB35d8cE49Ad98d3f483A55e532de73"}},l={Testnet:{executorId:"0x4000cfe2955d8355b3d3cf186f854fea9f787a457257056926fde1ec977670eb",executorRequestsId:"0x2d9ccf3cce3f7dce408e5455e90b80a8161ad9673d1366c2a5def60ad93657a8"},Mainnet:{executorId:"0xdb0fe8bb1e2b5be628adbea0636063325073e1070ee11e4281457dfd7f158235",executorRequestsId:"0xc030df7a3eed1494fa4b64aa8ab63a79041cf1114f4ff2b7ab5aca1c684a21a7"}},f={Testnet:"execXUrAsMnqMmTHj5m7N1YQgsDz3cwGLYCYyuDRciV",Mainnet:"execXUrAsMnqMmTHj5m7N1YQgsDz3cwGLYCYyuDRciV"},b=5001n,g={Testnet:{Aptos:5000n,ArbitrumSepolia:800000n,Avalanche:200000n,BaseSepolia:200000n,Linea:250000n,Sepolia:200000n,Solana:250000n,Sonic:250000n,Sui:8000000n},Mainnet:{Aptos:5000n,Arbitrum:800000n,Avalanche:250000n,Base:250000n,Ethereum:250000n,HyperEVM:250000n,Linea:250000n,Optimism:250000n,Polygon:250000n,Unichain:250000n,Seievm:250000n,Solana:250000n,Sonic:250000n,Sui:8000000n,Worldchain:250000n,Plume:250000n,Ink:250000n,Monad:500000n}},h={Testnet:{ArbitrumSepolia:{tokenMessengerV2:"0x8FE6B999Dc680CcFDD5Bf7EB0974218be2542DAA",messageTransmitterV2:"0xE737e5cEBEEBa77EFE34D4aa090756590b1CE275"},Avalanche:{tokenMessengerV2:"0x8FE6B999Dc680CcFDD5Bf7EB0974218be2542DAA",messageTransmitterV2:"0xE737e5cEBEEBa77EFE34D4aa090756590b1CE275"},BaseSepolia:{tokenMessengerV2:"0x8FE6B999Dc680CcFDD5Bf7EB0974218be2542DAA",messageTransmitterV2:"0xE737e5cEBEEBa77EFE34D4aa090756590b1CE275"},Linea:{tokenMessengerV2:"0x8FE6B999Dc680CcFDD5Bf7EB0974218be2542DAA",messageTransmitterV2:"0xE737e5cEBEEBa77EFE34D4aa090756590b1CE275"},Sepolia:{tokenMessengerV2:"0x8FE6B999Dc680CcFDD5Bf7EB0974218be2542DAA",messageTransmitterV2:"0xE737e5cEBEEBa77EFE34D4aa090756590b1CE275"},Solana:{tokenMessengerV2:"CCTPV2vPZJS2u2BBsUoscuikbYjnpFmbFsvVuJdgUMQe",messageTransmitterV2:"CCTPV2Sm4AdWt5296sk4P66VBZ7bEhcARwFaaS9YPbeC"},Sonic:{tokenMessengerV2:"0x8FE6B999Dc680CcFDD5Bf7EB0974218be2542DAA",messageTransmitterV2:"0xE737e5cEBEEBa77EFE34D4aa090756590b1CE275"}},Mainnet:{Arbitrum:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Avalanche:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Base:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Ethereum:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},HyperEVM:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Linea:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Optimism:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Polygon:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Solana:{tokenMessengerV2:"CCTPV2vPZJS2u2BBsUoscuikbYjnpFmbFsvVuJdgUMQe",messageTransmitterV2:"CCTPV2Sm4AdWt5296sk4P66VBZ7bEhcARwFaaS9YPbeC"},Unichain:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Seievm:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Sonic:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Worldchain:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Plume:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Ink:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"},Monad:{tokenMessengerV2:"0x28b5a0e9C621a5BadaA536219b3a228C8168cf5d",messageTransmitterV2:"0x81D40F21F12A8F0E3252Bccb954D722d4c464B64"}}},T={Testnet:{Sepolia:0,Avalanche:1,ArbitrumSepolia:3,Solana:5,BaseSepolia:6,Linea:11,Sonic:13},Mainnet:{Ethereum:0,Avalanche:1,Optimism:2,Arbitrum:3,Solana:5,Base:6,Polygon:7,Unichain:10,Linea:11,Sonic:13,Worldchain:14,Seievm:16,HyperEVM:19,Ink:21,Plume:22,Monad:15}},w={Testnet:{Solana:"8ZHaV5NQ218fLR85VtC9oK3Axyvj8uxGpnKdaswxsxe4"},Mainnet:{Solana:"Ec9XVcN6YqFhqNFTYQD3985jmGFEDa7tHEQK8bbQi5xD"}},M=(e,t)=>void 0!==T[e]?.[t],A=(e,t)=>{const n=T[e]?.[t];if(void 0===n)throw new Error(`CircleV2 domain not found for network ${e} and chain ${t}`);return n},S=(e,t)=>{const n=Object.entries(T[e]??{}).find((([,e])=>e===t))?.[0];if(void 0===n)throw new Error(`CircleV2 chain not found for network ${e} and domain ${t}`);return n},I={Testnet:"https://iris-api-sandbox.circle.com/v2",Mainnet:"https://iris-api.circle.com/v2"};var k;!function(e){e[e.CONFIRMED=1e3]="CONFIRMED",e[e.FINALIZED=2e3]="FINALIZED"}(k||(k={}));class C{network;chain;provider;contracts;usdcId;shimContract;constructor(e,t,n,a){if(this.network=e,this.chain=t,this.provider=n,this.contracts=a,"Devnet"===e)throw new Error("CCTPExecutor not supported on Devnet");const r=s.UO.get(this.network,this.chain);if(!r)throw new Error(`No USDC contract configured for network=${this.network} chain=${this.chain}`);this.usdcId=r;const i=d[e]?.[t];if(!i)throw new Error(`Shim contract for ${t} not found`);this.shimContract=i}static async fromRpc(e,t){const[n,a]=await u.O.chainFromRpc(e),r=t[a];if(!r)throw new Error(`No config found for ${a}`);if(r.network!==n)throw new Error(`Network mismatch: ${r.network} != ${n}`);return new C(n,a,e,r.contracts)}async*transfer(e,t,n){const a=new p.fy(e).unwrap(),r=i.kxK.from(t.address.toUniversalAddress().toUint8Array()),u=i.kxK.from(this.usdcId),m=n.remainingAmount+n.referrerFee,c=s.vw.get(this.network,t.chain),d=a,y=new p.fy(n.referrer?.address?.toString()??a).unwrap(),l=[m,c,r.toString(),u.toString(),n.estimatedCost,(0,o.Vn)(t.chain),d,n.signedQuote,n.relayInstructions,Number(n.referrerFeeDbps),y],f={function:`${this.shimContract}::cctp_v1_with_executor::deposit_for_burn_entry`,functionArguments:l};yield this.createUnsignedTx(f,"AtposCCTPExecutor.Transfer")}createUnsignedTx(e,t,n=!1){return new m.N(e,this.network,this.chain,t,n)}}(0,a.sW)(r.c0,"CCTPExecutor",C);var P=n(439305),E=n(889672),_=n(525360),v=n(796286),R=n(601431),D=n(228786);class F{network;chain;provider;contracts;chainId;shimContract;constructor(e,t,n,a){if(this.network=e,this.chain=t,this.provider=n,this.contracts=a,"Devnet"===e)throw new Error("CCTPExecutor not supported on Devnet");this.chainId=E.X.get(e,t);const r=d[e]?.[t];if(!r)throw new Error(`Shim contract for ${t} not found`);this.shimContract=r}static async fromRpc(e,t){const[n,a]=await _.W.chainFromRpc(e),r=t[a];if(r.network!==n)throw new Error(`Network mismatch: ${r.network} != ${n}`);return new F(n,a,e,r.contracts)}async*transfer(e,t,n){const a=new v.V(e).toString(),r=t.address.toUniversalAddress().toUint8Array(),i=n.remainingAmount+n.referrerFee,u=s.UO.get(this.network,this.chain),p=_.W.getTokenImplementation(this.provider,u);if(await p.allowance(a,this.shimContract)<i){const e=await p.approve.populateTransaction(this.shimContract,i);yield this.createUnsignedTx((0,P.Dt)(e,a),"ERC20.approve of EvmCCTPExecutor",!1)}const m=new D.CH(this.shimContract,["function depositForBurn(uint256 amount, uint16 destinationChain, uint32 destinationDomain, bytes32 mintRecipient, address burnToken, (address refundAddress, bytes signedQuote, bytes instructions) executorArgs, (uint16 dbps, address payee) feeArgs) external payable returns (uint64 nonce)"],this.provider),c=await m.getFunction("depositForBurn").populateTransaction(i,(0,o.Vn)(t.chain),s.vw.get(this.network,t.chain),r,u,{refundAddress:a,signedQuote:n.signedQuote,instructions:n.relayInstructions},{dbps:n.referrerFeeDbps,payee:n.referrer?.address?.toString()??a});c.value=n.estimatedCost,yield this.createUnsignedTx((0,P.Dt)(c,a),"EvmCCTPExecutor.depositForBurn")}createUnsignedTx(e,t,n=!1){return new R.z((0,P.rQ)(e,this.chainId),this.network,this.chain,t,n)}}var B=n(938694),x=n(772726);const{amountItem:O,circleDomainItem:K,universalAddressItem:N}=a.layoutItems,U={binary:"uint",size:4,custom:1,omit:!1},W={binary:"uint",size:4},V=[{name:"version",...U},{name:"burnToken",...N},{name:"mintRecipient",...N},{name:"amount",...O},{name:"messageSender",...N},{name:"maxFee",...O},{name:"feeExecuted",...O},{name:"expirationBlock",...O},{name:"hookData",binary:"bytes"}],L=[{name:"version",...U},{name:"sourceDomain",...K},{name:"destinationDomain",...K},{name:"nonce",binary:"bytes",size:32},{name:"sender",...N},{name:"recipient",...N},{name:"destinationCaller",...N},{name:"minFinalityThreshold",...W},{name:"finalityThresholdExecuted",...W},{name:"messageBody",binary:"bytes",layout:V}],G=e=>(0,x.qC)(L,e),$=[{name:"requests",binary:"array",layout:[{name:"request",binary:"switch",idSize:1,idTag:"type",layouts:[[[1,"GasInstruction"],[{name:"gasLimit",binary:"uint",size:16},{name:"msgValue",binary:"uint",size:16}]],[[2,"GasDropOffInstruction"],[{name:"dropOff",binary:"uint",size:16},{name:"recipient",...a.layoutItems.universalAddressItem}]]]}]}],q=[{name:"quote",binary:"switch",idSize:4,idTag:"prefix",layouts:[[[1162948657,"EQ01"],[{name:"quoterAddress",binary:"bytes",size:20},{name:"payeeAddress",binary:"bytes",size:32},{name:"srcChain",binary:"uint",size:2},{name:"dstChain",binary:"uint",size:2},{name:"expiryTime",binary:"uint",size:8,custom:{to:e=>new Date(Number(1000n*e)),from:e=>BigInt(e.getTime())/1000n}},{name:"baseFee",binary:"uint",size:8},{name:"dstGasPrice",binary:"uint",size:8},{name:"srcPrice",binary:"uint",size:8},{name:"dstPrice",binary:"uint",size:8}]]]},{name:"signature",binary:"bytes",size:65}];class j{network;chain;provider;contracts;chainId;shimContract;messageTransmitter;usdcContract;constructor(e,t,n,a){if(this.network=e,this.chain=t,this.provider=n,this.contracts=a,"Devnet"===e)throw new Error("CCTPv2Executor not supported on Devnet");this.chainId=E.X.get(e,t);const r=y[e]?.[t];if(!r)throw new Error(`Shim contract for ${t} not found`);this.shimContract=r;const i=h[e]?.[t]?.messageTransmitterV2;if(!i)throw new Error(`MessageTransmitter contract for ${t} not found`);this.messageTransmitter=i;const o=s.UO.get(e,t);if(!o)throw new Error(`USDC contract for ${t} not found`);this.usdcContract=o}static async fromRpc(e,t){const[n,a]=await _.W.chainFromRpc(e),r=t[a];if(r.network!==n)throw new Error(`Network mismatch: ${r.network} != ${n}`);return new j(n,a,e,r.contracts)}async*transfer(e,t,n){const a=new v.V(e).toString(),r=t.address.toUniversalAddress().toUint8Array(),i=n.remainingAmount+n.referrerFee,s=_.W.getTokenImplementation(this.provider,this.usdcContract);if(await s.allowance(a,this.shimContract)<i){const e=await s.approve.populateTransaction(this.shimContract,i);yield this.createUnsignedTx((0,P.Dt)(e,a),"ERC20.approve of EvmCCTPv2Executor",!1)}const u=new Uint8Array(32),p=new D.CH(this.shimContract,["function depositForBurn(uint256 amount, uint16 destinationChain, uint32 destinationDomain, bytes32 mintRecipient, address burnToken, bytes32 destinationCaller, uint256 maxFee, uint32 minFinalityThreshold, (address refundAddress, bytes signedQuote, bytes instructions) executorArgs, (uint16 dbps, address payee) feeArgs) external payable returns (uint64 nonce)"],this.provider),m=A(this.network,t.chain),c=await p.getFunction("depositForBurn").populateTransaction(i,(0,o.Vn)(t.chain),m,r,this.usdcContract,u,n.fastTransferMaxFee,n.minFinalityThreshold,{refundAddress:a,signedQuote:n.signedQuote,instructions:n.relayInstructions},{dbps:n.referrerFeeDbps,payee:n.referrer?.address?.toString()??a});c.value=n.estimatedCost,yield this.createUnsignedTx((0,P.Dt)(c,a),"EvmCCTPv2Executor.depositForBurn")}async isTransferCompleted(e){const t=new D.CH(this.messageTransmitter,["function usedNonces(bytes32) public view returns (uint256)"],this.provider);return 1n===await t.getFunction("usedNonces").staticCall(e.nonce)}async*redeem(e,t,n){const a=new v.V(e).toString(),r=new D.CH(this.messageTransmitter,["function receiveMessage(bytes message, bytes attestation)"],this.provider),i=await r.getFunction("receiveMessage").populateTransaction(G(t),B.$v.decode(n));yield this.createUnsignedTx((0,P.Dt)(i,a),"MessageTransmitterV2.receiveMessage")}async getCurrentBlock(){return BigInt(await this.provider.getBlockNumber())}createUnsignedTx(e,t,n=!1){return new R.z((0,P.rQ)(e,this.chainId),this.network,this.chain,t,n)}}(0,a.sW)(P.c0,"CCTPExecutor",F),(0,a.sW)(P.c0,"CCTPv2Executor",j);var H=n(644557),Y=n(800969),z=n(467475),Q=n(410760),Z=n(458173),J=n(404452),X=n(271659);class ee{network;chain;provider;contracts;usdcId;usdcTreasuryId;tokenMessengerId;tokenMessengerStateId;messageTransmitterId;messageTransmitterStateId;executorId;executorRequestsId;constructor(e,t,n,a){if(this.network=e,this.chain=t,this.provider=n,this.contracts=a,"Devnet"===e)throw new Error("CCTPExecutor not supported on Devnet");const r=(e,t)=>{if(!e)throw new Error(t);return e};this.usdcId=r(s.UO.get(this.network,this.chain),`No USDC contract configured for network=${this.network} chain=${this.chain}`);const{tokenMessengerState:i,messageTransmitterState:o,usdcTreasury:u}=(0,X.E)(e);this.usdcTreasuryId=u,this.tokenMessengerId=r(a.cctp?.tokenMessenger,`Circle Token Messenger contract for domain ${t} not found`),this.messageTransmitterId=r(a.cctp?.messageTransmitter,`Circle Message Transmitter contract for domain ${t} not found`),this.tokenMessengerStateId=i,this.messageTransmitterStateId=o,this.executorId=r(l[e]?.executorId,`Executor contract for ${e} not found`),this.executorRequestsId=r(l[e]?.executorRequestsId,`Executor requests contract for ${e} not found`)}static async fromRpc(e,t){const[n,a]=await J.$.chainFromRpc(e),r=t[a];if(r.network!==n)throw new Error(`Network mismatch: ${r.network} != ${n}`);return new ee(n,a,e,r.contracts)}async*transfer(e,t,n){const r=new z.Y,i=new Q.Ne(e).unwrap(),u=s.vw.get(this.network,t.chain),[p,...m]=await J.$.getCoins(this.provider,e,this.usdcId);if(void 0===p)throw new Error("No USDC in wallet");const c=r.object(p.coinObjectId);let d;if(m.length>0&&r.mergeCoins(c,m.map((e=>r.object(e.coinObjectId)))),n.referrerFee>0n){const[e,t]=r.splitCoins(c,[n.remainingAmount,n.referrerFee]);d=e,r.transferObjects([t],n.referrer?(0,a.QC)(n.referrer):i)}else{const[e]=r.splitCoins(c,[n.remainingAmount]);d=e}const[y,l]=r.moveCall({target:`${this.tokenMessengerId}::deposit_for_burn::deposit_for_burn`,arguments:[d,r.pure.u32(u),r.pure.address(t.address.toUniversalAddress().toString()),r.object(this.tokenMessengerStateId),r.object(this.messageTransmitterStateId),r.object("0x403"),r.object(this.usdcTreasuryId)],typeArguments:[this.usdcId]}),[f]=r.moveCall({target:`${this.messageTransmitterId}::message::source_domain`,arguments:[l]}),[b]=r.moveCall({target:`${this.messageTransmitterId}::message::nonce`,arguments:[l]}),[g]=r.moveCall({target:`${this.executorRequestsId}::executor_requests::make_cctp_v1_request`,arguments:[f,b]}),[h]=r.splitCoins(r.gas,[r.pure.u64(n.estimatedCost)]);r.moveCall({target:`${this.executorId}::executor::request_execution`,arguments:[h,r.object(Y.H$),r.pure.u16((0,o.Vn)(t.chain)),r.pure.address("0x0"),r.pure.address(i),r.pure.vector("u8",n.signedQuote),g,r.pure.vector("u8",n.relayInstructions)]}),yield this.createUnsignedTx(r,"SuiCCTPExecutor.Transfer")}createUnsignedTx(e,t,n=!1){return new Z.A(e,this.network,this.chain,t,n)}}(0,a.sW)(H.c0,"CCTPExecutor",ee);var te=n(718876),ne=n(956286),ae=n(332236),re=n(377922),ie=n(834348),se=n(627158),oe=n(635646),ue=n(143088),pe=n(966867),me=n(997135),ce=n(564861);const de={version:"0.1.0",name:"example_cctp_with_executor",instructions:[{name:"relayLastMessage",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"payee",isMut:!0,isSigner:!1},{name:"messageTransmitter",isMut:!1,isSigner:!1},{name:"executorProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"relayLastMessageArgs"}}]}],types:[{name:"relayLastMessageArgs",type:{kind:"struct",fields:[{name:"recipientChain",type:"u16"},{name:"execAmount",type:"u64"},{name:"signedQuoteBytes",type:"bytes"},{name:"relayInstructions",type:"bytes"}]}}]};var ye=n(348834).Buffer;class le{network;chain;connection;contracts;tokenMessengerProgramId;messageTransmitterProgramId;shimProgramId;executorProgramId;constructor(e,t,n,a){if(this.network=e,this.chain=t,this.connection=n,this.contracts=a,"Devnet"===e)throw new Error("CCTPExecutor not supported on Devnet");const r=(e,t)=>{if(!e)throw new Error(t);return new se.PublicKey(e)};this.tokenMessengerProgramId=r(a.cctp?.tokenMessenger,`Circle Token Messenger contract for domain ${t} not found`),this.messageTransmitterProgramId=r(a.cctp?.messageTransmitter,`Circle Message Transmitter contract for domain ${t} not found`),this.shimProgramId=r(d[e]?.[t],`Shim contract for ${t} not found`),this.executorProgramId=r(f[e],`Executor contract for ${e} not found`)}static async fromRpc(e,t){const[n,a]=await ne.d.chainFromRpc(e),r=t[a];if(r.network!==n)throw new Error(`Network mismatch: ${r.network} != ${n}`);return new le(n,a,e,r.contracts)}async*transfer(e,t,n){const a=new se.PublicKey(s.UO.get(this.network,this.chain)),r=new ae.W(e).unwrap(),i=(0,oe.MO)(a,r),u=new ae.W(n.referrer?.address?.toString()??r).unwrap(),p=new se.Transaction;if(p.feePayer=r,n.referrerFee>0n){const e=(0,oe.MO)(a,u,!0);await this.connection.getAccountInfo(e)||p.add((0,ue.ji)(r,e,u,a)),p.add((0,pe.$B)(i,e,r,n.referrerFee))}const m=s.vw.get(this.network,t.chain),c=t.address.toUniversalAddress(),d=se.Keypair.generate();p.add(await(0,me.M4)(this.messageTransmitterProgramId,this.tokenMessengerProgramId,a,m,r,i,c,n.remainingAmount,d.publicKey));const y=new ce.Program(de,this.shimProgramId,{connection:null}),l=(0,x.vB)(q,n.signedQuote),f=re.xc("message_transmitter",this.messageTransmitterProgramId);p.add(await y.methods.relayLastMessage({execAmount:new ce.BN(n.estimatedCost.toString()),recipientChain:(0,o.Vn)(t.chain),signedQuoteBytes:ye.from(n.signedQuote),relayInstructions:ye.from(n.relayInstructions)}).accounts({payer:r,messageTransmitter:f,payee:new se.PublicKey(l.quote.payeeAddress),executorProgram:this.executorProgramId}).instruction()),yield this.createUnsignedTx({transaction:p,signers:[d]},"SvmCCTPExecutor.Transfer")}createUnsignedTx(e,t,n=!1){return new ie.D(e,this.network,this.chain,t,n)}}var fe=n(474813);const be=JSON.parse('{"version":"0.2.0","name":"message_transmitter_v2","instructions":[{"name":"acceptOwnership","accounts":[{"name":"pendingOwner","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"AcceptOwnershipParams"}}]},{"name":"disableAttester","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"attesterManager","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false,"address":"11111111111111111111111111111111"},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"DisableAttesterParams"}}]},{"name":"enableAttester","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"attesterManager","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false,"address":"11111111111111111111111111111111"},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"EnableAttesterParams"}}]},{"name":"initialize","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"upgradeAuthority","isMut":false,"isSigner":true},{"name":"messageTransmitter","isMut":true,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"message_transmitter"}]}},{"name":"messageTransmitterProgramData","isMut":false,"isSigner":false},{"name":"messageTransmitterProgram","isMut":false,"isSigner":false,"address":"CCTPV2Sm4AdWt5296sk4P66VBZ7bEhcARwFaaS9YPbeC"},{"name":"systemProgram","isMut":false,"isSigner":false,"address":"11111111111111111111111111111111"},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"InitializeParams"}}]},{"name":"isNonceUsed","accounts":[{"name":"usedNonce","isMut":false,"isSigner":false,"docs":["Account will be explicitly loaded to avoid error when it\'s not initialized"]}],"args":[],"returns":"bool"},{"name":"pause","accounts":[{"name":"pauser","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"PauseParams"}}]},{"name":"receiveMessage","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"caller","isMut":false,"isSigner":true},{"name":"authorityPda","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"message_transmitter_authority"},{"kind":"account","type":"publicKey","path":"receiver"}]}},{"name":"messageTransmitter","isMut":false,"isSigner":false},{"name":"usedNonce","isMut":true,"isSigner":false,"docs":["Each nonce is stored in a separate PDA"]},{"name":"receiver","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false,"address":"11111111111111111111111111111111"},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"ReceiveMessageParams"}}]},{"name":"reclaimEventAccount","accounts":[{"name":"payee","isMut":true,"isSigner":true,"docs":["rent SOL receiver, should match original rent payer"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"messageSentEventData","isMut":true,"isSigner":false}],"args":[{"name":"params","type":{"defined":"ReclaimEventAccountParams"}}]},{"name":"sendMessage","accounts":[{"name":"eventRentPayer","isMut":true,"isSigner":true},{"name":"senderAuthorityPda","isMut":false,"isSigner":true,"pda":{"seeds":[{"kind":"const","type":"string","value":"sender_authority"}],"programId":{"kind":"account","type":"publicKey","path":"senderProgram"}}},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"messageSentEventData","isMut":true,"isSigner":true},{"name":"senderProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false,"address":"11111111111111111111111111111111"}],"args":[{"name":"params","type":{"defined":"SendMessageParams"}}]},{"name":"setMaxMessageBodySize","accounts":[{"name":"owner","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"SetMaxMessageBodySizeParams"}}]},{"name":"setSignatureThreshold","accounts":[{"name":"attesterManager","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"SetSignatureThresholdParams"}}]},{"name":"transferOwnership","accounts":[{"name":"owner","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"TransferOwnershipParams"}}]},{"name":"unpause","accounts":[{"name":"pauser","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UnpauseParams"}}]},{"name":"updateAttesterManager","accounts":[{"name":"owner","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UpdateAttesterManagerParams"}}]},{"name":"updatePauser","accounts":[{"name":"owner","isMut":false,"isSigner":true,"relations":["messageTransmitter"]},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false,"pda":{"seeds":[{"kind":"const","type":"string","value":"__event_authority"}]}},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UpdatePauserParams"}}]}],"accounts":[{"name":"MessageSent","type":{"kind":"struct","fields":[{"name":"rentPayer","type":"publicKey"},{"name":"createdAt","type":"i64"},{"name":"message","type":"bytes"}]}},{"name":"MessageTransmitter","type":{"kind":"struct","fields":[{"name":"owner","type":"publicKey"},{"name":"pendingOwner","type":"publicKey"},{"name":"attesterManager","type":"publicKey"},{"name":"pauser","type":"publicKey"},{"name":"paused","type":"bool"},{"name":"localDomain","type":"u32"},{"name":"version","type":"u32"},{"name":"signatureThreshold","type":"u32"},{"name":"enabledAttesters","type":{"vec":"publicKey"}},{"name":"maxMessageBodySize","type":"u64"}]}},{"name":"UsedNonce","type":{"kind":"struct","fields":[{"name":"isUsed","type":"bool"}]}}],"types":[{"name":"AcceptOwnershipParams","type":{"kind":"struct","fields":[]}},{"name":"DisableAttesterParams","type":{"kind":"struct","fields":[{"name":"attester","type":"publicKey"}]}},{"name":"EnableAttesterParams","type":{"kind":"struct","fields":[{"name":"newAttester","type":"publicKey"}]}},{"name":"InitializeParams","type":{"kind":"struct","fields":[{"name":"localDomain","type":"u32"},{"name":"attester","type":"publicKey"},{"name":"maxMessageBodySize","type":"u64"},{"name":"version","type":"u32"}]}},{"name":"PauseParams","type":{"kind":"struct","fields":[]}},{"name":"ReceiveMessageParams","type":{"kind":"struct","fields":[{"name":"message","type":"bytes"},{"name":"attestation","type":"bytes"}]}},{"name":"ReclaimEventAccountParams","type":{"kind":"struct","fields":[{"name":"attestation","type":"bytes"},{"name":"destinationMessage","type":"bytes"}]}},{"name":"SendMessageParams","type":{"kind":"struct","fields":[{"name":"destinationDomain","type":"u32"},{"name":"recipient","type":"publicKey"},{"name":"destinationCaller","type":"publicKey"},{"name":"minFinalityThreshold","type":"u32"},{"name":"messageBody","type":"bytes"}]}},{"name":"SetMaxMessageBodySizeParams","type":{"kind":"struct","fields":[{"name":"newMaxMessageBodySize","type":"u64"}]}},{"name":"SetSignatureThresholdParams","type":{"kind":"struct","fields":[{"name":"newSignatureThreshold","type":"u32"}]}},{"name":"TransferOwnershipParams","type":{"kind":"struct","fields":[{"name":"newOwner","type":"publicKey"}]}},{"name":"UnpauseParams","type":{"kind":"struct","fields":[]}},{"name":"UpdateAttesterManagerParams","type":{"kind":"struct","fields":[{"name":"newAttesterManager","type":"publicKey"}]}},{"name":"UpdatePauserParams","type":{"kind":"struct","fields":[{"name":"newPauser","type":"publicKey"}]}}],"events":[{"name":"AttesterDisabled","fields":[{"name":"attester","type":"publicKey","index":false}]},{"name":"AttesterEnabled","fields":[{"name":"attester","type":"publicKey","index":false}]},{"name":"AttesterManagerUpdated","fields":[{"name":"previousAttesterManager","type":"publicKey","index":false},{"name":"newAttesterManager","type":"publicKey","index":false}]},{"name":"MaxMessageBodySizeUpdated","fields":[{"name":"newMaxMessageBodySize","type":"u64","index":false}]},{"name":"MessageReceived","fields":[{"name":"caller","type":"publicKey","index":false},{"name":"sourceDomain","type":"u32","index":false},{"name":"nonce","type":{"array":["u8",32]},"index":false},{"name":"sender","type":"publicKey","index":false},{"name":"finalityThresholdExecuted","type":"u32","index":false},{"name":"messageBody","type":"bytes","index":false}]},{"name":"OwnershipTransferStarted","fields":[{"name":"previousOwner","type":"publicKey","index":false},{"name":"newOwner","type":"publicKey","index":false}]},{"name":"OwnershipTransferred","fields":[{"name":"previousOwner","type":"publicKey","index":false},{"name":"newOwner","type":"publicKey","index":false}]},{"name":"Pause","fields":[]},{"name":"PauserChanged","fields":[{"name":"newAddress","type":"publicKey","index":false}]},{"name":"SignatureThresholdUpdated","fields":[{"name":"oldSignatureThreshold","type":"u32","index":false},{"name":"newSignatureThreshold","type":"u32","index":false}]},{"name":"Unpause","fields":[]}],"errors":[{"code":6000,"name":"InvalidAuthority","msg":"Invalid authority"},{"code":6001,"name":"ProgramPaused","msg":"Instruction is not allowed at this time"},{"code":6002,"name":"InvalidMessageTransmitterState","msg":"Invalid message transmitter state"},{"code":6003,"name":"InvalidSignatureThreshold","msg":"Invalid signature threshold"},{"code":6004,"name":"SignatureThresholdAlreadySet","msg":"Signature threshold already set"},{"code":6005,"name":"InvalidOwner","msg":"Invalid owner"},{"code":6006,"name":"InvalidPauser","msg":"Invalid pauser"},{"code":6007,"name":"InvalidAttesterManager","msg":"Invalid attester manager"},{"code":6008,"name":"InvalidAttester","msg":"Invalid attester"},{"code":6009,"name":"AttesterAlreadyEnabled","msg":"Attester already enabled"},{"code":6010,"name":"TooFewEnabledAttesters","msg":"Too few enabled attesters"},{"code":6011,"name":"SignatureThresholdTooLow","msg":"Signature threshold is too low"},{"code":6012,"name":"AttesterAlreadyDisabled","msg":"Attester already disabled"},{"code":6013,"name":"MessageBodyLimitExceeded","msg":"Message body exceeds max size"},{"code":6014,"name":"InvalidDestinationCaller","msg":"Invalid destination caller"},{"code":6015,"name":"InvalidRecipient","msg":"Invalid message recipient"},{"code":6016,"name":"SenderNotPermitted","msg":"Sender is not permitted"},{"code":6017,"name":"InvalidSourceDomain","msg":"Invalid source domain"},{"code":6018,"name":"InvalidDestinationDomain","msg":"Invalid destination domain"},{"code":6019,"name":"InvalidMessageVersion","msg":"Invalid message version"},{"code":6020,"name":"InvalidUsedNoncesAccount","msg":"Invalid used nonces account"},{"code":6021,"name":"InvalidRecipientProgram","msg":"Invalid recipient program"},{"code":6022,"name":"InvalidNonce","msg":"Invalid nonce"},{"code":6023,"name":"NonceAlreadyUsed","msg":"Nonce already used"},{"code":6024,"name":"MessageTooShort","msg":"Message is too short"},{"code":6025,"name":"MalformedMessage","msg":"Malformed message"},{"code":6026,"name":"InvalidSignatureOrderOrDupe","msg":"Invalid signature order or dupe"},{"code":6027,"name":"InvalidAttesterSignature","msg":"Invalid attester signature"},{"code":6028,"name":"InvalidAttestationLength","msg":"Invalid attestation length"},{"code":6029,"name":"InvalidSignatureRecoveryId","msg":"Invalid signature recovery ID"},{"code":6030,"name":"InvalidSignatureSValue","msg":"Invalid signature S value"},{"code":6031,"name":"InvalidMessageHash","msg":"Invalid message hash"},{"code":6032,"name":"InvalidDestinationMessage","msg":"Invalid destination message"},{"code":6033,"name":"EventAccountWindowNotExpired","msg":"Event account window not expired"},{"code":6034,"name":"DestinationDomainIsLocalDomain","msg":"Destination domain is local domain"}]}'),ge=JSON.parse('{"version":"0.2.0","name":"token_messenger_minter_v2","instructions":[{"name":"acceptOwnership","accounts":[{"name":"pendingOwner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"AcceptOwnershipParams"}}]},{"name":"addLocalToken","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"tokenController","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":true,"isSigner":false},{"name":"custodyTokenAccount","isMut":true,"isSigner":false},{"name":"localTokenMint","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"AddLocalTokenParams"}}]},{"name":"addRemoteTokenMessenger","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"remoteTokenMessenger","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"AddRemoteTokenMessengerParams"}}]},{"name":"burnTokenCustody","accounts":[{"name":"payee","isMut":true,"isSigner":true},{"name":"tokenController","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":false,"isSigner":false},{"name":"custodyTokenAccount","isMut":true,"isSigner":false},{"name":"custodyTokenMint","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"BurnTokenCustodyParams"}}]},{"name":"denylistAccount","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"denylister","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"denylistAccount","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"DenylistParams"}}]},{"name":"depositForBurn","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"eventRentPayer","isMut":true,"isSigner":true},{"name":"senderAuthorityPda","isMut":false,"isSigner":false},{"name":"burnTokenAccount","isMut":true,"isSigner":false},{"name":"denylistAccount","isMut":false,"isSigner":false},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"remoteTokenMessenger","isMut":false,"isSigner":false},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":true,"isSigner":false},{"name":"burnTokenMint","isMut":true,"isSigner":false},{"name":"messageSentEventData","isMut":true,"isSigner":true},{"name":"messageTransmitterProgram","isMut":false,"isSigner":false},{"name":"tokenMessengerMinterProgram","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"DepositForBurnParams"}}]},{"name":"depositForBurnWithHook","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"eventRentPayer","isMut":true,"isSigner":true},{"name":"senderAuthorityPda","isMut":false,"isSigner":false},{"name":"burnTokenAccount","isMut":true,"isSigner":false},{"name":"denylistAccount","isMut":false,"isSigner":false},{"name":"messageTransmitter","isMut":true,"isSigner":false},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"remoteTokenMessenger","isMut":false,"isSigner":false},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":true,"isSigner":false},{"name":"burnTokenMint","isMut":true,"isSigner":false},{"name":"messageSentEventData","isMut":true,"isSigner":true},{"name":"messageTransmitterProgram","isMut":false,"isSigner":false},{"name":"tokenMessengerMinterProgram","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"DepositForBurnWithHookParams"}}]},{"name":"handleReceiveFinalizedMessage","accounts":[{"name":"authorityPda","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"remoteTokenMessenger","isMut":false,"isSigner":false},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":true,"isSigner":false},{"name":"tokenPair","isMut":false,"isSigner":false},{"name":"feeRecipientTokenAccount","isMut":true,"isSigner":false},{"name":"recipientTokenAccount","isMut":true,"isSigner":false},{"name":"custodyTokenAccount","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"HandleReceiveMessageParams"}}]},{"name":"handleReceiveUnfinalizedMessage","accounts":[{"name":"authorityPda","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"remoteTokenMessenger","isMut":false,"isSigner":false},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":true,"isSigner":false},{"name":"tokenPair","isMut":false,"isSigner":false},{"name":"feeRecipientTokenAccount","isMut":true,"isSigner":false},{"name":"recipientTokenAccount","isMut":true,"isSigner":false},{"name":"custodyTokenAccount","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"HandleReceiveMessageParams"}}]},{"name":"initialize","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"upgradeAuthority","isMut":false,"isSigner":true},{"name":"authorityPda","isMut":false,"isSigner":false},{"name":"tokenMessenger","isMut":true,"isSigner":false},{"name":"tokenMinter","isMut":true,"isSigner":false},{"name":"tokenMessengerMinterProgramData","isMut":false,"isSigner":false},{"name":"tokenMessengerMinterProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"InitializeParams"}}]},{"name":"linkTokenPair","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"tokenController","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"tokenPair","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"LinkTokenPairParams"}}]},{"name":"pause","accounts":[{"name":"pauser","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"PauseParams"}}]},{"name":"removeLocalToken","accounts":[{"name":"payee","isMut":true,"isSigner":true},{"name":"tokenController","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":true,"isSigner":false},{"name":"custodyTokenAccount","isMut":true,"isSigner":false},{"name":"custodyTokenMint","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"RemoveLocalTokenParams"}}]},{"name":"removeRemoteTokenMessenger","accounts":[{"name":"payee","isMut":true,"isSigner":true},{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"remoteTokenMessenger","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"RemoveRemoteTokenMessengerParams"}}]},{"name":"setFeeRecipient","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"SetFeeRecipientParams"}}]},{"name":"setMaxBurnAmountPerMessage","accounts":[{"name":"tokenController","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"localToken","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"SetMaxBurnAmountPerMessageParams"}}]},{"name":"setMinFee","accounts":[{"name":"minFeeController","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"SetMinFeeParams"}}]},{"name":"setMinFeeController","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"SetMinFeeControllerParams"}}]},{"name":"setTokenController","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"tokenMinter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"SetTokenControllerParams"}}]},{"name":"transferOwnership","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"TransferOwnershipParams"}}]},{"name":"undenylistAccount","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"denylister","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"denylistAccount","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UndenylistParams"}}]},{"name":"unlinkTokenPair","accounts":[{"name":"payee","isMut":true,"isSigner":true},{"name":"tokenController","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":false,"isSigner":false},{"name":"tokenPair","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UnlinkTokenPairParams"}}]},{"name":"unpause","accounts":[{"name":"pauser","isMut":false,"isSigner":true},{"name":"tokenMinter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UnpauseParams"}}]},{"name":"updateDenylister","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UpdateDenylisterParams"}}]},{"name":"updatePauser","accounts":[{"name":"owner","isMut":false,"isSigner":true},{"name":"tokenMessenger","isMut":false,"isSigner":false},{"name":"tokenMinter","isMut":true,"isSigner":false},{"name":"eventAuthority","isMut":false,"isSigner":false},{"name":"program","isMut":false,"isSigner":false}],"args":[{"name":"params","type":{"defined":"UpdatePauserParams"}}]}],"accounts":[{"name":"DenylistedAccount","type":{"kind":"struct","fields":[{"name":"account","type":"publicKey"}]}},{"name":"LocalToken","type":{"kind":"struct","fields":[{"name":"custody","type":"publicKey"},{"name":"mint","type":"publicKey"},{"name":"burnLimitPerMessage","type":"u64"},{"name":"messagesSent","type":"u64"},{"name":"messagesReceived","type":"u64"},{"name":"amountSent","type":"u128"},{"name":"amountReceived","type":"u128"},{"name":"bump","type":"u8"},{"name":"custodyBump","type":"u8"}]}},{"name":"MessageTransmitter","type":{"kind":"struct","fields":[{"name":"owner","type":"publicKey"},{"name":"pendingOwner","type":"publicKey"},{"name":"attesterManager","type":"publicKey"},{"name":"pauser","type":"publicKey"},{"name":"paused","type":"bool"},{"name":"localDomain","type":"u32"},{"name":"version","type":"u32"},{"name":"signatureThreshold","type":"u32"},{"name":"enabledAttesters","type":{"vec":"publicKey"}},{"name":"maxMessageBodySize","type":"u64"}]}},{"name":"RemoteTokenMessenger","type":{"kind":"struct","fields":[{"name":"domain","type":"u32"},{"name":"tokenMessenger","type":"publicKey"}]}},{"name":"TokenMessenger","type":{"kind":"struct","fields":[{"name":"denylister","type":"publicKey"},{"name":"owner","type":"publicKey"},{"name":"pendingOwner","type":"publicKey"},{"name":"messageBodyVersion","type":"u32"},{"name":"authorityBump","type":"u8"},{"name":"feeRecipient","type":"publicKey"},{"name":"minFeeController","type":"publicKey"},{"name":"minFee","type":"u32"}]}},{"name":"TokenMinter","type":{"kind":"struct","fields":[{"name":"tokenController","type":"publicKey"},{"name":"pauser","type":"publicKey"},{"name":"paused","type":"bool"},{"name":"bump","type":"u8"}]}},{"name":"TokenPair","type":{"kind":"struct","fields":[{"name":"remoteDomain","type":"u32"},{"name":"remoteToken","type":"publicKey"},{"name":"localToken","type":"publicKey"},{"name":"bump","type":"u8"}]}}],"events":[{"name":"Denylisted","fields":[{"name":"account","type":"publicKey","index":false}]},{"name":"DenylisterChanged","fields":[{"name":"oldDenylister","type":"publicKey","index":false},{"name":"newDenylister","type":"publicKey","index":false}]},{"name":"DepositForBurn","fields":[{"name":"burnToken","type":"publicKey","index":false},{"name":"amount","type":"u64","index":false},{"name":"depositor","type":"publicKey","index":false},{"name":"mintRecipient","type":"publicKey","index":false},{"name":"destinationDomain","type":"u32","index":false},{"name":"destinationTokenMessenger","type":"publicKey","index":false},{"name":"destinationCaller","type":"publicKey","index":false},{"name":"maxFee","type":"u64","index":false},{"name":"minFinalityThreshold","type":"u32","index":false},{"name":"hookData","type":"bytes","index":false}]},{"name":"FeeRecipientSet","fields":[{"name":"newFeeRecipient","type":"publicKey","index":false}]},{"name":"LocalTokenAdded","fields":[{"name":"custody","type":"publicKey","index":false},{"name":"mint","type":"publicKey","index":false}]},{"name":"LocalTokenRemoved","fields":[{"name":"custody","type":"publicKey","index":false},{"name":"mint","type":"publicKey","index":false}]},{"name":"MinFeeControllerSet","fields":[{"name":"newMinFeeController","type":"publicKey","index":false}]},{"name":"MinFeeSet","fields":[{"name":"newMinFee","type":"u32","index":false}]},{"name":"MintAndWithdraw","fields":[{"name":"mintRecipient","type":"publicKey","index":false},{"name":"amount","type":"u64","index":false},{"name":"mintToken","type":"publicKey","index":false},{"name":"feeCollected","type":"u64","index":false}]},{"name":"OwnershipTransferStarted","fields":[{"name":"previousOwner","type":"publicKey","index":false},{"name":"newOwner","type":"publicKey","index":false}]},{"name":"OwnershipTransferred","fields":[{"name":"previousOwner","type":"publicKey","index":false},{"name":"newOwner","type":"publicKey","index":false}]},{"name":"Pause","fields":[]},{"name":"PauserChanged","fields":[{"name":"newAddress","type":"publicKey","index":false}]},{"name":"RemoteTokenMessengerAdded","fields":[{"name":"domain","type":"u32","index":false},{"name":"tokenMessenger","type":"publicKey","index":false}]},{"name":"RemoteTokenMessengerRemoved","fields":[{"name":"domain","type":"u32","index":false},{"name":"tokenMessenger","type":"publicKey","index":false}]},{"name":"SetBurnLimitPerMessage","fields":[{"name":"token","type":"publicKey","index":false},{"name":"burnLimitPerMessage","type":"u64","index":false}]},{"name":"SetTokenController","fields":[{"name":"tokenController","type":"publicKey","index":false}]},{"name":"TokenCustodyBurned","fields":[{"name":"custodyTokenAccount","type":"publicKey","index":false},{"name":"amount","type":"u64","index":false}]},{"name":"TokenPairLinked","fields":[{"name":"localToken","type":"publicKey","index":false},{"name":"remoteDomain","type":"u32","index":false},{"name":"remoteToken","type":"publicKey","index":false}]},{"name":"TokenPairUnlinked","fields":[{"name":"localToken","type":"publicKey","index":false},{"name":"remoteDomain","type":"u32","index":false},{"name":"remoteToken","type":"publicKey","index":false}]},{"name":"UnDenylisted","fields":[{"name":"account","type":"publicKey","index":false}]},{"name":"Unpause","fields":[]}],"errors":[{"code":6000,"name":"InvalidAuthority","msg":"Invalid authority"},{"code":6001,"name":"InvalidTokenMinterState","msg":"Invalid token minter state"},{"code":6002,"name":"ProgramPaused","msg":"Instruction is not allowed at this time"},{"code":6003,"name":"InvalidTokenPairState","msg":"Invalid token pair state"},{"code":6004,"name":"InvalidLocalTokenState","msg":"Invalid local token state"},{"code":6005,"name":"InvalidPauser","msg":"Invalid pauser"},{"code":6006,"name":"InvalidTokenController","msg":"Invalid token controller"},{"code":6007,"name":"BurnAmountExceeded","msg":"Burn amount exceeded"},{"code":6008,"name":"InvalidAmount","msg":"Invalid amount"}],"types":[{"name":"AcceptOwnershipParams","type":{"kind":"struct","fields":[]}},{"name":"AddLocalTokenParams","type":{"kind":"struct","fields":[]}},{"name":"AddRemoteTokenMessengerParams","type":{"kind":"struct","fields":[{"name":"domain","type":"u32"},{"name":"tokenMessenger","type":"publicKey"}]}},{"name":"BurnTokenCustodyParams","type":{"kind":"struct","fields":[{"name":"amount","type":"u64"}]}},{"name":"DenylistParams","type":{"kind":"struct","fields":[{"name":"account","type":"publicKey"}]}},{"name":"DepositForBurnParams","type":{"kind":"struct","fields":[{"name":"amount","type":"u64"},{"name":"destinationDomain","type":"u32"},{"name":"mintRecipient","type":"publicKey"},{"name":"destinationCaller","type":"publicKey"},{"name":"maxFee","type":"u64"},{"name":"minFinalityThreshold","type":"u32"}]}},{"name":"DepositForBurnWithHookParams","type":{"kind":"struct","fields":[{"name":"amount","type":"u64"},{"name":"destinationDomain","type":"u32"},{"name":"mintRecipient","type":"publicKey"},{"name":"destinationCaller","type":"publicKey"},{"name":"maxFee","type":"u64"},{"name":"minFinalityThreshold","type":"u32"},{"name":"hookData","type":"bytes"}]}},{"name":"HandleReceiveMessageParams","type":{"kind":"struct","fields":[{"name":"remoteDomain","type":"u32"},{"name":"sender","type":"publicKey"},{"name":"finalityThresholdExecuted","type":"u32"},{"name":"messageBody","type":"bytes"},{"name":"authorityBump","type":"u8"}]}},{"name":"InitializeParams","type":{"kind":"struct","fields":[{"name":"tokenController","type":"publicKey"},{"name":"denylister","type":"publicKey"},{"name":"feeRecipient","type":"publicKey"},{"name":"minFeeController","type":"publicKey"},{"name":"minFee","type":"u32"},{"name":"messageBodyVersion","type":"u32"}]}},{"name":"LinkTokenPairParams","type":{"kind":"struct","fields":[{"name":"localToken","type":"publicKey"},{"name":"remoteDomain","type":"u32"},{"name":"remoteToken","type":"publicKey"}]}},{"name":"PauseParams","type":{"kind":"struct","fields":[]}},{"name":"RemoveLocalTokenParams","type":{"kind":"struct","fields":[]}},{"name":"RemoveRemoteTokenMessengerParams","type":{"kind":"struct","fields":[]}},{"name":"SetFeeRecipientParams","type":{"kind":"struct","fields":[{"name":"newFeeRecipient","type":"publicKey"}]}},{"name":"SetMaxBurnAmountPerMessageParams","type":{"kind":"struct","fields":[{"name":"burnLimitPerMessage","type":"u64"}]}},{"name":"SetMinFeeControllerParams","type":{"kind":"struct","fields":[{"name":"newMinFeeController","type":"publicKey"}]}},{"name":"SetMinFeeParams","type":{"kind":"struct","fields":[{"name":"newMinFee","type":"u32"}]}},{"name":"SetTokenControllerParams","type":{"kind":"struct","fields":[{"name":"tokenController","type":"publicKey"}]}},{"name":"TransferOwnershipParams","type":{"kind":"struct","fields":[{"name":"newOwner","type":"publicKey"}]}},{"name":"UndenylistParams","type":{"kind":"struct","fields":[{"name":"account","type":"publicKey"}]}},{"name":"UnlinkTokenPairParams","type":{"kind":"struct","fields":[]}},{"name":"UnpauseParams","type":{"kind":"struct","fields":[]}},{"name":"UpdateDenylisterParams","type":{"kind":"struct","fields":[{"name":"newDenylister","type":"publicKey"}]}},{"name":"UpdatePauserParams","type":{"kind":"struct","fields":[{"name":"newPauser","type":"publicKey"}]}}]}'),he={version:"0.1.0",name:"executor",instructions:[{name:"requestForExecution",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"payee",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"args",type:{defined:"RequestForExecutionArgs"}}]}],types:[{name:"RequestForExecutionArgs",type:{kind:"struct",fields:[{name:"amount",type:"u64"},{name:"dstChain",type:"u16"},{name:"dstAddr",type:{array:["u8",32]}},{name:"refundAddr",type:"publicKey"},{name:"signedQuoteBytes",type:"bytes"},{name:"requestBytes",type:"bytes"},{name:"relayInstructions",type:"bytes"}]}}],errors:[{code:6e3,name:"InvalidArguments",msg:"InvalidArguments"},{code:6001,name:"QuoteSrcChainMismatch",msg:"QuoteSrcChainMismatch"},{code:6002,name:"QuoteDstChainMismatch",msg:"QuoteDstChainMismatch"},{code:6003,name:"QuoteExpired",msg:"QuoteExpired"},{code:6004,name:"QuotePayeeMismatch",msg:"QuotePayeeMismatch"}]};var Te=n(348834).Buffer;const we=Te.from("4552433201","hex"),Me=(e,t,n)=>{const a=[Te.from(ce.utils.bytes.utf8.encode(e))];if(n)for(const e of n)"string"==typeof e?a.push(Te.from(ce.utils.bytes.utf8.encode(e))):Array.isArray(e)||Te.isBuffer(e)?a.push(Te.from(e)):a.push(Te.from(e.toBuffer()));const r=se.PublicKey.findProgramAddressSync(a,t);return{publicKey:r[0],bump:r[1]}};class Ae{network;chain;connection;contracts;tokenMessengerV2ProgramId;messageTransmitterV2ProgramId;executorProgramId;constructor(e,t,n,a){this.network=e,this.chain=t,this.connection=n,this.contracts=a;const r=(e,t)=>{if(!e)throw new Error(t);return new se.PublicKey(e)},i=h[e]?.[t];if(!i)throw new Error(`Circle V2 contracts not found for ${e} ${t}`);this.tokenMessengerV2ProgramId=r(i.tokenMessengerV2,`Circle Token Messenger V2 contract for domain ${t} not found`),this.messageTransmitterV2ProgramId=r(i.messageTransmitterV2,`Circle Message Transmitter V2 contract for domain ${t} not found`),this.executorProgramId=r(f[e],`Executor contract for ${e} not found`)}static async fromRpc(e,t){const[n,a]=await ne.d.chainFromRpc(e),r=t[a];if(r.network!==n)throw new Error(`Network mismatch: ${r.network} != ${n}`);return new Ae(n,a,e,r.contracts)}async*transfer(e,t,n){const a=new se.PublicKey(s.UO.get(this.network,this.chain)),r=new ae.W(e).unwrap(),i=(0,oe.MO)(a,r),u=new ae.W(n.referrer?.address?.toString()??r).unwrap(),p=[];if(n.referrerFee>0n){const e=(0,oe.MO)(a,u,!0);await this.connection.getAccountInfo(e)||p.push((0,ue.ji)(r,e,u,a)),p.push((0,pe.$B)(i,e,r,n.referrerFee))}const m=A(this.network,t.chain),c=t.address.toUniversalAddress(),d=se.Keypair.generate(),y=await this.createCCTPv2DepositInstruction(a,m,r,i,c,n.remainingAmount,d.publicKey);p.push(y);const l=new ce.Program(he,this.executorProgramId,{connection:null}),f=(0,x.vB)(q,n.signedQuote);p.push(await l.methods.requestForExecution({amount:new ce.BN(n.estimatedCost.toString()),dstChain:(0,o.Vn)(t.chain),dstAddr:[...t.address.toUniversalAddress().toUint8Array()],refundAddr:r,signedQuoteBytes:Te.from(n.signedQuote),requestBytes:we,relayInstructions:Te.from(n.relayInstructions)}).accounts({payer:r,payee:new se.PublicKey(f.quote.payeeAddress),systemProgram:se.SystemProgram.programId}).instruction());const b=w[this.network]?.[this.chain],g=await this.createVersionedTransaction(r,p,b);yield this.createUnsignedTx({transaction:g,signers:[d]},"SvmCCTPv2Executor.Transfer")}async isTransferCompleted(e){const t=Te.alloc(4);t.writeUInt32LE(e.sourceDomain,0);const n=Te.from(e.nonce).subarray(0,8),[a]=se.PublicKey.findProgramAddressSync([Te.from("used_nonces"),t,n],this.messageTransmitterV2ProgramId);try{return null!==await this.connection.getAccountInfo(a)}catch(e){return!1}}async*redeem(e,t,n){const a=new ae.W(e).unwrap(),r=new se.PublicKey(s.UO.get(this.network,this.chain)),i=new se.PublicKey(t.messageBody.mintRecipient.toUint8Array()),o=[];if(!await this.connection.getAccountInfo(i)){const e=(0,oe.MO)(r,a,!0);if(!e.equals(i))throw new Error(`Sender ATA ${e.toBase58()} does not match mint recipient ${i.toBase58()}`);o.push((0,ue.ji)(a,e,a,r))}o.push(await this.createReceiveMessageInstructionV2(this.messageTransmitterV2ProgramId,this.tokenMessengerV2ProgramId,r,t,n,a));const u=w[this.network]?.[this.chain],p=await this.createVersionedTransaction(a,o,u);yield this.createUnsignedTx({transaction:p,signers:[]},"SvmCCTPv2Executor.Redeem")}async getCurrentBlock(){const e=await this.connection.getSlot();return BigInt(e)}async createVersionedTransaction(e,t,n){const a=n?(await this.connection.getAddressLookupTable(new se.PublicKey(n))).value:null,{blockhash:r}=await this.connection.getLatestBlockhash(),i=new se.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:t}).compileToV0Message(a?[a]:[]);return new se.VersionedTransaction(i)}async createReceiveMessageInstructionV2(e,t,n,a,r,i){const s=Te.from(G(a)),o=Te.from(B.I1("0x",r),"hex"),u=new se.PublicKey(n),p=new se.PublicKey(Te.from(a.messageBody.burnToken.toUint8Array())),m=new se.PublicKey(a.messageBody.mintRecipient.toUint8Array()),c=a.sourceDomain.toString(),d=this.nonceAccountV2(e,s),y=Me("message_transmitter",e),l=Me("token_messenger",t),f=Me("token_minter",t),b=Me("local_token",t,[u]),g=Me("remote_token_messenger",t,[c]),h=Me("token_pair",t,[c,p]),T=Me("custody",t,[u]),w=Me("__event_authority",t),M=new ce.Program(ge,this.messageTransmitterV2ProgramId,{connection:this.connection}),A=await M.account.tokenMessenger.fetch(l.publicKey),S=(0,oe.MO)(u,A.feeRecipient),I=[{isSigner:!1,isWritable:!1,pubkey:l.publicKey},{isSigner:!1,isWritable:!1,pubkey:g.publicKey},{isSigner:!1,isWritable:!0,pubkey:f.publicKey},{isSigner:!1,isWritable:!0,pubkey:b.publicKey},{isSigner:!1,isWritable:!1,pubkey:h.publicKey},{isSigner:!1,isWritable:!0,pubkey:S},{isSigner:!1,isWritable:!0,pubkey:m},{isSigner:!1,isWritable:!0,pubkey:T.publicKey},{isSigner:!1,isWritable:!1,pubkey:fe.H_},{isSigner:!1,isWritable:!1,pubkey:w.publicKey},{isSigner:!1,isWritable:!1,pubkey:t}],k=new ce.Program(be,this.messageTransmitterV2ProgramId,{connection:null});return await k.methods.receiveMessage({message:s,attestation:o}).accounts({payer:i,caller:i,messageTransmitter:y.publicKey,usedNonce:d,receiver:t,program:k.programId}).remainingAccounts(I).instruction()}nonceAccountV2(e,t){const n=t.slice(12,44);return Me("used_nonce",e,[n]).publicKey}async createCCTPv2DepositInstruction(e,t,n,a,r,i,s){const[o]=se.PublicKey.findProgramAddressSync([Te.from("token_messenger")],this.tokenMessengerV2ProgramId),[u]=se.PublicKey.findProgramAddressSync([Te.from("local_token"),e.toBuffer()],this.tokenMessengerV2ProgramId),[p]=se.PublicKey.findProgramAddressSync([Te.from("remote_token_messenger"),Te.from(t.toString())],this.tokenMessengerV2ProgramId),[m]=se.PublicKey.findProgramAddressSync([Te.from("token_minter")],this.tokenMessengerV2ProgramId),[c]=se.PublicKey.findProgramAddressSync([Te.from("sender_authority")],this.tokenMessengerV2ProgramId),[d]=se.PublicKey.findProgramAddressSync([Te.from("__event_authority")],this.tokenMessengerV2ProgramId),[y]=se.PublicKey.findProgramAddressSync([Te.from("denylist_account"),n.toBuffer()],this.tokenMessengerV2ProgramId),[l]=se.PublicKey.findProgramAddressSync([Te.from("message_transmitter")],this.messageTransmitterV2ProgramId),f=Te.from([215,60,61,46,114,55,128,176]),b=Te.alloc(8);b.writeBigUInt64LE(i);const g=Te.alloc(4);g.writeUInt32LE(t);const h=Te.from(r.toUint8Array()),T=Te.alloc(32),w=Te.alloc(8);w.writeBigUInt64LE(0n);const M=Te.alloc(4);M.writeUInt32LE(0);const A=Te.concat([f,b,g,h,T,w,M]),S=[{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!0},{pubkey:this.messageTransmitterV2ProgramId,isSigner:!1,isWritable:!1},{pubkey:this.tokenMessengerV2ProgramId,isSigner:!1,isWritable:!1},{pubkey:fe.H_,isSigner:!1,isWritable:!1},{pubkey:se.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:this.tokenMessengerV2ProgramId,isSigner:!1,isWritable:!1}];return new se.TransactionInstruction({keys:S,programId:this.tokenMessengerV2ProgramId,data:A})}createUnsignedTx(e,t,n=!1){return new ie.D(e,this.network,this.chain,t,n)}}(0,a.sW)(te.c0,"CCTPExecutor",le),(0,a.sW)(te.c0,"CCTPv2Executor",Ae);var Se,Ie,ke=n(336883),Ce=n(963096),Pe=n(329039),Ee=n(351384),_e=n(736978),ve=n(530303),Re=n(715755),De=n(96733),Fe=n(890819);async function Be(e,t,n){const a=`${c[e]}/v0/status/tx`;try{return(await ve.Z.post(a,{txHash:t,chainId:(0,o.Vn)(n)})).data}catch(e){throw new Error(`Failed to fetch status for txHash: ${t}.`)}}!function(e){e.Pending="pending",e.Failed="failed",e.Unsupported="unsupported",e.Submitted="submitted",e.Underpaid="underpaid",e.Aborted="aborted"}(Se||(Se={})),function(e){e.ERM1="ERM1",e.ERV1="ERV1",e.ERN1="ERN1",e.ERC1="ERC1",e.ERC2="ERC2"}(Ie||(Ie={}));const xe=65535n;function Oe(e){return new Promise((t=>setTimeout(t,e)))}async function Ke(e,t,n=Re.OP){const a=A(t,e.chain);return De.XD((async()=>{const n=`${I[t]}/messages/${a}?transactionHash=${e.txid}`;try{const e=(await ve.Z.get(n)).data.messages[0];if(!e)return null;if(2!==e.cctpVersion)throw new Error("CCTPv1 attestation found");return"pending_confirmations"===e.status?null:{message:(r=B.$v.decode(e.message),(0,x.vB)(L,r)),attestation:e.attestation}}catch(e){if(!e)return null;if("object"==typeof e){if(ve.Z.isAxiosError(e)&&404===e.response?.status)return null;if("status"in e&&404===e.status)return null}throw e}var r}),2e3,n,"CCTPv2:GetMessage")}var Ne=n(906010);let Ue;Pe.ns;class We extends Pe.ns{static NATIVE_GAS_DROPOFF_SUPPORTED=!0;static supportedNetworks(){return["Mainnet","Testnet"]}static supportedChains(e){return Object.keys(T[e]??{})}getDefaultOptions(){return{nativeGas:0}}async initiate(e,t,n,a){if(!n.details)throw new Error("Missing quote details");return await async function(e,t,n,a){(0,x.vB)($,a.details.relayInstructions).requests.forEach((({request:e})=>{if("GasDropOffInstruction"===e.type&&!e.recipient.equals(n.address.toUniversalAddress()))throw new Error("Gas drop-off recipient does not match")}));const r=Fe.D.parseAddress(t.chain(),t.address()),i=await async function(e,t){if("Solana"!==e.chain)return e;const n=s.UO.get(t.toChain.network,t.toChain.chain);if(!n)throw new Error("No USDC contract found for Solana");const a=Fe.D.parseAddress("Solana",n);return t.toChain.getTokenAccount(e.address,a)}(n,e);let o;if("CCTPExecutor"===a.protocol){const t=await e.fromChain.getProtocol(a.protocol);o=await t.transfer(r,i,a.details)}else{const t=await e.fromChain.getProtocol(a.protocol);o=await t.transfer(r,i,a.details)}const u=await(0,Ne.M)(e.fromChain,o,t);let p=0;return(async()=>{for(;p<20;){try{const[t]=await Be(e.fromChain.network,u.at(-1).txid,e.fromChain.chain);if(t)break}catch(e){}p++,await Oe(2e3)}})(),{from:e.fromChain.chain,to:e.toChain.chain,state:Ee.ki.SourceInitiated,originTxs:u}}(e,t,a,{protocol:"CCTPv2Executor",details:n.details})}async*track(e,t){if((0,Ee.PN)(e))return e;let n=t||36e5;for(;n>0;){const t=Date.now();if((0,Ee.vk)(e)||(0,Ee.E6)(e)||(0,Ee.AY)(e)||(0,Ee.gO)(e))try{const t=e.originTxs.at(-1).txid;if((0,Ee.vk)(e)||(0,Ee.E6)(e)){const n=await Ke({chain:e.from,txid:t},this.wh.network);n&&(e={...e,state:Ee.ki.Attested,attestation:{id:t,attestation:n}}),yield e}if((0,Ee.AY)(e)){const[n]=await Be(this.wh.network,t,e.from);if(!n)throw new Error("No transaction status found");const a=n?.status;a===Se.Submitted?e={...e,state:Ee.ki.DestinationFinalized}:a!==Se.Failed&&a!==Se.Underpaid&&a!==Se.Unsupported&&a!==Se.Aborted||(e={...e,state:Ee.ki.Failed,error:new _e.t5(`Relay failed with status: ${a}`)})}if((0,Ee.gO)(e)){if(!e.attestation)throw new Error("Receipt is missing attestation");const t=e.attestation,n=await this.wh.getChain(e.to).getProtocol("CCTPv2Executor");await n.isTransferCompleted(t.attestation.message)&&(e={...e,state:Ee.ki.DestinationFinalized,attestation:t})}if(yield e,(0,Ee.PN)(e))return e}catch(e){console.error(`Error fetching transaction status: ${e.message||e}`)}await new Promise((e=>setTimeout(e,3e3))),n-=Date.now()-t}return e}async complete(e,t){if(!(0,Ee.AY)(t)&&!(0,Ee.gO)(t))throw new Error("Transfer is not attested");if(!t.attestation)throw new Error("No attestation found");const n=this.wh.getChain(t.to),a=await n.getProtocol("CCTPv2Executor");let{attestation:r,message:i}=t.attestation.attestation;const{expirationBlock:s}=i.messageBody,o=await a.getCurrentBlock();if(0n!==s&&s<o){const e=await async function(e,t){const n=B.$v.encode(t.attestation.message.nonce,!0),a=`${I[e]}/reattest/${n}`,r=await ve.Z.post(a);if(r.data.error){if(r.data.error.includes("Message is already finalized"))return t.attestation;throw new Error(`Error re-attesting message: ${r.data.error}`)}const i=S(e,t.attestation.message.sourceDomain);return De.XD((async()=>{const n=await Ke({txid:t.id,chain:i},e);return n?0n!==n.message.messageBody.expirationBlock?null:n:null}),2e3,Re.OP,"CCTPv2:Reattest")}(n.network,t.attestation);if(!e)throw new Error("Failed to reattest message");r=e.attestation,i=e.message}const u=Fe.D.parseAddress(e.chain(),e.address()),p=a.redeem(u,i,r),m=await(0,Ne.M)(this.wh.getChain(t.to),p,e);return{...t,state:Ee.ki.DestinationInitiated,attestation:t.attestation,destinationTxs:m}}async resume(e){const t=await Ke(e,this.wh.network);if(!t)throw new Error("No attestation found");const{message:n}=t,a=S(this.wh.network,n.destinationDomain),r=await this.wh.getChain(a).getProtocol("CCTPv2Executor");return await r.isTransferCompleted(n)?{from:e.chain,to:a,state:Ee.ki.DestinationFinalized,originTxs:[e],attestation:{id:e.txid,attestation:t}}:{from:e.chain,to:a,state:Ee.ki.Attested,originTxs:[e],attestation:{id:e.txid,attestation:t}}}}function Ve(e={referrerFeeDbps:0n}){if(e.referrerFeeDbps<0||e.referrerFeeDbps>65535n)throw new Error("Referrer fee must be between 0 and 65535");return class extends Le{static config=e}}class Le extends We{staticConfig=this.constructor.config;static config={referrerFeeDbps:0n};static meta={name:"CCTPv2StandardExecutorRoute",provider:"Circle CCTP"};static isPathSupported(e,t){return M(e.network,e.chain)&&M(t.network,t.chain)&&"Linea"!==e.chain}static async supportedDestinationTokens(e,t,n){return this.isPathSupported(t,n)?function(e,t,n){const r=s.UO.get(t.network,t.chain);if(!r||!(0,a.n2)(e,Fe.D.tokenId(t.chain,r)))return[];const{network:i,chain:o}=n,u=s.UO.get(i,o);return u?[Fe.D.chainAddress(o,u)]:[]}(e,t,n):[]}async validate(e,t){return Le.isPathSupported(e.fromChain,e.toChain)?t.options?.nativeGas&&(t.options.nativeGas<0||t.options.nativeGas>1)?{valid:!1,error:new Error("Invalid native gas percentage"),params:t}:{valid:!0,params:{normalizedParams:{amount:e.parseAmount(t.amount)},options:t.options??this.getDefaultOptions(),...t}}:{valid:!1,error:new Error("Can only transfer between Circle V2 chains"),params:t}}async quote(e,t){const{fromChain:n,toChain:r}=e;try{const i=await async function(e,t,n,r){const{fromChain:i,toChain:u}=e;if(!s.UO.get(i.network,i.chain))throw new Error("Invalid transfer, no USDC contract on source");const p=s.UO.get(u.network,u.chain);if(!p)throw new Error("Invalid transfer, no USDC contract on destination");let m;if(n.referrerFeeDbps>0n&&(m=n.referrerAddresses?.[i.network]?.[i.chain],!m))throw new Error(`Referrer address not configured for ${i.chain}`);const d=m?Fe.D.chainAddress(i.chain,m):void 0,{referrerFee:y,remainingAmount:l,referrerFeeDbps:f}=function(e,t,n){if(t>xe)throw new Error("dBps exceeds max u16");let a=t,r=0n,i=e;if(t>0){if(void 0!==n&&e>0){const i=Ce.Qc(n.toString(),6),s=Ce.Dl(i);r=(e<s?e:s)*t/100000n,a=100000n*r/e}else r=e*t/100000n;i=e-r}return{referrerFee:r,remainingAmount:i,referrerFeeDbps:a}}(Ce.Dl(t.normalizedParams.amount),n.referrerFeeDbps,n.referrerFeeThreshold);if(l<=0n)throw new Error("Amount after fee <= 0");const h=g[u.network]?.[u.chain];if(!h)throw new Error("Gas limit not found");const T=await async function(e){const t=`${c[e]}/v0/capabilities`;try{return(await ve.Z.get(t)).data}catch(t){throw new Error(`Failed to fetch capabilities for network: ${e}.`)}}(i.network);if(!T[(0,o.Vn)(i.chain)])throw new Error("Unsupported source chain");const w=T[(0,o.Vn)(u.chain)];if(!w||!w.requestPrefixes.includes(r))throw new Error("Unsupported destination chain");const{recipient:M}=e;let A=!0;if(M&&"Solana"===u.chain){const e=Fe.D.parseAddress("Solana",p),t=await u.getTokenAccount(M.address,e),n=await u.getRpc();A=null!==await n.getAccountInfo(new ae.W(t.address).unwrap()),A||Ue||(Ue=BigInt(await n.getMinimumBalanceForRentExemption(165)))}let S=0n;"Solana"===u.chain&&(S+=b,!A&&Ue&&(S+=Ue),"ERC2"===r&&(S+=1200000n));const I=[];I.push({request:{type:"GasInstruction",gasLimit:h,msgValue:S}});const k=BigInt(w.gasDropOffLimit),C=t.options.nativeGas&&k>0n?BigInt(Math.round(100*t.options.nativeGas))*k/100n:0n;(C>0n||!A)&&I.push({request:{type:"GasDropOffInstruction",dropOff:C,recipient:M?M.address.toUniversalAddress():new a.Vf(new Uint8Array(32))}});const P=(0,x.qC)($,{requests:I}),E=await async function(e,t,n,a){const r=`${c[e]}/v0/quote`;try{return(await ve.Z.post(r,{srcChain:(0,o.Vn)(t),dstChain:(0,o.Vn)(n),relayInstructions:a})).data}catch(e){throw new Error("Failed to fetch signed quote.")}}(i.network,i.chain,u.chain,B.$v.encode(P,!0));if(!E.estimatedCost)throw new Error("No estimated cost");const _=B.$v.decode(E.signedQuote),v=(0,x.vB)(q,_);return{signedQuote:_,relayInstructions:P,estimatedCost:BigInt(E.estimatedCost),referrer:d,referrerFee:y,remainingAmount:l,referrerFeeDbps:f,expiryTime:v.quote.expiryTime,gasDropOff:C}}(e,t,this.staticConfig,"ERC2"),{remainingAmount:u,estimatedCost:p,gasDropOff:m,expiryTime:d}=i,y="Polygon"===n.chain?4e5:ke.bm(n.chain)+1e3,[l,f]=await Promise.all([n.getDecimals("native"),r.getDecimals("native")]);return{success:!0,params:t,sourceToken:{token:e.source.id,amount:t.normalizedParams.amount},destinationToken:{token:e.destination.id,amount:Ce.dN(u,e.destination.decimals)},relayFee:{token:(0,a.OK)(n.chain),amount:Ce.dN(p,l)},destinationNativeGas:Ce.dN(m,f),eta:y,expires:d,details:{...i,minFinalityThreshold:k.FINALIZED,fastTransferMaxFee:0n}}}catch(e){return{success:!1,error:new Error(e instanceof Error?e.message:`${e}`)}}}}},496279:function(e,t){var n="undefined"!=typeof self?self:this,a=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,a="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function p(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function m(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return a&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function y(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function l(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function f(e){var t=new FileReader,n=l(t);return t.readAsArrayBuffer(e),n}function b(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&r&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=b(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=b(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=y(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,a=y(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,n=l(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=p(e),t=m(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d.prototype.delete=function(e){delete this.map[p(e)]},d.prototype.get=function(e){return e=p(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(p(e))},d.prototype.set=function(e,t){this.map[p(e)]=m(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),c(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),c(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),c(e)},a&&(d.prototype[Symbol.iterator]=d.prototype.entries);var h=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function T(e,t){var n,a,r=(t=t||{}).body;if(e instanceof T){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(a=(n=t.method||this.method||"GET").toUpperCase(),h.indexOf(a)>-1?a:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),a=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(r))}})),t}function M(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}T.prototype.clone=function(){return new T(this,{body:this._bodyInit})},g.call(T.prototype),g.call(M.prototype),M.prototype.clone=function(){return new M(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},M.error=function(){var e=new M(null,{status:0,statusText:""});return e.type="error",e};var A=[301,302,303,307,308];M.redirect=function(e,t){if(-1===A.indexOf(t))throw new RangeError("Invalid status code");return new M(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function S(e,n){return new Promise((function(a,i){var s=new T(e,n);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var o=new XMLHttpRequest;function u(){o.abort()}o.onload=function(){var e,t,n={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),a=n.shift().trim();if(a){var r=n.join(":").trim();t.append(a,r)}})),t)};n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");var r="response"in o?o.response:o.responseText;a(new M(r,n))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&r&&(o.responseType="blob"),s.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",u),o.onreadystatechange=function(){4===o.readyState&&s.signal.removeEventListener("abort",u)}),o.send(void 0===s._bodyInit?null:s._bodyInit)}))}S.polyfill=!0,e.fetch||(e.fetch=S,e.Headers=d,e.Request=T,e.Response=M),t.Headers=d,t.Request=T,t.Response=M,t.fetch=S,Object.defineProperty(t,"__esModule",{value:!0})}({})}(a),a.fetch.ponyfill=!0,delete a.fetch.polyfill;var r=a;(t=r.fetch).default=r.fetch,t.fetch=r.fetch,t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response,e.exports=t},331802:(e,t,n)=>{"use strict";n.d(t,{fy:()=>Pe,dT:()=>Ue,hm:()=>W,PB:()=>Fe});var a=n(496279),r=n(215473),i=n(912844),s=n(627158),o=n(348834),u=(n(883669),n(888)),p=n(228786),m=n(226410),c=n(996346),d=n(991965);!function(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let n=0;n<e.length;n++){const a=e.charAt(n),r=a.charCodeAt(0);if(255!==t[r])throw new TypeError(a+" is ambiguous");t[r]=n}const n=e.length,a=e.charAt(0),r=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function s(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;let i=0,s=0,o=0;for(;e[i]===a;)0;const u=(e.length-i)*r+1>>>0,p=new Uint8Array(u);for(;i<e.length;){const a=e.charCodeAt(i);if(a>255)return;let r=t[a];if(255===r)return;let s=0;for(let e=u-1;(0!==r||s<o)&&-1!==e;s++)n*p[e]>>>0,p[e]=r%256>>>0,r/256>>>0;if(0!==r)throw new Error("Non-zero carry");s}let m=u-o;for(;m!==u&&0===p[m];)0;const c=new Uint8Array(s+(u-m));let d=s;for(;m!==u;)c[d++]=p[m++];return c}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");var y=n(611028),l=n(460346),f=n(967468),b={MAYAN_FORWARDER_CONTRACT:"0x076baB2Bf1aa0a06F47BD32245527f6D84d62Fd1",MAYAN_PROGRAM_ID:"FC4eXxkyrMPTjiYUpp4EAnkmwMbQyZ6NDCh1kfLn6vsf",AUCTION_PROGRAM_ID:"8QJmxZcEzwuYmCPy6XqgN2sHcYCcFq6AEfBMJZZuLo5a",MCTP_PROGRAM_ID:"dkpZqrxHFrhziEMQ931GLtfy11nFkCsfMftH9u6QwBU",SWIFT_PROGRAM_ID:"92peaC8g5ANAxpK2aCfLTC12JgPncRKCGULQNB2DMvRH",FEE_MANAGER_PROGRAM_ID:"EyQnmCoLDaFDuNdGYJuYNjFPorohwPuvUzhewg9nGej1",WORMHOLE_PROGRAM_ID:"3u8hJUVTA4jH1wYAyUur7FFZVQ8H635K3tSHHF4ssjQ5",CCTP_CORE_PROGRAM_ID:"CCTPmbSD7gX1bxKPAmg77w8oFzNFpaQiQUWD43TKaecd",CCTP_TOKEN_PROGRAM_ID:"CCTPiPYPc6AsJuwueEnWgSgucamXDZwBd53dQ11YiKX3",TOKEN_PROGRAM_ID:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",TOKEN_2022_PROGRAM_ID:"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb",ASSOCIATED_TOKEN_PROGRAM_ID:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",SPL_UTILS_PROGRAM_ID:"B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69",LOOKUP_TABLE:"8fVCtaFqfEAtGtqcoVyawy1Mytj461T4Ti4YjHZqfF47",SUI_MCTP_STATE:"0xb787fe0f7530b4fd2162fa0cc92f4f6c5a97c54b4c5c55eb04ab29f4b803ac9c",SUI_MCTP_FEE_MANAGER_STATE:"0xa1b4a96ce93d36dd0bbce0adc39533a07d2f32928918c80cd6fe7868320978f2",SUI_CCTP_CORE_PACKAGE_ID:"0x08d87d37ba49e785dde270a83f8e979605b03dc552b5548f26fdf2f49bf7ed1b",SUI_CCTP_CORE_STATE:"0xf68268c3d9b1df3215f2439400c1c4ea08ac4ef4bb7d6f3ca6a2a239e17510af",SUI_CCTP_TOKEN_PACKAGE_ID:"0x2aa6c5d56376c371f88a6cc42e852824994993cb9bab8d3e6450cbe3cb32b94e",SUI_CCTP_TOKEN_STATE:"0x45993eecc0382f37419864992c12faee2238f5cfe22b98ad3bf455baf65c8a2f",SUI_WORMHOLE_PACKAGE_ID:"0x5306f64e312b581766351c07af79c72fcb1cd25147157fdc2f8ad76de9a3fb6a",SUI_WORMHOLE_STATE:"0xaeab97f96cf9877fee2883315d459552b2b921edc16d7ceac6eab944dd88919c",SUI_LOGGER_PACKAGE_ID:"0x05680e9030c147b413a489f7891273acc221d49bd061c433e5771bc170fc37ac",EXPLORER_URL:"https://testnet-explorer-api.mayan.finance/v3",PRICE_URL:"https://testnet-price-api.mayan.finance/v3",RELAYER_URL:"https://testnet-relayer-api.mayan.finance/v3"};function g(e,t){if(1===t)return(0,r.U3)(new s.PublicKey(e).toBytes(),32);if(t===M.ethereum||t===M.base||t===M.monad)return(0,r.U3)(e,32);throw console.log(`Unsupported chain id: ${t}`,e),new Error("Unsupported token chain")}function h(e){return new Uint8Array(o.Buffer.from(e.startsWith("0x")?e.substring(2):e,"hex"))}function T(e,t,n=!1,a=new s.PublicKey(b.TOKEN_PROGRAM_ID),r=new s.PublicKey(b.ASSOCIATED_TOKEN_PROGRAM_ID)){if(!n&&!s.PublicKey.isOnCurve(t.toBuffer()))throw new Error("TokenOwnerOffCurveError");const[i]=s.PublicKey.findProgramAddressSync([t.toBuffer(),a.toBuffer(),e.toBuffer()],r);return i}function w(e,t){if(null==e)throw new Error("getAmountOfFractionalAmount: Amount is null or undefined");if("string"!=typeof e&&"number"!=typeof e)throw new Error("getAmountOfFractionalAmount: Amount is not a string or number");if("string"==typeof e&&0===e.length)throw new Error("getAmountOfFractionalAmount: Amount is empty");if(!Number.isFinite(Number(e)))throw new Error("getAmountOfFractionalAmount: Amount is not a number");const n=Math.min(8,Number(t)),a=Number(e).toFixed(n+1),r=new RegExp(`^-?\\d+(?:\\.\\d{0,${n}})?`),s=a.match(r);if(!s)throw new Error("getAmountOfFractionalAmount: fixedAmount is null");const o=s[0];return(0,i.vz)(o,Number(t))}var M={solana:1,ethereum:10002,base:10004,monad:48,sui:21};function A(e){return M[e]}var S={11155111:10002,84532:10004,10143:48};function I(e){return S[e]}var k=[10,5,0];function C(){return k.join("_")}function P(e){return"solana"===e?9:18}var E=BigInt(2)**BigInt(64)-BigInt(1);function _(e){if(e<BigInt(0)||e>E)throw new Error(`Invalid u64: ${e}`);const t=o.Buffer.alloc(8);return t.writeBigUInt64LE(e),t}var v={value:BigInt(0),deadline:0,v:0,r:`0x${s.SystemProgram.programId.toBuffer().toString("hex")}`,s:`0x${s.SystemProgram.programId.toBuffer().toString("hex")}`};function R(e,t){return e&&t?"WH"===e.type?t?.solana||null:"MCTP"===e.type||"SWIFT"===e.type?"solana"===e.toChain?t?.solana||null:"sui"===e.toChain?t?.sui||null:t?.evm||null:null:null}var D=1,F=2,B=1,x=1,O=2,K=3;function N(e){return Object.entries(e).filter((([e,t])=>null!=t&&!Array.isArray(t))).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}async function U(e){if(e.status.toString().startsWith("5")){let t;try{const n=await e.json();(n?.code||n?.statusCode)&&(n?.message||n?.msg)&&(t={code:n?.code||n?.statusCode,message:n?.message||n?.msg})}catch(e){t=new Error("Internal server error")}throw t}}function W(e,t={wormhole:!0,swift:!0,mctp:!0,shuttle:!0,gasless:!1,onlyDirect:!1,fastMctp:!0}){const{gasDrop:n,referrerBps:a}=e;let r=e.slippageBps;"auto"===r||Number.isFinite(r)||(r=100*e.slippage);const i={wormhole:!1!==t.wormhole,swift:!1!==t.swift,mctp:!1!==t.mctp,shuttle:!0===t.shuttle,fastMctp:!1!==t.fastMctp,gasless:!0===t.gasless,onlyDirect:!0===t.onlyDirect,solanaProgram:b.MAYAN_PROGRAM_ID,forwarderAddress:b.MAYAN_FORWARDER_CONTRACT,amountIn:!e.amountIn64&&Number.isFinite(e.amount)?e.amount:void 0,amountIn64:e.amountIn64,fromToken:e.fromToken,fromChain:e.fromChain,toToken:e.toToken,toChain:e.toChain,slippageBps:r,referrer:e.referrer,referrerBps:Number.isFinite(a)?a:void 0,gasDrop:Number.isFinite(n)?n:void 0,sdkVersion:C()};return`${b.PRICE_URL}/quote?`+N(i)}async function V(e){const t=N({...e,sdkVersion:C()}),n=await a(`${b.PRICE_URL}/get-swap/solana?${t}`,{method:"GET",redirect:"follow"});await U(n);const r=await n.json();if(200!==n.status&&201!==n.status)throw r;return r}var L={_format:"hh-sol-artifact-1",contractName:"MayanSwap",sourceName:"src/MayanSwap.sol",abi:[{inputs:[{internalType:"address",name:"_tokenBridge",type:"address"},{internalType:"address",name:"_weth",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint16",name:"emitterChainId",type:"uint16"},{indexed:!0,internalType:"bytes32",name:"emitterAddress",type:"bytes32"},{indexed:!0,internalType:"uint64",name:"sequence",type:"uint64"}],name:"Redeemed",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"tokenAddr",type:"bytes32"},{internalType:"uint16",name:"tokenChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"sourceAddr",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint64",name:"sequence",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bool",name:"unwrapRedeem",type:"bool"},{internalType:"bool",name:"unwrapRefund",type:"bool"}],internalType:"struct MayanStructs.Swap",name:"s",type:"tuple"}],name:"encodeSwap",outputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],stateMutability:"pure",type:"function"},{inputs:[],name:"getWeth",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRedeemPayload",outputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"uint64",name:"relayerFee",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanStructs.Redeem",name:"r",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeem",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeemAndUnwrap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"swap",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"sweepEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"sweepToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"}],name:"wrapAndSwapETH",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}]},G={_format:"hh-sol-artifact-1",contractName:"MayanForwarder",sourceName:"src/MayanForwarder.sol",abi:[{inputs:[{internalType:"address",name:"_guardian",type:"address"},{internalType:"address[]",name:"_swapProtocols",type:"address[]"},{internalType:"address[]",name:"_mayanProtocols",type:"address[]"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"UnsupportedProtocol",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedEth",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"SwapAndForwarded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"tokenIn",type:"address"},{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedEth",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"mayanProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setMayanProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setSwapProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"swapProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],linkReferences:{},deployedLinkReferences:{}},$={_format:"hh-sol-artifact-1",contractName:"MayanCircle",sourceName:"src/MayanCircle.sol",abi:[{inputs:[{internalType:"address",name:"_cctpTokenMessenger",type:"address"},{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"CallerAlreadySet",type:"error"},{inputs:[],name:"CallerNotSet",type:"error"},{inputs:[],name:"CctpReceiveFailed",type:"error"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DomainAlreadySet",type:"error"},{inputs:[],name:"DomainNotSet",type:"error"},{inputs:[],name:"EmitterAlreadySet",type:"error"},{inputs:[],name:"EthTransferFailed",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAddress",type:"error"},{inputs:[],name:"InvalidAmountOut",type:"error"},{inputs:[],name:"InvalidCaller",type:"error"},{inputs:[],name:"InvalidDestAddr",type:"error"},{inputs:[],name:"InvalidDomain",type:"error"},{inputs:[],name:"InvalidEmitter",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidMintRecipient",type:"error"},{inputs:[],name:"InvalidNonce",type:"error"},{inputs:[],name:"InvalidOrder",type:"error"},{inputs:[],name:"InvalidPayload",type:"error"},{inputs:[],name:"InvalidProtocolFee",type:"error"},{inputs:[],name:"InvalidRedeemFee",type:"error"},{inputs:[],name:"InvalidReferrerFee",type:"error"},{inputs:[],name:"MintRecipientAlreadySet",type:"error"},{inputs:[],name:"MintRecipientNotSet",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderRefunded",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes",name:"customPayload",type:"bytes"}],name:"bridgeWithFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint256",name:"redeemFee",type:"uint256"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],name:"bridgeWithLockedFee",outputs:[{internalType:"uint64",name:"cctpNonce",type:"uint64"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cctpTokenMessenger",outputs:[{internalType:"contract ITokenMessenger",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint16",name:"",type:"uint16"}],name:"chainIdToEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"params",type:"tuple"}],name:"createOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"",type:"uint32"}],name:"domainToCaller",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint64",name:"",type:"uint64"}],name:"feeStorage",outputs:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"redeemFee",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"driver",type:"bytes32"}],internalType:"struct MayanCircle.FulfillParams",name:"params",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"}],name:"fulfillOrder",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"}],name:"getDomain",outputs:[{internalType:"uint32",name:"domain",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"keyToMintRecipient",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"localDomain",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"burnAmount",type:"uint64"},{internalType:"bytes32",name:"burnToken",type:"bytes32"},{internalType:"bytes32",name:"customPayload",type:"bytes32"}],internalType:"struct MayanCircle.BridgeWithFeeParams",name:"bridgeParams",type:"tuple"}],name:"redeemWithFee",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"redeemWithLockedFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"cctpNonce",type:"uint32"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"refineFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"orderParams",type:"tuple"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"}],internalType:"struct MayanCircle.ExtraParams",name:"extraParams",type:"tuple"}],name:"refund",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"uint32",name:"domain",type:"uint32"}],name:"setDomain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"domain",type:"uint32"},{internalType:"bytes32",name:"caller",type:"bytes32"}],name:"setDomainCaller",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"bytes32",name:"emitter",type:"bytes32"}],name:"setEmitter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"}],name:"setMintRecipient",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"}],name:"unlockFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm1",type:"bytes"},{internalType:"bytes",name:"encodedVm2",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],internalType:"struct MayanCircle.UnlockRefinedFeeMsg",name:"refinedMsg",type:"tuple"}],name:"unlockFeeRefined",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}},q=6;function j(e){switch(e){case"ethereum":return 0;case"avalanche":return 1;case"optimism":return 2;case"arbitrum":return 3;case"solana":return 5;case"base":return 6;case"polygon":return 7;case"sui":return 8;case"unichain":return 10;case"linea":return 11;default:throw new Error("unsupported chain for cctp")}}function H(e,t){const n=new s.PublicKey(b.CCTP_CORE_PROGRAM_ID),a=new s.PublicKey(b.CCTP_TOKEN_PROGRAM_ID),[r]=s.PublicKey.findProgramAddressSync([o.Buffer.from("message_transmitter")],n),[i]=s.PublicKey.findProgramAddressSync([o.Buffer.from("sender_authority")],a),[u]=s.PublicKey.findProgramAddressSync([o.Buffer.from("local_token"),e.toBytes()],a),[p]=s.PublicKey.findProgramAddressSync([o.Buffer.from("token_messenger")],a),[m]=s.PublicKey.findProgramAddressSync([o.Buffer.from("token_minter")],a),c=j(t),[d]=s.PublicKey.findProgramAddressSync([o.Buffer.from("remote_token_messenger"),o.Buffer.from(c.toString())],a),[y]=s.PublicKey.findProgramAddressSync([o.Buffer.from("__event_authority")],n),[l]=s.PublicKey.findProgramAddressSync([o.Buffer.from("__event_authority")],a);return{messageTransmitter:r,senderAuthority:i,remoteTokenMessengerKey:d,tokenMessenger:p,tokenMinter:m,eventAuthToken:l,eventAuthCore:y,localToken:u}}function Y(e,t,n,a){const r=function(e,t,n,a){const r=I(Number(n)),i=A(e.fromChain),s=A(e.toChain);if(i!==r)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${i} !== ${r}`);const u=e.cheaperChain===e.fromChain;if(u&&a)throw new Error("Bridge lock fee cannot have custom payload");const p=g(t,s),m=w(e.redeemRelayerFee,q),c=w(e.gasDrop,Math.min(P(e.toChain),8)),d=BigInt(e.effectiveAmountIn64),y=j(e.toChain);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");const l=e.mctpMayanContract;if("solana"===e.toChain&&u)throw new Error("Cannot lock fee for transfer to solana");let f=w(e.bridgeFee,P(e.fromChain));return u&&(f=BigInt(0)),{lockFee:u,tokenIn:e.mctpInputContract,amountIn:d,redeemFee:m,gasDrop:c,destAddr:p,destDomain:y,payloadType:a?F:D,customPayload:a?`0x${o.Buffer.from(a).toString("hex")}`:"0x",bridgeFee:f,contractAddress:l}}(e,t,n,a),{contractAddress:i,tokenIn:s,amountIn:u,destAddr:c,lockFee:d,redeemFee:y,gasDrop:l,destDomain:f,customPayload:b,payloadType:h,bridgeFee:T}=r,M=new p.CH(i,$.abi);let S,k;return S=d?M.interface.encodeFunctionData("bridgeWithLockedFee",[s,u,l,y,f,c]):M.interface.encodeFunctionData("bridgeWithFee",[s,u,y,l,c,f,h,b]),k=(0,m.m9)(T),{to:i,data:S,value:k,_params:r}}function z(e,t,n,a){const r=function(e,t,n,a){const r=I(Number(a)),i=A(e.fromChain),o=A(e.toChain);if(i!==r)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${i} !== ${r}`);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");const p=e.mctpMayanContract,m=g(t,o);let c;c=n?g(n,o):g(s.SystemProgram.programId.toString(),A("solana"));const d=w(e.redeemRelayerFee,q),y=w(e.gasDrop,Math.min(P(e.toChain),8));let l=BigInt(e.effectiveAmountIn64);const f=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),b=BigInt(e.deadline64),h=e.toToken.contract===u.N?g(s.SystemProgram.programId.toString(),A("solana")):g("sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{params:{tokenIn:e.mctpInputContract,amountIn:l,gasDrop:y,destAddr:m,destChain:o,tokenOut:h,minAmountOut:f,deadline:b,redeemFee:d,referrerAddr:c,referrerBps:e.referrerBps||0},bridgeFee:w(e.bridgeFee,P(e.fromChain)),contractAddress:p}}(e,t,n,a),{contractAddress:i,params:o,bridgeFee:c}=r;return{to:i,data:new p.CH(i,$.abi).interface.encodeFunctionData("createOrder",[o]),value:(0,m.m9)(c),_params:r}}var Q={_format:"hh-sol-artifact-1",contractName:"MayanSwift",sourceName:"src/MayanSwift.sol",abi:[{inputs:[{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"_solanaEmitter",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DuplicateOrder",type:"error"},{inputs:[],name:"FeesTooHigh",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidAuctionMode",type:"error"},{inputs:[],name:"InvalidBpsFee",type:"error"},{inputs:[],name:"InvalidContractSignature",type:"error"},{inputs:[],name:"InvalidDestChain",type:"error"},{inputs:[],name:"InvalidEmitterAddress",type:"error"},{inputs:[],name:"InvalidEmitterChain",type:"error"},{inputs:[],name:"InvalidEvmAddr",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidOrderHash",type:"error"},{inputs:[],name:"InvalidOrderStatus",type:"error"},{inputs:[],name:"InvalidSignature",type:"error"},{inputs:[],name:"InvalidSignatureLength",type:"error"},{inputs:[],name:"InvalidSigner",type:"error"},{inputs:[],name:"InvalidSrcChain",type:"error"},{inputs:[],name:"InvalidWormholeFee",type:"error"},{inputs:[],name:"OrderNotExists",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"SmallAmountIn",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"}],name:"OrderCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderRefunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderUnlocked",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"canceler",type:"bytes32"}],name:"cancelOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithEth",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes",name:"signedOrderHash",type:"bytes"}],name:"createOrderWithSig",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithToken",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillSimple",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"orders",outputs:[{internalType:"enum MayanSwift.Status",name:"status",type:"uint8"},{internalType:"uint64",name:"amountIn",type:"uint64"},{internalType:"uint16",name:"destChainId",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseFulfillPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"driver",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"}],internalType:"struct MayanSwift.FulfillMsg",name:"fulfillMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRefundPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"bytes32",name:"canceler",type:"bytes32"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwift.RefundMsg",name:"refundMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseUnlockPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],internalType:"struct MayanSwift.UnlockMsg",name:"unlockMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32[]",name:"orderHashes",type:"bytes32[]"}],name:"postBatch",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"refundOrder",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"solanaEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"unlockMsgs",outputs:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockSingle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}};function Z(e,t,n,a,r=new s.PublicKey(b.TOKEN_PROGRAM_ID),i=new s.PublicKey(b.ASSOCIATED_TOKEN_PROGRAM_ID)){const u=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:s.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new s.TransactionInstruction({keys:u,programId:i,data:o.Buffer.alloc(0)})}var J=165;async function X(e,t,n,a,r,i=new s.PublicKey(b.TOKEN_PROGRAM_ID)){const u=[],p=await e.getMinimumBalanceForRentExemption(J);return u.push(s.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:r.publicKey,lamports:p,space:J,programId:i})),u.push(new s.TransactionInstruction({keys:[{pubkey:r.publicKey,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1}],programId:i,data:o.Buffer.from([1])})),u}var ee=(0,c.struct)([(0,c.u8)("instruction"),(0,c.blob)(8,"amount")]),te=(0,c.struct)([(0,c.u8)("instruction")]);function ne(e){const t=[{pubkey:e,isSigner:!1,isWritable:!0}],n=o.Buffer.alloc(te.span);return te.encode({instruction:17},n),new s.TransactionInstruction({keys:t,programId:new s.PublicKey(b.TOKEN_PROGRAM_ID),data:n})}(0,c.struct)([(0,c.u8)("instruction")]);var ae=(0,c.struct)([(0,c.u8)("instruction"),(0,c.blob)(8,"amount")]);function re(e,t,n,a,r=new s.PublicKey(b.TOKEN_PROGRAM_ID)){const i=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],u=o.Buffer.alloc(ae.span);return ae.encode({instruction:3,amount:_(a)},u),new s.TransactionInstruction({keys:i,programId:r,data:u})}var ie=new s.PublicKey("So11111111111111111111111111111111111111112");function se(e){return new s.TransactionInstruction({programId:new s.PublicKey(e.programId),keys:e.accounts.map((e=>({pubkey:new s.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}))),data:o.Buffer.from(e.data,"base64")})}async function oe(e,t){return(await t.getMultipleAccountsInfo(e.map((e=>new s.PublicKey(e))))).reduce(((t,n,a)=>{const r=e[a];if(n){const e=new s.AddressLookupTableAccount({key:new s.PublicKey(r),state:s.AddressLookupTableAccount.deserialize(n.data)});t.push(e)}return t}),new Array)}function ue(e,t){return{swapInstruction:se(e.swapInstruction),cleanupInstruction:e.cleanupInstruction?se(e.cleanupInstruction):null,computeBudgetInstructions:e.computeBudgetInstructions?e.computeBudgetInstructions.map(se):[],setupInstructions:e.setupInstructions?e.setupInstructions.map(se):[],addressLookupTableAddresses:e.addressLookupTableAddresses}}function pe(e){let t=`global:${e}`;return o.Buffer.from(d.sha256.digest(t)).subarray(0,8)}async function me(){let e;try{const t=await async function(){const e=await a(`${b.RELAYER_URL}/active-relayers?solanaProgram=${b.MAYAN_PROGRAM_ID}`,{method:"GET",redirect:"follow"});await U(e);const t=await e.json();if(200!==e.status&&201!==e.status)throw t;return t.suggested}();e=new s.PublicKey(t)}catch(t){console.log("Relayer not found, using system program"),e=s.SystemProgram.programId}return e}function ce(e,t,n){e.computeBudgetInstructions.forEach((e=>{if(!e.programId.equals(s.ComputeBudgetProgram.programId))throw new Error("Invalid compute budget instruction:: programId");if(3===Uint8Array.from(e.data)[0]&&e.data.readBigUInt64LE(1)>100000000n)throw new Error("Invalid compute budget instruction:: to high tx fee")})),function(e,t){if(!(e.length<1)){if(e.length>6)throw new Error("Invalid setup instruction:: too many instructions");e.forEach((e=>{if(!(e.programId.equals(new s.PublicKey(b.ASSOCIATED_TOKEN_PROGRAM_ID))||e.programId.equals(s.SystemProgram.programId)||e.programId.equals(new s.PublicKey(b.TOKEN_PROGRAM_ID))||e.programId.equals(new s.PublicKey(b.TOKEN_2022_PROGRAM_ID))))throw new Error("Invalid setup instruction:: programId");if(e.programId.equals(new s.PublicKey(b.ASSOCIATED_TOKEN_PROGRAM_ID))){if(1===Uint8Array.from(e.data).length){if(1!==Uint8Array.from(e.data)[0])throw new Error("Invalid setup instruction:: data")}else if(0!==Uint8Array.from(e.data).length)throw new Error("Invalid setup instruction:: data")}else if(e.programId.equals(s.SystemProgram.programId)){if(!t)throw new Error("Invalid setup instruction:: unknown transfer");const n=T(ie,t,!0);if(2!==e.data.readUint32LE())throw new Error("Invalid setup instruction:: invalid system program instruction");if(!e.keys[1].pubkey.equals(n))throw new Error("Invalid setup instruction:: invalid wrap transfer dest")}else if("EQ=="!==e.data.toString("base64"))throw new Error("Invalid setup instruction:: invalid token program instruction")}))}}(e.setupInstructions,n),function(e,t){if(!e.programId.equals(new s.PublicKey("JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4")))throw new Error("Invalid swap instruction:: programId");if(e.data.subarray(0,8).toString("hex")===pe("shared_accounts_route").toString("hex")){if(!e.keys[6].pubkey.equals(t))throw new Error("Invalid swap instruction shared_accounts_route:: dest account")}else{if(e.data.subarray(0,8).toString("hex")!==pe("route").toString("hex"))throw new Error("Invalid swap instruction:: ix id");if(!e.keys[4].pubkey.equals(t))throw new Error("Invalid swap instruction route:: dest account")}}(e.swapInstruction,t),function(e){if(e){if(!e.programId.equals(new s.PublicKey(b.TOKEN_PROGRAM_ID))&&!e.programId.equals(new s.PublicKey(b.TOKEN_2022_PROGRAM_ID)))throw new Error("Invalid cleanup instruction:: programId");if(1!==Uint8Array.from(e.data).length)throw new Error("Invalid cleanup instruction:: data");if(9!==Uint8Array.from(e.data)[0])throw new Error("Invalid cleanup instruction:: data")}}(e.cleanupInstruction)}function de(e,t,n,a,r,i=new s.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA")){return new s.TransactionInstruction({keys:[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1}],programId:new s.PublicKey("B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69"),data:pe("transfer_all_and_close")})}var ye=(0,c.struct)([(0,c.blob)(8,"instruction")]);function le(e,t,n,a,r){const i=new s.PublicKey(b.WORMHOLE_PROGRAM_ID),u=new s.PublicKey(b.TOKEN_PROGRAM_ID),p=new s.PublicKey(b.CCTP_CORE_PROGRAM_ID),m=new s.PublicKey(b.CCTP_TOKEN_PROGRAM_ID),c=new s.PublicKey(b.MCTP_PROGRAM_ID),d=new s.PublicKey(a),y=new s.PublicKey(n),l=T(y,e,!0);let f;f=r&&r>BigInt(0)?T(y,d,!1):new s.PublicKey(b.MCTP_PROGRAM_ID);const g=H(y,t),h=function(e){const t=new s.PublicKey(b.WORMHOLE_PROGRAM_ID),n=new s.PublicKey(e),[a]=s.PublicKey.findProgramAddressSync([o.Buffer.from("Bridge")],t),[r]=s.PublicKey.findProgramAddressSync([o.Buffer.from("emitter")],n),[i]=s.PublicKey.findProgramAddressSync([o.Buffer.from("Sequence"),r.toBuffer()],t),[u]=s.PublicKey.findProgramAddressSync([o.Buffer.from("fee_collector")],t);return{bridgeConfig:a,sequenceKey:i,feeCollector:u,emitter:r}}(b.MCTP_PROGRAM_ID),w=s.Keypair.generate(),M=s.Keypair.generate(),A=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!0},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:g.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:g.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:g.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:g.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:g.localToken,isWritable:!0,isSigner:!1},{pubkey:g.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:g.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:w.publicKey,isWritable:!0,isSigner:!0},{pubkey:m,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:h.emitter,isWritable:!1,isSigner:!1},{pubkey:h.bridgeConfig,isWritable:!0,isSigner:!1},{pubkey:h.sequenceKey,isWritable:!0,isSigner:!1},{pubkey:h.feeCollector,isWritable:!0,isSigner:!1},{pubkey:M.publicKey,isWritable:!0,isSigner:!0},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],S=o.Buffer.alloc(ye.span);return ye.encode({instruction:pe("bridge_with_fee")},S),{instruction:new s.TransactionInstruction({keys:A,data:S,programId:c}),signers:[w,M]}}var fe=(0,c.struct)([(0,c.blob)(8,"instruction")]);function be(e,t,n,a,r){const i=[],u=new s.PublicKey(b.TOKEN_PROGRAM_ID),p=new s.PublicKey(b.ASSOCIATED_TOKEN_PROGRAM_ID),m=new s.PublicKey(b.CCTP_CORE_PROGRAM_ID),c=new s.PublicKey(b.CCTP_TOKEN_PROGRAM_ID),d=new s.PublicKey(b.MCTP_PROGRAM_ID),y=new s.PublicKey(a),l=new s.PublicKey(n),f=T(l,e,!0),g=H(l,t),h=s.Keypair.generate(),[w]=s.PublicKey.findProgramAddressSync([o.Buffer.from("LOCKED_FEE"),l.toBuffer(),h.publicKey.toBytes()],d);let M;M=r&&r>BigInt(0)?T(l,y,!1):new s.PublicKey(b.MCTP_PROGRAM_ID);const A=T(l,w,!0);i.push(Z(y,A,w,l));const S=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!0},{pubkey:M,isWritable:!0,isSigner:!1},{pubkey:w,isWritable:!0,isSigner:!1},{pubkey:A,isWritable:!0,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!1},{pubkey:g.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:g.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:g.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:g.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:g.localToken,isWritable:!0,isSigner:!1},{pubkey:g.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:g.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:h.publicKey,isWritable:!0,isSigner:!0},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:m,isWritable:!1,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],I=o.Buffer.alloc(fe.span);fe.encode({instruction:pe("bridge_locked_fee")},I);const k=new s.TransactionInstruction({keys:S,data:I,programId:d});return i.push(k),{instructions:i,signer:h}}var ge=(0,c.struct)([(0,c.blob)(8,"instruction")]);function he(e,t,n,a,r){const i=new s.PublicKey(b.TOKEN_PROGRAM_ID),u=new s.PublicKey(b.CCTP_CORE_PROGRAM_ID),p=new s.PublicKey(b.CCTP_TOKEN_PROGRAM_ID),m=new s.PublicKey(b.MCTP_PROGRAM_ID),c=new s.PublicKey(a),d=new s.PublicKey(n),y=T(d,e,!0),l=H(d,t),f=s.Keypair.generate(),[g]=s.PublicKey.findProgramAddressSync([o.Buffer.from("ORDER_SOLANA_SOURCE"),e.toBuffer()],m);let h;h=r&&r>BigInt(0)?T(d,c,!1):new s.PublicKey(b.MCTP_PROGRAM_ID);const w=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!0},{pubkey:h,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!1},{pubkey:g,isWritable:!0,isSigner:!1},{pubkey:l.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:l.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:l.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:l.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:l.localToken,isWritable:!0,isSigner:!1},{pubkey:l.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:l.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:f.publicKey,isWritable:!0,isSigner:!0},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(b.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],M=o.Buffer.alloc(ge.span);return ge.encode({instruction:pe("create_order")},M),{instruction:new s.TransactionInstruction({keys:w,data:M,programId:m}),signer:f}}var Te=(0,c.struct)([(0,c.blob)(8,"instruction"),(0,c.blob)(32,"destAddress"),(0,c.blob)(8,"amountInMin"),(0,c.blob)(8,"gasDrop"),(0,c.blob)(8,"feeRedeem"),(0,c.blob)(8,"feeSolana"),(0,c.u16)("destinationChain"),(0,c.blob)(32,"keyRnd"),(0,c.u8)("mode")]);function we(e){if("WITH_FEE"!==e.mode&&"LOCK_FEE"!==e.mode)throw new Error("Invalid mode: "+e.mode);const t=new s.PublicKey(e.swapperAddress),n=new s.PublicKey(e.mintAddress),a=T(n,e.ledger,!0),r=A(e.toChain),i=o.Buffer.from(h(g(e.destinationAddress,r))),u=_(e.amountInMin64),p=_(w(e.gasDrop,Math.min(P(e.toChain),8))),m=_(w(e.feeRedeem,q)),c=_(e.feeSolana),d=e.referrerAddress?o.Buffer.from(h(g(e.referrerAddress,r))):s.SystemProgram.programId.toBuffer(),y=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:e.customPayload||new s.PublicKey(b.MCTP_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(d),isWritable:!1,isSigner:!1}],l=o.Buffer.alloc(Te.span);return Te.encode({instruction:pe("init_bridge_ledger"),destAddress:i,amountInMin:u,gasDrop:p,feeRedeem:m,feeSolana:c,destinationChain:r,keyRnd:e.randomKey.toBuffer(),mode:"WITH_FEE"===e.mode?1:2},l),new s.TransactionInstruction({keys:y,data:l,programId:new s.PublicKey(b.MCTP_PROGRAM_ID)})}var Me=(0,c.struct)([(0,c.blob)(8,"instruction"),(0,c.blob)(32,"destAddress"),(0,c.blob)(8,"amountInMin"),(0,c.blob)(8,"gasDrop"),(0,c.blob)(8,"feeRedeem"),(0,c.blob)(8,"feeSolana"),(0,c.u16)("destinationChain"),(0,c.blob)(32,"keyRnd"),(0,c.u8)("mode"),(0,c.blob)(32,"tokenOut"),(0,c.blob)(8,"amountOutMin"),(0,c.blob)(8,"deadline"),(0,c.blob)(32,"refAddress"),(0,c.u8)("feeRateRef")]);function Ae(e){const t=new s.PublicKey(e.swapperAddress),n=new s.PublicKey(e.mintAddress),a=T(n,e.ledger,!0),r=A(e.toChain),i=o.Buffer.from(h(g(e.destinationAddress,r))),u=_(e.amountInMin64),p=_(w(e.gasDrop,Math.min(P(e.toChain),8))),m=_(w(e.feeRedeem,q)),c=_(e.feeSolana),d=o.Buffer.from(h(g(e.tokenOut,r))),y=e.referrerAddress?o.Buffer.from(h(g(e.referrerAddress,r))):s.SystemProgram.programId.toBuffer(),l=_(w(e.amountOutMin,Math.min(8,e.tokenOutDecimals))),f=_(e.deadline),M=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],S=o.Buffer.alloc(Me.span);return Me.encode({instruction:pe("init_order_ledger"),destAddress:i,amountInMin:u,gasDrop:p,feeRedeem:m,feeSolana:c,destinationChain:r,keyRnd:e.randomKey.toBuffer(),mode:3,tokenOut:d,refAddress:y,amountOutMin:l,deadline:f,feeRateRef:e.feeRateRef},S),new s.TransactionInstruction({keys:M,data:S,programId:new s.PublicKey(b.MCTP_PROGRAM_ID)})}var Se=(0,c.struct)([(0,c.blob)(8,"instruction"),(0,c.blob)(8,"amountInMin"),(0,c.u8)("nativeInput"),(0,c.blob)(8,"feeSubmit"),(0,c.blob)(32,"destAddress"),(0,c.u16)("destinationChain"),(0,c.blob)(32,"tokenOut"),(0,c.blob)(8,"amountOutMin"),(0,c.blob)(8,"gasDrop"),(0,c.blob)(8,"feeCancel"),(0,c.blob)(8,"feeRefund"),(0,c.blob)(8,"deadline"),(0,c.blob)(32,"refAddress"),(0,c.u8)("feeRateRef"),(0,c.u8)("feeRateMayan"),(0,c.u8)("auctionMode"),(0,c.blob)(32,"randomKey")]);async function Ie(e,t,n,a,r,i={}){if("SWIFT"!==e.type)throw new Error("Unsupported quote type for Swift: "+e.type);if("solana"===e.toChain)throw new Error("Unsupported destination chain: "+e.toChain);const p=i.allowSwapperOffCurve||!1;let m=[],c=[],d=[];d.push(b.LOOKUP_TABLE);let l=[],f=[],M=[];const S=s.Keypair.generate();let I=null;const k=new s.PublicKey(b.SWIFT_PROGRAM_ID),C=new s.PublicKey(t),E=s.Keypair.generate();if(!Number(e.deadline64))throw new Error("Swift mode requires a timeout");const v=BigInt(e.deadline64),R=function(e,t,n,a,r){const i=o.Buffer.alloc(239);let p=0;const m=A(e.fromChain),c=o.Buffer.from(h(g(t,m)));i.set(c,0),p+=32,i.writeUInt16BE(m,p),p+=2;const d=e.swiftInputContract===u.N?g(s.SystemProgram.programId.toString(),A("solana")):g(e.swiftInputContract,m),l=o.Buffer.from(h(d));i.set(l,p),p+=32;const f=A(e.toChain),b=o.Buffer.from(h(g(n,f)));i.set(b,p),p+=32,i.writeUInt16BE(f,p),p+=2;const T=e.toToken.contract===u.N?g(s.SystemProgram.programId.toString(),A("solana")):g(e.toToken.contract,f),M=o.Buffer.from(h(T));i.set(M,p),p+=32,i.writeBigUInt64BE(w(e.minAmountOut,Math.min(e.toToken.decimals,8)),p),p+=8,i.writeBigUInt64BE(w(e.gasDrop,Math.min(P(e.toChain),8)),p),p+=8,i.writeBigUInt64BE(BigInt(e.cancelRelayerFee64),p),p+=8,i.writeBigUInt64BE(BigInt(e.refundRelayerFee64),p),p+=8,i.writeBigUInt64BE(BigInt(e.deadline64),p),p+=8;const S=a?o.Buffer.from(h(g(a,f))):s.SystemProgram.programId.toBuffer();i.set(S,p),p+=32,i.writeUInt8(e.referrerBps,p),p+=1;const I=e.protocolBps;i.writeUInt8(I,p),p+=1,i.writeUInt8(e.swiftAuctionMode,p),p+=1;const k=o.Buffer.from(h(r));if(i.set(k,p),p+=32,239!==p)throw new Error(`Invalid order data size: ${p}`);const C=y.w(i);return o.Buffer.from(h(C))}(e,t,n,a,E.publicKey.toBuffer().toString("hex")),[D]=s.PublicKey.findProgramAddressSync([o.Buffer.from("STATE_SOURCE"),R],k),F=e.swiftInputContract===u.N?ie:new s.PublicKey(e.swiftInputContract),B=T(F,D,!0),x=e.gasless?new s.PublicKey(e.relayer):C,O=BigInt(e.submitRelayerFee64)>0n?T(F,x,!1):k;if(e.fromToken.contract===e.swiftInputContract)e.suggestedPriorityFee>0&&m.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),m.push(Z(x,B,D,F)),e.swiftInputContract===u.N?m.push(s.SystemProgram.transfer({fromPubkey:C,toPubkey:B,lamports:BigInt(e.effectiveAmountIn64)}),ne(B)):m.push(re(T(F,C,p),B,C,BigInt(e.effectiveAmountIn64)));else{const n=await V({minMiddleAmount:e.minMiddleAmount,middleToken:e.swiftInputContract,userWallet:t,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.gasless?"SWIFT_GASLESS":"SWIFT",orderHash:`0x${R.toString("hex")}`,fillMaxAccounts:i?.separateSwapTx||!1,tpmTokenAccount:i?.separateSwapTx?S.publicKey.toString():null}),a=ue(n);i?.separateSwapTx&&n.maxAccountsFilled?(ce(a,S.publicKey,C),M=await X(r,x,F,C,S),f.push(...a.computeBudgetInstructions),a.setupInstructions&&f.push(...a.setupInstructions),f.push(a.swapInstruction),a.cleanupInstruction&&f.push(a.cleanupInstruction),l.push(...a.addressLookupTableAddresses),m.push(Z(x,B,D,F)),m.push(de(C,F,S.publicKey,B,x))):(m.push(...a.computeBudgetInstructions),a.setupInstructions&&m.push(...a.setupInstructions),m.push(a.swapInstruction),a.cleanupInstruction&&m.push(a.cleanupInstruction),d.push(...a.addressLookupTableAddresses))}m.push(function(e){const{quote:t}=e,n=t.swiftInputContract===u.N?ie:new s.PublicKey(t.swiftInputContract),a=A(t.toChain);if(a!==t.toToken.wChainId)throw new Error(`Destination chain ID mismatch: ${a} != ${t.toToken.wChainId}`);const r=[{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.relayer,isWritable:!0,isSigner:!0},{pubkey:e.state,isWritable:!0,isSigner:!1},{pubkey:e.stateAccount,isWritable:!0,isSigner:!1},{pubkey:e.relayerAccount,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(b.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(b.TOKEN_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],i=o.Buffer.alloc(Se.span),p=e.referrerAddress?o.Buffer.from(h(g(e.referrerAddress,a))):s.SystemProgram.programId.toBuffer(),m=t.fromToken.contract===t.swiftInputContract?BigInt(t.effectiveAmountIn64):w(t.minMiddleAmount,t.swiftInputDecimals);return Se.encode({instruction:pe("init_order"),amountInMin:_(m),nativeInput:t.swiftInputContract===u.N?1:0,feeSubmit:_(BigInt(t.submitRelayerFee64)),destAddress:o.Buffer.from(h(g(e.destinationAddress,a))),destinationChain:a,tokenOut:o.Buffer.from(h(g(t.toToken.contract,a))),amountOutMin:_(w(t.minAmountOut,Math.min(t.toToken.decimals,8))),gasDrop:_(w(t.gasDrop,Math.min(P(t.toChain),8))),feeCancel:_(BigInt(t.cancelRelayerFee64)),feeRefund:_(BigInt(t.refundRelayerFee64)),deadline:_(e.deadline),refAddress:p,feeRateRef:t.referrerBps,feeRateMayan:t.protocolBps,auctionMode:t.swiftAuctionMode,randomKey:e.randomKey.toBuffer()},i),new s.TransactionInstruction({keys:r,data:i,programId:new s.PublicKey(b.SWIFT_PROGRAM_ID)})}({quote:e,state:D,trader:C,stateAccount:B,randomKey:E.publicKey,relayerAccount:O,relayer:x,destinationAddress:n,deadline:v,referrerAddress:a}));const K=await oe(d.concat(l),r);return c=K.slice(0,d.length),f.length>0&&(I={messageV0:{payerKey:x,instructions:f,addressLookupTableAccounts:K.slice(d.length)},createTmpTokenAccountIxs:M,tmpTokenAccount:S}),{instructions:m,signers:[],lookupTables:c,swapMessageV0Params:I}}var ke=420,Ce=(0,c.struct)([(0,c.u8)("instruction"),(0,c.u8)("stateNonce"),(0,c.blob)(8,"amount"),(0,c.blob)(8,"minAmountOut"),(0,c.blob)(8,"deadline"),(0,c.blob)(8,"feeSwap"),(0,c.blob)(8,"feeReturn"),(0,c.blob)(8,"feeCancel"),(0,c.blob)(8,"gasDrop"),(0,c.u16)("destinationChain"),(0,c.blob)(32,"destinationAddress"),(0,c.u8)("unwrapRedeem"),(0,c.u8)("unwrapRefund"),(0,c.u8)("mayanFeeNonce"),(0,c.u8)("referrerFeeNonce")]);async function Pe(e,t,n,a,r,i={}){const p=R(e,a);if("MCTP"===e.type)return async function(e,t,n,a,r,i={}){const u=i?.forceSkipCctpInstructions||!1,p=i?.allowSwapperOffCurve||!1;if("solana"===e.toChain)throw new Error("Unsupported destination chain: "+e.toChain);let m=[],c=[],d=[],y=[],l=[],f=[],g=[];const h=s.Keypair.generate();let M=null;m.push(b.LOOKUP_TABLE);const A=new s.PublicKey(b.MCTP_PROGRAM_ID),S=new s.PublicKey(t),I=s.Keypair.generate(),k=e.deadline64?BigInt(e.deadline64):BigInt(0);if(e.hasAuction&&!Number(e.deadline64))throw new Error("Swap mode requires a timeout");const C=e.hasAuction?"LEDGER_ORDER":"LEDGER_BRIDGE",[P]=s.PublicKey.findProgramAddressSync([o.Buffer.from(C),S.toBytes(),I.publicKey.toBytes()],A),E=T(new s.PublicKey(e.mctpInputContract),P,!0),_="solana"===e.cheaperChain?"LOCK_FEE":"WITH_FEE",v="sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract;if(e.fromToken.contract===e.mctpInputContract){const r=u?BigInt(e.solanaRelayerFee64):BigInt(0);if(e.suggestedPriorityFee>0&&c.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),c.push(Z(S,E,P,new s.PublicKey(e.mctpInputContract))),c.push(re(T(new s.PublicKey(e.mctpInputContract),S,p),E,S,BigInt(e.effectiveAmountIn64))),e.hasAuction){if(c.push(Ae({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:r,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),tokenOut:v,tokenOutDecimals:e.toToken.decimals,referrerAddress:a,amountOutMin:e.minAmountOut,deadline:k,feeRateRef:e.referrerBps})),!u){const{instruction:n,signer:a}=he(P,e.toChain,e.mctpInputContract,t,r);c.push(n),d.push(a)}}else if(c.push(we({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:r,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),mode:_,referrerAddress:a})),!u)if("WITH_FEE"===_){const{instruction:n,signers:a}=le(P,e.toChain,e.mctpInputContract,t,r);c.push(n),d.push(...a)}else{const{instructions:n,signer:a}=be(P,e.toChain,e.mctpInputContract,t,r);c.push(...n),d.push(a)}}else{const o=await V({minMiddleAmount:e.minMiddleAmount,middleToken:e.mctpInputContract,userWallet:t,userLedger:P.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.hasAuction?"SWAP":_,fillMaxAccounts:i?.separateSwapTx||!1,tpmTokenAccount:i?.separateSwapTx?h.publicKey.toString():null}),u=ue(o);i?.separateSwapTx&&o.maxAccountsFilled?(ce(u,h.publicKey,S),g=await X(r,S,new s.PublicKey(e.mctpInputContract),S,h),f.push(...u.computeBudgetInstructions),u.setupInstructions&&f.push(...u.setupInstructions),f.push(u.swapInstruction),u.cleanupInstruction&&f.push(u.cleanupInstruction),l.push(...u.addressLookupTableAddresses),c.push(Z(S,E,P,new s.PublicKey(e.mctpInputContract))),c.push(de(S,new s.PublicKey(e.mctpInputContract),h.publicKey,E,S))):(ce(u,E,S),c.push(...u.computeBudgetInstructions),u.setupInstructions&&c.push(...u.setupInstructions),c.push(u.swapInstruction),u.cleanupInstruction&&c.push(u.cleanupInstruction),m.push(...u.addressLookupTableAddresses));const p=f.length>0?BigInt(0):BigInt(e.solanaRelayerFee64);if(e.hasAuction){if(c.push(Ae({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:p,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,q),tokenOut:v,tokenOutDecimals:e.toToken.decimals,referrerAddress:a,amountOutMin:e.minAmountOut,deadline:k,feeRateRef:e.referrerBps})),f.length>0){const{instruction:n,signer:a}=he(P,e.toChain,e.mctpInputContract,t,p);c.push(n),d.push(a)}}else if(c.push(we({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:I.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:p,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,q),mode:_,referrerAddress:a})),f.length>0)if("WITH_FEE"===_){const{instruction:n,signers:a}=le(P,e.toChain,e.mctpInputContract,t,p);c.push(n),d.push(...a)}else{const{instructions:n,signer:a}=be(P,e.toChain,e.mctpInputContract,t,p);c.push(...n),d.push(a)}}const R=await oe(m.concat(l),r);return y=R.slice(0,m.length),f.length>0&&(M={messageV0:{payerKey:S,instructions:f,addressLookupTableAccounts:R.slice(m.length)},createTmpTokenAccountIxs:g,tmpTokenAccount:h}),{instructions:c,signers:d,lookupTables:y,swapMessageV0Params:M}}(e,t,n,p,r,i);if("SWIFT"===e.type)return Ie(e,t,n,p,r,i);let m=[];const c=r??new s.Connection("https://rpc.ankr.com/solana"),d=new s.PublicKey(b.MAYAN_PROGRAM_ID),y=new s.PublicKey(b.TOKEN_PROGRAM_ID),l=new s.PublicKey(t),f=new s.PublicKey(b.AUCTION_PROGRAM_ID);let M;e.suggestedPriorityFee>0&&m.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),M=p?new s.PublicKey(p):s.SystemProgram.programId;const[S,I]=s.PublicKey.findProgramAddressSync([o.Buffer.from("MAYANFEE")],d),[k,C]=s.PublicKey.findProgramAddressSync([o.Buffer.from("REFERRERFEE"),M.toBuffer()],d),P=s.Keypair.generate(),E=s.Keypair.generate(),[v,D]=s.PublicKey.findProgramAddressSync([o.Buffer.from("V2STATE"),o.Buffer.from(P.publicKey.toBytes()),o.Buffer.from(E.publicKey.toBytes())],d),F=new s.PublicKey(e.fromToken.mint),B=new s.PublicKey(e.toToken.mint),x=T(F,l),O=T(F,v,!0),[[K,N],U,W]=await Promise.all([c.getMultipleAccountsInfo([x,O],"finalized"),c.getMinimumBalanceForRentExemption(ke),me()]);K&&0!==K.data.length||m.push(Z(l,x,l,F)),N&&0!==N.data.length||m.push(Z(l,O,v,F)),e.fromToken.contract===u.N&&(m.push(s.SystemProgram.transfer({fromPubkey:l,toPubkey:x,lamports:BigInt(e.effectiveAmountIn64)})),m.push(ne(x)));const L=BigInt(e.effectiveAmountIn64),G=s.Keypair.generate();m.push(function(e,t,n,a,r=new s.PublicKey(b.TOKEN_PROGRAM_ID)){const i=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],u=o.Buffer.alloc(ee.span);return ee.encode({instruction:4,amount:_(a)},u),new s.TransactionInstruction({keys:i,programId:r,data:u})}(x,G.publicKey,l,L)),m.push(s.SystemProgram.transfer({fromPubkey:l,toPubkey:G.publicKey,lamports:U}));const $=[{pubkey:G.publicKey,isWritable:!1,isSigner:!0},{pubkey:P.publicKey,isWritable:!1,isSigner:!0},{pubkey:E.publicKey,isWritable:!1,isSigner:!0},{pubkey:v,isWritable:!0,isSigner:!1},{pubkey:x,isWritable:!0,isSigner:!1},{pubkey:l,isWritable:!1,isSigner:!1},{pubkey:O,isWritable:!0,isSigner:!1},{pubkey:F,isWritable:!1,isSigner:!1},{pubkey:B,isWritable:!1,isSigner:!1},{pubkey:f,isWritable:!1,isSigner:!1},{pubkey:M,isWritable:!1,isSigner:!1},{pubkey:S,isWritable:!1,isSigner:!1},{pubkey:k,isWritable:!1,isSigner:!1},{pubkey:G.publicKey,isWritable:!0,isSigner:!0},{pubkey:W,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],j=A(e.toChain);if(1===j){const e=await c.getAccountInfo(new s.PublicKey(n));if(e&&e.owner&&e.owner.equals(y))throw new Error("Destination address is not about token account. It should be a owner address")}const H=o.Buffer.from(h(g(n,j))),Y=w(e.minAmountOut,e.mintDecimals.to),z=w(e.swapRelayerFee,e.mintDecimals.from),Q=w(e.redeemRelayerFee,e.mintDecimals.to),J=w(e.refundRelayerFee,e.mintDecimals.from),te=w(e.gasDrop,"solana"===e.toChain?9:8),ae=e.toToken.contract===u.N,ie=e.fromToken.contract===u.N;if(!Number(e.deadline64))throw new Error("Deadline is not valid");const se=BigInt(e.deadline64),pe=o.Buffer.alloc(Ce.span),ye={instruction:101,stateNonce:D,amount:_(L),minAmountOut:_(Y),deadline:_(se),feeSwap:_(z),feeReturn:_(Q),feeCancel:_(J),gasDrop:_(te),destinationChain:j,destinationAddress:H,unwrapRedeem:ae?1:0,unwrapRefund:ie?1:0,mayanFeeNonce:I,referrerFeeNonce:C};Ce.encode(ye,pe);const fe=new s.TransactionInstruction({keys:$,data:pe,programId:d});return m.push(fe),{instructions:m,signers:[G,P,E],lookupTables:[],swapMessageV0Params:null}}var Ee={abi:[{type:"function",name:"batchMaxApprove",inputs:[{name:"approvals",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initiate",inputs:[{name:"recipient",type:"bytes32",internalType:"bytes32"},{name:"overrideAmountIn",type:"uint256",internalType:"uint256"},{name:"targetChain",type:"uint16",internalType:"uint16"},{name:"params",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"payable"},{type:"error",name:"ChainNotSupported",inputs:[{name:"chain",type:"uint16",internalType:"uint16"}]},{type:"error",name:"DeadlineExpired",inputs:[{name:"blocktime",type:"uint256",internalType:"uint256"},{name:"deadline",type:"uint256",internalType:"uint256"}]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"ExceedsMaxGasDropoff",inputs:[{name:"requested",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ExceedsMaxRelayingFee",inputs:[{name:"fee",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InsufficientInputAmount",inputs:[{name:"input",type:"uint256",internalType:"uint256"},{name:"minimum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidAddress",inputs:[{name:"addr",type:"bytes32",internalType:"bytes32"}]},{type:"error",name:"InvalidBoolVal",inputs:[{name:"val",type:"uint8",internalType:"uint8"}]},{type:"error",name:"InvalidOverrideAmount",inputs:[{name:"received",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapType",inputs:[{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapTypeForChain",inputs:[{name:"chain",type:"uint16",internalType:"uint16"},{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"LengthMismatch",inputs:[{name:"encodedLength",type:"uint256",internalType:"uint256"},{name:"expectedLength",type:"uint256",internalType:"uint256"}]},{type:"error",name:"RelayingDisabledForChain",inputs:[]}]},_e={FAST_MODE_FLAG:1,RELAY_REDEEM_MODE:2,EXACT_IN_FLAG:1,USDC_INPUT_TOKEN_TYPE:0,PRE_APPROVED_ACQUIRE_MODE:0,OUTPUT_USDC_MODE:0,OUTPUT_NATIVE_MODE:1,OUTPUT_OTHER_MODE:2};var ve={abi:[{type:"constructor",inputs:[{name:"_cctpTokenMessengerV2",type:"address",internalType:"address"},{name:"_feeManager",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"bridge",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"referrerAddress",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"customPayload",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"cctpTokenMessengerV2",inputs:[],outputs:[{name:"",type:"address",internalType:"contract ITokenMessengerV2"}],stateMutability:"view"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"createOrder",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"orderPayload",type:"tuple",internalType:"struct FastMCTP.OrderPayload",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"amountOutMin",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"domainToCaller",inputs:[{name:"",type:"uint32",internalType:"uint32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"feeManager",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"fulfillOrder",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"},{name:"swapProtocol",type:"address",internalType:"address"},{name:"swapData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"keyToMintRecipient",inputs:[{name:"",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"paused",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"redeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"refund",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"rescueEth",inputs:[{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address payable"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueRedeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setDomainCallers",inputs:[{name:"domain",type:"uint32",internalType:"uint32"},{name:"caller",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeManager",inputs:[{name:"_feeManager",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setMintRecipient",inputs:[{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"tokenIn",type:"address",internalType:"address"},{name:"mintRecipient",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setPause",inputs:[{name:"_pause",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedMsgSenders",inputs:[{name:"sender",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedSwapProtocols",inputs:[{name:"protocol",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"whitelistedMsgSenders",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"whitelistedSwapProtocols",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"event",name:"OrderFulfilled",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OrderRefunded",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AlreadySet",inputs:[]},{type:"error",name:"CallerNotSet",inputs:[]},{type:"error",name:"CctpReceiveFailed",inputs:[]},{type:"error",name:"DeadlineViolation",inputs:[]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"InvalidAmountOut",inputs:[]},{type:"error",name:"InvalidGasDrop",inputs:[]},{type:"error",name:"InvalidMintRecipient",inputs:[]},{type:"error",name:"InvalidPayload",inputs:[]},{type:"error",name:"InvalidPayloadType",inputs:[]},{type:"error",name:"InvalidRedeemFee",inputs:[]},{type:"error",name:"InvalidRefundFee",inputs:[]},{type:"error",name:"MintRecipientNotSet",inputs:[]},{type:"error",name:"Paused",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]},{type:"error",name:"UnauthorizedMsgSender",inputs:[]},{type:"error",name:"UnauthorizedSwapProtocol",inputs:[]}]};function Re(e,t,n,a,r){const i=function(e,t,n,a,r){const i=I(Number(a)),u=A(e.fromChain),p=A(e.toChain);if(u!==i)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${u} !== ${i}`);const m=g(t,p),c=w(e.redeemRelayerFee,q),d=w(e.gasDrop,Math.min(P(e.toChain),8)),y=BigInt(e.circleMaxFee64),l=BigInt(e.effectiveAmountIn64),f=j(e.toChain);let b;if(b=n?g(n,p):g(s.SystemProgram.programId.toString(),A("solana")),!e.fastMctpMayanContract)throw new Error("FastMctp contract address is missing");const h=e.fastMctpMayanContract;return{tokenIn:e.fastMctpInputContract,amountIn:l,redeemFee:c,gasDrop:d,destAddr:m,destDomain:f,referrerAddr:b,referrerBps:e.referrerBps,payloadType:r?O:x,customPayload:r?`0x${o.Buffer.from(r).toString("hex")}`:"0x",minFinalityThreshold:Number(e.fastMctpMinFinality),circleMaxFee:y,contractAddress:h}}(e,t,n,a,r),{contractAddress:u,tokenIn:c,amountIn:d,destAddr:y,redeemFee:l,gasDrop:f,circleMaxFee:b,referrerAddr:h,referrerBps:T,destDomain:M,customPayload:S,minFinalityThreshold:k,payloadType:C}=i;let E,_;return E=new p.CH(u,ve.abi).interface.encodeFunctionData("bridge",[c,d,l,b,f,y,M,h,T,C,k,S]),_=(0,m.m9)(0),{to:u,data:E,value:_,_params:i}}function De(e,t,n,a){const r=function(e,t,n,a){const r=I(Number(a)),i=A(e.fromChain),o=A(e.toChain);if(i!==r)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${i} !== ${r}`);if(!e.fastMctpMayanContract)throw new Error("MCTP contract address is missing");const p=e.fastMctpMayanContract,m=g(t,o);let c;c=n?g(n,o):g(s.SystemProgram.programId.toString(),A("solana"));const d=w(e.redeemRelayerFee,q),y=BigInt(e.refundRelayerFee64),l=BigInt(e.circleMaxFee64),f=w(e.gasDrop,Math.min(P(e.toChain),8)),b=j(e.toChain),h=BigInt(e.effectiveAmountIn64),T=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),M=BigInt(e.deadline64),S=e.toToken.contract===u.N?g(s.SystemProgram.programId.toString(),A("solana")):g("sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{tokenIn:e.fastMctpInputContract,amountIn:h,circleMaxFee:l,destDomain:b,minFinalityThreshold:Number(e.fastMctpMinFinality),orderPayload:{payloadType:K,destAddr:m,tokenOut:S,amountOutMin:T,gasDrop:f,redeemFee:d,refundFee:y,deadline:M,referrerAddr:c,referrerBps:e.referrerBps||0},contractAddress:p}}(e,t,n,a),{contractAddress:i,orderPayload:o,tokenIn:c,amountIn:d,circleMaxFee:y,destDomain:l,minFinalityThreshold:f}=r;return{to:i,data:new p.CH(i,ve.abi).interface.encodeFunctionData("createOrder",[c,d,y,l,f,o]),value:(0,m.m9)(0),_params:r}}function Fe(e,t,n,a,r,i,c,d){const y=I(Number(i)),l=A(e.fromChain);if(l!==y)throw new Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${l} !== ${y}`);const f=R(e,a);if("MCTP"===e.type)return function(e,t,n,a,r,i){if("MCTP"!==e.type)throw new Error("Quote type is not MCTP");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");a=Number(a);const s=r||v,o=new p.CH(b.MAYAN_FORWARDER_CONTRACT,G.abi),c=w(e.bridgeFee,P(e.fromChain));let d=(0,m.m9)(c);if(e.fromToken.contract===e.mctpInputContract){if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");const r=z(e,t,n,a),i="forwardERC20",u=[e.fromToken.contract,r._params.params.amountIn,s,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(i,u),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(d),chainId:a,_forwarder:{method:i,params:u}}}{const n=Y(e,t,a,i),r="forwardERC20",u=[e.fromToken.contract,n._params.amountIn,s,n._params.contractAddress,n.data];return{data:o.interface.encodeFunctionData(r,u),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(d),chainId:a,_forwarder:{method:r,params:u}}}}{const{minMiddleAmount:r,evmSwapRouterAddress:p,evmSwapRouterCalldata:y}=e;if(!r||!p||!y)throw new Error("MCTP swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");const r=z(e,t,n,a),i=w(e.minMiddleAmount,q);if(e.fromToken.contract===u.N){let t=r._params.params.amountIn;if(t<=c)throw new Error("Amount in is less than bridge fee");c!==BigInt(0)&&(t-=c),d=(0,m.m9)(r._params.params.amountIn);const n="swapAndForwardEth",s=[t,p,y,e.mctpInputContract,i,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(n,s),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(d),chainId:a,_forwarder:{method:n,params:s}}}{const t="swapAndForwardERC20",n=[e.fromToken.contract,r._params.params.amountIn,s,p,y,e.mctpInputContract,i,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(t,n),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(d),chainId:a,_forwarder:{method:t,params:n}}}}{const n=Y(e,t,a,i),r=w(e.minMiddleAmount,q);if(e.fromToken.contract===u.N){let t=n._params.amountIn;if(t<=c)throw new Error("Amount in is less than bridge fee");c!==BigInt(0)&&(t-=c),d=(0,m.m9)(n._params.amountIn);const i="swapAndForwardEth",s=[t,p,y,e.mctpInputContract,r,n._params.contractAddress,n.data];return{data:o.interface.encodeFunctionData(i,s),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(d),chainId:a,_forwarder:{method:i,params:s}}}{const t="swapAndForwardERC20",i=[e.fromToken.contract,n._params.amountIn,s,p,y,e.mctpInputContract,r,n._params.contractAddress,n.data];return{data:o.interface.encodeFunctionData(t,i),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(d),chainId:a,_forwarder:{method:t,params:i}}}}}}(e,n,f,i,d,c);if("SWIFT"===e.type)return function(e,t,n,a,r,i){if("SWIFT"!==e.type)throw new Error("Quote type is not SWIFT");if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");r=Number(r);const o=i||v,c=new p.CH(b.MAYAN_FORWARDER_CONTRACT,G.abi),{tokenIn:d,amountIn:y,order:l,contractAddress:f}=function(e,t,n,a,r){const i=I(Number(r)),o=A(e.fromChain),p=A(e.toChain);if(o!==i)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${o} !== ${i}`);if(!e.swiftMayanContract)throw new Error("SWIFT contract address is missing");if(e.toToken.wChainId!==p)throw new Error(`Destination chain ID mismatch: ${p} != ${e.toToken.wChainId}`);const m=e.swiftMayanContract;if(!Number(e.deadline64))throw new Error("Swift order requires timeout");const c=BigInt(e.deadline64),d=e.swiftInputContract,y=BigInt(e.effectiveAmountIn64);let l;l=a?g(a,p):g(s.SystemProgram.programId.toString(),1);const f=g(s.Keypair.generate().publicKey.toString(),1),b=e.toToken.contract===u.N?g(s.SystemProgram.programId.toString(),1):g(e.toToken.contract,p),h=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),T=w(e.gasDrop,Math.min(8,P(e.toChain))),M=g(n,p);return{contractAddress:m,tokenIn:d,amountIn:y,order:{trader:g(t,o),tokenOut:b,minAmountOut:h,gasDrop:T,cancelFee:BigInt(e.cancelRelayerFee64),refundFee:BigInt(e.refundRelayerFee64),deadline:c,destAddr:M,destChainId:p,referrerAddr:l,referrerBps:e.referrerBps||0,auctionMode:e.swiftAuctionMode,random:f}}}(e,t,n,a,r);let h;const T=new p.CH(f,Q.abi);let M,S,k;if(h=e.swiftInputContract===u.N?T.interface.encodeFunctionData("createOrderWithEth",[l]):T.interface.encodeFunctionData("createOrderWithToken",[d,y,l]),e.fromToken.contract===e.swiftInputContract)e.fromToken.contract===u.N?(M="forwardEth",S=[f,h],k=(0,m.m9)(y)):(M="forwardERC20",S=[d,y,o,f,h],k=(0,m.m9)(0));else{const{evmSwapRouterAddress:t,evmSwapRouterCalldata:n}=e;if(!e.minMiddleAmount||!t||!n)throw new Error("Swift swap requires middle amount, router address and calldata");const a=e.fromToken.contract,r=w(e.minMiddleAmount,e.swiftInputDecimals);e.fromToken.contract===u.N?(M="swapAndForwardEth",S=[y,t,n,e.swiftInputContract,r,f,h],k=(0,m.m9)(y)):(M="swapAndForwardERC20",S=[a,y,o,t,n,e.swiftInputContract,r,f,h],k=(0,m.m9)(0))}return{data:c.interface.encodeFunctionData(M,S),to:b.MAYAN_FORWARDER_CONTRACT,value:k,chainId:r,_forwarder:{method:M,params:S}}}(e,t,n,f,i,d);if("SHUTTLE"===e.type)return function(e,t,n,a){if("SHUTTLE"!==e.type)throw new Error("Quote type is not SHUTTLE");if(!Number.isFinite(Number(n)))throw new Error("Invalid signer chain id");n=Number(n);const r=a||v,i=new p.CH(b.MAYAN_FORWARDER_CONTRACT,G.abi),{destAddr:s,destChainId:c,serializedParams:d,contractAddress:y,amountIn:l,bridgeFee:f}=function(e,t,n){const{shuttleParams:a}=e;if(!a)throw new Error("Swap layer params are missing in quote response");const r=I(Number(n)),i=A(e.fromChain),s=A(e.toChain);if(i!==r)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${i} !== ${r}`);let p=[];p.push(_e.FAST_MODE_FLAG);const m=o.Buffer.alloc(8);m.writeBigUInt64BE(BigInt(a.maxLLFee));const c=m.subarray(2);p.push(...c);const d=o.Buffer.alloc(4);d.writeUInt32BE(a.fastTransferDeadline),p.push(...d),p.push(_e.RELAY_REDEEM_MODE);const y=w(e.gasDrop,Math.min(6,P(e.toChain))),l=o.Buffer.alloc(8);l.writeBigUInt64BE(y);const f=l.subarray(4);p.push(...f);const b=o.Buffer.alloc(8);b.writeBigUInt64BE(BigInt(a.maxRelayingFee));const h=b.subarray(2);p.push(...h),p.push(_e.EXACT_IN_FLAG),p.push(_e.USDC_INPUT_TOKEN_TYPE);const T=BigInt(e.effectiveAmountIn64);if(e.fromToken.contract===e.shuttleInputContract){p.push(...Array(8).fill(0));const e=o.Buffer.alloc(8);e.writeBigUInt64BE(T),p.push(...e)}else p.push(...Array(16).fill(0));if(p.push(_e.PRE_APPROVED_ACQUIRE_MODE),a.hasDestSwap){if(e.toToken.contract===u.N)p.push(_e.OUTPUT_NATIVE_MODE);else{p.push(_e.OUTPUT_OTHER_MODE);const t=o.Buffer.from(g(e.toToken.contract,s).slice(2),"hex");p.push(...t)}const t=o.Buffer.alloc(4);t.writeUInt32BE(Number(BigInt(e.deadline64))),p.push(...t);const n=w(e.minAmountOut,e.toToken.decimals);if("solana"===e.toChain){p.push(...Array(8).fill(0));const e=o.Buffer.alloc(8);e.writeBigUInt64BE(n),p.push(...e)}else{const e=function(e){if(e<0n||e>(1n<<128n)-1n)throw new RangeError("Value must fit in an unsigned 128-bit integer (0 <= value < 2^128)");const t=o.Buffer.alloc(16);for(let n=15;n>=0;n--)t[n]=Number(0xFFn&e),e>>=8n;return t}(n);p.push(...e)}const r=o.Buffer.from(a.path.slice(2),"hex");p.push(...r)}else p.push(_e.OUTPUT_USDC_MODE);return{destAddr:g(t,s),destChainId:s,serializedParams:`0x${o.Buffer.from(p).toString("hex")}`,contractAddress:e.shuttleContract,amountIn:T,bridgeFee:w(e.bridgeFee,P(e.fromChain))}}(e,t,n);let h,T,M,S;if(h=new p.CH(y,Ee.abi).interface.encodeFunctionData("initiate",[s,l,c,d]),e.fromToken.contract===e.shuttleInputContract)T="forwardERC20",M=[e.shuttleInputContract,l,r,y,h],S=(0,m.m9)(f);else{const{evmSwapRouterAddress:t,evmSwapRouterCalldata:n}=e;if(!e.minMiddleAmount||!t||!n)throw new Error("Shuttle source chain swap requires middle amount, router address and calldata");const a=e.fromToken.contract,i=w(e.minMiddleAmount,e.shuttleInputDecimals);e.fromToken.contract===u.N?(T="swapAndForwardEth",M=[l,t,n,e.shuttleInputContract,i,y,h],S=(0,m.m9)(l)):(T="swapAndForwardERC20",M=[a,l,r,t,n,e.shuttleInputContract,i,y,h],S=(0,m.m9)(f))}return{data:i.interface.encodeFunctionData(T,M),to:b.MAYAN_FORWARDER_CONTRACT,value:S,chainId:n,_forwarder:{method:T,params:M}}}(e,n,i,d);if("FAST_MCTP"===e.type)return function(e,t,n,a,r,i){if("FAST_MCTP"!==e.type)throw new Error("Quote type is not FAST_MCTP");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");a=Number(a);const s=r||v,o=new p.CH(b.MAYAN_FORWARDER_CONTRACT,G.abi);if(e.fromToken.contract===e.fastMctpInputContract){if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");const r=De(e,t,n,a),i="forwardERC20",u=[e.fromToken.contract,r._params.amountIn,s,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(i,u),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(0),chainId:a,_forwarder:{method:i,params:u}}}{const r=Re(e,t,n,a,i),u="forwardERC20",p=[e.fromToken.contract,r._params.amountIn,s,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(u,p),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(0),chainId:a,_forwarder:{method:u,params:p}}}}{const{minMiddleAmount:r,evmSwapRouterAddress:p,evmSwapRouterCalldata:c}=e;if(!r||!p||!c)throw new Error("Fast Mctp swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");const r=De(e,t,n,a),i=w(e.minMiddleAmount,q);if(e.fromToken.contract===u.N){const t="swapAndForwardEth",n=[r._params.amountIn,p,c,e.fastMctpInputContract,i,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(t,n),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(r._params.amountIn),chainId:a,_forwarder:{method:t,params:n}}}{const t="swapAndForwardERC20",n=[e.fromToken.contract,r._params.amountIn,s,p,c,e.fastMctpInputContract,i,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(t,n),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(0),chainId:a,_forwarder:{method:t,params:n}}}}{const r=Re(e,t,n,a,i),d=w(e.minMiddleAmount,q);if(e.fromToken.contract===u.N){const t="swapAndForwardEth",n=[r._params.amountIn,p,c,e.fastMctpInputContract,d,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(t,n),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(r._params.amountIn),chainId:a,_forwarder:{method:t,params:n}}}{const t="swapAndForwardERC20",n=[e.fromToken.contract,r._params.amountIn,s,p,c,e.fastMctpInputContract,d,r._params.contractAddress,r.data];return{data:o.interface.encodeFunctionData(t,n),to:b.MAYAN_FORWARDER_CONTRACT,value:(0,m.m9)(0),chainId:a,_forwarder:{method:t,params:n}}}}}}(e,n,f,i,d,c);if("WH"!=e.type)throw new Error("Unsupported quote type");if(!Number(e.deadline64))throw new Error("WH mode requires a timeout");const{relayerFees:h,recipient:M,tokenOut:S,tokenOutWChainId:k,criteria:C,tokenIn:E,amountIn:_,contractAddress:D,bridgeFee:F}=function(e,t,n,a,r,i){const p=new s.PublicKey(b.MAYAN_PROGRAM_ID),[m]=s.PublicKey.findProgramAddressSync([o.Buffer.from("MAIN")],p),c=T(new s.PublicKey(e.fromToken.mint),m,!0),d=BigInt(e.effectiveAmountIn64),y=g(c.toString(),1),l=g(b.AUCTION_PROGRAM_ID,1);let f;f=g(n||s.SystemProgram.programId.toString(),1);const h=I(Number(r)),M=A(e.fromChain),S=A(e.toChain);if(M!==h)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${M} !== ${h}`);const k=e.whMayanContract,C={mayanAddr:y,mayanChainId:1,destAddr:g(t,S),destChainId:S,auctionAddr:l,referrer:f,refundAddr:g(a,h)},E=e.toToken.contract===u.N,_={transferDeadline:BigInt(e.deadline64),swapDeadline:BigInt(e.deadline64),amountOutMin:w(e.minAmountOut,Math.min(8,e.toToken.decimals)),gasDrop:w(e.gasDrop,Math.min(8,P(e.toChain))),unwrap:E,customPayload:i?`0x${o.Buffer.from(i).toString("hex")}`:"0x"},v={swapFee:w(e.swapRelayerFee,Math.min(8,e.fromToken.decimals)),redeemFee:w(e.redeemRelayerFee,Math.min(8,e.toToken.decimals)),refundFee:w(e.refundRelayerFee,Math.min(8,e.fromToken.decimals))},R=g(e.toToken.realOriginContractAddress,e.toToken.realOriginChainId),D=w(e.bridgeFee,18);return{amountIn:d,tokenIn:e.fromToken.contract,tokenOut:R,tokenOutWChainId:e.toToken.realOriginChainId,criteria:_,recipient:C,relayerFees:v,contractAddress:k,bridgeFee:D}}(e,n,f,r,i,c),B=new p.CH(b.MAYAN_FORWARDER_CONTRACT,G.abi),x=new p.CH(D,L.abi);let O,K,N;const U=d||v;E===u.N?(O="forwardEth",K=[D,x.interface.encodeFunctionData("wrapAndSwapETH",[h,M,S,k,C])],N=(0,m.m9)(_)):(O="forwardERC20",K=[E,_,U,D,x.interface.encodeFunctionData("swap",[h,M,S,k,C,E,_])],N=(0,m.m9)(F));const W=B.interface.encodeFunctionData(O,K);return{to:b.MAYAN_FORWARDER_CONTRACT,data:W,value:N,chainId:i,_forwarder:{method:O,params:K}}}async function Be(e,t){let n;try{n=await t.getMoveFunctionArgTypes({package:e.package,module:e.module,function:e.function})}catch(t){throw new Error(`Failed to fetch ${e.package}::${e.module}::${e.function} ArgTypes`)}if(!n)throw new Error(`Failed to fetch package::${e.module}::${e.function} ArgTypes`);if("Pure"!==n[e.argumentIndex]&&"ByImmutableReference"!==n[e.argumentIndex]?.Object)throw new Error(`Argument ${e.argumentIndex} of ${e.module}::${e.function} is not immutable`)}async function xe(e,t){let n,a=[],r=BigInt(0);for(;;){const i=await t.getCoins({...e,owner:e.walletAddress,cursor:n}),s=i.data.filter((e=>BigInt(e.balance)>BigInt(0)));if(a=[...a,...s],s.forEach((e=>{r+=BigInt(e.balance)})),0===i.data.length||!i.hasNextPage||!i.nextCursor||r>=e.coinAmount)return{coins:a.sort(((e,t)=>Number(BigInt(e.coinObjectId)-BigInt(t.coinObjectId)))),sum:r};n=i.nextCursor}}async function Oe(e,t){let n;try{n=await t.getObject({id:e,options:{showContent:!0}})}catch(e){throw new Error(`Failed to fetch Mayan Sui package ID: \n\n ${e}`)}if(n.data?.content?.fields?.latest_package_id)return n.data.content.fields.latest_package_id;throw new Error("latest_package_id not found in Mayan Sui state object")}async function Ke(e,t,n,a,r,i){let s;if(i?.result)s=i.result;else if(i?.objectId)s=e.object(i.objectId);else if(a>BigInt(0)){const{coins:t,sum:i}=await xe({walletAddress:r,coinType:f.uq,coinAmount:a},n);if(i<a)throw new Error("Insufficient funds to pay Wormhole message fee");t.length>1&&e.mergeCoins(t[0].coinObjectId,t.slice(1).map((e=>e.coinObjectId)));const[o]=e.splitCoins(t[0].coinObjectId,[a]);s=o}else{const[t]=e.splitCoins(e.gas,[e.pure.u64(0)]);s=t}return e.moveCall({package:b.SUI_WORMHOLE_PACKAGE_ID,module:"publish_message",function:"publish_message",arguments:[e.object(b.SUI_WORMHOLE_STATE),s,t,e.object(f.H$)]}),e}async function Ne(e,t,n,a,r,i){let s;if(i?.result)s=i.result;else if(i?.objectId)s=r.object(i.objectId);else{const{coins:i,sum:o}=await xe({walletAddress:t,coinType:n,coinAmount:e},a);if(o<e)throw new Error(`Insufficient funds to create Coin ${n} with amount ${e}`);i.length>1&&r.mergeCoins(i[0].coinObjectId,i.slice(1).map((e=>e.coinObjectId)));const[u]=r.splitCoins(i[0].coinObjectId,[e]);s=u}return s}async function Ue(e,t,n,r,i,o,p){const m=R(e,r);if("MCTP"===e.type)return async function(e,t,n,r,i,o,p){const[m,c]=await Promise.all([Oe(b.SUI_MCTP_STATE,o),e.hasAuction?Oe(b.SUI_MCTP_FEE_MANAGER_STATE,o):null]),d=w(e.minMiddleAmount,q);let y,f,h;if(e.fromToken.contract===e.mctpInputContract)y=p?.builtTransaction??new l.Y,f=await Ne(d,t,e.mctpInputContract,o,y,p?.inputCoin);else{const{tx:n,outCoin:i,whFeeCoin:s}=await async function(e){const t=JSON.stringify({...e,sdkVersion:C()}),n=`${b.PRICE_URL}/get-swap/sui`,r=await a(n,{method:"POST",redirect:"follow",body:t,headers:{"Content-Type":"application/json"}});await U(r);const i=await r.json();if(200!==r.status&&201!==r.status)throw i;return i}({amountIn64:e.effectiveAmountIn64,inputCoinType:e.fromToken.contract,middleCoinType:e.mctpInputContract,userWallet:t,withWhFee:e.hasAuction||"sui"!==e.cheaperChain,referrerAddress:r,inputCoin:p?.inputCoin,transaction:p?.builtTransaction?await p.builtTransaction.toJSON():void 0});y=l.Y.from(n),f=i,h=s?{result:s}:null}e.hasAuction?await async function(e,t,n,a,r,i,o,p){const m=A(e.toChain),c=p?.builtTransaction??new l.Y,d=w(e.minMiddleAmount,q),[y]=await Promise.all([Ne(d,t,e.mctpInputContract,o,c,p?.inputCoin),Be({package:i,module:"calculate_mctp_fee",function:"prepare_calc_mctp_fee",argumentIndex:3},o)]),f=e.toToken.contract===u.N?g(s.SystemProgram.programId.toString(),A("solana")):g(e.toToken.contract,e.toToken.wChainId),h=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),T=g(n,m),M=j(e.toChain),S=w(e.gasDrop,Math.min(P(e.toChain),8)),I=w(e.redeemRelayerFee,q),k=BigInt(e.deadline64);let C;C=a?g(a,m):g(s.SystemProgram.programId.toString(),A("solana"));const E=[c.object(e.mctpVerifiedInputAddress),c.pure.u8(B),c.pure.address(t),y,c.pure.address(T),c.pure.u16(m),c.pure.address(f),c.pure.u64(h),c.pure.u64(S),c.pure.u64(I),c.pure.u64(k),c.pure.address(C),c.pure.u8(e.referrerBps)],[_]=c.moveCall({package:i,module:"calculate_mctp_fee",function:"prepare_calc_mctp_fee",typeArguments:[e.mctpInputContract],arguments:E}),[v]=c.moveCall({package:i,module:"calculate_mctp_fee",function:"calculate_mctp_fee",arguments:[c.object(b.SUI_MCTP_FEE_MANAGER_STATE),_]}),[R]=c.moveCall({package:r,module:"init_order",function:"prepare_initialize_order",typeArguments:[e.mctpInputContract],arguments:[...E.slice(1),c.pure.u32(M),c.pure.u64(d)]}),[D,F]=c.moveCall({package:r,module:"init_order",function:"initialize_order",typeArguments:[e.mctpInputContract],arguments:[c.object(b.SUI_MCTP_STATE),c.object(b.SUI_CCTP_CORE_STATE),c.object(e.mctpVerifiedInputAddress),R,v]}),[x,O]=c.moveCall({package:b.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${r}::init_order::CircleAuth`],arguments:[F,c.object(b.SUI_CCTP_TOKEN_STATE),c.object(b.SUI_CCTP_CORE_STATE),c.object("0x403"),c.object(e.mctpInputTreasury)]}),[K]=c.moveCall({package:r,module:"init_order",function:"publish_init_order",arguments:[c.object(b.SUI_MCTP_STATE),D,O]});return await Ke(c,K,o,BigInt(e.bridgeFee),t,p?.whFeeCoin),c}(e,t,n,r,m,c,o,{inputCoin:{result:f},whFeeCoin:h,builtTransaction:y}):"sui"===e.cheaperChain?await async function(e,t,n,a,r,i){const s=A(e.toChain),o=i?.builtTransaction??new l.Y,u=w(e.minMiddleAmount,q),p=await Ne(u,t,e.mctpInputContract,r,o,i?.inputCoin),m=g(n,s),c=j(e.toChain),d=w(e.gasDrop,Math.min(P(e.toChain),8)),y=w(e.redeemRelayerFee,q),[f]=o.moveCall({package:a,module:"bridge_locked_fee",function:"prepare_bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[p,o.pure.u64(u),o.pure.address(m),o.pure.u32(c),o.pure.u64(d),o.pure.u64(y)]}),[h,T]=o.moveCall({package:a,module:"bridge_locked_fee",function:"bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[o.object(b.SUI_MCTP_STATE),o.object(b.SUI_CCTP_CORE_STATE),o.object(e.mctpVerifiedInputAddress),f]}),[M,S]=o.moveCall({package:b.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${a}::bridge_locked_fee::CircleAuth`],arguments:[T,o.object(b.SUI_CCTP_TOKEN_STATE),o.object(b.SUI_CCTP_CORE_STATE),o.object("0x403"),o.object(e.mctpInputTreasury)]});return o.moveCall({package:a,module:"bridge_locked_fee",function:"store_bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[o.object(b.SUI_MCTP_STATE),o.object(e.mctpVerifiedInputAddress),h,S]}),o}(e,t,n,m,o,{inputCoin:{result:f},whFeeCoin:h,builtTransaction:y}):await async function(e,t,n,a,r,i,s){const o=A(e.toChain),u=s?.builtTransaction??new l.Y,p=w(e.minMiddleAmount,q),m=await Ne(p,t,e.mctpInputContract,i,u,s?.inputCoin),c=r?F:D,d=g(n,o),y=j(e.toChain),f=w(e.gasDrop,Math.min(P(e.toChain),8)),h=w(e.redeemRelayerFee,q),T=r?Uint8Array.from(r):Uint8Array.from([]),[M]=u.moveCall({package:a,module:"bridge_with_fee",function:"prepare_bridge_with_fee",typeArguments:[e.mctpInputContract],arguments:[u.pure.u8(c),m,u.pure.u64(p),u.pure.address(d),u.pure.u32(y),u.pure.u64(f),u.pure.u64(h),u.pure.vector("u8",T)]}),[S,I]=u.moveCall({package:a,module:"bridge_with_fee",function:"bridge_with_fee",typeArguments:[e.mctpInputContract],arguments:[u.object(b.SUI_MCTP_STATE),u.object(b.SUI_CCTP_CORE_STATE),u.object(e.mctpVerifiedInputAddress),M]}),[k,C]=u.moveCall({package:b.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${a}::bridge_with_fee::CircleAuth`],arguments:[I,u.object(b.SUI_CCTP_TOKEN_STATE),u.object(b.SUI_CCTP_CORE_STATE),u.object("0x403"),u.object(e.mctpInputTreasury)]}),[E]=u.moveCall({package:a,module:"bridge_with_fee",function:"publish_bridge_with_fee",arguments:[u.object(b.SUI_MCTP_STATE),S,C]});return await Ke(u,E,i,BigInt(e.bridgeFee),t,s?.whFeeCoin),u}(e,t,n,m,i,o,{inputCoin:{result:f},whFeeCoin:h,builtTransaction:y});const T=BigInt(e.effectiveAmountIn64),M=i?Uint8Array.from(i):Uint8Array.from([]);y.moveCall({package:m,module:"init_order",function:"log_initialize_mctp",typeArguments:[e.fromToken.contract],arguments:[y.pure.u64(T),y.object(e.fromToken.verifiedAddress),y.pure.vector("u8",M)]});try{let t;t=r?g(r,A(e.toChain)):g(s.SystemProgram.programId.toString(),A("solana")),y.moveCall({package:b.SUI_LOGGER_PACKAGE_ID,module:"referrer_logger",function:"log_referrer",arguments:[y.pure.address(t),y.pure.u8(e.referrerBps||0)]})}catch(e){console.error("Failed to log referrer",e)}return y}(e,t,n,m,i,o,p);throw new Error("Unsupported quote type from Sui chain")}}}]);