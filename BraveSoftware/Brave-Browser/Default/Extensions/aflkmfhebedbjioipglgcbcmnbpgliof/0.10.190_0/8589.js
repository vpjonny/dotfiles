"use strict";(globalThis.webpackChunk_coral_xyz_app_extension=globalThis.webpackChunk_coral_xyz_app_extension||[]).push([[8589],{126481:(t,e,i)=>{i.d(e,{h:()=>B});var s=i(304235),o=i(971346),r=i.n(o),n=i(202784),a=i(33229),l=i(442248),h=i(728067),d=i(325686),c=i(52356),u=i(483411),f=i(448752),p=i(456571),g=i(547187),m=i(331246),v=i(516634),S=i(622474),b=i(3348),y=i(694407),x=i(762350),w=i(897632),z=i(148347),C=i(748555),T=i(552322);const L={text:"text",number:"numeric",phone:"tel",email:"email"},k="web"!==a.default.OS;function _({visible:t,inputType:e,autoFocus:i=!0,autoCapitalize:o,placeholder:l="Search",cancelButtonText:c="Cancel",enterKeyHint:f="search",onChangeText:p,onClose:g,tintColor:m,style:_,...A},E){const O=(0,s.HJ)(),{dark:R,colors:B,fonts:D}=(0,s.Fg)(),[M,j]=n.useState(""),[W,I]=n.useState(t),[G]=n.useState((()=>new h.default.Value(t?1:0))),[H]=n.useState((()=>new h.default.Value(0))),N=n.useRef(t),P=n.useRef(!1),U=n.useRef(null);n.useEffect((()=>{if(t!==N.current)return h.default.timing(G,{toValue:t?1:0,duration:100,useNativeDriver:k}).start((({finished:e})=>{e&&(I(t),N.current=t)})),()=>{G.stopAnimation()}}),[t,G]);const V=""!==M;n.useEffect((()=>{P.current!==V&&h.default.timing(H,{toValue:V?1:0,duration:100,useNativeDriver:k}).start((({finished:t})=>{t&&(P.current=V)}))}),[H,V]);const K=n.useCallback((()=>{U.current?.clear(),U.current?.focus(),j("")}),[]),q=n.useCallback((()=>{K(),p?.({nativeEvent:{text:""}})}),[K,p]),X=n.useCallback((()=>{q(),g()}),[q,g]);if(n.useEffect((()=>O?.addListener("blur",X)),[X,O]),n.useImperativeHandle(E,(()=>({focus:()=>{U.current?.focus()},blur:()=>{U.current?.blur()},setText:t=>{U.current?.setNativeProps({text:t}),j(t)},clearText:K,cancelSearch:X})),[X,K]),!t&&!W)return null;const $=m??B.text;return(0,T.jsxs)(h.default.View,{pointerEvents:t?"auto":"none","aria-live":"polite","aria-hidden":!t,style:[F.container,{opacity:G},_],children:[(0,T.jsxs)(d.default,{style:F.searchbarContainer,children:[(0,T.jsx)(S.N9,{source:u,tintColor:$,style:F.inputSearchIcon}),(0,T.jsx)(b.default,{...A,ref:U,onChange:p,onChangeText:j,autoFocus:i,autoCapitalize:"systemDefault"===o?void 0:o,inputMode:L[e??"text"],enterKeyHint:f,placeholder:l,placeholderTextColor:r()($).alpha(.5).string(),cursorColor:B.primary,selectionHandleColor:B.primary,selectionColor:r()(B.primary).alpha(.3).string(),style:[D.regular,F.searchbar,{backgroundColor:a.default.select({ios:R?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",default:"transparent"}),color:$,borderBottomColor:r()($).alpha(.2).string()}]}),"ios"===a.default.OS?(0,T.jsx)(z.d,{onPress:q,style:[{opacity:H,transform:[{scale:H}]},F.clearButton],children:(0,T.jsx)(y.default,{source:x,resizeMode:"contain",tintColor:$,style:F.clearIcon})}):null]}),"ios"!==a.default.OS?(0,T.jsx)(v.O,{onPress:()=>{M?q():g()},style:F.closeButton,children:(0,T.jsx)(S.N9,{source:w,tintColor:$})}):null,"ios"===a.default.OS?(0,T.jsx)(z.d,{onPress:X,style:F.cancelButton,children:(0,T.jsx)(C.x,{style:[D.regular,{color:m??B.primary},F.cancelText],children:c})}):null]})}const F=l.default.create({container:{flex:1,flexDirection:"row",alignItems:"stretch"},inputSearchIcon:{position:"absolute",opacity:.5,left:a.default.select({ios:16,default:4}),top:a.default.select({ios:-1,default:17}),...a.default.select({ios:{height:18,width:18},default:{}})},closeButton:{position:"absolute",opacity:.5,right:a.default.select({ios:0,default:8}),top:a.default.select({ios:-2,default:17})},clearButton:{position:"absolute",right:0,top:-7,bottom:0,justifyContent:"center",padding:8},clearIcon:{height:16,width:16,opacity:.5},cancelButton:{alignSelf:"center",top:-4},cancelText:{fontSize:17,marginHorizontal:12},searchbarContainer:{flex:1},searchbar:a.default.select({ios:{flex:1,fontSize:17,paddingHorizontal:32,marginLeft:16,marginTop:-1,marginBottom:4,borderRadius:8,borderCurve:"continuous"},default:{flex:1,fontSize:18,paddingHorizontal:36,marginRight:8,marginTop:8,marginBottom:8,borderBottomWidth:1}})}),A=n.forwardRef(_);var E=i(82435),O=i(880386);const R=414;function B(t){const e=(0,c.HB)(),i=(0,f.M)((t=>t),!0),{colors:o}=(0,s.Fg)(),b=(0,s.HJ)(),y=n.useContext(E.P),[x,w]=n.useState(!1),[z,C]=n.useState(void 0),{layout:L=i,modal:k=!1,back:_,title:F,headerTitle:B,headerTitleAlign:M=("ios"===a.default.OS?"center":"left"),headerLeft:j=(_?t=>(0,T.jsx)(g.D,{...t}):void 0),headerSearchBarOptions:W,headerTransparent:I,headerTintColor:G,headerBackground:H,headerRight:N,headerTitleAllowFontScaling:P,headerTitleStyle:U,headerLeftContainerStyle:V,headerRightContainerStyle:K,headerTitleContainerStyle:q,headerBackButtonDisplayMode:X=("ios"===a.default.OS?"default":"minimal"),headerBackTitleStyle:$,headerBackgroundContainerStyle:J,headerStyle:Y,headerShadowVisible:Q,headerPressColor:Z,headerPressOpacity:tt,headerStatusBarHeight:et=(y?0:e.top)}=t,it=(0,p.R)(L,k,et),{height:st=it,maxHeight:ot,minHeight:rt,backfaceVisibility:nt,backgroundColor:at,borderBlockColor:lt,borderBlockEndColor:ht,borderBlockStartColor:dt,borderBottomColor:ct,borderBottomEndRadius:ut,borderBottomLeftRadius:ft,borderBottomRightRadius:pt,borderBottomStartRadius:gt,borderBottomWidth:mt,borderColor:vt,borderCurve:St,borderEndColor:bt,borderEndEndRadius:yt,borderEndStartRadius:xt,borderEndWidth:wt,borderLeftColor:zt,borderLeftWidth:Ct,borderRadius:Tt,borderRightColor:Lt,borderRightWidth:kt,borderStartColor:_t,borderStartEndRadius:Ft,borderStartStartRadius:At,borderStartWidth:Et,borderStyle:Ot,borderTopColor:Rt,borderTopEndRadius:Bt,borderTopLeftRadius:Dt,borderTopRightRadius:Mt,borderTopStartRadius:jt,borderTopWidth:Wt,borderWidth:It,boxShadow:Gt,elevation:Ht,filter:Nt,mixBlendMode:Pt,opacity:Ut,shadowColor:Vt,shadowOffset:Kt,shadowOpacity:qt,shadowRadius:Xt,transform:$t,transformOrigin:Jt,...Yt}=l.default.flatten(Y||{}),Qt={backfaceVisibility:nt,backgroundColor:at,borderBlockColor:lt,borderBlockEndColor:ht,borderBlockStartColor:dt,borderBottomColor:ct,borderBottomEndRadius:ut,borderBottomLeftRadius:ft,borderBottomRightRadius:pt,borderBottomStartRadius:gt,borderBottomWidth:mt,borderColor:vt,borderCurve:St,borderEndColor:bt,borderEndEndRadius:yt,borderEndStartRadius:xt,borderEndWidth:wt,borderLeftColor:zt,borderLeftWidth:Ct,borderRadius:Tt,borderRightColor:Lt,borderRightWidth:kt,borderStartColor:_t,borderStartEndRadius:Ft,borderStartStartRadius:At,borderStartWidth:Et,borderStyle:Ot,borderTopColor:Rt,borderTopEndRadius:Bt,borderTopLeftRadius:Dt,borderTopRightRadius:Mt,borderTopStartRadius:jt,borderTopWidth:Wt,borderWidth:It,boxShadow:Gt,elevation:Ht,filter:Nt,mixBlendMode:Pt,opacity:Ut,shadowColor:Vt,shadowOffset:Kt,shadowOpacity:qt,shadowRadius:Xt,transform:$t,transformOrigin:Jt};for(const t in Qt)void 0===Qt[t]&&delete Qt[t];const Zt={...I&&{backgroundColor:"transparent"},...(I||!1===Q)&&{borderBottomWidth:0,...a.default.select({android:{elevation:0},web:{boxShadow:"none"},default:{shadowOpacity:0}})},...Qt},te=G??a.default.select({ios:o.primary,default:o.text}),ee=j?j({tintColor:te,pressColor:Z,pressOpacity:tt,displayMode:X,titleLayout:z,screenLayout:L,canGoBack:Boolean(_),onPress:_?b.goBack:void 0,label:_?.title,labelStyle:$,href:_?.href}):null,ie=N?N({tintColor:te,pressColor:Z,pressOpacity:tt,canGoBack:Boolean(_)}):null,se="function"!=typeof B?t=>(0,T.jsx)(O.G,{...t}):B;return(0,T.jsxs)(h.default.View,{pointerEvents:"box-none",style:[{height:st,minHeight:rt,maxHeight:ot,opacity:Ut,transform:$t}],children:[(0,T.jsx)(h.default.View,{pointerEvents:"box-none",style:[l.default.absoluteFill,J],children:H?H({style:Zt}):(0,T.jsx)(m.w,{pointerEvents:!I||"transparent"!==Zt.backgroundColor&&0!==r()(Zt.backgroundColor).alpha()?"auto":"none",style:Zt})}),(0,T.jsx)(d.default,{pointerEvents:"none",style:{height:et}}),(0,T.jsxs)(d.default,{pointerEvents:"box-none",style:[D.content,"ios"===a.default.OS&&i.width>=R?D.large:null],children:[(0,T.jsx)(h.default.View,{pointerEvents:"box-none",style:[D.start,!x&&"center"===M&&D.expand,{marginStart:e.left},V],children:ee}),"ios"!==a.default.OS&&x?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(h.default.View,{pointerEvents:"box-none",style:[D.title,{maxWidth:"center"===M?L.width-2*((ee?"minimal"!==X?80:32:16)+(ie||W?16:0)+Math.max(e.left,e.right)):L.width-((ee?52:16)+(ie||W?52:16)+e.left-e.right)},"left"===M&&ee?{marginStart:4}:{marginHorizontal:16},q],children:se({children:F,allowFontScaling:P,tintColor:G,onLayout:t=>{const{height:e,width:i}=t.nativeEvent.layout;C((t=>t&&e===t.height&&i===t.width?t:{height:e,width:i}))},style:U})}),(0,T.jsxs)(h.default.View,{pointerEvents:"box-none",style:[D.end,D.expand,{marginEnd:e.right},K],children:[ie,W?(0,T.jsx)(v.O,{tintColor:te,pressColor:Z,pressOpacity:tt,onPress:()=>{w(!0),W?.onOpen?.()},children:(0,T.jsx)(S.N9,{source:u,tintColor:te})}):null]})]}),"ios"===a.default.OS||x?(0,T.jsx)(A,{...W,visible:x,onClose:()=>{w(!1),W?.onClose?.()},tintColor:G,style:["ios"===a.default.OS?[l.default.absoluteFill,{paddingTop:et?0:4},{backgroundColor:at??o.card}]:!ee&&{marginStart:8}]}):null]})]})}const D=l.default.create({content:{flex:1,flexDirection:"row",alignItems:"stretch"},large:{marginHorizontal:5},title:{justifyContent:"center"},start:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},end:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end"},expand:{flexGrow:1,flexBasis:0}})},228098:(t,e,i)=>{i.d(e,{X:()=>s});const s=(0,i(111578).K)("HeaderBackContext",void 0)},622474:(t,e,i)=>{i.d(e,{My:()=>d,N9:()=>l});var s=i(304235),o=i(694407),r=i(33229),n=i(442248),a=i(552322);function l({source:t,style:e,...i}){const{colors:r}=(0,s.Fg)(),{direction:n}=(0,s.bU)();return(0,a.jsx)(o.default,{source:t,resizeMode:"contain",fadeDuration:0,tintColor:r.text,style:[c.icon,"rtl"===n&&c.flip,e],...i})}const h="ios"===r.default.OS?21:24,d="ios"===r.default.OS?8:3,c=n.default.create({icon:{width:h,height:h,margin:d},flip:{transform:"scaleX(-1)"}})},82435:(t,e,i)=>{i.d(e,{P:()=>s});const s=(0,i(111578).K)("HeaderShownContext",!1)},590629:(t,e,i)=>{i.d(e,{o:()=>g});var s=i(202784),o=i(878052),r=i(33229),n=i(325686),a=i(442248),l=i(971502),h=i(52356),d=i(448752),c=i(552322);const{width:u=0,height:f=0}=o.default.get("window"),p="web"===r.default.OS||null==l.o?{frame:{x:0,y:0,width:u,height:f},insets:{top:0,left:0,right:0,bottom:0}}:l.o;function g({children:t,style:e}){const i=s.useContext(h.X9);return(0,c.jsx)(d.i,{initialFrame:p.frame,render:({ref:s,onLayout:o})=>i?(0,c.jsx)(n.default,{ref:s,onLayout:o,style:[m.container,e],children:t}):(0,c.jsx)(h.PK,{initialMetrics:p,style:e,onLayout:o,children:t})})}g.initialMetrics=p;const m=a.default.create({container:{flex:1}})},695e3:(t,e,i)=>{i.d(e,{l:()=>p});var s=i(304235),o=i(202784),r=i(325686),n=i(442248),a=i(52356),l=i(722231),h=i(456571),d=i(687898),c=i(82435),u=i(448752),f=i(552322);function p(t){const e=(0,a.HB)(),i=o.useContext(c.P),n=o.useContext(d.M),{focused:p,modal:m=!1,header:v,headerShown:S=!0,headerTransparent:b,headerStatusBarHeight:y=(i?0:e.top),navigation:x,route:w,children:z,style:C}=t,T=(0,u.M)((t=>(0,h.R)(t,m,y))),L=o.useRef(null),[k,_]=o.useState(T);return o.useLayoutEffect((()=>{L.current?.measure(((t,e,i,s)=>{_(s)}))}),[w.name]),(0,f.jsxs)(l.A,{"aria-hidden":!p,style:[g.container,C],collapsable:!1,children:[S?(0,f.jsx)(s.kH.Provider,{value:x,children:(0,f.jsx)(s.kw.Provider,{value:w,children:(0,f.jsx)(r.default,{ref:L,pointerEvents:"box-none",onLayout:t=>{const{height:e}=t.nativeEvent.layout;_(e)},style:[g.header,b?g.absolute:null],children:v})})}):null,(0,f.jsx)(r.default,{style:g.content,children:(0,f.jsx)(c.P.Provider,{value:i||!1!==S,children:(0,f.jsx)(d.M.Provider,{value:S?k:n??0,children:z})})})]})}const g=n.default.create({container:{flex:1},content:{flex:1},header:{zIndex:1},absolute:{position:"absolute",top:0,start:0,end:0}})},762350:(t,e,i)=>{t.exports=i.p+"assets/clear-icon.png"},897632:(t,e,i)=>{t.exports=i.p+"assets/close-icon.png"},483411:(t,e,i)=>{t.exports=i.p+"assets/search-icon.png"},5410:(t,e,i)=>{i.d(e,{z:()=>f});const s="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,o=new Set,r={env:{__DEV__:!1,IS_STATIC:"",NODE_ENV:"production",TAMAGUI_TARGET:"web",DEBUG:"0",BACKPACK_ENV:"production",BACKPACK_CONFIG_LOG_LEVEL:"none",BACKPACK_CONFIG_VERSION:"0.10.190-2"}},n=(t,e,i,s)=>{"function"==typeof r.emitWarning?r.emitWarning(t,e,i,s):console.error(`[${i}] ${e}: ${t}`)};let a=globalThis.AbortController,l=globalThis.AbortSignal;if(void 0===a){l=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(t,e){this._onabort.push(e)}},a=class{constructor(){e()}signal=new l;abort(t){if(!this.signal.aborted){this.signal.reason=t,this.signal.aborted=!0;for(const e of this.signal._onabort)e(t);this.signal.onabort?.(t)}}};let t="1"!==r.env?.LRU_CACHE_IGNORE_AC_WARNING;const e=()=>{t&&(t=!1,n("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}Symbol("type");const h=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),d=t=>h(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?c:null:null;class c extends Array{constructor(t){super(t),this.fill(0)}}class u{heap;length;static#t=!1;static create(t){const e=d(t);if(!e)return[];u.#t=!0;const i=new u(t,e);return u.#t=!1,i}constructor(t,e){if(!u.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class f{#e;#i;#s;#o;#r;#n;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#l;#h;#d;#c;#u;#f;#p;#g;#m;#v;#S;#b;#y;#x;#w;#z;static unsafeExposeInternals(t){return{starts:t.#b,ttls:t.#y,sizes:t.#S,keyMap:t.#h,keyList:t.#d,valList:t.#c,next:t.#u,prev:t.#f,get head(){return t.#p},get tail(){return t.#g},free:t.#m,isBackgroundFetch:e=>t.#C(e),backgroundFetch:(e,i,s,o)=>t.#T(e,i,s,o),moveToTail:e=>t.#L(e),indexes:e=>t.#k(e),rindexes:e=>t.#_(e),isStale:e=>t.#F(e)}}get max(){return this.#e}get maxSize(){return this.#i}get calculatedSize(){return this.#l}get size(){return this.#a}get fetchMethod(){return this.#r}get memoMethod(){return this.#n}get dispose(){return this.#s}get disposeAfter(){return this.#o}constructor(t){const{max:e=0,ttl:i,ttlResolution:s=1,ttlAutopurge:r,updateAgeOnGet:a,updateAgeOnHas:l,allowStale:c,dispose:p,disposeAfter:g,noDisposeOnSet:m,noUpdateTTL:v,maxSize:S=0,maxEntrySize:b=0,sizeCalculation:y,fetchMethod:x,memoMethod:w,noDeleteOnFetchRejection:z,noDeleteOnStaleGet:C,allowStaleOnFetchRejection:T,allowStaleOnFetchAbort:L,ignoreFetchAbort:k}=t;if(0!==e&&!h(e))throw new TypeError("max option must be a nonnegative integer");const _=e?d(e):Array;if(!_)throw new Error("invalid max value: "+e);if(this.#e=e,this.#i=S,this.maxEntrySize=b||this.#i,this.sizeCalculation=y,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==w&&"function"!=typeof w)throw new TypeError("memoMethod must be a function if defined");if(this.#n=w,void 0!==x&&"function"!=typeof x)throw new TypeError("fetchMethod must be a function if specified");if(this.#r=x,this.#w=!!x,this.#h=new Map,this.#d=new Array(e).fill(void 0),this.#c=new Array(e).fill(void 0),this.#u=new _(e),this.#f=new _(e),this.#p=0,this.#g=0,this.#m=u.create(e),this.#a=0,this.#l=0,"function"==typeof p&&(this.#s=p),"function"==typeof g?(this.#o=g,this.#v=[]):(this.#o=void 0,this.#v=void 0),this.#x=!!this.#s,this.#z=!!this.#o,this.noDisposeOnSet=!!m,this.noUpdateTTL=!!v,this.noDeleteOnFetchRejection=!!z,this.allowStaleOnFetchRejection=!!T,this.allowStaleOnFetchAbort=!!L,this.ignoreFetchAbort=!!k,0!==this.maxEntrySize){if(0!==this.#i&&!h(this.#i))throw new TypeError("maxSize must be a positive integer if specified");if(!h(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#A()}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!C,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!l,this.ttlResolution=h(s)||0===s?s:1,this.ttlAutopurge=!!r,this.ttl=i||0,this.ttl){if(!h(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#E()}if(0===this.#e&&0===this.ttl&&0===this.#i)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#i){const t="LRU_CACHE_UNBOUNDED";(t=>!o.has(t))(t)&&(o.add(t),n("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",t,f))}}getRemainingTTL(t){return this.#h.has(t)?1/0:0}#E(){const t=new c(this.#e),e=new c(this.#e);this.#y=t,this.#b=e,this.#O=(i,o,r=s.now())=>{if(e[i]=0!==o?r:0,t[i]=o,0!==o&&this.ttlAutopurge){const t=setTimeout((()=>{this.#F(i)&&this.#R(this.#d[i],"expire")}),o+1);t.unref&&t.unref()}},this.#B=i=>{e[i]=0!==t[i]?s.now():0},this.#D=(s,r)=>{if(t[r]){const n=t[r],a=e[r];if(!n||!a)return;s.ttl=n,s.start=a,s.now=i||o();const l=s.now-a;s.remainingTTL=n-l}};let i=0;const o=()=>{const t=s.now();if(this.ttlResolution>0){i=t;const e=setTimeout((()=>i=0),this.ttlResolution);e.unref&&e.unref()}return t};this.getRemainingTTL=s=>{const r=this.#h.get(s);if(void 0===r)return 0;const n=t[r],a=e[r];return n&&a?n-((i||o())-a):1/0},this.#F=s=>{const r=e[s],n=t[s];return!!n&&!!r&&(i||o())-r>n}}#B=()=>{};#D=()=>{};#O=()=>{};#F=()=>!1;#A(){const t=new c(this.#e);this.#l=0,this.#S=t,this.#M=e=>{this.#l-=t[e],t[e]=0},this.#j=(t,e,i,s)=>{if(this.#C(e))return 0;if(!h(i)){if(!s)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof s)throw new TypeError("sizeCalculation must be a function");if(i=s(e,t),!h(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return i},this.#W=(e,i,s)=>{if(t[e]=i,this.#i){const i=this.#i-t[e];for(;this.#l>i;)this.#I(!0)}this.#l+=t[e],s&&(s.entrySize=i,s.totalCalculatedSize=this.#l)}}#M=t=>{};#W=(t,e,i)=>{};#j=(t,e,i,s)=>{if(i||s)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#k({allowStale:t=this.allowStale}={}){if(this.#a)for(let e=this.#g;this.#G(e)&&(!t&&this.#F(e)||(yield e),e!==this.#p);)e=this.#f[e]}*#_({allowStale:t=this.allowStale}={}){if(this.#a)for(let e=this.#p;this.#G(e)&&(!t&&this.#F(e)||(yield e),e!==this.#g);)e=this.#u[e]}#G(t){return void 0!==t&&this.#h.get(this.#d[t])===t}*entries(){for(const t of this.#k())void 0===this.#c[t]||void 0===this.#d[t]||this.#C(this.#c[t])||(yield[this.#d[t],this.#c[t]])}*rentries(){for(const t of this.#_())void 0===this.#c[t]||void 0===this.#d[t]||this.#C(this.#c[t])||(yield[this.#d[t],this.#c[t]])}*keys(){for(const t of this.#k()){const e=this.#d[t];void 0===e||this.#C(this.#c[t])||(yield e)}}*rkeys(){for(const t of this.#_()){const e=this.#d[t];void 0===e||this.#C(this.#c[t])||(yield e)}}*values(){for(const t of this.#k())void 0===this.#c[t]||this.#C(this.#c[t])||(yield this.#c[t])}*rvalues(){for(const t of this.#_())void 0===this.#c[t]||this.#C(this.#c[t])||(yield this.#c[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(const i of this.#k()){const s=this.#c[i],o=this.#C(s)?s.__staleWhileFetching:s;if(void 0!==o&&t(o,this.#d[i],this))return this.get(this.#d[i],e)}}forEach(t,e=this){for(const i of this.#k()){const s=this.#c[i],o=this.#C(s)?s.__staleWhileFetching:s;void 0!==o&&t.call(e,o,this.#d[i],this)}}rforEach(t,e=this){for(const i of this.#_()){const s=this.#c[i],o=this.#C(s)?s.__staleWhileFetching:s;void 0!==o&&t.call(e,o,this.#d[i],this)}}purgeStale(){let t=!1;for(const e of this.#_({allowStale:!0}))this.#F(e)&&(this.#R(this.#d[e],"expire"),t=!0);return t}info(t){const e=this.#h.get(t);if(void 0===e)return;const i=this.#c[e],o=this.#C(i)?i.__staleWhileFetching:i;if(void 0===o)return;const r={value:o};if(this.#y&&this.#b){const t=this.#y[e],i=this.#b[e];if(t&&i){const e=t-(s.now()-i);r.ttl=e,r.start=Date.now()}}return this.#S&&(r.size=this.#S[e]),r}dump(){const t=[];for(const e of this.#k({allowStale:!0})){const i=this.#d[e],o=this.#c[e],r=this.#C(o)?o.__staleWhileFetching:o;if(void 0===r||void 0===i)continue;const n={value:r};if(this.#y&&this.#b){n.ttl=this.#y[e];const t=s.now()-this.#b[e];n.start=Math.floor(Date.now()-t)}this.#S&&(n.size=this.#S[e]),t.unshift([i,n])}return t}load(t){this.clear();for(const[e,i]of t){if(i.start){const t=Date.now()-i.start;i.start=s.now()-t}this.set(e,i.value,i)}}set(t,e,i={}){if(void 0===e)return this.delete(t),this;const{ttl:s=this.ttl,start:o,noDisposeOnSet:r=this.noDisposeOnSet,sizeCalculation:n=this.sizeCalculation,status:a}=i;let{noUpdateTTL:l=this.noUpdateTTL}=i;const h=this.#j(t,e,i.size||0,n);if(this.maxEntrySize&&h>this.maxEntrySize)return a&&(a.set="miss",a.maxEntrySizeExceeded=!0),this.#R(t,"set"),this;let d=0===this.#a?void 0:this.#h.get(t);if(void 0===d)d=0===this.#a?this.#g:0!==this.#m.length?this.#m.pop():this.#a===this.#e?this.#I(!1):this.#a,this.#d[d]=t,this.#c[d]=e,this.#h.set(t,d),this.#u[this.#g]=d,this.#f[d]=this.#g,this.#g=d,this.#a++,this.#W(d,h,a),a&&(a.set="add"),l=!1;else{this.#L(d);const i=this.#c[d];if(e!==i){if(this.#w&&this.#C(i)){i.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:e}=i;void 0===e||r||(this.#x&&this.#s?.(e,t,"set"),this.#z&&this.#v?.push([e,t,"set"]))}else r||(this.#x&&this.#s?.(i,t,"set"),this.#z&&this.#v?.push([i,t,"set"]));if(this.#M(d),this.#W(d,h,a),this.#c[d]=e,a){a.set="replace";const t=i&&this.#C(i)?i.__staleWhileFetching:i;void 0!==t&&(a.oldValue=t)}}else a&&(a.set="update")}if(0===s||this.#y||this.#E(),this.#y&&(l||this.#O(d,s,o),a&&this.#D(a,d)),!r&&this.#z&&this.#v){const t=this.#v;let e;for(;e=t?.shift();)this.#o?.(...e)}return this}pop(){try{for(;this.#a;){const t=this.#c[this.#p];if(this.#I(!0),this.#C(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(void 0!==t)return t}}finally{if(this.#z&&this.#v){const t=this.#v;let e;for(;e=t?.shift();)this.#o?.(...e)}}}#I(t){const e=this.#p,i=this.#d[e],s=this.#c[e];return this.#w&&this.#C(s)?s.__abortController.abort(new Error("evicted")):(this.#x||this.#z)&&(this.#x&&this.#s?.(s,i,"evict"),this.#z&&this.#v?.push([s,i,"evict"])),this.#M(e),t&&(this.#d[e]=void 0,this.#c[e]=void 0,this.#m.push(e)),1===this.#a?(this.#p=this.#g=0,this.#m.length=0):this.#p=this.#u[e],this.#h.delete(i),this.#a--,e}has(t,e={}){const{updateAgeOnHas:i=this.updateAgeOnHas,status:s}=e,o=this.#h.get(t);if(void 0!==o){const t=this.#c[o];if(this.#C(t)&&void 0===t.__staleWhileFetching)return!1;if(!this.#F(o))return i&&this.#B(o),s&&(s.has="hit",this.#D(s,o)),!0;s&&(s.has="stale",this.#D(s,o))}else s&&(s.has="miss");return!1}peek(t,e={}){const{allowStale:i=this.allowStale}=e,s=this.#h.get(t);if(void 0===s||!i&&this.#F(s))return;const o=this.#c[s];return this.#C(o)?o.__staleWhileFetching:o}#T(t,e,i,s){const o=void 0===e?void 0:this.#c[e];if(this.#C(o))return o;const r=new a,{signal:n}=i;n?.addEventListener("abort",(()=>r.abort(n.reason)),{signal:r.signal});const l={signal:r.signal,options:i,context:s},h=(s,o=!1)=>{const{aborted:n}=r.signal,a=i.ignoreFetchAbort&&void 0!==s;if(i.status&&(n&&!o?(i.status.fetchAborted=!0,i.status.fetchError=r.signal.reason,a&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),n&&!a&&!o)return d(r.signal.reason);const h=c;return this.#c[e]===c&&(void 0===s?h.__staleWhileFetching?this.#c[e]=h.__staleWhileFetching:this.#R(t,"fetch"):(i.status&&(i.status.fetchUpdated=!0),this.set(t,s,l.options))),s},d=s=>{const{aborted:o}=r.signal,n=o&&i.allowStaleOnFetchAbort,a=n||i.allowStaleOnFetchRejection,l=a||i.noDeleteOnFetchRejection,h=c;if(this.#c[e]===c&&(l&&void 0!==h.__staleWhileFetching?n||(this.#c[e]=h.__staleWhileFetching):this.#R(t,"fetch")),a)return i.status&&void 0!==h.__staleWhileFetching&&(i.status.returnedStale=!0),h.__staleWhileFetching;if(h.__returned===h)throw s};i.status&&(i.status.fetchDispatched=!0);const c=new Promise(((e,s)=>{const n=this.#r?.(t,o,l);n&&n instanceof Promise&&n.then((t=>e(void 0===t?void 0:t)),s),r.signal.addEventListener("abort",(()=>{i.ignoreFetchAbort&&!i.allowStaleOnFetchAbort||(e(void 0),i.allowStaleOnFetchAbort&&(e=t=>h(t,!0)))}))})).then(h,(t=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=t),d(t)))),u=Object.assign(c,{__abortController:r,__staleWhileFetching:o,__returned:void 0});return void 0===e?(this.set(t,u,{...l.options,status:void 0}),e=this.#h.get(t)):this.#c[e]=u,u}#C(t){if(!this.#w)return!1;const e=t;return!!e&&e instanceof Promise&&e.hasOwnProperty("__staleWhileFetching")&&e.__abortController instanceof a}async fetch(t,e={}){const{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:r=this.ttl,noDisposeOnSet:n=this.noDisposeOnSet,size:a=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:u=this.ignoreFetchAbort,allowStaleOnFetchAbort:f=this.allowStaleOnFetchAbort,context:p,forceRefresh:g=!1,status:m,signal:v}=e;if(!this.#w)return m&&(m.fetch="get"),this.get(t,{allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:o,status:m});const S={allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:o,ttl:r,noDisposeOnSet:n,size:a,sizeCalculation:l,noUpdateTTL:h,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:f,ignoreFetchAbort:u,status:m,signal:v};let b=this.#h.get(t);if(void 0===b){m&&(m.fetch="miss");const e=this.#T(t,b,S,p);return e.__returned=e}{const e=this.#c[b];if(this.#C(e)){const t=i&&void 0!==e.__staleWhileFetching;return m&&(m.fetch="inflight",t&&(m.returnedStale=!0)),t?e.__staleWhileFetching:e.__returned=e}const o=this.#F(b);if(!g&&!o)return m&&(m.fetch="hit"),this.#L(b),s&&this.#B(b),m&&this.#D(m,b),e;const r=this.#T(t,b,S,p),n=void 0!==r.__staleWhileFetching&&i;return m&&(m.fetch=o?"stale":"refresh",n&&o&&(m.returnedStale=!0)),n?r.__staleWhileFetching:r.__returned=r}}async forceFetch(t,e={}){const i=await this.fetch(t,e);if(void 0===i)throw new Error("fetch() returned undefined");return i}memo(t,e={}){const i=this.#n;if(!i)throw new Error("no memoMethod provided to constructor");const{context:s,forceRefresh:o,...r}=e,n=this.get(t,r);if(!o&&void 0!==n)return n;const a=i(t,n,{options:r,context:s});return this.set(t,a,r),a}get(t,e={}){const{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:r}=e,n=this.#h.get(t);if(void 0!==n){const e=this.#c[n],a=this.#C(e);return r&&this.#D(r,n),this.#F(n)?(r&&(r.get="stale"),a?(r&&i&&void 0!==e.__staleWhileFetching&&(r.returnedStale=!0),i?e.__staleWhileFetching:void 0):(o||this.#R(t,"expire"),r&&i&&(r.returnedStale=!0),i?e:void 0)):(r&&(r.get="hit"),a?e.__staleWhileFetching:(this.#L(n),s&&this.#B(n),e))}r&&(r.get="miss")}#H(t,e){this.#f[e]=t,this.#u[t]=e}#L(t){t!==this.#g&&(t===this.#p?this.#p=this.#u[t]:this.#H(this.#f[t],this.#u[t]),this.#H(this.#g,t),this.#g=t)}delete(t){return this.#R(t,"delete")}#R(t,e){let i=!1;if(0!==this.#a){const s=this.#h.get(t);if(void 0!==s)if(i=!0,1===this.#a)this.#N(e);else{this.#M(s);const i=this.#c[s];if(this.#C(i)?i.__abortController.abort(new Error("deleted")):(this.#x||this.#z)&&(this.#x&&this.#s?.(i,t,e),this.#z&&this.#v?.push([i,t,e])),this.#h.delete(t),this.#d[s]=void 0,this.#c[s]=void 0,s===this.#g)this.#g=this.#f[s];else if(s===this.#p)this.#p=this.#u[s];else{const t=this.#f[s];this.#u[t]=this.#u[s];const e=this.#u[s];this.#f[e]=this.#f[s]}this.#a--,this.#m.push(s)}}if(this.#z&&this.#v?.length){const t=this.#v;let e;for(;e=t?.shift();)this.#o?.(...e)}return i}clear(){return this.#N("delete")}#N(t){for(const e of this.#_({allowStale:!0})){const i=this.#c[e];if(this.#C(i))i.__abortController.abort(new Error("deleted"));else{const s=this.#d[e];this.#x&&this.#s?.(i,s,t),this.#z&&this.#v?.push([i,s,t])}}if(this.#h.clear(),this.#c.fill(void 0),this.#d.fill(void 0),this.#y&&this.#b&&(this.#y.fill(0),this.#b.fill(0)),this.#S&&this.#S.fill(0),this.#p=0,this.#g=0,this.#m.length=0,this.#l=0,this.#a=0,this.#z&&this.#v){const t=this.#v;let e;for(;e=t?.shift();)this.#o?.(...e)}}}}}]);